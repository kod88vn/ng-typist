!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(2),a=r(o),s=n(8),u=(r(s),n(5)),c=r(u),l=n(6),f=r(l),p=function d(){i(this,d),this.version=c["default"].version,this.typistConfig={words:["Hello, typist at work and...","Have a nice day!"],id:"malarkey",typeSpeed:50,deleteSpeed:50,pauseDelay:500,loop:!0,postfix:""}},h=function $(){i(this,$);var e=document.querySelector("#"+this.config.id),t={typeSpeed:this.config.typeSpeed,deleteSpeed:this.config.deleteSpeed,pauseDelay:this.config.pauseDelay,loop:this.config.loop,postfix:this.config.postfix},n=(0,f["default"])(e,t);this.config.words.forEach(function(e){n.type(e).pause()["delete"]()})};a["default"].module("typist",[]).controller("AppController",p).controller("TypistController",h).component("typist",{restrict:"E",bindings:{config:"="},template:'<div ng-attr-id="{{config.id}}"></div>',controller:"TypistController",controllerAs:"tc"}),a["default"].bootstrap(document,["typist"])},function(e,t){/**
	 * @license AngularJS v1.5.0
	 * (c) 2010-2016 Google, Inc. http://angularjs.org
	 * License: MIT
	 */
!function(e,t,n){"use strict";function r(e,t){return t=t||Error,function(){var n,r,i=2,o=arguments,a=o[0],s="["+(e?e+":":"")+a+"] ",u=o[1];for(s+=u.replace(/\{\d+\}/g,function(e){var t=+e.slice(1,-1),n=t+i;return n<o.length?be(o[n]):e}),s+="\nhttp://errors.angularjs.org/1.5.0/"+(e?e+"/":"")+a,r=i,n="?";r<o.length;r++,n="&")s+=n+"p"+(r-i)+"="+encodeURIComponent(be(o[r]));return new t(s)}}function i(e){if(null==e||O(e))return!1;if(Wr(e)||S(e)||Dr&&e instanceof Dr)return!0;var t="length"in Object(e)&&e.length;return C(t)&&(t>=0&&(t-1 in e||e instanceof Array)||"function"==typeof e.item)}function o(e,t,n){var r,a;if(e)if(A(e))for(r in e)"prototype"==r||"length"==r||"name"==r||e.hasOwnProperty&&!e.hasOwnProperty(r)||t.call(n,e[r],r,e);else if(Wr(e)||i(e)){var s="object"!=typeof e;for(r=0,a=e.length;a>r;r++)(s||r in e)&&t.call(n,e[r],r,e)}else if(e.forEach&&e.forEach!==o)e.forEach(t,n,e);else if(w(e))for(r in e)t.call(n,e[r],r,e);else if("function"==typeof e.hasOwnProperty)for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e);else for(r in e)Mr.call(e,r)&&t.call(n,e[r],r,e);return e}function a(e,t,n){for(var r=Object.keys(e).sort(),i=0;i<r.length;i++)t.call(n,e[r[i]],r[i]);return r}function s(e){return function(t,n){e(n,t)}}function u(){return++zr}function c(e,t){t?e.$$hashKey=t:delete e.$$hashKey}function l(e,t,n){for(var r=e.$$hashKey,i=0,o=t.length;o>i;++i){var a=t[i];if(x(a)||A(a))for(var s=Object.keys(a),u=0,f=s.length;f>u;u++){var p=s[u],h=a[p];n&&x(h)?E(h)?e[p]=new Date(h.valueOf()):k(h)?e[p]=new RegExp(h):h.nodeName?e[p]=h.cloneNode(!0):P(h)?e[p]=h.clone():(x(e[p])||(e[p]=Wr(h)?[]:{}),l(e[p],[h],!0)):e[p]=h}}return c(e,r),e}function f(e){return l(e,_r.call(arguments,1),!1)}function p(e){return l(e,_r.call(arguments,1),!0)}function h(e){return parseInt(e,10)}function d(e,t){return f(Object.create(e),t)}function $(){}function v(e){return e}function m(e){return function(){return e}}function g(e){return A(e.toString)&&e.toString!==Fr}function y(e){return"undefined"==typeof e}function b(e){return"undefined"!=typeof e}function x(e){return null!==e&&"object"==typeof e}function w(e){return null!==e&&"object"==typeof e&&!Lr(e)}function S(e){return"string"==typeof e}function C(e){return"number"==typeof e}function E(e){return"[object Date]"===Fr.call(e)}function A(e){return"function"==typeof e}function k(e){return"[object RegExp]"===Fr.call(e)}function O(e){return e&&e.window===e}function M(e){return e&&e.$evalAsync&&e.$watch}function T(e){return"[object File]"===Fr.call(e)}function N(e){return"[object FormData]"===Fr.call(e)}function j(e){return"[object Blob]"===Fr.call(e)}function V(e){return"boolean"==typeof e}function R(e){return e&&A(e.then)}function D(e){return e&&C(e.length)&&Gr.test(Fr.call(e))}function I(e){return"[object ArrayBuffer]"===Fr.call(e)}function P(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}function _(e){var t,n={},r=e.split(",");for(t=0;t<r.length;t++)n[r[t]]=!0;return n}function U(e){return Tr(e.nodeName||e[0]&&e[0].nodeName)}function q(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n}function F(e,t){function r(e,t){var n,r=t.$$hashKey;if(Wr(e))for(var o=0,a=e.length;a>o;o++)t.push(i(e[o]));else if(w(e))for(n in e)t[n]=i(e[n]);else if(e&&"function"==typeof e.hasOwnProperty)for(n in e)e.hasOwnProperty(n)&&(t[n]=i(e[n]));else for(n in e)Mr.call(e,n)&&(t[n]=i(e[n]));return c(t,r),t}function i(e){if(!x(e))return e;var t=s.indexOf(e);if(-1!==t)return u[t];if(O(e)||M(e))throw Br("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");var i=!1,o=a(e);return o===n&&(o=Wr(e)?[]:Object.create(Lr(e)),i=!0),s.push(e),u.push(o),i?r(e,o):o}function a(e){switch(Fr.call(e)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new e.constructor(i(e.buffer));case"[object ArrayBuffer]":if(!e.slice){var t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}return e.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new e.constructor(e.valueOf());case"[object RegExp]":var n=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0]);return n.lastIndex=e.lastIndex,n}return A(e.cloneNode)?e.cloneNode(!0):void 0}var s=[],u=[];if(t){if(D(t)||I(t))throw Br("cpta","Can't copy! TypedArray destination cannot be mutated.");if(e===t)throw Br("cpi","Can't copy! Source and destination are identical.");return Wr(t)?t.length=0:o(t,function(e,n){"$$hashKey"!==n&&delete t[n]}),s.push(e),u.push(t),r(e,t)}return i(e)}function L(e,t){if(Wr(e)){t=t||[];for(var n=0,r=e.length;r>n;n++)t[n]=e[n]}else if(x(e)){t=t||{};for(var i in e)"$"===i.charAt(0)&&"$"===i.charAt(1)||(t[i]=e[i])}return t||e}function B(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!==e&&t!==t)return!0;var n,r,i,o=typeof e,a=typeof t;if(o==a&&"object"==o){if(!Wr(e)){if(E(e))return E(t)?B(e.getTime(),t.getTime()):!1;if(k(e))return k(t)?e.toString()==t.toString():!1;if(M(e)||M(t)||O(e)||O(t)||Wr(t)||E(t)||k(t))return!1;i=me();for(r in e)if("$"!==r.charAt(0)&&!A(e[r])){if(!B(e[r],t[r]))return!1;i[r]=!0}for(r in t)if(!(r in i)&&"$"!==r.charAt(0)&&b(t[r])&&!A(t[r]))return!1;return!0}if(!Wr(t))return!1;if((n=e.length)==t.length){for(r=0;n>r;r++)if(!B(e[r],t[r]))return!1;return!0}}return!1}function H(e,t,n){return e.concat(_r.call(t,n))}function z(e,t){return _r.call(e,t||0)}function W(e,t){var n=arguments.length>2?z(arguments,2):[];return!A(t)||t instanceof RegExp?t:n.length?function(){return arguments.length?t.apply(e,H(n,arguments,0)):t.apply(e,n)}:function(){return arguments.length?t.apply(e,arguments):t.call(e)}}function G(e,r){var i=r;return"string"==typeof e&&"$"===e.charAt(0)&&"$"===e.charAt(1)?i=n:O(r)?i="$WINDOW":r&&t===r?i="$DOCUMENT":M(r)&&(i="$SCOPE"),i}function J(e,t){return y(e)?n:(C(t)||(t=t?2:null),JSON.stringify(e,G,t))}function Y(e){return S(e)?JSON.parse(e):e}function K(e,t){e=e.replace(Xr,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function Z(e,t){return e=new Date(e.getTime()),e.setMinutes(e.getMinutes()+t),e}function X(e,t,n){n=n?-1:1;var r=e.getTimezoneOffset(),i=K(t,r);return Z(e,n*(i-r))}function Q(e){e=Dr(e).clone();try{e.empty()}catch(t){}var n=Dr("<div>").append(e).html();try{return e[0].nodeType===ii?Tr(n):n.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(e,t){return"<"+Tr(t)})}catch(t){return Tr(n)}}function ee(e){try{return decodeURIComponent(e)}catch(t){}}function te(e){var t={};return o((e||"").split("&"),function(e){var n,r,i;e&&(r=e=e.replace(/\+/g,"%20"),n=e.indexOf("="),-1!==n&&(r=e.substring(0,n),i=e.substring(n+1)),r=ee(r),b(r)&&(i=b(i)?ee(i):!0,Mr.call(t,r)?Wr(t[r])?t[r].push(i):t[r]=[t[r],i]:t[r]=i))}),t}function ne(e){var t=[];return o(e,function(e,n){Wr(e)?o(e,function(e){t.push(ie(n,!0)+(e===!0?"":"="+ie(e,!0)))}):t.push(ie(n,!0)+(e===!0?"":"="+ie(e,!0)))}),t.length?t.join("&"):""}function re(e){return ie(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function ie(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,t?"%20":"+")}function oe(e,t){var n,r,i=Qr.length;for(r=0;i>r;++r)if(n=Qr[r]+t,S(n=e.getAttribute(n)))return n;return null}function ae(e,t){var n,r,i={};o(Qr,function(t){var i=t+"app";!n&&e.hasAttribute&&e.hasAttribute(i)&&(n=e,r=e.getAttribute(i))}),o(Qr,function(t){var i,o=t+"app";!n&&(i=e.querySelector("["+o.replace(":","\\:")+"]"))&&(n=i,r=i.getAttribute(o))}),n&&(i.strictDi=null!==oe(n,"strict-di"),t(n,r?[r]:[],i))}function se(n,r,i){x(i)||(i={});var a={strictDi:!1};i=f(a,i);var s=function(){if(n=Dr(n),n.injector()){var e=n[0]===t?"document":Q(n);throw Br("btstrpd","App Already Bootstrapped with this Element '{0}'",e.replace(/</,"&lt;").replace(/>/,"&gt;"))}r=r||[],r.unshift(["$provide",function(e){e.value("$rootElement",n)}]),i.debugInfoEnabled&&r.push(["$compileProvider",function(e){e.debugInfoEnabled(!0)}]),r.unshift("ng");var o=it(r,i.strictDi);return o.invoke(["$rootScope","$rootElement","$compile","$injector",function(e,t,n,r){e.$apply(function(){t.data("$injector",r),n(t)(e)})}]),o},u=/^NG_ENABLE_DEBUG_INFO!/,c=/^NG_DEFER_BOOTSTRAP!/;return e&&u.test(e.name)&&(i.debugInfoEnabled=!0,e.name=e.name.replace(u,"")),e&&!c.test(e.name)?s():(e.name=e.name.replace(c,""),Hr.resumeBootstrap=function(e){return o(e,function(e){r.push(e)}),s()},void(A(Hr.resumeDeferredBootstrap)&&Hr.resumeDeferredBootstrap()))}function ue(){e.name="NG_ENABLE_DEBUG_INFO!"+e.name,e.location.reload()}function ce(e){var t=Hr.element(e).injector();if(!t)throw Br("test","no injector found for element argument to getTestability");return t.get("$$testability")}function le(e,t){return t=t||"_",e.replace(ei,function(e,n){return(n?t:"")+e.toLowerCase()})}function fe(){var t;if(!ti){var r=Zr();Ir=y(r)?e.jQuery:r?e[r]:n,Ir&&Ir.fn.on?(Dr=Ir,f(Ir.fn,{scope:Si.scope,isolateScope:Si.isolateScope,controller:Si.controller,injector:Si.injector,inheritedData:Si.inheritedData}),t=Ir.cleanData,Ir.cleanData=function(e){for(var n,r,i=0;null!=(r=e[i]);i++)n=Ir._data(r,"events"),n&&n.$destroy&&Ir(r).triggerHandler("$destroy");t(e)}):Dr=Ne,Hr.element=Dr,ti=!0}}function pe(e,t,n){if(!e)throw Br("areq","Argument '{0}' is {1}",t||"?",n||"required");return e}function he(e,t,n){return n&&Wr(e)&&(e=e[e.length-1]),pe(A(e),t,"not a function, got "+(e&&"object"==typeof e?e.constructor.name||"Object":typeof e)),e}function de(e,t){if("hasOwnProperty"===e)throw Br("badname","hasOwnProperty is not a valid {0} name",t)}function $e(e,t,n){if(!t)return e;for(var r,i=t.split("."),o=e,a=i.length,s=0;a>s;s++)r=i[s],e&&(e=(o=e)[r]);return!n&&A(e)?W(o,e):e}function ve(e){for(var t,n=e[0],r=e[e.length-1],i=1;n!==r&&(n=n.nextSibling);i++)(t||e[i]!==n)&&(t||(t=Dr(_r.call(e,0,i))),t.push(n));return t||e}function me(){return Object.create(null)}function ge(e){function t(e,t,n){return e[t]||(e[t]=n())}var n=r("$injector"),i=r("ng"),o=t(e,"angular",Object);return o.$$minErr=o.$$minErr||r,t(o,"module",function(){var e={};return function(r,o,a){var s=function(e,t){if("hasOwnProperty"===e)throw i("badname","hasOwnProperty is not a valid {0} name",t)};return s(r,"module"),o&&e.hasOwnProperty(r)&&(e[r]=null),t(e,r,function(){function e(e,t,n,r){return r||(r=i),function(){return r[n||"push"]([e,t,arguments]),l}}function t(e,t){return function(n,o){return o&&A(o)&&(o.$$moduleName=r),i.push([e,t,arguments]),l}}if(!o)throw n("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",r);var i=[],s=[],u=[],c=e("$injector","invoke","push",s),l={_invokeQueue:i,_configBlocks:s,_runBlocks:u,requires:o,name:r,provider:t("$provide","provider"),factory:t("$provide","factory"),service:t("$provide","service"),value:e("$provide","value"),constant:e("$provide","constant","unshift"),decorator:t("$provide","decorator"),animation:t("$animateProvider","register"),filter:t("$filterProvider","register"),controller:t("$controllerProvider","register"),directive:t("$compileProvider","directive"),component:t("$compileProvider","component"),config:c,run:function(e){return u.push(e),this}};return a&&c(a),l})}})}function ye(e){var t=[];return JSON.stringify(e,function(e,n){if(n=G(e,n),x(n)){if(t.indexOf(n)>=0)return"...";t.push(n)}return n})}function be(e){return"function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):y(e)?"undefined":"string"!=typeof e?ye(e):e}function xe(t){f(t,{bootstrap:se,copy:F,extend:f,merge:p,equals:B,element:Dr,forEach:o,injector:it,noop:$,bind:W,toJson:J,fromJson:Y,identity:v,isUndefined:y,isDefined:b,isString:S,isFunction:A,isObject:x,isNumber:C,isElement:P,isArray:Wr,version:ui,isDate:E,lowercase:Tr,uppercase:Nr,callbacks:{counter:0},getTestability:ce,$$minErr:r,$$csp:Kr,reloadWithDebugInfo:ue}),(Pr=ge(e))("ng",["ngLocale"],["$provide",function(e){e.provider({$$sanitizeUri:Sn}),e.provider("$compile",dt).directive({a:Mo,input:Wo,textarea:Wo,form:Ro,script:Fa,select:Ha,style:Wa,option:za,ngBind:Yo,ngBindHtml:Zo,ngBindTemplate:Ko,ngClass:Qo,ngClassEven:ta,ngClassOdd:ea,ngCloak:na,ngController:ra,ngForm:Do,ngHide:Ra,ngIf:aa,ngInclude:sa,ngInit:ca,ngNonBindable:Ea,ngPluralize:Ma,ngRepeat:Ta,ngShow:Va,ngStyle:Da,ngSwitch:Ia,ngSwitchWhen:Pa,ngSwitchDefault:_a,ngOptions:Oa,ngTransclude:qa,ngModel:wa,ngList:la,ngChange:Xo,pattern:Ja,ngPattern:Ja,required:Ga,ngRequired:Ga,minlength:Ka,ngMinlength:Ka,maxlength:Ya,ngMaxlength:Ya,ngValue:Jo,ngModelOptions:Ca}).directive({ngInclude:ua}).directive(To).directive(ia),e.provider({$anchorScroll:ot,$animate:Ui,$animateCss:Li,$$animateJs:Pi,$$animateQueue:_i,$$AnimateRunner:Fi,$$animateAsyncRun:qi,$browser:ft,$cacheFactory:pt,$controller:yt,$document:bt,$exceptionHandler:xt,$filter:Pn,$$forceReflow:Gi,$interpolate:Dt,$interval:It,$http:Nt,$httpParamSerializer:St,$httpParamSerializerJQLike:Ct,$httpBackend:Vt,$xhrFactory:jt,$location:Kt,$log:Zt,$parse:mn,$rootScope:wn,$q:gn,$$q:yn,$sce:kn,$sceDelegate:An,$sniffer:On,$templateCache:ht,$templateRequest:Mn,$$testability:Tn,$timeout:Nn,$window:Rn,$$rAF:xn,$$jqLite:Xe,$$HashMap:ki,$$cookieReader:In})}])}function we(){return++li}function Se(e){return e.replace(hi,function(e,t,n,r){return r?n.toUpperCase():n}).replace(di,"Moz$1")}function Ce(e){return!gi.test(e)}function Ee(e){var t=e.nodeType;return t===ni||!t||t===ai}function Ae(e){for(var t in ci[e.ng339])return!0;return!1}function ke(e){for(var t=0,n=e.length;n>t;t++)De(e[t])}function Oe(e,t){var n,r,i,a,s=t.createDocumentFragment(),u=[];if(Ce(e))u.push(t.createTextNode(e));else{for(n=n||s.appendChild(t.createElement("div")),r=(yi.exec(e)||["",""])[1].toLowerCase(),i=xi[r]||xi._default,n.innerHTML=i[1]+e.replace(bi,"<$1></$2>")+i[2],a=i[0];a--;)n=n.lastChild;u=H(u,n.childNodes),n=s.firstChild,n.textContent=""}return s.textContent="",s.innerHTML="",o(u,function(e){s.appendChild(e)}),s}function Me(e,n){n=n||t;var r;return(r=mi.exec(e))?[n.createElement(r[1])]:(r=Oe(e,n))?r.childNodes:[]}function Te(e,t){var n=e.parentNode;n&&n.replaceChild(t,e),t.appendChild(e)}function Ne(e){if(e instanceof Ne)return e;var t;if(S(e)&&(e=Jr(e),t=!0),!(this instanceof Ne)){if(t&&"<"!=e.charAt(0))throw vi("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new Ne(e)}t?Fe(this,Me(e)):Fe(this,e)}function je(e){return e.cloneNode(!0)}function Ve(e,t){if(t||De(e),e.querySelectorAll)for(var n=e.querySelectorAll("*"),r=0,i=n.length;i>r;r++)De(n[r])}function Re(e,t,n,r){if(b(r))throw vi("offargs","jqLite#off() does not support the `selector` argument");var i=Ie(e),a=i&&i.events,s=i&&i.handle;if(s)if(t){var u=function(t){var r=a[t];b(n)&&q(r||[],n),b(n)&&r&&r.length>0||(pi(e,t,s),delete a[t])};o(t.split(" "),function(e){u(e),$i[e]&&u($i[e])})}else for(t in a)"$destroy"!==t&&pi(e,t,s),delete a[t]}function De(e,t){var r=e.ng339,i=r&&ci[r];if(i){if(t)return void delete i.data[t];i.handle&&(i.events.$destroy&&i.handle({},"$destroy"),Re(e)),delete ci[r],e.ng339=n}}function Ie(e,t){var r=e.ng339,i=r&&ci[r];return t&&!i&&(e.ng339=r=we(),i=ci[r]={events:{},data:{},handle:n}),i}function Pe(e,t,n){if(Ee(e)){var r=b(n),i=!r&&t&&!x(t),o=!t,a=Ie(e,!i),s=a&&a.data;if(r)s[t]=n;else{if(o)return s;if(i)return s&&s[t];f(s,t)}}}function _e(e,t){return e.getAttribute?(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1:!1}function Ue(e,t){t&&e.setAttribute&&o(t.split(" "),function(t){e.setAttribute("class",Jr((" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+Jr(t)+" "," ")))})}function qe(e,t){if(t&&e.setAttribute){var n=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");o(t.split(" "),function(e){e=Jr(e),-1===n.indexOf(" "+e+" ")&&(n+=e+" ")}),e.setAttribute("class",Jr(n))}}function Fe(e,t){if(t)if(t.nodeType)e[e.length++]=t;else{var n=t.length;if("number"==typeof n&&t.window!==t){if(n)for(var r=0;n>r;r++)e[e.length++]=t[r]}else e[e.length++]=t}}function Le(e,t){return Be(e,"$"+(t||"ngController")+"Controller")}function Be(e,t,n){e.nodeType==ai&&(e=e.documentElement);for(var r=Wr(t)?t:[t];e;){for(var i=0,o=r.length;o>i;i++)if(b(n=Dr.data(e,r[i])))return n;e=e.parentNode||e.nodeType===si&&e.host}}function He(e){for(Ve(e,!0);e.firstChild;)e.removeChild(e.firstChild)}function ze(e,t){t||Ve(e);var n=e.parentNode;n&&n.removeChild(e)}function We(t,n){n=n||e,"complete"===n.document.readyState?n.setTimeout(t):Dr(n).on("load",t)}function Ge(e,t){var n=Ci[t.toLowerCase()];return n&&Ei[U(e)]&&n}function Je(e){return Ai[e]}function Ye(e,t){var n=function(n,r){n.isDefaultPrevented=function(){return n.defaultPrevented};var i=t[r||n.type],o=i?i.length:0;if(o){if(y(n.immediatePropagationStopped)){var a=n.stopImmediatePropagation;n.stopImmediatePropagation=function(){n.immediatePropagationStopped=!0,n.stopPropagation&&n.stopPropagation(),a&&a.call(n)}}n.isImmediatePropagationStopped=function(){return n.immediatePropagationStopped===!0};var s=i.specialHandlerWrapper||Ke;o>1&&(i=L(i));for(var u=0;o>u;u++)n.isImmediatePropagationStopped()||s(e,n,i[u])}};return n.elem=e,n}function Ke(e,t,n){n.call(e,t)}function Ze(e,t,n){var r=t.relatedTarget;r&&(r===e||wi.call(e,r))||n.call(e,t)}function Xe(){this.$get=function(){return f(Ne,{hasClass:function(e,t){return e.attr&&(e=e[0]),_e(e,t)},addClass:function(e,t){return e.attr&&(e=e[0]),qe(e,t)},removeClass:function(e,t){return e.attr&&(e=e[0]),Ue(e,t)}})}}function Qe(e,t){var n=e&&e.$$hashKey;if(n)return"function"==typeof n&&(n=e.$$hashKey()),n;var r=typeof e;return n="function"==r||"object"==r&&null!==e?e.$$hashKey=r+":"+(t||u)():r+":"+e}function et(e,t){if(t){var n=0;this.nextUid=function(){return++n}}o(e,this.put,this)}function tt(e){var t=e.toString().replace(ji,""),n=t.match(Oi)||t.match(Mi);return n}function nt(e){var t=tt(e);return t?"function("+(t[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function rt(e,t,n){var r,i,a;if("function"==typeof e){if(!(r=e.$inject)){if(r=[],e.length){if(t)throw S(n)&&n||(n=e.name||nt(e)),Vi("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",n);i=tt(e),o(i[1].split(Ti),function(e){e.replace(Ni,function(e,t,n){r.push(n)})})}e.$inject=r}}else Wr(e)?(a=e.length-1,he(e[a],"fn"),r=e.slice(0,a)):he(e,"fn",!0);return r}function it(e,t){function r(e){return function(t,n){return x(t)?void o(t,s(e)):e(t,n)}}function i(e,t){if(de(e,"service"),(A(t)||Wr(t))&&(t=C.instantiate(t)),!t.$get)throw Vi("pget","Provider '{0}' must define $get factory method.",e);return w[e+v]=t}function a(e,t){return function(){var n=O.invoke(t,this);if(y(n))throw Vi("undef","Provider '{0}' must return a value from $get factory method.",e);return n}}function u(e,t,n){return i(e,{$get:n!==!1?a(e,t):t})}function c(e,t){return u(e,["$injector",function(e){return e.instantiate(t)}])}function l(e,t){return u(e,m(t),!1)}function f(e,t){de(e,"constant"),w[e]=t,E[e]=t}function p(e,t){var n=C.get(e+v),r=n.$get;n.$get=function(){var e=O.invoke(r,n);return O.invoke(t,null,{$delegate:e})}}function h(e){pe(y(e)||Wr(e),"modulesToLoad","not an array");var t,n=[];return o(e,function(e){function r(e){var t,n;for(t=0,n=e.length;n>t;t++){var r=e[t],i=C.get(r[0]);i[r[1]].apply(i,r[2])}}if(!b.get(e)){b.put(e,!0);try{S(e)?(t=Pr(e),n=n.concat(h(t.requires)).concat(t._runBlocks),r(t._invokeQueue),r(t._configBlocks)):A(e)?n.push(C.invoke(e)):Wr(e)?n.push(C.invoke(e)):he(e,"module")}catch(i){throw Wr(e)&&(e=e[e.length-1]),i.message&&i.stack&&-1==i.stack.indexOf(i.message)&&(i=i.message+"\n"+i.stack),Vi("modulerr","Failed to instantiate module {0} due to:\n{1}",e,i.stack||i.message||i)}}}),n}function d(e,n){function r(t,r){if(e.hasOwnProperty(t)){if(e[t]===$)throw Vi("cdep","Circular dependency found: {0}",t+" <- "+g.join(" <- "));return e[t]}try{return g.unshift(t),e[t]=$,e[t]=n(t,r)}catch(i){throw e[t]===$&&delete e[t],i}finally{g.shift()}}function i(e,n,i){for(var o=[],a=it.$$annotate(e,t,i),s=0,u=a.length;u>s;s++){var c=a[s];if("string"!=typeof c)throw Vi("itkn","Incorrect injection token! Expected service name as string, got {0}",c);o.push(n&&n.hasOwnProperty(c)?n[c]:r(c,i))}return o}function o(e){return 11>=Rr?!1:"function"==typeof e&&/^(?:class\s|constructor\()/.test(Function.prototype.toString.call(e))}function a(e,t,n,r){"string"==typeof n&&(r=n,n=null);var a=i(e,n,r);return Wr(e)&&(e=e[e.length-1]),o(e)?(a.unshift(null),new(Function.prototype.bind.apply(e,a))):e.apply(t,a)}function s(e,t,n){var r=Wr(e)?e[e.length-1]:e,o=i(e,t,n);return o.unshift(null),new(Function.prototype.bind.apply(r,o))}return{invoke:a,instantiate:s,get:r,annotate:it.$$annotate,has:function(t){return w.hasOwnProperty(t+v)||e.hasOwnProperty(t)}}}t=t===!0;var $={},v="Provider",g=[],b=new et([],!0),w={$provide:{provider:r(i),factory:r(u),service:r(c),value:r(l),constant:r(f),decorator:p}},C=w.$injector=d(w,function(e,t){throw Hr.isString(t)&&g.push(t),Vi("unpr","Unknown provider: {0}",g.join(" <- "))}),E={},k=d(E,function(e,t){var r=C.get(e+v,t);return O.invoke(r.$get,r,n,e)}),O=k;w["$injector"+v]={$get:m(k)};var M=h(e);return O=k.get("$injector"),O.strictDi=t,o(M,function(e){e&&O.invoke(e)}),O}function ot(){var e=!0;this.disableAutoScrolling=function(){e=!1},this.$get=["$window","$location","$rootScope",function(t,n,r){function i(e){var t=null;return Array.prototype.some.call(e,function(e){return"a"===U(e)?(t=e,!0):void 0}),t}function o(){var e=s.yOffset;if(A(e))e=e();else if(P(e)){var n=e[0],r=t.getComputedStyle(n);e="fixed"!==r.position?0:n.getBoundingClientRect().bottom}else C(e)||(e=0);return e}function a(e){if(e){e.scrollIntoView();var n=o();if(n){var r=e.getBoundingClientRect().top;t.scrollBy(0,r-n)}}else t.scrollTo(0,0)}function s(e){e=S(e)?e:n.hash();var t;e?(t=u.getElementById(e))?a(t):(t=i(u.getElementsByName(e)))?a(t):"top"===e&&a(null):a(null)}var u=t.document;return e&&r.$watch(function(){return n.hash()},function(e,t){e===t&&""===e||We(function(){r.$evalAsync(s)})}),s}]}function at(e,t){return e||t?e?t?(Wr(e)&&(e=e.join(" ")),Wr(t)&&(t=t.join(" ")),e+" "+t):e:t:""}function st(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.nodeType===Di)return n}}function ut(e){S(e)&&(e=e.split(" "));var t=me();return o(e,function(e){e.length&&(t[e]=!0)}),t}function ct(e){return x(e)?e:{}}function lt(e,t,n,r){function i(e){try{e.apply(null,z(arguments,1))}finally{if(g--,0===g)for(;b.length;)try{b.pop()()}catch(t){n.error(t)}}}function a(e){var t=e.indexOf("#");return-1===t?"":e.substr(t)}function s(){E=null,c(),l()}function u(){try{return h.state}catch(e){}}function c(){x=u(),x=y(x)?null:x,B(x,O)&&(x=O),O=x}function l(){S===f.url()&&w===x||(S=f.url(),w=x,o(A,function(e){e(f.url(),x)}))}var f=this,p=(t[0],e.location),h=e.history,d=e.setTimeout,v=e.clearTimeout,m={};f.isMock=!1;var g=0,b=[];f.$$completeOutstandingRequest=i,f.$$incOutstandingRequestCount=function(){g++},f.notifyWhenNoOutstandingRequests=function(e){0===g?e():b.push(e)};var x,w,S=p.href,C=t.find("base"),E=null;c(),w=x,f.url=function(t,n,i){if(y(i)&&(i=null),p!==e.location&&(p=e.location),h!==e.history&&(h=e.history),t){var o=w===i;if(S===t&&(!r.history||o))return f;var s=S&&Ft(S)===Ft(t);return S=t,w=i,!r.history||s&&o?(s&&!E||(E=t),n?p.replace(t):s?p.hash=a(t):p.href=t,p.href!==t&&(E=t)):(h[n?"replaceState":"pushState"](i,"",t),c(),w=x),f}return E||p.href.replace(/%27/g,"'")},f.state=function(){return x};var A=[],k=!1,O=null;f.onUrlChange=function(t){return k||(r.history&&Dr(e).on("popstate",s),Dr(e).on("hashchange",s),k=!0),A.push(t),t},f.$$applicationDestroyed=function(){Dr(e).off("hashchange popstate",s)},f.$$checkUrlChange=l,f.baseHref=function(){var e=C.attr("href");return e?e.replace(/^(https?\:)?\/\/[^\/]*/,""):""},f.defer=function(e,t){var n;return g++,n=d(function(){delete m[n],i(e)},t||0),m[n]=!0,n},f.defer.cancel=function(e){return m[e]?(delete m[e],v(e),i($),!0):!1}}function ft(){this.$get=["$window","$log","$sniffer","$document",function(e,t,n,r){return new lt(e,r,t,n)}]}function pt(){this.$get=function(){function e(e,n){function i(e){e!=p&&(h?h==e&&(h=e.n):h=e,o(e.n,e.p),o(e,p),p=e,p.n=null)}function o(e,t){e!=t&&(e&&(e.p=t),t&&(t.n=e))}if(e in t)throw r("$cacheFactory")("iid","CacheId '{0}' is already taken!",e);var a=0,s=f({},n,{id:e}),u=me(),c=n&&n.capacity||Number.MAX_VALUE,l=me(),p=null,h=null;return t[e]={put:function(e,t){if(!y(t)){if(c<Number.MAX_VALUE){var n=l[e]||(l[e]={key:e});i(n)}return e in u||a++,u[e]=t,a>c&&this.remove(h.key),t}},get:function(e){if(c<Number.MAX_VALUE){var t=l[e];if(!t)return;i(t)}return u[e]},remove:function(e){if(c<Number.MAX_VALUE){var t=l[e];if(!t)return;t==p&&(p=t.p),t==h&&(h=t.n),o(t.n,t.p),delete l[e]}e in u&&(delete u[e],a--)},removeAll:function(){u=me(),a=0,l=me(),p=h=null},destroy:function(){u=null,s=null,l=null,delete t[e]},info:function(){return f({},s,{size:a})}}}var t={};return e.info=function(){var e={};return o(t,function(t,n){e[n]=t.info()}),e},e.get=function(e){return t[e]},e}}function ht(){this.$get=["$cacheFactory",function(e){return e("templates")}]}function dt(e,r){function i(e,t,n){var r=/^\s*([@&<]|=(\*?))(\??)\s*(\w*)\s*$/,i={};return o(e,function(e,o){var a=e.match(r);if(!a)throw Bi("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",t,o,e,n?"controller bindings definition":"isolate scope definition");i[o]={mode:a[1][0],collection:"*"===a[2],optional:"?"===a[3],attrName:a[4]||o}}),i}function a(e,t){var n={isolateScope:null,bindToController:null};if(x(e.scope)&&(e.bindToController===!0?(n.bindToController=i(e.scope,t,!0),n.isolateScope={}):n.isolateScope=i(e.scope,t,!1)),x(e.bindToController)&&(n.bindToController=i(e.bindToController,t,!0)),x(n.bindToController)){var r=e.controller,o=e.controllerAs;if(!r)throw Bi("noctrl","Cannot bind to controller without directive '{0}'s controller.",t);if(!gt(r,o))throw Bi("noident","Cannot bind to controller without identifier for directive '{0}'.",t)}return n}function u(e){var t=e.charAt(0);if(!t||t!==Tr(t))throw Bi("baddir","Directive name '{0}' is invalid. The first character must be a lowercase letter",e);if(e!==e.trim())throw Bi("baddir","Directive name '{0}' is invalid. The name should not contain leading or trailing whitespaces",e)}var c={},l="Directive",p=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,h=/(([\w\-]+)(?:\:([^;]+))?;?)/,g=_("ngSrc,ngSrcset,src,srcset"),w=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,C=/^(on[a-z]+|formaction)$/;this.directive=function k(t,n){return de(t,"directive"),S(t)?(u(t),pe(n,"directiveFactory"),c.hasOwnProperty(t)||(c[t]=[],e.factory(t+l,["$injector","$exceptionHandler",function(e,n){var r=[];return o(c[t],function(i,o){try{var s=e.invoke(i);A(s)?s={compile:m(s)}:!s.compile&&s.link&&(s.compile=m(s.link)),s.priority=s.priority||0,s.index=o,s.name=s.name||t,s.require=s.require||s.controller&&s.name,s.restrict=s.restrict||"EA";var u=s.$$bindings=a(s,s.name);x(u.isolateScope)&&(s.$$isolateBindings=u.isolateScope),s.$$moduleName=i.$$moduleName,r.push(s)}catch(c){n(c)}}),r}])),c[t].push(n)):o(t,s(k)),this},this.component=function(e,t){function n(e){function n(t){return A(t)||Wr(t)?function(n,r){return e.invoke(t,this,{$element:n,$attrs:r})}:t}var i=t.template||t.templateUrl?t.template:"";return{controller:r,controllerAs:gt(t.controller)||t.controllerAs||"$ctrl",template:n(i),templateUrl:n(t.templateUrl),transclude:t.transclude,scope:{},bindToController:t.bindings||{},restrict:"E",require:t.require}}var r=t.controller||function(){};return o(t,function(e,t){"$"===t.charAt(0)&&(n[t]=e)}),n.$inject=["$injector"],this.directive(e,n)},this.aHrefSanitizationWhitelist=function(e){return b(e)?(r.aHrefSanitizationWhitelist(e),this):r.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(e){return b(e)?(r.imgSrcSanitizationWhitelist(e),this):r.imgSrcSanitizationWhitelist()};var E=!0;this.debugInfoEnabled=function(e){return b(e)?(E=e,this):E},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function(e,r,i,a,s,u,m,b,k,O){function T(e,t,n){ce.innerHTML="<span "+t+">";var r=ce.firstChild.attributes,i=r[0];r.removeNamedItem(i.name),i.value=n,e.attributes.setNamedItem(i)}function N(e,t){try{e.addClass(t)}catch(n){}}function j(e,n,r,i,o){e instanceof Dr||(e=Dr(e));for(var a=/\S+/,s=0,u=e.length;u>s;s++){var c=e[s];c.nodeType===ii&&c.nodeValue.match(a)&&Te(c,e[s]=t.createElement("span"))}var l=D(e,n,e,r,i,o);j.$$addScopeClass(e);var f=null;return function(t,n,r){pe(t,"scope"),o&&o.needsNewScope&&(t=t.$parent.$new()),r=r||{};var i=r.parentBoundTranscludeFn,a=r.transcludeControllers,s=r.futureParentElement;i&&i.$$boundTransclude&&(i=i.$$boundTransclude),f||(f=R(s));var u;if(u="html"!==f?Dr(te(f,Dr("<div>").append(e).html())):n?Si.clone.call(e):e,a)for(var c in a)u.data("$"+c+"Controller",a[c].instance);return j.$$addScopeInfo(u,t),n&&n(u,t),l&&l(t,u,u,i),u}}function R(e){var t=e&&e[0];return t&&"foreignobject"!==U(t)&&Fr.call(t).match(/SVG/)?"svg":"html"}function D(e,t,r,i,o,a){function s(e,r,i,o){var a,s,u,c,l,f,p,h,v;if(d){var m=r.length;for(v=new Array(m),l=0;l<$.length;l+=3)p=$[l],v[p]=r[p]}else v=r;for(l=0,f=$.length;f>l;)u=v[$[l++]],a=$[l++],s=$[l++],a?(a.scope?(c=e.$new(),j.$$addScopeInfo(Dr(u),c)):c=e,h=a.transcludeOnThisElement?I(e,a.transclude,o):!a.templateOnThisElement&&o?o:!o&&t?I(e,t):null,a(s,c,u,i,h)):s&&s(e,u.childNodes,n,o)}for(var u,c,l,f,p,h,d,$=[],v=0;v<e.length;v++)u=new fe,c=P(e[v],[],u,0===v?i:n,o),l=c.length?H(c,e[v],u,t,r,null,[],[],a):null,l&&l.scope&&j.$$addScopeClass(u.$$element),p=l&&l.terminal||!(f=e[v].childNodes)||!f.length?null:D(f,l?(l.transcludeOnThisElement||!l.templateOnThisElement)&&l.transclude:t),(l||p)&&($.push(v,l,p),h=!0,d=d||l),a=null;return h?s:null}function I(e,t,n){var r=function(r,i,o,a,s){return r||(r=e.$new(!1,s),r.$$transcluded=!0),t(r,i,{parentBoundTranscludeFn:n,transcludeControllers:o,futureParentElement:a})},i=r.$$slots=me();for(var o in t.$$slots)t.$$slots[o]?i[o]=I(e,t.$$slots[o],n):i[o]=null;return r}function P(e,t,n,r,i){var o,a,s=e.nodeType,u=n.$attr;switch(s){case ni:G(t,$t(U(e)),"E",r,i);for(var c,l,f,d,$,v,m=e.attributes,g=0,y=m&&m.length;y>g;g++){var b=!1,w=!1;c=m[g],l=c.name,$=Jr(c.value),d=$t(l),(v=ve.test(d))&&(l=l.replace(Hi,"").substr(8).replace(/_(.)/g,function(e,t){return t.toUpperCase()}));var C=d.match(ge);C&&J(C[1])&&(b=l,w=l.substr(0,l.length-5)+"end",l=l.substr(0,l.length-6)),f=$t(l.toLowerCase()),u[f]=l,!v&&n.hasOwnProperty(f)||(n[f]=$,Ge(e,f)&&(n[f]=!0)),re(e,t,$,f,v),G(t,f,"A",r,i,b,w)}if(a=e.className,x(a)&&(a=a.animVal),S(a)&&""!==a)for(;o=h.exec(a);)f=$t(o[2]),G(t,f,"C",r,i)&&(n[f]=Jr(o[3])),a=a.substr(o.index+o[0].length);break;case ii:if(11===Rr)for(;e.parentNode&&e.nextSibling&&e.nextSibling.nodeType===ii;)e.nodeValue=e.nodeValue+e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);ee(t,e.nodeValue);break;case oi:try{o=p.exec(e.nodeValue),o&&(f=$t(o[1]),G(t,f,"M",r,i)&&(n[f]=Jr(o[2])))}catch(E){}}return t.sort(Z),t}function _(e,t,n){var r=[],i=0;if(t&&e.hasAttribute&&e.hasAttribute(t)){do{if(!e)throw Bi("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",t,n);e.nodeType==ni&&(e.hasAttribute(t)&&i++,e.hasAttribute(n)&&i--),r.push(e),e=e.nextSibling}while(i>0)}else r.push(e);return Dr(r)}function F(e,t,n){return function(r,i,o,a,s){return i=_(i[0],t,n),e(r,i,o,a,s)}}function L(e,t,n,r,i,o){if(e)return j(t,n,r,i,o);var a;return function(){return a||(a=j(t,n,r,i,o),t=n=o=null),a.apply(this,arguments)}}function H(e,r,a,s,c,l,p,h,d){function $(e,t,n,r){e&&(n&&(e=F(e,n,r)),e.require=b.require,e.directiveName=C,(R===b||b.$$isolateScope)&&(e=oe(e,{isolateScope:!0})),p.push(e)),t&&(n&&(t=F(t,n,r)),t.require=b.require,t.directiveName=C,(R===b||b.$$isolateScope)&&(t=oe(t,{isolateScope:!0})),h.push(t))}function v(e,t,n,r){var i;if(S(t)){var a=t.match(w),s=t.substring(a[0].length),u=a[1]||a[3],c="?"===a[2];
if("^^"===u?n=n.parent():(i=r&&r[s],i=i&&i.instance),!i){var l="$"+s+"Controller";i=u?n.inheritedData(l):n.data(l)}if(!i&&!c)throw Bi("ctreq","Controller '{0}', required by directive '{1}', can't be found!",s,e)}else if(Wr(t)){i=[];for(var f=0,p=t.length;p>f;f++)i[f]=v(e,t[f],n,r)}else x(t)&&(i={},o(t,function(t,o){i[o]=v(e,t,n,r)}));return i||null}function m(e,t,n,r,i,o){var a=me();for(var s in r){var c=r[s],l={$scope:c===R||c.$$isolateScope?i:o,$element:e,$attrs:t,$transclude:n},f=c.controller;"@"==f&&(f=t[c.name]);var p=u(f,l,!0,c.controllerAs);a[c.name]=p,H||e.data("$"+c.name+"Controller",p.instance)}return a}function g(e,t,i,s,u){function c(e,t,r,i){var o;if(M(e)||(i=r,r=t,t=e,e=n),H&&(o=w),r||(r=H?C.parent():C),!i)return u(e,t,o,r,q);var a=u.$$slots[i];if(a)return a(e,t,o,r,q);if(y(a))throw Bi("noslot",'No parent directive that requires a transclusion with slot name "{0}". Element: {1}',i,Q(C))}var l,d,$,g,b,w,S,C,E,k,O;r===i?(E=a,C=a.$$element):(C=Dr(i),E=new fe(C,a)),b=t,R?g=t.$new(!0):N&&(b=t.$parent),u&&(S=c,S.$$boundTransclude=u,S.isSlotFilled=function(e){return!!u.$$slots[e]}),V&&(w=m(C,E,S,V,g,t)),R&&(j.$$addScopeInfo(C,g,!0,!(D&&(D===R||D===R.$$originalDirective))),j.$$addScopeClass(C,!0),g.$$isolateBindings=R.$$isolateBindings,k=se(t,E,g,g.$$isolateBindings,R),k&&g.$on("$destroy",k));for(var T in w){var I=V[T],P=w[T],_=I.$$bindings.bindToController;P.identifier&&_&&(O=se(b,E,P.instance,_,I));var U=P();U!==P.instance&&(P.instance=U,C.data("$"+I.name+"Controller",U),O&&O(),O=se(b,E,P.instance,_,I))}for(o(V,function(e,t){var n=e.require;e.bindToController&&!Wr(n)&&x(n)&&f(w[t].instance,v(t,n,C,w))}),o(w,function(e){A(e.instance.$onInit)&&e.instance.$onInit()}),l=0,d=p.length;d>l;l++)$=p[l],ae($,$.isolateScope?g:t,C,E,$.require&&v($.directiveName,$.require,C,w),S);var q=t;for(R&&(R.template||null===R.templateUrl)&&(q=g),e&&e(q,i.childNodes,n,u),l=h.length-1;l>=0;l--)$=h[l],ae($,$.isolateScope?g:t,C,E,$.require&&v($.directiveName,$.require,C,w),S)}d=d||{};for(var b,C,E,k,O,T=-Number.MAX_VALUE,N=d.newScopeDirective,V=d.controllerDirectives,R=d.newIsolateScopeDirective,D=d.templateDirective,I=d.nonTlbTranscludeDirective,q=!1,B=!1,H=d.hasElementTranscludeDirective,G=a.$$element=Dr(r),J=l,Z=s,ee=!1,ne=!1,re=0,ue=e.length;ue>re;re++){b=e[re];var ce=b.$$start,le=b.$$end;if(ce&&(G=_(r,ce,le)),E=n,T>b.priority)break;if((O=b.scope)&&(b.templateUrl||(x(O)?(X("new/isolated scope",R||N,b,G),R=b):X("new/isolated scope",R,b,G)),N=N||b),C=b.name,!ee&&(b.replace&&(b.templateUrl||b.template)||b.transclude&&!b.$$tlb)){for(var pe,he=re+1;pe=e[he++];)if(pe.transclude&&!pe.$$tlb||pe.replace&&(pe.templateUrl||pe.template)){ne=!0;break}ee=!0}if(!b.templateUrl&&b.controller&&(O=b.controller,V=V||me(),X("'"+C+"' controller",V[C],b,G),V[C]=b),O=b.transclude)if(q=!0,b.$$tlb||(X("transclusion",I,b,G),I=b),"element"==O)H=!0,T=b.priority,E=G,G=a.$$element=Dr(t.createComment(" "+C+": "+a[C]+" ")),r=G[0],ie(c,z(E),r),Z=L(ne,E,s,T,J&&J.name,{nonTlbTranscludeDirective:I});else{var de=me();if(E=Dr(je(r)).contents(),x(O)){E=[];var ve=me(),ge=me();o(O,function(e,t){var n="?"===e.charAt(0);e=n?e.substring(1):e,ve[e]=t,de[t]=null,ge[t]=n}),o(G.contents(),function(e){var t=ve[$t(U(e))];t?(ge[t]=!0,de[t]=de[t]||[],de[t].push(e)):E.push(e)}),o(ge,function(e,t){if(!e)throw Bi("reqslot","Required transclusion slot `{0}` was not filled.",t)});for(var ye in de)de[ye]&&(de[ye]=L(ne,de[ye],s))}G.empty(),Z=L(ne,E,s,n,n,{needsNewScope:b.$$isolateScope||b.$$newScope}),Z.$$slots=de}if(b.template)if(B=!0,X("template",D,b,G),D=b,O=A(b.template)?b.template(G,a):b.template,O=$e(O),b.replace){if(J=b,E=Ce(O)?[]:mt(te(b.templateNamespace,Jr(O))),r=E[0],1!=E.length||r.nodeType!==ni)throw Bi("tplrt","Template for directive '{0}' must have exactly one root element. {1}",C,"");ie(c,G,r);var be={$attr:{}},xe=P(r,[],be),we=e.splice(re+1,e.length-(re+1));(R||N)&&W(xe,R,N),e=e.concat(xe).concat(we),Y(a,be),ue=e.length}else G.html(O);if(b.templateUrl)B=!0,X("template",D,b,G),D=b,b.replace&&(J=b),g=K(e.splice(re,e.length-re),G,a,c,q&&Z,p,h,{controllerDirectives:V,newScopeDirective:N!==b&&N,newIsolateScopeDirective:R,templateDirective:D,nonTlbTranscludeDirective:I}),ue=e.length;else if(b.compile)try{k=b.compile(G,a,Z),A(k)?$(null,k,ce,le):k&&$(k.pre,k.post,ce,le)}catch(Se){i(Se,Q(G))}b.terminal&&(g.terminal=!0,T=Math.max(T,b.priority))}return g.scope=N&&N.scope===!0,g.transcludeOnThisElement=q,g.templateOnThisElement=B,g.transclude=Z,d.hasElementTranscludeDirective=H,g}function W(e,t,n){for(var r=0,i=e.length;i>r;r++)e[r]=d(e[r],{$$isolateScope:t,$$newScope:n})}function G(t,n,r,o,a,s,u){if(n===a)return null;var f=null;if(c.hasOwnProperty(n))for(var p,h=e.get(n+l),$=0,v=h.length;v>$;$++)try{p=h[$],(y(o)||o>p.priority)&&-1!=p.restrict.indexOf(r)&&(s&&(p=d(p,{$$start:s,$$end:u})),t.push(p),f=p)}catch(m){i(m)}return f}function J(t){if(c.hasOwnProperty(t))for(var n,r=e.get(t+l),i=0,o=r.length;o>i;i++)if(n=r[i],n.multiElement)return!0;return!1}function Y(e,t){var n=t.$attr,r=e.$attr,i=e.$$element;o(e,function(r,i){"$"!=i.charAt(0)&&(t[i]&&t[i]!==r&&(r+=("style"===i?";":" ")+t[i]),e.$set(i,r,!0,n[i]))}),o(t,function(t,o){"class"==o?(N(i,t),e["class"]=(e["class"]?e["class"]+" ":"")+t):"style"==o?(i.attr("style",i.attr("style")+";"+t),e.style=(e.style?e.style+";":"")+t):"$"==o.charAt(0)||e.hasOwnProperty(o)||(e[o]=t,r[o]=n[o])})}function K(e,t,n,r,i,s,u,c){var l,f,p=[],h=t[0],$=e.shift(),v=d($,{templateUrl:null,transclude:null,replace:null,$$originalDirective:$}),m=A($.templateUrl)?$.templateUrl(t,n):$.templateUrl,g=$.templateNamespace;return t.empty(),a(m).then(function(a){var d,y,b,w;if(a=$e(a),$.replace){if(b=Ce(a)?[]:mt(te(g,Jr(a))),d=b[0],1!=b.length||d.nodeType!==ni)throw Bi("tplrt","Template for directive '{0}' must have exactly one root element. {1}",$.name,m);y={$attr:{}},ie(r,t,d);var S=P(d,[],y);x($.scope)&&W(S,!0),e=S.concat(e),Y(n,y)}else d=h,t.html(a);for(e.unshift(v),l=H(e,d,n,i,t,$,s,u,c),o(r,function(e,n){e==d&&(r[n]=t[0])}),f=D(t[0].childNodes,i);p.length;){var C=p.shift(),E=p.shift(),A=p.shift(),k=p.shift(),O=t[0];if(!C.$$destroyed){if(E!==h){var M=E.className;c.hasElementTranscludeDirective&&$.replace||(O=je(d)),ie(A,Dr(E),O),N(Dr(O),M)}w=l.transcludeOnThisElement?I(C,l.transclude,k):k,l(f,C,O,r,w)}}p=null}),function(e,t,n,r,i){var o=i;t.$$destroyed||(p?p.push(t,n,r,o):(l.transcludeOnThisElement&&(o=I(t,l.transclude,i)),l(f,t,n,r,o)))}}function Z(e,t){var n=t.priority-e.priority;return 0!==n?n:e.name!==t.name?e.name<t.name?-1:1:e.index-t.index}function X(e,t,n,r){function i(e){return e?" (module: "+e+")":""}if(t)throw Bi("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",t.name,i(t.$$moduleName),n.name,i(n.$$moduleName),e,Q(r))}function ee(e,t){var n=r(t,!0);n&&e.push({priority:0,compile:function(e){var t=e.parent(),r=!!t.length;return r&&j.$$addBindingClass(t),function(e,t){var i=t.parent();r||j.$$addBindingClass(i),j.$$addBindingInfo(i,n.expressions),e.$watch(n,function(e){t[0].nodeValue=e})}}})}function te(e,n){switch(e=Tr(e||"html")){case"svg":case"math":var r=t.createElement("div");return r.innerHTML="<"+e+">"+n+"</"+e+">",r.childNodes[0].childNodes;default:return n}}function ne(e,t){if("srcdoc"==t)return b.HTML;var n=U(e);return"xlinkHref"==t||"form"==n&&"action"==t||"img"!=n&&("src"==t||"ngSrc"==t)?b.RESOURCE_URL:void 0}function re(e,t,n,i,o){var a=ne(e,i);o=g[i]||o;var s=r(n,!0,a,o);if(s){if("multiple"===i&&"select"===U(e))throw Bi("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",Q(e));t.push({priority:100,compile:function(){return{pre:function(e,t,u){var c=u.$$observers||(u.$$observers=me());if(C.test(i))throw Bi("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var l=u[i];l!==n&&(s=l&&r(l,!0,a,o),n=l),s&&(u[i]=s(e),(c[i]||(c[i]=[])).$$inter=!0,(u.$$observers&&u.$$observers[i].$$scope||e).$watch(s,function(e,t){"class"===i&&e!=t?u.$updateClass(e,t):u.$set(i,e)}))}}}})}}function ie(e,n,r){var i,o,a=n[0],s=n.length,u=a.parentNode;if(e)for(i=0,o=e.length;o>i;i++)if(e[i]==a){e[i++]=r;for(var c=i,l=c+s-1,f=e.length;f>c;c++,l++)f>l?e[c]=e[l]:delete e[c];e.length-=s-1,e.context===a&&(e.context=r);break}u&&u.replaceChild(r,a);var p=t.createDocumentFragment();for(i=0;s>i;i++)p.appendChild(n[i]);for(Dr.hasData(a)&&(Dr.data(r,Dr.data(a)),Dr(a).off("$destroy")),Dr.cleanData(p.querySelectorAll("*")),i=1;s>i;i++)delete n[i];n[0]=r,n.length=1}function oe(e,t){return f(function(){return e.apply(null,arguments)},e,t)}function ae(e,t,n,r,o,a){try{e(t,n,r,o,a)}catch(s){i(s,Q(n))}}function se(e,t,n,i,a){var u=[];return o(i,function(i,o){var c,l,f,p,h,d=i.attrName,v=i.optional,m=i.mode;switch(m){case"@":v||Mr.call(t,d)||(n[o]=t[d]=void 0),t.$observe(d,function(e){S(e)&&(n[o]=e)}),t.$$observers[d].$$scope=e,c=t[d],S(c)?n[o]=r(c)(e):V(c)&&(n[o]=c);break;case"=":if(!Mr.call(t,d)){if(v)break;t[d]=void 0}if(v&&!t[d])break;l=s(t[d]),p=l.literal?B:function(e,t){return e===t||e!==e&&t!==t},f=l.assign||function(){throw c=n[o]=l(e),Bi("nonassign","Expression '{0}' in attribute '{1}' used with directive '{2}' is non-assignable!",t[d],d,a.name)},c=n[o]=l(e);var g=function(t){return p(t,n[o])||(p(t,c)?f(e,t=n[o]):n[o]=t),c=t};g.$stateful=!0,h=i.collection?e.$watchCollection(t[d],g):e.$watch(s(t[d],g),null,l.literal),u.push(h);break;case"<":if(!Mr.call(t,d)){if(v)break;t[d]=void 0}if(v&&!t[d])break;l=s(t[d]),n[o]=l(e),h=e.$watch(l,function(e){n[o]=e},l.literal),u.push(h);break;case"&":if(l=t.hasOwnProperty(d)?s(t[d]):$,l===$&&v)break;n[o]=function(t){return l(e,t)}}}),u.length&&function(){for(var e=0,t=u.length;t>e;++e)u[e]()}}var ue=/^\w/,ce=t.createElement("div"),fe=function(e,t){if(t){var n,r,i,o=Object.keys(t);for(n=0,r=o.length;r>n;n++)i=o[n],this[i]=t[i]}else this.$attr={};this.$$element=e};fe.prototype={$normalize:$t,$addClass:function(e){e&&e.length>0&&k.addClass(this.$$element,e)},$removeClass:function(e){e&&e.length>0&&k.removeClass(this.$$element,e)},$updateClass:function(e,t){var n=vt(e,t);n&&n.length&&k.addClass(this.$$element,n);var r=vt(t,e);r&&r.length&&k.removeClass(this.$$element,r)},$set:function(e,t,n,r){var a,s=this.$$element[0],u=Ge(s,e),c=Je(e),l=e;if(u?(this.$$element.prop(e,t),r=u):c&&(this[c]=t,l=c),this[e]=t,r?this.$attr[e]=r:(r=this.$attr[e],r||(this.$attr[e]=r=le(e,"-"))),a=U(this.$$element),"a"===a&&("href"===e||"xlinkHref"===e)||"img"===a&&"src"===e)this[e]=t=O(t,"src"===e);else if("img"===a&&"srcset"===e){for(var f="",p=Jr(t),h=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,d=/\s/.test(p)?h:/(,)/,$=p.split(d),v=Math.floor($.length/2),m=0;v>m;m++){var g=2*m;f+=O(Jr($[g]),!0),f+=" "+Jr($[g+1])}var b=Jr($[2*m]).split(/\s/);f+=O(Jr(b[0]),!0),2===b.length&&(f+=" "+Jr(b[1])),this[e]=t=f}n!==!1&&(null===t||y(t)?this.$$element.removeAttr(r):ue.test(r)?this.$$element.attr(r,t):T(this.$$element[0],r,t));var x=this.$$observers;x&&o(x[l],function(e){try{e(t)}catch(n){i(n)}})},$observe:function(e,t){var n=this,r=n.$$observers||(n.$$observers=me()),i=r[e]||(r[e]=[]);return i.push(t),m.$evalAsync(function(){i.$$inter||!n.hasOwnProperty(e)||y(n[e])||t(n[e])}),function(){q(i,t)}}};var he=r.startSymbol(),de=r.endSymbol(),$e="{{"==he&&"}}"==de?v:function(e){return e.replace(/\{\{/g,he).replace(/}}/g,de)},ve=/^ngAttr[A-Z]/,ge=/^(.+)Start$/;return j.$$addBindingInfo=E?function(e,t){var n=e.data("$binding")||[];Wr(t)?n=n.concat(t):n.push(t),e.data("$binding",n)}:$,j.$$addBindingClass=E?function(e){N(e,"ng-binding")}:$,j.$$addScopeInfo=E?function(e,t,n,r){var i=n?r?"$isolateScopeNoTemplate":"$isolateScope":"$scope";e.data(i,t)}:$,j.$$addScopeClass=E?function(e,t){N(e,t?"ng-isolate-scope":"ng-scope")}:$,j}]}function $t(e){return Se(e.replace(Hi,""))}function vt(e,t){var n="",r=e.split(/\s+/),i=t.split(/\s+/);e:for(var o=0;o<r.length;o++){for(var a=r[o],s=0;s<i.length;s++)if(a==i[s])continue e;n+=(n.length>0?" ":"")+a}return n}function mt(e){e=Dr(e);var t=e.length;if(1>=t)return e;for(;t--;){var n=e[t];n.nodeType===oi&&Ur.call(e,t,1)}return e}function gt(e,t){if(t&&S(t))return t;if(S(e)){var n=Wi.exec(e);if(n)return n[3]}}function yt(){var e={},t=!1;this.register=function(t,n){de(t,"controller"),x(t)?f(e,t):e[t]=n},this.allowGlobals=function(){t=!0},this.$get=["$injector","$window",function(i,o){function a(e,t,n,i){if(!e||!x(e.$scope))throw r("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",i,t);e.$scope[t]=n}return function(r,s,u,c){var l,p,h,d;if(u=u===!0,c&&S(c)&&(d=c),S(r)){if(p=r.match(Wi),!p)throw zi("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",r);h=p[1],d=d||p[3],r=e.hasOwnProperty(h)?e[h]:$e(s.$scope,h,!0)||(t?$e(o,h,!0):n),he(r,h,!0)}if(u){var $=(Wr(r)?r[r.length-1]:r).prototype;l=Object.create($||null),d&&a(s,d,l,h||r.name);var v;return v=f(function(){var e=i.invoke(r,l,s,h);return e!==l&&(x(e)||A(e))&&(l=e,d&&a(s,d,l,h||r.name)),l},{instance:l,identifier:d})}return l=i.instantiate(r,s,h),d&&a(s,d,l,h||r.name),l}}]}function bt(){this.$get=["$window",function(e){return Dr(e.document)}]}function xt(){this.$get=["$log",function(e){return function(t,n){e.error.apply(e,arguments)}}]}function wt(e){return x(e)?E(e)?e.toISOString():J(e):e}function St(){this.$get=function(){return function(e){if(!e)return"";var t=[];return a(e,function(e,n){null===e||y(e)||(Wr(e)?o(e,function(e,r){t.push(ie(n)+"="+ie(wt(e)))}):t.push(ie(n)+"="+ie(wt(e))))}),t.join("&")}}}function Ct(){this.$get=function(){return function(e){function t(e,r,i){null===e||y(e)||(Wr(e)?o(e,function(e,n){t(e,r+"["+(x(e)?n:"")+"]")}):x(e)&&!E(e)?a(e,function(e,n){t(e,r+(i?"":"[")+n+(i?"":"]"))}):n.push(ie(r)+"="+ie(wt(e))))}if(!e)return"";var n=[];return t(e,"",!0),n.join("&")}}}function Et(e,t){if(S(e)){var n=e.replace(Xi,"").trim();if(n){var r=t("Content-Type");(r&&0===r.indexOf(Ji)||At(n))&&(e=Y(n))}}return e}function At(e){var t=e.match(Ki);return t&&Zi[t[0]].test(e)}function kt(e){function t(e,t){e&&(r[e]=r[e]?r[e]+", "+t:t)}var n,r=me();return S(e)?o(e.split("\n"),function(e){n=e.indexOf(":"),t(Tr(Jr(e.substr(0,n))),Jr(e.substr(n+1)))}):x(e)&&o(e,function(e,n){t(Tr(n),Jr(e))}),r}function Ot(e){var t;return function(n){if(t||(t=kt(e)),n){var r=t[Tr(n)];return void 0===r&&(r=null),r}return t}}function Mt(e,t,n,r){return A(r)?r(e,t,n):(o(r,function(r){e=r(e,t,n)}),e)}function Tt(e){return e>=200&&300>e}function Nt(){var e=this.defaults={transformResponse:[Et],transformRequest:[function(e){return!x(e)||T(e)||j(e)||N(e)?e:J(e)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:L(Yi),put:L(Yi),patch:L(Yi)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},t=!1;this.useApplyAsync=function(e){return b(e)?(t=!!e,this):t};var i=!0;this.useLegacyPromiseExtensions=function(e){return b(e)?(i=!!e,this):i};var a=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function(s,u,c,l,p,h){function d(t){function a(e){var t=f({},e);return t.data=Mt(e.data,e.headers,e.status,c.transformResponse),Tt(e.status)?t:p.reject(t)}function s(e,t){var n,r={};return o(e,function(e,i){A(e)?(n=e(t),null!=n&&(r[i]=n)):r[i]=e}),r}function u(t){var n,r,i,o=e.headers,a=f({},t.headers);o=f({},o.common,o[Tr(t.method)]);e:for(n in o){r=Tr(n);for(i in a)if(Tr(i)===r)continue e;a[n]=o[n]}return s(a,L(t))}if(!x(t))throw r("$http")("badreq","Http request configuration must be an object.  Received: {0}",t);if(!S(t.url))throw r("$http")("badreq","Http request configuration url must be a string.  Received: {0}",t.url);var c=f({method:"get",transformRequest:e.transformRequest,transformResponse:e.transformResponse,paramSerializer:e.paramSerializer},t);c.headers=u(t),c.method=Nr(c.method),c.paramSerializer=S(c.paramSerializer)?h.get(c.paramSerializer):c.paramSerializer;var l=function(t){var r=t.headers,i=Mt(t.data,Ot(r),n,t.transformRequest);return y(i)&&o(r,function(e,t){"content-type"===Tr(t)&&delete r[t]}),y(t.withCredentials)&&!y(e.withCredentials)&&(t.withCredentials=e.withCredentials),m(t,i).then(a,a)},d=[l,n],$=p.when(c);for(o(C,function(e){(e.request||e.requestError)&&d.unshift(e.request,e.requestError),(e.response||e.responseError)&&d.push(e.response,e.responseError)});d.length;){var v=d.shift(),g=d.shift();$=$.then(v,g)}return i?($.success=function(e){return he(e,"fn"),$.then(function(t){e(t.data,t.status,t.headers,c)}),$},$.error=function(e){return he(e,"fn"),$.then(null,function(t){e(t.data,t.status,t.headers,c)}),$}):($.success=eo("success"),$.error=eo("error")),$}function $(e){o(arguments,function(e){d[e]=function(t,n){return d(f({},n||{},{method:e,url:t}))}})}function v(e){o(arguments,function(e){d[e]=function(t,n,r){return d(f({},r||{},{method:e,url:t,data:n}))}})}function m(r,i){function o(e,n,r,i){function o(){a(n,e,r,i)}h&&(Tt(e)?h.put(C,[e,n,kt(r),i]):h.remove(C)),t?l.$applyAsync(o):(o(),l.$$phase||l.$apply())}function a(e,t,n,i){t=t>=-1?t:0,(Tt(t)?v.resolve:v.reject)({data:e,status:t,headers:Ot(n),config:r,statusText:i})}function c(e){a(e.data,e.status,L(e.headers()),e.statusText)}function f(){var e=d.pendingRequests.indexOf(r);-1!==e&&d.pendingRequests.splice(e,1)}var h,$,v=p.defer(),m=v.promise,S=r.headers,C=g(r.url,r.paramSerializer(r.params));if(d.pendingRequests.push(r),m.then(f,f),!r.cache&&!e.cache||r.cache===!1||"GET"!==r.method&&"JSONP"!==r.method||(h=x(r.cache)?r.cache:x(e.cache)?e.cache:w),h&&($=h.get(C),b($)?R($)?$.then(c,c):Wr($)?a($[1],$[0],L($[2]),$[3]):a($,200,{},"OK"):h.put(C,m)),y($)){var E=Vn(r.url)?u()[r.xsrfCookieName||e.xsrfCookieName]:n;E&&(S[r.xsrfHeaderName||e.xsrfHeaderName]=E),s(r.method,C,i,o,S,r.timeout,r.withCredentials,r.responseType)}return m}function g(e,t){return t.length>0&&(e+=(-1==e.indexOf("?")?"?":"&")+t),e}var w=c("$http");e.paramSerializer=S(e.paramSerializer)?h.get(e.paramSerializer):e.paramSerializer;var C=[];return o(a,function(e){C.unshift(S(e)?h.get(e):h.invoke(e))}),d.pendingRequests=[],$("get","delete","head","jsonp"),v("post","put","patch"),d.defaults=e,d}]}function jt(){this.$get=function(){return function(){return new e.XMLHttpRequest}}}function Vt(){this.$get=["$browser","$window","$document","$xhrFactory",function(e,t,n,r){return Rt(e,r,e.defer,t.angular.callbacks,n[0])}]}function Rt(e,t,n,r,i){function a(e,t,n){var o=i.createElement("script"),a=null;return o.type="text/javascript",o.src=e,o.async=!0,a=function(e){pi(o,"load",a),pi(o,"error",a),i.body.removeChild(o),o=null;var s=-1,u="unknown";e&&("load"!==e.type||r[t].called||(e={type:"error"}),u=e.type,s="error"===e.type?404:200),n&&n(s,u)},fi(o,"load",a),fi(o,"error",a),i.body.appendChild(o),a}return function(i,s,u,c,l,f,p,h){function d(){g&&g(),x&&x.abort()}function v(t,r,i,o,a){b(C)&&n.cancel(C),g=x=null,t(r,i,o,a),e.$$completeOutstandingRequest($)}if(e.$$incOutstandingRequestCount(),s=s||e.url(),"jsonp"==Tr(i)){var m="_"+(r.counter++).toString(36);r[m]=function(e){r[m].data=e,r[m].called=!0};var g=a(s.replace("JSON_CALLBACK","angular.callbacks."+m),m,function(e,t){v(c,e,r[m].data,"",t),r[m]=$})}else{var x=t(i,s);x.open(i,s,!0),o(l,function(e,t){b(e)&&x.setRequestHeader(t,e)}),x.onload=function(){var e=x.statusText||"",t="response"in x?x.response:x.responseText,n=1223===x.status?204:x.status;0===n&&(n=t?200:"file"==jn(s).protocol?404:0),v(c,n,t,x.getAllResponseHeaders(),e)};var w=function(){v(c,-1,null,null,"")};if(x.onerror=w,x.onabort=w,p&&(x.withCredentials=!0),h)try{x.responseType=h}catch(S){if("json"!==h)throw S}x.send(y(u)?null:u)}if(f>0)var C=n(d,f);else R(f)&&f.then(d)}}function Dt(){var e="{{",t="}}";this.startSymbol=function(t){return t?(e=t,this):e},this.endSymbol=function(e){return e?(t=e,this):t},this.$get=["$parse","$exceptionHandler","$sce",function(n,r,i){function o(e){return"\\\\\\"+e}function a(n){return n.replace(h,e).replace(d,t)}function s(e){if(null==e)return"";switch(typeof e){case"string":break;case"number":e=""+e;break;default:e=J(e)}return e}function u(e,t,n,r){var i;return i=e.$watch(function(e){return i(),r(e)},t,n)}function c(o,c,h,d){function $(e){try{return e=j(e),d&&!b(e)?e:s(e)}catch(t){r(to.interr(o,t))}}if(!o.length||-1===o.indexOf(e)){var v;if(!c){var g=a(o);v=m(g),v.exp=o,v.expressions=[],v.$$watchDelegate=u}return v}d=!!d;for(var x,w,S,C=0,E=[],k=[],O=o.length,M=[],T=[];O>C;){if(-1==(x=o.indexOf(e,C))||-1==(w=o.indexOf(t,x+l))){C!==O&&M.push(a(o.substring(C)));break}C!==x&&M.push(a(o.substring(C,x))),S=o.substring(x+l,w),E.push(S),k.push(n(S,$)),C=w+p,T.push(M.length),M.push("")}if(h&&M.length>1&&to.throwNoconcat(o),!c||E.length){var N=function(e){for(var t=0,n=E.length;n>t;t++){if(d&&y(e[t]))return;M[T[t]]=e[t]}return M.join("")},j=function(e){return h?i.getTrusted(h,e):i.valueOf(e)};return f(function(e){var t=0,n=E.length,i=new Array(n);try{for(;n>t;t++)i[t]=k[t](e);return N(i)}catch(a){r(to.interr(o,a))}},{exp:o,expressions:E,$$watchDelegate:function(e,t){var n;return e.$watchGroup(k,function(r,i){var o=N(r);A(t)&&t.call(this,o,r!==i?n:o,e),n=o})}})}}var l=e.length,p=t.length,h=new RegExp(e.replace(/./g,o),"g"),d=new RegExp(t.replace(/./g,o),"g");return c.startSymbol=function(){return e},c.endSymbol=function(){return t},c}]}function It(){this.$get=["$rootScope","$window","$q","$$q","$browser",function(e,t,n,r,i){function o(o,s,u,c){function l(){f?o.apply(null,p):o($)}var f=arguments.length>4,p=f?z(arguments,4):[],h=t.setInterval,d=t.clearInterval,$=0,v=b(c)&&!c,m=(v?r:n).defer(),g=m.promise;return u=b(u)?u:0,g.$$intervalId=h(function(){v?i.defer(l):e.$evalAsync(l),m.notify($++),u>0&&$>=u&&(m.resolve($),d(g.$$intervalId),delete a[g.$$intervalId]),v||e.$apply()},s),a[g.$$intervalId]=m,g}var a={};return o.cancel=function(e){return e&&e.$$intervalId in a?(a[e.$$intervalId].reject("canceled"),t.clearInterval(e.$$intervalId),delete a[e.$$intervalId],!0):!1},o}]}function Pt(e){for(var t=e.split("/"),n=t.length;n--;)t[n]=re(t[n]);return t.join("/")}function _t(e,t){var n=jn(e);t.$$protocol=n.protocol,t.$$host=n.hostname,t.$$port=h(n.port)||ro[n.protocol]||null}function Ut(e,t){var n="/"!==e.charAt(0);n&&(e="/"+e);var r=jn(e);t.$$path=decodeURIComponent(n&&"/"===r.pathname.charAt(0)?r.pathname.substring(1):r.pathname),t.$$search=te(r.search),t.$$hash=decodeURIComponent(r.hash),t.$$path&&"/"!=t.$$path.charAt(0)&&(t.$$path="/"+t.$$path)}function qt(e,t){return 0===t.indexOf(e)?t.substr(e.length):void 0}function Ft(e){var t=e.indexOf("#");return-1==t?e:e.substr(0,t)}function Lt(e){return e.replace(/(#.+)|#$/,"$1")}function Bt(e){return e.substr(0,Ft(e).lastIndexOf("/")+1)}function Ht(e){return e.substring(0,e.indexOf("/",e.indexOf("//")+2))}function zt(e,t,n){this.$$html5=!0,n=n||"",_t(e,this),this.$$parse=function(e){var n=qt(t,e);if(!S(n))throw io("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',e,t);Ut(n,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var e=ne(this.$$search),n=this.$$hash?"#"+re(this.$$hash):"";this.$$url=Pt(this.$$path)+(e?"?"+e:"")+n,this.$$absUrl=t+this.$$url.substr(1)},this.$$parseLinkUrl=function(r,i){if(i&&"#"===i[0])return this.hash(i.slice(1)),!0;var o,a,s;return b(o=qt(e,r))?(a=o,s=b(o=qt(n,o))?t+(qt("/",o)||o):e+a):b(o=qt(t,r))?s=t+o:t==r+"/"&&(s=t),s&&this.$$parse(s),!!s}}function Wt(e,t,n){_t(e,this),this.$$parse=function(r){function i(e,t,n){var r,i=/^\/[A-Z]:(\/.*)/;return 0===t.indexOf(n)&&(t=t.replace(n,"")),i.exec(t)?e:(r=i.exec(e),r?r[1]:e)}var o,a=qt(e,r)||qt(t,r);y(a)||"#"!==a.charAt(0)?this.$$html5?o=a:(o="",y(a)&&(e=r,this.replace())):(o=qt(n,a),y(o)&&(o=a)),Ut(o,this),this.$$path=i(this.$$path,o,e),this.$$compose()},this.$$compose=function(){var t=ne(this.$$search),r=this.$$hash?"#"+re(this.$$hash):"";this.$$url=Pt(this.$$path)+(t?"?"+t:"")+r,this.$$absUrl=e+(this.$$url?n+this.$$url:"")},this.$$parseLinkUrl=function(t,n){return Ft(e)==Ft(t)?(this.$$parse(t),!0):!1}}function Gt(e,t,n){this.$$html5=!0,Wt.apply(this,arguments),this.$$parseLinkUrl=function(r,i){if(i&&"#"===i[0])return this.hash(i.slice(1)),!0;var o,a;return e==Ft(r)?o=r:(a=qt(t,r))?o=e+n+a:t===r+"/"&&(o=t),o&&this.$$parse(o),!!o},this.$$compose=function(){var t=ne(this.$$search),r=this.$$hash?"#"+re(this.$$hash):"";this.$$url=Pt(this.$$path)+(t?"?"+t:"")+r,this.$$absUrl=e+n+this.$$url}}function Jt(e){return function(){return this[e]}}function Yt(e,t){return function(n){return y(n)?this[e]:(this[e]=t(n),this.$$compose(),this)}}function Kt(){var e="",t={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(t){return b(t)?(e=t,this):e},this.html5Mode=function(e){return V(e)?(t.enabled=e,this):x(e)?(V(e.enabled)&&(t.enabled=e.enabled),V(e.requireBase)&&(t.requireBase=e.requireBase),V(e.rewriteLinks)&&(t.rewriteLinks=e.rewriteLinks),this):t},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(n,r,i,o,a){function s(e,t,n){var i=c.url(),o=c.$$state;try{r.url(e,t,n),c.$$state=r.state()}catch(a){throw c.url(i),c.$$state=o,a}}function u(e,t){n.$broadcast("$locationChangeSuccess",c.absUrl(),e,c.$$state,t)}var c,l,f,p=r.baseHref(),h=r.url();if(t.enabled){if(!p&&t.requireBase)throw io("nobase","$location in HTML5 mode requires a <base> tag to be present!");f=Ht(h)+(p||"/"),l=i.history?zt:Gt}else f=Ft(h),l=Wt;var d=Bt(f);c=new l(f,d,"#"+e),c.$$parseLinkUrl(h,h),c.$$state=r.state();var $=/^\s*(javascript|mailto):/i;o.on("click",function(e){if(t.rewriteLinks&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&2!=e.which&&2!=e.button){for(var i=Dr(e.target);"a"!==U(i[0]);)if(i[0]===o[0]||!(i=i.parent())[0])return;var s=i.prop("href"),u=i.attr("href")||i.attr("xlink:href");x(s)&&"[object SVGAnimatedString]"===s.toString()&&(s=jn(s.animVal).href),$.test(s)||!s||i.attr("target")||e.isDefaultPrevented()||c.$$parseLinkUrl(s,u)&&(e.preventDefault(),c.absUrl()!=r.url()&&(n.$apply(),a.angular["ff-684208-preventDefault"]=!0))}}),Lt(c.absUrl())!=Lt(h)&&r.url(c.absUrl(),!0);var v=!0;return r.onUrlChange(function(e,t){return y(qt(d,e))?void(a.location.href=e):(n.$evalAsync(function(){var r,i=c.absUrl(),o=c.$$state;e=Lt(e),c.$$parse(e),c.$$state=t,r=n.$broadcast("$locationChangeStart",e,i,t,o).defaultPrevented,c.absUrl()===e&&(r?(c.$$parse(i),c.$$state=o,s(i,!1,o)):(v=!1,u(i,o)))}),void(n.$$phase||n.$digest()))}),n.$watch(function(){var e=Lt(r.url()),t=Lt(c.absUrl()),o=r.state(),a=c.$$replace,l=e!==t||c.$$html5&&i.history&&o!==c.$$state;(v||l)&&(v=!1,n.$evalAsync(function(){var t=c.absUrl(),r=n.$broadcast("$locationChangeStart",t,e,c.$$state,o).defaultPrevented;c.absUrl()===t&&(r?(c.$$parse(e),c.$$state=o):(l&&s(t,a,o===c.$$state?null:c.$$state),u(e,o)))})),c.$$replace=!1}),c}]}function Zt(){var e=!0,t=this;this.debugEnabled=function(t){return b(t)?(e=t,this):e},this.$get=["$window",function(n){function r(e){return e instanceof Error&&(e.stack?e=e.message&&-1===e.stack.indexOf(e.message)?"Error: "+e.message+"\n"+e.stack:e.stack:e.sourceURL&&(e=e.message+"\n"+e.sourceURL+":"+e.line)),e}function i(e){var t=n.console||{},i=t[e]||t.log||$,a=!1;try{a=!!i.apply}catch(s){}return a?function(){var e=[];return o(arguments,function(t){e.push(r(t))}),i.apply(t,e)}:function(e,t){i(e,null==t?"":t)}}return{log:i("log"),info:i("info"),warn:i("warn"),error:i("error"),debug:function(){var n=i("debug");return function(){e&&n.apply(t,arguments)}}()}}]}function Xt(e,t){if("__defineGetter__"===e||"__defineSetter__"===e||"__lookupGetter__"===e||"__lookupSetter__"===e||"__proto__"===e)throw ao("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",t);return e}function Qt(e){return e+""}function en(e,t){if(e){if(e.constructor===e)throw ao("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e.window===e)throw ao("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",t);if(e.children&&(e.nodeName||e.prop&&e.attr&&e.find))throw ao("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",t);if(e===Object)throw ao("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",t)}return e}function tn(e,t){if(e){if(e.constructor===e)throw ao("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e===so||e===uo||e===co)throw ao("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",t)}}function nn(e,t){if(e&&(e===0..constructor||e===(!1).constructor||e==="".constructor||e==={}.constructor||e===[].constructor||e===Function.constructor))throw ao("isecaf","Assigning to a constructor is disallowed! Expression: {0}",t)}function rn(e,t){return"undefined"!=typeof e?e:t}function on(e,t){return"undefined"==typeof e?t:"undefined"==typeof t?e:e+t}function an(e,t){var n=e(t);return!n.$stateful}function sn(e,t){var n,r;switch(e.type){case ho.Program:n=!0,o(e.body,function(e){sn(e.expression,t),n=n&&e.expression.constant}),e.constant=n;break;case ho.Literal:e.constant=!0,e.toWatch=[];break;case ho.UnaryExpression:sn(e.argument,t),e.constant=e.argument.constant,e.toWatch=e.argument.toWatch;break;case ho.BinaryExpression:sn(e.left,t),sn(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.left.toWatch.concat(e.right.toWatch);break;case ho.LogicalExpression:sn(e.left,t),sn(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.constant?[]:[e];break;case ho.ConditionalExpression:sn(e.test,t),sn(e.alternate,t),sn(e.consequent,t),e.constant=e.test.constant&&e.alternate.constant&&e.consequent.constant,e.toWatch=e.constant?[]:[e];break;case ho.Identifier:e.constant=!1,e.toWatch=[e];break;case ho.MemberExpression:sn(e.object,t),e.computed&&sn(e.property,t),e.constant=e.object.constant&&(!e.computed||e.property.constant),e.toWatch=[e];break;case ho.CallExpression:n=e.filter?an(t,e.callee.name):!1,r=[],o(e.arguments,function(e){sn(e,t),n=n&&e.constant,e.constant||r.push.apply(r,e.toWatch)}),e.constant=n,e.toWatch=e.filter&&an(t,e.callee.name)?r:[e];break;case ho.AssignmentExpression:sn(e.left,t),sn(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=[e];break;case ho.ArrayExpression:n=!0,r=[],o(e.elements,function(e){sn(e,t),n=n&&e.constant,e.constant||r.push.apply(r,e.toWatch)}),e.constant=n,e.toWatch=r;break;case ho.ObjectExpression:n=!0,r=[],o(e.properties,function(e){sn(e.value,t),n=n&&e.value.constant,e.value.constant||r.push.apply(r,e.value.toWatch)}),e.constant=n,e.toWatch=r;break;case ho.ThisExpression:e.constant=!1,e.toWatch=[];break;case ho.LocalsExpression:e.constant=!1,e.toWatch=[]}}function un(e){if(1==e.length){var t=e[0].expression,r=t.toWatch;return 1!==r.length?r:r[0]!==t?r:n}}function cn(e){return e.type===ho.Identifier||e.type===ho.MemberExpression}function ln(e){return 1===e.body.length&&cn(e.body[0].expression)?{type:ho.AssignmentExpression,left:e.body[0].expression,right:{type:ho.NGValueParameter},operator:"="}:void 0}function fn(e){return 0===e.body.length||1===e.body.length&&(e.body[0].expression.type===ho.Literal||e.body[0].expression.type===ho.ArrayExpression||e.body[0].expression.type===ho.ObjectExpression)}function pn(e){return e.constant}function hn(e,t){this.astBuilder=e,this.$filter=t}function dn(e,t){this.astBuilder=e,this.$filter=t}function $n(e){return"constructor"==e}function vn(e){return A(e.valueOf)?e.valueOf():vo.call(e)}function mn(){var e=me(),t=me();this.$get=["$filter",function(r){function i(n,i,o){var s,h,g;switch(o=o||m,typeof n){case"string":n=n.trim(),g=n;var y=o?t:e;if(s=y[g],!s){":"===n.charAt(0)&&":"===n.charAt(1)&&(h=!0,n=n.substring(2));var b=o?v:d,x=new po(b),w=new $o(x,r,b);s=w.parse(n),s.constant?s.$$watchDelegate=f:h?s.$$watchDelegate=s.literal?l:c:s.inputs&&(s.$$watchDelegate=u),o&&(s=a(s)),y[g]=s}return p(s,i);case"function":return p(n,i);default:return p($,i)}}function a(e){function t(t,n,r,i){var o=m;m=!0;try{return e(t,n,r,i)}finally{m=o}}if(!e)return e;t.$$watchDelegate=e.$$watchDelegate,t.assign=a(e.assign),t.constant=e.constant,t.literal=e.literal;for(var n=0;e.inputs&&n<e.inputs.length;++n)e.inputs[n]=a(e.inputs[n]);
return t.inputs=e.inputs,t}function s(e,t){return null==e||null==t?e===t:"object"==typeof e&&(e=vn(e),"object"==typeof e)?!1:e===t||e!==e&&t!==t}function u(e,t,r,i,o){var a,u=i.inputs;if(1===u.length){var c=s;return u=u[0],e.$watch(function(e){var t=u(e);return s(t,c)||(a=i(e,n,n,[t]),c=t&&vn(t)),a},t,r,o)}for(var l=[],f=[],p=0,h=u.length;h>p;p++)l[p]=s,f[p]=null;return e.$watch(function(e){for(var t=!1,r=0,o=u.length;o>r;r++){var c=u[r](e);(t||(t=!s(c,l[r])))&&(f[r]=c,l[r]=c&&vn(c))}return t&&(a=i(e,n,n,f)),a},t,r,o)}function c(e,t,n,r){var i,o;return i=e.$watch(function(e){return r(e)},function(e,n,r){o=e,A(t)&&t.apply(this,arguments),b(e)&&r.$$postDigest(function(){b(o)&&i()})},n)}function l(e,t,n,r){function i(e){var t=!0;return o(e,function(e){b(e)||(t=!1)}),t}var a,s;return a=e.$watch(function(e){return r(e)},function(e,n,r){s=e,A(t)&&t.call(this,e,n,r),i(e)&&r.$$postDigest(function(){i(s)&&a()})},n)}function f(e,t,n,r){var i;return i=e.$watch(function(e){return i(),r(e)},t,n)}function p(e,t){if(!t)return e;var n=e.$$watchDelegate,r=!1,i=n!==l&&n!==c,o=i?function(n,i,o,a){var s=r&&a?a[0]:e(n,i,o,a);return t(s,n,i)}:function(n,r,i,o){var a=e(n,r,i,o),s=t(a,n,r);return b(a)?s:a};return e.$$watchDelegate&&e.$$watchDelegate!==u?o.$$watchDelegate=e.$$watchDelegate:t.$stateful||(o.$$watchDelegate=u,r=!e.inputs,o.inputs=e.inputs?e.inputs:[e]),o}var h=Kr().noUnsafeEval,d={csp:h,expensiveChecks:!1},v={csp:h,expensiveChecks:!0},m=!1;return i.$$runningExpensiveChecks=function(){return m},i}]}function gn(){this.$get=["$rootScope","$exceptionHandler",function(e,t){return bn(function(t){e.$evalAsync(t)},t)}]}function yn(){this.$get=["$browser","$exceptionHandler",function(e,t){return bn(function(t){e.defer(t)},t)}]}function bn(e,t){function i(){this.$$state={status:0}}function a(e,t){return function(n){t.call(e,n)}}function s(e){var r,i,o;o=e.pending,e.processScheduled=!1,e.pending=n;for(var a=0,s=o.length;s>a;++a){i=o[a][0],r=o[a][e.status];try{A(r)?i.resolve(r(e.value)):1===e.status?i.resolve(e.value):i.reject(e.value)}catch(u){i.reject(u),t(u)}}}function u(t){!t.processScheduled&&t.pending&&(t.processScheduled=!0,e(function(){s(t)}))}function c(){this.promise=new i}function l(e){var t=new c,n=0,r=Wr(e)?[]:{};return o(e,function(e,i){n++,m(e).then(function(e){r.hasOwnProperty(i)||(r[i]=e,--n||t.resolve(r))},function(e){r.hasOwnProperty(i)||t.reject(e)})}),0===n&&t.resolve(r),t.promise}var p=r("$q",TypeError),h=function(){var e=new c;return e.resolve=a(e,e.resolve),e.reject=a(e,e.reject),e.notify=a(e,e.notify),e};f(i.prototype,{then:function(e,t,n){if(y(e)&&y(t)&&y(n))return this;var r=new c;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([r,e,t,n]),this.$$state.status>0&&u(this.$$state),r.promise},"catch":function(e){return this.then(null,e)},"finally":function(e,t){return this.then(function(t){return v(t,!0,e)},function(t){return v(t,!1,e)},t)}}),f(c.prototype,{resolve:function(e){this.promise.$$state.status||(e===this.promise?this.$$reject(p("qcycle","Expected promise to be resolved with value other than itself '{0}'",e)):this.$$resolve(e))},$$resolve:function(e){function n(e){s||(s=!0,o.$$resolve(e))}function r(e){s||(s=!0,o.$$reject(e))}var i,o=this,s=!1;try{(x(e)||A(e))&&(i=e&&e.then),A(i)?(this.promise.$$state.status=-1,i.call(e,n,r,a(this,this.notify))):(this.promise.$$state.value=e,this.promise.$$state.status=1,u(this.promise.$$state))}catch(c){r(c),t(c)}},reject:function(e){this.promise.$$state.status||this.$$reject(e)},$$reject:function(e){this.promise.$$state.value=e,this.promise.$$state.status=2,u(this.promise.$$state)},notify:function(n){var r=this.promise.$$state.pending;this.promise.$$state.status<=0&&r&&r.length&&e(function(){for(var e,i,o=0,a=r.length;a>o;o++){i=r[o][0],e=r[o][3];try{i.notify(A(e)?e(n):n)}catch(s){t(s)}}})}});var d=function(e){var t=new c;return t.reject(e),t.promise},$=function(e,t){var n=new c;return t?n.resolve(e):n.reject(e),n.promise},v=function(e,t,n){var r=null;try{A(n)&&(r=n())}catch(i){return $(i,!1)}return R(r)?r.then(function(){return $(e,t)},function(e){return $(e,!1)}):$(e,t)},m=function(e,t,n,r){var i=new c;return i.resolve(e),i.promise.then(t,n,r)},g=m,b=function(e){function t(e){r.resolve(e)}function n(e){r.reject(e)}if(!A(e))throw p("norslvr","Expected resolverFn, got '{0}'",e);var r=new c;return e(t,n),r.promise};return b.prototype=i.prototype,b.defer=h,b.reject=d,b.when=m,b.resolve=g,b.all=l,b}function xn(){this.$get=["$window","$timeout",function(e,t){var n=e.requestAnimationFrame||e.webkitRequestAnimationFrame,r=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame,i=!!n,o=i?function(e){var t=n(e);return function(){r(t)}}:function(e){var n=t(e,16.66,!1);return function(){t.cancel(n)}};return o.supported=i,o}]}function wn(){function e(e){function t(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=u(),this.$$ChildScope=null}return t.prototype=e,t}var t=10,n=r("$rootScope"),a=null,s=null;this.digestTtl=function(e){return arguments.length&&(t=e),t},this.$get=["$exceptionHandler","$parse","$browser",function(r,c,l){function f(e){e.currentScope.$$destroyed=!0}function p(e){9===Rr&&(e.$$childHead&&p(e.$$childHead),e.$$nextSibling&&p(e.$$nextSibling)),e.$parent=e.$$nextSibling=e.$$prevSibling=e.$$childHead=e.$$childTail=e.$root=e.$$watchers=null}function h(){this.$id=u(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function d(e){if(C.$$phase)throw n("inprog","{0} already in progress",C.$$phase);C.$$phase=e}function v(){C.$$phase=null}function m(e,t){do e.$$watchersCount+=t;while(e=e.$parent)}function g(e,t,n){do e.$$listenerCount[n]-=t,0===e.$$listenerCount[n]&&delete e.$$listenerCount[n];while(e=e.$parent)}function b(){}function w(){for(;O.length;)try{O.shift()()}catch(e){r(e)}s=null}function S(){null===s&&(s=l.defer(function(){C.$apply(w)}))}h.prototype={constructor:h,$new:function(t,n){var r;return n=n||this,t?(r=new h,r.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=e(this)),r=new this.$$ChildScope),r.$parent=n,r.$$prevSibling=n.$$childTail,n.$$childHead?(n.$$childTail.$$nextSibling=r,n.$$childTail=r):n.$$childHead=n.$$childTail=r,(t||n!=this)&&r.$on("$destroy",f),r},$watch:function(e,t,n,r){var i=c(e);if(i.$$watchDelegate)return i.$$watchDelegate(this,t,n,i,e);var o=this,s=o.$$watchers,u={fn:t,last:b,get:i,exp:r||e,eq:!!n};return a=null,A(t)||(u.fn=$),s||(s=o.$$watchers=[]),s.unshift(u),m(this,1),function(){q(s,u)>=0&&m(o,-1),a=null}},$watchGroup:function(e,t){function n(){u=!1,c?(c=!1,t(i,i,s)):t(i,r,s)}var r=new Array(e.length),i=new Array(e.length),a=[],s=this,u=!1,c=!0;if(!e.length){var l=!0;return s.$evalAsync(function(){l&&t(i,i,s)}),function(){l=!1}}return 1===e.length?this.$watch(e[0],function(e,n,o){i[0]=e,r[0]=n,t(i,e===n?i:r,o)}):(o(e,function(e,t){var o=s.$watch(e,function(e,o){i[t]=e,r[t]=o,u||(u=!0,s.$evalAsync(n))});a.push(o)}),function(){for(;a.length;)a.shift()()})},$watchCollection:function(e,t){function n(e){o=e;var t,n,r,s,u;if(!y(o)){if(x(o))if(i(o)){a!==h&&(a=h,v=a.length=0,f++),t=o.length,v!==t&&(f++,a.length=v=t);for(var c=0;t>c;c++)u=a[c],s=o[c],r=u!==u&&s!==s,r||u===s||(f++,a[c]=s)}else{a!==d&&(a=d={},v=0,f++),t=0;for(n in o)Mr.call(o,n)&&(t++,s=o[n],u=a[n],n in a?(r=u!==u&&s!==s,r||u===s||(f++,a[n]=s)):(v++,a[n]=s,f++));if(v>t){f++;for(n in a)Mr.call(o,n)||(v--,delete a[n])}}else a!==o&&(a=o,f++);return f}}function r(){if($?($=!1,t(o,o,u)):t(o,s,u),l)if(x(o))if(i(o)){s=new Array(o.length);for(var e=0;e<o.length;e++)s[e]=o[e]}else{s={};for(var n in o)Mr.call(o,n)&&(s[n]=o[n])}else s=o}n.$stateful=!0;var o,a,s,u=this,l=t.length>1,f=0,p=c(e,n),h=[],d={},$=!0,v=0;return this.$watch(p,r)},$digest:function(){var e,i,o,u,c,f,p,h,$,m,g,y,x=t,S=this,O=[];d("$digest"),l.$$checkUrlChange(),this===C&&null!==s&&(l.defer.cancel(s),w()),a=null;do{for(h=!1,m=S;E.length;){try{y=E.shift(),y.scope.$eval(y.expression,y.locals)}catch(M){r(M)}a=null}e:do{if(f=m.$$watchers)for(p=f.length;p--;)try{if(e=f[p])if(c=e.get,(i=c(m))===(o=e.last)||(e.eq?B(i,o):"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))){if(e===a){h=!1;break e}}else h=!0,a=e,e.last=e.eq?F(i,null):i,u=e.fn,u(i,o===b?i:o,m),5>x&&(g=4-x,O[g]||(O[g]=[]),O[g].push({msg:A(e.exp)?"fn: "+(e.exp.name||e.exp.toString()):e.exp,newVal:i,oldVal:o}))}catch(M){r(M)}if(!($=m.$$watchersCount&&m.$$childHead||m!==S&&m.$$nextSibling))for(;m!==S&&!($=m.$$nextSibling);)m=m.$parent}while(m=$);if((h||E.length)&&!x--)throw v(),n("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",t,O)}while(h||E.length);for(v();k.length;)try{k.shift()()}catch(M){r(M)}},$destroy:function(){if(!this.$$destroyed){var e=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this===C&&l.$$applicationDestroyed(),m(this,-this.$$watchersCount);for(var t in this.$$listenerCount)g(this,this.$$listenerCount[t],t);e&&e.$$childHead==this&&(e.$$childHead=this.$$nextSibling),e&&e.$$childTail==this&&(e.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=$,this.$on=this.$watch=this.$watchGroup=function(){return $},this.$$listeners={},this.$$nextSibling=null,p(this)}},$eval:function(e,t){return c(e)(this,t)},$evalAsync:function(e,t){C.$$phase||E.length||l.defer(function(){E.length&&C.$digest()}),E.push({scope:this,expression:c(e),locals:t})},$$postDigest:function(e){k.push(e)},$apply:function(e){try{d("$apply");try{return this.$eval(e)}finally{v()}}catch(t){r(t)}finally{try{C.$digest()}catch(t){throw r(t),t}}},$applyAsync:function(e){function t(){n.$eval(e)}var n=this;e&&O.push(t),e=c(e),S()},$on:function(e,t){var n=this.$$listeners[e];n||(this.$$listeners[e]=n=[]),n.push(t);var r=this;do r.$$listenerCount[e]||(r.$$listenerCount[e]=0),r.$$listenerCount[e]++;while(r=r.$parent);var i=this;return function(){var r=n.indexOf(t);-1!==r&&(n[r]=null,g(i,1,e))}},$emit:function(e,t){var n,i,o,a=[],s=this,u=!1,c={name:e,targetScope:s,stopPropagation:function(){u=!0},preventDefault:function(){c.defaultPrevented=!0},defaultPrevented:!1},l=H([c],arguments,1);do{for(n=s.$$listeners[e]||a,c.currentScope=s,i=0,o=n.length;o>i;i++)if(n[i])try{n[i].apply(null,l)}catch(f){r(f)}else n.splice(i,1),i--,o--;if(u)return c.currentScope=null,c;s=s.$parent}while(s);return c.currentScope=null,c},$broadcast:function(e,t){var n=this,i=n,o=n,a={name:e,targetScope:n,preventDefault:function(){a.defaultPrevented=!0},defaultPrevented:!1};if(!n.$$listenerCount[e])return a;for(var s,u,c,l=H([a],arguments,1);i=o;){for(a.currentScope=i,s=i.$$listeners[e]||[],u=0,c=s.length;c>u;u++)if(s[u])try{s[u].apply(null,l)}catch(f){r(f)}else s.splice(u,1),u--,c--;if(!(o=i.$$listenerCount[e]&&i.$$childHead||i!==n&&i.$$nextSibling))for(;i!==n&&!(o=i.$$nextSibling);)i=i.$parent}return a.currentScope=null,a}};var C=new h,E=C.$$asyncQueue=[],k=C.$$postDigestQueue=[],O=C.$$applyAsyncQueue=[];return C}]}function Sn(){var e=/^\s*(https?|ftp|mailto|tel|file):/,t=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(t){return b(t)?(e=t,this):e},this.imgSrcSanitizationWhitelist=function(e){return b(e)?(t=e,this):t},this.$get=function(){return function(n,r){var i,o=r?t:e;return i=jn(n).href,""===i||i.match(o)?n:"unsafe:"+i}}}function Cn(e){if("self"===e)return e;if(S(e)){if(e.indexOf("***")>-1)throw mo("iwcard","Illegal sequence *** in string matcher.  String: {0}",e);return e=Yr(e).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+e+"$")}if(k(e))return new RegExp("^"+e.source+"$");throw mo("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function En(e){var t=[];return b(e)&&o(e,function(e){t.push(Cn(e))}),t}function An(){this.SCE_CONTEXTS=go;var e=["self"],t=[];this.resourceUrlWhitelist=function(t){return arguments.length&&(e=En(t)),e},this.resourceUrlBlacklist=function(e){return arguments.length&&(t=En(e)),t},this.$get=["$injector",function(n){function r(e,t){return"self"===e?Vn(t):!!e.exec(t.href)}function i(n){var i,o,a=jn(n.toString()),s=!1;for(i=0,o=e.length;o>i;i++)if(r(e[i],a)){s=!0;break}if(s)for(i=0,o=t.length;o>i;i++)if(r(t[i],a)){s=!1;break}return s}function o(e){var t=function(e){this.$$unwrapTrustedValue=function(){return e}};return e&&(t.prototype=new e),t.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},t.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},t}function a(e,t){var n=f.hasOwnProperty(e)?f[e]:null;if(!n)throw mo("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",e,t);if(null===t||y(t)||""===t)return t;if("string"!=typeof t)throw mo("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",e);return new n(t)}function s(e){return e instanceof l?e.$$unwrapTrustedValue():e}function u(e,t){if(null===t||y(t)||""===t)return t;var n=f.hasOwnProperty(e)?f[e]:null;if(n&&t instanceof n)return t.$$unwrapTrustedValue();if(e===go.RESOURCE_URL){if(i(t))return t;throw mo("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",t.toString())}if(e===go.HTML)return c(t);throw mo("unsafe","Attempting to use an unsafe value in a safe context.")}var c=function(e){throw mo("unsafe","Attempting to use an unsafe value in a safe context.")};n.has("$sanitize")&&(c=n.get("$sanitize"));var l=o(),f={};return f[go.HTML]=o(l),f[go.CSS]=o(l),f[go.URL]=o(l),f[go.JS]=o(l),f[go.RESOURCE_URL]=o(f[go.URL]),{trustAs:a,getTrusted:u,valueOf:s}}]}function kn(){var e=!0;this.enabled=function(t){return arguments.length&&(e=!!t),e},this.$get=["$parse","$sceDelegate",function(t,n){if(e&&8>Rr)throw mo("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var r=L(go);r.isEnabled=function(){return e},r.trustAs=n.trustAs,r.getTrusted=n.getTrusted,r.valueOf=n.valueOf,e||(r.trustAs=r.getTrusted=function(e,t){return t},r.valueOf=v),r.parseAs=function(e,n){var i=t(n);return i.literal&&i.constant?i:t(n,function(t){return r.getTrusted(e,t)})};var i=r.parseAs,a=r.getTrusted,s=r.trustAs;return o(go,function(e,t){var n=Tr(t);r[Se("parse_as_"+n)]=function(t){return i(e,t)},r[Se("get_trusted_"+n)]=function(t){return a(e,t)},r[Se("trust_as_"+n)]=function(t){return s(e,t)}}),r}]}function On(){this.$get=["$window","$document",function(e,t){var n,r,i={},o=h((/android (\d+)/.exec(Tr((e.navigator||{}).userAgent))||[])[1]),a=/Boxee/i.test((e.navigator||{}).userAgent),s=t[0]||{},u=/^(Moz|webkit|ms)(?=[A-Z])/,c=s.body&&s.body.style,l=!1,f=!1;if(c){for(var p in c)if(r=u.exec(p)){n=r[0],n=n.substr(0,1).toUpperCase()+n.substr(1);break}n||(n="WebkitOpacity"in c&&"webkit"),l=!!("transition"in c||n+"Transition"in c),f=!!("animation"in c||n+"Animation"in c),!o||l&&f||(l=S(c.webkitTransition),f=S(c.webkitAnimation))}return{history:!(!e.history||!e.history.pushState||4>o||a),hasEvent:function(e){if("input"===e&&11>=Rr)return!1;if(y(i[e])){var t=s.createElement("div");i[e]="on"+e in t}return i[e]},csp:Kr(),vendorPrefix:n,transitions:l,animations:f,android:o}}]}function Mn(){var e;this.httpOptions=function(t){return t?(e=t,this):e},this.$get=["$templateCache","$http","$q","$sce",function(t,n,r,i){function o(a,s){function u(e){if(!s)throw Bi("tpload","Failed to load template: {0} (HTTP status: {1} {2})",a,e.status,e.statusText);return r.reject(e)}o.totalPendingRequests++,S(a)&&t.get(a)||(a=i.getTrustedResourceUrl(a));var c=n.defaults&&n.defaults.transformResponse;return Wr(c)?c=c.filter(function(e){return e!==Et}):c===Et&&(c=null),n.get(a,f({cache:t,transformResponse:c},e))["finally"](function(){o.totalPendingRequests--}).then(function(e){return t.put(a,e.data),e.data},u)}return o.totalPendingRequests=0,o}]}function Tn(){this.$get=["$rootScope","$browser","$location",function(e,t,n){var r={};return r.findBindings=function(e,t,n){var r=e.getElementsByClassName("ng-binding"),i=[];return o(r,function(e){var r=Hr.element(e).data("$binding");r&&o(r,function(r){if(n){var o=new RegExp("(^|\\s)"+Yr(t)+"(\\s|\\||$)");o.test(r)&&i.push(e)}else-1!=r.indexOf(t)&&i.push(e)})}),i},r.findModels=function(e,t,n){for(var r=["ng-","data-ng-","ng\\:"],i=0;i<r.length;++i){var o=n?"=":"*=",a="["+r[i]+"model"+o+'"'+t+'"]',s=e.querySelectorAll(a);if(s.length)return s}},r.getLocation=function(){return n.url()},r.setLocation=function(t){t!==n.url()&&(n.url(t),e.$digest())},r.whenStable=function(e){t.notifyWhenNoOutstandingRequests(e)},r}]}function Nn(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(e,t,n,r,i){function o(o,s,u){A(o)||(u=s,s=o,o=$);var c,l=z(arguments,3),f=b(u)&&!u,p=(f?r:n).defer(),h=p.promise;return c=t.defer(function(){try{p.resolve(o.apply(null,l))}catch(t){p.reject(t),i(t)}finally{delete a[h.$$timeoutId]}f||e.$apply()},s),h.$$timeoutId=c,a[c]=p,h}var a={};return o.cancel=function(e){return e&&e.$$timeoutId in a?(a[e.$$timeoutId].reject("canceled"),delete a[e.$$timeoutId],t.defer.cancel(e.$$timeoutId)):!1},o}]}function jn(e){var t=e;return Rr&&(yo.setAttribute("href",t),t=yo.href),yo.setAttribute("href",t),{href:yo.href,protocol:yo.protocol?yo.protocol.replace(/:$/,""):"",host:yo.host,search:yo.search?yo.search.replace(/^\?/,""):"",hash:yo.hash?yo.hash.replace(/^#/,""):"",hostname:yo.hostname,port:yo.port,pathname:"/"===yo.pathname.charAt(0)?yo.pathname:"/"+yo.pathname}}function Vn(e){var t=S(e)?jn(e):e;return t.protocol===bo.protocol&&t.host===bo.host}function Rn(){this.$get=m(e)}function Dn(e){function t(e){try{return decodeURIComponent(e)}catch(t){return e}}var n=e[0]||{},r={},i="";return function(){var e,o,a,s,u,c=n.cookie||"";if(c!==i)for(i=c,e=i.split("; "),r={},a=0;a<e.length;a++)o=e[a],s=o.indexOf("="),s>0&&(u=t(o.substring(0,s)),y(r[u])&&(r[u]=t(o.substring(s+1))));return r}}function In(){this.$get=Dn}function Pn(e){function t(r,i){if(x(r)){var a={};return o(r,function(e,n){a[n]=t(n,e)}),a}return e.factory(r+n,i)}var n="Filter";this.register=t,this.$get=["$injector",function(e){return function(t){return e.get(t+n)}}],t("currency",Ln),t("date",rr),t("filter",_n),t("json",ir),t("limitTo",or),t("lowercase",ko),t("number",Bn),t("orderBy",ar),t("uppercase",Oo)}function _n(){return function(e,t,n){if(!i(e)){if(null==e)return e;throw r("filter")("notarray","Expected array but received: {0}",e)}var o,a,s=Fn(t);switch(s){case"function":o=t;break;case"boolean":case"null":case"number":case"string":a=!0;case"object":o=Un(t,n,a);break;default:return e}return Array.prototype.filter.call(e,o)}}function Un(e,t,n){var r,i=x(e)&&"$"in e;return t===!0?t=B:A(t)||(t=function(e,t){return y(e)?!1:null===e||null===t?e===t:x(t)||x(e)&&!g(e)?!1:(e=Tr(""+e),t=Tr(""+t),-1!==e.indexOf(t))}),r=function(r){return i&&!x(r)?qn(r,e.$,t,!1):qn(r,e,t,n)}}function qn(e,t,n,r,i){var o=Fn(e),a=Fn(t);if("string"===a&&"!"===t.charAt(0))return!qn(e,t.substring(1),n,r);if(Wr(e))return e.some(function(e){return qn(e,t,n,r)});switch(o){case"object":var s;if(r){for(s in e)if("$"!==s.charAt(0)&&qn(e[s],t,n,!0))return!0;return i?!1:qn(e,t,n,!1)}if("object"===a){for(s in t){var u=t[s];if(!A(u)&&!y(u)){var c="$"===s,l=c?e:e[s];if(!qn(l,u,n,c,c))return!1}}return!0}return n(e,t);case"function":return!1;default:return n(e,t)}}function Fn(e){return null===e?"null":typeof e}function Ln(e){var t=e.NUMBER_FORMATS;return function(e,n,r){return y(n)&&(n=t.CURRENCY_SYM),y(r)&&(r=t.PATTERNS[1].maxFrac),null==e?e:Wn(e,t.PATTERNS[1],t.GROUP_SEP,t.DECIMAL_SEP,r).replace(/\u00A4/g,n)}}function Bn(e){var t=e.NUMBER_FORMATS;return function(e,n){return null==e?e:Wn(e,t.PATTERNS[0],t.GROUP_SEP,t.DECIMAL_SEP,n)}}function Hn(e){var t,n,r,i,o,a=0;for((n=e.indexOf(wo))>-1&&(e=e.replace(wo,"")),(r=e.search(/e/i))>0?(0>n&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):0>n&&(n=e.length),r=0;e.charAt(r)==So;r++);if(r==(o=e.length))t=[0],n=1;else{for(o--;e.charAt(o)==So;)o--;for(n-=r,t=[],i=0;o>=r;r++,i++)t[i]=+e.charAt(r)}return n>xo&&(t=t.splice(0,xo-1),a=n-1,n=1),{d:t,e:a,i:n}}function zn(e,t,n,r){var i=e.d,o=i.length-e.i;t=y(t)?Math.min(Math.max(n,o),r):+t;var a=t+e.i,s=i[a];if(a>0)i.splice(a);else{e.i=1,i.length=a=t+1;for(var u=0;a>u;u++)i[u]=0}for(s>=5&&i[a-1]++;t>o;o++)i.push(0);var c=i.reduceRight(function(e,t,n,r){return t+=e,r[n]=t%10,Math.floor(t/10)},0);c&&(i.unshift(c),e.i++)}function Wn(e,t,n,r,i){if(!S(e)&&!C(e)||isNaN(e))return"";var o,a=!isFinite(e),s=!1,u=Math.abs(e)+"",c="";if(a)c="";else{o=Hn(u),zn(o,i,t.minFrac,t.maxFrac);var l=o.d,f=o.i,p=o.e,h=[];for(s=l.reduce(function(e,t){return e&&!t},!0);0>f;)l.unshift(0),f++;f>0?h=l.splice(f):(h=l,l=[0]);var d=[];for(l.length>t.lgSize&&d.unshift(l.splice(-t.lgSize).join(""));l.length>t.gSize;)d.unshift(l.splice(-t.gSize).join(""));l.length&&d.unshift(l.join("")),c=d.join(n),h.length&&(c+=r+h.join("")),p&&(c+="e+"+p)}return 0>e&&!s?t.negPre+c+t.negSuf:t.posPre+c+t.posSuf}function Gn(e,t,n){var r="";for(0>e&&(r="-",e=-e),e=""+e;e.length<t;)e=So+e;return n&&(e=e.substr(e.length-t)),r+e}function Jn(e,t,n,r){return n=n||0,function(i){var o=i["get"+e]();return(n>0||o>-n)&&(o+=n),0===o&&-12==n&&(o=12),Gn(o,t,r)}}function Yn(e,t){return function(n,r){var i=n["get"+e](),o=Nr(t?"SHORT"+e:e);return r[o][i]}}function Kn(e,t,n){var r=-1*n,i=r>=0?"+":"";return i+=Gn(Math[r>0?"floor":"ceil"](r/60),2)+Gn(Math.abs(r%60),2)}function Zn(e){var t=new Date(e,0,1).getDay();return new Date(e,0,(4>=t?5:12)-t)}function Xn(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function Qn(e){return function(t){var n=Zn(t.getFullYear()),r=Xn(t),i=+r-+n,o=1+Math.round(i/6048e5);return Gn(o,e)}}function er(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function tr(e,t){return e.getFullYear()<=0?t.ERAS[0]:t.ERAS[1]}function nr(e,t){return e.getFullYear()<=0?t.ERANAMES[0]:t.ERANAMES[1]}function rr(e){function t(e){var t;if(t=e.match(n)){var r=new Date(0),i=0,o=0,a=t[8]?r.setUTCFullYear:r.setFullYear,s=t[8]?r.setUTCHours:r.setHours;t[9]&&(i=h(t[9]+t[10]),o=h(t[9]+t[11])),a.call(r,h(t[1]),h(t[2])-1,h(t[3]));var u=h(t[4]||0)-i,c=h(t[5]||0)-o,l=h(t[6]||0),f=Math.round(1e3*parseFloat("0."+(t[7]||0)));return s.call(r,u,c,l,f),r}return e}var n=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(n,r,i){var a,s,u="",c=[];if(r=r||"mediumDate",r=e.DATETIME_FORMATS[r]||r,S(n)&&(n=Ao.test(n)?h(n):t(n)),C(n)&&(n=new Date(n)),!E(n)||!isFinite(n.getTime()))return n;for(;r;)s=Eo.exec(r),s?(c=H(c,s,1),r=c.pop()):(c.push(r),r=null);var l=n.getTimezoneOffset();return i&&(l=K(i,l),n=X(n,i,!0)),o(c,function(t){a=Co[t],u+=a?a(n,e.DATETIME_FORMATS,l):"''"===t?"'":t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}}function ir(){return function(e,t){return y(t)&&(t=2),J(e,t)}}function or(){return function(e,t,n){return t=Math.abs(Number(t))===1/0?Number(t):h(t),isNaN(t)?e:(C(e)&&(e=e.toString()),Wr(e)||S(e)?(n=!n||isNaN(n)?0:h(n),n=0>n?Math.max(0,e.length+n):n,t>=0?e.slice(n,n+t):0===n?e.slice(t,e.length):e.slice(Math.max(0,n+t),n)):e)}}function ar(e){function t(t,n){return n=n?-1:1,t.map(function(t){var r=1,i=v;if(A(t))i=t;else if(S(t)&&("+"!=t.charAt(0)&&"-"!=t.charAt(0)||(r="-"==t.charAt(0)?-1:1,t=t.substring(1)),""!==t&&(i=e(t),i.constant))){var o=i();i=function(e){return e[o]}}return{get:i,descending:r*n}})}function n(e){switch(typeof e){case"number":case"boolean":case"string":return!0;default:return!1}}function o(e,t){return"function"==typeof e.valueOf&&(e=e.valueOf(),n(e))?e:g(e)&&(e=e.toString(),n(e))?e:t}function a(e,t){var n=typeof e;return null===e?(n="string",e="null"):"string"===n?e=e.toLowerCase():"object"===n&&(e=o(e,t)),{value:e,type:n}}function s(e,t){var n=0;return e.type===t.type?e.value!==t.value&&(n=e.value<t.value?-1:1):n=e.type<t.type?-1:1,n}return function(e,n,o){function u(e,t){return{value:e,predicateValues:l.map(function(n){return a(n.get(e),t)})}}function c(e,t){for(var n=0,r=0,i=l.length;i>r&&!(n=s(e.predicateValues[r],t.predicateValues[r])*l[r].descending);++r);return n}if(null==e)return e;if(!i(e))throw r("orderBy")("notarray","Expected array but received: {0}",e);Wr(n)||(n=[n]),0===n.length&&(n=["+"]);var l=t(n,o);l.push({get:function(){return{}},descending:o?-1:1});var f=Array.prototype.map.call(e,u);return f.sort(c),e=f.map(function(e){return e.value})}}function sr(e){return A(e)&&(e={link:e}),e.restrict=e.restrict||"AC",m(e)}function ur(e,t){e.$name=t}function cr(e,t,r,i,a){var s=this,u=[];s.$error={},s.$$success={},s.$pending=n,s.$name=a(t.name||t.ngForm||"")(r),s.$dirty=!1,s.$pristine=!0,s.$valid=!0,s.$invalid=!1,s.$submitted=!1,s.$$parentForm=No,s.$rollbackViewValue=function(){o(u,function(e){e.$rollbackViewValue()})},s.$commitViewValue=function(){o(u,function(e){e.$commitViewValue()})},s.$addControl=function(e){de(e.$name,"input"),u.push(e),e.$name&&(s[e.$name]=e),e.$$parentForm=s},s.$$renameControl=function(e,t){var n=e.$name;s[n]===e&&delete s[n],s[t]=e,e.$name=t},s.$removeControl=function(e){e.$name&&s[e.$name]===e&&delete s[e.$name],o(s.$pending,function(t,n){s.$setValidity(n,null,e)}),o(s.$error,function(t,n){s.$setValidity(n,null,e)}),o(s.$$success,function(t,n){s.$setValidity(n,null,e)}),q(u,e),e.$$parentForm=No},Cr({ctrl:this,$element:e,set:function(e,t,n){var r=e[t];if(r){var i=r.indexOf(n);-1===i&&r.push(n)}else e[t]=[n]},unset:function(e,t,n){var r=e[t];r&&(q(r,n),0===r.length&&delete e[t])},$animate:i}),s.$setDirty=function(){i.removeClass(e,ha),i.addClass(e,da),s.$dirty=!0,s.$pristine=!1,s.$$parentForm.$setDirty()},s.$setPristine=function(){i.setClass(e,ha,da+" "+jo),s.$dirty=!1,s.$pristine=!0,s.$submitted=!1,o(u,function(e){e.$setPristine()})},s.$setUntouched=function(){o(u,function(e){e.$setUntouched()})},s.$setSubmitted=function(){i.addClass(e,jo),s.$submitted=!0,s.$$parentForm.$setSubmitted()}}function lr(e){e.$formatters.push(function(t){return e.$isEmpty(t)?t:t.toString()})}function fr(e,t,n,r,i,o){pr(e,t,n,r,i,o),lr(r)}function pr(e,t,n,r,i,o){var a=Tr(t[0].type);if(!i.android){var s=!1;t.on("compositionstart",function(e){s=!0}),t.on("compositionend",function(){s=!1,u()})}var u=function(e){if(c&&(o.defer.cancel(c),c=null),!s){var i=t.val(),u=e&&e.type;"password"===a||n.ngTrim&&"false"===n.ngTrim||(i=Jr(i)),(r.$viewValue!==i||""===i&&r.$$hasNativeValidators)&&r.$setViewValue(i,u)}};if(i.hasEvent("input"))t.on("input",u);else{var c,l=function(e,t,n){c||(c=o.defer(function(){c=null,t&&t.value===n||u(e)}))};t.on("keydown",function(e){var t=e.keyCode;91===t||t>15&&19>t||t>=37&&40>=t||l(e,this,this.value)}),i.hasEvent("paste")&&t.on("paste cut",l)}t.on("change",u),r.$render=function(){var e=r.$isEmpty(r.$viewValue)?"":r.$viewValue;t.val()!==e&&t.val(e)}}function hr(e,t){if(E(e))return e;if(S(e)){Lo.lastIndex=0;var n=Lo.exec(e);if(n){var r=+n[1],i=+n[2],o=0,a=0,s=0,u=0,c=Zn(r),l=7*(i-1);return t&&(o=t.getHours(),a=t.getMinutes(),s=t.getSeconds(),u=t.getMilliseconds()),new Date(r,0,c.getDate()+l,o,a,s,u)}}return NaN}function dr(e,t){return function(n,r){var i,a;if(E(n))return n;if(S(n)){if('"'==n.charAt(0)&&'"'==n.charAt(n.length-1)&&(n=n.substring(1,n.length-1)),Io.test(n))return new Date(n);if(e.lastIndex=0,i=e.exec(n))return i.shift(),a=r?{yyyy:r.getFullYear(),MM:r.getMonth()+1,dd:r.getDate(),HH:r.getHours(),mm:r.getMinutes(),ss:r.getSeconds(),sss:r.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},o(i,function(e,n){n<t.length&&(a[t[n]]=+e)}),new Date(a.yyyy,a.MM-1,a.dd,a.HH,a.mm,a.ss||0,1e3*a.sss||0)}return NaN}}function $r(e,t,r,i){return function(o,a,s,u,c,l,f){function p(e){return e&&!(e.getTime&&e.getTime()!==e.getTime())}function h(e){return b(e)&&!E(e)?r(e)||n:e}vr(o,a,s,u),pr(o,a,s,u,c,l);var d,$=u&&u.$options&&u.$options.timezone;if(u.$$parserName=e,u.$parsers.push(function(e){if(u.$isEmpty(e))return null;if(t.test(e)){var i=r(e,d);return $&&(i=X(i,$)),i}return n}),u.$formatters.push(function(e){if(e&&!E(e))throw ba("datefmt","Expected `{0}` to be a date",e);return p(e)?(d=e,d&&$&&(d=X(d,$,!0)),f("date")(e,i,$)):(d=null,"")}),b(s.min)||s.ngMin){var v;u.$validators.min=function(e){return!p(e)||y(v)||r(e)>=v},s.$observe("min",function(e){v=h(e),u.$validate()})}if(b(s.max)||s.ngMax){var m;u.$validators.max=function(e){return!p(e)||y(m)||r(e)<=m},s.$observe("max",function(e){m=h(e),u.$validate()})}}}function vr(e,t,r,i){var o=t[0],a=i.$$hasNativeValidators=x(o.validity);a&&i.$parsers.push(function(e){var r=t.prop(Or)||{};return r.badInput||r.typeMismatch?n:e})}function mr(e,t,r,i,o,a){if(vr(e,t,r,i),pr(e,t,r,i,o,a),i.$$parserName="number",i.$parsers.push(function(e){return i.$isEmpty(e)?null:Uo.test(e)?parseFloat(e):n}),i.$formatters.push(function(e){if(!i.$isEmpty(e)){if(!C(e))throw ba("numfmt","Expected `{0}` to be a number",e);e=e.toString()}return e}),b(r.min)||r.ngMin){var s;i.$validators.min=function(e){return i.$isEmpty(e)||y(s)||e>=s},r.$observe("min",function(e){b(e)&&!C(e)&&(e=parseFloat(e,10)),s=C(e)&&!isNaN(e)?e:n,i.$validate()})}if(b(r.max)||r.ngMax){var u;i.$validators.max=function(e){return i.$isEmpty(e)||y(u)||u>=e},r.$observe("max",function(e){b(e)&&!C(e)&&(e=parseFloat(e,10)),u=C(e)&&!isNaN(e)?e:n,i.$validate()})}}function gr(e,t,n,r,i,o){pr(e,t,n,r,i,o),lr(r),r.$$parserName="url",r.$validators.url=function(e,t){var n=e||t;return r.$isEmpty(n)||Po.test(n)}}function yr(e,t,n,r,i,o){pr(e,t,n,r,i,o),lr(r),r.$$parserName="email",r.$validators.email=function(e,t){var n=e||t;return r.$isEmpty(n)||_o.test(n)}}function br(e,t,n,r){y(n.name)&&t.attr("name",u());var i=function(e){t[0].checked&&r.$setViewValue(n.value,e&&e.type)};t.on("click",i),r.$render=function(){var e=n.value;t[0].checked=e==r.$viewValue},n.$observe("value",r.$render)}function xr(e,t,n,r,i){var o;if(b(r)){if(o=e(r),!o.constant)throw ba("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",n,r);return o(t)}return i}function wr(e,t,n,r,i,o,a,s){var u=xr(s,e,"ngTrueValue",n.ngTrueValue,!0),c=xr(s,e,"ngFalseValue",n.ngFalseValue,!1),l=function(e){r.$setViewValue(t[0].checked,e&&e.type)};t.on("click",l),r.$render=function(){t[0].checked=r.$viewValue},r.$isEmpty=function(e){return e===!1},r.$formatters.push(function(e){return B(e,u)}),r.$parsers.push(function(e){return e?u:c})}function Sr(e,t){return e="ngClass"+e,["$animate",function(n){function r(e,t){var n=[];e:for(var r=0;r<e.length;r++){for(var i=e[r],o=0;o<t.length;o++)if(i==t[o])continue e;n.push(i)}return n}function i(e){var t=[];return Wr(e)?(o(e,function(e){t=t.concat(i(e))}),t):S(e)?e.split(" "):x(e)?(o(e,function(e,n){e&&(t=t.concat(n.split(" ")))}),t):e}return{restrict:"AC",link:function(a,s,u){function c(e){var t=f(e,1);u.$addClass(t)}function l(e){var t=f(e,-1);u.$removeClass(t)}function f(e,t){var n=s.data("$classCounts")||me(),r=[];return o(e,function(e){(t>0||n[e])&&(n[e]=(n[e]||0)+t,n[e]===+(t>0)&&r.push(e))}),s.data("$classCounts",n),r.join(" ")}function p(e,t){var i=r(t,e),o=r(e,t);i=f(i,1),o=f(o,-1),i&&i.length&&n.addClass(s,i),o&&o.length&&n.removeClass(s,o)}function h(e){if(t===!0||a.$index%2===t){var n=i(e||[]);if(d){if(!B(e,d)){var r=i(d);p(r,n)}}else c(n)}d=L(e)}var d;a.$watch(u[e],h,!0),u.$observe("class",function(t){h(a.$eval(u[e]))}),"ngClass"!==e&&a.$watch("$index",function(n,r){var o=1&n;if(o!==(1&r)){var s=i(a.$eval(u[e]));o===t?c(s):l(s)}})}}}]}function Cr(e){function t(e,t,u){y(t)?r("$pending",e,u):i("$pending",e,u),V(t)?t?(f(s.$error,e,u),l(s.$$success,e,u)):(l(s.$error,e,u),f(s.$$success,e,u)):(f(s.$error,e,u),f(s.$$success,e,u)),s.$pending?(o(ma,!0),s.$valid=s.$invalid=n,a("",null)):(o(ma,!1),s.$valid=Er(s.$error),
s.$invalid=!s.$valid,a("",s.$valid));var c;c=s.$pending&&s.$pending[e]?n:s.$error[e]?!1:s.$$success[e]?!0:null,a(e,c),s.$$parentForm.$setValidity(e,c,s)}function r(e,t,n){s[e]||(s[e]={}),l(s[e],t,n)}function i(e,t,r){s[e]&&f(s[e],t,r),Er(s[e])&&(s[e]=n)}function o(e,t){t&&!c[e]?(p.addClass(u,e),c[e]=!0):!t&&c[e]&&(p.removeClass(u,e),c[e]=!1)}function a(e,t){e=e?"-"+le(e,"-"):"",o(fa+e,t===!0),o(pa+e,t===!1)}var s=e.ctrl,u=e.$element,c={},l=e.set,f=e.unset,p=e.$animate;c[pa]=!(c[fa]=u.hasClass(fa)),s.$setValidity=t}function Er(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function Ar(e){e[0].hasAttribute("selected")&&(e[0].selected=!0)}var kr=/^\/(.+)\/([a-z]*)$/,Or="validity",Mr=Object.prototype.hasOwnProperty,Tr=function(e){return S(e)?e.toLowerCase():e},Nr=function(e){return S(e)?e.toUpperCase():e},jr=function(e){return S(e)?e.replace(/[A-Z]/g,function(e){return String.fromCharCode(32|e.charCodeAt(0))}):e},Vr=function(e){return S(e)?e.replace(/[a-z]/g,function(e){return String.fromCharCode(-33&e.charCodeAt(0))}):e};"i"!=="I".toLowerCase()&&(Tr=jr,Nr=Vr);var Rr,Dr,Ir,Pr,_r=[].slice,Ur=[].splice,qr=[].push,Fr=Object.prototype.toString,Lr=Object.getPrototypeOf,Br=r("ng"),Hr=e.angular||(e.angular={}),zr=0;Rr=t.documentMode,$.$inject=[],v.$inject=[];var Wr=Array.isArray,Gr=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/,Jr=function(e){return S(e)?e.trim():e},Yr=function(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},Kr=function(){function e(){try{return new Function(""),!1}catch(e){return!0}}if(!b(Kr.rules)){var n=t.querySelector("[ng-csp]")||t.querySelector("[data-ng-csp]");if(n){var r=n.getAttribute("ng-csp")||n.getAttribute("data-ng-csp");Kr.rules={noUnsafeEval:!r||-1!==r.indexOf("no-unsafe-eval"),noInlineStyle:!r||-1!==r.indexOf("no-inline-style")}}else Kr.rules={noUnsafeEval:e(),noInlineStyle:!1}}return Kr.rules},Zr=function(){if(b(Zr.name_))return Zr.name_;var e,n,r,i,o=Qr.length;for(n=0;o>n;++n)if(r=Qr[n],e=t.querySelector("["+r.replace(":","\\:")+"jq]")){i=e.getAttribute(r+"jq");break}return Zr.name_=i},Xr=/:/g,Qr=["ng-","data-ng-","ng:","x-ng-"],ei=/[A-Z]/g,ti=!1,ni=1,ri=2,ii=3,oi=8,ai=9,si=11,ui={full:"1.5.0",major:1,minor:5,dot:0,codeName:"ennoblement-facilitation"};Ne.expando="ng339";var ci=Ne.cache={},li=1,fi=function(e,t,n){e.addEventListener(t,n,!1)},pi=function(e,t,n){e.removeEventListener(t,n,!1)};Ne._data=function(e){return this.cache[e[this.expando]]||{}};var hi=/([\:\-\_]+(.))/g,di=/^moz([A-Z])/,$i={mouseleave:"mouseout",mouseenter:"mouseover"},vi=r("jqLite"),mi=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,gi=/<|&#?\w+;/,yi=/<([\w:-]+)/,bi=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,xi={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};xi.optgroup=xi.option,xi.tbody=xi.tfoot=xi.colgroup=xi.caption=xi.thead,xi.th=xi.td;var wi=Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))},Si=Ne.prototype={ready:function(n){function r(){i||(i=!0,n())}var i=!1;"complete"===t.readyState?setTimeout(r):(this.on("DOMContentLoaded",r),Ne(e).on("load",r))},toString:function(){var e=[];return o(this,function(t){e.push(""+t)}),"["+e.join(", ")+"]"},eq:function(e){return Dr(e>=0?this[e]:this[this.length+e])},length:0,push:qr,sort:[].sort,splice:[].splice},Ci={};o("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(e){Ci[Tr(e)]=e});var Ei={};o("input,select,option,textarea,button,form,details".split(","),function(e){Ei[e]=!0});var Ai={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};o({data:Pe,removeData:De,hasData:Ae,cleanData:ke},function(e,t){Ne[t]=e}),o({data:Pe,inheritedData:Be,scope:function(e){return Dr.data(e,"$scope")||Be(e.parentNode||e,["$isolateScope","$scope"])},isolateScope:function(e){return Dr.data(e,"$isolateScope")||Dr.data(e,"$isolateScopeNoTemplate")},controller:Le,injector:function(e){return Be(e,"$injector")},removeAttr:function(e,t){e.removeAttribute(t)},hasClass:_e,css:function(e,t,n){return t=Se(t),b(n)?void(e.style[t]=n):e.style[t]},attr:function(e,t,r){var i=e.nodeType;if(i!==ii&&i!==ri&&i!==oi){var o=Tr(t);if(Ci[o]){if(!b(r))return e[t]||(e.attributes.getNamedItem(t)||$).specified?o:n;r?(e[t]=!0,e.setAttribute(t,o)):(e[t]=!1,e.removeAttribute(o))}else if(b(r))e.setAttribute(t,r);else if(e.getAttribute){var a=e.getAttribute(t,2);return null===a?n:a}}},prop:function(e,t,n){return b(n)?void(e[t]=n):e[t]},text:function(){function e(e,t){if(y(t)){var n=e.nodeType;return n===ni||n===ii?e.textContent:""}e.textContent=t}return e.$dv="",e}(),val:function(e,t){if(y(t)){if(e.multiple&&"select"===U(e)){var n=[];return o(e.options,function(e){e.selected&&n.push(e.value||e.text)}),0===n.length?null:n}return e.value}e.value=t},html:function(e,t){return y(t)?e.innerHTML:(Ve(e,!0),void(e.innerHTML=t))},empty:He},function(e,t){Ne.prototype[t]=function(t,n){var r,i,o=this.length;if(e!==He&&y(2==e.length&&e!==_e&&e!==Le?t:n)){if(x(t)){for(r=0;o>r;r++)if(e===Pe)e(this[r],t);else for(i in t)e(this[r],i,t[i]);return this}for(var a=e.$dv,s=y(a)?Math.min(o,1):o,u=0;s>u;u++){var c=e(this[u],t,n);a=a?a+c:c}return a}for(r=0;o>r;r++)e(this[r],t,n);return this}}),o({removeData:De,on:function(e,t,r,i){if(b(i))throw vi("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(Ee(e)){var o=Ie(e,!0),a=o.events,s=o.handle;s||(s=o.handle=Ye(e,a));for(var u=t.indexOf(" ")>=0?t.split(" "):[t],c=u.length,l=function(t,n,i){var o=a[t];o||(o=a[t]=[],o.specialHandlerWrapper=n,"$destroy"===t||i||fi(e,t,s)),o.push(r)};c--;)t=u[c],$i[t]?(l($i[t],Ze),l(t,n,!0)):l(t)}},off:Re,one:function(e,t,n){e=Dr(e),e.on(t,function r(){e.off(t,n),e.off(t,r)}),e.on(t,n)},replaceWith:function(e,t){var n,r=e.parentNode;Ve(e),o(new Ne(t),function(t){n?r.insertBefore(t,n.nextSibling):r.replaceChild(t,e),n=t})},children:function(e){var t=[];return o(e.childNodes,function(e){e.nodeType===ni&&t.push(e)}),t},contents:function(e){return e.contentDocument||e.childNodes||[]},append:function(e,t){var n=e.nodeType;if(n===ni||n===si){t=new Ne(t);for(var r=0,i=t.length;i>r;r++){var o=t[r];e.appendChild(o)}}},prepend:function(e,t){if(e.nodeType===ni){var n=e.firstChild;o(new Ne(t),function(t){e.insertBefore(t,n)})}},wrap:function(e,t){Te(e,Dr(t).eq(0).clone()[0])},remove:ze,detach:function(e){ze(e,!0)},after:function(e,t){var n=e,r=e.parentNode;t=new Ne(t);for(var i=0,o=t.length;o>i;i++){var a=t[i];r.insertBefore(a,n.nextSibling),n=a}},addClass:qe,removeClass:Ue,toggleClass:function(e,t,n){t&&o(t.split(" "),function(t){var r=n;y(r)&&(r=!_e(e,t)),(r?qe:Ue)(e,t)})},parent:function(e){var t=e.parentNode;return t&&t.nodeType!==si?t:null},next:function(e){return e.nextElementSibling},find:function(e,t){return e.getElementsByTagName?e.getElementsByTagName(t):[]},clone:je,triggerHandler:function(e,t,n){var r,i,a,s=t.type||t,u=Ie(e),c=u&&u.events,l=c&&c[s];l&&(r={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return this.immediatePropagationStopped===!0},stopPropagation:$,type:s,target:e},t.type&&(r=f(r,t)),i=L(l),a=n?[r].concat(n):[r],o(i,function(t){r.isImmediatePropagationStopped()||t.apply(e,a)}))}},function(e,t){Ne.prototype[t]=function(t,n,r){for(var i,o=0,a=this.length;a>o;o++)y(i)?(i=e(this[o],t,n,r),b(i)&&(i=Dr(i))):Fe(i,e(this[o],t,n,r));return b(i)?i:this},Ne.prototype.bind=Ne.prototype.on,Ne.prototype.unbind=Ne.prototype.off}),et.prototype={put:function(e,t){this[Qe(e,this.nextUid)]=t},get:function(e){return this[Qe(e,this.nextUid)]},remove:function(e){var t=this[e=Qe(e,this.nextUid)];return delete this[e],t}};var ki=[function(){this.$get=[function(){return et}]}],Oi=/^([^\(]+?)=>/,Mi=/^[^\(]*\(\s*([^\)]*)\)/m,Ti=/,/,Ni=/^\s*(_?)(\S+?)\1\s*$/,ji=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,Vi=r("$injector");it.$$annotate=rt;var Ri=r("$animate"),Di=1,Ii="ng-animate",Pi=function(){this.$get=function(){}},_i=function(){var e=new et,t=[];this.$get=["$$AnimateRunner","$rootScope",function(n,r){function i(e,t,n){var r=!1;return t&&(t=S(t)?t.split(" "):Wr(t)?t:[],o(t,function(t){t&&(r=!0,e[t]=n)})),r}function a(){o(t,function(t){var n=e.get(t);if(n){var r=ut(t.attr("class")),i="",a="";o(n,function(e,t){var n=!!r[t];e!==n&&(e?i+=(i.length?" ":"")+t:a+=(a.length?" ":"")+t)}),o(t,function(e){i&&qe(e,i),a&&Ue(e,a)}),e.remove(t)}}),t.length=0}function s(n,o,s){var u=e.get(n)||{},c=i(u,o,!0),l=i(u,s,!1);(c||l)&&(e.put(n,u),t.push(n),1===t.length&&r.$$postDigest(a))}return{enabled:$,on:$,off:$,pin:$,push:function(e,t,r,i){i&&i(),r=r||{},r.from&&e.css(r.from),r.to&&e.css(r.to),(r.addClass||r.removeClass)&&s(e,r.addClass,r.removeClass);var o=new n;return o.complete(),o}}}]},Ui=["$provide",function(e){var t=this;this.$$registeredAnimations=Object.create(null),this.register=function(n,r){if(n&&"."!==n.charAt(0))throw Ri("notcsel","Expecting class selector starting with '.' got '{0}'.",n);var i=n+"-animation";t.$$registeredAnimations[n.substr(1)]=i,e.factory(i,r)},this.classNameFilter=function(e){if(1===arguments.length&&(this.$$classNameFilter=e instanceof RegExp?e:null,this.$$classNameFilter)){var t=new RegExp("(\\s+|\\/)"+Ii+"(\\s+|\\/)");if(t.test(this.$$classNameFilter.toString()))throw Ri("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',Ii)}return this.$$classNameFilter},this.$get=["$$animateQueue",function(e){function t(e,t,n){if(n){var r=st(n);!r||r.parentNode||r.previousElementSibling||(n=null)}n?n.after(e):t.prepend(e)}return{on:e.on,off:e.off,pin:e.pin,enabled:e.enabled,cancel:function(e){e.end&&e.end()},enter:function(n,r,i,o){return r=r&&Dr(r),i=i&&Dr(i),r=r||i.parent(),t(n,r,i),e.push(n,"enter",ct(o))},move:function(n,r,i,o){return r=r&&Dr(r),i=i&&Dr(i),r=r||i.parent(),t(n,r,i),e.push(n,"move",ct(o))},leave:function(t,n){return e.push(t,"leave",ct(n),function(){t.remove()})},addClass:function(t,n,r){return r=ct(r),r.addClass=at(r.addclass,n),e.push(t,"addClass",r)},removeClass:function(t,n,r){return r=ct(r),r.removeClass=at(r.removeClass,n),e.push(t,"removeClass",r)},setClass:function(t,n,r,i){return i=ct(i),i.addClass=at(i.addClass,n),i.removeClass=at(i.removeClass,r),e.push(t,"setClass",i)},animate:function(t,n,r,i,o){return o=ct(o),o.from=o.from?f(o.from,n):n,o.to=o.to?f(o.to,r):r,i=i||"ng-inline-animate",o.tempClasses=at(o.tempClasses,i),e.push(t,"animate",o)}}}]}],qi=function(){this.$get=["$$rAF",function(e){function t(t){n.push(t),n.length>1||e(function(){for(var e=0;e<n.length;e++)n[e]();n=[]})}var n=[];return function(){var e=!1;return t(function(){e=!0}),function(n){e?n():t(n)}}}]},Fi=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$document","$timeout",function(e,t,n,r,i){function a(e){this.setHost(e);var t=n(),o=function(e){i(e,0,!1)};this._doneCallbacks=[],this._tick=function(e){var n=r[0];n&&n.hidden?o(e):t(e)},this._state=0}var s=0,u=1,c=2;return a.chain=function(e,t){function n(){return r===e.length?void t(!0):void e[r](function(e){return e===!1?void t(!1):(r++,void n())})}var r=0;n()},a.all=function(e,t){function n(n){i=i&&n,++r===e.length&&t(i)}var r=0,i=!0;o(e,function(e){e.done(n)})},a.prototype={setHost:function(e){this.host=e||{}},done:function(e){this._state===c?e():this._doneCallbacks.push(e)},progress:$,getPromise:function(){if(!this.promise){var t=this;this.promise=e(function(e,n){t.done(function(t){t===!1?n():e()})})}return this.promise},then:function(e,t){return this.getPromise().then(e,t)},"catch":function(e){return this.getPromise()["catch"](e)},"finally":function(e){return this.getPromise()["finally"](e)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(e){var t=this;t._state===s&&(t._state=u,t._tick(function(){t._resolve(e)}))},_resolve:function(e){this._state!==c&&(o(this._doneCallbacks,function(t){t(e)}),this._doneCallbacks.length=0,this._state=c)}},a}]},Li=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function(e,t,n){return function(t,r){function i(){return e(function(){o(),s||u.complete(),s=!0}),u}function o(){a.addClass&&(t.addClass(a.addClass),a.addClass=null),a.removeClass&&(t.removeClass(a.removeClass),a.removeClass=null),a.to&&(t.css(a.to),a.to=null)}var a=r||{};a.$$prepared||(a=F(a)),a.cleanupStyles&&(a.from=a.to=null),a.from&&(t.css(a.from),a.from=null);var s,u=new n;return{start:i,end:i}}}]},Bi=r("$compile");dt.$inject=["$provide","$$sanitizeUriProvider"];var Hi=/^((?:x|data)[\:\-_])/i,zi=r("$controller"),Wi=/^(\S+)(\s+as\s+([\w$]+))?$/,Gi=function(){this.$get=["$document",function(e){return function(t){return t?!t.nodeType&&t instanceof Dr&&(t=t[0]):t=e[0].body,t.offsetWidth+1}}]},Ji="application/json",Yi={"Content-Type":Ji+";charset=utf-8"},Ki=/^\[|^\{(?!\{)/,Zi={"[":/]$/,"{":/}$/},Xi=/^\)\]\}',?\n/,Qi=r("$http"),eo=function(e){return function(){throw Qi("legacy","The method `{0}` on the promise returned from `$http` has been disabled.",e)}},to=Hr.$interpolateMinErr=r("$interpolate");to.throwNoconcat=function(e){throw to("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",e)},to.interr=function(e,t){return to("interr","Can't interpolate: {0}\n{1}",e,t.toString())};var no=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,ro={http:80,https:443,ftp:21},io=r("$location"),oo={$$html5:!1,$$replace:!1,absUrl:Jt("$$absUrl"),url:function(e){if(y(e))return this.$$url;var t=no.exec(e);return(t[1]||""===e)&&this.path(decodeURIComponent(t[1])),(t[2]||t[1]||""===e)&&this.search(t[3]||""),this.hash(t[5]||""),this},protocol:Jt("$$protocol"),host:Jt("$$host"),port:Jt("$$port"),path:Yt("$$path",function(e){return e=null!==e?e.toString():"","/"==e.charAt(0)?e:"/"+e}),search:function(e,t){switch(arguments.length){case 0:return this.$$search;case 1:if(S(e)||C(e))e=e.toString(),this.$$search=te(e);else{if(!x(e))throw io("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");e=F(e,{}),o(e,function(t,n){null==t&&delete e[n]}),this.$$search=e}break;default:y(t)||null===t?delete this.$$search[e]:this.$$search[e]=t}return this.$$compose(),this},hash:Yt("$$hash",function(e){return null!==e?e.toString():""}),replace:function(){return this.$$replace=!0,this}};o([Gt,Wt,zt],function(e){e.prototype=Object.create(oo),e.prototype.state=function(t){if(!arguments.length)return this.$$state;if(e!==zt||!this.$$html5)throw io("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=y(t)?null:t,this}});var ao=r("$parse"),so=Function.prototype.call,uo=Function.prototype.apply,co=Function.prototype.bind,lo=me();o("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(e){lo[e]=!0});var fo={n:"\n",f:"\f",r:"\r",t:"	",v:"\x0B","'":"'",'"':'"'},po=function(e){this.options=e};po.prototype={constructor:po,lex:function(e){for(this.text=e,this.index=0,this.tokens=[];this.index<this.text.length;){var t=this.text.charAt(this.index);if('"'===t||"'"===t)this.readString(t);else if(this.isNumber(t)||"."===t&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(t))this.readIdent();else if(this.is(t,"(){}[].,;:?"))this.tokens.push({index:this.index,text:t}),this.index++;else if(this.isWhitespace(t))this.index++;else{var n=t+this.peek(),r=n+this.peek(2),i=lo[t],o=lo[n],a=lo[r];if(i||o||a){var s=a?r:o?n:t;this.tokens.push({index:this.index,text:s,operator:!0}),this.index+=s.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(e,t){return-1!==t.indexOf(e)},peek:function(e){var t=e||1;return this.index+t<this.text.length?this.text.charAt(this.index+t):!1},isNumber:function(e){return e>="0"&&"9">=e&&"string"==typeof e},isWhitespace:function(e){return" "===e||"\r"===e||"	"===e||"\n"===e||"\x0B"===e||""===e},isIdent:function(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e||"_"===e||"$"===e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,n){n=n||this.index;var r=b(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,n)+"]":" "+n;throw ao("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",e,r,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var n=Tr(this.text.charAt(this.index));if("."==n||this.isNumber(n))e+=n;else{var r=this.peek();if("e"==n&&this.isExpOperator(r))e+=n;else if(this.isExpOperator(n)&&r&&this.isNumber(r)&&"e"==e.charAt(e.length-1))e+=n;else{if(!this.isExpOperator(n)||r&&this.isNumber(r)||"e"!=e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:t,text:e,constant:!0,value:Number(e)})},readIdent:function(){for(var e=this.index;this.index<this.text.length;){var t=this.text.charAt(this.index);if(!this.isIdent(t)&&!this.isNumber(t))break;this.index++}this.tokens.push({index:e,text:this.text.slice(e,this.index),identifier:!0})},readString:function(e){var t=this.index;this.index++;for(var n="",r=e,i=!1;this.index<this.text.length;){var o=this.text.charAt(this.index);if(r+=o,i){if("u"===o){var a=this.text.substring(this.index+1,this.index+5);a.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+a+"]"),this.index+=4,n+=String.fromCharCode(parseInt(a,16))}else{var s=fo[o];n+=s||o}i=!1}else if("\\"===o)i=!0;else{if(o===e)return this.index++,void this.tokens.push({index:t,text:r,constant:!0,value:n});n+=o}this.index++}this.throwError("Unterminated quote",t)}};var ho=function(e,t){this.lexer=e,this.options=t};ho.Program="Program",ho.ExpressionStatement="ExpressionStatement",ho.AssignmentExpression="AssignmentExpression",ho.ConditionalExpression="ConditionalExpression",ho.LogicalExpression="LogicalExpression",ho.BinaryExpression="BinaryExpression",ho.UnaryExpression="UnaryExpression",ho.CallExpression="CallExpression",ho.MemberExpression="MemberExpression",ho.Identifier="Identifier",ho.Literal="Literal",ho.ArrayExpression="ArrayExpression",ho.Property="Property",ho.ObjectExpression="ObjectExpression",ho.ThisExpression="ThisExpression",ho.LocalsExpression="LocalsExpression",ho.NGValueParameter="NGValueParameter",ho.prototype={ast:function(e){this.text=e,this.tokens=this.lexer.lex(e);var t=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),t},program:function(){for(var e=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&e.push(this.expressionStatement()),!this.expect(";"))return{type:ho.Program,body:e}},expressionStatement:function(){return{type:ho.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var e,t=this.expression();e=this.expect("|");)t=this.filter(t);return t},expression:function(){return this.assignment()},assignment:function(){var e=this.ternary();return this.expect("=")&&(e={type:ho.AssignmentExpression,left:e,right:this.assignment(),operator:"="}),e},ternary:function(){var e,t,n=this.logicalOR();return this.expect("?")&&(e=this.expression(),this.consume(":"))?(t=this.expression(),{type:ho.ConditionalExpression,test:n,alternate:e,consequent:t}):n},logicalOR:function(){for(var e=this.logicalAND();this.expect("||");)e={type:ho.LogicalExpression,operator:"||",left:e,right:this.logicalAND()};return e},logicalAND:function(){for(var e=this.equality();this.expect("&&");)e={type:ho.LogicalExpression,operator:"&&",left:e,right:this.equality()};return e},equality:function(){for(var e,t=this.relational();e=this.expect("==","!=","===","!==");)t={type:ho.BinaryExpression,operator:e.text,left:t,right:this.relational()};return t},relational:function(){for(var e,t=this.additive();e=this.expect("<",">","<=",">=");)t={type:ho.BinaryExpression,operator:e.text,left:t,right:this.additive()};return t},additive:function(){for(var e,t=this.multiplicative();e=this.expect("+","-");)t={type:ho.BinaryExpression,operator:e.text,left:t,right:this.multiplicative()};return t},multiplicative:function(){for(var e,t=this.unary();e=this.expect("*","/","%");)t={type:ho.BinaryExpression,operator:e.text,left:t,right:this.unary()};return t},unary:function(){var e;return(e=this.expect("+","-","!"))?{type:ho.UnaryExpression,operator:e.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var e;this.expect("(")?(e=this.filterChain(),this.consume(")")):this.expect("[")?e=this.arrayDeclaration():this.expect("{")?e=this.object():this.constants.hasOwnProperty(this.peek().text)?e=F(this.constants[this.consume().text]):this.peek().identifier?e=this.identifier():this.peek().constant?e=this.constant():this.throwError("not a primary expression",this.peek());for(var t;t=this.expect("(","[",".");)"("===t.text?(e={type:ho.CallExpression,callee:e,arguments:this.parseArguments()},this.consume(")")):"["===t.text?(e={type:ho.MemberExpression,object:e,property:this.expression(),computed:!0},this.consume("]")):"."===t.text?e={type:ho.MemberExpression,object:e,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return e},filter:function(e){for(var t=[e],n={type:ho.CallExpression,callee:this.identifier(),arguments:t,filter:!0};this.expect(":");)t.push(this.expression());return n},parseArguments:function(){var e=[];if(")"!==this.peekToken().text)do e.push(this.expression());while(this.expect(","));return e},identifier:function(){var e=this.consume();return e.identifier||this.throwError("is not a valid identifier",e),{type:ho.Identifier,name:e.text}},constant:function(){return{type:ho.Literal,value:this.consume().value}},arrayDeclaration:function(){var e=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;e.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:ho.ArrayExpression,elements:e}},object:function(){var e,t=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;e={type:ho.Property,kind:"init"},this.peek().constant?e.key=this.constant():this.peek().identifier?e.key=this.identifier():this.throwError("invalid key",this.peek()),this.consume(":"),e.value=this.expression(),t.push(e)}while(this.expect(","));return this.consume("}"),{type:ho.ObjectExpression,properties:t}},throwError:function(e,t){throw ao("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",t.text,e,t.index+1,this.text,this.text.substring(t.index))},consume:function(e){if(0===this.tokens.length)throw ao("ueoe","Unexpected end of expression: {0}",this.text);var t=this.expect(e);return t||this.throwError("is unexpected, expecting ["+e+"]",this.peek()),t},peekToken:function(){if(0===this.tokens.length)throw ao("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e,t,n,r){return this.peekAhead(0,e,t,n,r)},peekAhead:function(e,t,n,r,i){if(this.tokens.length>e){var o=this.tokens[e],a=o.text;if(a===t||a===n||a===r||a===i||!t&&!n&&!r&&!i)return o}return!1},expect:function(e,t,n,r){var i=this.peek(e,t,n,r);return i?(this.tokens.shift(),i):!1},constants:{"true":{type:ho.Literal,value:!0},"false":{type:ho.Literal,value:!1},"null":{type:ho.Literal,value:null},undefined:{type:ho.Literal,value:n},"this":{type:ho.ThisExpression},$locals:{type:ho.LocalsExpression}}},hn.prototype={compile:function(e,t){var r=this,i=this.astBuilder.ast(e);this.state={nextId:0,filters:{},expensiveChecks:t,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},sn(i,r.$filter);var a,s="";if(this.stage="assign",a=ln(i)){this.state.computing="assign";var u=this.nextId();this.recurse(a,u),this.return_(u),s="fn.assign="+this.generateFunction("assign","s,v,l")}var c=un(i.body);r.stage="inputs",o(c,function(e,t){var n="fn"+t;r.state[n]={vars:[],body:[],own:{}},r.state.computing=n;var i=r.nextId();r.recurse(e,i),r.return_(i),r.state.inputs.push(n),e.watchId=t}),this.state.computing="fn",this.stage="main",this.recurse(i);var l='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+s+this.watchFns()+"return fn;",f=new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext","ifDefined","plus","text",l)(this.$filter,Xt,en,tn,Qt,nn,rn,on,e);return this.state=this.stage=n,f.literal=fn(i),f.constant=pn(i),f},USE:"use",STRICT:"strict",watchFns:function(){var e=[],t=this.state.inputs,n=this;return o(t,function(t){e.push("var "+t+"="+n.generateFunction(t,"s"))}),t.length&&e.push("fn.inputs=["+t.join(",")+"];"),e.join("")},generateFunction:function(e,t){return"function("+t+"){"+this.varsPrefix(e)+this.body(e)+"};"},filterPrefix:function(){var e=[],t=this;return o(this.state.filters,function(n,r){e.push(n+"=$filter("+t.escape(r)+")")}),e.length?"var "+e.join(",")+";":""},varsPrefix:function(e){return this.state[e].vars.length?"var "+this.state[e].vars.join(",")+";":""},body:function(e){return this.state[e].body.join("")},recurse:function(e,t,r,i,a,s){var u,c,l,f,p=this;if(i=i||$,!s&&b(e.watchId))return t=t||this.nextId(),void this.if_("i",this.lazyAssign(t,this.computedMember("i",e.watchId)),this.lazyRecurse(e,t,r,i,a,!0));switch(e.type){case ho.Program:o(e.body,function(t,r){p.recurse(t.expression,n,n,function(e){c=e}),r!==e.body.length-1?p.current().body.push(c,";"):p.return_(c)});break;case ho.Literal:f=this.escape(e.value),this.assign(t,f),i(f);break;case ho.UnaryExpression:this.recurse(e.argument,n,n,function(e){c=e}),f=e.operator+"("+this.ifDefined(c,0)+")",this.assign(t,f),i(f);break;case ho.BinaryExpression:this.recurse(e.left,n,n,function(e){u=e}),this.recurse(e.right,n,n,function(e){c=e}),f="+"===e.operator?this.plus(u,c):"-"===e.operator?this.ifDefined(u,0)+e.operator+this.ifDefined(c,0):"("+u+")"+e.operator+"("+c+")",this.assign(t,f),i(f);break;case ho.LogicalExpression:t=t||this.nextId(),p.recurse(e.left,t),p.if_("&&"===e.operator?t:p.not(t),p.lazyRecurse(e.right,t)),i(t);break;case ho.ConditionalExpression:t=t||this.nextId(),p.recurse(e.test,t),p.if_(t,p.lazyRecurse(e.alternate,t),p.lazyRecurse(e.consequent,t)),i(t);break;case ho.Identifier:t=t||this.nextId(),r&&(r.context="inputs"===p.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",e.name)+"?l:s"),r.computed=!1,r.name=e.name),Xt(e.name),p.if_("inputs"===p.stage||p.not(p.getHasOwnProperty("l",e.name)),function(){p.if_("inputs"===p.stage||"s",function(){a&&1!==a&&p.if_(p.not(p.nonComputedMember("s",e.name)),p.lazyAssign(p.nonComputedMember("s",e.name),"{}")),p.assign(t,p.nonComputedMember("s",e.name))})},t&&p.lazyAssign(t,p.nonComputedMember("l",e.name))),(p.state.expensiveChecks||$n(e.name))&&p.addEnsureSafeObject(t),i(t);break;case ho.MemberExpression:u=r&&(r.context=this.nextId())||this.nextId(),t=t||this.nextId(),p.recurse(e.object,u,n,function(){p.if_(p.notNull(u),function(){a&&1!==a&&p.addEnsureSafeAssignContext(u),e.computed?(c=p.nextId(),p.recurse(e.property,c),p.getStringValue(c),p.addEnsureSafeMemberName(c),a&&1!==a&&p.if_(p.not(p.computedMember(u,c)),p.lazyAssign(p.computedMember(u,c),"{}")),f=p.ensureSafeObject(p.computedMember(u,c)),p.assign(t,f),r&&(r.computed=!0,r.name=c)):(Xt(e.property.name),a&&1!==a&&p.if_(p.not(p.nonComputedMember(u,e.property.name)),p.lazyAssign(p.nonComputedMember(u,e.property.name),"{}")),f=p.nonComputedMember(u,e.property.name),(p.state.expensiveChecks||$n(e.property.name))&&(f=p.ensureSafeObject(f)),p.assign(t,f),r&&(r.computed=!1,r.name=e.property.name))},function(){p.assign(t,"undefined")}),i(t)},!!a);break;case ho.CallExpression:t=t||this.nextId(),e.filter?(c=p.filter(e.callee.name),l=[],o(e.arguments,function(e){var t=p.nextId();p.recurse(e,t),l.push(t)}),f=c+"("+l.join(",")+")",p.assign(t,f),i(t)):(c=p.nextId(),u={},l=[],p.recurse(e.callee,c,u,function(){p.if_(p.notNull(c),function(){p.addEnsureSafeFunction(c),o(e.arguments,function(e){p.recurse(e,p.nextId(),n,function(e){l.push(p.ensureSafeObject(e))})}),u.name?(p.state.expensiveChecks||p.addEnsureSafeObject(u.context),f=p.member(u.context,u.name,u.computed)+"("+l.join(",")+")"):f=c+"("+l.join(",")+")",f=p.ensureSafeObject(f),p.assign(t,f)},function(){p.assign(t,"undefined")}),i(t)}));break;case ho.AssignmentExpression:if(c=this.nextId(),u={},!cn(e.left))throw ao("lval","Trying to assign a value to a non l-value");this.recurse(e.left,n,u,function(){p.if_(p.notNull(u.context),function(){p.recurse(e.right,c),p.addEnsureSafeObject(p.member(u.context,u.name,u.computed)),p.addEnsureSafeAssignContext(u.context),f=p.member(u.context,u.name,u.computed)+e.operator+c,p.assign(t,f),i(t||f)})},1);break;case ho.ArrayExpression:l=[],o(e.elements,function(e){p.recurse(e,p.nextId(),n,function(e){l.push(e)})}),f="["+l.join(",")+"]",this.assign(t,f),i(f);break;case ho.ObjectExpression:l=[],o(e.properties,function(e){p.recurse(e.value,p.nextId(),n,function(t){l.push(p.escape(e.key.type===ho.Identifier?e.key.name:""+e.key.value)+":"+t)})}),f="{"+l.join(",")+"}",this.assign(t,f),i(f);break;case ho.ThisExpression:this.assign(t,"s"),i("s");break;case ho.LocalsExpression:this.assign(t,"l"),i("l");break;case ho.NGValueParameter:this.assign(t,"v"),i("v")}},getHasOwnProperty:function(e,t){var n=e+"."+t,r=this.current().own;return r.hasOwnProperty(n)||(r[n]=this.nextId(!1,e+"&&("+this.escape(t)+" in "+e+")")),r[n]},assign:function(e,t){return e?(this.current().body.push(e,"=",t,";"),e):void 0},filter:function(e){return this.state.filters.hasOwnProperty(e)||(this.state.filters[e]=this.nextId(!0)),this.state.filters[e]},ifDefined:function(e,t){return"ifDefined("+e+","+this.escape(t)+")"},plus:function(e,t){return"plus("+e+","+t+")"},return_:function(e){this.current().body.push("return ",e,";")},if_:function(e,t,n){if(e===!0)t();else{var r=this.current().body;r.push("if(",e,"){"),t(),r.push("}"),n&&(r.push("else{"),n(),r.push("}"))}},not:function(e){return"!("+e+")"},notNull:function(e){return e+"!=null"},nonComputedMember:function(e,t){return e+"."+t},computedMember:function(e,t){return e+"["+t+"]"},member:function(e,t,n){return n?this.computedMember(e,t):this.nonComputedMember(e,t)},addEnsureSafeObject:function(e){this.current().body.push(this.ensureSafeObject(e),";")},addEnsureSafeMemberName:function(e){this.current().body.push(this.ensureSafeMemberName(e),";")},addEnsureSafeFunction:function(e){this.current().body.push(this.ensureSafeFunction(e),";")},addEnsureSafeAssignContext:function(e){this.current().body.push(this.ensureSafeAssignContext(e),";")},ensureSafeObject:function(e){return"ensureSafeObject("+e+",text)"},ensureSafeMemberName:function(e){return"ensureSafeMemberName("+e+",text)"},ensureSafeFunction:function(e){return"ensureSafeFunction("+e+",text)"},getStringValue:function(e){this.assign(e,"getStringValue("+e+")")},ensureSafeAssignContext:function(e){return"ensureSafeAssignContext("+e+",text)"},lazyRecurse:function(e,t,n,r,i,o){var a=this;return function(){a.recurse(e,t,n,r,i,o)}},lazyAssign:function(e,t){var n=this;return function(){n.assign(e,t)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)},escape:function(e){if(S(e))return"'"+e.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(C(e))return e.toString();if(e===!0)return"true";if(e===!1)return"false";if(null===e)return"null";if("undefined"==typeof e)return"undefined";throw ao("esc","IMPOSSIBLE")},nextId:function(e,t){var n="v"+this.state.nextId++;return e||this.current().vars.push(n+(t?"="+t:"")),n},current:function(){
return this.state[this.state.computing]}},dn.prototype={compile:function(e,t){var n=this,r=this.astBuilder.ast(e);this.expression=e,this.expensiveChecks=t,sn(r,n.$filter);var i,a;(i=ln(r))&&(a=this.recurse(i));var s,u=un(r.body);u&&(s=[],o(u,function(e,t){var r=n.recurse(e);e.input=r,s.push(r),e.watchId=t}));var c=[];o(r.body,function(e){c.push(n.recurse(e.expression))});var l=0===r.body.length?function(){}:1===r.body.length?c[0]:function(e,t){var n;return o(c,function(r){n=r(e,t)}),n};return a&&(l.assign=function(e,t,n){return a(e,n,t)}),s&&(l.inputs=s),l.literal=fn(r),l.constant=pn(r),l},recurse:function(e,t,r){var i,a,s,u=this;if(e.input)return this.inputs(e.input,e.watchId);switch(e.type){case ho.Literal:return this.value(e.value,t);case ho.UnaryExpression:return a=this.recurse(e.argument),this["unary"+e.operator](a,t);case ho.BinaryExpression:return i=this.recurse(e.left),a=this.recurse(e.right),this["binary"+e.operator](i,a,t);case ho.LogicalExpression:return i=this.recurse(e.left),a=this.recurse(e.right),this["binary"+e.operator](i,a,t);case ho.ConditionalExpression:return this["ternary?:"](this.recurse(e.test),this.recurse(e.alternate),this.recurse(e.consequent),t);case ho.Identifier:return Xt(e.name,u.expression),u.identifier(e.name,u.expensiveChecks||$n(e.name),t,r,u.expression);case ho.MemberExpression:return i=this.recurse(e.object,!1,!!r),e.computed||(Xt(e.property.name,u.expression),a=e.property.name),e.computed&&(a=this.recurse(e.property)),e.computed?this.computedMember(i,a,t,r,u.expression):this.nonComputedMember(i,a,u.expensiveChecks,t,r,u.expression);case ho.CallExpression:return s=[],o(e.arguments,function(e){s.push(u.recurse(e))}),e.filter&&(a=this.$filter(e.callee.name)),e.filter||(a=this.recurse(e.callee,!0)),e.filter?function(e,r,i,o){for(var u=[],c=0;c<s.length;++c)u.push(s[c](e,r,i,o));var l=a.apply(n,u,o);return t?{context:n,name:n,value:l}:l}:function(e,n,r,i){var o,c=a(e,n,r,i);if(null!=c.value){en(c.context,u.expression),tn(c.value,u.expression);for(var l=[],f=0;f<s.length;++f)l.push(en(s[f](e,n,r,i),u.expression));o=en(c.value.apply(c.context,l),u.expression)}return t?{value:o}:o};case ho.AssignmentExpression:return i=this.recurse(e.left,!0,1),a=this.recurse(e.right),function(e,n,r,o){var s=i(e,n,r,o),c=a(e,n,r,o);return en(s.value,u.expression),nn(s.context),s.context[s.name]=c,t?{value:c}:c};case ho.ArrayExpression:return s=[],o(e.elements,function(e){s.push(u.recurse(e))}),function(e,n,r,i){for(var o=[],a=0;a<s.length;++a)o.push(s[a](e,n,r,i));return t?{value:o}:o};case ho.ObjectExpression:return s=[],o(e.properties,function(e){s.push({key:e.key.type===ho.Identifier?e.key.name:""+e.key.value,value:u.recurse(e.value)})}),function(e,n,r,i){for(var o={},a=0;a<s.length;++a)o[s[a].key]=s[a].value(e,n,r,i);return t?{value:o}:o};case ho.ThisExpression:return function(e){return t?{value:e}:e};case ho.LocalsExpression:return function(e,n){return t?{value:n}:n};case ho.NGValueParameter:return function(e,n,r,i){return t?{value:r}:r}}},"unary+":function(e,t){return function(n,r,i,o){var a=e(n,r,i,o);return a=b(a)?+a:0,t?{value:a}:a}},"unary-":function(e,t){return function(n,r,i,o){var a=e(n,r,i,o);return a=b(a)?-a:0,t?{value:a}:a}},"unary!":function(e,t){return function(n,r,i,o){var a=!e(n,r,i,o);return t?{value:a}:a}},"binary+":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a),u=t(r,i,o,a),c=on(s,u);return n?{value:c}:c}},"binary-":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a),u=t(r,i,o,a),c=(b(s)?s:0)-(b(u)?u:0);return n?{value:c}:c}},"binary*":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)*t(r,i,o,a);return n?{value:s}:s}},"binary/":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)/t(r,i,o,a);return n?{value:s}:s}},"binary%":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)%t(r,i,o,a);return n?{value:s}:s}},"binary===":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)===t(r,i,o,a);return n?{value:s}:s}},"binary!==":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)!==t(r,i,o,a);return n?{value:s}:s}},"binary==":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)==t(r,i,o,a);return n?{value:s}:s}},"binary!=":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)!=t(r,i,o,a);return n?{value:s}:s}},"binary<":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)<t(r,i,o,a);return n?{value:s}:s}},"binary>":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)>t(r,i,o,a);return n?{value:s}:s}},"binary<=":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)<=t(r,i,o,a);return n?{value:s}:s}},"binary>=":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)>=t(r,i,o,a);return n?{value:s}:s}},"binary&&":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)&&t(r,i,o,a);return n?{value:s}:s}},"binary||":function(e,t,n){return function(r,i,o,a){var s=e(r,i,o,a)||t(r,i,o,a);return n?{value:s}:s}},"ternary?:":function(e,t,n,r){return function(i,o,a,s){var u=e(i,o,a,s)?t(i,o,a,s):n(i,o,a,s);return r?{value:u}:u}},value:function(e,t){return function(){return t?{context:n,name:n,value:e}:e}},identifier:function(e,t,r,i,o){return function(a,s,u,c){var l=s&&e in s?s:a;i&&1!==i&&l&&!l[e]&&(l[e]={});var f=l?l[e]:n;return t&&en(f,o),r?{context:l,name:e,value:f}:f}},computedMember:function(e,t,n,r,i){return function(o,a,s,u){var c,l,f=e(o,a,s,u);return null!=f&&(c=t(o,a,s,u),c=Qt(c),Xt(c,i),r&&1!==r&&(nn(f),f&&!f[c]&&(f[c]={})),l=f[c],en(l,i)),n?{context:f,name:c,value:l}:l}},nonComputedMember:function(e,t,r,i,o,a){return function(s,u,c,l){var f=e(s,u,c,l);o&&1!==o&&(nn(f),f&&!f[t]&&(f[t]={}));var p=null!=f?f[t]:n;return(r||$n(t))&&en(p,a),i?{context:f,name:t,value:p}:p}},inputs:function(e,t){return function(n,r,i,o){return o?o[t]:e(n,r,i)}}};var $o=function(e,t,n){this.lexer=e,this.$filter=t,this.options=n,this.ast=new ho(this.lexer),this.astCompiler=n.csp?new dn(this.ast,t):new hn(this.ast,t)};$o.prototype={constructor:$o,parse:function(e){return this.astCompiler.compile(e,this.options.expensiveChecks)}};var vo=Object.prototype.valueOf,mo=r("$sce"),go={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},Bi=r("$compile"),yo=t.createElement("a"),bo=jn(e.location.href);Dn.$inject=["$document"],Pn.$inject=["$provide"];var xo=22,wo=".",So="0";Ln.$inject=["$locale"],Bn.$inject=["$locale"];var Co={yyyy:Jn("FullYear",4),yy:Jn("FullYear",2,0,!0),y:Jn("FullYear",1),MMMM:Yn("Month"),MMM:Yn("Month",!0),MM:Jn("Month",2,1),M:Jn("Month",1,1),dd:Jn("Date",2),d:Jn("Date",1),HH:Jn("Hours",2),H:Jn("Hours",1),hh:Jn("Hours",2,-12),h:Jn("Hours",1,-12),mm:Jn("Minutes",2),m:Jn("Minutes",1),ss:Jn("Seconds",2),s:Jn("Seconds",1),sss:Jn("Milliseconds",3),EEEE:Yn("Day"),EEE:Yn("Day",!0),a:er,Z:Kn,ww:Qn(2),w:Qn(1),G:tr,GG:tr,GGG:tr,GGGG:nr},Eo=/((?:[^yMdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,Ao=/^\-?\d+$/;rr.$inject=["$locale"];var ko=m(Tr),Oo=m(Nr);ar.$inject=["$parse"];var Mo=m({restrict:"E",compile:function(e,t){return t.href||t.xlinkHref?void 0:function(e,t){if("a"===t[0].nodeName.toLowerCase()){var n="[object SVGAnimatedString]"===Fr.call(t.prop("href"))?"xlink:href":"href";t.on("click",function(e){t.attr(n)||e.preventDefault()})}}}}),To={};o(Ci,function(e,t){function n(e,n,i){e.$watch(i[r],function(e){i.$set(t,!!e)})}if("multiple"!=e){var r=$t("ng-"+t),i=n;"checked"===e&&(i=function(e,t,i){i.ngModel!==i[r]&&n(e,t,i)}),To[r]=function(){return{restrict:"A",priority:100,link:i}}}}),o(Ai,function(e,t){To[t]=function(){return{priority:100,link:function(e,n,r){if("ngPattern"===t&&"/"==r.ngPattern.charAt(0)){var i=r.ngPattern.match(kr);if(i)return void r.$set("ngPattern",new RegExp(i[1],i[2]))}e.$watch(r[t],function(e){r.$set(t,e)})}}}}),o(["src","srcset","href"],function(e){var t=$t("ng-"+e);To[t]=function(){return{priority:99,link:function(n,r,i){var o=e,a=e;"href"===e&&"[object SVGAnimatedString]"===Fr.call(r.prop("href"))&&(a="xlinkHref",i.$attr[a]="xlink:href",o=null),i.$observe(t,function(t){return t?(i.$set(a,t),void(Rr&&o&&r.prop(o,i[a]))):void("href"===e&&i.$set(a,null))})}}}});var No={$addControl:$,$$renameControl:ur,$removeControl:$,$setValidity:$,$setDirty:$,$setPristine:$,$setSubmitted:$},jo="ng-submitted";cr.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var Vo=function(e){return["$timeout","$parse",function(t,r){function i(e){return""===e?r('this[""]').assign:r(e).assign||$}var o={name:"form",restrict:e?"EAC":"E",require:["form","^^?form"],controller:cr,compile:function(r,o){r.addClass(ha).addClass(fa);var a=o.name?"name":e&&o.ngForm?"ngForm":!1;return{pre:function(e,r,o,s){var u=s[0];if(!("action"in o)){var c=function(t){e.$apply(function(){u.$commitViewValue(),u.$setSubmitted()}),t.preventDefault()};fi(r[0],"submit",c),r.on("$destroy",function(){t(function(){pi(r[0],"submit",c)},0,!1)})}var l=s[1]||u.$$parentForm;l.$addControl(u);var p=a?i(u.$name):$;a&&(p(e,u),o.$observe(a,function(t){u.$name!==t&&(p(e,n),u.$$parentForm.$$renameControl(u,t),(p=i(u.$name))(e,u))})),r.on("$destroy",function(){u.$$parentForm.$removeControl(u),p(e,n),f(u,No)})}}}};return o}]},Ro=Vo(),Do=Vo(!0),Io=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,Po=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:\/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,_o=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,Uo=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,qo=/^(\d{4})-(\d{2})-(\d{2})$/,Fo=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Lo=/^(\d{4})-W(\d\d)$/,Bo=/^(\d{4})-(\d\d)$/,Ho=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,zo={text:fr,date:$r("date",qo,dr(qo,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":$r("datetimelocal",Fo,dr(Fo,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:$r("time",Ho,dr(Ho,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:$r("week",Lo,hr,"yyyy-Www"),month:$r("month",Bo,dr(Bo,["yyyy","MM"]),"yyyy-MM"),number:mr,url:gr,email:yr,radio:br,checkbox:wr,hidden:$,button:$,submit:$,reset:$,file:$},Wo=["$browser","$sniffer","$filter","$parse",function(e,t,n,r){return{restrict:"E",require:["?ngModel"],link:{pre:function(i,o,a,s){s[0]&&(zo[Tr(a.type)]||zo.text)(i,o,a,s[0],t,e,n,r)}}}}],Go=/^(true|false|\d+)$/,Jo=function(){return{restrict:"A",priority:100,compile:function(e,t){return Go.test(t.ngValue)?function(e,t,n){n.$set("value",e.$eval(n.ngValue))}:function(e,t,n){e.$watch(n.ngValue,function(e){n.$set("value",e)})}}}},Yo=["$compile",function(e){return{restrict:"AC",compile:function(t){return e.$$addBindingClass(t),function(t,n,r){e.$$addBindingInfo(n,r.ngBind),n=n[0],t.$watch(r.ngBind,function(e){n.textContent=y(e)?"":e})}}}}],Ko=["$interpolate","$compile",function(e,t){return{compile:function(n){return t.$$addBindingClass(n),function(n,r,i){var o=e(r.attr(i.$attr.ngBindTemplate));t.$$addBindingInfo(r,o.expressions),r=r[0],i.$observe("ngBindTemplate",function(e){r.textContent=y(e)?"":e})}}}}],Zo=["$sce","$parse","$compile",function(e,t,n){return{restrict:"A",compile:function(r,i){var o=t(i.ngBindHtml),a=t(i.ngBindHtml,function(e){return(e||"").toString()});return n.$$addBindingClass(r),function(t,r,i){n.$$addBindingInfo(r,i.ngBindHtml),t.$watch(a,function(){r.html(e.getTrustedHtml(o(t))||"")})}}}}],Xo=m({restrict:"A",require:"ngModel",link:function(e,t,n,r){r.$viewChangeListeners.push(function(){e.$eval(n.ngChange)})}}),Qo=Sr("",!0),ea=Sr("Odd",0),ta=Sr("Even",1),na=sr({compile:function(e,t){t.$set("ngCloak",n),e.removeClass("ng-cloak")}}),ra=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ia={},oa={blur:!0,focus:!0};o("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(e){var t=$t("ng-"+e);ia[t]=["$parse","$rootScope",function(n,r){return{restrict:"A",compile:function(i,o){var a=n(o[t],null,!0);return function(t,n){n.on(e,function(n){var i=function(){a(t,{$event:n})};oa[e]&&r.$$phase?t.$evalAsync(i):t.$apply(i)})}}}}]});var aa=["$animate",function(e){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(n,r,i,o,a){var s,u,c;n.$watch(i.ngIf,function(n){n?u||a(function(n,o){u=o,n[n.length++]=t.createComment(" end ngIf: "+i.ngIf+" "),s={clone:n},e.enter(n,r.parent(),r)}):(c&&(c.remove(),c=null),u&&(u.$destroy(),u=null),s&&(c=ve(s.clone),e.leave(c).then(function(){c=null}),s=null))})}}}],sa=["$templateRequest","$anchorScroll","$animate",function(e,t,n){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Hr.noop,compile:function(r,i){var o=i.ngInclude||i.src,a=i.onload||"",s=i.autoscroll;return function(r,i,u,c,l){var f,p,h,d=0,$=function(){p&&(p.remove(),p=null),f&&(f.$destroy(),f=null),h&&(n.leave(h).then(function(){p=null}),p=h,h=null)};r.$watch(o,function(o){var u=function(){!b(s)||s&&!r.$eval(s)||t()},p=++d;o?(e(o,!0).then(function(e){if(!r.$$destroyed&&p===d){var t=r.$new();c.template=e;var s=l(t,function(e){$(),n.enter(e,null,i).then(u)});f=t,h=s,f.$emit("$includeContentLoaded",o),r.$eval(a)}},function(){r.$$destroyed||p===d&&($(),r.$emit("$includeContentError",o))}),r.$emit("$includeContentRequested",o)):($(),c.template=null)})}}}}],ua=["$compile",function(e){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(n,r,i,o){return Fr.call(r[0]).match(/SVG/)?(r.empty(),void e(Oe(o.template,t).childNodes)(n,function(e){r.append(e)},{futureParentElement:r})):(r.html(o.template),void e(r.contents())(n))}}}],ca=sr({priority:450,compile:function(){return{pre:function(e,t,n){e.$eval(n.ngInit)}}}}),la=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(e,t,r,i){var a=t.attr(r.$attr.ngList)||", ",s="false"!==r.ngTrim,u=s?Jr(a):a,c=function(e){if(!y(e)){var t=[];return e&&o(e.split(u),function(e){e&&t.push(s?Jr(e):e)}),t}};i.$parsers.push(c),i.$formatters.push(function(e){return Wr(e)?e.join(a):n}),i.$isEmpty=function(e){return!e||!e.length}}}},fa="ng-valid",pa="ng-invalid",ha="ng-pristine",da="ng-dirty",$a="ng-untouched",va="ng-touched",ma="ng-pending",ga="ng-empty",ya="ng-not-empty",ba=r("ngModel"),xa=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(e,t,r,i,a,s,u,c,l,f){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=n,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=n,this.$name=f(r.name||"",!1)(e),this.$$parentForm=No;var p,h=a(r.ngModel),d=h.assign,v=h,m=d,g=null,x=this;this.$$setOptions=function(e){if(x.$options=e,e&&e.getterSetter){var t=a(r.ngModel+"()"),n=a(r.ngModel+"($$$p)");v=function(e){var n=h(e);return A(n)&&(n=t(e)),n},m=function(e,t){A(h(e))?n(e,{$$$p:x.$modelValue}):d(e,x.$modelValue)}}else if(!h.assign)throw ba("nonassign","Expression '{0}' is non-assignable. Element: {1}",r.ngModel,Q(i))},this.$render=$,this.$isEmpty=function(e){return y(e)||""===e||null===e||e!==e},this.$$updateEmptyClasses=function(e){x.$isEmpty(e)?(s.removeClass(i,ya),s.addClass(i,ga)):(s.removeClass(i,ga),s.addClass(i,ya))};var w=0;Cr({ctrl:this,$element:i,set:function(e,t){e[t]=!0},unset:function(e,t){delete e[t]},$animate:s}),this.$setPristine=function(){x.$dirty=!1,x.$pristine=!0,s.removeClass(i,da),s.addClass(i,ha)},this.$setDirty=function(){x.$dirty=!0,x.$pristine=!1,s.removeClass(i,ha),s.addClass(i,da),x.$$parentForm.$setDirty()},this.$setUntouched=function(){x.$touched=!1,x.$untouched=!0,s.setClass(i,$a,va)},this.$setTouched=function(){x.$touched=!0,x.$untouched=!1,s.setClass(i,va,$a)},this.$rollbackViewValue=function(){u.cancel(g),x.$viewValue=x.$$lastCommittedViewValue,x.$render()},this.$validate=function(){if(!C(x.$modelValue)||!isNaN(x.$modelValue)){var e=x.$$lastCommittedViewValue,t=x.$$rawModelValue,r=x.$valid,i=x.$modelValue,o=x.$options&&x.$options.allowInvalid;x.$$runValidators(t,e,function(e){o||r===e||(x.$modelValue=e?t:n,x.$modelValue!==i&&x.$$writeModelToScope())})}},this.$$runValidators=function(e,t,r){function i(){var e=x.$$parserName||"parse";return y(p)?(u(e,null),!0):(p||(o(x.$validators,function(e,t){u(t,null)}),o(x.$asyncValidators,function(e,t){u(t,null)})),u(e,p),p)}function a(){var n=!0;return o(x.$validators,function(r,i){var o=r(e,t);n=n&&o,u(i,o)}),n?!0:(o(x.$asyncValidators,function(e,t){u(t,null)}),!1)}function s(){var r=[],i=!0;o(x.$asyncValidators,function(o,a){var s=o(e,t);if(!R(s))throw ba("nopromise","Expected asynchronous validator to return a promise but got '{0}' instead.",s);u(a,n),r.push(s.then(function(){u(a,!0)},function(e){i=!1,u(a,!1)}))}),r.length?l.all(r).then(function(){c(i)},$):c(!0)}function u(e,t){f===w&&x.$setValidity(e,t)}function c(e){f===w&&r(e)}w++;var f=w;return i()&&a()?void s():void c(!1)},this.$commitViewValue=function(){var e=x.$viewValue;u.cancel(g),(x.$$lastCommittedViewValue!==e||""===e&&x.$$hasNativeValidators)&&(x.$$updateEmptyClasses(e),x.$$lastCommittedViewValue=e,x.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function t(){x.$modelValue!==a&&x.$$writeModelToScope()}var r=x.$$lastCommittedViewValue,i=r;if(p=y(i)?n:!0)for(var o=0;o<x.$parsers.length;o++)if(i=x.$parsers[o](i),y(i)){p=!1;break}C(x.$modelValue)&&isNaN(x.$modelValue)&&(x.$modelValue=v(e));var a=x.$modelValue,s=x.$options&&x.$options.allowInvalid;x.$$rawModelValue=i,s&&(x.$modelValue=i,t()),x.$$runValidators(i,x.$$lastCommittedViewValue,function(e){s||(x.$modelValue=e?i:n,t())})},this.$$writeModelToScope=function(){m(e,x.$modelValue),o(x.$viewChangeListeners,function(e){try{e()}catch(n){t(n)}})},this.$setViewValue=function(e,t){x.$viewValue=e,x.$options&&!x.$options.updateOnDefault||x.$$debounceViewValueCommit(t)},this.$$debounceViewValueCommit=function(t){var n,r=0,i=x.$options;i&&b(i.debounce)&&(n=i.debounce,C(n)?r=n:C(n[t])?r=n[t]:C(n["default"])&&(r=n["default"])),u.cancel(g),r?g=u(function(){x.$commitViewValue()},r):c.$$phase?x.$commitViewValue():e.$apply(function(){x.$commitViewValue()})},e.$watch(function(){var t=v(e);if(t!==x.$modelValue&&(x.$modelValue===x.$modelValue||t===t)){x.$modelValue=x.$$rawModelValue=t,p=n;for(var r=x.$formatters,i=r.length,o=t;i--;)o=r[i](o);x.$viewValue!==o&&(x.$$updateEmptyClasses(o),x.$viewValue=x.$$lastCommittedViewValue=o,x.$render(),x.$$runValidators(t,o,$))}return t})}],wa=["$rootScope",function(e){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:xa,priority:1,compile:function(t){return t.addClass(ha).addClass($a).addClass(fa),{pre:function(e,t,n,r){var i=r[0],o=r[1]||i.$$parentForm;i.$$setOptions(r[2]&&r[2].$options),o.$addControl(i),n.$observe("name",function(e){i.$name!==e&&i.$$parentForm.$$renameControl(i,e)}),e.$on("$destroy",function(){i.$$parentForm.$removeControl(i)})},post:function(t,n,r,i){var o=i[0];o.$options&&o.$options.updateOn&&n.on(o.$options.updateOn,function(e){o.$$debounceViewValueCommit(e&&e.type)}),n.on("blur",function(n){o.$touched||(e.$$phase?t.$evalAsync(o.$setTouched):t.$apply(o.$setTouched))})}}}}}],Sa=/(\s+|^)default(\s+|$)/,Ca=function(){return{restrict:"A",controller:["$scope","$attrs",function(e,t){var n=this;this.$options=F(e.$eval(t.ngModelOptions)),b(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=Jr(this.$options.updateOn.replace(Sa,function(){return n.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},Ea=sr({terminal:!0,priority:1e3}),Aa=r("ngOptions"),ka=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,Oa=["$compile","$parse",function(e,n){function r(e,t,r){function o(e,t,n,r,i){this.selectValue=e,this.viewValue=t,this.label=n,this.group=r,this.disabled=i}function a(e){var t;if(!c&&i(e))t=e;else{t=[];for(var n in e)e.hasOwnProperty(n)&&"$"!==n.charAt(0)&&t.push(n)}return t}var s=e.match(ka);if(!s)throw Aa("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",e,Q(t));var u=s[5]||s[7],c=s[6],l=/ as /.test(s[0])&&s[1],f=s[9],p=n(s[2]?s[1]:u),h=l&&n(l),d=h||p,$=f&&n(f),v=f?function(e,t){return $(r,t)}:function(e){return Qe(e)},m=function(e,t){return v(e,S(e,t))},g=n(s[2]||s[1]),y=n(s[3]||""),b=n(s[4]||""),x=n(s[8]),w={},S=c?function(e,t){return w[c]=t,w[u]=e,w}:function(e){return w[u]=e,w};return{trackBy:f,getTrackByValue:m,getWatchables:n(x,function(e){var t=[];e=e||[];for(var n=a(e),i=n.length,o=0;i>o;o++){var u=e===n?o:n[o],c=(e[u],S(e[u],u)),l=v(e[u],c);if(t.push(l),s[2]||s[1]){var f=g(r,c);t.push(f)}if(s[4]){var p=b(r,c);t.push(p)}}return t}),getOptions:function(){for(var e=[],t={},n=x(r)||[],i=a(n),s=i.length,u=0;s>u;u++){var c=n===i?u:i[u],l=n[c],p=S(l,c),h=d(r,p),$=v(h,p),w=g(r,p),C=y(r,p),E=b(r,p),A=new o($,h,w,C,E);e.push(A),t[$]=A}return{items:e,selectValueMap:t,getOptionFromViewValue:function(e){return t[m(e)]},getViewValueFromOption:function(e){return f?Hr.copy(e.viewValue):e.viewValue}}}}}function a(t,n,i,a){function c(e,t){e.element=t,t.disabled=e.disabled,e.label!==t.label&&(t.label=e.label,t.textContent=e.label),e.value!==t.value&&(t.value=e.selectValue)}function l(e,t,n,r){var i;return t&&Tr(t.nodeName)===n?i=t:(i=r.cloneNode(!1),t?e.insertBefore(i,t):e.appendChild(i)),i}function f(e){for(var t;e;)t=e.nextSibling,ze(e),e=t}function p(e){var t=d&&d[0],n=S&&S[0];if(t||n)for(;e&&(e===t||e===n||e.nodeType===oi||"option"===U(e)&&""===e.value);)e=e.nextSibling;return e}function h(){var e=C&&$.readValue();C=E.getOptions();var t={},r=n[0].firstChild;if(w&&n.prepend(d),r=p(r),C.items.forEach(function(e){var i,o,a;b(e.group)?(i=t[e.group],i||(o=l(n[0],r,"optgroup",u),r=o.nextSibling,o.label=e.group,i=t[e.group]={groupElement:o,currentOptionElement:o.firstChild}),a=l(i.groupElement,i.currentOptionElement,"option",s),c(e,a),i.currentOptionElement=a.nextSibling):(a=l(n[0],r,"option",s),c(e,a),r=a.nextSibling)}),Object.keys(t).forEach(function(e){f(t[e].currentOptionElement)}),f(r),v.$render(),!v.$isEmpty(e)){var i=$.readValue(),o=E.trackBy||m;(o?B(e,i):e===i)||(v.$setViewValue(i),v.$render())}}for(var d,$=a[0],v=a[1],m=i.multiple,g=0,y=n.children(),x=y.length;x>g;g++)if(""===y[g].value){d=y.eq(g);break}var w=!!d,S=Dr(s.cloneNode(!1));S.val("?");var C,E=r(i.ngOptions,n,t),A=function(){w||n.prepend(d),n.val(""),d.prop("selected",!0),d.attr("selected",!0)},k=function(){w||d.remove()},O=function(){n.prepend(S),n.val("?"),S.prop("selected",!0),S.attr("selected",!0)},M=function(){S.remove()};m?(v.$isEmpty=function(e){return!e||0===e.length},$.writeValue=function(e){C.items.forEach(function(e){e.element.selected=!1}),e&&e.forEach(function(e){var t=C.getOptionFromViewValue(e);t&&!t.disabled&&(t.element.selected=!0)})},$.readValue=function(){var e=n.val()||[],t=[];return o(e,function(e){var n=C.selectValueMap[e];n&&!n.disabled&&t.push(C.getViewValueFromOption(n))}),t},E.trackBy&&t.$watchCollection(function(){return Wr(v.$viewValue)?v.$viewValue.map(function(e){return E.getTrackByValue(e)}):void 0},function(){v.$render()})):($.writeValue=function(e){var t=C.getOptionFromViewValue(e);t&&!t.disabled?n[0].value!==t.selectValue&&(M(),k(),n[0].value=t.selectValue,t.element.selected=!0,t.element.setAttribute("selected","selected")):null===e||w?(M(),A()):(k(),O())},$.readValue=function(){var e=C.selectValueMap[n.val()];return e&&!e.disabled?(k(),M(),C.getViewValueFromOption(e)):null},E.trackBy&&t.$watch(function(){return E.getTrackByValue(v.$viewValue)},function(){v.$render()})),w?(d.remove(),e(d)(t),d.removeClass("ng-scope")):d=Dr(s.cloneNode(!1)),h(),t.$watchCollection(E.getWatchables,h)}var s=t.createElement("option"),u=t.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(e,t,n,r){r[0].registerOption=$},post:a}}}],Ma=["$locale","$interpolate","$log",function(e,t,n){var r=/{}/g,i=/^when(Minus)?(.+)$/;return{link:function(a,s,u){function c(e){s.text(e||"")}var l,f=u.count,p=u.$attr.when&&s.attr(u.$attr.when),h=u.offset||0,d=a.$eval(p)||{},v={},m=t.startSymbol(),g=t.endSymbol(),b=m+f+"-"+h+g,x=Hr.noop;o(u,function(e,t){var n=i.exec(t);if(n){var r=(n[1]?"-":"")+Tr(n[2]);d[r]=s.attr(u.$attr[t])}}),o(d,function(e,n){v[n]=t(e.replace(r,b))}),a.$watch(f,function(t){var r=parseFloat(t),i=isNaN(r);if(i||r in d||(r=e.pluralCat(r-h)),r!==l&&!(i&&C(l)&&isNaN(l))){x();var o=v[r];y(o)?(null!=t&&n.debug("ngPluralize: no rule defined for '"+r+"' in "+p),x=$,c()):x=a.$watch(o,c),l=r}})}}}],Ta=["$parse","$animate",function(e,a){var s="$$NG_REMOVED",u=r("ngRepeat"),c=function(e,t,n,r,i,o,a){e[n]=r,i&&(e[i]=o),e.$index=t,e.$first=0===t,e.$last=t===a-1,e.$middle=!(e.$first||e.$last),e.$odd=!(e.$even=0===(1&t))},l=function(e){return e.clone[0]},f=function(e){return e.clone[e.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function(r,p){var h=p.ngRepeat,d=t.createComment(" end ngRepeat: "+h+" "),$=h.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!$)throw u("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",h);var v=$[1],m=$[2],g=$[3],y=$[4];if($=v.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/),!$)throw u("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",v);var b=$[3]||$[1],x=$[2];if(g&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(g)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(g)))throw u("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",g);var w,S,C,E,A={$id:Qe};return y?w=e(y):(C=function(e,t){return Qe(t)},E=function(e){return e}),function(e,t,r,p,$){w&&(S=function(t,n,r){return x&&(A[x]=t),A[b]=n,A.$index=r,w(e,A)});var v=me();e.$watchCollection(m,function(r){var p,m,y,w,A,k,O,M,T,N,j,V,R=t[0],D=me();if(g&&(e[g]=r),i(r))T=r,M=S||C;else{M=S||E,T=[];for(var I in r)Mr.call(r,I)&&"$"!==I.charAt(0)&&T.push(I)}for(w=T.length,j=new Array(w),p=0;w>p;p++)if(A=r===T?p:T[p],k=r[A],O=M(A,k,p),v[O])N=v[O],delete v[O],D[O]=N,j[p]=N;else{if(D[O])throw o(j,function(e){e&&e.scope&&(v[e.id]=e)}),u("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",h,O,k);j[p]={id:O,scope:n,clone:n},D[O]=!0}for(var P in v){if(N=v[P],V=ve(N.clone),a.leave(V),V[0].parentNode)for(p=0,m=V.length;m>p;p++)V[p][s]=!0;N.scope.$destroy()}for(p=0;w>p;p++)if(A=r===T?p:T[p],k=r[A],N=j[p],N.scope){y=R;do y=y.nextSibling;while(y&&y[s]);l(N)!=y&&a.move(ve(N.clone),null,Dr(R)),R=f(N),c(N.scope,p,b,k,x,A,w)}else $(function(e,t){N.scope=t;var n=d.cloneNode(!1);e[e.length++]=n,a.enter(e,null,Dr(R)),R=n,N.clone=e,D[N.id]=N,c(N.scope,p,b,k,x,A,w)});v=D})}}}}],Na="ng-hide",ja="ng-hide-animate",Va=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,r){t.$watch(r.ngShow,function(t){e[t?"removeClass":"addClass"](n,Na,{tempClasses:ja})})}}}],Ra=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,r){t.$watch(r.ngHide,function(t){e[t?"addClass":"removeClass"](n,Na,{tempClasses:ja})})}}}],Da=sr(function(e,t,n){e.$watch(n.ngStyle,function(e,n){n&&e!==n&&o(n,function(e,n){t.css(n,"")}),e&&t.css(e)},!0)}),Ia=["$animate",function(e){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(n,r,i,a){var s=i.ngSwitch||i.on,u=[],c=[],l=[],f=[],p=function(e,t){return function(){e.splice(t,1)}};n.$watch(s,function(n){var r,i;for(r=0,i=l.length;i>r;++r)e.cancel(l[r]);for(l.length=0,r=0,i=f.length;i>r;++r){var s=ve(c[r].clone);f[r].$destroy();var h=l[r]=e.leave(s);h.then(p(l,r))}c.length=0,f.length=0,(u=a.cases["!"+n]||a.cases["?"])&&o(u,function(n){n.transclude(function(r,i){f.push(i);var o=n.element;r[r.length++]=t.createComment(" end ngSwitchWhen: ");var a={clone:r};c.push(a),e.enter(r,o.parent(),o)})})})}}}],Pa=sr({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,r,i){r.cases["!"+n.ngSwitchWhen]=r.cases["!"+n.ngSwitchWhen]||[],r.cases["!"+n.ngSwitchWhen].push({transclude:i,element:t})}}),_a=sr({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,r,i){r.cases["?"]=r.cases["?"]||[],r.cases["?"].push({transclude:i,element:t})}}),Ua=r("ngTransclude"),qa=sr({restrict:"EAC",link:function(e,t,n,r,i){function o(e){e.length&&(t.empty(),t.append(e))}if(n.ngTransclude===n.$attr.ngTransclude&&(n.ngTransclude=""),!i)throw Ua("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",Q(t));var a=n.ngTransclude||n.ngTranscludeSlot;i(o,null,a)}}),Fa=["$templateCache",function(e){return{restrict:"E",terminal:!0,compile:function(t,n){if("text/ng-template"==n.type){var r=n.id,i=t[0].text;e.put(r,i)}}}}],La={$setViewValue:$,$render:$},Ba=["$element","$scope","$attrs",function(e,r,i){var o=this,a=new et;o.ngModelCtrl=La,o.unknownOption=Dr(t.createElement("option")),o.renderUnknownOption=function(t){var n="? "+Qe(t)+" ?";o.unknownOption.val(n),e.prepend(o.unknownOption),e.val(n)},r.$on("$destroy",function(){o.renderUnknownOption=$}),o.removeUnknownOption=function(){o.unknownOption.parent()&&o.unknownOption.remove()},o.readValue=function(){return o.removeUnknownOption(),e.val()},o.writeValue=function(t){o.hasOption(t)?(o.removeUnknownOption(),e.val(t),""===t&&o.emptyOption.prop("selected",!0)):null==t&&o.emptyOption?(o.removeUnknownOption(),e.val("")):o.renderUnknownOption(t)},o.addOption=function(e,t){if(t[0].nodeType!==oi){de(e,'"option value"'),""===e&&(o.emptyOption=t);var n=a.get(e)||0;a.put(e,n+1),o.ngModelCtrl.$render(),Ar(t)}},o.removeOption=function(e){var t=a.get(e);t&&(1===t?(a.remove(e),""===e&&(o.emptyOption=n)):a.put(e,t-1))},o.hasOption=function(e){return!!a.get(e)},o.registerOption=function(e,t,n,r,i){if(r){var a;n.$observe("value",function(e){b(a)&&o.removeOption(a),a=e,o.addOption(e,t)})}else i?e.$watch(i,function(e,r){n.$set("value",e),r!==e&&o.removeOption(r),o.addOption(e,t)}):o.addOption(n.value,t);t.on("$destroy",function(){o.removeOption(n.value),o.ngModelCtrl.$render()})}}],Ha=function(){function e(e,t,n,r){var i=r[1];if(i){var a=r[0];if(a.ngModelCtrl=i,t.on("change",function(){e.$apply(function(){i.$setViewValue(a.readValue())})}),n.multiple){a.readValue=function(){var e=[];return o(t.find("option"),function(t){t.selected&&e.push(t.value)}),e},a.writeValue=function(e){var n=new et(e);o(t.find("option"),function(e){e.selected=b(n.get(e.value))})};var s,u=NaN;e.$watch(function(){u!==i.$viewValue||B(s,i.$viewValue)||(s=L(i.$viewValue),i.$render()),u=i.$viewValue}),i.$isEmpty=function(e){return!e||0===e.length}}}}function t(e,t,n,r){var i=r[1];if(i){var o=r[0];i.$render=function(){o.writeValue(i.$viewValue)}}}return{restrict:"E",require:["select","?ngModel"],controller:Ba,priority:1,link:{pre:e,post:t}}},za=["$interpolate",function(e){return{restrict:"E",priority:100,compile:function(t,n){if(b(n.value))var r=e(n.value,!0);else{var i=e(t.text(),!0);i||n.$set("value",t.text())}return function(e,t,n){var o="$selectController",a=t.parent(),s=a.data(o)||a.parent().data(o);s&&s.registerOption(e,t,n,r,i)}}}}],Wa=m({restrict:"E",terminal:!1}),Ga=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){r&&(n.required=!0,r.$validators.required=function(e,t){return!n.required||!r.$isEmpty(t)},n.$observe("required",function(){r.$validate()}))}}},Ja=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,i,o){if(o){var a,s=i.ngPattern||i.pattern;
i.$observe("pattern",function(e){if(S(e)&&e.length>0&&(e=new RegExp("^"+e+"$")),e&&!e.test)throw r("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",s,e,Q(t));a=e||n,o.$validate()}),o.$validators.pattern=function(e,t){return o.$isEmpty(t)||y(a)||a.test(t)}}}}},Ya=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var i=-1;n.$observe("maxlength",function(e){var t=h(e);i=isNaN(t)?-1:t,r.$validate()}),r.$validators.maxlength=function(e,t){return 0>i||r.$isEmpty(t)||t.length<=i}}}}},Ka=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var i=0;n.$observe("minlength",function(e){i=h(e)||0,r.$validate()}),r.$validators.minlength=function(e,t){return r.$isEmpty(t)||t.length>=i}}}}};return e.angular.bootstrap?void console.log("WARNING: Tried to load angular more than once."):(fe(),xe(Hr),Hr.module("ngLocale",[],["$provide",function(e){function t(e){e+="";var t=e.indexOf(".");return-1==t?0:e.length-t-1}function r(e,r){var i=r;n===i&&(i=Math.min(t(e),3));var o=Math.pow(10,i),a=(e*o|0)%o;return{v:i,f:a}}var i={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};e.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(e,t){var n=0|e,o=r(e,t);return 1==n&&0==o.v?i.ONE:i.OTHER}})}]),void Dr(t).ready(function(){ae(t,se)}))}(window,document),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>')},function(e,t,n){n(1),e.exports=angular},function(e,t,n){t=e.exports=n(4)(),t.push([e.id,"body{padding:25px}h1{margin:15px 0}pre{font-family:monospace;font-size:14px}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<t.length;i++){var a=t[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t){e.exports={version:"0.1.0"}},function(e,t,n){!function(t){"use strict";function n(e,t){return-1!==e.indexOf(t,e.length-t.length)}function r(){}function i(e,t){function u(e,t){return w.push(e),S.push(t),E!=s&&(E=s,setTimeout(function(){c()},0)),d}function c(){if(E!=s)return E=o,A(e),void(A=r);if(++C==w.length){if(!$)return C=w.length-1,void(E=o);C=0}w[C].apply(null,[].concat(c,S[C]))}function l(t,n,r){var i=n.length;return i?void function o(a){setTimeout(function(){x(e,b(e)+n[a]),a+=1,i>a?o(a):t()},r)}(0):t()}function f(t,r,i){var o=b(e),a=o.length;return null!=r&&("string"==typeof r?a=n(o,r+y)?r.length+y.length:0:r>-1&&(a=Math.min(r,a))),a?void function s(n){setTimeout(function(){var r=b(e);n?(x(e,r.substring(0,r.length-1)),s(n-1)):t()},i)}(a):t()}function p(t){x(e,""),t()}function h(t,n){n.call(t,e)}var d=this;if(!(d instanceof i))return new i(e,t);t=t||{};var $=t.loop,v=t.speed||t.typeSpeed||50,m=t.speed||t.deleteSpeed||50,g=t.delay||t.pauseDelay||2e3,y=t.postfix||"",b=t.getter||function(e){return e.innerHTML},x=t.setter||function(e,t){e.innerHTML=t},w=[],S=[],C=-1,E=o,A=r;d.type=function(e,t){return u(l,[e+y,t||v])},d["delete"]=function(e,t){return u(f,[e,t||m])},d.clear=function(){return u(p)},d.pause=function(e){return u(setTimeout,[e||g])},d.call=function(e){return u(h,[e])},d.triggerPause=function(e){return E=a,A=e||r,d},d.triggerResume=function(){if(E!=s){var e=E;E=s,e==o&&c()}return d},d.isRunning=function(){return E!=o}}var o=0,a=1,s=2;e.exports=i}(this)},function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=h[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(c(r.parts[o],t))}else{for(var a=[],o=0;o<r.parts.length;o++)a.push(c(r.parts[o],t));h[r.id]={id:r.id,refs:1,parts:a}}}}function i(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r],o=i[0],a=i[1],s=i[2],u=i[3],c={css:a,media:s,sourceMap:u};n[o]?n[o].parts.push(c):t.push(n[o]={id:o,parts:[c]})}return t}function o(e,t){var n=v(),r=y[y.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),y.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=y.indexOf(e);t>=0&&y.splice(t,1)}function s(e){var t=document.createElement("style");return t.type="text/css",o(e,t),t}function u(e){var t=document.createElement("link");return t.rel="stylesheet",o(e,t),t}function c(e,t){var n,r,i;if(t.singleton){var o=g++;n=m||(m=s(t)),r=l.bind(null,n,o,!1),i=l.bind(null,n,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=u(t),r=p.bind(null,n),i=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(t),r=f.bind(null,n),i=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}function l(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=b(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function f(e,t){var n=t.css,r=t.media;t.sourceMap;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function p(e,t){var n=t.css,r=(t.media,t.sourceMap);r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var i=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(i),o&&URL.revokeObjectURL(o)}var h={},d=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},$=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),v=d(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,g=0,y=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=$()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=i(e);return r(n,t),function(e){for(var o=[],a=0;a<n.length;a++){var s=n[a],u=h[s.id];u.refs--,o.push(u)}if(e){var c=i(e);r(c,t)}for(var a=0;a<o.length;a++){var u=o[a];if(0===u.refs){for(var l=0;l<u.parts.length;l++)u.parts[l]();delete h[u.id]}}}};var b=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){var r=n(3);"string"==typeof r&&(r=[[e.id,r,""]]);n(7)(r,{});r.locals&&(e.exports=r.locals)}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vYnVuZGxlLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA3ZTRiYjZhNjk0NTFhYjlkZmI3YyIsIndlYnBhY2s6Ly8vLi9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vfi9hbmd1bGFyL2FuZ3VsYXIuanMiLCJ3ZWJwYWNrOi8vLy4uL34vYW5ndWxhci9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9pbmRleC5jc3MiLCJ3ZWJwYWNrOi8vLy4uL34vY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanMiLCJ3ZWJwYWNrOi8vLy4vaW5kZXguanNvbiIsIndlYnBhY2s6Ly8vLi4vfi9tYWxhcmtleS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vfi9zdHlsZS1sb2FkZXIvYWRkU3R5bGVzLmpzIiwid2VicGFjazovLy8uL2luZGV4LmNzcz8wOTJjIl0sIm5hbWVzIjpbIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiZXhwb3J0cyIsIm1vZHVsZSIsImlkIiwibG9hZGVkIiwiY2FsbCIsIm0iLCJjIiwicCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfYW5ndWxhciIsIl9hbmd1bGFyMiIsIl9pbmRleCIsIl9pbmRleDMiLCJfaW5kZXg0IiwiX21hbGFya2V5IiwiX21hbGFya2V5MiIsIkFwcENvbnRyb2xsZXIiLCJ0aGlzIiwidmVyc2lvbiIsInR5cGlzdENvbmZpZyIsIndvcmRzIiwidHlwZVNwZWVkIiwiZGVsZXRlU3BlZWQiLCJwYXVzZURlbGF5IiwibG9vcCIsInBvc3RmaXgiLCJUeXBpc3RDb250cm9sbGVyIiwiZWxlbSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbmZpZyIsIm9wdHMiLCJhY3QiLCJmb3JFYWNoIiwidyIsInR5cGUiLCJwYXVzZSIsImNvbnRyb2xsZXIiLCJjb21wb25lbnQiLCJyZXN0cmljdCIsImJpbmRpbmdzIiwidGVtcGxhdGUiLCJjb250cm9sbGVyQXMiLCJib290c3RyYXAiLCJ3aW5kb3ciLCJ1bmRlZmluZWQiLCJtaW5FcnIiLCJFcnJvckNvbnN0cnVjdG9yIiwiRXJyb3IiLCJwYXJhbVByZWZpeCIsImkiLCJTS0lQX0lOREVYRVMiLCJ0ZW1wbGF0ZUFyZ3MiLCJhcmd1bWVudHMiLCJjb2RlIiwibWVzc2FnZSIsInJlcGxhY2UiLCJtYXRjaCIsImluZGV4Iiwic2xpY2UiLCJzaGlmdGVkSW5kZXgiLCJsZW5ndGgiLCJ0b0RlYnVnU3RyaW5nIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiaXNBcnJheUxpa2UiLCJpc1dpbmRvdyIsImlzQXJyYXkiLCJpc1N0cmluZyIsImpxTGl0ZSIsIk9iamVjdCIsImlzTnVtYmVyIiwiQXJyYXkiLCJpdGVtIiwiaXRlcmF0b3IiLCJjb250ZXh0Iiwia2V5IiwiaXNGdW5jdGlvbiIsImhhc093blByb3BlcnR5IiwiaXNQcmltaXRpdmUiLCJpc0JsYW5rT2JqZWN0IiwiZm9yRWFjaFNvcnRlZCIsImtleXMiLCJzb3J0IiwicmV2ZXJzZVBhcmFtcyIsIml0ZXJhdG9yRm4iLCJ2YWx1ZSIsIm5leHRVaWQiLCJ1aWQiLCJzZXRIYXNoS2V5IiwiaCIsIiQkaGFzaEtleSIsImJhc2VFeHRlbmQiLCJkc3QiLCJvYmpzIiwiZGVlcCIsImlpIiwiaXNPYmplY3QiLCJqIiwiamoiLCJzcmMiLCJpc0RhdGUiLCJEYXRlIiwidmFsdWVPZiIsImlzUmVnRXhwIiwiUmVnRXhwIiwibm9kZU5hbWUiLCJjbG9uZU5vZGUiLCJpc0VsZW1lbnQiLCJjbG9uZSIsImV4dGVuZCIsIm1lcmdlIiwidG9JbnQiLCJzdHIiLCJwYXJzZUludCIsImluaGVyaXQiLCJwYXJlbnQiLCJleHRyYSIsImNyZWF0ZSIsIm5vb3AiLCJpZGVudGl0eSIsIiQiLCJ2YWx1ZUZuIiwiaGFzQ3VzdG9tVG9TdHJpbmciLCJ0b1N0cmluZyIsImlzVW5kZWZpbmVkIiwiaXNEZWZpbmVkIiwiZ2V0UHJvdG90eXBlT2YiLCJpc1Njb3BlIiwiJGV2YWxBc3luYyIsIiR3YXRjaCIsImlzRmlsZSIsImlzRm9ybURhdGEiLCJpc0Jsb2IiLCJpc0Jvb2xlYW4iLCJpc1Byb21pc2VMaWtlIiwidGhlbiIsImlzVHlwZWRBcnJheSIsIlRZUEVEX0FSUkFZX1JFR0VYUCIsInRlc3QiLCJpc0FycmF5QnVmZmVyIiwibm9kZSIsInByb3AiLCJhdHRyIiwiZmluZCIsIm1ha2VNYXAiLCJpdGVtcyIsInNwbGl0Iiwibm9kZU5hbWVfIiwiZWxlbWVudCIsImxvd2VyY2FzZSIsImFycmF5UmVtb3ZlIiwiYXJyYXkiLCJpbmRleE9mIiwic3BsaWNlIiwiY29weSIsInNvdXJjZSIsImRlc3RpbmF0aW9uIiwiY29weVJlY3Vyc2UiLCJwdXNoIiwiY29weUVsZW1lbnQiLCJzdGFja1NvdXJjZSIsInN0YWNrRGVzdCIsIm5nTWluRXJyIiwibmVlZHNSZWN1cnNlIiwiY29weVR5cGUiLCJjb25zdHJ1Y3RvciIsImJ1ZmZlciIsImNvcGllZCIsIkFycmF5QnVmZmVyIiwiYnl0ZUxlbmd0aCIsIlVpbnQ4QXJyYXkiLCJzZXQiLCJyZSIsImxhc3RJbmRleCIsInNoYWxsb3dDb3B5IiwiY2hhckF0IiwiZXF1YWxzIiwibzEiLCJvMiIsImtleVNldCIsInQxIiwidDIiLCJnZXRUaW1lIiwiY3JlYXRlTWFwIiwiY29uY2F0IiwiYXJyYXkxIiwiYXJyYXkyIiwic2xpY2VBcmdzIiwiYXJncyIsInN0YXJ0SW5kZXgiLCJiaW5kIiwic2VsZiIsImZuIiwiY3VycnlBcmdzIiwiYXBwbHkiLCJ0b0pzb25SZXBsYWNlciIsInZhbCIsInRvSnNvbiIsInByZXR0eSIsIkpTT04iLCJzdHJpbmdpZnkiLCJmcm9tSnNvbiIsImpzb24iLCJwYXJzZSIsInRpbWV6b25lVG9PZmZzZXQiLCJ0aW1lem9uZSIsImZhbGxiYWNrIiwiQUxMX0NPTE9OUyIsInJlcXVlc3RlZFRpbWV6b25lT2Zmc2V0IiwiaXNOYU4iLCJhZGREYXRlTWludXRlcyIsImRhdGUiLCJtaW51dGVzIiwic2V0TWludXRlcyIsImdldE1pbnV0ZXMiLCJjb252ZXJ0VGltZXpvbmVUb0xvY2FsIiwicmV2ZXJzZSIsImRhdGVUaW1lem9uZU9mZnNldCIsImdldFRpbWV6b25lT2Zmc2V0IiwidGltZXpvbmVPZmZzZXQiLCJzdGFydGluZ1RhZyIsImVtcHR5IiwiZSIsImVsZW1IdG1sIiwiYXBwZW5kIiwiaHRtbCIsIm5vZGVUeXBlIiwiTk9ERV9UWVBFX1RFWFQiLCJ0cnlEZWNvZGVVUklDb21wb25lbnQiLCJkZWNvZGVVUklDb21wb25lbnQiLCJwYXJzZUtleVZhbHVlIiwia2V5VmFsdWUiLCJzcGxpdFBvaW50Iiwic3Vic3RyaW5nIiwidG9LZXlWYWx1ZSIsInBhcnRzIiwiYXJyYXlWYWx1ZSIsImVuY29kZVVyaVF1ZXJ5Iiwiam9pbiIsImVuY29kZVVyaVNlZ21lbnQiLCJwY3RFbmNvZGVTcGFjZXMiLCJnZXROZ0F0dHJpYnV0ZSIsIm5nQXR0ciIsIm5nQXR0clByZWZpeGVzIiwiZ2V0QXR0cmlidXRlIiwiYW5ndWxhckluaXQiLCJhcHBFbGVtZW50IiwicHJlZml4IiwibmFtZSIsImhhc0F0dHJpYnV0ZSIsImNhbmRpZGF0ZSIsInN0cmljdERpIiwiZGVmYXVsdENvbmZpZyIsImRvQm9vdHN0cmFwIiwiaW5qZWN0b3IiLCJ0YWciLCJ1bnNoaWZ0IiwiJHByb3ZpZGUiLCJkZWJ1Z0luZm9FbmFibGVkIiwiJGNvbXBpbGVQcm92aWRlciIsImNyZWF0ZUluamVjdG9yIiwiaW52b2tlIiwic2NvcGUiLCJjb21waWxlIiwiJGFwcGx5IiwiZGF0YSIsIk5HX0VOQUJMRV9ERUJVR19JTkZPIiwiTkdfREVGRVJfQk9PVFNUUkFQIiwiYW5ndWxhciIsInJlc3VtZUJvb3RzdHJhcCIsImV4dHJhTW9kdWxlcyIsInJlc3VtZURlZmVycmVkQm9vdHN0cmFwIiwicmVsb2FkV2l0aERlYnVnSW5mbyIsImxvY2F0aW9uIiwicmVsb2FkIiwiZ2V0VGVzdGFiaWxpdHkiLCJyb290RWxlbWVudCIsImdldCIsInNuYWtlX2Nhc2UiLCJzZXBhcmF0b3IiLCJTTkFLRV9DQVNFX1JFR0VYUCIsImxldHRlciIsInBvcyIsInRvTG93ZXJDYXNlIiwiYmluZEpRdWVyeSIsIm9yaWdpbmFsQ2xlYW5EYXRhIiwiYmluZEpRdWVyeUZpcmVkIiwianFOYW1lIiwianEiLCJqUXVlcnkiLCJvbiIsIkpRTGl0ZVByb3RvdHlwZSIsImlzb2xhdGVTY29wZSIsImluaGVyaXRlZERhdGEiLCJjbGVhbkRhdGEiLCJlbGVtcyIsImV2ZW50cyIsIl9kYXRhIiwiJGRlc3Ryb3kiLCJ0cmlnZ2VySGFuZGxlciIsIkpRTGl0ZSIsImFzc2VydEFyZyIsImFyZyIsInJlYXNvbiIsImFzc2VydEFyZ0ZuIiwiYWNjZXB0QXJyYXlBbm5vdGF0aW9uIiwiYXNzZXJ0Tm90SGFzT3duUHJvcGVydHkiLCJnZXR0ZXIiLCJwYXRoIiwiYmluZEZuVG9TY29wZSIsImxhc3RJbnN0YW5jZSIsImxlbiIsImdldEJsb2NrTm9kZXMiLCJub2RlcyIsImJsb2NrTm9kZXMiLCJlbmROb2RlIiwibmV4dFNpYmxpbmciLCJzZXR1cE1vZHVsZUxvYWRlciIsImVuc3VyZSIsImZhY3RvcnkiLCIkaW5qZWN0b3JNaW5FcnIiLCIkJG1pbkVyciIsInJlcXVpcmVzIiwiY29uZmlnRm4iLCJpbnZva2VMYXRlciIsInByb3ZpZGVyIiwibWV0aG9kIiwiaW5zZXJ0TWV0aG9kIiwicXVldWUiLCJpbnZva2VRdWV1ZSIsIm1vZHVsZUluc3RhbmNlIiwiaW52b2tlTGF0ZXJBbmRTZXRNb2R1bGVOYW1lIiwicmVjaXBlTmFtZSIsImZhY3RvcnlGdW5jdGlvbiIsIiQkbW9kdWxlTmFtZSIsImNvbmZpZ0Jsb2NrcyIsInJ1bkJsb2NrcyIsIl9pbnZva2VRdWV1ZSIsIl9jb25maWdCbG9ja3MiLCJfcnVuQmxvY2tzIiwic2VydmljZSIsImNvbnN0YW50IiwiZGVjb3JhdG9yIiwiYW5pbWF0aW9uIiwiZmlsdGVyIiwiZGlyZWN0aXZlIiwicnVuIiwiYmxvY2siLCJzZXJpYWxpemVPYmplY3QiLCJzZWVuIiwicHVibGlzaEV4dGVybmFsQVBJIiwidXBwZXJjYXNlIiwiY2FsbGJhY2tzIiwiY291bnRlciIsIiQkY3NwIiwiY3NwIiwiYW5ndWxhck1vZHVsZSIsIiQkc2FuaXRpemVVcmkiLCIkJFNhbml0aXplVXJpUHJvdmlkZXIiLCIkQ29tcGlsZVByb3ZpZGVyIiwiYSIsImh0bWxBbmNob3JEaXJlY3RpdmUiLCJpbnB1dCIsImlucHV0RGlyZWN0aXZlIiwidGV4dGFyZWEiLCJmb3JtIiwiZm9ybURpcmVjdGl2ZSIsInNjcmlwdCIsInNjcmlwdERpcmVjdGl2ZSIsInNlbGVjdCIsInNlbGVjdERpcmVjdGl2ZSIsInN0eWxlIiwic3R5bGVEaXJlY3RpdmUiLCJvcHRpb24iLCJvcHRpb25EaXJlY3RpdmUiLCJuZ0JpbmQiLCJuZ0JpbmREaXJlY3RpdmUiLCJuZ0JpbmRIdG1sIiwibmdCaW5kSHRtbERpcmVjdGl2ZSIsIm5nQmluZFRlbXBsYXRlIiwibmdCaW5kVGVtcGxhdGVEaXJlY3RpdmUiLCJuZ0NsYXNzIiwibmdDbGFzc0RpcmVjdGl2ZSIsIm5nQ2xhc3NFdmVuIiwibmdDbGFzc0V2ZW5EaXJlY3RpdmUiLCJuZ0NsYXNzT2RkIiwibmdDbGFzc09kZERpcmVjdGl2ZSIsIm5nQ2xvYWsiLCJuZ0Nsb2FrRGlyZWN0aXZlIiwibmdDb250cm9sbGVyIiwibmdDb250cm9sbGVyRGlyZWN0aXZlIiwibmdGb3JtIiwibmdGb3JtRGlyZWN0aXZlIiwibmdIaWRlIiwibmdIaWRlRGlyZWN0aXZlIiwibmdJZiIsIm5nSWZEaXJlY3RpdmUiLCJuZ0luY2x1ZGUiLCJuZ0luY2x1ZGVEaXJlY3RpdmUiLCJuZ0luaXQiLCJuZ0luaXREaXJlY3RpdmUiLCJuZ05vbkJpbmRhYmxlIiwibmdOb25CaW5kYWJsZURpcmVjdGl2ZSIsIm5nUGx1cmFsaXplIiwibmdQbHVyYWxpemVEaXJlY3RpdmUiLCJuZ1JlcGVhdCIsIm5nUmVwZWF0RGlyZWN0aXZlIiwibmdTaG93IiwibmdTaG93RGlyZWN0aXZlIiwibmdTdHlsZSIsIm5nU3R5bGVEaXJlY3RpdmUiLCJuZ1N3aXRjaCIsIm5nU3dpdGNoRGlyZWN0aXZlIiwibmdTd2l0Y2hXaGVuIiwibmdTd2l0Y2hXaGVuRGlyZWN0aXZlIiwibmdTd2l0Y2hEZWZhdWx0IiwibmdTd2l0Y2hEZWZhdWx0RGlyZWN0aXZlIiwibmdPcHRpb25zIiwibmdPcHRpb25zRGlyZWN0aXZlIiwibmdUcmFuc2NsdWRlIiwibmdUcmFuc2NsdWRlRGlyZWN0aXZlIiwibmdNb2RlbCIsIm5nTW9kZWxEaXJlY3RpdmUiLCJuZ0xpc3QiLCJuZ0xpc3REaXJlY3RpdmUiLCJuZ0NoYW5nZSIsIm5nQ2hhbmdlRGlyZWN0aXZlIiwicGF0dGVybiIsInBhdHRlcm5EaXJlY3RpdmUiLCJuZ1BhdHRlcm4iLCJyZXF1aXJlZCIsInJlcXVpcmVkRGlyZWN0aXZlIiwibmdSZXF1aXJlZCIsIm1pbmxlbmd0aCIsIm1pbmxlbmd0aERpcmVjdGl2ZSIsIm5nTWlubGVuZ3RoIiwibWF4bGVuZ3RoIiwibWF4bGVuZ3RoRGlyZWN0aXZlIiwibmdNYXhsZW5ndGgiLCJuZ1ZhbHVlIiwibmdWYWx1ZURpcmVjdGl2ZSIsIm5nTW9kZWxPcHRpb25zIiwibmdNb2RlbE9wdGlvbnNEaXJlY3RpdmUiLCJuZ0luY2x1ZGVGaWxsQ29udGVudERpcmVjdGl2ZSIsIm5nQXR0cmlidXRlQWxpYXNEaXJlY3RpdmVzIiwibmdFdmVudERpcmVjdGl2ZXMiLCIkYW5jaG9yU2Nyb2xsIiwiJEFuY2hvclNjcm9sbFByb3ZpZGVyIiwiJGFuaW1hdGUiLCIkQW5pbWF0ZVByb3ZpZGVyIiwiJGFuaW1hdGVDc3MiLCIkQ29yZUFuaW1hdGVDc3NQcm92aWRlciIsIiQkYW5pbWF0ZUpzIiwiJCRDb3JlQW5pbWF0ZUpzUHJvdmlkZXIiLCIkJGFuaW1hdGVRdWV1ZSIsIiQkQ29yZUFuaW1hdGVRdWV1ZVByb3ZpZGVyIiwiJCRBbmltYXRlUnVubmVyIiwiJCRBbmltYXRlUnVubmVyRmFjdG9yeVByb3ZpZGVyIiwiJCRhbmltYXRlQXN5bmNSdW4iLCIkJEFuaW1hdGVBc3luY1J1bkZhY3RvcnlQcm92aWRlciIsIiRicm93c2VyIiwiJEJyb3dzZXJQcm92aWRlciIsIiRjYWNoZUZhY3RvcnkiLCIkQ2FjaGVGYWN0b3J5UHJvdmlkZXIiLCIkY29udHJvbGxlciIsIiRDb250cm9sbGVyUHJvdmlkZXIiLCIkZG9jdW1lbnQiLCIkRG9jdW1lbnRQcm92aWRlciIsIiRleGNlcHRpb25IYW5kbGVyIiwiJEV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlciIsIiRmaWx0ZXIiLCIkRmlsdGVyUHJvdmlkZXIiLCIkJGZvcmNlUmVmbG93IiwiJCRGb3JjZVJlZmxvd1Byb3ZpZGVyIiwiJGludGVycG9sYXRlIiwiJEludGVycG9sYXRlUHJvdmlkZXIiLCIkaW50ZXJ2YWwiLCIkSW50ZXJ2YWxQcm92aWRlciIsIiRodHRwIiwiJEh0dHBQcm92aWRlciIsIiRodHRwUGFyYW1TZXJpYWxpemVyIiwiJEh0dHBQYXJhbVNlcmlhbGl6ZXJQcm92aWRlciIsIiRodHRwUGFyYW1TZXJpYWxpemVySlFMaWtlIiwiJEh0dHBQYXJhbVNlcmlhbGl6ZXJKUUxpa2VQcm92aWRlciIsIiRodHRwQmFja2VuZCIsIiRIdHRwQmFja2VuZFByb3ZpZGVyIiwiJHhockZhY3RvcnkiLCIkeGhyRmFjdG9yeVByb3ZpZGVyIiwiJGxvY2F0aW9uIiwiJExvY2F0aW9uUHJvdmlkZXIiLCIkbG9nIiwiJExvZ1Byb3ZpZGVyIiwiJHBhcnNlIiwiJFBhcnNlUHJvdmlkZXIiLCIkcm9vdFNjb3BlIiwiJFJvb3RTY29wZVByb3ZpZGVyIiwiJHEiLCIkUVByb3ZpZGVyIiwiJCRxIiwiJCRRUHJvdmlkZXIiLCIkc2NlIiwiJFNjZVByb3ZpZGVyIiwiJHNjZURlbGVnYXRlIiwiJFNjZURlbGVnYXRlUHJvdmlkZXIiLCIkc25pZmZlciIsIiRTbmlmZmVyUHJvdmlkZXIiLCIkdGVtcGxhdGVDYWNoZSIsIiRUZW1wbGF0ZUNhY2hlUHJvdmlkZXIiLCIkdGVtcGxhdGVSZXF1ZXN0IiwiJFRlbXBsYXRlUmVxdWVzdFByb3ZpZGVyIiwiJCR0ZXN0YWJpbGl0eSIsIiQkVGVzdGFiaWxpdHlQcm92aWRlciIsIiR0aW1lb3V0IiwiJFRpbWVvdXRQcm92aWRlciIsIiR3aW5kb3ciLCIkV2luZG93UHJvdmlkZXIiLCIkJHJBRiIsIiQkUkFGUHJvdmlkZXIiLCIkJGpxTGl0ZSIsIiQkanFMaXRlUHJvdmlkZXIiLCIkJEhhc2hNYXAiLCIkJEhhc2hNYXBQcm92aWRlciIsIiQkY29va2llUmVhZGVyIiwiJCRDb29raWVSZWFkZXJQcm92aWRlciIsImpxTmV4dElkIiwianFJZCIsImNhbWVsQ2FzZSIsIlNQRUNJQUxfQ0hBUlNfUkVHRVhQIiwiXyIsIm9mZnNldCIsInRvVXBwZXJDYXNlIiwiTU9aX0hBQ0tfUkVHRVhQIiwianFMaXRlSXNUZXh0Tm9kZSIsIkhUTUxfUkVHRVhQIiwianFMaXRlQWNjZXB0c0RhdGEiLCJOT0RFX1RZUEVfRUxFTUVOVCIsIk5PREVfVFlQRV9ET0NVTUVOVCIsImpxTGl0ZUhhc0RhdGEiLCJqcUNhY2hlIiwibmczMzkiLCJqcUxpdGVDbGVhbkRhdGEiLCJqcUxpdGVSZW1vdmVEYXRhIiwianFMaXRlQnVpbGRGcmFnbWVudCIsInRtcCIsIndyYXAiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJjcmVhdGVUZXh0Tm9kZSIsImFwcGVuZENoaWxkIiwiY3JlYXRlRWxlbWVudCIsIlRBR19OQU1FX1JFR0VYUCIsImV4ZWMiLCJ3cmFwTWFwIiwiX2RlZmF1bHQiLCJpbm5lckhUTUwiLCJYSFRNTF9UQUdfUkVHRVhQIiwibGFzdENoaWxkIiwiY2hpbGROb2RlcyIsImZpcnN0Q2hpbGQiLCJ0ZXh0Q29udGVudCIsImpxTGl0ZVBhcnNlSFRNTCIsInBhcnNlZCIsIlNJTkdMRV9UQUdfUkVHRVhQIiwianFMaXRlV3JhcE5vZGUiLCJ3cmFwcGVyIiwicGFyZW50Tm9kZSIsInJlcGxhY2VDaGlsZCIsImFyZ0lzU3RyaW5nIiwidHJpbSIsImpxTGl0ZU1pbkVyciIsImpxTGl0ZUFkZE5vZGVzIiwianFMaXRlQ2xvbmUiLCJqcUxpdGVEZWFsb2MiLCJvbmx5RGVzY2VuZGFudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZGVzY2VuZGFudHMiLCJsIiwianFMaXRlT2ZmIiwidW5zdXBwb3J0ZWQiLCJleHBhbmRvU3RvcmUiLCJqcUxpdGVFeHBhbmRvU3RvcmUiLCJoYW5kbGUiLCJyZW1vdmVIYW5kbGVyIiwibGlzdGVuZXJGbnMiLCJyZW1vdmVFdmVudExpc3RlbmVyRm4iLCJNT1VTRV9FVkVOVF9NQVAiLCJleHBhbmRvSWQiLCJjcmVhdGVJZk5lY2Vzc2FyeSIsImpxTGl0ZURhdGEiLCJpc1NpbXBsZVNldHRlciIsImlzU2ltcGxlR2V0dGVyIiwibWFzc0dldHRlciIsImpxTGl0ZUhhc0NsYXNzIiwic2VsZWN0b3IiLCJqcUxpdGVSZW1vdmVDbGFzcyIsImNzc0NsYXNzZXMiLCJzZXRBdHRyaWJ1dGUiLCJjc3NDbGFzcyIsImpxTGl0ZUFkZENsYXNzIiwiZXhpc3RpbmdDbGFzc2VzIiwicm9vdCIsImVsZW1lbnRzIiwianFMaXRlQ29udHJvbGxlciIsImpxTGl0ZUluaGVyaXRlZERhdGEiLCJkb2N1bWVudEVsZW1lbnQiLCJuYW1lcyIsIk5PREVfVFlQRV9ET0NVTUVOVF9GUkFHTUVOVCIsImhvc3QiLCJqcUxpdGVFbXB0eSIsInJlbW92ZUNoaWxkIiwianFMaXRlUmVtb3ZlIiwia2VlcERhdGEiLCJqcUxpdGVEb2N1bWVudExvYWRlZCIsImFjdGlvbiIsIndpbiIsInJlYWR5U3RhdGUiLCJzZXRUaW1lb3V0IiwiZ2V0Qm9vbGVhbkF0dHJOYW1lIiwiYm9vbGVhbkF0dHIiLCJCT09MRUFOX0FUVFIiLCJCT09MRUFOX0VMRU1FTlRTIiwiZ2V0QWxpYXNlZEF0dHJOYW1lIiwiQUxJQVNFRF9BVFRSIiwiY3JlYXRlRXZlbnRIYW5kbGVyIiwiZXZlbnRIYW5kbGVyIiwiZXZlbnQiLCJpc0RlZmF1bHRQcmV2ZW50ZWQiLCJkZWZhdWx0UHJldmVudGVkIiwiZXZlbnRGbnMiLCJldmVudEZuc0xlbmd0aCIsImltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCIsIm9yaWdpbmFsU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uIiwic3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uIiwic3RvcFByb3BhZ2F0aW9uIiwiaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQiLCJoYW5kbGVyV3JhcHBlciIsInNwZWNpYWxIYW5kbGVyV3JhcHBlciIsImRlZmF1bHRIYW5kbGVyV3JhcHBlciIsImhhbmRsZXIiLCJzcGVjaWFsTW91c2VIYW5kbGVyV3JhcHBlciIsInRhcmdldCIsInJlbGF0ZWQiLCJyZWxhdGVkVGFyZ2V0IiwianFMaXRlQ29udGFpbnMiLCIkZ2V0IiwiaGFzQ2xhc3MiLCJjbGFzc2VzIiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsImhhc2hLZXkiLCJuZXh0VWlkRm4iLCJvYmpUeXBlIiwiSGFzaE1hcCIsImlzb2xhdGVkVWlkIiwicHV0IiwiZXh0cmFjdEFyZ3MiLCJmblRleHQiLCJTVFJJUF9DT01NRU5UUyIsIkFSUk9XX0FSRyIsIkZOX0FSR1MiLCJhbm9uRm4iLCJhbm5vdGF0ZSIsIiRpbmplY3QiLCJhcmdEZWNsIiwibGFzdCIsIkZOX0FSR19TUExJVCIsIkZOX0FSRyIsImFsbCIsInVuZGVyc2NvcmUiLCJtb2R1bGVzVG9Mb2FkIiwic3VwcG9ydE9iamVjdCIsImRlbGVnYXRlIiwicHJvdmlkZXJfIiwicHJvdmlkZXJJbmplY3RvciIsImluc3RhbnRpYXRlIiwicHJvdmlkZXJDYWNoZSIsInByb3ZpZGVyU3VmZml4IiwiZW5mb3JjZVJldHVyblZhbHVlIiwicmVzdWx0IiwiaW5zdGFuY2VJbmplY3RvciIsImZhY3RvcnlGbiIsImVuZm9yY2UiLCIkaW5qZWN0b3IiLCJpbnN0YW5jZUNhY2hlIiwic2VydmljZU5hbWUiLCJkZWNvckZuIiwib3JpZ1Byb3ZpZGVyIiwib3JpZyRnZXQiLCJvcmlnSW5zdGFuY2UiLCIkZGVsZWdhdGUiLCJsb2FkTW9kdWxlcyIsIm1vZHVsZUZuIiwicnVuSW52b2tlUXVldWUiLCJpbnZva2VBcmdzIiwibG9hZGVkTW9kdWxlcyIsInN0YWNrIiwiY3JlYXRlSW50ZXJuYWxJbmplY3RvciIsImNhY2hlIiwiZ2V0U2VydmljZSIsImNhbGxlciIsIklOU1RBTlRJQVRJTkciLCJlcnIiLCJzaGlmdCIsImluamVjdGlvbkFyZ3MiLCJsb2NhbHMiLCIkJGFubm90YXRlIiwiaXNDbGFzcyIsImZ1bmMiLCJtc2llIiwiRnVuY3Rpb24iLCJwcm90b3R5cGUiLCJUeXBlIiwiY3RvciIsImhhcyIsInByb3RvSW5zdGFuY2VJbmplY3RvciIsImF1dG9TY3JvbGxpbmdFbmFibGVkIiwiZGlzYWJsZUF1dG9TY3JvbGxpbmciLCJnZXRGaXJzdEFuY2hvciIsImxpc3QiLCJzb21lIiwiZ2V0WU9mZnNldCIsInNjcm9sbCIsInlPZmZzZXQiLCJnZXRDb21wdXRlZFN0eWxlIiwicG9zaXRpb24iLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJib3R0b20iLCJzY3JvbGxUbyIsInNjcm9sbEludG9WaWV3IiwiZWxlbVRvcCIsInRvcCIsInNjcm9sbEJ5IiwiaGFzaCIsImVsbSIsImdldEVsZW1lbnRCeUlkIiwiZ2V0RWxlbWVudHNCeU5hbWUiLCJuZXdWYWwiLCJvbGRWYWwiLCJtZXJnZUNsYXNzZXMiLCJiIiwiZXh0cmFjdEVsZW1lbnROb2RlIiwiRUxFTUVOVF9OT0RFIiwic3BsaXRDbGFzc2VzIiwia2xhc3MiLCJwcmVwYXJlQW5pbWF0ZU9wdGlvbnMiLCJvcHRpb25zIiwiQnJvd3NlciIsImNvbXBsZXRlT3V0c3RhbmRpbmdSZXF1ZXN0Iiwib3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQiLCJvdXRzdGFuZGluZ1JlcXVlc3RDYWxsYmFja3MiLCJwb3AiLCJlcnJvciIsImdldEhhc2giLCJ1cmwiLCJzdWJzdHIiLCJjYWNoZVN0YXRlQW5kRmlyZVVybENoYW5nZSIsInBlbmRpbmdMb2NhdGlvbiIsImNhY2hlU3RhdGUiLCJmaXJlVXJsQ2hhbmdlIiwiZ2V0Q3VycmVudFN0YXRlIiwiaGlzdG9yeSIsInN0YXRlIiwiY2FjaGVkU3RhdGUiLCJsYXN0Q2FjaGVkU3RhdGUiLCJsYXN0QnJvd3NlclVybCIsImxhc3RIaXN0b3J5U3RhdGUiLCJ1cmxDaGFuZ2VMaXN0ZW5lcnMiLCJsaXN0ZW5lciIsImNsZWFyVGltZW91dCIsInBlbmRpbmdEZWZlcklkcyIsImlzTW9jayIsIiQkY29tcGxldGVPdXRzdGFuZGluZ1JlcXVlc3QiLCIkJGluY091dHN0YW5kaW5nUmVxdWVzdENvdW50Iiwibm90aWZ5V2hlbk5vT3V0c3RhbmRpbmdSZXF1ZXN0cyIsImNhbGxiYWNrIiwiaHJlZiIsImJhc2VFbGVtZW50Iiwic2FtZVN0YXRlIiwic2FtZUJhc2UiLCJzdHJpcEhhc2giLCJ1cmxDaGFuZ2VJbml0Iiwib25VcmxDaGFuZ2UiLCIkJGFwcGxpY2F0aW9uRGVzdHJveWVkIiwib2ZmIiwiJCRjaGVja1VybENoYW5nZSIsImJhc2VIcmVmIiwiZGVmZXIiLCJkZWxheSIsInRpbWVvdXRJZCIsImNhbmNlbCIsImRlZmVySWQiLCJjYWNoZUZhY3RvcnkiLCJjYWNoZUlkIiwicmVmcmVzaCIsImVudHJ5IiwiZnJlc2hFbmQiLCJzdGFsZUVuZCIsIm4iLCJsaW5rIiwibmV4dEVudHJ5IiwicHJldkVudHJ5IiwiY2FjaGVzIiwic2l6ZSIsInN0YXRzIiwiY2FwYWNpdHkiLCJOdW1iZXIiLCJNQVhfVkFMVUUiLCJscnVIYXNoIiwibHJ1RW50cnkiLCJyZW1vdmUiLCJyZW1vdmVBbGwiLCJkZXN0cm95IiwiaW5mbyIsIiQkc2FuaXRpemVVcmlQcm92aWRlciIsInBhcnNlSXNvbGF0ZUJpbmRpbmdzIiwiZGlyZWN0aXZlTmFtZSIsImlzQ29udHJvbGxlciIsIkxPQ0FMX1JFR0VYUCIsImRlZmluaXRpb24iLCJzY29wZU5hbWUiLCIkY29tcGlsZU1pbkVyciIsIm1vZGUiLCJjb2xsZWN0aW9uIiwib3B0aW9uYWwiLCJhdHRyTmFtZSIsInBhcnNlRGlyZWN0aXZlQmluZGluZ3MiLCJiaW5kVG9Db250cm9sbGVyIiwiaWRlbnRpZmllckZvckNvbnRyb2xsZXIiLCJhc3NlcnRWYWxpZERpcmVjdGl2ZU5hbWUiLCJoYXNEaXJlY3RpdmVzIiwiU3VmZml4IiwiQ09NTUVOVF9ESVJFQ1RJVkVfUkVHRVhQIiwiQ0xBU1NfRElSRUNUSVZFX1JFR0VYUCIsIkFMTF9PUl9OT1RISU5HX0FUVFJTIiwiUkVRVUlSRV9QUkVGSVhfUkVHRVhQIiwiRVZFTlRfSEFORExFUl9BVFRSX1JFR0VYUCIsInJlZ2lzdGVyRGlyZWN0aXZlIiwiZGlyZWN0aXZlRmFjdG9yeSIsImRpcmVjdGl2ZXMiLCJwcmlvcml0eSIsInJlcXVpcmUiLCIkJGJpbmRpbmdzIiwiJCRpc29sYXRlQmluZGluZ3MiLCJtYWtlSW5qZWN0YWJsZSIsInRFbGVtZW50IiwidEF0dHJzIiwiJGVsZW1lbnQiLCIkYXR0cnMiLCJ0ZW1wbGF0ZVVybCIsInRyYW5zY2x1ZGUiLCJhSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdCIsInJlZ2V4cCIsImltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdCIsImVuYWJsZWQiLCJzZXRTcGVjaWFsQXR0ciIsInNwZWNpYWxBdHRySG9sZGVyIiwiYXR0cmlidXRlcyIsImF0dHJpYnV0ZSIsInJlbW92ZU5hbWVkSXRlbSIsInNldE5hbWVkSXRlbSIsInNhZmVBZGRDbGFzcyIsImNsYXNzTmFtZSIsIiRjb21waWxlTm9kZXMiLCJ0cmFuc2NsdWRlRm4iLCJtYXhQcmlvcml0eSIsImlnbm9yZURpcmVjdGl2ZSIsInByZXZpb3VzQ29tcGlsZUNvbnRleHQiLCJOT1RfRU1QVFkiLCJkb21Ob2RlIiwibm9kZVZhbHVlIiwiY29tcG9zaXRlTGlua0ZuIiwiY29tcGlsZU5vZGVzIiwiJCRhZGRTY29wZUNsYXNzIiwibmFtZXNwYWNlIiwiY2xvbmVDb25uZWN0Rm4iLCJuZWVkc05ld1Njb3BlIiwiJHBhcmVudCIsIiRuZXciLCJwYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbiIsInRyYW5zY2x1ZGVDb250cm9sbGVycyIsImZ1dHVyZVBhcmVudEVsZW1lbnQiLCIkJGJvdW5kVHJhbnNjbHVkZSIsImRldGVjdE5hbWVzcGFjZUZvckNoaWxkRWxlbWVudHMiLCIkbGlua05vZGUiLCJ3cmFwVGVtcGxhdGUiLCJjb250cm9sbGVyTmFtZSIsIiQkYWRkU2NvcGVJbmZvIiwicGFyZW50RWxlbWVudCIsIm5vZGVMaXN0IiwiJHJvb3RFbGVtZW50Iiwibm9kZUxpbmtGbiIsImNoaWxkTGlua0ZuIiwiY2hpbGRTY29wZSIsImlkeCIsImNoaWxkQm91bmRUcmFuc2NsdWRlRm4iLCJzdGFibGVOb2RlTGlzdCIsIm5vZGVMaW5rRm5Gb3VuZCIsIm5vZGVMaXN0TGVuZ3RoIiwibGlua0ZucyIsInRyYW5zY2x1ZGVPblRoaXNFbGVtZW50IiwiY3JlYXRlQm91bmRUcmFuc2NsdWRlRm4iLCJ0ZW1wbGF0ZU9uVGhpc0VsZW1lbnQiLCJhdHRycyIsImxpbmtGbkZvdW5kIiwiQXR0cmlidXRlcyIsImNvbGxlY3REaXJlY3RpdmVzIiwiYXBwbHlEaXJlY3RpdmVzVG9Ob2RlIiwiJCRlbGVtZW50IiwidGVybWluYWwiLCJwcmV2aW91c0JvdW5kVHJhbnNjbHVkZUZuIiwiYm91bmRUcmFuc2NsdWRlRm4iLCJ0cmFuc2NsdWRlZFNjb3BlIiwiY2xvbmVGbiIsImNvbnRyb2xsZXJzIiwiY29udGFpbmluZ1Njb3BlIiwiJCR0cmFuc2NsdWRlZCIsImJvdW5kU2xvdHMiLCIkJHNsb3RzIiwic2xvdE5hbWUiLCJhdHRyc01hcCIsIiRhdHRyIiwiYWRkRGlyZWN0aXZlIiwiZGlyZWN0aXZlTm9ybWFsaXplIiwibk5hbWUiLCJuZ0F0dHJOYW1lIiwiaXNOZ0F0dHIiLCJuQXR0cnMiLCJhdHRyU3RhcnROYW1lIiwiYXR0ckVuZE5hbWUiLCJOR19BVFRSX0JJTkRJTkciLCJQUkVGSVhfUkVHRVhQIiwibXVsdGlFbGVtZW50TWF0Y2giLCJNVUxUSV9FTEVNRU5UX0RJUl9SRSIsImRpcmVjdGl2ZUlzTXVsdGlFbGVtZW50IiwiYWRkQXR0ckludGVycG9sYXRlRGlyZWN0aXZlIiwiYW5pbVZhbCIsImFkZFRleHRJbnRlcnBvbGF0ZURpcmVjdGl2ZSIsIk5PREVfVFlQRV9DT01NRU5UIiwiYnlQcmlvcml0eSIsImdyb3VwU2NhbiIsImF0dHJTdGFydCIsImF0dHJFbmQiLCJkZXB0aCIsImdyb3VwRWxlbWVudHNMaW5rRm5XcmFwcGVyIiwibGlua0ZuIiwiY29tcGlsYXRpb25HZW5lcmF0b3IiLCJlYWdlciIsImNvbXBpbGVkIiwiY29tcGlsZU5vZGUiLCJ0ZW1wbGF0ZUF0dHJzIiwianFDb2xsZWN0aW9uIiwib3JpZ2luYWxSZXBsYWNlRGlyZWN0aXZlIiwicHJlTGlua0ZucyIsInBvc3RMaW5rRm5zIiwiYWRkTGlua0ZucyIsInByZSIsInBvc3QiLCJuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUiLCIkJGlzb2xhdGVTY29wZSIsImNsb25lQW5kQW5ub3RhdGVGbiIsImdldENvbnRyb2xsZXJzIiwiZWxlbWVudENvbnRyb2xsZXJzIiwiaW5oZXJpdFR5cGUiLCJkYXRhTmFtZSIsInByb3BlcnR5Iiwic2V0dXBDb250cm9sbGVycyIsImNvbnRyb2xsZXJEaXJlY3RpdmVzIiwiY29udHJvbGxlcktleSIsIiRzY29wZSIsIiR0cmFuc2NsdWRlIiwiY29udHJvbGxlckluc3RhbmNlIiwiaGFzRWxlbWVudFRyYW5zY2x1ZGVEaXJlY3RpdmUiLCJsaW5rTm9kZSIsImNvbnRyb2xsZXJzQm91bmRUcmFuc2NsdWRlIiwiY2xvbmVBdHRhY2hGbiIsInNjb3BlVG9DaGlsZCIsInNsb3RUcmFuc2NsdWRlRm4iLCJjb250cm9sbGVyU2NvcGUiLCJyZW1vdmVTY29wZUJpbmRpbmdXYXRjaGVzIiwicmVtb3ZlQ29udHJvbGxlckJpbmRpbmdXYXRjaGVzIiwibmV3U2NvcGVEaXJlY3RpdmUiLCJpc1Nsb3RGaWxsZWQiLCJ0ZW1wbGF0ZURpcmVjdGl2ZSIsIiQkb3JpZ2luYWxEaXJlY3RpdmUiLCJpbml0aWFsaXplRGlyZWN0aXZlQmluZGluZ3MiLCIkb24iLCJjb250cm9sbGVyRGlyZWN0aXZlIiwiaWRlbnRpZmllciIsImNvbnRyb2xsZXJSZXN1bHQiLCIkb25Jbml0IiwiaW52b2tlTGlua0ZuIiwiJHRlbXBsYXRlIiwiZGlyZWN0aXZlVmFsdWUiLCJ0ZXJtaW5hbFByaW9yaXR5Iiwibm9uVGxiVHJhbnNjbHVkZURpcmVjdGl2ZSIsImhhc1RyYW5zY2x1ZGVEaXJlY3RpdmUiLCJoYXNUZW1wbGF0ZSIsIiRjb21waWxlTm9kZSIsInJlcGxhY2VEaXJlY3RpdmUiLCJjaGlsZFRyYW5zY2x1ZGVGbiIsImRpZFNjYW5Gb3JNdWx0aXBsZVRyYW5zY2x1c2lvbiIsIm1pZ2h0SGF2ZU11bHRpcGxlVHJhbnNjbHVzaW9uRXJyb3IiLCIkJHN0YXJ0IiwiJCRlbmQiLCJhc3NlcnROb0R1cGxpY2F0ZSIsIiQkdGxiIiwiY2FuZGlkYXRlRGlyZWN0aXZlIiwic2Nhbm5pbmdJbmRleCIsImNyZWF0ZUNvbW1lbnQiLCJyZXBsYWNlV2l0aCIsInNsb3RzIiwiY29udGVudHMiLCJzbG90TWFwIiwiZmlsbGVkU2xvdHMiLCJlbGVtZW50U2VsZWN0b3IiLCJmaWxsZWQiLCIkJG5ld1Njb3BlIiwiZGVub3JtYWxpemVUZW1wbGF0ZSIsInJlbW92ZUNvbW1lbnRzIiwidGVtcGxhdGVOYW1lc3BhY2UiLCJuZXdUZW1wbGF0ZUF0dHJzIiwidGVtcGxhdGVEaXJlY3RpdmVzIiwidW5wcm9jZXNzZWREaXJlY3RpdmVzIiwibWFya0RpcmVjdGl2ZVNjb3BlIiwibWVyZ2VUZW1wbGF0ZUF0dHJpYnV0ZXMiLCJjb21waWxlVGVtcGxhdGVVcmwiLCJNYXRoIiwibWF4IiwibmV3U2NvcGUiLCJ0RGlyZWN0aXZlcyIsInN0YXJ0QXR0ck5hbWUiLCJlbmRBdHRyTmFtZSIsIm11bHRpRWxlbWVudCIsInNyY0F0dHIiLCJkc3RBdHRyIiwiJHNldCIsImFmdGVyVGVtcGxhdGVOb2RlTGlua0ZuIiwiYWZ0ZXJUZW1wbGF0ZUNoaWxkTGlua0ZuIiwibGlua1F1ZXVlIiwiYmVmb3JlVGVtcGxhdGVDb21waWxlTm9kZSIsIm9yaWdBc3luY0RpcmVjdGl2ZSIsImRlcml2ZWRTeW5jRGlyZWN0aXZlIiwiY29udGVudCIsInRlbXBUZW1wbGF0ZUF0dHJzIiwiYmVmb3JlVGVtcGxhdGVMaW5rTm9kZSIsImxpbmtSb290RWxlbWVudCIsIiQkZGVzdHJveWVkIiwib2xkQ2xhc3NlcyIsImlnbm9yZUNoaWxkTGlua0ZuIiwiZGlmZiIsIndoYXQiLCJwcmV2aW91c0RpcmVjdGl2ZSIsIndyYXBNb2R1bGVOYW1lSWZEZWZpbmVkIiwibW9kdWxlTmFtZSIsInRleHQiLCJpbnRlcnBvbGF0ZUZuIiwidGVtcGxhdGVOb2RlIiwidGVtcGxhdGVOb2RlUGFyZW50IiwiaGFzQ29tcGlsZVBhcmVudCIsIiQkYWRkQmluZGluZ0NsYXNzIiwiJCRhZGRCaW5kaW5nSW5mbyIsImV4cHJlc3Npb25zIiwiZ2V0VHJ1c3RlZENvbnRleHQiLCJhdHRyTm9ybWFsaXplZE5hbWUiLCJIVE1MIiwiUkVTT1VSQ0VfVVJMIiwiYWxsT3JOb3RoaW5nIiwidHJ1c3RlZENvbnRleHQiLCIkJG9ic2VydmVycyIsIm5ld1ZhbHVlIiwiJCRpbnRlciIsIiQkc2NvcGUiLCJvbGRWYWx1ZSIsIiR1cGRhdGVDbGFzcyIsImVsZW1lbnRzVG9SZW1vdmUiLCJuZXdOb2RlIiwiZmlyc3RFbGVtZW50VG9SZW1vdmUiLCJyZW1vdmVDb3VudCIsImoyIiwiaGFzRGF0YSIsImFubm90YXRpb24iLCJyZW1vdmVXYXRjaENvbGxlY3Rpb24iLCJsYXN0VmFsdWUiLCJwYXJlbnRHZXQiLCJwYXJlbnRTZXQiLCJjb21wYXJlIiwicmVtb3ZlV2F0Y2giLCIkb2JzZXJ2ZSIsImxpdGVyYWwiLCJhc3NpZ24iLCJwYXJlbnRWYWx1ZVdhdGNoIiwicGFyZW50VmFsdWUiLCIkc3RhdGVmdWwiLCIkd2F0Y2hDb2xsZWN0aW9uIiwibmV3UGFyZW50VmFsdWUiLCJTSU1QTEVfQVRUUl9OQU1FIiwiYXR0cmlidXRlc1RvQ29weSIsIiRub3JtYWxpemUiLCIkYWRkQ2xhc3MiLCJjbGFzc1ZhbCIsIiRyZW1vdmVDbGFzcyIsIm5ld0NsYXNzZXMiLCJ0b0FkZCIsInRva2VuRGlmZmVyZW5jZSIsInRvUmVtb3ZlIiwid3JpdGVBdHRyIiwiYm9vbGVhbktleSIsImFsaWFzZWRLZXkiLCJvYnNlcnZlciIsInRyaW1tZWRTcmNzZXQiLCJzcmNQYXR0ZXJuIiwicmF3VXJpcyIsIm5iclVyaXNXaXRoMnBhcnRzIiwiZmxvb3IiLCJpbm5lcklkeCIsImxhc3RUdXBsZSIsInJlbW92ZUF0dHIiLCJsaXN0ZW5lcnMiLCJzdGFydFN5bWJvbCIsImVuZFN5bWJvbCIsImJpbmRpbmciLCJpc29sYXRlZCIsIm5vVGVtcGxhdGUiLCJzdHIxIiwic3RyMiIsInZhbHVlcyIsInRva2VuczEiLCJ0b2tlbnMyIiwib3V0ZXIiLCJ0b2tlbiIsImpxTm9kZXMiLCJpZGVudCIsIkNOVFJMX1JFRyIsImdsb2JhbHMiLCJyZWdpc3RlciIsImFsbG93R2xvYmFscyIsImFkZElkZW50aWZpZXIiLCJleHByZXNzaW9uIiwibGF0ZXIiLCIkY29udHJvbGxlck1pbkVyciIsImNvbnRyb2xsZXJQcm90b3R5cGUiLCJleGNlcHRpb24iLCJjYXVzZSIsInNlcmlhbGl6ZVZhbHVlIiwidiIsInRvSVNPU3RyaW5nIiwicGFyYW1zIiwiayIsInNlcmlhbGl6ZSIsInRvU2VyaWFsaXplIiwidG9wTGV2ZWwiLCJkZWZhdWx0SHR0cFJlc3BvbnNlVHJhbnNmb3JtIiwiaGVhZGVycyIsInRlbXBEYXRhIiwiSlNPTl9QUk9URUNUSU9OX1BSRUZJWCIsImNvbnRlbnRUeXBlIiwiQVBQTElDQVRJT05fSlNPTiIsImlzSnNvbkxpa2UiLCJqc29uU3RhcnQiLCJKU09OX1NUQVJUIiwiSlNPTl9FTkRTIiwicGFyc2VIZWFkZXJzIiwiZmlsbEluUGFyc2VkIiwibGluZSIsImhlYWRlclZhbCIsImhlYWRlcktleSIsImhlYWRlcnNHZXR0ZXIiLCJoZWFkZXJzT2JqIiwidHJhbnNmb3JtRGF0YSIsInN0YXR1cyIsImZucyIsImlzU3VjY2VzcyIsImRlZmF1bHRzIiwidHJhbnNmb3JtUmVzcG9uc2UiLCJ0cmFuc2Zvcm1SZXF1ZXN0IiwiZCIsImNvbW1vbiIsIkFjY2VwdCIsIkNPTlRFTlRfVFlQRV9BUFBMSUNBVElPTl9KU09OIiwicGF0Y2giLCJ4c3JmQ29va2llTmFtZSIsInhzcmZIZWFkZXJOYW1lIiwicGFyYW1TZXJpYWxpemVyIiwidXNlQXBwbHlBc3luYyIsInVzZUxlZ2FjeVByb21pc2UiLCJ1c2VMZWdhY3lQcm9taXNlRXh0ZW5zaW9ucyIsImludGVyY2VwdG9yRmFjdG9yaWVzIiwiaW50ZXJjZXB0b3JzIiwicmVxdWVzdENvbmZpZyIsInJlc3BvbnNlIiwicmVzcCIsInJlamVjdCIsImV4ZWN1dGVIZWFkZXJGbnMiLCJoZWFkZXJDb250ZW50IiwicHJvY2Vzc2VkSGVhZGVycyIsImhlYWRlckZuIiwiaGVhZGVyIiwibWVyZ2VIZWFkZXJzIiwiZGVmSGVhZGVyTmFtZSIsImxvd2VyY2FzZURlZkhlYWRlck5hbWUiLCJyZXFIZWFkZXJOYW1lIiwiZGVmSGVhZGVycyIsInJlcUhlYWRlcnMiLCJkZWZhdWx0SGVhZGVyc0l0ZXJhdGlvbiIsInNlcnZlclJlcXVlc3QiLCJyZXFEYXRhIiwid2l0aENyZWRlbnRpYWxzIiwic2VuZFJlcSIsImNoYWluIiwicHJvbWlzZSIsIndoZW4iLCJyZXZlcnNlZEludGVyY2VwdG9ycyIsImludGVyY2VwdG9yIiwicmVxdWVzdCIsInJlcXVlc3RFcnJvciIsInJlc3BvbnNlRXJyb3IiLCJ0aGVuRm4iLCJyZWplY3RGbiIsInN1Y2Nlc3MiLCIkaHR0cE1pbkVyckxlZ2FjeUZuIiwiY3JlYXRlU2hvcnRNZXRob2RzIiwiY3JlYXRlU2hvcnRNZXRob2RzV2l0aERhdGEiLCJkb25lIiwiaGVhZGVyc1N0cmluZyIsInN0YXR1c1RleHQiLCJyZXNvbHZlSHR0cFByb21pc2UiLCJyZXNvbHZlUHJvbWlzZSIsIiRhcHBseUFzeW5jIiwiJCRwaGFzZSIsImRlZmVycmVkIiwicmVzb2x2ZSIsInJlc29sdmVQcm9taXNlV2l0aFJlc3VsdCIsInJlbW92ZVBlbmRpbmdSZXEiLCJwZW5kaW5nUmVxdWVzdHMiLCJjYWNoZWRSZXNwIiwiYnVpbGRVcmwiLCJkZWZhdWx0Q2FjaGUiLCJ4c3JmVmFsdWUiLCJ1cmxJc1NhbWVPcmlnaW4iLCJ0aW1lb3V0IiwicmVzcG9uc2VUeXBlIiwic2VyaWFsaXplZFBhcmFtcyIsImludGVyY2VwdG9yRmFjdG9yeSIsIlhNTEh0dHBSZXF1ZXN0IiwiY3JlYXRlSHR0cEJhY2tlbmQiLCJjcmVhdGVYaHIiLCIkYnJvd3NlckRlZmVyIiwicmF3RG9jdW1lbnQiLCJqc29ucFJlcSIsImNhbGxiYWNrSWQiLCJhc3luYyIsImJvZHkiLCJjYWxsZWQiLCJhZGRFdmVudExpc3RlbmVyRm4iLCJ0aW1lb3V0UmVxdWVzdCIsImpzb25wRG9uZSIsInhociIsImFib3J0IiwiY29tcGxldGVSZXF1ZXN0Iiwib3BlbiIsInNldFJlcXVlc3RIZWFkZXIiLCJvbmxvYWQiLCJyZXNwb25zZVRleHQiLCJ1cmxSZXNvbHZlIiwicHJvdG9jb2wiLCJnZXRBbGxSZXNwb25zZUhlYWRlcnMiLCJvbmVycm9yIiwib25hYm9ydCIsInNlbmQiLCJlc2NhcGUiLCJjaCIsInVuZXNjYXBlVGV4dCIsImVzY2FwZWRTdGFydFJlZ2V4cCIsImVzY2FwZWRFbmRSZWdleHAiLCJjb25zdGFudFdhdGNoRGVsZWdhdGUiLCJvYmplY3RFcXVhbGl0eSIsImNvbnN0YW50SW50ZXJwIiwidW53YXRjaCIsIm11c3RIYXZlRXhwcmVzc2lvbiIsInBhcnNlU3RyaW5naWZ5SW50ZXJjZXB0b3IiLCJnZXRWYWx1ZSIsIiRpbnRlcnBvbGF0ZU1pbkVyciIsImludGVyciIsInVuZXNjYXBlZFRleHQiLCJleHAiLCIkJHdhdGNoRGVsZWdhdGUiLCJlbmRJbmRleCIsInBhcnNlRm5zIiwidGV4dExlbmd0aCIsImV4cHJlc3Npb25Qb3NpdGlvbnMiLCJzdGFydFN5bWJvbExlbmd0aCIsImVuZFN5bWJvbExlbmd0aCIsInRocm93Tm9jb25jYXQiLCJjb21wdXRlIiwiZ2V0VHJ1c3RlZCIsIiR3YXRjaEdyb3VwIiwib2xkVmFsdWVzIiwiY3VyclZhbHVlIiwiaW50ZXJ2YWwiLCJjb3VudCIsImludm9rZUFwcGx5IiwiaGFzUGFyYW1zIiwiaXRlcmF0aW9uIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwic2tpcEFwcGx5IiwiJCRpbnRlcnZhbElkIiwibm90aWZ5IiwiaW50ZXJ2YWxzIiwiZW5jb2RlUGF0aCIsInNlZ21lbnRzIiwicGFyc2VBYnNvbHV0ZVVybCIsImFic29sdXRlVXJsIiwibG9jYXRpb25PYmoiLCJwYXJzZWRVcmwiLCIkJHByb3RvY29sIiwiJCRob3N0IiwiaG9zdG5hbWUiLCIkJHBvcnQiLCJwb3J0IiwiREVGQVVMVF9QT1JUUyIsInBhcnNlQXBwVXJsIiwicmVsYXRpdmVVcmwiLCJwcmVmaXhlZCIsIiQkcGF0aCIsInBhdGhuYW1lIiwiJCRzZWFyY2giLCJzZWFyY2giLCIkJGhhc2giLCJiZWdpbnNXaXRoIiwiYmVnaW4iLCJ3aG9sZSIsInRyaW1FbXB0eUhhc2giLCJzdHJpcEZpbGUiLCJsYXN0SW5kZXhPZiIsInNlcnZlckJhc2UiLCJMb2NhdGlvbkh0bWw1VXJsIiwiYXBwQmFzZSIsImFwcEJhc2VOb0ZpbGUiLCJiYXNlUHJlZml4IiwiJCRodG1sNSIsIiQkcGFyc2UiLCJwYXRoVXJsIiwiJGxvY2F0aW9uTWluRXJyIiwiJCRjb21wb3NlIiwiJCR1cmwiLCIkJGFic1VybCIsIiQkcGFyc2VMaW5rVXJsIiwicmVsSHJlZiIsImFwcFVybCIsInByZXZBcHBVcmwiLCJyZXdyaXR0ZW5VcmwiLCJMb2NhdGlvbkhhc2hiYW5nVXJsIiwiaGFzaFByZWZpeCIsInJlbW92ZVdpbmRvd3NEcml2ZU5hbWUiLCJiYXNlIiwiZmlyc3RQYXRoU2VnbWVudE1hdGNoIiwid2luZG93c0ZpbGVQYXRoRXhwIiwid2l0aG91dEhhc2hVcmwiLCJ3aXRob3V0QmFzZVVybCIsIkxvY2F0aW9uSGFzaGJhbmdJbkh0bWw1VXJsIiwibG9jYXRpb25HZXR0ZXIiLCJsb2NhdGlvbkdldHRlclNldHRlciIsInByZXByb2Nlc3MiLCJodG1sNU1vZGUiLCJyZXF1aXJlQmFzZSIsInJld3JpdGVMaW5rcyIsInNldEJyb3dzZXJVcmxXaXRoRmFsbGJhY2siLCJvbGRVcmwiLCJvbGRTdGF0ZSIsIiQkc3RhdGUiLCJhZnRlckxvY2F0aW9uQ2hhbmdlIiwiJGJyb2FkY2FzdCIsImFic1VybCIsIkxvY2F0aW9uTW9kZSIsImluaXRpYWxVcmwiLCJJR05PUkVfVVJJX1JFR0VYUCIsImN0cmxLZXkiLCJtZXRhS2V5Iiwic2hpZnRLZXkiLCJ3aGljaCIsImJ1dHRvbiIsImFic0hyZWYiLCJwcmV2ZW50RGVmYXVsdCIsImluaXRpYWxpemluZyIsIm5ld1VybCIsIm5ld1N0YXRlIiwiJGRpZ2VzdCIsImN1cnJlbnRSZXBsYWNlIiwiJCRyZXBsYWNlIiwidXJsT3JTdGF0ZUNoYW5nZWQiLCJkZWJ1ZyIsImRlYnVnRW5hYmxlZCIsImZsYWciLCJmb3JtYXRFcnJvciIsInNvdXJjZVVSTCIsImNvbnNvbGVMb2ciLCJjb25zb2xlIiwibG9nRm4iLCJsb2ciLCJoYXNBcHBseSIsImFyZzEiLCJhcmcyIiwid2FybiIsImVuc3VyZVNhZmVNZW1iZXJOYW1lIiwiZnVsbEV4cHJlc3Npb24iLCIkcGFyc2VNaW5FcnIiLCJnZXRTdHJpbmdWYWx1ZSIsImVuc3VyZVNhZmVPYmplY3QiLCJjaGlsZHJlbiIsImVuc3VyZVNhZmVGdW5jdGlvbiIsIkNBTEwiLCJBUFBMWSIsIkJJTkQiLCJlbnN1cmVTYWZlQXNzaWduQ29udGV4dCIsImlmRGVmaW5lZCIsInBsdXNGbiIsInIiLCJpc1N0YXRlbGVzcyIsImZpbHRlck5hbWUiLCJmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zIiwiYXN0IiwiYWxsQ29uc3RhbnRzIiwiYXJnc1RvV2F0Y2giLCJBU1QiLCJQcm9ncmFtIiwiZXhwciIsIkxpdGVyYWwiLCJ0b1dhdGNoIiwiVW5hcnlFeHByZXNzaW9uIiwiYXJndW1lbnQiLCJCaW5hcnlFeHByZXNzaW9uIiwibGVmdCIsInJpZ2h0IiwiTG9naWNhbEV4cHJlc3Npb24iLCJDb25kaXRpb25hbEV4cHJlc3Npb24iLCJhbHRlcm5hdGUiLCJjb25zZXF1ZW50IiwiSWRlbnRpZmllciIsIk1lbWJlckV4cHJlc3Npb24iLCJvYmplY3QiLCJjb21wdXRlZCIsIkNhbGxFeHByZXNzaW9uIiwiY2FsbGVlIiwiQXNzaWdubWVudEV4cHJlc3Npb24iLCJBcnJheUV4cHJlc3Npb24iLCJPYmplY3RFeHByZXNzaW9uIiwicHJvcGVydGllcyIsIlRoaXNFeHByZXNzaW9uIiwiTG9jYWxzRXhwcmVzc2lvbiIsImdldElucHV0cyIsImxhc3RFeHByZXNzaW9uIiwiaXNBc3NpZ25hYmxlIiwiYXNzaWduYWJsZUFTVCIsIk5HVmFsdWVQYXJhbWV0ZXIiLCJvcGVyYXRvciIsImlzTGl0ZXJhbCIsImlzQ29uc3RhbnQiLCJBU1RDb21waWxlciIsImFzdEJ1aWxkZXIiLCJBU1RJbnRlcnByZXRlciIsImlzUG9zc2libHlEYW5nZXJvdXNNZW1iZXJOYW1lIiwiZ2V0VmFsdWVPZiIsIm9iamVjdFZhbHVlT2YiLCJjYWNoZURlZmF1bHQiLCJjYWNoZUV4cGVuc2l2ZSIsImludGVyY2VwdG9yRm4iLCJleHBlbnNpdmVDaGVja3MiLCJwYXJzZWRFeHByZXNzaW9uIiwib25lVGltZSIsImNhY2hlS2V5IiwicnVubmluZ0NoZWNrc0VuYWJsZWQiLCJwYXJzZU9wdGlvbnMiLCIkcGFyc2VPcHRpb25zRXhwZW5zaXZlIiwiJHBhcnNlT3B0aW9ucyIsImxleGVyIiwiTGV4ZXIiLCJwYXJzZXIiLCJQYXJzZXIiLCJvbmVUaW1lTGl0ZXJhbFdhdGNoRGVsZWdhdGUiLCJvbmVUaW1lV2F0Y2hEZWxlZ2F0ZSIsImlucHV0cyIsImlucHV0c1dhdGNoRGVsZWdhdGUiLCJleHBlbnNpdmVDaGVja3NJbnRlcmNlcHRvciIsImFkZEludGVyY2VwdG9yIiwiZXhwZW5zaXZlQ2hlY2tGbiIsImV4cGVuc2l2ZUNoZWNrT2xkVmFsdWUiLCJleHByZXNzaW9uSW5wdXREaXJ0eUNoZWNrIiwib2xkVmFsdWVPZlZhbHVlIiwicHJldHR5UHJpbnRFeHByZXNzaW9uIiwibGFzdFJlc3VsdCIsImlucHV0RXhwcmVzc2lvbnMiLCJvbGRJbnB1dFZhbHVlT2YiLCJuZXdJbnB1dFZhbHVlIiwib2xkSW5wdXRWYWx1ZU9mVmFsdWVzIiwib2xkSW5wdXRWYWx1ZXMiLCJjaGFuZ2VkIiwib2xkIiwiJCRwb3N0RGlnZXN0IiwiaXNBbGxEZWZpbmVkIiwiYWxsRGVmaW5lZCIsIndhdGNoRGVsZWdhdGUiLCJ1c2VJbnB1dHMiLCJyZWd1bGFyV2F0Y2giLCJub1Vuc2FmZUV2YWwiLCIkJHJ1bm5pbmdFeHBlbnNpdmVDaGVja3MiLCJxRmFjdG9yeSIsIm5leHRUaWNrIiwiZXhjZXB0aW9uSGFuZGxlciIsIlByb21pc2UiLCJzaW1wbGVCaW5kIiwicHJvY2Vzc1F1ZXVlIiwicGVuZGluZyIsInByb2Nlc3NTY2hlZHVsZWQiLCJzY2hlZHVsZVByb2Nlc3NRdWV1ZSIsIkRlZmVycmVkIiwicHJvbWlzZXMiLCJyZXN1bHRzIiwiJHFNaW5FcnIiLCJvbkZ1bGZpbGxlZCIsIm9uUmVqZWN0ZWQiLCJwcm9ncmVzc0JhY2siLCJjYXRjaCIsImZpbmFsbHkiLCJoYW5kbGVDYWxsYmFjayIsIiQkcmVqZWN0IiwiJCRyZXNvbHZlIiwidGhhdCIsInJlamVjdFByb21pc2UiLCJwcm9ncmVzcyIsIm1ha2VQcm9taXNlIiwicmVzb2x2ZWQiLCJpc1Jlc29sdmVkIiwiY2FsbGJhY2tPdXRwdXQiLCJlcnJiYWNrIiwiJFEiLCJyZXNvbHZlciIsInJlc29sdmVGbiIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwid2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWUiLCJ3ZWJraXRDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJyYWZTdXBwb3J0ZWQiLCJyYWYiLCJ0aW1lciIsInN1cHBvcnRlZCIsImNyZWF0ZUNoaWxkU2NvcGVDbGFzcyIsIkNoaWxkU2NvcGUiLCIkJHdhdGNoZXJzIiwiJCRuZXh0U2libGluZyIsIiQkY2hpbGRIZWFkIiwiJCRjaGlsZFRhaWwiLCIkJGxpc3RlbmVycyIsIiQkbGlzdGVuZXJDb3VudCIsIiQkd2F0Y2hlcnNDb3VudCIsIiRpZCIsIiQkQ2hpbGRTY29wZSIsIlRUTCIsIiRyb290U2NvcGVNaW5FcnIiLCJsYXN0RGlydHlXYXRjaCIsImFwcGx5QXN5bmNJZCIsImRpZ2VzdFR0bCIsImRlc3Ryb3lDaGlsZFNjb3BlIiwiJGV2ZW50IiwiY3VycmVudFNjb3BlIiwiY2xlYW5VcFNjb3BlIiwiJCRwcmV2U2libGluZyIsIiRyb290IiwiU2NvcGUiLCJiZWdpblBoYXNlIiwicGhhc2UiLCJjbGVhclBoYXNlIiwiaW5jcmVtZW50V2F0Y2hlcnNDb3VudCIsImN1cnJlbnQiLCJkZWNyZW1lbnRMaXN0ZW5lckNvdW50IiwiaW5pdFdhdGNoVmFsIiwiZmx1c2hBcHBseUFzeW5jIiwiYXBwbHlBc3luY1F1ZXVlIiwic2NoZWR1bGVBcHBseUFzeW5jIiwiaXNvbGF0ZSIsImNoaWxkIiwid2F0Y2hFeHAiLCJ3YXRjaGVyIiwiZXEiLCJ3YXRjaEV4cHJlc3Npb25zIiwid2F0Y2hHcm91cEFjdGlvbiIsImNoYW5nZVJlYWN0aW9uU2NoZWR1bGVkIiwiZmlyc3RSdW4iLCJuZXdWYWx1ZXMiLCJkZXJlZ2lzdGVyRm5zIiwic2hvdWxkQ2FsbCIsInVud2F0Y2hGbiIsIiR3YXRjaENvbGxlY3Rpb25JbnRlcmNlcHRvciIsIl92YWx1ZSIsIm5ld0xlbmd0aCIsImJvdGhOYU4iLCJuZXdJdGVtIiwib2xkSXRlbSIsImludGVybmFsQXJyYXkiLCJvbGRMZW5ndGgiLCJjaGFuZ2VEZXRlY3RlZCIsImludGVybmFsT2JqZWN0IiwiJHdhdGNoQ29sbGVjdGlvbkFjdGlvbiIsImluaXRSdW4iLCJ2ZXJ5T2xkVmFsdWUiLCJ0cmFja1ZlcnlPbGRWYWx1ZSIsImNoYW5nZURldGVjdG9yIiwid2F0Y2giLCJ3YXRjaGVycyIsImRpcnR5IiwibmV4dCIsImxvZ0lkeCIsImFzeW5jVGFzayIsInR0bCIsIndhdGNoTG9nIiwiYXN5bmNRdWV1ZSIsIiRldmFsIiwidHJhdmVyc2VTY29wZXNMb29wIiwibXNnIiwicG9zdERpZ2VzdFF1ZXVlIiwiZXZlbnROYW1lIiwiJGFwcGx5QXN5bmNFeHByZXNzaW9uIiwibmFtZWRMaXN0ZW5lcnMiLCJpbmRleE9mTGlzdGVuZXIiLCIkZW1pdCIsInRhcmdldFNjb3BlIiwibGlzdGVuZXJBcmdzIiwiJCRhc3luY1F1ZXVlIiwiJCRwb3N0RGlnZXN0UXVldWUiLCIkJGFwcGx5QXN5bmNRdWV1ZSIsInVyaSIsImlzSW1hZ2UiLCJub3JtYWxpemVkVmFsIiwicmVnZXgiLCJhZGp1c3RNYXRjaGVyIiwibWF0Y2hlciIsIiRzY2VNaW5FcnIiLCJlc2NhcGVGb3JSZWdleHAiLCJhZGp1c3RNYXRjaGVycyIsIm1hdGNoZXJzIiwiYWRqdXN0ZWRNYXRjaGVycyIsIlNDRV9DT05URVhUUyIsInJlc291cmNlVXJsV2hpdGVsaXN0IiwicmVzb3VyY2VVcmxCbGFja2xpc3QiLCJtYXRjaFVybCIsImlzUmVzb3VyY2VVcmxBbGxvd2VkQnlQb2xpY3kiLCJhbGxvd2VkIiwiZ2VuZXJhdGVIb2xkZXJUeXBlIiwiQmFzZSIsImhvbGRlclR5cGUiLCJ0cnVzdGVkVmFsdWUiLCIkJHVud3JhcFRydXN0ZWRWYWx1ZSIsInRydXN0QXMiLCJieVR5cGUiLCJtYXliZVRydXN0ZWQiLCJ0cnVzdGVkVmFsdWVIb2xkZXJCYXNlIiwiaHRtbFNhbml0aXplciIsIkNTUyIsIlVSTCIsIkpTIiwic2NlIiwiaXNFbmFibGVkIiwicGFyc2VBcyIsImVudW1WYWx1ZSIsImxOYW1lIiwidmVuZG9yUHJlZml4IiwiZXZlbnRTdXBwb3J0IiwiYW5kcm9pZCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsImJveGVlIiwidmVuZG9yUmVnZXgiLCJib2R5U3R5bGUiLCJ0cmFuc2l0aW9ucyIsImFuaW1hdGlvbnMiLCJ3ZWJraXRUcmFuc2l0aW9uIiwid2Via2l0QW5pbWF0aW9uIiwicHVzaFN0YXRlIiwiaGFzRXZlbnQiLCJkaXZFbG0iLCJodHRwT3B0aW9ucyIsImhhbmRsZVJlcXVlc3RGbiIsInRwbCIsImlnbm9yZVJlcXVlc3RFcnJvciIsImhhbmRsZUVycm9yIiwidG90YWxQZW5kaW5nUmVxdWVzdHMiLCJnZXRUcnVzdGVkUmVzb3VyY2VVcmwiLCJ0cmFuc2Zvcm1lciIsInRlc3RhYmlsaXR5IiwiZmluZEJpbmRpbmdzIiwib3B0X2V4YWN0TWF0Y2giLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwibWF0Y2hlcyIsImRhdGFCaW5kaW5nIiwiYmluZGluZ05hbWUiLCJmaW5kTW9kZWxzIiwicHJlZml4ZXMiLCJhdHRyaWJ1dGVFcXVhbHMiLCJnZXRMb2NhdGlvbiIsInNldExvY2F0aW9uIiwid2hlblN0YWJsZSIsImRlZmVycmVkcyIsIiQkdGltZW91dElkIiwidXJsUGFyc2luZ05vZGUiLCJyZXF1ZXN0VXJsIiwib3JpZ2luVXJsIiwiJCRDb29raWVSZWFkZXIiLCJzYWZlRGVjb2RlVVJJQ29tcG9uZW50IiwibGFzdENvb2tpZXMiLCJsYXN0Q29va2llU3RyaW5nIiwiY29va2llQXJyYXkiLCJjb29raWUiLCJjdXJyZW50Q29va2llU3RyaW5nIiwiZmlsdGVycyIsInN1ZmZpeCIsImN1cnJlbmN5RmlsdGVyIiwiZGF0ZUZpbHRlciIsImZpbHRlckZpbHRlciIsImpzb25GaWx0ZXIiLCJsaW1pdFRvRmlsdGVyIiwibG93ZXJjYXNlRmlsdGVyIiwibnVtYmVyRmlsdGVyIiwib3JkZXJCeUZpbHRlciIsInVwcGVyY2FzZUZpbHRlciIsImNvbXBhcmF0b3IiLCJwcmVkaWNhdGVGbiIsIm1hdGNoQWdhaW5zdEFueVByb3AiLCJleHByZXNzaW9uVHlwZSIsImdldFR5cGVGb3JGaWx0ZXIiLCJjcmVhdGVQcmVkaWNhdGVGbiIsInNob3VsZE1hdGNoUHJpbWl0aXZlcyIsImFjdHVhbCIsImV4cGVjdGVkIiwiZGVlcENvbXBhcmUiLCJkb250TWF0Y2hXaG9sZU9iamVjdCIsImFjdHVhbFR5cGUiLCJleHBlY3RlZFR5cGUiLCJleHBlY3RlZFZhbCIsIm1hdGNoQW55UHJvcGVydHkiLCJhY3R1YWxWYWwiLCIkbG9jYWxlIiwiZm9ybWF0cyIsIk5VTUJFUl9GT1JNQVRTIiwiYW1vdW50IiwiY3VycmVuY3lTeW1ib2wiLCJmcmFjdGlvblNpemUiLCJDVVJSRU5DWV9TWU0iLCJQQVRURVJOUyIsIm1heEZyYWMiLCJmb3JtYXROdW1iZXIiLCJHUk9VUF9TRVAiLCJERUNJTUFMX1NFUCIsIm51bWJlciIsIm51bVN0ciIsImRpZ2l0cyIsIm51bWJlck9mSW50ZWdlckRpZ2l0cyIsInplcm9zIiwiZXhwb25lbnQiLCJaRVJPX0NIQVIiLCJNQVhfRElHSVRTIiwicm91bmROdW1iZXIiLCJwYXJzZWROdW1iZXIiLCJtaW5GcmFjIiwiZnJhY3Rpb25MZW4iLCJtaW4iLCJyb3VuZEF0IiwiZGlnaXQiLCJjYXJyeSIsInJlZHVjZVJpZ2h0IiwiZ3JvdXBTZXAiLCJkZWNpbWFsU2VwIiwiaXNJbmZpbml0eSIsImlzRmluaXRlIiwiaXNaZXJvIiwiYWJzIiwiZm9ybWF0dGVkVGV4dCIsImludGVnZXJMZW4iLCJkZWNpbWFscyIsInJlZHVjZSIsImdyb3VwcyIsImxnU2l6ZSIsImdTaXplIiwibmVnUHJlIiwibmVnU3VmIiwicG9zUHJlIiwicG9zU3VmIiwicGFkTnVtYmVyIiwibnVtIiwibmVnIiwiZGF0ZUdldHRlciIsImRhdGVTdHJHZXR0ZXIiLCJzaG9ydEZvcm0iLCJ0aW1lWm9uZUdldHRlciIsInpvbmUiLCJwYWRkZWRab25lIiwiZ2V0Rmlyc3RUaHVyc2RheU9mWWVhciIsInllYXIiLCJkYXlPZldlZWtPbkZpcnN0IiwiZ2V0RGF5IiwiZ2V0VGh1cnNkYXlUaGlzV2VlayIsImRhdGV0aW1lIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERhdGUiLCJ3ZWVrR2V0dGVyIiwiZmlyc3RUaHVycyIsInRoaXNUaHVycyIsInJvdW5kIiwiYW1wbUdldHRlciIsImdldEhvdXJzIiwiQU1QTVMiLCJlcmFHZXR0ZXIiLCJFUkFTIiwibG9uZ0VyYUdldHRlciIsIkVSQU5BTUVTIiwianNvblN0cmluZ1RvRGF0ZSIsInN0cmluZyIsIlJfSVNPODYwMV9TVFIiLCJ0ekhvdXIiLCJ0ek1pbiIsImRhdGVTZXR0ZXIiLCJzZXRVVENGdWxsWWVhciIsInNldEZ1bGxZZWFyIiwidGltZVNldHRlciIsInNldFVUQ0hvdXJzIiwic2V0SG91cnMiLCJzIiwibXMiLCJwYXJzZUZsb2F0IiwiZm9ybWF0IiwiREFURVRJTUVfRk9STUFUUyIsIk5VTUJFUl9TVFJJTkciLCJEQVRFX0ZPUk1BVFNfU1BMSVQiLCJEQVRFX0ZPUk1BVFMiLCJzcGFjaW5nIiwibGltaXQiLCJJbmZpbml0eSIsInByb2Nlc3NQcmVkaWNhdGVzIiwic29ydFByZWRpY2F0ZSIsInJldmVyc2VPcmRlciIsIm1hcCIsInByZWRpY2F0ZSIsImRlc2NlbmRpbmciLCJvYmplY3RWYWx1ZSIsImdldFByZWRpY2F0ZVZhbHVlIiwidjEiLCJ2MiIsImdldENvbXBhcmlzb25PYmplY3QiLCJwcmVkaWNhdGVWYWx1ZXMiLCJwcmVkaWNhdGVzIiwiZG9Db21wYXJpc29uIiwiY29tcGFyZVZhbHVlcyIsIm5nRGlyZWN0aXZlIiwibnVsbEZvcm1SZW5hbWVDb250cm9sIiwiY29udHJvbCIsIiRuYW1lIiwiRm9ybUNvbnRyb2xsZXIiLCJjb250cm9scyIsIiRlcnJvciIsIiQkc3VjY2VzcyIsIiRwZW5kaW5nIiwiJGRpcnR5IiwiJHByaXN0aW5lIiwiJHZhbGlkIiwiJGludmFsaWQiLCIkc3VibWl0dGVkIiwiJCRwYXJlbnRGb3JtIiwibnVsbEZvcm1DdHJsIiwiJHJvbGxiYWNrVmlld1ZhbHVlIiwiJGNvbW1pdFZpZXdWYWx1ZSIsIiRhZGRDb250cm9sIiwiJCRyZW5hbWVDb250cm9sIiwibmV3TmFtZSIsIm9sZE5hbWUiLCIkcmVtb3ZlQ29udHJvbCIsIiRzZXRWYWxpZGl0eSIsImFkZFNldFZhbGlkaXR5TWV0aG9kIiwiY3RybCIsInVuc2V0IiwiJHNldERpcnR5IiwiUFJJU1RJTkVfQ0xBU1MiLCJESVJUWV9DTEFTUyIsIiRzZXRQcmlzdGluZSIsInNldENsYXNzIiwiU1VCTUlUVEVEX0NMQVNTIiwiJHNldFVudG91Y2hlZCIsIiRzZXRTdWJtaXR0ZWQiLCJzdHJpbmdCYXNlZElucHV0VHlwZSIsIiRmb3JtYXR0ZXJzIiwiJGlzRW1wdHkiLCJ0ZXh0SW5wdXRUeXBlIiwiYmFzZUlucHV0VHlwZSIsImNvbXBvc2luZyIsImV2IiwibmdUcmltIiwiJHZpZXdWYWx1ZSIsIiQkaGFzTmF0aXZlVmFsaWRhdG9ycyIsIiRzZXRWaWV3VmFsdWUiLCJkZWZlckxpc3RlbmVyIiwib3JpZ1ZhbHVlIiwia2V5Q29kZSIsIiRyZW5kZXIiLCJ3ZWVrUGFyc2VyIiwiaXNvV2VlayIsImV4aXN0aW5nRGF0ZSIsIldFRUtfUkVHRVhQIiwid2VlayIsImhvdXJzIiwic2Vjb25kcyIsIm1pbGxpc2Vjb25kcyIsImFkZERheXMiLCJnZXRTZWNvbmRzIiwiZ2V0TWlsbGlzZWNvbmRzIiwiTmFOIiwiY3JlYXRlRGF0ZVBhcnNlciIsIm1hcHBpbmciLCJpc28iLCJJU09fREFURV9SRUdFWFAiLCJ5eXl5IiwiTU0iLCJkZCIsIkhIIiwibW0iLCJzcyIsInNzcyIsInBhcnQiLCJjcmVhdGVEYXRlSW5wdXRUeXBlIiwicGFyc2VEYXRlIiwiaXNWYWxpZERhdGUiLCJwYXJzZU9ic2VydmVkRGF0ZVZhbHVlIiwiYmFkSW5wdXRDaGVja2VyIiwicHJldmlvdXNEYXRlIiwiJG9wdGlvbnMiLCIkJHBhcnNlck5hbWUiLCIkcGFyc2VycyIsInBhcnNlZERhdGUiLCJuZ01vZGVsTWluRXJyIiwibmdNaW4iLCJtaW5WYWwiLCIkdmFsaWRhdG9ycyIsIiR2YWxpZGF0ZSIsIm5nTWF4IiwibWF4VmFsIiwibmF0aXZlVmFsaWRhdGlvbiIsInZhbGlkaXR5IiwiVkFMSURJVFlfU1RBVEVfUFJPUEVSVFkiLCJiYWRJbnB1dCIsInR5cGVNaXNtYXRjaCIsIm51bWJlcklucHV0VHlwZSIsIk5VTUJFUl9SRUdFWFAiLCJ1cmxJbnB1dFR5cGUiLCJtb2RlbFZhbHVlIiwidmlld1ZhbHVlIiwiVVJMX1JFR0VYUCIsImVtYWlsSW5wdXRUeXBlIiwiZW1haWwiLCJFTUFJTF9SRUdFWFAiLCJyYWRpb0lucHV0VHlwZSIsImNoZWNrZWQiLCJwYXJzZUNvbnN0YW50RXhwciIsInBhcnNlRm4iLCJjaGVja2JveElucHV0VHlwZSIsInRydWVWYWx1ZSIsIm5nVHJ1ZVZhbHVlIiwiZmFsc2VWYWx1ZSIsIm5nRmFsc2VWYWx1ZSIsImNsYXNzRGlyZWN0aXZlIiwiYXJyYXlEaWZmZXJlbmNlIiwiYXJyYXlDbGFzc2VzIiwiYWRkQ2xhc3NlcyIsImRpZ2VzdENsYXNzQ291bnRzIiwicmVtb3ZlQ2xhc3NlcyIsImNsYXNzQ291bnRzIiwiY2xhc3Nlc1RvVXBkYXRlIiwidXBkYXRlQ2xhc3NlcyIsIm5nQ2xhc3NXYXRjaEFjdGlvbiIsIiRpbmRleCIsIm9sZCRpbmRleCIsIm1vZCIsInNldFZhbGlkaXR5IiwidmFsaWRhdGlvbkVycm9yS2V5IiwiY3JlYXRlQW5kU2V0IiwidW5zZXRBbmRDbGVhbnVwIiwiY2FjaGVkVG9nZ2xlQ2xhc3MiLCJQRU5ESU5HX0NMQVNTIiwidG9nZ2xlVmFsaWRhdGlvbkNzcyIsImlzT2JqZWN0RW1wdHkiLCJjb21iaW5lZFN0YXRlIiwic3dpdGNoVmFsdWUiLCJjbGFzc0NhY2hlIiwiaXNWYWxpZCIsIlZBTElEX0NMQVNTIiwiSU5WQUxJRF9DTEFTUyIsImNocm9tZUhhY2siLCJvcHRpb25FbGVtZW50Iiwic2VsZWN0ZWQiLCJSRUdFWF9TVFJJTkdfUkVHRVhQIiwibWFudWFsTG93ZXJjYXNlIiwiU3RyaW5nIiwiZnJvbUNoYXJDb2RlIiwiY2hhckNvZGVBdCIsIm1hbnVhbFVwcGVyY2FzZSIsImRvY3VtZW50TW9kZSIsInJ1bGVzIiwibmdDc3BFbGVtZW50IiwibmdDc3BBdHRyaWJ1dGUiLCJub0lubGluZVN0eWxlIiwibmFtZV8iLCJlbCIsIk5PREVfVFlQRV9BVFRSSUJVVEUiLCJmdWxsIiwibWFqb3IiLCJtaW5vciIsImRvdCIsImNvZGVOYW1lIiwiZXhwYW5kbyIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwibW91c2VsZWF2ZSIsIm1vdXNlZW50ZXIiLCJ0aGVhZCIsImNvbCIsInRyIiwidGQiLCJvcHRncm91cCIsInRib2R5IiwidGZvb3QiLCJjb2xncm91cCIsImNhcHRpb24iLCJ0aCIsIk5vZGUiLCJjb250YWlucyIsImNvbXBhcmVEb2N1bWVudFBvc2l0aW9uIiwicmVhZHkiLCJ0cmlnZ2VyIiwiZmlyZWQiLCJyZW1vdmVEYXRhIiwicmVtb3ZlQXR0cmlidXRlIiwiY3NzIiwibG93ZXJjYXNlZE5hbWUiLCJnZXROYW1lZEl0ZW0iLCJzcGVjaWZpZWQiLCJyZXQiLCJnZXRUZXh0IiwiJGR2IiwibXVsdGlwbGUiLCJub2RlQ291bnQiLCJ0eXBlcyIsImFkZEhhbmRsZXIiLCJub0V2ZW50TGlzdGVuZXIiLCJvbmUiLCJvbkZuIiwicmVwbGFjZU5vZGUiLCJpbnNlcnRCZWZvcmUiLCJjb250ZW50RG9jdW1lbnQiLCJwcmVwZW5kIiwid3JhcE5vZGUiLCJkZXRhY2giLCJhZnRlciIsIm5ld0VsZW1lbnQiLCJ0b2dnbGVDbGFzcyIsImNvbmRpdGlvbiIsImNsYXNzQ29uZGl0aW9uIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJleHRyYVBhcmFtZXRlcnMiLCJkdW1teUV2ZW50IiwiZXZlbnRGbnNDb3B5IiwiaGFuZGxlckFyZ3MiLCJhcmczIiwidW5iaW5kIiwiJGFuaW1hdGVNaW5FcnIiLCJOR19BTklNQVRFX0NMQVNTTkFNRSIsInBvc3REaWdlc3RFbGVtZW50cyIsInVwZGF0ZURhdGEiLCJoYW5kbGVDU1NDbGFzc0NoYW5nZXMiLCJleGlzdGluZyIsImFkZFJlbW92ZUNsYXNzZXNQb3N0RGlnZXN0IiwiYWRkIiwiY2xhc3Nlc0FkZGVkIiwiY2xhc3Nlc1JlbW92ZWQiLCJwaW4iLCJkb21PcGVyYXRpb24iLCJmcm9tIiwidG8iLCJydW5uZXIiLCJjb21wbGV0ZSIsIiQkcmVnaXN0ZXJlZEFuaW1hdGlvbnMiLCJjbGFzc05hbWVGaWx0ZXIiLCIkJGNsYXNzTmFtZUZpbHRlciIsInJlc2VydmVkUmVnZXgiLCJkb21JbnNlcnQiLCJhZnRlckVsZW1lbnQiLCJhZnRlck5vZGUiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwiZW5kIiwiZW50ZXIiLCJtb3ZlIiwibGVhdmUiLCJhZGRjbGFzcyIsImFuaW1hdGUiLCJ0ZW1wQ2xhc3NlcyIsIndhaXRGb3JUaWNrIiwid2FpdFF1ZXVlIiwicGFzc2VkIiwiQW5pbWF0ZVJ1bm5lciIsInNldEhvc3QiLCJyYWZUaWNrIiwidGltZW91dFRpY2siLCJfZG9uZUNhbGxiYWNrcyIsIl90aWNrIiwiZG9jIiwiaGlkZGVuIiwiX3N0YXRlIiwiSU5JVElBTF9TVEFURSIsIkRPTkVfUEVORElOR19TVEFURSIsIkRPTkVfQ09NUExFVEVfU1RBVEUiLCJydW5uZXJzIiwib25Qcm9ncmVzcyIsImdldFByb21pc2UiLCJyZXNvbHZlSGFuZGxlciIsInJlamVjdEhhbmRsZXIiLCJyZXN1bWUiLCJfcmVzb2x2ZSIsImluaXRpYWxPcHRpb25zIiwiYXBwbHlBbmltYXRpb25Db250ZW50cyIsImNsb3NlZCIsIiQkcHJlcGFyZWQiLCJjbGVhbnVwU3R5bGVzIiwic3RhcnQiLCJvZmZzZXRXaWR0aCIsIkNvbnRlbnQtVHlwZSIsIlsiLCJ7IiwiJGh0dHBNaW5FcnIiLCJQQVRIX01BVENIIiwiaHR0cCIsImh0dHBzIiwiZnRwIiwibG9jYXRpb25Qcm90b3R5cGUiLCJwYXJhbVZhbHVlIiwiTG9jYXRpb24iLCJPUEVSQVRPUlMiLCJFU0NBUEUiLCJmIiwidCIsIiciLCJcIiIsImxleCIsInRva2VucyIsInJlYWRTdHJpbmciLCJwZWVrIiwicmVhZE51bWJlciIsImlzSWRlbnQiLCJyZWFkSWRlbnQiLCJpcyIsImlzV2hpdGVzcGFjZSIsImNoMiIsImNoMyIsIm9wMSIsIm9wMiIsIm9wMyIsInRocm93RXJyb3IiLCJjaGFycyIsImlzRXhwT3BlcmF0b3IiLCJjb2xTdHIiLCJwZWVrQ2giLCJxdW90ZSIsInJhd1N0cmluZyIsImhleCIsInJlcCIsIkV4cHJlc3Npb25TdGF0ZW1lbnQiLCJQcm9wZXJ0eSIsInByb2dyYW0iLCJleHByZXNzaW9uU3RhdGVtZW50IiwiZXhwZWN0IiwiZmlsdGVyQ2hhaW4iLCJhc3NpZ25tZW50IiwidGVybmFyeSIsImxvZ2ljYWxPUiIsImNvbnN1bWUiLCJsb2dpY2FsQU5EIiwiZXF1YWxpdHkiLCJyZWxhdGlvbmFsIiwiYWRkaXRpdmUiLCJtdWx0aXBsaWNhdGl2ZSIsInVuYXJ5IiwicHJpbWFyeSIsImFycmF5RGVjbGFyYXRpb24iLCJjb25zdGFudHMiLCJwYXJzZUFyZ3VtZW50cyIsImJhc2VFeHByZXNzaW9uIiwicGVla1Rva2VuIiwia2luZCIsImUxIiwiZTIiLCJlMyIsImU0IiwicGVla0FoZWFkIiwidHJ1ZSIsImZhbHNlIiwibnVsbCIsIiRsb2NhbHMiLCJuZXh0SWQiLCJ2YXJzIiwib3duIiwiYXNzaWduYWJsZSIsInN0YWdlIiwiY29tcHV0aW5nIiwicmVjdXJzZSIsInJldHVybl8iLCJnZW5lcmF0ZUZ1bmN0aW9uIiwiZm5LZXkiLCJpbnRvSWQiLCJ3YXRjaElkIiwiZm5TdHJpbmciLCJVU0UiLCJTVFJJQ1QiLCJmaWx0ZXJQcmVmaXgiLCJ3YXRjaEZucyIsInZhcnNQcmVmaXgiLCJzZWN0aW9uIiwibmFtZUlkIiwicmVjdXJzaW9uRm4iLCJza2lwV2F0Y2hJZENoZWNrIiwiaWZfIiwibGF6eUFzc2lnbiIsImNvbXB1dGVkTWVtYmVyIiwibGF6eVJlY3Vyc2UiLCJwbHVzIiwibm90IiwiZ2V0SGFzT3duUHJvcGVydHkiLCJub25Db21wdXRlZE1lbWJlciIsImFkZEVuc3VyZVNhZmVPYmplY3QiLCJub3ROdWxsIiwiYWRkRW5zdXJlU2FmZUFzc2lnbkNvbnRleHQiLCJhZGRFbnN1cmVTYWZlTWVtYmVyTmFtZSIsImFkZEVuc3VyZVNhZmVGdW5jdGlvbiIsIm1lbWJlciIsImRlZmF1bHRWYWx1ZSIsInN0cmluZ0VzY2FwZVJlZ2V4Iiwic3RyaW5nRXNjYXBlRm4iLCJza2lwIiwiaW5pdCIsInJocyIsImxocyIsInVuYXJ5KyIsInVuYXJ5LSIsInVuYXJ5ISIsImJpbmFyeSsiLCJiaW5hcnktIiwiYmluYXJ5KiIsImJpbmFyeS8iLCJiaW5hcnklIiwiYmluYXJ5PT09IiwiYmluYXJ5IT09IiwiYmluYXJ5PT0iLCJiaW5hcnkhPSIsImJpbmFyeTwiLCJiaW5hcnk+IiwiYmluYXJ5PD0iLCJiaW5hcnk+PSIsImJpbmFyeSYmIiwiYmluYXJ5fHwiLCJ0ZXJuYXJ5PzoiLCJhc3RDb21waWxlciIsInl5IiwieSIsIk1NTU0iLCJNTU0iLCJNIiwiSCIsImhoIiwiRUVFRSIsIkVFRSIsIloiLCJ3dyIsIkciLCJHRyIsIkdHRyIsIkdHR0ciLCJ4bGlua0hyZWYiLCJwcm9wTmFtZSIsImRlZmF1bHRMaW5rRm4iLCJub3JtYWxpemVkIiwiaHRtbEF0dHIiLCJmb3JtRGlyZWN0aXZlRmFjdG9yeSIsImlzTmdGb3JtIiwiZ2V0U2V0dGVyIiwiZm9ybUVsZW1lbnQiLCJuYW1lQXR0ciIsImN0cmxzIiwiaGFuZGxlRm9ybVN1Ym1pc3Npb24iLCJwYXJlbnRGb3JtQ3RybCIsInNldHRlciIsIkRBVEVfUkVHRVhQIiwiREFURVRJTUVMT0NBTF9SRUdFWFAiLCJNT05USF9SRUdFWFAiLCJUSU1FX1JFR0VYUCIsImlucHV0VHlwZSIsImRhdGV0aW1lLWxvY2FsIiwidGltZSIsIm1vbnRoIiwicmFkaW8iLCJjaGVja2JveCIsInN1Ym1pdCIsInJlc2V0IiwiZmlsZSIsIkNPTlNUQU5UX1ZBTFVFX1JFR0VYUCIsInRwbEF0dHIiLCIkY29tcGlsZSIsInRlbXBsYXRlRWxlbWVudCIsIm5nQmluZEh0bWxHZXR0ZXIiLCJuZ0JpbmRIdG1sV2F0Y2giLCJnZXRUcnVzdGVkSHRtbCIsIiR2aWV3Q2hhbmdlTGlzdGVuZXJzIiwiZm9yY2VBc3luY0V2ZW50cyIsImJsdXIiLCJmb2N1cyIsInByZXZpb3VzRWxlbWVudHMiLCJzcmNFeHAiLCJvbmxvYWRFeHAiLCJhdXRvU2Nyb2xsRXhwIiwiYXV0b3Njcm9sbCIsInByZXZpb3VzRWxlbWVudCIsImN1cnJlbnRFbGVtZW50IiwiY2hhbmdlQ291bnRlciIsImNsZWFudXBMYXN0SW5jbHVkZUNvbnRlbnQiLCJhZnRlckFuaW1hdGlvbiIsInRoaXNDaGFuZ2VJZCIsInRyaW1WYWx1ZXMiLCJVTlRPVUNIRURfQ0xBU1MiLCJUT1VDSEVEX0NMQVNTIiwiRU1QVFlfQ0xBU1MiLCJOT1RfRU1QVFlfQ0xBU1MiLCJOZ01vZGVsQ29udHJvbGxlciIsIiRtb2RlbFZhbHVlIiwiJCRyYXdNb2RlbFZhbHVlIiwiJGFzeW5jVmFsaWRhdG9ycyIsIiR1bnRvdWNoZWQiLCIkdG91Y2hlZCIsInBhcnNlclZhbGlkIiwicGFyc2VkTmdNb2RlbCIsInBhcnNlZE5nTW9kZWxBc3NpZ24iLCJuZ01vZGVsR2V0IiwibmdNb2RlbFNldCIsInBlbmRpbmdEZWJvdW5jZSIsIiQkc2V0T3B0aW9ucyIsImdldHRlclNldHRlciIsImludm9rZU1vZGVsR2V0dGVyIiwiaW52b2tlTW9kZWxTZXR0ZXIiLCIkJCRwIiwiJCR1cGRhdGVFbXB0eUNsYXNzZXMiLCJjdXJyZW50VmFsaWRhdGlvblJ1bklkIiwiJHNldFRvdWNoZWQiLCIkJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUiLCJwcmV2VmFsaWQiLCJwcmV2TW9kZWxWYWx1ZSIsImFsbG93SW52YWxpZCIsIiQkcnVuVmFsaWRhdG9ycyIsImFsbFZhbGlkIiwiJCR3cml0ZU1vZGVsVG9TY29wZSIsImRvbmVDYWxsYmFjayIsInByb2Nlc3NQYXJzZUVycm9ycyIsImVycm9yS2V5IiwicHJvY2Vzc1N5bmNWYWxpZGF0b3JzIiwic3luY1ZhbGlkYXRvcnNWYWxpZCIsInZhbGlkYXRvciIsInByb2Nlc3NBc3luY1ZhbGlkYXRvcnMiLCJ2YWxpZGF0b3JQcm9taXNlcyIsInZhbGlkYXRpb25Eb25lIiwibG9jYWxWYWxpZGF0aW9uUnVuSWQiLCIkJHBhcnNlQW5kVmFsaWRhdGUiLCJ3cml0ZVRvTW9kZWxJZk5lZWRlZCIsInVwZGF0ZU9uRGVmYXVsdCIsIiQkZGVib3VuY2VWaWV3VmFsdWVDb21taXQiLCJkZWJvdW5jZSIsImRlYm91bmNlRGVsYXkiLCJmb3JtYXR0ZXJzIiwibW9kZWxDdHJsIiwiZm9ybUN0cmwiLCJ1cGRhdGVPbiIsIkRFRkFVTFRfUkVHRVhQIiwibmdPcHRpb25zTWluRXJyIiwiTkdfT1BUSU9OU19SRUdFWFAiLCJwYXJzZU9wdGlvbnNFeHByZXNzaW9uIiwib3B0aW9uc0V4cCIsInNlbGVjdEVsZW1lbnQiLCJPcHRpb24iLCJzZWxlY3RWYWx1ZSIsImxhYmVsIiwiZ3JvdXAiLCJkaXNhYmxlZCIsImdldE9wdGlvblZhbHVlc0tleXMiLCJvcHRpb25WYWx1ZXMiLCJvcHRpb25WYWx1ZXNLZXlzIiwia2V5TmFtZSIsIml0ZW1LZXkiLCJ2YWx1ZU5hbWUiLCJzZWxlY3RBcyIsInRyYWNrQnkiLCJzZWxlY3RBc0ZuIiwidmlld1ZhbHVlRm4iLCJ0cmFja0J5Rm4iLCJnZXRUcmFja0J5VmFsdWVGbiIsImdldFRyYWNrQnlWYWx1ZSIsImdldExvY2FscyIsImRpc3BsYXlGbiIsImdyb3VwQnlGbiIsImRpc2FibGVXaGVuRm4iLCJ2YWx1ZXNGbiIsImdldFdhdGNoYWJsZXMiLCJ3YXRjaGVkQXJyYXkiLCJvcHRpb25WYWx1ZXNMZW5ndGgiLCJkaXNhYmxlV2hlbiIsImdldE9wdGlvbnMiLCJvcHRpb25JdGVtcyIsInNlbGVjdFZhbHVlTWFwIiwib3B0aW9uSXRlbSIsImdldE9wdGlvbkZyb21WaWV3VmFsdWUiLCJnZXRWaWV3VmFsdWVGcm9tT3B0aW9uIiwibmdPcHRpb25zUG9zdExpbmsiLCJ1cGRhdGVPcHRpb25FbGVtZW50IiwiYWRkT3JSZXVzZUVsZW1lbnQiLCJyZW1vdmVFeGNlc3NFbGVtZW50cyIsInNraXBFbXB0eUFuZFVua25vd25PcHRpb25zIiwiZW1wdHlPcHRpb25fIiwiZW1wdHlPcHRpb24iLCJ1bmtub3duT3B0aW9uXyIsInVua25vd25PcHRpb24iLCJ1cGRhdGVPcHRpb25zIiwicHJldmlvdXNWYWx1ZSIsInNlbGVjdEN0cmwiLCJyZWFkVmFsdWUiLCJncm91cE1hcCIsInByb3ZpZGVkRW1wdHlPcHRpb24iLCJncm91cEVsZW1lbnQiLCJvcHRHcm91cFRlbXBsYXRlIiwiY3VycmVudE9wdGlvbkVsZW1lbnQiLCJvcHRpb25UZW1wbGF0ZSIsIm5nTW9kZWxDdHJsIiwibmV4dFZhbHVlIiwiaXNOb3RQcmltaXRpdmUiLCJyZW5kZXJFbXB0eU9wdGlvbiIsInJlbW92ZUVtcHR5T3B0aW9uIiwicmVuZGVyVW5rbm93bk9wdGlvbiIsInJlbW92ZVVua25vd25PcHRpb24iLCJ3cml0ZVZhbHVlIiwic2VsZWN0ZWRWYWx1ZXMiLCJzZWxlY3Rpb25zIiwic2VsZWN0ZWRPcHRpb24iLCJyZWdpc3Rlck9wdGlvbiIsIkJSQUNFIiwiSVNfV0hFTiIsInVwZGF0ZUVsZW1lbnRUZXh0IiwibmV3VGV4dCIsImxhc3RDb3VudCIsIm51bWJlckV4cCIsIndoZW5FeHAiLCJ3aGVucyIsIndoZW5zRXhwRm5zIiwiYnJhY2VSZXBsYWNlbWVudCIsIndhdGNoUmVtb3ZlciIsImF0dHJpYnV0ZU5hbWUiLCJ0bXBNYXRjaCIsIndoZW5LZXkiLCJjb3VudElzTmFOIiwicGx1cmFsQ2F0Iiwid2hlbkV4cEZuIiwiTkdfUkVNT1ZFRCIsIm5nUmVwZWF0TWluRXJyIiwidXBkYXRlU2NvcGUiLCJ2YWx1ZUlkZW50aWZpZXIiLCJrZXlJZGVudGlmaWVyIiwiYXJyYXlMZW5ndGgiLCIkZmlyc3QiLCIkbGFzdCIsIiRtaWRkbGUiLCIkb2RkIiwiJGV2ZW4iLCJnZXRCbG9ja1N0YXJ0IiwiZ2V0QmxvY2tFbmQiLCJuZ1JlcGVhdEVuZENvbW1lbnQiLCJhbGlhc0FzIiwidHJhY2tCeUV4cCIsInRyYWNrQnlFeHBHZXR0ZXIiLCJ0cmFja0J5SWRFeHBGbiIsInRyYWNrQnlJZEFycmF5Rm4iLCJ0cmFja0J5SWRPYmpGbiIsImhhc2hGbkxvY2FscyIsImxhc3RCbG9ja01hcCIsIm5leHROb2RlIiwiY29sbGVjdGlvbkxlbmd0aCIsInRyYWNrQnlJZCIsInRyYWNrQnlJZEZuIiwiY29sbGVjdGlvbktleXMiLCJuZXh0QmxvY2tPcmRlciIsInByZXZpb3VzTm9kZSIsIm5leHRCbG9ja01hcCIsImJsb2NrS2V5IiwiTkdfSElERV9DTEFTUyIsIk5HX0hJREVfSU5fUFJPR1JFU1NfQ0xBU1MiLCJuZXdTdHlsZXMiLCJvbGRTdHlsZXMiLCJjYXNlcyIsIm5nU3dpdGNoQ29udHJvbGxlciIsIndhdGNoRXhwciIsInNlbGVjdGVkVHJhbnNjbHVkZXMiLCJzZWxlY3RlZEVsZW1lbnRzIiwicHJldmlvdXNMZWF2ZUFuaW1hdGlvbnMiLCJzZWxlY3RlZFNjb3BlcyIsInNwbGljZUZhY3RvcnkiLCJzZWxlY3RlZFRyYW5zY2x1ZGUiLCJjYXNlRWxlbWVudCIsInNlbGVjdGVkU2NvcGUiLCJhbmNob3IiLCJuZ1RyYW5zY2x1ZGVNaW5FcnIiLCJuZ1RyYW5zY2x1ZGVDbG9uZUF0dGFjaEZuIiwibmdUcmFuc2NsdWRlU2xvdCIsIm5vb3BOZ01vZGVsQ29udHJvbGxlciIsIlNlbGVjdENvbnRyb2xsZXIiLCJvcHRpb25zTWFwIiwidW5rbm93blZhbCIsImhhc09wdGlvbiIsImFkZE9wdGlvbiIsInJlbW92ZU9wdGlvbiIsIm9wdGlvblNjb3BlIiwib3B0aW9uQXR0cnMiLCJpbnRlcnBvbGF0ZVZhbHVlRm4iLCJpbnRlcnBvbGF0ZVRleHRGbiIsInNlbGVjdFByZUxpbmsiLCJsYXN0VmlldyIsImxhc3RWaWV3UmVmIiwic2VsZWN0UG9zdExpbmsiLCJzZWxlY3RDdHJsTmFtZSIsInBhdHRlcm5FeHAiLCJpbnRWYWwiLCJnZXREZWNpbWFscyIsImdldFZGIiwib3B0X3ByZWNpc2lvbiIsInBvdyIsIlBMVVJBTF9DQVRFR09SWSIsIlpFUk8iLCJPTkUiLCJUV08iLCJGRVciLCJNQU5ZIiwiT1RIRVIiLCJEQVkiLCJGSVJTVERBWU9GV0VFSyIsIk1PTlRIIiwiU0hPUlREQVkiLCJTSE9SVE1PTlRIIiwiU1RBTkRBTE9ORU1PTlRIIiwiV0VFS0VORFJBTkdFIiwiZnVsbERhdGUiLCJsb25nRGF0ZSIsIm1lZGl1bSIsIm1lZGl1bURhdGUiLCJtZWRpdW1UaW1lIiwic2hvcnQiLCJzaG9ydERhdGUiLCJzaG9ydFRpbWUiLCJtaW5JbnQiLCJsb2NhbGVJRCIsInZmIiwiaGVhZCIsIm1lZGlhUXVlcnkiLCJhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzIiwiZW5kc1dpdGgiLCJNYWxhcmtleSIsImVucXVldWUiLCJmblF1ZXVlIiwiYXJnc1F1ZXVlIiwiUlVOTklORyIsIlNUT1BQRUQiLCJwYXVzZUNiIiwiX3R5cGUiLCJjYiIsInNwZWVkIiwiX2RlbGV0ZSIsIngiLCJjdXJyIiwiX2NsZWFyIiwiX2NhbGwiLCJjbGVhciIsInRyaWdnZXJQYXVzZSIsIlNUT1BQSU5HIiwidHJpZ2dlclJlc3VtZSIsInByZXZTdGF0ZSIsImlzUnVubmluZyIsImFkZFN0eWxlc1RvRG9tIiwic3R5bGVzIiwiZG9tU3R5bGUiLCJzdHlsZXNJbkRvbSIsInJlZnMiLCJhZGRTdHlsZSIsImxpc3RUb1N0eWxlcyIsIm1lZGlhIiwic291cmNlTWFwIiwiaW5zZXJ0U3R5bGVFbGVtZW50Iiwic3R5bGVFbGVtZW50IiwiZ2V0SGVhZEVsZW1lbnQiLCJsYXN0U3R5bGVFbGVtZW50SW5zZXJ0ZWRBdFRvcCIsInN0eWxlRWxlbWVudHNJbnNlcnRlZEF0VG9wIiwiaW5zZXJ0QXQiLCJyZW1vdmVTdHlsZUVsZW1lbnQiLCJjcmVhdGVTdHlsZUVsZW1lbnQiLCJjcmVhdGVMaW5rRWxlbWVudCIsImxpbmtFbGVtZW50IiwicmVsIiwidXBkYXRlIiwic2luZ2xldG9uIiwic3R5bGVJbmRleCIsInNpbmdsZXRvbkNvdW50ZXIiLCJzaW5nbGV0b25FbGVtZW50IiwiYXBwbHlUb1NpbmdsZXRvblRhZyIsImNyZWF0ZU9iamVjdFVSTCIsInJldm9rZU9iamVjdFVSTCIsIkJsb2IiLCJidG9hIiwidXBkYXRlTGluayIsImFwcGx5VG9UYWciLCJuZXdPYmoiLCJzdHlsZVNoZWV0IiwiY3NzVGV4dCIsInJlcGxhY2VUZXh0IiwiY3NzTm9kZSIsInVuZXNjYXBlIiwiYmxvYiIsIm9sZFNyYyIsIm1lbW9pemUiLCJtZW1vIiwiaXNPbGRJRSIsIm5ld0xpc3QiLCJtYXlSZW1vdmUiLCJ0ZXh0U3RvcmUiLCJyZXBsYWNlbWVudCIsIkJvb2xlYW4iXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FFLFdBQ0FFLEdBQUFKLEVBQ0FLLFFBQUEsRUFVQSxPQU5BUCxHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBSCxHQUdBSSxFQUFBRSxRQUFBLEVBR0FGLEVBQUFELFFBdkJBLEdBQUFELEtBcUNBLE9BVEFGLEdBQUFRLEVBQUFULEVBR0FDLEVBQUFTLEVBQUFQLEVBR0FGLEVBQUFVLEVBQUEsR0FHQVYsRUFBQSxLRE1NLFNBQVNJLEVBQVFELEVBQVNILEdBRS9CLFlBa0JBLFNBQVNXLEdBQXVCQyxHQUFPLE1BQU9BLElBQU9BLEVBQUlDLFdBQWFELEdBQVFFLFVBQVNGLEdBRXZGLFFBQVNHLEdBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNFbEVqSCxHQUFBQyxHQUFBbkIsRUFBQSxHRmtES29CLEVBQVlULEVBQXVCUSxHRWpEeENFLEVBQUFyQixFQUFBLEdBQ0FzQixHRm9EZVgsRUFBdUJVLEdFcER0Q3JCLEVBQUEsSUZ3REt1QixFQUFVWixFQUF1QlcsR0V2RHRDRSxFQUFBeEIsRUFBQSxHRjJES3lCLEVBQWFkLEVBQXVCYSxHRXpEbkNFLEVBQ0osUUFBQUEsS0FBY1gsRUFBQVksS0FBQUQsR0FDYkMsS0FBS0MsUUFBVUwsYUFBT0ssUUFDckJELEtBQUtFLGNBQ0hDLE9BQVEsK0JBQWdDLG9CQUN4Q3pCLEdBQUksV0FDSjBCLFVB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T0FBMkJvQyxJQUM3Q2k4RSxFQUFBdnpFLE1BQUExSSxXQUNBazhFLEdBQUFELEVBQUF2aUYsT0FpSUEsSUFBQXdrRixHQUFBLFdBQ0EsR0FBQVUsS0FFQSxpQkFBQW5oRixFQUFBb2hGLEdBRUEsTUFEQUQsR0FBQW5oRixHQUFBb2hGLEVBQ0FELEVBQUFydkUsT0FBQXV2RSxTQUFBajJFLEtBQUEsV1RrcThCTSxTQUFTcFAsRUFBUUQsRUFBU0gsR1U1MThCaEMsR0FBQTRoQyxHQUFBNWhDLEVBQUEsRUFDQSxpQkFBQTRoQyxTQUFBeGhDLEVBQUFDLEdBQUF1aEMsRUFBQSxLQUVBNWhDLEdBQUEsR0FBQTRoQyxLQUNBQSxHQUFBbFYsU0FBQXRzQixFQUFBRCxRQUFBeWhDLEVBQUFsViIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBfYW5ndWxhciA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdFxuXHR2YXIgX2FuZ3VsYXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYW5ndWxhcik7XG5cdFxuXHR2YXIgX2luZGV4ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTtcblx0XG5cdHZhciBfaW5kZXgyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5kZXgpO1xuXHRcblx0dmFyIF9pbmRleDMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpO1xuXHRcblx0dmFyIF9pbmRleDQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbmRleDMpO1xuXHRcblx0dmFyIF9tYWxhcmtleSA9IF9fd2VicGFja19yZXF1aXJlX18oNik7XG5cdFxuXHR2YXIgX21hbGFya2V5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21hbGFya2V5KTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0dmFyIEFwcENvbnRyb2xsZXIgPSBmdW5jdGlvbiBBcHBDb250cm9sbGVyKCkge1xuXHQgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBcHBDb250cm9sbGVyKTtcblx0XG5cdCAgdGhpcy52ZXJzaW9uID0gX2luZGV4NC5kZWZhdWx0LnZlcnNpb247XG5cdCAgdGhpcy50eXBpc3RDb25maWcgPSB7XG5cdCAgICB3b3JkczogWydIZWxsbywgdHlwaXN0IGF0IHdvcmsgYW5kLi4uJywgJ0hhdmUgYSBuaWNlIGRheSEnXSxcblx0ICAgIGlkOiAnbWFsYXJrZXknLFxuXHQgICAgdHlwZVNwZWVkOiA1MCxcblx0ICAgIGRlbGV0ZVNwZWVkOiA1MCxcblx0ICAgIHBhdXNlRGVsYXk6IDUwMCxcblx0ICAgIGxvb3A6IHRydWUsXG5cdCAgICBwb3N0Zml4OiAnJ1xuXHQgIH07XG5cdH07XG5cdFxuXHR2YXIgVHlwaXN0Q29udHJvbGxlciA9IGZ1bmN0aW9uIFR5cGlzdENvbnRyb2xsZXIoKSB7XG5cdCAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFR5cGlzdENvbnRyb2xsZXIpO1xuXHRcblx0ICB2YXIgZWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdGhpcy5jb25maWcuaWQpO1xuXHQgIHZhciBvcHRzID0ge1xuXHQgICAgdHlwZVNwZWVkOiB0aGlzLmNvbmZpZy50eXBlU3BlZWQsXG5cdCAgICBkZWxldGVTcGVlZDogdGhpcy5jb25maWcuZGVsZXRlU3BlZWQsXG5cdCAgICBwYXVzZURlbGF5OiB0aGlzLmNvbmZpZy5wYXVzZURlbGF5LFxuXHQgICAgbG9vcDogdGhpcy5jb25maWcubG9vcCxcblx0ICAgIHBvc3RmaXg6IHRoaXMuY29uZmlnLnBvc3RmaXhcblx0ICB9O1xuXHRcblx0ICB2YXIgYWN0ID0gKDAsIF9tYWxhcmtleTIuZGVmYXVsdCkoZWxlbSwgb3B0cyk7XG5cdCAgdGhpcy5jb25maWcud29yZHMuZm9yRWFjaChmdW5jdGlvbiAodykge1xuXHQgICAgYWN0LnR5cGUodykucGF1c2UoKS5kZWxldGUoKTtcblx0ICB9KTtcblx0fTtcblx0XG5cdF9hbmd1bGFyMi5kZWZhdWx0Lm1vZHVsZSgndHlwaXN0JywgW10pLmNvbnRyb2xsZXIoJ0FwcENvbnRyb2xsZXInLCBBcHBDb250cm9sbGVyKS5jb250cm9sbGVyKCdUeXBpc3RDb250cm9sbGVyJywgVHlwaXN0Q29udHJvbGxlcikuY29tcG9uZW50KCd0eXBpc3QnLCB7XG5cdCAgcmVzdHJpY3Q6ICdFJyxcblx0ICBiaW5kaW5nczoge1xuXHQgICAgY29uZmlnOiAnPSdcblx0ICB9LFxuXHQgIHRlbXBsYXRlOiAnPGRpdiBuZy1hdHRyLWlkPVwie3tjb25maWcuaWR9fVwiPjwvZGl2PicsXG5cdCAgY29udHJvbGxlcjogJ1R5cGlzdENvbnRyb2xsZXInLFxuXHQgIGNvbnRyb2xsZXJBczogJ3RjJ1xuXHR9KTtcblx0XG5cdF9hbmd1bGFyMi5kZWZhdWx0LmJvb3RzdHJhcChkb2N1bWVudCwgWyd0eXBpc3QnXSk7XG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvKipcblx0ICogQGxpY2Vuc2UgQW5ndWxhckpTIHYxLjUuMFxuXHQgKiAoYykgMjAxMC0yMDE2IEdvb2dsZSwgSW5jLiBodHRwOi8vYW5ndWxhcmpzLm9yZ1xuXHQgKiBMaWNlbnNlOiBNSVRcblx0ICovXG5cdChmdW5jdGlvbih3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQpIHsndXNlIHN0cmljdCc7XG5cdFxuXHQvKipcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqXG5cdCAqIFRoaXMgb2JqZWN0IHByb3ZpZGVzIGEgdXRpbGl0eSBmb3IgcHJvZHVjaW5nIHJpY2ggRXJyb3IgbWVzc2FnZXMgd2l0aGluXG5cdCAqIEFuZ3VsYXIuIEl0IGNhbiBiZSBjYWxsZWQgYXMgZm9sbG93czpcblx0ICpcblx0ICogdmFyIGV4YW1wbGVNaW5FcnIgPSBtaW5FcnIoJ2V4YW1wbGUnKTtcblx0ICogdGhyb3cgZXhhbXBsZU1pbkVycignb25lJywgJ1RoaXMgezB9IGlzIHsxfScsIGZvbywgYmFyKTtcblx0ICpcblx0ICogVGhlIGFib3ZlIGNyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgbWluRXJyIGluIHRoZSBleGFtcGxlIG5hbWVzcGFjZS4gVGhlXG5cdCAqIHJlc3VsdGluZyBlcnJvciB3aWxsIGhhdmUgYSBuYW1lc3BhY2VkIGVycm9yIGNvZGUgb2YgZXhhbXBsZS5vbmUuICBUaGVcblx0ICogcmVzdWx0aW5nIGVycm9yIHdpbGwgcmVwbGFjZSB7MH0gd2l0aCB0aGUgdmFsdWUgb2YgZm9vLCBhbmQgezF9IHdpdGggdGhlXG5cdCAqIHZhbHVlIG9mIGJhci4gVGhlIG9iamVjdCBpcyBub3QgcmVzdHJpY3RlZCBpbiB0aGUgbnVtYmVyIG9mIGFyZ3VtZW50cyBpdCBjYW5cblx0ICogdGFrZS5cblx0ICpcblx0ICogSWYgZmV3ZXIgYXJndW1lbnRzIGFyZSBzcGVjaWZpZWQgdGhhbiBuZWNlc3NhcnkgZm9yIGludGVycG9sYXRpb24sIHRoZSBleHRyYVxuXHQgKiBpbnRlcnBvbGF0aW9uIG1hcmtlcnMgd2lsbCBiZSBwcmVzZXJ2ZWQgaW4gdGhlIGZpbmFsIHN0cmluZy5cblx0ICpcblx0ICogU2luY2UgZGF0YSB3aWxsIGJlIHBhcnNlZCBzdGF0aWNhbGx5IGR1cmluZyBhIGJ1aWxkIHN0ZXAsIHNvbWUgcmVzdHJpY3Rpb25zXG5cdCAqIGFyZSBhcHBsaWVkIHdpdGggcmVzcGVjdCB0byBob3cgbWluRXJyIGluc3RhbmNlcyBhcmUgY3JlYXRlZCBhbmQgY2FsbGVkLlxuXHQgKiBJbnN0YW5jZXMgc2hvdWxkIGhhdmUgbmFtZXMgb2YgdGhlIGZvcm0gbmFtZXNwYWNlTWluRXJyIGZvciBhIG1pbkVyciBjcmVhdGVkXG5cdCAqIHVzaW5nIG1pbkVycignbmFtZXNwYWNlJykgLiBFcnJvciBjb2RlcywgbmFtZXNwYWNlcyBhbmQgdGVtcGxhdGUgc3RyaW5nc1xuXHQgKiBzaG91bGQgYWxsIGJlIHN0YXRpYyBzdHJpbmdzLCBub3QgdmFyaWFibGVzIG9yIGdlbmVyYWwgZXhwcmVzc2lvbnMuXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBtb2R1bGUgVGhlIG5hbWVzcGFjZSB0byB1c2UgZm9yIHRoZSBuZXcgbWluRXJyIGluc3RhbmNlLlxuXHQgKiBAcGFyYW0ge2Z1bmN0aW9ufSBFcnJvckNvbnN0cnVjdG9yIEN1c3RvbSBlcnJvciBjb25zdHJ1Y3RvciB0byBiZSBpbnN0YW50aWF0ZWQgd2hlbiByZXR1cm5pbmdcblx0ICogICBlcnJvciBmcm9tIHJldHVybmVkIGZ1bmN0aW9uLCBmb3IgY2FzZXMgd2hlbiBhIHBhcnRpY3VsYXIgdHlwZSBvZiBlcnJvciBpcyB1c2VmdWwuXG5cdCAqIEByZXR1cm5zIHtmdW5jdGlvbihjb2RlOnN0cmluZywgdGVtcGxhdGU6c3RyaW5nLCAuLi50ZW1wbGF0ZUFyZ3MpOiBFcnJvcn0gbWluRXJyIGluc3RhbmNlXG5cdCAqL1xuXHRcblx0ZnVuY3Rpb24gbWluRXJyKG1vZHVsZSwgRXJyb3JDb25zdHJ1Y3Rvcikge1xuXHQgIEVycm9yQ29uc3RydWN0b3IgPSBFcnJvckNvbnN0cnVjdG9yIHx8IEVycm9yO1xuXHQgIHJldHVybiBmdW5jdGlvbigpIHtcblx0ICAgIHZhciBTS0lQX0lOREVYRVMgPSAyO1xuXHRcblx0ICAgIHZhciB0ZW1wbGF0ZUFyZ3MgPSBhcmd1bWVudHMsXG5cdCAgICAgIGNvZGUgPSB0ZW1wbGF0ZUFyZ3NbMF0sXG5cdCAgICAgIG1lc3NhZ2UgPSAnWycgKyAobW9kdWxlID8gbW9kdWxlICsgJzonIDogJycpICsgY29kZSArICddICcsXG5cdCAgICAgIHRlbXBsYXRlID0gdGVtcGxhdGVBcmdzWzFdLFxuXHQgICAgICBwYXJhbVByZWZpeCwgaTtcblx0XG5cdCAgICBtZXNzYWdlICs9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xcZCtcXH0vZywgZnVuY3Rpb24obWF0Y2gpIHtcblx0ICAgICAgdmFyIGluZGV4ID0gK21hdGNoLnNsaWNlKDEsIC0xKSxcblx0ICAgICAgICBzaGlmdGVkSW5kZXggPSBpbmRleCArIFNLSVBfSU5ERVhFUztcblx0XG5cdCAgICAgIGlmIChzaGlmdGVkSW5kZXggPCB0ZW1wbGF0ZUFyZ3MubGVuZ3RoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRvRGVidWdTdHJpbmcodGVtcGxhdGVBcmdzW3NoaWZ0ZWRJbmRleF0pO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gbWF0Y2g7XG5cdCAgICB9KTtcblx0XG5cdCAgICBtZXNzYWdlICs9ICdcXG5odHRwOi8vZXJyb3JzLmFuZ3VsYXJqcy5vcmcvMS41LjAvJyArXG5cdCAgICAgIChtb2R1bGUgPyBtb2R1bGUgKyAnLycgOiAnJykgKyBjb2RlO1xuXHRcblx0ICAgIGZvciAoaSA9IFNLSVBfSU5ERVhFUywgcGFyYW1QcmVmaXggPSAnPyc7IGkgPCB0ZW1wbGF0ZUFyZ3MubGVuZ3RoOyBpKyssIHBhcmFtUHJlZml4ID0gJyYnKSB7XG5cdCAgICAgIG1lc3NhZ2UgKz0gcGFyYW1QcmVmaXggKyAncCcgKyAoaSAtIFNLSVBfSU5ERVhFUykgKyAnPScgK1xuXHQgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudCh0b0RlYnVnU3RyaW5nKHRlbXBsYXRlQXJnc1tpXSkpO1xuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiBuZXcgRXJyb3JDb25zdHJ1Y3RvcihtZXNzYWdlKTtcblx0ICB9O1xuXHR9XG5cdFxuXHQvKiBXZSBuZWVkIHRvIHRlbGwganNoaW50IHdoYXQgdmFyaWFibGVzIGFyZSBiZWluZyBleHBvcnRlZCAqL1xuXHQvKiBnbG9iYWwgYW5ndWxhcjogdHJ1ZSxcblx0ICBtc2llOiB0cnVlLFxuXHQgIGpxTGl0ZTogdHJ1ZSxcblx0ICBqUXVlcnk6IHRydWUsXG5cdCAgc2xpY2U6IHRydWUsXG5cdCAgc3BsaWNlOiB0cnVlLFxuXHQgIHB1c2g6IHRydWUsXG5cdCAgdG9TdHJpbmc6IHRydWUsXG5cdCAgbmdNaW5FcnI6IHRydWUsXG5cdCAgYW5ndWxhck1vZHVsZTogdHJ1ZSxcblx0ICB1aWQ6IHRydWUsXG5cdCAgUkVHRVhfU1RSSU5HX1JFR0VYUDogdHJ1ZSxcblx0ICBWQUxJRElUWV9TVEFURV9QUk9QRVJUWTogdHJ1ZSxcblx0XG5cdCAgbG93ZXJjYXNlOiB0cnVlLFxuXHQgIHVwcGVyY2FzZTogdHJ1ZSxcblx0ICBtYW51YWxMb3dlcmNhc2U6IHRydWUsXG5cdCAgbWFudWFsVXBwZXJjYXNlOiB0cnVlLFxuXHQgIG5vZGVOYW1lXzogdHJ1ZSxcblx0ICBpc0FycmF5TGlrZTogdHJ1ZSxcblx0ICBmb3JFYWNoOiB0cnVlLFxuXHQgIGZvckVhY2hTb3J0ZWQ6IHRydWUsXG5cdCAgcmV2ZXJzZVBhcmFtczogdHJ1ZSxcblx0ICBuZXh0VWlkOiB0cnVlLFxuXHQgIHNldEhhc2hLZXk6IHRydWUsXG5cdCAgZXh0ZW5kOiB0cnVlLFxuXHQgIHRvSW50OiB0cnVlLFxuXHQgIGluaGVyaXQ6IHRydWUsXG5cdCAgbWVyZ2U6IHRydWUsXG5cdCAgbm9vcDogdHJ1ZSxcblx0ICBpZGVudGl0eTogdHJ1ZSxcblx0ICB2YWx1ZUZuOiB0cnVlLFxuXHQgIGlzVW5kZWZpbmVkOiB0cnVlLFxuXHQgIGlzRGVmaW5lZDogdHJ1ZSxcblx0ICBpc09iamVjdDogdHJ1ZSxcblx0ICBpc0JsYW5rT2JqZWN0OiB0cnVlLFxuXHQgIGlzU3RyaW5nOiB0cnVlLFxuXHQgIGlzTnVtYmVyOiB0cnVlLFxuXHQgIGlzRGF0ZTogdHJ1ZSxcblx0ICBpc0FycmF5OiB0cnVlLFxuXHQgIGlzRnVuY3Rpb246IHRydWUsXG5cdCAgaXNSZWdFeHA6IHRydWUsXG5cdCAgaXNXaW5kb3c6IHRydWUsXG5cdCAgaXNTY29wZTogdHJ1ZSxcblx0ICBpc0ZpbGU6IHRydWUsXG5cdCAgaXNGb3JtRGF0YTogdHJ1ZSxcblx0ICBpc0Jsb2I6IHRydWUsXG5cdCAgaXNCb29sZWFuOiB0cnVlLFxuXHQgIGlzUHJvbWlzZUxpa2U6IHRydWUsXG5cdCAgdHJpbTogdHJ1ZSxcblx0ICBlc2NhcGVGb3JSZWdleHA6IHRydWUsXG5cdCAgaXNFbGVtZW50OiB0cnVlLFxuXHQgIG1ha2VNYXA6IHRydWUsXG5cdCAgaW5jbHVkZXM6IHRydWUsXG5cdCAgYXJyYXlSZW1vdmU6IHRydWUsXG5cdCAgY29weTogdHJ1ZSxcblx0ICBzaGFsbG93Q29weTogdHJ1ZSxcblx0ICBlcXVhbHM6IHRydWUsXG5cdCAgY3NwOiB0cnVlLFxuXHQgIGpxOiB0cnVlLFxuXHQgIGNvbmNhdDogdHJ1ZSxcblx0ICBzbGljZUFyZ3M6IHRydWUsXG5cdCAgYmluZDogdHJ1ZSxcblx0ICB0b0pzb25SZXBsYWNlcjogdHJ1ZSxcblx0ICB0b0pzb246IHRydWUsXG5cdCAgZnJvbUpzb246IHRydWUsXG5cdCAgY29udmVydFRpbWV6b25lVG9Mb2NhbDogdHJ1ZSxcblx0ICB0aW1lem9uZVRvT2Zmc2V0OiB0cnVlLFxuXHQgIHN0YXJ0aW5nVGFnOiB0cnVlLFxuXHQgIHRyeURlY29kZVVSSUNvbXBvbmVudDogdHJ1ZSxcblx0ICBwYXJzZUtleVZhbHVlOiB0cnVlLFxuXHQgIHRvS2V5VmFsdWU6IHRydWUsXG5cdCAgZW5jb2RlVXJpU2VnbWVudDogdHJ1ZSxcblx0ICBlbmNvZGVVcmlRdWVyeTogdHJ1ZSxcblx0ICBhbmd1bGFySW5pdDogdHJ1ZSxcblx0ICBib290c3RyYXA6IHRydWUsXG5cdCAgZ2V0VGVzdGFiaWxpdHk6IHRydWUsXG5cdCAgc25ha2VfY2FzZTogdHJ1ZSxcblx0ICBiaW5kSlF1ZXJ5OiB0cnVlLFxuXHQgIGFzc2VydEFyZzogdHJ1ZSxcblx0ICBhc3NlcnRBcmdGbjogdHJ1ZSxcblx0ICBhc3NlcnROb3RIYXNPd25Qcm9wZXJ0eTogdHJ1ZSxcblx0ICBnZXR0ZXI6IHRydWUsXG5cdCAgZ2V0QmxvY2tOb2RlczogdHJ1ZSxcblx0ICBoYXNPd25Qcm9wZXJ0eTogdHJ1ZSxcblx0ICBjcmVhdGVNYXA6IHRydWUsXG5cdFxuXHQgIE5PREVfVFlQRV9FTEVNRU5UOiB0cnVlLFxuXHQgIE5PREVfVFlQRV9BVFRSSUJVVEU6IHRydWUsXG5cdCAgTk9ERV9UWVBFX1RFWFQ6IHRydWUsXG5cdCAgTk9ERV9UWVBFX0NPTU1FTlQ6IHRydWUsXG5cdCAgTk9ERV9UWVBFX0RPQ1VNRU5UOiB0cnVlLFxuXHQgIE5PREVfVFlQRV9ET0NVTUVOVF9GUkFHTUVOVDogdHJ1ZSxcblx0Ki9cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBtb2R1bGVcblx0ICogQG5hbWUgbmdcblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogIyBuZyAoY29yZSBtb2R1bGUpXG5cdCAqIFRoZSBuZyBtb2R1bGUgaXMgbG9hZGVkIGJ5IGRlZmF1bHQgd2hlbiBhbiBBbmd1bGFySlMgYXBwbGljYXRpb24gaXMgc3RhcnRlZC4gVGhlIG1vZHVsZSBpdHNlbGZcblx0ICogY29udGFpbnMgdGhlIGVzc2VudGlhbCBjb21wb25lbnRzIGZvciBhbiBBbmd1bGFySlMgYXBwbGljYXRpb24gdG8gZnVuY3Rpb24uIFRoZSB0YWJsZSBiZWxvd1xuXHQgKiBsaXN0cyBhIGhpZ2ggbGV2ZWwgYnJlYWtkb3duIG9mIGVhY2ggb2YgdGhlIHNlcnZpY2VzL2ZhY3RvcmllcywgZmlsdGVycywgZGlyZWN0aXZlcyBhbmQgdGVzdGluZ1xuXHQgKiBjb21wb25lbnRzIGF2YWlsYWJsZSB3aXRoaW4gdGhpcyBjb3JlIG1vZHVsZS5cblx0ICpcblx0ICogPGRpdiBkb2MtbW9kdWxlLWNvbXBvbmVudHM9XCJuZ1wiPjwvZGl2PlxuXHQgKi9cblx0XG5cdHZhciBSRUdFWF9TVFJJTkdfUkVHRVhQID0gL15cXC8oLispXFwvKFthLXpdKikkLztcblx0XG5cdC8vIFRoZSBuYW1lIG9mIGEgZm9ybSBjb250cm9sJ3MgVmFsaWRpdHlTdGF0ZSBwcm9wZXJ0eS5cblx0Ly8gVGhpcyBpcyB1c2VkIHNvIHRoYXQgaXQncyBwb3NzaWJsZSBmb3IgaW50ZXJuYWwgdGVzdHMgdG8gY3JlYXRlIG1vY2sgVmFsaWRpdHlTdGF0ZXMuXG5cdHZhciBWQUxJRElUWV9TVEFURV9QUk9QRVJUWSA9ICd2YWxpZGl0eSc7XG5cdFxuXHR2YXIgaGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXHRcblx0dmFyIGxvd2VyY2FzZSA9IGZ1bmN0aW9uKHN0cmluZykge3JldHVybiBpc1N0cmluZyhzdHJpbmcpID8gc3RyaW5nLnRvTG93ZXJDYXNlKCkgOiBzdHJpbmc7fTtcblx0dmFyIHVwcGVyY2FzZSA9IGZ1bmN0aW9uKHN0cmluZykge3JldHVybiBpc1N0cmluZyhzdHJpbmcpID8gc3RyaW5nLnRvVXBwZXJDYXNlKCkgOiBzdHJpbmc7fTtcblx0XG5cdFxuXHR2YXIgbWFudWFsTG93ZXJjYXNlID0gZnVuY3Rpb24ocykge1xuXHQgIC8qIGpzaGludCBiaXR3aXNlOiBmYWxzZSAqL1xuXHQgIHJldHVybiBpc1N0cmluZyhzKVxuXHQgICAgICA/IHMucmVwbGFjZSgvW0EtWl0vZywgZnVuY3Rpb24oY2gpIHtyZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShjaC5jaGFyQ29kZUF0KDApIHwgMzIpO30pXG5cdCAgICAgIDogcztcblx0fTtcblx0dmFyIG1hbnVhbFVwcGVyY2FzZSA9IGZ1bmN0aW9uKHMpIHtcblx0ICAvKiBqc2hpbnQgYml0d2lzZTogZmFsc2UgKi9cblx0ICByZXR1cm4gaXNTdHJpbmcocylcblx0ICAgICAgPyBzLnJlcGxhY2UoL1thLXpdL2csIGZ1bmN0aW9uKGNoKSB7cmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2guY2hhckNvZGVBdCgwKSAmIH4zMik7fSlcblx0ICAgICAgOiBzO1xuXHR9O1xuXHRcblx0XG5cdC8vIFN0cmluZyN0b0xvd2VyQ2FzZSBhbmQgU3RyaW5nI3RvVXBwZXJDYXNlIGRvbid0IHByb2R1Y2UgY29ycmVjdCByZXN1bHRzIGluIGJyb3dzZXJzIHdpdGggVHVya2lzaFxuXHQvLyBsb2NhbGUsIGZvciB0aGlzIHJlYXNvbiB3ZSBuZWVkIHRvIGRldGVjdCB0aGlzIGNhc2UgYW5kIHJlZGVmaW5lIGxvd2VyY2FzZS91cHBlcmNhc2UgbWV0aG9kc1xuXHQvLyB3aXRoIGNvcnJlY3QgYnV0IHNsb3dlciBhbHRlcm5hdGl2ZXMuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL2lzc3Vlcy8xMTM4N1xuXHRpZiAoJ2knICE9PSAnSScudG9Mb3dlckNhc2UoKSkge1xuXHQgIGxvd2VyY2FzZSA9IG1hbnVhbExvd2VyY2FzZTtcblx0ICB1cHBlcmNhc2UgPSBtYW51YWxVcHBlcmNhc2U7XG5cdH1cblx0XG5cdFxuXHR2YXJcblx0ICAgIG1zaWUsICAgICAgICAgICAgIC8vIGhvbGRzIG1ham9yIHZlcnNpb24gbnVtYmVyIGZvciBJRSwgb3IgTmFOIGlmIFVBIGlzIG5vdCBJRS5cblx0ICAgIGpxTGl0ZSwgICAgICAgICAgIC8vIGRlbGF5IGJpbmRpbmcgc2luY2UgalF1ZXJ5IGNvdWxkIGJlIGxvYWRlZCBhZnRlciB1cy5cblx0ICAgIGpRdWVyeSwgICAgICAgICAgIC8vIGRlbGF5IGJpbmRpbmdcblx0ICAgIHNsaWNlICAgICAgICAgICAgID0gW10uc2xpY2UsXG5cdCAgICBzcGxpY2UgICAgICAgICAgICA9IFtdLnNwbGljZSxcblx0ICAgIHB1c2ggICAgICAgICAgICAgID0gW10ucHVzaCxcblx0ICAgIHRvU3RyaW5nICAgICAgICAgID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxcblx0ICAgIGdldFByb3RvdHlwZU9mICAgID0gT2JqZWN0LmdldFByb3RvdHlwZU9mLFxuXHQgICAgbmdNaW5FcnIgICAgICAgICAgPSBtaW5FcnIoJ25nJyksXG5cdFxuXHQgICAgLyoqIEBuYW1lIGFuZ3VsYXIgKi9cblx0ICAgIGFuZ3VsYXIgICAgICAgICAgID0gd2luZG93LmFuZ3VsYXIgfHwgKHdpbmRvdy5hbmd1bGFyID0ge30pLFxuXHQgICAgYW5ndWxhck1vZHVsZSxcblx0ICAgIHVpZCAgICAgICAgICAgICAgID0gMDtcblx0XG5cdC8qKlxuXHQgKiBkb2N1bWVudE1vZGUgaXMgYW4gSUUtb25seSBwcm9wZXJ0eVxuXHQgKiBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvaWUvY2MxOTY5ODgodj12cy44NSkuYXNweFxuXHQgKi9cblx0bXNpZSA9IGRvY3VtZW50LmRvY3VtZW50TW9kZTtcblx0XG5cdFxuXHQvKipcblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIHsqfSBvYmpcblx0ICogQHJldHVybiB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIGlmIGBvYmpgIGlzIGFuIGFycmF5IG9yIGFycmF5LWxpa2Ugb2JqZWN0IChOb2RlTGlzdCwgQXJndW1lbnRzLFxuXHQgKiAgICAgICAgICAgICAgICAgICBTdHJpbmcgLi4uKVxuXHQgKi9cblx0ZnVuY3Rpb24gaXNBcnJheUxpa2Uob2JqKSB7XG5cdFxuXHQgIC8vIGBudWxsYCwgYHVuZGVmaW5lZGAgYW5kIGB3aW5kb3dgIGFyZSBub3QgYXJyYXktbGlrZVxuXHQgIGlmIChvYmogPT0gbnVsbCB8fCBpc1dpbmRvdyhvYmopKSByZXR1cm4gZmFsc2U7XG5cdFxuXHQgIC8vIGFycmF5cywgc3RyaW5ncyBhbmQgalF1ZXJ5L2pxTGl0ZSBvYmplY3RzIGFyZSBhcnJheSBsaWtlXG5cdCAgLy8gKiBqcUxpdGUgaXMgZWl0aGVyIHRoZSBqUXVlcnkgb3IganFMaXRlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uXG5cdCAgLy8gKiB3ZSBoYXZlIHRvIGNoZWNrIHRoZSBleGlzdGVuY2Ugb2YganFMaXRlIGZpcnN0IGFzIHRoaXMgbWV0aG9kIGlzIGNhbGxlZFxuXHQgIC8vICAgdmlhIHRoZSBmb3JFYWNoIG1ldGhvZCB3aGVuIGNvbnN0cnVjdGluZyB0aGUganFMaXRlIG9iamVjdCBpbiB0aGUgZmlyc3QgcGxhY2Vcblx0ICBpZiAoaXNBcnJheShvYmopIHx8IGlzU3RyaW5nKG9iaikgfHwgKGpxTGl0ZSAmJiBvYmogaW5zdGFuY2VvZiBqcUxpdGUpKSByZXR1cm4gdHJ1ZTtcblx0XG5cdCAgLy8gU3VwcG9ydDogaU9TIDguMiAobm90IHJlcHJvZHVjaWJsZSBpbiBzaW11bGF0b3IpXG5cdCAgLy8gXCJsZW5ndGhcIiBpbiBvYmogdXNlZCB0byBwcmV2ZW50IEpJVCBlcnJvciAoZ2gtMTE1MDgpXG5cdCAgdmFyIGxlbmd0aCA9IFwibGVuZ3RoXCIgaW4gT2JqZWN0KG9iaikgJiYgb2JqLmxlbmd0aDtcblx0XG5cdCAgLy8gTm9kZUxpc3Qgb2JqZWN0cyAod2l0aCBgaXRlbWAgbWV0aG9kKSBhbmRcblx0ICAvLyBvdGhlciBvYmplY3RzIHdpdGggc3VpdGFibGUgbGVuZ3RoIGNoYXJhY3RlcmlzdGljcyBhcmUgYXJyYXktbGlrZVxuXHQgIHJldHVybiBpc051bWJlcihsZW5ndGgpICYmXG5cdCAgICAobGVuZ3RoID49IDAgJiYgKChsZW5ndGggLSAxKSBpbiBvYmogfHwgb2JqIGluc3RhbmNlb2YgQXJyYXkpIHx8IHR5cGVvZiBvYmouaXRlbSA9PSAnZnVuY3Rpb24nKTtcblx0XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZnVuY3Rpb25cblx0ICogQG5hbWUgYW5ndWxhci5mb3JFYWNoXG5cdCAqIEBtb2R1bGUgbmdcblx0ICogQGtpbmQgZnVuY3Rpb25cblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEludm9rZXMgdGhlIGBpdGVyYXRvcmAgZnVuY3Rpb24gb25jZSBmb3IgZWFjaCBpdGVtIGluIGBvYmpgIGNvbGxlY3Rpb24sIHdoaWNoIGNhbiBiZSBlaXRoZXIgYW5cblx0ICogb2JqZWN0IG9yIGFuIGFycmF5LiBUaGUgYGl0ZXJhdG9yYCBmdW5jdGlvbiBpcyBpbnZva2VkIHdpdGggYGl0ZXJhdG9yKHZhbHVlLCBrZXksIG9iailgLCB3aGVyZSBgdmFsdWVgXG5cdCAqIGlzIHRoZSB2YWx1ZSBvZiBhbiBvYmplY3QgcHJvcGVydHkgb3IgYW4gYXJyYXkgZWxlbWVudCwgYGtleWAgaXMgdGhlIG9iamVjdCBwcm9wZXJ0eSBrZXkgb3Jcblx0ICogYXJyYXkgZWxlbWVudCBpbmRleCBhbmQgb2JqIGlzIHRoZSBgb2JqYCBpdHNlbGYuIFNwZWNpZnlpbmcgYSBgY29udGV4dGAgZm9yIHRoZSBmdW5jdGlvbiBpcyBvcHRpb25hbC5cblx0ICpcblx0ICogSXQgaXMgd29ydGggbm90aW5nIHRoYXQgYC5mb3JFYWNoYCBkb2VzIG5vdCBpdGVyYXRlIG92ZXIgaW5oZXJpdGVkIHByb3BlcnRpZXMgYmVjYXVzZSBpdCBmaWx0ZXJzXG5cdCAqIHVzaW5nIHRoZSBgaGFzT3duUHJvcGVydHlgIG1ldGhvZC5cblx0ICpcblx0ICogVW5saWtlIEVTMjYyJ3Ncblx0ICogW0FycmF5LnByb3RvdHlwZS5mb3JFYWNoXShodHRwOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuNC40LjE4KSxcblx0ICogUHJvdmlkaW5nICd1bmRlZmluZWQnIG9yICdudWxsJyB2YWx1ZXMgZm9yIGBvYmpgIHdpbGwgbm90IHRocm93IGEgVHlwZUVycm9yLCBidXQgcmF0aGVyIGp1c3Rcblx0ICogcmV0dXJuIHRoZSB2YWx1ZSBwcm92aWRlZC5cblx0ICpcblx0ICAgYGBganNcblx0ICAgICB2YXIgdmFsdWVzID0ge25hbWU6ICdtaXNrbycsIGdlbmRlcjogJ21hbGUnfTtcblx0ICAgICB2YXIgbG9nID0gW107XG5cdCAgICAgYW5ndWxhci5mb3JFYWNoKHZhbHVlcywgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuXHQgICAgICAgdGhpcy5wdXNoKGtleSArICc6ICcgKyB2YWx1ZSk7XG5cdCAgICAgfSwgbG9nKTtcblx0ICAgICBleHBlY3QobG9nKS50b0VxdWFsKFsnbmFtZTogbWlza28nLCAnZ2VuZGVyOiBtYWxlJ10pO1xuXHQgICBgYGBcblx0ICpcblx0ICogQHBhcmFtIHtPYmplY3R8QXJyYXl9IG9iaiBPYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRvciBJdGVyYXRvciBmdW5jdGlvbi5cblx0ICogQHBhcmFtIHtPYmplY3Q9fSBjb250ZXh0IE9iamVjdCB0byBiZWNvbWUgY29udGV4dCAoYHRoaXNgKSBmb3IgdGhlIGl0ZXJhdG9yIGZ1bmN0aW9uLlxuXHQgKiBAcmV0dXJucyB7T2JqZWN0fEFycmF5fSBSZWZlcmVuY2UgdG8gYG9iamAuXG5cdCAqL1xuXHRcblx0ZnVuY3Rpb24gZm9yRWFjaChvYmosIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG5cdCAgdmFyIGtleSwgbGVuZ3RoO1xuXHQgIGlmIChvYmopIHtcblx0ICAgIGlmIChpc0Z1bmN0aW9uKG9iaikpIHtcblx0ICAgICAgZm9yIChrZXkgaW4gb2JqKSB7XG5cdCAgICAgICAgLy8gTmVlZCB0byBjaGVjayBpZiBoYXNPd25Qcm9wZXJ0eSBleGlzdHMsXG5cdCAgICAgICAgLy8gYXMgb24gSUU4IHRoZSByZXN1bHQgb2YgcXVlcnlTZWxlY3RvckFsbCBpcyBhbiBvYmplY3Qgd2l0aG91dCBhIGhhc093blByb3BlcnR5IGZ1bmN0aW9uXG5cdCAgICAgICAgaWYgKGtleSAhPSAncHJvdG90eXBlJyAmJiBrZXkgIT0gJ2xlbmd0aCcgJiYga2V5ICE9ICduYW1lJyAmJiAoIW9iai5oYXNPd25Qcm9wZXJ0eSB8fCBvYmouaGFzT3duUHJvcGVydHkoa2V5KSkpIHtcblx0ICAgICAgICAgIGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgb2JqW2tleV0sIGtleSwgb2JqKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH0gZWxzZSBpZiAoaXNBcnJheShvYmopIHx8IGlzQXJyYXlMaWtlKG9iaikpIHtcblx0ICAgICAgdmFyIGlzUHJpbWl0aXZlID0gdHlwZW9mIG9iaiAhPT0gJ29iamVjdCc7XG5cdCAgICAgIGZvciAoa2V5ID0gMCwgbGVuZ3RoID0gb2JqLmxlbmd0aDsga2V5IDwgbGVuZ3RoOyBrZXkrKykge1xuXHQgICAgICAgIGlmIChpc1ByaW1pdGl2ZSB8fCBrZXkgaW4gb2JqKSB7XG5cdCAgICAgICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtrZXldLCBrZXksIG9iaik7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9IGVsc2UgaWYgKG9iai5mb3JFYWNoICYmIG9iai5mb3JFYWNoICE9PSBmb3JFYWNoKSB7XG5cdCAgICAgICAgb2JqLmZvckVhY2goaXRlcmF0b3IsIGNvbnRleHQsIG9iaik7XG5cdCAgICB9IGVsc2UgaWYgKGlzQmxhbmtPYmplY3Qob2JqKSkge1xuXHQgICAgICAvLyBjcmVhdGVNYXAoKSBmYXN0IHBhdGggLS0tIFNhZmUgdG8gYXZvaWQgaGFzT3duUHJvcGVydHkgY2hlY2sgYmVjYXVzZSBwcm90b3R5cGUgY2hhaW4gaXMgZW1wdHlcblx0ICAgICAgZm9yIChrZXkgaW4gb2JqKSB7XG5cdCAgICAgICAgaXRlcmF0b3IuY2FsbChjb250ZXh0LCBvYmpba2V5XSwga2V5LCBvYmopO1xuXHQgICAgICB9XG5cdCAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmouaGFzT3duUHJvcGVydHkgPT09ICdmdW5jdGlvbicpIHtcblx0ICAgICAgLy8gU2xvdyBwYXRoIGZvciBvYmplY3RzIGluaGVyaXRpbmcgT2JqZWN0LnByb3RvdHlwZSwgaGFzT3duUHJvcGVydHkgY2hlY2sgbmVlZGVkXG5cdCAgICAgIGZvciAoa2V5IGluIG9iaikge1xuXHQgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHQgICAgICAgICAgaXRlcmF0b3IuY2FsbChjb250ZXh0LCBvYmpba2V5XSwga2V5LCBvYmopO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgLy8gU2xvdyBwYXRoIGZvciBvYmplY3RzIHdoaWNoIGRvIG5vdCBoYXZlIGEgbWV0aG9kIGBoYXNPd25Qcm9wZXJ0eWBcblx0ICAgICAgZm9yIChrZXkgaW4gb2JqKSB7XG5cdCAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XG5cdCAgICAgICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtrZXldLCBrZXksIG9iaik7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfVxuXHQgIHJldHVybiBvYmo7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGZvckVhY2hTb3J0ZWQob2JqLCBpdGVyYXRvciwgY29udGV4dCkge1xuXHQgIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqKS5zb3J0KCk7XG5cdCAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtrZXlzW2ldXSwga2V5c1tpXSk7XG5cdCAgfVxuXHQgIHJldHVybiBrZXlzO1xuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIHdoZW4gdXNpbmcgZm9yRWFjaCB0aGUgcGFyYW1zIGFyZSB2YWx1ZSwga2V5LCBidXQgaXQgaXMgb2Z0ZW4gdXNlZnVsIHRvIGhhdmUga2V5LCB2YWx1ZS5cblx0ICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcsICopfSBpdGVyYXRvckZuXG5cdCAqIEByZXR1cm5zIHtmdW5jdGlvbigqLCBzdHJpbmcpfVxuXHQgKi9cblx0ZnVuY3Rpb24gcmV2ZXJzZVBhcmFtcyhpdGVyYXRvckZuKSB7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtpdGVyYXRvckZuKGtleSwgdmFsdWUpO307XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBBIGNvbnNpc3RlbnQgd2F5IG9mIGNyZWF0aW5nIHVuaXF1ZSBJRHMgaW4gYW5ndWxhci5cblx0ICpcblx0ICogVXNpbmcgc2ltcGxlIG51bWJlcnMgYWxsb3dzIHVzIHRvIGdlbmVyYXRlIDI4LjYgbWlsbGlvbiB1bmlxdWUgaWRzIHBlciBzZWNvbmQgZm9yIDEwIHllYXJzIGJlZm9yZVxuXHQgKiB3ZSBoaXQgbnVtYmVyIHByZWNpc2lvbiBpc3N1ZXMgaW4gSmF2YVNjcmlwdC5cblx0ICpcblx0ICogTWF0aC5wb3coMiw1MykgLyA2MCAvIDYwIC8gMjQgLyAzNjUgLyAxMCA9IDI4LjZNXG5cdCAqXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9IGFuIHVuaXF1ZSBhbHBoYS1udW1lcmljIHN0cmluZ1xuXHQgKi9cblx0ZnVuY3Rpb24gbmV4dFVpZCgpIHtcblx0ICByZXR1cm4gKyt1aWQ7XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogU2V0IG9yIGNsZWFyIHRoZSBoYXNoa2V5IGZvciBhbiBvYmplY3QuXG5cdCAqIEBwYXJhbSBvYmogb2JqZWN0XG5cdCAqIEBwYXJhbSBoIHRoZSBoYXNoa2V5ICghdHJ1dGh5IHRvIGRlbGV0ZSB0aGUgaGFzaGtleSlcblx0ICovXG5cdGZ1bmN0aW9uIHNldEhhc2hLZXkob2JqLCBoKSB7XG5cdCAgaWYgKGgpIHtcblx0ICAgIG9iai4kJGhhc2hLZXkgPSBoO1xuXHQgIH0gZWxzZSB7XG5cdCAgICBkZWxldGUgb2JqLiQkaGFzaEtleTtcblx0ICB9XG5cdH1cblx0XG5cdFxuXHRmdW5jdGlvbiBiYXNlRXh0ZW5kKGRzdCwgb2JqcywgZGVlcCkge1xuXHQgIHZhciBoID0gZHN0LiQkaGFzaEtleTtcblx0XG5cdCAgZm9yICh2YXIgaSA9IDAsIGlpID0gb2Jqcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG5cdCAgICB2YXIgb2JqID0gb2Jqc1tpXTtcblx0ICAgIGlmICghaXNPYmplY3Qob2JqKSAmJiAhaXNGdW5jdGlvbihvYmopKSBjb250aW51ZTtcblx0ICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqKTtcblx0ICAgIGZvciAodmFyIGogPSAwLCBqaiA9IGtleXMubGVuZ3RoOyBqIDwgamo7IGorKykge1xuXHQgICAgICB2YXIga2V5ID0ga2V5c1tqXTtcblx0ICAgICAgdmFyIHNyYyA9IG9ialtrZXldO1xuXHRcblx0ICAgICAgaWYgKGRlZXAgJiYgaXNPYmplY3Qoc3JjKSkge1xuXHQgICAgICAgIGlmIChpc0RhdGUoc3JjKSkge1xuXHQgICAgICAgICAgZHN0W2tleV0gPSBuZXcgRGF0ZShzcmMudmFsdWVPZigpKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKGlzUmVnRXhwKHNyYykpIHtcblx0ICAgICAgICAgIGRzdFtrZXldID0gbmV3IFJlZ0V4cChzcmMpO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoc3JjLm5vZGVOYW1lKSB7XG5cdCAgICAgICAgICBkc3Rba2V5XSA9IHNyYy5jbG9uZU5vZGUodHJ1ZSk7XG5cdCAgICAgICAgfSBlbHNlIGlmIChpc0VsZW1lbnQoc3JjKSkge1xuXHQgICAgICAgICAgZHN0W2tleV0gPSBzcmMuY2xvbmUoKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgaWYgKCFpc09iamVjdChkc3Rba2V5XSkpIGRzdFtrZXldID0gaXNBcnJheShzcmMpID8gW10gOiB7fTtcblx0ICAgICAgICAgIGJhc2VFeHRlbmQoZHN0W2tleV0sIFtzcmNdLCB0cnVlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgZHN0W2tleV0gPSBzcmM7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIHNldEhhc2hLZXkoZHN0LCBoKTtcblx0ICByZXR1cm4gZHN0O1xuXHR9XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGZ1bmN0aW9uXG5cdCAqIEBuYW1lIGFuZ3VsYXIuZXh0ZW5kXG5cdCAqIEBtb2R1bGUgbmdcblx0ICogQGtpbmQgZnVuY3Rpb25cblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEV4dGVuZHMgdGhlIGRlc3RpbmF0aW9uIG9iamVjdCBgZHN0YCBieSBjb3B5aW5nIG93biBlbnVtZXJhYmxlIHByb3BlcnRpZXMgZnJvbSB0aGUgYHNyY2Agb2JqZWN0KHMpXG5cdCAqIHRvIGBkc3RgLiBZb3UgY2FuIHNwZWNpZnkgbXVsdGlwbGUgYHNyY2Agb2JqZWN0cy4gSWYgeW91IHdhbnQgdG8gcHJlc2VydmUgb3JpZ2luYWwgb2JqZWN0cywgeW91IGNhbiBkbyBzb1xuXHQgKiBieSBwYXNzaW5nIGFuIGVtcHR5IG9iamVjdCBhcyB0aGUgdGFyZ2V0OiBgdmFyIG9iamVjdCA9IGFuZ3VsYXIuZXh0ZW5kKHt9LCBvYmplY3QxLCBvYmplY3QyKWAuXG5cdCAqXG5cdCAqICoqTm90ZToqKiBLZWVwIGluIG1pbmQgdGhhdCBgYW5ndWxhci5leHRlbmRgIGRvZXMgbm90IHN1cHBvcnQgcmVjdXJzaXZlIG1lcmdlIChkZWVwIGNvcHkpLiBVc2Vcblx0ICoge0BsaW5rIGFuZ3VsYXIubWVyZ2V9IGZvciB0aGlzLlxuXHQgKlxuXHQgKiBAcGFyYW0ge09iamVjdH0gZHN0IERlc3RpbmF0aW9uIG9iamVjdC5cblx0ICogQHBhcmFtIHsuLi5PYmplY3R9IHNyYyBTb3VyY2Ugb2JqZWN0KHMpLlxuXHQgKiBAcmV0dXJucyB7T2JqZWN0fSBSZWZlcmVuY2UgdG8gYGRzdGAuXG5cdCAqL1xuXHRmdW5jdGlvbiBleHRlbmQoZHN0KSB7XG5cdCAgcmV0dXJuIGJhc2VFeHRlbmQoZHN0LCBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSksIGZhbHNlKTtcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQqIEBuZ2RvYyBmdW5jdGlvblxuXHQqIEBuYW1lIGFuZ3VsYXIubWVyZ2Vcblx0KiBAbW9kdWxlIG5nXG5cdCogQGtpbmQgZnVuY3Rpb25cblx0KlxuXHQqIEBkZXNjcmlwdGlvblxuXHQqIERlZXBseSBleHRlbmRzIHRoZSBkZXN0aW5hdGlvbiBvYmplY3QgYGRzdGAgYnkgY29weWluZyBvd24gZW51bWVyYWJsZSBwcm9wZXJ0aWVzIGZyb20gdGhlIGBzcmNgIG9iamVjdChzKVxuXHQqIHRvIGBkc3RgLiBZb3UgY2FuIHNwZWNpZnkgbXVsdGlwbGUgYHNyY2Agb2JqZWN0cy4gSWYgeW91IHdhbnQgdG8gcHJlc2VydmUgb3JpZ2luYWwgb2JqZWN0cywgeW91IGNhbiBkbyBzb1xuXHQqIGJ5IHBhc3NpbmcgYW4gZW1wdHkgb2JqZWN0IGFzIHRoZSB0YXJnZXQ6IGB2YXIgb2JqZWN0ID0gYW5ndWxhci5tZXJnZSh7fSwgb2JqZWN0MSwgb2JqZWN0MilgLlxuXHQqXG5cdCogVW5saWtlIHtAbGluayBhbmd1bGFyLmV4dGVuZCBleHRlbmQoKX0sIGBtZXJnZSgpYCByZWN1cnNpdmVseSBkZXNjZW5kcyBpbnRvIG9iamVjdCBwcm9wZXJ0aWVzIG9mIHNvdXJjZVxuXHQqIG9iamVjdHMsIHBlcmZvcm1pbmcgYSBkZWVwIGNvcHkuXG5cdCpcblx0KiBAcGFyYW0ge09iamVjdH0gZHN0IERlc3RpbmF0aW9uIG9iamVjdC5cblx0KiBAcGFyYW0gey4uLk9iamVjdH0gc3JjIFNvdXJjZSBvYmplY3QocykuXG5cdCogQHJldHVybnMge09iamVjdH0gUmVmZXJlbmNlIHRvIGBkc3RgLlxuXHQqL1xuXHRmdW5jdGlvbiBtZXJnZShkc3QpIHtcblx0ICByZXR1cm4gYmFzZUV4dGVuZChkc3QsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSwgdHJ1ZSk7XG5cdH1cblx0XG5cdFxuXHRcblx0ZnVuY3Rpb24gdG9JbnQoc3RyKSB7XG5cdCAgcmV0dXJuIHBhcnNlSW50KHN0ciwgMTApO1xuXHR9XG5cdFxuXHRcblx0ZnVuY3Rpb24gaW5oZXJpdChwYXJlbnQsIGV4dHJhKSB7XG5cdCAgcmV0dXJuIGV4dGVuZChPYmplY3QuY3JlYXRlKHBhcmVudCksIGV4dHJhKTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBmdW5jdGlvblxuXHQgKiBAbmFtZSBhbmd1bGFyLm5vb3Bcblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogQSBmdW5jdGlvbiB0aGF0IHBlcmZvcm1zIG5vIG9wZXJhdGlvbnMuIFRoaXMgZnVuY3Rpb24gY2FuIGJlIHVzZWZ1bCB3aGVuIHdyaXRpbmcgY29kZSBpbiB0aGVcblx0ICogZnVuY3Rpb25hbCBzdHlsZS5cblx0ICAgYGBganNcblx0ICAgICBmdW5jdGlvbiBmb28oY2FsbGJhY2spIHtcblx0ICAgICAgIHZhciByZXN1bHQgPSBjYWxjdWxhdGVSZXN1bHQoKTtcblx0ICAgICAgIChjYWxsYmFjayB8fCBhbmd1bGFyLm5vb3ApKHJlc3VsdCk7XG5cdCAgICAgfVxuXHQgICBgYGBcblx0ICovXG5cdGZ1bmN0aW9uIG5vb3AoKSB7fVxuXHRub29wLiRpbmplY3QgPSBbXTtcblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGZ1bmN0aW9uXG5cdCAqIEBuYW1lIGFuZ3VsYXIuaWRlbnRpdHlcblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgaXRzIGZpcnN0IGFyZ3VtZW50LiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWZ1bCB3aGVuIHdyaXRpbmcgY29kZSBpbiB0aGVcblx0ICogZnVuY3Rpb25hbCBzdHlsZS5cblx0ICpcblx0ICAgYGBganNcblx0ICAgICBmdW5jdGlvbiB0cmFuc2Zvcm1lcih0cmFuc2Zvcm1hdGlvbkZuLCB2YWx1ZSkge1xuXHQgICAgICAgcmV0dXJuICh0cmFuc2Zvcm1hdGlvbkZuIHx8IGFuZ3VsYXIuaWRlbnRpdHkpKHZhbHVlKTtcblx0ICAgICB9O1xuXHQgICBgYGBcblx0ICAqIEBwYXJhbSB7Kn0gdmFsdWUgdG8gYmUgcmV0dXJuZWQuXG5cdCAgKiBAcmV0dXJucyB7Kn0gdGhlIHZhbHVlIHBhc3NlZCBpbi5cblx0ICovXG5cdGZ1bmN0aW9uIGlkZW50aXR5KCQpIHtyZXR1cm4gJDt9XG5cdGlkZW50aXR5LiRpbmplY3QgPSBbXTtcblx0XG5cdFxuXHRmdW5jdGlvbiB2YWx1ZUZuKHZhbHVlKSB7cmV0dXJuIGZ1bmN0aW9uKCkge3JldHVybiB2YWx1ZTt9O31cblx0XG5cdGZ1bmN0aW9uIGhhc0N1c3RvbVRvU3RyaW5nKG9iaikge1xuXHQgIHJldHVybiBpc0Z1bmN0aW9uKG9iai50b1N0cmluZykgJiYgb2JqLnRvU3RyaW5nICE9PSB0b1N0cmluZztcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZnVuY3Rpb25cblx0ICogQG5hbWUgYW5ndWxhci5pc1VuZGVmaW5lZFxuXHQgKiBAbW9kdWxlIG5nXG5cdCAqIEBraW5kIGZ1bmN0aW9uXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBEZXRlcm1pbmVzIGlmIGEgcmVmZXJlbmNlIGlzIHVuZGVmaW5lZC5cblx0ICpcblx0ICogQHBhcmFtIHsqfSB2YWx1ZSBSZWZlcmVuY2UgdG8gY2hlY2suXG5cdCAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGB2YWx1ZWAgaXMgdW5kZWZpbmVkLlxuXHQgKi9cblx0ZnVuY3Rpb24gaXNVbmRlZmluZWQodmFsdWUpIHtyZXR1cm4gdHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJzt9XG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBmdW5jdGlvblxuXHQgKiBAbmFtZSBhbmd1bGFyLmlzRGVmaW5lZFxuXHQgKiBAbW9kdWxlIG5nXG5cdCAqIEBraW5kIGZ1bmN0aW9uXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBEZXRlcm1pbmVzIGlmIGEgcmVmZXJlbmNlIGlzIGRlZmluZWQuXG5cdCAqXG5cdCAqIEBwYXJhbSB7Kn0gdmFsdWUgUmVmZXJlbmNlIHRvIGNoZWNrLlxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGlzIGRlZmluZWQuXG5cdCAqL1xuXHRmdW5jdGlvbiBpc0RlZmluZWQodmFsdWUpIHtyZXR1cm4gdHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJzt9XG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBmdW5jdGlvblxuXHQgKiBAbmFtZSBhbmd1bGFyLmlzT2JqZWN0XG5cdCAqIEBtb2R1bGUgbmdcblx0ICogQGtpbmQgZnVuY3Rpb25cblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIERldGVybWluZXMgaWYgYSByZWZlcmVuY2UgaXMgYW4gYE9iamVjdGAuIFVubGlrZSBgdHlwZW9mYCBpbiBKYXZhU2NyaXB0LCBgbnVsbGBzIGFyZSBub3Rcblx0ICogY29uc2lkZXJlZCB0byBiZSBvYmplY3RzLiBOb3RlIHRoYXQgSmF2YVNjcmlwdCBhcnJheXMgYXJlIG9iamVjdHMuXG5cdCAqXG5cdCAqIEBwYXJhbSB7Kn0gdmFsdWUgUmVmZXJlbmNlIHRvIGNoZWNrLlxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGlzIGFuIGBPYmplY3RgIGJ1dCBub3QgYG51bGxgLlxuXHQgKi9cblx0ZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcblx0ICAvLyBodHRwOi8vanNwZXJmLmNvbS9pc29iamVjdDRcblx0ICByZXR1cm4gdmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jztcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhbiBvYmplY3Qgd2l0aCBhIG51bGwgcHJvdG90eXBlXG5cdCAqXG5cdCAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGB2YWx1ZWAgaXMgYW4gYE9iamVjdGAgd2l0aCBhIG51bGwgcHJvdG90eXBlXG5cdCAqL1xuXHRmdW5jdGlvbiBpc0JsYW5rT2JqZWN0KHZhbHVlKSB7XG5cdCAgcmV0dXJuIHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgIWdldFByb3RvdHlwZU9mKHZhbHVlKTtcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZnVuY3Rpb25cblx0ICogQG5hbWUgYW5ndWxhci5pc1N0cmluZ1xuXHQgKiBAbW9kdWxlIG5nXG5cdCAqIEBraW5kIGZ1bmN0aW9uXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBEZXRlcm1pbmVzIGlmIGEgcmVmZXJlbmNlIGlzIGEgYFN0cmluZ2AuXG5cdCAqXG5cdCAqIEBwYXJhbSB7Kn0gdmFsdWUgUmVmZXJlbmNlIHRvIGNoZWNrLlxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGlzIGEgYFN0cmluZ2AuXG5cdCAqL1xuXHRmdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSkge3JldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnO31cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGZ1bmN0aW9uXG5cdCAqIEBuYW1lIGFuZ3VsYXIuaXNOdW1iZXJcblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogRGV0ZXJtaW5lcyBpZiBhIHJlZmVyZW5jZSBpcyBhIGBOdW1iZXJgLlxuXHQgKlxuXHQgKiBUaGlzIGluY2x1ZGVzIHRoZSBcInNwZWNpYWxcIiBudW1iZXJzIGBOYU5gLCBgK0luZmluaXR5YCBhbmQgYC1JbmZpbml0eWAuXG5cdCAqXG5cdCAqIElmIHlvdSB3aXNoIHRvIGV4Y2x1ZGUgdGhlc2UgdGhlbiB5b3UgY2FuIHVzZSB0aGUgbmF0aXZlXG5cdCAqIFtgaXNGaW5pdGUnXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9pc0Zpbml0ZSlcblx0ICogbWV0aG9kLlxuXHQgKlxuXHQgKiBAcGFyYW0geyp9IHZhbHVlIFJlZmVyZW5jZSB0byBjaGVjay5cblx0ICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgYHZhbHVlYCBpcyBhIGBOdW1iZXJgLlxuXHQgKi9cblx0ZnVuY3Rpb24gaXNOdW1iZXIodmFsdWUpIHtyZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJzt9XG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBmdW5jdGlvblxuXHQgKiBAbmFtZSBhbmd1bGFyLmlzRGF0ZVxuXHQgKiBAbW9kdWxlIG5nXG5cdCAqIEBraW5kIGZ1bmN0aW9uXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBEZXRlcm1pbmVzIGlmIGEgdmFsdWUgaXMgYSBkYXRlLlxuXHQgKlxuXHQgKiBAcGFyYW0geyp9IHZhbHVlIFJlZmVyZW5jZSB0byBjaGVjay5cblx0ICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgYHZhbHVlYCBpcyBhIGBEYXRlYC5cblx0ICovXG5cdGZ1bmN0aW9uIGlzRGF0ZSh2YWx1ZSkge1xuXHQgIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gJ1tvYmplY3QgRGF0ZV0nO1xuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBmdW5jdGlvblxuXHQgKiBAbmFtZSBhbmd1bGFyLmlzQXJyYXlcblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogRGV0ZXJtaW5lcyBpZiBhIHJlZmVyZW5jZSBpcyBhbiBgQXJyYXlgLlxuXHQgKlxuXHQgKiBAcGFyYW0geyp9IHZhbHVlIFJlZmVyZW5jZSB0byBjaGVjay5cblx0ICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgYHZhbHVlYCBpcyBhbiBgQXJyYXlgLlxuXHQgKi9cblx0dmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5O1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBmdW5jdGlvblxuXHQgKiBAbmFtZSBhbmd1bGFyLmlzRnVuY3Rpb25cblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogRGV0ZXJtaW5lcyBpZiBhIHJlZmVyZW5jZSBpcyBhIGBGdW5jdGlvbmAuXG5cdCAqXG5cdCAqIEBwYXJhbSB7Kn0gdmFsdWUgUmVmZXJlbmNlIHRvIGNoZWNrLlxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGlzIGEgYEZ1bmN0aW9uYC5cblx0ICovXG5cdGZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsdWUpIHtyZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nO31cblx0XG5cdFxuXHQvKipcblx0ICogRGV0ZXJtaW5lcyBpZiBhIHZhbHVlIGlzIGEgcmVndWxhciBleHByZXNzaW9uIG9iamVjdC5cblx0ICpcblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIHsqfSB2YWx1ZSBSZWZlcmVuY2UgdG8gY2hlY2suXG5cdCAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGB2YWx1ZWAgaXMgYSBgUmVnRXhwYC5cblx0ICovXG5cdGZ1bmN0aW9uIGlzUmVnRXhwKHZhbHVlKSB7XG5cdCAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsdWUpID09PSAnW29iamVjdCBSZWdFeHBdJztcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBDaGVja3MgaWYgYG9iamAgaXMgYSB3aW5kb3cgb2JqZWN0LlxuXHQgKlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0geyp9IG9iaiBPYmplY3QgdG8gY2hlY2tcblx0ICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgYG9iamAgaXMgYSB3aW5kb3cgb2JqLlxuXHQgKi9cblx0ZnVuY3Rpb24gaXNXaW5kb3cob2JqKSB7XG5cdCAgcmV0dXJuIG9iaiAmJiBvYmoud2luZG93ID09PSBvYmo7XG5cdH1cblx0XG5cdFxuXHRmdW5jdGlvbiBpc1Njb3BlKG9iaikge1xuXHQgIHJldHVybiBvYmogJiYgb2JqLiRldmFsQXN5bmMgJiYgb2JqLiR3YXRjaDtcblx0fVxuXHRcblx0XG5cdGZ1bmN0aW9uIGlzRmlsZShvYmopIHtcblx0ICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09PSAnW29iamVjdCBGaWxlXSc7XG5cdH1cblx0XG5cdFxuXHRmdW5jdGlvbiBpc0Zvcm1EYXRhKG9iaikge1xuXHQgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEZvcm1EYXRhXSc7XG5cdH1cblx0XG5cdFxuXHRmdW5jdGlvbiBpc0Jsb2Iob2JqKSB7XG5cdCAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgQmxvYl0nO1xuXHR9XG5cdFxuXHRcblx0ZnVuY3Rpb24gaXNCb29sZWFuKHZhbHVlKSB7XG5cdCAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nO1xuXHR9XG5cdFxuXHRcblx0ZnVuY3Rpb24gaXNQcm9taXNlTGlrZShvYmopIHtcblx0ICByZXR1cm4gb2JqICYmIGlzRnVuY3Rpb24ob2JqLnRoZW4pO1xuXHR9XG5cdFxuXHRcblx0dmFyIFRZUEVEX0FSUkFZX1JFR0VYUCA9IC9eXFxbb2JqZWN0ICg/OlVpbnQ4fFVpbnQ4Q2xhbXBlZHxVaW50MTZ8VWludDMyfEludDh8SW50MTZ8SW50MzJ8RmxvYXQzMnxGbG9hdDY0KUFycmF5XFxdJC87XG5cdGZ1bmN0aW9uIGlzVHlwZWRBcnJheSh2YWx1ZSkge1xuXHQgIHJldHVybiB2YWx1ZSAmJiBpc051bWJlcih2YWx1ZS5sZW5ndGgpICYmIFRZUEVEX0FSUkFZX1JFR0VYUC50ZXN0KHRvU3RyaW5nLmNhbGwodmFsdWUpKTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gaXNBcnJheUJ1ZmZlcihvYmopIHtcblx0ICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09PSAnW29iamVjdCBBcnJheUJ1ZmZlcl0nO1xuXHR9XG5cdFxuXHRcblx0dmFyIHRyaW0gPSBmdW5jdGlvbih2YWx1ZSkge1xuXHQgIHJldHVybiBpc1N0cmluZyh2YWx1ZSkgPyB2YWx1ZS50cmltKCkgOiB2YWx1ZTtcblx0fTtcblx0XG5cdC8vIENvcGllZCBmcm9tOlxuXHQvLyBodHRwOi8vZG9jcy5jbG9zdXJlLWxpYnJhcnkuZ29vZ2xlY29kZS5jb20vZ2l0L2xvY2FsX2Nsb3N1cmVfZ29vZ19zdHJpbmdfc3RyaW5nLmpzLnNvdXJjZS5odG1sI2xpbmUxMDIxXG5cdC8vIFByZXJlcTogcyBpcyBhIHN0cmluZy5cblx0dmFyIGVzY2FwZUZvclJlZ2V4cCA9IGZ1bmN0aW9uKHMpIHtcblx0ICByZXR1cm4gcy5yZXBsYWNlKC8oWy0oKVxcW1xcXXt9Kz8qLiRcXF58LDojPCFcXFxcXSkvZywgJ1xcXFwkMScpLlxuXHQgICAgICAgICAgIHJlcGxhY2UoL1xceDA4L2csICdcXFxceDA4Jyk7XG5cdH07XG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBmdW5jdGlvblxuXHQgKiBAbmFtZSBhbmd1bGFyLmlzRWxlbWVudFxuXHQgKiBAbW9kdWxlIG5nXG5cdCAqIEBraW5kIGZ1bmN0aW9uXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBEZXRlcm1pbmVzIGlmIGEgcmVmZXJlbmNlIGlzIGEgRE9NIGVsZW1lbnQgKG9yIHdyYXBwZWQgalF1ZXJ5IGVsZW1lbnQpLlxuXHQgKlxuXHQgKiBAcGFyYW0geyp9IHZhbHVlIFJlZmVyZW5jZSB0byBjaGVjay5cblx0ICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgYHZhbHVlYCBpcyBhIERPTSBlbGVtZW50IChvciB3cmFwcGVkIGpRdWVyeSBlbGVtZW50KS5cblx0ICovXG5cdGZ1bmN0aW9uIGlzRWxlbWVudChub2RlKSB7XG5cdCAgcmV0dXJuICEhKG5vZGUgJiZcblx0ICAgIChub2RlLm5vZGVOYW1lICAvLyB3ZSBhcmUgYSBkaXJlY3QgZWxlbWVudFxuXHQgICAgfHwgKG5vZGUucHJvcCAmJiBub2RlLmF0dHIgJiYgbm9kZS5maW5kKSkpOyAgLy8gd2UgaGF2ZSBhbiBvbiBhbmQgZmluZCBtZXRob2QgcGFydCBvZiBqUXVlcnkgQVBJXG5cdH1cblx0XG5cdC8qKlxuXHQgKiBAcGFyYW0gc3RyICdrZXkxLGtleTIsLi4uJ1xuXHQgKiBAcmV0dXJucyB7b2JqZWN0fSBpbiB0aGUgZm9ybSBvZiB7a2V5MTp0cnVlLCBrZXkyOnRydWUsIC4uLn1cblx0ICovXG5cdGZ1bmN0aW9uIG1ha2VNYXAoc3RyKSB7XG5cdCAgdmFyIG9iaiA9IHt9LCBpdGVtcyA9IHN0ci5zcGxpdCgnLCcpLCBpO1xuXHQgIGZvciAoaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuXHQgICAgb2JqW2l0ZW1zW2ldXSA9IHRydWU7XG5cdCAgfVxuXHQgIHJldHVybiBvYmo7XG5cdH1cblx0XG5cdFxuXHRmdW5jdGlvbiBub2RlTmFtZV8oZWxlbWVudCkge1xuXHQgIHJldHVybiBsb3dlcmNhc2UoZWxlbWVudC5ub2RlTmFtZSB8fCAoZWxlbWVudFswXSAmJiBlbGVtZW50WzBdLm5vZGVOYW1lKSk7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGluY2x1ZGVzKGFycmF5LCBvYmopIHtcblx0ICByZXR1cm4gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChhcnJheSwgb2JqKSAhPSAtMTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gYXJyYXlSZW1vdmUoYXJyYXksIHZhbHVlKSB7XG5cdCAgdmFyIGluZGV4ID0gYXJyYXkuaW5kZXhPZih2YWx1ZSk7XG5cdCAgaWYgKGluZGV4ID49IDApIHtcblx0ICAgIGFycmF5LnNwbGljZShpbmRleCwgMSk7XG5cdCAgfVxuXHQgIHJldHVybiBpbmRleDtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBmdW5jdGlvblxuXHQgKiBAbmFtZSBhbmd1bGFyLmNvcHlcblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogQ3JlYXRlcyBhIGRlZXAgY29weSBvZiBgc291cmNlYCwgd2hpY2ggc2hvdWxkIGJlIGFuIG9iamVjdCBvciBhbiBhcnJheS5cblx0ICpcblx0ICogKiBJZiBubyBkZXN0aW5hdGlvbiBpcyBzdXBwbGllZCwgYSBjb3B5IG9mIHRoZSBvYmplY3Qgb3IgYXJyYXkgaXMgY3JlYXRlZC5cblx0ICogKiBJZiBhIGRlc3RpbmF0aW9uIGlzIHByb3ZpZGVkLCBhbGwgb2YgaXRzIGVsZW1lbnRzIChmb3IgYXJyYXlzKSBvciBwcm9wZXJ0aWVzIChmb3Igb2JqZWN0cylcblx0ICogICBhcmUgZGVsZXRlZCBhbmQgdGhlbiBhbGwgZWxlbWVudHMvcHJvcGVydGllcyBmcm9tIHRoZSBzb3VyY2UgYXJlIGNvcGllZCB0byBpdC5cblx0ICogKiBJZiBgc291cmNlYCBpcyBub3QgYW4gb2JqZWN0IG9yIGFycmF5IChpbmMuIGBudWxsYCBhbmQgYHVuZGVmaW5lZGApLCBgc291cmNlYCBpcyByZXR1cm5lZC5cblx0ICogKiBJZiBgc291cmNlYCBpcyBpZGVudGljYWwgdG8gJ2Rlc3RpbmF0aW9uJyBhbiBleGNlcHRpb24gd2lsbCBiZSB0aHJvd24uXG5cdCAqXG5cdCAqIEBwYXJhbSB7Kn0gc291cmNlIFRoZSBzb3VyY2UgdGhhdCB3aWxsIGJlIHVzZWQgdG8gbWFrZSBhIGNvcHkuXG5cdCAqICAgICAgICAgICAgICAgICAgIENhbiBiZSBhbnkgdHlwZSwgaW5jbHVkaW5nIHByaW1pdGl2ZXMsIGBudWxsYCwgYW5kIGB1bmRlZmluZWRgLlxuXHQgKiBAcGFyYW0geyhPYmplY3R8QXJyYXkpPX0gZGVzdGluYXRpb24gRGVzdGluYXRpb24gaW50byB3aGljaCB0aGUgc291cmNlIGlzIGNvcGllZC4gSWZcblx0ICogICAgIHByb3ZpZGVkLCBtdXN0IGJlIG9mIHRoZSBzYW1lIHR5cGUgYXMgYHNvdXJjZWAuXG5cdCAqIEByZXR1cm5zIHsqfSBUaGUgY29weSBvciB1cGRhdGVkIGBkZXN0aW5hdGlvbmAsIGlmIGBkZXN0aW5hdGlvbmAgd2FzIHNwZWNpZmllZC5cblx0ICpcblx0ICogQGV4YW1wbGVcblx0IDxleGFtcGxlIG1vZHVsZT1cImNvcHlFeGFtcGxlXCI+XG5cdCA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0IDxmb3JtIG5vdmFsaWRhdGUgY2xhc3M9XCJzaW1wbGUtZm9ybVwiPlxuXHQgTmFtZTogPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJ1c2VyLm5hbWVcIiAvPjxiciAvPlxuXHQgRS1tYWlsOiA8aW5wdXQgdHlwZT1cImVtYWlsXCIgbmctbW9kZWw9XCJ1c2VyLmVtYWlsXCIgLz48YnIgLz5cblx0IEdlbmRlcjogPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5nLW1vZGVsPVwidXNlci5nZW5kZXJcIiB2YWx1ZT1cIm1hbGVcIiAvPm1hbGVcblx0IDxpbnB1dCB0eXBlPVwicmFkaW9cIiBuZy1tb2RlbD1cInVzZXIuZ2VuZGVyXCIgdmFsdWU9XCJmZW1hbGVcIiAvPmZlbWFsZTxiciAvPlxuXHQgPGJ1dHRvbiBuZy1jbGljaz1cInJlc2V0KClcIj5SRVNFVDwvYnV0dG9uPlxuXHQgPGJ1dHRvbiBuZy1jbGljaz1cInVwZGF0ZSh1c2VyKVwiPlNBVkU8L2J1dHRvbj5cblx0IDwvZm9ybT5cblx0IDxwcmU+Zm9ybSA9IHt7dXNlciB8IGpzb259fTwvcHJlPlxuXHQgPHByZT5tYXN0ZXIgPSB7e21hc3RlciB8IGpzb259fTwvcHJlPlxuXHQgPC9kaXY+XG5cdFxuXHQgPHNjcmlwdD5cblx0ICBhbmd1bGFyLm1vZHVsZSgnY29weUV4YW1wbGUnLCBbXSlcblx0ICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAgICAgICRzY29wZS5tYXN0ZXI9IHt9O1xuXHRcblx0ICAgICAgJHNjb3BlLnVwZGF0ZSA9IGZ1bmN0aW9uKHVzZXIpIHtcblx0ICAgICAgICAvLyBFeGFtcGxlIHdpdGggMSBhcmd1bWVudFxuXHQgICAgICAgICRzY29wZS5tYXN0ZXI9IGFuZ3VsYXIuY29weSh1c2VyKTtcblx0ICAgICAgfTtcblx0XG5cdCAgICAgICRzY29wZS5yZXNldCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIC8vIEV4YW1wbGUgd2l0aCAyIGFyZ3VtZW50c1xuXHQgICAgICAgIGFuZ3VsYXIuY29weSgkc2NvcGUubWFzdGVyLCAkc2NvcGUudXNlcik7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICAkc2NvcGUucmVzZXQoKTtcblx0ICAgIH1dKTtcblx0IDwvc2NyaXB0PlxuXHQgPC9maWxlPlxuXHQgPC9leGFtcGxlPlxuXHQgKi9cblx0ZnVuY3Rpb24gY29weShzb3VyY2UsIGRlc3RpbmF0aW9uKSB7XG5cdCAgdmFyIHN0YWNrU291cmNlID0gW107XG5cdCAgdmFyIHN0YWNrRGVzdCA9IFtdO1xuXHRcblx0ICBpZiAoZGVzdGluYXRpb24pIHtcblx0ICAgIGlmIChpc1R5cGVkQXJyYXkoZGVzdGluYXRpb24pIHx8IGlzQXJyYXlCdWZmZXIoZGVzdGluYXRpb24pKSB7XG5cdCAgICAgIHRocm93IG5nTWluRXJyKCdjcHRhJywgXCJDYW4ndCBjb3B5ISBUeXBlZEFycmF5IGRlc3RpbmF0aW9uIGNhbm5vdCBiZSBtdXRhdGVkLlwiKTtcblx0ICAgIH1cblx0ICAgIGlmIChzb3VyY2UgPT09IGRlc3RpbmF0aW9uKSB7XG5cdCAgICAgIHRocm93IG5nTWluRXJyKCdjcGknLCBcIkNhbid0IGNvcHkhIFNvdXJjZSBhbmQgZGVzdGluYXRpb24gYXJlIGlkZW50aWNhbC5cIik7XG5cdCAgICB9XG5cdFxuXHQgICAgLy8gRW1wdHkgdGhlIGRlc3RpbmF0aW9uIG9iamVjdFxuXHQgICAgaWYgKGlzQXJyYXkoZGVzdGluYXRpb24pKSB7XG5cdCAgICAgIGRlc3RpbmF0aW9uLmxlbmd0aCA9IDA7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBmb3JFYWNoKGRlc3RpbmF0aW9uLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG5cdCAgICAgICAgaWYgKGtleSAhPT0gJyQkaGFzaEtleScpIHtcblx0ICAgICAgICAgIGRlbGV0ZSBkZXN0aW5hdGlvbltrZXldO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdFxuXHQgICAgc3RhY2tTb3VyY2UucHVzaChzb3VyY2UpO1xuXHQgICAgc3RhY2tEZXN0LnB1c2goZGVzdGluYXRpb24pO1xuXHQgICAgcmV0dXJuIGNvcHlSZWN1cnNlKHNvdXJjZSwgZGVzdGluYXRpb24pO1xuXHQgIH1cblx0XG5cdCAgcmV0dXJuIGNvcHlFbGVtZW50KHNvdXJjZSk7XG5cdFxuXHQgIGZ1bmN0aW9uIGNvcHlSZWN1cnNlKHNvdXJjZSwgZGVzdGluYXRpb24pIHtcblx0ICAgIHZhciBoID0gZGVzdGluYXRpb24uJCRoYXNoS2V5O1xuXHQgICAgdmFyIHJlc3VsdCwga2V5O1xuXHQgICAgaWYgKGlzQXJyYXkoc291cmNlKSkge1xuXHQgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBzb3VyY2UubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHQgICAgICAgIGRlc3RpbmF0aW9uLnB1c2goY29weUVsZW1lbnQoc291cmNlW2ldKSk7XG5cdCAgICAgIH1cblx0ICAgIH0gZWxzZSBpZiAoaXNCbGFua09iamVjdChzb3VyY2UpKSB7XG5cdCAgICAgIC8vIGNyZWF0ZU1hcCgpIGZhc3QgcGF0aCAtLS0gU2FmZSB0byBhdm9pZCBoYXNPd25Qcm9wZXJ0eSBjaGVjayBiZWNhdXNlIHByb3RvdHlwZSBjaGFpbiBpcyBlbXB0eVxuXHQgICAgICBmb3IgKGtleSBpbiBzb3VyY2UpIHtcblx0ICAgICAgICBkZXN0aW5hdGlvbltrZXldID0gY29weUVsZW1lbnQoc291cmNlW2tleV0pO1xuXHQgICAgICB9XG5cdCAgICB9IGVsc2UgaWYgKHNvdXJjZSAmJiB0eXBlb2Ygc291cmNlLmhhc093blByb3BlcnR5ID09PSAnZnVuY3Rpb24nKSB7XG5cdCAgICAgIC8vIFNsb3cgcGF0aCwgd2hpY2ggbXVzdCByZWx5IG9uIGhhc093blByb3BlcnR5XG5cdCAgICAgIGZvciAoa2V5IGluIHNvdXJjZSkge1xuXHQgICAgICAgIGlmIChzb3VyY2UuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHQgICAgICAgICAgZGVzdGluYXRpb25ba2V5XSA9IGNvcHlFbGVtZW50KHNvdXJjZVtrZXldKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIC8vIFNsb3dlc3QgcGF0aCAtLS0gaGFzT3duUHJvcGVydHkgY2FuJ3QgYmUgY2FsbGVkIGFzIGEgbWV0aG9kXG5cdCAgICAgIGZvciAoa2V5IGluIHNvdXJjZSkge1xuXHQgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuXHQgICAgICAgICAgZGVzdGluYXRpb25ba2V5XSA9IGNvcHlFbGVtZW50KHNvdXJjZVtrZXldKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIHNldEhhc2hLZXkoZGVzdGluYXRpb24sIGgpO1xuXHQgICAgcmV0dXJuIGRlc3RpbmF0aW9uO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gY29weUVsZW1lbnQoc291cmNlKSB7XG5cdCAgICAvLyBTaW1wbGUgdmFsdWVzXG5cdCAgICBpZiAoIWlzT2JqZWN0KHNvdXJjZSkpIHtcblx0ICAgICAgcmV0dXJuIHNvdXJjZTtcblx0ICAgIH1cblx0XG5cdCAgICAvLyBBbHJlYWR5IGNvcGllZCB2YWx1ZXNcblx0ICAgIHZhciBpbmRleCA9IHN0YWNrU291cmNlLmluZGV4T2Yoc291cmNlKTtcblx0ICAgIGlmIChpbmRleCAhPT0gLTEpIHtcblx0ICAgICAgcmV0dXJuIHN0YWNrRGVzdFtpbmRleF07XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKGlzV2luZG93KHNvdXJjZSkgfHwgaXNTY29wZShzb3VyY2UpKSB7XG5cdCAgICAgIHRocm93IG5nTWluRXJyKCdjcHdzJyxcblx0ICAgICAgICBcIkNhbid0IGNvcHkhIE1ha2luZyBjb3BpZXMgb2YgV2luZG93IG9yIFNjb3BlIGluc3RhbmNlcyBpcyBub3Qgc3VwcG9ydGVkLlwiKTtcblx0ICAgIH1cblx0XG5cdCAgICB2YXIgbmVlZHNSZWN1cnNlID0gZmFsc2U7XG5cdCAgICB2YXIgZGVzdGluYXRpb24gPSBjb3B5VHlwZShzb3VyY2UpO1xuXHRcblx0ICAgIGlmIChkZXN0aW5hdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgIGRlc3RpbmF0aW9uID0gaXNBcnJheShzb3VyY2UpID8gW10gOiBPYmplY3QuY3JlYXRlKGdldFByb3RvdHlwZU9mKHNvdXJjZSkpO1xuXHQgICAgICBuZWVkc1JlY3Vyc2UgPSB0cnVlO1xuXHQgICAgfVxuXHRcblx0ICAgIHN0YWNrU291cmNlLnB1c2goc291cmNlKTtcblx0ICAgIHN0YWNrRGVzdC5wdXNoKGRlc3RpbmF0aW9uKTtcblx0XG5cdCAgICByZXR1cm4gbmVlZHNSZWN1cnNlXG5cdCAgICAgID8gY29weVJlY3Vyc2Uoc291cmNlLCBkZXN0aW5hdGlvbilcblx0ICAgICAgOiBkZXN0aW5hdGlvbjtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGNvcHlUeXBlKHNvdXJjZSkge1xuXHQgICAgc3dpdGNoICh0b1N0cmluZy5jYWxsKHNvdXJjZSkpIHtcblx0ICAgICAgY2FzZSAnW29iamVjdCBJbnQ4QXJyYXldJzpcblx0ICAgICAgY2FzZSAnW29iamVjdCBJbnQxNkFycmF5XSc6XG5cdCAgICAgIGNhc2UgJ1tvYmplY3QgSW50MzJBcnJheV0nOlxuXHQgICAgICBjYXNlICdbb2JqZWN0IEZsb2F0MzJBcnJheV0nOlxuXHQgICAgICBjYXNlICdbb2JqZWN0IEZsb2F0NjRBcnJheV0nOlxuXHQgICAgICBjYXNlICdbb2JqZWN0IFVpbnQ4QXJyYXldJzpcblx0ICAgICAgY2FzZSAnW29iamVjdCBVaW50OENsYW1wZWRBcnJheV0nOlxuXHQgICAgICBjYXNlICdbb2JqZWN0IFVpbnQxNkFycmF5XSc6XG5cdCAgICAgIGNhc2UgJ1tvYmplY3QgVWludDMyQXJyYXldJzpcblx0ICAgICAgICByZXR1cm4gbmV3IHNvdXJjZS5jb25zdHJ1Y3Rvcihjb3B5RWxlbWVudChzb3VyY2UuYnVmZmVyKSk7XG5cdFxuXHQgICAgICBjYXNlICdbb2JqZWN0IEFycmF5QnVmZmVyXSc6XG5cdCAgICAgICAgLy9TdXBwb3J0OiBJRTEwXG5cdCAgICAgICAgaWYgKCFzb3VyY2Uuc2xpY2UpIHtcblx0ICAgICAgICAgIHZhciBjb3BpZWQgPSBuZXcgQXJyYXlCdWZmZXIoc291cmNlLmJ5dGVMZW5ndGgpO1xuXHQgICAgICAgICAgbmV3IFVpbnQ4QXJyYXkoY29waWVkKS5zZXQobmV3IFVpbnQ4QXJyYXkoc291cmNlKSk7XG5cdCAgICAgICAgICByZXR1cm4gY29waWVkO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gc291cmNlLnNsaWNlKDApO1xuXHRcblx0ICAgICAgY2FzZSAnW29iamVjdCBCb29sZWFuXSc6XG5cdCAgICAgIGNhc2UgJ1tvYmplY3QgTnVtYmVyXSc6XG5cdCAgICAgIGNhc2UgJ1tvYmplY3QgU3RyaW5nXSc6XG5cdCAgICAgIGNhc2UgJ1tvYmplY3QgRGF0ZV0nOlxuXHQgICAgICAgIHJldHVybiBuZXcgc291cmNlLmNvbnN0cnVjdG9yKHNvdXJjZS52YWx1ZU9mKCkpO1xuXHRcblx0ICAgICAgY2FzZSAnW29iamVjdCBSZWdFeHBdJzpcblx0ICAgICAgICB2YXIgcmUgPSBuZXcgUmVnRXhwKHNvdXJjZS5zb3VyY2UsIHNvdXJjZS50b1N0cmluZygpLm1hdGNoKC9bXlxcL10qJC8pWzBdKTtcblx0ICAgICAgICByZS5sYXN0SW5kZXggPSBzb3VyY2UubGFzdEluZGV4O1xuXHQgICAgICAgIHJldHVybiByZTtcblx0ICAgIH1cblx0XG5cdCAgICBpZiAoaXNGdW5jdGlvbihzb3VyY2UuY2xvbmVOb2RlKSkge1xuXHQgICAgICByZXR1cm4gc291cmNlLmNsb25lTm9kZSh0cnVlKTtcblx0ICAgIH1cblx0ICB9XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgc2hhbGxvdyBjb3B5IG9mIGFuIG9iamVjdCwgYW4gYXJyYXkgb3IgYSBwcmltaXRpdmUuXG5cdCAqXG5cdCAqIEFzc3VtZXMgdGhhdCB0aGVyZSBhcmUgbm8gcHJvdG8gcHJvcGVydGllcyBmb3Igb2JqZWN0cy5cblx0ICovXG5cdGZ1bmN0aW9uIHNoYWxsb3dDb3B5KHNyYywgZHN0KSB7XG5cdCAgaWYgKGlzQXJyYXkoc3JjKSkge1xuXHQgICAgZHN0ID0gZHN0IHx8IFtdO1xuXHRcblx0ICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHNyYy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdCAgICAgIGRzdFtpXSA9IHNyY1tpXTtcblx0ICAgIH1cblx0ICB9IGVsc2UgaWYgKGlzT2JqZWN0KHNyYykpIHtcblx0ICAgIGRzdCA9IGRzdCB8fCB7fTtcblx0XG5cdCAgICBmb3IgKHZhciBrZXkgaW4gc3JjKSB7XG5cdCAgICAgIGlmICghKGtleS5jaGFyQXQoMCkgPT09ICckJyAmJiBrZXkuY2hhckF0KDEpID09PSAnJCcpKSB7XG5cdCAgICAgICAgZHN0W2tleV0gPSBzcmNba2V5XTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgcmV0dXJuIGRzdCB8fCBzcmM7XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGZ1bmN0aW9uXG5cdCAqIEBuYW1lIGFuZ3VsYXIuZXF1YWxzXG5cdCAqIEBtb2R1bGUgbmdcblx0ICogQGtpbmQgZnVuY3Rpb25cblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIERldGVybWluZXMgaWYgdHdvIG9iamVjdHMgb3IgdHdvIHZhbHVlcyBhcmUgZXF1aXZhbGVudC4gU3VwcG9ydHMgdmFsdWUgdHlwZXMsIHJlZ3VsYXJcblx0ICogZXhwcmVzc2lvbnMsIGFycmF5cyBhbmQgb2JqZWN0cy5cblx0ICpcblx0ICogVHdvIG9iamVjdHMgb3IgdmFsdWVzIGFyZSBjb25zaWRlcmVkIGVxdWl2YWxlbnQgaWYgYXQgbGVhc3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcgaXMgdHJ1ZTpcblx0ICpcblx0ICogKiBCb3RoIG9iamVjdHMgb3IgdmFsdWVzIHBhc3MgYD09PWAgY29tcGFyaXNvbi5cblx0ICogKiBCb3RoIG9iamVjdHMgb3IgdmFsdWVzIGFyZSBvZiB0aGUgc2FtZSB0eXBlIGFuZCBhbGwgb2YgdGhlaXIgcHJvcGVydGllcyBhcmUgZXF1YWwgYnlcblx0ICogICBjb21wYXJpbmcgdGhlbSB3aXRoIGBhbmd1bGFyLmVxdWFsc2AuXG5cdCAqICogQm90aCB2YWx1ZXMgYXJlIE5hTi4gKEluIEphdmFTY3JpcHQsIE5hTiA9PSBOYU4gPT4gZmFsc2UuIEJ1dCB3ZSBjb25zaWRlciB0d28gTmFOIGFzIGVxdWFsKVxuXHQgKiAqIEJvdGggdmFsdWVzIHJlcHJlc2VudCB0aGUgc2FtZSByZWd1bGFyIGV4cHJlc3Npb24gKEluIEphdmFTY3JpcHQsXG5cdCAqICAgL2FiYy8gPT0gL2FiYy8gPT4gZmFsc2UuIEJ1dCB3ZSBjb25zaWRlciB0d28gcmVndWxhciBleHByZXNzaW9ucyBhcyBlcXVhbCB3aGVuIHRoZWlyIHRleHR1YWxcblx0ICogICByZXByZXNlbnRhdGlvbiBtYXRjaGVzKS5cblx0ICpcblx0ICogRHVyaW5nIGEgcHJvcGVydHkgY29tcGFyaXNvbiwgcHJvcGVydGllcyBvZiBgZnVuY3Rpb25gIHR5cGUgYW5kIHByb3BlcnRpZXMgd2l0aCBuYW1lc1xuXHQgKiB0aGF0IGJlZ2luIHdpdGggYCRgIGFyZSBpZ25vcmVkLlxuXHQgKlxuXHQgKiBTY29wZSBhbmQgRE9NV2luZG93IG9iamVjdHMgYXJlIGJlaW5nIGNvbXBhcmVkIG9ubHkgYnkgaWRlbnRpZnkgKGA9PT1gKS5cblx0ICpcblx0ICogQHBhcmFtIHsqfSBvMSBPYmplY3Qgb3IgdmFsdWUgdG8gY29tcGFyZS5cblx0ICogQHBhcmFtIHsqfSBvMiBPYmplY3Qgb3IgdmFsdWUgdG8gY29tcGFyZS5cblx0ICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgYXJndW1lbnRzIGFyZSBlcXVhbC5cblx0ICovXG5cdGZ1bmN0aW9uIGVxdWFscyhvMSwgbzIpIHtcblx0ICBpZiAobzEgPT09IG8yKSByZXR1cm4gdHJ1ZTtcblx0ICBpZiAobzEgPT09IG51bGwgfHwgbzIgPT09IG51bGwpIHJldHVybiBmYWxzZTtcblx0ICBpZiAobzEgIT09IG8xICYmIG8yICE9PSBvMikgcmV0dXJuIHRydWU7IC8vIE5hTiA9PT0gTmFOXG5cdCAgdmFyIHQxID0gdHlwZW9mIG8xLCB0MiA9IHR5cGVvZiBvMiwgbGVuZ3RoLCBrZXksIGtleVNldDtcblx0ICBpZiAodDEgPT0gdDIgJiYgdDEgPT0gJ29iamVjdCcpIHtcblx0ICAgIGlmIChpc0FycmF5KG8xKSkge1xuXHQgICAgICBpZiAoIWlzQXJyYXkobzIpKSByZXR1cm4gZmFsc2U7XG5cdCAgICAgIGlmICgobGVuZ3RoID0gbzEubGVuZ3RoKSA9PSBvMi5sZW5ndGgpIHtcblx0ICAgICAgICBmb3IgKGtleSA9IDA7IGtleSA8IGxlbmd0aDsga2V5KyspIHtcblx0ICAgICAgICAgIGlmICghZXF1YWxzKG8xW2tleV0sIG8yW2tleV0pKSByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICB9XG5cdCAgICB9IGVsc2UgaWYgKGlzRGF0ZShvMSkpIHtcblx0ICAgICAgaWYgKCFpc0RhdGUobzIpKSByZXR1cm4gZmFsc2U7XG5cdCAgICAgIHJldHVybiBlcXVhbHMobzEuZ2V0VGltZSgpLCBvMi5nZXRUaW1lKCkpO1xuXHQgICAgfSBlbHNlIGlmIChpc1JlZ0V4cChvMSkpIHtcblx0ICAgICAgaWYgKCFpc1JlZ0V4cChvMikpIHJldHVybiBmYWxzZTtcblx0ICAgICAgcmV0dXJuIG8xLnRvU3RyaW5nKCkgPT0gbzIudG9TdHJpbmcoKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGlmIChpc1Njb3BlKG8xKSB8fCBpc1Njb3BlKG8yKSB8fCBpc1dpbmRvdyhvMSkgfHwgaXNXaW5kb3cobzIpIHx8XG5cdCAgICAgICAgaXNBcnJheShvMikgfHwgaXNEYXRlKG8yKSB8fCBpc1JlZ0V4cChvMikpIHJldHVybiBmYWxzZTtcblx0ICAgICAga2V5U2V0ID0gY3JlYXRlTWFwKCk7XG5cdCAgICAgIGZvciAoa2V5IGluIG8xKSB7XG5cdCAgICAgICAgaWYgKGtleS5jaGFyQXQoMCkgPT09ICckJyB8fCBpc0Z1bmN0aW9uKG8xW2tleV0pKSBjb250aW51ZTtcblx0ICAgICAgICBpZiAoIWVxdWFscyhvMVtrZXldLCBvMltrZXldKSkgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIGtleVNldFtrZXldID0gdHJ1ZTtcblx0ICAgICAgfVxuXHQgICAgICBmb3IgKGtleSBpbiBvMikge1xuXHQgICAgICAgIGlmICghKGtleSBpbiBrZXlTZXQpICYmXG5cdCAgICAgICAgICAgIGtleS5jaGFyQXQoMCkgIT09ICckJyAmJlxuXHQgICAgICAgICAgICBpc0RlZmluZWQobzJba2V5XSkgJiZcblx0ICAgICAgICAgICAgIWlzRnVuY3Rpb24obzJba2V5XSkpIHJldHVybiBmYWxzZTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgIH1cblx0ICB9XG5cdCAgcmV0dXJuIGZhbHNlO1xuXHR9XG5cdFxuXHR2YXIgY3NwID0gZnVuY3Rpb24oKSB7XG5cdCAgaWYgKCFpc0RlZmluZWQoY3NwLnJ1bGVzKSkge1xuXHRcblx0XG5cdCAgICB2YXIgbmdDc3BFbGVtZW50ID0gKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tuZy1jc3BdJykgfHxcblx0ICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1uZy1jc3BdJykpO1xuXHRcblx0ICAgIGlmIChuZ0NzcEVsZW1lbnQpIHtcblx0ICAgICAgdmFyIG5nQ3NwQXR0cmlidXRlID0gbmdDc3BFbGVtZW50LmdldEF0dHJpYnV0ZSgnbmctY3NwJykgfHxcblx0ICAgICAgICAgICAgICAgICAgICBuZ0NzcEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLW5nLWNzcCcpO1xuXHQgICAgICBjc3AucnVsZXMgPSB7XG5cdCAgICAgICAgbm9VbnNhZmVFdmFsOiAhbmdDc3BBdHRyaWJ1dGUgfHwgKG5nQ3NwQXR0cmlidXRlLmluZGV4T2YoJ25vLXVuc2FmZS1ldmFsJykgIT09IC0xKSxcblx0ICAgICAgICBub0lubGluZVN0eWxlOiAhbmdDc3BBdHRyaWJ1dGUgfHwgKG5nQ3NwQXR0cmlidXRlLmluZGV4T2YoJ25vLWlubGluZS1zdHlsZScpICE9PSAtMSlcblx0ICAgICAgfTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGNzcC5ydWxlcyA9IHtcblx0ICAgICAgICBub1Vuc2FmZUV2YWw6IG5vVW5zYWZlRXZhbCgpLFxuXHQgICAgICAgIG5vSW5saW5lU3R5bGU6IGZhbHNlXG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICByZXR1cm4gY3NwLnJ1bGVzO1xuXHRcblx0ICBmdW5jdGlvbiBub1Vuc2FmZUV2YWwoKSB7XG5cdCAgICB0cnkge1xuXHQgICAgICAvKiBqc2hpbnQgLVcwMzEsIC1XMDU0ICovXG5cdCAgICAgIG5ldyBGdW5jdGlvbignJyk7XG5cdCAgICAgIC8qIGpzaGludCArVzAzMSwgK1cwNTQgKi9cblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgIH1cblx0ICB9XG5cdH07XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbW9kdWxlIG5nXG5cdCAqIEBuYW1lIG5nSnFcblx0ICpcblx0ICogQGVsZW1lbnQgQU5ZXG5cdCAqIEBwYXJhbSB7c3RyaW5nPX0gbmdKcSB0aGUgbmFtZSBvZiB0aGUgbGlicmFyeSBhdmFpbGFibGUgdW5kZXIgYHdpbmRvd2Bcblx0ICogdG8gYmUgdXNlZCBmb3IgYW5ndWxhci5lbGVtZW50XG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBVc2UgdGhpcyBkaXJlY3RpdmUgdG8gZm9yY2UgdGhlIGFuZ3VsYXIuZWxlbWVudCBsaWJyYXJ5LiAgVGhpcyBzaG91bGQgYmVcblx0ICogdXNlZCB0byBmb3JjZSBlaXRoZXIganFMaXRlIGJ5IGxlYXZpbmcgbmctanEgYmxhbmsgb3Igc2V0dGluZyB0aGUgbmFtZSBvZlxuXHQgKiB0aGUganF1ZXJ5IHZhcmlhYmxlIHVuZGVyIHdpbmRvdyAoZWcuIGpRdWVyeSkuXG5cdCAqXG5cdCAqIFNpbmNlIGFuZ3VsYXIgbG9va3MgZm9yIHRoaXMgZGlyZWN0aXZlIHdoZW4gaXQgaXMgbG9hZGVkIChkb2Vzbid0IHdhaXQgZm9yIHRoZVxuXHQgKiBET01Db250ZW50TG9hZGVkIGV2ZW50KSwgaXQgbXVzdCBiZSBwbGFjZWQgb24gYW4gZWxlbWVudCB0aGF0IGNvbWVzIGJlZm9yZSB0aGUgc2NyaXB0XG5cdCAqIHdoaWNoIGxvYWRzIGFuZ3VsYXIuIEFsc28sIG9ubHkgdGhlIGZpcnN0IGluc3RhbmNlIG9mIGBuZy1qcWAgd2lsbCBiZSB1c2VkIGFuZCBhbGxcblx0ICogb3RoZXJzIGlnbm9yZWQuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqIFRoaXMgZXhhbXBsZSBzaG93cyBob3cgdG8gZm9yY2UganFMaXRlIHVzaW5nIHRoZSBgbmdKcWAgZGlyZWN0aXZlIHRvIHRoZSBgaHRtbGAgdGFnLlxuXHQgYGBgaHRtbFxuXHQgPCFkb2N0eXBlIGh0bWw+XG5cdCA8aHRtbCBuZy1hcHAgbmctanE+XG5cdCAuLi5cblx0IC4uLlxuXHQgPC9odG1sPlxuXHQgYGBgXG5cdCAqIEBleGFtcGxlXG5cdCAqIFRoaXMgZXhhbXBsZSBzaG93cyBob3cgdG8gdXNlIGEgalF1ZXJ5IGJhc2VkIGxpYnJhcnkgb2YgYSBkaWZmZXJlbnQgbmFtZS5cblx0ICogVGhlIGxpYnJhcnkgbmFtZSBtdXN0IGJlIGF2YWlsYWJsZSBhdCB0aGUgdG9wIG1vc3QgJ3dpbmRvdycuXG5cdCBgYGBodG1sXG5cdCA8IWRvY3R5cGUgaHRtbD5cblx0IDxodG1sIG5nLWFwcCBuZy1qcT1cImpRdWVyeUxpYlwiPlxuXHQgLi4uXG5cdCAuLi5cblx0IDwvaHRtbD5cblx0IGBgYFxuXHQgKi9cblx0dmFyIGpxID0gZnVuY3Rpb24oKSB7XG5cdCAgaWYgKGlzRGVmaW5lZChqcS5uYW1lXykpIHJldHVybiBqcS5uYW1lXztcblx0ICB2YXIgZWw7XG5cdCAgdmFyIGksIGlpID0gbmdBdHRyUHJlZml4ZXMubGVuZ3RoLCBwcmVmaXgsIG5hbWU7XG5cdCAgZm9yIChpID0gMDsgaSA8IGlpOyArK2kpIHtcblx0ICAgIHByZWZpeCA9IG5nQXR0clByZWZpeGVzW2ldO1xuXHQgICAgaWYgKGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignWycgKyBwcmVmaXgucmVwbGFjZSgnOicsICdcXFxcOicpICsgJ2pxXScpKSB7XG5cdCAgICAgIG5hbWUgPSBlbC5nZXRBdHRyaWJ1dGUocHJlZml4ICsgJ2pxJyk7XG5cdCAgICAgIGJyZWFrO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgcmV0dXJuIChqcS5uYW1lXyA9IG5hbWUpO1xuXHR9O1xuXHRcblx0ZnVuY3Rpb24gY29uY2F0KGFycmF5MSwgYXJyYXkyLCBpbmRleCkge1xuXHQgIHJldHVybiBhcnJheTEuY29uY2F0KHNsaWNlLmNhbGwoYXJyYXkyLCBpbmRleCkpO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBzbGljZUFyZ3MoYXJncywgc3RhcnRJbmRleCkge1xuXHQgIHJldHVybiBzbGljZS5jYWxsKGFyZ3MsIHN0YXJ0SW5kZXggfHwgMCk7XG5cdH1cblx0XG5cdFxuXHQvKiBqc2hpbnQgLVcxMDEgKi9cblx0LyoqXG5cdCAqIEBuZ2RvYyBmdW5jdGlvblxuXHQgKiBAbmFtZSBhbmd1bGFyLmJpbmRcblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogUmV0dXJucyBhIGZ1bmN0aW9uIHdoaWNoIGNhbGxzIGZ1bmN0aW9uIGBmbmAgYm91bmQgdG8gYHNlbGZgIChgc2VsZmAgYmVjb21lcyB0aGUgYHRoaXNgIGZvclxuXHQgKiBgZm5gKS4gWW91IGNhbiBzdXBwbHkgb3B0aW9uYWwgYGFyZ3NgIHRoYXQgYXJlIHByZWJvdW5kIHRvIHRoZSBmdW5jdGlvbi4gVGhpcyBmZWF0dXJlIGlzIGFsc29cblx0ICoga25vd24gYXMgW3BhcnRpYWwgYXBwbGljYXRpb25dKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUGFydGlhbF9hcHBsaWNhdGlvbiksIGFzXG5cdCAqIGRpc3Rpbmd1aXNoZWQgZnJvbSBbZnVuY3Rpb24gY3VycnlpbmddKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ3VycnlpbmcjQ29udHJhc3Rfd2l0aF9wYXJ0aWFsX2Z1bmN0aW9uX2FwcGxpY2F0aW9uKS5cblx0ICpcblx0ICogQHBhcmFtIHtPYmplY3R9IHNlbGYgQ29udGV4dCB3aGljaCBgZm5gIHNob3VsZCBiZSBldmFsdWF0ZWQgaW4uXG5cdCAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gZm4gRnVuY3Rpb24gdG8gYmUgYm91bmQuXG5cdCAqIEBwYXJhbSB7Li4uKn0gYXJncyBPcHRpb25hbCBhcmd1bWVudHMgdG8gYmUgcHJlYm91bmQgdG8gdGhlIGBmbmAgZnVuY3Rpb24gY2FsbC5cblx0ICogQHJldHVybnMge2Z1bmN0aW9uKCl9IEZ1bmN0aW9uIHRoYXQgd3JhcHMgdGhlIGBmbmAgd2l0aCBhbGwgdGhlIHNwZWNpZmllZCBiaW5kaW5ncy5cblx0ICovXG5cdC8qIGpzaGludCArVzEwMSAqL1xuXHRmdW5jdGlvbiBiaW5kKHNlbGYsIGZuKSB7XG5cdCAgdmFyIGN1cnJ5QXJncyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gc2xpY2VBcmdzKGFyZ3VtZW50cywgMikgOiBbXTtcblx0ICBpZiAoaXNGdW5jdGlvbihmbikgJiYgIShmbiBpbnN0YW5jZW9mIFJlZ0V4cCkpIHtcblx0ICAgIHJldHVybiBjdXJyeUFyZ3MubGVuZ3RoXG5cdCAgICAgID8gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aFxuXHQgICAgICAgICAgICA/IGZuLmFwcGx5KHNlbGYsIGNvbmNhdChjdXJyeUFyZ3MsIGFyZ3VtZW50cywgMCkpXG5cdCAgICAgICAgICAgIDogZm4uYXBwbHkoc2VsZiwgY3VycnlBcmdzKTtcblx0ICAgICAgICB9XG5cdCAgICAgIDogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aFxuXHQgICAgICAgICAgICA/IGZuLmFwcGx5KHNlbGYsIGFyZ3VtZW50cylcblx0ICAgICAgICAgICAgOiBmbi5jYWxsKHNlbGYpO1xuXHQgICAgICAgIH07XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIGluIElFLCBuYXRpdmUgbWV0aG9kcyBhcmUgbm90IGZ1bmN0aW9ucyBzbyB0aGV5IGNhbm5vdCBiZSBib3VuZCAobm90ZTogdGhleSBkb24ndCBuZWVkIHRvIGJlKVxuXHQgICAgcmV0dXJuIGZuO1xuXHQgIH1cblx0fVxuXHRcblx0XG5cdGZ1bmN0aW9uIHRvSnNvblJlcGxhY2VyKGtleSwgdmFsdWUpIHtcblx0ICB2YXIgdmFsID0gdmFsdWU7XG5cdFxuXHQgIGlmICh0eXBlb2Yga2V5ID09PSAnc3RyaW5nJyAmJiBrZXkuY2hhckF0KDApID09PSAnJCcgJiYga2V5LmNoYXJBdCgxKSA9PT0gJyQnKSB7XG5cdCAgICB2YWwgPSB1bmRlZmluZWQ7XG5cdCAgfSBlbHNlIGlmIChpc1dpbmRvdyh2YWx1ZSkpIHtcblx0ICAgIHZhbCA9ICckV0lORE9XJztcblx0ICB9IGVsc2UgaWYgKHZhbHVlICYmICBkb2N1bWVudCA9PT0gdmFsdWUpIHtcblx0ICAgIHZhbCA9ICckRE9DVU1FTlQnO1xuXHQgIH0gZWxzZSBpZiAoaXNTY29wZSh2YWx1ZSkpIHtcblx0ICAgIHZhbCA9ICckU0NPUEUnO1xuXHQgIH1cblx0XG5cdCAgcmV0dXJuIHZhbDtcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZnVuY3Rpb25cblx0ICogQG5hbWUgYW5ndWxhci50b0pzb25cblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogU2VyaWFsaXplcyBpbnB1dCBpbnRvIGEgSlNPTi1mb3JtYXR0ZWQgc3RyaW5nLiBQcm9wZXJ0aWVzIHdpdGggbGVhZGluZyAkJCBjaGFyYWN0ZXJzIHdpbGwgYmVcblx0ICogc3RyaXBwZWQgc2luY2UgYW5ndWxhciB1c2VzIHRoaXMgbm90YXRpb24gaW50ZXJuYWxseS5cblx0ICpcblx0ICogQHBhcmFtIHtPYmplY3R8QXJyYXl8RGF0ZXxzdHJpbmd8bnVtYmVyfSBvYmogSW5wdXQgdG8gYmUgc2VyaWFsaXplZCBpbnRvIEpTT04uXG5cdCAqIEBwYXJhbSB7Ym9vbGVhbnxudW1iZXJ9IFtwcmV0dHk9Ml0gSWYgc2V0IHRvIHRydWUsIHRoZSBKU09OIG91dHB1dCB3aWxsIGNvbnRhaW4gbmV3bGluZXMgYW5kIHdoaXRlc3BhY2UuXG5cdCAqICAgIElmIHNldCB0byBhbiBpbnRlZ2VyLCB0aGUgSlNPTiBvdXRwdXQgd2lsbCBjb250YWluIHRoYXQgbWFueSBzcGFjZXMgcGVyIGluZGVudGF0aW9uLlxuXHQgKiBAcmV0dXJucyB7c3RyaW5nfHVuZGVmaW5lZH0gSlNPTi1pZmllZCBzdHJpbmcgcmVwcmVzZW50aW5nIGBvYmpgLlxuXHQgKi9cblx0ZnVuY3Rpb24gdG9Kc29uKG9iaiwgcHJldHR5KSB7XG5cdCAgaWYgKGlzVW5kZWZpbmVkKG9iaikpIHJldHVybiB1bmRlZmluZWQ7XG5cdCAgaWYgKCFpc051bWJlcihwcmV0dHkpKSB7XG5cdCAgICBwcmV0dHkgPSBwcmV0dHkgPyAyIDogbnVsbDtcblx0ICB9XG5cdCAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iaiwgdG9Kc29uUmVwbGFjZXIsIHByZXR0eSk7XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGZ1bmN0aW9uXG5cdCAqIEBuYW1lIGFuZ3VsYXIuZnJvbUpzb25cblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogRGVzZXJpYWxpemVzIGEgSlNPTiBzdHJpbmcuXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBqc29uIEpTT04gc3RyaW5nIHRvIGRlc2VyaWFsaXplLlxuXHQgKiBAcmV0dXJucyB7T2JqZWN0fEFycmF5fHN0cmluZ3xudW1iZXJ9IERlc2VyaWFsaXplZCBKU09OIHN0cmluZy5cblx0ICovXG5cdGZ1bmN0aW9uIGZyb21Kc29uKGpzb24pIHtcblx0ICByZXR1cm4gaXNTdHJpbmcoanNvbilcblx0ICAgICAgPyBKU09OLnBhcnNlKGpzb24pXG5cdCAgICAgIDoganNvbjtcblx0fVxuXHRcblx0XG5cdHZhciBBTExfQ09MT05TID0gLzovZztcblx0ZnVuY3Rpb24gdGltZXpvbmVUb09mZnNldCh0aW1lem9uZSwgZmFsbGJhY2spIHtcblx0ICAvLyBJRS9FZGdlIGRvIG5vdCBcInVuZGVyc3RhbmRcIiBjb2xvbiAoYDpgKSBpbiB0aW1lem9uZVxuXHQgIHRpbWV6b25lID0gdGltZXpvbmUucmVwbGFjZShBTExfQ09MT05TLCAnJyk7XG5cdCAgdmFyIHJlcXVlc3RlZFRpbWV6b25lT2Zmc2V0ID0gRGF0ZS5wYXJzZSgnSmFuIDAxLCAxOTcwIDAwOjAwOjAwICcgKyB0aW1lem9uZSkgLyA2MDAwMDtcblx0ICByZXR1cm4gaXNOYU4ocmVxdWVzdGVkVGltZXpvbmVPZmZzZXQpID8gZmFsbGJhY2sgOiByZXF1ZXN0ZWRUaW1lem9uZU9mZnNldDtcblx0fVxuXHRcblx0XG5cdGZ1bmN0aW9uIGFkZERhdGVNaW51dGVzKGRhdGUsIG1pbnV0ZXMpIHtcblx0ICBkYXRlID0gbmV3IERhdGUoZGF0ZS5nZXRUaW1lKCkpO1xuXHQgIGRhdGUuc2V0TWludXRlcyhkYXRlLmdldE1pbnV0ZXMoKSArIG1pbnV0ZXMpO1xuXHQgIHJldHVybiBkYXRlO1xuXHR9XG5cdFxuXHRcblx0ZnVuY3Rpb24gY29udmVydFRpbWV6b25lVG9Mb2NhbChkYXRlLCB0aW1lem9uZSwgcmV2ZXJzZSkge1xuXHQgIHJldmVyc2UgPSByZXZlcnNlID8gLTEgOiAxO1xuXHQgIHZhciBkYXRlVGltZXpvbmVPZmZzZXQgPSBkYXRlLmdldFRpbWV6b25lT2Zmc2V0KCk7XG5cdCAgdmFyIHRpbWV6b25lT2Zmc2V0ID0gdGltZXpvbmVUb09mZnNldCh0aW1lem9uZSwgZGF0ZVRpbWV6b25lT2Zmc2V0KTtcblx0ICByZXR1cm4gYWRkRGF0ZU1pbnV0ZXMoZGF0ZSwgcmV2ZXJzZSAqICh0aW1lem9uZU9mZnNldCAtIGRhdGVUaW1lem9uZU9mZnNldCkpO1xuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgZWxlbWVudC5cblx0ICovXG5cdGZ1bmN0aW9uIHN0YXJ0aW5nVGFnKGVsZW1lbnQpIHtcblx0ICBlbGVtZW50ID0ganFMaXRlKGVsZW1lbnQpLmNsb25lKCk7XG5cdCAgdHJ5IHtcblx0ICAgIC8vIHR1cm5zIG91dCBJRSBkb2VzIG5vdCBsZXQgeW91IHNldCAuaHRtbCgpIG9uIGVsZW1lbnRzIHdoaWNoXG5cdCAgICAvLyBhcmUgbm90IGFsbG93ZWQgdG8gaGF2ZSBjaGlsZHJlbi4gU28gd2UganVzdCBpZ25vcmUgaXQuXG5cdCAgICBlbGVtZW50LmVtcHR5KCk7XG5cdCAgfSBjYXRjaCAoZSkge31cblx0ICB2YXIgZWxlbUh0bWwgPSBqcUxpdGUoJzxkaXY+JykuYXBwZW5kKGVsZW1lbnQpLmh0bWwoKTtcblx0ICB0cnkge1xuXHQgICAgcmV0dXJuIGVsZW1lbnRbMF0ubm9kZVR5cGUgPT09IE5PREVfVFlQRV9URVhUID8gbG93ZXJjYXNlKGVsZW1IdG1sKSA6XG5cdCAgICAgICAgZWxlbUh0bWwuXG5cdCAgICAgICAgICBtYXRjaCgvXig8W14+XSs+KS8pWzFdLlxuXHQgICAgICAgICAgcmVwbGFjZSgvXjwoW1xcd1xcLV0rKS8sIGZ1bmN0aW9uKG1hdGNoLCBub2RlTmFtZSkge3JldHVybiAnPCcgKyBsb3dlcmNhc2Uobm9kZU5hbWUpO30pO1xuXHQgIH0gY2F0Y2ggKGUpIHtcblx0ICAgIHJldHVybiBsb3dlcmNhc2UoZWxlbUh0bWwpO1xuXHQgIH1cblx0XG5cdH1cblx0XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHQvKipcblx0ICogVHJpZXMgdG8gZGVjb2RlIHRoZSBVUkkgY29tcG9uZW50IHdpdGhvdXQgdGhyb3dpbmcgYW4gZXhjZXB0aW9uLlxuXHQgKlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0gc3RyIHZhbHVlIHBvdGVudGlhbCBVUkkgY29tcG9uZW50IHRvIGNoZWNrLlxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGNhbiBiZSBkZWNvZGVkXG5cdCAqIHdpdGggdGhlIGRlY29kZVVSSUNvbXBvbmVudCBmdW5jdGlvbi5cblx0ICovXG5cdGZ1bmN0aW9uIHRyeURlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkge1xuXHQgIHRyeSB7XG5cdCAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKTtcblx0ICB9IGNhdGNoIChlKSB7XG5cdCAgICAvLyBJZ25vcmUgYW55IGludmFsaWQgdXJpIGNvbXBvbmVudFxuXHQgIH1cblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBQYXJzZXMgYW4gZXNjYXBlZCB1cmwgcXVlcnkgc3RyaW5nIGludG8ga2V5LXZhbHVlIHBhaXJzLlxuXHQgKiBAcmV0dXJucyB7T2JqZWN0LjxzdHJpbmcsYm9vbGVhbnxBcnJheT59XG5cdCAqL1xuXHRmdW5jdGlvbiBwYXJzZUtleVZhbHVlKC8qKnN0cmluZyova2V5VmFsdWUpIHtcblx0ICB2YXIgb2JqID0ge307XG5cdCAgZm9yRWFjaCgoa2V5VmFsdWUgfHwgXCJcIikuc3BsaXQoJyYnKSwgZnVuY3Rpb24oa2V5VmFsdWUpIHtcblx0ICAgIHZhciBzcGxpdFBvaW50LCBrZXksIHZhbDtcblx0ICAgIGlmIChrZXlWYWx1ZSkge1xuXHQgICAgICBrZXkgPSBrZXlWYWx1ZSA9IGtleVZhbHVlLnJlcGxhY2UoL1xcKy9nLCclMjAnKTtcblx0ICAgICAgc3BsaXRQb2ludCA9IGtleVZhbHVlLmluZGV4T2YoJz0nKTtcblx0ICAgICAgaWYgKHNwbGl0UG9pbnQgIT09IC0xKSB7XG5cdCAgICAgICAga2V5ID0ga2V5VmFsdWUuc3Vic3RyaW5nKDAsIHNwbGl0UG9pbnQpO1xuXHQgICAgICAgIHZhbCA9IGtleVZhbHVlLnN1YnN0cmluZyhzcGxpdFBvaW50ICsgMSk7XG5cdCAgICAgIH1cblx0ICAgICAga2V5ID0gdHJ5RGVjb2RlVVJJQ29tcG9uZW50KGtleSk7XG5cdCAgICAgIGlmIChpc0RlZmluZWQoa2V5KSkge1xuXHQgICAgICAgIHZhbCA9IGlzRGVmaW5lZCh2YWwpID8gdHJ5RGVjb2RlVVJJQ29tcG9uZW50KHZhbCkgOiB0cnVlO1xuXHQgICAgICAgIGlmICghaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcblx0ICAgICAgICAgIG9ialtrZXldID0gdmFsO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoaXNBcnJheShvYmpba2V5XSkpIHtcblx0ICAgICAgICAgIG9ialtrZXldLnB1c2godmFsKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgb2JqW2tleV0gPSBbb2JqW2tleV0sdmFsXTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9KTtcblx0ICByZXR1cm4gb2JqO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiB0b0tleVZhbHVlKG9iaikge1xuXHQgIHZhciBwYXJ0cyA9IFtdO1xuXHQgIGZvckVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG5cdCAgICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcblx0ICAgICAgZm9yRWFjaCh2YWx1ZSwgZnVuY3Rpb24oYXJyYXlWYWx1ZSkge1xuXHQgICAgICAgIHBhcnRzLnB1c2goZW5jb2RlVXJpUXVlcnkoa2V5LCB0cnVlKSArXG5cdCAgICAgICAgICAgICAgICAgICAoYXJyYXlWYWx1ZSA9PT0gdHJ1ZSA/ICcnIDogJz0nICsgZW5jb2RlVXJpUXVlcnkoYXJyYXlWYWx1ZSwgdHJ1ZSkpKTtcblx0ICAgICAgfSk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgcGFydHMucHVzaChlbmNvZGVVcmlRdWVyeShrZXksIHRydWUpICtcblx0ICAgICAgICAgICAgICAgKHZhbHVlID09PSB0cnVlID8gJycgOiAnPScgKyBlbmNvZGVVcmlRdWVyeSh2YWx1ZSwgdHJ1ZSkpKTtcblx0ICAgIH1cblx0ICB9KTtcblx0ICByZXR1cm4gcGFydHMubGVuZ3RoID8gcGFydHMuam9pbignJicpIDogJyc7XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogV2UgbmVlZCBvdXIgY3VzdG9tIG1ldGhvZCBiZWNhdXNlIGVuY29kZVVSSUNvbXBvbmVudCBpcyB0b28gYWdncmVzc2l2ZSBhbmQgZG9lc24ndCBmb2xsb3dcblx0ICogaHR0cDovL3d3dy5pZXRmLm9yZy9yZmMvcmZjMzk4Ni50eHQgd2l0aCByZWdhcmRzIHRvIHRoZSBjaGFyYWN0ZXIgc2V0IChwY2hhcikgYWxsb3dlZCBpbiBwYXRoXG5cdCAqIHNlZ21lbnRzOlxuXHQgKiAgICBzZWdtZW50ICAgICAgID0gKnBjaGFyXG5cdCAqICAgIHBjaGFyICAgICAgICAgPSB1bnJlc2VydmVkIC8gcGN0LWVuY29kZWQgLyBzdWItZGVsaW1zIC8gXCI6XCIgLyBcIkBcIlxuXHQgKiAgICBwY3QtZW5jb2RlZCAgID0gXCIlXCIgSEVYRElHIEhFWERJR1xuXHQgKiAgICB1bnJlc2VydmVkICAgID0gQUxQSEEgLyBESUdJVCAvIFwiLVwiIC8gXCIuXCIgLyBcIl9cIiAvIFwiflwiXG5cdCAqICAgIHN1Yi1kZWxpbXMgICAgPSBcIiFcIiAvIFwiJFwiIC8gXCImXCIgLyBcIidcIiAvIFwiKFwiIC8gXCIpXCJcblx0ICogICAgICAgICAgICAgICAgICAgICAvIFwiKlwiIC8gXCIrXCIgLyBcIixcIiAvIFwiO1wiIC8gXCI9XCJcblx0ICovXG5cdGZ1bmN0aW9uIGVuY29kZVVyaVNlZ21lbnQodmFsKSB7XG5cdCAgcmV0dXJuIGVuY29kZVVyaVF1ZXJ5KHZhbCwgdHJ1ZSkuXG5cdCAgICAgICAgICAgICByZXBsYWNlKC8lMjYvZ2ksICcmJykuXG5cdCAgICAgICAgICAgICByZXBsYWNlKC8lM0QvZ2ksICc9JykuXG5cdCAgICAgICAgICAgICByZXBsYWNlKC8lMkIvZ2ksICcrJyk7XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogVGhpcyBtZXRob2QgaXMgaW50ZW5kZWQgZm9yIGVuY29kaW5nICprZXkqIG9yICp2YWx1ZSogcGFydHMgb2YgcXVlcnkgY29tcG9uZW50LiBXZSBuZWVkIGEgY3VzdG9tXG5cdCAqIG1ldGhvZCBiZWNhdXNlIGVuY29kZVVSSUNvbXBvbmVudCBpcyB0b28gYWdncmVzc2l2ZSBhbmQgZW5jb2RlcyBzdHVmZiB0aGF0IGRvZXNuJ3QgaGF2ZSB0byBiZVxuXHQgKiBlbmNvZGVkIHBlciBodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzOTg2OlxuXHQgKiAgICBxdWVyeSAgICAgICA9ICooIHBjaGFyIC8gXCIvXCIgLyBcIj9cIiApXG5cdCAqICAgIHBjaGFyICAgICAgICAgPSB1bnJlc2VydmVkIC8gcGN0LWVuY29kZWQgLyBzdWItZGVsaW1zIC8gXCI6XCIgLyBcIkBcIlxuXHQgKiAgICB1bnJlc2VydmVkICAgID0gQUxQSEEgLyBESUdJVCAvIFwiLVwiIC8gXCIuXCIgLyBcIl9cIiAvIFwiflwiXG5cdCAqICAgIHBjdC1lbmNvZGVkICAgPSBcIiVcIiBIRVhESUcgSEVYRElHXG5cdCAqICAgIHN1Yi1kZWxpbXMgICAgPSBcIiFcIiAvIFwiJFwiIC8gXCImXCIgLyBcIidcIiAvIFwiKFwiIC8gXCIpXCJcblx0ICogICAgICAgICAgICAgICAgICAgICAvIFwiKlwiIC8gXCIrXCIgLyBcIixcIiAvIFwiO1wiIC8gXCI9XCJcblx0ICovXG5cdGZ1bmN0aW9uIGVuY29kZVVyaVF1ZXJ5KHZhbCwgcGN0RW5jb2RlU3BhY2VzKSB7XG5cdCAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudCh2YWwpLlxuXHQgICAgICAgICAgICAgcmVwbGFjZSgvJTQwL2dpLCAnQCcpLlxuXHQgICAgICAgICAgICAgcmVwbGFjZSgvJTNBL2dpLCAnOicpLlxuXHQgICAgICAgICAgICAgcmVwbGFjZSgvJTI0L2csICckJykuXG5cdCAgICAgICAgICAgICByZXBsYWNlKC8lMkMvZ2ksICcsJykuXG5cdCAgICAgICAgICAgICByZXBsYWNlKC8lM0IvZ2ksICc7JykuXG5cdCAgICAgICAgICAgICByZXBsYWNlKC8lMjAvZywgKHBjdEVuY29kZVNwYWNlcyA/ICclMjAnIDogJysnKSk7XG5cdH1cblx0XG5cdHZhciBuZ0F0dHJQcmVmaXhlcyA9IFsnbmctJywgJ2RhdGEtbmctJywgJ25nOicsICd4LW5nLSddO1xuXHRcblx0ZnVuY3Rpb24gZ2V0TmdBdHRyaWJ1dGUoZWxlbWVudCwgbmdBdHRyKSB7XG5cdCAgdmFyIGF0dHIsIGksIGlpID0gbmdBdHRyUHJlZml4ZXMubGVuZ3RoO1xuXHQgIGZvciAoaSA9IDA7IGkgPCBpaTsgKytpKSB7XG5cdCAgICBhdHRyID0gbmdBdHRyUHJlZml4ZXNbaV0gKyBuZ0F0dHI7XG5cdCAgICBpZiAoaXNTdHJpbmcoYXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKGF0dHIpKSkge1xuXHQgICAgICByZXR1cm4gYXR0cjtcblx0ICAgIH1cblx0ICB9XG5cdCAgcmV0dXJuIG51bGw7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIG5nQXBwXG5cdCAqIEBtb2R1bGUgbmdcblx0ICpcblx0ICogQGVsZW1lbnQgQU5ZXG5cdCAqIEBwYXJhbSB7YW5ndWxhci5Nb2R1bGV9IG5nQXBwIGFuIG9wdGlvbmFsIGFwcGxpY2F0aW9uXG5cdCAqICAge0BsaW5rIGFuZ3VsYXIubW9kdWxlIG1vZHVsZX0gbmFtZSB0byBsb2FkLlxuXHQgKiBAcGFyYW0ge2Jvb2xlYW49fSBuZ1N0cmljdERpIGlmIHRoaXMgYXR0cmlidXRlIGlzIHByZXNlbnQgb24gdGhlIGFwcCBlbGVtZW50LCB0aGUgaW5qZWN0b3Igd2lsbCBiZVxuXHQgKiAgIGNyZWF0ZWQgaW4gXCJzdHJpY3QtZGlcIiBtb2RlLiBUaGlzIG1lYW5zIHRoYXQgdGhlIGFwcGxpY2F0aW9uIHdpbGwgZmFpbCB0byBpbnZva2UgZnVuY3Rpb25zIHdoaWNoXG5cdCAqICAgZG8gbm90IHVzZSBleHBsaWNpdCBmdW5jdGlvbiBhbm5vdGF0aW9uIChhbmQgYXJlIHRodXMgdW5zdWl0YWJsZSBmb3IgbWluaWZpY2F0aW9uKSwgYXMgZGVzY3JpYmVkXG5cdCAqICAgaW4ge0BsaW5rIGd1aWRlL2RpIHRoZSBEZXBlbmRlbmN5IEluamVjdGlvbiBndWlkZX0sIGFuZCB1c2VmdWwgZGVidWdnaW5nIGluZm8gd2lsbCBhc3Npc3QgaW5cblx0ICogICB0cmFja2luZyBkb3duIHRoZSByb290IG9mIHRoZXNlIGJ1Z3MuXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKlxuXHQgKiBVc2UgdGhpcyBkaXJlY3RpdmUgdG8gKiphdXRvLWJvb3RzdHJhcCoqIGFuIEFuZ3VsYXJKUyBhcHBsaWNhdGlvbi4gVGhlIGBuZ0FwcGAgZGlyZWN0aXZlXG5cdCAqIGRlc2lnbmF0ZXMgdGhlICoqcm9vdCBlbGVtZW50Kiogb2YgdGhlIGFwcGxpY2F0aW9uIGFuZCBpcyB0eXBpY2FsbHkgcGxhY2VkIG5lYXIgdGhlIHJvb3QgZWxlbWVudFxuXHQgKiBvZiB0aGUgcGFnZSAtIGUuZy4gb24gdGhlIGA8Ym9keT5gIG9yIGA8aHRtbD5gIHRhZ3MuXG5cdCAqXG5cdCAqIE9ubHkgb25lIEFuZ3VsYXJKUyBhcHBsaWNhdGlvbiBjYW4gYmUgYXV0by1ib290c3RyYXBwZWQgcGVyIEhUTUwgZG9jdW1lbnQuIFRoZSBmaXJzdCBgbmdBcHBgXG5cdCAqIGZvdW5kIGluIHRoZSBkb2N1bWVudCB3aWxsIGJlIHVzZWQgdG8gZGVmaW5lIHRoZSByb290IGVsZW1lbnQgdG8gYXV0by1ib290c3RyYXAgYXMgYW5cblx0ICogYXBwbGljYXRpb24uIFRvIHJ1biBtdWx0aXBsZSBhcHBsaWNhdGlvbnMgaW4gYW4gSFRNTCBkb2N1bWVudCB5b3UgbXVzdCBtYW51YWxseSBib290c3RyYXAgdGhlbSB1c2luZ1xuXHQgKiB7QGxpbmsgYW5ndWxhci5ib290c3RyYXB9IGluc3RlYWQuIEFuZ3VsYXJKUyBhcHBsaWNhdGlvbnMgY2Fubm90IGJlIG5lc3RlZCB3aXRoaW4gZWFjaCBvdGhlci5cblx0ICpcblx0ICogWW91IGNhbiBzcGVjaWZ5IGFuICoqQW5ndWxhckpTIG1vZHVsZSoqIHRvIGJlIHVzZWQgYXMgdGhlIHJvb3QgbW9kdWxlIGZvciB0aGUgYXBwbGljYXRpb24uICBUaGlzXG5cdCAqIG1vZHVsZSB3aWxsIGJlIGxvYWRlZCBpbnRvIHRoZSB7QGxpbmsgYXV0by4kaW5qZWN0b3J9IHdoZW4gdGhlIGFwcGxpY2F0aW9uIGlzIGJvb3RzdHJhcHBlZC4gSXRcblx0ICogc2hvdWxkIGNvbnRhaW4gdGhlIGFwcGxpY2F0aW9uIGNvZGUgbmVlZGVkIG9yIGhhdmUgZGVwZW5kZW5jaWVzIG9uIG90aGVyIG1vZHVsZXMgdGhhdCB3aWxsXG5cdCAqIGNvbnRhaW4gdGhlIGNvZGUuIFNlZSB7QGxpbmsgYW5ndWxhci5tb2R1bGV9IGZvciBtb3JlIGluZm9ybWF0aW9uLlxuXHQgKlxuXHQgKiBJbiB0aGUgZXhhbXBsZSBiZWxvdyBpZiB0aGUgYG5nQXBwYCBkaXJlY3RpdmUgd2VyZSBub3QgcGxhY2VkIG9uIHRoZSBgaHRtbGAgZWxlbWVudCB0aGVuIHRoZVxuXHQgKiBkb2N1bWVudCB3b3VsZCBub3QgYmUgY29tcGlsZWQsIHRoZSBgQXBwQ29udHJvbGxlcmAgd291bGQgbm90IGJlIGluc3RhbnRpYXRlZCBhbmQgdGhlIGB7eyBhK2IgfX1gXG5cdCAqIHdvdWxkIG5vdCBiZSByZXNvbHZlZCB0byBgM2AuXG5cdCAqXG5cdCAqIGBuZ0FwcGAgaXMgdGhlIGVhc2llc3QsIGFuZCBtb3N0IGNvbW1vbiB3YXkgdG8gYm9vdHN0cmFwIGFuIGFwcGxpY2F0aW9uLlxuXHQgKlxuXHQgPGV4YW1wbGUgbW9kdWxlPVwibmdBcHBEZW1vXCI+XG5cdCAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgIDxkaXYgbmctY29udHJvbGxlcj1cIm5nQXBwRGVtb0NvbnRyb2xsZXJcIj5cblx0ICAgICBJIGNhbiBhZGQ6IHt7YX19ICsge3tifX0gPSAge3sgYStiIH19XG5cdCAgIDwvZGl2PlxuXHQgICA8L2ZpbGU+XG5cdCAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cblx0ICAgYW5ndWxhci5tb2R1bGUoJ25nQXBwRGVtbycsIFtdKS5jb250cm9sbGVyKCduZ0FwcERlbW9Db250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAgICAgJHNjb3BlLmEgPSAxO1xuXHQgICAgICRzY29wZS5iID0gMjtcblx0ICAgfSk7XG5cdCAgIDwvZmlsZT5cblx0IDwvZXhhbXBsZT5cblx0ICpcblx0ICogVXNpbmcgYG5nU3RyaWN0RGlgLCB5b3Ugd291bGQgc2VlIHNvbWV0aGluZyBsaWtlIHRoaXM6XG5cdCAqXG5cdCA8ZXhhbXBsZSBuZy1hcHAtaW5jbHVkZWQ9XCJ0cnVlXCI+XG5cdCAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgIDxkaXYgbmctYXBwPVwibmdBcHBTdHJpY3REZW1vXCIgbmctc3RyaWN0LWRpPlxuXHQgICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiR29vZENvbnRyb2xsZXIxXCI+XG5cdCAgICAgICAgICAgSSBjYW4gYWRkOiB7e2F9fSArIHt7Yn19ID0gIHt7IGErYiB9fVxuXHRcblx0ICAgICAgICAgICA8cD5UaGlzIHJlbmRlcnMgYmVjYXVzZSB0aGUgY29udHJvbGxlciBkb2VzIG5vdCBmYWlsIHRvXG5cdCAgICAgICAgICAgICAgaW5zdGFudGlhdGUsIGJ5IHVzaW5nIGV4cGxpY2l0IGFubm90YXRpb24gc3R5bGUgKHNlZVxuXHQgICAgICAgICAgICAgIHNjcmlwdC5qcyBmb3IgZGV0YWlscylcblx0ICAgICAgICAgICA8L3A+XG5cdCAgICAgICA8L2Rpdj5cblx0XG5cdCAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJHb29kQ29udHJvbGxlcjJcIj5cblx0ICAgICAgICAgICBOYW1lOiA8aW5wdXQgbmctbW9kZWw9XCJuYW1lXCI+PGJyIC8+XG5cdCAgICAgICAgICAgSGVsbG8sIHt7bmFtZX19IVxuXHRcblx0ICAgICAgICAgICA8cD5UaGlzIHJlbmRlcnMgYmVjYXVzZSB0aGUgY29udHJvbGxlciBkb2VzIG5vdCBmYWlsIHRvXG5cdCAgICAgICAgICAgICAgaW5zdGFudGlhdGUsIGJ5IHVzaW5nIGV4cGxpY2l0IGFubm90YXRpb24gc3R5bGVcblx0ICAgICAgICAgICAgICAoc2VlIHNjcmlwdC5qcyBmb3IgZGV0YWlscylcblx0ICAgICAgICAgICA8L3A+XG5cdCAgICAgICA8L2Rpdj5cblx0XG5cdCAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJCYWRDb250cm9sbGVyXCI+XG5cdCAgICAgICAgICAgSSBjYW4gYWRkOiB7e2F9fSArIHt7Yn19ID0gIHt7IGErYiB9fVxuXHRcblx0ICAgICAgICAgICA8cD5UaGUgY29udHJvbGxlciBjb3VsZCBub3QgYmUgaW5zdGFudGlhdGVkLCBkdWUgdG8gcmVseWluZ1xuXHQgICAgICAgICAgICAgIG9uIGF1dG9tYXRpYyBmdW5jdGlvbiBhbm5vdGF0aW9ucyAod2hpY2ggYXJlIGRpc2FibGVkIGluXG5cdCAgICAgICAgICAgICAgc3RyaWN0IG1vZGUpLiBBcyBzdWNoLCB0aGUgY29udGVudCBvZiB0aGlzIHNlY3Rpb24gaXMgbm90XG5cdCAgICAgICAgICAgICAgaW50ZXJwb2xhdGVkLCBhbmQgdGhlcmUgc2hvdWxkIGJlIGFuIGVycm9yIGluIHlvdXIgd2ViIGNvbnNvbGUuXG5cdCAgICAgICAgICAgPC9wPlxuXHQgICAgICAgPC9kaXY+XG5cdCAgIDwvZGl2PlxuXHQgICA8L2ZpbGU+XG5cdCAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cblx0ICAgYW5ndWxhci5tb2R1bGUoJ25nQXBwU3RyaWN0RGVtbycsIFtdKVxuXHQgICAgIC8vIEJhZENvbnRyb2xsZXIgd2lsbCBmYWlsIHRvIGluc3RhbnRpYXRlLCBkdWUgdG8gcmVseWluZyBvbiBhdXRvbWF0aWMgZnVuY3Rpb24gYW5ub3RhdGlvbixcblx0ICAgICAvLyByYXRoZXIgdGhhbiBhbiBleHBsaWNpdCBhbm5vdGF0aW9uXG5cdCAgICAgLmNvbnRyb2xsZXIoJ0JhZENvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICRzY29wZS5hID0gMTtcblx0ICAgICAgICRzY29wZS5iID0gMjtcblx0ICAgICB9KVxuXHQgICAgIC8vIFVubGlrZSBCYWRDb250cm9sbGVyLCBHb29kQ29udHJvbGxlcjEgYW5kIEdvb2RDb250cm9sbGVyMiB3aWxsIG5vdCBmYWlsIHRvIGJlIGluc3RhbnRpYXRlZCxcblx0ICAgICAvLyBkdWUgdG8gdXNpbmcgZXhwbGljaXQgYW5ub3RhdGlvbnMgdXNpbmcgdGhlIGFycmF5IHN0eWxlIGFuZCAkaW5qZWN0IHByb3BlcnR5LCByZXNwZWN0aXZlbHkuXG5cdCAgICAgLmNvbnRyb2xsZXIoJ0dvb2RDb250cm9sbGVyMScsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAgICAgICAkc2NvcGUuYSA9IDE7XG5cdCAgICAgICAkc2NvcGUuYiA9IDI7XG5cdCAgICAgfV0pXG5cdCAgICAgLmNvbnRyb2xsZXIoJ0dvb2RDb250cm9sbGVyMicsIEdvb2RDb250cm9sbGVyMik7XG5cdCAgICAgZnVuY3Rpb24gR29vZENvbnRyb2xsZXIyKCRzY29wZSkge1xuXHQgICAgICAgJHNjb3BlLm5hbWUgPSBcIldvcmxkXCI7XG5cdCAgICAgfVxuXHQgICAgIEdvb2RDb250cm9sbGVyMi4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblx0ICAgPC9maWxlPlxuXHQgICA8ZmlsZSBuYW1lPVwic3R5bGUuY3NzXCI+XG5cdCAgIGRpdltuZy1jb250cm9sbGVyXSB7XG5cdCAgICAgICBtYXJnaW4tYm90dG9tOiAxZW07XG5cdCAgICAgICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDRweDtcblx0ICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcblx0ICAgICAgIGJvcmRlcjogMXB4IHNvbGlkO1xuXHQgICAgICAgcGFkZGluZzogLjVlbTtcblx0ICAgfVxuXHQgICBkaXZbbmctY29udHJvbGxlcl49R29vZF0ge1xuXHQgICAgICAgYm9yZGVyLWNvbG9yOiAjZDZlOWM2O1xuXHQgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2RmZjBkODtcblx0ICAgICAgIGNvbG9yOiAjM2M3NjNkO1xuXHQgICB9XG5cdCAgIGRpdltuZy1jb250cm9sbGVyXj1CYWRdIHtcblx0ICAgICAgIGJvcmRlci1jb2xvcjogI2ViY2NkMTtcblx0ICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmMmRlZGU7XG5cdCAgICAgICBjb2xvcjogI2E5NDQ0Mjtcblx0ICAgICAgIG1hcmdpbi1ib3R0b206IDA7XG5cdCAgIH1cblx0ICAgPC9maWxlPlxuXHQgPC9leGFtcGxlPlxuXHQgKi9cblx0ZnVuY3Rpb24gYW5ndWxhckluaXQoZWxlbWVudCwgYm9vdHN0cmFwKSB7XG5cdCAgdmFyIGFwcEVsZW1lbnQsXG5cdCAgICAgIG1vZHVsZSxcblx0ICAgICAgY29uZmlnID0ge307XG5cdFxuXHQgIC8vIFRoZSBlbGVtZW50IGBlbGVtZW50YCBoYXMgcHJpb3JpdHkgb3ZlciBhbnkgb3RoZXIgZWxlbWVudFxuXHQgIGZvckVhY2gobmdBdHRyUHJlZml4ZXMsIGZ1bmN0aW9uKHByZWZpeCkge1xuXHQgICAgdmFyIG5hbWUgPSBwcmVmaXggKyAnYXBwJztcblx0XG5cdCAgICBpZiAoIWFwcEVsZW1lbnQgJiYgZWxlbWVudC5oYXNBdHRyaWJ1dGUgJiYgZWxlbWVudC5oYXNBdHRyaWJ1dGUobmFtZSkpIHtcblx0ICAgICAgYXBwRWxlbWVudCA9IGVsZW1lbnQ7XG5cdCAgICAgIG1vZHVsZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKG5hbWUpO1xuXHQgICAgfVxuXHQgIH0pO1xuXHQgIGZvckVhY2gobmdBdHRyUHJlZml4ZXMsIGZ1bmN0aW9uKHByZWZpeCkge1xuXHQgICAgdmFyIG5hbWUgPSBwcmVmaXggKyAnYXBwJztcblx0ICAgIHZhciBjYW5kaWRhdGU7XG5cdFxuXHQgICAgaWYgKCFhcHBFbGVtZW50ICYmIChjYW5kaWRhdGUgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ1snICsgbmFtZS5yZXBsYWNlKCc6JywgJ1xcXFw6JykgKyAnXScpKSkge1xuXHQgICAgICBhcHBFbGVtZW50ID0gY2FuZGlkYXRlO1xuXHQgICAgICBtb2R1bGUgPSBjYW5kaWRhdGUuZ2V0QXR0cmlidXRlKG5hbWUpO1xuXHQgICAgfVxuXHQgIH0pO1xuXHQgIGlmIChhcHBFbGVtZW50KSB7XG5cdCAgICBjb25maWcuc3RyaWN0RGkgPSBnZXROZ0F0dHJpYnV0ZShhcHBFbGVtZW50LCBcInN0cmljdC1kaVwiKSAhPT0gbnVsbDtcblx0ICAgIGJvb3RzdHJhcChhcHBFbGVtZW50LCBtb2R1bGUgPyBbbW9kdWxlXSA6IFtdLCBjb25maWcpO1xuXHQgIH1cblx0fVxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBmdW5jdGlvblxuXHQgKiBAbmFtZSBhbmd1bGFyLmJvb3RzdHJhcFxuXHQgKiBAbW9kdWxlIG5nXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBVc2UgdGhpcyBmdW5jdGlvbiB0byBtYW51YWxseSBzdGFydCB1cCBhbmd1bGFyIGFwcGxpY2F0aW9uLlxuXHQgKlxuXHQgKiBTZWU6IHtAbGluayBndWlkZS9ib290c3RyYXAgQm9vdHN0cmFwfVxuXHQgKlxuXHQgKiBOb3RlIHRoYXQgUHJvdHJhY3RvciBiYXNlZCBlbmQtdG8tZW5kIHRlc3RzIGNhbm5vdCB1c2UgdGhpcyBmdW5jdGlvbiB0byBib290c3RyYXAgbWFudWFsbHkuXG5cdCAqIFRoZXkgbXVzdCB1c2Uge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0FwcCBuZ0FwcH0uXG5cdCAqXG5cdCAqIEFuZ3VsYXIgd2lsbCBkZXRlY3QgaWYgaXQgaGFzIGJlZW4gbG9hZGVkIGludG8gdGhlIGJyb3dzZXIgbW9yZSB0aGFuIG9uY2UgYW5kIG9ubHkgYWxsb3cgdGhlXG5cdCAqIGZpcnN0IGxvYWRlZCBzY3JpcHQgdG8gYmUgYm9vdHN0cmFwcGVkIGFuZCB3aWxsIHJlcG9ydCBhIHdhcm5pbmcgdG8gdGhlIGJyb3dzZXIgY29uc29sZSBmb3Jcblx0ICogZWFjaCBvZiB0aGUgc3Vic2VxdWVudCBzY3JpcHRzLiBUaGlzIHByZXZlbnRzIHN0cmFuZ2UgcmVzdWx0cyBpbiBhcHBsaWNhdGlvbnMsIHdoZXJlIG90aGVyd2lzZVxuXHQgKiBtdWx0aXBsZSBpbnN0YW5jZXMgb2YgQW5ndWxhciB0cnkgdG8gd29yayBvbiB0aGUgRE9NLlxuXHQgKlxuXHQgKiBgYGBodG1sXG5cdCAqIDwhZG9jdHlwZSBodG1sPlxuXHQgKiA8aHRtbD5cblx0ICogPGJvZHk+XG5cdCAqIDxkaXYgbmctY29udHJvbGxlcj1cIldlbGNvbWVDb250cm9sbGVyXCI+XG5cdCAqICAge3tncmVldGluZ319XG5cdCAqIDwvZGl2PlxuXHQgKlxuXHQgKiA8c2NyaXB0IHNyYz1cImFuZ3VsYXIuanNcIj48L3NjcmlwdD5cblx0ICogPHNjcmlwdD5cblx0ICogICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2RlbW8nLCBbXSlcblx0ICogICAuY29udHJvbGxlcignV2VsY29tZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICogICAgICAgJHNjb3BlLmdyZWV0aW5nID0gJ1dlbGNvbWUhJztcblx0ICogICB9KTtcblx0ICogICBhbmd1bGFyLmJvb3RzdHJhcChkb2N1bWVudCwgWydkZW1vJ10pO1xuXHQgKiA8L3NjcmlwdD5cblx0ICogPC9ib2R5PlxuXHQgKiA8L2h0bWw+XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgRE9NIGVsZW1lbnQgd2hpY2ggaXMgdGhlIHJvb3Qgb2YgYW5ndWxhciBhcHBsaWNhdGlvbi5cblx0ICogQHBhcmFtIHtBcnJheTxTdHJpbmd8RnVuY3Rpb258QXJyYXk+PX0gbW9kdWxlcyBhbiBhcnJheSBvZiBtb2R1bGVzIHRvIGxvYWQgaW50byB0aGUgYXBwbGljYXRpb24uXG5cdCAqICAgICBFYWNoIGl0ZW0gaW4gdGhlIGFycmF5IHNob3VsZCBiZSB0aGUgbmFtZSBvZiBhIHByZWRlZmluZWQgbW9kdWxlIG9yIGEgKERJIGFubm90YXRlZClcblx0ICogICAgIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBpbnZva2VkIGJ5IHRoZSBpbmplY3RvciBhcyBhIGBjb25maWdgIGJsb2NrLlxuXHQgKiAgICAgU2VlOiB7QGxpbmsgYW5ndWxhci5tb2R1bGUgbW9kdWxlc31cblx0ICogQHBhcmFtIHtPYmplY3Q9fSBjb25maWcgYW4gb2JqZWN0IGZvciBkZWZpbmluZyBjb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSBhcHBsaWNhdGlvbi4gVGhlXG5cdCAqICAgICBmb2xsb3dpbmcga2V5cyBhcmUgc3VwcG9ydGVkOlxuXHQgKlxuXHQgKiAqIGBzdHJpY3REaWAgLSBkaXNhYmxlIGF1dG9tYXRpYyBmdW5jdGlvbiBhbm5vdGF0aW9uIGZvciB0aGUgYXBwbGljYXRpb24uIFRoaXMgaXMgbWVhbnQgdG9cblx0ICogICBhc3Npc3QgaW4gZmluZGluZyBidWdzIHdoaWNoIGJyZWFrIG1pbmlmaWVkIGNvZGUuIERlZmF1bHRzIHRvIGBmYWxzZWAuXG5cdCAqXG5cdCAqIEByZXR1cm5zIHthdXRvLiRpbmplY3Rvcn0gUmV0dXJucyB0aGUgbmV3bHkgY3JlYXRlZCBpbmplY3RvciBmb3IgdGhpcyBhcHAuXG5cdCAqL1xuXHRmdW5jdGlvbiBib290c3RyYXAoZWxlbWVudCwgbW9kdWxlcywgY29uZmlnKSB7XG5cdCAgaWYgKCFpc09iamVjdChjb25maWcpKSBjb25maWcgPSB7fTtcblx0ICB2YXIgZGVmYXVsdENvbmZpZyA9IHtcblx0ICAgIHN0cmljdERpOiBmYWxzZVxuXHQgIH07XG5cdCAgY29uZmlnID0gZXh0ZW5kKGRlZmF1bHRDb25maWcsIGNvbmZpZyk7XG5cdCAgdmFyIGRvQm9vdHN0cmFwID0gZnVuY3Rpb24oKSB7XG5cdCAgICBlbGVtZW50ID0ganFMaXRlKGVsZW1lbnQpO1xuXHRcblx0ICAgIGlmIChlbGVtZW50LmluamVjdG9yKCkpIHtcblx0ICAgICAgdmFyIHRhZyA9IChlbGVtZW50WzBdID09PSBkb2N1bWVudCkgPyAnZG9jdW1lbnQnIDogc3RhcnRpbmdUYWcoZWxlbWVudCk7XG5cdCAgICAgIC8vRW5jb2RlIGFuZ2xlIGJyYWNrZXRzIHRvIHByZXZlbnQgaW5wdXQgZnJvbSBiZWluZyBzYW5pdGl6ZWQgdG8gZW1wdHkgc3RyaW5nICM4NjgzXG5cdCAgICAgIHRocm93IG5nTWluRXJyKFxuXHQgICAgICAgICAgJ2J0c3RycGQnLFxuXHQgICAgICAgICAgXCJBcHAgQWxyZWFkeSBCb290c3RyYXBwZWQgd2l0aCB0aGlzIEVsZW1lbnQgJ3swfSdcIixcblx0ICAgICAgICAgIHRhZy5yZXBsYWNlKC88LywnJmx0OycpLnJlcGxhY2UoLz4vLCcmZ3Q7JykpO1xuXHQgICAgfVxuXHRcblx0ICAgIG1vZHVsZXMgPSBtb2R1bGVzIHx8IFtdO1xuXHQgICAgbW9kdWxlcy51bnNoaWZ0KFsnJHByb3ZpZGUnLCBmdW5jdGlvbigkcHJvdmlkZSkge1xuXHQgICAgICAkcHJvdmlkZS52YWx1ZSgnJHJvb3RFbGVtZW50JywgZWxlbWVudCk7XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgaWYgKGNvbmZpZy5kZWJ1Z0luZm9FbmFibGVkKSB7XG5cdCAgICAgIC8vIFB1c2hpbmcgc28gdGhhdCB0aGlzIG92ZXJyaWRlcyBgZGVidWdJbmZvRW5hYmxlZGAgc2V0dGluZyBkZWZpbmVkIGluIHVzZXIncyBgbW9kdWxlc2AuXG5cdCAgICAgIG1vZHVsZXMucHVzaChbJyRjb21waWxlUHJvdmlkZXInLCBmdW5jdGlvbigkY29tcGlsZVByb3ZpZGVyKSB7XG5cdCAgICAgICAgJGNvbXBpbGVQcm92aWRlci5kZWJ1Z0luZm9FbmFibGVkKHRydWUpO1xuXHQgICAgICB9XSk7XG5cdCAgICB9XG5cdFxuXHQgICAgbW9kdWxlcy51bnNoaWZ0KCduZycpO1xuXHQgICAgdmFyIGluamVjdG9yID0gY3JlYXRlSW5qZWN0b3IobW9kdWxlcywgY29uZmlnLnN0cmljdERpKTtcblx0ICAgIGluamVjdG9yLmludm9rZShbJyRyb290U2NvcGUnLCAnJHJvb3RFbGVtZW50JywgJyRjb21waWxlJywgJyRpbmplY3RvcicsXG5cdCAgICAgICBmdW5jdGlvbiBib290c3RyYXBBcHBseShzY29wZSwgZWxlbWVudCwgY29tcGlsZSwgaW5qZWN0b3IpIHtcblx0ICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBlbGVtZW50LmRhdGEoJyRpbmplY3RvcicsIGluamVjdG9yKTtcblx0ICAgICAgICAgIGNvbXBpbGUoZWxlbWVudCkoc2NvcGUpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XVxuXHQgICAgKTtcblx0ICAgIHJldHVybiBpbmplY3Rvcjtcblx0ICB9O1xuXHRcblx0ICB2YXIgTkdfRU5BQkxFX0RFQlVHX0lORk8gPSAvXk5HX0VOQUJMRV9ERUJVR19JTkZPIS87XG5cdCAgdmFyIE5HX0RFRkVSX0JPT1RTVFJBUCA9IC9eTkdfREVGRVJfQk9PVFNUUkFQIS87XG5cdFxuXHQgIGlmICh3aW5kb3cgJiYgTkdfRU5BQkxFX0RFQlVHX0lORk8udGVzdCh3aW5kb3cubmFtZSkpIHtcblx0ICAgIGNvbmZpZy5kZWJ1Z0luZm9FbmFibGVkID0gdHJ1ZTtcblx0ICAgIHdpbmRvdy5uYW1lID0gd2luZG93Lm5hbWUucmVwbGFjZShOR19FTkFCTEVfREVCVUdfSU5GTywgJycpO1xuXHQgIH1cblx0XG5cdCAgaWYgKHdpbmRvdyAmJiAhTkdfREVGRVJfQk9PVFNUUkFQLnRlc3Qod2luZG93Lm5hbWUpKSB7XG5cdCAgICByZXR1cm4gZG9Cb290c3RyYXAoKTtcblx0ICB9XG5cdFxuXHQgIHdpbmRvdy5uYW1lID0gd2luZG93Lm5hbWUucmVwbGFjZShOR19ERUZFUl9CT09UU1RSQVAsICcnKTtcblx0ICBhbmd1bGFyLnJlc3VtZUJvb3RzdHJhcCA9IGZ1bmN0aW9uKGV4dHJhTW9kdWxlcykge1xuXHQgICAgZm9yRWFjaChleHRyYU1vZHVsZXMsIGZ1bmN0aW9uKG1vZHVsZSkge1xuXHQgICAgICBtb2R1bGVzLnB1c2gobW9kdWxlKTtcblx0ICAgIH0pO1xuXHQgICAgcmV0dXJuIGRvQm9vdHN0cmFwKCk7XG5cdCAgfTtcblx0XG5cdCAgaWYgKGlzRnVuY3Rpb24oYW5ndWxhci5yZXN1bWVEZWZlcnJlZEJvb3RzdHJhcCkpIHtcblx0ICAgIGFuZ3VsYXIucmVzdW1lRGVmZXJyZWRCb290c3RyYXAoKTtcblx0ICB9XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZnVuY3Rpb25cblx0ICogQG5hbWUgYW5ndWxhci5yZWxvYWRXaXRoRGVidWdJbmZvXG5cdCAqIEBtb2R1bGUgbmdcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFVzZSB0aGlzIGZ1bmN0aW9uIHRvIHJlbG9hZCB0aGUgY3VycmVudCBhcHBsaWNhdGlvbiB3aXRoIGRlYnVnIGluZm9ybWF0aW9uIHR1cm5lZCBvbi5cblx0ICogVGhpcyB0YWtlcyBwcmVjZWRlbmNlIG92ZXIgYSBjYWxsIHRvIGAkY29tcGlsZVByb3ZpZGVyLmRlYnVnSW5mb0VuYWJsZWQoZmFsc2UpYC5cblx0ICpcblx0ICogU2VlIHtAbGluayBuZy4kY29tcGlsZVByb3ZpZGVyI2RlYnVnSW5mb0VuYWJsZWR9IGZvciBtb3JlLlxuXHQgKi9cblx0ZnVuY3Rpb24gcmVsb2FkV2l0aERlYnVnSW5mbygpIHtcblx0ICB3aW5kb3cubmFtZSA9ICdOR19FTkFCTEVfREVCVUdfSU5GTyEnICsgd2luZG93Lm5hbWU7XG5cdCAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQG5hbWUgYW5ndWxhci5nZXRUZXN0YWJpbGl0eVxuXHQgKiBAbW9kdWxlIG5nXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBHZXQgdGhlIHRlc3RhYmlsaXR5IHNlcnZpY2UgZm9yIHRoZSBpbnN0YW5jZSBvZiBBbmd1bGFyIG9uIHRoZSBnaXZlblxuXHQgKiBlbGVtZW50LlxuXHQgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgRE9NIGVsZW1lbnQgd2hpY2ggaXMgdGhlIHJvb3Qgb2YgYW5ndWxhciBhcHBsaWNhdGlvbi5cblx0ICovXG5cdGZ1bmN0aW9uIGdldFRlc3RhYmlsaXR5KHJvb3RFbGVtZW50KSB7XG5cdCAgdmFyIGluamVjdG9yID0gYW5ndWxhci5lbGVtZW50KHJvb3RFbGVtZW50KS5pbmplY3RvcigpO1xuXHQgIGlmICghaW5qZWN0b3IpIHtcblx0ICAgIHRocm93IG5nTWluRXJyKCd0ZXN0Jyxcblx0ICAgICAgJ25vIGluamVjdG9yIGZvdW5kIGZvciBlbGVtZW50IGFyZ3VtZW50IHRvIGdldFRlc3RhYmlsaXR5Jyk7XG5cdCAgfVxuXHQgIHJldHVybiBpbmplY3Rvci5nZXQoJyQkdGVzdGFiaWxpdHknKTtcblx0fVxuXHRcblx0dmFyIFNOQUtFX0NBU0VfUkVHRVhQID0gL1tBLVpdL2c7XG5cdGZ1bmN0aW9uIHNuYWtlX2Nhc2UobmFtZSwgc2VwYXJhdG9yKSB7XG5cdCAgc2VwYXJhdG9yID0gc2VwYXJhdG9yIHx8ICdfJztcblx0ICByZXR1cm4gbmFtZS5yZXBsYWNlKFNOQUtFX0NBU0VfUkVHRVhQLCBmdW5jdGlvbihsZXR0ZXIsIHBvcykge1xuXHQgICAgcmV0dXJuIChwb3MgPyBzZXBhcmF0b3IgOiAnJykgKyBsZXR0ZXIudG9Mb3dlckNhc2UoKTtcblx0ICB9KTtcblx0fVxuXHRcblx0dmFyIGJpbmRKUXVlcnlGaXJlZCA9IGZhbHNlO1xuXHRmdW5jdGlvbiBiaW5kSlF1ZXJ5KCkge1xuXHQgIHZhciBvcmlnaW5hbENsZWFuRGF0YTtcblx0XG5cdCAgaWYgKGJpbmRKUXVlcnlGaXJlZCkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblx0XG5cdCAgLy8gYmluZCB0byBqUXVlcnkgaWYgcHJlc2VudDtcblx0ICB2YXIganFOYW1lID0ganEoKTtcblx0ICBqUXVlcnkgPSBpc1VuZGVmaW5lZChqcU5hbWUpID8gd2luZG93LmpRdWVyeSA6ICAgLy8gdXNlIGpRdWVyeSAoaWYgcHJlc2VudClcblx0ICAgICAgICAgICAhanFOYW1lICAgICAgICAgICAgID8gdW5kZWZpbmVkICAgICA6ICAgLy8gdXNlIGpxTGl0ZVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3dbanFOYW1lXTsgICAvLyB1c2UgalF1ZXJ5IHNwZWNpZmllZCBieSBgbmdKcWBcblx0XG5cdCAgLy8gVXNlIGpRdWVyeSBpZiBpdCBleGlzdHMgd2l0aCBwcm9wZXIgZnVuY3Rpb25hbGl0eSwgb3RoZXJ3aXNlIGRlZmF1bHQgdG8gdXMuXG5cdCAgLy8gQW5ndWxhciAxLjIrIHJlcXVpcmVzIGpRdWVyeSAxLjcrIGZvciBvbigpL29mZigpIHN1cHBvcnQuXG5cdCAgLy8gQW5ndWxhciAxLjMrIHRlY2huaWNhbGx5IHJlcXVpcmVzIGF0IGxlYXN0IGpRdWVyeSAyLjErIGJ1dCBpdCBtYXkgd29yayB3aXRoIG9sZGVyXG5cdCAgLy8gdmVyc2lvbnMuIEl0IHdpbGwgbm90IHdvcmsgZm9yIHN1cmUgd2l0aCBqUXVlcnkgPDEuNywgdGhvdWdoLlxuXHQgIGlmIChqUXVlcnkgJiYgalF1ZXJ5LmZuLm9uKSB7XG5cdCAgICBqcUxpdGUgPSBqUXVlcnk7XG5cdCAgICBleHRlbmQoalF1ZXJ5LmZuLCB7XG5cdCAgICAgIHNjb3BlOiBKUUxpdGVQcm90b3R5cGUuc2NvcGUsXG5cdCAgICAgIGlzb2xhdGVTY29wZTogSlFMaXRlUHJvdG90eXBlLmlzb2xhdGVTY29wZSxcblx0ICAgICAgY29udHJvbGxlcjogSlFMaXRlUHJvdG90eXBlLmNvbnRyb2xsZXIsXG5cdCAgICAgIGluamVjdG9yOiBKUUxpdGVQcm90b3R5cGUuaW5qZWN0b3IsXG5cdCAgICAgIGluaGVyaXRlZERhdGE6IEpRTGl0ZVByb3RvdHlwZS5pbmhlcml0ZWREYXRhXG5cdCAgICB9KTtcblx0XG5cdCAgICAvLyBBbGwgbm9kZXMgcmVtb3ZlZCBmcm9tIHRoZSBET00gdmlhIHZhcmlvdXMgalF1ZXJ5IEFQSXMgbGlrZSAucmVtb3ZlKClcblx0ICAgIC8vIGFyZSBwYXNzZWQgdGhyb3VnaCBqUXVlcnkuY2xlYW5EYXRhLiBNb25rZXktcGF0Y2ggdGhpcyBtZXRob2QgdG8gZmlyZVxuXHQgICAgLy8gdGhlICRkZXN0cm95IGV2ZW50IG9uIGFsbCByZW1vdmVkIG5vZGVzLlxuXHQgICAgb3JpZ2luYWxDbGVhbkRhdGEgPSBqUXVlcnkuY2xlYW5EYXRhO1xuXHQgICAgalF1ZXJ5LmNsZWFuRGF0YSA9IGZ1bmN0aW9uKGVsZW1zKSB7XG5cdCAgICAgIHZhciBldmVudHM7XG5cdCAgICAgIGZvciAodmFyIGkgPSAwLCBlbGVtOyAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKyspIHtcblx0ICAgICAgICBldmVudHMgPSBqUXVlcnkuX2RhdGEoZWxlbSwgXCJldmVudHNcIik7XG5cdCAgICAgICAgaWYgKGV2ZW50cyAmJiBldmVudHMuJGRlc3Ryb3kpIHtcblx0ICAgICAgICAgIGpRdWVyeShlbGVtKS50cmlnZ2VySGFuZGxlcignJGRlc3Ryb3knKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgICAgb3JpZ2luYWxDbGVhbkRhdGEoZWxlbXMpO1xuXHQgICAgfTtcblx0ICB9IGVsc2Uge1xuXHQgICAganFMaXRlID0gSlFMaXRlO1xuXHQgIH1cblx0XG5cdCAgYW5ndWxhci5lbGVtZW50ID0ganFMaXRlO1xuXHRcblx0ICAvLyBQcmV2ZW50IGRvdWJsZS1wcm94eWluZy5cblx0ICBiaW5kSlF1ZXJ5RmlyZWQgPSB0cnVlO1xuXHR9XG5cdFxuXHQvKipcblx0ICogdGhyb3cgZXJyb3IgaWYgdGhlIGFyZ3VtZW50IGlzIGZhbHN5LlxuXHQgKi9cblx0ZnVuY3Rpb24gYXNzZXJ0QXJnKGFyZywgbmFtZSwgcmVhc29uKSB7XG5cdCAgaWYgKCFhcmcpIHtcblx0ICAgIHRocm93IG5nTWluRXJyKCdhcmVxJywgXCJBcmd1bWVudCAnezB9JyBpcyB7MX1cIiwgKG5hbWUgfHwgJz8nKSwgKHJlYXNvbiB8fCBcInJlcXVpcmVkXCIpKTtcblx0ICB9XG5cdCAgcmV0dXJuIGFyZztcblx0fVxuXHRcblx0ZnVuY3Rpb24gYXNzZXJ0QXJnRm4oYXJnLCBuYW1lLCBhY2NlcHRBcnJheUFubm90YXRpb24pIHtcblx0ICBpZiAoYWNjZXB0QXJyYXlBbm5vdGF0aW9uICYmIGlzQXJyYXkoYXJnKSkge1xuXHQgICAgICBhcmcgPSBhcmdbYXJnLmxlbmd0aCAtIDFdO1xuXHQgIH1cblx0XG5cdCAgYXNzZXJ0QXJnKGlzRnVuY3Rpb24oYXJnKSwgbmFtZSwgJ25vdCBhIGZ1bmN0aW9uLCBnb3QgJyArXG5cdCAgICAgIChhcmcgJiYgdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgPyBhcmcuY29uc3RydWN0b3IubmFtZSB8fCAnT2JqZWN0JyA6IHR5cGVvZiBhcmcpKTtcblx0ICByZXR1cm4gYXJnO1xuXHR9XG5cdFxuXHQvKipcblx0ICogdGhyb3cgZXJyb3IgaWYgdGhlIG5hbWUgZ2l2ZW4gaXMgaGFzT3duUHJvcGVydHlcblx0ICogQHBhcmFtICB7U3RyaW5nfSBuYW1lICAgIHRoZSBuYW1lIHRvIHRlc3Rcblx0ICogQHBhcmFtICB7U3RyaW5nfSBjb250ZXh0IHRoZSBjb250ZXh0IGluIHdoaWNoIHRoZSBuYW1lIGlzIHVzZWQsIHN1Y2ggYXMgbW9kdWxlIG9yIGRpcmVjdGl2ZVxuXHQgKi9cblx0ZnVuY3Rpb24gYXNzZXJ0Tm90SGFzT3duUHJvcGVydHkobmFtZSwgY29udGV4dCkge1xuXHQgIGlmIChuYW1lID09PSAnaGFzT3duUHJvcGVydHknKSB7XG5cdCAgICB0aHJvdyBuZ01pbkVycignYmFkbmFtZScsIFwiaGFzT3duUHJvcGVydHkgaXMgbm90IGEgdmFsaWQgezB9IG5hbWVcIiwgY29udGV4dCk7XG5cdCAgfVxuXHR9XG5cdFxuXHQvKipcblx0ICogUmV0dXJuIHRoZSB2YWx1ZSBhY2Nlc3NpYmxlIGZyb20gdGhlIG9iamVjdCBieSBwYXRoLiBBbnkgdW5kZWZpbmVkIHRyYXZlcnNhbHMgYXJlIGlnbm9yZWRcblx0ICogQHBhcmFtIHtPYmplY3R9IG9iaiBzdGFydGluZyBvYmplY3Rcblx0ICogQHBhcmFtIHtTdHJpbmd9IHBhdGggcGF0aCB0byB0cmF2ZXJzZVxuXHQgKiBAcGFyYW0ge2Jvb2xlYW59IFtiaW5kRm5Ub1Njb3BlPXRydWVdXG5cdCAqIEByZXR1cm5zIHtPYmplY3R9IHZhbHVlIGFzIGFjY2Vzc2libGUgYnkgcGF0aFxuXHQgKi9cblx0Ly9UT0RPKG1pc2tvKTogdGhpcyBmdW5jdGlvbiBuZWVkcyB0byBiZSByZW1vdmVkXG5cdGZ1bmN0aW9uIGdldHRlcihvYmosIHBhdGgsIGJpbmRGblRvU2NvcGUpIHtcblx0ICBpZiAoIXBhdGgpIHJldHVybiBvYmo7XG5cdCAgdmFyIGtleXMgPSBwYXRoLnNwbGl0KCcuJyk7XG5cdCAgdmFyIGtleTtcblx0ICB2YXIgbGFzdEluc3RhbmNlID0gb2JqO1xuXHQgIHZhciBsZW4gPSBrZXlzLmxlbmd0aDtcblx0XG5cdCAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuXHQgICAga2V5ID0ga2V5c1tpXTtcblx0ICAgIGlmIChvYmopIHtcblx0ICAgICAgb2JqID0gKGxhc3RJbnN0YW5jZSA9IG9iailba2V5XTtcblx0ICAgIH1cblx0ICB9XG5cdCAgaWYgKCFiaW5kRm5Ub1Njb3BlICYmIGlzRnVuY3Rpb24ob2JqKSkge1xuXHQgICAgcmV0dXJuIGJpbmQobGFzdEluc3RhbmNlLCBvYmopO1xuXHQgIH1cblx0ICByZXR1cm4gb2JqO1xuXHR9XG5cdFxuXHQvKipcblx0ICogUmV0dXJuIHRoZSBET00gc2libGluZ3MgYmV0d2VlbiB0aGUgZmlyc3QgYW5kIGxhc3Qgbm9kZSBpbiB0aGUgZ2l2ZW4gYXJyYXkuXG5cdCAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IGxpa2Ugb2JqZWN0XG5cdCAqIEByZXR1cm5zIHtBcnJheX0gdGhlIGlucHV0dGVkIG9iamVjdCBvciBhIGpxTGl0ZSBjb2xsZWN0aW9uIGNvbnRhaW5pbmcgdGhlIG5vZGVzXG5cdCAqL1xuXHRmdW5jdGlvbiBnZXRCbG9ja05vZGVzKG5vZGVzKSB7XG5cdCAgLy8gVE9ETyhwZXJmKTogdXBkYXRlIGBub2Rlc2AgaW5zdGVhZCBvZiBjcmVhdGluZyBhIG5ldyBvYmplY3Q/XG5cdCAgdmFyIG5vZGUgPSBub2Rlc1swXTtcblx0ICB2YXIgZW5kTm9kZSA9IG5vZGVzW25vZGVzLmxlbmd0aCAtIDFdO1xuXHQgIHZhciBibG9ja05vZGVzO1xuXHRcblx0ICBmb3IgKHZhciBpID0gMTsgbm9kZSAhPT0gZW5kTm9kZSAmJiAobm9kZSA9IG5vZGUubmV4dFNpYmxpbmcpOyBpKyspIHtcblx0ICAgIGlmIChibG9ja05vZGVzIHx8IG5vZGVzW2ldICE9PSBub2RlKSB7XG5cdCAgICAgIGlmICghYmxvY2tOb2Rlcykge1xuXHQgICAgICAgIGJsb2NrTm9kZXMgPSBqcUxpdGUoc2xpY2UuY2FsbChub2RlcywgMCwgaSkpO1xuXHQgICAgICB9XG5cdCAgICAgIGJsb2NrTm9kZXMucHVzaChub2RlKTtcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIHJldHVybiBibG9ja05vZGVzIHx8IG5vZGVzO1xuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIENyZWF0ZXMgYSBuZXcgb2JqZWN0IHdpdGhvdXQgYSBwcm90b3R5cGUuIFRoaXMgb2JqZWN0IGlzIHVzZWZ1bCBmb3IgbG9va3VwIHdpdGhvdXQgaGF2aW5nIHRvXG5cdCAqIGd1YXJkIGFnYWluc3QgcHJvdG90eXBpY2FsbHkgaW5oZXJpdGVkIHByb3BlcnRpZXMgdmlhIGhhc093blByb3BlcnR5LlxuXHQgKlxuXHQgKiBSZWxhdGVkIG1pY3JvLWJlbmNobWFya3M6XG5cdCAqIC0gaHR0cDovL2pzcGVyZi5jb20vb2JqZWN0LWNyZWF0ZTJcblx0ICogLSBodHRwOi8vanNwZXJmLmNvbS9wcm90by1tYXAtbG9va3VwLzJcblx0ICogLSBodHRwOi8vanNwZXJmLmNvbS9mb3ItaW4tdnMtb2JqZWN0LWtleXMyXG5cdCAqXG5cdCAqIEByZXR1cm5zIHtPYmplY3R9XG5cdCAqL1xuXHRmdW5jdGlvbiBjcmVhdGVNYXAoKSB7XG5cdCAgcmV0dXJuIE9iamVjdC5jcmVhdGUobnVsbCk7XG5cdH1cblx0XG5cdHZhciBOT0RFX1RZUEVfRUxFTUVOVCA9IDE7XG5cdHZhciBOT0RFX1RZUEVfQVRUUklCVVRFID0gMjtcblx0dmFyIE5PREVfVFlQRV9URVhUID0gMztcblx0dmFyIE5PREVfVFlQRV9DT01NRU5UID0gODtcblx0dmFyIE5PREVfVFlQRV9ET0NVTUVOVCA9IDk7XG5cdHZhciBOT0RFX1RZUEVfRE9DVU1FTlRfRlJBR01FTlQgPSAxMTtcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgdHlwZVxuXHQgKiBAbmFtZSBhbmd1bGFyLk1vZHVsZVxuXHQgKiBAbW9kdWxlIG5nXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKlxuXHQgKiBJbnRlcmZhY2UgZm9yIGNvbmZpZ3VyaW5nIGFuZ3VsYXIge0BsaW5rIGFuZ3VsYXIubW9kdWxlIG1vZHVsZXN9LlxuXHQgKi9cblx0XG5cdGZ1bmN0aW9uIHNldHVwTW9kdWxlTG9hZGVyKHdpbmRvdykge1xuXHRcblx0ICB2YXIgJGluamVjdG9yTWluRXJyID0gbWluRXJyKCckaW5qZWN0b3InKTtcblx0ICB2YXIgbmdNaW5FcnIgPSBtaW5FcnIoJ25nJyk7XG5cdFxuXHQgIGZ1bmN0aW9uIGVuc3VyZShvYmosIG5hbWUsIGZhY3RvcnkpIHtcblx0ICAgIHJldHVybiBvYmpbbmFtZV0gfHwgKG9ialtuYW1lXSA9IGZhY3RvcnkoKSk7XG5cdCAgfVxuXHRcblx0ICB2YXIgYW5ndWxhciA9IGVuc3VyZSh3aW5kb3csICdhbmd1bGFyJywgT2JqZWN0KTtcblx0XG5cdCAgLy8gV2UgbmVlZCB0byBleHBvc2UgYGFuZ3VsYXIuJCRtaW5FcnJgIHRvIG1vZHVsZXMgc3VjaCBhcyBgbmdSZXNvdXJjZWAgdGhhdCByZWZlcmVuY2UgaXQgZHVyaW5nIGJvb3RzdHJhcFxuXHQgIGFuZ3VsYXIuJCRtaW5FcnIgPSBhbmd1bGFyLiQkbWluRXJyIHx8IG1pbkVycjtcblx0XG5cdCAgcmV0dXJuIGVuc3VyZShhbmd1bGFyLCAnbW9kdWxlJywgZnVuY3Rpb24oKSB7XG5cdCAgICAvKiogQHR5cGUge09iamVjdC48c3RyaW5nLCBhbmd1bGFyLk1vZHVsZT59ICovXG5cdCAgICB2YXIgbW9kdWxlcyA9IHt9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIGZ1bmN0aW9uXG5cdCAgICAgKiBAbmFtZSBhbmd1bGFyLm1vZHVsZVxuXHQgICAgICogQG1vZHVsZSBuZ1xuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKlxuXHQgICAgICogVGhlIGBhbmd1bGFyLm1vZHVsZWAgaXMgYSBnbG9iYWwgcGxhY2UgZm9yIGNyZWF0aW5nLCByZWdpc3RlcmluZyBhbmQgcmV0cmlldmluZyBBbmd1bGFyXG5cdCAgICAgKiBtb2R1bGVzLlxuXHQgICAgICogQWxsIG1vZHVsZXMgKGFuZ3VsYXIgY29yZSBvciAzcmQgcGFydHkpIHRoYXQgc2hvdWxkIGJlIGF2YWlsYWJsZSB0byBhbiBhcHBsaWNhdGlvbiBtdXN0IGJlXG5cdCAgICAgKiByZWdpc3RlcmVkIHVzaW5nIHRoaXMgbWVjaGFuaXNtLlxuXHQgICAgICpcblx0ICAgICAqIFBhc3Npbmcgb25lIGFyZ3VtZW50IHJldHJpZXZlcyBhbiBleGlzdGluZyB7QGxpbmsgYW5ndWxhci5Nb2R1bGV9LFxuXHQgICAgICogd2hlcmVhcyBwYXNzaW5nIG1vcmUgdGhhbiBvbmUgYXJndW1lbnQgY3JlYXRlcyBhIG5ldyB7QGxpbmsgYW5ndWxhci5Nb2R1bGV9XG5cdCAgICAgKlxuXHQgICAgICpcblx0ICAgICAqICMgTW9kdWxlXG5cdCAgICAgKlxuXHQgICAgICogQSBtb2R1bGUgaXMgYSBjb2xsZWN0aW9uIG9mIHNlcnZpY2VzLCBkaXJlY3RpdmVzLCBjb250cm9sbGVycywgZmlsdGVycywgYW5kIGNvbmZpZ3VyYXRpb24gaW5mb3JtYXRpb24uXG5cdCAgICAgKiBgYW5ndWxhci5tb2R1bGVgIGlzIHVzZWQgdG8gY29uZmlndXJlIHRoZSB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfS5cblx0ICAgICAqXG5cdCAgICAgKiBgYGBqc1xuXHQgICAgICogLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZVxuXHQgICAgICogdmFyIG15TW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ215TW9kdWxlJywgW10pO1xuXHQgICAgICpcblx0ICAgICAqIC8vIHJlZ2lzdGVyIGEgbmV3IHNlcnZpY2Vcblx0ICAgICAqIG15TW9kdWxlLnZhbHVlKCdhcHBOYW1lJywgJ015Q29vbEFwcCcpO1xuXHQgICAgICpcblx0ICAgICAqIC8vIGNvbmZpZ3VyZSBleGlzdGluZyBzZXJ2aWNlcyBpbnNpZGUgaW5pdGlhbGl6YXRpb24gYmxvY2tzLlxuXHQgICAgICogbXlNb2R1bGUuY29uZmlnKFsnJGxvY2F0aW9uUHJvdmlkZXInLCBmdW5jdGlvbigkbG9jYXRpb25Qcm92aWRlcikge1xuXHQgICAgICogICAvLyBDb25maWd1cmUgZXhpc3RpbmcgcHJvdmlkZXJzXG5cdCAgICAgKiAgICRsb2NhdGlvblByb3ZpZGVyLmhhc2hQcmVmaXgoJyEnKTtcblx0ICAgICAqIH1dKTtcblx0ICAgICAqIGBgYFxuXHQgICAgICpcblx0ICAgICAqIFRoZW4geW91IGNhbiBjcmVhdGUgYW4gaW5qZWN0b3IgYW5kIGxvYWQgeW91ciBtb2R1bGVzIGxpa2UgdGhpczpcblx0ICAgICAqXG5cdCAgICAgKiBgYGBqc1xuXHQgICAgICogdmFyIGluamVjdG9yID0gYW5ndWxhci5pbmplY3RvcihbJ25nJywgJ215TW9kdWxlJ10pXG5cdCAgICAgKiBgYGBcblx0ICAgICAqXG5cdCAgICAgKiBIb3dldmVyIGl0J3MgbW9yZSBsaWtlbHkgdGhhdCB5b3UnbGwganVzdCB1c2Vcblx0ICAgICAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdBcHAgbmdBcHB9IG9yXG5cdCAgICAgKiB7QGxpbmsgYW5ndWxhci5ib290c3RyYXB9IHRvIHNpbXBsaWZ5IHRoaXMgcHJvY2VzcyBmb3IgeW91LlxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7IXN0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgbW9kdWxlIHRvIGNyZWF0ZSBvciByZXRyaWV2ZS5cblx0ICAgICAqIEBwYXJhbSB7IUFycmF5LjxzdHJpbmc+PX0gcmVxdWlyZXMgSWYgc3BlY2lmaWVkIHRoZW4gbmV3IG1vZHVsZSBpcyBiZWluZyBjcmVhdGVkLiBJZlxuXHQgICAgICogICAgICAgIHVuc3BlY2lmaWVkIHRoZW4gdGhlIG1vZHVsZSBpcyBiZWluZyByZXRyaWV2ZWQgZm9yIGZ1cnRoZXIgY29uZmlndXJhdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7RnVuY3Rpb249fSBjb25maWdGbiBPcHRpb25hbCBjb25maWd1cmF0aW9uIGZ1bmN0aW9uIGZvciB0aGUgbW9kdWxlLiBTYW1lIGFzXG5cdCAgICAgKiAgICAgICAge0BsaW5rIGFuZ3VsYXIuTW9kdWxlI2NvbmZpZyBNb2R1bGUjY29uZmlnKCl9LlxuXHQgICAgICogQHJldHVybnMge2FuZ3VsYXIuTW9kdWxlfSBuZXcgbW9kdWxlIHdpdGggdGhlIHtAbGluayBhbmd1bGFyLk1vZHVsZX0gYXBpLlxuXHQgICAgICovXG5cdCAgICByZXR1cm4gZnVuY3Rpb24gbW9kdWxlKG5hbWUsIHJlcXVpcmVzLCBjb25maWdGbikge1xuXHQgICAgICB2YXIgYXNzZXJ0Tm90SGFzT3duUHJvcGVydHkgPSBmdW5jdGlvbihuYW1lLCBjb250ZXh0KSB7XG5cdCAgICAgICAgaWYgKG5hbWUgPT09ICdoYXNPd25Qcm9wZXJ0eScpIHtcblx0ICAgICAgICAgIHRocm93IG5nTWluRXJyKCdiYWRuYW1lJywgJ2hhc093blByb3BlcnR5IGlzIG5vdCBhIHZhbGlkIHswfSBuYW1lJywgY29udGV4dCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHRcblx0ICAgICAgYXNzZXJ0Tm90SGFzT3duUHJvcGVydHkobmFtZSwgJ21vZHVsZScpO1xuXHQgICAgICBpZiAocmVxdWlyZXMgJiYgbW9kdWxlcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuXHQgICAgICAgIG1vZHVsZXNbbmFtZV0gPSBudWxsO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBlbnN1cmUobW9kdWxlcywgbmFtZSwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKCFyZXF1aXJlcykge1xuXHQgICAgICAgICAgdGhyb3cgJGluamVjdG9yTWluRXJyKCdub21vZCcsIFwiTW9kdWxlICd7MH0nIGlzIG5vdCBhdmFpbGFibGUhIFlvdSBlaXRoZXIgbWlzc3BlbGxlZCBcIiArXG5cdCAgICAgICAgICAgICBcInRoZSBtb2R1bGUgbmFtZSBvciBmb3Jnb3QgdG8gbG9hZCBpdC4gSWYgcmVnaXN0ZXJpbmcgYSBtb2R1bGUgZW5zdXJlIHRoYXQgeW91IFwiICtcblx0ICAgICAgICAgICAgIFwic3BlY2lmeSB0aGUgZGVwZW5kZW5jaWVzIGFzIHRoZSBzZWNvbmQgYXJndW1lbnQuXCIsIG5hbWUpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqIEB0eXBlIHshQXJyYXkuPEFycmF5LjwqPj59ICovXG5cdCAgICAgICAgdmFyIGludm9rZVF1ZXVlID0gW107XG5cdFxuXHQgICAgICAgIC8qKiBAdHlwZSB7IUFycmF5LjxGdW5jdGlvbj59ICovXG5cdCAgICAgICAgdmFyIGNvbmZpZ0Jsb2NrcyA9IFtdO1xuXHRcblx0ICAgICAgICAvKiogQHR5cGUgeyFBcnJheS48RnVuY3Rpb24+fSAqL1xuXHQgICAgICAgIHZhciBydW5CbG9ja3MgPSBbXTtcblx0XG5cdCAgICAgICAgdmFyIGNvbmZpZyA9IGludm9rZUxhdGVyKCckaW5qZWN0b3InLCAnaW52b2tlJywgJ3B1c2gnLCBjb25maWdCbG9ja3MpO1xuXHRcblx0ICAgICAgICAvKiogQHR5cGUge2FuZ3VsYXIuTW9kdWxlfSAqL1xuXHQgICAgICAgIHZhciBtb2R1bGVJbnN0YW5jZSA9IHtcblx0ICAgICAgICAgIC8vIFByaXZhdGUgc3RhdGVcblx0ICAgICAgICAgIF9pbnZva2VRdWV1ZTogaW52b2tlUXVldWUsXG5cdCAgICAgICAgICBfY29uZmlnQmxvY2tzOiBjb25maWdCbG9ja3MsXG5cdCAgICAgICAgICBfcnVuQmxvY2tzOiBydW5CbG9ja3MsXG5cdFxuXHQgICAgICAgICAgLyoqXG5cdCAgICAgICAgICAgKiBAbmdkb2MgcHJvcGVydHlcblx0ICAgICAgICAgICAqIEBuYW1lIGFuZ3VsYXIuTW9kdWxlI3JlcXVpcmVzXG5cdCAgICAgICAgICAgKiBAbW9kdWxlIG5nXG5cdCAgICAgICAgICAgKlxuXHQgICAgICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAgICAgKiBIb2xkcyB0aGUgbGlzdCBvZiBtb2R1bGVzIHdoaWNoIHRoZSBpbmplY3RvciB3aWxsIGxvYWQgYmVmb3JlIHRoZSBjdXJyZW50IG1vZHVsZSBpc1xuXHQgICAgICAgICAgICogbG9hZGVkLlxuXHQgICAgICAgICAgICovXG5cdCAgICAgICAgICByZXF1aXJlczogcmVxdWlyZXMsXG5cdFxuXHQgICAgICAgICAgLyoqXG5cdCAgICAgICAgICAgKiBAbmdkb2MgcHJvcGVydHlcblx0ICAgICAgICAgICAqIEBuYW1lIGFuZ3VsYXIuTW9kdWxlI25hbWVcblx0ICAgICAgICAgICAqIEBtb2R1bGUgbmdcblx0ICAgICAgICAgICAqXG5cdCAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICAgICAqIE5hbWUgb2YgdGhlIG1vZHVsZS5cblx0ICAgICAgICAgICAqL1xuXHQgICAgICAgICAgbmFtZTogbmFtZSxcblx0XG5cdFxuXHQgICAgICAgICAgLyoqXG5cdCAgICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAgICAgKiBAbmFtZSBhbmd1bGFyLk1vZHVsZSNwcm92aWRlclxuXHQgICAgICAgICAgICogQG1vZHVsZSBuZ1xuXHQgICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgc2VydmljZSBuYW1lXG5cdCAgICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcm92aWRlclR5cGUgQ29uc3RydWN0aW9uIGZ1bmN0aW9uIGZvciBjcmVhdGluZyBuZXcgaW5zdGFuY2Ugb2YgdGhlXG5cdCAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZS5cblx0ICAgICAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgICAgICogU2VlIHtAbGluayBhdXRvLiRwcm92aWRlI3Byb3ZpZGVyICRwcm92aWRlLnByb3ZpZGVyKCl9LlxuXHQgICAgICAgICAgICovXG5cdCAgICAgICAgICBwcm92aWRlcjogaW52b2tlTGF0ZXJBbmRTZXRNb2R1bGVOYW1lKCckcHJvdmlkZScsICdwcm92aWRlcicpLFxuXHRcblx0ICAgICAgICAgIC8qKlxuXHQgICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjZmFjdG9yeVxuXHQgICAgICAgICAgICogQG1vZHVsZSBuZ1xuXHQgICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgc2VydmljZSBuYW1lXG5cdCAgICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcm92aWRlckZ1bmN0aW9uIEZ1bmN0aW9uIGZvciBjcmVhdGluZyBuZXcgaW5zdGFuY2Ugb2YgdGhlIHNlcnZpY2UuXG5cdCAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICAgICAqIFNlZSB7QGxpbmsgYXV0by4kcHJvdmlkZSNmYWN0b3J5ICRwcm92aWRlLmZhY3RvcnkoKX0uXG5cdCAgICAgICAgICAgKi9cblx0ICAgICAgICAgIGZhY3Rvcnk6IGludm9rZUxhdGVyQW5kU2V0TW9kdWxlTmFtZSgnJHByb3ZpZGUnLCAnZmFjdG9yeScpLFxuXHRcblx0ICAgICAgICAgIC8qKlxuXHQgICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjc2VydmljZVxuXHQgICAgICAgICAgICogQG1vZHVsZSBuZ1xuXHQgICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgc2VydmljZSBuYW1lXG5cdCAgICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjb25zdHJ1Y3RvciBBIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBpbnN0YW50aWF0ZWQuXG5cdCAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICAgICAqIFNlZSB7QGxpbmsgYXV0by4kcHJvdmlkZSNzZXJ2aWNlICRwcm92aWRlLnNlcnZpY2UoKX0uXG5cdCAgICAgICAgICAgKi9cblx0ICAgICAgICAgIHNlcnZpY2U6IGludm9rZUxhdGVyQW5kU2V0TW9kdWxlTmFtZSgnJHByb3ZpZGUnLCAnc2VydmljZScpLFxuXHRcblx0ICAgICAgICAgIC8qKlxuXHQgICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjdmFsdWVcblx0ICAgICAgICAgICAqIEBtb2R1bGUgbmdcblx0ICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIHNlcnZpY2UgbmFtZVxuXHQgICAgICAgICAgICogQHBhcmFtIHsqfSBvYmplY3QgU2VydmljZSBpbnN0YW5jZSBvYmplY3QuXG5cdCAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICAgICAqIFNlZSB7QGxpbmsgYXV0by4kcHJvdmlkZSN2YWx1ZSAkcHJvdmlkZS52YWx1ZSgpfS5cblx0ICAgICAgICAgICAqL1xuXHQgICAgICAgICAgdmFsdWU6IGludm9rZUxhdGVyKCckcHJvdmlkZScsICd2YWx1ZScpLFxuXHRcblx0ICAgICAgICAgIC8qKlxuXHQgICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjY29uc3RhbnRcblx0ICAgICAgICAgICAqIEBtb2R1bGUgbmdcblx0ICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIGNvbnN0YW50IG5hbWVcblx0ICAgICAgICAgICAqIEBwYXJhbSB7Kn0gb2JqZWN0IENvbnN0YW50IHZhbHVlLlxuXHQgICAgICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAgICAgKiBCZWNhdXNlIHRoZSBjb25zdGFudHMgYXJlIGZpeGVkLCB0aGV5IGdldCBhcHBsaWVkIGJlZm9yZSBvdGhlciBwcm92aWRlIG1ldGhvZHMuXG5cdCAgICAgICAgICAgKiBTZWUge0BsaW5rIGF1dG8uJHByb3ZpZGUjY29uc3RhbnQgJHByb3ZpZGUuY29uc3RhbnQoKX0uXG5cdCAgICAgICAgICAgKi9cblx0ICAgICAgICAgIGNvbnN0YW50OiBpbnZva2VMYXRlcignJHByb3ZpZGUnLCAnY29uc3RhbnQnLCAndW5zaGlmdCcpLFxuXHRcblx0ICAgICAgICAgICAvKipcblx0ICAgICAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICAgICAqIEBuYW1lIGFuZ3VsYXIuTW9kdWxlI2RlY29yYXRvclxuXHQgICAgICAgICAgICogQG1vZHVsZSBuZ1xuXHQgICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IFRoZSBuYW1lIG9mIHRoZSBzZXJ2aWNlIHRvIGRlY29yYXRlLlxuXHQgICAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gVGhpcyBmdW5jdGlvbiB3aWxsIGJlIGludm9rZWQgd2hlbiB0aGUgc2VydmljZSBuZWVkcyB0byBiZVxuXHQgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZWQgYW5kIHNob3VsZCByZXR1cm4gdGhlIGRlY29yYXRlZCBzZXJ2aWNlIGluc3RhbmNlLlxuXHQgICAgICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAgICAgKiBTZWUge0BsaW5rIGF1dG8uJHByb3ZpZGUjZGVjb3JhdG9yICRwcm92aWRlLmRlY29yYXRvcigpfS5cblx0ICAgICAgICAgICAqL1xuXHQgICAgICAgICAgZGVjb3JhdG9yOiBpbnZva2VMYXRlckFuZFNldE1vZHVsZU5hbWUoJyRwcm92aWRlJywgJ2RlY29yYXRvcicpLFxuXHRcblx0ICAgICAgICAgIC8qKlxuXHQgICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjYW5pbWF0aW9uXG5cdCAgICAgICAgICAgKiBAbW9kdWxlIG5nXG5cdCAgICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBhbmltYXRpb24gbmFtZVxuXHQgICAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gYW5pbWF0aW9uRmFjdG9yeSBGYWN0b3J5IGZ1bmN0aW9uIGZvciBjcmVhdGluZyBuZXcgaW5zdGFuY2Ugb2YgYW5cblx0ICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLlxuXHQgICAgICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAgICAgKlxuXHQgICAgICAgICAgICogKipOT1RFKio6IGFuaW1hdGlvbnMgdGFrZSBlZmZlY3Qgb25seSBpZiB0aGUgKipuZ0FuaW1hdGUqKiBtb2R1bGUgaXMgbG9hZGVkLlxuXHQgICAgICAgICAgICpcblx0ICAgICAgICAgICAqXG5cdCAgICAgICAgICAgKiBEZWZpbmVzIGFuIGFuaW1hdGlvbiBob29rIHRoYXQgY2FuIGJlIGxhdGVyIHVzZWQgd2l0aFxuXHQgICAgICAgICAgICoge0BsaW5rICRhbmltYXRlICRhbmltYXRlfSBzZXJ2aWNlIGFuZCBkaXJlY3RpdmVzIHRoYXQgdXNlIHRoaXMgc2VydmljZS5cblx0ICAgICAgICAgICAqXG5cdCAgICAgICAgICAgKiBgYGBqc1xuXHQgICAgICAgICAgICogbW9kdWxlLmFuaW1hdGlvbignLmFuaW1hdGlvbi1uYW1lJywgZnVuY3Rpb24oJGluamVjdDEsICRpbmplY3QyKSB7XG5cdCAgICAgICAgICAgKiAgIHJldHVybiB7XG5cdCAgICAgICAgICAgKiAgICAgZXZlbnROYW1lIDogZnVuY3Rpb24oZWxlbWVudCwgZG9uZSkge1xuXHQgICAgICAgICAgICogICAgICAgLy9jb2RlIHRvIHJ1biB0aGUgYW5pbWF0aW9uXG5cdCAgICAgICAgICAgKiAgICAgICAvL29uY2UgY29tcGxldGUsIHRoZW4gcnVuIGRvbmUoKVxuXHQgICAgICAgICAgICogICAgICAgcmV0dXJuIGZ1bmN0aW9uIGNhbmNlbGxhdGlvbkZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0ICAgICAgICAgICAqICAgICAgICAgLy9jb2RlIHRvIGNhbmNlbCB0aGUgYW5pbWF0aW9uXG5cdCAgICAgICAgICAgKiAgICAgICB9XG5cdCAgICAgICAgICAgKiAgICAgfVxuXHQgICAgICAgICAgICogICB9XG5cdCAgICAgICAgICAgKiB9KVxuXHQgICAgICAgICAgICogYGBgXG5cdCAgICAgICAgICAgKlxuXHQgICAgICAgICAgICogU2VlIHtAbGluayBuZy4kYW5pbWF0ZVByb3ZpZGVyI3JlZ2lzdGVyICRhbmltYXRlUHJvdmlkZXIucmVnaXN0ZXIoKX0gYW5kXG5cdCAgICAgICAgICAgKiB7QGxpbmsgbmdBbmltYXRlIG5nQW5pbWF0ZSBtb2R1bGV9IGZvciBtb3JlIGluZm9ybWF0aW9uLlxuXHQgICAgICAgICAgICovXG5cdCAgICAgICAgICBhbmltYXRpb246IGludm9rZUxhdGVyQW5kU2V0TW9kdWxlTmFtZSgnJGFuaW1hdGVQcm92aWRlcicsICdyZWdpc3RlcicpLFxuXHRcblx0ICAgICAgICAgIC8qKlxuXHQgICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjZmlsdGVyXG5cdCAgICAgICAgICAgKiBAbW9kdWxlIG5nXG5cdCAgICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBGaWx0ZXIgbmFtZSAtIHRoaXMgbXVzdCBiZSBhIHZhbGlkIGFuZ3VsYXIgZXhwcmVzc2lvbiBpZGVudGlmaWVyXG5cdCAgICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmaWx0ZXJGYWN0b3J5IEZhY3RvcnkgZnVuY3Rpb24gZm9yIGNyZWF0aW5nIG5ldyBpbnN0YW5jZSBvZiBmaWx0ZXIuXG5cdCAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICAgICAqIFNlZSB7QGxpbmsgbmcuJGZpbHRlclByb3ZpZGVyI3JlZ2lzdGVyICRmaWx0ZXJQcm92aWRlci5yZWdpc3RlcigpfS5cblx0ICAgICAgICAgICAqXG5cdCAgICAgICAgICAgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuXHQgICAgICAgICAgICogKipOb3RlOioqIEZpbHRlciBuYW1lcyBtdXN0IGJlIHZhbGlkIGFuZ3VsYXIge0BsaW5rIGV4cHJlc3Npb259IGlkZW50aWZpZXJzLCBzdWNoIGFzIGB1cHBlcmNhc2VgIG9yIGBvcmRlckJ5YC5cblx0ICAgICAgICAgICAqIE5hbWVzIHdpdGggc3BlY2lhbCBjaGFyYWN0ZXJzLCBzdWNoIGFzIGh5cGhlbnMgYW5kIGRvdHMsIGFyZSBub3QgYWxsb3dlZC4gSWYgeW91IHdpc2ggdG8gbmFtZXNwYWNlXG5cdCAgICAgICAgICAgKiB5b3VyIGZpbHRlcnMsIHRoZW4geW91IGNhbiB1c2UgY2FwaXRhbGl6YXRpb24gKGBteWFwcFN1YnNlY3Rpb25GaWx0ZXJ4YCkgb3IgdW5kZXJzY29yZXNcblx0ICAgICAgICAgICAqIChgbXlhcHBfc3Vic2VjdGlvbl9maWx0ZXJ4YCkuXG5cdCAgICAgICAgICAgKiA8L2Rpdj5cblx0ICAgICAgICAgICAqL1xuXHQgICAgICAgICAgZmlsdGVyOiBpbnZva2VMYXRlckFuZFNldE1vZHVsZU5hbWUoJyRmaWx0ZXJQcm92aWRlcicsICdyZWdpc3RlcicpLFxuXHRcblx0ICAgICAgICAgIC8qKlxuXHQgICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjY29udHJvbGxlclxuXHQgICAgICAgICAgICogQG1vZHVsZSBuZ1xuXHQgICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd8T2JqZWN0fSBuYW1lIENvbnRyb2xsZXIgbmFtZSwgb3IgYW4gb2JqZWN0IG1hcCBvZiBjb250cm9sbGVycyB3aGVyZSB0aGVcblx0ICAgICAgICAgICAqICAgIGtleXMgYXJlIHRoZSBuYW1lcyBhbmQgdGhlIHZhbHVlcyBhcmUgdGhlIGNvbnN0cnVjdG9ycy5cblx0ICAgICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNvbnN0cnVjdG9yIENvbnRyb2xsZXIgY29uc3RydWN0b3IgZnVuY3Rpb24uXG5cdCAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICAgICAqIFNlZSB7QGxpbmsgbmcuJGNvbnRyb2xsZXJQcm92aWRlciNyZWdpc3RlciAkY29udHJvbGxlclByb3ZpZGVyLnJlZ2lzdGVyKCl9LlxuXHQgICAgICAgICAgICovXG5cdCAgICAgICAgICBjb250cm9sbGVyOiBpbnZva2VMYXRlckFuZFNldE1vZHVsZU5hbWUoJyRjb250cm9sbGVyUHJvdmlkZXInLCAncmVnaXN0ZXInKSxcblx0XG5cdCAgICAgICAgICAvKipcblx0ICAgICAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICAgICAqIEBuYW1lIGFuZ3VsYXIuTW9kdWxlI2RpcmVjdGl2ZVxuXHQgICAgICAgICAgICogQG1vZHVsZSBuZ1xuXHQgICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd8T2JqZWN0fSBuYW1lIERpcmVjdGl2ZSBuYW1lLCBvciBhbiBvYmplY3QgbWFwIG9mIGRpcmVjdGl2ZXMgd2hlcmUgdGhlXG5cdCAgICAgICAgICAgKiAgICBrZXlzIGFyZSB0aGUgbmFtZXMgYW5kIHRoZSB2YWx1ZXMgYXJlIHRoZSBmYWN0b3JpZXMuXG5cdCAgICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBkaXJlY3RpdmVGYWN0b3J5IEZhY3RvcnkgZnVuY3Rpb24gZm9yIGNyZWF0aW5nIG5ldyBpbnN0YW5jZSBvZlxuXHQgICAgICAgICAgICogZGlyZWN0aXZlcy5cblx0ICAgICAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgICAgICogU2VlIHtAbGluayBuZy4kY29tcGlsZVByb3ZpZGVyI2RpcmVjdGl2ZSAkY29tcGlsZVByb3ZpZGVyLmRpcmVjdGl2ZSgpfS5cblx0ICAgICAgICAgICAqL1xuXHQgICAgICAgICAgZGlyZWN0aXZlOiBpbnZva2VMYXRlckFuZFNldE1vZHVsZU5hbWUoJyRjb21waWxlUHJvdmlkZXInLCAnZGlyZWN0aXZlJyksXG5cdFxuXHQgICAgICAgICAgLyoqXG5cdCAgICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAgICAgKiBAbmFtZSBhbmd1bGFyLk1vZHVsZSNjb21wb25lbnRcblx0ICAgICAgICAgICAqIEBtb2R1bGUgbmdcblx0ICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIE5hbWUgb2YgdGhlIGNvbXBvbmVudCBpbiBjYW1lbC1jYXNlIChpLmUuIG15Q29tcCB3aGljaCB3aWxsIG1hdGNoIGFzIG15LWNvbXApXG5cdCAgICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBDb21wb25lbnQgZGVmaW5pdGlvbiBvYmplY3QgKGEgc2ltcGxpZmllZFxuXHQgICAgICAgICAgICogICAge0BsaW5rIG5nLiRjb21waWxlI2RpcmVjdGl2ZS1kZWZpbml0aW9uLW9iamVjdCBkaXJlY3RpdmUgZGVmaW5pdGlvbiBvYmplY3R9KVxuXHQgICAgICAgICAgICpcblx0ICAgICAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgICAgICogU2VlIHtAbGluayBuZy4kY29tcGlsZVByb3ZpZGVyI2NvbXBvbmVudCAkY29tcGlsZVByb3ZpZGVyLmNvbXBvbmVudCgpfS5cblx0ICAgICAgICAgICAqL1xuXHQgICAgICAgICAgY29tcG9uZW50OiBpbnZva2VMYXRlckFuZFNldE1vZHVsZU5hbWUoJyRjb21waWxlUHJvdmlkZXInLCAnY29tcG9uZW50JyksXG5cdFxuXHQgICAgICAgICAgLyoqXG5cdCAgICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAgICAgKiBAbmFtZSBhbmd1bGFyLk1vZHVsZSNjb25maWdcblx0ICAgICAgICAgICAqIEBtb2R1bGUgbmdcblx0ICAgICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNvbmZpZ0ZuIEV4ZWN1dGUgdGhpcyBmdW5jdGlvbiBvbiBtb2R1bGUgbG9hZC4gVXNlZnVsIGZvciBzZXJ2aWNlXG5cdCAgICAgICAgICAgKiAgICBjb25maWd1cmF0aW9uLlxuXHQgICAgICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAgICAgKiBVc2UgdGhpcyBtZXRob2QgdG8gcmVnaXN0ZXIgd29yayB3aGljaCBuZWVkcyB0byBiZSBwZXJmb3JtZWQgb24gbW9kdWxlIGxvYWRpbmcuXG5cdCAgICAgICAgICAgKiBGb3IgbW9yZSBhYm91dCBob3cgdG8gY29uZmlndXJlIHNlcnZpY2VzLCBzZWVcblx0ICAgICAgICAgICAqIHtAbGluayBwcm92aWRlcnMjcHJvdmlkZXItcmVjaXBlIFByb3ZpZGVyIFJlY2lwZX0uXG5cdCAgICAgICAgICAgKi9cblx0ICAgICAgICAgIGNvbmZpZzogY29uZmlnLFxuXHRcblx0ICAgICAgICAgIC8qKlxuXHQgICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjcnVuXG5cdCAgICAgICAgICAgKiBAbW9kdWxlIG5nXG5cdCAgICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpbml0aWFsaXphdGlvbkZuIEV4ZWN1dGUgdGhpcyBmdW5jdGlvbiBhZnRlciBpbmplY3RvciBjcmVhdGlvbi5cblx0ICAgICAgICAgICAqICAgIFVzZWZ1bCBmb3IgYXBwbGljYXRpb24gaW5pdGlhbGl6YXRpb24uXG5cdCAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICAgICAqIFVzZSB0aGlzIG1ldGhvZCB0byByZWdpc3RlciB3b3JrIHdoaWNoIHNob3VsZCBiZSBwZXJmb3JtZWQgd2hlbiB0aGUgaW5qZWN0b3IgaXMgZG9uZVxuXHQgICAgICAgICAgICogbG9hZGluZyBhbGwgbW9kdWxlcy5cblx0ICAgICAgICAgICAqL1xuXHQgICAgICAgICAgcnVuOiBmdW5jdGlvbihibG9jaykge1xuXHQgICAgICAgICAgICBydW5CbG9ja3MucHVzaChibG9jayk7XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH07XG5cdFxuXHQgICAgICAgIGlmIChjb25maWdGbikge1xuXHQgICAgICAgICAgY29uZmlnKGNvbmZpZ0ZuKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiBtb2R1bGVJbnN0YW5jZTtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHByb3ZpZGVyXG5cdCAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG1ldGhvZFxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nPX0gaW5zZXJ0TWV0aG9kXG5cdCAgICAgICAgICogQHJldHVybnMge2FuZ3VsYXIuTW9kdWxlfVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIGZ1bmN0aW9uIGludm9rZUxhdGVyKHByb3ZpZGVyLCBtZXRob2QsIGluc2VydE1ldGhvZCwgcXVldWUpIHtcblx0ICAgICAgICAgIGlmICghcXVldWUpIHF1ZXVlID0gaW52b2tlUXVldWU7XG5cdCAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIHF1ZXVlW2luc2VydE1ldGhvZCB8fCAncHVzaCddKFtwcm92aWRlciwgbWV0aG9kLCBhcmd1bWVudHNdKTtcblx0ICAgICAgICAgICAgcmV0dXJuIG1vZHVsZUluc3RhbmNlO1xuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwcm92aWRlclxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtZXRob2Rcblx0ICAgICAgICAgKiBAcmV0dXJucyB7YW5ndWxhci5Nb2R1bGV9XG5cdCAgICAgICAgICovXG5cdCAgICAgICAgZnVuY3Rpb24gaW52b2tlTGF0ZXJBbmRTZXRNb2R1bGVOYW1lKHByb3ZpZGVyLCBtZXRob2QpIHtcblx0ICAgICAgICAgIHJldHVybiBmdW5jdGlvbihyZWNpcGVOYW1lLCBmYWN0b3J5RnVuY3Rpb24pIHtcblx0ICAgICAgICAgICAgaWYgKGZhY3RvcnlGdW5jdGlvbiAmJiBpc0Z1bmN0aW9uKGZhY3RvcnlGdW5jdGlvbikpIGZhY3RvcnlGdW5jdGlvbi4kJG1vZHVsZU5hbWUgPSBuYW1lO1xuXHQgICAgICAgICAgICBpbnZva2VRdWV1ZS5wdXNoKFtwcm92aWRlciwgbWV0aG9kLCBhcmd1bWVudHNdKTtcblx0ICAgICAgICAgICAgcmV0dXJuIG1vZHVsZUluc3RhbmNlO1xuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHQgICAgfTtcblx0ICB9KTtcblx0XG5cdH1cblx0XG5cdC8qIGdsb2JhbDogdG9EZWJ1Z1N0cmluZzogdHJ1ZSAqL1xuXHRcblx0ZnVuY3Rpb24gc2VyaWFsaXplT2JqZWN0KG9iaikge1xuXHQgIHZhciBzZWVuID0gW107XG5cdFxuXHQgIHJldHVybiBKU09OLnN0cmluZ2lmeShvYmosIGZ1bmN0aW9uKGtleSwgdmFsKSB7XG5cdCAgICB2YWwgPSB0b0pzb25SZXBsYWNlcihrZXksIHZhbCk7XG5cdCAgICBpZiAoaXNPYmplY3QodmFsKSkge1xuXHRcblx0ICAgICAgaWYgKHNlZW4uaW5kZXhPZih2YWwpID49IDApIHJldHVybiAnLi4uJztcblx0XG5cdCAgICAgIHNlZW4ucHVzaCh2YWwpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIHZhbDtcblx0ICB9KTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gdG9EZWJ1Z1N0cmluZyhvYmopIHtcblx0ICBpZiAodHlwZW9mIG9iaiA9PT0gJ2Z1bmN0aW9uJykge1xuXHQgICAgcmV0dXJuIG9iai50b1N0cmluZygpLnJlcGxhY2UoLyBcXHtbXFxzXFxTXSokLywgJycpO1xuXHQgIH0gZWxzZSBpZiAoaXNVbmRlZmluZWQob2JqKSkge1xuXHQgICAgcmV0dXJuICd1bmRlZmluZWQnO1xuXHQgIH0gZWxzZSBpZiAodHlwZW9mIG9iaiAhPT0gJ3N0cmluZycpIHtcblx0ICAgIHJldHVybiBzZXJpYWxpemVPYmplY3Qob2JqKTtcblx0ICB9XG5cdCAgcmV0dXJuIG9iajtcblx0fVxuXHRcblx0LyogZ2xvYmFsIGFuZ3VsYXJNb2R1bGU6IHRydWUsXG5cdCAgdmVyc2lvbjogdHJ1ZSxcblx0XG5cdCAgJENvbXBpbGVQcm92aWRlcixcblx0XG5cdCAgaHRtbEFuY2hvckRpcmVjdGl2ZSxcblx0ICBpbnB1dERpcmVjdGl2ZSxcblx0ICBpbnB1dERpcmVjdGl2ZSxcblx0ICBmb3JtRGlyZWN0aXZlLFxuXHQgIHNjcmlwdERpcmVjdGl2ZSxcblx0ICBzZWxlY3REaXJlY3RpdmUsXG5cdCAgc3R5bGVEaXJlY3RpdmUsXG5cdCAgb3B0aW9uRGlyZWN0aXZlLFxuXHQgIG5nQmluZERpcmVjdGl2ZSxcblx0ICBuZ0JpbmRIdG1sRGlyZWN0aXZlLFxuXHQgIG5nQmluZFRlbXBsYXRlRGlyZWN0aXZlLFxuXHQgIG5nQ2xhc3NEaXJlY3RpdmUsXG5cdCAgbmdDbGFzc0V2ZW5EaXJlY3RpdmUsXG5cdCAgbmdDbGFzc09kZERpcmVjdGl2ZSxcblx0ICBuZ0Nsb2FrRGlyZWN0aXZlLFxuXHQgIG5nQ29udHJvbGxlckRpcmVjdGl2ZSxcblx0ICBuZ0Zvcm1EaXJlY3RpdmUsXG5cdCAgbmdIaWRlRGlyZWN0aXZlLFxuXHQgIG5nSWZEaXJlY3RpdmUsXG5cdCAgbmdJbmNsdWRlRGlyZWN0aXZlLFxuXHQgIG5nSW5jbHVkZUZpbGxDb250ZW50RGlyZWN0aXZlLFxuXHQgIG5nSW5pdERpcmVjdGl2ZSxcblx0ICBuZ05vbkJpbmRhYmxlRGlyZWN0aXZlLFxuXHQgIG5nUGx1cmFsaXplRGlyZWN0aXZlLFxuXHQgIG5nUmVwZWF0RGlyZWN0aXZlLFxuXHQgIG5nU2hvd0RpcmVjdGl2ZSxcblx0ICBuZ1N0eWxlRGlyZWN0aXZlLFxuXHQgIG5nU3dpdGNoRGlyZWN0aXZlLFxuXHQgIG5nU3dpdGNoV2hlbkRpcmVjdGl2ZSxcblx0ICBuZ1N3aXRjaERlZmF1bHREaXJlY3RpdmUsXG5cdCAgbmdPcHRpb25zRGlyZWN0aXZlLFxuXHQgIG5nVHJhbnNjbHVkZURpcmVjdGl2ZSxcblx0ICBuZ01vZGVsRGlyZWN0aXZlLFxuXHQgIG5nTGlzdERpcmVjdGl2ZSxcblx0ICBuZ0NoYW5nZURpcmVjdGl2ZSxcblx0ICBwYXR0ZXJuRGlyZWN0aXZlLFxuXHQgIHBhdHRlcm5EaXJlY3RpdmUsXG5cdCAgcmVxdWlyZWREaXJlY3RpdmUsXG5cdCAgcmVxdWlyZWREaXJlY3RpdmUsXG5cdCAgbWlubGVuZ3RoRGlyZWN0aXZlLFxuXHQgIG1pbmxlbmd0aERpcmVjdGl2ZSxcblx0ICBtYXhsZW5ndGhEaXJlY3RpdmUsXG5cdCAgbWF4bGVuZ3RoRGlyZWN0aXZlLFxuXHQgIG5nVmFsdWVEaXJlY3RpdmUsXG5cdCAgbmdNb2RlbE9wdGlvbnNEaXJlY3RpdmUsXG5cdCAgbmdBdHRyaWJ1dGVBbGlhc0RpcmVjdGl2ZXMsXG5cdCAgbmdFdmVudERpcmVjdGl2ZXMsXG5cdFxuXHQgICRBbmNob3JTY3JvbGxQcm92aWRlcixcblx0ICAkQW5pbWF0ZVByb3ZpZGVyLFxuXHQgICRDb3JlQW5pbWF0ZUNzc1Byb3ZpZGVyLFxuXHQgICQkQ29yZUFuaW1hdGVKc1Byb3ZpZGVyLFxuXHQgICQkQ29yZUFuaW1hdGVRdWV1ZVByb3ZpZGVyLFxuXHQgICQkQW5pbWF0ZVJ1bm5lckZhY3RvcnlQcm92aWRlcixcblx0ICAkJEFuaW1hdGVBc3luY1J1bkZhY3RvcnlQcm92aWRlcixcblx0ICAkQnJvd3NlclByb3ZpZGVyLFxuXHQgICRDYWNoZUZhY3RvcnlQcm92aWRlcixcblx0ICAkQ29udHJvbGxlclByb3ZpZGVyLFxuXHQgICREYXRlUHJvdmlkZXIsXG5cdCAgJERvY3VtZW50UHJvdmlkZXIsXG5cdCAgJEV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcixcblx0ICAkRmlsdGVyUHJvdmlkZXIsXG5cdCAgJCRGb3JjZVJlZmxvd1Byb3ZpZGVyLFxuXHQgICRJbnRlcnBvbGF0ZVByb3ZpZGVyLFxuXHQgICRJbnRlcnZhbFByb3ZpZGVyLFxuXHQgICQkSGFzaE1hcFByb3ZpZGVyLFxuXHQgICRIdHRwUHJvdmlkZXIsXG5cdCAgJEh0dHBQYXJhbVNlcmlhbGl6ZXJQcm92aWRlcixcblx0ICAkSHR0cFBhcmFtU2VyaWFsaXplckpRTGlrZVByb3ZpZGVyLFxuXHQgICRIdHRwQmFja2VuZFByb3ZpZGVyLFxuXHQgICR4aHJGYWN0b3J5UHJvdmlkZXIsXG5cdCAgJExvY2F0aW9uUHJvdmlkZXIsXG5cdCAgJExvZ1Byb3ZpZGVyLFxuXHQgICRQYXJzZVByb3ZpZGVyLFxuXHQgICRSb290U2NvcGVQcm92aWRlcixcblx0ICAkUVByb3ZpZGVyLFxuXHQgICQkUVByb3ZpZGVyLFxuXHQgICQkU2FuaXRpemVVcmlQcm92aWRlcixcblx0ICAkU2NlUHJvdmlkZXIsXG5cdCAgJFNjZURlbGVnYXRlUHJvdmlkZXIsXG5cdCAgJFNuaWZmZXJQcm92aWRlcixcblx0ICAkVGVtcGxhdGVDYWNoZVByb3ZpZGVyLFxuXHQgICRUZW1wbGF0ZVJlcXVlc3RQcm92aWRlcixcblx0ICAkJFRlc3RhYmlsaXR5UHJvdmlkZXIsXG5cdCAgJFRpbWVvdXRQcm92aWRlcixcblx0ICAkJFJBRlByb3ZpZGVyLFxuXHQgICRXaW5kb3dQcm92aWRlcixcblx0ICAkJGpxTGl0ZVByb3ZpZGVyLFxuXHQgICQkQ29va2llUmVhZGVyUHJvdmlkZXJcblx0Ki9cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIG9iamVjdFxuXHQgKiBAbmFtZSBhbmd1bGFyLnZlcnNpb25cblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGN1cnJlbnQgQW5ndWxhckpTIHZlcnNpb24uXG5cdCAqXG5cdCAqIFRoaXMgb2JqZWN0IGhhcyB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG5cdCAqXG5cdCAqIC0gYGZ1bGxgIOKAkyBge3N0cmluZ31gIOKAkyBGdWxsIHZlcnNpb24gc3RyaW5nLCBzdWNoIGFzIFwiMC45LjE4XCIuXG5cdCAqIC0gYG1ham9yYCDigJMgYHtudW1iZXJ9YCDigJMgTWFqb3IgdmVyc2lvbiBudW1iZXIsIHN1Y2ggYXMgXCIwXCIuXG5cdCAqIC0gYG1pbm9yYCDigJMgYHtudW1iZXJ9YCDigJMgTWlub3IgdmVyc2lvbiBudW1iZXIsIHN1Y2ggYXMgXCI5XCIuXG5cdCAqIC0gYGRvdGAg4oCTIGB7bnVtYmVyfWAg4oCTIERvdCB2ZXJzaW9uIG51bWJlciwgc3VjaCBhcyBcIjE4XCIuXG5cdCAqIC0gYGNvZGVOYW1lYCDigJMgYHtzdHJpbmd9YCDigJMgQ29kZSBuYW1lIG9mIHRoZSByZWxlYXNlLCBzdWNoIGFzIFwiamlnZ2xpbmctYXJtZmF0XCIuXG5cdCAqL1xuXHR2YXIgdmVyc2lvbiA9IHtcblx0ICBmdWxsOiAnMS41LjAnLCAgICAvLyBhbGwgb2YgdGhlc2UgcGxhY2Vob2xkZXIgc3RyaW5ncyB3aWxsIGJlIHJlcGxhY2VkIGJ5IGdydW50J3Ncblx0ICBtYWpvcjogMSwgICAgLy8gcGFja2FnZSB0YXNrXG5cdCAgbWlub3I6IDUsXG5cdCAgZG90OiAwLFxuXHQgIGNvZGVOYW1lOiAnZW5ub2JsZW1lbnQtZmFjaWxpdGF0aW9uJ1xuXHR9O1xuXHRcblx0XG5cdGZ1bmN0aW9uIHB1Ymxpc2hFeHRlcm5hbEFQSShhbmd1bGFyKSB7XG5cdCAgZXh0ZW5kKGFuZ3VsYXIsIHtcblx0ICAgICdib290c3RyYXAnOiBib290c3RyYXAsXG5cdCAgICAnY29weSc6IGNvcHksXG5cdCAgICAnZXh0ZW5kJzogZXh0ZW5kLFxuXHQgICAgJ21lcmdlJzogbWVyZ2UsXG5cdCAgICAnZXF1YWxzJzogZXF1YWxzLFxuXHQgICAgJ2VsZW1lbnQnOiBqcUxpdGUsXG5cdCAgICAnZm9yRWFjaCc6IGZvckVhY2gsXG5cdCAgICAnaW5qZWN0b3InOiBjcmVhdGVJbmplY3Rvcixcblx0ICAgICdub29wJzogbm9vcCxcblx0ICAgICdiaW5kJzogYmluZCxcblx0ICAgICd0b0pzb24nOiB0b0pzb24sXG5cdCAgICAnZnJvbUpzb24nOiBmcm9tSnNvbixcblx0ICAgICdpZGVudGl0eSc6IGlkZW50aXR5LFxuXHQgICAgJ2lzVW5kZWZpbmVkJzogaXNVbmRlZmluZWQsXG5cdCAgICAnaXNEZWZpbmVkJzogaXNEZWZpbmVkLFxuXHQgICAgJ2lzU3RyaW5nJzogaXNTdHJpbmcsXG5cdCAgICAnaXNGdW5jdGlvbic6IGlzRnVuY3Rpb24sXG5cdCAgICAnaXNPYmplY3QnOiBpc09iamVjdCxcblx0ICAgICdpc051bWJlcic6IGlzTnVtYmVyLFxuXHQgICAgJ2lzRWxlbWVudCc6IGlzRWxlbWVudCxcblx0ICAgICdpc0FycmF5JzogaXNBcnJheSxcblx0ICAgICd2ZXJzaW9uJzogdmVyc2lvbixcblx0ICAgICdpc0RhdGUnOiBpc0RhdGUsXG5cdCAgICAnbG93ZXJjYXNlJzogbG93ZXJjYXNlLFxuXHQgICAgJ3VwcGVyY2FzZSc6IHVwcGVyY2FzZSxcblx0ICAgICdjYWxsYmFja3MnOiB7Y291bnRlcjogMH0sXG5cdCAgICAnZ2V0VGVzdGFiaWxpdHknOiBnZXRUZXN0YWJpbGl0eSxcblx0ICAgICckJG1pbkVycic6IG1pbkVycixcblx0ICAgICckJGNzcCc6IGNzcCxcblx0ICAgICdyZWxvYWRXaXRoRGVidWdJbmZvJzogcmVsb2FkV2l0aERlYnVnSW5mb1xuXHQgIH0pO1xuXHRcblx0ICBhbmd1bGFyTW9kdWxlID0gc2V0dXBNb2R1bGVMb2FkZXIod2luZG93KTtcblx0XG5cdCAgYW5ndWxhck1vZHVsZSgnbmcnLCBbJ25nTG9jYWxlJ10sIFsnJHByb3ZpZGUnLFxuXHQgICAgZnVuY3Rpb24gbmdNb2R1bGUoJHByb3ZpZGUpIHtcblx0ICAgICAgLy8gJCRzYW5pdGl6ZVVyaVByb3ZpZGVyIG5lZWRzIHRvIGJlIGJlZm9yZSAkY29tcGlsZVByb3ZpZGVyIGFzIGl0IGlzIHVzZWQgYnkgaXQuXG5cdCAgICAgICRwcm92aWRlLnByb3ZpZGVyKHtcblx0ICAgICAgICAkJHNhbml0aXplVXJpOiAkJFNhbml0aXplVXJpUHJvdmlkZXJcblx0ICAgICAgfSk7XG5cdCAgICAgICRwcm92aWRlLnByb3ZpZGVyKCckY29tcGlsZScsICRDb21waWxlUHJvdmlkZXIpLlxuXHQgICAgICAgIGRpcmVjdGl2ZSh7XG5cdCAgICAgICAgICAgIGE6IGh0bWxBbmNob3JEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIGlucHV0OiBpbnB1dERpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgdGV4dGFyZWE6IGlucHV0RGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBmb3JtOiBmb3JtRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBzY3JpcHQ6IHNjcmlwdERpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgc2VsZWN0OiBzZWxlY3REaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIHN0eWxlOiBzdHlsZURpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgb3B0aW9uOiBvcHRpb25EaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nQmluZDogbmdCaW5kRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBuZ0JpbmRIdG1sOiBuZ0JpbmRIdG1sRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBuZ0JpbmRUZW1wbGF0ZTogbmdCaW5kVGVtcGxhdGVEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nQ2xhc3M6IG5nQ2xhc3NEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nQ2xhc3NFdmVuOiBuZ0NsYXNzRXZlbkRpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgbmdDbGFzc09kZDogbmdDbGFzc09kZERpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgbmdDbG9hazogbmdDbG9ha0RpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgbmdDb250cm9sbGVyOiBuZ0NvbnRyb2xsZXJEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nRm9ybTogbmdGb3JtRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBuZ0hpZGU6IG5nSGlkZURpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgbmdJZjogbmdJZkRpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgbmdJbmNsdWRlOiBuZ0luY2x1ZGVEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nSW5pdDogbmdJbml0RGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBuZ05vbkJpbmRhYmxlOiBuZ05vbkJpbmRhYmxlRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBuZ1BsdXJhbGl6ZTogbmdQbHVyYWxpemVEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nUmVwZWF0OiBuZ1JlcGVhdERpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgbmdTaG93OiBuZ1Nob3dEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nU3R5bGU6IG5nU3R5bGVEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nU3dpdGNoOiBuZ1N3aXRjaERpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgbmdTd2l0Y2hXaGVuOiBuZ1N3aXRjaFdoZW5EaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nU3dpdGNoRGVmYXVsdDogbmdTd2l0Y2hEZWZhdWx0RGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBuZ09wdGlvbnM6IG5nT3B0aW9uc0RpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgbmdUcmFuc2NsdWRlOiBuZ1RyYW5zY2x1ZGVEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nTW9kZWw6IG5nTW9kZWxEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nTGlzdDogbmdMaXN0RGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBuZ0NoYW5nZTogbmdDaGFuZ2VEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIHBhdHRlcm46IHBhdHRlcm5EaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nUGF0dGVybjogcGF0dGVybkRpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgcmVxdWlyZWQ6IHJlcXVpcmVkRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBuZ1JlcXVpcmVkOiByZXF1aXJlZERpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgbWlubGVuZ3RoOiBtaW5sZW5ndGhEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG5nTWlubGVuZ3RoOiBtaW5sZW5ndGhEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgIG1heGxlbmd0aDogbWF4bGVuZ3RoRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBuZ01heGxlbmd0aDogbWF4bGVuZ3RoRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBuZ1ZhbHVlOiBuZ1ZhbHVlRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICBuZ01vZGVsT3B0aW9uczogbmdNb2RlbE9wdGlvbnNEaXJlY3RpdmVcblx0ICAgICAgICB9KS5cblx0ICAgICAgICBkaXJlY3RpdmUoe1xuXHQgICAgICAgICAgbmdJbmNsdWRlOiBuZ0luY2x1ZGVGaWxsQ29udGVudERpcmVjdGl2ZVxuXHQgICAgICAgIH0pLlxuXHQgICAgICAgIGRpcmVjdGl2ZShuZ0F0dHJpYnV0ZUFsaWFzRGlyZWN0aXZlcykuXG5cdCAgICAgICAgZGlyZWN0aXZlKG5nRXZlbnREaXJlY3RpdmVzKTtcblx0ICAgICAgJHByb3ZpZGUucHJvdmlkZXIoe1xuXHQgICAgICAgICRhbmNob3JTY3JvbGw6ICRBbmNob3JTY3JvbGxQcm92aWRlcixcblx0ICAgICAgICAkYW5pbWF0ZTogJEFuaW1hdGVQcm92aWRlcixcblx0ICAgICAgICAkYW5pbWF0ZUNzczogJENvcmVBbmltYXRlQ3NzUHJvdmlkZXIsXG5cdCAgICAgICAgJCRhbmltYXRlSnM6ICQkQ29yZUFuaW1hdGVKc1Byb3ZpZGVyLFxuXHQgICAgICAgICQkYW5pbWF0ZVF1ZXVlOiAkJENvcmVBbmltYXRlUXVldWVQcm92aWRlcixcblx0ICAgICAgICAkJEFuaW1hdGVSdW5uZXI6ICQkQW5pbWF0ZVJ1bm5lckZhY3RvcnlQcm92aWRlcixcblx0ICAgICAgICAkJGFuaW1hdGVBc3luY1J1bjogJCRBbmltYXRlQXN5bmNSdW5GYWN0b3J5UHJvdmlkZXIsXG5cdCAgICAgICAgJGJyb3dzZXI6ICRCcm93c2VyUHJvdmlkZXIsXG5cdCAgICAgICAgJGNhY2hlRmFjdG9yeTogJENhY2hlRmFjdG9yeVByb3ZpZGVyLFxuXHQgICAgICAgICRjb250cm9sbGVyOiAkQ29udHJvbGxlclByb3ZpZGVyLFxuXHQgICAgICAgICRkb2N1bWVudDogJERvY3VtZW50UHJvdmlkZXIsXG5cdCAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXI6ICRFeGNlcHRpb25IYW5kbGVyUHJvdmlkZXIsXG5cdCAgICAgICAgJGZpbHRlcjogJEZpbHRlclByb3ZpZGVyLFxuXHQgICAgICAgICQkZm9yY2VSZWZsb3c6ICQkRm9yY2VSZWZsb3dQcm92aWRlcixcblx0ICAgICAgICAkaW50ZXJwb2xhdGU6ICRJbnRlcnBvbGF0ZVByb3ZpZGVyLFxuXHQgICAgICAgICRpbnRlcnZhbDogJEludGVydmFsUHJvdmlkZXIsXG5cdCAgICAgICAgJGh0dHA6ICRIdHRwUHJvdmlkZXIsXG5cdCAgICAgICAgJGh0dHBQYXJhbVNlcmlhbGl6ZXI6ICRIdHRwUGFyYW1TZXJpYWxpemVyUHJvdmlkZXIsXG5cdCAgICAgICAgJGh0dHBQYXJhbVNlcmlhbGl6ZXJKUUxpa2U6ICRIdHRwUGFyYW1TZXJpYWxpemVySlFMaWtlUHJvdmlkZXIsXG5cdCAgICAgICAgJGh0dHBCYWNrZW5kOiAkSHR0cEJhY2tlbmRQcm92aWRlcixcblx0ICAgICAgICAkeGhyRmFjdG9yeTogJHhockZhY3RvcnlQcm92aWRlcixcblx0ICAgICAgICAkbG9jYXRpb246ICRMb2NhdGlvblByb3ZpZGVyLFxuXHQgICAgICAgICRsb2c6ICRMb2dQcm92aWRlcixcblx0ICAgICAgICAkcGFyc2U6ICRQYXJzZVByb3ZpZGVyLFxuXHQgICAgICAgICRyb290U2NvcGU6ICRSb290U2NvcGVQcm92aWRlcixcblx0ICAgICAgICAkcTogJFFQcm92aWRlcixcblx0ICAgICAgICAkJHE6ICQkUVByb3ZpZGVyLFxuXHQgICAgICAgICRzY2U6ICRTY2VQcm92aWRlcixcblx0ICAgICAgICAkc2NlRGVsZWdhdGU6ICRTY2VEZWxlZ2F0ZVByb3ZpZGVyLFxuXHQgICAgICAgICRzbmlmZmVyOiAkU25pZmZlclByb3ZpZGVyLFxuXHQgICAgICAgICR0ZW1wbGF0ZUNhY2hlOiAkVGVtcGxhdGVDYWNoZVByb3ZpZGVyLFxuXHQgICAgICAgICR0ZW1wbGF0ZVJlcXVlc3Q6ICRUZW1wbGF0ZVJlcXVlc3RQcm92aWRlcixcblx0ICAgICAgICAkJHRlc3RhYmlsaXR5OiAkJFRlc3RhYmlsaXR5UHJvdmlkZXIsXG5cdCAgICAgICAgJHRpbWVvdXQ6ICRUaW1lb3V0UHJvdmlkZXIsXG5cdCAgICAgICAgJHdpbmRvdzogJFdpbmRvd1Byb3ZpZGVyLFxuXHQgICAgICAgICQkckFGOiAkJFJBRlByb3ZpZGVyLFxuXHQgICAgICAgICQkanFMaXRlOiAkJGpxTGl0ZVByb3ZpZGVyLFxuXHQgICAgICAgICQkSGFzaE1hcDogJCRIYXNoTWFwUHJvdmlkZXIsXG5cdCAgICAgICAgJCRjb29raWVSZWFkZXI6ICQkQ29va2llUmVhZGVyUHJvdmlkZXJcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgXSk7XG5cdH1cblx0XG5cdC8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICpcblx0ICogICAgIEFueSBjb21taXRzIHRvIHRoaXMgZmlsZSBzaG91bGQgYmUgcmV2aWV3ZWQgd2l0aCBzZWN1cml0eSBpbiBtaW5kLiAgKlxuXHQgKiAgIENoYW5nZXMgdG8gdGhpcyBmaWxlIGNhbiBwb3RlbnRpYWxseSBjcmVhdGUgc2VjdXJpdHkgdnVsbmVyYWJpbGl0aWVzLiAqXG5cdCAqICAgICAgICAgIEFuIGFwcHJvdmFsIGZyb20gMiBDb3JlIG1lbWJlcnMgd2l0aCBoaXN0b3J5IG9mIG1vZGlmeWluZyAgICAgICpcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyBmaWxlIGlzIHJlcXVpcmVkLiAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG5cdCAqICBEb2VzIHRoZSBjaGFuZ2Ugc29tZWhvdyBhbGxvdyBmb3IgYXJiaXRyYXJ5IGphdmFzY3JpcHQgdG8gYmUgZXhlY3V0ZWQ/ICpcblx0ICogICAgT3IgYWxsb3dzIGZvciBzb21lb25lIHRvIGNoYW5nZSB0aGUgcHJvdG90eXBlIG9mIGJ1aWx0LWluIG9iamVjdHM/ICAgKlxuXHQgKiAgICAgT3IgZ2l2ZXMgdW5kZXNpcmVkIGFjY2VzcyB0byB2YXJpYWJsZXMgbGlrZXMgZG9jdW1lbnQgb3Igd2luZG93PyAgICAqXG5cdCAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovXG5cdFxuXHQvKiBnbG9iYWwgSlFMaXRlUHJvdG90eXBlOiB0cnVlLFxuXHQgIGFkZEV2ZW50TGlzdGVuZXJGbjogdHJ1ZSxcblx0ICByZW1vdmVFdmVudExpc3RlbmVyRm46IHRydWUsXG5cdCAgQk9PTEVBTl9BVFRSOiB0cnVlLFxuXHQgIEFMSUFTRURfQVRUUjogdHJ1ZSxcblx0Ki9cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly9KUUxpdGVcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBmdW5jdGlvblxuXHQgKiBAbmFtZSBhbmd1bGFyLmVsZW1lbnRcblx0ICogQG1vZHVsZSBuZ1xuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogV3JhcHMgYSByYXcgRE9NIGVsZW1lbnQgb3IgSFRNTCBzdHJpbmcgYXMgYSBbalF1ZXJ5XShodHRwOi8vanF1ZXJ5LmNvbSkgZWxlbWVudC5cblx0ICpcblx0ICogSWYgalF1ZXJ5IGlzIGF2YWlsYWJsZSwgYGFuZ3VsYXIuZWxlbWVudGAgaXMgYW4gYWxpYXMgZm9yIHRoZVxuXHQgKiBbalF1ZXJ5XShodHRwOi8vYXBpLmpxdWVyeS5jb20valF1ZXJ5LykgZnVuY3Rpb24uIElmIGpRdWVyeSBpcyBub3QgYXZhaWxhYmxlLCBgYW5ndWxhci5lbGVtZW50YFxuXHQgKiBkZWxlZ2F0ZXMgdG8gQW5ndWxhcidzIGJ1aWx0LWluIHN1YnNldCBvZiBqUXVlcnksIGNhbGxlZCBcImpRdWVyeSBsaXRlXCIgb3IgKipqcUxpdGUqKi5cblx0ICpcblx0ICoganFMaXRlIGlzIGEgdGlueSwgQVBJLWNvbXBhdGlibGUgc3Vic2V0IG9mIGpRdWVyeSB0aGF0IGFsbG93c1xuXHQgKiBBbmd1bGFyIHRvIG1hbmlwdWxhdGUgdGhlIERPTSBpbiBhIGNyb3NzLWJyb3dzZXIgY29tcGF0aWJsZSB3YXkuIGpxTGl0ZSBpbXBsZW1lbnRzIG9ubHkgdGhlIG1vc3Rcblx0ICogY29tbW9ubHkgbmVlZGVkIGZ1bmN0aW9uYWxpdHkgd2l0aCB0aGUgZ29hbCBvZiBoYXZpbmcgYSB2ZXJ5IHNtYWxsIGZvb3RwcmludC5cblx0ICpcblx0ICogVG8gdXNlIGBqUXVlcnlgLCBzaW1wbHkgZW5zdXJlIGl0IGlzIGxvYWRlZCBiZWZvcmUgdGhlIGBhbmd1bGFyLmpzYCBmaWxlLiBZb3UgY2FuIGFsc28gdXNlIHRoZVxuXHQgKiB7QGxpbmsgbmdKcSBgbmdKcWB9IGRpcmVjdGl2ZSB0byBzcGVjaWZ5IHRoYXQganFsaXRlIHNob3VsZCBiZSB1c2VkIG92ZXIgalF1ZXJ5LCBvciB0byB1c2UgYVxuXHQgKiBzcGVjaWZpYyB2ZXJzaW9uIG9mIGpRdWVyeSBpZiBtdWx0aXBsZSB2ZXJzaW9ucyBleGlzdCBvbiB0aGUgcGFnZS5cblx0ICpcblx0ICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWluZm9cIj4qKk5vdGU6KiogQWxsIGVsZW1lbnQgcmVmZXJlbmNlcyBpbiBBbmd1bGFyIGFyZSBhbHdheXMgd3JhcHBlZCB3aXRoIGpRdWVyeSBvclxuXHQgKiBqcUxpdGUgKHN1Y2ggYXMgdGhlIGVsZW1lbnQgYXJndW1lbnQgaW4gYSBkaXJlY3RpdmUncyBjb21waWxlIC8gbGluayBmdW5jdGlvbikuIFRoZXkgYXJlIG5ldmVyIHJhdyBET00gcmVmZXJlbmNlcy48L2Rpdj5cblx0ICpcblx0ICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj4qKk5vdGU6KiogS2VlcCBpbiBtaW5kIHRoYXQgdGhpcyBmdW5jdGlvbiB3aWxsIG5vdCBmaW5kIGVsZW1lbnRzXG5cdCAqIGJ5IHRhZyBuYW1lIC8gQ1NTIHNlbGVjdG9yLiBGb3IgbG9va3VwcyBieSB0YWcgbmFtZSwgdHJ5IGluc3RlYWQgYGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkuZmluZCguLi4pYFxuXHQgKiBvciBgJGRvY3VtZW50LmZpbmQoKWAsIG9yIHVzZSB0aGUgc3RhbmRhcmQgRE9NIEFQSXMsIGUuZy4gYGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoKWAuPC9kaXY+XG5cdCAqXG5cdCAqICMjIEFuZ3VsYXIncyBqcUxpdGVcblx0ICoganFMaXRlIHByb3ZpZGVzIG9ubHkgdGhlIGZvbGxvd2luZyBqUXVlcnkgbWV0aG9kczpcblx0ICpcblx0ICogLSBbYGFkZENsYXNzKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vYWRkQ2xhc3MvKVxuXHQgKiAtIFtgYWZ0ZXIoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9hZnRlci8pXG5cdCAqIC0gW2BhcHBlbmQoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9hcHBlbmQvKVxuXHQgKiAtIFtgYXR0cigpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL2F0dHIvKSAtIERvZXMgbm90IHN1cHBvcnQgZnVuY3Rpb25zIGFzIHBhcmFtZXRlcnNcblx0ICogLSBbYGJpbmQoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9iaW5kLykgLSBEb2VzIG5vdCBzdXBwb3J0IG5hbWVzcGFjZXMsIHNlbGVjdG9ycyBvciBldmVudERhdGFcblx0ICogLSBbYGNoaWxkcmVuKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vY2hpbGRyZW4vKSAtIERvZXMgbm90IHN1cHBvcnQgc2VsZWN0b3JzXG5cdCAqIC0gW2BjbG9uZSgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL2Nsb25lLylcblx0ICogLSBbYGNvbnRlbnRzKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vY29udGVudHMvKVxuXHQgKiAtIFtgY3NzKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vY3NzLykgLSBPbmx5IHJldHJpZXZlcyBpbmxpbmUtc3R5bGVzLCBkb2VzIG5vdCBjYWxsIGBnZXRDb21wdXRlZFN0eWxlKClgLlxuXHQgKiAgIEFzIGEgc2V0dGVyLCBkb2VzIG5vdCBjb252ZXJ0IG51bWJlcnMgdG8gc3RyaW5ncyBvciBhcHBlbmQgJ3B4JywgYW5kIGFsc28gZG9lcyBub3QgaGF2ZSBhdXRvbWF0aWMgcHJvcGVydHkgcHJlZml4aW5nLlxuXHQgKiAtIFtgZGF0YSgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL2RhdGEvKVxuXHQgKiAtIFtgZGV0YWNoKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vZGV0YWNoLylcblx0ICogLSBbYGVtcHR5KClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vZW1wdHkvKVxuXHQgKiAtIFtgZXEoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9lcS8pXG5cdCAqIC0gW2BmaW5kKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vZmluZC8pIC0gTGltaXRlZCB0byBsb29rdXBzIGJ5IHRhZyBuYW1lXG5cdCAqIC0gW2BoYXNDbGFzcygpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL2hhc0NsYXNzLylcblx0ICogLSBbYGh0bWwoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9odG1sLylcblx0ICogLSBbYG5leHQoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9uZXh0LykgLSBEb2VzIG5vdCBzdXBwb3J0IHNlbGVjdG9yc1xuXHQgKiAtIFtgb24oKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9vbi8pIC0gRG9lcyBub3Qgc3VwcG9ydCBuYW1lc3BhY2VzLCBzZWxlY3RvcnMgb3IgZXZlbnREYXRhXG5cdCAqIC0gW2BvZmYoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9vZmYvKSAtIERvZXMgbm90IHN1cHBvcnQgbmFtZXNwYWNlcywgc2VsZWN0b3JzIG9yIGV2ZW50IG9iamVjdCBhcyBwYXJhbWV0ZXJcblx0ICogLSBbYG9uZSgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL29uZS8pIC0gRG9lcyBub3Qgc3VwcG9ydCBuYW1lc3BhY2VzIG9yIHNlbGVjdG9yc1xuXHQgKiAtIFtgcGFyZW50KClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vcGFyZW50LykgLSBEb2VzIG5vdCBzdXBwb3J0IHNlbGVjdG9yc1xuXHQgKiAtIFtgcHJlcGVuZCgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL3ByZXBlbmQvKVxuXHQgKiAtIFtgcHJvcCgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL3Byb3AvKVxuXHQgKiAtIFtgcmVhZHkoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9yZWFkeS8pXG5cdCAqIC0gW2ByZW1vdmUoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9yZW1vdmUvKVxuXHQgKiAtIFtgcmVtb3ZlQXR0cigpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL3JlbW92ZUF0dHIvKVxuXHQgKiAtIFtgcmVtb3ZlQ2xhc3MoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9yZW1vdmVDbGFzcy8pXG5cdCAqIC0gW2ByZW1vdmVEYXRhKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vcmVtb3ZlRGF0YS8pXG5cdCAqIC0gW2ByZXBsYWNlV2l0aCgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL3JlcGxhY2VXaXRoLylcblx0ICogLSBbYHRleHQoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS90ZXh0Lylcblx0ICogLSBbYHRvZ2dsZUNsYXNzKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vdG9nZ2xlQ2xhc3MvKVxuXHQgKiAtIFtgdHJpZ2dlckhhbmRsZXIoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS90cmlnZ2VySGFuZGxlci8pIC0gUGFzc2VzIGEgZHVtbXkgZXZlbnQgb2JqZWN0IHRvIGhhbmRsZXJzLlxuXHQgKiAtIFtgdW5iaW5kKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vdW5iaW5kLykgLSBEb2VzIG5vdCBzdXBwb3J0IG5hbWVzcGFjZXMgb3IgZXZlbnQgb2JqZWN0IGFzIHBhcmFtZXRlclxuXHQgKiAtIFtgdmFsKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vdmFsLylcblx0ICogLSBbYHdyYXAoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS93cmFwLylcblx0ICpcblx0ICogIyMgalF1ZXJ5L2pxTGl0ZSBFeHRyYXNcblx0ICogQW5ndWxhciBhbHNvIHByb3ZpZGVzIHRoZSBmb2xsb3dpbmcgYWRkaXRpb25hbCBtZXRob2RzIGFuZCBldmVudHMgdG8gYm90aCBqUXVlcnkgYW5kIGpxTGl0ZTpcblx0ICpcblx0ICogIyMjIEV2ZW50c1xuXHQgKiAtIGAkZGVzdHJveWAgLSBBbmd1bGFySlMgaW50ZXJjZXB0cyBhbGwganFMaXRlL2pRdWVyeSdzIERPTSBkZXN0cnVjdGlvbiBhcGlzIGFuZCBmaXJlcyB0aGlzIGV2ZW50XG5cdCAqICAgIG9uIGFsbCBET00gbm9kZXMgYmVpbmcgcmVtb3ZlZC4gIFRoaXMgY2FuIGJlIHVzZWQgdG8gY2xlYW4gdXAgYW55IDNyZCBwYXJ0eSBiaW5kaW5ncyB0byB0aGUgRE9NXG5cdCAqICAgIGVsZW1lbnQgYmVmb3JlIGl0IGlzIHJlbW92ZWQuXG5cdCAqXG5cdCAqICMjIyBNZXRob2RzXG5cdCAqIC0gYGNvbnRyb2xsZXIobmFtZSlgIC0gcmV0cmlldmVzIHRoZSBjb250cm9sbGVyIG9mIHRoZSBjdXJyZW50IGVsZW1lbnQgb3IgaXRzIHBhcmVudC4gQnkgZGVmYXVsdFxuXHQgKiAgIHJldHJpZXZlcyBjb250cm9sbGVyIGFzc29jaWF0ZWQgd2l0aCB0aGUgYG5nQ29udHJvbGxlcmAgZGlyZWN0aXZlLiBJZiBgbmFtZWAgaXMgcHJvdmlkZWQgYXNcblx0ICogICBjYW1lbENhc2UgZGlyZWN0aXZlIG5hbWUsIHRoZW4gdGhlIGNvbnRyb2xsZXIgZm9yIHRoaXMgZGlyZWN0aXZlIHdpbGwgYmUgcmV0cmlldmVkIChlLmcuXG5cdCAqICAgYCduZ01vZGVsJ2ApLlxuXHQgKiAtIGBpbmplY3RvcigpYCAtIHJldHJpZXZlcyB0aGUgaW5qZWN0b3Igb2YgdGhlIGN1cnJlbnQgZWxlbWVudCBvciBpdHMgcGFyZW50LlxuXHQgKiAtIGBzY29wZSgpYCAtIHJldHJpZXZlcyB0aGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUgc2NvcGV9IG9mIHRoZSBjdXJyZW50XG5cdCAqICAgZWxlbWVudCBvciBpdHMgcGFyZW50LiBSZXF1aXJlcyB7QGxpbmsgZ3VpZGUvcHJvZHVjdGlvbiNkaXNhYmxpbmctZGVidWctZGF0YSBEZWJ1ZyBEYXRhfSB0b1xuXHQgKiAgIGJlIGVuYWJsZWQuXG5cdCAqIC0gYGlzb2xhdGVTY29wZSgpYCAtIHJldHJpZXZlcyBhbiBpc29sYXRlIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIHNjb3BlfSBpZiBvbmUgaXMgYXR0YWNoZWQgZGlyZWN0bHkgdG8gdGhlXG5cdCAqICAgY3VycmVudCBlbGVtZW50LiBUaGlzIGdldHRlciBzaG91bGQgYmUgdXNlZCBvbmx5IG9uIGVsZW1lbnRzIHRoYXQgY29udGFpbiBhIGRpcmVjdGl2ZSB3aGljaCBzdGFydHMgYSBuZXcgaXNvbGF0ZVxuXHQgKiAgIHNjb3BlLiBDYWxsaW5nIGBzY29wZSgpYCBvbiB0aGlzIGVsZW1lbnQgYWx3YXlzIHJldHVybnMgdGhlIG9yaWdpbmFsIG5vbi1pc29sYXRlIHNjb3BlLlxuXHQgKiAgIFJlcXVpcmVzIHtAbGluayBndWlkZS9wcm9kdWN0aW9uI2Rpc2FibGluZy1kZWJ1Zy1kYXRhIERlYnVnIERhdGF9IHRvIGJlIGVuYWJsZWQuXG5cdCAqIC0gYGluaGVyaXRlZERhdGEoKWAgLSBzYW1lIGFzIGBkYXRhKClgLCBidXQgd2Fsa3MgdXAgdGhlIERPTSB1bnRpbCBhIHZhbHVlIGlzIGZvdW5kIG9yIHRoZSB0b3Bcblx0ICogICBwYXJlbnQgZWxlbWVudCBpcyByZWFjaGVkLlxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ3xET01FbGVtZW50fSBlbGVtZW50IEhUTUwgc3RyaW5nIG9yIERPTUVsZW1lbnQgdG8gYmUgd3JhcHBlZCBpbnRvIGpRdWVyeS5cblx0ICogQHJldHVybnMge09iamVjdH0galF1ZXJ5IG9iamVjdC5cblx0ICovXG5cdFxuXHRKUUxpdGUuZXhwYW5kbyA9ICduZzMzOSc7XG5cdFxuXHR2YXIganFDYWNoZSA9IEpRTGl0ZS5jYWNoZSA9IHt9LFxuXHQgICAganFJZCA9IDEsXG5cdCAgICBhZGRFdmVudExpc3RlbmVyRm4gPSBmdW5jdGlvbihlbGVtZW50LCB0eXBlLCBmbikge1xuXHQgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgZm4sIGZhbHNlKTtcblx0ICAgIH0sXG5cdCAgICByZW1vdmVFdmVudExpc3RlbmVyRm4gPSBmdW5jdGlvbihlbGVtZW50LCB0eXBlLCBmbikge1xuXHQgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgZm4sIGZhbHNlKTtcblx0ICAgIH07XG5cdFxuXHQvKlxuXHQgKiAhISEgVGhpcyBpcyBhbiB1bmRvY3VtZW50ZWQgXCJwcml2YXRlXCIgZnVuY3Rpb24gISEhXG5cdCAqL1xuXHRKUUxpdGUuX2RhdGEgPSBmdW5jdGlvbihub2RlKSB7XG5cdCAgLy9qUXVlcnkgYWx3YXlzIHJldHVybnMgYW4gb2JqZWN0IG9uIGNhY2hlIG1pc3Ncblx0ICByZXR1cm4gdGhpcy5jYWNoZVtub2RlW3RoaXMuZXhwYW5kb11dIHx8IHt9O1xuXHR9O1xuXHRcblx0ZnVuY3Rpb24ganFOZXh0SWQoKSB7IHJldHVybiArK2pxSWQ7IH1cblx0XG5cdFxuXHR2YXIgU1BFQ0lBTF9DSEFSU19SRUdFWFAgPSAvKFtcXDpcXC1cXF9dKyguKSkvZztcblx0dmFyIE1PWl9IQUNLX1JFR0VYUCA9IC9ebW96KFtBLVpdKS87XG5cdHZhciBNT1VTRV9FVkVOVF9NQVA9IHsgbW91c2VsZWF2ZTogXCJtb3VzZW91dFwiLCBtb3VzZWVudGVyOiBcIm1vdXNlb3ZlclwifTtcblx0dmFyIGpxTGl0ZU1pbkVyciA9IG1pbkVycignanFMaXRlJyk7XG5cdFxuXHQvKipcblx0ICogQ29udmVydHMgc25ha2VfY2FzZSB0byBjYW1lbENhc2UuXG5cdCAqIEFsc28gdGhlcmUgaXMgc3BlY2lhbCBjYXNlIGZvciBNb3ogcHJlZml4IHN0YXJ0aW5nIHdpdGggdXBwZXIgY2FzZSBsZXR0ZXIuXG5cdCAqIEBwYXJhbSBuYW1lIE5hbWUgdG8gbm9ybWFsaXplXG5cdCAqL1xuXHRmdW5jdGlvbiBjYW1lbENhc2UobmFtZSkge1xuXHQgIHJldHVybiBuYW1lLlxuXHQgICAgcmVwbGFjZShTUEVDSUFMX0NIQVJTX1JFR0VYUCwgZnVuY3Rpb24oXywgc2VwYXJhdG9yLCBsZXR0ZXIsIG9mZnNldCkge1xuXHQgICAgICByZXR1cm4gb2Zmc2V0ID8gbGV0dGVyLnRvVXBwZXJDYXNlKCkgOiBsZXR0ZXI7XG5cdCAgICB9KS5cblx0ICAgIHJlcGxhY2UoTU9aX0hBQ0tfUkVHRVhQLCAnTW96JDEnKTtcblx0fVxuXHRcblx0dmFyIFNJTkdMRV9UQUdfUkVHRVhQID0gL148KFtcXHctXSspXFxzKlxcLz8+KD86PFxcL1xcMT58KSQvO1xuXHR2YXIgSFRNTF9SRUdFWFAgPSAvPHwmIz9cXHcrOy87XG5cdHZhciBUQUdfTkFNRV9SRUdFWFAgPSAvPChbXFx3Oi1dKykvO1xuXHR2YXIgWEhUTUxfVEFHX1JFR0VYUCA9IC88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFtcXHc6LV0rKVtePl0qKVxcLz4vZ2k7XG5cdFxuXHR2YXIgd3JhcE1hcCA9IHtcblx0ICAnb3B0aW9uJzogWzEsICc8c2VsZWN0IG11bHRpcGxlPVwibXVsdGlwbGVcIj4nLCAnPC9zZWxlY3Q+J10sXG5cdFxuXHQgICd0aGVhZCc6IFsxLCAnPHRhYmxlPicsICc8L3RhYmxlPiddLFxuXHQgICdjb2wnOiBbMiwgJzx0YWJsZT48Y29sZ3JvdXA+JywgJzwvY29sZ3JvdXA+PC90YWJsZT4nXSxcblx0ICAndHInOiBbMiwgJzx0YWJsZT48dGJvZHk+JywgJzwvdGJvZHk+PC90YWJsZT4nXSxcblx0ICAndGQnOiBbMywgJzx0YWJsZT48dGJvZHk+PHRyPicsICc8L3RyPjwvdGJvZHk+PC90YWJsZT4nXSxcblx0ICAnX2RlZmF1bHQnOiBbMCwgXCJcIiwgXCJcIl1cblx0fTtcblx0XG5cdHdyYXBNYXAub3B0Z3JvdXAgPSB3cmFwTWFwLm9wdGlvbjtcblx0d3JhcE1hcC50Ym9keSA9IHdyYXBNYXAudGZvb3QgPSB3cmFwTWFwLmNvbGdyb3VwID0gd3JhcE1hcC5jYXB0aW9uID0gd3JhcE1hcC50aGVhZDtcblx0d3JhcE1hcC50aCA9IHdyYXBNYXAudGQ7XG5cdFxuXHRcblx0ZnVuY3Rpb24ganFMaXRlSXNUZXh0Tm9kZShodG1sKSB7XG5cdCAgcmV0dXJuICFIVE1MX1JFR0VYUC50ZXN0KGh0bWwpO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBqcUxpdGVBY2NlcHRzRGF0YShub2RlKSB7XG5cdCAgLy8gVGhlIHdpbmRvdyBvYmplY3QgY2FuIGFjY2VwdCBkYXRhIGJ1dCBoYXMgbm8gbm9kZVR5cGVcblx0ICAvLyBPdGhlcndpc2Ugd2UgYXJlIG9ubHkgaW50ZXJlc3RlZCBpbiBlbGVtZW50cyAoMSkgYW5kIGRvY3VtZW50cyAoOSlcblx0ICB2YXIgbm9kZVR5cGUgPSBub2RlLm5vZGVUeXBlO1xuXHQgIHJldHVybiBub2RlVHlwZSA9PT0gTk9ERV9UWVBFX0VMRU1FTlQgfHwgIW5vZGVUeXBlIHx8IG5vZGVUeXBlID09PSBOT0RFX1RZUEVfRE9DVU1FTlQ7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGpxTGl0ZUhhc0RhdGEobm9kZSkge1xuXHQgIGZvciAodmFyIGtleSBpbiBqcUNhY2hlW25vZGUubmczMzldKSB7XG5cdCAgICByZXR1cm4gdHJ1ZTtcblx0ICB9XG5cdCAgcmV0dXJuIGZhbHNlO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBqcUxpdGVDbGVhbkRhdGEobm9kZXMpIHtcblx0ICBmb3IgKHZhciBpID0gMCwgaWkgPSBub2Rlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdCAgICBqcUxpdGVSZW1vdmVEYXRhKG5vZGVzW2ldKTtcblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGpxTGl0ZUJ1aWxkRnJhZ21lbnQoaHRtbCwgY29udGV4dCkge1xuXHQgIHZhciB0bXAsIHRhZywgd3JhcCxcblx0ICAgICAgZnJhZ21lbnQgPSBjb250ZXh0LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxcblx0ICAgICAgbm9kZXMgPSBbXSwgaTtcblx0XG5cdCAgaWYgKGpxTGl0ZUlzVGV4dE5vZGUoaHRtbCkpIHtcblx0ICAgIC8vIENvbnZlcnQgbm9uLWh0bWwgaW50byBhIHRleHQgbm9kZVxuXHQgICAgbm9kZXMucHVzaChjb250ZXh0LmNyZWF0ZVRleHROb2RlKGh0bWwpKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgLy8gQ29udmVydCBodG1sIGludG8gRE9NIG5vZGVzXG5cdCAgICB0bXAgPSB0bXAgfHwgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoY29udGV4dC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKTtcblx0ICAgIHRhZyA9IChUQUdfTkFNRV9SRUdFWFAuZXhlYyhodG1sKSB8fCBbXCJcIiwgXCJcIl0pWzFdLnRvTG93ZXJDYXNlKCk7XG5cdCAgICB3cmFwID0gd3JhcE1hcFt0YWddIHx8IHdyYXBNYXAuX2RlZmF1bHQ7XG5cdCAgICB0bXAuaW5uZXJIVE1MID0gd3JhcFsxXSArIGh0bWwucmVwbGFjZShYSFRNTF9UQUdfUkVHRVhQLCBcIjwkMT48LyQyPlwiKSArIHdyYXBbMl07XG5cdFxuXHQgICAgLy8gRGVzY2VuZCB0aHJvdWdoIHdyYXBwZXJzIHRvIHRoZSByaWdodCBjb250ZW50XG5cdCAgICBpID0gd3JhcFswXTtcblx0ICAgIHdoaWxlIChpLS0pIHtcblx0ICAgICAgdG1wID0gdG1wLmxhc3RDaGlsZDtcblx0ICAgIH1cblx0XG5cdCAgICBub2RlcyA9IGNvbmNhdChub2RlcywgdG1wLmNoaWxkTm9kZXMpO1xuXHRcblx0ICAgIHRtcCA9IGZyYWdtZW50LmZpcnN0Q2hpbGQ7XG5cdCAgICB0bXAudGV4dENvbnRlbnQgPSBcIlwiO1xuXHQgIH1cblx0XG5cdCAgLy8gUmVtb3ZlIHdyYXBwZXIgZnJvbSBmcmFnbWVudFxuXHQgIGZyYWdtZW50LnRleHRDb250ZW50ID0gXCJcIjtcblx0ICBmcmFnbWVudC5pbm5lckhUTUwgPSBcIlwiOyAvLyBDbGVhciBpbm5lciBIVE1MXG5cdCAgZm9yRWFjaChub2RlcywgZnVuY3Rpb24obm9kZSkge1xuXHQgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XG5cdCAgfSk7XG5cdFxuXHQgIHJldHVybiBmcmFnbWVudDtcblx0fVxuXHRcblx0ZnVuY3Rpb24ganFMaXRlUGFyc2VIVE1MKGh0bWwsIGNvbnRleHQpIHtcblx0ICBjb250ZXh0ID0gY29udGV4dCB8fCBkb2N1bWVudDtcblx0ICB2YXIgcGFyc2VkO1xuXHRcblx0ICBpZiAoKHBhcnNlZCA9IFNJTkdMRV9UQUdfUkVHRVhQLmV4ZWMoaHRtbCkpKSB7XG5cdCAgICByZXR1cm4gW2NvbnRleHQuY3JlYXRlRWxlbWVudChwYXJzZWRbMV0pXTtcblx0ICB9XG5cdFxuXHQgIGlmICgocGFyc2VkID0ganFMaXRlQnVpbGRGcmFnbWVudChodG1sLCBjb250ZXh0KSkpIHtcblx0ICAgIHJldHVybiBwYXJzZWQuY2hpbGROb2Rlcztcblx0ICB9XG5cdFxuXHQgIHJldHVybiBbXTtcblx0fVxuXHRcblx0ZnVuY3Rpb24ganFMaXRlV3JhcE5vZGUobm9kZSwgd3JhcHBlcikge1xuXHQgIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudE5vZGU7XG5cdFxuXHQgIGlmIChwYXJlbnQpIHtcblx0ICAgIHBhcmVudC5yZXBsYWNlQ2hpbGQod3JhcHBlciwgbm9kZSk7XG5cdCAgfVxuXHRcblx0ICB3cmFwcGVyLmFwcGVuZENoaWxkKG5vZGUpO1xuXHR9XG5cdFxuXHRcblx0Ly8gSUU5LTExIGhhcyBubyBtZXRob2QgXCJjb250YWluc1wiIGluIFNWRyBlbGVtZW50IGFuZCBpbiBOb2RlLnByb3RvdHlwZS4gQnVnICMxMDI1OS5cblx0dmFyIGpxTGl0ZUNvbnRhaW5zID0gTm9kZS5wcm90b3R5cGUuY29udGFpbnMgfHwgZnVuY3Rpb24oYXJnKSB7XG5cdCAgLy8ganNoaW50IGJpdHdpc2U6IGZhbHNlXG5cdCAgcmV0dXJuICEhKHRoaXMuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYXJnKSAmIDE2KTtcblx0ICAvLyBqc2hpbnQgYml0d2lzZTogdHJ1ZVxuXHR9O1xuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdGZ1bmN0aW9uIEpRTGl0ZShlbGVtZW50KSB7XG5cdCAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBKUUxpdGUpIHtcblx0ICAgIHJldHVybiBlbGVtZW50O1xuXHQgIH1cblx0XG5cdCAgdmFyIGFyZ0lzU3RyaW5nO1xuXHRcblx0ICBpZiAoaXNTdHJpbmcoZWxlbWVudCkpIHtcblx0ICAgIGVsZW1lbnQgPSB0cmltKGVsZW1lbnQpO1xuXHQgICAgYXJnSXNTdHJpbmcgPSB0cnVlO1xuXHQgIH1cblx0ICBpZiAoISh0aGlzIGluc3RhbmNlb2YgSlFMaXRlKSkge1xuXHQgICAgaWYgKGFyZ0lzU3RyaW5nICYmIGVsZW1lbnQuY2hhckF0KDApICE9ICc8Jykge1xuXHQgICAgICB0aHJvdyBqcUxpdGVNaW5FcnIoJ25vc2VsJywgJ0xvb2tpbmcgdXAgZWxlbWVudHMgdmlhIHNlbGVjdG9ycyBpcyBub3Qgc3VwcG9ydGVkIGJ5IGpxTGl0ZSEgU2VlOiBodHRwOi8vZG9jcy5hbmd1bGFyanMub3JnL2FwaS9hbmd1bGFyLmVsZW1lbnQnKTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBuZXcgSlFMaXRlKGVsZW1lbnQpO1xuXHQgIH1cblx0XG5cdCAgaWYgKGFyZ0lzU3RyaW5nKSB7XG5cdCAgICBqcUxpdGVBZGROb2Rlcyh0aGlzLCBqcUxpdGVQYXJzZUhUTUwoZWxlbWVudCkpO1xuXHQgIH0gZWxzZSB7XG5cdCAgICBqcUxpdGVBZGROb2Rlcyh0aGlzLCBlbGVtZW50KTtcblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGpxTGl0ZUNsb25lKGVsZW1lbnQpIHtcblx0ICByZXR1cm4gZWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGpxTGl0ZURlYWxvYyhlbGVtZW50LCBvbmx5RGVzY2VuZGFudHMpIHtcblx0ICBpZiAoIW9ubHlEZXNjZW5kYW50cykganFMaXRlUmVtb3ZlRGF0YShlbGVtZW50KTtcblx0XG5cdCAgaWYgKGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCkge1xuXHQgICAgdmFyIGRlc2NlbmRhbnRzID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcqJyk7XG5cdCAgICBmb3IgKHZhciBpID0gMCwgbCA9IGRlc2NlbmRhbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuXHQgICAgICBqcUxpdGVSZW1vdmVEYXRhKGRlc2NlbmRhbnRzW2ldKTtcblx0ICAgIH1cblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGpxTGl0ZU9mZihlbGVtZW50LCB0eXBlLCBmbiwgdW5zdXBwb3J0ZWQpIHtcblx0ICBpZiAoaXNEZWZpbmVkKHVuc3VwcG9ydGVkKSkgdGhyb3cganFMaXRlTWluRXJyKCdvZmZhcmdzJywgJ2pxTGl0ZSNvZmYoKSBkb2VzIG5vdCBzdXBwb3J0IHRoZSBgc2VsZWN0b3JgIGFyZ3VtZW50Jyk7XG5cdFxuXHQgIHZhciBleHBhbmRvU3RvcmUgPSBqcUxpdGVFeHBhbmRvU3RvcmUoZWxlbWVudCk7XG5cdCAgdmFyIGV2ZW50cyA9IGV4cGFuZG9TdG9yZSAmJiBleHBhbmRvU3RvcmUuZXZlbnRzO1xuXHQgIHZhciBoYW5kbGUgPSBleHBhbmRvU3RvcmUgJiYgZXhwYW5kb1N0b3JlLmhhbmRsZTtcblx0XG5cdCAgaWYgKCFoYW5kbGUpIHJldHVybjsgLy9ubyBsaXN0ZW5lcnMgcmVnaXN0ZXJlZFxuXHRcblx0ICBpZiAoIXR5cGUpIHtcblx0ICAgIGZvciAodHlwZSBpbiBldmVudHMpIHtcblx0ICAgICAgaWYgKHR5cGUgIT09ICckZGVzdHJveScpIHtcblx0ICAgICAgICByZW1vdmVFdmVudExpc3RlbmVyRm4oZWxlbWVudCwgdHlwZSwgaGFuZGxlKTtcblx0ICAgICAgfVxuXHQgICAgICBkZWxldGUgZXZlbnRzW3R5cGVdO1xuXHQgICAgfVxuXHQgIH0gZWxzZSB7XG5cdFxuXHQgICAgdmFyIHJlbW92ZUhhbmRsZXIgPSBmdW5jdGlvbih0eXBlKSB7XG5cdCAgICAgIHZhciBsaXN0ZW5lckZucyA9IGV2ZW50c1t0eXBlXTtcblx0ICAgICAgaWYgKGlzRGVmaW5lZChmbikpIHtcblx0ICAgICAgICBhcnJheVJlbW92ZShsaXN0ZW5lckZucyB8fCBbXSwgZm4pO1xuXHQgICAgICB9XG5cdCAgICAgIGlmICghKGlzRGVmaW5lZChmbikgJiYgbGlzdGVuZXJGbnMgJiYgbGlzdGVuZXJGbnMubGVuZ3RoID4gMCkpIHtcblx0ICAgICAgICByZW1vdmVFdmVudExpc3RlbmVyRm4oZWxlbWVudCwgdHlwZSwgaGFuZGxlKTtcblx0ICAgICAgICBkZWxldGUgZXZlbnRzW3R5cGVdO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIGZvckVhY2godHlwZS5zcGxpdCgnICcpLCBmdW5jdGlvbih0eXBlKSB7XG5cdCAgICAgIHJlbW92ZUhhbmRsZXIodHlwZSk7XG5cdCAgICAgIGlmIChNT1VTRV9FVkVOVF9NQVBbdHlwZV0pIHtcblx0ICAgICAgICByZW1vdmVIYW5kbGVyKE1PVVNFX0VWRU5UX01BUFt0eXBlXSk7XG5cdCAgICAgIH1cblx0ICAgIH0pO1xuXHQgIH1cblx0fVxuXHRcblx0ZnVuY3Rpb24ganFMaXRlUmVtb3ZlRGF0YShlbGVtZW50LCBuYW1lKSB7XG5cdCAgdmFyIGV4cGFuZG9JZCA9IGVsZW1lbnQubmczMzk7XG5cdCAgdmFyIGV4cGFuZG9TdG9yZSA9IGV4cGFuZG9JZCAmJiBqcUNhY2hlW2V4cGFuZG9JZF07XG5cdFxuXHQgIGlmIChleHBhbmRvU3RvcmUpIHtcblx0ICAgIGlmIChuYW1lKSB7XG5cdCAgICAgIGRlbGV0ZSBleHBhbmRvU3RvcmUuZGF0YVtuYW1lXTtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmIChleHBhbmRvU3RvcmUuaGFuZGxlKSB7XG5cdCAgICAgIGlmIChleHBhbmRvU3RvcmUuZXZlbnRzLiRkZXN0cm95KSB7XG5cdCAgICAgICAgZXhwYW5kb1N0b3JlLmhhbmRsZSh7fSwgJyRkZXN0cm95Jyk7XG5cdCAgICAgIH1cblx0ICAgICAganFMaXRlT2ZmKGVsZW1lbnQpO1xuXHQgICAgfVxuXHQgICAgZGVsZXRlIGpxQ2FjaGVbZXhwYW5kb0lkXTtcblx0ICAgIGVsZW1lbnQubmczMzkgPSB1bmRlZmluZWQ7IC8vIGRvbid0IGRlbGV0ZSBET00gZXhwYW5kb3MuIElFIGFuZCBDaHJvbWUgZG9uJ3QgbGlrZSBpdFxuXHQgIH1cblx0fVxuXHRcblx0XG5cdGZ1bmN0aW9uIGpxTGl0ZUV4cGFuZG9TdG9yZShlbGVtZW50LCBjcmVhdGVJZk5lY2Vzc2FyeSkge1xuXHQgIHZhciBleHBhbmRvSWQgPSBlbGVtZW50Lm5nMzM5LFxuXHQgICAgICBleHBhbmRvU3RvcmUgPSBleHBhbmRvSWQgJiYganFDYWNoZVtleHBhbmRvSWRdO1xuXHRcblx0ICBpZiAoY3JlYXRlSWZOZWNlc3NhcnkgJiYgIWV4cGFuZG9TdG9yZSkge1xuXHQgICAgZWxlbWVudC5uZzMzOSA9IGV4cGFuZG9JZCA9IGpxTmV4dElkKCk7XG5cdCAgICBleHBhbmRvU3RvcmUgPSBqcUNhY2hlW2V4cGFuZG9JZF0gPSB7ZXZlbnRzOiB7fSwgZGF0YToge30sIGhhbmRsZTogdW5kZWZpbmVkfTtcblx0ICB9XG5cdFxuXHQgIHJldHVybiBleHBhbmRvU3RvcmU7XG5cdH1cblx0XG5cdFxuXHRmdW5jdGlvbiBqcUxpdGVEYXRhKGVsZW1lbnQsIGtleSwgdmFsdWUpIHtcblx0ICBpZiAoanFMaXRlQWNjZXB0c0RhdGEoZWxlbWVudCkpIHtcblx0XG5cdCAgICB2YXIgaXNTaW1wbGVTZXR0ZXIgPSBpc0RlZmluZWQodmFsdWUpO1xuXHQgICAgdmFyIGlzU2ltcGxlR2V0dGVyID0gIWlzU2ltcGxlU2V0dGVyICYmIGtleSAmJiAhaXNPYmplY3Qoa2V5KTtcblx0ICAgIHZhciBtYXNzR2V0dGVyID0gIWtleTtcblx0ICAgIHZhciBleHBhbmRvU3RvcmUgPSBqcUxpdGVFeHBhbmRvU3RvcmUoZWxlbWVudCwgIWlzU2ltcGxlR2V0dGVyKTtcblx0ICAgIHZhciBkYXRhID0gZXhwYW5kb1N0b3JlICYmIGV4cGFuZG9TdG9yZS5kYXRhO1xuXHRcblx0ICAgIGlmIChpc1NpbXBsZVNldHRlcikgeyAvLyBkYXRhKCdrZXknLCB2YWx1ZSlcblx0ICAgICAgZGF0YVtrZXldID0gdmFsdWU7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBpZiAobWFzc0dldHRlcikgeyAgLy8gZGF0YSgpXG5cdCAgICAgICAgcmV0dXJuIGRhdGE7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgaWYgKGlzU2ltcGxlR2V0dGVyKSB7IC8vIGRhdGEoJ2tleScpXG5cdCAgICAgICAgICAvLyBkb24ndCBmb3JjZSBjcmVhdGlvbiBvZiBleHBhbmRvU3RvcmUgaWYgaXQgZG9lc24ndCBleGlzdCB5ZXRcblx0ICAgICAgICAgIHJldHVybiBkYXRhICYmIGRhdGFba2V5XTtcblx0ICAgICAgICB9IGVsc2UgeyAvLyBtYXNzLXNldHRlcjogZGF0YSh7a2V5MTogdmFsMSwga2V5MjogdmFsMn0pXG5cdCAgICAgICAgICBleHRlbmQoZGF0YSwga2V5KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGpxTGl0ZUhhc0NsYXNzKGVsZW1lbnQsIHNlbGVjdG9yKSB7XG5cdCAgaWYgKCFlbGVtZW50LmdldEF0dHJpYnV0ZSkgcmV0dXJuIGZhbHNlO1xuXHQgIHJldHVybiAoKFwiIFwiICsgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdjbGFzcycpIHx8ICcnKSArIFwiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIikuXG5cdCAgICAgIGluZGV4T2YoXCIgXCIgKyBzZWxlY3RvciArIFwiIFwiKSA+IC0xKTtcblx0fVxuXHRcblx0ZnVuY3Rpb24ganFMaXRlUmVtb3ZlQ2xhc3MoZWxlbWVudCwgY3NzQ2xhc3Nlcykge1xuXHQgIGlmIChjc3NDbGFzc2VzICYmIGVsZW1lbnQuc2V0QXR0cmlidXRlKSB7XG5cdCAgICBmb3JFYWNoKGNzc0NsYXNzZXMuc3BsaXQoJyAnKSwgZnVuY3Rpb24oY3NzQ2xhc3MpIHtcblx0ICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgdHJpbShcblx0ICAgICAgICAgIChcIiBcIiArIChlbGVtZW50LmdldEF0dHJpYnV0ZSgnY2xhc3MnKSB8fCAnJykgKyBcIiBcIilcblx0ICAgICAgICAgIC5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIilcblx0ICAgICAgICAgIC5yZXBsYWNlKFwiIFwiICsgdHJpbShjc3NDbGFzcykgKyBcIiBcIiwgXCIgXCIpKVxuXHQgICAgICApO1xuXHQgICAgfSk7XG5cdCAgfVxuXHR9XG5cdFxuXHRmdW5jdGlvbiBqcUxpdGVBZGRDbGFzcyhlbGVtZW50LCBjc3NDbGFzc2VzKSB7XG5cdCAgaWYgKGNzc0NsYXNzZXMgJiYgZWxlbWVudC5zZXRBdHRyaWJ1dGUpIHtcblx0ICAgIHZhciBleGlzdGluZ0NsYXNzZXMgPSAoJyAnICsgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdjbGFzcycpIHx8ICcnKSArICcgJylcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIik7XG5cdFxuXHQgICAgZm9yRWFjaChjc3NDbGFzc2VzLnNwbGl0KCcgJyksIGZ1bmN0aW9uKGNzc0NsYXNzKSB7XG5cdCAgICAgIGNzc0NsYXNzID0gdHJpbShjc3NDbGFzcyk7XG5cdCAgICAgIGlmIChleGlzdGluZ0NsYXNzZXMuaW5kZXhPZignICcgKyBjc3NDbGFzcyArICcgJykgPT09IC0xKSB7XG5cdCAgICAgICAgZXhpc3RpbmdDbGFzc2VzICs9IGNzc0NsYXNzICsgJyAnO1xuXHQgICAgICB9XG5cdCAgICB9KTtcblx0XG5cdCAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnY2xhc3MnLCB0cmltKGV4aXN0aW5nQ2xhc3NlcykpO1xuXHQgIH1cblx0fVxuXHRcblx0XG5cdGZ1bmN0aW9uIGpxTGl0ZUFkZE5vZGVzKHJvb3QsIGVsZW1lbnRzKSB7XG5cdCAgLy8gVEhJUyBDT0RFIElTIFZFUlkgSE9ULiBEb24ndCBtYWtlIGNoYW5nZXMgd2l0aG91dCBiZW5jaG1hcmtpbmcuXG5cdFxuXHQgIGlmIChlbGVtZW50cykge1xuXHRcblx0ICAgIC8vIGlmIGEgTm9kZSAodGhlIG1vc3QgY29tbW9uIGNhc2UpXG5cdCAgICBpZiAoZWxlbWVudHMubm9kZVR5cGUpIHtcblx0ICAgICAgcm9vdFtyb290Lmxlbmd0aCsrXSA9IGVsZW1lbnRzO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdmFyIGxlbmd0aCA9IGVsZW1lbnRzLmxlbmd0aDtcblx0XG5cdCAgICAgIC8vIGlmIGFuIEFycmF5IG9yIE5vZGVMaXN0IGFuZCBub3QgYSBXaW5kb3dcblx0ICAgICAgaWYgKHR5cGVvZiBsZW5ndGggPT09ICdudW1iZXInICYmIGVsZW1lbnRzLndpbmRvdyAhPT0gZWxlbWVudHMpIHtcblx0ICAgICAgICBpZiAobGVuZ3RoKSB7XG5cdCAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICAgIHJvb3Rbcm9vdC5sZW5ndGgrK10gPSBlbGVtZW50c1tpXTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcm9vdFtyb290Lmxlbmd0aCsrXSA9IGVsZW1lbnRzO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfVxuXHR9XG5cdFxuXHRcblx0ZnVuY3Rpb24ganFMaXRlQ29udHJvbGxlcihlbGVtZW50LCBuYW1lKSB7XG5cdCAgcmV0dXJuIGpxTGl0ZUluaGVyaXRlZERhdGEoZWxlbWVudCwgJyQnICsgKG5hbWUgfHwgJ25nQ29udHJvbGxlcicpICsgJ0NvbnRyb2xsZXInKTtcblx0fVxuXHRcblx0ZnVuY3Rpb24ganFMaXRlSW5oZXJpdGVkRGF0YShlbGVtZW50LCBuYW1lLCB2YWx1ZSkge1xuXHQgIC8vIGlmIGVsZW1lbnQgaXMgdGhlIGRvY3VtZW50IG9iamVjdCB3b3JrIHdpdGggdGhlIGh0bWwgZWxlbWVudCBpbnN0ZWFkXG5cdCAgLy8gdGhpcyBtYWtlcyAkKGRvY3VtZW50KS5zY29wZSgpIHBvc3NpYmxlXG5cdCAgaWYgKGVsZW1lbnQubm9kZVR5cGUgPT0gTk9ERV9UWVBFX0RPQ1VNRU5UKSB7XG5cdCAgICBlbGVtZW50ID0gZWxlbWVudC5kb2N1bWVudEVsZW1lbnQ7XG5cdCAgfVxuXHQgIHZhciBuYW1lcyA9IGlzQXJyYXkobmFtZSkgPyBuYW1lIDogW25hbWVdO1xuXHRcblx0ICB3aGlsZSAoZWxlbWVudCkge1xuXHQgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gbmFtZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHQgICAgICBpZiAoaXNEZWZpbmVkKHZhbHVlID0ganFMaXRlLmRhdGEoZWxlbWVudCwgbmFtZXNbaV0pKSkgcmV0dXJuIHZhbHVlO1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIElmIGRlYWxpbmcgd2l0aCBhIGRvY3VtZW50IGZyYWdtZW50IG5vZGUgd2l0aCBhIGhvc3QgZWxlbWVudCwgYW5kIG5vIHBhcmVudCwgdXNlIHRoZSBob3N0XG5cdCAgICAvLyBlbGVtZW50IGFzIHRoZSBwYXJlbnQuIFRoaXMgZW5hYmxlcyBkaXJlY3RpdmVzIHdpdGhpbiBhIFNoYWRvdyBET00gb3IgcG9seWZpbGxlZCBTaGFkb3cgRE9NXG5cdCAgICAvLyB0byBsb29rdXAgcGFyZW50IGNvbnRyb2xsZXJzLlxuXHQgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50Tm9kZSB8fCAoZWxlbWVudC5ub2RlVHlwZSA9PT0gTk9ERV9UWVBFX0RPQ1VNRU5UX0ZSQUdNRU5UICYmIGVsZW1lbnQuaG9zdCk7XG5cdCAgfVxuXHR9XG5cdFxuXHRmdW5jdGlvbiBqcUxpdGVFbXB0eShlbGVtZW50KSB7XG5cdCAganFMaXRlRGVhbG9jKGVsZW1lbnQsIHRydWUpO1xuXHQgIHdoaWxlIChlbGVtZW50LmZpcnN0Q2hpbGQpIHtcblx0ICAgIGVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudC5maXJzdENoaWxkKTtcblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGpxTGl0ZVJlbW92ZShlbGVtZW50LCBrZWVwRGF0YSkge1xuXHQgIGlmICgha2VlcERhdGEpIGpxTGl0ZURlYWxvYyhlbGVtZW50KTtcblx0ICB2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnROb2RlO1xuXHQgIGlmIChwYXJlbnQpIHBhcmVudC5yZW1vdmVDaGlsZChlbGVtZW50KTtcblx0fVxuXHRcblx0XG5cdGZ1bmN0aW9uIGpxTGl0ZURvY3VtZW50TG9hZGVkKGFjdGlvbiwgd2luKSB7XG5cdCAgd2luID0gd2luIHx8IHdpbmRvdztcblx0ICBpZiAod2luLmRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHtcblx0ICAgIC8vIEZvcmNlIHRoZSBhY3Rpb24gdG8gYmUgcnVuIGFzeW5jIGZvciBjb25zaXN0ZW50IGJlaGF2aW9yXG5cdCAgICAvLyBmcm9tIHRoZSBhY3Rpb24ncyBwb2ludCBvZiB2aWV3XG5cdCAgICAvLyBpLmUuIGl0IHdpbGwgZGVmaW5pdGVseSBub3QgYmUgaW4gYSAkYXBwbHlcblx0ICAgIHdpbi5zZXRUaW1lb3V0KGFjdGlvbik7XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIE5vIG5lZWQgdG8gdW5iaW5kIHRoaXMgaGFuZGxlciBhcyBsb2FkIGlzIG9ubHkgZXZlciBjYWxsZWQgb25jZVxuXHQgICAganFMaXRlKHdpbikub24oJ2xvYWQnLCBhY3Rpb24pO1xuXHQgIH1cblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vIEZ1bmN0aW9ucyB3aGljaCBhcmUgZGVjbGFyZWQgZGlyZWN0bHkuXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHR2YXIgSlFMaXRlUHJvdG90eXBlID0gSlFMaXRlLnByb3RvdHlwZSA9IHtcblx0ICByZWFkeTogZnVuY3Rpb24oZm4pIHtcblx0ICAgIHZhciBmaXJlZCA9IGZhbHNlO1xuXHRcblx0ICAgIGZ1bmN0aW9uIHRyaWdnZXIoKSB7XG5cdCAgICAgIGlmIChmaXJlZCkgcmV0dXJuO1xuXHQgICAgICBmaXJlZCA9IHRydWU7XG5cdCAgICAgIGZuKCk7XG5cdCAgICB9XG5cdFxuXHQgICAgLy8gY2hlY2sgaWYgZG9jdW1lbnQgaXMgYWxyZWFkeSBsb2FkZWRcblx0ICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnY29tcGxldGUnKSB7XG5cdCAgICAgIHNldFRpbWVvdXQodHJpZ2dlcik7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB0aGlzLm9uKCdET01Db250ZW50TG9hZGVkJywgdHJpZ2dlcik7IC8vIHdvcmtzIGZvciBtb2Rlcm4gYnJvd3NlcnMgYW5kIElFOVxuXHQgICAgICAvLyB3ZSBjYW4gbm90IHVzZSBqcUxpdGUgc2luY2Ugd2UgYXJlIG5vdCBkb25lIGxvYWRpbmcgYW5kIGpRdWVyeSBjb3VsZCBiZSBsb2FkZWQgbGF0ZXIuXG5cdCAgICAgIC8vIGpzaGludCAtVzA2NFxuXHQgICAgICBKUUxpdGUod2luZG93KS5vbignbG9hZCcsIHRyaWdnZXIpOyAvLyBmYWxsYmFjayB0byB3aW5kb3cub25sb2FkIGZvciBvdGhlcnNcblx0ICAgICAgLy8ganNoaW50ICtXMDY0XG5cdCAgICB9XG5cdCAgfSxcblx0ICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgdmFsdWUgPSBbXTtcblx0ICAgIGZvckVhY2godGhpcywgZnVuY3Rpb24oZSkgeyB2YWx1ZS5wdXNoKCcnICsgZSk7fSk7XG5cdCAgICByZXR1cm4gJ1snICsgdmFsdWUuam9pbignLCAnKSArICddJztcblx0ICB9LFxuXHRcblx0ICBlcTogZnVuY3Rpb24oaW5kZXgpIHtcblx0ICAgICAgcmV0dXJuIChpbmRleCA+PSAwKSA/IGpxTGl0ZSh0aGlzW2luZGV4XSkgOiBqcUxpdGUodGhpc1t0aGlzLmxlbmd0aCArIGluZGV4XSk7XG5cdCAgfSxcblx0XG5cdCAgbGVuZ3RoOiAwLFxuXHQgIHB1c2g6IHB1c2gsXG5cdCAgc29ydDogW10uc29ydCxcblx0ICBzcGxpY2U6IFtdLnNwbGljZVxuXHR9O1xuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdC8vIEZ1bmN0aW9ucyBpdGVyYXRpbmcgZ2V0dGVyL3NldHRlcnMuXG5cdC8vIHRoZXNlIGZ1bmN0aW9ucyByZXR1cm4gc2VsZiBvbiBzZXR0ZXIgYW5kXG5cdC8vIHZhbHVlIG9uIGdldC5cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdHZhciBCT09MRUFOX0FUVFIgPSB7fTtcblx0Zm9yRWFjaCgnbXVsdGlwbGUsc2VsZWN0ZWQsY2hlY2tlZCxkaXNhYmxlZCxyZWFkT25seSxyZXF1aXJlZCxvcGVuJy5zcGxpdCgnLCcpLCBmdW5jdGlvbih2YWx1ZSkge1xuXHQgIEJPT0xFQU5fQVRUUltsb3dlcmNhc2UodmFsdWUpXSA9IHZhbHVlO1xuXHR9KTtcblx0dmFyIEJPT0xFQU5fRUxFTUVOVFMgPSB7fTtcblx0Zm9yRWFjaCgnaW5wdXQsc2VsZWN0LG9wdGlvbix0ZXh0YXJlYSxidXR0b24sZm9ybSxkZXRhaWxzJy5zcGxpdCgnLCcpLCBmdW5jdGlvbih2YWx1ZSkge1xuXHQgIEJPT0xFQU5fRUxFTUVOVFNbdmFsdWVdID0gdHJ1ZTtcblx0fSk7XG5cdHZhciBBTElBU0VEX0FUVFIgPSB7XG5cdCAgJ25nTWlubGVuZ3RoJzogJ21pbmxlbmd0aCcsXG5cdCAgJ25nTWF4bGVuZ3RoJzogJ21heGxlbmd0aCcsXG5cdCAgJ25nTWluJzogJ21pbicsXG5cdCAgJ25nTWF4JzogJ21heCcsXG5cdCAgJ25nUGF0dGVybic6ICdwYXR0ZXJuJ1xuXHR9O1xuXHRcblx0ZnVuY3Rpb24gZ2V0Qm9vbGVhbkF0dHJOYW1lKGVsZW1lbnQsIG5hbWUpIHtcblx0ICAvLyBjaGVjayBkb20gbGFzdCBzaW5jZSB3ZSB3aWxsIG1vc3QgbGlrZWx5IGZhaWwgb24gbmFtZVxuXHQgIHZhciBib29sZWFuQXR0ciA9IEJPT0xFQU5fQVRUUltuYW1lLnRvTG93ZXJDYXNlKCldO1xuXHRcblx0ICAvLyBib29sZWFuQXR0ciBpcyBoZXJlIHR3aWNlIHRvIG1pbmltaXplIERPTSBhY2Nlc3Ncblx0ICByZXR1cm4gYm9vbGVhbkF0dHIgJiYgQk9PTEVBTl9FTEVNRU5UU1tub2RlTmFtZV8oZWxlbWVudCldICYmIGJvb2xlYW5BdHRyO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBnZXRBbGlhc2VkQXR0ck5hbWUobmFtZSkge1xuXHQgIHJldHVybiBBTElBU0VEX0FUVFJbbmFtZV07XG5cdH1cblx0XG5cdGZvckVhY2goe1xuXHQgIGRhdGE6IGpxTGl0ZURhdGEsXG5cdCAgcmVtb3ZlRGF0YToganFMaXRlUmVtb3ZlRGF0YSxcblx0ICBoYXNEYXRhOiBqcUxpdGVIYXNEYXRhLFxuXHQgIGNsZWFuRGF0YToganFMaXRlQ2xlYW5EYXRhXG5cdH0sIGZ1bmN0aW9uKGZuLCBuYW1lKSB7XG5cdCAgSlFMaXRlW25hbWVdID0gZm47XG5cdH0pO1xuXHRcblx0Zm9yRWFjaCh7XG5cdCAgZGF0YToganFMaXRlRGF0YSxcblx0ICBpbmhlcml0ZWREYXRhOiBqcUxpdGVJbmhlcml0ZWREYXRhLFxuXHRcblx0ICBzY29wZTogZnVuY3Rpb24oZWxlbWVudCkge1xuXHQgICAgLy8gQ2FuJ3QgdXNlIGpxTGl0ZURhdGEgaGVyZSBkaXJlY3RseSBzbyB3ZSBzdGF5IGNvbXBhdGlibGUgd2l0aCBqUXVlcnkhXG5cdCAgICByZXR1cm4ganFMaXRlLmRhdGEoZWxlbWVudCwgJyRzY29wZScpIHx8IGpxTGl0ZUluaGVyaXRlZERhdGEoZWxlbWVudC5wYXJlbnROb2RlIHx8IGVsZW1lbnQsIFsnJGlzb2xhdGVTY29wZScsICckc2NvcGUnXSk7XG5cdCAgfSxcblx0XG5cdCAgaXNvbGF0ZVNjb3BlOiBmdW5jdGlvbihlbGVtZW50KSB7XG5cdCAgICAvLyBDYW4ndCB1c2UganFMaXRlRGF0YSBoZXJlIGRpcmVjdGx5IHNvIHdlIHN0YXkgY29tcGF0aWJsZSB3aXRoIGpRdWVyeSFcblx0ICAgIHJldHVybiBqcUxpdGUuZGF0YShlbGVtZW50LCAnJGlzb2xhdGVTY29wZScpIHx8IGpxTGl0ZS5kYXRhKGVsZW1lbnQsICckaXNvbGF0ZVNjb3BlTm9UZW1wbGF0ZScpO1xuXHQgIH0sXG5cdFxuXHQgIGNvbnRyb2xsZXI6IGpxTGl0ZUNvbnRyb2xsZXIsXG5cdFxuXHQgIGluamVjdG9yOiBmdW5jdGlvbihlbGVtZW50KSB7XG5cdCAgICByZXR1cm4ganFMaXRlSW5oZXJpdGVkRGF0YShlbGVtZW50LCAnJGluamVjdG9yJyk7XG5cdCAgfSxcblx0XG5cdCAgcmVtb3ZlQXR0cjogZnVuY3Rpb24oZWxlbWVudCwgbmFtZSkge1xuXHQgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XG5cdCAgfSxcblx0XG5cdCAgaGFzQ2xhc3M6IGpxTGl0ZUhhc0NsYXNzLFxuXHRcblx0ICBjc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIG5hbWUsIHZhbHVlKSB7XG5cdCAgICBuYW1lID0gY2FtZWxDYXNlKG5hbWUpO1xuXHRcblx0ICAgIGlmIChpc0RlZmluZWQodmFsdWUpKSB7XG5cdCAgICAgIGVsZW1lbnQuc3R5bGVbbmFtZV0gPSB2YWx1ZTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHJldHVybiBlbGVtZW50LnN0eWxlW25hbWVdO1xuXHQgICAgfVxuXHQgIH0sXG5cdFxuXHQgIGF0dHI6IGZ1bmN0aW9uKGVsZW1lbnQsIG5hbWUsIHZhbHVlKSB7XG5cdCAgICB2YXIgbm9kZVR5cGUgPSBlbGVtZW50Lm5vZGVUeXBlO1xuXHQgICAgaWYgKG5vZGVUeXBlID09PSBOT0RFX1RZUEVfVEVYVCB8fCBub2RlVHlwZSA9PT0gTk9ERV9UWVBFX0FUVFJJQlVURSB8fCBub2RlVHlwZSA9PT0gTk9ERV9UWVBFX0NPTU1FTlQpIHtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHQgICAgdmFyIGxvd2VyY2FzZWROYW1lID0gbG93ZXJjYXNlKG5hbWUpO1xuXHQgICAgaWYgKEJPT0xFQU5fQVRUUltsb3dlcmNhc2VkTmFtZV0pIHtcblx0ICAgICAgaWYgKGlzRGVmaW5lZCh2YWx1ZSkpIHtcblx0ICAgICAgICBpZiAoISF2YWx1ZSkge1xuXHQgICAgICAgICAgZWxlbWVudFtuYW1lXSA9IHRydWU7XG5cdCAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShuYW1lLCBsb3dlcmNhc2VkTmFtZSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGVsZW1lbnRbbmFtZV0gPSBmYWxzZTtcblx0ICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKGxvd2VyY2FzZWROYW1lKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIChlbGVtZW50W25hbWVdIHx8XG5cdCAgICAgICAgICAgICAgICAgKGVsZW1lbnQuYXR0cmlidXRlcy5nZXROYW1lZEl0ZW0obmFtZSkgfHwgbm9vcCkuc3BlY2lmaWVkKVxuXHQgICAgICAgICAgICAgICA/IGxvd2VyY2FzZWROYW1lXG5cdCAgICAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuXHQgICAgICB9XG5cdCAgICB9IGVsc2UgaWYgKGlzRGVmaW5lZCh2YWx1ZSkpIHtcblx0ICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUobmFtZSwgdmFsdWUpO1xuXHQgICAgfSBlbHNlIGlmIChlbGVtZW50LmdldEF0dHJpYnV0ZSkge1xuXHQgICAgICAvLyB0aGUgZXh0cmEgYXJndW1lbnQgXCIyXCIgaXMgdG8gZ2V0IHRoZSByaWdodCB0aGluZyBmb3IgYS5ocmVmIGluIElFLCBzZWUgalF1ZXJ5IGNvZGVcblx0ICAgICAgLy8gc29tZSBlbGVtZW50cyAoZS5nLiBEb2N1bWVudCkgZG9uJ3QgaGF2ZSBnZXQgYXR0cmlidXRlLCBzbyByZXR1cm4gdW5kZWZpbmVkXG5cdCAgICAgIHZhciByZXQgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShuYW1lLCAyKTtcblx0ICAgICAgLy8gbm9ybWFsaXplIG5vbi1leGlzdGluZyBhdHRyaWJ1dGVzIHRvIHVuZGVmaW5lZCAoYXMgalF1ZXJ5KVxuXHQgICAgICByZXR1cm4gcmV0ID09PSBudWxsID8gdW5kZWZpbmVkIDogcmV0O1xuXHQgICAgfVxuXHQgIH0sXG5cdFxuXHQgIHByb3A6IGZ1bmN0aW9uKGVsZW1lbnQsIG5hbWUsIHZhbHVlKSB7XG5cdCAgICBpZiAoaXNEZWZpbmVkKHZhbHVlKSkge1xuXHQgICAgICBlbGVtZW50W25hbWVdID0gdmFsdWU7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICByZXR1cm4gZWxlbWVudFtuYW1lXTtcblx0ICAgIH1cblx0ICB9LFxuXHRcblx0ICB0ZXh0OiAoZnVuY3Rpb24oKSB7XG5cdCAgICBnZXRUZXh0LiRkdiA9ICcnO1xuXHQgICAgcmV0dXJuIGdldFRleHQ7XG5cdFxuXHQgICAgZnVuY3Rpb24gZ2V0VGV4dChlbGVtZW50LCB2YWx1ZSkge1xuXHQgICAgICBpZiAoaXNVbmRlZmluZWQodmFsdWUpKSB7XG5cdCAgICAgICAgdmFyIG5vZGVUeXBlID0gZWxlbWVudC5ub2RlVHlwZTtcblx0ICAgICAgICByZXR1cm4gKG5vZGVUeXBlID09PSBOT0RFX1RZUEVfRUxFTUVOVCB8fCBub2RlVHlwZSA9PT0gTk9ERV9UWVBFX1RFWFQpID8gZWxlbWVudC50ZXh0Q29udGVudCA6ICcnO1xuXHQgICAgICB9XG5cdCAgICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSB2YWx1ZTtcblx0ICAgIH1cblx0ICB9KSgpLFxuXHRcblx0ICB2YWw6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlKSB7XG5cdCAgICBpZiAoaXNVbmRlZmluZWQodmFsdWUpKSB7XG5cdCAgICAgIGlmIChlbGVtZW50Lm11bHRpcGxlICYmIG5vZGVOYW1lXyhlbGVtZW50KSA9PT0gJ3NlbGVjdCcpIHtcblx0ICAgICAgICB2YXIgcmVzdWx0ID0gW107XG5cdCAgICAgICAgZm9yRWFjaChlbGVtZW50Lm9wdGlvbnMsIGZ1bmN0aW9uKG9wdGlvbikge1xuXHQgICAgICAgICAgaWYgKG9wdGlvbi5zZWxlY3RlZCkge1xuXHQgICAgICAgICAgICByZXN1bHQucHVzaChvcHRpb24udmFsdWUgfHwgb3B0aW9uLnRleHQpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHJldHVybiByZXN1bHQubGVuZ3RoID09PSAwID8gbnVsbCA6IHJlc3VsdDtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gZWxlbWVudC52YWx1ZTtcblx0ICAgIH1cblx0ICAgIGVsZW1lbnQudmFsdWUgPSB2YWx1ZTtcblx0ICB9LFxuXHRcblx0ICBodG1sOiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZSkge1xuXHQgICAgaWYgKGlzVW5kZWZpbmVkKHZhbHVlKSkge1xuXHQgICAgICByZXR1cm4gZWxlbWVudC5pbm5lckhUTUw7XG5cdCAgICB9XG5cdCAgICBqcUxpdGVEZWFsb2MoZWxlbWVudCwgdHJ1ZSk7XG5cdCAgICBlbGVtZW50LmlubmVySFRNTCA9IHZhbHVlO1xuXHQgIH0sXG5cdFxuXHQgIGVtcHR5OiBqcUxpdGVFbXB0eVxuXHR9LCBmdW5jdGlvbihmbiwgbmFtZSkge1xuXHQgIC8qKlxuXHQgICAqIFByb3BlcnRpZXM6IHdyaXRlcyByZXR1cm4gc2VsZWN0aW9uLCByZWFkcyByZXR1cm4gZmlyc3QgdmFsdWVcblx0ICAgKi9cblx0ICBKUUxpdGUucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oYXJnMSwgYXJnMikge1xuXHQgICAgdmFyIGksIGtleTtcblx0ICAgIHZhciBub2RlQ291bnQgPSB0aGlzLmxlbmd0aDtcblx0XG5cdCAgICAvLyBqcUxpdGVIYXNDbGFzcyBoYXMgb25seSB0d28gYXJndW1lbnRzLCBidXQgaXMgYSBnZXR0ZXItb25seSBmbiwgc28gd2UgbmVlZCB0byBzcGVjaWFsLWNhc2UgaXRcblx0ICAgIC8vIGluIGEgd2F5IHRoYXQgc3Vydml2ZXMgbWluaWZpY2F0aW9uLlxuXHQgICAgLy8ganFMaXRlRW1wdHkgdGFrZXMgbm8gYXJndW1lbnRzIGJ1dCBpcyBhIHNldHRlci5cblx0ICAgIGlmIChmbiAhPT0ganFMaXRlRW1wdHkgJiZcblx0ICAgICAgICAoaXNVbmRlZmluZWQoKGZuLmxlbmd0aCA9PSAyICYmIChmbiAhPT0ganFMaXRlSGFzQ2xhc3MgJiYgZm4gIT09IGpxTGl0ZUNvbnRyb2xsZXIpKSA/IGFyZzEgOiBhcmcyKSkpIHtcblx0ICAgICAgaWYgKGlzT2JqZWN0KGFyZzEpKSB7XG5cdFxuXHQgICAgICAgIC8vIHdlIGFyZSBhIHdyaXRlLCBidXQgdGhlIG9iamVjdCBwcm9wZXJ0aWVzIGFyZSB0aGUga2V5L3ZhbHVlc1xuXHQgICAgICAgIGZvciAoaSA9IDA7IGkgPCBub2RlQ291bnQ7IGkrKykge1xuXHQgICAgICAgICAgaWYgKGZuID09PSBqcUxpdGVEYXRhKSB7XG5cdCAgICAgICAgICAgIC8vIGRhdGEoKSB0YWtlcyB0aGUgd2hvbGUgb2JqZWN0IGluIGpRdWVyeVxuXHQgICAgICAgICAgICBmbih0aGlzW2ldLCBhcmcxKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGZvciAoa2V5IGluIGFyZzEpIHtcblx0ICAgICAgICAgICAgICBmbih0aGlzW2ldLCBrZXksIGFyZzFba2V5XSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgLy8gcmV0dXJuIHNlbGYgZm9yIGNoYWluaW5nXG5cdCAgICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgLy8gd2UgYXJlIGEgcmVhZCwgc28gcmVhZCB0aGUgZmlyc3QgY2hpbGQuXG5cdCAgICAgICAgLy8gVE9ETzogZG8gd2Ugc3RpbGwgbmVlZCB0aGlzP1xuXHQgICAgICAgIHZhciB2YWx1ZSA9IGZuLiRkdjtcblx0ICAgICAgICAvLyBPbmx5IGlmIHdlIGhhdmUgJGR2IGRvIHdlIGl0ZXJhdGUgb3ZlciBhbGwsIG90aGVyd2lzZSBpdCBpcyBqdXN0IHRoZSBmaXJzdCBlbGVtZW50LlxuXHQgICAgICAgIHZhciBqaiA9IChpc1VuZGVmaW5lZCh2YWx1ZSkpID8gTWF0aC5taW4obm9kZUNvdW50LCAxKSA6IG5vZGVDb3VudDtcblx0ICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGpqOyBqKyspIHtcblx0ICAgICAgICAgIHZhciBub2RlVmFsdWUgPSBmbih0aGlzW2pdLCBhcmcxLCBhcmcyKTtcblx0ICAgICAgICAgIHZhbHVlID0gdmFsdWUgPyB2YWx1ZSArIG5vZGVWYWx1ZSA6IG5vZGVWYWx1ZTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIHZhbHVlO1xuXHQgICAgICB9XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICAvLyB3ZSBhcmUgYSB3cml0ZSwgc28gYXBwbHkgdG8gYWxsIGNoaWxkcmVuXG5cdCAgICAgIGZvciAoaSA9IDA7IGkgPCBub2RlQ291bnQ7IGkrKykge1xuXHQgICAgICAgIGZuKHRoaXNbaV0sIGFyZzEsIGFyZzIpO1xuXHQgICAgICB9XG5cdCAgICAgIC8vIHJldHVybiBzZWxmIGZvciBjaGFpbmluZ1xuXHQgICAgICByZXR1cm4gdGhpcztcblx0ICAgIH1cblx0ICB9O1xuXHR9KTtcblx0XG5cdGZ1bmN0aW9uIGNyZWF0ZUV2ZW50SGFuZGxlcihlbGVtZW50LCBldmVudHMpIHtcblx0ICB2YXIgZXZlbnRIYW5kbGVyID0gZnVuY3Rpb24oZXZlbnQsIHR5cGUpIHtcblx0ICAgIC8vIGpRdWVyeSBzcGVjaWZpYyBhcGlcblx0ICAgIGV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICByZXR1cm4gZXZlbnQuZGVmYXVsdFByZXZlbnRlZDtcblx0ICAgIH07XG5cdFxuXHQgICAgdmFyIGV2ZW50Rm5zID0gZXZlbnRzW3R5cGUgfHwgZXZlbnQudHlwZV07XG5cdCAgICB2YXIgZXZlbnRGbnNMZW5ndGggPSBldmVudEZucyA/IGV2ZW50Rm5zLmxlbmd0aCA6IDA7XG5cdFxuXHQgICAgaWYgKCFldmVudEZuc0xlbmd0aCkgcmV0dXJuO1xuXHRcblx0ICAgIGlmIChpc1VuZGVmaW5lZChldmVudC5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQpKSB7XG5cdCAgICAgIHZhciBvcmlnaW5hbFN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiA9IGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjtcblx0ICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgZXZlbnQuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gdHJ1ZTtcblx0XG5cdCAgICAgICAgaWYgKGV2ZW50LnN0b3BQcm9wYWdhdGlvbikge1xuXHQgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAob3JpZ2luYWxTdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24pIHtcblx0ICAgICAgICAgIG9yaWdpbmFsU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uLmNhbGwoZXZlbnQpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBldmVudC5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICByZXR1cm4gZXZlbnQuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID09PSB0cnVlO1xuXHQgICAgfTtcblx0XG5cdCAgICAvLyBTb21lIGV2ZW50cyBoYXZlIHNwZWNpYWwgaGFuZGxlcnMgdGhhdCB3cmFwIHRoZSByZWFsIGhhbmRsZXJcblx0ICAgIHZhciBoYW5kbGVyV3JhcHBlciA9IGV2ZW50Rm5zLnNwZWNpYWxIYW5kbGVyV3JhcHBlciB8fCBkZWZhdWx0SGFuZGxlcldyYXBwZXI7XG5cdFxuXHQgICAgLy8gQ29weSBldmVudCBoYW5kbGVycyBpbiBjYXNlIGV2ZW50IGhhbmRsZXJzIGFycmF5IGlzIG1vZGlmaWVkIGR1cmluZyBleGVjdXRpb24uXG5cdCAgICBpZiAoKGV2ZW50Rm5zTGVuZ3RoID4gMSkpIHtcblx0ICAgICAgZXZlbnRGbnMgPSBzaGFsbG93Q29weShldmVudEZucyk7XG5cdCAgICB9XG5cdFxuXHQgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudEZuc0xlbmd0aDsgaSsrKSB7XG5cdCAgICAgIGlmICghZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSkge1xuXHQgICAgICAgIGhhbmRsZXJXcmFwcGVyKGVsZW1lbnQsIGV2ZW50LCBldmVudEZuc1tpXSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvLyBUT0RPOiB0aGlzIGlzIGEgaGFjayBmb3IgYW5ndWxhck1vY2tzL2NsZWFyRGF0YUNhY2hlIHRoYXQgbWFrZXMgaXQgcG9zc2libGUgdG8gZGVyZWdpc3RlciBhbGxcblx0ICAvLyAgICAgICBldmVudHMgb24gYGVsZW1lbnRgXG5cdCAgZXZlbnRIYW5kbGVyLmVsZW0gPSBlbGVtZW50O1xuXHQgIHJldHVybiBldmVudEhhbmRsZXI7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGRlZmF1bHRIYW5kbGVyV3JhcHBlcihlbGVtZW50LCBldmVudCwgaGFuZGxlcikge1xuXHQgIGhhbmRsZXIuY2FsbChlbGVtZW50LCBldmVudCk7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHNwZWNpYWxNb3VzZUhhbmRsZXJXcmFwcGVyKHRhcmdldCwgZXZlbnQsIGhhbmRsZXIpIHtcblx0ICAvLyBSZWZlciB0byBqUXVlcnkncyBpbXBsZW1lbnRhdGlvbiBvZiBtb3VzZWVudGVyICYgbW91c2VsZWF2ZVxuXHQgIC8vIFJlYWQgYWJvdXQgbW91c2VlbnRlciBhbmQgbW91c2VsZWF2ZTpcblx0ICAvLyBodHRwOi8vd3d3LnF1aXJrc21vZGUub3JnL2pzL2V2ZW50c19tb3VzZS5odG1sI2xpbms4XG5cdCAgdmFyIHJlbGF0ZWQgPSBldmVudC5yZWxhdGVkVGFyZ2V0O1xuXHQgIC8vIEZvciBtb3VzZW50ZXIvbGVhdmUgY2FsbCB0aGUgaGFuZGxlciBpZiByZWxhdGVkIGlzIG91dHNpZGUgdGhlIHRhcmdldC5cblx0ICAvLyBOQjogTm8gcmVsYXRlZFRhcmdldCBpZiB0aGUgbW91c2UgbGVmdC9lbnRlcmVkIHRoZSBicm93c2VyIHdpbmRvd1xuXHQgIGlmICghcmVsYXRlZCB8fCAocmVsYXRlZCAhPT0gdGFyZ2V0ICYmICFqcUxpdGVDb250YWlucy5jYWxsKHRhcmdldCwgcmVsYXRlZCkpKSB7XG5cdCAgICBoYW5kbGVyLmNhbGwodGFyZ2V0LCBldmVudCk7XG5cdCAgfVxuXHR9XG5cdFxuXHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8gRnVuY3Rpb25zIGl0ZXJhdGluZyB0cmF2ZXJzYWwuXG5cdC8vIFRoZXNlIGZ1bmN0aW9ucyBjaGFpbiByZXN1bHRzIGludG8gYSBzaW5nbGVcblx0Ly8gc2VsZWN0b3IuXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRmb3JFYWNoKHtcblx0ICByZW1vdmVEYXRhOiBqcUxpdGVSZW1vdmVEYXRhLFxuXHRcblx0ICBvbjogZnVuY3Rpb24ganFMaXRlT24oZWxlbWVudCwgdHlwZSwgZm4sIHVuc3VwcG9ydGVkKSB7XG5cdCAgICBpZiAoaXNEZWZpbmVkKHVuc3VwcG9ydGVkKSkgdGhyb3cganFMaXRlTWluRXJyKCdvbmFyZ3MnLCAnanFMaXRlI29uKCkgZG9lcyBub3Qgc3VwcG9ydCB0aGUgYHNlbGVjdG9yYCBvciBgZXZlbnREYXRhYCBwYXJhbWV0ZXJzJyk7XG5cdFxuXHQgICAgLy8gRG8gbm90IGFkZCBldmVudCBoYW5kbGVycyB0byBub24tZWxlbWVudHMgYmVjYXVzZSB0aGV5IHdpbGwgbm90IGJlIGNsZWFuZWQgdXAuXG5cdCAgICBpZiAoIWpxTGl0ZUFjY2VwdHNEYXRhKGVsZW1lbnQpKSB7XG5cdCAgICAgIHJldHVybjtcblx0ICAgIH1cblx0XG5cdCAgICB2YXIgZXhwYW5kb1N0b3JlID0ganFMaXRlRXhwYW5kb1N0b3JlKGVsZW1lbnQsIHRydWUpO1xuXHQgICAgdmFyIGV2ZW50cyA9IGV4cGFuZG9TdG9yZS5ldmVudHM7XG5cdCAgICB2YXIgaGFuZGxlID0gZXhwYW5kb1N0b3JlLmhhbmRsZTtcblx0XG5cdCAgICBpZiAoIWhhbmRsZSkge1xuXHQgICAgICBoYW5kbGUgPSBleHBhbmRvU3RvcmUuaGFuZGxlID0gY3JlYXRlRXZlbnRIYW5kbGVyKGVsZW1lbnQsIGV2ZW50cyk7XG5cdCAgICB9XG5cdFxuXHQgICAgLy8gaHR0cDovL2pzcGVyZi5jb20vc3RyaW5nLWluZGV4b2YtdnMtc3BsaXRcblx0ICAgIHZhciB0eXBlcyA9IHR5cGUuaW5kZXhPZignICcpID49IDAgPyB0eXBlLnNwbGl0KCcgJykgOiBbdHlwZV07XG5cdCAgICB2YXIgaSA9IHR5cGVzLmxlbmd0aDtcblx0XG5cdCAgICB2YXIgYWRkSGFuZGxlciA9IGZ1bmN0aW9uKHR5cGUsIHNwZWNpYWxIYW5kbGVyV3JhcHBlciwgbm9FdmVudExpc3RlbmVyKSB7XG5cdCAgICAgIHZhciBldmVudEZucyA9IGV2ZW50c1t0eXBlXTtcblx0XG5cdCAgICAgIGlmICghZXZlbnRGbnMpIHtcblx0ICAgICAgICBldmVudEZucyA9IGV2ZW50c1t0eXBlXSA9IFtdO1xuXHQgICAgICAgIGV2ZW50Rm5zLnNwZWNpYWxIYW5kbGVyV3JhcHBlciA9IHNwZWNpYWxIYW5kbGVyV3JhcHBlcjtcblx0ICAgICAgICBpZiAodHlwZSAhPT0gJyRkZXN0cm95JyAmJiAhbm9FdmVudExpc3RlbmVyKSB7XG5cdCAgICAgICAgICBhZGRFdmVudExpc3RlbmVyRm4oZWxlbWVudCwgdHlwZSwgaGFuZGxlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGV2ZW50Rm5zLnB1c2goZm4pO1xuXHQgICAgfTtcblx0XG5cdCAgICB3aGlsZSAoaS0tKSB7XG5cdCAgICAgIHR5cGUgPSB0eXBlc1tpXTtcblx0ICAgICAgaWYgKE1PVVNFX0VWRU5UX01BUFt0eXBlXSkge1xuXHQgICAgICAgIGFkZEhhbmRsZXIoTU9VU0VfRVZFTlRfTUFQW3R5cGVdLCBzcGVjaWFsTW91c2VIYW5kbGVyV3JhcHBlcik7XG5cdCAgICAgICAgYWRkSGFuZGxlcih0eXBlLCB1bmRlZmluZWQsIHRydWUpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGFkZEhhbmRsZXIodHlwZSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9LFxuXHRcblx0ICBvZmY6IGpxTGl0ZU9mZixcblx0XG5cdCAgb25lOiBmdW5jdGlvbihlbGVtZW50LCB0eXBlLCBmbikge1xuXHQgICAgZWxlbWVudCA9IGpxTGl0ZShlbGVtZW50KTtcblx0XG5cdCAgICAvL2FkZCB0aGUgbGlzdGVuZXIgdHdpY2Ugc28gdGhhdCB3aGVuIGl0IGlzIGNhbGxlZFxuXHQgICAgLy95b3UgY2FuIHJlbW92ZSB0aGUgb3JpZ2luYWwgZnVuY3Rpb24gYW5kIHN0aWxsIGJlXG5cdCAgICAvL2FibGUgdG8gY2FsbCBlbGVtZW50Lm9mZihldiwgZm4pIG5vcm1hbGx5XG5cdCAgICBlbGVtZW50Lm9uKHR5cGUsIGZ1bmN0aW9uIG9uRm4oKSB7XG5cdCAgICAgIGVsZW1lbnQub2ZmKHR5cGUsIGZuKTtcblx0ICAgICAgZWxlbWVudC5vZmYodHlwZSwgb25Gbik7XG5cdCAgICB9KTtcblx0ICAgIGVsZW1lbnQub24odHlwZSwgZm4pO1xuXHQgIH0sXG5cdFxuXHQgIHJlcGxhY2VXaXRoOiBmdW5jdGlvbihlbGVtZW50LCByZXBsYWNlTm9kZSkge1xuXHQgICAgdmFyIGluZGV4LCBwYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG5cdCAgICBqcUxpdGVEZWFsb2MoZWxlbWVudCk7XG5cdCAgICBmb3JFYWNoKG5ldyBKUUxpdGUocmVwbGFjZU5vZGUpLCBmdW5jdGlvbihub2RlKSB7XG5cdCAgICAgIGlmIChpbmRleCkge1xuXHQgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUobm9kZSwgaW5kZXgubmV4dFNpYmxpbmcpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHBhcmVudC5yZXBsYWNlQ2hpbGQobm9kZSwgZWxlbWVudCk7XG5cdCAgICAgIH1cblx0ICAgICAgaW5kZXggPSBub2RlO1xuXHQgICAgfSk7XG5cdCAgfSxcblx0XG5cdCAgY2hpbGRyZW46IGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0ICAgIHZhciBjaGlsZHJlbiA9IFtdO1xuXHQgICAgZm9yRWFjaChlbGVtZW50LmNoaWxkTm9kZXMsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0ICAgICAgaWYgKGVsZW1lbnQubm9kZVR5cGUgPT09IE5PREVfVFlQRV9FTEVNRU5UKSB7XG5cdCAgICAgICAgY2hpbGRyZW4ucHVzaChlbGVtZW50KTtcblx0ICAgICAgfVxuXHQgICAgfSk7XG5cdCAgICByZXR1cm4gY2hpbGRyZW47XG5cdCAgfSxcblx0XG5cdCAgY29udGVudHM6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0ICAgIHJldHVybiBlbGVtZW50LmNvbnRlbnREb2N1bWVudCB8fCBlbGVtZW50LmNoaWxkTm9kZXMgfHwgW107XG5cdCAgfSxcblx0XG5cdCAgYXBwZW5kOiBmdW5jdGlvbihlbGVtZW50LCBub2RlKSB7XG5cdCAgICB2YXIgbm9kZVR5cGUgPSBlbGVtZW50Lm5vZGVUeXBlO1xuXHQgICAgaWYgKG5vZGVUeXBlICE9PSBOT0RFX1RZUEVfRUxFTUVOVCAmJiBub2RlVHlwZSAhPT0gTk9ERV9UWVBFX0RPQ1VNRU5UX0ZSQUdNRU5UKSByZXR1cm47XG5cdFxuXHQgICAgbm9kZSA9IG5ldyBKUUxpdGUobm9kZSk7XG5cdFxuXHQgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gbm9kZS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdCAgICAgIHZhciBjaGlsZCA9IG5vZGVbaV07XG5cdCAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuXHQgICAgfVxuXHQgIH0sXG5cdFxuXHQgIHByZXBlbmQ6IGZ1bmN0aW9uKGVsZW1lbnQsIG5vZGUpIHtcblx0ICAgIGlmIChlbGVtZW50Lm5vZGVUeXBlID09PSBOT0RFX1RZUEVfRUxFTUVOVCkge1xuXHQgICAgICB2YXIgaW5kZXggPSBlbGVtZW50LmZpcnN0Q2hpbGQ7XG5cdCAgICAgIGZvckVhY2gobmV3IEpRTGl0ZShub2RlKSwgZnVuY3Rpb24oY2hpbGQpIHtcblx0ICAgICAgICBlbGVtZW50Lmluc2VydEJlZm9yZShjaGlsZCwgaW5kZXgpO1xuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LFxuXHRcblx0ICB3cmFwOiBmdW5jdGlvbihlbGVtZW50LCB3cmFwTm9kZSkge1xuXHQgICAganFMaXRlV3JhcE5vZGUoZWxlbWVudCwganFMaXRlKHdyYXBOb2RlKS5lcSgwKS5jbG9uZSgpWzBdKTtcblx0ICB9LFxuXHRcblx0ICByZW1vdmU6IGpxTGl0ZVJlbW92ZSxcblx0XG5cdCAgZGV0YWNoOiBmdW5jdGlvbihlbGVtZW50KSB7XG5cdCAgICBqcUxpdGVSZW1vdmUoZWxlbWVudCwgdHJ1ZSk7XG5cdCAgfSxcblx0XG5cdCAgYWZ0ZXI6IGZ1bmN0aW9uKGVsZW1lbnQsIG5ld0VsZW1lbnQpIHtcblx0ICAgIHZhciBpbmRleCA9IGVsZW1lbnQsIHBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcblx0ICAgIG5ld0VsZW1lbnQgPSBuZXcgSlFMaXRlKG5ld0VsZW1lbnQpO1xuXHRcblx0ICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IG5ld0VsZW1lbnQubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHQgICAgICB2YXIgbm9kZSA9IG5ld0VsZW1lbnRbaV07XG5cdCAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUobm9kZSwgaW5kZXgubmV4dFNpYmxpbmcpO1xuXHQgICAgICBpbmRleCA9IG5vZGU7XG5cdCAgICB9XG5cdCAgfSxcblx0XG5cdCAgYWRkQ2xhc3M6IGpxTGl0ZUFkZENsYXNzLFxuXHQgIHJlbW92ZUNsYXNzOiBqcUxpdGVSZW1vdmVDbGFzcyxcblx0XG5cdCAgdG9nZ2xlQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIHNlbGVjdG9yLCBjb25kaXRpb24pIHtcblx0ICAgIGlmIChzZWxlY3Rvcikge1xuXHQgICAgICBmb3JFYWNoKHNlbGVjdG9yLnNwbGl0KCcgJyksIGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xuXHQgICAgICAgIHZhciBjbGFzc0NvbmRpdGlvbiA9IGNvbmRpdGlvbjtcblx0ICAgICAgICBpZiAoaXNVbmRlZmluZWQoY2xhc3NDb25kaXRpb24pKSB7XG5cdCAgICAgICAgICBjbGFzc0NvbmRpdGlvbiA9ICFqcUxpdGVIYXNDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICAoY2xhc3NDb25kaXRpb24gPyBqcUxpdGVBZGRDbGFzcyA6IGpxTGl0ZVJlbW92ZUNsYXNzKShlbGVtZW50LCBjbGFzc05hbWUpO1xuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LFxuXHRcblx0ICBwYXJlbnQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0ICAgIHZhciBwYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG5cdCAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5ub2RlVHlwZSAhPT0gTk9ERV9UWVBFX0RPQ1VNRU5UX0ZSQUdNRU5UID8gcGFyZW50IDogbnVsbDtcblx0ICB9LFxuXHRcblx0ICBuZXh0OiBmdW5jdGlvbihlbGVtZW50KSB7XG5cdCAgICByZXR1cm4gZWxlbWVudC5uZXh0RWxlbWVudFNpYmxpbmc7XG5cdCAgfSxcblx0XG5cdCAgZmluZDogZnVuY3Rpb24oZWxlbWVudCwgc2VsZWN0b3IpIHtcblx0ICAgIGlmIChlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKSB7XG5cdCAgICAgIHJldHVybiBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKHNlbGVjdG9yKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHJldHVybiBbXTtcblx0ICAgIH1cblx0ICB9LFxuXHRcblx0ICBjbG9uZToganFMaXRlQ2xvbmUsXG5cdFxuXHQgIHRyaWdnZXJIYW5kbGVyOiBmdW5jdGlvbihlbGVtZW50LCBldmVudCwgZXh0cmFQYXJhbWV0ZXJzKSB7XG5cdFxuXHQgICAgdmFyIGR1bW15RXZlbnQsIGV2ZW50Rm5zQ29weSwgaGFuZGxlckFyZ3M7XG5cdCAgICB2YXIgZXZlbnROYW1lID0gZXZlbnQudHlwZSB8fCBldmVudDtcblx0ICAgIHZhciBleHBhbmRvU3RvcmUgPSBqcUxpdGVFeHBhbmRvU3RvcmUoZWxlbWVudCk7XG5cdCAgICB2YXIgZXZlbnRzID0gZXhwYW5kb1N0b3JlICYmIGV4cGFuZG9TdG9yZS5ldmVudHM7XG5cdCAgICB2YXIgZXZlbnRGbnMgPSBldmVudHMgJiYgZXZlbnRzW2V2ZW50TmFtZV07XG5cdFxuXHQgICAgaWYgKGV2ZW50Rm5zKSB7XG5cdCAgICAgIC8vIENyZWF0ZSBhIGR1bW15IGV2ZW50IHRvIHBhc3MgdG8gdGhlIGhhbmRsZXJzXG5cdCAgICAgIGR1bW15RXZlbnQgPSB7XG5cdCAgICAgICAgcHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uKCkgeyB0aGlzLmRlZmF1bHRQcmV2ZW50ZWQgPSB0cnVlOyB9LFxuXHQgICAgICAgIGlzRGVmYXVsdFByZXZlbnRlZDogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLmRlZmF1bHRQcmV2ZW50ZWQgPT09IHRydWU7IH0sXG5cdCAgICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOiBmdW5jdGlvbigpIHsgdGhpcy5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSB0cnVlOyB9LFxuXHQgICAgICAgIGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID09PSB0cnVlOyB9LFxuXHQgICAgICAgIHN0b3BQcm9wYWdhdGlvbjogbm9vcCxcblx0ICAgICAgICB0eXBlOiBldmVudE5hbWUsXG5cdCAgICAgICAgdGFyZ2V0OiBlbGVtZW50XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICAvLyBJZiBhIGN1c3RvbSBldmVudCB3YXMgcHJvdmlkZWQgdGhlbiBleHRlbmQgb3VyIGR1bW15IGV2ZW50IHdpdGggaXRcblx0ICAgICAgaWYgKGV2ZW50LnR5cGUpIHtcblx0ICAgICAgICBkdW1teUV2ZW50ID0gZXh0ZW5kKGR1bW15RXZlbnQsIGV2ZW50KTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLy8gQ29weSBldmVudCBoYW5kbGVycyBpbiBjYXNlIGV2ZW50IGhhbmRsZXJzIGFycmF5IGlzIG1vZGlmaWVkIGR1cmluZyBleGVjdXRpb24uXG5cdCAgICAgIGV2ZW50Rm5zQ29weSA9IHNoYWxsb3dDb3B5KGV2ZW50Rm5zKTtcblx0ICAgICAgaGFuZGxlckFyZ3MgPSBleHRyYVBhcmFtZXRlcnMgPyBbZHVtbXlFdmVudF0uY29uY2F0KGV4dHJhUGFyYW1ldGVycykgOiBbZHVtbXlFdmVudF07XG5cdFxuXHQgICAgICBmb3JFYWNoKGV2ZW50Rm5zQ29weSwgZnVuY3Rpb24oZm4pIHtcblx0ICAgICAgICBpZiAoIWR1bW15RXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSkge1xuXHQgICAgICAgICAgZm4uYXBwbHkoZWxlbWVudCwgaGFuZGxlckFyZ3MpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfVxuXHR9LCBmdW5jdGlvbihmbiwgbmFtZSkge1xuXHQgIC8qKlxuXHQgICAqIGNoYWluaW5nIGZ1bmN0aW9uc1xuXHQgICAqL1xuXHQgIEpRTGl0ZS5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbihhcmcxLCBhcmcyLCBhcmczKSB7XG5cdCAgICB2YXIgdmFsdWU7XG5cdFxuXHQgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdCAgICAgIGlmIChpc1VuZGVmaW5lZCh2YWx1ZSkpIHtcblx0ICAgICAgICB2YWx1ZSA9IGZuKHRoaXNbaV0sIGFyZzEsIGFyZzIsIGFyZzMpO1xuXHQgICAgICAgIGlmIChpc0RlZmluZWQodmFsdWUpKSB7XG5cdCAgICAgICAgICAvLyBhbnkgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhIHZhbHVlIG5lZWRzIHRvIGJlIHdyYXBwZWRcblx0ICAgICAgICAgIHZhbHVlID0ganFMaXRlKHZhbHVlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAganFMaXRlQWRkTm9kZXModmFsdWUsIGZuKHRoaXNbaV0sIGFyZzEsIGFyZzIsIGFyZzMpKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIGlzRGVmaW5lZCh2YWx1ZSkgPyB2YWx1ZSA6IHRoaXM7XG5cdCAgfTtcblx0XG5cdCAgLy8gYmluZCBsZWdhY3kgYmluZC91bmJpbmQgdG8gb24vb2ZmXG5cdCAgSlFMaXRlLnByb3RvdHlwZS5iaW5kID0gSlFMaXRlLnByb3RvdHlwZS5vbjtcblx0ICBKUUxpdGUucHJvdG90eXBlLnVuYmluZCA9IEpRTGl0ZS5wcm90b3R5cGUub2ZmO1xuXHR9KTtcblx0XG5cdFxuXHQvLyBQcm92aWRlciBmb3IgcHJpdmF0ZSAkJGpxTGl0ZSBzZXJ2aWNlXG5cdGZ1bmN0aW9uICQkanFMaXRlUHJvdmlkZXIoKSB7XG5cdCAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24gJCRqcUxpdGUoKSB7XG5cdCAgICByZXR1cm4gZXh0ZW5kKEpRTGl0ZSwge1xuXHQgICAgICBoYXNDbGFzczogZnVuY3Rpb24obm9kZSwgY2xhc3Nlcykge1xuXHQgICAgICAgIGlmIChub2RlLmF0dHIpIG5vZGUgPSBub2RlWzBdO1xuXHQgICAgICAgIHJldHVybiBqcUxpdGVIYXNDbGFzcyhub2RlLCBjbGFzc2VzKTtcblx0ICAgICAgfSxcblx0ICAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKG5vZGUsIGNsYXNzZXMpIHtcblx0ICAgICAgICBpZiAobm9kZS5hdHRyKSBub2RlID0gbm9kZVswXTtcblx0ICAgICAgICByZXR1cm4ganFMaXRlQWRkQ2xhc3Mobm9kZSwgY2xhc3Nlcyk7XG5cdCAgICAgIH0sXG5cdCAgICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihub2RlLCBjbGFzc2VzKSB7XG5cdCAgICAgICAgaWYgKG5vZGUuYXR0cikgbm9kZSA9IG5vZGVbMF07XG5cdCAgICAgICAgcmV0dXJuIGpxTGl0ZVJlbW92ZUNsYXNzKG5vZGUsIGNsYXNzZXMpO1xuXHQgICAgICB9XG5cdCAgICB9KTtcblx0ICB9O1xuXHR9XG5cdFxuXHQvKipcblx0ICogQ29tcHV0ZXMgYSBoYXNoIG9mIGFuICdvYmonLlxuXHQgKiBIYXNoIG9mIGE6XG5cdCAqICBzdHJpbmcgaXMgc3RyaW5nXG5cdCAqICBudW1iZXIgaXMgbnVtYmVyIGFzIHN0cmluZ1xuXHQgKiAgb2JqZWN0IGlzIGVpdGhlciByZXN1bHQgb2YgY2FsbGluZyAkJGhhc2hLZXkgZnVuY3Rpb24gb24gdGhlIG9iamVjdCBvciB1bmlxdWVseSBnZW5lcmF0ZWQgaWQsXG5cdCAqICAgICAgICAgdGhhdCBpcyBhbHNvIGFzc2lnbmVkIHRvIHRoZSAkJGhhc2hLZXkgcHJvcGVydHkgb2YgdGhlIG9iamVjdC5cblx0ICpcblx0ICogQHBhcmFtIG9ialxuXHQgKiBAcmV0dXJucyB7c3RyaW5nfSBoYXNoIHN0cmluZyBzdWNoIHRoYXQgdGhlIHNhbWUgaW5wdXQgd2lsbCBoYXZlIHRoZSBzYW1lIGhhc2ggc3RyaW5nLlxuXHQgKiAgICAgICAgIFRoZSByZXN1bHRpbmcgc3RyaW5nIGtleSBpcyBpbiAndHlwZTpoYXNoS2V5JyBmb3JtYXQuXG5cdCAqL1xuXHRmdW5jdGlvbiBoYXNoS2V5KG9iaiwgbmV4dFVpZEZuKSB7XG5cdCAgdmFyIGtleSA9IG9iaiAmJiBvYmouJCRoYXNoS2V5O1xuXHRcblx0ICBpZiAoa2V5KSB7XG5cdCAgICBpZiAodHlwZW9mIGtleSA9PT0gJ2Z1bmN0aW9uJykge1xuXHQgICAgICBrZXkgPSBvYmouJCRoYXNoS2V5KCk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4ga2V5O1xuXHQgIH1cblx0XG5cdCAgdmFyIG9ialR5cGUgPSB0eXBlb2Ygb2JqO1xuXHQgIGlmIChvYmpUeXBlID09ICdmdW5jdGlvbicgfHwgKG9ialR5cGUgPT0gJ29iamVjdCcgJiYgb2JqICE9PSBudWxsKSkge1xuXHQgICAga2V5ID0gb2JqLiQkaGFzaEtleSA9IG9ialR5cGUgKyAnOicgKyAobmV4dFVpZEZuIHx8IG5leHRVaWQpKCk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIGtleSA9IG9ialR5cGUgKyAnOicgKyBvYmo7XG5cdCAgfVxuXHRcblx0ICByZXR1cm4ga2V5O1xuXHR9XG5cdFxuXHQvKipcblx0ICogSGFzaE1hcCB3aGljaCBjYW4gdXNlIG9iamVjdHMgYXMga2V5c1xuXHQgKi9cblx0ZnVuY3Rpb24gSGFzaE1hcChhcnJheSwgaXNvbGF0ZWRVaWQpIHtcblx0ICBpZiAoaXNvbGF0ZWRVaWQpIHtcblx0ICAgIHZhciB1aWQgPSAwO1xuXHQgICAgdGhpcy5uZXh0VWlkID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHJldHVybiArK3VpZDtcblx0ICAgIH07XG5cdCAgfVxuXHQgIGZvckVhY2goYXJyYXksIHRoaXMucHV0LCB0aGlzKTtcblx0fVxuXHRIYXNoTWFwLnByb3RvdHlwZSA9IHtcblx0ICAvKipcblx0ICAgKiBTdG9yZSBrZXkgdmFsdWUgcGFpclxuXHQgICAqIEBwYXJhbSBrZXkga2V5IHRvIHN0b3JlIGNhbiBiZSBhbnkgdHlwZVxuXHQgICAqIEBwYXJhbSB2YWx1ZSB2YWx1ZSB0byBzdG9yZSBjYW4gYmUgYW55IHR5cGVcblx0ICAgKi9cblx0ICBwdXQ6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcblx0ICAgIHRoaXNbaGFzaEtleShrZXksIHRoaXMubmV4dFVpZCldID0gdmFsdWU7XG5cdCAgfSxcblx0XG5cdCAgLyoqXG5cdCAgICogQHBhcmFtIGtleVxuXHQgICAqIEByZXR1cm5zIHtPYmplY3R9IHRoZSB2YWx1ZSBmb3IgdGhlIGtleVxuXHQgICAqL1xuXHQgIGdldDogZnVuY3Rpb24oa2V5KSB7XG5cdCAgICByZXR1cm4gdGhpc1toYXNoS2V5KGtleSwgdGhpcy5uZXh0VWlkKV07XG5cdCAgfSxcblx0XG5cdCAgLyoqXG5cdCAgICogUmVtb3ZlIHRoZSBrZXkvdmFsdWUgcGFpclxuXHQgICAqIEBwYXJhbSBrZXlcblx0ICAgKi9cblx0ICByZW1vdmU6IGZ1bmN0aW9uKGtleSkge1xuXHQgICAgdmFyIHZhbHVlID0gdGhpc1trZXkgPSBoYXNoS2V5KGtleSwgdGhpcy5uZXh0VWlkKV07XG5cdCAgICBkZWxldGUgdGhpc1trZXldO1xuXHQgICAgcmV0dXJuIHZhbHVlO1xuXHQgIH1cblx0fTtcblx0XG5cdHZhciAkJEhhc2hNYXBQcm92aWRlciA9IFtmdW5jdGlvbigpIHtcblx0ICB0aGlzLiRnZXQgPSBbZnVuY3Rpb24oKSB7XG5cdCAgICByZXR1cm4gSGFzaE1hcDtcblx0ICB9XTtcblx0fV07XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGZ1bmN0aW9uXG5cdCAqIEBtb2R1bGUgbmdcblx0ICogQG5hbWUgYW5ndWxhci5pbmplY3RvclxuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogQ3JlYXRlcyBhbiBpbmplY3RvciBvYmplY3QgdGhhdCBjYW4gYmUgdXNlZCBmb3IgcmV0cmlldmluZyBzZXJ2aWNlcyBhcyB3ZWxsIGFzIGZvclxuXHQgKiBkZXBlbmRlbmN5IGluamVjdGlvbiAoc2VlIHtAbGluayBndWlkZS9kaSBkZXBlbmRlbmN5IGluamVjdGlvbn0pLlxuXHQgKlxuXHQgKiBAcGFyYW0ge0FycmF5LjxzdHJpbmd8RnVuY3Rpb24+fSBtb2R1bGVzIEEgbGlzdCBvZiBtb2R1bGUgZnVuY3Rpb25zIG9yIHRoZWlyIGFsaWFzZXMuIFNlZVxuXHQgKiAgICAge0BsaW5rIGFuZ3VsYXIubW9kdWxlfS4gVGhlIGBuZ2AgbW9kdWxlIG11c3QgYmUgZXhwbGljaXRseSBhZGRlZC5cblx0ICogQHBhcmFtIHtib29sZWFuPX0gW3N0cmljdERpPWZhbHNlXSBXaGV0aGVyIHRoZSBpbmplY3RvciBzaG91bGQgYmUgaW4gc3RyaWN0IG1vZGUsIHdoaWNoXG5cdCAqICAgICBkaXNhbGxvd3MgYXJndW1lbnQgbmFtZSBhbm5vdGF0aW9uIGluZmVyZW5jZS5cblx0ICogQHJldHVybnMge2luamVjdG9yfSBJbmplY3RvciBvYmplY3QuIFNlZSB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfS5cblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICogVHlwaWNhbCB1c2FnZVxuXHQgKiBgYGBqc1xuXHQgKiAgIC8vIGNyZWF0ZSBhbiBpbmplY3RvclxuXHQgKiAgIHZhciAkaW5qZWN0b3IgPSBhbmd1bGFyLmluamVjdG9yKFsnbmcnXSk7XG5cdCAqXG5cdCAqICAgLy8gdXNlIHRoZSBpbmplY3RvciB0byBraWNrIG9mZiB5b3VyIGFwcGxpY2F0aW9uXG5cdCAqICAgLy8gdXNlIHRoZSB0eXBlIGluZmVyZW5jZSB0byBhdXRvIGluamVjdCBhcmd1bWVudHMsIG9yIHVzZSBpbXBsaWNpdCBpbmplY3Rpb25cblx0ICogICAkaW5qZWN0b3IuaW52b2tlKGZ1bmN0aW9uKCRyb290U2NvcGUsICRjb21waWxlLCAkZG9jdW1lbnQpIHtcblx0ICogICAgICRjb21waWxlKCRkb2N1bWVudCkoJHJvb3RTY29wZSk7XG5cdCAqICAgICAkcm9vdFNjb3BlLiRkaWdlc3QoKTtcblx0ICogICB9KTtcblx0ICogYGBgXG5cdCAqXG5cdCAqIFNvbWV0aW1lcyB5b3Ugd2FudCB0byBnZXQgYWNjZXNzIHRvIHRoZSBpbmplY3RvciBvZiBhIGN1cnJlbnRseSBydW5uaW5nIEFuZ3VsYXIgYXBwXG5cdCAqIGZyb20gb3V0c2lkZSBBbmd1bGFyLiBQZXJoYXBzLCB5b3Ugd2FudCB0byBpbmplY3QgYW5kIGNvbXBpbGUgc29tZSBtYXJrdXAgYWZ0ZXIgdGhlXG5cdCAqIGFwcGxpY2F0aW9uIGhhcyBiZWVuIGJvb3RzdHJhcHBlZC4gWW91IGNhbiBkbyB0aGlzIHVzaW5nIHRoZSBleHRyYSBgaW5qZWN0b3IoKWAgYWRkZWRcblx0ICogdG8gSlF1ZXJ5L2pxTGl0ZSBlbGVtZW50cy4gU2VlIHtAbGluayBhbmd1bGFyLmVsZW1lbnR9LlxuXHQgKlxuXHQgKiAqVGhpcyBpcyBmYWlybHkgcmFyZSBidXQgY291bGQgYmUgdGhlIGNhc2UgaWYgYSB0aGlyZCBwYXJ0eSBsaWJyYXJ5IGlzIGluamVjdGluZyB0aGVcblx0ICogbWFya3VwLipcblx0ICpcblx0ICogSW4gdGhlIGZvbGxvd2luZyBleGFtcGxlIGEgbmV3IGJsb2NrIG9mIEhUTUwgY29udGFpbmluZyBhIGBuZy1jb250cm9sbGVyYFxuXHQgKiBkaXJlY3RpdmUgaXMgYWRkZWQgdG8gdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQgYm9keSBieSBKUXVlcnkuIFdlIHRoZW4gY29tcGlsZSBhbmQgbGlua1xuXHQgKiBpdCBpbnRvIHRoZSBjdXJyZW50IEFuZ3VsYXJKUyBzY29wZS5cblx0ICpcblx0ICogYGBganNcblx0ICogdmFyICRkaXYgPSAkKCc8ZGl2IG5nLWNvbnRyb2xsZXI9XCJNeUN0cmxcIj57e2NvbnRlbnQubGFiZWx9fTwvZGl2PicpO1xuXHQgKiAkKGRvY3VtZW50LmJvZHkpLmFwcGVuZCgkZGl2KTtcblx0ICpcblx0ICogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5pbmplY3RvcigpLmludm9rZShmdW5jdGlvbigkY29tcGlsZSkge1xuXHQgKiAgIHZhciBzY29wZSA9IGFuZ3VsYXIuZWxlbWVudCgkZGl2KS5zY29wZSgpO1xuXHQgKiAgICRjb21waWxlKCRkaXYpKHNjb3BlKTtcblx0ICogfSk7XG5cdCAqIGBgYFxuXHQgKi9cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIG1vZHVsZVxuXHQgKiBAbmFtZSBhdXRvXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKlxuXHQgKiBJbXBsaWNpdCBtb2R1bGUgd2hpY2ggZ2V0cyBhdXRvbWF0aWNhbGx5IGFkZGVkIHRvIGVhY2gge0BsaW5rIGF1dG8uJGluamVjdG9yICRpbmplY3Rvcn0uXG5cdCAqL1xuXHRcblx0dmFyIEFSUk9XX0FSRyA9IC9eKFteXFwoXSs/KT0+Lztcblx0dmFyIEZOX0FSR1MgPSAvXlteXFwoXSpcXChcXHMqKFteXFwpXSopXFwpL207XG5cdHZhciBGTl9BUkdfU1BMSVQgPSAvLC87XG5cdHZhciBGTl9BUkcgPSAvXlxccyooXz8pKFxcUys/KVxcMVxccyokLztcblx0dmFyIFNUUklQX0NPTU1FTlRTID0gLygoXFwvXFwvLiokKXwoXFwvXFwqW1xcc1xcU10qP1xcKlxcLykpL21nO1xuXHR2YXIgJGluamVjdG9yTWluRXJyID0gbWluRXJyKCckaW5qZWN0b3InKTtcblx0XG5cdGZ1bmN0aW9uIGV4dHJhY3RBcmdzKGZuKSB7XG5cdCAgdmFyIGZuVGV4dCA9IGZuLnRvU3RyaW5nKCkucmVwbGFjZShTVFJJUF9DT01NRU5UUywgJycpLFxuXHQgICAgICBhcmdzID0gZm5UZXh0Lm1hdGNoKEFSUk9XX0FSRykgfHwgZm5UZXh0Lm1hdGNoKEZOX0FSR1MpO1xuXHQgIHJldHVybiBhcmdzO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBhbm9uRm4oZm4pIHtcblx0ICAvLyBGb3IgYW5vbnltb3VzIGZ1bmN0aW9ucywgc2hvd2luZyBhdCB0aGUgdmVyeSBsZWFzdCB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlIGNhbiBoZWxwIGluXG5cdCAgLy8gZGVidWdnaW5nLlxuXHQgIHZhciBhcmdzID0gZXh0cmFjdEFyZ3MoZm4pO1xuXHQgIGlmIChhcmdzKSB7XG5cdCAgICByZXR1cm4gJ2Z1bmN0aW9uKCcgKyAoYXJnc1sxXSB8fCAnJykucmVwbGFjZSgvW1xcc1xcclxcbl0rLywgJyAnKSArICcpJztcblx0ICB9XG5cdCAgcmV0dXJuICdmbic7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGFubm90YXRlKGZuLCBzdHJpY3REaSwgbmFtZSkge1xuXHQgIHZhciAkaW5qZWN0LFxuXHQgICAgICBhcmdEZWNsLFxuXHQgICAgICBsYXN0O1xuXHRcblx0ICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG5cdCAgICBpZiAoISgkaW5qZWN0ID0gZm4uJGluamVjdCkpIHtcblx0ICAgICAgJGluamVjdCA9IFtdO1xuXHQgICAgICBpZiAoZm4ubGVuZ3RoKSB7XG5cdCAgICAgICAgaWYgKHN0cmljdERpKSB7XG5cdCAgICAgICAgICBpZiAoIWlzU3RyaW5nKG5hbWUpIHx8ICFuYW1lKSB7XG5cdCAgICAgICAgICAgIG5hbWUgPSBmbi5uYW1lIHx8IGFub25Gbihmbik7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICB0aHJvdyAkaW5qZWN0b3JNaW5FcnIoJ3N0cmljdGRpJyxcblx0ICAgICAgICAgICAgJ3swfSBpcyBub3QgdXNpbmcgZXhwbGljaXQgYW5ub3RhdGlvbiBhbmQgY2Fubm90IGJlIGludm9rZWQgaW4gc3RyaWN0IG1vZGUnLCBuYW1lKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgYXJnRGVjbCA9IGV4dHJhY3RBcmdzKGZuKTtcblx0ICAgICAgICBmb3JFYWNoKGFyZ0RlY2xbMV0uc3BsaXQoRk5fQVJHX1NQTElUKSwgZnVuY3Rpb24oYXJnKSB7XG5cdCAgICAgICAgICBhcmcucmVwbGFjZShGTl9BUkcsIGZ1bmN0aW9uKGFsbCwgdW5kZXJzY29yZSwgbmFtZSkge1xuXHQgICAgICAgICAgICAkaW5qZWN0LnB1c2gobmFtZSk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgICBmbi4kaW5qZWN0ID0gJGluamVjdDtcblx0ICAgIH1cblx0ICB9IGVsc2UgaWYgKGlzQXJyYXkoZm4pKSB7XG5cdCAgICBsYXN0ID0gZm4ubGVuZ3RoIC0gMTtcblx0ICAgIGFzc2VydEFyZ0ZuKGZuW2xhc3RdLCAnZm4nKTtcblx0ICAgICRpbmplY3QgPSBmbi5zbGljZSgwLCBsYXN0KTtcblx0ICB9IGVsc2Uge1xuXHQgICAgYXNzZXJ0QXJnRm4oZm4sICdmbicsIHRydWUpO1xuXHQgIH1cblx0ICByZXR1cm4gJGluamVjdDtcblx0fVxuXHRcblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHNlcnZpY2Vcblx0ICogQG5hbWUgJGluamVjdG9yXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKlxuXHQgKiBgJGluamVjdG9yYCBpcyB1c2VkIHRvIHJldHJpZXZlIG9iamVjdCBpbnN0YW5jZXMgYXMgZGVmaW5lZCBieVxuXHQgKiB7QGxpbmsgYXV0by4kcHJvdmlkZSBwcm92aWRlcn0sIGluc3RhbnRpYXRlIHR5cGVzLCBpbnZva2UgbWV0aG9kcyxcblx0ICogYW5kIGxvYWQgbW9kdWxlcy5cblx0ICpcblx0ICogVGhlIGZvbGxvd2luZyBhbHdheXMgaG9sZHMgdHJ1ZTpcblx0ICpcblx0ICogYGBganNcblx0ICogICB2YXIgJGluamVjdG9yID0gYW5ndWxhci5pbmplY3RvcigpO1xuXHQgKiAgIGV4cGVjdCgkaW5qZWN0b3IuZ2V0KCckaW5qZWN0b3InKSkudG9CZSgkaW5qZWN0b3IpO1xuXHQgKiAgIGV4cGVjdCgkaW5qZWN0b3IuaW52b2tlKGZ1bmN0aW9uKCRpbmplY3Rvcikge1xuXHQgKiAgICAgcmV0dXJuICRpbmplY3Rvcjtcblx0ICogICB9KSkudG9CZSgkaW5qZWN0b3IpO1xuXHQgKiBgYGBcblx0ICpcblx0ICogIyBJbmplY3Rpb24gRnVuY3Rpb24gQW5ub3RhdGlvblxuXHQgKlxuXHQgKiBKYXZhU2NyaXB0IGRvZXMgbm90IGhhdmUgYW5ub3RhdGlvbnMsIGFuZCBhbm5vdGF0aW9ucyBhcmUgbmVlZGVkIGZvciBkZXBlbmRlbmN5IGluamVjdGlvbi4gVGhlXG5cdCAqIGZvbGxvd2luZyBhcmUgYWxsIHZhbGlkIHdheXMgb2YgYW5ub3RhdGluZyBmdW5jdGlvbiB3aXRoIGluamVjdGlvbiBhcmd1bWVudHMgYW5kIGFyZSBlcXVpdmFsZW50LlxuXHQgKlxuXHQgKiBgYGBqc1xuXHQgKiAgIC8vIGluZmVycmVkIChvbmx5IHdvcmtzIGlmIGNvZGUgbm90IG1pbmlmaWVkL29iZnVzY2F0ZWQpXG5cdCAqICAgJGluamVjdG9yLmludm9rZShmdW5jdGlvbihzZXJ2aWNlQSl7fSk7XG5cdCAqXG5cdCAqICAgLy8gYW5ub3RhdGVkXG5cdCAqICAgZnVuY3Rpb24gZXhwbGljaXQoc2VydmljZUEpIHt9O1xuXHQgKiAgIGV4cGxpY2l0LiRpbmplY3QgPSBbJ3NlcnZpY2VBJ107XG5cdCAqICAgJGluamVjdG9yLmludm9rZShleHBsaWNpdCk7XG5cdCAqXG5cdCAqICAgLy8gaW5saW5lXG5cdCAqICAgJGluamVjdG9yLmludm9rZShbJ3NlcnZpY2VBJywgZnVuY3Rpb24oc2VydmljZUEpe31dKTtcblx0ICogYGBgXG5cdCAqXG5cdCAqICMjIEluZmVyZW5jZVxuXHQgKlxuXHQgKiBJbiBKYXZhU2NyaXB0IGNhbGxpbmcgYHRvU3RyaW5nKClgIG9uIGEgZnVuY3Rpb24gcmV0dXJucyB0aGUgZnVuY3Rpb24gZGVmaW5pdGlvbi4gVGhlIGRlZmluaXRpb25cblx0ICogY2FuIHRoZW4gYmUgcGFyc2VkIGFuZCB0aGUgZnVuY3Rpb24gYXJndW1lbnRzIGNhbiBiZSBleHRyYWN0ZWQuIFRoaXMgbWV0aG9kIG9mIGRpc2NvdmVyaW5nXG5cdCAqIGFubm90YXRpb25zIGlzIGRpc2FsbG93ZWQgd2hlbiB0aGUgaW5qZWN0b3IgaXMgaW4gc3RyaWN0IG1vZGUuXG5cdCAqICpOT1RFOiogVGhpcyBkb2VzIG5vdCB3b3JrIHdpdGggbWluaWZpY2F0aW9uLCBhbmQgb2JmdXNjYXRpb24gdG9vbHMgc2luY2UgdGhlc2UgdG9vbHMgY2hhbmdlIHRoZVxuXHQgKiBhcmd1bWVudCBuYW1lcy5cblx0ICpcblx0ICogIyMgYCRpbmplY3RgIEFubm90YXRpb25cblx0ICogQnkgYWRkaW5nIGFuIGAkaW5qZWN0YCBwcm9wZXJ0eSBvbnRvIGEgZnVuY3Rpb24gdGhlIGluamVjdGlvbiBwYXJhbWV0ZXJzIGNhbiBiZSBzcGVjaWZpZWQuXG5cdCAqXG5cdCAqICMjIElubGluZVxuXHQgKiBBcyBhbiBhcnJheSBvZiBpbmplY3Rpb24gbmFtZXMsIHdoZXJlIHRoZSBsYXN0IGl0ZW0gaW4gdGhlIGFycmF5IGlzIHRoZSBmdW5jdGlvbiB0byBjYWxsLlxuXHQgKi9cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgbWV0aG9kXG5cdCAqIEBuYW1lICRpbmplY3RvciNnZXRcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFJldHVybiBhbiBpbnN0YW5jZSBvZiB0aGUgc2VydmljZS5cblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGluc3RhbmNlIHRvIHJldHJpZXZlLlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IGNhbGxlciBBbiBvcHRpb25hbCBzdHJpbmcgdG8gcHJvdmlkZSB0aGUgb3JpZ2luIG9mIHRoZSBmdW5jdGlvbiBjYWxsIGZvciBlcnJvciBtZXNzYWdlcy5cblx0ICogQHJldHVybiB7Kn0gVGhlIGluc3RhbmNlLlxuXHQgKi9cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgbWV0aG9kXG5cdCAqIEBuYW1lICRpbmplY3RvciNpbnZva2Vcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEludm9rZSB0aGUgbWV0aG9kIGFuZCBzdXBwbHkgdGhlIG1ldGhvZCBhcmd1bWVudHMgZnJvbSB0aGUgYCRpbmplY3RvcmAuXG5cdCAqXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb258QXJyYXkuPHN0cmluZ3xGdW5jdGlvbj59IGZuIFRoZSBpbmplY3RhYmxlIGZ1bmN0aW9uIHRvIGludm9rZS4gRnVuY3Rpb24gcGFyYW1ldGVycyBhcmVcblx0ICogICBpbmplY3RlZCBhY2NvcmRpbmcgdG8gdGhlIHtAbGluayBndWlkZS9kaSAkaW5qZWN0IEFubm90YXRpb259IHJ1bGVzLlxuXHQgKiBAcGFyYW0ge09iamVjdD19IHNlbGYgVGhlIGB0aGlzYCBmb3IgdGhlIGludm9rZWQgbWV0aG9kLlxuXHQgKiBAcGFyYW0ge09iamVjdD19IGxvY2FscyBPcHRpb25hbCBvYmplY3QuIElmIHByZXNldCB0aGVuIGFueSBhcmd1bWVudCBuYW1lcyBhcmUgcmVhZCBmcm9tIHRoaXNcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0IGZpcnN0LCBiZWZvcmUgdGhlIGAkaW5qZWN0b3JgIGlzIGNvbnN1bHRlZC5cblx0ICogQHJldHVybnMgeyp9IHRoZSB2YWx1ZSByZXR1cm5lZCBieSB0aGUgaW52b2tlZCBgZm5gIGZ1bmN0aW9uLlxuXHQgKi9cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgbWV0aG9kXG5cdCAqIEBuYW1lICRpbmplY3RvciNoYXNcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEFsbG93cyB0aGUgdXNlciB0byBxdWVyeSBpZiB0aGUgcGFydGljdWxhciBzZXJ2aWNlIGV4aXN0cy5cblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgTmFtZSBvZiB0aGUgc2VydmljZSB0byBxdWVyeS5cblx0ICogQHJldHVybnMge2Jvb2xlYW59IGB0cnVlYCBpZiBpbmplY3RvciBoYXMgZ2l2ZW4gc2VydmljZS5cblx0ICovXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIG1ldGhvZFxuXHQgKiBAbmFtZSAkaW5qZWN0b3IjaW5zdGFudGlhdGVcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIENyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiBKUyB0eXBlLiBUaGUgbWV0aG9kIHRha2VzIGEgY29uc3RydWN0b3IgZnVuY3Rpb24sIGludm9rZXMgdGhlIG5ld1xuXHQgKiBvcGVyYXRvciwgYW5kIHN1cHBsaWVzIGFsbCBvZiB0aGUgYXJndW1lbnRzIHRvIHRoZSBjb25zdHJ1Y3RvciBmdW5jdGlvbiBhcyBzcGVjaWZpZWQgYnkgdGhlXG5cdCAqIGNvbnN0cnVjdG9yIGFubm90YXRpb24uXG5cdCAqXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb259IFR5cGUgQW5ub3RhdGVkIGNvbnN0cnVjdG9yIGZ1bmN0aW9uLlxuXHQgKiBAcGFyYW0ge09iamVjdD19IGxvY2FscyBPcHRpb25hbCBvYmplY3QuIElmIHByZXNldCB0aGVuIGFueSBhcmd1bWVudCBuYW1lcyBhcmUgcmVhZCBmcm9tIHRoaXNcblx0ICogb2JqZWN0IGZpcnN0LCBiZWZvcmUgdGhlIGAkaW5qZWN0b3JgIGlzIGNvbnN1bHRlZC5cblx0ICogQHJldHVybnMge09iamVjdH0gbmV3IGluc3RhbmNlIG9mIGBUeXBlYC5cblx0ICovXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIG1ldGhvZFxuXHQgKiBAbmFtZSAkaW5qZWN0b3IjYW5ub3RhdGVcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFJldHVybnMgYW4gYXJyYXkgb2Ygc2VydmljZSBuYW1lcyB3aGljaCB0aGUgZnVuY3Rpb24gaXMgcmVxdWVzdGluZyBmb3IgaW5qZWN0aW9uLiBUaGlzIEFQSSBpc1xuXHQgKiB1c2VkIGJ5IHRoZSBpbmplY3RvciB0byBkZXRlcm1pbmUgd2hpY2ggc2VydmljZXMgbmVlZCB0byBiZSBpbmplY3RlZCBpbnRvIHRoZSBmdW5jdGlvbiB3aGVuIHRoZVxuXHQgKiBmdW5jdGlvbiBpcyBpbnZva2VkLiBUaGVyZSBhcmUgdGhyZWUgd2F5cyBpbiB3aGljaCB0aGUgZnVuY3Rpb24gY2FuIGJlIGFubm90YXRlZCB3aXRoIHRoZSBuZWVkZWRcblx0ICogZGVwZW5kZW5jaWVzLlxuXHQgKlxuXHQgKiAjIEFyZ3VtZW50IG5hbWVzXG5cdCAqXG5cdCAqIFRoZSBzaW1wbGVzdCBmb3JtIGlzIHRvIGV4dHJhY3QgdGhlIGRlcGVuZGVuY2llcyBmcm9tIHRoZSBhcmd1bWVudHMgb2YgdGhlIGZ1bmN0aW9uLiBUaGlzIGlzIGRvbmVcblx0ICogYnkgY29udmVydGluZyB0aGUgZnVuY3Rpb24gaW50byBhIHN0cmluZyB1c2luZyBgdG9TdHJpbmcoKWAgbWV0aG9kIGFuZCBleHRyYWN0aW5nIHRoZSBhcmd1bWVudFxuXHQgKiBuYW1lcy5cblx0ICogYGBganNcblx0ICogICAvLyBHaXZlblxuXHQgKiAgIGZ1bmN0aW9uIE15Q29udHJvbGxlcigkc2NvcGUsICRyb3V0ZSkge1xuXHQgKiAgICAgLy8gLi4uXG5cdCAqICAgfVxuXHQgKlxuXHQgKiAgIC8vIFRoZW5cblx0ICogICBleHBlY3QoaW5qZWN0b3IuYW5ub3RhdGUoTXlDb250cm9sbGVyKSkudG9FcXVhbChbJyRzY29wZScsICckcm91dGUnXSk7XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBZb3UgY2FuIGRpc2FsbG93IHRoaXMgbWV0aG9kIGJ5IHVzaW5nIHN0cmljdCBpbmplY3Rpb24gbW9kZS5cblx0ICpcblx0ICogVGhpcyBtZXRob2QgZG9lcyBub3Qgd29yayB3aXRoIGNvZGUgbWluaWZpY2F0aW9uIC8gb2JmdXNjYXRpb24uIEZvciB0aGlzIHJlYXNvbiB0aGUgZm9sbG93aW5nXG5cdCAqIGFubm90YXRpb24gc3RyYXRlZ2llcyBhcmUgc3VwcG9ydGVkLlxuXHQgKlxuXHQgKiAjIFRoZSBgJGluamVjdGAgcHJvcGVydHlcblx0ICpcblx0ICogSWYgYSBmdW5jdGlvbiBoYXMgYW4gYCRpbmplY3RgIHByb3BlcnR5IGFuZCBpdHMgdmFsdWUgaXMgYW4gYXJyYXkgb2Ygc3RyaW5ncywgdGhlbiB0aGUgc3RyaW5nc1xuXHQgKiByZXByZXNlbnQgbmFtZXMgb2Ygc2VydmljZXMgdG8gYmUgaW5qZWN0ZWQgaW50byB0aGUgZnVuY3Rpb24uXG5cdCAqIGBgYGpzXG5cdCAqICAgLy8gR2l2ZW5cblx0ICogICB2YXIgTXlDb250cm9sbGVyID0gZnVuY3Rpb24ob2JmdXNjYXRlZFNjb3BlLCBvYmZ1c2NhdGVkUm91dGUpIHtcblx0ICogICAgIC8vIC4uLlxuXHQgKiAgIH1cblx0ICogICAvLyBEZWZpbmUgZnVuY3Rpb24gZGVwZW5kZW5jaWVzXG5cdCAqICAgTXlDb250cm9sbGVyWyckaW5qZWN0J10gPSBbJyRzY29wZScsICckcm91dGUnXTtcblx0ICpcblx0ICogICAvLyBUaGVuXG5cdCAqICAgZXhwZWN0KGluamVjdG9yLmFubm90YXRlKE15Q29udHJvbGxlcikpLnRvRXF1YWwoWyckc2NvcGUnLCAnJHJvdXRlJ10pO1xuXHQgKiBgYGBcblx0ICpcblx0ICogIyBUaGUgYXJyYXkgbm90YXRpb25cblx0ICpcblx0ICogSXQgaXMgb2Z0ZW4gZGVzaXJhYmxlIHRvIGlubGluZSBJbmplY3RlZCBmdW5jdGlvbnMgYW5kIHRoYXQncyB3aGVuIHNldHRpbmcgdGhlIGAkaW5qZWN0YCBwcm9wZXJ0eVxuXHQgKiBpcyB2ZXJ5IGluY29udmVuaWVudC4gSW4gdGhlc2Ugc2l0dWF0aW9ucyB1c2luZyB0aGUgYXJyYXkgbm90YXRpb24gdG8gc3BlY2lmeSB0aGUgZGVwZW5kZW5jaWVzIGluXG5cdCAqIGEgd2F5IHRoYXQgc3Vydml2ZXMgbWluaWZpY2F0aW9uIGlzIGEgYmV0dGVyIGNob2ljZTpcblx0ICpcblx0ICogYGBganNcblx0ICogICAvLyBXZSB3aXNoIHRvIHdyaXRlIHRoaXMgKG5vdCBtaW5pZmljYXRpb24gLyBvYmZ1c2NhdGlvbiBzYWZlKVxuXHQgKiAgIGluamVjdG9yLmludm9rZShmdW5jdGlvbigkY29tcGlsZSwgJHJvb3RTY29wZSkge1xuXHQgKiAgICAgLy8gLi4uXG5cdCAqICAgfSk7XG5cdCAqXG5cdCAqICAgLy8gV2UgYXJlIGZvcmNlZCB0byB3cml0ZSBicmVhayBpbmxpbmluZ1xuXHQgKiAgIHZhciB0bXBGbiA9IGZ1bmN0aW9uKG9iZnVzY2F0ZWRDb21waWxlLCBvYmZ1c2NhdGVkUm9vdFNjb3BlKSB7XG5cdCAqICAgICAvLyAuLi5cblx0ICogICB9O1xuXHQgKiAgIHRtcEZuLiRpbmplY3QgPSBbJyRjb21waWxlJywgJyRyb290U2NvcGUnXTtcblx0ICogICBpbmplY3Rvci5pbnZva2UodG1wRm4pO1xuXHQgKlxuXHQgKiAgIC8vIFRvIGJldHRlciBzdXBwb3J0IGlubGluZSBmdW5jdGlvbiB0aGUgaW5saW5lIGFubm90YXRpb24gaXMgc3VwcG9ydGVkXG5cdCAqICAgaW5qZWN0b3IuaW52b2tlKFsnJGNvbXBpbGUnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uKG9iZkNvbXBpbGUsIG9iZlJvb3RTY29wZSkge1xuXHQgKiAgICAgLy8gLi4uXG5cdCAqICAgfV0pO1xuXHQgKlxuXHQgKiAgIC8vIFRoZXJlZm9yZVxuXHQgKiAgIGV4cGVjdChpbmplY3Rvci5hbm5vdGF0ZShcblx0ICogICAgICBbJyRjb21waWxlJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbihvYmZ1c18kY29tcGlsZSwgb2JmdXNfJHJvb3RTY29wZSkge31dKVxuXHQgKiAgICApLnRvRXF1YWwoWyckY29tcGlsZScsICckcm9vdFNjb3BlJ10pO1xuXHQgKiBgYGBcblx0ICpcblx0ICogQHBhcmFtIHtGdW5jdGlvbnxBcnJheS48c3RyaW5nfEZ1bmN0aW9uPn0gZm4gRnVuY3Rpb24gZm9yIHdoaWNoIGRlcGVuZGVudCBzZXJ2aWNlIG5hbWVzIG5lZWQgdG9cblx0ICogYmUgcmV0cmlldmVkIGFzIGRlc2NyaWJlZCBhYm92ZS5cblx0ICpcblx0ICogQHBhcmFtIHtib29sZWFuPX0gW3N0cmljdERpPWZhbHNlXSBEaXNhbGxvdyBhcmd1bWVudCBuYW1lIGFubm90YXRpb24gaW5mZXJlbmNlLlxuXHQgKlxuXHQgKiBAcmV0dXJucyB7QXJyYXkuPHN0cmluZz59IFRoZSBuYW1lcyBvZiB0aGUgc2VydmljZXMgd2hpY2ggdGhlIGZ1bmN0aW9uIHJlcXVpcmVzLlxuXHQgKi9cblx0XG5cdFxuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2Mgc2VydmljZVxuXHQgKiBAbmFtZSAkcHJvdmlkZVxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogVGhlIHtAbGluayBhdXRvLiRwcm92aWRlICRwcm92aWRlfSBzZXJ2aWNlIGhhcyBhIG51bWJlciBvZiBtZXRob2RzIGZvciByZWdpc3RlcmluZyBjb21wb25lbnRzXG5cdCAqIHdpdGggdGhlIHtAbGluayBhdXRvLiRpbmplY3RvciAkaW5qZWN0b3J9LiBNYW55IG9mIHRoZXNlIGZ1bmN0aW9ucyBhcmUgYWxzbyBleHBvc2VkIG9uXG5cdCAqIHtAbGluayBhbmd1bGFyLk1vZHVsZX0uXG5cdCAqXG5cdCAqIEFuIEFuZ3VsYXIgKipzZXJ2aWNlKiogaXMgYSBzaW5nbGV0b24gb2JqZWN0IGNyZWF0ZWQgYnkgYSAqKnNlcnZpY2UgZmFjdG9yeSoqLiAgVGhlc2UgKipzZXJ2aWNlXG5cdCAqIGZhY3RvcmllcyoqIGFyZSBmdW5jdGlvbnMgd2hpY2gsIGluIHR1cm4sIGFyZSBjcmVhdGVkIGJ5IGEgKipzZXJ2aWNlIHByb3ZpZGVyKiouXG5cdCAqIFRoZSAqKnNlcnZpY2UgcHJvdmlkZXJzKiogYXJlIGNvbnN0cnVjdG9yIGZ1bmN0aW9ucy4gV2hlbiBpbnN0YW50aWF0ZWQgdGhleSBtdXN0IGNvbnRhaW4gYVxuXHQgKiBwcm9wZXJ0eSBjYWxsZWQgYCRnZXRgLCB3aGljaCBob2xkcyB0aGUgKipzZXJ2aWNlIGZhY3RvcnkqKiBmdW5jdGlvbi5cblx0ICpcblx0ICogV2hlbiB5b3UgcmVxdWVzdCBhIHNlcnZpY2UsIHRoZSB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfSBpcyByZXNwb25zaWJsZSBmb3IgZmluZGluZyB0aGVcblx0ICogY29ycmVjdCAqKnNlcnZpY2UgcHJvdmlkZXIqKiwgaW5zdGFudGlhdGluZyBpdCBhbmQgdGhlbiBjYWxsaW5nIGl0cyBgJGdldGAgKipzZXJ2aWNlIGZhY3RvcnkqKlxuXHQgKiBmdW5jdGlvbiB0byBnZXQgdGhlIGluc3RhbmNlIG9mIHRoZSAqKnNlcnZpY2UqKi5cblx0ICpcblx0ICogT2Z0ZW4gc2VydmljZXMgaGF2ZSBubyBjb25maWd1cmF0aW9uIG9wdGlvbnMgYW5kIHRoZXJlIGlzIG5vIG5lZWQgdG8gYWRkIG1ldGhvZHMgdG8gdGhlIHNlcnZpY2Vcblx0ICogcHJvdmlkZXIuICBUaGUgcHJvdmlkZXIgd2lsbCBiZSBubyBtb3JlIHRoYW4gYSBjb25zdHJ1Y3RvciBmdW5jdGlvbiB3aXRoIGEgYCRnZXRgIHByb3BlcnR5LiBGb3Jcblx0ICogdGhlc2UgY2FzZXMgdGhlIHtAbGluayBhdXRvLiRwcm92aWRlICRwcm92aWRlfSBzZXJ2aWNlIGhhcyBhZGRpdGlvbmFsIGhlbHBlciBtZXRob2RzIHRvIHJlZ2lzdGVyXG5cdCAqIHNlcnZpY2VzIHdpdGhvdXQgc3BlY2lmeWluZyBhIHByb3ZpZGVyLlxuXHQgKlxuXHQgKiAqIHtAbGluayBhdXRvLiRwcm92aWRlI3Byb3ZpZGVyIHByb3ZpZGVyKHByb3ZpZGVyKX0gLSByZWdpc3RlcnMgYSAqKnNlcnZpY2UgcHJvdmlkZXIqKiB3aXRoIHRoZVxuXHQgKiAgICAge0BsaW5rIGF1dG8uJGluamVjdG9yICRpbmplY3Rvcn1cblx0ICogKiB7QGxpbmsgYXV0by4kcHJvdmlkZSNjb25zdGFudCBjb25zdGFudChvYmopfSAtIHJlZ2lzdGVycyBhIHZhbHVlL29iamVjdCB0aGF0IGNhbiBiZSBhY2Nlc3NlZCBieVxuXHQgKiAgICAgcHJvdmlkZXJzIGFuZCBzZXJ2aWNlcy5cblx0ICogKiB7QGxpbmsgYXV0by4kcHJvdmlkZSN2YWx1ZSB2YWx1ZShvYmopfSAtIHJlZ2lzdGVycyBhIHZhbHVlL29iamVjdCB0aGF0IGNhbiBvbmx5IGJlIGFjY2Vzc2VkIGJ5XG5cdCAqICAgICBzZXJ2aWNlcywgbm90IHByb3ZpZGVycy5cblx0ICogKiB7QGxpbmsgYXV0by4kcHJvdmlkZSNmYWN0b3J5IGZhY3RvcnkoZm4pfSAtIHJlZ2lzdGVycyBhIHNlcnZpY2UgKipmYWN0b3J5IGZ1bmN0aW9uKiosIGBmbmAsXG5cdCAqICAgICB0aGF0IHdpbGwgYmUgd3JhcHBlZCBpbiBhICoqc2VydmljZSBwcm92aWRlcioqIG9iamVjdCwgd2hvc2UgYCRnZXRgIHByb3BlcnR5IHdpbGwgY29udGFpbiB0aGVcblx0ICogICAgIGdpdmVuIGZhY3RvcnkgZnVuY3Rpb24uXG5cdCAqICoge0BsaW5rIGF1dG8uJHByb3ZpZGUjc2VydmljZSBzZXJ2aWNlKGNsYXNzKX0gLSByZWdpc3RlcnMgYSAqKmNvbnN0cnVjdG9yIGZ1bmN0aW9uKiosIGBjbGFzc2Bcblx0ICogICAgIHRoYXQgd2lsbCBiZSB3cmFwcGVkIGluIGEgKipzZXJ2aWNlIHByb3ZpZGVyKiogb2JqZWN0LCB3aG9zZSBgJGdldGAgcHJvcGVydHkgd2lsbCBpbnN0YW50aWF0ZVxuXHQgKiAgICAgIGEgbmV3IG9iamVjdCB1c2luZyB0aGUgZ2l2ZW4gY29uc3RydWN0b3IgZnVuY3Rpb24uXG5cdCAqXG5cdCAqIFNlZSB0aGUgaW5kaXZpZHVhbCBtZXRob2RzIGZvciBtb3JlIGluZm9ybWF0aW9uIGFuZCBleGFtcGxlcy5cblx0ICovXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIG1ldGhvZFxuXHQgKiBAbmFtZSAkcHJvdmlkZSNwcm92aWRlclxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogUmVnaXN0ZXIgYSAqKnByb3ZpZGVyIGZ1bmN0aW9uKiogd2l0aCB0aGUge0BsaW5rIGF1dG8uJGluamVjdG9yICRpbmplY3Rvcn0uIFByb3ZpZGVyIGZ1bmN0aW9uc1xuXHQgKiBhcmUgY29uc3RydWN0b3IgZnVuY3Rpb25zLCB3aG9zZSBpbnN0YW5jZXMgYXJlIHJlc3BvbnNpYmxlIGZvciBcInByb3ZpZGluZ1wiIGEgZmFjdG9yeSBmb3IgYVxuXHQgKiBzZXJ2aWNlLlxuXHQgKlxuXHQgKiBTZXJ2aWNlIHByb3ZpZGVyIG5hbWVzIHN0YXJ0IHdpdGggdGhlIG5hbWUgb2YgdGhlIHNlcnZpY2UgdGhleSBwcm92aWRlIGZvbGxvd2VkIGJ5IGBQcm92aWRlcmAuXG5cdCAqIEZvciBleGFtcGxlLCB0aGUge0BsaW5rIG5nLiRsb2cgJGxvZ30gc2VydmljZSBoYXMgYSBwcm92aWRlciBjYWxsZWRcblx0ICoge0BsaW5rIG5nLiRsb2dQcm92aWRlciAkbG9nUHJvdmlkZXJ9LlxuXHQgKlxuXHQgKiBTZXJ2aWNlIHByb3ZpZGVyIG9iamVjdHMgY2FuIGhhdmUgYWRkaXRpb25hbCBtZXRob2RzIHdoaWNoIGFsbG93IGNvbmZpZ3VyYXRpb24gb2YgdGhlIHByb3ZpZGVyXG5cdCAqIGFuZCBpdHMgc2VydmljZS4gSW1wb3J0YW50bHksIHlvdSBjYW4gY29uZmlndXJlIHdoYXQga2luZCBvZiBzZXJ2aWNlIGlzIGNyZWF0ZWQgYnkgdGhlIGAkZ2V0YFxuXHQgKiBtZXRob2QsIG9yIGhvdyB0aGF0IHNlcnZpY2Ugd2lsbCBhY3QuIEZvciBleGFtcGxlLCB0aGUge0BsaW5rIG5nLiRsb2dQcm92aWRlciAkbG9nUHJvdmlkZXJ9IGhhcyBhXG5cdCAqIG1ldGhvZCB7QGxpbmsgbmcuJGxvZ1Byb3ZpZGVyI2RlYnVnRW5hYmxlZCBkZWJ1Z0VuYWJsZWR9XG5cdCAqIHdoaWNoIGxldHMgeW91IHNwZWNpZnkgd2hldGhlciB0aGUge0BsaW5rIG5nLiRsb2cgJGxvZ30gc2VydmljZSB3aWxsIGxvZyBkZWJ1ZyBtZXNzYWdlcyB0byB0aGVcblx0ICogY29uc29sZSBvciBub3QuXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBpbnN0YW5jZS4gTk9URTogdGhlIHByb3ZpZGVyIHdpbGwgYmUgYXZhaWxhYmxlIHVuZGVyIGBuYW1lICtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgJ1Byb3ZpZGVyJ2Aga2V5LlxuXHQgKiBAcGFyYW0geyhPYmplY3R8ZnVuY3Rpb24oKSl9IHByb3ZpZGVyIElmIHRoZSBwcm92aWRlciBpczpcblx0ICpcblx0ICogICAtIGBPYmplY3RgOiB0aGVuIGl0IHNob3VsZCBoYXZlIGEgYCRnZXRgIG1ldGhvZC4gVGhlIGAkZ2V0YCBtZXRob2Qgd2lsbCBiZSBpbnZva2VkIHVzaW5nXG5cdCAqICAgICB7QGxpbmsgYXV0by4kaW5qZWN0b3IjaW52b2tlICRpbmplY3Rvci5pbnZva2UoKX0gd2hlbiBhbiBpbnN0YW5jZSBuZWVkcyB0byBiZSBjcmVhdGVkLlxuXHQgKiAgIC0gYENvbnN0cnVjdG9yYDogYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIHByb3ZpZGVyIHdpbGwgYmUgY3JlYXRlZCB1c2luZ1xuXHQgKiAgICAge0BsaW5rIGF1dG8uJGluamVjdG9yI2luc3RhbnRpYXRlICRpbmplY3Rvci5pbnN0YW50aWF0ZSgpfSwgdGhlbiB0cmVhdGVkIGFzIGBvYmplY3RgLlxuXHQgKlxuXHQgKiBAcmV0dXJucyB7T2JqZWN0fSByZWdpc3RlcmVkIHByb3ZpZGVyIGluc3RhbmNlXG5cdFxuXHQgKiBAZXhhbXBsZVxuXHQgKlxuXHQgKiBUaGUgZm9sbG93aW5nIGV4YW1wbGUgc2hvd3MgaG93IHRvIGNyZWF0ZSBhIHNpbXBsZSBldmVudCB0cmFja2luZyBzZXJ2aWNlIGFuZCByZWdpc3RlciBpdCB1c2luZ1xuXHQgKiB7QGxpbmsgYXV0by4kcHJvdmlkZSNwcm92aWRlciAkcHJvdmlkZS5wcm92aWRlcigpfS5cblx0ICpcblx0ICogYGBganNcblx0ICogIC8vIERlZmluZSB0aGUgZXZlbnRUcmFja2VyIHByb3ZpZGVyXG5cdCAqICBmdW5jdGlvbiBFdmVudFRyYWNrZXJQcm92aWRlcigpIHtcblx0ICogICAgdmFyIHRyYWNraW5nVXJsID0gJy90cmFjayc7XG5cdCAqXG5cdCAqICAgIC8vIEEgcHJvdmlkZXIgbWV0aG9kIGZvciBjb25maWd1cmluZyB3aGVyZSB0aGUgdHJhY2tlZCBldmVudHMgc2hvdWxkIGJlZW4gc2F2ZWRcblx0ICogICAgdGhpcy5zZXRUcmFja2luZ1VybCA9IGZ1bmN0aW9uKHVybCkge1xuXHQgKiAgICAgIHRyYWNraW5nVXJsID0gdXJsO1xuXHQgKiAgICB9O1xuXHQgKlxuXHQgKiAgICAvLyBUaGUgc2VydmljZSBmYWN0b3J5IGZ1bmN0aW9uXG5cdCAqICAgIHRoaXMuJGdldCA9IFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCkge1xuXHQgKiAgICAgIHZhciB0cmFja2VkRXZlbnRzID0ge307XG5cdCAqICAgICAgcmV0dXJuIHtcblx0ICogICAgICAgIC8vIENhbGwgdGhpcyB0byB0cmFjayBhbiBldmVudFxuXHQgKiAgICAgICAgZXZlbnQ6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdCAqICAgICAgICAgIHZhciBjb3VudCA9IHRyYWNrZWRFdmVudHNbZXZlbnRdIHx8IDA7XG5cdCAqICAgICAgICAgIGNvdW50ICs9IDE7XG5cdCAqICAgICAgICAgIHRyYWNrZWRFdmVudHNbZXZlbnRdID0gY291bnQ7XG5cdCAqICAgICAgICAgIHJldHVybiBjb3VudDtcblx0ICogICAgICAgIH0sXG5cdCAqICAgICAgICAvLyBDYWxsIHRoaXMgdG8gc2F2ZSB0aGUgdHJhY2tlZCBldmVudHMgdG8gdGhlIHRyYWNraW5nVXJsXG5cdCAqICAgICAgICBzYXZlOiBmdW5jdGlvbigpIHtcblx0ICogICAgICAgICAgJGh0dHAucG9zdCh0cmFja2luZ1VybCwgdHJhY2tlZEV2ZW50cyk7XG5cdCAqICAgICAgICB9XG5cdCAqICAgICAgfTtcblx0ICogICAgfV07XG5cdCAqICB9XG5cdCAqXG5cdCAqICBkZXNjcmliZSgnZXZlbnRUcmFja2VyJywgZnVuY3Rpb24oKSB7XG5cdCAqICAgIHZhciBwb3N0U3B5O1xuXHQgKlxuXHQgKiAgICBiZWZvcmVFYWNoKG1vZHVsZShmdW5jdGlvbigkcHJvdmlkZSkge1xuXHQgKiAgICAgIC8vIFJlZ2lzdGVyIHRoZSBldmVudFRyYWNrZXIgcHJvdmlkZXJcblx0ICogICAgICAkcHJvdmlkZS5wcm92aWRlcignZXZlbnRUcmFja2VyJywgRXZlbnRUcmFja2VyUHJvdmlkZXIpO1xuXHQgKiAgICB9KSk7XG5cdCAqXG5cdCAqICAgIGJlZm9yZUVhY2gobW9kdWxlKGZ1bmN0aW9uKGV2ZW50VHJhY2tlclByb3ZpZGVyKSB7XG5cdCAqICAgICAgLy8gQ29uZmlndXJlIGV2ZW50VHJhY2tlciBwcm92aWRlclxuXHQgKiAgICAgIGV2ZW50VHJhY2tlclByb3ZpZGVyLnNldFRyYWNraW5nVXJsKCcvY3VzdG9tLXRyYWNrJyk7XG5cdCAqICAgIH0pKTtcblx0ICpcblx0ICogICAgaXQoJ3RyYWNrcyBldmVudHMnLCBpbmplY3QoZnVuY3Rpb24oZXZlbnRUcmFja2VyKSB7XG5cdCAqICAgICAgZXhwZWN0KGV2ZW50VHJhY2tlci5ldmVudCgnbG9naW4nKSkudG9FcXVhbCgxKTtcblx0ICogICAgICBleHBlY3QoZXZlbnRUcmFja2VyLmV2ZW50KCdsb2dpbicpKS50b0VxdWFsKDIpO1xuXHQgKiAgICB9KSk7XG5cdCAqXG5cdCAqICAgIGl0KCdzYXZlcyB0byB0aGUgdHJhY2tpbmcgdXJsJywgaW5qZWN0KGZ1bmN0aW9uKGV2ZW50VHJhY2tlciwgJGh0dHApIHtcblx0ICogICAgICBwb3N0U3B5ID0gc3B5T24oJGh0dHAsICdwb3N0Jyk7XG5cdCAqICAgICAgZXZlbnRUcmFja2VyLmV2ZW50KCdsb2dpbicpO1xuXHQgKiAgICAgIGV2ZW50VHJhY2tlci5zYXZlKCk7XG5cdCAqICAgICAgZXhwZWN0KHBvc3RTcHkpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcblx0ICogICAgICBleHBlY3QocG9zdFNweS5tb3N0UmVjZW50Q2FsbC5hcmdzWzBdKS5ub3QudG9FcXVhbCgnL3RyYWNrJyk7XG5cdCAqICAgICAgZXhwZWN0KHBvc3RTcHkubW9zdFJlY2VudENhbGwuYXJnc1swXSkudG9FcXVhbCgnL2N1c3RvbS10cmFjaycpO1xuXHQgKiAgICAgIGV4cGVjdChwb3N0U3B5Lm1vc3RSZWNlbnRDYWxsLmFyZ3NbMV0pLnRvRXF1YWwoeyAnbG9naW4nOiAxIH0pO1xuXHQgKiAgICB9KSk7XG5cdCAqICB9KTtcblx0ICogYGBgXG5cdCAqL1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBtZXRob2Rcblx0ICogQG5hbWUgJHByb3ZpZGUjZmFjdG9yeVxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogUmVnaXN0ZXIgYSAqKnNlcnZpY2UgZmFjdG9yeSoqLCB3aGljaCB3aWxsIGJlIGNhbGxlZCB0byByZXR1cm4gdGhlIHNlcnZpY2UgaW5zdGFuY2UuXG5cdCAqIFRoaXMgaXMgc2hvcnQgZm9yIHJlZ2lzdGVyaW5nIGEgc2VydmljZSB3aGVyZSBpdHMgcHJvdmlkZXIgY29uc2lzdHMgb2Ygb25seSBhIGAkZ2V0YCBwcm9wZXJ0eSxcblx0ICogd2hpY2ggaXMgdGhlIGdpdmVuIHNlcnZpY2UgZmFjdG9yeSBmdW5jdGlvbi5cblx0ICogWW91IHNob3VsZCB1c2Uge0BsaW5rIGF1dG8uJHByb3ZpZGUjZmFjdG9yeSAkcHJvdmlkZS5mYWN0b3J5KGdldEZuKX0gaWYgeW91IGRvIG5vdCBuZWVkIHRvXG5cdCAqIGNvbmZpZ3VyZSB5b3VyIHNlcnZpY2UgaW4gYSBwcm92aWRlci5cblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGluc3RhbmNlLlxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufEFycmF5LjxzdHJpbmd8RnVuY3Rpb24+fSAkZ2V0Rm4gVGhlIGluamVjdGFibGUgJGdldEZuIGZvciB0aGUgaW5zdGFuY2UgY3JlYXRpb24uXG5cdCAqICAgICAgICAgICAgICAgICAgICAgIEludGVybmFsbHkgdGhpcyBpcyBhIHNob3J0IGhhbmQgZm9yIGAkcHJvdmlkZS5wcm92aWRlcihuYW1lLCB7JGdldDogJGdldEZufSlgLlxuXHQgKiBAcmV0dXJucyB7T2JqZWN0fSByZWdpc3RlcmVkIHByb3ZpZGVyIGluc3RhbmNlXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqIEhlcmUgaXMgYW4gZXhhbXBsZSBvZiByZWdpc3RlcmluZyBhIHNlcnZpY2Vcblx0ICogYGBganNcblx0ICogICAkcHJvdmlkZS5mYWN0b3J5KCdwaW5nJywgWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKSB7XG5cdCAqICAgICByZXR1cm4gZnVuY3Rpb24gcGluZygpIHtcblx0ICogICAgICAgcmV0dXJuICRodHRwLnNlbmQoJy9waW5nJyk7XG5cdCAqICAgICB9O1xuXHQgKiAgIH1dKTtcblx0ICogYGBgXG5cdCAqIFlvdSB3b3VsZCB0aGVuIGluamVjdCBhbmQgdXNlIHRoaXMgc2VydmljZSBsaWtlIHRoaXM6XG5cdCAqIGBgYGpzXG5cdCAqICAgc29tZU1vZHVsZS5jb250cm9sbGVyKCdDdHJsJywgWydwaW5nJywgZnVuY3Rpb24ocGluZykge1xuXHQgKiAgICAgcGluZygpO1xuXHQgKiAgIH1dKTtcblx0ICogYGBgXG5cdCAqL1xuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgbWV0aG9kXG5cdCAqIEBuYW1lICRwcm92aWRlI3NlcnZpY2Vcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqXG5cdCAqIFJlZ2lzdGVyIGEgKipzZXJ2aWNlIGNvbnN0cnVjdG9yKiosIHdoaWNoIHdpbGwgYmUgaW52b2tlZCB3aXRoIGBuZXdgIHRvIGNyZWF0ZSB0aGUgc2VydmljZVxuXHQgKiBpbnN0YW5jZS5cblx0ICogVGhpcyBpcyBzaG9ydCBmb3IgcmVnaXN0ZXJpbmcgYSBzZXJ2aWNlIHdoZXJlIGl0cyBwcm92aWRlcidzIGAkZ2V0YCBwcm9wZXJ0eSBpcyBhIGZhY3Rvcnlcblx0ICogZnVuY3Rpb24gdGhhdCByZXR1cm5zIGFuIGluc3RhbmNlIGluc3RhbnRpYXRlZCBieSB0aGUgaW5qZWN0b3IgZnJvbSB0aGUgc2VydmljZSBjb25zdHJ1Y3RvclxuXHQgKiBmdW5jdGlvbi5cblx0ICpcblx0ICogSW50ZXJuYWxseSBpdCBsb29rcyBhIGJpdCBsaWtlIHRoaXM6XG5cdCAqXG5cdCAqIGBgYFxuXHQgKiB7XG5cdCAqICAgJGdldDogZnVuY3Rpb24oKSB7XG5cdCAqICAgICByZXR1cm4gJGluamVjdG9yLmluc3RhbnRpYXRlKGNvbnN0cnVjdG9yKTtcblx0ICogICB9XG5cdCAqIH1cblx0ICogYGBgXG5cdCAqXG5cdCAqXG5cdCAqIFlvdSBzaG91bGQgdXNlIHtAbGluayBhdXRvLiRwcm92aWRlI3NlcnZpY2UgJHByb3ZpZGUuc2VydmljZShjbGFzcyl9IGlmIHlvdSBkZWZpbmUgeW91ciBzZXJ2aWNlXG5cdCAqIGFzIGEgdHlwZS9jbGFzcy5cblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGluc3RhbmNlLlxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufEFycmF5LjxzdHJpbmd8RnVuY3Rpb24+fSBjb25zdHJ1Y3RvciBBbiBpbmplY3RhYmxlIGNsYXNzIChjb25zdHJ1Y3RvciBmdW5jdGlvbilcblx0ICogICAgIHRoYXQgd2lsbCBiZSBpbnN0YW50aWF0ZWQuXG5cdCAqIEByZXR1cm5zIHtPYmplY3R9IHJlZ2lzdGVyZWQgcHJvdmlkZXIgaW5zdGFuY2Vcblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICogSGVyZSBpcyBhbiBleGFtcGxlIG9mIHJlZ2lzdGVyaW5nIGEgc2VydmljZSB1c2luZ1xuXHQgKiB7QGxpbmsgYXV0by4kcHJvdmlkZSNzZXJ2aWNlICRwcm92aWRlLnNlcnZpY2UoY2xhc3MpfS5cblx0ICogYGBganNcblx0ICogICB2YXIgUGluZyA9IGZ1bmN0aW9uKCRodHRwKSB7XG5cdCAqICAgICB0aGlzLiRodHRwID0gJGh0dHA7XG5cdCAqICAgfTtcblx0ICpcblx0ICogICBQaW5nLiRpbmplY3QgPSBbJyRodHRwJ107XG5cdCAqXG5cdCAqICAgUGluZy5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKCkge1xuXHQgKiAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0KCcvcGluZycpO1xuXHQgKiAgIH07XG5cdCAqICAgJHByb3ZpZGUuc2VydmljZSgncGluZycsIFBpbmcpO1xuXHQgKiBgYGBcblx0ICogWW91IHdvdWxkIHRoZW4gaW5qZWN0IGFuZCB1c2UgdGhpcyBzZXJ2aWNlIGxpa2UgdGhpczpcblx0ICogYGBganNcblx0ICogICBzb21lTW9kdWxlLmNvbnRyb2xsZXIoJ0N0cmwnLCBbJ3BpbmcnLCBmdW5jdGlvbihwaW5nKSB7XG5cdCAqICAgICBwaW5nLnNlbmQoKTtcblx0ICogICB9XSk7XG5cdCAqIGBgYFxuXHQgKi9cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIG1ldGhvZFxuXHQgKiBAbmFtZSAkcHJvdmlkZSN2YWx1ZVxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogUmVnaXN0ZXIgYSAqKnZhbHVlIHNlcnZpY2UqKiB3aXRoIHRoZSB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfSwgc3VjaCBhcyBhIHN0cmluZywgYVxuXHQgKiBudW1iZXIsIGFuIGFycmF5LCBhbiBvYmplY3Qgb3IgYSBmdW5jdGlvbi4gIFRoaXMgaXMgc2hvcnQgZm9yIHJlZ2lzdGVyaW5nIGEgc2VydmljZSB3aGVyZSBpdHNcblx0ICogcHJvdmlkZXIncyBgJGdldGAgcHJvcGVydHkgaXMgYSBmYWN0b3J5IGZ1bmN0aW9uIHRoYXQgdGFrZXMgbm8gYXJndW1lbnRzIGFuZCByZXR1cm5zIHRoZSAqKnZhbHVlXG5cdCAqIHNlcnZpY2UqKi5cblx0ICpcblx0ICogVmFsdWUgc2VydmljZXMgYXJlIHNpbWlsYXIgdG8gY29uc3RhbnQgc2VydmljZXMsIGV4Y2VwdCB0aGF0IHRoZXkgY2Fubm90IGJlIGluamVjdGVkIGludG8gYVxuXHQgKiBtb2R1bGUgY29uZmlndXJhdGlvbiBmdW5jdGlvbiAoc2VlIHtAbGluayBhbmd1bGFyLk1vZHVsZSNjb25maWd9KSBidXQgdGhleSBjYW4gYmUgb3ZlcnJpZGRlbiBieVxuXHQgKiBhbiBBbmd1bGFyXG5cdCAqIHtAbGluayBhdXRvLiRwcm92aWRlI2RlY29yYXRvciBkZWNvcmF0b3J9LlxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgaW5zdGFuY2UuXG5cdCAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlLlxuXHQgKiBAcmV0dXJucyB7T2JqZWN0fSByZWdpc3RlcmVkIHByb3ZpZGVyIGluc3RhbmNlXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqIEhlcmUgYXJlIHNvbWUgZXhhbXBsZXMgb2YgY3JlYXRpbmcgdmFsdWUgc2VydmljZXMuXG5cdCAqIGBgYGpzXG5cdCAqICAgJHByb3ZpZGUudmFsdWUoJ0FETUlOX1VTRVInLCAnYWRtaW4nKTtcblx0ICpcblx0ICogICAkcHJvdmlkZS52YWx1ZSgnUm9sZUxvb2t1cCcsIHsgYWRtaW46IDAsIHdyaXRlcjogMSwgcmVhZGVyOiAyIH0pO1xuXHQgKlxuXHQgKiAgICRwcm92aWRlLnZhbHVlKCdoYWxmT2YnLCBmdW5jdGlvbih2YWx1ZSkge1xuXHQgKiAgICAgcmV0dXJuIHZhbHVlIC8gMjtcblx0ICogICB9KTtcblx0ICogYGBgXG5cdCAqL1xuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgbWV0aG9kXG5cdCAqIEBuYW1lICRwcm92aWRlI2NvbnN0YW50XG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKlxuXHQgKiBSZWdpc3RlciBhICoqY29uc3RhbnQgc2VydmljZSoqLCBzdWNoIGFzIGEgc3RyaW5nLCBhIG51bWJlciwgYW4gYXJyYXksIGFuIG9iamVjdCBvciBhIGZ1bmN0aW9uLFxuXHQgKiB3aXRoIHRoZSB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfS4gVW5saWtlIHtAbGluayBhdXRvLiRwcm92aWRlI3ZhbHVlIHZhbHVlfSBpdCBjYW4gYmVcblx0ICogaW5qZWN0ZWQgaW50byBhIG1vZHVsZSBjb25maWd1cmF0aW9uIGZ1bmN0aW9uIChzZWUge0BsaW5rIGFuZ3VsYXIuTW9kdWxlI2NvbmZpZ30pIGFuZCBpdCBjYW5ub3Rcblx0ICogYmUgb3ZlcnJpZGRlbiBieSBhbiBBbmd1bGFyIHtAbGluayBhdXRvLiRwcm92aWRlI2RlY29yYXRvciBkZWNvcmF0b3J9LlxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgY29uc3RhbnQuXG5cdCAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIGNvbnN0YW50IHZhbHVlLlxuXHQgKiBAcmV0dXJucyB7T2JqZWN0fSByZWdpc3RlcmVkIGluc3RhbmNlXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqIEhlcmUgYSBzb21lIGV4YW1wbGVzIG9mIGNyZWF0aW5nIGNvbnN0YW50czpcblx0ICogYGBganNcblx0ICogICAkcHJvdmlkZS5jb25zdGFudCgnU0hBUkRfSEVJR0hUJywgMzA2KTtcblx0ICpcblx0ICogICAkcHJvdmlkZS5jb25zdGFudCgnTVlfQ09MT1VSUycsIFsncmVkJywgJ2JsdWUnLCAnZ3JleSddKTtcblx0ICpcblx0ICogICAkcHJvdmlkZS5jb25zdGFudCgnZG91YmxlJywgZnVuY3Rpb24odmFsdWUpIHtcblx0ICogICAgIHJldHVybiB2YWx1ZSAqIDI7XG5cdCAqICAgfSk7XG5cdCAqIGBgYFxuXHQgKi9cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIG1ldGhvZFxuXHQgKiBAbmFtZSAkcHJvdmlkZSNkZWNvcmF0b3Jcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqXG5cdCAqIFJlZ2lzdGVyIGEgKipzZXJ2aWNlIGRlY29yYXRvcioqIHdpdGggdGhlIHtAbGluayBhdXRvLiRpbmplY3RvciAkaW5qZWN0b3J9LiBBIHNlcnZpY2UgZGVjb3JhdG9yXG5cdCAqIGludGVyY2VwdHMgdGhlIGNyZWF0aW9uIG9mIGEgc2VydmljZSwgYWxsb3dpbmcgaXQgdG8gb3ZlcnJpZGUgb3IgbW9kaWZ5IHRoZSBiZWhhdmlvciBvZiB0aGVcblx0ICogc2VydmljZS4gVGhlIG9iamVjdCByZXR1cm5lZCBieSB0aGUgZGVjb3JhdG9yIG1heSBiZSB0aGUgb3JpZ2luYWwgc2VydmljZSwgb3IgYSBuZXcgc2VydmljZVxuXHQgKiBvYmplY3Qgd2hpY2ggcmVwbGFjZXMgb3Igd3JhcHMgYW5kIGRlbGVnYXRlcyB0byB0aGUgb3JpZ2luYWwgc2VydmljZS5cblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIHNlcnZpY2UgdG8gZGVjb3JhdGUuXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb258QXJyYXkuPHN0cmluZ3xGdW5jdGlvbj59IGRlY29yYXRvciBUaGlzIGZ1bmN0aW9uIHdpbGwgYmUgaW52b2tlZCB3aGVuIHRoZSBzZXJ2aWNlIG5lZWRzIHRvIGJlXG5cdCAqICAgIGluc3RhbnRpYXRlZCBhbmQgc2hvdWxkIHJldHVybiB0aGUgZGVjb3JhdGVkIHNlcnZpY2UgaW5zdGFuY2UuIFRoZSBmdW5jdGlvbiBpcyBjYWxsZWQgdXNpbmdcblx0ICogICAgdGhlIHtAbGluayBhdXRvLiRpbmplY3RvciNpbnZva2UgaW5qZWN0b3IuaW52b2tlfSBtZXRob2QgYW5kIGlzIHRoZXJlZm9yZSBmdWxseSBpbmplY3RhYmxlLlxuXHQgKiAgICBMb2NhbCBpbmplY3Rpb24gYXJndW1lbnRzOlxuXHQgKlxuXHQgKiAgICAqIGAkZGVsZWdhdGVgIC0gVGhlIG9yaWdpbmFsIHNlcnZpY2UgaW5zdGFuY2UsIHdoaWNoIGNhbiBiZSBtb25rZXkgcGF0Y2hlZCwgY29uZmlndXJlZCxcblx0ICogICAgICBkZWNvcmF0ZWQgb3IgZGVsZWdhdGVkIHRvLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgKiBIZXJlIHdlIGRlY29yYXRlIHRoZSB7QGxpbmsgbmcuJGxvZyAkbG9nfSBzZXJ2aWNlIHRvIGNvbnZlcnQgd2FybmluZ3MgdG8gZXJyb3JzIGJ5IGludGVyY2VwdGluZ1xuXHQgKiBjYWxscyB0byB7QGxpbmsgbmcuJGxvZyNlcnJvciAkbG9nLndhcm4oKX0uXG5cdCAqIGBgYGpzXG5cdCAqICAgJHByb3ZpZGUuZGVjb3JhdG9yKCckbG9nJywgWyckZGVsZWdhdGUnLCBmdW5jdGlvbigkZGVsZWdhdGUpIHtcblx0ICogICAgICRkZWxlZ2F0ZS53YXJuID0gJGRlbGVnYXRlLmVycm9yO1xuXHQgKiAgICAgcmV0dXJuICRkZWxlZ2F0ZTtcblx0ICogICB9XSk7XG5cdCAqIGBgYFxuXHQgKi9cblx0XG5cdFxuXHRmdW5jdGlvbiBjcmVhdGVJbmplY3Rvcihtb2R1bGVzVG9Mb2FkLCBzdHJpY3REaSkge1xuXHQgIHN0cmljdERpID0gKHN0cmljdERpID09PSB0cnVlKTtcblx0ICB2YXIgSU5TVEFOVElBVElORyA9IHt9LFxuXHQgICAgICBwcm92aWRlclN1ZmZpeCA9ICdQcm92aWRlcicsXG5cdCAgICAgIHBhdGggPSBbXSxcblx0ICAgICAgbG9hZGVkTW9kdWxlcyA9IG5ldyBIYXNoTWFwKFtdLCB0cnVlKSxcblx0ICAgICAgcHJvdmlkZXJDYWNoZSA9IHtcblx0ICAgICAgICAkcHJvdmlkZToge1xuXHQgICAgICAgICAgICBwcm92aWRlcjogc3VwcG9ydE9iamVjdChwcm92aWRlciksXG5cdCAgICAgICAgICAgIGZhY3Rvcnk6IHN1cHBvcnRPYmplY3QoZmFjdG9yeSksXG5cdCAgICAgICAgICAgIHNlcnZpY2U6IHN1cHBvcnRPYmplY3Qoc2VydmljZSksXG5cdCAgICAgICAgICAgIHZhbHVlOiBzdXBwb3J0T2JqZWN0KHZhbHVlKSxcblx0ICAgICAgICAgICAgY29uc3RhbnQ6IHN1cHBvcnRPYmplY3QoY29uc3RhbnQpLFxuXHQgICAgICAgICAgICBkZWNvcmF0b3I6IGRlY29yYXRvclxuXHQgICAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBwcm92aWRlckluamVjdG9yID0gKHByb3ZpZGVyQ2FjaGUuJGluamVjdG9yID1cblx0ICAgICAgICAgIGNyZWF0ZUludGVybmFsSW5qZWN0b3IocHJvdmlkZXJDYWNoZSwgZnVuY3Rpb24oc2VydmljZU5hbWUsIGNhbGxlcikge1xuXHQgICAgICAgICAgICBpZiAoYW5ndWxhci5pc1N0cmluZyhjYWxsZXIpKSB7XG5cdCAgICAgICAgICAgICAgcGF0aC5wdXNoKGNhbGxlcik7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgdGhyb3cgJGluamVjdG9yTWluRXJyKCd1bnByJywgXCJVbmtub3duIHByb3ZpZGVyOiB7MH1cIiwgcGF0aC5qb2luKCcgPC0gJykpO1xuXHQgICAgICAgICAgfSkpLFxuXHQgICAgICBpbnN0YW5jZUNhY2hlID0ge30sXG5cdCAgICAgIHByb3RvSW5zdGFuY2VJbmplY3RvciA9XG5cdCAgICAgICAgICBjcmVhdGVJbnRlcm5hbEluamVjdG9yKGluc3RhbmNlQ2FjaGUsIGZ1bmN0aW9uKHNlcnZpY2VOYW1lLCBjYWxsZXIpIHtcblx0ICAgICAgICAgICAgdmFyIHByb3ZpZGVyID0gcHJvdmlkZXJJbmplY3Rvci5nZXQoc2VydmljZU5hbWUgKyBwcm92aWRlclN1ZmZpeCwgY2FsbGVyKTtcblx0ICAgICAgICAgICAgcmV0dXJuIGluc3RhbmNlSW5qZWN0b3IuaW52b2tlKFxuXHQgICAgICAgICAgICAgICAgcHJvdmlkZXIuJGdldCwgcHJvdmlkZXIsIHVuZGVmaW5lZCwgc2VydmljZU5hbWUpO1xuXHQgICAgICAgICAgfSksXG5cdCAgICAgIGluc3RhbmNlSW5qZWN0b3IgPSBwcm90b0luc3RhbmNlSW5qZWN0b3I7XG5cdFxuXHQgIHByb3ZpZGVyQ2FjaGVbJyRpbmplY3RvcicgKyBwcm92aWRlclN1ZmZpeF0gPSB7ICRnZXQ6IHZhbHVlRm4ocHJvdG9JbnN0YW5jZUluamVjdG9yKSB9O1xuXHQgIHZhciBydW5CbG9ja3MgPSBsb2FkTW9kdWxlcyhtb2R1bGVzVG9Mb2FkKTtcblx0ICBpbnN0YW5jZUluamVjdG9yID0gcHJvdG9JbnN0YW5jZUluamVjdG9yLmdldCgnJGluamVjdG9yJyk7XG5cdCAgaW5zdGFuY2VJbmplY3Rvci5zdHJpY3REaSA9IHN0cmljdERpO1xuXHQgIGZvckVhY2gocnVuQmxvY2tzLCBmdW5jdGlvbihmbikgeyBpZiAoZm4pIGluc3RhbmNlSW5qZWN0b3IuaW52b2tlKGZuKTsgfSk7XG5cdFxuXHQgIHJldHVybiBpbnN0YW5jZUluamVjdG9yO1xuXHRcblx0ICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0ICAvLyAkcHJvdmlkZXJcblx0ICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdCAgZnVuY3Rpb24gc3VwcG9ydE9iamVjdChkZWxlZ2F0ZSkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcblx0ICAgICAgaWYgKGlzT2JqZWN0KGtleSkpIHtcblx0ICAgICAgICBmb3JFYWNoKGtleSwgcmV2ZXJzZVBhcmFtcyhkZWxlZ2F0ZSkpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHJldHVybiBkZWxlZ2F0ZShrZXksIHZhbHVlKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIHByb3ZpZGVyKG5hbWUsIHByb3ZpZGVyXykge1xuXHQgICAgYXNzZXJ0Tm90SGFzT3duUHJvcGVydHkobmFtZSwgJ3NlcnZpY2UnKTtcblx0ICAgIGlmIChpc0Z1bmN0aW9uKHByb3ZpZGVyXykgfHwgaXNBcnJheShwcm92aWRlcl8pKSB7XG5cdCAgICAgIHByb3ZpZGVyXyA9IHByb3ZpZGVySW5qZWN0b3IuaW5zdGFudGlhdGUocHJvdmlkZXJfKTtcblx0ICAgIH1cblx0ICAgIGlmICghcHJvdmlkZXJfLiRnZXQpIHtcblx0ICAgICAgdGhyb3cgJGluamVjdG9yTWluRXJyKCdwZ2V0JywgXCJQcm92aWRlciAnezB9JyBtdXN0IGRlZmluZSAkZ2V0IGZhY3RvcnkgbWV0aG9kLlwiLCBuYW1lKTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBwcm92aWRlckNhY2hlW25hbWUgKyBwcm92aWRlclN1ZmZpeF0gPSBwcm92aWRlcl87XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBlbmZvcmNlUmV0dXJuVmFsdWUobmFtZSwgZmFjdG9yeSkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uIGVuZm9yY2VkUmV0dXJuVmFsdWUoKSB7XG5cdCAgICAgIHZhciByZXN1bHQgPSBpbnN0YW5jZUluamVjdG9yLmludm9rZShmYWN0b3J5LCB0aGlzKTtcblx0ICAgICAgaWYgKGlzVW5kZWZpbmVkKHJlc3VsdCkpIHtcblx0ICAgICAgICB0aHJvdyAkaW5qZWN0b3JNaW5FcnIoJ3VuZGVmJywgXCJQcm92aWRlciAnezB9JyBtdXN0IHJldHVybiBhIHZhbHVlIGZyb20gJGdldCBmYWN0b3J5IG1ldGhvZC5cIiwgbmFtZSk7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIHJlc3VsdDtcblx0ICAgIH07XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBmYWN0b3J5KG5hbWUsIGZhY3RvcnlGbiwgZW5mb3JjZSkge1xuXHQgICAgcmV0dXJuIHByb3ZpZGVyKG5hbWUsIHtcblx0ICAgICAgJGdldDogZW5mb3JjZSAhPT0gZmFsc2UgPyBlbmZvcmNlUmV0dXJuVmFsdWUobmFtZSwgZmFjdG9yeUZuKSA6IGZhY3RvcnlGblxuXHQgICAgfSk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBzZXJ2aWNlKG5hbWUsIGNvbnN0cnVjdG9yKSB7XG5cdCAgICByZXR1cm4gZmFjdG9yeShuYW1lLCBbJyRpbmplY3RvcicsIGZ1bmN0aW9uKCRpbmplY3Rvcikge1xuXHQgICAgICByZXR1cm4gJGluamVjdG9yLmluc3RhbnRpYXRlKGNvbnN0cnVjdG9yKTtcblx0ICAgIH1dKTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIHZhbHVlKG5hbWUsIHZhbCkgeyByZXR1cm4gZmFjdG9yeShuYW1lLCB2YWx1ZUZuKHZhbCksIGZhbHNlKTsgfVxuXHRcblx0ICBmdW5jdGlvbiBjb25zdGFudChuYW1lLCB2YWx1ZSkge1xuXHQgICAgYXNzZXJ0Tm90SGFzT3duUHJvcGVydHkobmFtZSwgJ2NvbnN0YW50Jyk7XG5cdCAgICBwcm92aWRlckNhY2hlW25hbWVdID0gdmFsdWU7XG5cdCAgICBpbnN0YW5jZUNhY2hlW25hbWVdID0gdmFsdWU7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBkZWNvcmF0b3Ioc2VydmljZU5hbWUsIGRlY29yRm4pIHtcblx0ICAgIHZhciBvcmlnUHJvdmlkZXIgPSBwcm92aWRlckluamVjdG9yLmdldChzZXJ2aWNlTmFtZSArIHByb3ZpZGVyU3VmZml4KSxcblx0ICAgICAgICBvcmlnJGdldCA9IG9yaWdQcm92aWRlci4kZ2V0O1xuXHRcblx0ICAgIG9yaWdQcm92aWRlci4kZ2V0ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHZhciBvcmlnSW5zdGFuY2UgPSBpbnN0YW5jZUluamVjdG9yLmludm9rZShvcmlnJGdldCwgb3JpZ1Byb3ZpZGVyKTtcblx0ICAgICAgcmV0dXJuIGluc3RhbmNlSW5qZWN0b3IuaW52b2tlKGRlY29yRm4sIG51bGwsIHskZGVsZWdhdGU6IG9yaWdJbnN0YW5jZX0pO1xuXHQgICAgfTtcblx0ICB9XG5cdFxuXHQgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQgIC8vIE1vZHVsZSBMb2FkaW5nXG5cdCAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdCAgZnVuY3Rpb24gbG9hZE1vZHVsZXMobW9kdWxlc1RvTG9hZCkge1xuXHQgICAgYXNzZXJ0QXJnKGlzVW5kZWZpbmVkKG1vZHVsZXNUb0xvYWQpIHx8IGlzQXJyYXkobW9kdWxlc1RvTG9hZCksICdtb2R1bGVzVG9Mb2FkJywgJ25vdCBhbiBhcnJheScpO1xuXHQgICAgdmFyIHJ1bkJsb2NrcyA9IFtdLCBtb2R1bGVGbjtcblx0ICAgIGZvckVhY2gobW9kdWxlc1RvTG9hZCwgZnVuY3Rpb24obW9kdWxlKSB7XG5cdCAgICAgIGlmIChsb2FkZWRNb2R1bGVzLmdldChtb2R1bGUpKSByZXR1cm47XG5cdCAgICAgIGxvYWRlZE1vZHVsZXMucHV0KG1vZHVsZSwgdHJ1ZSk7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBydW5JbnZva2VRdWV1ZShxdWV1ZSkge1xuXHQgICAgICAgIHZhciBpLCBpaTtcblx0ICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHF1ZXVlLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0ICAgICAgICAgIHZhciBpbnZva2VBcmdzID0gcXVldWVbaV0sXG5cdCAgICAgICAgICAgICAgcHJvdmlkZXIgPSBwcm92aWRlckluamVjdG9yLmdldChpbnZva2VBcmdzWzBdKTtcblx0XG5cdCAgICAgICAgICBwcm92aWRlcltpbnZva2VBcmdzWzFdXS5hcHBseShwcm92aWRlciwgaW52b2tlQXJnc1syXSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdFxuXHQgICAgICB0cnkge1xuXHQgICAgICAgIGlmIChpc1N0cmluZyhtb2R1bGUpKSB7XG5cdCAgICAgICAgICBtb2R1bGVGbiA9IGFuZ3VsYXJNb2R1bGUobW9kdWxlKTtcblx0ICAgICAgICAgIHJ1bkJsb2NrcyA9IHJ1bkJsb2Nrcy5jb25jYXQobG9hZE1vZHVsZXMobW9kdWxlRm4ucmVxdWlyZXMpKS5jb25jYXQobW9kdWxlRm4uX3J1bkJsb2Nrcyk7XG5cdCAgICAgICAgICBydW5JbnZva2VRdWV1ZShtb2R1bGVGbi5faW52b2tlUXVldWUpO1xuXHQgICAgICAgICAgcnVuSW52b2tlUXVldWUobW9kdWxlRm4uX2NvbmZpZ0Jsb2Nrcyk7XG5cdCAgICAgICAgfSBlbHNlIGlmIChpc0Z1bmN0aW9uKG1vZHVsZSkpIHtcblx0ICAgICAgICAgICAgcnVuQmxvY2tzLnB1c2gocHJvdmlkZXJJbmplY3Rvci5pbnZva2UobW9kdWxlKSk7XG5cdCAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5KG1vZHVsZSkpIHtcblx0ICAgICAgICAgICAgcnVuQmxvY2tzLnB1c2gocHJvdmlkZXJJbmplY3Rvci5pbnZva2UobW9kdWxlKSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGFzc2VydEFyZ0ZuKG1vZHVsZSwgJ21vZHVsZScpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgIGlmIChpc0FycmF5KG1vZHVsZSkpIHtcblx0ICAgICAgICAgIG1vZHVsZSA9IG1vZHVsZVttb2R1bGUubGVuZ3RoIC0gMV07XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmIChlLm1lc3NhZ2UgJiYgZS5zdGFjayAmJiBlLnN0YWNrLmluZGV4T2YoZS5tZXNzYWdlKSA9PSAtMSkge1xuXHQgICAgICAgICAgLy8gU2FmYXJpICYgRkYncyBzdGFjayB0cmFjZXMgZG9uJ3QgY29udGFpbiBlcnJvci5tZXNzYWdlIGNvbnRlbnRcblx0ICAgICAgICAgIC8vIHVubGlrZSB0aG9zZSBvZiBDaHJvbWUgYW5kIElFXG5cdCAgICAgICAgICAvLyBTbyBpZiBzdGFjayBkb2Vzbid0IGNvbnRhaW4gbWVzc2FnZSwgd2UgY3JlYXRlIGEgbmV3IHN0cmluZyB0aGF0IGNvbnRhaW5zIGJvdGguXG5cdCAgICAgICAgICAvLyBTaW5jZSBlcnJvci5zdGFjayBpcyByZWFkLW9ubHkgaW4gU2FmYXJpLCBJJ20gb3ZlcnJpZGluZyBlIGFuZCBub3QgZS5zdGFjayBoZXJlLlxuXHQgICAgICAgICAgLyoganNoaW50IC1XMDIyICovXG5cdCAgICAgICAgICBlID0gZS5tZXNzYWdlICsgJ1xcbicgKyBlLnN0YWNrO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB0aHJvdyAkaW5qZWN0b3JNaW5FcnIoJ21vZHVsZXJyJywgXCJGYWlsZWQgdG8gaW5zdGFudGlhdGUgbW9kdWxlIHswfSBkdWUgdG86XFxuezF9XCIsXG5cdCAgICAgICAgICAgICAgICAgIG1vZHVsZSwgZS5zdGFjayB8fCBlLm1lc3NhZ2UgfHwgZSk7XG5cdCAgICAgIH1cblx0ICAgIH0pO1xuXHQgICAgcmV0dXJuIHJ1bkJsb2Nrcztcblx0ICB9XG5cdFxuXHQgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQgIC8vIGludGVybmFsIEluamVjdG9yXG5cdCAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHQgIGZ1bmN0aW9uIGNyZWF0ZUludGVybmFsSW5qZWN0b3IoY2FjaGUsIGZhY3RvcnkpIHtcblx0XG5cdCAgICBmdW5jdGlvbiBnZXRTZXJ2aWNlKHNlcnZpY2VOYW1lLCBjYWxsZXIpIHtcblx0ICAgICAgaWYgKGNhY2hlLmhhc093blByb3BlcnR5KHNlcnZpY2VOYW1lKSkge1xuXHQgICAgICAgIGlmIChjYWNoZVtzZXJ2aWNlTmFtZV0gPT09IElOU1RBTlRJQVRJTkcpIHtcblx0ICAgICAgICAgIHRocm93ICRpbmplY3Rvck1pbkVycignY2RlcCcsICdDaXJjdWxhciBkZXBlbmRlbmN5IGZvdW5kOiB7MH0nLFxuXHQgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VOYW1lICsgJyA8LSAnICsgcGF0aC5qb2luKCcgPC0gJykpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gY2FjaGVbc2VydmljZU5hbWVdO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICBwYXRoLnVuc2hpZnQoc2VydmljZU5hbWUpO1xuXHQgICAgICAgICAgY2FjaGVbc2VydmljZU5hbWVdID0gSU5TVEFOVElBVElORztcblx0ICAgICAgICAgIHJldHVybiBjYWNoZVtzZXJ2aWNlTmFtZV0gPSBmYWN0b3J5KHNlcnZpY2VOYW1lLCBjYWxsZXIpO1xuXHQgICAgICAgIH0gY2F0Y2ggKGVycikge1xuXHQgICAgICAgICAgaWYgKGNhY2hlW3NlcnZpY2VOYW1lXSA9PT0gSU5TVEFOVElBVElORykge1xuXHQgICAgICAgICAgICBkZWxldGUgY2FjaGVbc2VydmljZU5hbWVdO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgdGhyb3cgZXJyO1xuXHQgICAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgICBwYXRoLnNoaWZ0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIGZ1bmN0aW9uIGluamVjdGlvbkFyZ3MoZm4sIGxvY2Fscywgc2VydmljZU5hbWUpIHtcblx0ICAgICAgdmFyIGFyZ3MgPSBbXSxcblx0ICAgICAgICAgICRpbmplY3QgPSBjcmVhdGVJbmplY3Rvci4kJGFubm90YXRlKGZuLCBzdHJpY3REaSwgc2VydmljZU5hbWUpO1xuXHRcblx0ICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9ICRpbmplY3QubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICB2YXIga2V5ID0gJGluamVjdFtpXTtcblx0ICAgICAgICBpZiAodHlwZW9mIGtleSAhPT0gJ3N0cmluZycpIHtcblx0ICAgICAgICAgIHRocm93ICRpbmplY3Rvck1pbkVycignaXRrbicsXG5cdCAgICAgICAgICAgICAgICAgICdJbmNvcnJlY3QgaW5qZWN0aW9uIHRva2VuISBFeHBlY3RlZCBzZXJ2aWNlIG5hbWUgYXMgc3RyaW5nLCBnb3QgezB9Jywga2V5KTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgYXJncy5wdXNoKGxvY2FscyAmJiBsb2NhbHMuaGFzT3duUHJvcGVydHkoa2V5KSA/IGxvY2Fsc1trZXldIDpcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0U2VydmljZShrZXksIHNlcnZpY2VOYW1lKSk7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIGFyZ3M7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gaXNDbGFzcyhmdW5jKSB7XG5cdCAgICAgIC8vIElFIDktMTEgZG8gbm90IHN1cHBvcnQgY2xhc3NlcyBhbmQgSUU5IGxlYWtzIHdpdGggdGhlIGNvZGUgYmVsb3cuXG5cdCAgICAgIGlmIChtc2llIDw9IDExKSB7XG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9XG5cdCAgICAgIC8vIFdvcmthcm91bmQgZm9yIE1TIEVkZ2UuXG5cdCAgICAgIC8vIENoZWNrIGh0dHBzOi8vY29ubmVjdC5taWNyb3NvZnQuY29tL0lFL0ZlZWRiYWNrL0RldGFpbHMvMjIxMTY1M1xuXHQgICAgICByZXR1cm4gdHlwZW9mIGZ1bmMgPT09ICdmdW5jdGlvbidcblx0ICAgICAgICAmJiAvXig/OmNsYXNzXFxzfGNvbnN0cnVjdG9yXFwoKS8udGVzdChGdW5jdGlvbi5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChmdW5jKSk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gaW52b2tlKGZuLCBzZWxmLCBsb2NhbHMsIHNlcnZpY2VOYW1lKSB7XG5cdCAgICAgIGlmICh0eXBlb2YgbG9jYWxzID09PSAnc3RyaW5nJykge1xuXHQgICAgICAgIHNlcnZpY2VOYW1lID0gbG9jYWxzO1xuXHQgICAgICAgIGxvY2FscyA9IG51bGw7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHZhciBhcmdzID0gaW5qZWN0aW9uQXJncyhmbiwgbG9jYWxzLCBzZXJ2aWNlTmFtZSk7XG5cdCAgICAgIGlmIChpc0FycmF5KGZuKSkge1xuXHQgICAgICAgIGZuID0gZm5bZm4ubGVuZ3RoIC0gMV07XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGlmICghaXNDbGFzcyhmbikpIHtcblx0ICAgICAgICAvLyBodHRwOi8vanNwZXJmLmNvbS9hbmd1bGFyanMtaW52b2tlLWFwcGx5LXZzLXN3aXRjaFxuXHQgICAgICAgIC8vICM1Mzg4XG5cdCAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHNlbGYsIGFyZ3MpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGFyZ3MudW5zaGlmdChudWxsKTtcblx0ICAgICAgICByZXR1cm4gbmV3IChGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5hcHBseShmbiwgYXJncykpKCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdFxuXHQgICAgZnVuY3Rpb24gaW5zdGFudGlhdGUoVHlwZSwgbG9jYWxzLCBzZXJ2aWNlTmFtZSkge1xuXHQgICAgICAvLyBDaGVjayBpZiBUeXBlIGlzIGFubm90YXRlZCBhbmQgdXNlIGp1c3QgdGhlIGdpdmVuIGZ1bmN0aW9uIGF0IG4tMSBhcyBwYXJhbWV0ZXJcblx0ICAgICAgLy8gZS5nLiBzb21lTW9kdWxlLmZhY3RvcnkoJ2dyZWV0ZXInLCBbJyR3aW5kb3cnLCBmdW5jdGlvbihyZW5hbWVkJHdpbmRvdykge31dKTtcblx0ICAgICAgdmFyIGN0b3IgPSAoaXNBcnJheShUeXBlKSA/IFR5cGVbVHlwZS5sZW5ndGggLSAxXSA6IFR5cGUpO1xuXHQgICAgICB2YXIgYXJncyA9IGluamVjdGlvbkFyZ3MoVHlwZSwgbG9jYWxzLCBzZXJ2aWNlTmFtZSk7XG5cdCAgICAgIC8vIEVtcHR5IG9iamVjdCBhdCBwb3NpdGlvbiAwIGlzIGlnbm9yZWQgZm9yIGludm9jYXRpb24gd2l0aCBgbmV3YCwgYnV0IHJlcXVpcmVkLlxuXHQgICAgICBhcmdzLnVuc2hpZnQobnVsbCk7XG5cdCAgICAgIHJldHVybiBuZXcgKEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmFwcGx5KGN0b3IsIGFyZ3MpKSgpO1xuXHQgICAgfVxuXHRcblx0XG5cdCAgICByZXR1cm4ge1xuXHQgICAgICBpbnZva2U6IGludm9rZSxcblx0ICAgICAgaW5zdGFudGlhdGU6IGluc3RhbnRpYXRlLFxuXHQgICAgICBnZXQ6IGdldFNlcnZpY2UsXG5cdCAgICAgIGFubm90YXRlOiBjcmVhdGVJbmplY3Rvci4kJGFubm90YXRlLFxuXHQgICAgICBoYXM6IGZ1bmN0aW9uKG5hbWUpIHtcblx0ICAgICAgICByZXR1cm4gcHJvdmlkZXJDYWNoZS5oYXNPd25Qcm9wZXJ0eShuYW1lICsgcHJvdmlkZXJTdWZmaXgpIHx8IGNhY2hlLmhhc093blByb3BlcnR5KG5hbWUpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgIH1cblx0fVxuXHRcblx0Y3JlYXRlSW5qZWN0b3IuJCRhbm5vdGF0ZSA9IGFubm90YXRlO1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBwcm92aWRlclxuXHQgKiBAbmFtZSAkYW5jaG9yU2Nyb2xsUHJvdmlkZXJcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFVzZSBgJGFuY2hvclNjcm9sbFByb3ZpZGVyYCB0byBkaXNhYmxlIGF1dG9tYXRpYyBzY3JvbGxpbmcgd2hlbmV2ZXJcblx0ICoge0BsaW5rIG5nLiRsb2NhdGlvbiNoYXNoICRsb2NhdGlvbi5oYXNoKCl9IGNoYW5nZXMuXG5cdCAqL1xuXHRmdW5jdGlvbiAkQW5jaG9yU2Nyb2xsUHJvdmlkZXIoKSB7XG5cdFxuXHQgIHZhciBhdXRvU2Nyb2xsaW5nRW5hYmxlZCA9IHRydWU7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkYW5jaG9yU2Nyb2xsUHJvdmlkZXIjZGlzYWJsZUF1dG9TY3JvbGxpbmdcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIEJ5IGRlZmF1bHQsIHtAbGluayBuZy4kYW5jaG9yU2Nyb2xsICRhbmNob3JTY3JvbGwoKX0gd2lsbCBhdXRvbWF0aWNhbGx5IGRldGVjdCBjaGFuZ2VzIHRvXG5cdCAgICoge0BsaW5rIG5nLiRsb2NhdGlvbiNoYXNoICRsb2NhdGlvbi5oYXNoKCl9IGFuZCBzY3JvbGwgdG8gdGhlIGVsZW1lbnQgbWF0Y2hpbmcgdGhlIG5ldyBoYXNoLjxiciAvPlxuXHQgICAqIFVzZSB0aGlzIG1ldGhvZCB0byBkaXNhYmxlIGF1dG9tYXRpYyBzY3JvbGxpbmcuXG5cdCAgICpcblx0ICAgKiBJZiBhdXRvbWF0aWMgc2Nyb2xsaW5nIGlzIGRpc2FibGVkLCBvbmUgbXVzdCBleHBsaWNpdGx5IGNhbGxcblx0ICAgKiB7QGxpbmsgbmcuJGFuY2hvclNjcm9sbCAkYW5jaG9yU2Nyb2xsKCl9IGluIG9yZGVyIHRvIHNjcm9sbCB0byB0aGUgZWxlbWVudCByZWxhdGVkIHRvIHRoZVxuXHQgICAqIGN1cnJlbnQgaGFzaC5cblx0ICAgKi9cblx0ICB0aGlzLmRpc2FibGVBdXRvU2Nyb2xsaW5nID0gZnVuY3Rpb24oKSB7XG5cdCAgICBhdXRvU2Nyb2xsaW5nRW5hYmxlZCA9IGZhbHNlO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBzZXJ2aWNlXG5cdCAgICogQG5hbWUgJGFuY2hvclNjcm9sbFxuXHQgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICogQHJlcXVpcmVzICR3aW5kb3dcblx0ICAgKiBAcmVxdWlyZXMgJGxvY2F0aW9uXG5cdCAgICogQHJlcXVpcmVzICRyb290U2NvcGVcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFdoZW4gY2FsbGVkLCBpdCBzY3JvbGxzIHRvIHRoZSBlbGVtZW50IHJlbGF0ZWQgdG8gdGhlIHNwZWNpZmllZCBgaGFzaGAgb3IgKGlmIG9taXR0ZWQpIHRvIHRoZVxuXHQgICAqIGN1cnJlbnQgdmFsdWUgb2Yge0BsaW5rIG5nLiRsb2NhdGlvbiNoYXNoICRsb2NhdGlvbi5oYXNoKCl9LCBhY2NvcmRpbmcgdG8gdGhlIHJ1bGVzIHNwZWNpZmllZFxuXHQgICAqIGluIHRoZVxuXHQgICAqIFtIVE1MNSBzcGVjXShodHRwOi8vd3d3LnczLm9yZy9odG1sL3dnL2RyYWZ0cy9odG1sL21hc3Rlci9icm93c2Vycy5odG1sI3RoZS1pbmRpY2F0ZWQtcGFydC1vZi10aGUtZG9jdW1lbnQpLlxuXHQgICAqXG5cdCAgICogSXQgYWxzbyB3YXRjaGVzIHRoZSB7QGxpbmsgbmcuJGxvY2F0aW9uI2hhc2ggJGxvY2F0aW9uLmhhc2goKX0gYW5kIGF1dG9tYXRpY2FsbHkgc2Nyb2xscyB0b1xuXHQgICAqIG1hdGNoIGFueSBhbmNob3Igd2hlbmV2ZXIgaXQgY2hhbmdlcy4gVGhpcyBjYW4gYmUgZGlzYWJsZWQgYnkgY2FsbGluZ1xuXHQgICAqIHtAbGluayBuZy4kYW5jaG9yU2Nyb2xsUHJvdmlkZXIjZGlzYWJsZUF1dG9TY3JvbGxpbmcgJGFuY2hvclNjcm9sbFByb3ZpZGVyLmRpc2FibGVBdXRvU2Nyb2xsaW5nKCl9LlxuXHQgICAqXG5cdCAgICogQWRkaXRpb25hbGx5LCB5b3UgY2FuIHVzZSBpdHMge0BsaW5rIG5nLiRhbmNob3JTY3JvbGwjeU9mZnNldCB5T2Zmc2V0fSBwcm9wZXJ0eSB0byBzcGVjaWZ5IGFcblx0ICAgKiB2ZXJ0aWNhbCBzY3JvbGwtb2Zmc2V0IChlaXRoZXIgZml4ZWQgb3IgZHluYW1pYykuXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IGhhc2ggVGhlIGhhc2ggc3BlY2lmeWluZyB0aGUgZWxlbWVudCB0byBzY3JvbGwgdG8uIElmIG9taXR0ZWQsIHRoZSB2YWx1ZSBvZlxuXHQgICAqICAgICAgICAgICAgICAgICAgICAgICB7QGxpbmsgbmcuJGxvY2F0aW9uI2hhc2ggJGxvY2F0aW9uLmhhc2goKX0gd2lsbCBiZSB1c2VkLlxuXHQgICAqXG5cdCAgICogQHByb3BlcnR5IHsobnVtYmVyfGZ1bmN0aW9ufGpxTGl0ZSl9IHlPZmZzZXRcblx0ICAgKiBJZiBzZXQsIHNwZWNpZmllcyBhIHZlcnRpY2FsIHNjcm9sbC1vZmZzZXQuIFRoaXMgaXMgb2Z0ZW4gdXNlZnVsIHdoZW4gdGhlcmUgYXJlIGZpeGVkXG5cdCAgICogcG9zaXRpb25lZCBlbGVtZW50cyBhdCB0aGUgdG9wIG9mIHRoZSBwYWdlLCBzdWNoIGFzIG5hdmJhcnMsIGhlYWRlcnMgZXRjLlxuXHQgICAqXG5cdCAgICogYHlPZmZzZXRgIGNhbiBiZSBzcGVjaWZpZWQgaW4gdmFyaW91cyB3YXlzOlxuXHQgICAqIC0gKipudW1iZXIqKjogQSBmaXhlZCBudW1iZXIgb2YgcGl4ZWxzIHRvIGJlIHVzZWQgYXMgb2Zmc2V0LjxiciAvPjxiciAvPlxuXHQgICAqIC0gKipmdW5jdGlvbioqOiBBIGdldHRlciBmdW5jdGlvbiBjYWxsZWQgZXZlcnl0aW1lIGAkYW5jaG9yU2Nyb2xsKClgIGlzIGV4ZWN1dGVkLiBNdXN0IHJldHVyblxuXHQgICAqICAgYSBudW1iZXIgcmVwcmVzZW50aW5nIHRoZSBvZmZzZXQgKGluIHBpeGVscykuPGJyIC8+PGJyIC8+XG5cdCAgICogLSAqKmpxTGl0ZSoqOiBBIGpxTGl0ZS9qUXVlcnkgZWxlbWVudCB0byBiZSB1c2VkIGZvciBzcGVjaWZ5aW5nIHRoZSBvZmZzZXQuIFRoZSBkaXN0YW5jZSBmcm9tXG5cdCAgICogICB0aGUgdG9wIG9mIHRoZSBwYWdlIHRvIHRoZSBlbGVtZW50J3MgYm90dG9tIHdpbGwgYmUgdXNlZCBhcyBvZmZzZXQuPGJyIC8+XG5cdCAgICogICAqKk5vdGUqKjogVGhlIGVsZW1lbnQgd2lsbCBiZSB0YWtlbiBpbnRvIGFjY291bnQgb25seSBhcyBsb25nIGFzIGl0cyBgcG9zaXRpb25gIGlzIHNldCB0b1xuXHQgICAqICAgYGZpeGVkYC4gVGhpcyBvcHRpb24gaXMgdXNlZnVsLCB3aGVuIGRlYWxpbmcgd2l0aCByZXNwb25zaXZlIG5hdmJhcnMvaGVhZGVycyB0aGF0IGFkanVzdFxuXHQgICAqICAgdGhlaXIgaGVpZ2h0IGFuZC9vciBwb3NpdGlvbmluZyBhY2NvcmRpbmcgdG8gdGhlIHZpZXdwb3J0J3Mgc2l6ZS5cblx0ICAgKlxuXHQgICAqIDxiciAvPlxuXHQgICAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG5cdCAgICogSW4gb3JkZXIgZm9yIGB5T2Zmc2V0YCB0byB3b3JrIHByb3Blcmx5LCBzY3JvbGxpbmcgc2hvdWxkIHRha2UgcGxhY2Ugb24gdGhlIGRvY3VtZW50J3Mgcm9vdCBhbmRcblx0ICAgKiBub3Qgc29tZSBjaGlsZCBlbGVtZW50LlxuXHQgICAqIDwvZGl2PlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgICA8ZXhhbXBsZSBtb2R1bGU9XCJhbmNob3JTY3JvbGxFeGFtcGxlXCI+XG5cdCAgICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgICA8ZGl2IGlkPVwic2Nyb2xsQXJlYVwiIG5nLWNvbnRyb2xsZXI9XCJTY3JvbGxDb250cm9sbGVyXCI+XG5cdCAgICAgICAgICAgPGEgbmctY2xpY2s9XCJnb3RvQm90dG9tKClcIj5HbyB0byBib3R0b208L2E+XG5cdCAgICAgICAgICAgPGEgaWQ9XCJib3R0b21cIj48L2E+IFlvdSdyZSBhdCB0aGUgYm90dG9tIVxuXHQgICAgICAgICA8L2Rpdj5cblx0ICAgICAgIDwvZmlsZT5cblx0ICAgICAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cblx0ICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2FuY2hvclNjcm9sbEV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAgICAuY29udHJvbGxlcignU2Nyb2xsQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRsb2NhdGlvbicsICckYW5jaG9yU2Nyb2xsJyxcblx0ICAgICAgICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbiwgJGFuY2hvclNjcm9sbCkge1xuXHQgICAgICAgICAgICAgICAkc2NvcGUuZ290b0JvdHRvbSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgbG9jYXRpb24uaGFzaCB0byB0aGUgaWQgb2Zcblx0ICAgICAgICAgICAgICAgICAvLyB0aGUgZWxlbWVudCB5b3Ugd2lzaCB0byBzY3JvbGwgdG8uXG5cdCAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLmhhc2goJ2JvdHRvbScpO1xuXHRcblx0ICAgICAgICAgICAgICAgICAvLyBjYWxsICRhbmNob3JTY3JvbGwoKVxuXHQgICAgICAgICAgICAgICAgICRhbmNob3JTY3JvbGwoKTtcblx0ICAgICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgIH1dKTtcblx0ICAgICAgIDwvZmlsZT5cblx0ICAgICAgIDxmaWxlIG5hbWU9XCJzdHlsZS5jc3NcIj5cblx0ICAgICAgICAgI3Njcm9sbEFyZWEge1xuXHQgICAgICAgICAgIGhlaWdodDogMjgwcHg7XG5cdCAgICAgICAgICAgb3ZlcmZsb3c6IGF1dG87XG5cdCAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICNib3R0b20ge1xuXHQgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuXHQgICAgICAgICAgIG1hcmdpbi10b3A6IDIwMDBweDtcblx0ICAgICAgICAgfVxuXHQgICAgICAgPC9maWxlPlxuXHQgICAgIDwvZXhhbXBsZT5cblx0ICAgKlxuXHQgICAqIDxociAvPlxuXHQgICAqIFRoZSBleGFtcGxlIGJlbG93IGlsbHVzdHJhdGVzIHRoZSB1c2Ugb2YgYSB2ZXJ0aWNhbCBzY3JvbGwtb2Zmc2V0IChzcGVjaWZpZWQgYXMgYSBmaXhlZCB2YWx1ZSkuXG5cdCAgICogU2VlIHtAbGluayBuZy4kYW5jaG9yU2Nyb2xsI3lPZmZzZXQgJGFuY2hvclNjcm9sbC55T2Zmc2V0fSBmb3IgbW9yZSBkZXRhaWxzLlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgICA8ZXhhbXBsZSBtb2R1bGU9XCJhbmNob3JTY3JvbGxPZmZzZXRFeGFtcGxlXCI+XG5cdCAgICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgICA8ZGl2IGNsYXNzPVwiZml4ZWQtaGVhZGVyXCIgbmctY29udHJvbGxlcj1cImhlYWRlckN0cmxcIj5cblx0ICAgICAgICAgICA8YSBocmVmPVwiXCIgbmctY2xpY2s9XCJnb3RvQW5jaG9yKHgpXCIgbmctcmVwZWF0PVwieCBpbiBbMSwyLDMsNCw1XVwiPlxuXHQgICAgICAgICAgICAgR28gdG8gYW5jaG9yIHt7eH19XG5cdCAgICAgICAgICAgPC9hPlxuXHQgICAgICAgICA8L2Rpdj5cblx0ICAgICAgICAgPGRpdiBpZD1cImFuY2hvcnt7eH19XCIgY2xhc3M9XCJhbmNob3JcIiBuZy1yZXBlYXQ9XCJ4IGluIFsxLDIsMyw0LDVdXCI+XG5cdCAgICAgICAgICAgQW5jaG9yIHt7eH19IG9mIDVcblx0ICAgICAgICAgPC9kaXY+XG5cdCAgICAgICA8L2ZpbGU+XG5cdCAgICAgICA8ZmlsZSBuYW1lPVwic2NyaXB0LmpzXCI+XG5cdCAgICAgICAgIGFuZ3VsYXIubW9kdWxlKCdhbmNob3JTY3JvbGxPZmZzZXRFeGFtcGxlJywgW10pXG5cdCAgICAgICAgICAgLnJ1bihbJyRhbmNob3JTY3JvbGwnLCBmdW5jdGlvbigkYW5jaG9yU2Nyb2xsKSB7XG5cdCAgICAgICAgICAgICAkYW5jaG9yU2Nyb2xsLnlPZmZzZXQgPSA1MDsgICAvLyBhbHdheXMgc2Nyb2xsIGJ5IDUwIGV4dHJhIHBpeGVsc1xuXHQgICAgICAgICAgIH1dKVxuXHQgICAgICAgICAgIC5jb250cm9sbGVyKCdoZWFkZXJDdHJsJywgWyckYW5jaG9yU2Nyb2xsJywgJyRsb2NhdGlvbicsICckc2NvcGUnLFxuXHQgICAgICAgICAgICAgZnVuY3Rpb24gKCRhbmNob3JTY3JvbGwsICRsb2NhdGlvbiwgJHNjb3BlKSB7XG5cdCAgICAgICAgICAgICAgICRzY29wZS5nb3RvQW5jaG9yID0gZnVuY3Rpb24oeCkge1xuXHQgICAgICAgICAgICAgICAgIHZhciBuZXdIYXNoID0gJ2FuY2hvcicgKyB4O1xuXHQgICAgICAgICAgICAgICAgIGlmICgkbG9jYXRpb24uaGFzaCgpICE9PSBuZXdIYXNoKSB7XG5cdCAgICAgICAgICAgICAgICAgICAvLyBzZXQgdGhlICRsb2NhdGlvbi5oYXNoIHRvIGBuZXdIYXNoYCBhbmRcblx0ICAgICAgICAgICAgICAgICAgIC8vICRhbmNob3JTY3JvbGwgd2lsbCBhdXRvbWF0aWNhbGx5IHNjcm9sbCB0byBpdFxuXHQgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLmhhc2goJ2FuY2hvcicgKyB4KTtcblx0ICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgLy8gY2FsbCAkYW5jaG9yU2Nyb2xsKCkgZXhwbGljaXRseSxcblx0ICAgICAgICAgICAgICAgICAgIC8vIHNpbmNlICRsb2NhdGlvbi5oYXNoIGhhc24ndCBjaGFuZ2VkXG5cdCAgICAgICAgICAgICAgICAgICAkYW5jaG9yU2Nyb2xsKCk7XG5cdCAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgIF0pO1xuXHQgICAgICAgPC9maWxlPlxuXHQgICAgICAgPGZpbGUgbmFtZT1cInN0eWxlLmNzc1wiPlxuXHQgICAgICAgICBib2R5IHtcblx0ICAgICAgICAgICBwYWRkaW5nLXRvcDogNTBweDtcblx0ICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgLmFuY2hvciB7XG5cdCAgICAgICAgICAgYm9yZGVyOiAycHggZGFzaGVkIERhcmtPcmNoaWQ7XG5cdCAgICAgICAgICAgcGFkZGluZzogMTBweCAxMHB4IDIwMHB4IDEwcHg7XG5cdCAgICAgICAgIH1cblx0XG5cdCAgICAgICAgIC5maXhlZC1oZWFkZXIge1xuXHQgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC4yKTtcblx0ICAgICAgICAgICBoZWlnaHQ6IDUwcHg7XG5cdCAgICAgICAgICAgcG9zaXRpb246IGZpeGVkO1xuXHQgICAgICAgICAgIHRvcDogMDsgbGVmdDogMDsgcmlnaHQ6IDA7XG5cdCAgICAgICAgIH1cblx0XG5cdCAgICAgICAgIC5maXhlZC1oZWFkZXIgPiBhIHtcblx0ICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG5cdCAgICAgICAgICAgbWFyZ2luOiA1cHggMTVweDtcblx0ICAgICAgICAgfVxuXHQgICAgICAgPC9maWxlPlxuXHQgICAgIDwvZXhhbXBsZT5cblx0ICAgKi9cblx0ICB0aGlzLiRnZXQgPSBbJyR3aW5kb3cnLCAnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkd2luZG93LCAkbG9jYXRpb24sICRyb290U2NvcGUpIHtcblx0ICAgIHZhciBkb2N1bWVudCA9ICR3aW5kb3cuZG9jdW1lbnQ7XG5cdFxuXHQgICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGdldCBmaXJzdCBhbmNob3IgZnJvbSBhIE5vZGVMaXN0XG5cdCAgICAvLyAodXNpbmcgYEFycmF5I3NvbWUoKWAgaW5zdGVhZCBvZiBgYW5ndWxhciNmb3JFYWNoKClgIHNpbmNlIGl0J3MgbW9yZSBwZXJmb3JtYW50XG5cdCAgICAvLyAgYW5kIHdvcmtpbmcgaW4gYWxsIHN1cHBvcnRlZCBicm93c2Vycy4pXG5cdCAgICBmdW5jdGlvbiBnZXRGaXJzdEFuY2hvcihsaXN0KSB7XG5cdCAgICAgIHZhciByZXN1bHQgPSBudWxsO1xuXHQgICAgICBBcnJheS5wcm90b3R5cGUuc29tZS5jYWxsKGxpc3QsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0ICAgICAgICBpZiAobm9kZU5hbWVfKGVsZW1lbnQpID09PSAnYScpIHtcblx0ICAgICAgICAgIHJlc3VsdCA9IGVsZW1lbnQ7XG5cdCAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHQgICAgICByZXR1cm4gcmVzdWx0O1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGdldFlPZmZzZXQoKSB7XG5cdFxuXHQgICAgICB2YXIgb2Zmc2V0ID0gc2Nyb2xsLnlPZmZzZXQ7XG5cdFxuXHQgICAgICBpZiAoaXNGdW5jdGlvbihvZmZzZXQpKSB7XG5cdCAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0KCk7XG5cdCAgICAgIH0gZWxzZSBpZiAoaXNFbGVtZW50KG9mZnNldCkpIHtcblx0ICAgICAgICB2YXIgZWxlbSA9IG9mZnNldFswXTtcblx0ICAgICAgICB2YXIgc3R5bGUgPSAkd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbSk7XG5cdCAgICAgICAgaWYgKHN0eWxlLnBvc2l0aW9uICE9PSAnZml4ZWQnKSB7XG5cdCAgICAgICAgICBvZmZzZXQgPSAwO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBvZmZzZXQgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0gZWxzZSBpZiAoIWlzTnVtYmVyKG9mZnNldCkpIHtcblx0ICAgICAgICBvZmZzZXQgPSAwO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gb2Zmc2V0O1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHNjcm9sbFRvKGVsZW0pIHtcblx0ICAgICAgaWYgKGVsZW0pIHtcblx0ICAgICAgICBlbGVtLnNjcm9sbEludG9WaWV3KCk7XG5cdFxuXHQgICAgICAgIHZhciBvZmZzZXQgPSBnZXRZT2Zmc2V0KCk7XG5cdFxuXHQgICAgICAgIGlmIChvZmZzZXQpIHtcblx0ICAgICAgICAgIC8vIGBvZmZzZXRgIGlzIHRoZSBudW1iZXIgb2YgcGl4ZWxzIHdlIHNob3VsZCBzY3JvbGwgVVAgaW4gb3JkZXIgdG8gYWxpZ24gYGVsZW1gIHByb3Blcmx5LlxuXHQgICAgICAgICAgLy8gVGhpcyBpcyB0cnVlIE9OTFkgaWYgdGhlIGNhbGwgdG8gYGVsZW0uc2Nyb2xsSW50b1ZpZXcoKWAgaW5pdGlhbGx5IGFsaWducyBgZWxlbWAgYXQgdGhlXG5cdCAgICAgICAgICAvLyB0b3Agb2YgdGhlIHZpZXdwb3J0LlxuXHQgICAgICAgICAgLy9cblx0ICAgICAgICAgIC8vIElGIHRoZSBudW1iZXIgb2YgcGl4ZWxzIGZyb20gdGhlIHRvcCBvZiBgZWxlbWAgdG8gdGhlIGVuZCBvZiB0aGUgcGFnZSdzIGNvbnRlbnQgaXMgbGVzc1xuXHQgICAgICAgICAgLy8gdGhhbiB0aGUgaGVpZ2h0IG9mIHRoZSB2aWV3cG9ydCwgdGhlbiBgZWxlbS5zY3JvbGxJbnRvVmlldygpYCB3aWxsIGFsaWduIHRoZSBgZWxlbWAgc29tZVxuXHQgICAgICAgICAgLy8gd2F5IGRvd24gdGhlIHBhZ2UuXG5cdCAgICAgICAgICAvL1xuXHQgICAgICAgICAgLy8gVGhpcyBpcyBvZnRlbiB0aGUgY2FzZSBmb3IgZWxlbWVudHMgbmVhciB0aGUgYm90dG9tIG9mIHRoZSBwYWdlLlxuXHQgICAgICAgICAgLy9cblx0ICAgICAgICAgIC8vIEluIHN1Y2ggY2FzZXMgd2UgZG8gbm90IG5lZWQgdG8gc2Nyb2xsIHRoZSB3aG9sZSBgb2Zmc2V0YCB1cCwganVzdCB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuXG5cdCAgICAgICAgICAvLyB0aGUgdG9wIG9mIHRoZSBlbGVtZW50IGFuZCB0aGUgb2Zmc2V0LCB3aGljaCBpcyBlbm91Z2ggdG8gYWxpZ24gdGhlIHRvcCBvZiBgZWxlbWAgYXQgdGhlXG5cdCAgICAgICAgICAvLyBkZXNpcmVkIHBvc2l0aW9uLlxuXHQgICAgICAgICAgdmFyIGVsZW1Ub3AgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcblx0ICAgICAgICAgICR3aW5kb3cuc2Nyb2xsQnkoMCwgZWxlbVRvcCAtIG9mZnNldCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICR3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBzY3JvbGwoaGFzaCkge1xuXHQgICAgICBoYXNoID0gaXNTdHJpbmcoaGFzaCkgPyBoYXNoIDogJGxvY2F0aW9uLmhhc2goKTtcblx0ICAgICAgdmFyIGVsbTtcblx0XG5cdCAgICAgIC8vIGVtcHR5IGhhc2gsIHNjcm9sbCB0byB0aGUgdG9wIG9mIHRoZSBwYWdlXG5cdCAgICAgIGlmICghaGFzaCkgc2Nyb2xsVG8obnVsbCk7XG5cdFxuXHQgICAgICAvLyBlbGVtZW50IHdpdGggZ2l2ZW4gaWRcblx0ICAgICAgZWxzZSBpZiAoKGVsbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhhc2gpKSkgc2Nyb2xsVG8oZWxtKTtcblx0XG5cdCAgICAgIC8vIGZpcnN0IGFuY2hvciB3aXRoIGdpdmVuIG5hbWUgOi1EXG5cdCAgICAgIGVsc2UgaWYgKChlbG0gPSBnZXRGaXJzdEFuY2hvcihkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZShoYXNoKSkpKSBzY3JvbGxUbyhlbG0pO1xuXHRcblx0ICAgICAgLy8gbm8gZWxlbWVudCBhbmQgaGFzaCA9PSAndG9wJywgc2Nyb2xsIHRvIHRoZSB0b3Agb2YgdGhlIHBhZ2Vcblx0ICAgICAgZWxzZSBpZiAoaGFzaCA9PT0gJ3RvcCcpIHNjcm9sbFRvKG51bGwpO1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIGRvZXMgbm90IHNjcm9sbCB3aGVuIHVzZXIgY2xpY2tzIG9uIGFuY2hvciBsaW5rIHRoYXQgaXMgY3VycmVudGx5IG9uXG5cdCAgICAvLyAobm8gdXJsIGNoYW5nZSwgbm8gJGxvY2F0aW9uLmhhc2goKSBjaGFuZ2UpLCBicm93c2VyIG5hdGl2ZSBkb2VzIHNjcm9sbFxuXHQgICAgaWYgKGF1dG9TY3JvbGxpbmdFbmFibGVkKSB7XG5cdCAgICAgICRyb290U2NvcGUuJHdhdGNoKGZ1bmN0aW9uIGF1dG9TY3JvbGxXYXRjaCgpIHtyZXR1cm4gJGxvY2F0aW9uLmhhc2goKTt9LFxuXHQgICAgICAgIGZ1bmN0aW9uIGF1dG9TY3JvbGxXYXRjaEFjdGlvbihuZXdWYWwsIG9sZFZhbCkge1xuXHQgICAgICAgICAgLy8gc2tpcCB0aGUgaW5pdGlhbCBzY3JvbGwgaWYgJGxvY2F0aW9uLmhhc2ggaXMgZW1wdHlcblx0ICAgICAgICAgIGlmIChuZXdWYWwgPT09IG9sZFZhbCAmJiBuZXdWYWwgPT09ICcnKSByZXR1cm47XG5cdFxuXHQgICAgICAgICAganFMaXRlRG9jdW1lbnRMb2FkZWQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgICRyb290U2NvcGUuJGV2YWxBc3luYyhzY3JvbGwpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfSk7XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIHNjcm9sbDtcblx0ICB9XTtcblx0fVxuXHRcblx0dmFyICRhbmltYXRlTWluRXJyID0gbWluRXJyKCckYW5pbWF0ZScpO1xuXHR2YXIgRUxFTUVOVF9OT0RFID0gMTtcblx0dmFyIE5HX0FOSU1BVEVfQ0xBU1NOQU1FID0gJ25nLWFuaW1hdGUnO1xuXHRcblx0ZnVuY3Rpb24gbWVyZ2VDbGFzc2VzKGEsYikge1xuXHQgIGlmICghYSAmJiAhYikgcmV0dXJuICcnO1xuXHQgIGlmICghYSkgcmV0dXJuIGI7XG5cdCAgaWYgKCFiKSByZXR1cm4gYTtcblx0ICBpZiAoaXNBcnJheShhKSkgYSA9IGEuam9pbignICcpO1xuXHQgIGlmIChpc0FycmF5KGIpKSBiID0gYi5qb2luKCcgJyk7XG5cdCAgcmV0dXJuIGEgKyAnICcgKyBiO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCkge1xuXHQgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudC5sZW5ndGg7IGkrKykge1xuXHQgICAgdmFyIGVsbSA9IGVsZW1lbnRbaV07XG5cdCAgICBpZiAoZWxtLm5vZGVUeXBlID09PSBFTEVNRU5UX05PREUpIHtcblx0ICAgICAgcmV0dXJuIGVsbTtcblx0ICAgIH1cblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHNwbGl0Q2xhc3NlcyhjbGFzc2VzKSB7XG5cdCAgaWYgKGlzU3RyaW5nKGNsYXNzZXMpKSB7XG5cdCAgICBjbGFzc2VzID0gY2xhc3Nlcy5zcGxpdCgnICcpO1xuXHQgIH1cblx0XG5cdCAgLy8gVXNlIGNyZWF0ZU1hcCgpIHRvIHByZXZlbnQgY2xhc3MgYXNzdW1wdGlvbnMgaW52b2x2aW5nIHByb3BlcnR5IG5hbWVzIGluXG5cdCAgLy8gT2JqZWN0LnByb3RvdHlwZVxuXHQgIHZhciBvYmogPSBjcmVhdGVNYXAoKTtcblx0ICBmb3JFYWNoKGNsYXNzZXMsIGZ1bmN0aW9uKGtsYXNzKSB7XG5cdCAgICAvLyBzb21ldGltZXMgdGhlIHNwbGl0IGxlYXZlcyBlbXB0eSBzdHJpbmcgdmFsdWVzXG5cdCAgICAvLyBpbmNhc2UgZXh0cmEgc3BhY2VzIHdlcmUgYXBwbGllZCB0byB0aGUgb3B0aW9uc1xuXHQgICAgaWYgKGtsYXNzLmxlbmd0aCkge1xuXHQgICAgICBvYmpba2xhc3NdID0gdHJ1ZTtcblx0ICAgIH1cblx0ICB9KTtcblx0ICByZXR1cm4gb2JqO1xuXHR9XG5cdFxuXHQvLyBpZiBhbnkgb3RoZXIgdHlwZSBvZiBvcHRpb25zIHZhbHVlIGJlc2lkZXMgYW4gT2JqZWN0IHZhbHVlIGlzXG5cdC8vIHBhc3NlZCBpbnRvIHRoZSAkYW5pbWF0ZS5tZXRob2QoKSBhbmltYXRpb24gdGhlbiB0aGlzIGhlbHBlciBjb2RlXG5cdC8vIHdpbGwgYmUgcnVuIHdoaWNoIHdpbGwgaWdub3JlIGl0LiBXaGlsZSB0aGlzIHBhdGNoIGlzIG5vdCB0aGVcblx0Ly8gZ3JlYXRlc3Qgc29sdXRpb24gdG8gdGhpcywgYSBsb3Qgb2YgZXhpc3RpbmcgcGx1Z2lucyBkZXBlbmQgb25cblx0Ly8gJGFuaW1hdGUgdG8gZWl0aGVyIGNhbGwgdGhlIGNhbGxiYWNrICg8IDEuMikgb3IgcmV0dXJuIGEgcHJvbWlzZVxuXHQvLyB0aGF0IGNhbiBiZSBjaGFuZ2VkLiBUaGlzIGhlbHBlciBmdW5jdGlvbiBlbnN1cmVzIHRoYXQgdGhlIG9wdGlvbnNcblx0Ly8gYXJlIHdpcGVkIGNsZWFuIGluY2FzZSBhIGNhbGxiYWNrIGZ1bmN0aW9uIGlzIHByb3ZpZGVkLlxuXHRmdW5jdGlvbiBwcmVwYXJlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucykge1xuXHQgIHJldHVybiBpc09iamVjdChvcHRpb25zKVxuXHQgICAgICA/IG9wdGlvbnNcblx0ICAgICAgOiB7fTtcblx0fVxuXHRcblx0dmFyICQkQ29yZUFuaW1hdGVKc1Byb3ZpZGVyID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24oKSB7fTtcblx0fTtcblx0XG5cdC8vIHRoaXMgaXMgcHJlZml4ZWQgd2l0aCBDb3JlIHNpbmNlIGl0IGNvbmZsaWN0cyB3aXRoXG5cdC8vIHRoZSBhbmltYXRlUXVldWVQcm92aWRlciBkZWZpbmVkIGluIG5nQW5pbWF0ZS9hbmltYXRlUXVldWUuanNcblx0dmFyICQkQ29yZUFuaW1hdGVRdWV1ZVByb3ZpZGVyID0gZnVuY3Rpb24oKSB7XG5cdCAgdmFyIHBvc3REaWdlc3RRdWV1ZSA9IG5ldyBIYXNoTWFwKCk7XG5cdCAgdmFyIHBvc3REaWdlc3RFbGVtZW50cyA9IFtdO1xuXHRcblx0ICB0aGlzLiRnZXQgPSBbJyQkQW5pbWF0ZVJ1bm5lcicsICckcm9vdFNjb3BlJyxcblx0ICAgICAgIGZ1bmN0aW9uKCQkQW5pbWF0ZVJ1bm5lciwgICAkcm9vdFNjb3BlKSB7XG5cdCAgICByZXR1cm4ge1xuXHQgICAgICBlbmFibGVkOiBub29wLFxuXHQgICAgICBvbjogbm9vcCxcblx0ICAgICAgb2ZmOiBub29wLFxuXHQgICAgICBwaW46IG5vb3AsXG5cdFxuXHQgICAgICBwdXNoOiBmdW5jdGlvbihlbGVtZW50LCBldmVudCwgb3B0aW9ucywgZG9tT3BlcmF0aW9uKSB7XG5cdCAgICAgICAgZG9tT3BlcmF0aW9uICAgICAgICAmJiBkb21PcGVyYXRpb24oKTtcblx0XG5cdCAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICAgICAgb3B0aW9ucy5mcm9tICAgICAgICAmJiBlbGVtZW50LmNzcyhvcHRpb25zLmZyb20pO1xuXHQgICAgICAgIG9wdGlvbnMudG8gICAgICAgICAgJiYgZWxlbWVudC5jc3Mob3B0aW9ucy50byk7XG5cdFxuXHQgICAgICAgIGlmIChvcHRpb25zLmFkZENsYXNzIHx8IG9wdGlvbnMucmVtb3ZlQ2xhc3MpIHtcblx0ICAgICAgICAgIGFkZFJlbW92ZUNsYXNzZXNQb3N0RGlnZXN0KGVsZW1lbnQsIG9wdGlvbnMuYWRkQ2xhc3MsIG9wdGlvbnMucmVtb3ZlQ2xhc3MpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdmFyIHJ1bm5lciA9IG5ldyAkJEFuaW1hdGVSdW5uZXIoKTsgLy8ganNoaW50IGlnbm9yZTpsaW5lXG5cdFxuXHQgICAgICAgIC8vIHNpbmNlIHRoZXJlIGFyZSBubyBhbmltYXRpb25zIHRvIHJ1biB0aGUgcnVubmVyIG5lZWRzIHRvIGJlXG5cdCAgICAgICAgLy8gbm90aWZpZWQgdGhhdCB0aGUgYW5pbWF0aW9uIGNhbGwgaXMgY29tcGxldGUuXG5cdCAgICAgICAgcnVubmVyLmNvbXBsZXRlKCk7XG5cdCAgICAgICAgcmV0dXJuIHJ1bm5lcjtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdFxuXHQgICAgZnVuY3Rpb24gdXBkYXRlRGF0YShkYXRhLCBjbGFzc2VzLCB2YWx1ZSkge1xuXHQgICAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xuXHQgICAgICBpZiAoY2xhc3Nlcykge1xuXHQgICAgICAgIGNsYXNzZXMgPSBpc1N0cmluZyhjbGFzc2VzKSA/IGNsYXNzZXMuc3BsaXQoJyAnKSA6XG5cdCAgICAgICAgICAgICAgICAgIGlzQXJyYXkoY2xhc3NlcykgPyBjbGFzc2VzIDogW107XG5cdCAgICAgICAgZm9yRWFjaChjbGFzc2VzLCBmdW5jdGlvbihjbGFzc05hbWUpIHtcblx0ICAgICAgICAgIGlmIChjbGFzc05hbWUpIHtcblx0ICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG5cdCAgICAgICAgICAgIGRhdGFbY2xhc3NOYW1lXSA9IHZhbHVlO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBjaGFuZ2VkO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGhhbmRsZUNTU0NsYXNzQ2hhbmdlcygpIHtcblx0ICAgICAgZm9yRWFjaChwb3N0RGlnZXN0RWxlbWVudHMsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0ICAgICAgICB2YXIgZGF0YSA9IHBvc3REaWdlc3RRdWV1ZS5nZXQoZWxlbWVudCk7XG5cdCAgICAgICAgaWYgKGRhdGEpIHtcblx0ICAgICAgICAgIHZhciBleGlzdGluZyA9IHNwbGl0Q2xhc3NlcyhlbGVtZW50LmF0dHIoJ2NsYXNzJykpO1xuXHQgICAgICAgICAgdmFyIHRvQWRkID0gJyc7XG5cdCAgICAgICAgICB2YXIgdG9SZW1vdmUgPSAnJztcblx0ICAgICAgICAgIGZvckVhY2goZGF0YSwgZnVuY3Rpb24oc3RhdHVzLCBjbGFzc05hbWUpIHtcblx0ICAgICAgICAgICAgdmFyIGhhc0NsYXNzID0gISFleGlzdGluZ1tjbGFzc05hbWVdO1xuXHQgICAgICAgICAgICBpZiAoc3RhdHVzICE9PSBoYXNDbGFzcykge1xuXHQgICAgICAgICAgICAgIGlmIChzdGF0dXMpIHtcblx0ICAgICAgICAgICAgICAgIHRvQWRkICs9ICh0b0FkZC5sZW5ndGggPyAnICcgOiAnJykgKyBjbGFzc05hbWU7XG5cdCAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIHRvUmVtb3ZlICs9ICh0b1JlbW92ZS5sZW5ndGggPyAnICcgOiAnJykgKyBjbGFzc05hbWU7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICBmb3JFYWNoKGVsZW1lbnQsIGZ1bmN0aW9uKGVsbSkge1xuXHQgICAgICAgICAgICB0b0FkZCAgICAmJiBqcUxpdGVBZGRDbGFzcyhlbG0sIHRvQWRkKTtcblx0ICAgICAgICAgICAgdG9SZW1vdmUgJiYganFMaXRlUmVtb3ZlQ2xhc3MoZWxtLCB0b1JlbW92ZSk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICAgIHBvc3REaWdlc3RRdWV1ZS5yZW1vdmUoZWxlbWVudCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0ICAgICAgcG9zdERpZ2VzdEVsZW1lbnRzLmxlbmd0aCA9IDA7XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIGZ1bmN0aW9uIGFkZFJlbW92ZUNsYXNzZXNQb3N0RGlnZXN0KGVsZW1lbnQsIGFkZCwgcmVtb3ZlKSB7XG5cdCAgICAgIHZhciBkYXRhID0gcG9zdERpZ2VzdFF1ZXVlLmdldChlbGVtZW50KSB8fCB7fTtcblx0XG5cdCAgICAgIHZhciBjbGFzc2VzQWRkZWQgPSB1cGRhdGVEYXRhKGRhdGEsIGFkZCwgdHJ1ZSk7XG5cdCAgICAgIHZhciBjbGFzc2VzUmVtb3ZlZCA9IHVwZGF0ZURhdGEoZGF0YSwgcmVtb3ZlLCBmYWxzZSk7XG5cdFxuXHQgICAgICBpZiAoY2xhc3Nlc0FkZGVkIHx8IGNsYXNzZXNSZW1vdmVkKSB7XG5cdFxuXHQgICAgICAgIHBvc3REaWdlc3RRdWV1ZS5wdXQoZWxlbWVudCwgZGF0YSk7XG5cdCAgICAgICAgcG9zdERpZ2VzdEVsZW1lbnRzLnB1c2goZWxlbWVudCk7XG5cdFxuXHQgICAgICAgIGlmIChwb3N0RGlnZXN0RWxlbWVudHMubGVuZ3RoID09PSAxKSB7XG5cdCAgICAgICAgICAkcm9vdFNjb3BlLiQkcG9zdERpZ2VzdChoYW5kbGVDU1NDbGFzc0NoYW5nZXMpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH1dO1xuXHR9O1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBwcm92aWRlclxuXHQgKiBAbmFtZSAkYW5pbWF0ZVByb3ZpZGVyXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBEZWZhdWx0IGltcGxlbWVudGF0aW9uIG9mICRhbmltYXRlIHRoYXQgZG9lc24ndCBwZXJmb3JtIGFueSBhbmltYXRpb25zLCBpbnN0ZWFkIGp1c3Rcblx0ICogc3luY2hyb25vdXNseSBwZXJmb3JtcyBET00gdXBkYXRlcyBhbmQgcmVzb2x2ZXMgdGhlIHJldHVybmVkIHJ1bm5lciBwcm9taXNlLlxuXHQgKlxuXHQgKiBJbiBvcmRlciB0byBlbmFibGUgYW5pbWF0aW9ucyB0aGUgYG5nQW5pbWF0ZWAgbW9kdWxlIGhhcyB0byBiZSBsb2FkZWQuXG5cdCAqXG5cdCAqIFRvIHNlZSB0aGUgZnVuY3Rpb25hbCBpbXBsZW1lbnRhdGlvbiBjaGVjayBvdXQgYHNyYy9uZ0FuaW1hdGUvYW5pbWF0ZS5qc2AuXG5cdCAqL1xuXHR2YXIgJEFuaW1hdGVQcm92aWRlciA9IFsnJHByb3ZpZGUnLCBmdW5jdGlvbigkcHJvdmlkZSkge1xuXHQgIHZhciBwcm92aWRlciA9IHRoaXM7XG5cdFxuXHQgIHRoaXMuJCRyZWdpc3RlcmVkQW5pbWF0aW9ucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cdFxuXHQgICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgJGFuaW1hdGVQcm92aWRlciNyZWdpc3RlclxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogUmVnaXN0ZXJzIGEgbmV3IGluamVjdGFibGUgYW5pbWF0aW9uIGZhY3RvcnkgZnVuY3Rpb24uIFRoZSBmYWN0b3J5IGZ1bmN0aW9uIHByb2R1Y2VzIHRoZVxuXHQgICAqIGFuaW1hdGlvbiBvYmplY3Qgd2hpY2ggY29udGFpbnMgY2FsbGJhY2sgZnVuY3Rpb25zIGZvciBlYWNoIGV2ZW50IHRoYXQgaXMgZXhwZWN0ZWQgdG8gYmVcblx0ICAgKiBhbmltYXRlZC5cblx0ICAgKlxuXHQgICAqICAgKiBgZXZlbnRGbmA6IGBmdW5jdGlvbihlbGVtZW50LCAuLi4gLCBkb25lRnVuY3Rpb24sIG9wdGlvbnMpYFxuXHQgICAqICAgVGhlIGVsZW1lbnQgdG8gYW5pbWF0ZSwgdGhlIGBkb25lRnVuY3Rpb25gIGFuZCB0aGUgb3B0aW9ucyBmZWQgaW50byB0aGUgYW5pbWF0aW9uLiBEZXBlbmRpbmdcblx0ICAgKiAgIG9uIHRoZSB0eXBlIG9mIGFuaW1hdGlvbiBhZGRpdGlvbmFsIGFyZ3VtZW50cyB3aWxsIGJlIGluamVjdGVkIGludG8gdGhlIGFuaW1hdGlvbiBmdW5jdGlvbi4gVGhlXG5cdCAgICogICBsaXN0IGJlbG93IGV4cGxhaW5zIHRoZSBmdW5jdGlvbiBzaWduYXR1cmVzIGZvciB0aGUgZGlmZmVyZW50IGFuaW1hdGlvbiBtZXRob2RzOlxuXHQgICAqXG5cdCAgICogICAtIHNldENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBhZGRlZENsYXNzZXMsIHJlbW92ZWRDbGFzc2VzLCBkb25lRnVuY3Rpb24sIG9wdGlvbnMpXG5cdCAgICogICAtIGFkZENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBhZGRlZENsYXNzZXMsIGRvbmVGdW5jdGlvbiwgb3B0aW9ucylcblx0ICAgKiAgIC0gcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIHJlbW92ZWRDbGFzc2VzLCBkb25lRnVuY3Rpb24sIG9wdGlvbnMpXG5cdCAgICogICAtIGVudGVyLCBsZWF2ZSwgbW92ZTogZnVuY3Rpb24oZWxlbWVudCwgZG9uZUZ1bmN0aW9uLCBvcHRpb25zKVxuXHQgICAqICAgLSBhbmltYXRlOiBmdW5jdGlvbihlbGVtZW50LCBmcm9tU3R5bGVzLCB0b1N0eWxlcywgZG9uZUZ1bmN0aW9uLCBvcHRpb25zKVxuXHQgICAqXG5cdCAgICogICBNYWtlIHN1cmUgdG8gdHJpZ2dlciB0aGUgYGRvbmVGdW5jdGlvbmAgb25jZSB0aGUgYW5pbWF0aW9uIGlzIGZ1bGx5IGNvbXBsZXRlLlxuXHQgICAqXG5cdCAgICogYGBganNcblx0ICAgKiAgIHJldHVybiB7XG5cdCAgICogICAgIC8vZW50ZXIsIGxlYXZlLCBtb3ZlIHNpZ25hdHVyZVxuXHQgICAqICAgICBldmVudEZuIDogZnVuY3Rpb24oZWxlbWVudCwgZG9uZSwgb3B0aW9ucykge1xuXHQgICAqICAgICAgIC8vY29kZSB0byBydW4gdGhlIGFuaW1hdGlvblxuXHQgICAqICAgICAgIC8vb25jZSBjb21wbGV0ZSwgdGhlbiBydW4gZG9uZSgpXG5cdCAgICogICAgICAgcmV0dXJuIGZ1bmN0aW9uIGVuZEZ1bmN0aW9uKHdhc0NhbmNlbGxlZCkge1xuXHQgICAqICAgICAgICAgLy9jb2RlIHRvIGNhbmNlbCB0aGUgYW5pbWF0aW9uXG5cdCAgICogICAgICAgfVxuXHQgICAqICAgICB9XG5cdCAgICogICB9XG5cdCAgICogYGBgXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgYW5pbWF0aW9uICh0aGlzIGlzIHdoYXQgdGhlIGNsYXNzLWJhc2VkIENTUyB2YWx1ZSB3aWxsIGJlIGNvbXBhcmVkIHRvKS5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmYWN0b3J5IFRoZSBmYWN0b3J5IGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBleGVjdXRlZCB0byByZXR1cm4gdGhlIGFuaW1hdGlvblxuXHQgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0LlxuXHQgICAqL1xuXHQgIHRoaXMucmVnaXN0ZXIgPSBmdW5jdGlvbihuYW1lLCBmYWN0b3J5KSB7XG5cdCAgICBpZiAobmFtZSAmJiBuYW1lLmNoYXJBdCgwKSAhPT0gJy4nKSB7XG5cdCAgICAgIHRocm93ICRhbmltYXRlTWluRXJyKCdub3Rjc2VsJywgXCJFeHBlY3RpbmcgY2xhc3Mgc2VsZWN0b3Igc3RhcnRpbmcgd2l0aCAnLicgZ290ICd7MH0nLlwiLCBuYW1lKTtcblx0ICAgIH1cblx0XG5cdCAgICB2YXIga2V5ID0gbmFtZSArICctYW5pbWF0aW9uJztcblx0ICAgIHByb3ZpZGVyLiQkcmVnaXN0ZXJlZEFuaW1hdGlvbnNbbmFtZS5zdWJzdHIoMSldID0ga2V5O1xuXHQgICAgJHByb3ZpZGUuZmFjdG9yeShrZXksIGZhY3RvcnkpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkYW5pbWF0ZVByb3ZpZGVyI2NsYXNzTmFtZUZpbHRlclxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogU2V0cyBhbmQvb3IgcmV0dXJucyB0aGUgQ1NTIGNsYXNzIHJlZ3VsYXIgZXhwcmVzc2lvbiB0aGF0IGlzIGNoZWNrZWQgd2hlbiBwZXJmb3JtaW5nXG5cdCAgICogYW4gYW5pbWF0aW9uLiBVcG9uIGJvb3RzdHJhcCB0aGUgY2xhc3NOYW1lRmlsdGVyIHZhbHVlIGlzIG5vdCBzZXQgYXQgYWxsIGFuZCB3aWxsXG5cdCAgICogdGhlcmVmb3JlIGVuYWJsZSAkYW5pbWF0ZSB0byBhdHRlbXB0IHRvIHBlcmZvcm0gYW4gYW5pbWF0aW9uIG9uIGFueSBlbGVtZW50IHRoYXQgaXMgdHJpZ2dlcmVkLlxuXHQgICAqIFdoZW4gc2V0dGluZyB0aGUgYGNsYXNzTmFtZUZpbHRlcmAgdmFsdWUsIGFuaW1hdGlvbnMgd2lsbCBvbmx5IGJlIHBlcmZvcm1lZCBvbiBlbGVtZW50c1xuXHQgICAqIHRoYXQgc3VjY2Vzc2Z1bGx5IG1hdGNoIHRoZSBmaWx0ZXIgZXhwcmVzc2lvbi4gVGhpcyBpbiB0dXJuIGNhbiBib29zdCBwZXJmb3JtYW5jZVxuXHQgICAqIGZvciBsb3ctcG93ZXJlZCBkZXZpY2VzIGFzIHdlbGwgYXMgYXBwbGljYXRpb25zIGNvbnRhaW5pbmcgYSBsb3Qgb2Ygc3RydWN0dXJhbCBvcGVyYXRpb25zLlxuXHQgICAqIEBwYXJhbSB7UmVnRXhwPX0gZXhwcmVzc2lvbiBUaGUgY2xhc3NOYW1lIGV4cHJlc3Npb24gd2hpY2ggd2lsbCBiZSBjaGVja2VkIGFnYWluc3QgYWxsIGFuaW1hdGlvbnNcblx0ICAgKiBAcmV0dXJuIHtSZWdFeHB9IFRoZSBjdXJyZW50IENTUyBjbGFzc05hbWUgZXhwcmVzc2lvbiB2YWx1ZS4gSWYgbnVsbCB0aGVuIHRoZXJlIGlzIG5vIGV4cHJlc3Npb24gdmFsdWVcblx0ICAgKi9cblx0ICB0aGlzLmNsYXNzTmFtZUZpbHRlciA9IGZ1bmN0aW9uKGV4cHJlc3Npb24pIHtcblx0ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG5cdCAgICAgIHRoaXMuJCRjbGFzc05hbWVGaWx0ZXIgPSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIFJlZ0V4cCkgPyBleHByZXNzaW9uIDogbnVsbDtcblx0ICAgICAgaWYgKHRoaXMuJCRjbGFzc05hbWVGaWx0ZXIpIHtcblx0ICAgICAgICB2YXIgcmVzZXJ2ZWRSZWdleCA9IG5ldyBSZWdFeHAoXCIoXFxcXHMrfFxcXFwvKVwiICsgTkdfQU5JTUFURV9DTEFTU05BTUUgKyBcIihcXFxccyt8XFxcXC8pXCIpO1xuXHQgICAgICAgIGlmIChyZXNlcnZlZFJlZ2V4LnRlc3QodGhpcy4kJGNsYXNzTmFtZUZpbHRlci50b1N0cmluZygpKSkge1xuXHQgICAgICAgICAgdGhyb3cgJGFuaW1hdGVNaW5FcnIoJ25vbmdjbHMnLCckYW5pbWF0ZVByb3ZpZGVyLmNsYXNzTmFtZUZpbHRlcihyZWdleCkgcHJvaGliaXRzIGFjY2VwdGluZyBhIHJlZ2V4IHZhbHVlIHdoaWNoIG1hdGNoZXMvY29udGFpbnMgdGhlIFwiezB9XCIgQ1NTIGNsYXNzLicsIE5HX0FOSU1BVEVfQ0xBU1NOQU1FKTtcblx0XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gdGhpcy4kJGNsYXNzTmFtZUZpbHRlcjtcblx0ICB9O1xuXHRcblx0ICB0aGlzLiRnZXQgPSBbJyQkYW5pbWF0ZVF1ZXVlJywgZnVuY3Rpb24oJCRhbmltYXRlUXVldWUpIHtcblx0ICAgIGZ1bmN0aW9uIGRvbUluc2VydChlbGVtZW50LCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQpIHtcblx0ICAgICAgLy8gaWYgZm9yIHNvbWUgcmVhc29uIHRoZSBwcmV2aW91cyBlbGVtZW50IHdhcyByZW1vdmVkXG5cdCAgICAgIC8vIGZyb20gdGhlIGRvbSBzb21ldGltZSBiZWZvcmUgdGhpcyBjb2RlIHJ1bnMgdGhlbiBsZXQnc1xuXHQgICAgICAvLyBqdXN0IHN0aWNrIHRvIHVzaW5nIHRoZSBwYXJlbnQgZWxlbWVudCBhcyB0aGUgYW5jaG9yXG5cdCAgICAgIGlmIChhZnRlckVsZW1lbnQpIHtcblx0ICAgICAgICB2YXIgYWZ0ZXJOb2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGFmdGVyRWxlbWVudCk7XG5cdCAgICAgICAgaWYgKGFmdGVyTm9kZSAmJiAhYWZ0ZXJOb2RlLnBhcmVudE5vZGUgJiYgIWFmdGVyTm9kZS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKSB7XG5cdCAgICAgICAgICBhZnRlckVsZW1lbnQgPSBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICBhZnRlckVsZW1lbnQgPyBhZnRlckVsZW1lbnQuYWZ0ZXIoZWxlbWVudCkgOiBwYXJlbnRFbGVtZW50LnByZXBlbmQoZWxlbWVudCk7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAbmdkb2Mgc2VydmljZVxuXHQgICAgICogQG5hbWUgJGFuaW1hdGVcblx0ICAgICAqIEBkZXNjcmlwdGlvbiBUaGUgJGFuaW1hdGUgc2VydmljZSBleHBvc2VzIGEgc2VyaWVzIG9mIERPTSB1dGlsaXR5IG1ldGhvZHMgdGhhdCBwcm92aWRlIHN1cHBvcnRcblx0ICAgICAqIGZvciBhbmltYXRpb24gaG9va3MuIFRoZSBkZWZhdWx0IGJlaGF2aW9yIGlzIHRoZSBhcHBsaWNhdGlvbiBvZiBET00gb3BlcmF0aW9ucywgaG93ZXZlcixcblx0ICAgICAqIHdoZW4gYW4gYW5pbWF0aW9uIGlzIGRldGVjdGVkIChhbmQgYW5pbWF0aW9ucyBhcmUgZW5hYmxlZCksICRhbmltYXRlIHdpbGwgZG8gdGhlIGhlYXZ5IGxpZnRpbmdcblx0ICAgICAqIHRvIGVuc3VyZSB0aGF0IGFuaW1hdGlvbiBydW5zIHdpdGggdGhlIHRyaWdnZXJlZCBET00gb3BlcmF0aW9uLlxuXHQgICAgICpcblx0ICAgICAqIEJ5IGRlZmF1bHQgJGFuaW1hdGUgZG9lc24ndCB0cmlnZ2VyIGFueSBhbmltYXRpb25zLiBUaGlzIGlzIGJlY2F1c2UgdGhlIGBuZ0FuaW1hdGVgIG1vZHVsZSBpc24ndFxuXHQgICAgICogaW5jbHVkZWQgYW5kIG9ubHkgd2hlbiBpdCBpcyBhY3RpdmUgdGhlbiB0aGUgYW5pbWF0aW9uIGhvb2tzIHRoYXQgYCRhbmltYXRlYCB0cmlnZ2VycyB3aWxsIGJlXG5cdCAgICAgKiBmdW5jdGlvbmFsLiBPbmNlIGFjdGl2ZSB0aGVuIGFsbCBzdHJ1Y3R1cmFsIGBuZy1gIGRpcmVjdGl2ZXMgd2lsbCB0cmlnZ2VyIGFuaW1hdGlvbnMgYXMgdGhleSBwZXJmb3JtXG5cdCAgICAgKiB0aGVpciBET00tcmVsYXRlZCBvcGVyYXRpb25zIChlbnRlciwgbGVhdmUgYW5kIG1vdmUpLiBPdGhlciBkaXJlY3RpdmVzIHN1Y2ggYXMgYG5nQ2xhc3NgLFxuXHQgICAgICogYG5nU2hvd2AsIGBuZ0hpZGVgIGFuZCBgbmdNZXNzYWdlc2AgYWxzbyBwcm92aWRlIHN1cHBvcnQgZm9yIGFuaW1hdGlvbnMuXG5cdCAgICAgKlxuXHQgICAgICogSXQgaXMgcmVjb21tZW5kZWQgdGhhdCB0aGVgJGFuaW1hdGVgIHNlcnZpY2UgaXMgYWx3YXlzIHVzZWQgd2hlbiBleGVjdXRpbmcgRE9NLXJlbGF0ZWQgcHJvY2VkdXJlcyB3aXRoaW4gZGlyZWN0aXZlcy5cblx0ICAgICAqXG5cdCAgICAgKiBUbyBsZWFybiBtb3JlIGFib3V0IGVuYWJsaW5nIGFuaW1hdGlvbiBzdXBwb3J0LCBjbGljayBoZXJlIHRvIHZpc2l0IHRoZVxuXHQgICAgICoge0BsaW5rIG5nQW5pbWF0ZSBuZ0FuaW1hdGUgbW9kdWxlIHBhZ2V9LlxuXHQgICAgICovXG5cdCAgICByZXR1cm4ge1xuXHQgICAgICAvLyB3ZSBkb24ndCBjYWxsIGl0IGRpcmVjdGx5IHNpbmNlIG5vbi1leGlzdGFudCBhcmd1bWVudHMgbWF5XG5cdCAgICAgIC8vIGJlIGludGVycHJldGVkIGFzIG51bGwgd2l0aGluIHRoZSBzdWIgZW5hYmxlZCBmdW5jdGlvblxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJGFuaW1hdGUjb25cblx0ICAgICAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgICAgICogQGRlc2NyaXB0aW9uIFNldHMgdXAgYW4gZXZlbnQgbGlzdGVuZXIgdG8gZmlyZSB3aGVuZXZlciB0aGUgYW5pbWF0aW9uIGV2ZW50IChlbnRlciwgbGVhdmUsIG1vdmUsIGV0Yy4uLilcblx0ICAgICAgICogICAgaGFzIGZpcmVkIG9uIHRoZSBnaXZlbiBlbGVtZW50IG9yIGFtb25nIGFueSBvZiBpdHMgY2hpbGRyZW4uIE9uY2UgdGhlIGxpc3RlbmVyIGlzIGZpcmVkLCB0aGUgcHJvdmlkZWQgY2FsbGJhY2tcblx0ICAgICAgICogICAgaXMgZmlyZWQgd2l0aCB0aGUgZm9sbG93aW5nIHBhcmFtczpcblx0ICAgICAgICpcblx0ICAgICAgICogYGBganNcblx0ICAgICAgICogJGFuaW1hdGUub24oJ2VudGVyJywgY29udGFpbmVyLFxuXHQgICAgICAgKiAgICBmdW5jdGlvbiBjYWxsYmFjayhlbGVtZW50LCBwaGFzZSkge1xuXHQgICAgICAgKiAgICAgIC8vIGNvb2wgd2UgZGV0ZWN0ZWQgYW4gZW50ZXIgYW5pbWF0aW9uIHdpdGhpbiB0aGUgY29udGFpbmVyXG5cdCAgICAgICAqICAgIH1cblx0ICAgICAgICogKTtcblx0ICAgICAgICogYGBgXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudCB0aGUgYW5pbWF0aW9uIGV2ZW50IHRoYXQgd2lsbCBiZSBjYXB0dXJlZCAoZS5nLiBlbnRlciwgbGVhdmUsIG1vdmUsIGFkZENsYXNzLCByZW1vdmVDbGFzcywgZXRjLi4uKVxuXHQgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGNvbnRhaW5lciB0aGUgY29udGFpbmVyIGVsZW1lbnQgdGhhdCB3aWxsIGNhcHR1cmUgZWFjaCBvZiB0aGUgYW5pbWF0aW9uIGV2ZW50cyB0aGF0IGFyZSBmaXJlZCBvbiBpdHNlbGZcblx0ICAgICAgICogICAgIGFzIHdlbGwgYXMgYW1vbmcgaXRzIGNoaWxkcmVuXG5cdCAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIHRoZSBjYWxsYmFjayBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgZmlyZWQgd2hlbiB0aGUgbGlzdGVuZXIgaXMgdHJpZ2dlcmVkXG5cdCAgICAgICAqXG5cdCAgICAgICAqIFRoZSBhcmd1bWVudHMgcHJlc2VudCBpbiB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gYXJlOlxuXHQgICAgICAgKiAqIGBlbGVtZW50YCAtIFRoZSBjYXB0dXJlZCBET00gZWxlbWVudCB0aGF0IHRoZSBhbmltYXRpb24gd2FzIGZpcmVkIG9uLlxuXHQgICAgICAgKiAqIGBwaGFzZWAgLSBUaGUgcGhhc2Ugb2YgdGhlIGFuaW1hdGlvbi4gVGhlIHR3byBwb3NzaWJsZSBwaGFzZXMgYXJlICoqc3RhcnQqKiAod2hlbiB0aGUgYW5pbWF0aW9uIHN0YXJ0cykgYW5kICoqY2xvc2UqKiAod2hlbiBpdCBlbmRzKS5cblx0ICAgICAgICovXG5cdCAgICAgIG9uOiAkJGFuaW1hdGVRdWV1ZS5vbixcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAqIEBuYW1lICRhbmltYXRlI29mZlxuXHQgICAgICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAgICAgKiBAZGVzY3JpcHRpb24gRGVyZWdpc3RlcnMgYW4gZXZlbnQgbGlzdGVuZXIgYmFzZWQgb24gdGhlIGV2ZW50IHdoaWNoIGhhcyBiZWVuIGFzc29jaWF0ZWQgd2l0aCB0aGUgcHJvdmlkZWQgZWxlbWVudC4gVGhpcyBtZXRob2Rcblx0ICAgICAgICogY2FuIGJlIHVzZWQgaW4gdGhyZWUgZGlmZmVyZW50IHdheXMgZGVwZW5kaW5nIG9uIHRoZSBhcmd1bWVudHM6XG5cdCAgICAgICAqXG5cdCAgICAgICAqIGBgYGpzXG5cdCAgICAgICAqIC8vIHJlbW92ZSBhbGwgdGhlIGFuaW1hdGlvbiBldmVudCBsaXN0ZW5lcnMgbGlzdGVuaW5nIGZvciBgZW50ZXJgXG5cdCAgICAgICAqICRhbmltYXRlLm9mZignZW50ZXInKTtcblx0ICAgICAgICpcblx0ICAgICAgICogLy8gcmVtb3ZlIGFsbCB0aGUgYW5pbWF0aW9uIGV2ZW50IGxpc3RlbmVycyBsaXN0ZW5pbmcgZm9yIGBlbnRlcmAgb24gdGhlIGdpdmVuIGVsZW1lbnQgYW5kIGl0cyBjaGlsZHJlblxuXHQgICAgICAgKiAkYW5pbWF0ZS5vZmYoJ2VudGVyJywgY29udGFpbmVyKTtcblx0ICAgICAgICpcblx0ICAgICAgICogLy8gcmVtb3ZlIHRoZSBldmVudCBsaXN0ZW5lciBmdW5jdGlvbiBwcm92aWRlZCBieSBgY2FsbGJhY2tgIHRoYXQgaXMgc2V0XG5cdCAgICAgICAqIC8vIHRvIGxpc3RlbiBmb3IgYGVudGVyYCBvbiB0aGUgZ2l2ZW4gYGNvbnRhaW5lcmAgYXMgd2VsbCBhcyBpdHMgY2hpbGRyZW5cblx0ICAgICAgICogJGFuaW1hdGUub2ZmKCdlbnRlcicsIGNvbnRhaW5lciwgY2FsbGJhY2spO1xuXHQgICAgICAgKiBgYGBcblx0ICAgICAgICpcblx0ICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50IHRoZSBhbmltYXRpb24gZXZlbnQgKGUuZy4gZW50ZXIsIGxlYXZlLCBtb3ZlLCBhZGRDbGFzcywgcmVtb3ZlQ2xhc3MsIGV0Yy4uLilcblx0ICAgICAgICogQHBhcmFtIHtET01FbGVtZW50PX0gY29udGFpbmVyIHRoZSBjb250YWluZXIgZWxlbWVudCB0aGUgZXZlbnQgbGlzdGVuZXIgd2FzIHBsYWNlZCBvblxuXHQgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY2FsbGJhY2sgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgd2FzIHJlZ2lzdGVyZWQgYXMgdGhlIGxpc3RlbmVyXG5cdCAgICAgICAqL1xuXHQgICAgICBvZmY6ICQkYW5pbWF0ZVF1ZXVlLm9mZixcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAqIEBuYW1lICRhbmltYXRlI3BpblxuXHQgICAgICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAgICAgKiBAZGVzY3JpcHRpb24gQXNzb2NpYXRlcyB0aGUgcHJvdmlkZWQgZWxlbWVudCB3aXRoIGEgaG9zdCBwYXJlbnQgZWxlbWVudCB0byBhbGxvdyB0aGUgZWxlbWVudCB0byBiZSBhbmltYXRlZCBldmVuIGlmIGl0IGV4aXN0c1xuXHQgICAgICAgKiAgICBvdXRzaWRlIG9mIHRoZSBET00gc3RydWN0dXJlIG9mIHRoZSBBbmd1bGFyIGFwcGxpY2F0aW9uLiBCeSBkb2luZyBzbywgYW55IGFuaW1hdGlvbiB0cmlnZ2VyZWQgdmlhIGAkYW5pbWF0ZWAgY2FuIGJlIGlzc3VlZCBvbiB0aGVcblx0ICAgICAgICogICAgZWxlbWVudCBkZXNwaXRlIGJlaW5nIG91dHNpZGUgdGhlIHJlYWxtIG9mIHRoZSBhcHBsaWNhdGlvbiBvciB3aXRoaW4gYW5vdGhlciBhcHBsaWNhdGlvbi4gU2F5IGZvciBleGFtcGxlIGlmIHRoZSBhcHBsaWNhdGlvblxuXHQgICAgICAgKiAgICB3YXMgYm9vdHN0cmFwcGVkIG9uIGFuIGVsZW1lbnQgdGhhdCBpcyBzb21ld2hlcmUgaW5zaWRlIG9mIHRoZSBgPGJvZHk+YCB0YWcsIGJ1dCB3ZSB3YW50ZWQgdG8gYWxsb3cgZm9yIGFuIGVsZW1lbnQgdG8gYmUgc2l0dWF0ZWRcblx0ICAgICAgICogICAgYXMgYSBkaXJlY3QgY2hpbGQgb2YgYGRvY3VtZW50LmJvZHlgLCB0aGVuIHRoaXMgY2FuIGJlIGFjaGlldmVkIGJ5IHBpbm5pbmcgdGhlIGVsZW1lbnQgdmlhIGAkYW5pbWF0ZS5waW4oZWxlbWVudClgLiBLZWVwIGluIG1pbmRcblx0ICAgICAgICogICAgdGhhdCBjYWxsaW5nIGAkYW5pbWF0ZS5waW4oZWxlbWVudCwgcGFyZW50RWxlbWVudClgIHdpbGwgbm90IGFjdHVhbGx5IGluc2VydCBpbnRvIHRoZSBET00gYW55d2hlcmU7IGl0IHdpbGwganVzdCBjcmVhdGUgdGhlIGFzc29jaWF0aW9uLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiAgICBOb3RlIHRoYXQgdGhpcyBmZWF0dXJlIGlzIG9ubHkgYWN0aXZlIHdoZW4gdGhlIGBuZ0FuaW1hdGVgIG1vZHVsZSBpcyB1c2VkLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGV4dGVybmFsIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHBpbm5lZFxuXHQgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IHBhcmVudEVsZW1lbnQgdGhlIGhvc3QgcGFyZW50IGVsZW1lbnQgdGhhdCB3aWxsIGJlIGFzc29jaWF0ZWQgd2l0aCB0aGUgZXh0ZXJuYWwgZWxlbWVudFxuXHQgICAgICAgKi9cblx0ICAgICAgcGluOiAkJGFuaW1hdGVRdWV1ZS5waW4sXG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICpcblx0ICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNlbmFibGVkXG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvbiBVc2VkIHRvIGdldCBhbmQgc2V0IHdoZXRoZXIgYW5pbWF0aW9ucyBhcmUgZW5hYmxlZCBvciBub3Qgb24gdGhlIGVudGlyZSBhcHBsaWNhdGlvbiBvciBvbiBhbiBlbGVtZW50IGFuZCBpdHMgY2hpbGRyZW4uIFRoaXNcblx0ICAgICAgICogZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCBpbiBmb3VyIHdheXM6XG5cdCAgICAgICAqXG5cdCAgICAgICAqIGBgYGpzXG5cdCAgICAgICAqIC8vIHJldHVybnMgdHJ1ZSBvciBmYWxzZVxuXHQgICAgICAgKiAkYW5pbWF0ZS5lbmFibGVkKCk7XG5cdCAgICAgICAqXG5cdCAgICAgICAqIC8vIGNoYW5nZXMgdGhlIGVuYWJsZWQgc3RhdGUgZm9yIGFsbCBhbmltYXRpb25zXG5cdCAgICAgICAqICRhbmltYXRlLmVuYWJsZWQoZmFsc2UpO1xuXHQgICAgICAgKiAkYW5pbWF0ZS5lbmFibGVkKHRydWUpO1xuXHQgICAgICAgKlxuXHQgICAgICAgKiAvLyByZXR1cm5zIHRydWUgb3IgZmFsc2UgaWYgYW5pbWF0aW9ucyBhcmUgZW5hYmxlZCBmb3IgYW4gZWxlbWVudFxuXHQgICAgICAgKiAkYW5pbWF0ZS5lbmFibGVkKGVsZW1lbnQpO1xuXHQgICAgICAgKlxuXHQgICAgICAgKiAvLyBjaGFuZ2VzIHRoZSBlbmFibGVkIHN0YXRlIGZvciBhbiBlbGVtZW50IGFuZCBpdHMgY2hpbGRyZW5cblx0ICAgICAgICogJGFuaW1hdGUuZW5hYmxlZChlbGVtZW50LCB0cnVlKTtcblx0ICAgICAgICogJGFuaW1hdGUuZW5hYmxlZChlbGVtZW50LCBmYWxzZSk7XG5cdCAgICAgICAqIGBgYFxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnQ9fSBlbGVtZW50IHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSBjb25zaWRlcmVkIGZvciBjaGVja2luZy9zZXR0aW5nIHRoZSBlbmFibGVkIHN0YXRlXG5cdCAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IGVuYWJsZWQgd2hldGhlciBvciBub3QgdGhlIGFuaW1hdGlvbnMgd2lsbCBiZSBlbmFibGVkIGZvciB0aGUgZWxlbWVudFxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSB3aGV0aGVyIG9yIG5vdCBhbmltYXRpb25zIGFyZSBlbmFibGVkXG5cdCAgICAgICAqL1xuXHQgICAgICBlbmFibGVkOiAkJGFuaW1hdGVRdWV1ZS5lbmFibGVkLFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJGFuaW1hdGUjY2FuY2VsXG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvbiBDYW5jZWxzIHRoZSBwcm92aWRlZCBhbmltYXRpb24uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7UHJvbWlzZX0gYW5pbWF0aW9uUHJvbWlzZSBUaGUgYW5pbWF0aW9uIHByb21pc2UgdGhhdCBpcyByZXR1cm5lZCB3aGVuIGFuIGFuaW1hdGlvbiBpcyBzdGFydGVkLlxuXHQgICAgICAgKi9cblx0ICAgICAgY2FuY2VsOiBmdW5jdGlvbihydW5uZXIpIHtcblx0ICAgICAgICBydW5uZXIuZW5kICYmIHJ1bm5lci5lbmQoKTtcblx0ICAgICAgfSxcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAqIEBuYW1lICRhbmltYXRlI2VudGVyXG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvbiBJbnNlcnRzIHRoZSBlbGVtZW50IGludG8gdGhlIERPTSBlaXRoZXIgYWZ0ZXIgdGhlIGBhZnRlcmAgZWxlbWVudCAoaWYgcHJvdmlkZWQpIG9yXG5cdCAgICAgICAqICAgYXMgdGhlIGZpcnN0IGNoaWxkIHdpdGhpbiB0aGUgYHBhcmVudGAgZWxlbWVudCBhbmQgdGhlbiB0cmlnZ2VycyBhbiBhbmltYXRpb24uXG5cdCAgICAgICAqICAgQSBwcm9taXNlIGlzIHJldHVybmVkIHRoYXQgd2lsbCBiZSByZXNvbHZlZCBkdXJpbmcgdGhlIG5leHQgZGlnZXN0IG9uY2UgdGhlIGFuaW1hdGlvblxuXHQgICAgICAgKiAgIGhhcyBjb21wbGV0ZWQuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB3aGljaCB3aWxsIGJlIGluc2VydGVkIGludG8gdGhlIERPTVxuXHQgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IHBhcmVudCB0aGUgcGFyZW50IGVsZW1lbnQgd2hpY2ggd2lsbCBhcHBlbmQgdGhlIGVsZW1lbnQgYXNcblx0ICAgICAgICogICBhIGNoaWxkIChzbyBsb25nIGFzIHRoZSBhZnRlciBlbGVtZW50IGlzIG5vdCBwcmVzZW50KVxuXHQgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnQ9fSBhZnRlciB0aGUgc2libGluZyBlbGVtZW50IGFmdGVyIHdoaWNoIHRoZSBlbGVtZW50IHdpbGwgYmUgYXBwZW5kZWRcblx0ICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygb3B0aW9ucy9zdHlsZXMgdGhhdCB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnRcblx0ICAgICAgICpcblx0ICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXG5cdCAgICAgICAqL1xuXHQgICAgICBlbnRlcjogZnVuY3Rpb24oZWxlbWVudCwgcGFyZW50LCBhZnRlciwgb3B0aW9ucykge1xuXHQgICAgICAgIHBhcmVudCA9IHBhcmVudCAmJiBqcUxpdGUocGFyZW50KTtcblx0ICAgICAgICBhZnRlciA9IGFmdGVyICYmIGpxTGl0ZShhZnRlcik7XG5cdCAgICAgICAgcGFyZW50ID0gcGFyZW50IHx8IGFmdGVyLnBhcmVudCgpO1xuXHQgICAgICAgIGRvbUluc2VydChlbGVtZW50LCBwYXJlbnQsIGFmdGVyKTtcblx0ICAgICAgICByZXR1cm4gJCRhbmltYXRlUXVldWUucHVzaChlbGVtZW50LCAnZW50ZXInLCBwcmVwYXJlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucykpO1xuXHQgICAgICB9LFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJGFuaW1hdGUjbW92ZVxuXHQgICAgICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAgICAgKiBAZGVzY3JpcHRpb24gSW5zZXJ0cyAobW92ZXMpIHRoZSBlbGVtZW50IGludG8gaXRzIG5ldyBwb3NpdGlvbiBpbiB0aGUgRE9NIGVpdGhlciBhZnRlclxuXHQgICAgICAgKiAgIHRoZSBgYWZ0ZXJgIGVsZW1lbnQgKGlmIHByb3ZpZGVkKSBvciBhcyB0aGUgZmlyc3QgY2hpbGQgd2l0aGluIHRoZSBgcGFyZW50YCBlbGVtZW50XG5cdCAgICAgICAqICAgYW5kIHRoZW4gdHJpZ2dlcnMgYW4gYW5pbWF0aW9uLiBBIHByb21pc2UgaXMgcmV0dXJuZWQgdGhhdCB3aWxsIGJlIHJlc29sdmVkXG5cdCAgICAgICAqICAgZHVyaW5nIHRoZSBuZXh0IGRpZ2VzdCBvbmNlIHRoZSBhbmltYXRpb24gaGFzIGNvbXBsZXRlZC5cblx0ICAgICAgICpcblx0ICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHdoaWNoIHdpbGwgYmUgbW92ZWQgaW50byB0aGUgbmV3IERPTSBwb3NpdGlvblxuXHQgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IHBhcmVudCB0aGUgcGFyZW50IGVsZW1lbnQgd2hpY2ggd2lsbCBhcHBlbmQgdGhlIGVsZW1lbnQgYXNcblx0ICAgICAgICogICBhIGNoaWxkIChzbyBsb25nIGFzIHRoZSBhZnRlciBlbGVtZW50IGlzIG5vdCBwcmVzZW50KVxuXHQgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnQ9fSBhZnRlciB0aGUgc2libGluZyBlbGVtZW50IGFmdGVyIHdoaWNoIHRoZSBlbGVtZW50IHdpbGwgYmUgYXBwZW5kZWRcblx0ICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygb3B0aW9ucy9zdHlsZXMgdGhhdCB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnRcblx0ICAgICAgICpcblx0ICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXG5cdCAgICAgICAqL1xuXHQgICAgICBtb3ZlOiBmdW5jdGlvbihlbGVtZW50LCBwYXJlbnQsIGFmdGVyLCBvcHRpb25zKSB7XG5cdCAgICAgICAgcGFyZW50ID0gcGFyZW50ICYmIGpxTGl0ZShwYXJlbnQpO1xuXHQgICAgICAgIGFmdGVyID0gYWZ0ZXIgJiYganFMaXRlKGFmdGVyKTtcblx0ICAgICAgICBwYXJlbnQgPSBwYXJlbnQgfHwgYWZ0ZXIucGFyZW50KCk7XG5cdCAgICAgICAgZG9tSW5zZXJ0KGVsZW1lbnQsIHBhcmVudCwgYWZ0ZXIpO1xuXHQgICAgICAgIHJldHVybiAkJGFuaW1hdGVRdWV1ZS5wdXNoKGVsZW1lbnQsICdtb3ZlJywgcHJlcGFyZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpKTtcblx0ICAgICAgfSxcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAqIEBuYW1lICRhbmltYXRlI2xlYXZlXG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvbiBUcmlnZ2VycyBhbiBhbmltYXRpb24gYW5kIHRoZW4gcmVtb3ZlcyB0aGUgZWxlbWVudCBmcm9tIHRoZSBET00uXG5cdCAgICAgICAqIFdoZW4gdGhlIGZ1bmN0aW9uIGlzIGNhbGxlZCBhIHByb21pc2UgaXMgcmV0dXJuZWQgdGhhdCB3aWxsIGJlIHJlc29sdmVkIGR1cmluZyB0aGUgbmV4dFxuXHQgICAgICAgKiBkaWdlc3Qgb25jZSB0aGUgYW5pbWF0aW9uIGhhcyBjb21wbGV0ZWQuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB3aGljaCB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgRE9NXG5cdCAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIG9wdGlvbnMvc3R5bGVzIHRoYXQgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50XG5cdCAgICAgICAqXG5cdCAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxuXHQgICAgICAgKi9cblx0ICAgICAgbGVhdmU6IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcblx0ICAgICAgICByZXR1cm4gJCRhbmltYXRlUXVldWUucHVzaChlbGVtZW50LCAnbGVhdmUnLCBwcmVwYXJlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucyksIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSxcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAqIEBuYW1lICRhbmltYXRlI2FkZENsYXNzXG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvbiBUcmlnZ2VycyBhbiBhZGRDbGFzcyBhbmltYXRpb24gc3Vycm91bmRpbmcgdGhlIGFkZGl0aW9uIG9mIHRoZSBwcm92aWRlZCBDU1MgY2xhc3MoZXMpLiBVcG9uXG5cdCAgICAgICAqICAgZXhlY3V0aW9uLCB0aGUgYWRkQ2xhc3Mgb3BlcmF0aW9uIHdpbGwgb25seSBiZSBoYW5kbGVkIGFmdGVyIHRoZSBuZXh0IGRpZ2VzdCBhbmQgaXQgd2lsbCBub3QgdHJpZ2dlciBhblxuXHQgICAgICAgKiAgIGFuaW1hdGlvbiBpZiBlbGVtZW50IGFscmVhZHkgY29udGFpbnMgdGhlIENTUyBjbGFzcyBvciBpZiB0aGUgY2xhc3MgaXMgcmVtb3ZlZCBhdCBhIGxhdGVyIHN0ZXAuXG5cdCAgICAgICAqICAgTm90ZSB0aGF0IGNsYXNzLWJhc2VkIGFuaW1hdGlvbnMgYXJlIHRyZWF0ZWQgZGlmZmVyZW50bHkgY29tcGFyZWQgdG8gc3RydWN0dXJhbCBhbmltYXRpb25zXG5cdCAgICAgICAqICAgKGxpa2UgZW50ZXIsIG1vdmUgYW5kIGxlYXZlKSBzaW5jZSB0aGUgQ1NTIGNsYXNzZXMgbWF5IGJlIGFkZGVkL3JlbW92ZWQgYXQgZGlmZmVyZW50IHBvaW50c1xuXHQgICAgICAgKiAgIGRlcGVuZGluZyBpZiBDU1Mgb3IgSmF2YVNjcmlwdCBhbmltYXRpb25zIGFyZSB1c2VkLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgd2hpY2ggdGhlIENTUyBjbGFzc2VzIHdpbGwgYmUgYXBwbGllZCB0b1xuXHQgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NOYW1lIHRoZSBDU1MgY2xhc3MoZXMpIHRoYXQgd2lsbCBiZSBhZGRlZCAobXVsdGlwbGUgY2xhc3NlcyBhcmUgc2VwYXJhdGVkIHZpYSBzcGFjZXMpXG5cdCAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIG9wdGlvbnMvc3R5bGVzIHRoYXQgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50XG5cdCAgICAgICAqXG5cdCAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxuXHQgICAgICAgKi9cblx0ICAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgb3B0aW9ucykge1xuXHQgICAgICAgIG9wdGlvbnMgPSBwcmVwYXJlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucyk7XG5cdCAgICAgICAgb3B0aW9ucy5hZGRDbGFzcyA9IG1lcmdlQ2xhc3NlcyhvcHRpb25zLmFkZGNsYXNzLCBjbGFzc05hbWUpO1xuXHQgICAgICAgIHJldHVybiAkJGFuaW1hdGVRdWV1ZS5wdXNoKGVsZW1lbnQsICdhZGRDbGFzcycsIG9wdGlvbnMpO1xuXHQgICAgICB9LFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJGFuaW1hdGUjcmVtb3ZlQ2xhc3Ncblx0ICAgICAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgICAgICpcblx0ICAgICAgICogQGRlc2NyaXB0aW9uIFRyaWdnZXJzIGEgcmVtb3ZlQ2xhc3MgYW5pbWF0aW9uIHN1cnJvdW5kaW5nIHRoZSByZW1vdmFsIG9mIHRoZSBwcm92aWRlZCBDU1MgY2xhc3MoZXMpLiBVcG9uXG5cdCAgICAgICAqICAgZXhlY3V0aW9uLCB0aGUgcmVtb3ZlQ2xhc3Mgb3BlcmF0aW9uIHdpbGwgb25seSBiZSBoYW5kbGVkIGFmdGVyIHRoZSBuZXh0IGRpZ2VzdCBhbmQgaXQgd2lsbCBub3QgdHJpZ2dlciBhblxuXHQgICAgICAgKiAgIGFuaW1hdGlvbiBpZiBlbGVtZW50IGRvZXMgbm90IGNvbnRhaW4gdGhlIENTUyBjbGFzcyBvciBpZiB0aGUgY2xhc3MgaXMgYWRkZWQgYXQgYSBsYXRlciBzdGVwLlxuXHQgICAgICAgKiAgIE5vdGUgdGhhdCBjbGFzcy1iYXNlZCBhbmltYXRpb25zIGFyZSB0cmVhdGVkIGRpZmZlcmVudGx5IGNvbXBhcmVkIHRvIHN0cnVjdHVyYWwgYW5pbWF0aW9uc1xuXHQgICAgICAgKiAgIChsaWtlIGVudGVyLCBtb3ZlIGFuZCBsZWF2ZSkgc2luY2UgdGhlIENTUyBjbGFzc2VzIG1heSBiZSBhZGRlZC9yZW1vdmVkIGF0IGRpZmZlcmVudCBwb2ludHNcblx0ICAgICAgICogICBkZXBlbmRpbmcgaWYgQ1NTIG9yIEphdmFTY3JpcHQgYW5pbWF0aW9ucyBhcmUgdXNlZC5cblx0ICAgICAgICpcblx0ICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHdoaWNoIHRoZSBDU1MgY2xhc3NlcyB3aWxsIGJlIGFwcGxpZWQgdG9cblx0ICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzTmFtZSB0aGUgQ1NTIGNsYXNzKGVzKSB0aGF0IHdpbGwgYmUgcmVtb3ZlZCAobXVsdGlwbGUgY2xhc3NlcyBhcmUgc2VwYXJhdGVkIHZpYSBzcGFjZXMpXG5cdCAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIG9wdGlvbnMvc3R5bGVzIHRoYXQgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50XG5cdCAgICAgICAqXG5cdCAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxuXHQgICAgICAgKi9cblx0ICAgICAgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgb3B0aW9ucykge1xuXHQgICAgICAgIG9wdGlvbnMgPSBwcmVwYXJlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucyk7XG5cdCAgICAgICAgb3B0aW9ucy5yZW1vdmVDbGFzcyA9IG1lcmdlQ2xhc3NlcyhvcHRpb25zLnJlbW92ZUNsYXNzLCBjbGFzc05hbWUpO1xuXHQgICAgICAgIHJldHVybiAkJGFuaW1hdGVRdWV1ZS5wdXNoKGVsZW1lbnQsICdyZW1vdmVDbGFzcycsIG9wdGlvbnMpO1xuXHQgICAgICB9LFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJGFuaW1hdGUjc2V0Q2xhc3Ncblx0ICAgICAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgICAgICpcblx0ICAgICAgICogQGRlc2NyaXB0aW9uIFBlcmZvcm1zIGJvdGggdGhlIGFkZGl0aW9uIGFuZCByZW1vdmFsIG9mIGEgQ1NTIGNsYXNzZXMgb24gYW4gZWxlbWVudCBhbmQgKGR1cmluZyB0aGUgcHJvY2Vzcylcblx0ICAgICAgICogICAgdHJpZ2dlcnMgYW4gYW5pbWF0aW9uIHN1cnJvdW5kaW5nIHRoZSBjbGFzcyBhZGRpdGlvbi9yZW1vdmFsLiBNdWNoIGxpa2UgYCRhbmltYXRlLmFkZENsYXNzYCBhbmRcblx0ICAgICAgICogICAgYCRhbmltYXRlLnJlbW92ZUNsYXNzYCwgYHNldENsYXNzYCB3aWxsIG9ubHkgZXZhbHVhdGUgdGhlIGNsYXNzZXMgYmVpbmcgYWRkZWQvcmVtb3ZlZCBvbmNlIGEgZGlnZXN0IGhhc1xuXHQgICAgICAgKiAgICBwYXNzZWQuIE5vdGUgdGhhdCBjbGFzcy1iYXNlZCBhbmltYXRpb25zIGFyZSB0cmVhdGVkIGRpZmZlcmVudGx5IGNvbXBhcmVkIHRvIHN0cnVjdHVyYWwgYW5pbWF0aW9uc1xuXHQgICAgICAgKiAgICAobGlrZSBlbnRlciwgbW92ZSBhbmQgbGVhdmUpIHNpbmNlIHRoZSBDU1MgY2xhc3NlcyBtYXkgYmUgYWRkZWQvcmVtb3ZlZCBhdCBkaWZmZXJlbnQgcG9pbnRzXG5cdCAgICAgICAqICAgIGRlcGVuZGluZyBpZiBDU1Mgb3IgSmF2YVNjcmlwdCBhbmltYXRpb25zIGFyZSB1c2VkLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgd2hpY2ggdGhlIENTUyBjbGFzc2VzIHdpbGwgYmUgYXBwbGllZCB0b1xuXHQgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gYWRkIHRoZSBDU1MgY2xhc3MoZXMpIHRoYXQgd2lsbCBiZSBhZGRlZCAobXVsdGlwbGUgY2xhc3NlcyBhcmUgc2VwYXJhdGVkIHZpYSBzcGFjZXMpXG5cdCAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZW1vdmUgdGhlIENTUyBjbGFzcyhlcykgdGhhdCB3aWxsIGJlIHJlbW92ZWQgKG11bHRpcGxlIGNsYXNzZXMgYXJlIHNlcGFyYXRlZCB2aWEgc3BhY2VzKVxuXHQgICAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgYW4gb3B0aW9uYWwgY29sbGVjdGlvbiBvZiBvcHRpb25zL3N0eWxlcyB0aGF0IHdpbGwgYmUgYXBwbGllZCB0byB0aGUgZWxlbWVudFxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSB0aGUgYW5pbWF0aW9uIGNhbGxiYWNrIHByb21pc2Vcblx0ICAgICAgICovXG5cdCAgICAgIHNldENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBhZGQsIHJlbW92ZSwgb3B0aW9ucykge1xuXHQgICAgICAgIG9wdGlvbnMgPSBwcmVwYXJlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucyk7XG5cdCAgICAgICAgb3B0aW9ucy5hZGRDbGFzcyA9IG1lcmdlQ2xhc3NlcyhvcHRpb25zLmFkZENsYXNzLCBhZGQpO1xuXHQgICAgICAgIG9wdGlvbnMucmVtb3ZlQ2xhc3MgPSBtZXJnZUNsYXNzZXMob3B0aW9ucy5yZW1vdmVDbGFzcywgcmVtb3ZlKTtcblx0ICAgICAgICByZXR1cm4gJCRhbmltYXRlUXVldWUucHVzaChlbGVtZW50LCAnc2V0Q2xhc3MnLCBvcHRpb25zKTtcblx0ICAgICAgfSxcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAqIEBuYW1lICRhbmltYXRlI2FuaW1hdGVcblx0ICAgICAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgICAgICpcblx0ICAgICAgICogQGRlc2NyaXB0aW9uIFBlcmZvcm1zIGFuIGlubGluZSBhbmltYXRpb24gb24gdGhlIGVsZW1lbnQgd2hpY2ggYXBwbGllcyB0aGUgcHJvdmlkZWQgdG8gYW5kIGZyb20gQ1NTIHN0eWxlcyB0byB0aGUgZWxlbWVudC5cblx0ICAgICAgICogSWYgYW55IGRldGVjdGVkIENTUyB0cmFuc2l0aW9uLCBrZXlmcmFtZSBvciBKYXZhU2NyaXB0IG1hdGNoZXMgdGhlIHByb3ZpZGVkIGNsYXNzTmFtZSB2YWx1ZSwgdGhlbiB0aGUgYW5pbWF0aW9uIHdpbGwgdGFrZVxuXHQgICAgICAgKiBvbiB0aGUgcHJvdmlkZWQgc3R5bGVzLiBGb3IgZXhhbXBsZSwgaWYgYSB0cmFuc2l0aW9uIGFuaW1hdGlvbiBpcyBzZXQgZm9yIHRoZSBnaXZlbiBjbGFzc05hbWVtLCB0aGVuIHRoZSBwcm92aWRlZCBgZnJvbWAgYW5kXG5cdCAgICAgICAqIGB0b2Agc3R5bGVzIHdpbGwgYmUgYXBwbGllZCBhbG9uZ3NpZGUgdGhlIGdpdmVuIHRyYW5zaXRpb24uIElmIHRoZSBDU1Mgc3R5bGUgcHJvdmlkZWQgaW4gYGZyb21gIGRvZXMgbm90IGhhdmUgYSBjb3JyZXNwb25kaW5nXG5cdCAgICAgICAqIHN0eWxlIGluIGB0b2AsIHRoZSBzdHlsZSBpbiBgZnJvbWAgaXMgYXBwbGllZCBpbW1lZGlhdGVseSwgYW5kIG5vIGFuaW1hdGlvbiBpcyBydW4uXG5cdCAgICAgICAqIElmIGEgSmF2YVNjcmlwdCBhbmltYXRpb24gaXMgZGV0ZWN0ZWQgdGhlbiB0aGUgcHJvdmlkZWQgc3R5bGVzIHdpbGwgYmUgZ2l2ZW4gaW4gYXMgZnVuY3Rpb24gcGFyYW1ldGVycyBpbnRvIHRoZSBgYW5pbWF0ZWBcblx0ICAgICAgICogbWV0aG9kIChvciBhcyBwYXJ0IG9mIHRoZSBgb3B0aW9uc2AgcGFyYW1ldGVyKTpcblx0ICAgICAgICpcblx0ICAgICAgICogYGBganNcblx0ICAgICAgICogbmdNb2R1bGUuYW5pbWF0aW9uKCcubXktaW5saW5lLWFuaW1hdGlvbicsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgKiAgIHJldHVybiB7XG5cdCAgICAgICAqICAgICBhbmltYXRlIDogZnVuY3Rpb24oZWxlbWVudCwgZnJvbSwgdG8sIGRvbmUsIG9wdGlvbnMpIHtcblx0ICAgICAgICogICAgICAgLy9hbmltYXRpb25cblx0ICAgICAgICogICAgICAgZG9uZSgpO1xuXHQgICAgICAgKiAgICAgfVxuXHQgICAgICAgKiAgIH1cblx0ICAgICAgICogfSk7XG5cdCAgICAgICAqIGBgYFxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgd2hpY2ggdGhlIENTUyBzdHlsZXMgd2lsbCBiZSBhcHBsaWVkIHRvXG5cdCAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBmcm9tIHRoZSBmcm9tIChzdGFydGluZykgQ1NTIHN0eWxlcyB0aGF0IHdpbGwgYmUgYXBwbGllZCB0byB0aGUgZWxlbWVudCBhbmQgYWNyb3NzIHRoZSBhbmltYXRpb24uXG5cdCAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSB0byB0aGUgdG8gKGRlc3RpbmF0aW9uKSBDU1Mgc3R5bGVzIHRoYXQgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50IGFuZCBhY3Jvc3MgdGhlIGFuaW1hdGlvbi5cblx0ICAgICAgICogQHBhcmFtIHtzdHJpbmc9fSBjbGFzc05hbWUgYW4gb3B0aW9uYWwgQ1NTIGNsYXNzIHRoYXQgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50IGZvciB0aGUgZHVyYXRpb24gb2YgdGhlIGFuaW1hdGlvbi4gSWZcblx0ICAgICAgICogICAgdGhpcyB2YWx1ZSBpcyBsZWZ0IGFzIGVtcHR5IHRoZW4gYSBDU1MgY2xhc3Mgb2YgYG5nLWlubGluZS1hbmltYXRlYCB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnQuXG5cdCAgICAgICAqICAgIChOb3RlIHRoYXQgaWYgbm8gYW5pbWF0aW9uIGlzIGRldGVjdGVkIHRoZW4gdGhpcyB2YWx1ZSB3aWxsIG5vdCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50Lilcblx0ICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygb3B0aW9ucy9zdHlsZXMgdGhhdCB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnRcblx0ICAgICAgICpcblx0ICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXG5cdCAgICAgICAqL1xuXHQgICAgICBhbmltYXRlOiBmdW5jdGlvbihlbGVtZW50LCBmcm9tLCB0bywgY2xhc3NOYW1lLCBvcHRpb25zKSB7XG5cdCAgICAgICAgb3B0aW9ucyA9IHByZXBhcmVBbmltYXRlT3B0aW9ucyhvcHRpb25zKTtcblx0ICAgICAgICBvcHRpb25zLmZyb20gPSBvcHRpb25zLmZyb20gPyBleHRlbmQob3B0aW9ucy5mcm9tLCBmcm9tKSA6IGZyb207XG5cdCAgICAgICAgb3B0aW9ucy50byAgID0gb3B0aW9ucy50byAgID8gZXh0ZW5kKG9wdGlvbnMudG8sIHRvKSAgICAgOiB0bztcblx0XG5cdCAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lIHx8ICduZy1pbmxpbmUtYW5pbWF0ZSc7XG5cdCAgICAgICAgb3B0aW9ucy50ZW1wQ2xhc3NlcyA9IG1lcmdlQ2xhc3NlcyhvcHRpb25zLnRlbXBDbGFzc2VzLCBjbGFzc05hbWUpO1xuXHQgICAgICAgIHJldHVybiAkJGFuaW1hdGVRdWV1ZS5wdXNoKGVsZW1lbnQsICdhbmltYXRlJywgb3B0aW9ucyk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgfV07XG5cdH1dO1xuXHRcblx0dmFyICQkQW5pbWF0ZUFzeW5jUnVuRmFjdG9yeVByb3ZpZGVyID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy4kZ2V0ID0gWyckJHJBRicsIGZ1bmN0aW9uKCQkckFGKSB7XG5cdCAgICB2YXIgd2FpdFF1ZXVlID0gW107XG5cdFxuXHQgICAgZnVuY3Rpb24gd2FpdEZvclRpY2soZm4pIHtcblx0ICAgICAgd2FpdFF1ZXVlLnB1c2goZm4pO1xuXHQgICAgICBpZiAod2FpdFF1ZXVlLmxlbmd0aCA+IDEpIHJldHVybjtcblx0ICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3YWl0UXVldWUubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgIHdhaXRRdWV1ZVtpXSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB3YWl0UXVldWUgPSBbXTtcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgICB2YXIgcGFzc2VkID0gZmFsc2U7XG5cdCAgICAgIHdhaXRGb3JUaWNrKGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHBhc3NlZCA9IHRydWU7XG5cdCAgICAgIH0pO1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0ICAgICAgICBwYXNzZWQgPyBjYWxsYmFjaygpIDogd2FpdEZvclRpY2soY2FsbGJhY2spO1xuXHQgICAgICB9O1xuXHQgICAgfTtcblx0ICB9XTtcblx0fTtcblx0XG5cdHZhciAkJEFuaW1hdGVSdW5uZXJGYWN0b3J5UHJvdmlkZXIgPSBmdW5jdGlvbigpIHtcblx0ICB0aGlzLiRnZXQgPSBbJyRxJywgJyRzbmlmZmVyJywgJyQkYW5pbWF0ZUFzeW5jUnVuJywgJyRkb2N1bWVudCcsICckdGltZW91dCcsXG5cdCAgICAgICBmdW5jdGlvbigkcSwgICAkc25pZmZlciwgICAkJGFuaW1hdGVBc3luY1J1biwgICAkZG9jdW1lbnQsICAgJHRpbWVvdXQpIHtcblx0XG5cdCAgICB2YXIgSU5JVElBTF9TVEFURSA9IDA7XG5cdCAgICB2YXIgRE9ORV9QRU5ESU5HX1NUQVRFID0gMTtcblx0ICAgIHZhciBET05FX0NPTVBMRVRFX1NUQVRFID0gMjtcblx0XG5cdCAgICBBbmltYXRlUnVubmVyLmNoYWluID0gZnVuY3Rpb24oY2hhaW4sIGNhbGxiYWNrKSB7XG5cdCAgICAgIHZhciBpbmRleCA9IDA7XG5cdFxuXHQgICAgICBuZXh0KCk7XG5cdCAgICAgIGZ1bmN0aW9uIG5leHQoKSB7XG5cdCAgICAgICAgaWYgKGluZGV4ID09PSBjaGFpbi5sZW5ndGgpIHtcblx0ICAgICAgICAgIGNhbGxiYWNrKHRydWUpO1xuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgY2hhaW5baW5kZXhdKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdCAgICAgICAgICBpZiAocmVzcG9uc2UgPT09IGZhbHNlKSB7XG5cdCAgICAgICAgICAgIGNhbGxiYWNrKGZhbHNlKTtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgaW5kZXgrKztcblx0ICAgICAgICAgIG5leHQoKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICBBbmltYXRlUnVubmVyLmFsbCA9IGZ1bmN0aW9uKHJ1bm5lcnMsIGNhbGxiYWNrKSB7XG5cdCAgICAgIHZhciBjb3VudCA9IDA7XG5cdCAgICAgIHZhciBzdGF0dXMgPSB0cnVlO1xuXHQgICAgICBmb3JFYWNoKHJ1bm5lcnMsIGZ1bmN0aW9uKHJ1bm5lcikge1xuXHQgICAgICAgIHJ1bm5lci5kb25lKG9uUHJvZ3Jlc3MpO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIG9uUHJvZ3Jlc3MocmVzcG9uc2UpIHtcblx0ICAgICAgICBzdGF0dXMgPSBzdGF0dXMgJiYgcmVzcG9uc2U7XG5cdCAgICAgICAgaWYgKCsrY291bnQgPT09IHJ1bm5lcnMubGVuZ3RoKSB7XG5cdCAgICAgICAgICBjYWxsYmFjayhzdGF0dXMpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBBbmltYXRlUnVubmVyKGhvc3QpIHtcblx0ICAgICAgdGhpcy5zZXRIb3N0KGhvc3QpO1xuXHRcblx0ICAgICAgdmFyIHJhZlRpY2sgPSAkJGFuaW1hdGVBc3luY1J1bigpO1xuXHQgICAgICB2YXIgdGltZW91dFRpY2sgPSBmdW5jdGlvbihmbikge1xuXHQgICAgICAgICR0aW1lb3V0KGZuLCAwLCBmYWxzZSk7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICB0aGlzLl9kb25lQ2FsbGJhY2tzID0gW107XG5cdCAgICAgIHRoaXMuX3RpY2sgPSBmdW5jdGlvbihmbikge1xuXHQgICAgICAgIHZhciBkb2MgPSAkZG9jdW1lbnRbMF07XG5cdFxuXHQgICAgICAgIC8vIHRoZSBkb2N1bWVudCBtYXkgbm90IGJlIHJlYWR5IG9yIGF0dGFjaGVkXG5cdCAgICAgICAgLy8gdG8gdGhlIG1vZHVsZSBmb3Igc29tZSBpbnRlcm5hbCB0ZXN0c1xuXHQgICAgICAgIGlmIChkb2MgJiYgZG9jLmhpZGRlbikge1xuXHQgICAgICAgICAgdGltZW91dFRpY2soZm4pO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICByYWZUaWNrKGZuKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgICAgIHRoaXMuX3N0YXRlID0gMDtcblx0ICAgIH1cblx0XG5cdCAgICBBbmltYXRlUnVubmVyLnByb3RvdHlwZSA9IHtcblx0ICAgICAgc2V0SG9zdDogZnVuY3Rpb24oaG9zdCkge1xuXHQgICAgICAgIHRoaXMuaG9zdCA9IGhvc3QgfHwge307XG5cdCAgICAgIH0sXG5cdFxuXHQgICAgICBkb25lOiBmdW5jdGlvbihmbikge1xuXHQgICAgICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gRE9ORV9DT01QTEVURV9TVEFURSkge1xuXHQgICAgICAgICAgZm4oKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgdGhpcy5fZG9uZUNhbGxiYWNrcy5wdXNoKGZuKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdFxuXHQgICAgICBwcm9ncmVzczogbm9vcCxcblx0XG5cdCAgICAgIGdldFByb21pc2U6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICghdGhpcy5wcm9taXNlKSB7XG5cdCAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAgICAgICAgICB0aGlzLnByb21pc2UgPSAkcShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgICAgICAgc2VsZi5kb25lKGZ1bmN0aW9uKHN0YXR1cykge1xuXHQgICAgICAgICAgICAgIHN0YXR1cyA9PT0gZmFsc2UgPyByZWplY3QoKSA6IHJlc29sdmUoKTtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZTtcblx0ICAgICAgfSxcblx0XG5cdCAgICAgIHRoZW46IGZ1bmN0aW9uKHJlc29sdmVIYW5kbGVyLCByZWplY3RIYW5kbGVyKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvbWlzZSgpLnRoZW4ocmVzb2x2ZUhhbmRsZXIsIHJlamVjdEhhbmRsZXIpO1xuXHQgICAgICB9LFxuXHRcblx0ICAgICAgJ2NhdGNoJzogZnVuY3Rpb24oaGFuZGxlcikge1xuXHQgICAgICAgIHJldHVybiB0aGlzLmdldFByb21pc2UoKVsnY2F0Y2gnXShoYW5kbGVyKTtcblx0ICAgICAgfSxcblx0XG5cdCAgICAgICdmaW5hbGx5JzogZnVuY3Rpb24oaGFuZGxlcikge1xuXHQgICAgICAgIHJldHVybiB0aGlzLmdldFByb21pc2UoKVsnZmluYWxseSddKGhhbmRsZXIpO1xuXHQgICAgICB9LFxuXHRcblx0ICAgICAgcGF1c2U6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICh0aGlzLmhvc3QucGF1c2UpIHtcblx0ICAgICAgICAgIHRoaXMuaG9zdC5wYXVzZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0XG5cdCAgICAgIHJlc3VtZTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKHRoaXMuaG9zdC5yZXN1bWUpIHtcblx0ICAgICAgICAgIHRoaXMuaG9zdC5yZXN1bWUoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdFxuXHQgICAgICBlbmQ6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICh0aGlzLmhvc3QuZW5kKSB7XG5cdCAgICAgICAgICB0aGlzLmhvc3QuZW5kKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMuX3Jlc29sdmUodHJ1ZSk7XG5cdCAgICAgIH0sXG5cdFxuXHQgICAgICBjYW5jZWw6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICh0aGlzLmhvc3QuY2FuY2VsKSB7XG5cdCAgICAgICAgICB0aGlzLmhvc3QuY2FuY2VsKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMuX3Jlc29sdmUoZmFsc2UpO1xuXHQgICAgICB9LFxuXHRcblx0ICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdCAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXHQgICAgICAgIGlmIChzZWxmLl9zdGF0ZSA9PT0gSU5JVElBTF9TVEFURSkge1xuXHQgICAgICAgICAgc2VsZi5fc3RhdGUgPSBET05FX1BFTkRJTkdfU1RBVEU7XG5cdCAgICAgICAgICBzZWxmLl90aWNrKGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBzZWxmLl9yZXNvbHZlKHJlc3BvbnNlKTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0XG5cdCAgICAgIF9yZXNvbHZlOiBmdW5jdGlvbihyZXNwb25zZSkge1xuXHQgICAgICAgIGlmICh0aGlzLl9zdGF0ZSAhPT0gRE9ORV9DT01QTEVURV9TVEFURSkge1xuXHQgICAgICAgICAgZm9yRWFjaCh0aGlzLl9kb25lQ2FsbGJhY2tzLCBmdW5jdGlvbihmbikge1xuXHQgICAgICAgICAgICBmbihyZXNwb25zZSk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICAgIHRoaXMuX2RvbmVDYWxsYmFja3MubGVuZ3RoID0gMDtcblx0ICAgICAgICAgIHRoaXMuX3N0YXRlID0gRE9ORV9DT01QTEVURV9TVEFURTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEFuaW1hdGVSdW5uZXI7XG5cdCAgfV07XG5cdH07XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHNlcnZpY2Vcblx0ICogQG5hbWUgJGFuaW1hdGVDc3Ncblx0ICogQGtpbmQgb2JqZWN0XG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUaGlzIGlzIHRoZSBjb3JlIHZlcnNpb24gb2YgYCRhbmltYXRlQ3NzYC4gQnkgZGVmYXVsdCwgb25seSB3aGVuIHRoZSBgbmdBbmltYXRlYCBpcyBpbmNsdWRlZCxcblx0ICogdGhlbiB0aGUgYCRhbmltYXRlQ3NzYCBzZXJ2aWNlIHdpbGwgYWN0dWFsbHkgcGVyZm9ybSBhbmltYXRpb25zLlxuXHQgKlxuXHQgKiBDbGljayBoZXJlIHtAbGluayBuZ0FuaW1hdGUuJGFuaW1hdGVDc3MgdG8gcmVhZCB0aGUgZG9jdW1lbnRhdGlvbiBmb3IgJGFuaW1hdGVDc3N9LlxuXHQgKi9cblx0dmFyICRDb3JlQW5pbWF0ZUNzc1Byb3ZpZGVyID0gZnVuY3Rpb24oKSB7XG5cdCAgdGhpcy4kZ2V0ID0gWyckJHJBRicsICckcScsICckJEFuaW1hdGVSdW5uZXInLCBmdW5jdGlvbigkJHJBRiwgJHEsICQkQW5pbWF0ZVJ1bm5lcikge1xuXHRcblx0ICAgIHJldHVybiBmdW5jdGlvbihlbGVtZW50LCBpbml0aWFsT3B0aW9ucykge1xuXHQgICAgICAvLyBhbGwgb2YgdGhlIGFuaW1hdGlvbiBmdW5jdGlvbnMgc2hvdWxkIGNyZWF0ZVxuXHQgICAgICAvLyBhIGNvcHkgb2YgdGhlIG9wdGlvbnMgZGF0YSwgaG93ZXZlciwgaWYgYVxuXHQgICAgICAvLyBwYXJlbnQgc2VydmljZSBoYXMgYWxyZWFkeSBjcmVhdGVkIGEgY29weSB0aGVuXG5cdCAgICAgIC8vIHdlIHNob3VsZCBzdGljayB0byB1c2luZyB0aGF0XG5cdCAgICAgIHZhciBvcHRpb25zID0gaW5pdGlhbE9wdGlvbnMgfHwge307XG5cdCAgICAgIGlmICghb3B0aW9ucy4kJHByZXBhcmVkKSB7XG5cdCAgICAgICAgb3B0aW9ucyA9IGNvcHkob3B0aW9ucyk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vIHRoZXJlIGlzIG5vIHBvaW50IGluIGFwcGx5aW5nIHRoZSBzdHlsZXMgc2luY2Vcblx0ICAgICAgLy8gdGhlcmUgaXMgbm8gYW5pbWF0aW9uIHRoYXQgZ29lcyBvbiBhdCBhbGwgaW5cblx0ICAgICAgLy8gdGhpcyB2ZXJzaW9uIG9mICRhbmltYXRlQ3NzLlxuXHQgICAgICBpZiAob3B0aW9ucy5jbGVhbnVwU3R5bGVzKSB7XG5cdCAgICAgICAgb3B0aW9ucy5mcm9tID0gb3B0aW9ucy50byA9IG51bGw7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGlmIChvcHRpb25zLmZyb20pIHtcblx0ICAgICAgICBlbGVtZW50LmNzcyhvcHRpb25zLmZyb20pO1xuXHQgICAgICAgIG9wdGlvbnMuZnJvbSA9IG51bGw7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8qIGpzaGludCBuZXdjYXA6IGZhbHNlICovXG5cdCAgICAgIHZhciBjbG9zZWQsIHJ1bm5lciA9IG5ldyAkJEFuaW1hdGVSdW5uZXIoKTtcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICBzdGFydDogcnVuLFxuXHQgICAgICAgIGVuZDogcnVuXG5cdCAgICAgIH07XG5cdFxuXHQgICAgICBmdW5jdGlvbiBydW4oKSB7XG5cdCAgICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBhcHBseUFuaW1hdGlvbkNvbnRlbnRzKCk7XG5cdCAgICAgICAgICBpZiAoIWNsb3NlZCkge1xuXHQgICAgICAgICAgICBydW5uZXIuY29tcGxldGUoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGNsb3NlZCA9IHRydWU7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgcmV0dXJuIHJ1bm5lcjtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgZnVuY3Rpb24gYXBwbHlBbmltYXRpb25Db250ZW50cygpIHtcblx0ICAgICAgICBpZiAob3B0aW9ucy5hZGRDbGFzcykge1xuXHQgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcyhvcHRpb25zLmFkZENsYXNzKTtcblx0ICAgICAgICAgIG9wdGlvbnMuYWRkQ2xhc3MgPSBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAob3B0aW9ucy5yZW1vdmVDbGFzcykge1xuXHQgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhvcHRpb25zLnJlbW92ZUNsYXNzKTtcblx0ICAgICAgICAgIG9wdGlvbnMucmVtb3ZlQ2xhc3MgPSBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAob3B0aW9ucy50bykge1xuXHQgICAgICAgICAgZWxlbWVudC5jc3Mob3B0aW9ucy50byk7XG5cdCAgICAgICAgICBvcHRpb25zLnRvID0gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgfV07XG5cdH07XG5cdFxuXHQvKiBnbG9iYWwgc3RyaXBIYXNoOiB0cnVlICovXG5cdFxuXHQvKipcblx0ICogISBUaGlzIGlzIGEgcHJpdmF0ZSB1bmRvY3VtZW50ZWQgc2VydmljZSAhXG5cdCAqXG5cdCAqIEBuYW1lICRicm93c2VyXG5cdCAqIEByZXF1aXJlcyAkbG9nXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUaGlzIG9iamVjdCBoYXMgdHdvIGdvYWxzOlxuXHQgKlxuXHQgKiAtIGhpZGUgYWxsIHRoZSBnbG9iYWwgc3RhdGUgaW4gdGhlIGJyb3dzZXIgY2F1c2VkIGJ5IHRoZSB3aW5kb3cgb2JqZWN0XG5cdCAqIC0gYWJzdHJhY3QgYXdheSBhbGwgdGhlIGJyb3dzZXIgc3BlY2lmaWMgZmVhdHVyZXMgYW5kIGluY29uc2lzdGVuY2llc1xuXHQgKlxuXHQgKiBGb3IgdGVzdHMgd2UgcHJvdmlkZSB7QGxpbmsgbmdNb2NrLiRicm93c2VyIG1vY2sgaW1wbGVtZW50YXRpb259IG9mIHRoZSBgJGJyb3dzZXJgXG5cdCAqIHNlcnZpY2UsIHdoaWNoIGNhbiBiZSB1c2VkIGZvciBjb252ZW5pZW50IHRlc3Rpbmcgb2YgdGhlIGFwcGxpY2F0aW9uIHdpdGhvdXQgdGhlIGludGVyYWN0aW9uIHdpdGhcblx0ICogdGhlIHJlYWwgYnJvd3NlciBhcGlzLlxuXHQgKi9cblx0LyoqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSB3aW5kb3cgVGhlIGdsb2JhbCB3aW5kb3cgb2JqZWN0LlxuXHQgKiBAcGFyYW0ge29iamVjdH0gZG9jdW1lbnQgalF1ZXJ5IHdyYXBwZWQgZG9jdW1lbnQuXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSAkbG9nIHdpbmRvdy5jb25zb2xlIG9yIGFuIG9iamVjdCB3aXRoIHRoZSBzYW1lIGludGVyZmFjZS5cblx0ICogQHBhcmFtIHtvYmplY3R9ICRzbmlmZmVyICRzbmlmZmVyIHNlcnZpY2Vcblx0ICovXG5cdGZ1bmN0aW9uIEJyb3dzZXIod2luZG93LCBkb2N1bWVudCwgJGxvZywgJHNuaWZmZXIpIHtcblx0ICB2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICAgIHJhd0RvY3VtZW50ID0gZG9jdW1lbnRbMF0sXG5cdCAgICAgIGxvY2F0aW9uID0gd2luZG93LmxvY2F0aW9uLFxuXHQgICAgICBoaXN0b3J5ID0gd2luZG93Lmhpc3RvcnksXG5cdCAgICAgIHNldFRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dCxcblx0ICAgICAgY2xlYXJUaW1lb3V0ID0gd2luZG93LmNsZWFyVGltZW91dCxcblx0ICAgICAgcGVuZGluZ0RlZmVySWRzID0ge307XG5cdFxuXHQgIHNlbGYuaXNNb2NrID0gZmFsc2U7XG5cdFxuXHQgIHZhciBvdXRzdGFuZGluZ1JlcXVlc3RDb3VudCA9IDA7XG5cdCAgdmFyIG91dHN0YW5kaW5nUmVxdWVzdENhbGxiYWNrcyA9IFtdO1xuXHRcblx0ICAvLyBUT0RPKHZvanRhKTogcmVtb3ZlIHRoaXMgdGVtcG9yYXJ5IGFwaVxuXHQgIHNlbGYuJCRjb21wbGV0ZU91dHN0YW5kaW5nUmVxdWVzdCA9IGNvbXBsZXRlT3V0c3RhbmRpbmdSZXF1ZXN0O1xuXHQgIHNlbGYuJCRpbmNPdXRzdGFuZGluZ1JlcXVlc3RDb3VudCA9IGZ1bmN0aW9uKCkgeyBvdXRzdGFuZGluZ1JlcXVlc3RDb3VudCsrOyB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBFeGVjdXRlcyB0aGUgYGZuYCBmdW5jdGlvbihzdXBwb3J0cyBjdXJyeWluZykgYW5kIGRlY3JlbWVudHMgdGhlIGBvdXRzdGFuZGluZ1JlcXVlc3RDYWxsYmFja3NgXG5cdCAgICogY291bnRlci4gSWYgdGhlIGNvdW50ZXIgcmVhY2hlcyAwLCBhbGwgdGhlIGBvdXRzdGFuZGluZ1JlcXVlc3RDYWxsYmFja3NgIGFyZSBleGVjdXRlZC5cblx0ICAgKi9cblx0ICBmdW5jdGlvbiBjb21wbGV0ZU91dHN0YW5kaW5nUmVxdWVzdChmbikge1xuXHQgICAgdHJ5IHtcblx0ICAgICAgZm4uYXBwbHkobnVsbCwgc2xpY2VBcmdzKGFyZ3VtZW50cywgMSkpO1xuXHQgICAgfSBmaW5hbGx5IHtcblx0ICAgICAgb3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQtLTtcblx0ICAgICAgaWYgKG91dHN0YW5kaW5nUmVxdWVzdENvdW50ID09PSAwKSB7XG5cdCAgICAgICAgd2hpbGUgKG91dHN0YW5kaW5nUmVxdWVzdENhbGxiYWNrcy5sZW5ndGgpIHtcblx0ICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgIG91dHN0YW5kaW5nUmVxdWVzdENhbGxiYWNrcy5wb3AoKSgpO1xuXHQgICAgICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgICAkbG9nLmVycm9yKGUpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gZ2V0SGFzaCh1cmwpIHtcblx0ICAgIHZhciBpbmRleCA9IHVybC5pbmRleE9mKCcjJyk7XG5cdCAgICByZXR1cm4gaW5kZXggPT09IC0xID8gJycgOiB1cmwuc3Vic3RyKGluZGV4KTtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBwcml2YXRlXG5cdCAgICogTm90ZTogdGhpcyBtZXRob2QgaXMgdXNlZCBvbmx5IGJ5IHNjZW5hcmlvIHJ1bm5lclxuXHQgICAqIFRPRE8odm9qdGEpOiBwcmVmaXggdGhpcyBtZXRob2Qgd2l0aCAkJCA/XG5cdCAgICogQHBhcmFtIHtmdW5jdGlvbigpfSBjYWxsYmFjayBGdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIHdoZW4gbm8gb3V0c3RhbmRpbmcgcmVxdWVzdFxuXHQgICAqL1xuXHQgIHNlbGYubm90aWZ5V2hlbk5vT3V0c3RhbmRpbmdSZXF1ZXN0cyA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG5cdCAgICBpZiAob3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQgPT09IDApIHtcblx0ICAgICAgY2FsbGJhY2soKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIG91dHN0YW5kaW5nUmVxdWVzdENhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQgIC8vIFVSTCBBUElcblx0ICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcblx0ICB2YXIgY2FjaGVkU3RhdGUsIGxhc3RIaXN0b3J5U3RhdGUsXG5cdCAgICAgIGxhc3RCcm93c2VyVXJsID0gbG9jYXRpb24uaHJlZixcblx0ICAgICAgYmFzZUVsZW1lbnQgPSBkb2N1bWVudC5maW5kKCdiYXNlJyksXG5cdCAgICAgIHBlbmRpbmdMb2NhdGlvbiA9IG51bGw7XG5cdFxuXHQgIGNhY2hlU3RhdGUoKTtcblx0ICBsYXN0SGlzdG9yeVN0YXRlID0gY2FjaGVkU3RhdGU7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuYW1lICRicm93c2VyI3VybFxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogR0VUVEVSOlxuXHQgICAqIFdpdGhvdXQgYW55IGFyZ3VtZW50LCB0aGlzIG1ldGhvZCBqdXN0IHJldHVybnMgY3VycmVudCB2YWx1ZSBvZiBsb2NhdGlvbi5ocmVmLlxuXHQgICAqXG5cdCAgICogU0VUVEVSOlxuXHQgICAqIFdpdGggYXQgbGVhc3Qgb25lIGFyZ3VtZW50LCB0aGlzIG1ldGhvZCBzZXRzIHVybCB0byBuZXcgdmFsdWUuXG5cdCAgICogSWYgaHRtbDUgaGlzdG9yeSBhcGkgc3VwcG9ydGVkLCBwdXNoU3RhdGUvcmVwbGFjZVN0YXRlIGlzIHVzZWQsIG90aGVyd2lzZVxuXHQgICAqIGxvY2F0aW9uLmhyZWYvbG9jYXRpb24ucmVwbGFjZSBpcyB1c2VkLlxuXHQgICAqIFJldHVybnMgaXRzIG93biBpbnN0YW5jZSB0byBhbGxvdyBjaGFpbmluZ1xuXHQgICAqXG5cdCAgICogTk9URTogdGhpcyBhcGkgaXMgaW50ZW5kZWQgZm9yIHVzZSBvbmx5IGJ5IHRoZSAkbG9jYXRpb24gc2VydmljZS4gUGxlYXNlIHVzZSB0aGVcblx0ICAgKiB7QGxpbmsgbmcuJGxvY2F0aW9uICRsb2NhdGlvbiBzZXJ2aWNlfSB0byBjaGFuZ2UgdXJsLlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHVybCBOZXcgdXJsICh3aGVuIHVzZWQgYXMgc2V0dGVyKVxuXHQgICAqIEBwYXJhbSB7Ym9vbGVhbj19IHJlcGxhY2UgU2hvdWxkIG5ldyB1cmwgcmVwbGFjZSBjdXJyZW50IGhpc3RvcnkgcmVjb3JkP1xuXHQgICAqIEBwYXJhbSB7b2JqZWN0PX0gc3RhdGUgb2JqZWN0IHRvIHVzZSB3aXRoIHB1c2hTdGF0ZS9yZXBsYWNlU3RhdGVcblx0ICAgKi9cblx0ICBzZWxmLnVybCA9IGZ1bmN0aW9uKHVybCwgcmVwbGFjZSwgc3RhdGUpIHtcblx0ICAgIC8vIEluIG1vZGVybiBicm93c2VycyBgaGlzdG9yeS5zdGF0ZWAgaXMgYG51bGxgIGJ5IGRlZmF1bHQ7IHRyZWF0aW5nIGl0IHNlcGFyYXRlbHlcblx0ICAgIC8vIGZyb20gYHVuZGVmaW5lZGAgd291bGQgY2F1c2UgYCRicm93c2VyLnVybCgnL2ZvbycpYCB0byBjaGFuZ2UgYGhpc3Rvcnkuc3RhdGVgXG5cdCAgICAvLyB0byB1bmRlZmluZWQgdmlhIGBwdXNoU3RhdGVgLiBJbnN0ZWFkLCBsZXQncyBjaGFuZ2UgYHVuZGVmaW5lZGAgdG8gYG51bGxgIGhlcmUuXG5cdCAgICBpZiAoaXNVbmRlZmluZWQoc3RhdGUpKSB7XG5cdCAgICAgIHN0YXRlID0gbnVsbDtcblx0ICAgIH1cblx0XG5cdCAgICAvLyBBbmRyb2lkIEJyb3dzZXIgQkZDYWNoZSBjYXVzZXMgbG9jYXRpb24sIGhpc3RvcnkgcmVmZXJlbmNlIHRvIGJlY29tZSBzdGFsZS5cblx0ICAgIGlmIChsb2NhdGlvbiAhPT0gd2luZG93LmxvY2F0aW9uKSBsb2NhdGlvbiA9IHdpbmRvdy5sb2NhdGlvbjtcblx0ICAgIGlmIChoaXN0b3J5ICE9PSB3aW5kb3cuaGlzdG9yeSkgaGlzdG9yeSA9IHdpbmRvdy5oaXN0b3J5O1xuXHRcblx0ICAgIC8vIHNldHRlclxuXHQgICAgaWYgKHVybCkge1xuXHQgICAgICB2YXIgc2FtZVN0YXRlID0gbGFzdEhpc3RvcnlTdGF0ZSA9PT0gc3RhdGU7XG5cdFxuXHQgICAgICAvLyBEb24ndCBjaGFuZ2UgYW55dGhpbmcgaWYgcHJldmlvdXMgYW5kIGN1cnJlbnQgVVJMcyBhbmQgc3RhdGVzIG1hdGNoLiBUaGlzIGFsc28gcHJldmVudHNcblx0ICAgICAgLy8gSUU8MTAgZnJvbSBnZXR0aW5nIGludG8gcmVkaXJlY3QgbG9vcCB3aGVuIGluIExvY2F0aW9uSGFzaGJhbmdJbkh0bWw1VXJsIG1vZGUuXG5cdCAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL2NvbW1pdC9mZmIyNzAxXG5cdCAgICAgIGlmIChsYXN0QnJvd3NlclVybCA9PT0gdXJsICYmICghJHNuaWZmZXIuaGlzdG9yeSB8fCBzYW1lU3RhdGUpKSB7XG5cdCAgICAgICAgcmV0dXJuIHNlbGY7XG5cdCAgICAgIH1cblx0ICAgICAgdmFyIHNhbWVCYXNlID0gbGFzdEJyb3dzZXJVcmwgJiYgc3RyaXBIYXNoKGxhc3RCcm93c2VyVXJsKSA9PT0gc3RyaXBIYXNoKHVybCk7XG5cdCAgICAgIGxhc3RCcm93c2VyVXJsID0gdXJsO1xuXHQgICAgICBsYXN0SGlzdG9yeVN0YXRlID0gc3RhdGU7XG5cdCAgICAgIC8vIERvbid0IHVzZSBoaXN0b3J5IEFQSSBpZiBvbmx5IHRoZSBoYXNoIGNoYW5nZWRcblx0ICAgICAgLy8gZHVlIHRvIGEgYnVnIGluIElFMTAvSUUxMSB3aGljaCBsZWFkc1xuXHQgICAgICAvLyB0byBub3QgZmlyaW5nIGEgYGhhc2hjaGFuZ2VgIG5vciBgcG9wc3RhdGVgIGV2ZW50XG5cdCAgICAgIC8vIGluIHNvbWUgY2FzZXMgKHNlZSAjOTE0MykuXG5cdCAgICAgIGlmICgkc25pZmZlci5oaXN0b3J5ICYmICghc2FtZUJhc2UgfHwgIXNhbWVTdGF0ZSkpIHtcblx0ICAgICAgICBoaXN0b3J5W3JlcGxhY2UgPyAncmVwbGFjZVN0YXRlJyA6ICdwdXNoU3RhdGUnXShzdGF0ZSwgJycsIHVybCk7XG5cdCAgICAgICAgY2FjaGVTdGF0ZSgpO1xuXHQgICAgICAgIC8vIERvIHRoZSBhc3NpZ25tZW50IGFnYWluIHNvIHRoYXQgdGhvc2UgdHdvIHZhcmlhYmxlcyBhcmUgcmVmZXJlbnRpYWxseSBpZGVudGljYWwuXG5cdCAgICAgICAgbGFzdEhpc3RvcnlTdGF0ZSA9IGNhY2hlZFN0YXRlO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGlmICghc2FtZUJhc2UgfHwgcGVuZGluZ0xvY2F0aW9uKSB7XG5cdCAgICAgICAgICBwZW5kaW5nTG9jYXRpb24gPSB1cmw7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmIChyZXBsYWNlKSB7XG5cdCAgICAgICAgICBsb2NhdGlvbi5yZXBsYWNlKHVybCk7XG5cdCAgICAgICAgfSBlbHNlIGlmICghc2FtZUJhc2UpIHtcblx0ICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSB1cmw7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGxvY2F0aW9uLmhhc2ggPSBnZXRIYXNoKHVybCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmIChsb2NhdGlvbi5ocmVmICE9PSB1cmwpIHtcblx0ICAgICAgICAgIHBlbmRpbmdMb2NhdGlvbiA9IHVybDtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIHNlbGY7XG5cdCAgICAvLyBnZXR0ZXJcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIC8vIC0gcGVuZGluZ0xvY2F0aW9uIGlzIG5lZWRlZCBhcyBicm93c2VycyBkb24ndCBhbGxvdyB0byByZWFkIG91dFxuXHQgICAgICAvLyAgIHRoZSBuZXcgbG9jYXRpb24uaHJlZiBpZiBhIHJlbG9hZCBoYXBwZW5lZCBvciBpZiB0aGVyZSBpcyBhIGJ1ZyBsaWtlIGluIGlPUyA5IChzZWVcblx0ICAgICAgLy8gICBodHRwczovL29wZW5yYWRhci5hcHBzcG90LmNvbS8yMjE4NjEwOSkuXG5cdCAgICAgIC8vIC0gdGhlIHJlcGxhY2VtZW50IGlzIGEgd29ya2Fyb3VuZCBmb3IgaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NDA3MTcyXG5cdCAgICAgIHJldHVybiBwZW5kaW5nTG9jYXRpb24gfHwgbG9jYXRpb24uaHJlZi5yZXBsYWNlKC8lMjcvZyxcIidcIik7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5hbWUgJGJyb3dzZXIjc3RhdGVcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFRoaXMgbWV0aG9kIGlzIGEgZ2V0dGVyLlxuXHQgICAqXG5cdCAgICogUmV0dXJuIGhpc3Rvcnkuc3RhdGUgb3IgbnVsbCBpZiBoaXN0b3J5LnN0YXRlIGlzIHVuZGVmaW5lZC5cblx0ICAgKlxuXHQgICAqIEByZXR1cm5zIHtvYmplY3R9IHN0YXRlXG5cdCAgICovXG5cdCAgc2VsZi5zdGF0ZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgcmV0dXJuIGNhY2hlZFN0YXRlO1xuXHQgIH07XG5cdFxuXHQgIHZhciB1cmxDaGFuZ2VMaXN0ZW5lcnMgPSBbXSxcblx0ICAgICAgdXJsQ2hhbmdlSW5pdCA9IGZhbHNlO1xuXHRcblx0ICBmdW5jdGlvbiBjYWNoZVN0YXRlQW5kRmlyZVVybENoYW5nZSgpIHtcblx0ICAgIHBlbmRpbmdMb2NhdGlvbiA9IG51bGw7XG5cdCAgICBjYWNoZVN0YXRlKCk7XG5cdCAgICBmaXJlVXJsQ2hhbmdlKCk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBnZXRDdXJyZW50U3RhdGUoKSB7XG5cdCAgICB0cnkge1xuXHQgICAgICByZXR1cm4gaGlzdG9yeS5zdGF0ZTtcblx0ICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgLy8gTVNJRSBjYW4gcmVwb3J0ZWRseSB0aHJvdyB3aGVuIHRoZXJlIGlzIG5vIHN0YXRlIChVTkNPTkZJUk1FRCkuXG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICAvLyBUaGlzIHZhcmlhYmxlIHNob3VsZCBiZSB1c2VkICpvbmx5KiBpbnNpZGUgdGhlIGNhY2hlU3RhdGUgZnVuY3Rpb24uXG5cdCAgdmFyIGxhc3RDYWNoZWRTdGF0ZSA9IG51bGw7XG5cdCAgZnVuY3Rpb24gY2FjaGVTdGF0ZSgpIHtcblx0ICAgIC8vIFRoaXMgc2hvdWxkIGJlIHRoZSBvbmx5IHBsYWNlIGluICRicm93c2VyIHdoZXJlIGBoaXN0b3J5LnN0YXRlYCBpcyByZWFkLlxuXHQgICAgY2FjaGVkU3RhdGUgPSBnZXRDdXJyZW50U3RhdGUoKTtcblx0ICAgIGNhY2hlZFN0YXRlID0gaXNVbmRlZmluZWQoY2FjaGVkU3RhdGUpID8gbnVsbCA6IGNhY2hlZFN0YXRlO1xuXHRcblx0ICAgIC8vIFByZXZlbnQgY2FsbGJhY2tzIGZvIGZpcmUgdHdpY2UgaWYgYm90aCBoYXNoY2hhbmdlICYgcG9wc3RhdGUgd2VyZSBmaXJlZC5cblx0ICAgIGlmIChlcXVhbHMoY2FjaGVkU3RhdGUsIGxhc3RDYWNoZWRTdGF0ZSkpIHtcblx0ICAgICAgY2FjaGVkU3RhdGUgPSBsYXN0Q2FjaGVkU3RhdGU7XG5cdCAgICB9XG5cdCAgICBsYXN0Q2FjaGVkU3RhdGUgPSBjYWNoZWRTdGF0ZTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGZpcmVVcmxDaGFuZ2UoKSB7XG5cdCAgICBpZiAobGFzdEJyb3dzZXJVcmwgPT09IHNlbGYudXJsKCkgJiYgbGFzdEhpc3RvcnlTdGF0ZSA9PT0gY2FjaGVkU3RhdGUpIHtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHRcblx0ICAgIGxhc3RCcm93c2VyVXJsID0gc2VsZi51cmwoKTtcblx0ICAgIGxhc3RIaXN0b3J5U3RhdGUgPSBjYWNoZWRTdGF0ZTtcblx0ICAgIGZvckVhY2godXJsQ2hhbmdlTGlzdGVuZXJzLCBmdW5jdGlvbihsaXN0ZW5lcikge1xuXHQgICAgICBsaXN0ZW5lcihzZWxmLnVybCgpLCBjYWNoZWRTdGF0ZSk7XG5cdCAgICB9KTtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuYW1lICRicm93c2VyI29uVXJsQ2hhbmdlXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBSZWdpc3RlciBjYWxsYmFjayBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkLCB3aGVuIHVybCBjaGFuZ2VzLlxuXHQgICAqXG5cdCAgICogSXQncyBvbmx5IGNhbGxlZCB3aGVuIHRoZSB1cmwgaXMgY2hhbmdlZCBmcm9tIG91dHNpZGUgb2YgYW5ndWxhcjpcblx0ICAgKiAtIHVzZXIgdHlwZXMgZGlmZmVyZW50IHVybCBpbnRvIGFkZHJlc3MgYmFyXG5cdCAgICogLSB1c2VyIGNsaWNrcyBvbiBoaXN0b3J5IChmb3J3YXJkL2JhY2spIGJ1dHRvblxuXHQgICAqIC0gdXNlciBjbGlja3Mgb24gYSBsaW5rXG5cdCAgICpcblx0ICAgKiBJdCdzIG5vdCBjYWxsZWQgd2hlbiB1cmwgaXMgY2hhbmdlZCBieSAkYnJvd3Nlci51cmwoKSBtZXRob2Rcblx0ICAgKlxuXHQgICAqIFRoZSBsaXN0ZW5lciBnZXRzIGNhbGxlZCB3aXRoIG5ldyB1cmwgYXMgcGFyYW1ldGVyLlxuXHQgICAqXG5cdCAgICogTk9URTogdGhpcyBhcGkgaXMgaW50ZW5kZWQgZm9yIHVzZSBvbmx5IGJ5IHRoZSAkbG9jYXRpb24gc2VydmljZS4gUGxlYXNlIHVzZSB0aGVcblx0ICAgKiB7QGxpbmsgbmcuJGxvY2F0aW9uICRsb2NhdGlvbiBzZXJ2aWNlfSB0byBtb25pdG9yIHVybCBjaGFuZ2VzIGluIGFuZ3VsYXIgYXBwcy5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nKX0gbGlzdGVuZXIgTGlzdGVuZXIgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIHdoZW4gdXJsIGNoYW5nZXMuXG5cdCAgICogQHJldHVybiB7ZnVuY3Rpb24oc3RyaW5nKX0gUmV0dXJucyB0aGUgcmVnaXN0ZXJlZCBsaXN0ZW5lciBmbiAtIGhhbmR5IGlmIHRoZSBmbiBpcyBhbm9ueW1vdXMuXG5cdCAgICovXG5cdCAgc2VsZi5vblVybENoYW5nZSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG5cdCAgICAvLyBUT0RPKHZvanRhKTogcmVmYWN0b3IgdG8gdXNlIG5vZGUncyBzeW50YXggZm9yIGV2ZW50c1xuXHQgICAgaWYgKCF1cmxDaGFuZ2VJbml0KSB7XG5cdCAgICAgIC8vIFdlIGxpc3RlbiBvbiBib3RoIChoYXNoY2hhbmdlL3BvcHN0YXRlKSB3aGVuIGF2YWlsYWJsZSwgYXMgc29tZSBicm93c2VycyAoZS5nLiBPcGVyYSlcblx0ICAgICAgLy8gZG9uJ3QgZmlyZSBwb3BzdGF0ZSB3aGVuIHVzZXIgY2hhbmdlIHRoZSBhZGRyZXNzIGJhciBhbmQgZG9uJ3QgZmlyZSBoYXNoY2hhbmdlIHdoZW4gdXJsXG5cdCAgICAgIC8vIGNoYW5nZWQgYnkgcHVzaC9yZXBsYWNlU3RhdGVcblx0XG5cdCAgICAgIC8vIGh0bWw1IGhpc3RvcnkgYXBpIC0gcG9wc3RhdGUgZXZlbnRcblx0ICAgICAgaWYgKCRzbmlmZmVyLmhpc3RvcnkpIGpxTGl0ZSh3aW5kb3cpLm9uKCdwb3BzdGF0ZScsIGNhY2hlU3RhdGVBbmRGaXJlVXJsQ2hhbmdlKTtcblx0ICAgICAgLy8gaGFzaGNoYW5nZSBldmVudFxuXHQgICAgICBqcUxpdGUod2luZG93KS5vbignaGFzaGNoYW5nZScsIGNhY2hlU3RhdGVBbmRGaXJlVXJsQ2hhbmdlKTtcblx0XG5cdCAgICAgIHVybENoYW5nZUluaXQgPSB0cnVlO1xuXHQgICAgfVxuXHRcblx0ICAgIHVybENoYW5nZUxpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTtcblx0ICAgIHJldHVybiBjYWxsYmFjaztcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBAcHJpdmF0ZVxuXHQgICAqIFJlbW92ZSBwb3BzdGF0ZSBhbmQgaGFzaGNoYW5nZSBoYW5kbGVyIGZyb20gd2luZG93LlxuXHQgICAqXG5cdCAgICogTk9URTogdGhpcyBhcGkgaXMgaW50ZW5kZWQgZm9yIHVzZSBvbmx5IGJ5ICRyb290U2NvcGUuXG5cdCAgICovXG5cdCAgc2VsZi4kJGFwcGxpY2F0aW9uRGVzdHJveWVkID0gZnVuY3Rpb24oKSB7XG5cdCAgICBqcUxpdGUod2luZG93KS5vZmYoJ2hhc2hjaGFuZ2UgcG9wc3RhdGUnLCBjYWNoZVN0YXRlQW5kRmlyZVVybENoYW5nZSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ2hlY2tzIHdoZXRoZXIgdGhlIHVybCBoYXMgY2hhbmdlZCBvdXRzaWRlIG9mIEFuZ3VsYXIuXG5cdCAgICogTmVlZHMgdG8gYmUgZXhwb3J0ZWQgdG8gYmUgYWJsZSB0byBjaGVjayBmb3IgY2hhbmdlcyB0aGF0IGhhdmUgYmVlbiBkb25lIGluIHN5bmMsXG5cdCAgICogYXMgaGFzaGNoYW5nZS9wb3BzdGF0ZSBldmVudHMgZmlyZSBpbiBhc3luYy5cblx0ICAgKi9cblx0ICBzZWxmLiQkY2hlY2tVcmxDaGFuZ2UgPSBmaXJlVXJsQ2hhbmdlO1xuXHRcblx0ICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHQgIC8vIE1pc2MgQVBJXG5cdCAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdCAgLyoqXG5cdCAgICogQG5hbWUgJGJyb3dzZXIjYmFzZUhyZWZcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFJldHVybnMgY3VycmVudCA8YmFzZSBocmVmPlxuXHQgICAqIChhbHdheXMgcmVsYXRpdmUgLSB3aXRob3V0IGRvbWFpbilcblx0ICAgKlxuXHQgICAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBjdXJyZW50IGJhc2UgaHJlZlxuXHQgICAqL1xuXHQgIHNlbGYuYmFzZUhyZWYgPSBmdW5jdGlvbigpIHtcblx0ICAgIHZhciBocmVmID0gYmFzZUVsZW1lbnQuYXR0cignaHJlZicpO1xuXHQgICAgcmV0dXJuIGhyZWYgPyBocmVmLnJlcGxhY2UoL14oaHR0cHM/XFw6KT9cXC9cXC9bXlxcL10qLywgJycpIDogJyc7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5hbWUgJGJyb3dzZXIjZGVmZXJcblx0ICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGZuIEEgZnVuY3Rpb24sIHdobydzIGV4ZWN1dGlvbiBzaG91bGQgYmUgZGVmZXJyZWQuXG5cdCAgICogQHBhcmFtIHtudW1iZXI9fSBbZGVsYXk9MF0gb2YgbWlsbGlzZWNvbmRzIHRvIGRlZmVyIHRoZSBmdW5jdGlvbiBleGVjdXRpb24uXG5cdCAgICogQHJldHVybnMgeyp9IERlZmVySWQgdGhhdCBjYW4gYmUgdXNlZCB0byBjYW5jZWwgdGhlIHRhc2sgdmlhIGAkYnJvd3Nlci5kZWZlci5jYW5jZWwoKWAuXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBFeGVjdXRlcyBhIGZuIGFzeW5jaHJvbm91c2x5IHZpYSBgc2V0VGltZW91dChmbiwgZGVsYXkpYC5cblx0ICAgKlxuXHQgICAqIFVubGlrZSB3aGVuIGNhbGxpbmcgYHNldFRpbWVvdXRgIGRpcmVjdGx5LCBpbiB0ZXN0IHRoaXMgZnVuY3Rpb24gaXMgbW9ja2VkIGFuZCBpbnN0ZWFkIG9mIHVzaW5nXG5cdCAgICogYHNldFRpbWVvdXRgIGluIHRlc3RzLCB0aGUgZm5zIGFyZSBxdWV1ZWQgaW4gYW4gYXJyYXksIHdoaWNoIGNhbiBiZSBwcm9ncmFtbWF0aWNhbGx5IGZsdXNoZWRcblx0ICAgKiB2aWEgYCRicm93c2VyLmRlZmVyLmZsdXNoKClgLlxuXHQgICAqXG5cdCAgICovXG5cdCAgc2VsZi5kZWZlciA9IGZ1bmN0aW9uKGZuLCBkZWxheSkge1xuXHQgICAgdmFyIHRpbWVvdXRJZDtcblx0ICAgIG91dHN0YW5kaW5nUmVxdWVzdENvdW50Kys7XG5cdCAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICBkZWxldGUgcGVuZGluZ0RlZmVySWRzW3RpbWVvdXRJZF07XG5cdCAgICAgIGNvbXBsZXRlT3V0c3RhbmRpbmdSZXF1ZXN0KGZuKTtcblx0ICAgIH0sIGRlbGF5IHx8IDApO1xuXHQgICAgcGVuZGluZ0RlZmVySWRzW3RpbWVvdXRJZF0gPSB0cnVlO1xuXHQgICAgcmV0dXJuIHRpbWVvdXRJZDtcblx0ICB9O1xuXHRcblx0XG5cdCAgLyoqXG5cdCAgICogQG5hbWUgJGJyb3dzZXIjZGVmZXIuY2FuY2VsXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBDYW5jZWxzIGEgZGVmZXJyZWQgdGFzayBpZGVudGlmaWVkIHdpdGggYGRlZmVySWRgLlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHsqfSBkZWZlcklkIFRva2VuIHJldHVybmVkIGJ5IHRoZSBgJGJyb3dzZXIuZGVmZXJgIGZ1bmN0aW9uLlxuXHQgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgdGFzayBoYXNuJ3QgZXhlY3V0ZWQgeWV0IGFuZCB3YXMgc3VjY2Vzc2Z1bGx5XG5cdCAgICogICAgICAgICAgICAgICAgICAgIGNhbmNlbGVkLlxuXHQgICAqL1xuXHQgIHNlbGYuZGVmZXIuY2FuY2VsID0gZnVuY3Rpb24oZGVmZXJJZCkge1xuXHQgICAgaWYgKHBlbmRpbmdEZWZlcklkc1tkZWZlcklkXSkge1xuXHQgICAgICBkZWxldGUgcGVuZGluZ0RlZmVySWRzW2RlZmVySWRdO1xuXHQgICAgICBjbGVhclRpbWVvdXQoZGVmZXJJZCk7XG5cdCAgICAgIGNvbXBsZXRlT3V0c3RhbmRpbmdSZXF1ZXN0KG5vb3ApO1xuXHQgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBmYWxzZTtcblx0ICB9O1xuXHRcblx0fVxuXHRcblx0ZnVuY3Rpb24gJEJyb3dzZXJQcm92aWRlcigpIHtcblx0ICB0aGlzLiRnZXQgPSBbJyR3aW5kb3cnLCAnJGxvZycsICckc25pZmZlcicsICckZG9jdW1lbnQnLFxuXHQgICAgICBmdW5jdGlvbigkd2luZG93LCAkbG9nLCAkc25pZmZlciwgJGRvY3VtZW50KSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBCcm93c2VyKCR3aW5kb3csICRkb2N1bWVudCwgJGxvZywgJHNuaWZmZXIpO1xuXHQgICAgICB9XTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBzZXJ2aWNlXG5cdCAqIEBuYW1lICRjYWNoZUZhY3Rvcnlcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEZhY3RvcnkgdGhhdCBjb25zdHJ1Y3RzIHtAbGluayAkY2FjaGVGYWN0b3J5LkNhY2hlIENhY2hlfSBvYmplY3RzIGFuZCBnaXZlcyBhY2Nlc3MgdG9cblx0ICogdGhlbS5cblx0ICpcblx0ICogYGBganNcblx0ICpcblx0ICogIHZhciBjYWNoZSA9ICRjYWNoZUZhY3RvcnkoJ2NhY2hlSWQnKTtcblx0ICogIGV4cGVjdCgkY2FjaGVGYWN0b3J5LmdldCgnY2FjaGVJZCcpKS50b0JlKGNhY2hlKTtcblx0ICogIGV4cGVjdCgkY2FjaGVGYWN0b3J5LmdldCgnbm9TdWNoQ2FjaGVJZCcpKS5ub3QudG9CZURlZmluZWQoKTtcblx0ICpcblx0ICogIGNhY2hlLnB1dChcImtleVwiLCBcInZhbHVlXCIpO1xuXHQgKiAgY2FjaGUucHV0KFwiYW5vdGhlciBrZXlcIiwgXCJhbm90aGVyIHZhbHVlXCIpO1xuXHQgKlxuXHQgKiAgLy8gV2UndmUgc3BlY2lmaWVkIG5vIG9wdGlvbnMgb24gY3JlYXRpb25cblx0ICogIGV4cGVjdChjYWNoZS5pbmZvKCkpLnRvRXF1YWwoe2lkOiAnY2FjaGVJZCcsIHNpemU6IDJ9KTtcblx0ICpcblx0ICogYGBgXG5cdCAqXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBjYWNoZUlkIE5hbWUgb3IgaWQgb2YgdGhlIG5ld2x5IGNyZWF0ZWQgY2FjaGUuXG5cdCAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBPcHRpb25zIG9iamVjdCB0aGF0IHNwZWNpZmllcyB0aGUgY2FjaGUgYmVoYXZpb3IuIFByb3BlcnRpZXM6XG5cdCAqXG5cdCAqICAgLSBge251bWJlcj19YCBgY2FwYWNpdHlgIOKAlCB0dXJucyB0aGUgY2FjaGUgaW50byBMUlUgY2FjaGUuXG5cdCAqXG5cdCAqIEByZXR1cm5zIHtvYmplY3R9IE5ld2x5IGNyZWF0ZWQgY2FjaGUgb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBzZXQgb2YgbWV0aG9kczpcblx0ICpcblx0ICogLSBge29iamVjdH1gIGBpbmZvKClgIOKAlCBSZXR1cm5zIGlkLCBzaXplLCBhbmQgb3B0aW9ucyBvZiBjYWNoZS5cblx0ICogLSBge3sqfX1gIGBwdXQoe3N0cmluZ30ga2V5LCB7Kn0gdmFsdWUpYCDigJQgUHV0cyBhIG5ldyBrZXktdmFsdWUgcGFpciBpbnRvIHRoZSBjYWNoZSBhbmQgcmV0dXJuc1xuXHQgKiAgIGl0LlxuXHQgKiAtIGB7eyp9fWAgYGdldCh7c3RyaW5nfSBrZXkpYCDigJQgUmV0dXJucyBjYWNoZWQgdmFsdWUgZm9yIGBrZXlgIG9yIHVuZGVmaW5lZCBmb3IgY2FjaGUgbWlzcy5cblx0ICogLSBge3ZvaWR9YCBgcmVtb3ZlKHtzdHJpbmd9IGtleSlgIOKAlCBSZW1vdmVzIGEga2V5LXZhbHVlIHBhaXIgZnJvbSB0aGUgY2FjaGUuXG5cdCAqIC0gYHt2b2lkfWAgYHJlbW92ZUFsbCgpYCDigJQgUmVtb3ZlcyBhbGwgY2FjaGVkIHZhbHVlcy5cblx0ICogLSBge3ZvaWR9YCBgZGVzdHJveSgpYCDigJQgUmVtb3ZlcyByZWZlcmVuY2VzIHRvIHRoaXMgY2FjaGUgZnJvbSAkY2FjaGVGYWN0b3J5LlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZSBtb2R1bGU9XCJjYWNoZUV4YW1wbGVBcHBcIj5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiQ2FjaGVDb250cm9sbGVyXCI+XG5cdCAgICAgICAgIDxpbnB1dCBuZy1tb2RlbD1cIm5ld0NhY2hlS2V5XCIgcGxhY2Vob2xkZXI9XCJLZXlcIj5cblx0ICAgICAgICAgPGlucHV0IG5nLW1vZGVsPVwibmV3Q2FjaGVWYWx1ZVwiIHBsYWNlaG9sZGVyPVwiVmFsdWVcIj5cblx0ICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cInB1dChuZXdDYWNoZUtleSwgbmV3Q2FjaGVWYWx1ZSlcIj5DYWNoZTwvYnV0dG9uPlxuXHRcblx0ICAgICAgICAgPHAgbmctaWY9XCJrZXlzLmxlbmd0aFwiPkNhY2hlZCBWYWx1ZXM8L3A+XG5cdCAgICAgICAgIDxkaXYgbmctcmVwZWF0PVwia2V5IGluIGtleXNcIj5cblx0ICAgICAgICAgICA8c3BhbiBuZy1iaW5kPVwia2V5XCI+PC9zcGFuPlxuXHQgICAgICAgICAgIDxzcGFuPjogPC9zcGFuPlxuXHQgICAgICAgICAgIDxiIG5nLWJpbmQ9XCJjYWNoZS5nZXQoa2V5KVwiPjwvYj5cblx0ICAgICAgICAgPC9kaXY+XG5cdFxuXHQgICAgICAgICA8cD5DYWNoZSBJbmZvPC9wPlxuXHQgICAgICAgICA8ZGl2IG5nLXJlcGVhdD1cIihrZXksIHZhbHVlKSBpbiBjYWNoZS5pbmZvKClcIj5cblx0ICAgICAgICAgICA8c3BhbiBuZy1iaW5kPVwia2V5XCI+PC9zcGFuPlxuXHQgICAgICAgICAgIDxzcGFuPjogPC9zcGFuPlxuXHQgICAgICAgICAgIDxiIG5nLWJpbmQ9XCJ2YWx1ZVwiPjwvYj5cblx0ICAgICAgICAgPC9kaXY+XG5cdCAgICAgICA8L2Rpdj5cblx0ICAgICA8L2ZpbGU+XG5cdCAgICAgPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuXHQgICAgICAgYW5ndWxhci5tb2R1bGUoJ2NhY2hlRXhhbXBsZUFwcCcsIFtdKS5cblx0ICAgICAgICAgY29udHJvbGxlcignQ2FjaGVDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGNhY2hlRmFjdG9yeScsIGZ1bmN0aW9uKCRzY29wZSwgJGNhY2hlRmFjdG9yeSkge1xuXHQgICAgICAgICAgICRzY29wZS5rZXlzID0gW107XG5cdCAgICAgICAgICAgJHNjb3BlLmNhY2hlID0gJGNhY2hlRmFjdG9yeSgnY2FjaGVJZCcpO1xuXHQgICAgICAgICAgICRzY29wZS5wdXQgPSBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG5cdCAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZCgkc2NvcGUuY2FjaGUuZ2V0KGtleSkpKSB7XG5cdCAgICAgICAgICAgICAgICRzY29wZS5rZXlzLnB1c2goa2V5KTtcblx0ICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICRzY29wZS5jYWNoZS5wdXQoa2V5LCBhbmd1bGFyLmlzVW5kZWZpbmVkKHZhbHVlKSA/IG51bGwgOiB2YWx1ZSk7XG5cdCAgICAgICAgICAgfTtcblx0ICAgICAgICAgfV0pO1xuXHQgICAgIDwvZmlsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwic3R5bGUuY3NzXCI+XG5cdCAgICAgICBwIHtcblx0ICAgICAgICAgbWFyZ2luOiAxMHB4IDAgM3B4O1xuXHQgICAgICAgfVxuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKi9cblx0ZnVuY3Rpb24gJENhY2hlRmFjdG9yeVByb3ZpZGVyKCkge1xuXHRcblx0ICB0aGlzLiRnZXQgPSBmdW5jdGlvbigpIHtcblx0ICAgIHZhciBjYWNoZXMgPSB7fTtcblx0XG5cdCAgICBmdW5jdGlvbiBjYWNoZUZhY3RvcnkoY2FjaGVJZCwgb3B0aW9ucykge1xuXHQgICAgICBpZiAoY2FjaGVJZCBpbiBjYWNoZXMpIHtcblx0ICAgICAgICB0aHJvdyBtaW5FcnIoJyRjYWNoZUZhY3RvcnknKSgnaWlkJywgXCJDYWNoZUlkICd7MH0nIGlzIGFscmVhZHkgdGFrZW4hXCIsIGNhY2hlSWQpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICB2YXIgc2l6ZSA9IDAsXG5cdCAgICAgICAgICBzdGF0cyA9IGV4dGVuZCh7fSwgb3B0aW9ucywge2lkOiBjYWNoZUlkfSksXG5cdCAgICAgICAgICBkYXRhID0gY3JlYXRlTWFwKCksXG5cdCAgICAgICAgICBjYXBhY2l0eSA9IChvcHRpb25zICYmIG9wdGlvbnMuY2FwYWNpdHkpIHx8IE51bWJlci5NQVhfVkFMVUUsXG5cdCAgICAgICAgICBscnVIYXNoID0gY3JlYXRlTWFwKCksXG5cdCAgICAgICAgICBmcmVzaEVuZCA9IG51bGwsXG5cdCAgICAgICAgICBzdGFsZUVuZCA9IG51bGw7XG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQG5nZG9jIHR5cGVcblx0ICAgICAgICogQG5hbWUgJGNhY2hlRmFjdG9yeS5DYWNoZVxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICogQSBjYWNoZSBvYmplY3QgdXNlZCB0byBzdG9yZSBhbmQgcmV0cmlldmUgZGF0YSwgcHJpbWFyaWx5IHVzZWQgYnlcblx0ICAgICAgICoge0BsaW5rICRodHRwICRodHRwfSBhbmQgdGhlIHtAbGluayBuZy5kaXJlY3RpdmU6c2NyaXB0IHNjcmlwdH0gZGlyZWN0aXZlIHRvIGNhY2hlXG5cdCAgICAgICAqIHRlbXBsYXRlcyBhbmQgb3RoZXIgZGF0YS5cblx0ICAgICAgICpcblx0ICAgICAgICogYGBganNcblx0ICAgICAgICogIGFuZ3VsYXIubW9kdWxlKCdzdXBlckNhY2hlJylcblx0ICAgICAgICogICAgLmZhY3RvcnkoJ3N1cGVyQ2FjaGUnLCBbJyRjYWNoZUZhY3RvcnknLCBmdW5jdGlvbigkY2FjaGVGYWN0b3J5KSB7XG5cdCAgICAgICAqICAgICAgcmV0dXJuICRjYWNoZUZhY3RvcnkoJ3N1cGVyLWNhY2hlJyk7XG5cdCAgICAgICAqICAgIH1dKTtcblx0ICAgICAgICogYGBgXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEV4YW1wbGUgdGVzdDpcblx0ICAgICAgICpcblx0ICAgICAgICogYGBganNcblx0ICAgICAgICogIGl0KCdzaG91bGQgYmVoYXZlIGxpa2UgYSBjYWNoZScsIGluamVjdChmdW5jdGlvbihzdXBlckNhY2hlKSB7XG5cdCAgICAgICAqICAgIHN1cGVyQ2FjaGUucHV0KCdrZXknLCAndmFsdWUnKTtcblx0ICAgICAgICogICAgc3VwZXJDYWNoZS5wdXQoJ2Fub3RoZXIga2V5JywgJ2Fub3RoZXIgdmFsdWUnKTtcblx0ICAgICAgICpcblx0ICAgICAgICogICAgZXhwZWN0KHN1cGVyQ2FjaGUuaW5mbygpKS50b0VxdWFsKHtcblx0ICAgICAgICogICAgICBpZDogJ3N1cGVyLWNhY2hlJyxcblx0ICAgICAgICogICAgICBzaXplOiAyXG5cdCAgICAgICAqICAgIH0pO1xuXHQgICAgICAgKlxuXHQgICAgICAgKiAgICBzdXBlckNhY2hlLnJlbW92ZSgnYW5vdGhlciBrZXknKTtcblx0ICAgICAgICogICAgZXhwZWN0KHN1cGVyQ2FjaGUuZ2V0KCdhbm90aGVyIGtleScpKS50b0JlVW5kZWZpbmVkKCk7XG5cdCAgICAgICAqXG5cdCAgICAgICAqICAgIHN1cGVyQ2FjaGUucmVtb3ZlQWxsKCk7XG5cdCAgICAgICAqICAgIGV4cGVjdChzdXBlckNhY2hlLmluZm8oKSkudG9FcXVhbCh7XG5cdCAgICAgICAqICAgICAgaWQ6ICdzdXBlci1jYWNoZScsXG5cdCAgICAgICAqICAgICAgc2l6ZTogMFxuXHQgICAgICAgKiAgICB9KTtcblx0ICAgICAgICogIH0pKTtcblx0ICAgICAgICogYGBgXG5cdCAgICAgICAqL1xuXHQgICAgICByZXR1cm4gY2FjaGVzW2NhY2hlSWRdID0ge1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAgICogQG5hbWUgJGNhY2hlRmFjdG9yeS5DYWNoZSNwdXRcblx0ICAgICAgICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAgICogSW5zZXJ0cyBhIG5hbWVkIGVudHJ5IGludG8gdGhlIHtAbGluayAkY2FjaGVGYWN0b3J5LkNhY2hlIENhY2hlfSBvYmplY3QgdG8gYmVcblx0ICAgICAgICAgKiByZXRyaWV2ZWQgbGF0ZXIsIGFuZCBpbmNyZW1lbnRpbmcgdGhlIHNpemUgb2YgdGhlIGNhY2hlIGlmIHRoZSBrZXkgd2FzIG5vdCBhbHJlYWR5XG5cdCAgICAgICAgICogcHJlc2VudCBpbiB0aGUgY2FjaGUuIElmIGJlaGF2aW5nIGxpa2UgYW4gTFJVIGNhY2hlLCBpdCB3aWxsIGFsc28gcmVtb3ZlIHN0YWxlXG5cdCAgICAgICAgICogZW50cmllcyBmcm9tIHRoZSBzZXQuXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBJdCB3aWxsIG5vdCBpbnNlcnQgdW5kZWZpbmVkIHZhbHVlcyBpbnRvIHRoZSBjYWNoZS5cblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgdGhlIGtleSB1bmRlciB3aGljaCB0aGUgY2FjaGVkIGRhdGEgaXMgc3RvcmVkLlxuXHQgICAgICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgdGhlIHZhbHVlIHRvIHN0b3JlIGFsb25nc2lkZSB0aGUga2V5LiBJZiBpdCBpcyB1bmRlZmluZWQsIHRoZSBrZXlcblx0ICAgICAgICAgKiAgICB3aWxsIG5vdCBiZSBzdG9yZWQuXG5cdCAgICAgICAgICogQHJldHVybnMgeyp9IHRoZSB2YWx1ZSBzdG9yZWQuXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgcHV0OiBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG5cdCAgICAgICAgICBpZiAoaXNVbmRlZmluZWQodmFsdWUpKSByZXR1cm47XG5cdCAgICAgICAgICBpZiAoY2FwYWNpdHkgPCBOdW1iZXIuTUFYX1ZBTFVFKSB7XG5cdCAgICAgICAgICAgIHZhciBscnVFbnRyeSA9IGxydUhhc2hba2V5XSB8fCAobHJ1SGFzaFtrZXldID0ge2tleToga2V5fSk7XG5cdFxuXHQgICAgICAgICAgICByZWZyZXNoKGxydUVudHJ5KTtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICBpZiAoIShrZXkgaW4gZGF0YSkpIHNpemUrKztcblx0ICAgICAgICAgIGRhdGFba2V5XSA9IHZhbHVlO1xuXHRcblx0ICAgICAgICAgIGlmIChzaXplID4gY2FwYWNpdHkpIHtcblx0ICAgICAgICAgICAgdGhpcy5yZW1vdmUoc3RhbGVFbmQua2V5KTtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICByZXR1cm4gdmFsdWU7XG5cdCAgICAgICAgfSxcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgICAqIEBuYW1lICRjYWNoZUZhY3RvcnkuQ2FjaGUjZ2V0XG5cdCAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgICAqIFJldHJpZXZlcyBuYW1lZCBkYXRhIHN0b3JlZCBpbiB0aGUge0BsaW5rICRjYWNoZUZhY3RvcnkuQ2FjaGUgQ2FjaGV9IG9iamVjdC5cblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgdGhlIGtleSBvZiB0aGUgZGF0YSB0byBiZSByZXRyaWV2ZWRcblx0ICAgICAgICAgKiBAcmV0dXJucyB7Kn0gdGhlIHZhbHVlIHN0b3JlZC5cblx0ICAgICAgICAgKi9cblx0ICAgICAgICBnZXQ6IGZ1bmN0aW9uKGtleSkge1xuXHQgICAgICAgICAgaWYgKGNhcGFjaXR5IDwgTnVtYmVyLk1BWF9WQUxVRSkge1xuXHQgICAgICAgICAgICB2YXIgbHJ1RW50cnkgPSBscnVIYXNoW2tleV07XG5cdFxuXHQgICAgICAgICAgICBpZiAoIWxydUVudHJ5KSByZXR1cm47XG5cdFxuXHQgICAgICAgICAgICByZWZyZXNoKGxydUVudHJ5KTtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICByZXR1cm4gZGF0YVtrZXldO1xuXHQgICAgICAgIH0sXG5cdFxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAgICogQG5hbWUgJGNhY2hlRmFjdG9yeS5DYWNoZSNyZW1vdmVcblx0ICAgICAgICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAgICogUmVtb3ZlcyBhbiBlbnRyeSBmcm9tIHRoZSB7QGxpbmsgJGNhY2hlRmFjdG9yeS5DYWNoZSBDYWNoZX0gb2JqZWN0LlxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSB0aGUga2V5IG9mIHRoZSBlbnRyeSB0byBiZSByZW1vdmVkXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbihrZXkpIHtcblx0ICAgICAgICAgIGlmIChjYXBhY2l0eSA8IE51bWJlci5NQVhfVkFMVUUpIHtcblx0ICAgICAgICAgICAgdmFyIGxydUVudHJ5ID0gbHJ1SGFzaFtrZXldO1xuXHRcblx0ICAgICAgICAgICAgaWYgKCFscnVFbnRyeSkgcmV0dXJuO1xuXHRcblx0ICAgICAgICAgICAgaWYgKGxydUVudHJ5ID09IGZyZXNoRW5kKSBmcmVzaEVuZCA9IGxydUVudHJ5LnA7XG5cdCAgICAgICAgICAgIGlmIChscnVFbnRyeSA9PSBzdGFsZUVuZCkgc3RhbGVFbmQgPSBscnVFbnRyeS5uO1xuXHQgICAgICAgICAgICBsaW5rKGxydUVudHJ5Lm4sbHJ1RW50cnkucCk7XG5cdFxuXHQgICAgICAgICAgICBkZWxldGUgbHJ1SGFzaFtrZXldO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIGlmICghKGtleSBpbiBkYXRhKSkgcmV0dXJuO1xuXHRcblx0ICAgICAgICAgIGRlbGV0ZSBkYXRhW2tleV07XG5cdCAgICAgICAgICBzaXplLS07XG5cdCAgICAgICAgfSxcblx0XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICAgKiBAbmFtZSAkY2FjaGVGYWN0b3J5LkNhY2hlI3JlbW92ZUFsbFxuXHQgICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICAgKiBDbGVhcnMgdGhlIGNhY2hlIG9iamVjdCBvZiBhbnkgZW50cmllcy5cblx0ICAgICAgICAgKi9cblx0ICAgICAgICByZW1vdmVBbGw6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgZGF0YSA9IGNyZWF0ZU1hcCgpO1xuXHQgICAgICAgICAgc2l6ZSA9IDA7XG5cdCAgICAgICAgICBscnVIYXNoID0gY3JlYXRlTWFwKCk7XG5cdCAgICAgICAgICBmcmVzaEVuZCA9IHN0YWxlRW5kID0gbnVsbDtcblx0ICAgICAgICB9LFxuXHRcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgICAqIEBuYW1lICRjYWNoZUZhY3RvcnkuQ2FjaGUjZGVzdHJveVxuXHQgICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICAgKiBEZXN0cm95cyB0aGUge0BsaW5rICRjYWNoZUZhY3RvcnkuQ2FjaGUgQ2FjaGV9IG9iamVjdCBlbnRpcmVseSxcblx0ICAgICAgICAgKiByZW1vdmluZyBpdCBmcm9tIHRoZSB7QGxpbmsgJGNhY2hlRmFjdG9yeSAkY2FjaGVGYWN0b3J5fSBzZXQuXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBkYXRhID0gbnVsbDtcblx0ICAgICAgICAgIHN0YXRzID0gbnVsbDtcblx0ICAgICAgICAgIGxydUhhc2ggPSBudWxsO1xuXHQgICAgICAgICAgZGVsZXRlIGNhY2hlc1tjYWNoZUlkXTtcblx0ICAgICAgICB9LFxuXHRcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgICAqIEBuYW1lICRjYWNoZUZhY3RvcnkuQ2FjaGUjaW5mb1xuXHQgICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICAgKiBSZXRyaWV2ZSBpbmZvcm1hdGlvbiByZWdhcmRpbmcgYSBwYXJ0aWN1bGFyIHtAbGluayAkY2FjaGVGYWN0b3J5LkNhY2hlIENhY2hlfS5cblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEByZXR1cm5zIHtvYmplY3R9IGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcblx0ICAgICAgICAgKiAgIDx1bD5cblx0ICAgICAgICAgKiAgICAgPGxpPioqaWQqKjogdGhlIGlkIG9mIHRoZSBjYWNoZSBpbnN0YW5jZTwvbGk+XG5cdCAgICAgICAgICogICAgIDxsaT4qKnNpemUqKjogdGhlIG51bWJlciBvZiBlbnRyaWVzIGtlcHQgaW4gdGhlIGNhY2hlIGluc3RhbmNlPC9saT5cblx0ICAgICAgICAgKiAgICAgPGxpPioqLi4uKio6IGFueSBhZGRpdGlvbmFsIHByb3BlcnRpZXMgZnJvbSB0aGUgb3B0aW9ucyBvYmplY3Qgd2hlbiBjcmVhdGluZyB0aGVcblx0ICAgICAgICAgKiAgICAgICBjYWNoZS48L2xpPlxuXHQgICAgICAgICAqICAgPC91bD5cblx0ICAgICAgICAgKi9cblx0ICAgICAgICBpbmZvOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHJldHVybiBleHRlbmQoe30sIHN0YXRzLCB7c2l6ZTogc2l6ZX0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0XG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogbWFrZXMgdGhlIGBlbnRyeWAgdGhlIGZyZXNoRW5kIG9mIHRoZSBMUlUgbGlua2VkIGxpc3Rcblx0ICAgICAgICovXG5cdCAgICAgIGZ1bmN0aW9uIHJlZnJlc2goZW50cnkpIHtcblx0ICAgICAgICBpZiAoZW50cnkgIT0gZnJlc2hFbmQpIHtcblx0ICAgICAgICAgIGlmICghc3RhbGVFbmQpIHtcblx0ICAgICAgICAgICAgc3RhbGVFbmQgPSBlbnRyeTtcblx0ICAgICAgICAgIH0gZWxzZSBpZiAoc3RhbGVFbmQgPT0gZW50cnkpIHtcblx0ICAgICAgICAgICAgc3RhbGVFbmQgPSBlbnRyeS5uO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIGxpbmsoZW50cnkubiwgZW50cnkucCk7XG5cdCAgICAgICAgICBsaW5rKGVudHJ5LCBmcmVzaEVuZCk7XG5cdCAgICAgICAgICBmcmVzaEVuZCA9IGVudHJ5O1xuXHQgICAgICAgICAgZnJlc2hFbmQubiA9IG51bGw7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIGJpZGlyZWN0aW9uYWxseSBsaW5rcyB0d28gZW50cmllcyBvZiB0aGUgTFJVIGxpbmtlZCBsaXN0XG5cdCAgICAgICAqL1xuXHQgICAgICBmdW5jdGlvbiBsaW5rKG5leHRFbnRyeSwgcHJldkVudHJ5KSB7XG5cdCAgICAgICAgaWYgKG5leHRFbnRyeSAhPSBwcmV2RW50cnkpIHtcblx0ICAgICAgICAgIGlmIChuZXh0RW50cnkpIG5leHRFbnRyeS5wID0gcHJldkVudHJ5OyAvL3Agc3RhbmRzIGZvciBwcmV2aW91cywgJ3ByZXYnIGRpZG4ndCBtaW5pZnlcblx0ICAgICAgICAgIGlmIChwcmV2RW50cnkpIHByZXZFbnRyeS5uID0gbmV4dEVudHJ5OyAvL24gc3RhbmRzIGZvciBuZXh0LCAnbmV4dCcgZGlkbid0IG1pbmlmeVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRjYWNoZUZhY3RvcnkjaW5mb1xuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogR2V0IGluZm9ybWF0aW9uIGFib3V0IGFsbCB0aGUgY2FjaGVzIHRoYXQgaGF2ZSBiZWVuIGNyZWF0ZWRcblx0ICAgKlxuXHQgICAqIEByZXR1cm5zIHtPYmplY3R9IC0ga2V5LXZhbHVlIG1hcCBvZiBgY2FjaGVJZGAgdG8gdGhlIHJlc3VsdCBvZiBjYWxsaW5nIGBjYWNoZSNpbmZvYFxuXHQgICAqL1xuXHQgICAgY2FjaGVGYWN0b3J5LmluZm8gPSBmdW5jdGlvbigpIHtcblx0ICAgICAgdmFyIGluZm8gPSB7fTtcblx0ICAgICAgZm9yRWFjaChjYWNoZXMsIGZ1bmN0aW9uKGNhY2hlLCBjYWNoZUlkKSB7XG5cdCAgICAgICAgaW5mb1tjYWNoZUlkXSA9IGNhY2hlLmluZm8oKTtcblx0ICAgICAgfSk7XG5cdCAgICAgIHJldHVybiBpbmZvO1xuXHQgICAgfTtcblx0XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkY2FjaGVGYWN0b3J5I2dldFxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogR2V0IGFjY2VzcyB0byBhIGNhY2hlIG9iamVjdCBieSB0aGUgYGNhY2hlSWRgIHVzZWQgd2hlbiBpdCB3YXMgY3JlYXRlZC5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSBjYWNoZUlkIE5hbWUgb3IgaWQgb2YgYSBjYWNoZSB0byBhY2Nlc3MuXG5cdCAgICogQHJldHVybnMge29iamVjdH0gQ2FjaGUgb2JqZWN0IGlkZW50aWZpZWQgYnkgdGhlIGNhY2hlSWQgb3IgdW5kZWZpbmVkIGlmIG5vIHN1Y2ggY2FjaGUuXG5cdCAgICovXG5cdCAgICBjYWNoZUZhY3RvcnkuZ2V0ID0gZnVuY3Rpb24oY2FjaGVJZCkge1xuXHQgICAgICByZXR1cm4gY2FjaGVzW2NhY2hlSWRdO1xuXHQgICAgfTtcblx0XG5cdFxuXHQgICAgcmV0dXJuIGNhY2hlRmFjdG9yeTtcblx0ICB9O1xuXHR9XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHNlcnZpY2Vcblx0ICogQG5hbWUgJHRlbXBsYXRlQ2FjaGVcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFRoZSBmaXJzdCB0aW1lIGEgdGVtcGxhdGUgaXMgdXNlZCwgaXQgaXMgbG9hZGVkIGluIHRoZSB0ZW1wbGF0ZSBjYWNoZSBmb3IgcXVpY2sgcmV0cmlldmFsLiBZb3Vcblx0ICogY2FuIGxvYWQgdGVtcGxhdGVzIGRpcmVjdGx5IGludG8gdGhlIGNhY2hlIGluIGEgYHNjcmlwdGAgdGFnLCBvciBieSBjb25zdW1pbmcgdGhlXG5cdCAqIGAkdGVtcGxhdGVDYWNoZWAgc2VydmljZSBkaXJlY3RseS5cblx0ICpcblx0ICogQWRkaW5nIHZpYSB0aGUgYHNjcmlwdGAgdGFnOlxuXHQgKlxuXHQgKiBgYGBodG1sXG5cdCAqICAgPHNjcmlwdCB0eXBlPVwidGV4dC9uZy10ZW1wbGF0ZVwiIGlkPVwidGVtcGxhdGVJZC5odG1sXCI+XG5cdCAqICAgICA8cD5UaGlzIGlzIHRoZSBjb250ZW50IG9mIHRoZSB0ZW1wbGF0ZTwvcD5cblx0ICogICA8L3NjcmlwdD5cblx0ICogYGBgXG5cdCAqXG5cdCAqICoqTm90ZToqKiB0aGUgYHNjcmlwdGAgdGFnIGNvbnRhaW5pbmcgdGhlIHRlbXBsYXRlIGRvZXMgbm90IG5lZWQgdG8gYmUgaW5jbHVkZWQgaW4gdGhlIGBoZWFkYCBvZlxuXHQgKiB0aGUgZG9jdW1lbnQsIGJ1dCBpdCBtdXN0IGJlIGEgZGVzY2VuZGVudCBvZiB0aGUge0BsaW5rIG5nLiRyb290RWxlbWVudCAkcm9vdEVsZW1lbnR9IChJRSxcblx0ICogZWxlbWVudCB3aXRoIG5nLWFwcCBhdHRyaWJ1dGUpLCBvdGhlcndpc2UgdGhlIHRlbXBsYXRlIHdpbGwgYmUgaWdub3JlZC5cblx0ICpcblx0ICogQWRkaW5nIHZpYSB0aGUgYCR0ZW1wbGF0ZUNhY2hlYCBzZXJ2aWNlOlxuXHQgKlxuXHQgKiBgYGBqc1xuXHQgKiB2YXIgbXlBcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnLCBbXSk7XG5cdCAqIG15QXBwLnJ1bihmdW5jdGlvbigkdGVtcGxhdGVDYWNoZSkge1xuXHQgKiAgICR0ZW1wbGF0ZUNhY2hlLnB1dCgndGVtcGxhdGVJZC5odG1sJywgJ1RoaXMgaXMgdGhlIGNvbnRlbnQgb2YgdGhlIHRlbXBsYXRlJyk7XG5cdCAqIH0pO1xuXHQgKiBgYGBcblx0ICpcblx0ICogVG8gcmV0cmlldmUgdGhlIHRlbXBsYXRlIGxhdGVyLCBzaW1wbHkgdXNlIGl0IGluIHlvdXIgSFRNTDpcblx0ICogYGBgaHRtbFxuXHQgKiA8ZGl2IG5nLWluY2x1ZGU9XCIgJ3RlbXBsYXRlSWQuaHRtbCcgXCI+PC9kaXY+XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBvciBnZXQgaXQgdmlhIEphdmFzY3JpcHQ6XG5cdCAqIGBgYGpzXG5cdCAqICR0ZW1wbGF0ZUNhY2hlLmdldCgndGVtcGxhdGVJZC5odG1sJylcblx0ICogYGBgXG5cdCAqXG5cdCAqIFNlZSB7QGxpbmsgbmcuJGNhY2hlRmFjdG9yeSAkY2FjaGVGYWN0b3J5fS5cblx0ICpcblx0ICovXG5cdGZ1bmN0aW9uICRUZW1wbGF0ZUNhY2hlUHJvdmlkZXIoKSB7XG5cdCAgdGhpcy4kZ2V0ID0gWyckY2FjaGVGYWN0b3J5JywgZnVuY3Rpb24oJGNhY2hlRmFjdG9yeSkge1xuXHQgICAgcmV0dXJuICRjYWNoZUZhY3RvcnkoJ3RlbXBsYXRlcycpO1xuXHQgIH1dO1xuXHR9XG5cdFxuXHQvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqXG5cdCAqICAgICBBbnkgY29tbWl0cyB0byB0aGlzIGZpbGUgc2hvdWxkIGJlIHJldmlld2VkIHdpdGggc2VjdXJpdHkgaW4gbWluZC4gICpcblx0ICogICBDaGFuZ2VzIHRvIHRoaXMgZmlsZSBjYW4gcG90ZW50aWFsbHkgY3JlYXRlIHNlY3VyaXR5IHZ1bG5lcmFiaWxpdGllcy4gKlxuXHQgKiAgICAgICAgICBBbiBhcHByb3ZhbCBmcm9tIDIgQ29yZSBtZW1iZXJzIHdpdGggaGlzdG9yeSBvZiBtb2RpZnlpbmcgICAgICAqXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMgZmlsZSBpcyByZXF1aXJlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICpcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuXHQgKiAgRG9lcyB0aGUgY2hhbmdlIHNvbWVob3cgYWxsb3cgZm9yIGFyYml0cmFyeSBqYXZhc2NyaXB0IHRvIGJlIGV4ZWN1dGVkPyAqXG5cdCAqICAgIE9yIGFsbG93cyBmb3Igc29tZW9uZSB0byBjaGFuZ2UgdGhlIHByb3RvdHlwZSBvZiBidWlsdC1pbiBvYmplY3RzPyAgICpcblx0ICogICAgIE9yIGdpdmVzIHVuZGVzaXJlZCBhY2Nlc3MgdG8gdmFyaWFibGVzIGxpa2VzIGRvY3VtZW50IG9yIHdpbmRvdz8gICAgKlxuXHQgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqL1xuXHRcblx0LyogISBWQVJJQUJMRS9GVU5DVElPTiBOQU1JTkcgQ09OVkVOVElPTlMgVEhBVCBBUFBMWSBUTyBUSElTIEZJTEUhXG5cdCAqXG5cdCAqIERPTS1yZWxhdGVkIHZhcmlhYmxlczpcblx0ICpcblx0ICogLSBcIm5vZGVcIiAtIERPTSBOb2RlXG5cdCAqIC0gXCJlbGVtZW50XCIgLSBET00gRWxlbWVudCBvciBOb2RlXG5cdCAqIC0gXCIkbm9kZVwiIG9yIFwiJGVsZW1lbnRcIiAtIGpxTGl0ZS13cmFwcGVkIG5vZGUgb3IgZWxlbWVudFxuXHQgKlxuXHQgKlxuXHQgKiBDb21waWxlciByZWxhdGVkIHN0dWZmOlxuXHQgKlxuXHQgKiAtIFwibGlua0ZuXCIgLSBsaW5raW5nIGZuIG9mIGEgc2luZ2xlIGRpcmVjdGl2ZVxuXHQgKiAtIFwibm9kZUxpbmtGblwiIC0gZnVuY3Rpb24gdGhhdCBhZ2dyZWdhdGVzIGFsbCBsaW5raW5nIGZucyBmb3IgYSBwYXJ0aWN1bGFyIG5vZGVcblx0ICogLSBcImNoaWxkTGlua0ZuXCIgLSAgZnVuY3Rpb24gdGhhdCBhZ2dyZWdhdGVzIGFsbCBsaW5raW5nIGZucyBmb3IgY2hpbGQgbm9kZXMgb2YgYSBwYXJ0aWN1bGFyIG5vZGVcblx0ICogLSBcImNvbXBvc2l0ZUxpbmtGblwiIC0gZnVuY3Rpb24gdGhhdCBhZ2dyZWdhdGVzIGFsbCBsaW5raW5nIGZucyBmb3IgYSBjb21waWxhdGlvbiByb290IChub2RlTGlzdClcblx0ICovXG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBzZXJ2aWNlXG5cdCAqIEBuYW1lICRjb21waWxlXG5cdCAqIEBraW5kIGZ1bmN0aW9uXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBDb21waWxlcyBhbiBIVE1MIHN0cmluZyBvciBET00gaW50byBhIHRlbXBsYXRlIGFuZCBwcm9kdWNlcyBhIHRlbXBsYXRlIGZ1bmN0aW9uLCB3aGljaFxuXHQgKiBjYW4gdGhlbiBiZSB1c2VkIHRvIGxpbmsge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUgYHNjb3BlYH0gYW5kIHRoZSB0ZW1wbGF0ZSB0b2dldGhlci5cblx0ICpcblx0ICogVGhlIGNvbXBpbGF0aW9uIGlzIGEgcHJvY2VzcyBvZiB3YWxraW5nIHRoZSBET00gdHJlZSBhbmQgbWF0Y2hpbmcgRE9NIGVsZW1lbnRzIHRvXG5cdCAqIHtAbGluayBuZy4kY29tcGlsZVByb3ZpZGVyI2RpcmVjdGl2ZSBkaXJlY3RpdmVzfS5cblx0ICpcblx0ICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cblx0ICogKipOb3RlOioqIFRoaXMgZG9jdW1lbnQgaXMgYW4gaW4tZGVwdGggcmVmZXJlbmNlIG9mIGFsbCBkaXJlY3RpdmUgb3B0aW9ucy5cblx0ICogRm9yIGEgZ2VudGxlIGludHJvZHVjdGlvbiB0byBkaXJlY3RpdmVzIHdpdGggZXhhbXBsZXMgb2YgY29tbW9uIHVzZSBjYXNlcyxcblx0ICogc2VlIHRoZSB7QGxpbmsgZ3VpZGUvZGlyZWN0aXZlIGRpcmVjdGl2ZSBndWlkZX0uXG5cdCAqIDwvZGl2PlxuXHQgKlxuXHQgKiAjIyBDb21wcmVoZW5zaXZlIERpcmVjdGl2ZSBBUElcblx0ICpcblx0ICogVGhlcmUgYXJlIG1hbnkgZGlmZmVyZW50IG9wdGlvbnMgZm9yIGEgZGlyZWN0aXZlLlxuXHQgKlxuXHQgKiBUaGUgZGlmZmVyZW5jZSByZXNpZGVzIGluIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGZhY3RvcnkgZnVuY3Rpb24uXG5cdCAqIFlvdSBjYW4gZWl0aGVyIHJldHVybiBhIFwiRGlyZWN0aXZlIERlZmluaXRpb24gT2JqZWN0XCIgKHNlZSBiZWxvdykgdGhhdCBkZWZpbmVzIHRoZSBkaXJlY3RpdmUgcHJvcGVydGllcyxcblx0ICogb3IganVzdCB0aGUgYHBvc3RMaW5rYCBmdW5jdGlvbiAoYWxsIG90aGVyIHByb3BlcnRpZXMgd2lsbCBoYXZlIHRoZSBkZWZhdWx0IHZhbHVlcykuXG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1zdWNjZXNzXCI+XG5cdCAqICoqQmVzdCBQcmFjdGljZToqKiBJdCdzIHJlY29tbWVuZGVkIHRvIHVzZSB0aGUgXCJkaXJlY3RpdmUgZGVmaW5pdGlvbiBvYmplY3RcIiBmb3JtLlxuXHQgKiA8L2Rpdj5cblx0ICpcblx0ICogSGVyZSdzIGFuIGV4YW1wbGUgZGlyZWN0aXZlIGRlY2xhcmVkIHdpdGggYSBEaXJlY3RpdmUgRGVmaW5pdGlvbiBPYmplY3Q6XG5cdCAqXG5cdCAqIGBgYGpzXG5cdCAqICAgdmFyIG15TW9kdWxlID0gYW5ndWxhci5tb2R1bGUoLi4uKTtcblx0ICpcblx0ICogICBteU1vZHVsZS5kaXJlY3RpdmUoJ2RpcmVjdGl2ZU5hbWUnLCBmdW5jdGlvbiBmYWN0b3J5KGluamVjdGFibGVzKSB7XG5cdCAqICAgICB2YXIgZGlyZWN0aXZlRGVmaW5pdGlvbk9iamVjdCA9IHtcblx0ICogICAgICAgcHJpb3JpdHk6IDAsXG5cdCAqICAgICAgIHRlbXBsYXRlOiAnPGRpdj48L2Rpdj4nLCAvLyBvciAvLyBmdW5jdGlvbih0RWxlbWVudCwgdEF0dHJzKSB7IC4uLiB9LFxuXHQgKiAgICAgICAvLyBvclxuXHQgKiAgICAgICAvLyB0ZW1wbGF0ZVVybDogJ2RpcmVjdGl2ZS5odG1sJywgLy8gb3IgLy8gZnVuY3Rpb24odEVsZW1lbnQsIHRBdHRycykgeyAuLi4gfSxcblx0ICogICAgICAgdHJhbnNjbHVkZTogZmFsc2UsXG5cdCAqICAgICAgIHJlc3RyaWN0OiAnQScsXG5cdCAqICAgICAgIHRlbXBsYXRlTmFtZXNwYWNlOiAnaHRtbCcsXG5cdCAqICAgICAgIHNjb3BlOiBmYWxzZSxcblx0ICogICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkdHJhbnNjbHVkZSwgb3RoZXJJbmplY3RhYmxlcykgeyAuLi4gfSxcblx0ICogICAgICAgY29udHJvbGxlckFzOiAnc3RyaW5nSWRlbnRpZmllcicsXG5cdCAqICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IGZhbHNlLFxuXHQgKiAgICAgICByZXF1aXJlOiAnc2libGluZ0RpcmVjdGl2ZU5hbWUnLCAvLyBvciAvLyBbJ15wYXJlbnREaXJlY3RpdmVOYW1lJywgJz9vcHRpb25hbERpcmVjdGl2ZU5hbWUnLCAnP15vcHRpb25hbFBhcmVudCddLFxuXHQgKiAgICAgICBjb21waWxlOiBmdW5jdGlvbiBjb21waWxlKHRFbGVtZW50LCB0QXR0cnMsIHRyYW5zY2x1ZGUpIHtcblx0ICogICAgICAgICByZXR1cm4ge1xuXHQgKiAgICAgICAgICAgcHJlOiBmdW5jdGlvbiBwcmVMaW5rKHNjb3BlLCBpRWxlbWVudCwgaUF0dHJzLCBjb250cm9sbGVyKSB7IC4uLiB9LFxuXHQgKiAgICAgICAgICAgcG9zdDogZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGlFbGVtZW50LCBpQXR0cnMsIGNvbnRyb2xsZXIpIHsgLi4uIH1cblx0ICogICAgICAgICB9XG5cdCAqICAgICAgICAgLy8gb3Jcblx0ICogICAgICAgICAvLyByZXR1cm4gZnVuY3Rpb24gcG9zdExpbmsoIC4uLiApIHsgLi4uIH1cblx0ICogICAgICAgfSxcblx0ICogICAgICAgLy8gb3Jcblx0ICogICAgICAgLy8gbGluazoge1xuXHQgKiAgICAgICAvLyAgcHJlOiBmdW5jdGlvbiBwcmVMaW5rKHNjb3BlLCBpRWxlbWVudCwgaUF0dHJzLCBjb250cm9sbGVyKSB7IC4uLiB9LFxuXHQgKiAgICAgICAvLyAgcG9zdDogZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGlFbGVtZW50LCBpQXR0cnMsIGNvbnRyb2xsZXIpIHsgLi4uIH1cblx0ICogICAgICAgLy8gfVxuXHQgKiAgICAgICAvLyBvclxuXHQgKiAgICAgICAvLyBsaW5rOiBmdW5jdGlvbiBwb3N0TGluayggLi4uICkgeyAuLi4gfVxuXHQgKiAgICAgfTtcblx0ICogICAgIHJldHVybiBkaXJlY3RpdmVEZWZpbml0aW9uT2JqZWN0O1xuXHQgKiAgIH0pO1xuXHQgKiBgYGBcblx0ICpcblx0ICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cblx0ICogKipOb3RlOioqIEFueSB1bnNwZWNpZmllZCBvcHRpb25zIHdpbGwgdXNlIHRoZSBkZWZhdWx0IHZhbHVlLiBZb3UgY2FuIHNlZSB0aGUgZGVmYXVsdCB2YWx1ZXMgYmVsb3cuXG5cdCAqIDwvZGl2PlxuXHQgKlxuXHQgKiBUaGVyZWZvcmUgdGhlIGFib3ZlIGNhbiBiZSBzaW1wbGlmaWVkIGFzOlxuXHQgKlxuXHQgKiBgYGBqc1xuXHQgKiAgIHZhciBteU1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKC4uLik7XG5cdCAqXG5cdCAqICAgbXlNb2R1bGUuZGlyZWN0aXZlKCdkaXJlY3RpdmVOYW1lJywgZnVuY3Rpb24gZmFjdG9yeShpbmplY3RhYmxlcykge1xuXHQgKiAgICAgdmFyIGRpcmVjdGl2ZURlZmluaXRpb25PYmplY3QgPSB7XG5cdCAqICAgICAgIGxpbms6IGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBpRWxlbWVudCwgaUF0dHJzKSB7IC4uLiB9XG5cdCAqICAgICB9O1xuXHQgKiAgICAgcmV0dXJuIGRpcmVjdGl2ZURlZmluaXRpb25PYmplY3Q7XG5cdCAqICAgICAvLyBvclxuXHQgKiAgICAgLy8gcmV0dXJuIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBpRWxlbWVudCwgaUF0dHJzKSB7IC4uLiB9XG5cdCAqICAgfSk7XG5cdCAqIGBgYFxuXHQgKlxuXHQgKlxuXHQgKlxuXHQgKiAjIyMgRGlyZWN0aXZlIERlZmluaXRpb24gT2JqZWN0XG5cdCAqXG5cdCAqIFRoZSBkaXJlY3RpdmUgZGVmaW5pdGlvbiBvYmplY3QgcHJvdmlkZXMgaW5zdHJ1Y3Rpb25zIHRvIHRoZSB7QGxpbmsgbmcuJGNvbXBpbGVcblx0ICogY29tcGlsZXJ9LiBUaGUgYXR0cmlidXRlcyBhcmU6XG5cdCAqXG5cdCAqICMjIyMgYG11bHRpRWxlbWVudGBcblx0ICogV2hlbiB0aGlzIHByb3BlcnR5IGlzIHNldCB0byB0cnVlLCB0aGUgSFRNTCBjb21waWxlciB3aWxsIGNvbGxlY3QgRE9NIG5vZGVzIGJldHdlZW5cblx0ICogbm9kZXMgd2l0aCB0aGUgYXR0cmlidXRlcyBgZGlyZWN0aXZlLW5hbWUtc3RhcnRgIGFuZCBgZGlyZWN0aXZlLW5hbWUtZW5kYCwgYW5kIGdyb3VwIHRoZW1cblx0ICogdG9nZXRoZXIgYXMgdGhlIGRpcmVjdGl2ZSBlbGVtZW50cy4gSXQgaXMgcmVjb21tZW5kZWQgdGhhdCB0aGlzIGZlYXR1cmUgYmUgdXNlZCBvbiBkaXJlY3RpdmVzXG5cdCAqIHdoaWNoIGFyZSBub3Qgc3RyaWN0bHkgYmVoYXZpb3JhbCAoc3VjaCBhcyB7QGxpbmsgbmdDbGlja30pLCBhbmQgd2hpY2hcblx0ICogZG8gbm90IG1hbmlwdWxhdGUgb3IgcmVwbGFjZSBjaGlsZCBub2RlcyAoc3VjaCBhcyB7QGxpbmsgbmdJbmNsdWRlfSkuXG5cdCAqXG5cdCAqICMjIyMgYHByaW9yaXR5YFxuXHQgKiBXaGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBkaXJlY3RpdmVzIGRlZmluZWQgb24gYSBzaW5nbGUgRE9NIGVsZW1lbnQsIHNvbWV0aW1lcyBpdFxuXHQgKiBpcyBuZWNlc3NhcnkgdG8gc3BlY2lmeSB0aGUgb3JkZXIgaW4gd2hpY2ggdGhlIGRpcmVjdGl2ZXMgYXJlIGFwcGxpZWQuIFRoZSBgcHJpb3JpdHlgIGlzIHVzZWRcblx0ICogdG8gc29ydCB0aGUgZGlyZWN0aXZlcyBiZWZvcmUgdGhlaXIgYGNvbXBpbGVgIGZ1bmN0aW9ucyBnZXQgY2FsbGVkLiBQcmlvcml0eSBpcyBkZWZpbmVkIGFzIGFcblx0ICogbnVtYmVyLiBEaXJlY3RpdmVzIHdpdGggZ3JlYXRlciBudW1lcmljYWwgYHByaW9yaXR5YCBhcmUgY29tcGlsZWQgZmlyc3QuIFByZS1saW5rIGZ1bmN0aW9uc1xuXHQgKiBhcmUgYWxzbyBydW4gaW4gcHJpb3JpdHkgb3JkZXIsIGJ1dCBwb3N0LWxpbmsgZnVuY3Rpb25zIGFyZSBydW4gaW4gcmV2ZXJzZSBvcmRlci4gVGhlIG9yZGVyXG5cdCAqIG9mIGRpcmVjdGl2ZXMgd2l0aCB0aGUgc2FtZSBwcmlvcml0eSBpcyB1bmRlZmluZWQuIFRoZSBkZWZhdWx0IHByaW9yaXR5IGlzIGAwYC5cblx0ICpcblx0ICogIyMjIyBgdGVybWluYWxgXG5cdCAqIElmIHNldCB0byB0cnVlIHRoZW4gdGhlIGN1cnJlbnQgYHByaW9yaXR5YCB3aWxsIGJlIHRoZSBsYXN0IHNldCBvZiBkaXJlY3RpdmVzXG5cdCAqIHdoaWNoIHdpbGwgZXhlY3V0ZSAoYW55IGRpcmVjdGl2ZXMgYXQgdGhlIGN1cnJlbnQgcHJpb3JpdHkgd2lsbCBzdGlsbCBleGVjdXRlXG5cdCAqIGFzIHRoZSBvcmRlciBvZiBleGVjdXRpb24gb24gc2FtZSBgcHJpb3JpdHlgIGlzIHVuZGVmaW5lZCkuIE5vdGUgdGhhdCBleHByZXNzaW9uc1xuXHQgKiBhbmQgb3RoZXIgZGlyZWN0aXZlcyB1c2VkIGluIHRoZSBkaXJlY3RpdmUncyB0ZW1wbGF0ZSB3aWxsIGFsc28gYmUgZXhjbHVkZWQgZnJvbSBleGVjdXRpb24uXG5cdCAqXG5cdCAqICMjIyMgYHNjb3BlYFxuXHQgKiBUaGUgc2NvcGUgcHJvcGVydHkgY2FuIGJlIGB0cnVlYCwgYW4gb2JqZWN0IG9yIGEgZmFsc3kgdmFsdWU6XG5cdCAqXG5cdCAqICogKipmYWxzeToqKiBObyBzY29wZSB3aWxsIGJlIGNyZWF0ZWQgZm9yIHRoZSBkaXJlY3RpdmUuIFRoZSBkaXJlY3RpdmUgd2lsbCB1c2UgaXRzIHBhcmVudCdzIHNjb3BlLlxuXHQgKlxuXHQgKiAqICoqYHRydWVgOioqIEEgbmV3IGNoaWxkIHNjb3BlIHRoYXQgcHJvdG90eXBpY2FsbHkgaW5oZXJpdHMgZnJvbSBpdHMgcGFyZW50IHdpbGwgYmUgY3JlYXRlZCBmb3Jcblx0ICogdGhlIGRpcmVjdGl2ZSdzIGVsZW1lbnQuIElmIG11bHRpcGxlIGRpcmVjdGl2ZXMgb24gdGhlIHNhbWUgZWxlbWVudCByZXF1ZXN0IGEgbmV3IHNjb3BlLFxuXHQgKiBvbmx5IG9uZSBuZXcgc2NvcGUgaXMgY3JlYXRlZC4gVGhlIG5ldyBzY29wZSBydWxlIGRvZXMgbm90IGFwcGx5IGZvciB0aGUgcm9vdCBvZiB0aGUgdGVtcGxhdGVcblx0ICogc2luY2UgdGhlIHJvb3Qgb2YgdGhlIHRlbXBsYXRlIGFsd2F5cyBnZXRzIGEgbmV3IHNjb3BlLlxuXHQgKlxuXHQgKiAqICoqYHsuLi59YCAoYW4gb2JqZWN0IGhhc2gpOioqIEEgbmV3IFwiaXNvbGF0ZVwiIHNjb3BlIGlzIGNyZWF0ZWQgZm9yIHRoZSBkaXJlY3RpdmUncyBlbGVtZW50LiBUaGVcblx0ICogJ2lzb2xhdGUnIHNjb3BlIGRpZmZlcnMgZnJvbSBub3JtYWwgc2NvcGUgaW4gdGhhdCBpdCBkb2VzIG5vdCBwcm90b3R5cGljYWxseSBpbmhlcml0IGZyb20gaXRzIHBhcmVudFxuXHQgKiBzY29wZS4gVGhpcyBpcyB1c2VmdWwgd2hlbiBjcmVhdGluZyByZXVzYWJsZSBjb21wb25lbnRzLCB3aGljaCBzaG91bGQgbm90IGFjY2lkZW50YWxseSByZWFkIG9yIG1vZGlmeVxuXHQgKiBkYXRhIGluIHRoZSBwYXJlbnQgc2NvcGUuXG5cdCAqXG5cdCAqIFRoZSAnaXNvbGF0ZScgc2NvcGUgb2JqZWN0IGhhc2ggZGVmaW5lcyBhIHNldCBvZiBsb2NhbCBzY29wZSBwcm9wZXJ0aWVzIGRlcml2ZWQgZnJvbSBhdHRyaWJ1dGVzIG9uIHRoZVxuXHQgKiBkaXJlY3RpdmUncyBlbGVtZW50LiBUaGVzZSBsb2NhbCBwcm9wZXJ0aWVzIGFyZSB1c2VmdWwgZm9yIGFsaWFzaW5nIHZhbHVlcyBmb3IgdGVtcGxhdGVzLiBUaGUga2V5cyBpblxuXHQgKiB0aGUgb2JqZWN0IGhhc2ggbWFwIHRvIHRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSBvbiB0aGUgaXNvbGF0ZSBzY29wZTsgdGhlIHZhbHVlcyBkZWZpbmUgaG93IHRoZSBwcm9wZXJ0eVxuXHQgKiBpcyBib3VuZCB0byB0aGUgcGFyZW50IHNjb3BlLCB2aWEgbWF0Y2hpbmcgYXR0cmlidXRlcyBvbiB0aGUgZGlyZWN0aXZlJ3MgZWxlbWVudDpcblx0ICpcblx0ICogKiBgQGAgb3IgYEBhdHRyYCAtIGJpbmQgYSBsb2NhbCBzY29wZSBwcm9wZXJ0eSB0byB0aGUgdmFsdWUgb2YgRE9NIGF0dHJpYnV0ZS4gVGhlIHJlc3VsdCBpc1xuXHQgKiAgIGFsd2F5cyBhIHN0cmluZyBzaW5jZSBET00gYXR0cmlidXRlcyBhcmUgc3RyaW5ncy4gSWYgbm8gYGF0dHJgIG5hbWUgaXMgc3BlY2lmaWVkIHRoZW4gdGhlXG5cdCAqICAgYXR0cmlidXRlIG5hbWUgaXMgYXNzdW1lZCB0byBiZSB0aGUgc2FtZSBhcyB0aGUgbG9jYWwgbmFtZS4gR2l2ZW4gYDxteS1jb21wb25lbnRcblx0ICogICBteS1hdHRyPVwiaGVsbG8ge3tuYW1lfX1cIj5gIGFuZCB0aGUgaXNvbGF0ZSBzY29wZSBkZWZpbml0aW9uIGBzY29wZTogeyBsb2NhbE5hbWU6J0BteUF0dHInIH1gLFxuXHQgKiAgIHRoZSBkaXJlY3RpdmUncyBzY29wZSBwcm9wZXJ0eSBgbG9jYWxOYW1lYCB3aWxsIHJlZmxlY3QgdGhlIGludGVycG9sYXRlZCB2YWx1ZSBvZiBgaGVsbG9cblx0ICogICB7e25hbWV9fWAuIEFzIHRoZSBgbmFtZWAgYXR0cmlidXRlIGNoYW5nZXMgc28gd2lsbCB0aGUgYGxvY2FsTmFtZWAgcHJvcGVydHkgb24gdGhlIGRpcmVjdGl2ZSdzXG5cdCAqICAgc2NvcGUuIFRoZSBgbmFtZWAgaXMgcmVhZCBmcm9tIHRoZSBwYXJlbnQgc2NvcGUgKG5vdCB0aGUgZGlyZWN0aXZlJ3Mgc2NvcGUpLlxuXHQgKlxuXHQgKiAqIGA9YCBvciBgPWF0dHJgIC0gc2V0IHVwIGEgYmlkaXJlY3Rpb25hbCBiaW5kaW5nIGJldHdlZW4gYSBsb2NhbCBzY29wZSBwcm9wZXJ0eSBhbmQgYW4gZXhwcmVzc2lvblxuXHQgKiAgIHBhc3NlZCB2aWEgdGhlIGF0dHJpYnV0ZSBgYXR0cmAuIFRoZSBleHByZXNzaW9uIGlzIGV2YWx1YXRlZCBpbiB0aGUgY29udGV4dCBvZiB0aGUgcGFyZW50IHNjb3BlLlxuXHQgKiAgIElmIG5vIGBhdHRyYCBuYW1lIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBhdHRyaWJ1dGUgbmFtZSBpcyBhc3N1bWVkIHRvIGJlIHRoZSBzYW1lIGFzIHRoZSBsb2NhbFxuXHQgKiAgIG5hbWUuIEdpdmVuIGA8bXktY29tcG9uZW50IG15LWF0dHI9XCJwYXJlbnRNb2RlbFwiPmAgYW5kIHRoZSBpc29sYXRlIHNjb3BlIGRlZmluaXRpb24gYHNjb3BlOiB7XG5cdCAqICAgbG9jYWxNb2RlbDogJz1teUF0dHInIH1gLCB0aGUgcHJvcGVydHkgYGxvY2FsTW9kZWxgIG9uIHRoZSBkaXJlY3RpdmUncyBzY29wZSB3aWxsIHJlZmxlY3QgdGhlXG5cdCAqICAgdmFsdWUgb2YgYHBhcmVudE1vZGVsYCBvbiB0aGUgcGFyZW50IHNjb3BlLiBDaGFuZ2VzIHRvIGBwYXJlbnRNb2RlbGAgd2lsbCBiZSByZWZsZWN0ZWQgaW5cblx0ICogICBgbG9jYWxNb2RlbGAgYW5kIHZpY2UgdmVyc2EuIE9wdGlvbmFsIGF0dHJpYnV0ZXMgc2hvdWxkIGJlIG1hcmtlZCBhcyBzdWNoIHdpdGggYSBxdWVzdGlvbiBtYXJrOlxuXHQgKiAgIGA9P2Agb3IgYD0/YXR0cmAuIElmIHRoZSBiaW5kaW5nIGV4cHJlc3Npb24gaXMgbm9uLWFzc2lnbmFibGUsIG9yIGlmIHRoZSBhdHRyaWJ1dGUgaXNuJ3Rcblx0ICogICBvcHRpb25hbCBhbmQgZG9lc24ndCBleGlzdCwgYW4gZXhjZXB0aW9uICh7QGxpbmsgZXJyb3IvJGNvbXBpbGUvbm9uYXNzaWduIGAkY29tcGlsZTpub25hc3NpZ25gfSlcblx0ICogICB3aWxsIGJlIHRocm93biB1cG9uIGRpc2NvdmVyaW5nIGNoYW5nZXMgdG8gdGhlIGxvY2FsIHZhbHVlLCBzaW5jZSBpdCB3aWxsIGJlIGltcG9zc2libGUgdG8gc3luY1xuXHQgKiAgIHRoZW0gYmFjayB0byB0aGUgcGFyZW50IHNjb3BlLiBCeSBkZWZhdWx0LCB0aGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJHdhdGNoIGAkd2F0Y2hgfVxuXHQgKiAgIG1ldGhvZCBpcyB1c2VkIGZvciB0cmFja2luZyBjaGFuZ2VzLCBhbmQgdGhlIGVxdWFsaXR5IGNoZWNrIGlzIGJhc2VkIG9uIG9iamVjdCBpZGVudGl0eS5cblx0ICogICBIb3dldmVyLCBpZiBhbiBvYmplY3QgbGl0ZXJhbCBvciBhbiBhcnJheSBsaXRlcmFsIGlzIHBhc3NlZCBhcyB0aGUgYmluZGluZyBleHByZXNzaW9uLCB0aGVcblx0ICogICBlcXVhbGl0eSBjaGVjayBpcyBkb25lIGJ5IHZhbHVlICh1c2luZyB0aGUge0BsaW5rIGFuZ3VsYXIuZXF1YWxzfSBmdW5jdGlvbikuIEl0J3MgYWxzbyBwb3NzaWJsZVxuXHQgKiAgIHRvIHdhdGNoIHRoZSBldmFsdWF0ZWQgdmFsdWUgc2hhbGxvd2x5IHdpdGgge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJHdhdGNoQ29sbGVjdGlvblxuXHQgKiAgIGAkd2F0Y2hDb2xsZWN0aW9uYH06IHVzZSBgPSpgIG9yIGA9KmF0dHJgIChgPSo/YCBvciBgPSo/YXR0cmAgaWYgdGhlIGF0dHJpYnV0ZSBpcyBvcHRpb25hbCkuXG5cdCAqXG5cdCAgKiAqIGA8YCBvciBgPGF0dHJgIC0gc2V0IHVwIGEgb25lLXdheSAob25lLWRpcmVjdGlvbmFsKSBiaW5kaW5nIGJldHdlZW4gYSBsb2NhbCBzY29wZSBwcm9wZXJ0eSBhbmQgYW5cblx0ICogICBleHByZXNzaW9uIHBhc3NlZCB2aWEgdGhlIGF0dHJpYnV0ZSBgYXR0cmAuIFRoZSBleHByZXNzaW9uIGlzIGV2YWx1YXRlZCBpbiB0aGUgY29udGV4dCBvZiB0aGVcblx0ICogICBwYXJlbnQgc2NvcGUuIElmIG5vIGBhdHRyYCBuYW1lIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBhdHRyaWJ1dGUgbmFtZSBpcyBhc3N1bWVkIHRvIGJlIHRoZSBzYW1lIGFzIHRoZVxuXHQgKiAgIGxvY2FsIG5hbWUuIFlvdSBjYW4gYWxzbyBtYWtlIHRoZSBiaW5kaW5nIG9wdGlvbmFsIGJ5IGFkZGluZyBgP2A6IGA8P2Agb3IgYDw/YXR0cmAuXG5cdCAqXG5cdCAqICAgRm9yIGV4YW1wbGUsIGdpdmVuIGA8bXktY29tcG9uZW50IG15LWF0dHI9XCJwYXJlbnRNb2RlbFwiPmAgYW5kIGRpcmVjdGl2ZSBkZWZpbml0aW9uIG9mXG5cdCAqICAgYHNjb3BlOiB7IGxvY2FsTW9kZWw6JzxteUF0dHInIH1gLCB0aGVuIHRoZSBpc29sYXRlZCBzY29wZSBwcm9wZXJ0eSBgbG9jYWxNb2RlbGAgd2lsbCByZWZsZWN0IHRoZVxuXHQgKiAgIHZhbHVlIG9mIGBwYXJlbnRNb2RlbGAgb24gdGhlIHBhcmVudCBzY29wZS4gQW55IGNoYW5nZXMgdG8gYHBhcmVudE1vZGVsYCB3aWxsIGJlIHJlZmxlY3RlZFxuXHQgKiAgIGluIGBsb2NhbE1vZGVsYCwgYnV0IGNoYW5nZXMgaW4gYGxvY2FsTW9kZWxgIHdpbGwgbm90IHJlZmxlY3QgaW4gYHBhcmVudE1vZGVsYC4gVGhlcmUgYXJlIGhvd2V2ZXJcblx0ICogICB0d28gY2F2ZWF0czpcblx0ICogICAgIDEuIG9uZS13YXkgYmluZGluZyBkb2VzIG5vdCBjb3B5IHRoZSB2YWx1ZSBmcm9tIHRoZSBwYXJlbnQgdG8gdGhlIGlzb2xhdGUgc2NvcGUsIGl0IHNpbXBseVxuXHQgKiAgICAgc2V0cyB0aGUgc2FtZSB2YWx1ZS4gVGhhdCBtZWFucyBpZiB5b3VyIGJvdW5kIHZhbHVlIGlzIGFuIG9iamVjdCwgY2hhbmdlcyB0byBpdHMgcHJvcGVydGllc1xuXHQgKiAgICAgaW4gdGhlIGlzb2xhdGVkIHNjb3BlIHdpbGwgYmUgcmVmbGVjdGVkIGluIHRoZSBwYXJlbnQgc2NvcGUgKGJlY2F1c2UgYm90aCByZWZlcmVuY2UgdGhlIHNhbWUgb2JqZWN0KS5cblx0ICogICAgIDIuIG9uZS13YXkgYmluZGluZyB3YXRjaGVzIGNoYW5nZXMgdG8gdGhlICoqaWRlbnRpdHkqKiBvZiB0aGUgcGFyZW50IHZhbHVlLiBUaGF0IG1lYW5zIHRoZVxuXHQgKiAgICAge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJHdhdGNoIGAkd2F0Y2hgfSBvbiB0aGUgcGFyZW50IHZhbHVlIG9ubHkgZmlyZXMgaWYgdGhlIHJlZmVyZW5jZVxuXHQgKiAgICAgdG8gdGhlIHZhbHVlIGhhcyBjaGFuZ2VkLiBJbiBtb3N0IGNhc2VzLCB0aGlzIHNob3VsZCBub3QgYmUgb2YgY29uY2VybiwgYnV0IGNhbiBiZSBpbXBvcnRhbnRcblx0ICogICAgIHRvIGtub3cgaWYgeW91IG9uZS13YXkgYmluZCB0byBhbiBvYmplY3QsIGFuZCB0aGVuIHJlcGxhY2UgdGhhdCBvYmplY3QgaW4gdGhlIGlzb2xhdGVkIHNjb3BlLlxuXHQgKiAgICAgSWYgeW91IG5vdyBjaGFuZ2UgYSBwcm9wZXJ0eSBvZiB0aGUgb2JqZWN0IGluIHlvdXIgcGFyZW50IHNjb3BlLCB0aGUgY2hhbmdlIHdpbGwgbm90IGJlXG5cdCAqICAgICBwcm9wYWdhdGVkIHRvIHRoZSBpc29sYXRlZCBzY29wZSwgYmVjYXVzZSB0aGUgaWRlbnRpdHkgb2YgdGhlIG9iamVjdCBvbiB0aGUgcGFyZW50IHNjb3BlXG5cdCAqICAgICBoYXMgbm90IGNoYW5nZWQuIEluc3RlYWQgeW91IG11c3QgYXNzaWduIGEgbmV3IG9iamVjdC5cblx0ICpcblx0ICogICBPbmUtd2F5IGJpbmRpbmcgaXMgdXNlZnVsIGlmIHlvdSBkbyBub3QgcGxhbiB0byBwcm9wYWdhdGUgY2hhbmdlcyB0byB5b3VyIGlzb2xhdGVkIHNjb3BlIGJpbmRpbmdzXG5cdCAqICAgYmFjayB0byB0aGUgcGFyZW50LiBIb3dldmVyLCBpdCBkb2VzIG5vdCBtYWtlIHRoaXMgY29tcGxldGVseSBpbXBvc3NpYmxlLlxuXHQgKlxuXHQgKiAqIGAmYCBvciBgJmF0dHJgIC0gcHJvdmlkZXMgYSB3YXkgdG8gZXhlY3V0ZSBhbiBleHByZXNzaW9uIGluIHRoZSBjb250ZXh0IG9mIHRoZSBwYXJlbnQgc2NvcGUuIElmXG5cdCAqICAgbm8gYGF0dHJgIG5hbWUgaXMgc3BlY2lmaWVkIHRoZW4gdGhlIGF0dHJpYnV0ZSBuYW1lIGlzIGFzc3VtZWQgdG8gYmUgdGhlIHNhbWUgYXMgdGhlIGxvY2FsIG5hbWUuXG5cdCAqICAgR2l2ZW4gYDxteS1jb21wb25lbnQgbXktYXR0cj1cImNvdW50ID0gY291bnQgKyB2YWx1ZVwiPmAgYW5kIHRoZSBpc29sYXRlIHNjb3BlIGRlZmluaXRpb24gYHNjb3BlOiB7XG5cdCAqICAgbG9jYWxGbjonJm15QXR0cicgfWAsIHRoZSBpc29sYXRlIHNjb3BlIHByb3BlcnR5IGBsb2NhbEZuYCB3aWxsIHBvaW50IHRvIGEgZnVuY3Rpb24gd3JhcHBlciBmb3Jcblx0ICogICB0aGUgYGNvdW50ID0gY291bnQgKyB2YWx1ZWAgZXhwcmVzc2lvbi4gT2Z0ZW4gaXQncyBkZXNpcmFibGUgdG8gcGFzcyBkYXRhIGZyb20gdGhlIGlzb2xhdGVkIHNjb3BlXG5cdCAqICAgdmlhIGFuIGV4cHJlc3Npb24gdG8gdGhlIHBhcmVudCBzY29wZS4gVGhpcyBjYW4gYmUgZG9uZSBieSBwYXNzaW5nIGEgbWFwIG9mIGxvY2FsIHZhcmlhYmxlIG5hbWVzXG5cdCAqICAgYW5kIHZhbHVlcyBpbnRvIHRoZSBleHByZXNzaW9uIHdyYXBwZXIgZm4uIEZvciBleGFtcGxlLCBpZiB0aGUgZXhwcmVzc2lvbiBpcyBgaW5jcmVtZW50KGFtb3VudClgXG5cdCAqICAgdGhlbiB3ZSBjYW4gc3BlY2lmeSB0aGUgYW1vdW50IHZhbHVlIGJ5IGNhbGxpbmcgdGhlIGBsb2NhbEZuYCBhcyBgbG9jYWxGbih7YW1vdW50OiAyMn0pYC5cblx0ICpcblx0ICogSW4gZ2VuZXJhbCBpdCdzIHBvc3NpYmxlIHRvIGFwcGx5IG1vcmUgdGhhbiBvbmUgZGlyZWN0aXZlIHRvIG9uZSBlbGVtZW50LCBidXQgdGhlcmUgbWlnaHQgYmUgbGltaXRhdGlvbnNcblx0ICogZGVwZW5kaW5nIG9uIHRoZSB0eXBlIG9mIHNjb3BlIHJlcXVpcmVkIGJ5IHRoZSBkaXJlY3RpdmVzLiBUaGUgZm9sbG93aW5nIHBvaW50cyB3aWxsIGhlbHAgZXhwbGFpbiB0aGVzZSBsaW1pdGF0aW9ucy5cblx0ICogRm9yIHNpbXBsaWNpdHkgb25seSB0d28gZGlyZWN0aXZlcyBhcmUgdGFrZW4gaW50byBhY2NvdW50LCBidXQgaXQgaXMgYWxzbyBhcHBsaWNhYmxlIGZvciBzZXZlcmFsIGRpcmVjdGl2ZXM6XG5cdCAqXG5cdCAqICogKipubyBzY29wZSoqICsgKipubyBzY29wZSoqID0+IFR3byBkaXJlY3RpdmVzIHdoaWNoIGRvbid0IHJlcXVpcmUgdGhlaXIgb3duIHNjb3BlIHdpbGwgdXNlIHRoZWlyIHBhcmVudCdzIHNjb3BlXG5cdCAqICogKipjaGlsZCBzY29wZSoqICsgKipubyBzY29wZSoqID0+ICBCb3RoIGRpcmVjdGl2ZXMgd2lsbCBzaGFyZSBvbmUgc2luZ2xlIGNoaWxkIHNjb3BlXG5cdCAqICogKipjaGlsZCBzY29wZSoqICsgKipjaGlsZCBzY29wZSoqID0+ICBCb3RoIGRpcmVjdGl2ZXMgd2lsbCBzaGFyZSBvbmUgc2luZ2xlIGNoaWxkIHNjb3BlXG5cdCAqICogKippc29sYXRlZCBzY29wZSoqICsgKipubyBzY29wZSoqID0+ICBUaGUgaXNvbGF0ZWQgZGlyZWN0aXZlIHdpbGwgdXNlIGl0J3Mgb3duIGNyZWF0ZWQgaXNvbGF0ZWQgc2NvcGUuIFRoZSBvdGhlciBkaXJlY3RpdmUgd2lsbCB1c2Vcblx0ICogaXRzIHBhcmVudCdzIHNjb3BlXG5cdCAqICogKippc29sYXRlZCBzY29wZSoqICsgKipjaGlsZCBzY29wZSoqID0+ICAqKldvbid0IHdvcmshKiogT25seSBvbmUgc2NvcGUgY2FuIGJlIHJlbGF0ZWQgdG8gb25lIGVsZW1lbnQuIFRoZXJlZm9yZSB0aGVzZSBkaXJlY3RpdmVzIGNhbm5vdFxuXHQgKiBiZSBhcHBsaWVkIHRvIHRoZSBzYW1lIGVsZW1lbnQuXG5cdCAqICogKippc29sYXRlZCBzY29wZSoqICsgKippc29sYXRlZCBzY29wZSoqICA9PiAgKipXb24ndCB3b3JrISoqIE9ubHkgb25lIHNjb3BlIGNhbiBiZSByZWxhdGVkIHRvIG9uZSBlbGVtZW50LiBUaGVyZWZvcmUgdGhlc2UgZGlyZWN0aXZlc1xuXHQgKiBjYW5ub3QgYmUgYXBwbGllZCB0byB0aGUgc2FtZSBlbGVtZW50LlxuXHQgKlxuXHQgKlxuXHQgKiAjIyMjIGBiaW5kVG9Db250cm9sbGVyYFxuXHQgKiBUaGlzIHByb3BlcnR5IGlzIHVzZWQgdG8gYmluZCBzY29wZSBwcm9wZXJ0aWVzIGRpcmVjdGx5IHRvIHRoZSBjb250cm9sbGVyLiBJdCBjYW4gYmUgZWl0aGVyXG5cdCAqIGB0cnVlYCBvciBhbiBvYmplY3QgaGFzaCB3aXRoIHRoZSBzYW1lIGZvcm1hdCBhcyB0aGUgYHNjb3BlYCBwcm9wZXJ0eS4gQWRkaXRpb25hbGx5LCBhIGNvbnRyb2xsZXJcblx0ICogYWxpYXMgbXVzdCBiZSBzZXQsIGVpdGhlciBieSB1c2luZyBgY29udHJvbGxlckFzOiAnbXlBbGlhcydgIG9yIGJ5IHNwZWNpZnlpbmcgdGhlIGFsaWFzIGluIHRoZSBjb250cm9sbGVyXG5cdCAqIGRlZmluaXRpb246IGBjb250cm9sbGVyOiAnbXlDdHJsIGFzIG15QWxpYXMnYC5cblx0ICpcblx0ICogV2hlbiBhbiBpc29sYXRlIHNjb3BlIGlzIHVzZWQgZm9yIGEgZGlyZWN0aXZlIChzZWUgYWJvdmUpLCBgYmluZFRvQ29udHJvbGxlcjogdHJ1ZWAgd2lsbFxuXHQgKiBhbGxvdyBhIGNvbXBvbmVudCB0byBoYXZlIGl0cyBwcm9wZXJ0aWVzIGJvdW5kIHRvIHRoZSBjb250cm9sbGVyLCByYXRoZXIgdGhhbiB0byBzY29wZS5cblx0ICpcblx0ICogQWZ0ZXIgdGhlIGNvbnRyb2xsZXIgaXMgaW5zdGFudGlhdGVkLCB0aGUgaW5pdGlhbCB2YWx1ZXMgb2YgdGhlIGlzb2xhdGUgc2NvcGUgYmluZGluZ3Mgd2lsbCBiZSBib3VuZCB0byB0aGUgY29udHJvbGxlclxuXHQgKiBwcm9wZXJ0aWVzLiBZb3UgY2FuIGFjY2VzcyB0aGVzZSBiaW5kaW5ncyBvbmNlIHRoZXkgaGF2ZSBiZWVuIGluaXRpYWxpemVkIGJ5IHByb3ZpZGluZyBhIGNvbnRyb2xsZXIgbWV0aG9kIGNhbGxlZFxuXHQgKiBgJG9uSW5pdGAsIHdoaWNoIGlzIGNhbGxlZCBhZnRlciBhbGwgdGhlIGNvbnRyb2xsZXJzIG9uIGFuIGVsZW1lbnQgaGF2ZSBiZWVuIGNvbnN0cnVjdGVkIGFuZCBoYWQgdGhlaXIgYmluZGluZ3Ncblx0ICogaW5pdGlhbGl6ZWQuXG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG5cdCAqICoqRGVwcmVjYXRpb24gd2FybmluZzoqKiBhbHRob3VnaCBiaW5kaW5ncyBmb3Igbm9uLUVTNiBjbGFzcyBjb250cm9sbGVycyBhcmUgY3VycmVudGx5XG5cdCAqIGJvdW5kIHRvIGB0aGlzYCBiZWZvcmUgdGhlIGNvbnRyb2xsZXIgY29uc3RydWN0b3IgaXMgY2FsbGVkLCB0aGlzIHVzZSBpcyBub3cgZGVwcmVjYXRlZC4gUGxlYXNlIHBsYWNlIGluaXRpYWxpemF0aW9uXG5cdCAqIGNvZGUgdGhhdCByZWxpZXMgdXBvbiBiaW5kaW5ncyBpbnNpZGUgYSBgJG9uSW5pdGAgbWV0aG9kIG9uIHRoZSBjb250cm9sbGVyLCBpbnN0ZWFkLlxuXHQgKiA8L2Rpdj5cblx0ICpcblx0ICogSXQgaXMgYWxzbyBwb3NzaWJsZSB0byBzZXQgYGJpbmRUb0NvbnRyb2xsZXJgIHRvIGFuIG9iamVjdCBoYXNoIHdpdGggdGhlIHNhbWUgZm9ybWF0IGFzIHRoZSBgc2NvcGVgIHByb3BlcnR5LlxuXHQgKiBUaGlzIHdpbGwgc2V0IHVwIHRoZSBzY29wZSBiaW5kaW5ncyB0byB0aGUgY29udHJvbGxlciBkaXJlY3RseS4gTm90ZSB0aGF0IGBzY29wZWAgY2FuIHN0aWxsIGJlIHVzZWRcblx0ICogdG8gZGVmaW5lIHdoaWNoIGtpbmQgb2Ygc2NvcGUgaXMgY3JlYXRlZC4gQnkgZGVmYXVsdCwgbm8gc2NvcGUgaXMgY3JlYXRlZC4gVXNlIGBzY29wZToge31gIHRvIGNyZWF0ZSBhbiBpc29sYXRlXG5cdCAqIHNjb3BlICh1c2VmdWwgZm9yIGNvbXBvbmVudCBkaXJlY3RpdmVzKS5cblx0ICpcblx0ICogSWYgYm90aCBgYmluZFRvQ29udHJvbGxlcmAgYW5kIGBzY29wZWAgYXJlIGRlZmluZWQgYW5kIGhhdmUgb2JqZWN0IGhhc2hlcywgYGJpbmRUb0NvbnRyb2xsZXJgIG92ZXJyaWRlcyBgc2NvcGVgLlxuXHQgKlxuXHQgKlxuXHQgKiAjIyMjIGBjb250cm9sbGVyYFxuXHQgKiBDb250cm9sbGVyIGNvbnN0cnVjdG9yIGZ1bmN0aW9uLiBUaGUgY29udHJvbGxlciBpcyBpbnN0YW50aWF0ZWQgYmVmb3JlIHRoZVxuXHQgKiBwcmUtbGlua2luZyBwaGFzZSBhbmQgY2FuIGJlIGFjY2Vzc2VkIGJ5IG90aGVyIGRpcmVjdGl2ZXMgKHNlZVxuXHQgKiBgcmVxdWlyZWAgYXR0cmlidXRlKS4gVGhpcyBhbGxvd3MgdGhlIGRpcmVjdGl2ZXMgdG8gY29tbXVuaWNhdGUgd2l0aCBlYWNoIG90aGVyIGFuZCBhdWdtZW50XG5cdCAqIGVhY2ggb3RoZXIncyBiZWhhdmlvci4gVGhlIGNvbnRyb2xsZXIgaXMgaW5qZWN0YWJsZSAoYW5kIHN1cHBvcnRzIGJyYWNrZXQgbm90YXRpb24pIHdpdGggdGhlIGZvbGxvd2luZyBsb2NhbHM6XG5cdCAqXG5cdCAqICogYCRzY29wZWAgLSBDdXJyZW50IHNjb3BlIGFzc29jaWF0ZWQgd2l0aCB0aGUgZWxlbWVudFxuXHQgKiAqIGAkZWxlbWVudGAgLSBDdXJyZW50IGVsZW1lbnRcblx0ICogKiBgJGF0dHJzYCAtIEN1cnJlbnQgYXR0cmlidXRlcyBvYmplY3QgZm9yIHRoZSBlbGVtZW50XG5cdCAqICogYCR0cmFuc2NsdWRlYCAtIEEgdHJhbnNjbHVkZSBsaW5raW5nIGZ1bmN0aW9uIHByZS1ib3VuZCB0byB0aGUgY29ycmVjdCB0cmFuc2NsdXNpb24gc2NvcGU6XG5cdCAqICAgYGZ1bmN0aW9uKFtzY29wZV0sIGNsb25lTGlua2luZ0ZuLCBmdXR1cmVQYXJlbnRFbGVtZW50LCBzbG90TmFtZSlgOlxuXHQgKiAgICAqIGBzY29wZWA6IChvcHRpb25hbCkgb3ZlcnJpZGUgdGhlIHNjb3BlLlxuXHQgKiAgICAqIGBjbG9uZUxpbmtpbmdGbmA6IChvcHRpb25hbCkgYXJndW1lbnQgdG8gY3JlYXRlIGNsb25lcyBvZiB0aGUgb3JpZ2luYWwgdHJhbnNjbHVkZWQgY29udGVudC5cblx0ICogICAgKiBgZnV0dXJlUGFyZW50RWxlbWVudGAgKG9wdGlvbmFsKTpcblx0ICogICAgICAgICogZGVmaW5lcyB0aGUgcGFyZW50IHRvIHdoaWNoIHRoZSBgY2xvbmVMaW5raW5nRm5gIHdpbGwgYWRkIHRoZSBjbG9uZWQgZWxlbWVudHMuXG5cdCAqICAgICAgICAqIGRlZmF1bHQ6IGAkZWxlbWVudC5wYXJlbnQoKWAgcmVzcC4gYCRlbGVtZW50YCBmb3IgYHRyYW5zY2x1ZGU6J2VsZW1lbnQnYCByZXNwLiBgdHJhbnNjbHVkZTp0cnVlYC5cblx0ICogICAgICAgICogb25seSBuZWVkZWQgZm9yIHRyYW5zY2x1ZGVzIHRoYXQgYXJlIGFsbG93ZWQgdG8gY29udGFpbiBub24gaHRtbCBlbGVtZW50cyAoZS5nLiBTVkcgZWxlbWVudHMpXG5cdCAqICAgICAgICAgIGFuZCB3aGVuIHRoZSBgY2xvbmVMaW5raW5GbmAgaXMgcGFzc2VkLFxuXHQgKiAgICAgICAgICBhcyB0aG9zZSBlbGVtZW50cyBuZWVkIHRvIGNyZWF0ZWQgYW5kIGNsb25lZCBpbiBhIHNwZWNpYWwgd2F5IHdoZW4gdGhleSBhcmUgZGVmaW5lZCBvdXRzaWRlIHRoZWlyXG5cdCAqICAgICAgICAgIHVzdWFsIGNvbnRhaW5lcnMgKGUuZy4gbGlrZSBgPHN2Zz5gKS5cblx0ICogICAgICAgICogU2VlIGFsc28gdGhlIGBkaXJlY3RpdmUudGVtcGxhdGVOYW1lc3BhY2VgIHByb3BlcnR5LlxuXHQgKiAgICAqIGBzbG90TmFtZWA6IChvcHRpb25hbCkgdGhlIG5hbWUgb2YgdGhlIHNsb3QgdG8gdHJhbnNjbHVkZS4gSWYgZmFsc3kgKGUuZy4gYG51bGxgLCBgdW5kZWZpbmVkYCBvciBgJydgKVxuXHQgKiAgICAgIHRoZW4gdGhlIGRlZmF1bHQgdHJhbnNsdXNpb24gaXMgcHJvdmlkZWQuXG5cdCAqICAgIFRoZSBgJHRyYW5zY2x1ZGVgIGZ1bmN0aW9uIGFsc28gaGFzIGEgbWV0aG9kIG9uIGl0LCBgJHRyYW5zY2x1ZGUuaXNTbG90RmlsbGVkKHNsb3ROYW1lKWAsIHdoaWNoIHJldHVybnNcblx0ICogICAgYHRydWVgIGlmIHRoZSBzcGVjaWZpZWQgc2xvdCBjb250YWlucyBjb250ZW50IChpLmUuIG9uZSBvciBtb3JlIERPTSBub2RlcykuXG5cdCAqXG5cdCAqIFRoZSBjb250cm9sbGVyIGNhbiBwcm92aWRlIHRoZSBmb2xsb3dpbmcgbWV0aG9kcyB0aGF0IGFjdCBhcyBsaWZlLWN5Y2xlIGhvb2tzOlxuXHQgKiAqIGAkb25Jbml0YCAtIENhbGxlZCBvbiBlYWNoIGNvbnRyb2xsZXIgYWZ0ZXIgYWxsIHRoZSBjb250cm9sbGVycyBvbiBhbiBlbGVtZW50IGhhdmUgYmVlbiBjb25zdHJ1Y3RlZCBhbmRcblx0ICogICBoYWQgdGhlaXIgYmluZGluZ3MgaW5pdGlhbGl6ZWQgKGFuZCBiZWZvcmUgdGhlIHByZSAmYW1wOyBwb3N0IGxpbmtpbmcgZnVuY3Rpb25zIGZvciB0aGUgZGlyZWN0aXZlcyBvblxuXHQgKiAgIHRoaXMgZWxlbWVudCkuIFRoaXMgaXMgYSBnb29kIHBsYWNlIHRvIHB1dCBpbml0aWFsaXphdGlvbiBjb2RlIGZvciB5b3VyIGNvbnRyb2xsZXIuXG5cdCAqXG5cdCAqICMjIyMgYHJlcXVpcmVgXG5cdCAqIFJlcXVpcmUgYW5vdGhlciBkaXJlY3RpdmUgYW5kIGluamVjdCBpdHMgY29udHJvbGxlciBhcyB0aGUgZm91cnRoIGFyZ3VtZW50IHRvIHRoZSBsaW5raW5nIGZ1bmN0aW9uLiBUaGVcblx0ICogYHJlcXVpcmVgIHByb3BlcnR5IGNhbiBiZSBhIHN0cmluZywgYW4gYXJyYXkgb3IgYW4gb2JqZWN0OlxuXHQgKiAqIGEgKipzdHJpbmcqKiBjb250YWluaW5nIHRoZSBuYW1lIG9mIHRoZSBkaXJlY3RpdmUgdG8gcGFzcyB0byB0aGUgbGlua2luZyBmdW5jdGlvblxuXHQgKiAqIGFuICoqYXJyYXkqKiBjb250YWluaW5nIHRoZSBuYW1lcyBvZiBkaXJlY3RpdmVzIHRvIHBhc3MgdG8gdGhlIGxpbmtpbmcgZnVuY3Rpb24uIFRoZSBhcmd1bWVudCBwYXNzZWQgdG8gdGhlXG5cdCAqIGxpbmtpbmcgZnVuY3Rpb24gd2lsbCBiZSBhbiBhcnJheSBvZiBjb250cm9sbGVycyBpbiB0aGUgc2FtZSBvcmRlciBhcyB0aGUgbmFtZXMgaW4gdGhlIGByZXF1aXJlYCBwcm9wZXJ0eVxuXHQgKiAqIGFuICoqb2JqZWN0Kiogd2hvc2UgcHJvcGVydHkgdmFsdWVzIGFyZSB0aGUgbmFtZXMgb2YgdGhlIGRpcmVjdGl2ZXMgdG8gcGFzcyB0byB0aGUgbGlua2luZyBmdW5jdGlvbi4gVGhlIGFyZ3VtZW50XG5cdCAqIHBhc3NlZCB0byB0aGUgbGlua2luZyBmdW5jdGlvbiB3aWxsIGFsc28gYmUgYW4gb2JqZWN0IHdpdGggbWF0Y2hpbmcga2V5cywgd2hvc2UgdmFsdWVzIHdpbGwgaG9sZCB0aGUgY29ycmVzcG9uZGluZ1xuXHQgKiBjb250cm9sbGVycy5cblx0ICpcblx0ICogSWYgdGhlIGByZXF1aXJlYCBwcm9wZXJ0eSBpcyBhbiBvYmplY3QgYW5kIGBiaW5kVG9Db250cm9sbGVyYCBpcyB0cnV0aHksIHRoZW4gdGhlIHJlcXVpcmVkIGNvbnRyb2xsZXJzIGFyZVxuXHQgKiBib3VuZCB0byB0aGUgY29udHJvbGxlciB1c2luZyB0aGUga2V5cyBvZiB0aGUgYHJlcXVpcmVgIHByb3BlcnR5LiBUaGlzIGJpbmRpbmcgb2NjdXJzIGFmdGVyIGFsbCB0aGUgY29udHJvbGxlcnNcblx0ICogaGF2ZSBiZWVuIGNvbnN0cnVjdGVkIGJ1dCBiZWZvcmUgYCRvbkluaXRgIGlzIGNhbGxlZC5cblx0ICogU2VlIHRoZSB7QGxpbmsgJGNvbXBpbGVQcm92aWRlciNjb21wb25lbnR9IGhlbHBlciBmb3IgYW4gZXhhbXBsZSBvZiBob3cgdGhpcyBjYW4gYmUgdXNlZC5cblx0ICpcblx0ICogSWYgbm8gc3VjaCByZXF1aXJlZCBkaXJlY3RpdmUocykgY2FuIGJlIGZvdW5kLCBvciBpZiB0aGUgZGlyZWN0aXZlIGRvZXMgbm90IGhhdmUgYSBjb250cm9sbGVyLCB0aGVuIGFuIGVycm9yIGlzXG5cdCAqIHJhaXNlZCAodW5sZXNzIG5vIGxpbmsgZnVuY3Rpb24gaXMgc3BlY2lmaWVkIGFuZCB0aGUgcmVxdWlyZWQgY29udHJvbGxlcnMgYXJlIG5vdCBiZWluZyBib3VuZCB0byB0aGUgZGlyZWN0aXZlXG5cdCAqIGNvbnRyb2xsZXIsIGluIHdoaWNoIGNhc2UgZXJyb3IgY2hlY2tpbmcgaXMgc2tpcHBlZCkuIFRoZSBuYW1lIGNhbiBiZSBwcmVmaXhlZCB3aXRoOlxuXHQgKlxuXHQgKiAqIChubyBwcmVmaXgpIC0gTG9jYXRlIHRoZSByZXF1aXJlZCBjb250cm9sbGVyIG9uIHRoZSBjdXJyZW50IGVsZW1lbnQuIFRocm93IGFuIGVycm9yIGlmIG5vdCBmb3VuZC5cblx0ICogKiBgP2AgLSBBdHRlbXB0IHRvIGxvY2F0ZSB0aGUgcmVxdWlyZWQgY29udHJvbGxlciBvciBwYXNzIGBudWxsYCB0byB0aGUgYGxpbmtgIGZuIGlmIG5vdCBmb3VuZC5cblx0ICogKiBgXmAgLSBMb2NhdGUgdGhlIHJlcXVpcmVkIGNvbnRyb2xsZXIgYnkgc2VhcmNoaW5nIHRoZSBlbGVtZW50IGFuZCBpdHMgcGFyZW50cy4gVGhyb3cgYW4gZXJyb3IgaWYgbm90IGZvdW5kLlxuXHQgKiAqIGBeXmAgLSBMb2NhdGUgdGhlIHJlcXVpcmVkIGNvbnRyb2xsZXIgYnkgc2VhcmNoaW5nIHRoZSBlbGVtZW50J3MgcGFyZW50cy4gVGhyb3cgYW4gZXJyb3IgaWYgbm90IGZvdW5kLlxuXHQgKiAqIGA/XmAgLSBBdHRlbXB0IHRvIGxvY2F0ZSB0aGUgcmVxdWlyZWQgY29udHJvbGxlciBieSBzZWFyY2hpbmcgdGhlIGVsZW1lbnQgYW5kIGl0cyBwYXJlbnRzIG9yIHBhc3Ncblx0ICogICBgbnVsbGAgdG8gdGhlIGBsaW5rYCBmbiBpZiBub3QgZm91bmQuXG5cdCAqICogYD9eXmAgLSBBdHRlbXB0IHRvIGxvY2F0ZSB0aGUgcmVxdWlyZWQgY29udHJvbGxlciBieSBzZWFyY2hpbmcgdGhlIGVsZW1lbnQncyBwYXJlbnRzLCBvciBwYXNzXG5cdCAqICAgYG51bGxgIHRvIHRoZSBgbGlua2AgZm4gaWYgbm90IGZvdW5kLlxuXHQgKlxuXHQgKlxuXHQgKiAjIyMjIGBjb250cm9sbGVyQXNgXG5cdCAqIElkZW50aWZpZXIgbmFtZSBmb3IgYSByZWZlcmVuY2UgdG8gdGhlIGNvbnRyb2xsZXIgaW4gdGhlIGRpcmVjdGl2ZSdzIHNjb3BlLlxuXHQgKiBUaGlzIGFsbG93cyB0aGUgY29udHJvbGxlciB0byBiZSByZWZlcmVuY2VkIGZyb20gdGhlIGRpcmVjdGl2ZSB0ZW1wbGF0ZS4gVGhpcyBpcyBlc3BlY2lhbGx5XG5cdCAqIHVzZWZ1bCB3aGVuIGEgZGlyZWN0aXZlIGlzIHVzZWQgYXMgY29tcG9uZW50LCBpLmUuIHdpdGggYW4gYGlzb2xhdGVgIHNjb3BlLiBJdCdzIGFsc28gcG9zc2libGVcblx0ICogdG8gdXNlIGl0IGluIGEgZGlyZWN0aXZlIHdpdGhvdXQgYW4gYGlzb2xhdGVgIC8gYG5ld2Agc2NvcGUsIGJ1dCB5b3UgbmVlZCB0byBiZSBhd2FyZSB0aGF0IHRoZVxuXHQgKiBgY29udHJvbGxlckFzYCByZWZlcmVuY2UgbWlnaHQgb3ZlcndyaXRlIGEgcHJvcGVydHkgdGhhdCBhbHJlYWR5IGV4aXN0cyBvbiB0aGUgcGFyZW50IHNjb3BlLlxuXHQgKlxuXHQgKlxuXHQgKiAjIyMjIGByZXN0cmljdGBcblx0ICogU3RyaW5nIG9mIHN1YnNldCBvZiBgRUFDTWAgd2hpY2ggcmVzdHJpY3RzIHRoZSBkaXJlY3RpdmUgdG8gYSBzcGVjaWZpYyBkaXJlY3RpdmVcblx0ICogZGVjbGFyYXRpb24gc3R5bGUuIElmIG9taXR0ZWQsIHRoZSBkZWZhdWx0cyAoZWxlbWVudHMgYW5kIGF0dHJpYnV0ZXMpIGFyZSB1c2VkLlxuXHQgKlxuXHQgKiAqIGBFYCAtIEVsZW1lbnQgbmFtZSAoZGVmYXVsdCk6IGA8bXktZGlyZWN0aXZlPjwvbXktZGlyZWN0aXZlPmBcblx0ICogKiBgQWAgLSBBdHRyaWJ1dGUgKGRlZmF1bHQpOiBgPGRpdiBteS1kaXJlY3RpdmU9XCJleHBcIj48L2Rpdj5gXG5cdCAqICogYENgIC0gQ2xhc3M6IGA8ZGl2IGNsYXNzPVwibXktZGlyZWN0aXZlOiBleHA7XCI+PC9kaXY+YFxuXHQgKiAqIGBNYCAtIENvbW1lbnQ6IGA8IS0tIGRpcmVjdGl2ZTogbXktZGlyZWN0aXZlIGV4cCAtLT5gXG5cdCAqXG5cdCAqXG5cdCAqICMjIyMgYHRlbXBsYXRlTmFtZXNwYWNlYFxuXHQgKiBTdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBkb2N1bWVudCB0eXBlIHVzZWQgYnkgdGhlIG1hcmt1cCBpbiB0aGUgdGVtcGxhdGUuXG5cdCAqIEFuZ3VsYXJKUyBuZWVkcyB0aGlzIGluZm9ybWF0aW9uIGFzIHRob3NlIGVsZW1lbnRzIG5lZWQgdG8gYmUgY3JlYXRlZCBhbmQgY2xvbmVkXG5cdCAqIGluIGEgc3BlY2lhbCB3YXkgd2hlbiB0aGV5IGFyZSBkZWZpbmVkIG91dHNpZGUgdGhlaXIgdXN1YWwgY29udGFpbmVycyBsaWtlIGA8c3ZnPmAgYW5kIGA8bWF0aD5gLlxuXHQgKlxuXHQgKiAqIGBodG1sYCAtIEFsbCByb290IG5vZGVzIGluIHRoZSB0ZW1wbGF0ZSBhcmUgSFRNTC4gUm9vdCBub2RlcyBtYXkgYWxzbyBiZVxuXHQgKiAgIHRvcC1sZXZlbCBlbGVtZW50cyBzdWNoIGFzIGA8c3ZnPmAgb3IgYDxtYXRoPmAuXG5cdCAqICogYHN2Z2AgLSBUaGUgcm9vdCBub2RlcyBpbiB0aGUgdGVtcGxhdGUgYXJlIFNWRyBlbGVtZW50cyAoZXhjbHVkaW5nIGA8bWF0aD5gKS5cblx0ICogKiBgbWF0aGAgLSBUaGUgcm9vdCBub2RlcyBpbiB0aGUgdGVtcGxhdGUgYXJlIE1hdGhNTCBlbGVtZW50cyAoZXhjbHVkaW5nIGA8c3ZnPmApLlxuXHQgKlxuXHQgKiBJZiBubyBgdGVtcGxhdGVOYW1lc3BhY2VgIGlzIHNwZWNpZmllZCwgdGhlbiB0aGUgbmFtZXNwYWNlIGlzIGNvbnNpZGVyZWQgdG8gYmUgYGh0bWxgLlxuXHQgKlxuXHQgKiAjIyMjIGB0ZW1wbGF0ZWBcblx0ICogSFRNTCBtYXJrdXAgdGhhdCBtYXk6XG5cdCAqICogUmVwbGFjZSB0aGUgY29udGVudHMgb2YgdGhlIGRpcmVjdGl2ZSdzIGVsZW1lbnQgKGRlZmF1bHQpLlxuXHQgKiAqIFJlcGxhY2UgdGhlIGRpcmVjdGl2ZSdzIGVsZW1lbnQgaXRzZWxmIChpZiBgcmVwbGFjZWAgaXMgdHJ1ZSAtIERFUFJFQ0FURUQpLlxuXHQgKiAqIFdyYXAgdGhlIGNvbnRlbnRzIG9mIHRoZSBkaXJlY3RpdmUncyBlbGVtZW50IChpZiBgdHJhbnNjbHVkZWAgaXMgdHJ1ZSkuXG5cdCAqXG5cdCAqIFZhbHVlIG1heSBiZTpcblx0ICpcblx0ICogKiBBIHN0cmluZy4gRm9yIGV4YW1wbGUgYDxkaXYgcmVkLW9uLWhvdmVyPnt7ZGVsZXRlX3N0cn19PC9kaXY+YC5cblx0ICogKiBBIGZ1bmN0aW9uIHdoaWNoIHRha2VzIHR3byBhcmd1bWVudHMgYHRFbGVtZW50YCBhbmQgYHRBdHRyc2AgKGRlc2NyaWJlZCBpbiB0aGUgYGNvbXBpbGVgXG5cdCAqICAgZnVuY3Rpb24gYXBpIGJlbG93KSBhbmQgcmV0dXJucyBhIHN0cmluZyB2YWx1ZS5cblx0ICpcblx0ICpcblx0ICogIyMjIyBgdGVtcGxhdGVVcmxgXG5cdCAqIFRoaXMgaXMgc2ltaWxhciB0byBgdGVtcGxhdGVgIGJ1dCB0aGUgdGVtcGxhdGUgaXMgbG9hZGVkIGZyb20gdGhlIHNwZWNpZmllZCBVUkwsIGFzeW5jaHJvbm91c2x5LlxuXHQgKlxuXHQgKiBCZWNhdXNlIHRlbXBsYXRlIGxvYWRpbmcgaXMgYXN5bmNocm9ub3VzIHRoZSBjb21waWxlciB3aWxsIHN1c3BlbmQgY29tcGlsYXRpb24gb2YgZGlyZWN0aXZlcyBvbiB0aGF0IGVsZW1lbnRcblx0ICogZm9yIGxhdGVyIHdoZW4gdGhlIHRlbXBsYXRlIGhhcyBiZWVuIHJlc29sdmVkLiAgSW4gdGhlIG1lYW50aW1lIGl0IHdpbGwgY29udGludWUgdG8gY29tcGlsZSBhbmQgbGlua1xuXHQgKiBzaWJsaW5nIGFuZCBwYXJlbnQgZWxlbWVudHMgYXMgdGhvdWdoIHRoaXMgZWxlbWVudCBoYWQgbm90IGNvbnRhaW5lZCBhbnkgZGlyZWN0aXZlcy5cblx0ICpcblx0ICogVGhlIGNvbXBpbGVyIGRvZXMgbm90IHN1c3BlbmQgdGhlIGVudGlyZSBjb21waWxhdGlvbiB0byB3YWl0IGZvciB0ZW1wbGF0ZXMgdG8gYmUgbG9hZGVkIGJlY2F1c2UgdGhpc1xuXHQgKiB3b3VsZCByZXN1bHQgaW4gdGhlIHdob2xlIGFwcCBcInN0YWxsaW5nXCIgdW50aWwgYWxsIHRlbXBsYXRlcyBhcmUgbG9hZGVkIGFzeW5jaHJvbm91c2x5IC0gZXZlbiBpbiB0aGVcblx0ICogY2FzZSB3aGVuIG9ubHkgb25lIGRlZXBseSBuZXN0ZWQgZGlyZWN0aXZlIGhhcyBgdGVtcGxhdGVVcmxgLlxuXHQgKlxuXHQgKiBUZW1wbGF0ZSBsb2FkaW5nIGlzIGFzeW5jaHJvbm91cyBldmVuIGlmIHRoZSB0ZW1wbGF0ZSBoYXMgYmVlbiBwcmVsb2FkZWQgaW50byB0aGUge0BsaW5rICR0ZW1wbGF0ZUNhY2hlfVxuXHQgKlxuXHQgKiBZb3UgY2FuIHNwZWNpZnkgYHRlbXBsYXRlVXJsYCBhcyBhIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIFVSTCBvciBhcyBhIGZ1bmN0aW9uIHdoaWNoIHRha2VzIHR3b1xuXHQgKiBhcmd1bWVudHMgYHRFbGVtZW50YCBhbmQgYHRBdHRyc2AgKGRlc2NyaWJlZCBpbiB0aGUgYGNvbXBpbGVgIGZ1bmN0aW9uIGFwaSBiZWxvdykgYW5kIHJldHVybnNcblx0ICogYSBzdHJpbmcgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSB1cmwuICBJbiBlaXRoZXIgY2FzZSwgdGhlIHRlbXBsYXRlIFVSTCBpcyBwYXNzZWQgdGhyb3VnaCB7QGxpbmtcblx0ICogJHNjZSNnZXRUcnVzdGVkUmVzb3VyY2VVcmwgJHNjZS5nZXRUcnVzdGVkUmVzb3VyY2VVcmx9LlxuXHQgKlxuXHQgKlxuXHQgKiAjIyMjIGByZXBsYWNlYCAoWypERVBSRUNBVEVEKiFdLCB3aWxsIGJlIHJlbW92ZWQgaW4gbmV4dCBtYWpvciByZWxlYXNlIC0gaS5lLiB2Mi4wKVxuXHQgKiBzcGVjaWZ5IHdoYXQgdGhlIHRlbXBsYXRlIHNob3VsZCByZXBsYWNlLiBEZWZhdWx0cyB0byBgZmFsc2VgLlxuXHQgKlxuXHQgKiAqIGB0cnVlYCAtIHRoZSB0ZW1wbGF0ZSB3aWxsIHJlcGxhY2UgdGhlIGRpcmVjdGl2ZSdzIGVsZW1lbnQuXG5cdCAqICogYGZhbHNlYCAtIHRoZSB0ZW1wbGF0ZSB3aWxsIHJlcGxhY2UgdGhlIGNvbnRlbnRzIG9mIHRoZSBkaXJlY3RpdmUncyBlbGVtZW50LlxuXHQgKlxuXHQgKiBUaGUgcmVwbGFjZW1lbnQgcHJvY2VzcyBtaWdyYXRlcyBhbGwgb2YgdGhlIGF0dHJpYnV0ZXMgLyBjbGFzc2VzIGZyb20gdGhlIG9sZCBlbGVtZW50IHRvIHRoZSBuZXdcblx0ICogb25lLiBTZWUgdGhlIHtAbGluayBndWlkZS9kaXJlY3RpdmUjdGVtcGxhdGUtZXhwYW5kaW5nLWRpcmVjdGl2ZVxuXHQgKiBEaXJlY3RpdmVzIEd1aWRlfSBmb3IgYW4gZXhhbXBsZS5cblx0ICpcblx0ICogVGhlcmUgYXJlIHZlcnkgZmV3IHNjZW5hcmlvcyB3aGVyZSBlbGVtZW50IHJlcGxhY2VtZW50IGlzIHJlcXVpcmVkIGZvciB0aGUgYXBwbGljYXRpb24gZnVuY3Rpb24sXG5cdCAqIHRoZSBtYWluIG9uZSBiZWluZyByZXVzYWJsZSBjdXN0b20gY29tcG9uZW50cyB0aGF0IGFyZSB1c2VkIHdpdGhpbiBTVkcgY29udGV4dHNcblx0ICogKGJlY2F1c2UgU1ZHIGRvZXNuJ3Qgd29yayB3aXRoIGN1c3RvbSBlbGVtZW50cyBpbiB0aGUgRE9NIHRyZWUpLlxuXHQgKlxuXHQgKiAjIyMjIGB0cmFuc2NsdWRlYFxuXHQgKiBFeHRyYWN0IHRoZSBjb250ZW50cyBvZiB0aGUgZWxlbWVudCB3aGVyZSB0aGUgZGlyZWN0aXZlIGFwcGVhcnMgYW5kIG1ha2UgaXQgYXZhaWxhYmxlIHRvIHRoZSBkaXJlY3RpdmUuXG5cdCAqIFRoZSBjb250ZW50cyBhcmUgY29tcGlsZWQgYW5kIHByb3ZpZGVkIHRvIHRoZSBkaXJlY3RpdmUgYXMgYSAqKnRyYW5zY2x1c2lvbiBmdW5jdGlvbioqLiBTZWUgdGhlXG5cdCAqIHtAbGluayAkY29tcGlsZSN0cmFuc2NsdXNpb24gVHJhbnNjbHVzaW9ufSBzZWN0aW9uIGJlbG93LlxuXHQgKlxuXHQgKlxuXHQgKiAjIyMjIGBjb21waWxlYFxuXHQgKlxuXHQgKiBgYGBqc1xuXHQgKiAgIGZ1bmN0aW9uIGNvbXBpbGUodEVsZW1lbnQsIHRBdHRycywgdHJhbnNjbHVkZSkgeyAuLi4gfVxuXHQgKiBgYGBcblx0ICpcblx0ICogVGhlIGNvbXBpbGUgZnVuY3Rpb24gZGVhbHMgd2l0aCB0cmFuc2Zvcm1pbmcgdGhlIHRlbXBsYXRlIERPTS4gU2luY2UgbW9zdCBkaXJlY3RpdmVzIGRvIG5vdCBkb1xuXHQgKiB0ZW1wbGF0ZSB0cmFuc2Zvcm1hdGlvbiwgaXQgaXMgbm90IHVzZWQgb2Z0ZW4uIFRoZSBjb21waWxlIGZ1bmN0aW9uIHRha2VzIHRoZSBmb2xsb3dpbmcgYXJndW1lbnRzOlxuXHQgKlxuXHQgKiAgICogYHRFbGVtZW50YCAtIHRlbXBsYXRlIGVsZW1lbnQgLSBUaGUgZWxlbWVudCB3aGVyZSB0aGUgZGlyZWN0aXZlIGhhcyBiZWVuIGRlY2xhcmVkLiBJdCBpc1xuXHQgKiAgICAgc2FmZSB0byBkbyB0ZW1wbGF0ZSB0cmFuc2Zvcm1hdGlvbiBvbiB0aGUgZWxlbWVudCBhbmQgY2hpbGQgZWxlbWVudHMgb25seS5cblx0ICpcblx0ICogICAqIGB0QXR0cnNgIC0gdGVtcGxhdGUgYXR0cmlidXRlcyAtIE5vcm1hbGl6ZWQgbGlzdCBvZiBhdHRyaWJ1dGVzIGRlY2xhcmVkIG9uIHRoaXMgZWxlbWVudCBzaGFyZWRcblx0ICogICAgIGJldHdlZW4gYWxsIGRpcmVjdGl2ZSBjb21waWxlIGZ1bmN0aW9ucy5cblx0ICpcblx0ICogICAqIGB0cmFuc2NsdWRlYCAtICBbKkRFUFJFQ0FURUQqIV0gQSB0cmFuc2NsdWRlIGxpbmtpbmcgZnVuY3Rpb246IGBmdW5jdGlvbihzY29wZSwgY2xvbmVMaW5raW5nRm4pYFxuXHQgKlxuXHQgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuXHQgKiAqKk5vdGU6KiogVGhlIHRlbXBsYXRlIGluc3RhbmNlIGFuZCB0aGUgbGluayBpbnN0YW5jZSBtYXkgYmUgZGlmZmVyZW50IG9iamVjdHMgaWYgdGhlIHRlbXBsYXRlIGhhc1xuXHQgKiBiZWVuIGNsb25lZC4gRm9yIHRoaXMgcmVhc29uIGl0IGlzICoqbm90Kiogc2FmZSB0byBkbyBhbnl0aGluZyBvdGhlciB0aGFuIERPTSB0cmFuc2Zvcm1hdGlvbnMgdGhhdFxuXHQgKiBhcHBseSB0byBhbGwgY2xvbmVkIERPTSBub2RlcyB3aXRoaW4gdGhlIGNvbXBpbGUgZnVuY3Rpb24uIFNwZWNpZmljYWxseSwgRE9NIGxpc3RlbmVyIHJlZ2lzdHJhdGlvblxuXHQgKiBzaG91bGQgYmUgZG9uZSBpbiBhIGxpbmtpbmcgZnVuY3Rpb24gcmF0aGVyIHRoYW4gaW4gYSBjb21waWxlIGZ1bmN0aW9uLlxuXHQgKiA8L2Rpdj5cblx0XG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG5cdCAqICoqTm90ZToqKiBUaGUgY29tcGlsZSBmdW5jdGlvbiBjYW5ub3QgaGFuZGxlIGRpcmVjdGl2ZXMgdGhhdCByZWN1cnNpdmVseSB1c2UgdGhlbXNlbHZlcyBpbiB0aGVpclxuXHQgKiBvd24gdGVtcGxhdGVzIG9yIGNvbXBpbGUgZnVuY3Rpb25zLiBDb21waWxpbmcgdGhlc2UgZGlyZWN0aXZlcyByZXN1bHRzIGluIGFuIGluZmluaXRlIGxvb3AgYW5kXG5cdCAqIHN0YWNrIG92ZXJmbG93IGVycm9ycy5cblx0ICpcblx0ICogVGhpcyBjYW4gYmUgYXZvaWRlZCBieSBtYW51YWxseSB1c2luZyAkY29tcGlsZSBpbiB0aGUgcG9zdExpbmsgZnVuY3Rpb24gdG8gaW1wZXJhdGl2ZWx5IGNvbXBpbGVcblx0ICogYSBkaXJlY3RpdmUncyB0ZW1wbGF0ZSBpbnN0ZWFkIG9mIHJlbHlpbmcgb24gYXV0b21hdGljIHRlbXBsYXRlIGNvbXBpbGF0aW9uIHZpYSBgdGVtcGxhdGVgIG9yXG5cdCAqIGB0ZW1wbGF0ZVVybGAgZGVjbGFyYXRpb24gb3IgbWFudWFsIGNvbXBpbGF0aW9uIGluc2lkZSB0aGUgY29tcGlsZSBmdW5jdGlvbi5cblx0ICogPC9kaXY+XG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1kYW5nZXJcIj5cblx0ICogKipOb3RlOioqIFRoZSBgdHJhbnNjbHVkZWAgZnVuY3Rpb24gdGhhdCBpcyBwYXNzZWQgdG8gdGhlIGNvbXBpbGUgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZCwgYXMgaXRcblx0ICogICBlLmcuIGRvZXMgbm90IGtub3cgYWJvdXQgdGhlIHJpZ2h0IG91dGVyIHNjb3BlLiBQbGVhc2UgdXNlIHRoZSB0cmFuc2NsdWRlIGZ1bmN0aW9uIHRoYXQgaXMgcGFzc2VkXG5cdCAqICAgdG8gdGhlIGxpbmsgZnVuY3Rpb24gaW5zdGVhZC5cblx0ICogPC9kaXY+XG5cdFxuXHQgKiBBIGNvbXBpbGUgZnVuY3Rpb24gY2FuIGhhdmUgYSByZXR1cm4gdmFsdWUgd2hpY2ggY2FuIGJlIGVpdGhlciBhIGZ1bmN0aW9uIG9yIGFuIG9iamVjdC5cblx0ICpcblx0ICogKiByZXR1cm5pbmcgYSAocG9zdC1saW5rKSBmdW5jdGlvbiAtIGlzIGVxdWl2YWxlbnQgdG8gcmVnaXN0ZXJpbmcgdGhlIGxpbmtpbmcgZnVuY3Rpb24gdmlhIHRoZVxuXHQgKiAgIGBsaW5rYCBwcm9wZXJ0eSBvZiB0aGUgY29uZmlnIG9iamVjdCB3aGVuIHRoZSBjb21waWxlIGZ1bmN0aW9uIGlzIGVtcHR5LlxuXHQgKlxuXHQgKiAqIHJldHVybmluZyBhbiBvYmplY3Qgd2l0aCBmdW5jdGlvbihzKSByZWdpc3RlcmVkIHZpYSBgcHJlYCBhbmQgYHBvc3RgIHByb3BlcnRpZXMgLSBhbGxvd3MgeW91IHRvXG5cdCAqICAgY29udHJvbCB3aGVuIGEgbGlua2luZyBmdW5jdGlvbiBzaG91bGQgYmUgY2FsbGVkIGR1cmluZyB0aGUgbGlua2luZyBwaGFzZS4gU2VlIGluZm8gYWJvdXRcblx0ICogICBwcmUtbGlua2luZyBhbmQgcG9zdC1saW5raW5nIGZ1bmN0aW9ucyBiZWxvdy5cblx0ICpcblx0ICpcblx0ICogIyMjIyBgbGlua2Bcblx0ICogVGhpcyBwcm9wZXJ0eSBpcyB1c2VkIG9ubHkgaWYgdGhlIGBjb21waWxlYCBwcm9wZXJ0eSBpcyBub3QgZGVmaW5lZC5cblx0ICpcblx0ICogYGBganNcblx0ICogICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBpRWxlbWVudCwgaUF0dHJzLCBjb250cm9sbGVyLCB0cmFuc2NsdWRlRm4pIHsgLi4uIH1cblx0ICogYGBgXG5cdCAqXG5cdCAqIFRoZSBsaW5rIGZ1bmN0aW9uIGlzIHJlc3BvbnNpYmxlIGZvciByZWdpc3RlcmluZyBET00gbGlzdGVuZXJzIGFzIHdlbGwgYXMgdXBkYXRpbmcgdGhlIERPTS4gSXQgaXNcblx0ICogZXhlY3V0ZWQgYWZ0ZXIgdGhlIHRlbXBsYXRlIGhhcyBiZWVuIGNsb25lZC4gVGhpcyBpcyB3aGVyZSBtb3N0IG9mIHRoZSBkaXJlY3RpdmUgbG9naWMgd2lsbCBiZVxuXHQgKiBwdXQuXG5cdCAqXG5cdCAqICAgKiBgc2NvcGVgIC0ge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUgU2NvcGV9IC0gVGhlIHNjb3BlIHRvIGJlIHVzZWQgYnkgdGhlXG5cdCAqICAgICBkaXJlY3RpdmUgZm9yIHJlZ2lzdGVyaW5nIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyR3YXRjaCB3YXRjaGVzfS5cblx0ICpcblx0ICogICAqIGBpRWxlbWVudGAgLSBpbnN0YW5jZSBlbGVtZW50IC0gVGhlIGVsZW1lbnQgd2hlcmUgdGhlIGRpcmVjdGl2ZSBpcyB0byBiZSB1c2VkLiBJdCBpcyBzYWZlIHRvXG5cdCAqICAgICBtYW5pcHVsYXRlIHRoZSBjaGlsZHJlbiBvZiB0aGUgZWxlbWVudCBvbmx5IGluIGBwb3N0TGlua2AgZnVuY3Rpb24gc2luY2UgdGhlIGNoaWxkcmVuIGhhdmVcblx0ICogICAgIGFscmVhZHkgYmVlbiBsaW5rZWQuXG5cdCAqXG5cdCAqICAgKiBgaUF0dHJzYCAtIGluc3RhbmNlIGF0dHJpYnV0ZXMgLSBOb3JtYWxpemVkIGxpc3Qgb2YgYXR0cmlidXRlcyBkZWNsYXJlZCBvbiB0aGlzIGVsZW1lbnQgc2hhcmVkXG5cdCAqICAgICBiZXR3ZWVuIGFsbCBkaXJlY3RpdmUgbGlua2luZyBmdW5jdGlvbnMuXG5cdCAqXG5cdCAqICAgKiBgY29udHJvbGxlcmAgLSB0aGUgZGlyZWN0aXZlJ3MgcmVxdWlyZWQgY29udHJvbGxlciBpbnN0YW5jZShzKSAtIEluc3RhbmNlcyBhcmUgc2hhcmVkXG5cdCAqICAgICBhbW9uZyBhbGwgZGlyZWN0aXZlcywgd2hpY2ggYWxsb3dzIHRoZSBkaXJlY3RpdmVzIHRvIHVzZSB0aGUgY29udHJvbGxlcnMgYXMgYSBjb21tdW5pY2F0aW9uXG5cdCAqICAgICBjaGFubmVsLiBUaGUgZXhhY3QgdmFsdWUgZGVwZW5kcyBvbiB0aGUgZGlyZWN0aXZlJ3MgYHJlcXVpcmVgIHByb3BlcnR5OlxuXHQgKiAgICAgICAqIG5vIGNvbnRyb2xsZXIocykgcmVxdWlyZWQ6IHRoZSBkaXJlY3RpdmUncyBvd24gY29udHJvbGxlciwgb3IgYHVuZGVmaW5lZGAgaWYgaXQgZG9lc24ndCBoYXZlIG9uZVxuXHQgKiAgICAgICAqIGBzdHJpbmdgOiB0aGUgY29udHJvbGxlciBpbnN0YW5jZVxuXHQgKiAgICAgICAqIGBhcnJheWA6IGFycmF5IG9mIGNvbnRyb2xsZXIgaW5zdGFuY2VzXG5cdCAqXG5cdCAqICAgICBJZiBhIHJlcXVpcmVkIGNvbnRyb2xsZXIgY2Fubm90IGJlIGZvdW5kLCBhbmQgaXQgaXMgb3B0aW9uYWwsIHRoZSBpbnN0YW5jZSBpcyBgbnVsbGAsXG5cdCAqICAgICBvdGhlcndpc2UgdGhlIHtAbGluayBlcnJvcjokY29tcGlsZTpjdHJlcSBNaXNzaW5nIFJlcXVpcmVkIENvbnRyb2xsZXJ9IGVycm9yIGlzIHRocm93bi5cblx0ICpcblx0ICogICAgIE5vdGUgdGhhdCB5b3UgY2FuIGFsc28gcmVxdWlyZSB0aGUgZGlyZWN0aXZlJ3Mgb3duIGNvbnRyb2xsZXIgLSBpdCB3aWxsIGJlIG1hZGUgYXZhaWxhYmxlIGxpa2Vcblx0ICogICAgIGFueSBvdGhlciBjb250cm9sbGVyLlxuXHQgKlxuXHQgKiAgICogYHRyYW5zY2x1ZGVGbmAgLSBBIHRyYW5zY2x1ZGUgbGlua2luZyBmdW5jdGlvbiBwcmUtYm91bmQgdG8gdGhlIGNvcnJlY3QgdHJhbnNjbHVzaW9uIHNjb3BlLlxuXHQgKiAgICAgVGhpcyBpcyB0aGUgc2FtZSBhcyB0aGUgYCR0cmFuc2NsdWRlYFxuXHQgKiAgICAgcGFyYW1ldGVyIG9mIGRpcmVjdGl2ZSBjb250cm9sbGVycywgc2VlIHRoZXJlIGZvciBkZXRhaWxzLlxuXHQgKiAgICAgYGZ1bmN0aW9uKFtzY29wZV0sIGNsb25lTGlua2luZ0ZuLCBmdXR1cmVQYXJlbnRFbGVtZW50KWAuXG5cdCAqXG5cdCAqICMjIyMgUHJlLWxpbmtpbmcgZnVuY3Rpb25cblx0ICpcblx0ICogRXhlY3V0ZWQgYmVmb3JlIHRoZSBjaGlsZCBlbGVtZW50cyBhcmUgbGlua2VkLiBOb3Qgc2FmZSB0byBkbyBET00gdHJhbnNmb3JtYXRpb24gc2luY2UgdGhlXG5cdCAqIGNvbXBpbGVyIGxpbmtpbmcgZnVuY3Rpb24gd2lsbCBmYWlsIHRvIGxvY2F0ZSB0aGUgY29ycmVjdCBlbGVtZW50cyBmb3IgbGlua2luZy5cblx0ICpcblx0ICogIyMjIyBQb3N0LWxpbmtpbmcgZnVuY3Rpb25cblx0ICpcblx0ICogRXhlY3V0ZWQgYWZ0ZXIgdGhlIGNoaWxkIGVsZW1lbnRzIGFyZSBsaW5rZWQuXG5cdCAqXG5cdCAqIE5vdGUgdGhhdCBjaGlsZCBlbGVtZW50cyB0aGF0IGNvbnRhaW4gYHRlbXBsYXRlVXJsYCBkaXJlY3RpdmVzIHdpbGwgbm90IGhhdmUgYmVlbiBjb21waWxlZFxuXHQgKiBhbmQgbGlua2VkIHNpbmNlIHRoZXkgYXJlIHdhaXRpbmcgZm9yIHRoZWlyIHRlbXBsYXRlIHRvIGxvYWQgYXN5bmNocm9ub3VzbHkgYW5kIHRoZWlyIG93blxuXHQgKiBjb21waWxhdGlvbiBhbmQgbGlua2luZyBoYXMgYmVlbiBzdXNwZW5kZWQgdW50aWwgdGhhdCBvY2N1cnMuXG5cdCAqXG5cdCAqIEl0IGlzIHNhZmUgdG8gZG8gRE9NIHRyYW5zZm9ybWF0aW9uIGluIHRoZSBwb3N0LWxpbmtpbmcgZnVuY3Rpb24gb24gZWxlbWVudHMgdGhhdCBhcmUgbm90IHdhaXRpbmdcblx0ICogZm9yIHRoZWlyIGFzeW5jIHRlbXBsYXRlcyB0byBiZSByZXNvbHZlZC5cblx0ICpcblx0ICpcblx0ICogIyMjIFRyYW5zY2x1c2lvblxuXHQgKlxuXHQgKiBUcmFuc2NsdXNpb24gaXMgdGhlIHByb2Nlc3Mgb2YgZXh0cmFjdGluZyBhIGNvbGxlY3Rpb24gb2YgRE9NIGVsZW1lbnRzIGZyb20gb25lIHBhcnQgb2YgdGhlIERPTSBhbmRcblx0ICogY29weWluZyB0aGVtIHRvIGFub3RoZXIgcGFydCBvZiB0aGUgRE9NLCB3aGlsZSBtYWludGFpbmluZyB0aGVpciBjb25uZWN0aW9uIHRvIHRoZSBvcmlnaW5hbCBBbmd1bGFySlNcblx0ICogc2NvcGUgZnJvbSB3aGVyZSB0aGV5IHdlcmUgdGFrZW4uXG5cdCAqXG5cdCAqIFRyYW5zY2x1c2lvbiBpcyB1c2VkIChvZnRlbiB3aXRoIHtAbGluayBuZ1RyYW5zY2x1ZGV9KSB0byBpbnNlcnQgdGhlXG5cdCAqIG9yaWdpbmFsIGNvbnRlbnRzIG9mIGEgZGlyZWN0aXZlJ3MgZWxlbWVudCBpbnRvIGEgc3BlY2lmaWVkIHBsYWNlIGluIHRoZSB0ZW1wbGF0ZSBvZiB0aGUgZGlyZWN0aXZlLlxuXHQgKiBUaGUgYmVuZWZpdCBvZiB0cmFuc2NsdXNpb24sIG92ZXIgc2ltcGx5IG1vdmluZyB0aGUgRE9NIGVsZW1lbnRzIG1hbnVhbGx5LCBpcyB0aGF0IHRoZSB0cmFuc2NsdWRlZFxuXHQgKiBjb250ZW50IGhhcyBhY2Nlc3MgdG8gdGhlIHByb3BlcnRpZXMgb24gdGhlIHNjb3BlIGZyb20gd2hpY2ggaXQgd2FzIHRha2VuLCBldmVuIGlmIHRoZSBkaXJlY3RpdmVcblx0ICogaGFzIGlzb2xhdGVkIHNjb3BlLlxuXHQgKiBTZWUgdGhlIHtAbGluayBndWlkZS9kaXJlY3RpdmUjY3JlYXRpbmctYS1kaXJlY3RpdmUtdGhhdC13cmFwcy1vdGhlci1lbGVtZW50cyBEaXJlY3RpdmVzIEd1aWRlfS5cblx0ICpcblx0ICogVGhpcyBtYWtlcyBpdCBwb3NzaWJsZSBmb3IgdGhlIHdpZGdldCB0byBoYXZlIHByaXZhdGUgc3RhdGUgZm9yIGl0cyB0ZW1wbGF0ZSwgd2hpbGUgdGhlIHRyYW5zY2x1ZGVkXG5cdCAqIGNvbnRlbnQgaGFzIGFjY2VzcyB0byBpdHMgb3JpZ2luYXRpbmcgc2NvcGUuXG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG5cdCAqICoqTm90ZToqKiBXaGVuIHRlc3RpbmcgYW4gZWxlbWVudCB0cmFuc2NsdWRlIGRpcmVjdGl2ZSB5b3UgbXVzdCBub3QgcGxhY2UgdGhlIGRpcmVjdGl2ZSBhdCB0aGUgcm9vdCBvZiB0aGVcblx0ICogRE9NIGZyYWdtZW50IHRoYXQgaXMgYmVpbmcgY29tcGlsZWQuIFNlZSB7QGxpbmsgZ3VpZGUvdW5pdC10ZXN0aW5nI3Rlc3RpbmctdHJhbnNjbHVzaW9uLWRpcmVjdGl2ZXNcblx0ICogVGVzdGluZyBUcmFuc2NsdXNpb24gRGlyZWN0aXZlc30uXG5cdCAqIDwvZGl2PlxuXHQgKlxuXHQgKiBUaGVyZSBhcmUgdGhyZWUga2luZHMgb2YgdHJhbnNjbHVzaW9uIGRlcGVuZGluZyB1cG9uIHdoZXRoZXIgeW91IHdhbnQgdG8gdHJhbnNjbHVkZSBqdXN0IHRoZSBjb250ZW50cyBvZiB0aGVcblx0ICogZGlyZWN0aXZlJ3MgZWxlbWVudCwgdGhlIGVudGlyZSBlbGVtZW50IG9yIG11bHRpcGxlIHBhcnRzIG9mIHRoZSBlbGVtZW50IGNvbnRlbnRzOlxuXHQgKlxuXHQgKiAqIGB0cnVlYCAtIHRyYW5zY2x1ZGUgdGhlIGNvbnRlbnQgKGkuZS4gdGhlIGNoaWxkIG5vZGVzKSBvZiB0aGUgZGlyZWN0aXZlJ3MgZWxlbWVudC5cblx0ICogKiBgJ2VsZW1lbnQnYCAtIHRyYW5zY2x1ZGUgdGhlIHdob2xlIG9mIHRoZSBkaXJlY3RpdmUncyBlbGVtZW50IGluY2x1ZGluZyBhbnkgZGlyZWN0aXZlcyBvbiB0aGlzXG5cdCAqICAgZWxlbWVudCB0aGF0IGRlZmluZWQgYXQgYSBsb3dlciBwcmlvcml0eSB0aGFuIHRoaXMgZGlyZWN0aXZlLiBXaGVuIHVzZWQsIHRoZSBgdGVtcGxhdGVgXG5cdCAqICAgcHJvcGVydHkgaXMgaWdub3JlZC5cblx0ICogKiAqKmB7Li4ufWAgKGFuIG9iamVjdCBoYXNoKToqKiAtIG1hcCBlbGVtZW50cyBvZiB0aGUgY29udGVudCBvbnRvIHRyYW5zY2x1c2lvbiBcInNsb3RzXCIgaW4gdGhlIHRlbXBsYXRlLlxuXHQgKlxuXHQgKiAqKk11bHQtc2xvdCB0cmFuc2NsdXNpb24qKiBpcyBkZWNsYXJlZCBieSBwcm92aWRpbmcgYW4gb2JqZWN0IGZvciB0aGUgYHRyYW5zY2x1ZGVgIHByb3BlcnR5LlxuXHQgKlxuXHQgKiBUaGlzIG9iamVjdCBpcyBhIG1hcCB3aGVyZSB0aGUga2V5cyBhcmUgdGhlIG5hbWUgb2YgdGhlIHNsb3QgdG8gZmlsbCBhbmQgdGhlIHZhbHVlIGlzIGFuIGVsZW1lbnQgc2VsZWN0b3Jcblx0ICogdXNlZCB0byBtYXRjaCB0aGUgSFRNTCB0byB0aGUgc2xvdC4gVGhlIGVsZW1lbnQgc2VsZWN0b3Igc2hvdWxkIGJlIGluIG5vcm1hbGl6ZWQgZm9ybSAoZS5nLiBgbXlFbGVtZW50YClcblx0ICogYW5kIHdpbGwgbWF0Y2ggdGhlIHN0YW5kYXJkIGVsZW1lbnQgdmFyaWFudHMgKGUuZy4gYG15LWVsZW1lbnRgLCBgbXk6ZWxlbWVudGAsIGBkYXRhLW15LWVsZW1lbnRgLCBldGMpLlxuXHQgKlxuXHQgKiBGb3IgZnVydGhlciBpbmZvcm1hdGlvbiBjaGVjayBvdXQgdGhlIGd1aWRlIG9uIHtAbGluayBndWlkZS9kaXJlY3RpdmUjbWF0Y2hpbmctZGlyZWN0aXZlcyBNYXRjaGluZyBEaXJlY3RpdmVzfVxuXHQgKlxuXHQgKiBJZiB0aGUgZWxlbWVudCBzZWxlY3RvciBpcyBwcmVmaXhlZCB3aXRoIGEgYD9gIHRoZW4gdGhhdCBzbG90IGlzIG9wdGlvbmFsLlxuXHQgKlxuXHQgKiBGb3IgZXhhbXBsZSwgdGhlIHRyYW5zY2x1ZGUgb2JqZWN0IGB7IHNsb3RBOiAnP215Q3VzdG9tRWxlbWVudCcgfWAgbWFwcyBgPG15LWN1c3RvbS1lbGVtZW50PmAgZWxlbWVudHMgdG9cblx0ICogdGhlIGBzbG90QWAgc2xvdCwgd2hpY2ggY2FuIGJlIGFjY2Vzc2VkIHZpYSB0aGUgYCR0cmFuc2NsdWRlYCBmdW5jdGlvbiBvciB2aWEgdGhlIHtAbGluayBuZ1RyYW5zY2x1ZGV9IGRpcmVjdGl2ZS5cblx0ICpcblx0ICogU2xvdHMgdGhhdCBhcmUgbm90IG1hcmtlZCBhcyBvcHRpb25hbCAoYD9gKSB3aWxsIHRyaWdnZXIgYSBjb21waWxlIHRpbWUgZXJyb3IgaWYgdGhlcmUgYXJlIG5vIG1hdGNoaW5nIGVsZW1lbnRzXG5cdCAqIGluIHRoZSB0cmFuc2NsdWRlIGNvbnRlbnQuIElmIHlvdSB3aXNoIHRvIGtub3cgaWYgYW4gb3B0aW9uYWwgc2xvdCB3YXMgZmlsbGVkIHdpdGggY29udGVudCwgdGhlbiB5b3UgY2FuIGNhbGxcblx0ICogYCR0cmFuc2NsdWRlLmlzU2xvdEZpbGxlZChzbG90TmFtZSlgIG9uIHRoZSB0cmFuc2NsdWRlIGZ1bmN0aW9uIHBhc3NlZCB0byB0aGUgZGlyZWN0aXZlJ3MgbGluayBmdW5jdGlvbiBhbmRcblx0ICogaW5qZWN0YWJsZSBpbnRvIHRoZSBkaXJlY3RpdmUncyBjb250cm9sbGVyLlxuXHQgKlxuXHQgKlxuXHQgKiAjIyMjIFRyYW5zY2x1c2lvbiBGdW5jdGlvbnNcblx0ICpcblx0ICogV2hlbiBhIGRpcmVjdGl2ZSByZXF1ZXN0cyB0cmFuc2NsdXNpb24sIHRoZSBjb21waWxlciBleHRyYWN0cyBpdHMgY29udGVudHMgYW5kIHByb3ZpZGVzIGEgKip0cmFuc2NsdXNpb25cblx0ICogZnVuY3Rpb24qKiB0byB0aGUgZGlyZWN0aXZlJ3MgYGxpbmtgIGZ1bmN0aW9uIGFuZCBgY29udHJvbGxlcmAuIFRoaXMgdHJhbnNjbHVzaW9uIGZ1bmN0aW9uIGlzIGEgc3BlY2lhbFxuXHQgKiAqKmxpbmtpbmcgZnVuY3Rpb24qKiB0aGF0IHdpbGwgcmV0dXJuIHRoZSBjb21waWxlZCBjb250ZW50cyBsaW5rZWQgdG8gYSBuZXcgdHJhbnNjbHVzaW9uIHNjb3BlLlxuXHQgKlxuXHQgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtaW5mb1wiPlxuXHQgKiBJZiB5b3UgYXJlIGp1c3QgdXNpbmcge0BsaW5rIG5nVHJhbnNjbHVkZX0gdGhlbiB5b3UgZG9uJ3QgbmVlZCB0byB3b3JyeSBhYm91dCB0aGlzIGZ1bmN0aW9uLCBzaW5jZVxuXHQgKiBuZ1RyYW5zY2x1ZGUgd2lsbCBkZWFsIHdpdGggaXQgZm9yIHVzLlxuXHQgKiA8L2Rpdj5cblx0ICpcblx0ICogSWYgeW91IHdhbnQgdG8gbWFudWFsbHkgY29udHJvbCB0aGUgaW5zZXJ0aW9uIGFuZCByZW1vdmFsIG9mIHRoZSB0cmFuc2NsdWRlZCBjb250ZW50IGluIHlvdXIgZGlyZWN0aXZlXG5cdCAqIHRoZW4geW91IG11c3QgdXNlIHRoaXMgdHJhbnNjbHVkZSBmdW5jdGlvbi4gV2hlbiB5b3UgY2FsbCBhIHRyYW5zY2x1ZGUgZnVuY3Rpb24gaXQgcmV0dXJucyBhIGEganFMaXRlL0pRdWVyeVxuXHQgKiBvYmplY3QgdGhhdCBjb250YWlucyB0aGUgY29tcGlsZWQgRE9NLCB3aGljaCBpcyBsaW5rZWQgdG8gdGhlIGNvcnJlY3QgdHJhbnNjbHVzaW9uIHNjb3BlLlxuXHQgKlxuXHQgKiBXaGVuIHlvdSBjYWxsIGEgdHJhbnNjbHVzaW9uIGZ1bmN0aW9uIHlvdSBjYW4gcGFzcyBpbiBhICoqY2xvbmUgYXR0YWNoIGZ1bmN0aW9uKiouIFRoaXMgZnVuY3Rpb24gYWNjZXB0c1xuXHQgKiB0d28gcGFyYW1ldGVycywgYGZ1bmN0aW9uKGNsb25lLCBzY29wZSkgeyAuLi4gfWAsIHdoZXJlIHRoZSBgY2xvbmVgIGlzIGEgZnJlc2ggY29tcGlsZWQgY29weSBvZiB5b3VyIHRyYW5zY2x1ZGVkXG5cdCAqIGNvbnRlbnQgYW5kIHRoZSBgc2NvcGVgIGlzIHRoZSBuZXdseSBjcmVhdGVkIHRyYW5zY2x1c2lvbiBzY29wZSwgdG8gd2hpY2ggdGhlIGNsb25lIGlzIGJvdW5kLlxuXHQgKlxuXHQgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtaW5mb1wiPlxuXHQgKiAqKkJlc3QgUHJhY3RpY2UqKjogQWx3YXlzIHByb3ZpZGUgYSBgY2xvbmVGbmAgKGNsb25lIGF0dGFjaCBmdW5jdGlvbikgd2hlbiB5b3UgY2FsbCBhIHRyYW5zY2x1ZGUgZnVuY3Rpb25cblx0ICogc2luY2UgeW91IHRoZW4gZ2V0IGEgZnJlc2ggY2xvbmUgb2YgdGhlIG9yaWdpbmFsIERPTSBhbmQgYWxzbyBoYXZlIGFjY2VzcyB0byB0aGUgbmV3IHRyYW5zY2x1c2lvbiBzY29wZS5cblx0ICogPC9kaXY+XG5cdCAqXG5cdCAqIEl0IGlzIG5vcm1hbCBwcmFjdGljZSB0byBhdHRhY2ggeW91ciB0cmFuc2NsdWRlZCBjb250ZW50IChgY2xvbmVgKSB0byB0aGUgRE9NIGluc2lkZSB5b3VyICoqY2xvbmVcblx0ICogYXR0YWNoIGZ1bmN0aW9uKio6XG5cdCAqXG5cdCAqIGBgYGpzXG5cdCAqIHZhciB0cmFuc2NsdWRlZENvbnRlbnQsIHRyYW5zY2x1c2lvblNjb3BlO1xuXHQgKlxuXHQgKiAkdHJhbnNjbHVkZShmdW5jdGlvbihjbG9uZSwgc2NvcGUpIHtcblx0ICogICBlbGVtZW50LmFwcGVuZChjbG9uZSk7XG5cdCAqICAgdHJhbnNjbHVkZWRDb250ZW50ID0gY2xvbmU7XG5cdCAqICAgdHJhbnNjbHVzaW9uU2NvcGUgPSBzY29wZTtcblx0ICogfSk7XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBMYXRlciwgaWYgeW91IHdhbnQgdG8gcmVtb3ZlIHRoZSB0cmFuc2NsdWRlZCBjb250ZW50IGZyb20geW91ciBET00gdGhlbiB5b3Ugc2hvdWxkIGFsc28gZGVzdHJveSB0aGVcblx0ICogYXNzb2NpYXRlZCB0cmFuc2NsdXNpb24gc2NvcGU6XG5cdCAqXG5cdCAqIGBgYGpzXG5cdCAqIHRyYW5zY2x1ZGVkQ29udGVudC5yZW1vdmUoKTtcblx0ICogdHJhbnNjbHVzaW9uU2NvcGUuJGRlc3Ryb3koKTtcblx0ICogYGBgXG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1pbmZvXCI+XG5cdCAqICoqQmVzdCBQcmFjdGljZSoqOiBpZiB5b3UgaW50ZW5kIHRvIGFkZCBhbmQgcmVtb3ZlIHRyYW5zY2x1ZGVkIGNvbnRlbnQgbWFudWFsbHkgaW4geW91ciBkaXJlY3RpdmVcblx0ICogKGJ5IGNhbGxpbmcgdGhlIHRyYW5zY2x1ZGUgZnVuY3Rpb24gdG8gZ2V0IHRoZSBET00gYW5kIGNhbGxpbmcgYGVsZW1lbnQucmVtb3ZlKClgIHRvIHJlbW92ZSBpdCksXG5cdCAqIHRoZW4geW91IGFyZSBhbHNvIHJlc3BvbnNpYmxlIGZvciBjYWxsaW5nIGAkZGVzdHJveWAgb24gdGhlIHRyYW5zY2x1c2lvbiBzY29wZS5cblx0ICogPC9kaXY+XG5cdCAqXG5cdCAqIFRoZSBidWlsdC1pbiBET00gbWFuaXB1bGF0aW9uIGRpcmVjdGl2ZXMsIHN1Y2ggYXMge0BsaW5rIG5nSWZ9LCB7QGxpbmsgbmdTd2l0Y2h9IGFuZCB7QGxpbmsgbmdSZXBlYXR9XG5cdCAqIGF1dG9tYXRpY2FsbHkgZGVzdHJveSB0aGVpciB0cmFuc2NsdWRlZCBjbG9uZXMgYXMgbmVjZXNzYXJ5IHNvIHlvdSBkbyBub3QgbmVlZCB0byB3b3JyeSBhYm91dCB0aGlzIGlmXG5cdCAqIHlvdSBhcmUgc2ltcGx5IHVzaW5nIHtAbGluayBuZ1RyYW5zY2x1ZGV9IHRvIGluamVjdCB0aGUgdHJhbnNjbHVzaW9uIGludG8geW91ciBkaXJlY3RpdmUuXG5cdCAqXG5cdCAqXG5cdCAqICMjIyMgVHJhbnNjbHVzaW9uIFNjb3Blc1xuXHQgKlxuXHQgKiBXaGVuIHlvdSBjYWxsIGEgdHJhbnNjbHVkZSBmdW5jdGlvbiBpdCByZXR1cm5zIGEgRE9NIGZyYWdtZW50IHRoYXQgaXMgcHJlLWJvdW5kIHRvIGEgKip0cmFuc2NsdXNpb25cblx0ICogc2NvcGUqKi4gVGhpcyBzY29wZSBpcyBzcGVjaWFsLCBpbiB0aGF0IGl0IGlzIGEgY2hpbGQgb2YgdGhlIGRpcmVjdGl2ZSdzIHNjb3BlIChhbmQgc28gZ2V0cyBkZXN0cm95ZWRcblx0ICogd2hlbiB0aGUgZGlyZWN0aXZlJ3Mgc2NvcGUgZ2V0cyBkZXN0cm95ZWQpIGJ1dCBpdCBpbmhlcml0cyB0aGUgcHJvcGVydGllcyBvZiB0aGUgc2NvcGUgZnJvbSB3aGljaCBpdFxuXHQgKiB3YXMgdGFrZW4uXG5cdCAqXG5cdCAqIEZvciBleGFtcGxlIGNvbnNpZGVyIGEgZGlyZWN0aXZlIHRoYXQgdXNlcyB0cmFuc2NsdXNpb24gYW5kIGlzb2xhdGVkIHNjb3BlLiBUaGUgRE9NIGhpZXJhcmNoeSBtaWdodCBsb29rXG5cdCAqIGxpa2UgdGhpczpcblx0ICpcblx0ICogYGBgaHRtbFxuXHQgKiA8ZGl2IG5nLWFwcD5cblx0ICogICA8ZGl2IGlzb2xhdGU+XG5cdCAqICAgICA8ZGl2IHRyYW5zY2x1c2lvbj5cblx0ICogICAgIDwvZGl2PlxuXHQgKiAgIDwvZGl2PlxuXHQgKiA8L2Rpdj5cblx0ICogYGBgXG5cdCAqXG5cdCAqIFRoZSBgJHBhcmVudGAgc2NvcGUgaGllcmFyY2h5IHdpbGwgbG9vayBsaWtlIHRoaXM6XG5cdCAqXG5cdCAgIGBgYFxuXHQgICAtICRyb290U2NvcGVcblx0ICAgICAtIGlzb2xhdGVcblx0ICAgICAgIC0gdHJhbnNjbHVzaW9uXG5cdCAgIGBgYFxuXHQgKlxuXHQgKiBidXQgdGhlIHNjb3BlcyB3aWxsIGluaGVyaXQgcHJvdG90eXBpY2FsbHkgZnJvbSBkaWZmZXJlbnQgc2NvcGVzIHRvIHRoZWlyIGAkcGFyZW50YC5cblx0ICpcblx0ICAgYGBgXG5cdCAgIC0gJHJvb3RTY29wZVxuXHQgICAgIC0gdHJhbnNjbHVzaW9uXG5cdCAgIC0gaXNvbGF0ZVxuXHQgICBgYGBcblx0ICpcblx0ICpcblx0ICogIyMjIEF0dHJpYnV0ZXNcblx0ICpcblx0ICogVGhlIHtAbGluayBuZy4kY29tcGlsZS5kaXJlY3RpdmUuQXR0cmlidXRlcyBBdHRyaWJ1dGVzfSBvYmplY3QgLSBwYXNzZWQgYXMgYSBwYXJhbWV0ZXIgaW4gdGhlXG5cdCAqIGBsaW5rKClgIG9yIGBjb21waWxlKClgIGZ1bmN0aW9ucy4gSXQgaGFzIGEgdmFyaWV0eSBvZiB1c2VzLlxuXHQgKlxuXHQgKiAqICpBY2Nlc3Npbmcgbm9ybWFsaXplZCBhdHRyaWJ1dGUgbmFtZXM6KiBEaXJlY3RpdmVzIGxpa2UgJ25nQmluZCcgY2FuIGJlIGV4cHJlc3NlZCBpbiBtYW55IHdheXM6XG5cdCAqICAgJ25nOmJpbmQnLCBgZGF0YS1uZy1iaW5kYCwgb3IgJ3gtbmctYmluZCcuIFRoZSBhdHRyaWJ1dGVzIG9iamVjdCBhbGxvd3MgZm9yIG5vcm1hbGl6ZWQgYWNjZXNzXG5cdCAqICAgdG8gdGhlIGF0dHJpYnV0ZXMuXG5cdCAqXG5cdCAqICogKkRpcmVjdGl2ZSBpbnRlci1jb21tdW5pY2F0aW9uOiogQWxsIGRpcmVjdGl2ZXMgc2hhcmUgdGhlIHNhbWUgaW5zdGFuY2Ugb2YgdGhlIGF0dHJpYnV0ZXNcblx0ICogICBvYmplY3Qgd2hpY2ggYWxsb3dzIHRoZSBkaXJlY3RpdmVzIHRvIHVzZSB0aGUgYXR0cmlidXRlcyBvYmplY3QgYXMgaW50ZXIgZGlyZWN0aXZlXG5cdCAqICAgY29tbXVuaWNhdGlvbi5cblx0ICpcblx0ICogKiAqU3VwcG9ydHMgaW50ZXJwb2xhdGlvbjoqIEludGVycG9sYXRpb24gYXR0cmlidXRlcyBhcmUgYXNzaWduZWQgdG8gdGhlIGF0dHJpYnV0ZSBvYmplY3Rcblx0ICogICBhbGxvd2luZyBvdGhlciBkaXJlY3RpdmVzIHRvIHJlYWQgdGhlIGludGVycG9sYXRlZCB2YWx1ZS5cblx0ICpcblx0ICogKiAqT2JzZXJ2aW5nIGludGVycG9sYXRlZCBhdHRyaWJ1dGVzOiogVXNlIGAkb2JzZXJ2ZWAgdG8gb2JzZXJ2ZSB0aGUgdmFsdWUgY2hhbmdlcyBvZiBhdHRyaWJ1dGVzXG5cdCAqICAgdGhhdCBjb250YWluIGludGVycG9sYXRpb24gKGUuZy4gYHNyYz1cInt7YmFyfX1cImApLiBOb3Qgb25seSBpcyB0aGlzIHZlcnkgZWZmaWNpZW50IGJ1dCBpdCdzIGFsc29cblx0ICogICB0aGUgb25seSB3YXkgdG8gZWFzaWx5IGdldCB0aGUgYWN0dWFsIHZhbHVlIGJlY2F1c2UgZHVyaW5nIHRoZSBsaW5raW5nIHBoYXNlIHRoZSBpbnRlcnBvbGF0aW9uXG5cdCAqICAgaGFzbid0IGJlZW4gZXZhbHVhdGVkIHlldCBhbmQgc28gdGhlIHZhbHVlIGlzIGF0IHRoaXMgdGltZSBzZXQgdG8gYHVuZGVmaW5lZGAuXG5cdCAqXG5cdCAqIGBgYGpzXG5cdCAqIGZ1bmN0aW9uIGxpbmtpbmdGbihzY29wZSwgZWxtLCBhdHRycywgY3RybCkge1xuXHQgKiAgIC8vIGdldCB0aGUgYXR0cmlidXRlIHZhbHVlXG5cdCAqICAgY29uc29sZS5sb2coYXR0cnMubmdNb2RlbCk7XG5cdCAqXG5cdCAqICAgLy8gY2hhbmdlIHRoZSBhdHRyaWJ1dGVcblx0ICogICBhdHRycy4kc2V0KCduZ01vZGVsJywgJ25ldyB2YWx1ZScpO1xuXHQgKlxuXHQgKiAgIC8vIG9ic2VydmUgY2hhbmdlcyB0byBpbnRlcnBvbGF0ZWQgYXR0cmlidXRlXG5cdCAqICAgYXR0cnMuJG9ic2VydmUoJ25nTW9kZWwnLCBmdW5jdGlvbih2YWx1ZSkge1xuXHQgKiAgICAgY29uc29sZS5sb2coJ25nTW9kZWwgaGFzIGNoYW5nZWQgdmFsdWUgdG8gJyArIHZhbHVlKTtcblx0ICogICB9KTtcblx0ICogfVxuXHQgKiBgYGBcblx0ICpcblx0ICogIyMgRXhhbXBsZVxuXHQgKlxuXHQgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuXHQgKiAqKk5vdGUqKjogVHlwaWNhbGx5IGRpcmVjdGl2ZXMgYXJlIHJlZ2lzdGVyZWQgd2l0aCBgbW9kdWxlLmRpcmVjdGl2ZWAuIFRoZSBleGFtcGxlIGJlbG93IGlzXG5cdCAqIHRvIGlsbHVzdHJhdGUgaG93IGAkY29tcGlsZWAgd29ya3MuXG5cdCAqIDwvZGl2PlxuXHQgKlxuXHQgPGV4YW1wbGUgbW9kdWxlPVwiY29tcGlsZUV4YW1wbGVcIj5cblx0ICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgIDxzY3JpcHQ+XG5cdCAgICAgIGFuZ3VsYXIubW9kdWxlKCdjb21waWxlRXhhbXBsZScsIFtdLCBmdW5jdGlvbigkY29tcGlsZVByb3ZpZGVyKSB7XG5cdCAgICAgICAgLy8gY29uZmlndXJlIG5ldyAnY29tcGlsZScgZGlyZWN0aXZlIGJ5IHBhc3NpbmcgYSBkaXJlY3RpdmVcblx0ICAgICAgICAvLyBmYWN0b3J5IGZ1bmN0aW9uLiBUaGUgZmFjdG9yeSBmdW5jdGlvbiBpbmplY3RzIHRoZSAnJGNvbXBpbGUnXG5cdCAgICAgICAgJGNvbXBpbGVQcm92aWRlci5kaXJlY3RpdmUoJ2NvbXBpbGUnLCBmdW5jdGlvbigkY29tcGlsZSkge1xuXHQgICAgICAgICAgLy8gZGlyZWN0aXZlIGZhY3RvcnkgY3JlYXRlcyBhIGxpbmsgZnVuY3Rpb25cblx0ICAgICAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcblx0ICAgICAgICAgICAgc2NvcGUuJHdhdGNoKFxuXHQgICAgICAgICAgICAgIGZ1bmN0aW9uKHNjb3BlKSB7XG5cdCAgICAgICAgICAgICAgICAgLy8gd2F0Y2ggdGhlICdjb21waWxlJyBleHByZXNzaW9uIGZvciBjaGFuZ2VzXG5cdCAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUuJGV2YWwoYXR0cnMuY29tcGlsZSk7XG5cdCAgICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgICBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgJ2NvbXBpbGUnIGV4cHJlc3Npb24gY2hhbmdlc1xuXHQgICAgICAgICAgICAgICAgLy8gYXNzaWduIGl0IGludG8gdGhlIGN1cnJlbnQgRE9NXG5cdCAgICAgICAgICAgICAgICBlbGVtZW50Lmh0bWwodmFsdWUpO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIGNvbXBpbGUgdGhlIG5ldyBET00gYW5kIGxpbmsgaXQgdG8gdGhlIGN1cnJlbnRcblx0ICAgICAgICAgICAgICAgIC8vIHNjb3BlLlxuXHQgICAgICAgICAgICAgICAgLy8gTk9URTogd2Ugb25seSBjb21waWxlIC5jaGlsZE5vZGVzIHNvIHRoYXRcblx0ICAgICAgICAgICAgICAgIC8vIHdlIGRvbid0IGdldCBpbnRvIGluZmluaXRlIGxvb3AgY29tcGlsaW5nIG91cnNlbHZlc1xuXHQgICAgICAgICAgICAgICAgJGNvbXBpbGUoZWxlbWVudC5jb250ZW50cygpKShzY29wZSk7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICApO1xuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSlcblx0ICAgICAgLmNvbnRyb2xsZXIoJ0dyZWV0ZXJDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAkc2NvcGUubmFtZSA9ICdBbmd1bGFyJztcblx0ICAgICAgICAkc2NvcGUuaHRtbCA9ICdIZWxsbyB7e25hbWV9fSc7XG5cdCAgICAgIH1dKTtcblx0ICAgIDwvc2NyaXB0PlxuXHQgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiR3JlZXRlckNvbnRyb2xsZXJcIj5cblx0ICAgICAgPGlucHV0IG5nLW1vZGVsPVwibmFtZVwiPiA8YnIvPlxuXHQgICAgICA8dGV4dGFyZWEgbmctbW9kZWw9XCJodG1sXCI+PC90ZXh0YXJlYT4gPGJyLz5cblx0ICAgICAgPGRpdiBjb21waWxlPVwiaHRtbFwiPjwvZGl2PlxuXHQgICAgPC9kaXY+XG5cdCAgIDwvZmlsZT5cblx0ICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgIGl0KCdzaG91bGQgYXV0byBjb21waWxlJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICB2YXIgdGV4dGFyZWEgPSAkKCd0ZXh0YXJlYScpO1xuXHQgICAgICAgdmFyIG91dHB1dCA9ICQoJ2Rpdltjb21waWxlXScpO1xuXHQgICAgICAgLy8gVGhlIGluaXRpYWwgc3RhdGUgcmVhZHMgJ0hlbGxvIEFuZ3VsYXInLlxuXHQgICAgICAgZXhwZWN0KG91dHB1dC5nZXRUZXh0KCkpLnRvQmUoJ0hlbGxvIEFuZ3VsYXInKTtcblx0ICAgICAgIHRleHRhcmVhLmNsZWFyKCk7XG5cdCAgICAgICB0ZXh0YXJlYS5zZW5kS2V5cygne3tuYW1lfX0hJyk7XG5cdCAgICAgICBleHBlY3Qob3V0cHV0LmdldFRleHQoKSkudG9CZSgnQW5ndWxhciEnKTtcblx0ICAgICB9KTtcblx0ICAgPC9maWxlPlxuXHQgPC9leGFtcGxlPlxuXHRcblx0ICpcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd8RE9NRWxlbWVudH0gZWxlbWVudCBFbGVtZW50IG9yIEhUTUwgc3RyaW5nIHRvIGNvbXBpbGUgaW50byBhIHRlbXBsYXRlIGZ1bmN0aW9uLlxuXHQgKiBAcGFyYW0ge2Z1bmN0aW9uKGFuZ3VsYXIuU2NvcGUsIGNsb25lQXR0YWNoRm49KX0gdHJhbnNjbHVkZSBmdW5jdGlvbiBhdmFpbGFibGUgdG8gZGlyZWN0aXZlcyAtIERFUFJFQ0FURUQuXG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1kYW5nZXJcIj5cblx0ICogKipOb3RlOioqIFBhc3NpbmcgYSBgdHJhbnNjbHVkZWAgZnVuY3Rpb24gdG8gdGhlICRjb21waWxlIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQsIGFzIGl0XG5cdCAqICAgZS5nLiB3aWxsIG5vdCB1c2UgdGhlIHJpZ2h0IG91dGVyIHNjb3BlLiBQbGVhc2UgcGFzcyB0aGUgdHJhbnNjbHVkZSBmdW5jdGlvbiBhcyBhXG5cdCAqICAgYHBhcmVudEJvdW5kVHJhbnNjbHVkZUZuYCB0byB0aGUgbGluayBmdW5jdGlvbiBpbnN0ZWFkLlxuXHQgKiA8L2Rpdj5cblx0ICpcblx0ICogQHBhcmFtIHtudW1iZXJ9IG1heFByaW9yaXR5IG9ubHkgYXBwbHkgZGlyZWN0aXZlcyBsb3dlciB0aGFuIGdpdmVuIHByaW9yaXR5IChPbmx5IGVmZmVjdHMgdGhlXG5cdCAqICAgICAgICAgICAgICAgICByb290IGVsZW1lbnQocyksIG5vdCB0aGVpciBjaGlsZHJlbilcblx0ICogQHJldHVybnMge2Z1bmN0aW9uKHNjb3BlLCBjbG9uZUF0dGFjaEZuPSwgb3B0aW9ucz0pfSBhIGxpbmsgZnVuY3Rpb24gd2hpY2ggaXMgdXNlZCB0byBiaW5kIHRlbXBsYXRlXG5cdCAqIChhIERPTSBlbGVtZW50L3RyZWUpIHRvIGEgc2NvcGUuIFdoZXJlOlxuXHQgKlxuXHQgKiAgKiBgc2NvcGVgIC0gQSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSBTY29wZX0gdG8gYmluZCB0by5cblx0ICogICogYGNsb25lQXR0YWNoRm5gIC0gSWYgYGNsb25lQXR0YWNoRm5gIGlzIHByb3ZpZGVkLCB0aGVuIHRoZSBsaW5rIGZ1bmN0aW9uIHdpbGwgY2xvbmUgdGhlXG5cdCAqICBgdGVtcGxhdGVgIGFuZCBjYWxsIHRoZSBgY2xvbmVBdHRhY2hGbmAgZnVuY3Rpb24gYWxsb3dpbmcgdGhlIGNhbGxlciB0byBhdHRhY2ggdGhlXG5cdCAqICBjbG9uZWQgZWxlbWVudHMgdG8gdGhlIERPTSBkb2N1bWVudCBhdCB0aGUgYXBwcm9wcmlhdGUgcGxhY2UuIFRoZSBgY2xvbmVBdHRhY2hGbmAgaXNcblx0ICogIGNhbGxlZCBhczogPGJyLz4gYGNsb25lQXR0YWNoRm4oY2xvbmVkRWxlbWVudCwgc2NvcGUpYCB3aGVyZTpcblx0ICpcblx0ICogICAgICAqIGBjbG9uZWRFbGVtZW50YCAtIGlzIGEgY2xvbmUgb2YgdGhlIG9yaWdpbmFsIGBlbGVtZW50YCBwYXNzZWQgaW50byB0aGUgY29tcGlsZXIuXG5cdCAqICAgICAgKiBgc2NvcGVgIC0gaXMgdGhlIGN1cnJlbnQgc2NvcGUgd2l0aCB3aGljaCB0aGUgbGlua2luZyBmdW5jdGlvbiBpcyB3b3JraW5nIHdpdGguXG5cdCAqXG5cdCAqICAqIGBvcHRpb25zYCAtIEFuIG9wdGlvbmFsIG9iamVjdCBoYXNoIHdpdGggbGlua2luZyBvcHRpb25zLiBJZiBgb3B0aW9uc2AgaXMgcHJvdmlkZWQsIHRoZW4gdGhlIGZvbGxvd2luZ1xuXHQgKiAga2V5cyBtYXkgYmUgdXNlZCB0byBjb250cm9sIGxpbmtpbmcgYmVoYXZpb3I6XG5cdCAqXG5cdCAqICAgICAgKiBgcGFyZW50Qm91bmRUcmFuc2NsdWRlRm5gIC0gdGhlIHRyYW5zY2x1ZGUgZnVuY3Rpb24gbWFkZSBhdmFpbGFibGUgdG9cblx0ICogICAgICAgIGRpcmVjdGl2ZXM7IGlmIGdpdmVuLCBpdCB3aWxsIGJlIHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBsaW5rIGZ1bmN0aW9ucyBvZlxuXHQgKiAgICAgICAgZGlyZWN0aXZlcyBmb3VuZCBpbiBgZWxlbWVudGAgZHVyaW5nIGNvbXBpbGF0aW9uLlxuXHQgKiAgICAgICogYHRyYW5zY2x1ZGVDb250cm9sbGVyc2AgLSBhbiBvYmplY3QgaGFzaCB3aXRoIGtleXMgdGhhdCBtYXAgY29udHJvbGxlciBuYW1lc1xuXHQgKiAgICAgICAgdG8gYSBoYXNoIHdpdGggdGhlIGtleSBgaW5zdGFuY2VgLCB3aGljaCBtYXBzIHRvIHRoZSBjb250cm9sbGVyIGluc3RhbmNlO1xuXHQgKiAgICAgICAgaWYgZ2l2ZW4sIGl0IHdpbGwgbWFrZSB0aGUgY29udHJvbGxlcnMgYXZhaWxhYmxlIHRvIGRpcmVjdGl2ZXMgb24gdGhlIGNvbXBpbGVOb2RlOlxuXHQgKiAgICAgICAgYGBgXG5cdCAqICAgICAgICB7XG5cdCAqICAgICAgICAgIHBhcmVudDoge1xuXHQgKiAgICAgICAgICAgIGluc3RhbmNlOiBwYXJlbnRDb250cm9sbGVySW5zdGFuY2Vcblx0ICogICAgICAgICAgfVxuXHQgKiAgICAgICAgfVxuXHQgKiAgICAgICAgYGBgXG5cdCAqICAgICAgKiBgZnV0dXJlUGFyZW50RWxlbWVudGAgLSBkZWZpbmVzIHRoZSBwYXJlbnQgdG8gd2hpY2ggdGhlIGBjbG9uZUF0dGFjaEZuYCB3aWxsIGFkZFxuXHQgKiAgICAgICAgdGhlIGNsb25lZCBlbGVtZW50czsgb25seSBuZWVkZWQgZm9yIHRyYW5zY2x1ZGVzIHRoYXQgYXJlIGFsbG93ZWQgdG8gY29udGFpbiBub24gaHRtbFxuXHQgKiAgICAgICAgZWxlbWVudHMgKGUuZy4gU1ZHIGVsZW1lbnRzKS4gU2VlIGFsc28gdGhlIGRpcmVjdGl2ZS5jb250cm9sbGVyIHByb3BlcnR5LlxuXHQgKlxuXHQgKiBDYWxsaW5nIHRoZSBsaW5raW5nIGZ1bmN0aW9uIHJldHVybnMgdGhlIGVsZW1lbnQgb2YgdGhlIHRlbXBsYXRlLiBJdCBpcyBlaXRoZXIgdGhlIG9yaWdpbmFsXG5cdCAqIGVsZW1lbnQgcGFzc2VkIGluLCBvciB0aGUgY2xvbmUgb2YgdGhlIGVsZW1lbnQgaWYgdGhlIGBjbG9uZUF0dGFjaEZuYCBpcyBwcm92aWRlZC5cblx0ICpcblx0ICogQWZ0ZXIgbGlua2luZyB0aGUgdmlldyBpcyBub3QgdXBkYXRlZCB1bnRpbCBhZnRlciBhIGNhbGwgdG8gJGRpZ2VzdCB3aGljaCB0eXBpY2FsbHkgaXMgZG9uZSBieVxuXHQgKiBBbmd1bGFyIGF1dG9tYXRpY2FsbHkuXG5cdCAqXG5cdCAqIElmIHlvdSBuZWVkIGFjY2VzcyB0byB0aGUgYm91bmQgdmlldywgdGhlcmUgYXJlIHR3byB3YXlzIHRvIGRvIGl0OlxuXHQgKlxuXHQgKiAtIElmIHlvdSBhcmUgbm90IGFza2luZyB0aGUgbGlua2luZyBmdW5jdGlvbiB0byBjbG9uZSB0aGUgdGVtcGxhdGUsIGNyZWF0ZSB0aGUgRE9NIGVsZW1lbnQocylcblx0ICogICBiZWZvcmUgeW91IHNlbmQgdGhlbSB0byB0aGUgY29tcGlsZXIgYW5kIGtlZXAgdGhpcyByZWZlcmVuY2UgYXJvdW5kLlxuXHQgKiAgIGBgYGpzXG5cdCAqICAgICB2YXIgZWxlbWVudCA9ICRjb21waWxlKCc8cD57e3RvdGFsfX08L3A+Jykoc2NvcGUpO1xuXHQgKiAgIGBgYFxuXHQgKlxuXHQgKiAtIGlmIG9uIHRoZSBvdGhlciBoYW5kLCB5b3UgbmVlZCB0aGUgZWxlbWVudCB0byBiZSBjbG9uZWQsIHRoZSB2aWV3IHJlZmVyZW5jZSBmcm9tIHRoZSBvcmlnaW5hbFxuXHQgKiAgIGV4YW1wbGUgd291bGQgbm90IHBvaW50IHRvIHRoZSBjbG9uZSwgYnV0IHJhdGhlciB0byB0aGUgb3JpZ2luYWwgdGVtcGxhdGUgdGhhdCB3YXMgY2xvbmVkLiBJblxuXHQgKiAgIHRoaXMgY2FzZSwgeW91IGNhbiBhY2Nlc3MgdGhlIGNsb25lIHZpYSB0aGUgY2xvbmVBdHRhY2hGbjpcblx0ICogICBgYGBqc1xuXHQgKiAgICAgdmFyIHRlbXBsYXRlRWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudCgnPHA+e3t0b3RhbH19PC9wPicpLFxuXHQgKiAgICAgICAgIHNjb3BlID0gLi4uLjtcblx0ICpcblx0ICogICAgIHZhciBjbG9uZWRFbGVtZW50ID0gJGNvbXBpbGUodGVtcGxhdGVFbGVtZW50KShzY29wZSwgZnVuY3Rpb24oY2xvbmVkRWxlbWVudCwgc2NvcGUpIHtcblx0ICogICAgICAgLy9hdHRhY2ggdGhlIGNsb25lIHRvIERPTSBkb2N1bWVudCBhdCB0aGUgcmlnaHQgcGxhY2Vcblx0ICogICAgIH0pO1xuXHQgKlxuXHQgKiAgICAgLy9ub3cgd2UgaGF2ZSByZWZlcmVuY2UgdG8gdGhlIGNsb25lZCBET00gdmlhIGBjbG9uZWRFbGVtZW50YFxuXHQgKiAgIGBgYFxuXHQgKlxuXHQgKlxuXHQgKiBGb3IgaW5mb3JtYXRpb24gb24gaG93IHRoZSBjb21waWxlciB3b3Jrcywgc2VlIHRoZVxuXHQgKiB7QGxpbmsgZ3VpZGUvY29tcGlsZXIgQW5ndWxhciBIVE1MIENvbXBpbGVyfSBzZWN0aW9uIG9mIHRoZSBEZXZlbG9wZXIgR3VpZGUuXG5cdCAqL1xuXHRcblx0dmFyICRjb21waWxlTWluRXJyID0gbWluRXJyKCckY29tcGlsZScpO1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBwcm92aWRlclxuXHQgKiBAbmFtZSAkY29tcGlsZVByb3ZpZGVyXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKi9cblx0JENvbXBpbGVQcm92aWRlci4kaW5qZWN0ID0gWyckcHJvdmlkZScsICckJHNhbml0aXplVXJpUHJvdmlkZXInXTtcblx0ZnVuY3Rpb24gJENvbXBpbGVQcm92aWRlcigkcHJvdmlkZSwgJCRzYW5pdGl6ZVVyaVByb3ZpZGVyKSB7XG5cdCAgdmFyIGhhc0RpcmVjdGl2ZXMgPSB7fSxcblx0ICAgICAgU3VmZml4ID0gJ0RpcmVjdGl2ZScsXG5cdCAgICAgIENPTU1FTlRfRElSRUNUSVZFX1JFR0VYUCA9IC9eXFxzKmRpcmVjdGl2ZVxcOlxccyooW1xcd1xcLV0rKVxccysoLiopJC8sXG5cdCAgICAgIENMQVNTX0RJUkVDVElWRV9SRUdFWFAgPSAvKChbXFx3XFwtXSspKD86XFw6KFteO10rKSk/Oz8pLyxcblx0ICAgICAgQUxMX09SX05PVEhJTkdfQVRUUlMgPSBtYWtlTWFwKCduZ1NyYyxuZ1NyY3NldCxzcmMsc3Jjc2V0JyksXG5cdCAgICAgIFJFUVVJUkVfUFJFRklYX1JFR0VYUCA9IC9eKD86KFxcXlxcXj8pPyhcXD8pPyhcXF5cXF4/KT8pPy87XG5cdFxuXHQgIC8vIFJlZjogaHR0cDovL2RldmVsb3BlcnMud2hhdHdnLm9yZy93ZWJhcHBhcGlzLmh0bWwjZXZlbnQtaGFuZGxlci1pZGwtYXR0cmlidXRlc1xuXHQgIC8vIFRoZSBhc3N1bXB0aW9uIGlzIHRoYXQgZnV0dXJlIERPTSBldmVudCBhdHRyaWJ1dGUgbmFtZXMgd2lsbCBiZWdpbiB3aXRoXG5cdCAgLy8gJ29uJyBhbmQgYmUgY29tcG9zZWQgb2Ygb25seSBFbmdsaXNoIGxldHRlcnMuXG5cdCAgdmFyIEVWRU5UX0hBTkRMRVJfQVRUUl9SRUdFWFAgPSAvXihvblthLXpdK3xmb3JtYWN0aW9uKSQvO1xuXHRcblx0ICBmdW5jdGlvbiBwYXJzZUlzb2xhdGVCaW5kaW5ncyhzY29wZSwgZGlyZWN0aXZlTmFtZSwgaXNDb250cm9sbGVyKSB7XG5cdCAgICB2YXIgTE9DQUxfUkVHRVhQID0gL15cXHMqKFtAJjxdfD0oXFwqPykpKFxcPz8pXFxzKihcXHcqKVxccyokLztcblx0XG5cdCAgICB2YXIgYmluZGluZ3MgPSB7fTtcblx0XG5cdCAgICBmb3JFYWNoKHNjb3BlLCBmdW5jdGlvbihkZWZpbml0aW9uLCBzY29wZU5hbWUpIHtcblx0ICAgICAgdmFyIG1hdGNoID0gZGVmaW5pdGlvbi5tYXRjaChMT0NBTF9SRUdFWFApO1xuXHRcblx0ICAgICAgaWYgKCFtYXRjaCkge1xuXHQgICAgICAgIHRocm93ICRjb21waWxlTWluRXJyKCdpc2NwJyxcblx0ICAgICAgICAgICAgXCJJbnZhbGlkIHszfSBmb3IgZGlyZWN0aXZlICd7MH0nLlwiICtcblx0ICAgICAgICAgICAgXCIgRGVmaW5pdGlvbjogey4uLiB7MX06ICd7Mn0nIC4uLn1cIixcblx0ICAgICAgICAgICAgZGlyZWN0aXZlTmFtZSwgc2NvcGVOYW1lLCBkZWZpbml0aW9uLFxuXHQgICAgICAgICAgICAoaXNDb250cm9sbGVyID8gXCJjb250cm9sbGVyIGJpbmRpbmdzIGRlZmluaXRpb25cIiA6XG5cdCAgICAgICAgICAgIFwiaXNvbGF0ZSBzY29wZSBkZWZpbml0aW9uXCIpKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgYmluZGluZ3Nbc2NvcGVOYW1lXSA9IHtcblx0ICAgICAgICBtb2RlOiBtYXRjaFsxXVswXSxcblx0ICAgICAgICBjb2xsZWN0aW9uOiBtYXRjaFsyXSA9PT0gJyonLFxuXHQgICAgICAgIG9wdGlvbmFsOiBtYXRjaFszXSA9PT0gJz8nLFxuXHQgICAgICAgIGF0dHJOYW1lOiBtYXRjaFs0XSB8fCBzY29wZU5hbWVcblx0ICAgICAgfTtcblx0ICAgIH0pO1xuXHRcblx0ICAgIHJldHVybiBiaW5kaW5ncztcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIHBhcnNlRGlyZWN0aXZlQmluZGluZ3MoZGlyZWN0aXZlLCBkaXJlY3RpdmVOYW1lKSB7XG5cdCAgICB2YXIgYmluZGluZ3MgPSB7XG5cdCAgICAgIGlzb2xhdGVTY29wZTogbnVsbCxcblx0ICAgICAgYmluZFRvQ29udHJvbGxlcjogbnVsbFxuXHQgICAgfTtcblx0ICAgIGlmIChpc09iamVjdChkaXJlY3RpdmUuc2NvcGUpKSB7XG5cdCAgICAgIGlmIChkaXJlY3RpdmUuYmluZFRvQ29udHJvbGxlciA9PT0gdHJ1ZSkge1xuXHQgICAgICAgIGJpbmRpbmdzLmJpbmRUb0NvbnRyb2xsZXIgPSBwYXJzZUlzb2xhdGVCaW5kaW5ncyhkaXJlY3RpdmUuc2NvcGUsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdGl2ZU5hbWUsIHRydWUpO1xuXHQgICAgICAgIGJpbmRpbmdzLmlzb2xhdGVTY29wZSA9IHt9O1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGJpbmRpbmdzLmlzb2xhdGVTY29wZSA9IHBhcnNlSXNvbGF0ZUJpbmRpbmdzKGRpcmVjdGl2ZS5zY29wZSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3RpdmVOYW1lLCBmYWxzZSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIGlmIChpc09iamVjdChkaXJlY3RpdmUuYmluZFRvQ29udHJvbGxlcikpIHtcblx0ICAgICAgYmluZGluZ3MuYmluZFRvQ29udHJvbGxlciA9XG5cdCAgICAgICAgICBwYXJzZUlzb2xhdGVCaW5kaW5ncyhkaXJlY3RpdmUuYmluZFRvQ29udHJvbGxlciwgZGlyZWN0aXZlTmFtZSwgdHJ1ZSk7XG5cdCAgICB9XG5cdCAgICBpZiAoaXNPYmplY3QoYmluZGluZ3MuYmluZFRvQ29udHJvbGxlcikpIHtcblx0ICAgICAgdmFyIGNvbnRyb2xsZXIgPSBkaXJlY3RpdmUuY29udHJvbGxlcjtcblx0ICAgICAgdmFyIGNvbnRyb2xsZXJBcyA9IGRpcmVjdGl2ZS5jb250cm9sbGVyQXM7XG5cdCAgICAgIGlmICghY29udHJvbGxlcikge1xuXHQgICAgICAgIC8vIFRoZXJlIGlzIG5vIGNvbnRyb2xsZXIsIHRoZXJlIG1heSBvciBtYXkgbm90IGJlIGEgY29udHJvbGxlckFzIHByb3BlcnR5XG5cdCAgICAgICAgdGhyb3cgJGNvbXBpbGVNaW5FcnIoJ25vY3RybCcsXG5cdCAgICAgICAgICAgICAgXCJDYW5ub3QgYmluZCB0byBjb250cm9sbGVyIHdpdGhvdXQgZGlyZWN0aXZlICd7MH0ncyBjb250cm9sbGVyLlwiLFxuXHQgICAgICAgICAgICAgIGRpcmVjdGl2ZU5hbWUpO1xuXHQgICAgICB9IGVsc2UgaWYgKCFpZGVudGlmaWVyRm9yQ29udHJvbGxlcihjb250cm9sbGVyLCBjb250cm9sbGVyQXMpKSB7XG5cdCAgICAgICAgLy8gVGhlcmUgaXMgYSBjb250cm9sbGVyLCBidXQgbm8gaWRlbnRpZmllciBvciBjb250cm9sbGVyQXMgcHJvcGVydHlcblx0ICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycignbm9pZGVudCcsXG5cdCAgICAgICAgICAgICAgXCJDYW5ub3QgYmluZCB0byBjb250cm9sbGVyIHdpdGhvdXQgaWRlbnRpZmllciBmb3IgZGlyZWN0aXZlICd7MH0nLlwiLFxuXHQgICAgICAgICAgICAgIGRpcmVjdGl2ZU5hbWUpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gYmluZGluZ3M7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBhc3NlcnRWYWxpZERpcmVjdGl2ZU5hbWUobmFtZSkge1xuXHQgICAgdmFyIGxldHRlciA9IG5hbWUuY2hhckF0KDApO1xuXHQgICAgaWYgKCFsZXR0ZXIgfHwgbGV0dGVyICE9PSBsb3dlcmNhc2UobGV0dGVyKSkge1xuXHQgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycignYmFkZGlyJywgXCJEaXJlY3RpdmUgbmFtZSAnezB9JyBpcyBpbnZhbGlkLiBUaGUgZmlyc3QgY2hhcmFjdGVyIG11c3QgYmUgYSBsb3dlcmNhc2UgbGV0dGVyXCIsIG5hbWUpO1xuXHQgICAgfVxuXHQgICAgaWYgKG5hbWUgIT09IG5hbWUudHJpbSgpKSB7XG5cdCAgICAgIHRocm93ICRjb21waWxlTWluRXJyKCdiYWRkaXInLFxuXHQgICAgICAgICAgICBcIkRpcmVjdGl2ZSBuYW1lICd7MH0nIGlzIGludmFsaWQuIFRoZSBuYW1lIHNob3VsZCBub3QgY29udGFpbiBsZWFkaW5nIG9yIHRyYWlsaW5nIHdoaXRlc3BhY2VzXCIsXG5cdCAgICAgICAgICAgIG5hbWUpO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRjb21waWxlUHJvdmlkZXIjZGlyZWN0aXZlXG5cdCAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFJlZ2lzdGVyIGEgbmV3IGRpcmVjdGl2ZSB3aXRoIHRoZSBjb21waWxlci5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfE9iamVjdH0gbmFtZSBOYW1lIG9mIHRoZSBkaXJlY3RpdmUgaW4gY2FtZWwtY2FzZSAoaS5lLiA8Y29kZT5uZ0JpbmQ8L2NvZGU+IHdoaWNoXG5cdCAgICogICAgd2lsbCBtYXRjaCBhcyA8Y29kZT5uZy1iaW5kPC9jb2RlPiksIG9yIGFuIG9iamVjdCBtYXAgb2YgZGlyZWN0aXZlcyB3aGVyZSB0aGUga2V5cyBhcmUgdGhlXG5cdCAgICogICAgbmFtZXMgYW5kIHRoZSB2YWx1ZXMgYXJlIHRoZSBmYWN0b3JpZXMuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbnxBcnJheX0gZGlyZWN0aXZlRmFjdG9yeSBBbiBpbmplY3RhYmxlIGRpcmVjdGl2ZSBmYWN0b3J5IGZ1bmN0aW9uLiBTZWUgdGhlXG5cdCAgICogICAge0BsaW5rIGd1aWRlL2RpcmVjdGl2ZSBkaXJlY3RpdmUgZ3VpZGV9IGFuZCB0aGUge0BsaW5rICRjb21waWxlIGNvbXBpbGUgQVBJfSBmb3IgbW9yZSBpbmZvLlxuXHQgICAqIEByZXR1cm5zIHtuZy4kY29tcGlsZVByb3ZpZGVyfSBTZWxmIGZvciBjaGFpbmluZy5cblx0ICAgKi9cblx0ICAgdGhpcy5kaXJlY3RpdmUgPSBmdW5jdGlvbiByZWdpc3RlckRpcmVjdGl2ZShuYW1lLCBkaXJlY3RpdmVGYWN0b3J5KSB7XG5cdCAgICBhc3NlcnROb3RIYXNPd25Qcm9wZXJ0eShuYW1lLCAnZGlyZWN0aXZlJyk7XG5cdCAgICBpZiAoaXNTdHJpbmcobmFtZSkpIHtcblx0ICAgICAgYXNzZXJ0VmFsaWREaXJlY3RpdmVOYW1lKG5hbWUpO1xuXHQgICAgICBhc3NlcnRBcmcoZGlyZWN0aXZlRmFjdG9yeSwgJ2RpcmVjdGl2ZUZhY3RvcnknKTtcblx0ICAgICAgaWYgKCFoYXNEaXJlY3RpdmVzLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG5cdCAgICAgICAgaGFzRGlyZWN0aXZlc1tuYW1lXSA9IFtdO1xuXHQgICAgICAgICRwcm92aWRlLmZhY3RvcnkobmFtZSArIFN1ZmZpeCwgWyckaW5qZWN0b3InLCAnJGV4Y2VwdGlvbkhhbmRsZXInLFxuXHQgICAgICAgICAgZnVuY3Rpb24oJGluamVjdG9yLCAkZXhjZXB0aW9uSGFuZGxlcikge1xuXHQgICAgICAgICAgICB2YXIgZGlyZWN0aXZlcyA9IFtdO1xuXHQgICAgICAgICAgICBmb3JFYWNoKGhhc0RpcmVjdGl2ZXNbbmFtZV0sIGZ1bmN0aW9uKGRpcmVjdGl2ZUZhY3RvcnksIGluZGV4KSB7XG5cdCAgICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgIHZhciBkaXJlY3RpdmUgPSAkaW5qZWN0b3IuaW52b2tlKGRpcmVjdGl2ZUZhY3RvcnkpO1xuXHQgICAgICAgICAgICAgICAgaWYgKGlzRnVuY3Rpb24oZGlyZWN0aXZlKSkge1xuXHQgICAgICAgICAgICAgICAgICBkaXJlY3RpdmUgPSB7IGNvbXBpbGU6IHZhbHVlRm4oZGlyZWN0aXZlKSB9O1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghZGlyZWN0aXZlLmNvbXBpbGUgJiYgZGlyZWN0aXZlLmxpbmspIHtcblx0ICAgICAgICAgICAgICAgICAgZGlyZWN0aXZlLmNvbXBpbGUgPSB2YWx1ZUZuKGRpcmVjdGl2ZS5saW5rKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIGRpcmVjdGl2ZS5wcmlvcml0eSA9IGRpcmVjdGl2ZS5wcmlvcml0eSB8fCAwO1xuXHQgICAgICAgICAgICAgICAgZGlyZWN0aXZlLmluZGV4ID0gaW5kZXg7XG5cdCAgICAgICAgICAgICAgICBkaXJlY3RpdmUubmFtZSA9IGRpcmVjdGl2ZS5uYW1lIHx8IG5hbWU7XG5cdCAgICAgICAgICAgICAgICBkaXJlY3RpdmUucmVxdWlyZSA9IGRpcmVjdGl2ZS5yZXF1aXJlIHx8IChkaXJlY3RpdmUuY29udHJvbGxlciAmJiBkaXJlY3RpdmUubmFtZSk7XG5cdCAgICAgICAgICAgICAgICBkaXJlY3RpdmUucmVzdHJpY3QgPSBkaXJlY3RpdmUucmVzdHJpY3QgfHwgJ0VBJztcblx0ICAgICAgICAgICAgICAgIHZhciBiaW5kaW5ncyA9IGRpcmVjdGl2ZS4kJGJpbmRpbmdzID1cblx0ICAgICAgICAgICAgICAgICAgICBwYXJzZURpcmVjdGl2ZUJpbmRpbmdzKGRpcmVjdGl2ZSwgZGlyZWN0aXZlLm5hbWUpO1xuXHQgICAgICAgICAgICAgICAgaWYgKGlzT2JqZWN0KGJpbmRpbmdzLmlzb2xhdGVTY29wZSkpIHtcblx0ICAgICAgICAgICAgICAgICAgZGlyZWN0aXZlLiQkaXNvbGF0ZUJpbmRpbmdzID0gYmluZGluZ3MuaXNvbGF0ZVNjb3BlO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgZGlyZWN0aXZlLiQkbW9kdWxlTmFtZSA9IGRpcmVjdGl2ZUZhY3RvcnkuJCRtb2R1bGVOYW1lO1xuXHQgICAgICAgICAgICAgICAgZGlyZWN0aXZlcy5wdXNoKGRpcmVjdGl2ZSk7XG5cdCAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZXM7XG5cdCAgICAgICAgICB9XSk7XG5cdCAgICAgIH1cblx0ICAgICAgaGFzRGlyZWN0aXZlc1tuYW1lXS5wdXNoKGRpcmVjdGl2ZUZhY3RvcnkpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgZm9yRWFjaChuYW1lLCByZXZlcnNlUGFyYW1zKHJlZ2lzdGVyRGlyZWN0aXZlKSk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gdGhpcztcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgJGNvbXBpbGVQcm92aWRlciNjb21wb25lbnRcblx0ICAgKiBAbW9kdWxlIG5nXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgTmFtZSBvZiB0aGUgY29tcG9uZW50IGluIGNhbWVsQ2FzZSAoaS5lLiBgbXlDb21wYCB3aGljaCB3aWxsIG1hdGNoIGA8bXktY29tcD5gKVxuXHQgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIENvbXBvbmVudCBkZWZpbml0aW9uIG9iamVjdCAoYSBzaW1wbGlmaWVkXG5cdCAgICogICAge0BsaW5rIG5nLiRjb21waWxlI2RpcmVjdGl2ZS1kZWZpbml0aW9uLW9iamVjdCBkaXJlY3RpdmUgZGVmaW5pdGlvbiBvYmplY3R9KSxcblx0ICAgKiAgICB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllcyAoYWxsIG9wdGlvbmFsKTpcblx0ICAgKlxuXHQgICAqICAgIC0gYGNvbnRyb2xsZXJgIOKAkyBgeyhzdHJpbmd8ZnVuY3Rpb24oKT19YCDigJMgY29udHJvbGxlciBjb25zdHJ1Y3RvciBmdW5jdGlvbiB0aGF0IHNob3VsZCBiZVxuXHQgICAqICAgICAgYXNzb2NpYXRlZCB3aXRoIG5ld2x5IGNyZWF0ZWQgc2NvcGUgb3IgdGhlIG5hbWUgb2YgYSB7QGxpbmsgbmcuJGNvbXBpbGUjLWNvbnRyb2xsZXItXG5cdCAgICogICAgICByZWdpc3RlcmVkIGNvbnRyb2xsZXJ9IGlmIHBhc3NlZCBhcyBhIHN0cmluZy4gQW4gZW1wdHkgYG5vb3BgIGZ1bmN0aW9uIGJ5IGRlZmF1bHQuXG5cdCAgICogICAgLSBgY29udHJvbGxlckFzYCDigJMgYHtzdHJpbmc9fWAg4oCTIGlkZW50aWZpZXIgbmFtZSBmb3IgdG8gcmVmZXJlbmNlIHRoZSBjb250cm9sbGVyIGluIHRoZSBjb21wb25lbnQncyBzY29wZS5cblx0ICAgKiAgICAgIElmIHByZXNlbnQsIHRoZSBjb250cm9sbGVyIHdpbGwgYmUgcHVibGlzaGVkIHRvIHNjb3BlIHVuZGVyIHRoZSBgY29udHJvbGxlckFzYCBuYW1lLlxuXHQgICAqICAgICAgSWYgbm90IHByZXNlbnQsIHRoaXMgd2lsbCBkZWZhdWx0IHRvIGJlIGAkY3RybGAuXG5cdCAgICogICAgLSBgdGVtcGxhdGVgIOKAkyBge3N0cmluZz18ZnVuY3Rpb24oKT19YCDigJMgaHRtbCB0ZW1wbGF0ZSBhcyBhIHN0cmluZyBvciBhIGZ1bmN0aW9uIHRoYXRcblx0ICAgKiAgICAgIHJldHVybnMgYW4gaHRtbCB0ZW1wbGF0ZSBhcyBhIHN0cmluZyB3aGljaCBzaG91bGQgYmUgdXNlZCBhcyB0aGUgY29udGVudHMgb2YgdGhpcyBjb21wb25lbnQuXG5cdCAgICogICAgICBFbXB0eSBzdHJpbmcgYnkgZGVmYXVsdC5cblx0ICAgKlxuXHQgICAqICAgICAgSWYgYHRlbXBsYXRlYCBpcyBhIGZ1bmN0aW9uLCB0aGVuIGl0IGlzIHtAbGluayBhdXRvLiRpbmplY3RvciNpbnZva2UgaW5qZWN0ZWR9IHdpdGhcblx0ICAgKiAgICAgIHRoZSBmb2xsb3dpbmcgbG9jYWxzOlxuXHQgICAqXG5cdCAgICogICAgICAtIGAkZWxlbWVudGAgLSBDdXJyZW50IGVsZW1lbnRcblx0ICAgKiAgICAgIC0gYCRhdHRyc2AgLSBDdXJyZW50IGF0dHJpYnV0ZXMgb2JqZWN0IGZvciB0aGUgZWxlbWVudFxuXHQgICAqXG5cdCAgICogICAgLSBgdGVtcGxhdGVVcmxgIOKAkyBge3N0cmluZz18ZnVuY3Rpb24oKT19YCDigJMgcGF0aCBvciBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBwYXRoIHRvIGFuIGh0bWxcblx0ICAgKiAgICAgIHRlbXBsYXRlIHRoYXQgc2hvdWxkIGJlIHVzZWQgIGFzIHRoZSBjb250ZW50cyBvZiB0aGlzIGNvbXBvbmVudC5cblx0ICAgKlxuXHQgICAqICAgICAgSWYgYHRlbXBsYXRlVXJsYCBpcyBhIGZ1bmN0aW9uLCB0aGVuIGl0IGlzIHtAbGluayBhdXRvLiRpbmplY3RvciNpbnZva2UgaW5qZWN0ZWR9IHdpdGhcblx0ICAgKiAgICAgIHRoZSBmb2xsb3dpbmcgbG9jYWxzOlxuXHQgICAqXG5cdCAgICogICAgICAtIGAkZWxlbWVudGAgLSBDdXJyZW50IGVsZW1lbnRcblx0ICAgKiAgICAgIC0gYCRhdHRyc2AgLSBDdXJyZW50IGF0dHJpYnV0ZXMgb2JqZWN0IGZvciB0aGUgZWxlbWVudFxuXHQgICAqXG5cdCAgICogICAgLSBgYmluZGluZ3NgIOKAkyBge29iamVjdD19YCDigJMgZGVmaW5lcyBiaW5kaW5ncyBiZXR3ZWVuIERPTSBhdHRyaWJ1dGVzIGFuZCBjb21wb25lbnQgcHJvcGVydGllcy5cblx0ICAgKiAgICAgIENvbXBvbmVudCBwcm9wZXJ0aWVzIGFyZSBhbHdheXMgYm91bmQgdG8gdGhlIGNvbXBvbmVudCBjb250cm9sbGVyIGFuZCBub3QgdG8gdGhlIHNjb3BlLlxuXHQgICAqICAgICAgU2VlIHtAbGluayBuZy4kY29tcGlsZSMtYmluZHRvY29udHJvbGxlci0gYGJpbmRUb0NvbnRyb2xsZXJgfS5cblx0ICAgKiAgICAtIGB0cmFuc2NsdWRlYCDigJMgYHtib29sZWFuPX1gIOKAkyB3aGV0aGVyIHtAbGluayAkY29tcGlsZSN0cmFuc2NsdXNpb24gY29udGVudCB0cmFuc2NsdXNpb259IGlzIGVuYWJsZWQuXG5cdCAgICogICAgICBEaXNhYmxlZCBieSBkZWZhdWx0LlxuXHQgICAqICAgIC0gYCQuLi5gIOKAkyBge2Z1bmN0aW9uKCk9fWAg4oCTIGFkZGl0aW9uYWwgYW5ub3RhdGlvbnMgdG8gcHJvdmlkZSB0byB0aGUgZGlyZWN0aXZlIGZhY3RvcnkgZnVuY3Rpb24uXG5cdCAgICpcblx0ICAgKiBAcmV0dXJucyB7bmcuJGNvbXBpbGVQcm92aWRlcn0gdGhlIGNvbXBpbGUgcHJvdmlkZXIgaXRzZWxmLCBmb3IgY2hhaW5pbmcgb2YgZnVuY3Rpb24gY2FsbHMuXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogUmVnaXN0ZXIgYSAqKmNvbXBvbmVudCBkZWZpbml0aW9uKiogd2l0aCB0aGUgY29tcGlsZXIuIFRoaXMgaXMgYSBzaG9ydGhhbmQgZm9yIHJlZ2lzdGVyaW5nIGEgc3BlY2lhbFxuXHQgICAqIHR5cGUgb2YgZGlyZWN0aXZlLCB3aGljaCByZXByZXNlbnRzIGEgc2VsZi1jb250YWluZWQgVUkgY29tcG9uZW50IGluIHlvdXIgYXBwbGljYXRpb24uIFN1Y2ggY29tcG9uZW50c1xuXHQgICAqIGFyZSBhbHdheXMgaXNvbGF0ZWQgKGkuZS4gYHNjb3BlOiB7fWApIGFuZCBhcmUgYWx3YXlzIHJlc3RyaWN0ZWQgdG8gZWxlbWVudHMgKGkuZS4gYHJlc3RyaWN0OiAnRSdgKS5cblx0ICAgKlxuXHQgICAqIENvbXBvbmVudCBkZWZpbml0aW9ucyBhcmUgdmVyeSBzaW1wbGUgYW5kIGRvIG5vdCByZXF1aXJlIGFzIG11Y2ggY29uZmlndXJhdGlvbiBhcyBkZWZpbmluZyBnZW5lcmFsXG5cdCAgICogZGlyZWN0aXZlcy4gQ29tcG9uZW50IGRlZmluaXRpb25zIHVzdWFsbHkgY29uc2lzdCBvbmx5IG9mIGEgdGVtcGxhdGUgYW5kIGEgY29udHJvbGxlciBiYWNraW5nIGl0LlxuXHQgICAqXG5cdCAgICogSW4gb3JkZXIgdG8gbWFrZSB0aGUgZGVmaW5pdGlvbiBlYXNpZXIsIGNvbXBvbmVudHMgZW5mb3JjZSBiZXN0IHByYWN0aWNlcyBsaWtlIHVzZSBvZiBgY29udHJvbGxlckFzYCxcblx0ICAgKiBgYmluZFRvQ29udHJvbGxlcmAuIFRoZXkgYWx3YXlzIGhhdmUgKippc29sYXRlIHNjb3BlKiogYW5kIGFyZSByZXN0cmljdGVkIHRvIGVsZW1lbnRzLlxuXHQgICAqXG5cdCAgICogSGVyZSBhcmUgYSBmZXcgZXhhbXBsZXMgb2YgaG93IHlvdSB3b3VsZCB1c3VhbGx5IGRlZmluZSBjb21wb25lbnRzOlxuXHQgICAqXG5cdCAgICogYGBganNcblx0ICAgKiAgIHZhciBteU1vZCA9IGFuZ3VsYXIubW9kdWxlKC4uLik7XG5cdCAgICogICBteU1vZC5jb21wb25lbnQoJ215Q29tcCcsIHtcblx0ICAgKiAgICAgdGVtcGxhdGU6ICc8ZGl2Pk15IG5hbWUgaXMge3skY3RybC5uYW1lfX08L2Rpdj4nLFxuXHQgICAqICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigpIHtcblx0ICAgKiAgICAgICB0aGlzLm5hbWUgPSAnc2hhaGFyJztcblx0ICAgKiAgICAgfVxuXHQgICAqICAgfSk7XG5cdCAgICpcblx0ICAgKiAgIG15TW9kLmNvbXBvbmVudCgnbXlDb21wJywge1xuXHQgICAqICAgICB0ZW1wbGF0ZTogJzxkaXY+TXkgbmFtZSBpcyB7eyRjdHJsLm5hbWV9fTwvZGl2PicsXG5cdCAgICogICAgIGJpbmRpbmdzOiB7bmFtZTogJ0AnfVxuXHQgICAqICAgfSk7XG5cdCAgICpcblx0ICAgKiAgIG15TW9kLmNvbXBvbmVudCgnbXlDb21wJywge1xuXHQgICAqICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL215LWNvbXAuaHRtbCcsXG5cdCAgICogICAgIGNvbnRyb2xsZXI6ICdNeUN0cmwgYXMgY3RybCcsXG5cdCAgICogICAgIGJpbmRpbmdzOiB7bmFtZTogJ0AnfVxuXHQgICAqICAgfSk7XG5cdCAgICpcblx0ICAgKiBgYGBcblx0ICAgKiBGb3IgbW9yZSBleGFtcGxlcywgYW5kIGFuIGluLWRlcHRoIGd1aWRlLCBzZWUgdGhlIHtAbGluayBndWlkZS9jb21wb25lbnQgY29tcG9uZW50IGd1aWRlfS5cblx0ICAgKlxuXHQgICAqIDxiciAvPlxuXHQgICAqIFNlZSBhbHNvIHtAbGluayBuZy4kY29tcGlsZVByb3ZpZGVyI2RpcmVjdGl2ZSAkY29tcGlsZVByb3ZpZGVyLmRpcmVjdGl2ZSgpfS5cblx0ICAgKi9cblx0ICB0aGlzLmNvbXBvbmVudCA9IGZ1bmN0aW9uIHJlZ2lzdGVyQ29tcG9uZW50KG5hbWUsIG9wdGlvbnMpIHtcblx0ICAgIHZhciBjb250cm9sbGVyID0gb3B0aW9ucy5jb250cm9sbGVyIHx8IGZ1bmN0aW9uKCkge307XG5cdFxuXHQgICAgZnVuY3Rpb24gZmFjdG9yeSgkaW5qZWN0b3IpIHtcblx0ICAgICAgZnVuY3Rpb24gbWFrZUluamVjdGFibGUoZm4pIHtcblx0ICAgICAgICBpZiAoaXNGdW5jdGlvbihmbikgfHwgaXNBcnJheShmbikpIHtcblx0ICAgICAgICAgIHJldHVybiBmdW5jdGlvbih0RWxlbWVudCwgdEF0dHJzKSB7XG5cdCAgICAgICAgICAgIHJldHVybiAkaW5qZWN0b3IuaW52b2tlKGZuLCB0aGlzLCB7JGVsZW1lbnQ6IHRFbGVtZW50LCAkYXR0cnM6IHRBdHRyc30pO1xuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgcmV0dXJuIGZuO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHRcblx0ICAgICAgdmFyIHRlbXBsYXRlID0gKCFvcHRpb25zLnRlbXBsYXRlICYmICFvcHRpb25zLnRlbXBsYXRlVXJsID8gJycgOiBvcHRpb25zLnRlbXBsYXRlKTtcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICBjb250cm9sbGVyOiBjb250cm9sbGVyLFxuXHQgICAgICAgIGNvbnRyb2xsZXJBczogaWRlbnRpZmllckZvckNvbnRyb2xsZXIob3B0aW9ucy5jb250cm9sbGVyKSB8fCBvcHRpb25zLmNvbnRyb2xsZXJBcyB8fCAnJGN0cmwnLFxuXHQgICAgICAgIHRlbXBsYXRlOiBtYWtlSW5qZWN0YWJsZSh0ZW1wbGF0ZSksXG5cdCAgICAgICAgdGVtcGxhdGVVcmw6IG1ha2VJbmplY3RhYmxlKG9wdGlvbnMudGVtcGxhdGVVcmwpLFxuXHQgICAgICAgIHRyYW5zY2x1ZGU6IG9wdGlvbnMudHJhbnNjbHVkZSxcblx0ICAgICAgICBzY29wZToge30sXG5cdCAgICAgICAgYmluZFRvQ29udHJvbGxlcjogb3B0aW9ucy5iaW5kaW5ncyB8fCB7fSxcblx0ICAgICAgICByZXN0cmljdDogJ0UnLFxuXHQgICAgICAgIHJlcXVpcmU6IG9wdGlvbnMucmVxdWlyZVxuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIENvcHkgYW55IGFubm90YXRpb24gcHJvcGVydGllcyAoc3RhcnRpbmcgd2l0aCAkKSBvdmVyIHRvIHRoZSBmYWN0b3J5IGZ1bmN0aW9uXG5cdCAgICAvLyBUaGVzZSBjb3VsZCBiZSB1c2VkIGJ5IGxpYnJhcmllcyBzdWNoIGFzIHRoZSBuZXcgY29tcG9uZW50IHJvdXRlclxuXHQgICAgZm9yRWFjaChvcHRpb25zLCBmdW5jdGlvbih2YWwsIGtleSkge1xuXHQgICAgICBpZiAoa2V5LmNoYXJBdCgwKSA9PT0gJyQnKSB7XG5cdCAgICAgICAgZmFjdG9yeVtrZXldID0gdmFsO1xuXHQgICAgICB9XG5cdCAgICB9KTtcblx0XG5cdCAgICBmYWN0b3J5LiRpbmplY3QgPSBbJyRpbmplY3RvciddO1xuXHRcblx0ICAgIHJldHVybiB0aGlzLmRpcmVjdGl2ZShuYW1lLCBmYWN0b3J5KTtcblx0ICB9O1xuXHRcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRjb21waWxlUHJvdmlkZXIjYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3Rcblx0ICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogUmV0cmlldmVzIG9yIG92ZXJyaWRlcyB0aGUgZGVmYXVsdCByZWd1bGFyIGV4cHJlc3Npb24gdGhhdCBpcyB1c2VkIGZvciB3aGl0ZWxpc3Rpbmcgb2Ygc2FmZVxuXHQgICAqIHVybHMgZHVyaW5nIGFbaHJlZl0gc2FuaXRpemF0aW9uLlxuXHQgICAqXG5cdCAgICogVGhlIHNhbml0aXphdGlvbiBpcyBhIHNlY3VyaXR5IG1lYXN1cmUgYWltZWQgYXQgcHJldmVudGluZyBYU1MgYXR0YWNrcyB2aWEgaHRtbCBsaW5rcy5cblx0ICAgKlxuXHQgICAqIEFueSB1cmwgYWJvdXQgdG8gYmUgYXNzaWduZWQgdG8gYVtocmVmXSB2aWEgZGF0YS1iaW5kaW5nIGlzIGZpcnN0IG5vcm1hbGl6ZWQgYW5kIHR1cm5lZCBpbnRvXG5cdCAgICogYW4gYWJzb2x1dGUgdXJsLiBBZnRlcndhcmRzLCB0aGUgdXJsIGlzIG1hdGNoZWQgYWdhaW5zdCB0aGUgYGFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0YFxuXHQgICAqIHJlZ3VsYXIgZXhwcmVzc2lvbi4gSWYgYSBtYXRjaCBpcyBmb3VuZCwgdGhlIG9yaWdpbmFsIHVybCBpcyB3cml0dGVuIGludG8gdGhlIGRvbS4gT3RoZXJ3aXNlLFxuXHQgICAqIHRoZSBhYnNvbHV0ZSB1cmwgaXMgcHJlZml4ZWQgd2l0aCBgJ3Vuc2FmZTonYCBzdHJpbmcgYW5kIG9ubHkgdGhlbiBpcyBpdCB3cml0dGVuIGludG8gdGhlIERPTS5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7UmVnRXhwPX0gcmVnZXhwIE5ldyByZWdleHAgdG8gd2hpdGVsaXN0IHVybHMgd2l0aC5cblx0ICAgKiBAcmV0dXJucyB7UmVnRXhwfG5nLiRjb21waWxlUHJvdmlkZXJ9IEN1cnJlbnQgUmVnRXhwIGlmIGNhbGxlZCB3aXRob3V0IHZhbHVlIG9yIHNlbGYgZm9yXG5cdCAgICogICAgY2hhaW5pbmcgb3RoZXJ3aXNlLlxuXHQgICAqL1xuXHQgIHRoaXMuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3QgPSBmdW5jdGlvbihyZWdleHApIHtcblx0ICAgIGlmIChpc0RlZmluZWQocmVnZXhwKSkge1xuXHQgICAgICAkJHNhbml0aXplVXJpUHJvdmlkZXIuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3QocmVnZXhwKTtcblx0ICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICByZXR1cm4gJCRzYW5pdGl6ZVVyaVByb3ZpZGVyLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0KCk7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkY29tcGlsZVByb3ZpZGVyI2ltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdFxuXHQgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBSZXRyaWV2ZXMgb3Igb3ZlcnJpZGVzIHRoZSBkZWZhdWx0IHJlZ3VsYXIgZXhwcmVzc2lvbiB0aGF0IGlzIHVzZWQgZm9yIHdoaXRlbGlzdGluZyBvZiBzYWZlXG5cdCAgICogdXJscyBkdXJpbmcgaW1nW3NyY10gc2FuaXRpemF0aW9uLlxuXHQgICAqXG5cdCAgICogVGhlIHNhbml0aXphdGlvbiBpcyBhIHNlY3VyaXR5IG1lYXN1cmUgYWltZWQgYXQgcHJldmVudCBYU1MgYXR0YWNrcyB2aWEgaHRtbCBsaW5rcy5cblx0ICAgKlxuXHQgICAqIEFueSB1cmwgYWJvdXQgdG8gYmUgYXNzaWduZWQgdG8gaW1nW3NyY10gdmlhIGRhdGEtYmluZGluZyBpcyBmaXJzdCBub3JtYWxpemVkIGFuZCB0dXJuZWQgaW50b1xuXHQgICAqIGFuIGFic29sdXRlIHVybC4gQWZ0ZXJ3YXJkcywgdGhlIHVybCBpcyBtYXRjaGVkIGFnYWluc3QgdGhlIGBpbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3RgXG5cdCAgICogcmVndWxhciBleHByZXNzaW9uLiBJZiBhIG1hdGNoIGlzIGZvdW5kLCB0aGUgb3JpZ2luYWwgdXJsIGlzIHdyaXR0ZW4gaW50byB0aGUgZG9tLiBPdGhlcndpc2UsXG5cdCAgICogdGhlIGFic29sdXRlIHVybCBpcyBwcmVmaXhlZCB3aXRoIGAndW5zYWZlOidgIHN0cmluZyBhbmQgb25seSB0aGVuIGlzIGl0IHdyaXR0ZW4gaW50byB0aGUgRE9NLlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtSZWdFeHA9fSByZWdleHAgTmV3IHJlZ2V4cCB0byB3aGl0ZWxpc3QgdXJscyB3aXRoLlxuXHQgICAqIEByZXR1cm5zIHtSZWdFeHB8bmcuJGNvbXBpbGVQcm92aWRlcn0gQ3VycmVudCBSZWdFeHAgaWYgY2FsbGVkIHdpdGhvdXQgdmFsdWUgb3Igc2VsZiBmb3Jcblx0ICAgKiAgICBjaGFpbmluZyBvdGhlcndpc2UuXG5cdCAgICovXG5cdCAgdGhpcy5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3QgPSBmdW5jdGlvbihyZWdleHApIHtcblx0ICAgIGlmIChpc0RlZmluZWQocmVnZXhwKSkge1xuXHQgICAgICAkJHNhbml0aXplVXJpUHJvdmlkZXIuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0KHJlZ2V4cCk7XG5cdCAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgcmV0dXJuICQkc2FuaXRpemVVcmlQcm92aWRlci5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3QoKTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgICRjb21waWxlUHJvdmlkZXIjZGVidWdJbmZvRW5hYmxlZFxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtib29sZWFuPX0gZW5hYmxlZCB1cGRhdGUgdGhlIGRlYnVnSW5mb0VuYWJsZWQgc3RhdGUgaWYgcHJvdmlkZWQsIG90aGVyd2lzZSBqdXN0IHJldHVybiB0aGVcblx0ICAgKiBjdXJyZW50IGRlYnVnSW5mb0VuYWJsZWQgc3RhdGVcblx0ICAgKiBAcmV0dXJucyB7Kn0gY3VycmVudCB2YWx1ZSBpZiB1c2VkIGFzIGdldHRlciBvciBpdHNlbGYgKGNoYWluaW5nKSBpZiB1c2VkIGFzIHNldHRlclxuXHQgICAqXG5cdCAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIENhbGwgdGhpcyBtZXRob2QgdG8gZW5hYmxlL2Rpc2FibGUgdmFyaW91cyBkZWJ1ZyBydW50aW1lIGluZm9ybWF0aW9uIGluIHRoZSBjb21waWxlciBzdWNoIGFzIGFkZGluZ1xuXHQgICAqIGJpbmRpbmcgaW5mb3JtYXRpb24gYW5kIGEgcmVmZXJlbmNlIHRvIHRoZSBjdXJyZW50IHNjb3BlIG9uIHRvIERPTSBlbGVtZW50cy5cblx0ICAgKiBJZiBlbmFibGVkLCB0aGUgY29tcGlsZXIgd2lsbCBhZGQgdGhlIGZvbGxvd2luZyB0byBET00gZWxlbWVudHMgdGhhdCBoYXZlIGJlZW4gYm91bmQgdG8gdGhlIHNjb3BlXG5cdCAgICogKiBgbmctYmluZGluZ2AgQ1NTIGNsYXNzXG5cdCAgICogKiBgJGJpbmRpbmdgIGRhdGEgcHJvcGVydHkgY29udGFpbmluZyBhbiBhcnJheSBvZiB0aGUgYmluZGluZyBleHByZXNzaW9uc1xuXHQgICAqXG5cdCAgICogWW91IG1heSB3YW50IHRvIGRpc2FibGUgdGhpcyBpbiBwcm9kdWN0aW9uIGZvciBhIHNpZ25pZmljYW50IHBlcmZvcm1hbmNlIGJvb3N0LiBTZWVcblx0ICAgKiB7QGxpbmsgZ3VpZGUvcHJvZHVjdGlvbiNkaXNhYmxpbmctZGVidWctZGF0YSBEaXNhYmxpbmcgRGVidWcgRGF0YX0gZm9yIG1vcmUuXG5cdCAgICpcblx0ICAgKiBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlLlxuXHQgICAqL1xuXHQgIHZhciBkZWJ1Z0luZm9FbmFibGVkID0gdHJ1ZTtcblx0ICB0aGlzLmRlYnVnSW5mb0VuYWJsZWQgPSBmdW5jdGlvbihlbmFibGVkKSB7XG5cdCAgICBpZiAoaXNEZWZpbmVkKGVuYWJsZWQpKSB7XG5cdCAgICAgIGRlYnVnSW5mb0VuYWJsZWQgPSBlbmFibGVkO1xuXHQgICAgICByZXR1cm4gdGhpcztcblx0ICAgIH1cblx0ICAgIHJldHVybiBkZWJ1Z0luZm9FbmFibGVkO1xuXHQgIH07XG5cdFxuXHQgIHRoaXMuJGdldCA9IFtcblx0ICAgICAgICAgICAgJyRpbmplY3RvcicsICckaW50ZXJwb2xhdGUnLCAnJGV4Y2VwdGlvbkhhbmRsZXInLCAnJHRlbXBsYXRlUmVxdWVzdCcsICckcGFyc2UnLFxuXHQgICAgICAgICAgICAnJGNvbnRyb2xsZXInLCAnJHJvb3RTY29wZScsICckc2NlJywgJyRhbmltYXRlJywgJyQkc2FuaXRpemVVcmknLFxuXHQgICAgZnVuY3Rpb24oJGluamVjdG9yLCAgICRpbnRlcnBvbGF0ZSwgICAkZXhjZXB0aW9uSGFuZGxlciwgICAkdGVtcGxhdGVSZXF1ZXN0LCAgICRwYXJzZSxcblx0ICAgICAgICAgICAgICRjb250cm9sbGVyLCAgICRyb290U2NvcGUsICAgJHNjZSwgICAkYW5pbWF0ZSwgICAkJHNhbml0aXplVXJpKSB7XG5cdFxuXHQgICAgdmFyIFNJTVBMRV9BVFRSX05BTUUgPSAvXlxcdy87XG5cdCAgICB2YXIgc3BlY2lhbEF0dHJIb2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0ICAgIHZhciBBdHRyaWJ1dGVzID0gZnVuY3Rpb24oZWxlbWVudCwgYXR0cmlidXRlc1RvQ29weSkge1xuXHQgICAgICBpZiAoYXR0cmlidXRlc1RvQ29weSkge1xuXHQgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoYXR0cmlidXRlc1RvQ29weSk7XG5cdCAgICAgICAgdmFyIGksIGwsIGtleTtcblx0XG5cdCAgICAgICAgZm9yIChpID0gMCwgbCA9IGtleXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG5cdCAgICAgICAgICBrZXkgPSBrZXlzW2ldO1xuXHQgICAgICAgICAgdGhpc1trZXldID0gYXR0cmlidXRlc1RvQ29weVtrZXldO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB0aGlzLiRhdHRyID0ge307XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHRoaXMuJCRlbGVtZW50ID0gZWxlbWVudDtcblx0ICAgIH07XG5cdFxuXHQgICAgQXR0cmlidXRlcy5wcm90b3R5cGUgPSB7XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAqIEBuYW1lICRjb21waWxlLmRpcmVjdGl2ZS5BdHRyaWJ1dGVzIyRub3JtYWxpemVcblx0ICAgICAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgICAgICpcblx0ICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAqIENvbnZlcnRzIGFuIGF0dHJpYnV0ZSBuYW1lIChlLmcuIGRhc2gvY29sb24vdW5kZXJzY29yZS1kZWxpbWl0ZWQgc3RyaW5nLCBvcHRpb25hbGx5IHByZWZpeGVkIHdpdGggYHgtYCBvclxuXHQgICAgICAgKiBgZGF0YS1gKSB0byBpdHMgbm9ybWFsaXplZCwgY2FtZWxDYXNlIGZvcm0uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEFsc28gdGhlcmUgaXMgc3BlY2lhbCBjYXNlIGZvciBNb3ogcHJlZml4IHN0YXJ0aW5nIHdpdGggdXBwZXIgY2FzZSBsZXR0ZXIuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEZvciBmdXJ0aGVyIGluZm9ybWF0aW9uIGNoZWNrIG91dCB0aGUgZ3VpZGUgb24ge0BsaW5rIGd1aWRlL2RpcmVjdGl2ZSNtYXRjaGluZy1kaXJlY3RpdmVzIE1hdGNoaW5nIERpcmVjdGl2ZXN9XG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIE5hbWUgdG8gbm9ybWFsaXplXG5cdCAgICAgICAqL1xuXHQgICAgICAkbm9ybWFsaXplOiBkaXJlY3RpdmVOb3JtYWxpemUsXG5cdFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJGNvbXBpbGUuZGlyZWN0aXZlLkF0dHJpYnV0ZXMjJGFkZENsYXNzXG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBBZGRzIHRoZSBDU1MgY2xhc3MgdmFsdWUgc3BlY2lmaWVkIGJ5IHRoZSBjbGFzc1ZhbCBwYXJhbWV0ZXIgdG8gdGhlIGVsZW1lbnQuIElmIGFuaW1hdGlvbnNcblx0ICAgICAgICogYXJlIGVuYWJsZWQgdGhlbiBhbiBhbmltYXRpb24gd2lsbCBiZSB0cmlnZ2VyZWQgZm9yIHRoZSBjbGFzcyBhZGRpdGlvbi5cblx0ICAgICAgICpcblx0ICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzVmFsIFRoZSBjbGFzc05hbWUgdmFsdWUgdGhhdCB3aWxsIGJlIGFkZGVkIHRvIHRoZSBlbGVtZW50XG5cdCAgICAgICAqL1xuXHQgICAgICAkYWRkQ2xhc3M6IGZ1bmN0aW9uKGNsYXNzVmFsKSB7XG5cdCAgICAgICAgaWYgKGNsYXNzVmFsICYmIGNsYXNzVmFsLmxlbmd0aCA+IDApIHtcblx0ICAgICAgICAgICRhbmltYXRlLmFkZENsYXNzKHRoaXMuJCRlbGVtZW50LCBjbGFzc1ZhbCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJGNvbXBpbGUuZGlyZWN0aXZlLkF0dHJpYnV0ZXMjJHJlbW92ZUNsYXNzXG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBSZW1vdmVzIHRoZSBDU1MgY2xhc3MgdmFsdWUgc3BlY2lmaWVkIGJ5IHRoZSBjbGFzc1ZhbCBwYXJhbWV0ZXIgZnJvbSB0aGUgZWxlbWVudC4gSWZcblx0ICAgICAgICogYW5pbWF0aW9ucyBhcmUgZW5hYmxlZCB0aGVuIGFuIGFuaW1hdGlvbiB3aWxsIGJlIHRyaWdnZXJlZCBmb3IgdGhlIGNsYXNzIHJlbW92YWwuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjbGFzc1ZhbCBUaGUgY2xhc3NOYW1lIHZhbHVlIHRoYXQgd2lsbCBiZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnRcblx0ICAgICAgICovXG5cdCAgICAgICRyZW1vdmVDbGFzczogZnVuY3Rpb24oY2xhc3NWYWwpIHtcblx0ICAgICAgICBpZiAoY2xhc3NWYWwgJiYgY2xhc3NWYWwubGVuZ3RoID4gMCkge1xuXHQgICAgICAgICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3ModGhpcy4kJGVsZW1lbnQsIGNsYXNzVmFsKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgKiBAbmFtZSAkY29tcGlsZS5kaXJlY3RpdmUuQXR0cmlidXRlcyMkdXBkYXRlQ2xhc3Ncblx0ICAgICAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgICAgICpcblx0ICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAqIEFkZHMgYW5kIHJlbW92ZXMgdGhlIGFwcHJvcHJpYXRlIENTUyBjbGFzcyB2YWx1ZXMgdG8gdGhlIGVsZW1lbnQgYmFzZWQgb24gdGhlIGRpZmZlcmVuY2Vcblx0ICAgICAgICogYmV0d2VlbiB0aGUgbmV3IGFuZCBvbGQgQ1NTIGNsYXNzIHZhbHVlcyAoc3BlY2lmaWVkIGFzIG5ld0NsYXNzZXMgYW5kIG9sZENsYXNzZXMpLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmV3Q2xhc3NlcyBUaGUgY3VycmVudCBDU1MgY2xhc3NOYW1lIHZhbHVlXG5cdCAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvbGRDbGFzc2VzIFRoZSBmb3JtZXIgQ1NTIGNsYXNzTmFtZSB2YWx1ZVxuXHQgICAgICAgKi9cblx0ICAgICAgJHVwZGF0ZUNsYXNzOiBmdW5jdGlvbihuZXdDbGFzc2VzLCBvbGRDbGFzc2VzKSB7XG5cdCAgICAgICAgdmFyIHRvQWRkID0gdG9rZW5EaWZmZXJlbmNlKG5ld0NsYXNzZXMsIG9sZENsYXNzZXMpO1xuXHQgICAgICAgIGlmICh0b0FkZCAmJiB0b0FkZC5sZW5ndGgpIHtcblx0ICAgICAgICAgICRhbmltYXRlLmFkZENsYXNzKHRoaXMuJCRlbGVtZW50LCB0b0FkZCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB2YXIgdG9SZW1vdmUgPSB0b2tlbkRpZmZlcmVuY2Uob2xkQ2xhc3NlcywgbmV3Q2xhc3Nlcyk7XG5cdCAgICAgICAgaWYgKHRvUmVtb3ZlICYmIHRvUmVtb3ZlLmxlbmd0aCkge1xuXHQgICAgICAgICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3ModGhpcy4kJGVsZW1lbnQsIHRvUmVtb3ZlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogU2V0IGEgbm9ybWFsaXplZCBhdHRyaWJ1dGUgb24gdGhlIGVsZW1lbnQgaW4gYSB3YXkgc3VjaCB0aGF0IGFsbCBkaXJlY3RpdmVzXG5cdCAgICAgICAqIGNhbiBzaGFyZSB0aGUgYXR0cmlidXRlLiBUaGlzIGZ1bmN0aW9uIHByb3Blcmx5IGhhbmRsZXMgYm9vbGVhbiBhdHRyaWJ1dGVzLlxuXHQgICAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IE5vcm1hbGl6ZWQga2V5LiAoaWUgbmdBdHRyaWJ1dGUpXG5cdCAgICAgICAqIEBwYXJhbSB7c3RyaW5nfGJvb2xlYW59IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQuIElmIGBudWxsYCBhdHRyaWJ1dGUgd2lsbCBiZSBkZWxldGVkLlxuXHQgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSB3cml0ZUF0dHIgSWYgZmFsc2UsIGRvZXMgbm90IHdyaXRlIHRoZSB2YWx1ZSB0byBET00gZWxlbWVudCBhdHRyaWJ1dGUuXG5cdCAgICAgICAqICAgICBEZWZhdWx0cyB0byB0cnVlLlxuXHQgICAgICAgKiBAcGFyYW0ge3N0cmluZz19IGF0dHJOYW1lIE9wdGlvbmFsIG5vbmUgbm9ybWFsaXplZCBuYW1lLiBEZWZhdWx0cyB0byBrZXkuXG5cdCAgICAgICAqL1xuXHQgICAgICAkc2V0OiBmdW5jdGlvbihrZXksIHZhbHVlLCB3cml0ZUF0dHIsIGF0dHJOYW1lKSB7XG5cdCAgICAgICAgLy8gVE9ETzogZGVjaWRlIHdoZXRoZXIgb3Igbm90IHRvIHRocm93IGFuIGVycm9yIGlmIFwiY2xhc3NcIlxuXHQgICAgICAgIC8vaXMgc2V0IHRocm91Z2ggdGhpcyBmdW5jdGlvbiBzaW5jZSBpdCBtYXkgY2F1c2UgJHVwZGF0ZUNsYXNzIHRvXG5cdCAgICAgICAgLy9iZWNvbWUgdW5zdGFibGUuXG5cdFxuXHQgICAgICAgIHZhciBub2RlID0gdGhpcy4kJGVsZW1lbnRbMF0sXG5cdCAgICAgICAgICAgIGJvb2xlYW5LZXkgPSBnZXRCb29sZWFuQXR0ck5hbWUobm9kZSwga2V5KSxcblx0ICAgICAgICAgICAgYWxpYXNlZEtleSA9IGdldEFsaWFzZWRBdHRyTmFtZShrZXkpLFxuXHQgICAgICAgICAgICBvYnNlcnZlciA9IGtleSxcblx0ICAgICAgICAgICAgbm9kZU5hbWU7XG5cdFxuXHQgICAgICAgIGlmIChib29sZWFuS2V5KSB7XG5cdCAgICAgICAgICB0aGlzLiQkZWxlbWVudC5wcm9wKGtleSwgdmFsdWUpO1xuXHQgICAgICAgICAgYXR0ck5hbWUgPSBib29sZWFuS2V5O1xuXHQgICAgICAgIH0gZWxzZSBpZiAoYWxpYXNlZEtleSkge1xuXHQgICAgICAgICAgdGhpc1thbGlhc2VkS2V5XSA9IHZhbHVlO1xuXHQgICAgICAgICAgb2JzZXJ2ZXIgPSBhbGlhc2VkS2V5O1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XG5cdFxuXHQgICAgICAgIC8vIHRyYW5zbGF0ZSBub3JtYWxpemVkIGtleSB0byBhY3R1YWwga2V5XG5cdCAgICAgICAgaWYgKGF0dHJOYW1lKSB7XG5cdCAgICAgICAgICB0aGlzLiRhdHRyW2tleV0gPSBhdHRyTmFtZTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgYXR0ck5hbWUgPSB0aGlzLiRhdHRyW2tleV07XG5cdCAgICAgICAgICBpZiAoIWF0dHJOYW1lKSB7XG5cdCAgICAgICAgICAgIHRoaXMuJGF0dHJba2V5XSA9IGF0dHJOYW1lID0gc25ha2VfY2FzZShrZXksICctJyk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBub2RlTmFtZSA9IG5vZGVOYW1lXyh0aGlzLiQkZWxlbWVudCk7XG5cdFxuXHQgICAgICAgIGlmICgobm9kZU5hbWUgPT09ICdhJyAmJiAoa2V5ID09PSAnaHJlZicgfHwga2V5ID09PSAneGxpbmtIcmVmJykpIHx8XG5cdCAgICAgICAgICAgIChub2RlTmFtZSA9PT0gJ2ltZycgJiYga2V5ID09PSAnc3JjJykpIHtcblx0ICAgICAgICAgIC8vIHNhbml0aXplIGFbaHJlZl0gYW5kIGltZ1tzcmNdIHZhbHVlc1xuXHQgICAgICAgICAgdGhpc1trZXldID0gdmFsdWUgPSAkJHNhbml0aXplVXJpKHZhbHVlLCBrZXkgPT09ICdzcmMnKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKG5vZGVOYW1lID09PSAnaW1nJyAmJiBrZXkgPT09ICdzcmNzZXQnKSB7XG5cdCAgICAgICAgICAvLyBzYW5pdGl6ZSBpbWdbc3Jjc2V0XSB2YWx1ZXNcblx0ICAgICAgICAgIHZhciByZXN1bHQgPSBcIlwiO1xuXHRcblx0ICAgICAgICAgIC8vIGZpcnN0IGNoZWNrIGlmIHRoZXJlIGFyZSBzcGFjZXMgYmVjYXVzZSBpdCdzIG5vdCB0aGUgc2FtZSBwYXR0ZXJuXG5cdCAgICAgICAgICB2YXIgdHJpbW1lZFNyY3NldCA9IHRyaW0odmFsdWUpO1xuXHQgICAgICAgICAgLy8gICAgICAgICAgICAgICAgKCAgIDk5OXggICAsfCAgIDk5OXcgICAsfCAgICx8LCAgIClcblx0ICAgICAgICAgIHZhciBzcmNQYXR0ZXJuID0gLyhcXHMrXFxkK3hcXHMqLHxcXHMrXFxkK3dcXHMqLHxcXHMrLHwsXFxzKykvO1xuXHQgICAgICAgICAgdmFyIHBhdHRlcm4gPSAvXFxzLy50ZXN0KHRyaW1tZWRTcmNzZXQpID8gc3JjUGF0dGVybiA6IC8oLCkvO1xuXHRcblx0ICAgICAgICAgIC8vIHNwbGl0IHNyY3NldCBpbnRvIHR1cGxlIG9mIHVyaSBhbmQgZGVzY3JpcHRvciBleGNlcHQgZm9yIHRoZSBsYXN0IGl0ZW1cblx0ICAgICAgICAgIHZhciByYXdVcmlzID0gdHJpbW1lZFNyY3NldC5zcGxpdChwYXR0ZXJuKTtcblx0XG5cdCAgICAgICAgICAvLyBmb3IgZWFjaCB0dXBsZXNcblx0ICAgICAgICAgIHZhciBuYnJVcmlzV2l0aDJwYXJ0cyA9IE1hdGguZmxvb3IocmF3VXJpcy5sZW5ndGggLyAyKTtcblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbmJyVXJpc1dpdGgycGFydHM7IGkrKykge1xuXHQgICAgICAgICAgICB2YXIgaW5uZXJJZHggPSBpICogMjtcblx0ICAgICAgICAgICAgLy8gc2FuaXRpemUgdGhlIHVyaVxuXHQgICAgICAgICAgICByZXN1bHQgKz0gJCRzYW5pdGl6ZVVyaSh0cmltKHJhd1VyaXNbaW5uZXJJZHhdKSwgdHJ1ZSk7XG5cdCAgICAgICAgICAgIC8vIGFkZCB0aGUgZGVzY3JpcHRvclxuXHQgICAgICAgICAgICByZXN1bHQgKz0gKFwiIFwiICsgdHJpbShyYXdVcmlzW2lubmVySWR4ICsgMV0pKTtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAvLyBzcGxpdCB0aGUgbGFzdCBpdGVtIGludG8gdXJpIGFuZCBkZXNjcmlwdG9yXG5cdCAgICAgICAgICB2YXIgbGFzdFR1cGxlID0gdHJpbShyYXdVcmlzW2kgKiAyXSkuc3BsaXQoL1xccy8pO1xuXHRcblx0ICAgICAgICAgIC8vIHNhbml0aXplIHRoZSBsYXN0IHVyaVxuXHQgICAgICAgICAgcmVzdWx0ICs9ICQkc2FuaXRpemVVcmkodHJpbShsYXN0VHVwbGVbMF0pLCB0cnVlKTtcblx0XG5cdCAgICAgICAgICAvLyBhbmQgYWRkIHRoZSBsYXN0IGRlc2NyaXB0b3IgaWYgYW55XG5cdCAgICAgICAgICBpZiAobGFzdFR1cGxlLmxlbmd0aCA9PT0gMikge1xuXHQgICAgICAgICAgICByZXN1bHQgKz0gKFwiIFwiICsgdHJpbShsYXN0VHVwbGVbMV0pKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIHRoaXNba2V5XSA9IHZhbHVlID0gcmVzdWx0O1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKHdyaXRlQXR0ciAhPT0gZmFsc2UpIHtcblx0ICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCBpc1VuZGVmaW5lZCh2YWx1ZSkpIHtcblx0ICAgICAgICAgICAgdGhpcy4kJGVsZW1lbnQucmVtb3ZlQXR0cihhdHRyTmFtZSk7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBpZiAoU0lNUExFX0FUVFJfTkFNRS50ZXN0KGF0dHJOYW1lKSkge1xuXHQgICAgICAgICAgICAgIHRoaXMuJCRlbGVtZW50LmF0dHIoYXR0ck5hbWUsIHZhbHVlKTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICBzZXRTcGVjaWFsQXR0cih0aGlzLiQkZWxlbWVudFswXSwgYXR0ck5hbWUsIHZhbHVlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy8gZmlyZSBvYnNlcnZlcnNcblx0ICAgICAgICB2YXIgJCRvYnNlcnZlcnMgPSB0aGlzLiQkb2JzZXJ2ZXJzO1xuXHQgICAgICAgICQkb2JzZXJ2ZXJzICYmIGZvckVhY2goJCRvYnNlcnZlcnNbb2JzZXJ2ZXJdLCBmdW5jdGlvbihmbikge1xuXHQgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgZm4odmFsdWUpO1xuXHQgICAgICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgICAkZXhjZXB0aW9uSGFuZGxlcihlKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0ICAgICAgfSxcblx0XG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgKiBAbmFtZSAkY29tcGlsZS5kaXJlY3RpdmUuQXR0cmlidXRlcyMkb2JzZXJ2ZVxuXHQgICAgICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICogT2JzZXJ2ZXMgYW4gaW50ZXJwb2xhdGVkIGF0dHJpYnV0ZS5cblx0ICAgICAgICpcblx0ICAgICAgICogVGhlIG9ic2VydmVyIGZ1bmN0aW9uIHdpbGwgYmUgaW52b2tlZCBvbmNlIGR1cmluZyB0aGUgbmV4dCBgJGRpZ2VzdGAgZm9sbG93aW5nXG5cdCAgICAgICAqIGNvbXBpbGF0aW9uLiBUaGUgb2JzZXJ2ZXIgaXMgdGhlbiBpbnZva2VkIHdoZW5ldmVyIHRoZSBpbnRlcnBvbGF0ZWQgdmFsdWVcblx0ICAgICAgICogY2hhbmdlcy5cblx0ICAgICAgICpcblx0ICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBOb3JtYWxpemVkIGtleS4gKGllIG5nQXR0cmlidXRlKSAuXG5cdCAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oaW50ZXJwb2xhdGVkVmFsdWUpfSBmbiBGdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIHdoZW5ldmVyXG5cdCAgICAgICAgICAgICAgICB0aGUgaW50ZXJwb2xhdGVkIHZhbHVlIG9mIHRoZSBhdHRyaWJ1dGUgY2hhbmdlcy5cblx0ICAgICAgICogICAgICAgIFNlZSB0aGUge0BsaW5rIGd1aWRlL2ludGVycG9sYXRpb24jaG93LXRleHQtYW5kLWF0dHJpYnV0ZS1iaW5kaW5ncy13b3JrIEludGVycG9sYXRpb25cblx0ICAgICAgICogICAgICAgIGd1aWRlfSBmb3IgbW9yZSBpbmZvLlxuXHQgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb24oKX0gUmV0dXJucyBhIGRlcmVnaXN0cmF0aW9uIGZ1bmN0aW9uIGZvciB0aGlzIG9ic2VydmVyLlxuXHQgICAgICAgKi9cblx0ICAgICAgJG9ic2VydmU6IGZ1bmN0aW9uKGtleSwgZm4pIHtcblx0ICAgICAgICB2YXIgYXR0cnMgPSB0aGlzLFxuXHQgICAgICAgICAgICAkJG9ic2VydmVycyA9IChhdHRycy4kJG9ic2VydmVycyB8fCAoYXR0cnMuJCRvYnNlcnZlcnMgPSBjcmVhdGVNYXAoKSkpLFxuXHQgICAgICAgICAgICBsaXN0ZW5lcnMgPSAoJCRvYnNlcnZlcnNba2V5XSB8fCAoJCRvYnNlcnZlcnNba2V5XSA9IFtdKSk7XG5cdFxuXHQgICAgICAgIGxpc3RlbmVycy5wdXNoKGZuKTtcblx0ICAgICAgICAkcm9vdFNjb3BlLiRldmFsQXN5bmMoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBpZiAoIWxpc3RlbmVycy4kJGludGVyICYmIGF0dHJzLmhhc093blByb3BlcnR5KGtleSkgJiYgIWlzVW5kZWZpbmVkKGF0dHJzW2tleV0pKSB7XG5cdCAgICAgICAgICAgIC8vIG5vIG9uZSByZWdpc3RlcmVkIGF0dHJpYnV0ZSBpbnRlcnBvbGF0aW9uIGZ1bmN0aW9uLCBzbyBsZXRzIGNhbGwgaXQgbWFudWFsbHlcblx0ICAgICAgICAgICAgZm4oYXR0cnNba2V5XSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIGFycmF5UmVtb3ZlKGxpc3RlbmVycywgZm4pO1xuXHQgICAgICAgIH07XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gc2V0U3BlY2lhbEF0dHIoZWxlbWVudCwgYXR0ck5hbWUsIHZhbHVlKSB7XG5cdCAgICAgIC8vIEF0dHJpYnV0ZXMgbmFtZXMgdGhhdCBkbyBub3Qgc3RhcnQgd2l0aCBsZXR0ZXJzIChzdWNoIGFzIGAoY2xpY2spYCkgY2Fubm90IGJlIHNldCB1c2luZyBgc2V0QXR0cmlidXRlYFxuXHQgICAgICAvLyBzbyB3ZSBoYXZlIHRvIGp1bXAgdGhyb3VnaCBzb21lIGhvb3BzIHRvIGdldCBzdWNoIGFuIGF0dHJpYnV0ZVxuXHQgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL3B1bGwvMTMzMThcblx0ICAgICAgc3BlY2lhbEF0dHJIb2xkZXIuaW5uZXJIVE1MID0gXCI8c3BhbiBcIiArIGF0dHJOYW1lICsgXCI+XCI7XG5cdCAgICAgIHZhciBhdHRyaWJ1dGVzID0gc3BlY2lhbEF0dHJIb2xkZXIuZmlyc3RDaGlsZC5hdHRyaWJ1dGVzO1xuXHQgICAgICB2YXIgYXR0cmlidXRlID0gYXR0cmlidXRlc1swXTtcblx0ICAgICAgLy8gV2UgaGF2ZSB0byByZW1vdmUgdGhlIGF0dHJpYnV0ZSBmcm9tIGl0cyBjb250YWluZXIgZWxlbWVudCBiZWZvcmUgd2UgY2FuIGFkZCBpdCB0byB0aGUgZGVzdGluYXRpb24gZWxlbWVudFxuXHQgICAgICBhdHRyaWJ1dGVzLnJlbW92ZU5hbWVkSXRlbShhdHRyaWJ1dGUubmFtZSk7XG5cdCAgICAgIGF0dHJpYnV0ZS52YWx1ZSA9IHZhbHVlO1xuXHQgICAgICBlbGVtZW50LmF0dHJpYnV0ZXMuc2V0TmFtZWRJdGVtKGF0dHJpYnV0ZSk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gc2FmZUFkZENsYXNzKCRlbGVtZW50LCBjbGFzc05hbWUpIHtcblx0ICAgICAgdHJ5IHtcblx0ICAgICAgICAkZWxlbWVudC5hZGRDbGFzcyhjbGFzc05hbWUpO1xuXHQgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgLy8gaWdub3JlLCBzaW5jZSBpdCBtZWFucyB0aGF0IHdlIGFyZSB0cnlpbmcgdG8gc2V0IGNsYXNzIG9uXG5cdCAgICAgICAgLy8gU1ZHIGVsZW1lbnQsIHdoZXJlIGNsYXNzIG5hbWUgaXMgcmVhZC1vbmx5LlxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIHZhciBzdGFydFN5bWJvbCA9ICRpbnRlcnBvbGF0ZS5zdGFydFN5bWJvbCgpLFxuXHQgICAgICAgIGVuZFN5bWJvbCA9ICRpbnRlcnBvbGF0ZS5lbmRTeW1ib2woKSxcblx0ICAgICAgICBkZW5vcm1hbGl6ZVRlbXBsYXRlID0gKHN0YXJ0U3ltYm9sID09ICd7eycgJiYgZW5kU3ltYm9sICA9PSAnfX0nKVxuXHQgICAgICAgICAgICA/IGlkZW50aXR5XG5cdCAgICAgICAgICAgIDogZnVuY3Rpb24gZGVub3JtYWxpemVUZW1wbGF0ZSh0ZW1wbGF0ZSkge1xuXHQgICAgICAgICAgICAgIHJldHVybiB0ZW1wbGF0ZS5yZXBsYWNlKC9cXHtcXHsvZywgc3RhcnRTeW1ib2wpLnJlcGxhY2UoL319L2csIGVuZFN5bWJvbCk7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBOR19BVFRSX0JJTkRJTkcgPSAvXm5nQXR0cltBLVpdLztcblx0ICAgIHZhciBNVUxUSV9FTEVNRU5UX0RJUl9SRSA9IC9eKC4rKVN0YXJ0JC87XG5cdFxuXHQgICAgY29tcGlsZS4kJGFkZEJpbmRpbmdJbmZvID0gZGVidWdJbmZvRW5hYmxlZCA/IGZ1bmN0aW9uICQkYWRkQmluZGluZ0luZm8oJGVsZW1lbnQsIGJpbmRpbmcpIHtcblx0ICAgICAgdmFyIGJpbmRpbmdzID0gJGVsZW1lbnQuZGF0YSgnJGJpbmRpbmcnKSB8fCBbXTtcblx0XG5cdCAgICAgIGlmIChpc0FycmF5KGJpbmRpbmcpKSB7XG5cdCAgICAgICAgYmluZGluZ3MgPSBiaW5kaW5ncy5jb25jYXQoYmluZGluZyk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgYmluZGluZ3MucHVzaChiaW5kaW5nKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgJGVsZW1lbnQuZGF0YSgnJGJpbmRpbmcnLCBiaW5kaW5ncyk7XG5cdCAgICB9IDogbm9vcDtcblx0XG5cdCAgICBjb21waWxlLiQkYWRkQmluZGluZ0NsYXNzID0gZGVidWdJbmZvRW5hYmxlZCA/IGZ1bmN0aW9uICQkYWRkQmluZGluZ0NsYXNzKCRlbGVtZW50KSB7XG5cdCAgICAgIHNhZmVBZGRDbGFzcygkZWxlbWVudCwgJ25nLWJpbmRpbmcnKTtcblx0ICAgIH0gOiBub29wO1xuXHRcblx0ICAgIGNvbXBpbGUuJCRhZGRTY29wZUluZm8gPSBkZWJ1Z0luZm9FbmFibGVkID8gZnVuY3Rpb24gJCRhZGRTY29wZUluZm8oJGVsZW1lbnQsIHNjb3BlLCBpc29sYXRlZCwgbm9UZW1wbGF0ZSkge1xuXHQgICAgICB2YXIgZGF0YU5hbWUgPSBpc29sYXRlZCA/IChub1RlbXBsYXRlID8gJyRpc29sYXRlU2NvcGVOb1RlbXBsYXRlJyA6ICckaXNvbGF0ZVNjb3BlJykgOiAnJHNjb3BlJztcblx0ICAgICAgJGVsZW1lbnQuZGF0YShkYXRhTmFtZSwgc2NvcGUpO1xuXHQgICAgfSA6IG5vb3A7XG5cdFxuXHQgICAgY29tcGlsZS4kJGFkZFNjb3BlQ2xhc3MgPSBkZWJ1Z0luZm9FbmFibGVkID8gZnVuY3Rpb24gJCRhZGRTY29wZUNsYXNzKCRlbGVtZW50LCBpc29sYXRlZCkge1xuXHQgICAgICBzYWZlQWRkQ2xhc3MoJGVsZW1lbnQsIGlzb2xhdGVkID8gJ25nLWlzb2xhdGUtc2NvcGUnIDogJ25nLXNjb3BlJyk7XG5cdCAgICB9IDogbm9vcDtcblx0XG5cdCAgICByZXR1cm4gY29tcGlsZTtcblx0XG5cdCAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cdFxuXHQgICAgZnVuY3Rpb24gY29tcGlsZSgkY29tcGlsZU5vZGVzLCB0cmFuc2NsdWRlRm4sIG1heFByaW9yaXR5LCBpZ25vcmVEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzQ29tcGlsZUNvbnRleHQpIHtcblx0ICAgICAgaWYgKCEoJGNvbXBpbGVOb2RlcyBpbnN0YW5jZW9mIGpxTGl0ZSkpIHtcblx0ICAgICAgICAvLyBqcXVlcnkgYWx3YXlzIHJld3JhcHMsIHdoZXJlYXMgd2UgbmVlZCB0byBwcmVzZXJ2ZSB0aGUgb3JpZ2luYWwgc2VsZWN0b3Igc28gdGhhdCB3ZSBjYW5cblx0ICAgICAgICAvLyBtb2RpZnkgaXQuXG5cdCAgICAgICAgJGNvbXBpbGVOb2RlcyA9IGpxTGl0ZSgkY29tcGlsZU5vZGVzKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgdmFyIE5PVF9FTVBUWSA9IC9cXFMrLztcblx0XG5cdCAgICAgIC8vIFdlIGNhbiBub3QgY29tcGlsZSB0b3AgbGV2ZWwgdGV4dCBlbGVtZW50cyBzaW5jZSB0ZXh0IG5vZGVzIGNhbiBiZSBtZXJnZWQgYW5kIHdlIHdpbGxcblx0ICAgICAgLy8gbm90IGJlIGFibGUgdG8gYXR0YWNoIHNjb3BlIGRhdGEgdG8gdGhlbSwgc28gd2Ugd2lsbCB3cmFwIHRoZW0gaW4gPHNwYW4+XG5cdCAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSAkY29tcGlsZU5vZGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgdmFyIGRvbU5vZGUgPSAkY29tcGlsZU5vZGVzW2ldO1xuXHRcblx0ICAgICAgICBpZiAoZG9tTm9kZS5ub2RlVHlwZSA9PT0gTk9ERV9UWVBFX1RFWFQgJiYgZG9tTm9kZS5ub2RlVmFsdWUubWF0Y2goTk9UX0VNUFRZKSAvKiBub24tZW1wdHkgKi8pIHtcblx0ICAgICAgICAgIGpxTGl0ZVdyYXBOb2RlKGRvbU5vZGUsICRjb21waWxlTm9kZXNbaV0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJykpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHRcblx0ICAgICAgdmFyIGNvbXBvc2l0ZUxpbmtGbiA9XG5cdCAgICAgICAgICAgICAgY29tcGlsZU5vZGVzKCRjb21waWxlTm9kZXMsIHRyYW5zY2x1ZGVGbiwgJGNvbXBpbGVOb2Rlcyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4UHJpb3JpdHksIGlnbm9yZURpcmVjdGl2ZSwgcHJldmlvdXNDb21waWxlQ29udGV4dCk7XG5cdCAgICAgIGNvbXBpbGUuJCRhZGRTY29wZUNsYXNzKCRjb21waWxlTm9kZXMpO1xuXHQgICAgICB2YXIgbmFtZXNwYWNlID0gbnVsbDtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uIHB1YmxpY0xpbmtGbihzY29wZSwgY2xvbmVDb25uZWN0Rm4sIG9wdGlvbnMpIHtcblx0ICAgICAgICBhc3NlcnRBcmcoc2NvcGUsICdzY29wZScpO1xuXHRcblx0ICAgICAgICBpZiAocHJldmlvdXNDb21waWxlQ29udGV4dCAmJiBwcmV2aW91c0NvbXBpbGVDb250ZXh0Lm5lZWRzTmV3U2NvcGUpIHtcblx0ICAgICAgICAgIC8vIEEgcGFyZW50IGRpcmVjdGl2ZSBkaWQgYSByZXBsYWNlIGFuZCBhIGRpcmVjdGl2ZSBvbiB0aGlzIGVsZW1lbnQgYXNrZWRcblx0ICAgICAgICAgIC8vIGZvciB0cmFuc2NsdXNpb24sIHdoaWNoIGNhdXNlZCB1cyB0byBsb3NlIGEgbGF5ZXIgb2YgZWxlbWVudCBvbiB3aGljaFxuXHQgICAgICAgICAgLy8gd2UgY291bGQgaG9sZCB0aGUgbmV3IHRyYW5zY2x1c2lvbiBzY29wZSwgc28gd2Ugd2lsbCBjcmVhdGUgaXQgbWFudWFsbHlcblx0ICAgICAgICAgIC8vIGhlcmUuXG5cdCAgICAgICAgICBzY29wZSA9IHNjb3BlLiRwYXJlbnQuJG5ldygpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICAgICAgdmFyIHBhcmVudEJvdW5kVHJhbnNjbHVkZUZuID0gb3B0aW9ucy5wYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbixcblx0ICAgICAgICAgIHRyYW5zY2x1ZGVDb250cm9sbGVycyA9IG9wdGlvbnMudHJhbnNjbHVkZUNvbnRyb2xsZXJzLFxuXHQgICAgICAgICAgZnV0dXJlUGFyZW50RWxlbWVudCA9IG9wdGlvbnMuZnV0dXJlUGFyZW50RWxlbWVudDtcblx0XG5cdCAgICAgICAgLy8gV2hlbiBgcGFyZW50Qm91bmRUcmFuc2NsdWRlRm5gIGlzIHBhc3NlZCwgaXQgaXMgYVxuXHQgICAgICAgIC8vIGBjb250cm9sbGVyc0JvdW5kVHJhbnNjbHVkZWAgZnVuY3Rpb24gKGl0IHdhcyBwcmV2aW91c2x5IHBhc3NlZFxuXHQgICAgICAgIC8vIGFzIGB0cmFuc2NsdWRlYCB0byBkaXJlY3RpdmUubGluaykgc28gd2UgbXVzdCB1bndyYXAgaXQgdG8gZ2V0XG5cdCAgICAgICAgLy8gaXRzIGBib3VuZFRyYW5zY2x1ZGVGbmBcblx0ICAgICAgICBpZiAocGFyZW50Qm91bmRUcmFuc2NsdWRlRm4gJiYgcGFyZW50Qm91bmRUcmFuc2NsdWRlRm4uJCRib3VuZFRyYW5zY2x1ZGUpIHtcblx0ICAgICAgICAgIHBhcmVudEJvdW5kVHJhbnNjbHVkZUZuID0gcGFyZW50Qm91bmRUcmFuc2NsdWRlRm4uJCRib3VuZFRyYW5zY2x1ZGU7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAoIW5hbWVzcGFjZSkge1xuXHQgICAgICAgICAgbmFtZXNwYWNlID0gZGV0ZWN0TmFtZXNwYWNlRm9yQ2hpbGRFbGVtZW50cyhmdXR1cmVQYXJlbnRFbGVtZW50KTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdmFyICRsaW5rTm9kZTtcblx0ICAgICAgICBpZiAobmFtZXNwYWNlICE9PSAnaHRtbCcpIHtcblx0ICAgICAgICAgIC8vIFdoZW4gdXNpbmcgYSBkaXJlY3RpdmUgd2l0aCByZXBsYWNlOnRydWUgYW5kIHRlbXBsYXRlVXJsIHRoZSAkY29tcGlsZU5vZGVzXG5cdCAgICAgICAgICAvLyAob3IgYSBjaGlsZCBlbGVtZW50IGluc2lkZSBvZiB0aGVtKVxuXHQgICAgICAgICAgLy8gbWlnaHQgY2hhbmdlLCBzbyB3ZSBuZWVkIHRvIHJlY3JlYXRlIHRoZSBuYW1lc3BhY2UgYWRhcHRlZCBjb21waWxlTm9kZXNcblx0ICAgICAgICAgIC8vIGZvciBjYWxsIHRvIHRoZSBsaW5rIGZ1bmN0aW9uLlxuXHQgICAgICAgICAgLy8gTm90ZTogVGhpcyB3aWxsIGFscmVhZHkgY2xvbmUgdGhlIG5vZGVzLi4uXG5cdCAgICAgICAgICAkbGlua05vZGUgPSBqcUxpdGUoXG5cdCAgICAgICAgICAgIHdyYXBUZW1wbGF0ZShuYW1lc3BhY2UsIGpxTGl0ZSgnPGRpdj4nKS5hcHBlbmQoJGNvbXBpbGVOb2RlcykuaHRtbCgpKVxuXHQgICAgICAgICAgKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKGNsb25lQ29ubmVjdEZuKSB7XG5cdCAgICAgICAgICAvLyBpbXBvcnRhbnQhITogd2UgbXVzdCBjYWxsIG91ciBqcUxpdGUuY2xvbmUoKSBzaW5jZSB0aGUgalF1ZXJ5IG9uZSBpcyB0cnlpbmcgdG8gYmUgc21hcnRcblx0ICAgICAgICAgIC8vIGFuZCBzb21ldGltZXMgY2hhbmdlcyB0aGUgc3RydWN0dXJlIG9mIHRoZSBET00uXG5cdCAgICAgICAgICAkbGlua05vZGUgPSBKUUxpdGVQcm90b3R5cGUuY2xvbmUuY2FsbCgkY29tcGlsZU5vZGVzKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgJGxpbmtOb2RlID0gJGNvbXBpbGVOb2Rlcztcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmICh0cmFuc2NsdWRlQ29udHJvbGxlcnMpIHtcblx0ICAgICAgICAgIGZvciAodmFyIGNvbnRyb2xsZXJOYW1lIGluIHRyYW5zY2x1ZGVDb250cm9sbGVycykge1xuXHQgICAgICAgICAgICAkbGlua05vZGUuZGF0YSgnJCcgKyBjb250cm9sbGVyTmFtZSArICdDb250cm9sbGVyJywgdHJhbnNjbHVkZUNvbnRyb2xsZXJzW2NvbnRyb2xsZXJOYW1lXS5pbnN0YW5jZSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBjb21waWxlLiQkYWRkU2NvcGVJbmZvKCRsaW5rTm9kZSwgc2NvcGUpO1xuXHRcblx0ICAgICAgICBpZiAoY2xvbmVDb25uZWN0Rm4pIGNsb25lQ29ubmVjdEZuKCRsaW5rTm9kZSwgc2NvcGUpO1xuXHQgICAgICAgIGlmIChjb21wb3NpdGVMaW5rRm4pIGNvbXBvc2l0ZUxpbmtGbihzY29wZSwgJGxpbmtOb2RlLCAkbGlua05vZGUsIHBhcmVudEJvdW5kVHJhbnNjbHVkZUZuKTtcblx0ICAgICAgICByZXR1cm4gJGxpbmtOb2RlO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGRldGVjdE5hbWVzcGFjZUZvckNoaWxkRWxlbWVudHMocGFyZW50RWxlbWVudCkge1xuXHQgICAgICAvLyBUT0RPOiBNYWtlIHRoaXMgZGV0ZWN0IE1hdGhNTCBhcyB3ZWxsLi4uXG5cdCAgICAgIHZhciBub2RlID0gcGFyZW50RWxlbWVudCAmJiBwYXJlbnRFbGVtZW50WzBdO1xuXHQgICAgICBpZiAoIW5vZGUpIHtcblx0ICAgICAgICByZXR1cm4gJ2h0bWwnO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHJldHVybiBub2RlTmFtZV8obm9kZSkgIT09ICdmb3JlaWdub2JqZWN0JyAmJiB0b1N0cmluZy5jYWxsKG5vZGUpLm1hdGNoKC9TVkcvKSA/ICdzdmcnIDogJ2h0bWwnO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBDb21waWxlIGZ1bmN0aW9uIG1hdGNoZXMgZWFjaCBub2RlIGluIG5vZGVMaXN0IGFnYWluc3QgdGhlIGRpcmVjdGl2ZXMuIE9uY2UgYWxsIGRpcmVjdGl2ZXNcblx0ICAgICAqIGZvciBhIHBhcnRpY3VsYXIgbm9kZSBhcmUgY29sbGVjdGVkIHRoZWlyIGNvbXBpbGUgZnVuY3Rpb25zIGFyZSBleGVjdXRlZC4gVGhlIGNvbXBpbGVcblx0ICAgICAqIGZ1bmN0aW9ucyByZXR1cm4gdmFsdWVzIC0gdGhlIGxpbmtpbmcgZnVuY3Rpb25zIC0gYXJlIGNvbWJpbmVkIGludG8gYSBjb21wb3NpdGUgbGlua2luZ1xuXHQgICAgICogZnVuY3Rpb24sIHdoaWNoIGlzIHRoZSBhIGxpbmtpbmcgZnVuY3Rpb24gZm9yIHRoZSBub2RlLlxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7Tm9kZUxpc3R9IG5vZGVMaXN0IGFuIGFycmF5IG9mIG5vZGVzIG9yIE5vZGVMaXN0IHRvIGNvbXBpbGVcblx0ICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oYW5ndWxhci5TY29wZSwgY2xvbmVBdHRhY2hGbj0pfSB0cmFuc2NsdWRlRm4gQSBsaW5raW5nIGZ1bmN0aW9uLCB3aGVyZSB0aGVcblx0ICAgICAqICAgICAgICBzY29wZSBhcmd1bWVudCBpcyBhdXRvLWdlbmVyYXRlZCB0byB0aGUgbmV3IGNoaWxkIG9mIHRoZSB0cmFuc2NsdWRlZCBwYXJlbnQgc2NvcGUuXG5cdCAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnQ9fSAkcm9vdEVsZW1lbnQgSWYgdGhlIG5vZGVMaXN0IGlzIHRoZSByb290IG9mIHRoZSBjb21waWxhdGlvbiB0cmVlIHRoZW5cblx0ICAgICAqICAgICAgICB0aGUgcm9vdEVsZW1lbnQgbXVzdCBiZSBzZXQgdGhlIGpxTGl0ZSBjb2xsZWN0aW9uIG9mIHRoZSBjb21waWxlIHJvb3QuIFRoaXMgaXNcblx0ICAgICAqICAgICAgICBuZWVkZWQgc28gdGhhdCB0aGUganFMaXRlIGNvbGxlY3Rpb24gaXRlbXMgY2FuIGJlIHJlcGxhY2VkIHdpdGggd2lkZ2V0cy5cblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyPX0gbWF4UHJpb3JpdHkgTWF4IGRpcmVjdGl2ZSBwcmlvcml0eS5cblx0ICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gQSBjb21wb3NpdGUgbGlua2luZyBmdW5jdGlvbiBvZiBhbGwgb2YgdGhlIG1hdGNoZWQgZGlyZWN0aXZlcyBvciBudWxsLlxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBjb21waWxlTm9kZXMobm9kZUxpc3QsIHRyYW5zY2x1ZGVGbiwgJHJvb3RFbGVtZW50LCBtYXhQcmlvcml0eSwgaWdub3JlRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNDb21waWxlQ29udGV4dCkge1xuXHQgICAgICB2YXIgbGlua0ZucyA9IFtdLFxuXHQgICAgICAgICAgYXR0cnMsIGRpcmVjdGl2ZXMsIG5vZGVMaW5rRm4sIGNoaWxkTm9kZXMsIGNoaWxkTGlua0ZuLCBsaW5rRm5Gb3VuZCwgbm9kZUxpbmtGbkZvdW5kO1xuXHRcblx0ICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlTGlzdC5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIGF0dHJzID0gbmV3IEF0dHJpYnV0ZXMoKTtcblx0XG5cdCAgICAgICAgLy8gd2UgbXVzdCBhbHdheXMgcmVmZXIgdG8gbm9kZUxpc3RbaV0gc2luY2UgdGhlIG5vZGVzIGNhbiBiZSByZXBsYWNlZCB1bmRlcm5lYXRoIHVzLlxuXHQgICAgICAgIGRpcmVjdGl2ZXMgPSBjb2xsZWN0RGlyZWN0aXZlcyhub2RlTGlzdFtpXSwgW10sIGF0dHJzLCBpID09PSAwID8gbWF4UHJpb3JpdHkgOiB1bmRlZmluZWQsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmVEaXJlY3RpdmUpO1xuXHRcblx0ICAgICAgICBub2RlTGlua0ZuID0gKGRpcmVjdGl2ZXMubGVuZ3RoKVxuXHQgICAgICAgICAgICA/IGFwcGx5RGlyZWN0aXZlc1RvTm9kZShkaXJlY3RpdmVzLCBub2RlTGlzdFtpXSwgYXR0cnMsIHRyYW5zY2x1ZGVGbiwgJHJvb3RFbGVtZW50LFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsIFtdLCBbXSwgcHJldmlvdXNDb21waWxlQ29udGV4dClcblx0ICAgICAgICAgICAgOiBudWxsO1xuXHRcblx0ICAgICAgICBpZiAobm9kZUxpbmtGbiAmJiBub2RlTGlua0ZuLnNjb3BlKSB7XG5cdCAgICAgICAgICBjb21waWxlLiQkYWRkU2NvcGVDbGFzcyhhdHRycy4kJGVsZW1lbnQpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgY2hpbGRMaW5rRm4gPSAobm9kZUxpbmtGbiAmJiBub2RlTGlua0ZuLnRlcm1pbmFsIHx8XG5cdCAgICAgICAgICAgICAgICAgICAgICAhKGNoaWxkTm9kZXMgPSBub2RlTGlzdFtpXS5jaGlsZE5vZGVzKSB8fFxuXHQgICAgICAgICAgICAgICAgICAgICAgIWNoaWxkTm9kZXMubGVuZ3RoKVxuXHQgICAgICAgICAgICA/IG51bGxcblx0ICAgICAgICAgICAgOiBjb21waWxlTm9kZXMoY2hpbGROb2Rlcyxcblx0ICAgICAgICAgICAgICAgICBub2RlTGlua0ZuID8gKFxuXHQgICAgICAgICAgICAgICAgICAobm9kZUxpbmtGbi50cmFuc2NsdWRlT25UaGlzRWxlbWVudCB8fCAhbm9kZUxpbmtGbi50ZW1wbGF0ZU9uVGhpc0VsZW1lbnQpXG5cdCAgICAgICAgICAgICAgICAgICAgICYmIG5vZGVMaW5rRm4udHJhbnNjbHVkZSkgOiB0cmFuc2NsdWRlRm4pO1xuXHRcblx0ICAgICAgICBpZiAobm9kZUxpbmtGbiB8fCBjaGlsZExpbmtGbikge1xuXHQgICAgICAgICAgbGlua0Zucy5wdXNoKGksIG5vZGVMaW5rRm4sIGNoaWxkTGlua0ZuKTtcblx0ICAgICAgICAgIGxpbmtGbkZvdW5kID0gdHJ1ZTtcblx0ICAgICAgICAgIG5vZGVMaW5rRm5Gb3VuZCA9IG5vZGVMaW5rRm5Gb3VuZCB8fCBub2RlTGlua0ZuO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy91c2UgdGhlIHByZXZpb3VzIGNvbnRleHQgb25seSBmb3IgdGhlIGZpcnN0IGVsZW1lbnQgaW4gdGhlIHZpcnR1YWwgZ3JvdXBcblx0ICAgICAgICBwcmV2aW91c0NvbXBpbGVDb250ZXh0ID0gbnVsbDtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLy8gcmV0dXJuIGEgbGlua2luZyBmdW5jdGlvbiBpZiB3ZSBoYXZlIGZvdW5kIGFueXRoaW5nLCBudWxsIG90aGVyd2lzZVxuXHQgICAgICByZXR1cm4gbGlua0ZuRm91bmQgPyBjb21wb3NpdGVMaW5rRm4gOiBudWxsO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gY29tcG9zaXRlTGlua0ZuKHNjb3BlLCBub2RlTGlzdCwgJHJvb3RFbGVtZW50LCBwYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbikge1xuXHQgICAgICAgIHZhciBub2RlTGlua0ZuLCBjaGlsZExpbmtGbiwgbm9kZSwgY2hpbGRTY29wZSwgaSwgaWksIGlkeCwgY2hpbGRCb3VuZFRyYW5zY2x1ZGVGbjtcblx0ICAgICAgICB2YXIgc3RhYmxlTm9kZUxpc3Q7XG5cdFxuXHRcblx0ICAgICAgICBpZiAobm9kZUxpbmtGbkZvdW5kKSB7XG5cdCAgICAgICAgICAvLyBjb3B5IG5vZGVMaXN0IHNvIHRoYXQgaWYgYSBub2RlTGlua0ZuIHJlbW92ZXMgb3IgYWRkcyBhbiBlbGVtZW50IGF0IHRoaXMgRE9NIGxldmVsIG91clxuXHQgICAgICAgICAgLy8gb2Zmc2V0cyBkb24ndCBnZXQgc2NyZXdlZCB1cFxuXHQgICAgICAgICAgdmFyIG5vZGVMaXN0TGVuZ3RoID0gbm9kZUxpc3QubGVuZ3RoO1xuXHQgICAgICAgICAgc3RhYmxlTm9kZUxpc3QgPSBuZXcgQXJyYXkobm9kZUxpc3RMZW5ndGgpO1xuXHRcblx0ICAgICAgICAgIC8vIGNyZWF0ZSBhIHNwYXJzZSBhcnJheSBieSBvbmx5IGNvcHlpbmcgdGhlIGVsZW1lbnRzIHdoaWNoIGhhdmUgYSBsaW5rRm5cblx0ICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsaW5rRm5zLmxlbmd0aDsgaSs9Mykge1xuXHQgICAgICAgICAgICBpZHggPSBsaW5rRm5zW2ldO1xuXHQgICAgICAgICAgICBzdGFibGVOb2RlTGlzdFtpZHhdID0gbm9kZUxpc3RbaWR4XTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgc3RhYmxlTm9kZUxpc3QgPSBub2RlTGlzdDtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGZvciAoaSA9IDAsIGlpID0gbGlua0Zucy5sZW5ndGg7IGkgPCBpaTspIHtcblx0ICAgICAgICAgIG5vZGUgPSBzdGFibGVOb2RlTGlzdFtsaW5rRm5zW2krK11dO1xuXHQgICAgICAgICAgbm9kZUxpbmtGbiA9IGxpbmtGbnNbaSsrXTtcblx0ICAgICAgICAgIGNoaWxkTGlua0ZuID0gbGlua0Zuc1tpKytdO1xuXHRcblx0ICAgICAgICAgIGlmIChub2RlTGlua0ZuKSB7XG5cdCAgICAgICAgICAgIGlmIChub2RlTGlua0ZuLnNjb3BlKSB7XG5cdCAgICAgICAgICAgICAgY2hpbGRTY29wZSA9IHNjb3BlLiRuZXcoKTtcblx0ICAgICAgICAgICAgICBjb21waWxlLiQkYWRkU2NvcGVJbmZvKGpxTGl0ZShub2RlKSwgY2hpbGRTY29wZSk7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgY2hpbGRTY29wZSA9IHNjb3BlO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICBpZiAobm9kZUxpbmtGbi50cmFuc2NsdWRlT25UaGlzRWxlbWVudCkge1xuXHQgICAgICAgICAgICAgIGNoaWxkQm91bmRUcmFuc2NsdWRlRm4gPSBjcmVhdGVCb3VuZFRyYW5zY2x1ZGVGbihcblx0ICAgICAgICAgICAgICAgICAgc2NvcGUsIG5vZGVMaW5rRm4udHJhbnNjbHVkZSwgcGFyZW50Qm91bmRUcmFuc2NsdWRlRm4pO1xuXHRcblx0ICAgICAgICAgICAgfSBlbHNlIGlmICghbm9kZUxpbmtGbi50ZW1wbGF0ZU9uVGhpc0VsZW1lbnQgJiYgcGFyZW50Qm91bmRUcmFuc2NsdWRlRm4pIHtcblx0ICAgICAgICAgICAgICBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuID0gcGFyZW50Qm91bmRUcmFuc2NsdWRlRm47XG5cdFxuXHQgICAgICAgICAgICB9IGVsc2UgaWYgKCFwYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbiAmJiB0cmFuc2NsdWRlRm4pIHtcblx0ICAgICAgICAgICAgICBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuID0gY3JlYXRlQm91bmRUcmFuc2NsdWRlRm4oc2NvcGUsIHRyYW5zY2x1ZGVGbik7XG5cdFxuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIGNoaWxkQm91bmRUcmFuc2NsdWRlRm4gPSBudWxsO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICBub2RlTGlua0ZuKGNoaWxkTGlua0ZuLCBjaGlsZFNjb3BlLCBub2RlLCAkcm9vdEVsZW1lbnQsIGNoaWxkQm91bmRUcmFuc2NsdWRlRm4pO1xuXHRcblx0ICAgICAgICAgIH0gZWxzZSBpZiAoY2hpbGRMaW5rRm4pIHtcblx0ICAgICAgICAgICAgY2hpbGRMaW5rRm4oc2NvcGUsIG5vZGUuY2hpbGROb2RlcywgdW5kZWZpbmVkLCBwYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbik7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gY3JlYXRlQm91bmRUcmFuc2NsdWRlRm4oc2NvcGUsIHRyYW5zY2x1ZGVGbiwgcHJldmlvdXNCb3VuZFRyYW5zY2x1ZGVGbikge1xuXHRcblx0ICAgICAgdmFyIGJvdW5kVHJhbnNjbHVkZUZuID0gZnVuY3Rpb24odHJhbnNjbHVkZWRTY29wZSwgY2xvbmVGbiwgY29udHJvbGxlcnMsIGZ1dHVyZVBhcmVudEVsZW1lbnQsIGNvbnRhaW5pbmdTY29wZSkge1xuXHRcblx0ICAgICAgICBpZiAoIXRyYW5zY2x1ZGVkU2NvcGUpIHtcblx0ICAgICAgICAgIHRyYW5zY2x1ZGVkU2NvcGUgPSBzY29wZS4kbmV3KGZhbHNlLCBjb250YWluaW5nU2NvcGUpO1xuXHQgICAgICAgICAgdHJhbnNjbHVkZWRTY29wZS4kJHRyYW5zY2x1ZGVkID0gdHJ1ZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiB0cmFuc2NsdWRlRm4odHJhbnNjbHVkZWRTY29wZSwgY2xvbmVGbiwge1xuXHQgICAgICAgICAgcGFyZW50Qm91bmRUcmFuc2NsdWRlRm46IHByZXZpb3VzQm91bmRUcmFuc2NsdWRlRm4sXG5cdCAgICAgICAgICB0cmFuc2NsdWRlQ29udHJvbGxlcnM6IGNvbnRyb2xsZXJzLFxuXHQgICAgICAgICAgZnV0dXJlUGFyZW50RWxlbWVudDogZnV0dXJlUGFyZW50RWxlbWVudFxuXHQgICAgICAgIH0pO1xuXHQgICAgICB9O1xuXHRcblx0ICAgICAgLy8gV2UgbmVlZCAgdG8gYXR0YWNoIHRoZSB0cmFuc2NsdXNpb24gc2xvdHMgb250byB0aGUgYGJvdW5kVHJhbnNjbHVkZUZuYFxuXHQgICAgICAvLyBzbyB0aGF0IHRoZXkgYXJlIGF2YWlsYWJsZSBpbnNpZGUgdGhlIGBjb250cm9sbGVyc0JvdW5kVHJhbnNjbHVkZWAgZnVuY3Rpb25cblx0ICAgICAgdmFyIGJvdW5kU2xvdHMgPSBib3VuZFRyYW5zY2x1ZGVGbi4kJHNsb3RzID0gY3JlYXRlTWFwKCk7XG5cdCAgICAgIGZvciAodmFyIHNsb3ROYW1lIGluIHRyYW5zY2x1ZGVGbi4kJHNsb3RzKSB7XG5cdCAgICAgICAgaWYgKHRyYW5zY2x1ZGVGbi4kJHNsb3RzW3Nsb3ROYW1lXSkge1xuXHQgICAgICAgICAgYm91bmRTbG90c1tzbG90TmFtZV0gPSBjcmVhdGVCb3VuZFRyYW5zY2x1ZGVGbihzY29wZSwgdHJhbnNjbHVkZUZuLiQkc2xvdHNbc2xvdE5hbWVdLCBwcmV2aW91c0JvdW5kVHJhbnNjbHVkZUZuKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgYm91bmRTbG90c1tzbG90TmFtZV0gPSBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIGJvdW5kVHJhbnNjbHVkZUZuO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogTG9va3MgZm9yIGRpcmVjdGl2ZXMgb24gdGhlIGdpdmVuIG5vZGUgYW5kIGFkZHMgdGhlbSB0byB0aGUgZGlyZWN0aXZlIGNvbGxlY3Rpb24gd2hpY2ggaXNcblx0ICAgICAqIHNvcnRlZC5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0gbm9kZSBOb2RlIHRvIHNlYXJjaC5cblx0ICAgICAqIEBwYXJhbSBkaXJlY3RpdmVzIEFuIGFycmF5IHRvIHdoaWNoIHRoZSBkaXJlY3RpdmVzIGFyZSBhZGRlZCB0by4gVGhpcyBhcnJheSBpcyBzb3J0ZWQgYmVmb3JlXG5cdCAgICAgKiAgICAgICAgdGhlIGZ1bmN0aW9uIHJldHVybnMuXG5cdCAgICAgKiBAcGFyYW0gYXR0cnMgVGhlIHNoYXJlZCBhdHRycyBvYmplY3Qgd2hpY2ggaXMgdXNlZCB0byBwb3B1bGF0ZSB0aGUgbm9ybWFsaXplZCBhdHRyaWJ1dGVzLlxuXHQgICAgICogQHBhcmFtIHtudW1iZXI9fSBtYXhQcmlvcml0eSBNYXggZGlyZWN0aXZlIHByaW9yaXR5LlxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBjb2xsZWN0RGlyZWN0aXZlcyhub2RlLCBkaXJlY3RpdmVzLCBhdHRycywgbWF4UHJpb3JpdHksIGlnbm9yZURpcmVjdGl2ZSkge1xuXHQgICAgICB2YXIgbm9kZVR5cGUgPSBub2RlLm5vZGVUeXBlLFxuXHQgICAgICAgICAgYXR0cnNNYXAgPSBhdHRycy4kYXR0cixcblx0ICAgICAgICAgIG1hdGNoLFxuXHQgICAgICAgICAgY2xhc3NOYW1lO1xuXHRcblx0ICAgICAgc3dpdGNoIChub2RlVHlwZSkge1xuXHQgICAgICAgIGNhc2UgTk9ERV9UWVBFX0VMRU1FTlQ6IC8qIEVsZW1lbnQgKi9cblx0ICAgICAgICAgIC8vIHVzZSB0aGUgbm9kZSBuYW1lOiA8ZGlyZWN0aXZlPlxuXHQgICAgICAgICAgYWRkRGlyZWN0aXZlKGRpcmVjdGl2ZXMsXG5cdCAgICAgICAgICAgICAgZGlyZWN0aXZlTm9ybWFsaXplKG5vZGVOYW1lXyhub2RlKSksICdFJywgbWF4UHJpb3JpdHksIGlnbm9yZURpcmVjdGl2ZSk7XG5cdFxuXHQgICAgICAgICAgLy8gaXRlcmF0ZSBvdmVyIHRoZSBhdHRyaWJ1dGVzXG5cdCAgICAgICAgICBmb3IgKHZhciBhdHRyLCBuYW1lLCBuTmFtZSwgbmdBdHRyTmFtZSwgdmFsdWUsIGlzTmdBdHRyLCBuQXR0cnMgPSBub2RlLmF0dHJpYnV0ZXMsXG5cdCAgICAgICAgICAgICAgICAgICBqID0gMCwgamogPSBuQXR0cnMgJiYgbkF0dHJzLmxlbmd0aDsgaiA8IGpqOyBqKyspIHtcblx0ICAgICAgICAgICAgdmFyIGF0dHJTdGFydE5hbWUgPSBmYWxzZTtcblx0ICAgICAgICAgICAgdmFyIGF0dHJFbmROYW1lID0gZmFsc2U7XG5cdFxuXHQgICAgICAgICAgICBhdHRyID0gbkF0dHJzW2pdO1xuXHQgICAgICAgICAgICBuYW1lID0gYXR0ci5uYW1lO1xuXHQgICAgICAgICAgICB2YWx1ZSA9IHRyaW0oYXR0ci52YWx1ZSk7XG5cdFxuXHQgICAgICAgICAgICAvLyBzdXBwb3J0IG5nQXR0ciBhdHRyaWJ1dGUgYmluZGluZ1xuXHQgICAgICAgICAgICBuZ0F0dHJOYW1lID0gZGlyZWN0aXZlTm9ybWFsaXplKG5hbWUpO1xuXHQgICAgICAgICAgICBpZiAoaXNOZ0F0dHIgPSBOR19BVFRSX0JJTkRJTkcudGVzdChuZ0F0dHJOYW1lKSkge1xuXHQgICAgICAgICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoUFJFRklYX1JFR0VYUCwgJycpXG5cdCAgICAgICAgICAgICAgICAuc3Vic3RyKDgpLnJlcGxhY2UoL18oLikvZywgZnVuY3Rpb24obWF0Y2gsIGxldHRlcikge1xuXHQgICAgICAgICAgICAgICAgICByZXR1cm4gbGV0dGVyLnRvVXBwZXJDYXNlKCk7XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgdmFyIG11bHRpRWxlbWVudE1hdGNoID0gbmdBdHRyTmFtZS5tYXRjaChNVUxUSV9FTEVNRU5UX0RJUl9SRSk7XG5cdCAgICAgICAgICAgIGlmIChtdWx0aUVsZW1lbnRNYXRjaCAmJiBkaXJlY3RpdmVJc011bHRpRWxlbWVudChtdWx0aUVsZW1lbnRNYXRjaFsxXSkpIHtcblx0ICAgICAgICAgICAgICBhdHRyU3RhcnROYW1lID0gbmFtZTtcblx0ICAgICAgICAgICAgICBhdHRyRW5kTmFtZSA9IG5hbWUuc3Vic3RyKDAsIG5hbWUubGVuZ3RoIC0gNSkgKyAnZW5kJztcblx0ICAgICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHIoMCwgbmFtZS5sZW5ndGggLSA2KTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgbk5hbWUgPSBkaXJlY3RpdmVOb3JtYWxpemUobmFtZS50b0xvd2VyQ2FzZSgpKTtcblx0ICAgICAgICAgICAgYXR0cnNNYXBbbk5hbWVdID0gbmFtZTtcblx0ICAgICAgICAgICAgaWYgKGlzTmdBdHRyIHx8ICFhdHRycy5oYXNPd25Qcm9wZXJ0eShuTmFtZSkpIHtcblx0ICAgICAgICAgICAgICAgIGF0dHJzW25OYW1lXSA9IHZhbHVlO1xuXHQgICAgICAgICAgICAgICAgaWYgKGdldEJvb2xlYW5BdHRyTmFtZShub2RlLCBuTmFtZSkpIHtcblx0ICAgICAgICAgICAgICAgICAgYXR0cnNbbk5hbWVdID0gdHJ1ZTsgLy8gcHJlc2VuY2UgbWVhbnMgdHJ1ZVxuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGFkZEF0dHJJbnRlcnBvbGF0ZURpcmVjdGl2ZShub2RlLCBkaXJlY3RpdmVzLCB2YWx1ZSwgbk5hbWUsIGlzTmdBdHRyKTtcblx0ICAgICAgICAgICAgYWRkRGlyZWN0aXZlKGRpcmVjdGl2ZXMsIG5OYW1lLCAnQScsIG1heFByaW9yaXR5LCBpZ25vcmVEaXJlY3RpdmUsIGF0dHJTdGFydE5hbWUsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0ckVuZE5hbWUpO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIC8vIHVzZSBjbGFzcyBhcyBkaXJlY3RpdmVcblx0ICAgICAgICAgIGNsYXNzTmFtZSA9IG5vZGUuY2xhc3NOYW1lO1xuXHQgICAgICAgICAgaWYgKGlzT2JqZWN0KGNsYXNzTmFtZSkpIHtcblx0ICAgICAgICAgICAgICAvLyBNYXliZSBTVkdBbmltYXRlZFN0cmluZ1xuXHQgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZS5hbmltVmFsO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgaWYgKGlzU3RyaW5nKGNsYXNzTmFtZSkgJiYgY2xhc3NOYW1lICE9PSAnJykge1xuXHQgICAgICAgICAgICB3aGlsZSAobWF0Y2ggPSBDTEFTU19ESVJFQ1RJVkVfUkVHRVhQLmV4ZWMoY2xhc3NOYW1lKSkge1xuXHQgICAgICAgICAgICAgIG5OYW1lID0gZGlyZWN0aXZlTm9ybWFsaXplKG1hdGNoWzJdKTtcblx0ICAgICAgICAgICAgICBpZiAoYWRkRGlyZWN0aXZlKGRpcmVjdGl2ZXMsIG5OYW1lLCAnQycsIG1heFByaW9yaXR5LCBpZ25vcmVEaXJlY3RpdmUpKSB7XG5cdCAgICAgICAgICAgICAgICBhdHRyc1tuTmFtZV0gPSB0cmltKG1hdGNoWzNdKTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lLnN1YnN0cihtYXRjaC5pbmRleCArIG1hdGNoWzBdLmxlbmd0aCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgIGNhc2UgTk9ERV9UWVBFX1RFWFQ6IC8qIFRleHQgTm9kZSAqL1xuXHQgICAgICAgICAgaWYgKG1zaWUgPT09IDExKSB7XG5cdCAgICAgICAgICAgIC8vIFdvcmthcm91bmQgZm9yICMxMTc4MVxuXHQgICAgICAgICAgICB3aGlsZSAobm9kZS5wYXJlbnROb2RlICYmIG5vZGUubmV4dFNpYmxpbmcgJiYgbm9kZS5uZXh0U2libGluZy5ub2RlVHlwZSA9PT0gTk9ERV9UWVBFX1RFWFQpIHtcblx0ICAgICAgICAgICAgICBub2RlLm5vZGVWYWx1ZSA9IG5vZGUubm9kZVZhbHVlICsgbm9kZS5uZXh0U2libGluZy5ub2RlVmFsdWU7XG5cdCAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUubmV4dFNpYmxpbmcpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBhZGRUZXh0SW50ZXJwb2xhdGVEaXJlY3RpdmUoZGlyZWN0aXZlcywgbm9kZS5ub2RlVmFsdWUpO1xuXHQgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgY2FzZSBOT0RFX1RZUEVfQ09NTUVOVDogLyogQ29tbWVudCAqL1xuXHQgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgbWF0Y2ggPSBDT01NRU5UX0RJUkVDVElWRV9SRUdFWFAuZXhlYyhub2RlLm5vZGVWYWx1ZSk7XG5cdCAgICAgICAgICAgIGlmIChtYXRjaCkge1xuXHQgICAgICAgICAgICAgIG5OYW1lID0gZGlyZWN0aXZlTm9ybWFsaXplKG1hdGNoWzFdKTtcblx0ICAgICAgICAgICAgICBpZiAoYWRkRGlyZWN0aXZlKGRpcmVjdGl2ZXMsIG5OYW1lLCAnTScsIG1heFByaW9yaXR5LCBpZ25vcmVEaXJlY3RpdmUpKSB7XG5cdCAgICAgICAgICAgICAgICBhdHRyc1tuTmFtZV0gPSB0cmltKG1hdGNoWzJdKTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICAgICAgLy8gdHVybnMgb3V0IHRoYXQgdW5kZXIgc29tZSBjaXJjdW1zdGFuY2VzIElFOSB0aHJvd3MgZXJyb3JzIHdoZW4gb25lIGF0dGVtcHRzIHRvIHJlYWRcblx0ICAgICAgICAgICAgLy8gY29tbWVudCdzIG5vZGUgdmFsdWUuXG5cdCAgICAgICAgICAgIC8vIEp1c3QgaWdub3JlIGl0IGFuZCBjb250aW51ZS4gKENhbid0IHNlZW0gdG8gcmVwcm9kdWNlIGluIHRlc3QgY2FzZS4pXG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBicmVhaztcblx0ICAgICAgfVxuXHRcblx0ICAgICAgZGlyZWN0aXZlcy5zb3J0KGJ5UHJpb3JpdHkpO1xuXHQgICAgICByZXR1cm4gZGlyZWN0aXZlcztcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEdpdmVuIGEgbm9kZSB3aXRoIGFuIGRpcmVjdGl2ZS1zdGFydCBpdCBjb2xsZWN0cyBhbGwgb2YgdGhlIHNpYmxpbmdzIHVudGlsIGl0IGZpbmRzXG5cdCAgICAgKiBkaXJlY3RpdmUtZW5kLlxuXHQgICAgICogQHBhcmFtIG5vZGVcblx0ICAgICAqIEBwYXJhbSBhdHRyU3RhcnRcblx0ICAgICAqIEBwYXJhbSBhdHRyRW5kXG5cdCAgICAgKiBAcmV0dXJucyB7Kn1cblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gZ3JvdXBTY2FuKG5vZGUsIGF0dHJTdGFydCwgYXR0ckVuZCkge1xuXHQgICAgICB2YXIgbm9kZXMgPSBbXTtcblx0ICAgICAgdmFyIGRlcHRoID0gMDtcblx0ICAgICAgaWYgKGF0dHJTdGFydCAmJiBub2RlLmhhc0F0dHJpYnV0ZSAmJiBub2RlLmhhc0F0dHJpYnV0ZShhdHRyU3RhcnQpKSB7XG5cdCAgICAgICAgZG8ge1xuXHQgICAgICAgICAgaWYgKCFub2RlKSB7XG5cdCAgICAgICAgICAgIHRocm93ICRjb21waWxlTWluRXJyKCd1dGVyZGlyJyxcblx0ICAgICAgICAgICAgICAgICAgICAgIFwiVW50ZXJtaW5hdGVkIGF0dHJpYnV0ZSwgZm91bmQgJ3swfScgYnV0IG5vIG1hdGNoaW5nICd7MX0nIGZvdW5kLlwiLFxuXHQgICAgICAgICAgICAgICAgICAgICAgYXR0clN0YXJ0LCBhdHRyRW5kKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IE5PREVfVFlQRV9FTEVNRU5UKSB7XG5cdCAgICAgICAgICAgIGlmIChub2RlLmhhc0F0dHJpYnV0ZShhdHRyU3RhcnQpKSBkZXB0aCsrO1xuXHQgICAgICAgICAgICBpZiAobm9kZS5oYXNBdHRyaWJ1dGUoYXR0ckVuZCkpIGRlcHRoLS07XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuXHQgICAgICAgICAgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmc7XG5cdCAgICAgICAgfSB3aGlsZSAoZGVwdGggPiAwKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4ganFMaXRlKG5vZGVzKTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIFdyYXBwZXIgZm9yIGxpbmtpbmcgZnVuY3Rpb24gd2hpY2ggY29udmVydHMgbm9ybWFsIGxpbmtpbmcgZnVuY3Rpb24gaW50byBhIGdyb3VwZWRcblx0ICAgICAqIGxpbmtpbmcgZnVuY3Rpb24uXG5cdCAgICAgKiBAcGFyYW0gbGlua0ZuXG5cdCAgICAgKiBAcGFyYW0gYXR0clN0YXJ0XG5cdCAgICAgKiBAcGFyYW0gYXR0ckVuZFxuXHQgICAgICogQHJldHVybnMge0Z1bmN0aW9ufVxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBncm91cEVsZW1lbnRzTGlua0ZuV3JhcHBlcihsaW5rRm4sIGF0dHJTdGFydCwgYXR0ckVuZCkge1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjb250cm9sbGVycywgdHJhbnNjbHVkZUZuKSB7XG5cdCAgICAgICAgZWxlbWVudCA9IGdyb3VwU2NhbihlbGVtZW50WzBdLCBhdHRyU3RhcnQsIGF0dHJFbmQpO1xuXHQgICAgICAgIHJldHVybiBsaW5rRm4oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjb250cm9sbGVycywgdHJhbnNjbHVkZUZuKTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEEgZnVuY3Rpb24gZ2VuZXJhdG9yIHRoYXQgaXMgdXNlZCB0byBzdXBwb3J0IGJvdGggZWFnZXIgYW5kIGxhenkgY29tcGlsYXRpb25cblx0ICAgICAqIGxpbmtpbmcgZnVuY3Rpb24uXG5cdCAgICAgKiBAcGFyYW0gZWFnZXJcblx0ICAgICAqIEBwYXJhbSAkY29tcGlsZU5vZGVzXG5cdCAgICAgKiBAcGFyYW0gdHJhbnNjbHVkZUZuXG5cdCAgICAgKiBAcGFyYW0gbWF4UHJpb3JpdHlcblx0ICAgICAqIEBwYXJhbSBpZ25vcmVEaXJlY3RpdmVcblx0ICAgICAqIEBwYXJhbSBwcmV2aW91c0NvbXBpbGVDb250ZXh0XG5cdCAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259XG5cdCAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIGNvbXBpbGF0aW9uR2VuZXJhdG9yKGVhZ2VyLCAkY29tcGlsZU5vZGVzLCB0cmFuc2NsdWRlRm4sIG1heFByaW9yaXR5LCBpZ25vcmVEaXJlY3RpdmUsIHByZXZpb3VzQ29tcGlsZUNvbnRleHQpIHtcblx0ICAgICAgICBpZiAoZWFnZXIpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGNvbXBpbGUoJGNvbXBpbGVOb2RlcywgdHJhbnNjbHVkZUZuLCBtYXhQcmlvcml0eSwgaWdub3JlRGlyZWN0aXZlLCBwcmV2aW91c0NvbXBpbGVDb250ZXh0KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHZhciBjb21waWxlZDtcblx0XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBpZiAoIWNvbXBpbGVkKSB7XG5cdCAgICAgICAgICAgICAgICBjb21waWxlZCA9IGNvbXBpbGUoJGNvbXBpbGVOb2RlcywgdHJhbnNjbHVkZUZuLCBtYXhQcmlvcml0eSwgaWdub3JlRGlyZWN0aXZlLCBwcmV2aW91c0NvbXBpbGVDb250ZXh0KTtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBOdWxsIG91dCBhbGwgb2YgdGhlc2UgcmVmZXJlbmNlcyBpbiBvcmRlciB0byBtYWtlIHRoZW0gZWxpZ2libGUgZm9yIGdhcmJhZ2UgY29sbGVjdGlvblxuXHQgICAgICAgICAgICAgICAgLy8gc2luY2UgdGhpcyBpcyBhIHBvdGVudGlhbGx5IGxvbmcgbGl2ZWQgY2xvc3VyZVxuXHQgICAgICAgICAgICAgICAgJGNvbXBpbGVOb2RlcyA9IHRyYW5zY2x1ZGVGbiA9IHByZXZpb3VzQ29tcGlsZUNvbnRleHQgPSBudWxsO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gY29tcGlsZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0ICAgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogT25jZSB0aGUgZGlyZWN0aXZlcyBoYXZlIGJlZW4gY29sbGVjdGVkLCB0aGVpciBjb21waWxlIGZ1bmN0aW9ucyBhcmUgZXhlY3V0ZWQuIFRoaXMgbWV0aG9kXG5cdCAgICAgKiBpcyByZXNwb25zaWJsZSBmb3IgaW5saW5pbmcgZGlyZWN0aXZlIHRlbXBsYXRlcyBhcyB3ZWxsIGFzIHRlcm1pbmF0aW5nIHRoZSBhcHBsaWNhdGlvblxuXHQgICAgICogb2YgdGhlIGRpcmVjdGl2ZXMgaWYgdGhlIHRlcm1pbmFsIGRpcmVjdGl2ZSBoYXMgYmVlbiByZWFjaGVkLlxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7QXJyYXl9IGRpcmVjdGl2ZXMgQXJyYXkgb2YgY29sbGVjdGVkIGRpcmVjdGl2ZXMgdG8gZXhlY3V0ZSB0aGVpciBjb21waWxlIGZ1bmN0aW9uLlxuXHQgICAgICogICAgICAgIHRoaXMgbmVlZHMgdG8gYmUgcHJlLXNvcnRlZCBieSBwcmlvcml0eSBvcmRlci5cblx0ICAgICAqIEBwYXJhbSB7Tm9kZX0gY29tcGlsZU5vZGUgVGhlIHJhdyBET00gbm9kZSB0byBhcHBseSB0aGUgY29tcGlsZSBmdW5jdGlvbnMgdG9cblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSB0ZW1wbGF0ZUF0dHJzIFRoZSBzaGFyZWQgYXR0cmlidXRlIGZ1bmN0aW9uXG5cdCAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGFuZ3VsYXIuU2NvcGUsIGNsb25lQXR0YWNoRm49KX0gdHJhbnNjbHVkZUZuIEEgbGlua2luZyBmdW5jdGlvbiwgd2hlcmUgdGhlXG5cdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUgYXJndW1lbnQgaXMgYXV0by1nZW5lcmF0ZWQgdG8gdGhlIG5ld1xuXHQgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkIG9mIHRoZSB0cmFuc2NsdWRlZCBwYXJlbnQgc2NvcGUuXG5cdCAgICAgKiBAcGFyYW0ge0pRTGl0ZX0ganFDb2xsZWN0aW9uIElmIHdlIGFyZSB3b3JraW5nIG9uIHRoZSByb290IG9mIHRoZSBjb21waWxlIHRyZWUgdGhlbiB0aGlzXG5cdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3VtZW50IGhhcyB0aGUgcm9vdCBqcUxpdGUgYXJyYXkgc28gdGhhdCB3ZSBjYW4gcmVwbGFjZSBub2Rlc1xuXHQgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbiBpdC5cblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0PX0gb3JpZ2luYWxSZXBsYWNlRGlyZWN0aXZlIEFuIG9wdGlvbmFsIGRpcmVjdGl2ZSB0aGF0IHdpbGwgYmUgaWdub3JlZCB3aGVuXG5cdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21waWxpbmcgdGhlIHRyYW5zY2x1c2lvbi5cblx0ICAgICAqIEBwYXJhbSB7QXJyYXkuPEZ1bmN0aW9uPn0gcHJlTGlua0Zuc1xuXHQgICAgICogQHBhcmFtIHtBcnJheS48RnVuY3Rpb24+fSBwb3N0TGlua0Zuc1xuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IHByZXZpb3VzQ29tcGlsZUNvbnRleHQgQ29udGV4dCB1c2VkIGZvciBwcmV2aW91cyBjb21waWxhdGlvbiBvZiB0aGUgY3VycmVudFxuXHQgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVxuXHQgICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBsaW5rRm5cblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gYXBwbHlEaXJlY3RpdmVzVG9Ob2RlKGRpcmVjdGl2ZXMsIGNvbXBpbGVOb2RlLCB0ZW1wbGF0ZUF0dHJzLCB0cmFuc2NsdWRlRm4sXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganFDb2xsZWN0aW9uLCBvcmlnaW5hbFJlcGxhY2VEaXJlY3RpdmUsIHByZUxpbmtGbnMsIHBvc3RMaW5rRm5zLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzQ29tcGlsZUNvbnRleHQpIHtcblx0ICAgICAgcHJldmlvdXNDb21waWxlQ29udGV4dCA9IHByZXZpb3VzQ29tcGlsZUNvbnRleHQgfHwge307XG5cdFxuXHQgICAgICB2YXIgdGVybWluYWxQcmlvcml0eSA9IC1OdW1iZXIuTUFYX1ZBTFVFLFxuXHQgICAgICAgICAgbmV3U2NvcGVEaXJlY3RpdmUgPSBwcmV2aW91c0NvbXBpbGVDb250ZXh0Lm5ld1Njb3BlRGlyZWN0aXZlLFxuXHQgICAgICAgICAgY29udHJvbGxlckRpcmVjdGl2ZXMgPSBwcmV2aW91c0NvbXBpbGVDb250ZXh0LmNvbnRyb2xsZXJEaXJlY3RpdmVzLFxuXHQgICAgICAgICAgbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlID0gcHJldmlvdXNDb21waWxlQ29udGV4dC5uZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUsXG5cdCAgICAgICAgICB0ZW1wbGF0ZURpcmVjdGl2ZSA9IHByZXZpb3VzQ29tcGlsZUNvbnRleHQudGVtcGxhdGVEaXJlY3RpdmUsXG5cdCAgICAgICAgICBub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlID0gcHJldmlvdXNDb21waWxlQ29udGV4dC5ub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlLFxuXHQgICAgICAgICAgaGFzVHJhbnNjbHVkZURpcmVjdGl2ZSA9IGZhbHNlLFxuXHQgICAgICAgICAgaGFzVGVtcGxhdGUgPSBmYWxzZSxcblx0ICAgICAgICAgIGhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlID0gcHJldmlvdXNDb21waWxlQ29udGV4dC5oYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSxcblx0ICAgICAgICAgICRjb21waWxlTm9kZSA9IHRlbXBsYXRlQXR0cnMuJCRlbGVtZW50ID0ganFMaXRlKGNvbXBpbGVOb2RlKSxcblx0ICAgICAgICAgIGRpcmVjdGl2ZSxcblx0ICAgICAgICAgIGRpcmVjdGl2ZU5hbWUsXG5cdCAgICAgICAgICAkdGVtcGxhdGUsXG5cdCAgICAgICAgICByZXBsYWNlRGlyZWN0aXZlID0gb3JpZ2luYWxSZXBsYWNlRGlyZWN0aXZlLFxuXHQgICAgICAgICAgY2hpbGRUcmFuc2NsdWRlRm4gPSB0cmFuc2NsdWRlRm4sXG5cdCAgICAgICAgICBsaW5rRm4sXG5cdCAgICAgICAgICBkaWRTY2FuRm9yTXVsdGlwbGVUcmFuc2NsdXNpb24gPSBmYWxzZSxcblx0ICAgICAgICAgIG1pZ2h0SGF2ZU11bHRpcGxlVHJhbnNjbHVzaW9uRXJyb3IgPSBmYWxzZSxcblx0ICAgICAgICAgIGRpcmVjdGl2ZVZhbHVlO1xuXHRcblx0ICAgICAgLy8gZXhlY3V0ZXMgYWxsIGRpcmVjdGl2ZXMgb24gdGhlIGN1cnJlbnQgZWxlbWVudFxuXHQgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBkaXJlY3RpdmVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0ICAgICAgICBkaXJlY3RpdmUgPSBkaXJlY3RpdmVzW2ldO1xuXHQgICAgICAgIHZhciBhdHRyU3RhcnQgPSBkaXJlY3RpdmUuJCRzdGFydDtcblx0ICAgICAgICB2YXIgYXR0ckVuZCA9IGRpcmVjdGl2ZS4kJGVuZDtcblx0XG5cdCAgICAgICAgLy8gY29sbGVjdCBtdWx0aWJsb2NrIHNlY3Rpb25zXG5cdCAgICAgICAgaWYgKGF0dHJTdGFydCkge1xuXHQgICAgICAgICAgJGNvbXBpbGVOb2RlID0gZ3JvdXBTY2FuKGNvbXBpbGVOb2RlLCBhdHRyU3RhcnQsIGF0dHJFbmQpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICAkdGVtcGxhdGUgPSB1bmRlZmluZWQ7XG5cdFxuXHQgICAgICAgIGlmICh0ZXJtaW5hbFByaW9yaXR5ID4gZGlyZWN0aXZlLnByaW9yaXR5KSB7XG5cdCAgICAgICAgICBicmVhazsgLy8gcHJldmVudCBmdXJ0aGVyIHByb2Nlc3Npbmcgb2YgZGlyZWN0aXZlc1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKGRpcmVjdGl2ZVZhbHVlID0gZGlyZWN0aXZlLnNjb3BlKSB7XG5cdFxuXHQgICAgICAgICAgLy8gc2tpcCB0aGUgY2hlY2sgZm9yIGRpcmVjdGl2ZXMgd2l0aCBhc3luYyB0ZW1wbGF0ZXMsIHdlJ2xsIGNoZWNrIHRoZSBkZXJpdmVkIHN5bmNcblx0ICAgICAgICAgIC8vIGRpcmVjdGl2ZSB3aGVuIHRoZSB0ZW1wbGF0ZSBhcnJpdmVzXG5cdCAgICAgICAgICBpZiAoIWRpcmVjdGl2ZS50ZW1wbGF0ZVVybCkge1xuXHQgICAgICAgICAgICBpZiAoaXNPYmplY3QoZGlyZWN0aXZlVmFsdWUpKSB7XG5cdCAgICAgICAgICAgICAgLy8gVGhpcyBkaXJlY3RpdmUgaXMgdHJ5aW5nIHRvIGFkZCBhbiBpc29sYXRlZCBzY29wZS5cblx0ICAgICAgICAgICAgICAvLyBDaGVjayB0aGF0IHRoZXJlIGlzIG5vIHNjb3BlIG9mIGFueSBraW5kIGFscmVhZHlcblx0ICAgICAgICAgICAgICBhc3NlcnROb0R1cGxpY2F0ZSgnbmV3L2lzb2xhdGVkIHNjb3BlJywgbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlIHx8IG5ld1Njb3BlRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdGl2ZSwgJGNvbXBpbGVOb2RlKTtcblx0ICAgICAgICAgICAgICBuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUgPSBkaXJlY3RpdmU7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgLy8gVGhpcyBkaXJlY3RpdmUgaXMgdHJ5aW5nIHRvIGFkZCBhIGNoaWxkIHNjb3BlLlxuXHQgICAgICAgICAgICAgIC8vIENoZWNrIHRoYXQgdGhlcmUgaXMgbm8gaXNvbGF0ZWQgc2NvcGUgYWxyZWFkeVxuXHQgICAgICAgICAgICAgIGFzc2VydE5vRHVwbGljYXRlKCduZXcvaXNvbGF0ZWQgc2NvcGUnLCBuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUsIGRpcmVjdGl2ZSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY29tcGlsZU5vZGUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgbmV3U2NvcGVEaXJlY3RpdmUgPSBuZXdTY29wZURpcmVjdGl2ZSB8fCBkaXJlY3RpdmU7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBkaXJlY3RpdmVOYW1lID0gZGlyZWN0aXZlLm5hbWU7XG5cdFxuXHQgICAgICAgIC8vIElmIHdlIGVuY291bnRlciBhIGNvbmRpdGlvbiB0aGF0IGNhbiByZXN1bHQgaW4gdHJhbnNjbHVzaW9uIG9uIHRoZSBkaXJlY3RpdmUsXG5cdCAgICAgICAgLy8gdGhlbiBzY2FuIGFoZWFkIGluIHRoZSByZW1haW5pbmcgZGlyZWN0aXZlcyBmb3Igb3RoZXJzIHRoYXQgbWF5IGNhdXNlIGEgbXVsdGlwbGVcblx0ICAgICAgICAvLyB0cmFuc2NsdXNpb24gZXJyb3IgdG8gYmUgdGhyb3duIGR1cmluZyB0aGUgY29tcGlsYXRpb24gcHJvY2Vzcy4gIElmIGEgbWF0Y2hpbmcgZGlyZWN0aXZlXG5cdCAgICAgICAgLy8gaXMgZm91bmQsIHRoZW4gd2Uga25vdyB0aGF0IHdoZW4gd2UgZW5jb3VudGVyIGEgdHJhbnNjbHVkZWQgZGlyZWN0aXZlLCB3ZSBuZWVkIHRvIGVhZ2VybHlcblx0ICAgICAgICAvLyBjb21waWxlIHRoZSBgdHJhbnNjbHVkZWAgZnVuY3Rpb24gcmF0aGVyIHRoYW4gZG9pbmcgaXQgbGF6aWx5IGluIG9yZGVyIHRvIHRocm93XG5cdCAgICAgICAgLy8gZXhjZXB0aW9ucyBhdCB0aGUgY29ycmVjdCB0aW1lXG5cdCAgICAgICAgaWYgKCFkaWRTY2FuRm9yTXVsdGlwbGVUcmFuc2NsdXNpb24gJiYgKChkaXJlY3RpdmUucmVwbGFjZSAmJiAoZGlyZWN0aXZlLnRlbXBsYXRlVXJsIHx8IGRpcmVjdGl2ZS50ZW1wbGF0ZSkpXG5cdCAgICAgICAgICAgIHx8IChkaXJlY3RpdmUudHJhbnNjbHVkZSAmJiAhZGlyZWN0aXZlLiQkdGxiKSkpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBjYW5kaWRhdGVEaXJlY3RpdmU7XG5cdFxuXHQgICAgICAgICAgICAgICAgZm9yICh2YXIgc2Nhbm5pbmdJbmRleCA9IGkgKyAxOyBjYW5kaWRhdGVEaXJlY3RpdmUgPSBkaXJlY3RpdmVzW3NjYW5uaW5nSW5kZXgrK107KSB7XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKChjYW5kaWRhdGVEaXJlY3RpdmUudHJhbnNjbHVkZSAmJiAhY2FuZGlkYXRlRGlyZWN0aXZlLiQkdGxiKVxuXHQgICAgICAgICAgICAgICAgICAgICAgICB8fCAoY2FuZGlkYXRlRGlyZWN0aXZlLnJlcGxhY2UgJiYgKGNhbmRpZGF0ZURpcmVjdGl2ZS50ZW1wbGF0ZVVybCB8fCBjYW5kaWRhdGVEaXJlY3RpdmUudGVtcGxhdGUpKSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBtaWdodEhhdmVNdWx0aXBsZVRyYW5zY2x1c2lvbkVycm9yID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgICAgIGRpZFNjYW5Gb3JNdWx0aXBsZVRyYW5zY2x1c2lvbiA9IHRydWU7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAoIWRpcmVjdGl2ZS50ZW1wbGF0ZVVybCAmJiBkaXJlY3RpdmUuY29udHJvbGxlcikge1xuXHQgICAgICAgICAgZGlyZWN0aXZlVmFsdWUgPSBkaXJlY3RpdmUuY29udHJvbGxlcjtcblx0ICAgICAgICAgIGNvbnRyb2xsZXJEaXJlY3RpdmVzID0gY29udHJvbGxlckRpcmVjdGl2ZXMgfHwgY3JlYXRlTWFwKCk7XG5cdCAgICAgICAgICBhc3NlcnROb0R1cGxpY2F0ZShcIidcIiArIGRpcmVjdGl2ZU5hbWUgKyBcIicgY29udHJvbGxlclwiLFxuXHQgICAgICAgICAgICAgIGNvbnRyb2xsZXJEaXJlY3RpdmVzW2RpcmVjdGl2ZU5hbWVdLCBkaXJlY3RpdmUsICRjb21waWxlTm9kZSk7XG5cdCAgICAgICAgICBjb250cm9sbGVyRGlyZWN0aXZlc1tkaXJlY3RpdmVOYW1lXSA9IGRpcmVjdGl2ZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmIChkaXJlY3RpdmVWYWx1ZSA9IGRpcmVjdGl2ZS50cmFuc2NsdWRlKSB7XG5cdCAgICAgICAgICBoYXNUcmFuc2NsdWRlRGlyZWN0aXZlID0gdHJ1ZTtcblx0XG5cdCAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UgbmdJZiBhbmQgbmdSZXBlYXQgc28gdGhhdCB3ZSBkb24ndCBjb21wbGFpbiBhYm91dCBkdXBsaWNhdGUgdHJhbnNjbHVzaW9uLlxuXHQgICAgICAgICAgLy8gVGhpcyBvcHRpb24gc2hvdWxkIG9ubHkgYmUgdXNlZCBieSBkaXJlY3RpdmVzIHRoYXQga25vdyBob3cgdG8gc2FmZWx5IGhhbmRsZSBlbGVtZW50IHRyYW5zY2x1c2lvbixcblx0ICAgICAgICAgIC8vIHdoZXJlIHRoZSB0cmFuc2NsdWRlZCBub2RlcyBhcmUgYWRkZWQgb3IgcmVwbGFjZWQgYWZ0ZXIgbGlua2luZy5cblx0ICAgICAgICAgIGlmICghZGlyZWN0aXZlLiQkdGxiKSB7XG5cdCAgICAgICAgICAgIGFzc2VydE5vRHVwbGljYXRlKCd0cmFuc2NsdXNpb24nLCBub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlLCBkaXJlY3RpdmUsICRjb21waWxlTm9kZSk7XG5cdCAgICAgICAgICAgIG5vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmUgPSBkaXJlY3RpdmU7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgaWYgKGRpcmVjdGl2ZVZhbHVlID09ICdlbGVtZW50Jykge1xuXHQgICAgICAgICAgICBoYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSA9IHRydWU7XG5cdCAgICAgICAgICAgIHRlcm1pbmFsUHJpb3JpdHkgPSBkaXJlY3RpdmUucHJpb3JpdHk7XG5cdCAgICAgICAgICAgICR0ZW1wbGF0ZSA9ICRjb21waWxlTm9kZTtcblx0ICAgICAgICAgICAgJGNvbXBpbGVOb2RlID0gdGVtcGxhdGVBdHRycy4kJGVsZW1lbnQgPVxuXHQgICAgICAgICAgICAgICAganFMaXRlKGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoJyAnICsgZGlyZWN0aXZlTmFtZSArICc6ICcgK1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVBdHRyc1tkaXJlY3RpdmVOYW1lXSArICcgJykpO1xuXHQgICAgICAgICAgICBjb21waWxlTm9kZSA9ICRjb21waWxlTm9kZVswXTtcblx0ICAgICAgICAgICAgcmVwbGFjZVdpdGgoanFDb2xsZWN0aW9uLCBzbGljZUFyZ3MoJHRlbXBsYXRlKSwgY29tcGlsZU5vZGUpO1xuXHRcblx0ICAgICAgICAgICAgY2hpbGRUcmFuc2NsdWRlRm4gPSBjb21waWxhdGlvbkdlbmVyYXRvcihtaWdodEhhdmVNdWx0aXBsZVRyYW5zY2x1c2lvbkVycm9yLCAkdGVtcGxhdGUsIHRyYW5zY2x1ZGVGbiwgdGVybWluYWxQcmlvcml0eSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VEaXJlY3RpdmUgJiYgcmVwbGFjZURpcmVjdGl2ZS5uYW1lLCB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvbid0IHBhc3MgaW46XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIC0gY29udHJvbGxlckRpcmVjdGl2ZXMgLSBvdGhlcndpc2Ugd2UnbGwgY3JlYXRlIGR1cGxpY2F0ZXMgY29udHJvbGxlcnNcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gLSBuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUgb3IgdGVtcGxhdGVEaXJlY3RpdmUgLSBjb21iaW5pbmcgdGVtcGxhdGVzIHdpdGhcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBlbGVtZW50IHRyYW5zY2x1c2lvbiBkb2Vzbid0IG1ha2Ugc2Vuc2UuXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgb25seSBub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlIHNvIHRoYXQgd2UgcHJldmVudCBwdXR0aW5nIHRyYW5zY2x1c2lvblxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBvbiB0aGUgc2FtZSBlbGVtZW50IG1vcmUgdGhhbiBvbmNlLlxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlOiBub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdFxuXHQgICAgICAgICAgICB2YXIgc2xvdHMgPSBjcmVhdGVNYXAoKTtcblx0XG5cdCAgICAgICAgICAgICR0ZW1wbGF0ZSA9IGpxTGl0ZShqcUxpdGVDbG9uZShjb21waWxlTm9kZSkpLmNvbnRlbnRzKCk7XG5cdFxuXHQgICAgICAgICAgICBpZiAoaXNPYmplY3QoZGlyZWN0aXZlVmFsdWUpKSB7XG5cdFxuXHQgICAgICAgICAgICAgIC8vIFdlIGhhdmUgdHJhbnNjbHVzaW9uIHNsb3RzLFxuXHQgICAgICAgICAgICAgIC8vIGNvbGxlY3QgdGhlbSB1cCwgY29tcGlsZSB0aGVtIGFuZCBzdG9yZSB0aGVpciB0cmFuc2NsdXNpb24gZnVuY3Rpb25zXG5cdCAgICAgICAgICAgICAgJHRlbXBsYXRlID0gW107XG5cdFxuXHQgICAgICAgICAgICAgIHZhciBzbG90TWFwID0gY3JlYXRlTWFwKCk7XG5cdCAgICAgICAgICAgICAgdmFyIGZpbGxlZFNsb3RzID0gY3JlYXRlTWFwKCk7XG5cdFxuXHQgICAgICAgICAgICAgIC8vIFBhcnNlIHRoZSBlbGVtZW50IHNlbGVjdG9yc1xuXHQgICAgICAgICAgICAgIGZvckVhY2goZGlyZWN0aXZlVmFsdWUsIGZ1bmN0aW9uKGVsZW1lbnRTZWxlY3Rvciwgc2xvdE5hbWUpIHtcblx0ICAgICAgICAgICAgICAgIC8vIElmIGFuIGVsZW1lbnQgc2VsZWN0b3Igc3RhcnRzIHdpdGggYSA/IHRoZW4gaXQgaXMgb3B0aW9uYWxcblx0ICAgICAgICAgICAgICAgIHZhciBvcHRpb25hbCA9IChlbGVtZW50U2VsZWN0b3IuY2hhckF0KDApID09PSAnPycpO1xuXHQgICAgICAgICAgICAgICAgZWxlbWVudFNlbGVjdG9yID0gb3B0aW9uYWwgPyBlbGVtZW50U2VsZWN0b3Iuc3Vic3RyaW5nKDEpIDogZWxlbWVudFNlbGVjdG9yO1xuXHRcblx0ICAgICAgICAgICAgICAgIHNsb3RNYXBbZWxlbWVudFNlbGVjdG9yXSA9IHNsb3ROYW1lO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIFdlIGV4cGxpY2l0bHkgYXNzaWduIGBudWxsYCBzaW5jZSB0aGlzIGltcGxpZXMgdGhhdCBhIHNsb3Qgd2FzIGRlZmluZWQgYnV0IG5vdCBmaWxsZWQuXG5cdCAgICAgICAgICAgICAgICAvLyBMYXRlciB3aGVuIGNhbGxpbmcgYm91bmRUcmFuc2NsdXNpb24gZnVuY3Rpb25zIHdpdGggYSBzbG90IG5hbWUgd2Ugb25seSBlcnJvciBpZiB0aGVcblx0ICAgICAgICAgICAgICAgIC8vIHNsb3QgaXMgYHVuZGVmaW5lZGBcblx0ICAgICAgICAgICAgICAgIHNsb3RzW3Nsb3ROYW1lXSA9IG51bGw7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gZmlsbGVkU2xvdHMgY29udGFpbnMgYHRydWVgIGZvciBhbGwgc2xvdHMgdGhhdCBhcmUgZWl0aGVyIG9wdGlvbmFsIG9yIGhhdmUgYmVlblxuXHQgICAgICAgICAgICAgICAgLy8gZmlsbGVkLiBUaGlzIGlzIHVzZWQgdG8gY2hlY2sgdGhhdCB3ZSBoYXZlIG5vdCBtaXNzZWQgYW55IHJlcXVpcmVkIHNsb3RzXG5cdCAgICAgICAgICAgICAgICBmaWxsZWRTbG90c1tzbG90TmFtZV0gPSBvcHRpb25hbDtcblx0ICAgICAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAgICAgLy8gQWRkIHRoZSBtYXRjaGluZyBlbGVtZW50cyBpbnRvIHRoZWlyIHNsb3Rcblx0ICAgICAgICAgICAgICBmb3JFYWNoKCRjb21waWxlTm9kZS5jb250ZW50cygpLCBmdW5jdGlvbihub2RlKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgc2xvdE5hbWUgPSBzbG90TWFwW2RpcmVjdGl2ZU5vcm1hbGl6ZShub2RlTmFtZV8obm9kZSkpXTtcblx0ICAgICAgICAgICAgICAgIGlmIChzbG90TmFtZSkge1xuXHQgICAgICAgICAgICAgICAgICBmaWxsZWRTbG90c1tzbG90TmFtZV0gPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgICBzbG90c1tzbG90TmFtZV0gPSBzbG90c1tzbG90TmFtZV0gfHwgW107XG5cdCAgICAgICAgICAgICAgICAgIHNsb3RzW3Nsb3ROYW1lXS5wdXNoKG5vZGUpO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgJHRlbXBsYXRlLnB1c2gobm9kZSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgICAgIC8vIENoZWNrIGZvciByZXF1aXJlZCBzbG90cyB0aGF0IHdlcmUgbm90IGZpbGxlZFxuXHQgICAgICAgICAgICAgIGZvckVhY2goZmlsbGVkU2xvdHMsIGZ1bmN0aW9uKGZpbGxlZCwgc2xvdE5hbWUpIHtcblx0ICAgICAgICAgICAgICAgIGlmICghZmlsbGVkKSB7XG5cdCAgICAgICAgICAgICAgICAgIHRocm93ICRjb21waWxlTWluRXJyKCdyZXFzbG90JywgJ1JlcXVpcmVkIHRyYW5zY2x1c2lvbiBzbG90IGB7MH1gIHdhcyBub3QgZmlsbGVkLicsIHNsb3ROYW1lKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAgICAgZm9yICh2YXIgc2xvdE5hbWUgaW4gc2xvdHMpIHtcblx0ICAgICAgICAgICAgICAgIGlmIChzbG90c1tzbG90TmFtZV0pIHtcblx0ICAgICAgICAgICAgICAgICAgLy8gT25seSBkZWZpbmUgYSB0cmFuc2NsdXNpb24gZnVuY3Rpb24gaWYgdGhlIHNsb3Qgd2FzIGZpbGxlZFxuXHQgICAgICAgICAgICAgICAgICBzbG90c1tzbG90TmFtZV0gPSBjb21waWxhdGlvbkdlbmVyYXRvcihtaWdodEhhdmVNdWx0aXBsZVRyYW5zY2x1c2lvbkVycm9yLCBzbG90c1tzbG90TmFtZV0sIHRyYW5zY2x1ZGVGbik7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAkY29tcGlsZU5vZGUuZW1wdHkoKTsgLy8gY2xlYXIgY29udGVudHNcblx0ICAgICAgICAgICAgY2hpbGRUcmFuc2NsdWRlRm4gPSBjb21waWxhdGlvbkdlbmVyYXRvcihtaWdodEhhdmVNdWx0aXBsZVRyYW5zY2x1c2lvbkVycm9yLCAkdGVtcGxhdGUsIHRyYW5zY2x1ZGVGbiwgdW5kZWZpbmVkLFxuXHQgICAgICAgICAgICAgICAgdW5kZWZpbmVkLCB7IG5lZWRzTmV3U2NvcGU6IGRpcmVjdGl2ZS4kJGlzb2xhdGVTY29wZSB8fCBkaXJlY3RpdmUuJCRuZXdTY29wZX0pO1xuXHQgICAgICAgICAgICBjaGlsZFRyYW5zY2x1ZGVGbi4kJHNsb3RzID0gc2xvdHM7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAoZGlyZWN0aXZlLnRlbXBsYXRlKSB7XG5cdCAgICAgICAgICBoYXNUZW1wbGF0ZSA9IHRydWU7XG5cdCAgICAgICAgICBhc3NlcnROb0R1cGxpY2F0ZSgndGVtcGxhdGUnLCB0ZW1wbGF0ZURpcmVjdGl2ZSwgZGlyZWN0aXZlLCAkY29tcGlsZU5vZGUpO1xuXHQgICAgICAgICAgdGVtcGxhdGVEaXJlY3RpdmUgPSBkaXJlY3RpdmU7XG5cdFxuXHQgICAgICAgICAgZGlyZWN0aXZlVmFsdWUgPSAoaXNGdW5jdGlvbihkaXJlY3RpdmUudGVtcGxhdGUpKVxuXHQgICAgICAgICAgICAgID8gZGlyZWN0aXZlLnRlbXBsYXRlKCRjb21waWxlTm9kZSwgdGVtcGxhdGVBdHRycylcblx0ICAgICAgICAgICAgICA6IGRpcmVjdGl2ZS50ZW1wbGF0ZTtcblx0XG5cdCAgICAgICAgICBkaXJlY3RpdmVWYWx1ZSA9IGRlbm9ybWFsaXplVGVtcGxhdGUoZGlyZWN0aXZlVmFsdWUpO1xuXHRcblx0ICAgICAgICAgIGlmIChkaXJlY3RpdmUucmVwbGFjZSkge1xuXHQgICAgICAgICAgICByZXBsYWNlRGlyZWN0aXZlID0gZGlyZWN0aXZlO1xuXHQgICAgICAgICAgICBpZiAoanFMaXRlSXNUZXh0Tm9kZShkaXJlY3RpdmVWYWx1ZSkpIHtcblx0ICAgICAgICAgICAgICAkdGVtcGxhdGUgPSBbXTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAkdGVtcGxhdGUgPSByZW1vdmVDb21tZW50cyh3cmFwVGVtcGxhdGUoZGlyZWN0aXZlLnRlbXBsYXRlTmFtZXNwYWNlLCB0cmltKGRpcmVjdGl2ZVZhbHVlKSkpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGNvbXBpbGVOb2RlID0gJHRlbXBsYXRlWzBdO1xuXHRcblx0ICAgICAgICAgICAgaWYgKCR0ZW1wbGF0ZS5sZW5ndGggIT0gMSB8fCBjb21waWxlTm9kZS5ub2RlVHlwZSAhPT0gTk9ERV9UWVBFX0VMRU1FTlQpIHtcblx0ICAgICAgICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycigndHBscnQnLFxuXHQgICAgICAgICAgICAgICAgICBcIlRlbXBsYXRlIGZvciBkaXJlY3RpdmUgJ3swfScgbXVzdCBoYXZlIGV4YWN0bHkgb25lIHJvb3QgZWxlbWVudC4gezF9XCIsXG5cdCAgICAgICAgICAgICAgICAgIGRpcmVjdGl2ZU5hbWUsICcnKTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgcmVwbGFjZVdpdGgoanFDb2xsZWN0aW9uLCAkY29tcGlsZU5vZGUsIGNvbXBpbGVOb2RlKTtcblx0XG5cdCAgICAgICAgICAgIHZhciBuZXdUZW1wbGF0ZUF0dHJzID0geyRhdHRyOiB7fX07XG5cdFxuXHQgICAgICAgICAgICAvLyBjb21iaW5lIGRpcmVjdGl2ZXMgZnJvbSB0aGUgb3JpZ2luYWwgbm9kZSBhbmQgZnJvbSB0aGUgdGVtcGxhdGU6XG5cdCAgICAgICAgICAgIC8vIC0gdGFrZSB0aGUgYXJyYXkgb2YgZGlyZWN0aXZlcyBmb3IgdGhpcyBlbGVtZW50XG5cdCAgICAgICAgICAgIC8vIC0gc3BsaXQgaXQgaW50byB0d28gcGFydHMsIHRob3NlIHRoYXQgYWxyZWFkeSBhcHBsaWVkIChwcm9jZXNzZWQpIGFuZCB0aG9zZSB0aGF0IHdlcmVuJ3QgKHVucHJvY2Vzc2VkKVxuXHQgICAgICAgICAgICAvLyAtIGNvbGxlY3QgZGlyZWN0aXZlcyBmcm9tIHRoZSB0ZW1wbGF0ZSBhbmQgc29ydCB0aGVtIGJ5IHByaW9yaXR5XG5cdCAgICAgICAgICAgIC8vIC0gY29tYmluZSBkaXJlY3RpdmVzIGFzOiBwcm9jZXNzZWQgKyB0ZW1wbGF0ZSArIHVucHJvY2Vzc2VkXG5cdCAgICAgICAgICAgIHZhciB0ZW1wbGF0ZURpcmVjdGl2ZXMgPSBjb2xsZWN0RGlyZWN0aXZlcyhjb21waWxlTm9kZSwgW10sIG5ld1RlbXBsYXRlQXR0cnMpO1xuXHQgICAgICAgICAgICB2YXIgdW5wcm9jZXNzZWREaXJlY3RpdmVzID0gZGlyZWN0aXZlcy5zcGxpY2UoaSArIDEsIGRpcmVjdGl2ZXMubGVuZ3RoIC0gKGkgKyAxKSk7XG5cdFxuXHQgICAgICAgICAgICBpZiAobmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlIHx8IG5ld1Njb3BlRGlyZWN0aXZlKSB7XG5cdCAgICAgICAgICAgICAgLy8gVGhlIG9yaWdpbmFsIGRpcmVjdGl2ZSBjYXVzZWQgdGhlIGN1cnJlbnQgZWxlbWVudCB0byBiZSByZXBsYWNlZCBidXQgdGhpcyBlbGVtZW50XG5cdCAgICAgICAgICAgICAgLy8gYWxzbyBuZWVkcyB0byBoYXZlIGEgbmV3IHNjb3BlLCBzbyB3ZSBuZWVkIHRvIHRlbGwgdGhlIHRlbXBsYXRlIGRpcmVjdGl2ZXNcblx0ICAgICAgICAgICAgICAvLyB0aGF0IHRoZXkgd291bGQgbmVlZCB0byBnZXQgdGhlaXIgc2NvcGUgZnJvbSBmdXJ0aGVyIHVwLCBpZiB0aGV5IHJlcXVpcmUgdHJhbnNjbHVzaW9uXG5cdCAgICAgICAgICAgICAgbWFya0RpcmVjdGl2ZVNjb3BlKHRlbXBsYXRlRGlyZWN0aXZlcywgbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlLCBuZXdTY29wZURpcmVjdGl2ZSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgZGlyZWN0aXZlcyA9IGRpcmVjdGl2ZXMuY29uY2F0KHRlbXBsYXRlRGlyZWN0aXZlcykuY29uY2F0KHVucHJvY2Vzc2VkRGlyZWN0aXZlcyk7XG5cdCAgICAgICAgICAgIG1lcmdlVGVtcGxhdGVBdHRyaWJ1dGVzKHRlbXBsYXRlQXR0cnMsIG5ld1RlbXBsYXRlQXR0cnMpO1xuXHRcblx0ICAgICAgICAgICAgaWkgPSBkaXJlY3RpdmVzLmxlbmd0aDtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICRjb21waWxlTm9kZS5odG1sKGRpcmVjdGl2ZVZhbHVlKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmIChkaXJlY3RpdmUudGVtcGxhdGVVcmwpIHtcblx0ICAgICAgICAgIGhhc1RlbXBsYXRlID0gdHJ1ZTtcblx0ICAgICAgICAgIGFzc2VydE5vRHVwbGljYXRlKCd0ZW1wbGF0ZScsIHRlbXBsYXRlRGlyZWN0aXZlLCBkaXJlY3RpdmUsICRjb21waWxlTm9kZSk7XG5cdCAgICAgICAgICB0ZW1wbGF0ZURpcmVjdGl2ZSA9IGRpcmVjdGl2ZTtcblx0XG5cdCAgICAgICAgICBpZiAoZGlyZWN0aXZlLnJlcGxhY2UpIHtcblx0ICAgICAgICAgICAgcmVwbGFjZURpcmVjdGl2ZSA9IGRpcmVjdGl2ZTtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICBub2RlTGlua0ZuID0gY29tcGlsZVRlbXBsYXRlVXJsKGRpcmVjdGl2ZXMuc3BsaWNlKGksIGRpcmVjdGl2ZXMubGVuZ3RoIC0gaSksICRjb21waWxlTm9kZSxcblx0ICAgICAgICAgICAgICB0ZW1wbGF0ZUF0dHJzLCBqcUNvbGxlY3Rpb24sIGhhc1RyYW5zY2x1ZGVEaXJlY3RpdmUgJiYgY2hpbGRUcmFuc2NsdWRlRm4sIHByZUxpbmtGbnMsIHBvc3RMaW5rRm5zLCB7XG5cdCAgICAgICAgICAgICAgICBjb250cm9sbGVyRGlyZWN0aXZlczogY29udHJvbGxlckRpcmVjdGl2ZXMsXG5cdCAgICAgICAgICAgICAgICBuZXdTY29wZURpcmVjdGl2ZTogKG5ld1Njb3BlRGlyZWN0aXZlICE9PSBkaXJlY3RpdmUpICYmIG5ld1Njb3BlRGlyZWN0aXZlLFxuXHQgICAgICAgICAgICAgICAgbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlOiBuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgICAgICB0ZW1wbGF0ZURpcmVjdGl2ZTogdGVtcGxhdGVEaXJlY3RpdmUsXG5cdCAgICAgICAgICAgICAgICBub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlOiBub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlXG5cdCAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICBpaSA9IGRpcmVjdGl2ZXMubGVuZ3RoO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aXZlLmNvbXBpbGUpIHtcblx0ICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgIGxpbmtGbiA9IGRpcmVjdGl2ZS5jb21waWxlKCRjb21waWxlTm9kZSwgdGVtcGxhdGVBdHRycywgY2hpbGRUcmFuc2NsdWRlRm4pO1xuXHQgICAgICAgICAgICBpZiAoaXNGdW5jdGlvbihsaW5rRm4pKSB7XG5cdCAgICAgICAgICAgICAgYWRkTGlua0ZucyhudWxsLCBsaW5rRm4sIGF0dHJTdGFydCwgYXR0ckVuZCk7XG5cdCAgICAgICAgICAgIH0gZWxzZSBpZiAobGlua0ZuKSB7XG5cdCAgICAgICAgICAgICAgYWRkTGlua0ZucyhsaW5rRm4ucHJlLCBsaW5rRm4ucG9zdCwgYXR0clN0YXJ0LCBhdHRyRW5kKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgICAkZXhjZXB0aW9uSGFuZGxlcihlLCBzdGFydGluZ1RhZygkY29tcGlsZU5vZGUpKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmIChkaXJlY3RpdmUudGVybWluYWwpIHtcblx0ICAgICAgICAgIG5vZGVMaW5rRm4udGVybWluYWwgPSB0cnVlO1xuXHQgICAgICAgICAgdGVybWluYWxQcmlvcml0eSA9IE1hdGgubWF4KHRlcm1pbmFsUHJpb3JpdHksIGRpcmVjdGl2ZS5wcmlvcml0eSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgfVxuXHRcblx0ICAgICAgbm9kZUxpbmtGbi5zY29wZSA9IG5ld1Njb3BlRGlyZWN0aXZlICYmIG5ld1Njb3BlRGlyZWN0aXZlLnNjb3BlID09PSB0cnVlO1xuXHQgICAgICBub2RlTGlua0ZuLnRyYW5zY2x1ZGVPblRoaXNFbGVtZW50ID0gaGFzVHJhbnNjbHVkZURpcmVjdGl2ZTtcblx0ICAgICAgbm9kZUxpbmtGbi50ZW1wbGF0ZU9uVGhpc0VsZW1lbnQgPSBoYXNUZW1wbGF0ZTtcblx0ICAgICAgbm9kZUxpbmtGbi50cmFuc2NsdWRlID0gY2hpbGRUcmFuc2NsdWRlRm47XG5cdFxuXHQgICAgICBwcmV2aW91c0NvbXBpbGVDb250ZXh0Lmhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlID0gaGFzRWxlbWVudFRyYW5zY2x1ZGVEaXJlY3RpdmU7XG5cdFxuXHQgICAgICAvLyBtaWdodCBiZSBub3JtYWwgb3IgZGVsYXllZCBub2RlTGlua0ZuIGRlcGVuZGluZyBvbiBpZiB0ZW1wbGF0ZVVybCBpcyBwcmVzZW50XG5cdCAgICAgIHJldHVybiBub2RlTGlua0ZuO1xuXHRcblx0ICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdCAgICAgIGZ1bmN0aW9uIGFkZExpbmtGbnMocHJlLCBwb3N0LCBhdHRyU3RhcnQsIGF0dHJFbmQpIHtcblx0ICAgICAgICBpZiAocHJlKSB7XG5cdCAgICAgICAgICBpZiAoYXR0clN0YXJ0KSBwcmUgPSBncm91cEVsZW1lbnRzTGlua0ZuV3JhcHBlcihwcmUsIGF0dHJTdGFydCwgYXR0ckVuZCk7XG5cdCAgICAgICAgICBwcmUucmVxdWlyZSA9IGRpcmVjdGl2ZS5yZXF1aXJlO1xuXHQgICAgICAgICAgcHJlLmRpcmVjdGl2ZU5hbWUgPSBkaXJlY3RpdmVOYW1lO1xuXHQgICAgICAgICAgaWYgKG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZSA9PT0gZGlyZWN0aXZlIHx8IGRpcmVjdGl2ZS4kJGlzb2xhdGVTY29wZSkge1xuXHQgICAgICAgICAgICBwcmUgPSBjbG9uZUFuZEFubm90YXRlRm4ocHJlLCB7aXNvbGF0ZVNjb3BlOiB0cnVlfSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBwcmVMaW5rRm5zLnB1c2gocHJlKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKHBvc3QpIHtcblx0ICAgICAgICAgIGlmIChhdHRyU3RhcnQpIHBvc3QgPSBncm91cEVsZW1lbnRzTGlua0ZuV3JhcHBlcihwb3N0LCBhdHRyU3RhcnQsIGF0dHJFbmQpO1xuXHQgICAgICAgICAgcG9zdC5yZXF1aXJlID0gZGlyZWN0aXZlLnJlcXVpcmU7XG5cdCAgICAgICAgICBwb3N0LmRpcmVjdGl2ZU5hbWUgPSBkaXJlY3RpdmVOYW1lO1xuXHQgICAgICAgICAgaWYgKG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZSA9PT0gZGlyZWN0aXZlIHx8IGRpcmVjdGl2ZS4kJGlzb2xhdGVTY29wZSkge1xuXHQgICAgICAgICAgICBwb3N0ID0gY2xvbmVBbmRBbm5vdGF0ZUZuKHBvc3QsIHtpc29sYXRlU2NvcGU6IHRydWV9KTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIHBvc3RMaW5rRm5zLnB1c2gocG9zdCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdFxuXHRcblx0ICAgICAgZnVuY3Rpb24gZ2V0Q29udHJvbGxlcnMoZGlyZWN0aXZlTmFtZSwgcmVxdWlyZSwgJGVsZW1lbnQsIGVsZW1lbnRDb250cm9sbGVycykge1xuXHQgICAgICAgIHZhciB2YWx1ZTtcblx0XG5cdCAgICAgICAgaWYgKGlzU3RyaW5nKHJlcXVpcmUpKSB7XG5cdCAgICAgICAgICB2YXIgbWF0Y2ggPSByZXF1aXJlLm1hdGNoKFJFUVVJUkVfUFJFRklYX1JFR0VYUCk7XG5cdCAgICAgICAgICB2YXIgbmFtZSA9IHJlcXVpcmUuc3Vic3RyaW5nKG1hdGNoWzBdLmxlbmd0aCk7XG5cdCAgICAgICAgICB2YXIgaW5oZXJpdFR5cGUgPSBtYXRjaFsxXSB8fCBtYXRjaFszXTtcblx0ICAgICAgICAgIHZhciBvcHRpb25hbCA9IG1hdGNoWzJdID09PSAnPyc7XG5cdFxuXHQgICAgICAgICAgLy9JZiBvbmx5IHBhcmVudHMgdGhlbiBzdGFydCBhdCB0aGUgcGFyZW50IGVsZW1lbnRcblx0ICAgICAgICAgIGlmIChpbmhlcml0VHlwZSA9PT0gJ15eJykge1xuXHQgICAgICAgICAgICAkZWxlbWVudCA9ICRlbGVtZW50LnBhcmVudCgpO1xuXHQgICAgICAgICAgLy9PdGhlcndpc2UgYXR0ZW1wdCBnZXR0aW5nIHRoZSBjb250cm9sbGVyIGZyb20gZWxlbWVudENvbnRyb2xsZXJzIGluIGNhc2Vcblx0ICAgICAgICAgIC8vdGhlIGVsZW1lbnQgaXMgdHJhbnNjbHVkZWQgKGFuZCBoYXMgbm8gZGF0YSkgYW5kIHRvIGF2b2lkIC5kYXRhIGlmIHBvc3NpYmxlXG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICB2YWx1ZSA9IGVsZW1lbnRDb250cm9sbGVycyAmJiBlbGVtZW50Q29udHJvbGxlcnNbbmFtZV07XG5cdCAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgJiYgdmFsdWUuaW5zdGFuY2U7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuXHQgICAgICAgICAgICB2YXIgZGF0YU5hbWUgPSAnJCcgKyBuYW1lICsgJ0NvbnRyb2xsZXInO1xuXHQgICAgICAgICAgICB2YWx1ZSA9IGluaGVyaXRUeXBlID8gJGVsZW1lbnQuaW5oZXJpdGVkRGF0YShkYXRhTmFtZSkgOiAkZWxlbWVudC5kYXRhKGRhdGFOYW1lKTtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICBpZiAoIXZhbHVlICYmICFvcHRpb25hbCkge1xuXHQgICAgICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycignY3RyZXEnLFxuXHQgICAgICAgICAgICAgICAgXCJDb250cm9sbGVyICd7MH0nLCByZXF1aXJlZCBieSBkaXJlY3RpdmUgJ3sxfScsIGNhbid0IGJlIGZvdW5kIVwiLFxuXHQgICAgICAgICAgICAgICAgbmFtZSwgZGlyZWN0aXZlTmFtZSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5KHJlcXVpcmUpKSB7XG5cdCAgICAgICAgICB2YWx1ZSA9IFtdO1xuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gcmVxdWlyZS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdCAgICAgICAgICAgIHZhbHVlW2ldID0gZ2V0Q29udHJvbGxlcnMoZGlyZWN0aXZlTmFtZSwgcmVxdWlyZVtpXSwgJGVsZW1lbnQsIGVsZW1lbnRDb250cm9sbGVycyk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIGlmIChpc09iamVjdChyZXF1aXJlKSkge1xuXHQgICAgICAgICAgdmFsdWUgPSB7fTtcblx0ICAgICAgICAgIGZvckVhY2gocmVxdWlyZSwgZnVuY3Rpb24oY29udHJvbGxlciwgcHJvcGVydHkpIHtcblx0ICAgICAgICAgICAgdmFsdWVbcHJvcGVydHldID0gZ2V0Q29udHJvbGxlcnMoZGlyZWN0aXZlTmFtZSwgY29udHJvbGxlciwgJGVsZW1lbnQsIGVsZW1lbnRDb250cm9sbGVycyk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiB2YWx1ZSB8fCBudWxsO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBmdW5jdGlvbiBzZXR1cENvbnRyb2xsZXJzKCRlbGVtZW50LCBhdHRycywgdHJhbnNjbHVkZUZuLCBjb250cm9sbGVyRGlyZWN0aXZlcywgaXNvbGF0ZVNjb3BlLCBzY29wZSkge1xuXHQgICAgICAgIHZhciBlbGVtZW50Q29udHJvbGxlcnMgPSBjcmVhdGVNYXAoKTtcblx0ICAgICAgICBmb3IgKHZhciBjb250cm9sbGVyS2V5IGluIGNvbnRyb2xsZXJEaXJlY3RpdmVzKSB7XG5cdCAgICAgICAgICB2YXIgZGlyZWN0aXZlID0gY29udHJvbGxlckRpcmVjdGl2ZXNbY29udHJvbGxlcktleV07XG5cdCAgICAgICAgICB2YXIgbG9jYWxzID0ge1xuXHQgICAgICAgICAgICAkc2NvcGU6IGRpcmVjdGl2ZSA9PT0gbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlIHx8IGRpcmVjdGl2ZS4kJGlzb2xhdGVTY29wZSA/IGlzb2xhdGVTY29wZSA6IHNjb3BlLFxuXHQgICAgICAgICAgICAkZWxlbWVudDogJGVsZW1lbnQsXG5cdCAgICAgICAgICAgICRhdHRyczogYXR0cnMsXG5cdCAgICAgICAgICAgICR0cmFuc2NsdWRlOiB0cmFuc2NsdWRlRm5cblx0ICAgICAgICAgIH07XG5cdFxuXHQgICAgICAgICAgdmFyIGNvbnRyb2xsZXIgPSBkaXJlY3RpdmUuY29udHJvbGxlcjtcblx0ICAgICAgICAgIGlmIChjb250cm9sbGVyID09ICdAJykge1xuXHQgICAgICAgICAgICBjb250cm9sbGVyID0gYXR0cnNbZGlyZWN0aXZlLm5hbWVdO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIHZhciBjb250cm9sbGVySW5zdGFuY2UgPSAkY29udHJvbGxlcihjb250cm9sbGVyLCBsb2NhbHMsIHRydWUsIGRpcmVjdGl2ZS5jb250cm9sbGVyQXMpO1xuXHRcblx0ICAgICAgICAgIC8vIEZvciBkaXJlY3RpdmVzIHdpdGggZWxlbWVudCB0cmFuc2NsdXNpb24gdGhlIGVsZW1lbnQgaXMgYSBjb21tZW50LFxuXHQgICAgICAgICAgLy8gYnV0IGpRdWVyeSAuZGF0YSBkb2Vzbid0IHN1cHBvcnQgYXR0YWNoaW5nIGRhdGEgdG8gY29tbWVudCBub2RlcyBhcyBpdCdzIGhhcmQgdG9cblx0ICAgICAgICAgIC8vIGNsZWFuIHVwIChodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC84MzM1KS5cblx0ICAgICAgICAgIC8vIEluc3RlYWQsIHdlIHNhdmUgdGhlIGNvbnRyb2xsZXJzIGZvciB0aGUgZWxlbWVudCBpbiBhIGxvY2FsIGhhc2ggYW5kIGF0dGFjaCB0byAuZGF0YVxuXHQgICAgICAgICAgLy8gbGF0ZXIsIG9uY2Ugd2UgaGF2ZSB0aGUgYWN0dWFsIGVsZW1lbnQuXG5cdCAgICAgICAgICBlbGVtZW50Q29udHJvbGxlcnNbZGlyZWN0aXZlLm5hbWVdID0gY29udHJvbGxlckluc3RhbmNlO1xuXHQgICAgICAgICAgaWYgKCFoYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSkge1xuXHQgICAgICAgICAgICAkZWxlbWVudC5kYXRhKCckJyArIGRpcmVjdGl2ZS5uYW1lICsgJ0NvbnRyb2xsZXInLCBjb250cm9sbGVySW5zdGFuY2UuaW5zdGFuY2UpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gZWxlbWVudENvbnRyb2xsZXJzO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBmdW5jdGlvbiBub2RlTGlua0ZuKGNoaWxkTGlua0ZuLCBzY29wZSwgbGlua05vZGUsICRyb290RWxlbWVudCwgYm91bmRUcmFuc2NsdWRlRm4pIHtcblx0ICAgICAgICB2YXIgaSwgaWksIGxpbmtGbiwgaXNvbGF0ZVNjb3BlLCBjb250cm9sbGVyU2NvcGUsIGVsZW1lbnRDb250cm9sbGVycywgdHJhbnNjbHVkZUZuLCAkZWxlbWVudCxcblx0ICAgICAgICAgICAgYXR0cnMsIHJlbW92ZVNjb3BlQmluZGluZ1dhdGNoZXMsIHJlbW92ZUNvbnRyb2xsZXJCaW5kaW5nV2F0Y2hlcztcblx0XG5cdCAgICAgICAgaWYgKGNvbXBpbGVOb2RlID09PSBsaW5rTm9kZSkge1xuXHQgICAgICAgICAgYXR0cnMgPSB0ZW1wbGF0ZUF0dHJzO1xuXHQgICAgICAgICAgJGVsZW1lbnQgPSB0ZW1wbGF0ZUF0dHJzLiQkZWxlbWVudDtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgJGVsZW1lbnQgPSBqcUxpdGUobGlua05vZGUpO1xuXHQgICAgICAgICAgYXR0cnMgPSBuZXcgQXR0cmlidXRlcygkZWxlbWVudCwgdGVtcGxhdGVBdHRycyk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBjb250cm9sbGVyU2NvcGUgPSBzY29wZTtcblx0ICAgICAgICBpZiAobmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlKSB7XG5cdCAgICAgICAgICBpc29sYXRlU2NvcGUgPSBzY29wZS4kbmV3KHRydWUpO1xuXHQgICAgICAgIH0gZWxzZSBpZiAobmV3U2NvcGVEaXJlY3RpdmUpIHtcblx0ICAgICAgICAgIGNvbnRyb2xsZXJTY29wZSA9IHNjb3BlLiRwYXJlbnQ7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAoYm91bmRUcmFuc2NsdWRlRm4pIHtcblx0ICAgICAgICAgIC8vIHRyYWNrIGBib3VuZFRyYW5zY2x1ZGVGbmAgc28gaXQgY2FuIGJlIHVud3JhcHBlZCBpZiBgdHJhbnNjbHVkZUZuYFxuXHQgICAgICAgICAgLy8gaXMgbGF0ZXIgcGFzc2VkIGFzIGBwYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbmAgdG8gYHB1YmxpY0xpbmtGbmBcblx0ICAgICAgICAgIHRyYW5zY2x1ZGVGbiA9IGNvbnRyb2xsZXJzQm91bmRUcmFuc2NsdWRlO1xuXHQgICAgICAgICAgdHJhbnNjbHVkZUZuLiQkYm91bmRUcmFuc2NsdWRlID0gYm91bmRUcmFuc2NsdWRlRm47XG5cdCAgICAgICAgICAvLyBleHBvc2UgdGhlIHNsb3RzIG9uIHRoZSBgJHRyYW5zY2x1ZGVgIGZ1bmN0aW9uXG5cdCAgICAgICAgICB0cmFuc2NsdWRlRm4uaXNTbG90RmlsbGVkID0gZnVuY3Rpb24oc2xvdE5hbWUpIHtcblx0ICAgICAgICAgICAgcmV0dXJuICEhYm91bmRUcmFuc2NsdWRlRm4uJCRzbG90c1tzbG90TmFtZV07XG5cdCAgICAgICAgICB9O1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKGNvbnRyb2xsZXJEaXJlY3RpdmVzKSB7XG5cdCAgICAgICAgICBlbGVtZW50Q29udHJvbGxlcnMgPSBzZXR1cENvbnRyb2xsZXJzKCRlbGVtZW50LCBhdHRycywgdHJhbnNjbHVkZUZuLCBjb250cm9sbGVyRGlyZWN0aXZlcywgaXNvbGF0ZVNjb3BlLCBzY29wZSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAobmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlKSB7XG5cdCAgICAgICAgICAvLyBJbml0aWFsaXplIGlzb2xhdGUgc2NvcGUgYmluZGluZ3MgZm9yIG5ldyBpc29sYXRlIHNjb3BlIGRpcmVjdGl2ZS5cblx0ICAgICAgICAgIGNvbXBpbGUuJCRhZGRTY29wZUluZm8oJGVsZW1lbnQsIGlzb2xhdGVTY29wZSwgdHJ1ZSwgISh0ZW1wbGF0ZURpcmVjdGl2ZSAmJiAodGVtcGxhdGVEaXJlY3RpdmUgPT09IG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZSB8fFxuXHQgICAgICAgICAgICAgIHRlbXBsYXRlRGlyZWN0aXZlID09PSBuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUuJCRvcmlnaW5hbERpcmVjdGl2ZSkpKTtcblx0ICAgICAgICAgIGNvbXBpbGUuJCRhZGRTY29wZUNsYXNzKCRlbGVtZW50LCB0cnVlKTtcblx0ICAgICAgICAgIGlzb2xhdGVTY29wZS4kJGlzb2xhdGVCaW5kaW5ncyA9XG5cdCAgICAgICAgICAgICAgbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlLiQkaXNvbGF0ZUJpbmRpbmdzO1xuXHQgICAgICAgICAgcmVtb3ZlU2NvcGVCaW5kaW5nV2F0Y2hlcyA9IGluaXRpYWxpemVEaXJlY3RpdmVCaW5kaW5ncyhzY29wZSwgYXR0cnMsIGlzb2xhdGVTY29wZSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzb2xhdGVTY29wZS4kJGlzb2xhdGVCaW5kaW5ncyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZSk7XG5cdCAgICAgICAgICBpZiAocmVtb3ZlU2NvcGVCaW5kaW5nV2F0Y2hlcykge1xuXHQgICAgICAgICAgICBpc29sYXRlU2NvcGUuJG9uKCckZGVzdHJveScsIHJlbW92ZVNjb3BlQmluZGluZ1dhdGNoZXMpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy8gSW5pdGlhbGl6ZSBiaW5kVG9Db250cm9sbGVyIGJpbmRpbmdzXG5cdCAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBlbGVtZW50Q29udHJvbGxlcnMpIHtcblx0ICAgICAgICAgIHZhciBjb250cm9sbGVyRGlyZWN0aXZlID0gY29udHJvbGxlckRpcmVjdGl2ZXNbbmFtZV07XG5cdCAgICAgICAgICB2YXIgY29udHJvbGxlciA9IGVsZW1lbnRDb250cm9sbGVyc1tuYW1lXTtcblx0ICAgICAgICAgIHZhciBiaW5kaW5ncyA9IGNvbnRyb2xsZXJEaXJlY3RpdmUuJCRiaW5kaW5ncy5iaW5kVG9Db250cm9sbGVyO1xuXHRcblx0ICAgICAgICAgIGlmIChjb250cm9sbGVyLmlkZW50aWZpZXIgJiYgYmluZGluZ3MpIHtcblx0ICAgICAgICAgICAgcmVtb3ZlQ29udHJvbGxlckJpbmRpbmdXYXRjaGVzID1cblx0ICAgICAgICAgICAgICBpbml0aWFsaXplRGlyZWN0aXZlQmluZGluZ3MoY29udHJvbGxlclNjb3BlLCBhdHRycywgY29udHJvbGxlci5pbnN0YW5jZSwgYmluZGluZ3MsIGNvbnRyb2xsZXJEaXJlY3RpdmUpO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIHZhciBjb250cm9sbGVyUmVzdWx0ID0gY29udHJvbGxlcigpO1xuXHQgICAgICAgICAgaWYgKGNvbnRyb2xsZXJSZXN1bHQgIT09IGNvbnRyb2xsZXIuaW5zdGFuY2UpIHtcblx0ICAgICAgICAgICAgLy8gSWYgdGhlIGNvbnRyb2xsZXIgY29uc3RydWN0b3IgaGFzIGEgcmV0dXJuIHZhbHVlLCBvdmVyd3JpdGUgdGhlIGluc3RhbmNlXG5cdCAgICAgICAgICAgIC8vIGZyb20gc2V0dXBDb250cm9sbGVyc1xuXHQgICAgICAgICAgICBjb250cm9sbGVyLmluc3RhbmNlID0gY29udHJvbGxlclJlc3VsdDtcblx0ICAgICAgICAgICAgJGVsZW1lbnQuZGF0YSgnJCcgKyBjb250cm9sbGVyRGlyZWN0aXZlLm5hbWUgKyAnQ29udHJvbGxlcicsIGNvbnRyb2xsZXJSZXN1bHQpO1xuXHQgICAgICAgICAgICByZW1vdmVDb250cm9sbGVyQmluZGluZ1dhdGNoZXMgJiYgcmVtb3ZlQ29udHJvbGxlckJpbmRpbmdXYXRjaGVzKCk7XG5cdCAgICAgICAgICAgIHJlbW92ZUNvbnRyb2xsZXJCaW5kaW5nV2F0Y2hlcyA9XG5cdCAgICAgICAgICAgICAgaW5pdGlhbGl6ZURpcmVjdGl2ZUJpbmRpbmdzKGNvbnRyb2xsZXJTY29wZSwgYXR0cnMsIGNvbnRyb2xsZXIuaW5zdGFuY2UsIGJpbmRpbmdzLCBjb250cm9sbGVyRGlyZWN0aXZlKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8vIEJpbmQgdGhlIHJlcXVpcmVkIGNvbnRyb2xsZXJzIHRvIHRoZSBjb250cm9sbGVyLCBpZiBgcmVxdWlyZWAgaXMgYW4gb2JqZWN0IGFuZCBgYmluZFRvQ29udHJvbGxlcmAgaXMgdHJ1dGh5XG5cdCAgICAgICAgZm9yRWFjaChjb250cm9sbGVyRGlyZWN0aXZlcywgZnVuY3Rpb24oY29udHJvbGxlckRpcmVjdGl2ZSwgbmFtZSkge1xuXHQgICAgICAgICAgdmFyIHJlcXVpcmUgPSBjb250cm9sbGVyRGlyZWN0aXZlLnJlcXVpcmU7XG5cdCAgICAgICAgICBpZiAoY29udHJvbGxlckRpcmVjdGl2ZS5iaW5kVG9Db250cm9sbGVyICYmICFpc0FycmF5KHJlcXVpcmUpICYmIGlzT2JqZWN0KHJlcXVpcmUpKSB7XG5cdCAgICAgICAgICAgIGV4dGVuZChlbGVtZW50Q29udHJvbGxlcnNbbmFtZV0uaW5zdGFuY2UsIGdldENvbnRyb2xsZXJzKG5hbWUsIHJlcXVpcmUsICRlbGVtZW50LCBlbGVtZW50Q29udHJvbGxlcnMpKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgLy8gVHJpZ2dlciB0aGUgYCRvbkluaXRgIG1ldGhvZCBvbiBhbGwgY29udHJvbGxlcnMgdGhhdCBoYXZlIG9uZVxuXHQgICAgICAgIGZvckVhY2goZWxlbWVudENvbnRyb2xsZXJzLCBmdW5jdGlvbihjb250cm9sbGVyKSB7XG5cdCAgICAgICAgICBpZiAoaXNGdW5jdGlvbihjb250cm9sbGVyLmluc3RhbmNlLiRvbkluaXQpKSB7XG5cdCAgICAgICAgICAgIGNvbnRyb2xsZXIuaW5zdGFuY2UuJG9uSW5pdCgpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAvLyBQUkVMSU5LSU5HXG5cdCAgICAgICAgZm9yIChpID0gMCwgaWkgPSBwcmVMaW5rRm5zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0ICAgICAgICAgIGxpbmtGbiA9IHByZUxpbmtGbnNbaV07XG5cdCAgICAgICAgICBpbnZva2VMaW5rRm4obGlua0ZuLFxuXHQgICAgICAgICAgICAgIGxpbmtGbi5pc29sYXRlU2NvcGUgPyBpc29sYXRlU2NvcGUgOiBzY29wZSxcblx0ICAgICAgICAgICAgICAkZWxlbWVudCxcblx0ICAgICAgICAgICAgICBhdHRycyxcblx0ICAgICAgICAgICAgICBsaW5rRm4ucmVxdWlyZSAmJiBnZXRDb250cm9sbGVycyhsaW5rRm4uZGlyZWN0aXZlTmFtZSwgbGlua0ZuLnJlcXVpcmUsICRlbGVtZW50LCBlbGVtZW50Q29udHJvbGxlcnMpLFxuXHQgICAgICAgICAgICAgIHRyYW5zY2x1ZGVGblxuXHQgICAgICAgICAgKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8vIFJFQ1VSU0lPTlxuXHQgICAgICAgIC8vIFdlIG9ubHkgcGFzcyB0aGUgaXNvbGF0ZSBzY29wZSwgaWYgdGhlIGlzb2xhdGUgZGlyZWN0aXZlIGhhcyBhIHRlbXBsYXRlLFxuXHQgICAgICAgIC8vIG90aGVyd2lzZSB0aGUgY2hpbGQgZWxlbWVudHMgZG8gbm90IGJlbG9uZyB0byB0aGUgaXNvbGF0ZSBkaXJlY3RpdmUuXG5cdCAgICAgICAgdmFyIHNjb3BlVG9DaGlsZCA9IHNjb3BlO1xuXHQgICAgICAgIGlmIChuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUgJiYgKG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZS50ZW1wbGF0ZSB8fCBuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUudGVtcGxhdGVVcmwgPT09IG51bGwpKSB7XG5cdCAgICAgICAgICBzY29wZVRvQ2hpbGQgPSBpc29sYXRlU2NvcGU7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGNoaWxkTGlua0ZuICYmIGNoaWxkTGlua0ZuKHNjb3BlVG9DaGlsZCwgbGlua05vZGUuY2hpbGROb2RlcywgdW5kZWZpbmVkLCBib3VuZFRyYW5zY2x1ZGVGbik7XG5cdFxuXHQgICAgICAgIC8vIFBPU1RMSU5LSU5HXG5cdCAgICAgICAgZm9yIChpID0gcG9zdExpbmtGbnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0ICAgICAgICAgIGxpbmtGbiA9IHBvc3RMaW5rRm5zW2ldO1xuXHQgICAgICAgICAgaW52b2tlTGlua0ZuKGxpbmtGbixcblx0ICAgICAgICAgICAgICBsaW5rRm4uaXNvbGF0ZVNjb3BlID8gaXNvbGF0ZVNjb3BlIDogc2NvcGUsXG5cdCAgICAgICAgICAgICAgJGVsZW1lbnQsXG5cdCAgICAgICAgICAgICAgYXR0cnMsXG5cdCAgICAgICAgICAgICAgbGlua0ZuLnJlcXVpcmUgJiYgZ2V0Q29udHJvbGxlcnMobGlua0ZuLmRpcmVjdGl2ZU5hbWUsIGxpbmtGbi5yZXF1aXJlLCAkZWxlbWVudCwgZWxlbWVudENvbnRyb2xsZXJzKSxcblx0ICAgICAgICAgICAgICB0cmFuc2NsdWRlRm5cblx0ICAgICAgICAgICk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvLyBUaGlzIGlzIHRoZSBmdW5jdGlvbiB0aGF0IGlzIGluamVjdGVkIGFzIGAkdHJhbnNjbHVkZWAuXG5cdCAgICAgICAgLy8gTm90ZTogYWxsIGFyZ3VtZW50cyBhcmUgb3B0aW9uYWwhXG5cdCAgICAgICAgZnVuY3Rpb24gY29udHJvbGxlcnNCb3VuZFRyYW5zY2x1ZGUoc2NvcGUsIGNsb25lQXR0YWNoRm4sIGZ1dHVyZVBhcmVudEVsZW1lbnQsIHNsb3ROYW1lKSB7XG5cdCAgICAgICAgICB2YXIgdHJhbnNjbHVkZUNvbnRyb2xsZXJzO1xuXHQgICAgICAgICAgLy8gTm8gc2NvcGUgcGFzc2VkIGluOlxuXHQgICAgICAgICAgaWYgKCFpc1Njb3BlKHNjb3BlKSkge1xuXHQgICAgICAgICAgICBzbG90TmFtZSA9IGZ1dHVyZVBhcmVudEVsZW1lbnQ7XG5cdCAgICAgICAgICAgIGZ1dHVyZVBhcmVudEVsZW1lbnQgPSBjbG9uZUF0dGFjaEZuO1xuXHQgICAgICAgICAgICBjbG9uZUF0dGFjaEZuID0gc2NvcGU7XG5cdCAgICAgICAgICAgIHNjb3BlID0gdW5kZWZpbmVkO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIGlmIChoYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSkge1xuXHQgICAgICAgICAgICB0cmFuc2NsdWRlQ29udHJvbGxlcnMgPSBlbGVtZW50Q29udHJvbGxlcnM7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBpZiAoIWZ1dHVyZVBhcmVudEVsZW1lbnQpIHtcblx0ICAgICAgICAgICAgZnV0dXJlUGFyZW50RWxlbWVudCA9IGhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlID8gJGVsZW1lbnQucGFyZW50KCkgOiAkZWxlbWVudDtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGlmIChzbG90TmFtZSkge1xuXHQgICAgICAgICAgICAvLyBzbG90VHJhbnNjbHVkZUZuIGNhbiBiZSBvbmUgb2YgdGhyZWUgdGhpbmdzOlxuXHQgICAgICAgICAgICAvLyAgKiBhIHRyYW5zY2x1ZGUgZnVuY3Rpb24gLSBhIGZpbGxlZCBzbG90XG5cdCAgICAgICAgICAgIC8vICAqIGBudWxsYCAtIGFuIG9wdGlvbmFsIHNsb3QgdGhhdCB3YXMgbm90IGZpbGxlZFxuXHQgICAgICAgICAgICAvLyAgKiBgdW5kZWZpbmVkYCAtIGEgc2xvdCB0aGF0IHdhcyBub3QgZGVjbGFyZWQgKGkuZS4gaW52YWxpZClcblx0ICAgICAgICAgICAgdmFyIHNsb3RUcmFuc2NsdWRlRm4gPSBib3VuZFRyYW5zY2x1ZGVGbi4kJHNsb3RzW3Nsb3ROYW1lXTtcblx0ICAgICAgICAgICAgaWYgKHNsb3RUcmFuc2NsdWRlRm4pIHtcblx0ICAgICAgICAgICAgICByZXR1cm4gc2xvdFRyYW5zY2x1ZGVGbihzY29wZSwgY2xvbmVBdHRhY2hGbiwgdHJhbnNjbHVkZUNvbnRyb2xsZXJzLCBmdXR1cmVQYXJlbnRFbGVtZW50LCBzY29wZVRvQ2hpbGQpO1xuXHQgICAgICAgICAgICB9IGVsc2UgaWYgKGlzVW5kZWZpbmVkKHNsb3RUcmFuc2NsdWRlRm4pKSB7XG5cdCAgICAgICAgICAgICAgdGhyb3cgJGNvbXBpbGVNaW5FcnIoJ25vc2xvdCcsXG5cdCAgICAgICAgICAgICAgICdObyBwYXJlbnQgZGlyZWN0aXZlIHRoYXQgcmVxdWlyZXMgYSB0cmFuc2NsdXNpb24gd2l0aCBzbG90IG5hbWUgXCJ7MH1cIi4gJyArXG5cdCAgICAgICAgICAgICAgICdFbGVtZW50OiB7MX0nLFxuXHQgICAgICAgICAgICAgICBzbG90TmFtZSwgc3RhcnRpbmdUYWcoJGVsZW1lbnQpKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGJvdW5kVHJhbnNjbHVkZUZuKHNjb3BlLCBjbG9uZUF0dGFjaEZuLCB0cmFuc2NsdWRlQ29udHJvbGxlcnMsIGZ1dHVyZVBhcmVudEVsZW1lbnQsIHNjb3BlVG9DaGlsZCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgLy8gRGVwZW5kaW5nIHVwb24gdGhlIGNvbnRleHQgaW4gd2hpY2ggYSBkaXJlY3RpdmUgZmluZHMgaXRzZWxmIGl0IG1pZ2h0IG5lZWQgdG8gaGF2ZSBhIG5ldyBpc29sYXRlZFxuXHQgICAgLy8gb3IgY2hpbGQgc2NvcGUgY3JlYXRlZC4gRm9yIGluc3RhbmNlOlxuXHQgICAgLy8gKiBpZiB0aGUgZGlyZWN0aXZlIGhhcyBiZWVuIHB1bGxlZCBpbnRvIGEgdGVtcGxhdGUgYmVjYXVzZSBhbm90aGVyIGRpcmVjdGl2ZSB3aXRoIGEgaGlnaGVyIHByaW9yaXR5XG5cdCAgICAvLyBhc2tlZCBmb3IgZWxlbWVudCB0cmFuc2NsdXNpb25cblx0ICAgIC8vICogaWYgdGhlIGRpcmVjdGl2ZSBpdHNlbGYgYXNrcyBmb3IgdHJhbnNjbHVzaW9uIGJ1dCBpdCBpcyBhdCB0aGUgcm9vdCBvZiBhIHRlbXBsYXRlIGFuZCB0aGUgb3JpZ2luYWxcblx0ICAgIC8vIGVsZW1lbnQgd2FzIHJlcGxhY2VkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy9pc3N1ZXMvMTI5MzZcblx0ICAgIGZ1bmN0aW9uIG1hcmtEaXJlY3RpdmVTY29wZShkaXJlY3RpdmVzLCBpc29sYXRlU2NvcGUsIG5ld1Njb3BlKSB7XG5cdCAgICAgIGZvciAodmFyIGogPSAwLCBqaiA9IGRpcmVjdGl2ZXMubGVuZ3RoOyBqIDwgamo7IGorKykge1xuXHQgICAgICAgIGRpcmVjdGl2ZXNbal0gPSBpbmhlcml0KGRpcmVjdGl2ZXNbal0sIHskJGlzb2xhdGVTY29wZTogaXNvbGF0ZVNjb3BlLCAkJG5ld1Njb3BlOiBuZXdTY29wZX0pO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBsb29rcyB1cCB0aGUgZGlyZWN0aXZlIGFuZCBkZWNvcmF0ZXMgaXQgd2l0aCBleGNlcHRpb24gaGFuZGxpbmcgYW5kIHByb3BlciBwYXJhbWV0ZXJzLiBXZVxuXHQgICAgICogY2FsbCB0aGlzIHRoZSBib3VuZERpcmVjdGl2ZS5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBuYW1lIG9mIHRoZSBkaXJlY3RpdmUgdG8gbG9vayB1cC5cblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsb2NhdGlvbiBUaGUgZGlyZWN0aXZlIG11c3QgYmUgZm91bmQgaW4gc3BlY2lmaWMgZm9ybWF0LlxuXHQgICAgICogICBTdHJpbmcgY29udGFpbmluZyBhbnkgb2YgdGhlc2VzIGNoYXJhY3RlcnM6XG5cdCAgICAgKlxuXHQgICAgICogICAqIGBFYDogZWxlbWVudCBuYW1lXG5cdCAgICAgKiAgICogYEEnOiBhdHRyaWJ1dGVcblx0ICAgICAqICAgKiBgQ2A6IGNsYXNzXG5cdCAgICAgKiAgICogYE1gOiBjb21tZW50XG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpZiBkaXJlY3RpdmUgd2FzIGFkZGVkLlxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBhZGREaXJlY3RpdmUodERpcmVjdGl2ZXMsIG5hbWUsIGxvY2F0aW9uLCBtYXhQcmlvcml0eSwgaWdub3JlRGlyZWN0aXZlLCBzdGFydEF0dHJOYW1lLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZEF0dHJOYW1lKSB7XG5cdCAgICAgIGlmIChuYW1lID09PSBpZ25vcmVEaXJlY3RpdmUpIHJldHVybiBudWxsO1xuXHQgICAgICB2YXIgbWF0Y2ggPSBudWxsO1xuXHQgICAgICBpZiAoaGFzRGlyZWN0aXZlcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuXHQgICAgICAgIGZvciAodmFyIGRpcmVjdGl2ZSwgZGlyZWN0aXZlcyA9ICRpbmplY3Rvci5nZXQobmFtZSArIFN1ZmZpeCksXG5cdCAgICAgICAgICAgIGkgPSAwLCBpaSA9IGRpcmVjdGl2ZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHQgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgZGlyZWN0aXZlID0gZGlyZWN0aXZlc1tpXTtcblx0ICAgICAgICAgICAgaWYgKChpc1VuZGVmaW5lZChtYXhQcmlvcml0eSkgfHwgbWF4UHJpb3JpdHkgPiBkaXJlY3RpdmUucHJpb3JpdHkpICYmXG5cdCAgICAgICAgICAgICAgICAgZGlyZWN0aXZlLnJlc3RyaWN0LmluZGV4T2YobG9jYXRpb24pICE9IC0xKSB7XG5cdCAgICAgICAgICAgICAgaWYgKHN0YXJ0QXR0ck5hbWUpIHtcblx0ICAgICAgICAgICAgICAgIGRpcmVjdGl2ZSA9IGluaGVyaXQoZGlyZWN0aXZlLCB7JCRzdGFydDogc3RhcnRBdHRyTmFtZSwgJCRlbmQ6IGVuZEF0dHJOYW1lfSk7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIHREaXJlY3RpdmVzLnB1c2goZGlyZWN0aXZlKTtcblx0ICAgICAgICAgICAgICBtYXRjaCA9IGRpcmVjdGl2ZTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSBjYXRjaCAoZSkgeyAkZXhjZXB0aW9uSGFuZGxlcihlKTsgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gbWF0Y2g7XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogbG9va3MgdXAgdGhlIGRpcmVjdGl2ZSBhbmQgcmV0dXJucyB0cnVlIGlmIGl0IGlzIGEgbXVsdGktZWxlbWVudCBkaXJlY3RpdmUsXG5cdCAgICAgKiBhbmQgdGhlcmVmb3JlIHJlcXVpcmVzIERPTSBub2RlcyBiZXR3ZWVuIC1zdGFydCBhbmQgLWVuZCBtYXJrZXJzIHRvIGJlIGdyb3VwZWRcblx0ICAgICAqIHRvZ2V0aGVyLlxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIG5hbWUgb2YgdGhlIGRpcmVjdGl2ZSB0byBsb29rIHVwLlxuXHQgICAgICogQHJldHVybnMgdHJ1ZSBpZiBkaXJlY3RpdmUgd2FzIHJlZ2lzdGVyZWQgYXMgbXVsdGktZWxlbWVudC5cblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gZGlyZWN0aXZlSXNNdWx0aUVsZW1lbnQobmFtZSkge1xuXHQgICAgICBpZiAoaGFzRGlyZWN0aXZlcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuXHQgICAgICAgIGZvciAodmFyIGRpcmVjdGl2ZSwgZGlyZWN0aXZlcyA9ICRpbmplY3Rvci5nZXQobmFtZSArIFN1ZmZpeCksXG5cdCAgICAgICAgICAgIGkgPSAwLCBpaSA9IGRpcmVjdGl2ZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHQgICAgICAgICAgZGlyZWN0aXZlID0gZGlyZWN0aXZlc1tpXTtcblx0ICAgICAgICAgIGlmIChkaXJlY3RpdmUubXVsdGlFbGVtZW50KSB7XG5cdCAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBXaGVuIHRoZSBlbGVtZW50IGlzIHJlcGxhY2VkIHdpdGggSFRNTCB0ZW1wbGF0ZSB0aGVuIHRoZSBuZXcgYXR0cmlidXRlc1xuXHQgICAgICogb24gdGhlIHRlbXBsYXRlIG5lZWQgdG8gYmUgbWVyZ2VkIHdpdGggdGhlIGV4aXN0aW5nIGF0dHJpYnV0ZXMgaW4gdGhlIERPTS5cblx0ICAgICAqIFRoZSBkZXNpcmVkIGVmZmVjdCBpcyB0byBoYXZlIGJvdGggb2YgdGhlIGF0dHJpYnV0ZXMgcHJlc2VudC5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge29iamVjdH0gZHN0IGRlc3RpbmF0aW9uIGF0dHJpYnV0ZXMgKG9yaWdpbmFsIERPTSlcblx0ICAgICAqIEBwYXJhbSB7b2JqZWN0fSBzcmMgc291cmNlIGF0dHJpYnV0ZXMgKGZyb20gdGhlIGRpcmVjdGl2ZSB0ZW1wbGF0ZSlcblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gbWVyZ2VUZW1wbGF0ZUF0dHJpYnV0ZXMoZHN0LCBzcmMpIHtcblx0ICAgICAgdmFyIHNyY0F0dHIgPSBzcmMuJGF0dHIsXG5cdCAgICAgICAgICBkc3RBdHRyID0gZHN0LiRhdHRyLFxuXHQgICAgICAgICAgJGVsZW1lbnQgPSBkc3QuJCRlbGVtZW50O1xuXHRcblx0ICAgICAgLy8gcmVhcHBseSB0aGUgb2xkIGF0dHJpYnV0ZXMgdG8gdGhlIG5ldyBlbGVtZW50XG5cdCAgICAgIGZvckVhY2goZHN0LCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG5cdCAgICAgICAgaWYgKGtleS5jaGFyQXQoMCkgIT0gJyQnKSB7XG5cdCAgICAgICAgICBpZiAoc3JjW2tleV0gJiYgc3JjW2tleV0gIT09IHZhbHVlKSB7XG5cdCAgICAgICAgICAgIHZhbHVlICs9IChrZXkgPT09ICdzdHlsZScgPyAnOycgOiAnICcpICsgc3JjW2tleV07XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBkc3QuJHNldChrZXksIHZhbHVlLCB0cnVlLCBzcmNBdHRyW2tleV0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICAvLyBjb3B5IHRoZSBuZXcgYXR0cmlidXRlcyBvbiB0aGUgb2xkIGF0dHJzIG9iamVjdFxuXHQgICAgICBmb3JFYWNoKHNyYywgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuXHQgICAgICAgIGlmIChrZXkgPT0gJ2NsYXNzJykge1xuXHQgICAgICAgICAgc2FmZUFkZENsYXNzKCRlbGVtZW50LCB2YWx1ZSk7XG5cdCAgICAgICAgICBkc3RbJ2NsYXNzJ10gPSAoZHN0WydjbGFzcyddID8gZHN0WydjbGFzcyddICsgJyAnIDogJycpICsgdmFsdWU7XG5cdCAgICAgICAgfSBlbHNlIGlmIChrZXkgPT0gJ3N0eWxlJykge1xuXHQgICAgICAgICAgJGVsZW1lbnQuYXR0cignc3R5bGUnLCAkZWxlbWVudC5hdHRyKCdzdHlsZScpICsgJzsnICsgdmFsdWUpO1xuXHQgICAgICAgICAgZHN0WydzdHlsZSddID0gKGRzdFsnc3R5bGUnXSA/IGRzdFsnc3R5bGUnXSArICc7JyA6ICcnKSArIHZhbHVlO1xuXHQgICAgICAgICAgLy8gYGRzdGAgd2lsbCBuZXZlciBjb250YWluIGhhc093blByb3BlcnR5IGFzIERPTSBwYXJzZXIgd29uJ3QgbGV0IGl0LlxuXHQgICAgICAgICAgLy8gWW91IHdpbGwgZ2V0IGFuIFwiSW52YWxpZENoYXJhY3RlckVycm9yOiBET00gRXhjZXB0aW9uIDVcIiBlcnJvciBpZiB5b3Vcblx0ICAgICAgICAgIC8vIGhhdmUgYW4gYXR0cmlidXRlIGxpa2UgXCJoYXMtb3duLXByb3BlcnR5XCIgb3IgXCJkYXRhLWhhcy1vd24tcHJvcGVydHlcIiwgZXRjLlxuXHQgICAgICAgIH0gZWxzZSBpZiAoa2V5LmNoYXJBdCgwKSAhPSAnJCcgJiYgIWRzdC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdCAgICAgICAgICBkc3Rba2V5XSA9IHZhbHVlO1xuXHQgICAgICAgICAgZHN0QXR0cltrZXldID0gc3JjQXR0cltrZXldO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIGZ1bmN0aW9uIGNvbXBpbGVUZW1wbGF0ZVVybChkaXJlY3RpdmVzLCAkY29tcGlsZU5vZGUsIHRBdHRycyxcblx0ICAgICAgICAkcm9vdEVsZW1lbnQsIGNoaWxkVHJhbnNjbHVkZUZuLCBwcmVMaW5rRm5zLCBwb3N0TGlua0ZucywgcHJldmlvdXNDb21waWxlQ29udGV4dCkge1xuXHQgICAgICB2YXIgbGlua1F1ZXVlID0gW10sXG5cdCAgICAgICAgICBhZnRlclRlbXBsYXRlTm9kZUxpbmtGbixcblx0ICAgICAgICAgIGFmdGVyVGVtcGxhdGVDaGlsZExpbmtGbixcblx0ICAgICAgICAgIGJlZm9yZVRlbXBsYXRlQ29tcGlsZU5vZGUgPSAkY29tcGlsZU5vZGVbMF0sXG5cdCAgICAgICAgICBvcmlnQXN5bmNEaXJlY3RpdmUgPSBkaXJlY3RpdmVzLnNoaWZ0KCksXG5cdCAgICAgICAgICBkZXJpdmVkU3luY0RpcmVjdGl2ZSA9IGluaGVyaXQob3JpZ0FzeW5jRGlyZWN0aXZlLCB7XG5cdCAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBudWxsLCB0cmFuc2NsdWRlOiBudWxsLCByZXBsYWNlOiBudWxsLCAkJG9yaWdpbmFsRGlyZWN0aXZlOiBvcmlnQXN5bmNEaXJlY3RpdmVcblx0ICAgICAgICAgIH0pLFxuXHQgICAgICAgICAgdGVtcGxhdGVVcmwgPSAoaXNGdW5jdGlvbihvcmlnQXN5bmNEaXJlY3RpdmUudGVtcGxhdGVVcmwpKVxuXHQgICAgICAgICAgICAgID8gb3JpZ0FzeW5jRGlyZWN0aXZlLnRlbXBsYXRlVXJsKCRjb21waWxlTm9kZSwgdEF0dHJzKVxuXHQgICAgICAgICAgICAgIDogb3JpZ0FzeW5jRGlyZWN0aXZlLnRlbXBsYXRlVXJsLFxuXHQgICAgICAgICAgdGVtcGxhdGVOYW1lc3BhY2UgPSBvcmlnQXN5bmNEaXJlY3RpdmUudGVtcGxhdGVOYW1lc3BhY2U7XG5cdFxuXHQgICAgICAkY29tcGlsZU5vZGUuZW1wdHkoKTtcblx0XG5cdCAgICAgICR0ZW1wbGF0ZVJlcXVlc3QodGVtcGxhdGVVcmwpXG5cdCAgICAgICAgLnRoZW4oZnVuY3Rpb24oY29udGVudCkge1xuXHQgICAgICAgICAgdmFyIGNvbXBpbGVOb2RlLCB0ZW1wVGVtcGxhdGVBdHRycywgJHRlbXBsYXRlLCBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuO1xuXHRcblx0ICAgICAgICAgIGNvbnRlbnQgPSBkZW5vcm1hbGl6ZVRlbXBsYXRlKGNvbnRlbnQpO1xuXHRcblx0ICAgICAgICAgIGlmIChvcmlnQXN5bmNEaXJlY3RpdmUucmVwbGFjZSkge1xuXHQgICAgICAgICAgICBpZiAoanFMaXRlSXNUZXh0Tm9kZShjb250ZW50KSkge1xuXHQgICAgICAgICAgICAgICR0ZW1wbGF0ZSA9IFtdO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICR0ZW1wbGF0ZSA9IHJlbW92ZUNvbW1lbnRzKHdyYXBUZW1wbGF0ZSh0ZW1wbGF0ZU5hbWVzcGFjZSwgdHJpbShjb250ZW50KSkpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGNvbXBpbGVOb2RlID0gJHRlbXBsYXRlWzBdO1xuXHRcblx0ICAgICAgICAgICAgaWYgKCR0ZW1wbGF0ZS5sZW5ndGggIT0gMSB8fCBjb21waWxlTm9kZS5ub2RlVHlwZSAhPT0gTk9ERV9UWVBFX0VMRU1FTlQpIHtcblx0ICAgICAgICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycigndHBscnQnLFxuXHQgICAgICAgICAgICAgICAgICBcIlRlbXBsYXRlIGZvciBkaXJlY3RpdmUgJ3swfScgbXVzdCBoYXZlIGV4YWN0bHkgb25lIHJvb3QgZWxlbWVudC4gezF9XCIsXG5cdCAgICAgICAgICAgICAgICAgIG9yaWdBc3luY0RpcmVjdGl2ZS5uYW1lLCB0ZW1wbGF0ZVVybCk7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHRlbXBUZW1wbGF0ZUF0dHJzID0geyRhdHRyOiB7fX07XG5cdCAgICAgICAgICAgIHJlcGxhY2VXaXRoKCRyb290RWxlbWVudCwgJGNvbXBpbGVOb2RlLCBjb21waWxlTm9kZSk7XG5cdCAgICAgICAgICAgIHZhciB0ZW1wbGF0ZURpcmVjdGl2ZXMgPSBjb2xsZWN0RGlyZWN0aXZlcyhjb21waWxlTm9kZSwgW10sIHRlbXBUZW1wbGF0ZUF0dHJzKTtcblx0XG5cdCAgICAgICAgICAgIGlmIChpc09iamVjdChvcmlnQXN5bmNEaXJlY3RpdmUuc2NvcGUpKSB7XG5cdCAgICAgICAgICAgICAgLy8gdGhlIG9yaWdpbmFsIGRpcmVjdGl2ZSB0aGF0IGNhdXNlZCB0aGUgdGVtcGxhdGUgdG8gYmUgbG9hZGVkIGFzeW5jIHJlcXVpcmVkXG5cdCAgICAgICAgICAgICAgLy8gYW4gaXNvbGF0ZSBzY29wZVxuXHQgICAgICAgICAgICAgIG1hcmtEaXJlY3RpdmVTY29wZSh0ZW1wbGF0ZURpcmVjdGl2ZXMsIHRydWUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGRpcmVjdGl2ZXMgPSB0ZW1wbGF0ZURpcmVjdGl2ZXMuY29uY2F0KGRpcmVjdGl2ZXMpO1xuXHQgICAgICAgICAgICBtZXJnZVRlbXBsYXRlQXR0cmlidXRlcyh0QXR0cnMsIHRlbXBUZW1wbGF0ZUF0dHJzKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGNvbXBpbGVOb2RlID0gYmVmb3JlVGVtcGxhdGVDb21waWxlTm9kZTtcblx0ICAgICAgICAgICAgJGNvbXBpbGVOb2RlLmh0bWwoY29udGVudCk7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgZGlyZWN0aXZlcy51bnNoaWZ0KGRlcml2ZWRTeW5jRGlyZWN0aXZlKTtcblx0XG5cdCAgICAgICAgICBhZnRlclRlbXBsYXRlTm9kZUxpbmtGbiA9IGFwcGx5RGlyZWN0aXZlc1RvTm9kZShkaXJlY3RpdmVzLCBjb21waWxlTm9kZSwgdEF0dHJzLFxuXHQgICAgICAgICAgICAgIGNoaWxkVHJhbnNjbHVkZUZuLCAkY29tcGlsZU5vZGUsIG9yaWdBc3luY0RpcmVjdGl2ZSwgcHJlTGlua0ZucywgcG9zdExpbmtGbnMsXG5cdCAgICAgICAgICAgICAgcHJldmlvdXNDb21waWxlQ29udGV4dCk7XG5cdCAgICAgICAgICBmb3JFYWNoKCRyb290RWxlbWVudCwgZnVuY3Rpb24obm9kZSwgaSkge1xuXHQgICAgICAgICAgICBpZiAobm9kZSA9PSBjb21waWxlTm9kZSkge1xuXHQgICAgICAgICAgICAgICRyb290RWxlbWVudFtpXSA9ICRjb21waWxlTm9kZVswXTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgICBhZnRlclRlbXBsYXRlQ2hpbGRMaW5rRm4gPSBjb21waWxlTm9kZXMoJGNvbXBpbGVOb2RlWzBdLmNoaWxkTm9kZXMsIGNoaWxkVHJhbnNjbHVkZUZuKTtcblx0XG5cdCAgICAgICAgICB3aGlsZSAobGlua1F1ZXVlLmxlbmd0aCkge1xuXHQgICAgICAgICAgICB2YXIgc2NvcGUgPSBsaW5rUXVldWUuc2hpZnQoKSxcblx0ICAgICAgICAgICAgICAgIGJlZm9yZVRlbXBsYXRlTGlua05vZGUgPSBsaW5rUXVldWUuc2hpZnQoKSxcblx0ICAgICAgICAgICAgICAgIGxpbmtSb290RWxlbWVudCA9IGxpbmtRdWV1ZS5zaGlmdCgpLFxuXHQgICAgICAgICAgICAgICAgYm91bmRUcmFuc2NsdWRlRm4gPSBsaW5rUXVldWUuc2hpZnQoKSxcblx0ICAgICAgICAgICAgICAgIGxpbmtOb2RlID0gJGNvbXBpbGVOb2RlWzBdO1xuXHRcblx0ICAgICAgICAgICAgaWYgKHNjb3BlLiQkZGVzdHJveWVkKSBjb250aW51ZTtcblx0XG5cdCAgICAgICAgICAgIGlmIChiZWZvcmVUZW1wbGF0ZUxpbmtOb2RlICE9PSBiZWZvcmVUZW1wbGF0ZUNvbXBpbGVOb2RlKSB7XG5cdCAgICAgICAgICAgICAgdmFyIG9sZENsYXNzZXMgPSBiZWZvcmVUZW1wbGF0ZUxpbmtOb2RlLmNsYXNzTmFtZTtcblx0XG5cdCAgICAgICAgICAgICAgaWYgKCEocHJldmlvdXNDb21waWxlQ29udGV4dC5oYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSAmJlxuXHQgICAgICAgICAgICAgICAgICBvcmlnQXN5bmNEaXJlY3RpdmUucmVwbGFjZSkpIHtcblx0ICAgICAgICAgICAgICAgIC8vIGl0IHdhcyBjbG9uZWQgdGhlcmVmb3JlIHdlIGhhdmUgdG8gY2xvbmUgYXMgd2VsbC5cblx0ICAgICAgICAgICAgICAgIGxpbmtOb2RlID0ganFMaXRlQ2xvbmUoY29tcGlsZU5vZGUpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICByZXBsYWNlV2l0aChsaW5rUm9vdEVsZW1lbnQsIGpxTGl0ZShiZWZvcmVUZW1wbGF0ZUxpbmtOb2RlKSwgbGlua05vZGUpO1xuXHRcblx0ICAgICAgICAgICAgICAvLyBDb3B5IGluIENTUyBjbGFzc2VzIGZyb20gb3JpZ2luYWwgbm9kZVxuXHQgICAgICAgICAgICAgIHNhZmVBZGRDbGFzcyhqcUxpdGUobGlua05vZGUpLCBvbGRDbGFzc2VzKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBpZiAoYWZ0ZXJUZW1wbGF0ZU5vZGVMaW5rRm4udHJhbnNjbHVkZU9uVGhpc0VsZW1lbnQpIHtcblx0ICAgICAgICAgICAgICBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuID0gY3JlYXRlQm91bmRUcmFuc2NsdWRlRm4oc2NvcGUsIGFmdGVyVGVtcGxhdGVOb2RlTGlua0ZuLnRyYW5zY2x1ZGUsIGJvdW5kVHJhbnNjbHVkZUZuKTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuID0gYm91bmRUcmFuc2NsdWRlRm47XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgYWZ0ZXJUZW1wbGF0ZU5vZGVMaW5rRm4oYWZ0ZXJUZW1wbGF0ZUNoaWxkTGlua0ZuLCBzY29wZSwgbGlua05vZGUsICRyb290RWxlbWVudCxcblx0ICAgICAgICAgICAgICBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGxpbmtRdWV1ZSA9IG51bGw7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gZGVsYXllZE5vZGVMaW5rRm4oaWdub3JlQ2hpbGRMaW5rRm4sIHNjb3BlLCBub2RlLCByb290RWxlbWVudCwgYm91bmRUcmFuc2NsdWRlRm4pIHtcblx0ICAgICAgICB2YXIgY2hpbGRCb3VuZFRyYW5zY2x1ZGVGbiA9IGJvdW5kVHJhbnNjbHVkZUZuO1xuXHQgICAgICAgIGlmIChzY29wZS4kJGRlc3Ryb3llZCkgcmV0dXJuO1xuXHQgICAgICAgIGlmIChsaW5rUXVldWUpIHtcblx0ICAgICAgICAgIGxpbmtRdWV1ZS5wdXNoKHNjb3BlLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRCb3VuZFRyYW5zY2x1ZGVGbik7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGlmIChhZnRlclRlbXBsYXRlTm9kZUxpbmtGbi50cmFuc2NsdWRlT25UaGlzRWxlbWVudCkge1xuXHQgICAgICAgICAgICBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuID0gY3JlYXRlQm91bmRUcmFuc2NsdWRlRm4oc2NvcGUsIGFmdGVyVGVtcGxhdGVOb2RlTGlua0ZuLnRyYW5zY2x1ZGUsIGJvdW5kVHJhbnNjbHVkZUZuKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGFmdGVyVGVtcGxhdGVOb2RlTGlua0ZuKGFmdGVyVGVtcGxhdGVDaGlsZExpbmtGbiwgc2NvcGUsIG5vZGUsIHJvb3RFbGVtZW50LCBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU29ydGluZyBmdW5jdGlvbiBmb3IgYm91bmQgZGlyZWN0aXZlcy5cblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gYnlQcmlvcml0eShhLCBiKSB7XG5cdCAgICAgIHZhciBkaWZmID0gYi5wcmlvcml0eSAtIGEucHJpb3JpdHk7XG5cdCAgICAgIGlmIChkaWZmICE9PSAwKSByZXR1cm4gZGlmZjtcblx0ICAgICAgaWYgKGEubmFtZSAhPT0gYi5uYW1lKSByZXR1cm4gKGEubmFtZSA8IGIubmFtZSkgPyAtMSA6IDE7XG5cdCAgICAgIHJldHVybiBhLmluZGV4IC0gYi5pbmRleDtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBhc3NlcnROb0R1cGxpY2F0ZSh3aGF0LCBwcmV2aW91c0RpcmVjdGl2ZSwgZGlyZWN0aXZlLCBlbGVtZW50KSB7XG5cdFxuXHQgICAgICBmdW5jdGlvbiB3cmFwTW9kdWxlTmFtZUlmRGVmaW5lZChtb2R1bGVOYW1lKSB7XG5cdCAgICAgICAgcmV0dXJuIG1vZHVsZU5hbWUgP1xuXHQgICAgICAgICAgKCcgKG1vZHVsZTogJyArIG1vZHVsZU5hbWUgKyAnKScpIDpcblx0ICAgICAgICAgICcnO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBpZiAocHJldmlvdXNEaXJlY3RpdmUpIHtcblx0ICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycignbXVsdGlkaXInLCAnTXVsdGlwbGUgZGlyZWN0aXZlcyBbezB9ezF9LCB7Mn17M31dIGFza2luZyBmb3IgezR9IG9uOiB7NX0nLFxuXHQgICAgICAgICAgICBwcmV2aW91c0RpcmVjdGl2ZS5uYW1lLCB3cmFwTW9kdWxlTmFtZUlmRGVmaW5lZChwcmV2aW91c0RpcmVjdGl2ZS4kJG1vZHVsZU5hbWUpLFxuXHQgICAgICAgICAgICBkaXJlY3RpdmUubmFtZSwgd3JhcE1vZHVsZU5hbWVJZkRlZmluZWQoZGlyZWN0aXZlLiQkbW9kdWxlTmFtZSksIHdoYXQsIHN0YXJ0aW5nVGFnKGVsZW1lbnQpKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0XG5cdCAgICBmdW5jdGlvbiBhZGRUZXh0SW50ZXJwb2xhdGVEaXJlY3RpdmUoZGlyZWN0aXZlcywgdGV4dCkge1xuXHQgICAgICB2YXIgaW50ZXJwb2xhdGVGbiA9ICRpbnRlcnBvbGF0ZSh0ZXh0LCB0cnVlKTtcblx0ICAgICAgaWYgKGludGVycG9sYXRlRm4pIHtcblx0ICAgICAgICBkaXJlY3RpdmVzLnB1c2goe1xuXHQgICAgICAgICAgcHJpb3JpdHk6IDAsXG5cdCAgICAgICAgICBjb21waWxlOiBmdW5jdGlvbiB0ZXh0SW50ZXJwb2xhdGVDb21waWxlRm4odGVtcGxhdGVOb2RlKSB7XG5cdCAgICAgICAgICAgIHZhciB0ZW1wbGF0ZU5vZGVQYXJlbnQgPSB0ZW1wbGF0ZU5vZGUucGFyZW50KCksXG5cdCAgICAgICAgICAgICAgICBoYXNDb21waWxlUGFyZW50ID0gISF0ZW1wbGF0ZU5vZGVQYXJlbnQubGVuZ3RoO1xuXHRcblx0ICAgICAgICAgICAgLy8gV2hlbiB0cmFuc2NsdWRpbmcgYSB0ZW1wbGF0ZSB0aGF0IGhhcyBiaW5kaW5ncyBpbiB0aGUgcm9vdFxuXHQgICAgICAgICAgICAvLyB3ZSBkb24ndCBoYXZlIGEgcGFyZW50IGFuZCB0aHVzIG5lZWQgdG8gYWRkIHRoZSBjbGFzcyBkdXJpbmcgbGlua2luZyBmbi5cblx0ICAgICAgICAgICAgaWYgKGhhc0NvbXBpbGVQYXJlbnQpIGNvbXBpbGUuJCRhZGRCaW5kaW5nQ2xhc3ModGVtcGxhdGVOb2RlUGFyZW50KTtcblx0XG5cdCAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiB0ZXh0SW50ZXJwb2xhdGVMaW5rRm4oc2NvcGUsIG5vZGUpIHtcblx0ICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5wYXJlbnQoKTtcblx0ICAgICAgICAgICAgICBpZiAoIWhhc0NvbXBpbGVQYXJlbnQpIGNvbXBpbGUuJCRhZGRCaW5kaW5nQ2xhc3MocGFyZW50KTtcblx0ICAgICAgICAgICAgICBjb21waWxlLiQkYWRkQmluZGluZ0luZm8ocGFyZW50LCBpbnRlcnBvbGF0ZUZuLmV4cHJlc3Npb25zKTtcblx0ICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goaW50ZXJwb2xhdGVGbiwgZnVuY3Rpb24gaW50ZXJwb2xhdGVGbldhdGNoQWN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgICBub2RlWzBdLm5vZGVWYWx1ZSA9IHZhbHVlO1xuXHQgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIGZ1bmN0aW9uIHdyYXBUZW1wbGF0ZSh0eXBlLCB0ZW1wbGF0ZSkge1xuXHQgICAgICB0eXBlID0gbG93ZXJjYXNlKHR5cGUgfHwgJ2h0bWwnKTtcblx0ICAgICAgc3dpdGNoICh0eXBlKSB7XG5cdCAgICAgIGNhc2UgJ3N2Zyc6XG5cdCAgICAgIGNhc2UgJ21hdGgnOlxuXHQgICAgICAgIHZhciB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdCAgICAgICAgd3JhcHBlci5pbm5lckhUTUwgPSAnPCcgKyB0eXBlICsgJz4nICsgdGVtcGxhdGUgKyAnPC8nICsgdHlwZSArICc+Jztcblx0ICAgICAgICByZXR1cm4gd3JhcHBlci5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXM7XG5cdCAgICAgIGRlZmF1bHQ6XG5cdCAgICAgICAgcmV0dXJuIHRlbXBsYXRlO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIGZ1bmN0aW9uIGdldFRydXN0ZWRDb250ZXh0KG5vZGUsIGF0dHJOb3JtYWxpemVkTmFtZSkge1xuXHQgICAgICBpZiAoYXR0ck5vcm1hbGl6ZWROYW1lID09IFwic3JjZG9jXCIpIHtcblx0ICAgICAgICByZXR1cm4gJHNjZS5IVE1MO1xuXHQgICAgICB9XG5cdCAgICAgIHZhciB0YWcgPSBub2RlTmFtZV8obm9kZSk7XG5cdCAgICAgIC8vIG1hY3Rpb25beGxpbms6aHJlZl0gY2FuIHNvdXJjZSBTVkcuICBJdCdzIG5vdCBsaW1pdGVkIHRvIDxtYWN0aW9uPi5cblx0ICAgICAgaWYgKGF0dHJOb3JtYWxpemVkTmFtZSA9PSBcInhsaW5rSHJlZlwiIHx8XG5cdCAgICAgICAgICAodGFnID09IFwiZm9ybVwiICYmIGF0dHJOb3JtYWxpemVkTmFtZSA9PSBcImFjdGlvblwiKSB8fFxuXHQgICAgICAgICAgKHRhZyAhPSBcImltZ1wiICYmIChhdHRyTm9ybWFsaXplZE5hbWUgPT0gXCJzcmNcIiB8fFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0ck5vcm1hbGl6ZWROYW1lID09IFwibmdTcmNcIikpKSB7XG5cdCAgICAgICAgcmV0dXJuICRzY2UuUkVTT1VSQ0VfVVJMO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIGZ1bmN0aW9uIGFkZEF0dHJJbnRlcnBvbGF0ZURpcmVjdGl2ZShub2RlLCBkaXJlY3RpdmVzLCB2YWx1ZSwgbmFtZSwgYWxsT3JOb3RoaW5nKSB7XG5cdCAgICAgIHZhciB0cnVzdGVkQ29udGV4dCA9IGdldFRydXN0ZWRDb250ZXh0KG5vZGUsIG5hbWUpO1xuXHQgICAgICBhbGxPck5vdGhpbmcgPSBBTExfT1JfTk9USElOR19BVFRSU1tuYW1lXSB8fCBhbGxPck5vdGhpbmc7XG5cdFxuXHQgICAgICB2YXIgaW50ZXJwb2xhdGVGbiA9ICRpbnRlcnBvbGF0ZSh2YWx1ZSwgdHJ1ZSwgdHJ1c3RlZENvbnRleHQsIGFsbE9yTm90aGluZyk7XG5cdFxuXHQgICAgICAvLyBubyBpbnRlcnBvbGF0aW9uIGZvdW5kIC0+IGlnbm9yZVxuXHQgICAgICBpZiAoIWludGVycG9sYXRlRm4pIHJldHVybjtcblx0XG5cdFxuXHQgICAgICBpZiAobmFtZSA9PT0gXCJtdWx0aXBsZVwiICYmIG5vZGVOYW1lXyhub2RlKSA9PT0gXCJzZWxlY3RcIikge1xuXHQgICAgICAgIHRocm93ICRjb21waWxlTWluRXJyKFwic2VsbXVsdGlcIixcblx0ICAgICAgICAgICAgXCJCaW5kaW5nIHRvIHRoZSAnbXVsdGlwbGUnIGF0dHJpYnV0ZSBpcyBub3Qgc3VwcG9ydGVkLiBFbGVtZW50OiB7MH1cIixcblx0ICAgICAgICAgICAgc3RhcnRpbmdUYWcobm9kZSkpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBkaXJlY3RpdmVzLnB1c2goe1xuXHQgICAgICAgIHByaW9yaXR5OiAxMDAsXG5cdCAgICAgICAgY29tcGlsZTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgICAgcHJlOiBmdW5jdGlvbiBhdHRySW50ZXJwb2xhdGVQcmVMaW5rRm4oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcblx0ICAgICAgICAgICAgICAgIHZhciAkJG9ic2VydmVycyA9IChhdHRyLiQkb2JzZXJ2ZXJzIHx8IChhdHRyLiQkb2JzZXJ2ZXJzID0gY3JlYXRlTWFwKCkpKTtcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAoRVZFTlRfSEFORExFUl9BVFRSX1JFR0VYUC50ZXN0KG5hbWUpKSB7XG5cdCAgICAgICAgICAgICAgICAgIHRocm93ICRjb21waWxlTWluRXJyKCdub2RvbWV2ZW50cycsXG5cdCAgICAgICAgICAgICAgICAgICAgICBcIkludGVycG9sYXRpb25zIGZvciBIVE1MIERPTSBldmVudCBhdHRyaWJ1dGVzIGFyZSBkaXNhbGxvd2VkLiAgUGxlYXNlIHVzZSB0aGUgXCIgK1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmctIHZlcnNpb25zIChzdWNoIGFzIG5nLWNsaWNrIGluc3RlYWQgb2Ygb25jbGljaykgaW5zdGVhZC5cIik7XG5cdCAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gSWYgdGhlIGF0dHJpYnV0ZSBoYXMgY2hhbmdlZCBzaW5jZSBsYXN0ICRpbnRlcnBvbGF0ZSgpZWRcblx0ICAgICAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IGF0dHJbbmFtZV07XG5cdCAgICAgICAgICAgICAgICBpZiAobmV3VmFsdWUgIT09IHZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gaW50ZXJwb2xhdGUgYWdhaW4gc2luY2UgdGhlIGF0dHJpYnV0ZSB2YWx1ZSBoYXMgYmVlbiB1cGRhdGVkXG5cdCAgICAgICAgICAgICAgICAgIC8vIChlLmcuIGJ5IGFub3RoZXIgZGlyZWN0aXZlJ3MgY29tcGlsZSBmdW5jdGlvbilcblx0ICAgICAgICAgICAgICAgICAgLy8gZW5zdXJlIHVuc2V0L2VtcHR5IHZhbHVlcyBtYWtlIGludGVycG9sYXRlRm4gZmFsc3lcblx0ICAgICAgICAgICAgICAgICAgaW50ZXJwb2xhdGVGbiA9IG5ld1ZhbHVlICYmICRpbnRlcnBvbGF0ZShuZXdWYWx1ZSwgdHJ1ZSwgdHJ1c3RlZENvbnRleHQsIGFsbE9yTm90aGluZyk7XG5cdCAgICAgICAgICAgICAgICAgIHZhbHVlID0gbmV3VmFsdWU7XG5cdCAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gaWYgYXR0cmlidXRlIHdhcyB1cGRhdGVkIHNvIHRoYXQgdGhlcmUgaXMgbm8gaW50ZXJwb2xhdGlvbiBnb2luZyBvbiB3ZSBkb24ndCB3YW50IHRvXG5cdCAgICAgICAgICAgICAgICAvLyByZWdpc3RlciBhbnkgb2JzZXJ2ZXJzXG5cdCAgICAgICAgICAgICAgICBpZiAoIWludGVycG9sYXRlRm4pIHJldHVybjtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBpbml0aWFsaXplIGF0dHIgb2JqZWN0IHNvIHRoYXQgaXQncyByZWFkeSBpbiBjYXNlIHdlIG5lZWQgdGhlIHZhbHVlIGZvciBpc29sYXRlXG5cdCAgICAgICAgICAgICAgICAvLyBzY29wZSBpbml0aWFsaXphdGlvbiwgb3RoZXJ3aXNlIHRoZSB2YWx1ZSB3b3VsZCBub3QgYmUgYXZhaWxhYmxlIGZyb20gaXNvbGF0ZVxuXHQgICAgICAgICAgICAgICAgLy8gZGlyZWN0aXZlJ3MgbGlua2luZyBmbiBkdXJpbmcgbGlua2luZyBwaGFzZVxuXHQgICAgICAgICAgICAgICAgYXR0cltuYW1lXSA9IGludGVycG9sYXRlRm4oc2NvcGUpO1xuXHRcblx0ICAgICAgICAgICAgICAgICgkJG9ic2VydmVyc1tuYW1lXSB8fCAoJCRvYnNlcnZlcnNbbmFtZV0gPSBbXSkpLiQkaW50ZXIgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgKGF0dHIuJCRvYnNlcnZlcnMgJiYgYXR0ci4kJG9ic2VydmVyc1tuYW1lXS4kJHNjb3BlIHx8IHNjb3BlKS5cblx0ICAgICAgICAgICAgICAgICAgJHdhdGNoKGludGVycG9sYXRlRm4sIGZ1bmN0aW9uIGludGVycG9sYXRlRm5XYXRjaEFjdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcblx0ICAgICAgICAgICAgICAgICAgICAvL3NwZWNpYWwgY2FzZSBmb3IgY2xhc3MgYXR0cmlidXRlIGFkZGl0aW9uICsgcmVtb3ZhbFxuXHQgICAgICAgICAgICAgICAgICAgIC8vc28gdGhhdCBjbGFzcyBjaGFuZ2VzIGNhbiB0YXAgaW50byB0aGUgYW5pbWF0aW9uXG5cdCAgICAgICAgICAgICAgICAgICAgLy9ob29rcyBwcm92aWRlZCBieSB0aGUgJGFuaW1hdGUgc2VydmljZS4gQmUgc3VyZSB0b1xuXHQgICAgICAgICAgICAgICAgICAgIC8vc2tpcCBhbmltYXRpb25zIHdoZW4gdGhlIGZpcnN0IGRpZ2VzdCBvY2N1cnMgKHdoZW5cblx0ICAgICAgICAgICAgICAgICAgICAvL2JvdGggdGhlIG5ldyBhbmQgdGhlIG9sZCB2YWx1ZXMgYXJlIHRoZSBzYW1lKSBzaW5jZVxuXHQgICAgICAgICAgICAgICAgICAgIC8vdGhlIENTUyBjbGFzc2VzIGFyZSB0aGUgbm9uLWludGVycG9sYXRlZCB2YWx1ZXNcblx0ICAgICAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gJ2NsYXNzJyAmJiBuZXdWYWx1ZSAhPSBvbGRWYWx1ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgYXR0ci4kdXBkYXRlQ2xhc3MobmV3VmFsdWUsIG9sZFZhbHVlKTtcblx0ICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgICAgYXR0ci4kc2V0KG5hbWUsIG5ld1ZhbHVlKTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogVGhpcyBpcyBhIHNwZWNpYWwganFMaXRlLnJlcGxhY2VXaXRoLCB3aGljaCBjYW4gcmVwbGFjZSBpdGVtcyB3aGljaFxuXHQgICAgICogaGF2ZSBubyBwYXJlbnRzLCBwcm92aWRlZCB0aGF0IHRoZSBjb250YWluaW5nIGpxTGl0ZSBjb2xsZWN0aW9uIGlzIHByb3ZpZGVkLlxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7SnFMaXRlPX0gJHJvb3RFbGVtZW50IFRoZSByb290IG9mIHRoZSBjb21waWxlIHRyZWUuIFVzZWQgc28gdGhhdCB3ZSBjYW4gcmVwbGFjZSBub2Rlc1xuXHQgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gdGhlIHJvb3Qgb2YgdGhlIHRyZWUuXG5cdCAgICAgKiBAcGFyYW0ge0pxTGl0ZX0gZWxlbWVudHNUb1JlbW92ZSBUaGUganFMaXRlIGVsZW1lbnQgd2hpY2ggd2UgYXJlIGdvaW5nIHRvIHJlcGxhY2UuIFdlIGtlZXBcblx0ICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBzaGVsbCwgYnV0IHJlcGxhY2UgaXRzIERPTSBub2RlIHJlZmVyZW5jZS5cblx0ICAgICAqIEBwYXJhbSB7Tm9kZX0gbmV3Tm9kZSBUaGUgbmV3IERPTSBub2RlLlxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiByZXBsYWNlV2l0aCgkcm9vdEVsZW1lbnQsIGVsZW1lbnRzVG9SZW1vdmUsIG5ld05vZGUpIHtcblx0ICAgICAgdmFyIGZpcnN0RWxlbWVudFRvUmVtb3ZlID0gZWxlbWVudHNUb1JlbW92ZVswXSxcblx0ICAgICAgICAgIHJlbW92ZUNvdW50ID0gZWxlbWVudHNUb1JlbW92ZS5sZW5ndGgsXG5cdCAgICAgICAgICBwYXJlbnQgPSBmaXJzdEVsZW1lbnRUb1JlbW92ZS5wYXJlbnROb2RlLFxuXHQgICAgICAgICAgaSwgaWk7XG5cdFxuXHQgICAgICBpZiAoJHJvb3RFbGVtZW50KSB7XG5cdCAgICAgICAgZm9yIChpID0gMCwgaWkgPSAkcm9vdEVsZW1lbnQubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHQgICAgICAgICAgaWYgKCRyb290RWxlbWVudFtpXSA9PSBmaXJzdEVsZW1lbnRUb1JlbW92ZSkge1xuXHQgICAgICAgICAgICAkcm9vdEVsZW1lbnRbaSsrXSA9IG5ld05vZGU7XG5cdCAgICAgICAgICAgIGZvciAodmFyIGogPSBpLCBqMiA9IGogKyByZW1vdmVDb3VudCAtIDEsXG5cdCAgICAgICAgICAgICAgICAgICAgIGpqID0gJHJvb3RFbGVtZW50Lmxlbmd0aDtcblx0ICAgICAgICAgICAgICAgICBqIDwgamo7IGorKywgajIrKykge1xuXHQgICAgICAgICAgICAgIGlmIChqMiA8IGpqKSB7XG5cdCAgICAgICAgICAgICAgICAkcm9vdEVsZW1lbnRbal0gPSAkcm9vdEVsZW1lbnRbajJdO1xuXHQgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICBkZWxldGUgJHJvb3RFbGVtZW50W2pdO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAkcm9vdEVsZW1lbnQubGVuZ3RoIC09IHJlbW92ZUNvdW50IC0gMTtcblx0XG5cdCAgICAgICAgICAgIC8vIElmIHRoZSByZXBsYWNlZCBlbGVtZW50IGlzIGFsc28gdGhlIGpRdWVyeSAuY29udGV4dCB0aGVuIHJlcGxhY2UgaXRcblx0ICAgICAgICAgICAgLy8gLmNvbnRleHQgaXMgYSBkZXByZWNhdGVkIGpRdWVyeSBhcGksIHNvIHdlIHNob3VsZCBzZXQgaXQgb25seSB3aGVuIGpRdWVyeSBzZXQgaXRcblx0ICAgICAgICAgICAgLy8gaHR0cDovL2FwaS5qcXVlcnkuY29tL2NvbnRleHQvXG5cdCAgICAgICAgICAgIGlmICgkcm9vdEVsZW1lbnQuY29udGV4dCA9PT0gZmlyc3RFbGVtZW50VG9SZW1vdmUpIHtcblx0ICAgICAgICAgICAgICAkcm9vdEVsZW1lbnQuY29udGV4dCA9IG5ld05vZGU7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdFxuXHQgICAgICBpZiAocGFyZW50KSB7XG5cdCAgICAgICAgcGFyZW50LnJlcGxhY2VDaGlsZChuZXdOb2RlLCBmaXJzdEVsZW1lbnRUb1JlbW92ZSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vIEFwcGVuZCBhbGwgdGhlIGBlbGVtZW50c1RvUmVtb3ZlYCB0byBhIGZyYWdtZW50LiBUaGlzIHdpbGwuLi5cblx0ICAgICAgLy8gLSByZW1vdmUgdGhlbSBmcm9tIHRoZSBET01cblx0ICAgICAgLy8gLSBhbGxvdyB0aGVtIHRvIHN0aWxsIGJlIHRyYXZlcnNlZCB3aXRoIC5uZXh0U2libGluZ1xuXHQgICAgICAvLyAtIGFsbG93IGEgc2luZ2xlIGZyYWdtZW50LnFTQSB0byBmZXRjaCBhbGwgZWxlbWVudHMgYmVpbmcgcmVtb3ZlZFxuXHQgICAgICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cdCAgICAgIGZvciAoaSA9IDA7IGkgPCByZW1vdmVDb3VudDsgaSsrKSB7XG5cdCAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZWxlbWVudHNUb1JlbW92ZVtpXSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGlmIChqcUxpdGUuaGFzRGF0YShmaXJzdEVsZW1lbnRUb1JlbW92ZSkpIHtcblx0ICAgICAgICAvLyBDb3B5IG92ZXIgdXNlciBkYXRhICh0aGF0IGluY2x1ZGVzIEFuZ3VsYXIncyAkc2NvcGUgZXRjLikuIERvbid0IGNvcHkgcHJpdmF0ZVxuXHQgICAgICAgIC8vIGRhdGEgaGVyZSBiZWNhdXNlIHRoZXJlJ3Mgbm8gcHVibGljIGludGVyZmFjZSBpbiBqUXVlcnkgdG8gZG8gdGhhdCBhbmQgY29weWluZyBvdmVyXG5cdCAgICAgICAgLy8gZXZlbnQgbGlzdGVuZXJzICh3aGljaCBpcyB0aGUgbWFpbiB1c2Ugb2YgcHJpdmF0ZSBkYXRhKSB3b3VsZG4ndCB3b3JrIGFueXdheS5cblx0ICAgICAgICBqcUxpdGUuZGF0YShuZXdOb2RlLCBqcUxpdGUuZGF0YShmaXJzdEVsZW1lbnRUb1JlbW92ZSkpO1xuXHRcblx0ICAgICAgICAvLyBSZW1vdmUgJGRlc3Ryb3kgZXZlbnQgbGlzdGVuZXJzIGZyb20gYGZpcnN0RWxlbWVudFRvUmVtb3ZlYFxuXHQgICAgICAgIGpxTGl0ZShmaXJzdEVsZW1lbnRUb1JlbW92ZSkub2ZmKCckZGVzdHJveScpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvLyBDbGVhbnVwIGFueSBkYXRhL2xpc3RlbmVycyBvbiB0aGUgZWxlbWVudHMgYW5kIGNoaWxkcmVuLlxuXHQgICAgICAvLyBUaGlzIGluY2x1ZGVzIGludm9raW5nIHRoZSAkZGVzdHJveSBldmVudCBvbiBhbnkgZWxlbWVudHMgd2l0aCBsaXN0ZW5lcnMuXG5cdCAgICAgIGpxTGl0ZS5jbGVhbkRhdGEoZnJhZ21lbnQucXVlcnlTZWxlY3RvckFsbCgnKicpKTtcblx0XG5cdCAgICAgIC8vIFVwZGF0ZSB0aGUganFMaXRlIGNvbGxlY3Rpb24gdG8gb25seSBjb250YWluIHRoZSBgbmV3Tm9kZWBcblx0ICAgICAgZm9yIChpID0gMTsgaSA8IHJlbW92ZUNvdW50OyBpKyspIHtcblx0ICAgICAgICBkZWxldGUgZWxlbWVudHNUb1JlbW92ZVtpXTtcblx0ICAgICAgfVxuXHQgICAgICBlbGVtZW50c1RvUmVtb3ZlWzBdID0gbmV3Tm9kZTtcblx0ICAgICAgZWxlbWVudHNUb1JlbW92ZS5sZW5ndGggPSAxO1xuXHQgICAgfVxuXHRcblx0XG5cdCAgICBmdW5jdGlvbiBjbG9uZUFuZEFubm90YXRlRm4oZm4sIGFubm90YXRpb24pIHtcblx0ICAgICAgcmV0dXJuIGV4dGVuZChmdW5jdGlvbigpIHsgcmV0dXJuIGZuLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7IH0sIGZuLCBhbm5vdGF0aW9uKTtcblx0ICAgIH1cblx0XG5cdFxuXHQgICAgZnVuY3Rpb24gaW52b2tlTGlua0ZuKGxpbmtGbiwgc2NvcGUsICRlbGVtZW50LCBhdHRycywgY29udHJvbGxlcnMsIHRyYW5zY2x1ZGVGbikge1xuXHQgICAgICB0cnkge1xuXHQgICAgICAgIGxpbmtGbihzY29wZSwgJGVsZW1lbnQsIGF0dHJzLCBjb250cm9sbGVycywgdHJhbnNjbHVkZUZuKTtcblx0ICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgICRleGNlcHRpb25IYW5kbGVyKGUsIHN0YXJ0aW5nVGFnKCRlbGVtZW50KSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdFxuXHQgICAgLy8gU2V0IHVwICR3YXRjaGVzIGZvciBpc29sYXRlIHNjb3BlIGFuZCBjb250cm9sbGVyIGJpbmRpbmdzLiBUaGlzIHByb2Nlc3Ncblx0ICAgIC8vIG9ubHkgb2NjdXJzIGZvciBpc29sYXRlIHNjb3BlcyBhbmQgbmV3IHNjb3BlcyB3aXRoIGNvbnRyb2xsZXJBcy5cblx0ICAgIGZ1bmN0aW9uIGluaXRpYWxpemVEaXJlY3RpdmVCaW5kaW5ncyhzY29wZSwgYXR0cnMsIGRlc3RpbmF0aW9uLCBiaW5kaW5ncywgZGlyZWN0aXZlKSB7XG5cdCAgICAgIHZhciByZW1vdmVXYXRjaENvbGxlY3Rpb24gPSBbXTtcblx0ICAgICAgZm9yRWFjaChiaW5kaW5ncywgZnVuY3Rpb24oZGVmaW5pdGlvbiwgc2NvcGVOYW1lKSB7XG5cdCAgICAgICAgdmFyIGF0dHJOYW1lID0gZGVmaW5pdGlvbi5hdHRyTmFtZSxcblx0ICAgICAgICBvcHRpb25hbCA9IGRlZmluaXRpb24ub3B0aW9uYWwsXG5cdCAgICAgICAgbW9kZSA9IGRlZmluaXRpb24ubW9kZSwgLy8gQCwgPSwgb3IgJlxuXHQgICAgICAgIGxhc3RWYWx1ZSxcblx0ICAgICAgICBwYXJlbnRHZXQsIHBhcmVudFNldCwgY29tcGFyZSwgcmVtb3ZlV2F0Y2g7XG5cdFxuXHQgICAgICAgIHN3aXRjaCAobW9kZSkge1xuXHRcblx0ICAgICAgICAgIGNhc2UgJ0AnOlxuXHQgICAgICAgICAgICBpZiAoIW9wdGlvbmFsICYmICFoYXNPd25Qcm9wZXJ0eS5jYWxsKGF0dHJzLCBhdHRyTmFtZSkpIHtcblx0ICAgICAgICAgICAgICBkZXN0aW5hdGlvbltzY29wZU5hbWVdID0gYXR0cnNbYXR0ck5hbWVdID0gdm9pZCAwO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGF0dHJzLiRvYnNlcnZlKGF0dHJOYW1lLCBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgICAgICAgIGlmIChpc1N0cmluZyh2YWx1ZSkpIHtcblx0ICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uW3Njb3BlTmFtZV0gPSB2YWx1ZTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICBhdHRycy4kJG9ic2VydmVyc1thdHRyTmFtZV0uJCRzY29wZSA9IHNjb3BlO1xuXHQgICAgICAgICAgICBsYXN0VmFsdWUgPSBhdHRyc1thdHRyTmFtZV07XG5cdCAgICAgICAgICAgIGlmIChpc1N0cmluZyhsYXN0VmFsdWUpKSB7XG5cdCAgICAgICAgICAgICAgLy8gSWYgdGhlIGF0dHJpYnV0ZSBoYXMgYmVlbiBwcm92aWRlZCB0aGVuIHdlIHRyaWdnZXIgYW4gaW50ZXJwb2xhdGlvbiB0byBlbnN1cmVcblx0ICAgICAgICAgICAgICAvLyB0aGUgdmFsdWUgaXMgdGhlcmUgZm9yIHVzZSBpbiB0aGUgbGluayBmblxuXHQgICAgICAgICAgICAgIGRlc3RpbmF0aW9uW3Njb3BlTmFtZV0gPSAkaW50ZXJwb2xhdGUobGFzdFZhbHVlKShzY29wZSk7XG5cdCAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNCb29sZWFuKGxhc3RWYWx1ZSkpIHtcblx0ICAgICAgICAgICAgICAvLyBJZiB0aGUgYXR0cmlidXRlcyBpcyBvbmUgb2YgdGhlIEJPT0xFQU5fQVRUUiB0aGVuIEFuZ3VsYXIgd2lsbCBoYXZlIGNvbnZlcnRlZFxuXHQgICAgICAgICAgICAgIC8vIHRoZSB2YWx1ZSB0byBib29sZWFuIHJhdGhlciB0aGFuIGEgc3RyaW5nLCBzbyB3ZSBzcGVjaWFsIGNhc2UgdGhpcyBzaXR1YXRpb25cblx0ICAgICAgICAgICAgICBkZXN0aW5hdGlvbltzY29wZU5hbWVdID0gbGFzdFZhbHVlO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGJyZWFrO1xuXHRcblx0ICAgICAgICAgIGNhc2UgJz0nOlxuXHQgICAgICAgICAgICBpZiAoIWhhc093blByb3BlcnR5LmNhbGwoYXR0cnMsIGF0dHJOYW1lKSkge1xuXHQgICAgICAgICAgICAgIGlmIChvcHRpb25hbCkgYnJlYWs7XG5cdCAgICAgICAgICAgICAgYXR0cnNbYXR0ck5hbWVdID0gdm9pZCAwO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGlmIChvcHRpb25hbCAmJiAhYXR0cnNbYXR0ck5hbWVdKSBicmVhaztcblx0XG5cdCAgICAgICAgICAgIHBhcmVudEdldCA9ICRwYXJzZShhdHRyc1thdHRyTmFtZV0pO1xuXHQgICAgICAgICAgICBpZiAocGFyZW50R2V0LmxpdGVyYWwpIHtcblx0ICAgICAgICAgICAgICBjb21wYXJlID0gZXF1YWxzO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIGNvbXBhcmUgPSBmdW5jdGlvbihhLCBiKSB7IHJldHVybiBhID09PSBiIHx8IChhICE9PSBhICYmIGIgIT09IGIpOyB9O1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHBhcmVudFNldCA9IHBhcmVudEdldC5hc3NpZ24gfHwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgICAgLy8gcmVzZXQgdGhlIGNoYW5nZSwgb3Igd2Ugd2lsbCB0aHJvdyB0aGlzIGV4Y2VwdGlvbiBvbiBldmVyeSAkZGlnZXN0XG5cdCAgICAgICAgICAgICAgbGFzdFZhbHVlID0gZGVzdGluYXRpb25bc2NvcGVOYW1lXSA9IHBhcmVudEdldChzY29wZSk7XG5cdCAgICAgICAgICAgICAgdGhyb3cgJGNvbXBpbGVNaW5FcnIoJ25vbmFzc2lnbicsXG5cdCAgICAgICAgICAgICAgICAgIFwiRXhwcmVzc2lvbiAnezB9JyBpbiBhdHRyaWJ1dGUgJ3sxfScgdXNlZCB3aXRoIGRpcmVjdGl2ZSAnezJ9JyBpcyBub24tYXNzaWduYWJsZSFcIixcblx0ICAgICAgICAgICAgICAgICAgYXR0cnNbYXR0ck5hbWVdLCBhdHRyTmFtZSwgZGlyZWN0aXZlLm5hbWUpO1xuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICBsYXN0VmFsdWUgPSBkZXN0aW5hdGlvbltzY29wZU5hbWVdID0gcGFyZW50R2V0KHNjb3BlKTtcblx0ICAgICAgICAgICAgdmFyIHBhcmVudFZhbHVlV2F0Y2ggPSBmdW5jdGlvbiBwYXJlbnRWYWx1ZVdhdGNoKHBhcmVudFZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgaWYgKCFjb21wYXJlKHBhcmVudFZhbHVlLCBkZXN0aW5hdGlvbltzY29wZU5hbWVdKSkge1xuXHQgICAgICAgICAgICAgICAgLy8gd2UgYXJlIG91dCBvZiBzeW5jIGFuZCBuZWVkIHRvIGNvcHlcblx0ICAgICAgICAgICAgICAgIGlmICghY29tcGFyZShwYXJlbnRWYWx1ZSwgbGFzdFZhbHVlKSkge1xuXHQgICAgICAgICAgICAgICAgICAvLyBwYXJlbnQgY2hhbmdlZCBhbmQgaXQgaGFzIHByZWNlZGVuY2Vcblx0ICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb25bc2NvcGVOYW1lXSA9IHBhcmVudFZhbHVlO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIHBhcmVudCBjYW4gYmUgYXNzaWduZWQgdGhlbiBkbyBzb1xuXHQgICAgICAgICAgICAgICAgICBwYXJlbnRTZXQoc2NvcGUsIHBhcmVudFZhbHVlID0gZGVzdGluYXRpb25bc2NvcGVOYW1lXSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIHJldHVybiBsYXN0VmFsdWUgPSBwYXJlbnRWYWx1ZTtcblx0ICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgcGFyZW50VmFsdWVXYXRjaC4kc3RhdGVmdWwgPSB0cnVlO1xuXHQgICAgICAgICAgICBpZiAoZGVmaW5pdGlvbi5jb2xsZWN0aW9uKSB7XG5cdCAgICAgICAgICAgICAgcmVtb3ZlV2F0Y2ggPSBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGF0dHJzW2F0dHJOYW1lXSwgcGFyZW50VmFsdWVXYXRjaCk7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgcmVtb3ZlV2F0Y2ggPSBzY29wZS4kd2F0Y2goJHBhcnNlKGF0dHJzW2F0dHJOYW1lXSwgcGFyZW50VmFsdWVXYXRjaCksIG51bGwsIHBhcmVudEdldC5saXRlcmFsKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICByZW1vdmVXYXRjaENvbGxlY3Rpb24ucHVzaChyZW1vdmVXYXRjaCk7XG5cdCAgICAgICAgICAgIGJyZWFrO1xuXHRcblx0ICAgICAgICAgIGNhc2UgJzwnOlxuXHQgICAgICAgICAgICBpZiAoIWhhc093blByb3BlcnR5LmNhbGwoYXR0cnMsIGF0dHJOYW1lKSkge1xuXHQgICAgICAgICAgICAgIGlmIChvcHRpb25hbCkgYnJlYWs7XG5cdCAgICAgICAgICAgICAgYXR0cnNbYXR0ck5hbWVdID0gdm9pZCAwO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGlmIChvcHRpb25hbCAmJiAhYXR0cnNbYXR0ck5hbWVdKSBicmVhaztcblx0XG5cdCAgICAgICAgICAgIHBhcmVudEdldCA9ICRwYXJzZShhdHRyc1thdHRyTmFtZV0pO1xuXHRcblx0ICAgICAgICAgICAgZGVzdGluYXRpb25bc2NvcGVOYW1lXSA9IHBhcmVudEdldChzY29wZSk7XG5cdFxuXHQgICAgICAgICAgICByZW1vdmVXYXRjaCA9IHNjb3BlLiR3YXRjaChwYXJlbnRHZXQsIGZ1bmN0aW9uIHBhcmVudFZhbHVlV2F0Y2hBY3Rpb24obmV3UGFyZW50VmFsdWUpIHtcblx0ICAgICAgICAgICAgICBkZXN0aW5hdGlvbltzY29wZU5hbWVdID0gbmV3UGFyZW50VmFsdWU7XG5cdCAgICAgICAgICAgIH0sIHBhcmVudEdldC5saXRlcmFsKTtcblx0XG5cdCAgICAgICAgICAgIHJlbW92ZVdhdGNoQ29sbGVjdGlvbi5wdXNoKHJlbW92ZVdhdGNoKTtcblx0ICAgICAgICAgICAgYnJlYWs7XG5cdFxuXHQgICAgICAgICAgY2FzZSAnJic6XG5cdCAgICAgICAgICAgIC8vIERvbid0IGFzc2lnbiBPYmplY3QucHJvdG90eXBlIG1ldGhvZCB0byBzY29wZVxuXHQgICAgICAgICAgICBwYXJlbnRHZXQgPSBhdHRycy5oYXNPd25Qcm9wZXJ0eShhdHRyTmFtZSkgPyAkcGFyc2UoYXR0cnNbYXR0ck5hbWVdKSA6IG5vb3A7XG5cdFxuXHQgICAgICAgICAgICAvLyBEb24ndCBhc3NpZ24gbm9vcCB0byBkZXN0aW5hdGlvbiBpZiBleHByZXNzaW9uIGlzIG5vdCB2YWxpZFxuXHQgICAgICAgICAgICBpZiAocGFyZW50R2V0ID09PSBub29wICYmIG9wdGlvbmFsKSBicmVhaztcblx0XG5cdCAgICAgICAgICAgIGRlc3RpbmF0aW9uW3Njb3BlTmFtZV0gPSBmdW5jdGlvbihsb2NhbHMpIHtcblx0ICAgICAgICAgICAgICByZXR1cm4gcGFyZW50R2V0KHNjb3BlLCBsb2NhbHMpO1xuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgcmV0dXJuIHJlbW92ZVdhdGNoQ29sbGVjdGlvbi5sZW5ndGggJiYgZnVuY3Rpb24gcmVtb3ZlV2F0Y2hlcygpIHtcblx0ICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSByZW1vdmVXYXRjaENvbGxlY3Rpb24ubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuXHQgICAgICAgICAgcmVtb3ZlV2F0Y2hDb2xsZWN0aW9uW2ldKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgICAgfVxuXHQgIH1dO1xuXHR9XG5cdFxuXHR2YXIgUFJFRklYX1JFR0VYUCA9IC9eKCg/Onh8ZGF0YSlbXFw6XFwtX10pL2k7XG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhbGwgYWNjZXB0ZWQgZGlyZWN0aXZlcyBmb3JtYXQgaW50byBwcm9wZXIgZGlyZWN0aXZlIG5hbWUuXG5cdCAqIEBwYXJhbSBuYW1lIE5hbWUgdG8gbm9ybWFsaXplXG5cdCAqL1xuXHRmdW5jdGlvbiBkaXJlY3RpdmVOb3JtYWxpemUobmFtZSkge1xuXHQgIHJldHVybiBjYW1lbENhc2UobmFtZS5yZXBsYWNlKFBSRUZJWF9SRUdFWFAsICcnKSk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgdHlwZVxuXHQgKiBAbmFtZSAkY29tcGlsZS5kaXJlY3RpdmUuQXR0cmlidXRlc1xuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogQSBzaGFyZWQgb2JqZWN0IGJldHdlZW4gZGlyZWN0aXZlIGNvbXBpbGUgLyBsaW5raW5nIGZ1bmN0aW9ucyB3aGljaCBjb250YWlucyBub3JtYWxpemVkIERPTVxuXHQgKiBlbGVtZW50IGF0dHJpYnV0ZXMuIFRoZSB2YWx1ZXMgcmVmbGVjdCBjdXJyZW50IGJpbmRpbmcgc3RhdGUgYHt7IH19YC4gVGhlIG5vcm1hbGl6YXRpb24gaXNcblx0ICogbmVlZGVkIHNpbmNlIGFsbCBvZiB0aGVzZSBhcmUgdHJlYXRlZCBhcyBlcXVpdmFsZW50IGluIEFuZ3VsYXI6XG5cdCAqXG5cdCAqIGBgYFxuXHQgKiAgICA8c3BhbiBuZzpiaW5kPVwiYVwiIG5nLWJpbmQ9XCJhXCIgZGF0YS1uZy1iaW5kPVwiYVwiIHgtbmctYmluZD1cImFcIj5cblx0ICogYGBgXG5cdCAqL1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBwcm9wZXJ0eVxuXHQgKiBAbmFtZSAkY29tcGlsZS5kaXJlY3RpdmUuQXR0cmlidXRlcyMkYXR0clxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogQSBtYXAgb2YgRE9NIGVsZW1lbnQgYXR0cmlidXRlIG5hbWVzIHRvIHRoZSBub3JtYWxpemVkIG5hbWUuIFRoaXMgaXNcblx0ICogbmVlZGVkIHRvIGRvIHJldmVyc2UgbG9va3VwIGZyb20gbm9ybWFsaXplZCBuYW1lIGJhY2sgdG8gYWN0dWFsIG5hbWUuXG5cdCAqL1xuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgbWV0aG9kXG5cdCAqIEBuYW1lICRjb21waWxlLmRpcmVjdGl2ZS5BdHRyaWJ1dGVzIyRzZXRcblx0ICogQGtpbmQgZnVuY3Rpb25cblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFNldCBET00gZWxlbWVudCBhdHRyaWJ1dGUgdmFsdWUuXG5cdCAqXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIE5vcm1hbGl6ZWQgZWxlbWVudCBhdHRyaWJ1dGUgbmFtZSBvZiB0aGUgcHJvcGVydHkgdG8gbW9kaWZ5LiBUaGUgbmFtZSBpc1xuXHQgKiAgICAgICAgICByZXZlcnNlLXRyYW5zbGF0ZWQgdXNpbmcgdGhlIHtAbGluayBuZy4kY29tcGlsZS5kaXJlY3RpdmUuQXR0cmlidXRlcyMkYXR0ciAkYXR0cn1cblx0ICogICAgICAgICAgcHJvcGVydHkgdG8gdGhlIG9yaWdpbmFsIG5hbWUuXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSBWYWx1ZSB0byBzZXQgdGhlIGF0dHJpYnV0ZSB0by4gVGhlIHZhbHVlIGNhbiBiZSBhbiBpbnRlcnBvbGF0ZWQgc3RyaW5nLlxuXHQgKi9cblx0XG5cdFxuXHRcblx0LyoqXG5cdCAqIENsb3N1cmUgY29tcGlsZXIgdHlwZSBpbmZvcm1hdGlvblxuXHQgKi9cblx0XG5cdGZ1bmN0aW9uIG5vZGVzZXRMaW5raW5nRm4oXG5cdCAgLyogYW5ndWxhci5TY29wZSAqLyBzY29wZSxcblx0ICAvKiBOb2RlTGlzdCAqLyBub2RlTGlzdCxcblx0ICAvKiBFbGVtZW50ICovIHJvb3RFbGVtZW50LFxuXHQgIC8qIGZ1bmN0aW9uKEZ1bmN0aW9uKSAqLyBib3VuZFRyYW5zY2x1ZGVGblxuXHQpIHt9XG5cdFxuXHRmdW5jdGlvbiBkaXJlY3RpdmVMaW5raW5nRm4oXG5cdCAgLyogbm9kZXNldExpbmtpbmdGbiAqLyBub2Rlc2V0TGlua2luZ0ZuLFxuXHQgIC8qIGFuZ3VsYXIuU2NvcGUgKi8gc2NvcGUsXG5cdCAgLyogTm9kZSAqLyBub2RlLFxuXHQgIC8qIEVsZW1lbnQgKi8gcm9vdEVsZW1lbnQsXG5cdCAgLyogZnVuY3Rpb24oRnVuY3Rpb24pICovIGJvdW5kVHJhbnNjbHVkZUZuXG5cdCkge31cblx0XG5cdGZ1bmN0aW9uIHRva2VuRGlmZmVyZW5jZShzdHIxLCBzdHIyKSB7XG5cdCAgdmFyIHZhbHVlcyA9ICcnLFxuXHQgICAgICB0b2tlbnMxID0gc3RyMS5zcGxpdCgvXFxzKy8pLFxuXHQgICAgICB0b2tlbnMyID0gc3RyMi5zcGxpdCgvXFxzKy8pO1xuXHRcblx0ICBvdXRlcjpcblx0ICBmb3IgKHZhciBpID0gMDsgaSA8IHRva2VuczEubGVuZ3RoOyBpKyspIHtcblx0ICAgIHZhciB0b2tlbiA9IHRva2VuczFbaV07XG5cdCAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRva2VuczIubGVuZ3RoOyBqKyspIHtcblx0ICAgICAgaWYgKHRva2VuID09IHRva2VuczJbal0pIGNvbnRpbnVlIG91dGVyO1xuXHQgICAgfVxuXHQgICAgdmFsdWVzICs9ICh2YWx1ZXMubGVuZ3RoID4gMCA/ICcgJyA6ICcnKSArIHRva2VuO1xuXHQgIH1cblx0ICByZXR1cm4gdmFsdWVzO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiByZW1vdmVDb21tZW50cyhqcU5vZGVzKSB7XG5cdCAganFOb2RlcyA9IGpxTGl0ZShqcU5vZGVzKTtcblx0ICB2YXIgaSA9IGpxTm9kZXMubGVuZ3RoO1xuXHRcblx0ICBpZiAoaSA8PSAxKSB7XG5cdCAgICByZXR1cm4ganFOb2Rlcztcblx0ICB9XG5cdFxuXHQgIHdoaWxlIChpLS0pIHtcblx0ICAgIHZhciBub2RlID0ganFOb2Rlc1tpXTtcblx0ICAgIGlmIChub2RlLm5vZGVUeXBlID09PSBOT0RFX1RZUEVfQ09NTUVOVCkge1xuXHQgICAgICBzcGxpY2UuY2FsbChqcU5vZGVzLCBpLCAxKTtcblx0ICAgIH1cblx0ICB9XG5cdCAgcmV0dXJuIGpxTm9kZXM7XG5cdH1cblx0XG5cdHZhciAkY29udHJvbGxlck1pbkVyciA9IG1pbkVycignJGNvbnRyb2xsZXInKTtcblx0XG5cdFxuXHR2YXIgQ05UUkxfUkVHID0gL14oXFxTKykoXFxzK2FzXFxzKyhbXFx3JF0rKSk/JC87XG5cdGZ1bmN0aW9uIGlkZW50aWZpZXJGb3JDb250cm9sbGVyKGNvbnRyb2xsZXIsIGlkZW50KSB7XG5cdCAgaWYgKGlkZW50ICYmIGlzU3RyaW5nKGlkZW50KSkgcmV0dXJuIGlkZW50O1xuXHQgIGlmIChpc1N0cmluZyhjb250cm9sbGVyKSkge1xuXHQgICAgdmFyIG1hdGNoID0gQ05UUkxfUkVHLmV4ZWMoY29udHJvbGxlcik7XG5cdCAgICBpZiAobWF0Y2gpIHJldHVybiBtYXRjaFszXTtcblx0ICB9XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHByb3ZpZGVyXG5cdCAqIEBuYW1lICRjb250cm9sbGVyUHJvdmlkZXJcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFRoZSB7QGxpbmsgbmcuJGNvbnRyb2xsZXIgJGNvbnRyb2xsZXIgc2VydmljZX0gaXMgdXNlZCBieSBBbmd1bGFyIHRvIGNyZWF0ZSBuZXdcblx0ICogY29udHJvbGxlcnMuXG5cdCAqXG5cdCAqIFRoaXMgcHJvdmlkZXIgYWxsb3dzIGNvbnRyb2xsZXIgcmVnaXN0cmF0aW9uIHZpYSB0aGVcblx0ICoge0BsaW5rIG5nLiRjb250cm9sbGVyUHJvdmlkZXIjcmVnaXN0ZXIgcmVnaXN0ZXJ9IG1ldGhvZC5cblx0ICovXG5cdGZ1bmN0aW9uICRDb250cm9sbGVyUHJvdmlkZXIoKSB7XG5cdCAgdmFyIGNvbnRyb2xsZXJzID0ge30sXG5cdCAgICAgIGdsb2JhbHMgPSBmYWxzZTtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRjb250cm9sbGVyUHJvdmlkZXIjcmVnaXN0ZXJcblx0ICAgKiBAcGFyYW0ge3N0cmluZ3xPYmplY3R9IG5hbWUgQ29udHJvbGxlciBuYW1lLCBvciBhbiBvYmplY3QgbWFwIG9mIGNvbnRyb2xsZXJzIHdoZXJlIHRoZSBrZXlzIGFyZVxuXHQgICAqICAgIHRoZSBuYW1lcyBhbmQgdGhlIHZhbHVlcyBhcmUgdGhlIGNvbnN0cnVjdG9ycy5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufEFycmF5fSBjb25zdHJ1Y3RvciBDb250cm9sbGVyIGNvbnN0cnVjdG9yIGZuIChvcHRpb25hbGx5IGRlY29yYXRlZCB3aXRoIERJXG5cdCAgICogICAgYW5ub3RhdGlvbnMgaW4gdGhlIGFycmF5IG5vdGF0aW9uKS5cblx0ICAgKi9cblx0ICB0aGlzLnJlZ2lzdGVyID0gZnVuY3Rpb24obmFtZSwgY29uc3RydWN0b3IpIHtcblx0ICAgIGFzc2VydE5vdEhhc093blByb3BlcnR5KG5hbWUsICdjb250cm9sbGVyJyk7XG5cdCAgICBpZiAoaXNPYmplY3QobmFtZSkpIHtcblx0ICAgICAgZXh0ZW5kKGNvbnRyb2xsZXJzLCBuYW1lKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGNvbnRyb2xsZXJzW25hbWVdID0gY29uc3RydWN0b3I7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRjb250cm9sbGVyUHJvdmlkZXIjYWxsb3dHbG9iYWxzXG5cdCAgICogQGRlc2NyaXB0aW9uIElmIGNhbGxlZCwgYWxsb3dzIGAkY29udHJvbGxlcmAgdG8gZmluZCBjb250cm9sbGVyIGNvbnN0cnVjdG9ycyBvbiBgd2luZG93YFxuXHQgICAqL1xuXHQgIHRoaXMuYWxsb3dHbG9iYWxzID0gZnVuY3Rpb24oKSB7XG5cdCAgICBnbG9iYWxzID0gdHJ1ZTtcblx0ICB9O1xuXHRcblx0XG5cdCAgdGhpcy4kZ2V0ID0gWyckaW5qZWN0b3InLCAnJHdpbmRvdycsIGZ1bmN0aW9uKCRpbmplY3RvciwgJHdpbmRvdykge1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIHNlcnZpY2Vcblx0ICAgICAqIEBuYW1lICRjb250cm9sbGVyXG5cdCAgICAgKiBAcmVxdWlyZXMgJGluamVjdG9yXG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtGdW5jdGlvbnxzdHJpbmd9IGNvbnN0cnVjdG9yIElmIGNhbGxlZCB3aXRoIGEgZnVuY3Rpb24gdGhlbiBpdCdzIGNvbnNpZGVyZWQgdG8gYmUgdGhlXG5cdCAgICAgKiAgICBjb250cm9sbGVyIGNvbnN0cnVjdG9yIGZ1bmN0aW9uLiBPdGhlcndpc2UgaXQncyBjb25zaWRlcmVkIHRvIGJlIGEgc3RyaW5nIHdoaWNoIGlzIHVzZWRcblx0ICAgICAqICAgIHRvIHJldHJpZXZlIHRoZSBjb250cm9sbGVyIGNvbnN0cnVjdG9yIHVzaW5nIHRoZSBmb2xsb3dpbmcgc3RlcHM6XG5cdCAgICAgKlxuXHQgICAgICogICAgKiBjaGVjayBpZiBhIGNvbnRyb2xsZXIgd2l0aCBnaXZlbiBuYW1lIGlzIHJlZ2lzdGVyZWQgdmlhIGAkY29udHJvbGxlclByb3ZpZGVyYFxuXHQgICAgICogICAgKiBjaGVjayBpZiBldmFsdWF0aW5nIHRoZSBzdHJpbmcgb24gdGhlIGN1cnJlbnQgc2NvcGUgcmV0dXJucyBhIGNvbnN0cnVjdG9yXG5cdCAgICAgKiAgICAqIGlmICRjb250cm9sbGVyUHJvdmlkZXIjYWxsb3dHbG9iYWxzLCBjaGVjayBgd2luZG93W2NvbnN0cnVjdG9yXWAgb24gdGhlIGdsb2JhbFxuXHQgICAgICogICAgICBgd2luZG93YCBvYmplY3QgKG5vdCByZWNvbW1lbmRlZClcblx0ICAgICAqXG5cdCAgICAgKiAgICBUaGUgc3RyaW5nIGNhbiB1c2UgdGhlIGBjb250cm9sbGVyIGFzIHByb3BlcnR5YCBzeW50YXgsIHdoZXJlIHRoZSBjb250cm9sbGVyIGluc3RhbmNlIGlzIHB1Ymxpc2hlZFxuXHQgICAgICogICAgYXMgdGhlIHNwZWNpZmllZCBwcm9wZXJ0eSBvbiB0aGUgYHNjb3BlYDsgdGhlIGBzY29wZWAgbXVzdCBiZSBpbmplY3RlZCBpbnRvIGBsb2NhbHNgIHBhcmFtIGZvciB0aGlzXG5cdCAgICAgKiAgICB0byB3b3JrIGNvcnJlY3RseS5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge09iamVjdH0gbG9jYWxzIEluamVjdGlvbiBsb2NhbHMgZm9yIENvbnRyb2xsZXIuXG5cdCAgICAgKiBAcmV0dXJuIHtPYmplY3R9IEluc3RhbmNlIG9mIGdpdmVuIGNvbnRyb2xsZXIuXG5cdCAgICAgKlxuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKiBgJGNvbnRyb2xsZXJgIHNlcnZpY2UgaXMgcmVzcG9uc2libGUgZm9yIGluc3RhbnRpYXRpbmcgY29udHJvbGxlcnMuXG5cdCAgICAgKlxuXHQgICAgICogSXQncyBqdXN0IGEgc2ltcGxlIGNhbGwgdG8ge0BsaW5rIGF1dG8uJGluamVjdG9yICRpbmplY3Rvcn0sIGJ1dCBleHRyYWN0ZWQgaW50b1xuXHQgICAgICogYSBzZXJ2aWNlLCBzbyB0aGF0IG9uZSBjYW4gb3ZlcnJpZGUgdGhpcyBzZXJ2aWNlIHdpdGggW0JDIHZlcnNpb25dKGh0dHBzOi8vZ2lzdC5naXRodWIuY29tLzE2NDk3ODgpLlxuXHQgICAgICovXG5cdCAgICByZXR1cm4gZnVuY3Rpb24oZXhwcmVzc2lvbiwgbG9jYWxzLCBsYXRlciwgaWRlbnQpIHtcblx0ICAgICAgLy8gUFJJVkFURSBBUEk6XG5cdCAgICAgIC8vICAgcGFyYW0gYGxhdGVyYCAtLS0gaW5kaWNhdGVzIHRoYXQgdGhlIGNvbnRyb2xsZXIncyBjb25zdHJ1Y3RvciBpcyBpbnZva2VkIGF0IGEgbGF0ZXIgdGltZS5cblx0ICAgICAgLy8gICAgICAgICAgICAgICAgICAgICBJZiB0cnVlLCAkY29udHJvbGxlciB3aWxsIGFsbG9jYXRlIHRoZSBvYmplY3Qgd2l0aCB0aGUgY29ycmVjdFxuXHQgICAgICAvLyAgICAgICAgICAgICAgICAgICAgIHByb3RvdHlwZSBjaGFpbiwgYnV0IHdpbGwgbm90IGludm9rZSB0aGUgY29udHJvbGxlciB1bnRpbCBhIHJldHVybmVkXG5cdCAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sgaXMgaW52b2tlZC5cblx0ICAgICAgLy8gICBwYXJhbSBgaWRlbnRgIC0tLSBBbiBvcHRpb25hbCBsYWJlbCB3aGljaCBvdmVycmlkZXMgdGhlIGxhYmVsIHBhcnNlZCBmcm9tIHRoZSBjb250cm9sbGVyXG5cdCAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbiwgaWYgYW55LlxuXHQgICAgICB2YXIgaW5zdGFuY2UsIG1hdGNoLCBjb25zdHJ1Y3RvciwgaWRlbnRpZmllcjtcblx0ICAgICAgbGF0ZXIgPSBsYXRlciA9PT0gdHJ1ZTtcblx0ICAgICAgaWYgKGlkZW50ICYmIGlzU3RyaW5nKGlkZW50KSkge1xuXHQgICAgICAgIGlkZW50aWZpZXIgPSBpZGVudDtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgaWYgKGlzU3RyaW5nKGV4cHJlc3Npb24pKSB7XG5cdCAgICAgICAgbWF0Y2ggPSBleHByZXNzaW9uLm1hdGNoKENOVFJMX1JFRyk7XG5cdCAgICAgICAgaWYgKCFtYXRjaCkge1xuXHQgICAgICAgICAgdGhyb3cgJGNvbnRyb2xsZXJNaW5FcnIoJ2N0cmxmbXQnLFxuXHQgICAgICAgICAgICBcIkJhZGx5IGZvcm1lZCBjb250cm9sbGVyIHN0cmluZyAnezB9Jy4gXCIgK1xuXHQgICAgICAgICAgICBcIk11c3QgbWF0Y2ggYF9fbmFtZV9fIGFzIF9faWRfX2Agb3IgYF9fbmFtZV9fYC5cIiwgZXhwcmVzc2lvbik7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGNvbnN0cnVjdG9yID0gbWF0Y2hbMV0sXG5cdCAgICAgICAgaWRlbnRpZmllciA9IGlkZW50aWZpZXIgfHwgbWF0Y2hbM107XG5cdCAgICAgICAgZXhwcmVzc2lvbiA9IGNvbnRyb2xsZXJzLmhhc093blByb3BlcnR5KGNvbnN0cnVjdG9yKVxuXHQgICAgICAgICAgICA/IGNvbnRyb2xsZXJzW2NvbnN0cnVjdG9yXVxuXHQgICAgICAgICAgICA6IGdldHRlcihsb2NhbHMuJHNjb3BlLCBjb25zdHJ1Y3RvciwgdHJ1ZSkgfHxcblx0ICAgICAgICAgICAgICAgIChnbG9iYWxzID8gZ2V0dGVyKCR3aW5kb3csIGNvbnN0cnVjdG9yLCB0cnVlKSA6IHVuZGVmaW5lZCk7XG5cdFxuXHQgICAgICAgIGFzc2VydEFyZ0ZuKGV4cHJlc3Npb24sIGNvbnN0cnVjdG9yLCB0cnVlKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgaWYgKGxhdGVyKSB7XG5cdCAgICAgICAgLy8gSW5zdGFudGlhdGUgY29udHJvbGxlciBsYXRlcjpcblx0ICAgICAgICAvLyBUaGlzIG1hY2hpbmVyeSBpcyB1c2VkIHRvIGNyZWF0ZSBhbiBpbnN0YW5jZSBvZiB0aGUgb2JqZWN0IGJlZm9yZSBjYWxsaW5nIHRoZVxuXHQgICAgICAgIC8vIGNvbnRyb2xsZXIncyBjb25zdHJ1Y3RvciBpdHNlbGYuXG5cdCAgICAgICAgLy9cblx0ICAgICAgICAvLyBUaGlzIGFsbG93cyBwcm9wZXJ0aWVzIHRvIGJlIGFkZGVkIHRvIHRoZSBjb250cm9sbGVyIGJlZm9yZSB0aGUgY29uc3RydWN0b3IgaXNcblx0ICAgICAgICAvLyBpbnZva2VkLiBQcmltYXJpbHksIHRoaXMgaXMgdXNlZCBmb3IgaXNvbGF0ZSBzY29wZSBiaW5kaW5ncyBpbiAkY29tcGlsZS5cblx0ICAgICAgICAvL1xuXHQgICAgICAgIC8vIFRoaXMgZmVhdHVyZSBpcyBub3QgaW50ZW5kZWQgZm9yIHVzZSBieSBhcHBsaWNhdGlvbnMsIGFuZCBpcyB0aHVzIG5vdCBkb2N1bWVudGVkXG5cdCAgICAgICAgLy8gcHVibGljbHkuXG5cdCAgICAgICAgLy8gT2JqZWN0IGNyZWF0aW9uOiBodHRwOi8vanNwZXJmLmNvbS9jcmVhdGUtY29uc3RydWN0b3IvMlxuXHQgICAgICAgIHZhciBjb250cm9sbGVyUHJvdG90eXBlID0gKGlzQXJyYXkoZXhwcmVzc2lvbikgP1xuXHQgICAgICAgICAgZXhwcmVzc2lvbltleHByZXNzaW9uLmxlbmd0aCAtIDFdIDogZXhwcmVzc2lvbikucHJvdG90eXBlO1xuXHQgICAgICAgIGluc3RhbmNlID0gT2JqZWN0LmNyZWF0ZShjb250cm9sbGVyUHJvdG90eXBlIHx8IG51bGwpO1xuXHRcblx0ICAgICAgICBpZiAoaWRlbnRpZmllcikge1xuXHQgICAgICAgICAgYWRkSWRlbnRpZmllcihsb2NhbHMsIGlkZW50aWZpZXIsIGluc3RhbmNlLCBjb25zdHJ1Y3RvciB8fCBleHByZXNzaW9uLm5hbWUpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdmFyIGluc3RhbnRpYXRlO1xuXHQgICAgICAgIHJldHVybiBpbnN0YW50aWF0ZSA9IGV4dGVuZChmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHZhciByZXN1bHQgPSAkaW5qZWN0b3IuaW52b2tlKGV4cHJlc3Npb24sIGluc3RhbmNlLCBsb2NhbHMsIGNvbnN0cnVjdG9yKTtcblx0ICAgICAgICAgIGlmIChyZXN1bHQgIT09IGluc3RhbmNlICYmIChpc09iamVjdChyZXN1bHQpIHx8IGlzRnVuY3Rpb24ocmVzdWx0KSkpIHtcblx0ICAgICAgICAgICAgaW5zdGFuY2UgPSByZXN1bHQ7XG5cdCAgICAgICAgICAgIGlmIChpZGVudGlmaWVyKSB7XG5cdCAgICAgICAgICAgICAgLy8gSWYgcmVzdWx0IGNoYW5nZWQsIHJlLWFzc2lnbiBjb250cm9sbGVyQXMgdmFsdWUgdG8gc2NvcGUuXG5cdCAgICAgICAgICAgICAgYWRkSWRlbnRpZmllcihsb2NhbHMsIGlkZW50aWZpZXIsIGluc3RhbmNlLCBjb25zdHJ1Y3RvciB8fCBleHByZXNzaW9uLm5hbWUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICByZXR1cm4gaW5zdGFuY2U7XG5cdCAgICAgICAgfSwge1xuXHQgICAgICAgICAgaW5zdGFuY2U6IGluc3RhbmNlLFxuXHQgICAgICAgICAgaWRlbnRpZmllcjogaWRlbnRpZmllclxuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBpbnN0YW5jZSA9ICRpbmplY3Rvci5pbnN0YW50aWF0ZShleHByZXNzaW9uLCBsb2NhbHMsIGNvbnN0cnVjdG9yKTtcblx0XG5cdCAgICAgIGlmIChpZGVudGlmaWVyKSB7XG5cdCAgICAgICAgYWRkSWRlbnRpZmllcihsb2NhbHMsIGlkZW50aWZpZXIsIGluc3RhbmNlLCBjb25zdHJ1Y3RvciB8fCBleHByZXNzaW9uLm5hbWUpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gaW5zdGFuY2U7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIGFkZElkZW50aWZpZXIobG9jYWxzLCBpZGVudGlmaWVyLCBpbnN0YW5jZSwgbmFtZSkge1xuXHQgICAgICBpZiAoIShsb2NhbHMgJiYgaXNPYmplY3QobG9jYWxzLiRzY29wZSkpKSB7XG5cdCAgICAgICAgdGhyb3cgbWluRXJyKCckY29udHJvbGxlcicpKCdub3NjcCcsXG5cdCAgICAgICAgICBcIkNhbm5vdCBleHBvcnQgY29udHJvbGxlciAnezB9JyBhcyAnezF9JyEgTm8gJHNjb3BlIG9iamVjdCBwcm92aWRlZCB2aWEgYGxvY2Fsc2AuXCIsXG5cdCAgICAgICAgICBuYW1lLCBpZGVudGlmaWVyKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgbG9jYWxzLiRzY29wZVtpZGVudGlmaWVyXSA9IGluc3RhbmNlO1xuXHQgICAgfVxuXHQgIH1dO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHNlcnZpY2Vcblx0ICogQG5hbWUgJGRvY3VtZW50XG5cdCAqIEByZXF1aXJlcyAkd2luZG93XG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBBIHtAbGluayBhbmd1bGFyLmVsZW1lbnQgalF1ZXJ5IG9yIGpxTGl0ZX0gd3JhcHBlciBmb3IgdGhlIGJyb3dzZXIncyBgd2luZG93LmRvY3VtZW50YCBvYmplY3QuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlIG1vZHVsZT1cImRvY3VtZW50RXhhbXBsZVwiPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgICAgICAgICA8cD4kZG9jdW1lbnQgdGl0bGU6IDxiIG5nLWJpbmQ9XCJ0aXRsZVwiPjwvYj48L3A+XG5cdCAgICAgICAgIDxwPndpbmRvdy5kb2N1bWVudCB0aXRsZTogPGIgbmctYmluZD1cIndpbmRvd1RpdGxlXCI+PC9iPjwvcD5cblx0ICAgICAgIDwvZGl2PlxuXHQgICAgIDwvZmlsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwic2NyaXB0LmpzXCI+XG5cdCAgICAgICBhbmd1bGFyLm1vZHVsZSgnZG9jdW1lbnRFeGFtcGxlJywgW10pXG5cdCAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRkb2N1bWVudCcsIGZ1bmN0aW9uKCRzY29wZSwgJGRvY3VtZW50KSB7XG5cdCAgICAgICAgICAgJHNjb3BlLnRpdGxlID0gJGRvY3VtZW50WzBdLnRpdGxlO1xuXHQgICAgICAgICAgICRzY29wZS53aW5kb3dUaXRsZSA9IGFuZ3VsYXIuZWxlbWVudCh3aW5kb3cuZG9jdW1lbnQpWzBdLnRpdGxlO1xuXHQgICAgICAgICB9XSk7XG5cdCAgICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCAqL1xuXHRmdW5jdGlvbiAkRG9jdW1lbnRQcm92aWRlcigpIHtcblx0ICB0aGlzLiRnZXQgPSBbJyR3aW5kb3cnLCBmdW5jdGlvbih3aW5kb3cpIHtcblx0ICAgIHJldHVybiBqcUxpdGUod2luZG93LmRvY3VtZW50KTtcblx0ICB9XTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBzZXJ2aWNlXG5cdCAqIEBuYW1lICRleGNlcHRpb25IYW5kbGVyXG5cdCAqIEByZXF1aXJlcyBuZy4kbG9nXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBBbnkgdW5jYXVnaHQgZXhjZXB0aW9uIGluIGFuZ3VsYXIgZXhwcmVzc2lvbnMgaXMgZGVsZWdhdGVkIHRvIHRoaXMgc2VydmljZS5cblx0ICogVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gc2ltcGx5IGRlbGVnYXRlcyB0byBgJGxvZy5lcnJvcmAgd2hpY2ggbG9ncyBpdCBpbnRvXG5cdCAqIHRoZSBicm93c2VyIGNvbnNvbGUuXG5cdCAqXG5cdCAqIEluIHVuaXQgdGVzdHMsIGlmIGBhbmd1bGFyLW1vY2tzLmpzYCBpcyBsb2FkZWQsIHRoaXMgc2VydmljZSBpcyBvdmVycmlkZGVuIGJ5XG5cdCAqIHtAbGluayBuZ01vY2suJGV4Y2VwdGlvbkhhbmRsZXIgbW9jayAkZXhjZXB0aW9uSGFuZGxlcn0gd2hpY2ggYWlkcyBpbiB0ZXN0aW5nLlxuXHQgKlxuXHQgKiAjIyBFeGFtcGxlOlxuXHQgKlxuXHQgKiBgYGBqc1xuXHQgKiAgIGFuZ3VsYXIubW9kdWxlKCdleGNlcHRpb25PdmVycmlkZScsIFtdKS5mYWN0b3J5KCckZXhjZXB0aW9uSGFuZGxlcicsIGZ1bmN0aW9uKCkge1xuXHQgKiAgICAgcmV0dXJuIGZ1bmN0aW9uKGV4Y2VwdGlvbiwgY2F1c2UpIHtcblx0ICogICAgICAgZXhjZXB0aW9uLm1lc3NhZ2UgKz0gJyAoY2F1c2VkIGJ5IFwiJyArIGNhdXNlICsgJ1wiKSc7XG5cdCAqICAgICAgIHRocm93IGV4Y2VwdGlvbjtcblx0ICogICAgIH07XG5cdCAqICAgfSk7XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBUaGlzIGV4YW1wbGUgd2lsbCBvdmVycmlkZSB0aGUgbm9ybWFsIGFjdGlvbiBvZiBgJGV4Y2VwdGlvbkhhbmRsZXJgLCB0byBtYWtlIGFuZ3VsYXJcblx0ICogZXhjZXB0aW9ucyBmYWlsIGhhcmQgd2hlbiB0aGV5IGhhcHBlbiwgaW5zdGVhZCBvZiBqdXN0IGxvZ2dpbmcgdG8gdGhlIGNvbnNvbGUuXG5cdCAqXG5cdCAqIDxociAvPlxuXHQgKiBOb3RlLCB0aGF0IGNvZGUgZXhlY3V0ZWQgaW4gZXZlbnQtbGlzdGVuZXJzIChldmVuIHRob3NlIHJlZ2lzdGVyZWQgdXNpbmcganFMaXRlJ3MgYG9uYC9gYmluZGBcblx0ICogbWV0aG9kcykgZG9lcyBub3QgZGVsZWdhdGUgZXhjZXB0aW9ucyB0byB0aGUge0BsaW5rIG5nLiRleGNlcHRpb25IYW5kbGVyICRleGNlcHRpb25IYW5kbGVyfVxuXHQgKiAodW5sZXNzIGV4ZWN1dGVkIGR1cmluZyBhIGRpZ2VzdCkuXG5cdCAqXG5cdCAqIElmIHlvdSB3aXNoLCB5b3UgY2FuIG1hbnVhbGx5IGRlbGVnYXRlIGV4Y2VwdGlvbnMsIGUuZy5cblx0ICogYHRyeSB7IC4uLiB9IGNhdGNoKGUpIHsgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7IH1gXG5cdCAqXG5cdCAqIEBwYXJhbSB7RXJyb3J9IGV4Y2VwdGlvbiBFeGNlcHRpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBlcnJvci5cblx0ICogQHBhcmFtIHtzdHJpbmc9fSBjYXVzZSBvcHRpb25hbCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgY29udGV4dCBpbiB3aGljaFxuXHQgKiAgICAgICB0aGUgZXJyb3Igd2FzIHRocm93bi5cblx0ICpcblx0ICovXG5cdGZ1bmN0aW9uICRFeGNlcHRpb25IYW5kbGVyUHJvdmlkZXIoKSB7XG5cdCAgdGhpcy4kZ2V0ID0gWyckbG9nJywgZnVuY3Rpb24oJGxvZykge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKGV4Y2VwdGlvbiwgY2F1c2UpIHtcblx0ICAgICAgJGxvZy5lcnJvci5hcHBseSgkbG9nLCBhcmd1bWVudHMpO1xuXHQgICAgfTtcblx0ICB9XTtcblx0fVxuXHRcblx0dmFyICQkRm9yY2VSZWZsb3dQcm92aWRlciA9IGZ1bmN0aW9uKCkge1xuXHQgIHRoaXMuJGdldCA9IFsnJGRvY3VtZW50JywgZnVuY3Rpb24oJGRvY3VtZW50KSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oZG9tTm9kZSkge1xuXHQgICAgICAvL3RoZSBsaW5lIGJlbG93IHdpbGwgZm9yY2UgdGhlIGJyb3dzZXIgdG8gcGVyZm9ybSBhIHJlcGFpbnQgc29cblx0ICAgICAgLy90aGF0IGFsbCB0aGUgYW5pbWF0ZWQgZWxlbWVudHMgd2l0aGluIHRoZSBhbmltYXRpb24gZnJhbWUgd2lsbFxuXHQgICAgICAvL2JlIHByb3Blcmx5IHVwZGF0ZWQgYW5kIGRyYXduIG9uIHNjcmVlbi4gVGhpcyBpcyByZXF1aXJlZCB0b1xuXHQgICAgICAvL2Vuc3VyZSB0aGF0IHRoZSBwcmVwYXJhdGlvbiBhbmltYXRpb24gaXMgcHJvcGVybHkgZmx1c2hlZCBzbyB0aGF0XG5cdCAgICAgIC8vdGhlIGFjdGl2ZSBzdGF0ZSBwaWNrcyB1cCBmcm9tIHRoZXJlLiBETyBOT1QgUkVNT1ZFIFRISVMgTElORS5cblx0ICAgICAgLy9ETyBOT1QgT1BUSU1JWkUgVEhJUyBMSU5FLiBUSEUgTUlOSUZJRVIgV0lMTCBSRU1PVkUgSVQgT1RIRVJXSVNFIFdISUNIXG5cdCAgICAgIC8vV0lMTCBSRVNVTFQgSU4gQU4gVU5QUkVESUNUQUJMRSBCVUcgVEhBVCBJUyBWRVJZIEhBUkQgVE8gVFJBQ0sgRE9XTiBBTkRcblx0ICAgICAgLy9XSUxMIFRBS0UgWUVBUlMgQVdBWSBGUk9NIFlPVVIgTElGRS5cblx0ICAgICAgaWYgKGRvbU5vZGUpIHtcblx0ICAgICAgICBpZiAoIWRvbU5vZGUubm9kZVR5cGUgJiYgZG9tTm9kZSBpbnN0YW5jZW9mIGpxTGl0ZSkge1xuXHQgICAgICAgICAgZG9tTm9kZSA9IGRvbU5vZGVbMF07XG5cdCAgICAgICAgfVxuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGRvbU5vZGUgPSAkZG9jdW1lbnRbMF0uYm9keTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gZG9tTm9kZS5vZmZzZXRXaWR0aCArIDE7XG5cdCAgICB9O1xuXHQgIH1dO1xuXHR9O1xuXHRcblx0dmFyIEFQUExJQ0FUSU9OX0pTT04gPSAnYXBwbGljYXRpb24vanNvbic7XG5cdHZhciBDT05URU5UX1RZUEVfQVBQTElDQVRJT05fSlNPTiA9IHsnQ29udGVudC1UeXBlJzogQVBQTElDQVRJT05fSlNPTiArICc7Y2hhcnNldD11dGYtOCd9O1xuXHR2YXIgSlNPTl9TVEFSVCA9IC9eXFxbfF5cXHsoPyFcXHspLztcblx0dmFyIEpTT05fRU5EUyA9IHtcblx0ICAnWyc6IC9dJC8sXG5cdCAgJ3snOiAvfSQvXG5cdH07XG5cdHZhciBKU09OX1BST1RFQ1RJT05fUFJFRklYID0gL15cXClcXF1cXH0nLD9cXG4vO1xuXHR2YXIgJGh0dHBNaW5FcnIgPSBtaW5FcnIoJyRodHRwJyk7XG5cdHZhciAkaHR0cE1pbkVyckxlZ2FjeUZuID0gZnVuY3Rpb24obWV0aG9kKSB7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgdGhyb3cgJGh0dHBNaW5FcnIoJ2xlZ2FjeScsICdUaGUgbWV0aG9kIGB7MH1gIG9uIHRoZSBwcm9taXNlIHJldHVybmVkIGZyb20gYCRodHRwYCBoYXMgYmVlbiBkaXNhYmxlZC4nLCBtZXRob2QpO1xuXHQgIH07XG5cdH07XG5cdFxuXHRmdW5jdGlvbiBzZXJpYWxpemVWYWx1ZSh2KSB7XG5cdCAgaWYgKGlzT2JqZWN0KHYpKSB7XG5cdCAgICByZXR1cm4gaXNEYXRlKHYpID8gdi50b0lTT1N0cmluZygpIDogdG9Kc29uKHYpO1xuXHQgIH1cblx0ICByZXR1cm4gdjtcblx0fVxuXHRcblx0XG5cdGZ1bmN0aW9uICRIdHRwUGFyYW1TZXJpYWxpemVyUHJvdmlkZXIoKSB7XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIHNlcnZpY2Vcblx0ICAgKiBAbmFtZSAkaHR0cFBhcmFtU2VyaWFsaXplclxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqXG5cdCAgICogRGVmYXVsdCB7QGxpbmsgJGh0dHAgYCRodHRwYH0gcGFyYW1zIHNlcmlhbGl6ZXIgdGhhdCBjb252ZXJ0cyBvYmplY3RzIHRvIHN0cmluZ3Ncblx0ICAgKiBhY2NvcmRpbmcgdG8gdGhlIGZvbGxvd2luZyBydWxlczpcblx0ICAgKlxuXHQgICAqICogYHsnZm9vJzogJ2Jhcid9YCByZXN1bHRzIGluIGBmb289YmFyYFxuXHQgICAqICogYHsnZm9vJzogRGF0ZS5ub3coKX1gIHJlc3VsdHMgaW4gYGZvbz0yMDE1LTA0LTAxVDA5JTNBNTAlM0E0OS4yNjJaYCAoYHRvSVNPU3RyaW5nKClgIGFuZCBlbmNvZGVkIHJlcHJlc2VudGF0aW9uIG9mIGEgRGF0ZSBvYmplY3QpXG5cdCAgICogKiBgeydmb28nOiBbJ2JhcicsICdiYXonXX1gIHJlc3VsdHMgaW4gYGZvbz1iYXImZm9vPWJhemAgKHJlcGVhdGVkIGtleSBmb3IgZWFjaCBhcnJheSBlbGVtZW50KVxuXHQgICAqICogYHsnZm9vJzogeydiYXInOidiYXonfX1gIHJlc3VsdHMgaW4gYGZvbz0lN0IlMjJiYXIlMjIlM0ElMjJiYXolMjIlN0RcImAgKHN0cmluZ2lmaWVkIGFuZCBlbmNvZGVkIHJlcHJlc2VudGF0aW9uIG9mIGFuIG9iamVjdClcblx0ICAgKlxuXHQgICAqIE5vdGUgdGhhdCBzZXJpYWxpemVyIHdpbGwgc29ydCB0aGUgcmVxdWVzdCBwYXJhbWV0ZXJzIGFscGhhYmV0aWNhbGx5LlxuXHQgICAqICovXG5cdFxuXHQgIHRoaXMuJGdldCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uIG5nUGFyYW1TZXJpYWxpemVyKHBhcmFtcykge1xuXHQgICAgICBpZiAoIXBhcmFtcykgcmV0dXJuICcnO1xuXHQgICAgICB2YXIgcGFydHMgPSBbXTtcblx0ICAgICAgZm9yRWFjaFNvcnRlZChwYXJhbXMsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcblx0ICAgICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgaXNVbmRlZmluZWQodmFsdWUpKSByZXR1cm47XG5cdCAgICAgICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG5cdCAgICAgICAgICBmb3JFYWNoKHZhbHVlLCBmdW5jdGlvbih2LCBrKSB7XG5cdCAgICAgICAgICAgIHBhcnRzLnB1c2goZW5jb2RlVXJpUXVlcnkoa2V5KSAgKyAnPScgKyBlbmNvZGVVcmlRdWVyeShzZXJpYWxpemVWYWx1ZSh2KSkpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHBhcnRzLnB1c2goZW5jb2RlVXJpUXVlcnkoa2V5KSArICc9JyArIGVuY29kZVVyaVF1ZXJ5KHNlcmlhbGl6ZVZhbHVlKHZhbHVlKSkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICByZXR1cm4gcGFydHMuam9pbignJicpO1xuXHQgICAgfTtcblx0ICB9O1xuXHR9XG5cdFxuXHRmdW5jdGlvbiAkSHR0cFBhcmFtU2VyaWFsaXplckpRTGlrZVByb3ZpZGVyKCkge1xuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBzZXJ2aWNlXG5cdCAgICogQG5hbWUgJGh0dHBQYXJhbVNlcmlhbGl6ZXJKUUxpa2Vcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKlxuXHQgICAqIEFsdGVybmF0aXZlIHtAbGluayAkaHR0cCBgJGh0dHBgfSBwYXJhbXMgc2VyaWFsaXplciB0aGF0IGZvbGxvd3Ncblx0ICAgKiBqUXVlcnkncyBbYHBhcmFtKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vanF1ZXJ5LnBhcmFtLykgbWV0aG9kIGxvZ2ljLlxuXHQgICAqIFRoZSBzZXJpYWxpemVyIHdpbGwgYWxzbyBzb3J0IHRoZSBwYXJhbXMgYWxwaGFiZXRpY2FsbHkuXG5cdCAgICpcblx0ICAgKiBUbyB1c2UgaXQgZm9yIHNlcmlhbGl6aW5nIGAkaHR0cGAgcmVxdWVzdCBwYXJhbWV0ZXJzLCBzZXQgaXQgYXMgdGhlIGBwYXJhbVNlcmlhbGl6ZXJgIHByb3BlcnR5OlxuXHQgICAqXG5cdCAgICogYGBganNcblx0ICAgKiAkaHR0cCh7XG5cdCAgICogICB1cmw6IG15VXJsLFxuXHQgICAqICAgbWV0aG9kOiAnR0VUJyxcblx0ICAgKiAgIHBhcmFtczogbXlQYXJhbXMsXG5cdCAgICogICBwYXJhbVNlcmlhbGl6ZXI6ICckaHR0cFBhcmFtU2VyaWFsaXplckpRTGlrZSdcblx0ICAgKiB9KTtcblx0ICAgKiBgYGBcblx0ICAgKlxuXHQgICAqIEl0IGlzIGFsc28gcG9zc2libGUgdG8gc2V0IGl0IGFzIHRoZSBkZWZhdWx0IGBwYXJhbVNlcmlhbGl6ZXJgIGluIHRoZVxuXHQgICAqIHtAbGluayAkaHR0cFByb3ZpZGVyI2RlZmF1bHRzIGAkaHR0cFByb3ZpZGVyYH0uXG5cdCAgICpcblx0ICAgKiBBZGRpdGlvbmFsbHksIHlvdSBjYW4gaW5qZWN0IHRoZSBzZXJpYWxpemVyIGFuZCB1c2UgaXQgZXhwbGljaXRseSwgZm9yIGV4YW1wbGUgdG8gc2VyaWFsaXplXG5cdCAgICogZm9ybSBkYXRhIGZvciBzdWJtaXNzaW9uOlxuXHQgICAqXG5cdCAgICogYGBganNcblx0ICAgKiAuY29udHJvbGxlcihmdW5jdGlvbigkaHR0cCwgJGh0dHBQYXJhbVNlcmlhbGl6ZXJKUUxpa2UpIHtcblx0ICAgKiAgIC8vLi4uXG5cdCAgICpcblx0ICAgKiAgICRodHRwKHtcblx0ICAgKiAgICAgdXJsOiBteVVybCxcblx0ICAgKiAgICAgbWV0aG9kOiAnUE9TVCcsXG5cdCAgICogICAgIGRhdGE6ICRodHRwUGFyYW1TZXJpYWxpemVySlFMaWtlKG15RGF0YSksXG5cdCAgICogICAgIGhlYWRlcnM6IHtcblx0ICAgKiAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcblx0ICAgKiAgICAgfVxuXHQgICAqICAgfSk7XG5cdCAgICpcblx0ICAgKiB9KTtcblx0ICAgKiBgYGBcblx0ICAgKlxuXHQgICAqICovXG5cdCAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24oKSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24galF1ZXJ5TGlrZVBhcmFtU2VyaWFsaXplcihwYXJhbXMpIHtcblx0ICAgICAgaWYgKCFwYXJhbXMpIHJldHVybiAnJztcblx0ICAgICAgdmFyIHBhcnRzID0gW107XG5cdCAgICAgIHNlcmlhbGl6ZShwYXJhbXMsICcnLCB0cnVlKTtcblx0ICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJyYnKTtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIHNlcmlhbGl6ZSh0b1NlcmlhbGl6ZSwgcHJlZml4LCB0b3BMZXZlbCkge1xuXHQgICAgICAgIGlmICh0b1NlcmlhbGl6ZSA9PT0gbnVsbCB8fCBpc1VuZGVmaW5lZCh0b1NlcmlhbGl6ZSkpIHJldHVybjtcblx0ICAgICAgICBpZiAoaXNBcnJheSh0b1NlcmlhbGl6ZSkpIHtcblx0ICAgICAgICAgIGZvckVhY2godG9TZXJpYWxpemUsIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCkge1xuXHQgICAgICAgICAgICBzZXJpYWxpemUodmFsdWUsIHByZWZpeCArICdbJyArIChpc09iamVjdCh2YWx1ZSkgPyBpbmRleCA6ICcnKSArICddJyk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9IGVsc2UgaWYgKGlzT2JqZWN0KHRvU2VyaWFsaXplKSAmJiAhaXNEYXRlKHRvU2VyaWFsaXplKSkge1xuXHQgICAgICAgICAgZm9yRWFjaFNvcnRlZCh0b1NlcmlhbGl6ZSwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuXHQgICAgICAgICAgICBzZXJpYWxpemUodmFsdWUsIHByZWZpeCArXG5cdCAgICAgICAgICAgICAgICAodG9wTGV2ZWwgPyAnJyA6ICdbJykgK1xuXHQgICAgICAgICAgICAgICAga2V5ICtcblx0ICAgICAgICAgICAgICAgICh0b3BMZXZlbCA/ICcnIDogJ10nKSk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgcGFydHMucHVzaChlbmNvZGVVcmlRdWVyeShwcmVmaXgpICsgJz0nICsgZW5jb2RlVXJpUXVlcnkoc2VyaWFsaXplVmFsdWUodG9TZXJpYWxpemUpKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgIH07XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGRlZmF1bHRIdHRwUmVzcG9uc2VUcmFuc2Zvcm0oZGF0YSwgaGVhZGVycykge1xuXHQgIGlmIChpc1N0cmluZyhkYXRhKSkge1xuXHQgICAgLy8gU3RyaXAganNvbiB2dWxuZXJhYmlsaXR5IHByb3RlY3Rpb24gcHJlZml4IGFuZCB0cmltIHdoaXRlc3BhY2Vcblx0ICAgIHZhciB0ZW1wRGF0YSA9IGRhdGEucmVwbGFjZShKU09OX1BST1RFQ1RJT05fUFJFRklYLCAnJykudHJpbSgpO1xuXHRcblx0ICAgIGlmICh0ZW1wRGF0YSkge1xuXHQgICAgICB2YXIgY29udGVudFR5cGUgPSBoZWFkZXJzKCdDb250ZW50LVR5cGUnKTtcblx0ICAgICAgaWYgKChjb250ZW50VHlwZSAmJiAoY29udGVudFR5cGUuaW5kZXhPZihBUFBMSUNBVElPTl9KU09OKSA9PT0gMCkpIHx8IGlzSnNvbkxpa2UodGVtcERhdGEpKSB7XG5cdCAgICAgICAgZGF0YSA9IGZyb21Kc29uKHRlbXBEYXRhKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgcmV0dXJuIGRhdGE7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGlzSnNvbkxpa2Uoc3RyKSB7XG5cdCAgICB2YXIganNvblN0YXJ0ID0gc3RyLm1hdGNoKEpTT05fU1RBUlQpO1xuXHQgICAgcmV0dXJuIGpzb25TdGFydCAmJiBKU09OX0VORFNbanNvblN0YXJ0WzBdXS50ZXN0KHN0cik7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBQYXJzZSBoZWFkZXJzIGludG8ga2V5IHZhbHVlIG9iamVjdFxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaGVhZGVycyBSYXcgaGVhZGVycyBhcyBhIHN0cmluZ1xuXHQgKiBAcmV0dXJucyB7T2JqZWN0fSBQYXJzZWQgaGVhZGVycyBhcyBrZXkgdmFsdWUgb2JqZWN0XG5cdCAqL1xuXHRmdW5jdGlvbiBwYXJzZUhlYWRlcnMoaGVhZGVycykge1xuXHQgIHZhciBwYXJzZWQgPSBjcmVhdGVNYXAoKSwgaTtcblx0XG5cdCAgZnVuY3Rpb24gZmlsbEluUGFyc2VkKGtleSwgdmFsKSB7XG5cdCAgICBpZiAoa2V5KSB7XG5cdCAgICAgIHBhcnNlZFtrZXldID0gcGFyc2VkW2tleV0gPyBwYXJzZWRba2V5XSArICcsICcgKyB2YWwgOiB2YWw7XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICBpZiAoaXNTdHJpbmcoaGVhZGVycykpIHtcblx0ICAgIGZvckVhY2goaGVhZGVycy5zcGxpdCgnXFxuJyksIGZ1bmN0aW9uKGxpbmUpIHtcblx0ICAgICAgaSA9IGxpbmUuaW5kZXhPZignOicpO1xuXHQgICAgICBmaWxsSW5QYXJzZWQobG93ZXJjYXNlKHRyaW0obGluZS5zdWJzdHIoMCwgaSkpKSwgdHJpbShsaW5lLnN1YnN0cihpICsgMSkpKTtcblx0ICAgIH0pO1xuXHQgIH0gZWxzZSBpZiAoaXNPYmplY3QoaGVhZGVycykpIHtcblx0ICAgIGZvckVhY2goaGVhZGVycywgZnVuY3Rpb24oaGVhZGVyVmFsLCBoZWFkZXJLZXkpIHtcblx0ICAgICAgZmlsbEluUGFyc2VkKGxvd2VyY2FzZShoZWFkZXJLZXkpLCB0cmltKGhlYWRlclZhbCkpO1xuXHQgICAgfSk7XG5cdCAgfVxuXHRcblx0ICByZXR1cm4gcGFyc2VkO1xuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IHByb3ZpZGVzIGFjY2VzcyB0byBwYXJzZWQgaGVhZGVycy5cblx0ICpcblx0ICogSGVhZGVycyBhcmUgbGF6eSBwYXJzZWQgd2hlbiBmaXJzdCByZXF1ZXN0ZWQuXG5cdCAqIEBzZWUgcGFyc2VIZWFkZXJzXG5cdCAqXG5cdCAqIEBwYXJhbSB7KHN0cmluZ3xPYmplY3QpfSBoZWFkZXJzIEhlYWRlcnMgdG8gcHJvdmlkZSBhY2Nlc3MgdG8uXG5cdCAqIEByZXR1cm5zIHtmdW5jdGlvbihzdHJpbmc9KX0gUmV0dXJucyBhIGdldHRlciBmdW5jdGlvbiB3aGljaCBpZiBjYWxsZWQgd2l0aDpcblx0ICpcblx0ICogICAtIGlmIGNhbGxlZCB3aXRoIHNpbmdsZSBhbiBhcmd1bWVudCByZXR1cm5zIGEgc2luZ2xlIGhlYWRlciB2YWx1ZSBvciBudWxsXG5cdCAqICAgLSBpZiBjYWxsZWQgd2l0aCBubyBhcmd1bWVudHMgcmV0dXJucyBhbiBvYmplY3QgY29udGFpbmluZyBhbGwgaGVhZGVycy5cblx0ICovXG5cdGZ1bmN0aW9uIGhlYWRlcnNHZXR0ZXIoaGVhZGVycykge1xuXHQgIHZhciBoZWFkZXJzT2JqO1xuXHRcblx0ICByZXR1cm4gZnVuY3Rpb24obmFtZSkge1xuXHQgICAgaWYgKCFoZWFkZXJzT2JqKSBoZWFkZXJzT2JqID0gIHBhcnNlSGVhZGVycyhoZWFkZXJzKTtcblx0XG5cdCAgICBpZiAobmFtZSkge1xuXHQgICAgICB2YXIgdmFsdWUgPSBoZWFkZXJzT2JqW2xvd2VyY2FzZShuYW1lKV07XG5cdCAgICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwKSB7XG5cdCAgICAgICAgdmFsdWUgPSBudWxsO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiB2YWx1ZTtcblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gaGVhZGVyc09iajtcblx0ICB9O1xuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIENoYWluIGFsbCBnaXZlbiBmdW5jdGlvbnNcblx0ICpcblx0ICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIGZvciBib3RoIHJlcXVlc3QgYW5kIHJlc3BvbnNlIHRyYW5zZm9ybWluZ1xuXHQgKlxuXHQgKiBAcGFyYW0geyp9IGRhdGEgRGF0YSB0byB0cmFuc2Zvcm0uXG5cdCAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nPSl9IGhlYWRlcnMgSFRUUCBoZWFkZXJzIGdldHRlciBmbi5cblx0ICogQHBhcmFtIHtudW1iZXJ9IHN0YXR1cyBIVFRQIHN0YXR1cyBjb2RlIG9mIHRoZSByZXNwb25zZS5cblx0ICogQHBhcmFtIHsoRnVuY3Rpb258QXJyYXkuPEZ1bmN0aW9uPil9IGZucyBGdW5jdGlvbiBvciBhbiBhcnJheSBvZiBmdW5jdGlvbnMuXG5cdCAqIEByZXR1cm5zIHsqfSBUcmFuc2Zvcm1lZCBkYXRhLlxuXHQgKi9cblx0ZnVuY3Rpb24gdHJhbnNmb3JtRGF0YShkYXRhLCBoZWFkZXJzLCBzdGF0dXMsIGZucykge1xuXHQgIGlmIChpc0Z1bmN0aW9uKGZucykpIHtcblx0ICAgIHJldHVybiBmbnMoZGF0YSwgaGVhZGVycywgc3RhdHVzKTtcblx0ICB9XG5cdFxuXHQgIGZvckVhY2goZm5zLCBmdW5jdGlvbihmbikge1xuXHQgICAgZGF0YSA9IGZuKGRhdGEsIGhlYWRlcnMsIHN0YXR1cyk7XG5cdCAgfSk7XG5cdFxuXHQgIHJldHVybiBkYXRhO1xuXHR9XG5cdFxuXHRcblx0ZnVuY3Rpb24gaXNTdWNjZXNzKHN0YXR1cykge1xuXHQgIHJldHVybiAyMDAgPD0gc3RhdHVzICYmIHN0YXR1cyA8IDMwMDtcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgcHJvdmlkZXJcblx0ICogQG5hbWUgJGh0dHBQcm92aWRlclxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogVXNlIGAkaHR0cFByb3ZpZGVyYCB0byBjaGFuZ2UgdGhlIGRlZmF1bHQgYmVoYXZpb3Igb2YgdGhlIHtAbGluayBuZy4kaHR0cCAkaHR0cH0gc2VydmljZS5cblx0ICogKi9cblx0ZnVuY3Rpb24gJEh0dHBQcm92aWRlcigpIHtcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgcHJvcGVydHlcblx0ICAgKiBAbmFtZSAkaHR0cFByb3ZpZGVyI2RlZmF1bHRzXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICpcblx0ICAgKiBPYmplY3QgY29udGFpbmluZyBkZWZhdWx0IHZhbHVlcyBmb3IgYWxsIHtAbGluayBuZy4kaHR0cCAkaHR0cH0gcmVxdWVzdHMuXG5cdCAgICpcblx0ICAgKiAtICoqYGRlZmF1bHRzLmNhY2hlYCoqIC0ge09iamVjdH0gLSBhbiBvYmplY3QgYnVpbHQgd2l0aCB7QGxpbmsgbmcuJGNhY2hlRmFjdG9yeSBgJGNhY2hlRmFjdG9yeWB9XG5cdCAgICogdGhhdCB3aWxsIHByb3ZpZGUgdGhlIGNhY2hlIGZvciBhbGwgcmVxdWVzdHMgd2hvIHNldCB0aGVpciBgY2FjaGVgIHByb3BlcnR5IHRvIGB0cnVlYC5cblx0ICAgKiBJZiB5b3Ugc2V0IHRoZSBgZGVmYXVsdHMuY2FjaGUgPSBmYWxzZWAgdGhlbiBvbmx5IHJlcXVlc3RzIHRoYXQgc3BlY2lmeSB0aGVpciBvd24gY3VzdG9tXG5cdCAgICogY2FjaGUgb2JqZWN0IHdpbGwgYmUgY2FjaGVkLiBTZWUge0BsaW5rICRodHRwI2NhY2hpbmcgJGh0dHAgQ2FjaGluZ30gZm9yIG1vcmUgaW5mb3JtYXRpb24uXG5cdCAgICpcblx0ICAgKiAtICoqYGRlZmF1bHRzLnhzcmZDb29raWVOYW1lYCoqIC0ge3N0cmluZ30gLSBOYW1lIG9mIGNvb2tpZSBjb250YWluaW5nIHRoZSBYU1JGIHRva2VuLlxuXHQgICAqIERlZmF1bHRzIHZhbHVlIGlzIGAnWFNSRi1UT0tFTidgLlxuXHQgICAqXG5cdCAgICogLSAqKmBkZWZhdWx0cy54c3JmSGVhZGVyTmFtZWAqKiAtIHtzdHJpbmd9IC0gTmFtZSBvZiBIVFRQIGhlYWRlciB0byBwb3B1bGF0ZSB3aXRoIHRoZVxuXHQgICAqIFhTUkYgdG9rZW4uIERlZmF1bHRzIHZhbHVlIGlzIGAnWC1YU1JGLVRPS0VOJ2AuXG5cdCAgICpcblx0ICAgKiAtICoqYGRlZmF1bHRzLmhlYWRlcnNgKiogLSB7T2JqZWN0fSAtIERlZmF1bHQgaGVhZGVycyBmb3IgYWxsICRodHRwIHJlcXVlc3RzLlxuXHQgICAqIFJlZmVyIHRvIHtAbGluayBuZy4kaHR0cCNzZXR0aW5nLWh0dHAtaGVhZGVycyAkaHR0cH0gZm9yIGRvY3VtZW50YXRpb24gb25cblx0ICAgKiBzZXR0aW5nIGRlZmF1bHQgaGVhZGVycy5cblx0ICAgKiAgICAgLSAqKmBkZWZhdWx0cy5oZWFkZXJzLmNvbW1vbmAqKlxuXHQgICAqICAgICAtICoqYGRlZmF1bHRzLmhlYWRlcnMucG9zdGAqKlxuXHQgICAqICAgICAtICoqYGRlZmF1bHRzLmhlYWRlcnMucHV0YCoqXG5cdCAgICogICAgIC0gKipgZGVmYXVsdHMuaGVhZGVycy5wYXRjaGAqKlxuXHQgICAqXG5cdCAgICpcblx0ICAgKiAtICoqYGRlZmF1bHRzLnBhcmFtU2VyaWFsaXplcmAqKiAtIGB7c3RyaW5nfGZ1bmN0aW9uKE9iamVjdDxzdHJpbmcsc3RyaW5nPik6c3RyaW5nfWAgLSBBIGZ1bmN0aW9uXG5cdCAgICogIHVzZWQgdG8gdGhlIHByZXBhcmUgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHJlcXVlc3QgcGFyYW1ldGVycyAoc3BlY2lmaWVkIGFzIGFuIG9iamVjdCkuXG5cdCAgICogIElmIHNwZWNpZmllZCBhcyBzdHJpbmcsIGl0IGlzIGludGVycHJldGVkIGFzIGEgZnVuY3Rpb24gcmVnaXN0ZXJlZCB3aXRoIHRoZSB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfS5cblx0ICAgKiAgRGVmYXVsdHMgdG8ge0BsaW5rIG5nLiRodHRwUGFyYW1TZXJpYWxpemVyICRodHRwUGFyYW1TZXJpYWxpemVyfS5cblx0ICAgKlxuXHQgICAqKi9cblx0ICB2YXIgZGVmYXVsdHMgPSB0aGlzLmRlZmF1bHRzID0ge1xuXHQgICAgLy8gdHJhbnNmb3JtIGluY29taW5nIHJlc3BvbnNlIGRhdGFcblx0ICAgIHRyYW5zZm9ybVJlc3BvbnNlOiBbZGVmYXVsdEh0dHBSZXNwb25zZVRyYW5zZm9ybV0sXG5cdFxuXHQgICAgLy8gdHJhbnNmb3JtIG91dGdvaW5nIHJlcXVlc3QgZGF0YVxuXHQgICAgdHJhbnNmb3JtUmVxdWVzdDogW2Z1bmN0aW9uKGQpIHtcblx0ICAgICAgcmV0dXJuIGlzT2JqZWN0KGQpICYmICFpc0ZpbGUoZCkgJiYgIWlzQmxvYihkKSAmJiAhaXNGb3JtRGF0YShkKSA/IHRvSnNvbihkKSA6IGQ7XG5cdCAgICB9XSxcblx0XG5cdCAgICAvLyBkZWZhdWx0IGhlYWRlcnNcblx0ICAgIGhlYWRlcnM6IHtcblx0ICAgICAgY29tbW9uOiB7XG5cdCAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyonXG5cdCAgICAgIH0sXG5cdCAgICAgIHBvc3Q6ICAgc2hhbGxvd0NvcHkoQ09OVEVOVF9UWVBFX0FQUExJQ0FUSU9OX0pTT04pLFxuXHQgICAgICBwdXQ6ICAgIHNoYWxsb3dDb3B5KENPTlRFTlRfVFlQRV9BUFBMSUNBVElPTl9KU09OKSxcblx0ICAgICAgcGF0Y2g6ICBzaGFsbG93Q29weShDT05URU5UX1RZUEVfQVBQTElDQVRJT05fSlNPTilcblx0ICAgIH0sXG5cdFxuXHQgICAgeHNyZkNvb2tpZU5hbWU6ICdYU1JGLVRPS0VOJyxcblx0ICAgIHhzcmZIZWFkZXJOYW1lOiAnWC1YU1JGLVRPS0VOJyxcblx0XG5cdCAgICBwYXJhbVNlcmlhbGl6ZXI6ICckaHR0cFBhcmFtU2VyaWFsaXplcidcblx0ICB9O1xuXHRcblx0ICB2YXIgdXNlQXBwbHlBc3luYyA9IGZhbHNlO1xuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkaHR0cFByb3ZpZGVyI3VzZUFwcGx5QXN5bmNcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKlxuXHQgICAqIENvbmZpZ3VyZSAkaHR0cCBzZXJ2aWNlIHRvIGNvbWJpbmUgcHJvY2Vzc2luZyBvZiBtdWx0aXBsZSBodHRwIHJlc3BvbnNlcyByZWNlaXZlZCBhdCBhcm91bmRcblx0ICAgKiB0aGUgc2FtZSB0aW1lIHZpYSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkYXBwbHlBc3luYyAkcm9vdFNjb3BlLiRhcHBseUFzeW5jfS4gVGhpcyBjYW4gcmVzdWx0IGluXG5cdCAgICogc2lnbmlmaWNhbnQgcGVyZm9ybWFuY2UgaW1wcm92ZW1lbnQgZm9yIGJpZ2dlciBhcHBsaWNhdGlvbnMgdGhhdCBtYWtlIG1hbnkgSFRUUCByZXF1ZXN0c1xuXHQgICAqIGNvbmN1cnJlbnRseSAoY29tbW9uIGR1cmluZyBhcHBsaWNhdGlvbiBib290c3RyYXApLlxuXHQgICAqXG5cdCAgICogRGVmYXVsdHMgdG8gZmFsc2UuIElmIG5vIHZhbHVlIGlzIHNwZWNpZmllZCwgcmV0dXJucyB0aGUgY3VycmVudCBjb25maWd1cmVkIHZhbHVlLlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtib29sZWFuPX0gdmFsdWUgSWYgdHJ1ZSwgd2hlbiByZXF1ZXN0cyBhcmUgbG9hZGVkLCB0aGV5IHdpbGwgc2NoZWR1bGUgYSBkZWZlcnJlZFxuXHQgICAqICAgIFwiYXBwbHlcIiBvbiB0aGUgbmV4dCB0aWNrLCBnaXZpbmcgdGltZSBmb3Igc3Vic2VxdWVudCByZXF1ZXN0cyBpbiBhIHJvdWdobHkgfjEwbXMgd2luZG93XG5cdCAgICogICAgdG8gbG9hZCBhbmQgc2hhcmUgdGhlIHNhbWUgZGlnZXN0IGN5Y2xlLlxuXHQgICAqXG5cdCAgICogQHJldHVybnMge2Jvb2xlYW58T2JqZWN0fSBJZiBhIHZhbHVlIGlzIHNwZWNpZmllZCwgcmV0dXJucyB0aGUgJGh0dHBQcm92aWRlciBmb3IgY2hhaW5pbmcuXG5cdCAgICogICAgb3RoZXJ3aXNlLCByZXR1cm5zIHRoZSBjdXJyZW50IGNvbmZpZ3VyZWQgdmFsdWUuXG5cdCAgICoqL1xuXHQgIHRoaXMudXNlQXBwbHlBc3luYyA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICBpZiAoaXNEZWZpbmVkKHZhbHVlKSkge1xuXHQgICAgICB1c2VBcHBseUFzeW5jID0gISF2YWx1ZTtcblx0ICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gdXNlQXBwbHlBc3luYztcblx0ICB9O1xuXHRcblx0ICB2YXIgdXNlTGVnYWN5UHJvbWlzZSA9IHRydWU7XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRodHRwUHJvdmlkZXIjdXNlTGVnYWN5UHJvbWlzZUV4dGVuc2lvbnNcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKlxuXHQgICAqIENvbmZpZ3VyZSBgJGh0dHBgIHNlcnZpY2UgdG8gcmV0dXJuIHByb21pc2VzIHdpdGhvdXQgdGhlIHNob3J0aGFuZCBtZXRob2RzIGBzdWNjZXNzYCBhbmQgYGVycm9yYC5cblx0ICAgKiBUaGlzIHNob3VsZCBiZSB1c2VkIHRvIG1ha2Ugc3VyZSB0aGF0IGFwcGxpY2F0aW9ucyB3b3JrIHdpdGhvdXQgdGhlc2UgbWV0aG9kcy5cblx0ICAgKlxuXHQgICAqIERlZmF1bHRzIHRvIHRydWUuIElmIG5vIHZhbHVlIGlzIHNwZWNpZmllZCwgcmV0dXJucyB0aGUgY3VycmVudCBjb25maWd1cmVkIHZhbHVlLlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtib29sZWFuPX0gdmFsdWUgSWYgdHJ1ZSwgYCRodHRwYCB3aWxsIHJldHVybiBhIHByb21pc2Ugd2l0aCB0aGUgZGVwcmVjYXRlZCBsZWdhY3kgYHN1Y2Nlc3NgIGFuZCBgZXJyb3JgIG1ldGhvZHMuXG5cdCAgICpcblx0ICAgKiBAcmV0dXJucyB7Ym9vbGVhbnxPYmplY3R9IElmIGEgdmFsdWUgaXMgc3BlY2lmaWVkLCByZXR1cm5zIHRoZSAkaHR0cFByb3ZpZGVyIGZvciBjaGFpbmluZy5cblx0ICAgKiAgICBvdGhlcndpc2UsIHJldHVybnMgdGhlIGN1cnJlbnQgY29uZmlndXJlZCB2YWx1ZS5cblx0ICAgKiovXG5cdCAgdGhpcy51c2VMZWdhY3lQcm9taXNlRXh0ZW5zaW9ucyA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICBpZiAoaXNEZWZpbmVkKHZhbHVlKSkge1xuXHQgICAgICB1c2VMZWdhY3lQcm9taXNlID0gISF2YWx1ZTtcblx0ICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gdXNlTGVnYWN5UHJvbWlzZTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgcHJvcGVydHlcblx0ICAgKiBAbmFtZSAkaHR0cFByb3ZpZGVyI2ludGVyY2VwdG9yc1xuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqXG5cdCAgICogQXJyYXkgY29udGFpbmluZyBzZXJ2aWNlIGZhY3RvcmllcyBmb3IgYWxsIHN5bmNocm9ub3VzIG9yIGFzeW5jaHJvbm91cyB7QGxpbmsgbmcuJGh0dHAgJGh0dHB9XG5cdCAgICogcHJlLXByb2Nlc3Npbmcgb2YgcmVxdWVzdCBvciBwb3N0cHJvY2Vzc2luZyBvZiByZXNwb25zZXMuXG5cdCAgICpcblx0ICAgKiBUaGVzZSBzZXJ2aWNlIGZhY3RvcmllcyBhcmUgb3JkZXJlZCBieSByZXF1ZXN0LCBpLmUuIHRoZXkgYXJlIGFwcGxpZWQgaW4gdGhlIHNhbWUgb3JkZXIgYXMgdGhlXG5cdCAgICogYXJyYXksIG9uIHJlcXVlc3QsIGJ1dCByZXZlcnNlIG9yZGVyLCBvbiByZXNwb25zZS5cblx0ICAgKlxuXHQgICAqIHtAbGluayBuZy4kaHR0cCNpbnRlcmNlcHRvcnMgSW50ZXJjZXB0b3JzIGRldGFpbGVkIGluZm99XG5cdCAgICoqL1xuXHQgIHZhciBpbnRlcmNlcHRvckZhY3RvcmllcyA9IHRoaXMuaW50ZXJjZXB0b3JzID0gW107XG5cdFxuXHQgIHRoaXMuJGdldCA9IFsnJGh0dHBCYWNrZW5kJywgJyQkY29va2llUmVhZGVyJywgJyRjYWNoZUZhY3RvcnknLCAnJHJvb3RTY29wZScsICckcScsICckaW5qZWN0b3InLFxuXHQgICAgICBmdW5jdGlvbigkaHR0cEJhY2tlbmQsICQkY29va2llUmVhZGVyLCAkY2FjaGVGYWN0b3J5LCAkcm9vdFNjb3BlLCAkcSwgJGluamVjdG9yKSB7XG5cdFxuXHQgICAgdmFyIGRlZmF1bHRDYWNoZSA9ICRjYWNoZUZhY3RvcnkoJyRodHRwJyk7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBNYWtlIHN1cmUgdGhhdCBkZWZhdWx0IHBhcmFtIHNlcmlhbGl6ZXIgaXMgZXhwb3NlZCBhcyBhIGZ1bmN0aW9uXG5cdCAgICAgKi9cblx0ICAgIGRlZmF1bHRzLnBhcmFtU2VyaWFsaXplciA9IGlzU3RyaW5nKGRlZmF1bHRzLnBhcmFtU2VyaWFsaXplcikgP1xuXHQgICAgICAkaW5qZWN0b3IuZ2V0KGRlZmF1bHRzLnBhcmFtU2VyaWFsaXplcikgOiBkZWZhdWx0cy5wYXJhbVNlcmlhbGl6ZXI7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBJbnRlcmNlcHRvcnMgc3RvcmVkIGluIHJldmVyc2Ugb3JkZXIuIElubmVyIGludGVyY2VwdG9ycyBiZWZvcmUgb3V0ZXIgaW50ZXJjZXB0b3JzLlxuXHQgICAgICogVGhlIHJldmVyc2FsIGlzIG5lZWRlZCBzbyB0aGF0IHdlIGNhbiBidWlsZCB1cCB0aGUgaW50ZXJjZXB0aW9uIGNoYWluIGFyb3VuZCB0aGVcblx0ICAgICAqIHNlcnZlciByZXF1ZXN0LlxuXHQgICAgICovXG5cdCAgICB2YXIgcmV2ZXJzZWRJbnRlcmNlcHRvcnMgPSBbXTtcblx0XG5cdCAgICBmb3JFYWNoKGludGVyY2VwdG9yRmFjdG9yaWVzLCBmdW5jdGlvbihpbnRlcmNlcHRvckZhY3RvcnkpIHtcblx0ICAgICAgcmV2ZXJzZWRJbnRlcmNlcHRvcnMudW5zaGlmdChpc1N0cmluZyhpbnRlcmNlcHRvckZhY3RvcnkpXG5cdCAgICAgICAgICA/ICRpbmplY3Rvci5nZXQoaW50ZXJjZXB0b3JGYWN0b3J5KSA6ICRpbmplY3Rvci5pbnZva2UoaW50ZXJjZXB0b3JGYWN0b3J5KSk7XG5cdCAgICB9KTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBzZXJ2aWNlXG5cdCAgICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAgICogQG5hbWUgJGh0dHBcblx0ICAgICAqIEByZXF1aXJlcyBuZy4kaHR0cEJhY2tlbmRcblx0ICAgICAqIEByZXF1aXJlcyAkY2FjaGVGYWN0b3J5XG5cdCAgICAgKiBAcmVxdWlyZXMgJHJvb3RTY29wZVxuXHQgICAgICogQHJlcXVpcmVzICRxXG5cdCAgICAgKiBAcmVxdWlyZXMgJGluamVjdG9yXG5cdCAgICAgKlxuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKiBUaGUgYCRodHRwYCBzZXJ2aWNlIGlzIGEgY29yZSBBbmd1bGFyIHNlcnZpY2UgdGhhdCBmYWNpbGl0YXRlcyBjb21tdW5pY2F0aW9uIHdpdGggdGhlIHJlbW90ZVxuXHQgICAgICogSFRUUCBzZXJ2ZXJzIHZpYSB0aGUgYnJvd3NlcidzIFtYTUxIdHRwUmVxdWVzdF0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4veG1saHR0cHJlcXVlc3QpXG5cdCAgICAgKiBvYmplY3Qgb3IgdmlhIFtKU09OUF0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9KU09OUCkuXG5cdCAgICAgKlxuXHQgICAgICogRm9yIHVuaXQgdGVzdGluZyBhcHBsaWNhdGlvbnMgdGhhdCB1c2UgYCRodHRwYCBzZXJ2aWNlLCBzZWVcblx0ICAgICAqIHtAbGluayBuZ01vY2suJGh0dHBCYWNrZW5kICRodHRwQmFja2VuZCBtb2NrfS5cblx0ICAgICAqXG5cdCAgICAgKiBGb3IgYSBoaWdoZXIgbGV2ZWwgb2YgYWJzdHJhY3Rpb24sIHBsZWFzZSBjaGVjayBvdXQgdGhlIHtAbGluayBuZ1Jlc291cmNlLiRyZXNvdXJjZVxuXHQgICAgICogJHJlc291cmNlfSBzZXJ2aWNlLlxuXHQgICAgICpcblx0ICAgICAqIFRoZSAkaHR0cCBBUEkgaXMgYmFzZWQgb24gdGhlIHtAbGluayBuZy4kcSBkZWZlcnJlZC9wcm9taXNlIEFQSXN9IGV4cG9zZWQgYnlcblx0ICAgICAqIHRoZSAkcSBzZXJ2aWNlLiBXaGlsZSBmb3Igc2ltcGxlIHVzYWdlIHBhdHRlcm5zIHRoaXMgZG9lc24ndCBtYXR0ZXIgbXVjaCwgZm9yIGFkdmFuY2VkIHVzYWdlXG5cdCAgICAgKiBpdCBpcyBpbXBvcnRhbnQgdG8gZmFtaWxpYXJpemUgeW91cnNlbGYgd2l0aCB0aGVzZSBBUElzIGFuZCB0aGUgZ3VhcmFudGVlcyB0aGV5IHByb3ZpZGUuXG5cdCAgICAgKlxuXHQgICAgICpcblx0ICAgICAqICMjIEdlbmVyYWwgdXNhZ2Vcblx0ICAgICAqIFRoZSBgJGh0dHBgIHNlcnZpY2UgaXMgYSBmdW5jdGlvbiB3aGljaCB0YWtlcyBhIHNpbmdsZSBhcmd1bWVudCDigJQgYSB7QGxpbmsgJGh0dHAjdXNhZ2UgY29uZmlndXJhdGlvbiBvYmplY3R9IOKAlFxuXHQgICAgICogdGhhdCBpcyB1c2VkIHRvIGdlbmVyYXRlIGFuIEhUVFAgcmVxdWVzdCBhbmQgcmV0dXJucyAgYSB7QGxpbmsgbmcuJHEgcHJvbWlzZX0uXG5cdCAgICAgKlxuXHQgICAgICogYGBganNcblx0ICAgICAqICAgLy8gU2ltcGxlIEdFVCByZXF1ZXN0IGV4YW1wbGU6XG5cdCAgICAgKiAgICRodHRwKHtcblx0ICAgICAqICAgICBtZXRob2Q6ICdHRVQnLFxuXHQgICAgICogICAgIHVybDogJy9zb21lVXJsJ1xuXHQgICAgICogICB9KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuXHQgICAgICogICAgICAgLy8gdGhpcyBjYWxsYmFjayB3aWxsIGJlIGNhbGxlZCBhc3luY2hyb25vdXNseVxuXHQgICAgICogICAgICAgLy8gd2hlbiB0aGUgcmVzcG9uc2UgaXMgYXZhaWxhYmxlXG5cdCAgICAgKiAgICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuXHQgICAgICogICAgICAgLy8gY2FsbGVkIGFzeW5jaHJvbm91c2x5IGlmIGFuIGVycm9yIG9jY3Vyc1xuXHQgICAgICogICAgICAgLy8gb3Igc2VydmVyIHJldHVybnMgcmVzcG9uc2Ugd2l0aCBhbiBlcnJvciBzdGF0dXMuXG5cdCAgICAgKiAgICAgfSk7XG5cdCAgICAgKiBgYGBcblx0ICAgICAqXG5cdCAgICAgKiBUaGUgcmVzcG9uc2Ugb2JqZWN0IGhhcyB0aGVzZSBwcm9wZXJ0aWVzOlxuXHQgICAgICpcblx0ICAgICAqICAgLSAqKmRhdGEqKiDigJMgYHtzdHJpbmd8T2JqZWN0fWAg4oCTIFRoZSByZXNwb25zZSBib2R5IHRyYW5zZm9ybWVkIHdpdGggdGhlIHRyYW5zZm9ybVxuXHQgICAgICogICAgIGZ1bmN0aW9ucy5cblx0ICAgICAqICAgLSAqKnN0YXR1cyoqIOKAkyBge251bWJlcn1gIOKAkyBIVFRQIHN0YXR1cyBjb2RlIG9mIHRoZSByZXNwb25zZS5cblx0ICAgICAqICAgLSAqKmhlYWRlcnMqKiDigJMgYHtmdW5jdGlvbihbaGVhZGVyTmFtZV0pfWAg4oCTIEhlYWRlciBnZXR0ZXIgZnVuY3Rpb24uXG5cdCAgICAgKiAgIC0gKipjb25maWcqKiDigJMgYHtPYmplY3R9YCDigJMgVGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IHRoYXQgd2FzIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIHJlcXVlc3QuXG5cdCAgICAgKiAgIC0gKipzdGF0dXNUZXh0Kiog4oCTIGB7c3RyaW5nfWAg4oCTIEhUVFAgc3RhdHVzIHRleHQgb2YgdGhlIHJlc3BvbnNlLlxuXHQgICAgICpcblx0ICAgICAqIEEgcmVzcG9uc2Ugc3RhdHVzIGNvZGUgYmV0d2VlbiAyMDAgYW5kIDI5OSBpcyBjb25zaWRlcmVkIGEgc3VjY2VzcyBzdGF0dXMgYW5kXG5cdCAgICAgKiB3aWxsIHJlc3VsdCBpbiB0aGUgc3VjY2VzcyBjYWxsYmFjayBiZWluZyBjYWxsZWQuIE5vdGUgdGhhdCBpZiB0aGUgcmVzcG9uc2UgaXMgYSByZWRpcmVjdCxcblx0ICAgICAqIFhNTEh0dHBSZXF1ZXN0IHdpbGwgdHJhbnNwYXJlbnRseSBmb2xsb3cgaXQsIG1lYW5pbmcgdGhhdCB0aGUgZXJyb3IgY2FsbGJhY2sgd2lsbCBub3QgYmVcblx0ICAgICAqIGNhbGxlZCBmb3Igc3VjaCByZXNwb25zZXMuXG5cdCAgICAgKlxuXHQgICAgICpcblx0ICAgICAqICMjIFNob3J0Y3V0IG1ldGhvZHNcblx0ICAgICAqXG5cdCAgICAgKiBTaG9ydGN1dCBtZXRob2RzIGFyZSBhbHNvIGF2YWlsYWJsZS4gQWxsIHNob3J0Y3V0IG1ldGhvZHMgcmVxdWlyZSBwYXNzaW5nIGluIHRoZSBVUkwsIGFuZFxuXHQgICAgICogcmVxdWVzdCBkYXRhIG11c3QgYmUgcGFzc2VkIGluIGZvciBQT1NUL1BVVCByZXF1ZXN0cy4gQW4gb3B0aW9uYWwgY29uZmlnIGNhbiBiZSBwYXNzZWQgYXMgdGhlXG5cdCAgICAgKiBsYXN0IGFyZ3VtZW50LlxuXHQgICAgICpcblx0ICAgICAqIGBgYGpzXG5cdCAgICAgKiAgICRodHRwLmdldCgnL3NvbWVVcmwnLCBjb25maWcpLnRoZW4oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKTtcblx0ICAgICAqICAgJGh0dHAucG9zdCgnL3NvbWVVcmwnLCBkYXRhLCBjb25maWcpLnRoZW4oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKTtcblx0ICAgICAqIGBgYFxuXHQgICAgICpcblx0ICAgICAqIENvbXBsZXRlIGxpc3Qgb2Ygc2hvcnRjdXQgbWV0aG9kczpcblx0ICAgICAqXG5cdCAgICAgKiAtIHtAbGluayBuZy4kaHR0cCNnZXQgJGh0dHAuZ2V0fVxuXHQgICAgICogLSB7QGxpbmsgbmcuJGh0dHAjaGVhZCAkaHR0cC5oZWFkfVxuXHQgICAgICogLSB7QGxpbmsgbmcuJGh0dHAjcG9zdCAkaHR0cC5wb3N0fVxuXHQgICAgICogLSB7QGxpbmsgbmcuJGh0dHAjcHV0ICRodHRwLnB1dH1cblx0ICAgICAqIC0ge0BsaW5rIG5nLiRodHRwI2RlbGV0ZSAkaHR0cC5kZWxldGV9XG5cdCAgICAgKiAtIHtAbGluayBuZy4kaHR0cCNqc29ucCAkaHR0cC5qc29ucH1cblx0ICAgICAqIC0ge0BsaW5rIG5nLiRodHRwI3BhdGNoICRodHRwLnBhdGNofVxuXHQgICAgICpcblx0ICAgICAqXG5cdCAgICAgKiAjIyBXcml0aW5nIFVuaXQgVGVzdHMgdGhhdCB1c2UgJGh0dHBcblx0ICAgICAqIFdoZW4gdW5pdCB0ZXN0aW5nICh1c2luZyB7QGxpbmsgbmdNb2NrIG5nTW9ja30pLCBpdCBpcyBuZWNlc3NhcnkgdG8gY2FsbFxuXHQgICAgICoge0BsaW5rIG5nTW9jay4kaHR0cEJhY2tlbmQjZmx1c2ggJGh0dHBCYWNrZW5kLmZsdXNoKCl9IHRvIGZsdXNoIGVhY2ggcGVuZGluZ1xuXHQgICAgICogcmVxdWVzdCB1c2luZyB0cmFpbmVkIHJlc3BvbnNlcy5cblx0ICAgICAqXG5cdCAgICAgKiBgYGBcblx0ICAgICAqICRodHRwQmFja2VuZC5leHBlY3RHRVQoLi4uKTtcblx0ICAgICAqICRodHRwLmdldCguLi4pO1xuXHQgICAgICogJGh0dHBCYWNrZW5kLmZsdXNoKCk7XG5cdCAgICAgKiBgYGBcblx0ICAgICAqXG5cdCAgICAgKiAjIyBEZXByZWNhdGlvbiBOb3RpY2Vcblx0ICAgICAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1kYW5nZXJcIj5cblx0ICAgICAqICAgVGhlIGAkaHR0cGAgbGVnYWN5IHByb21pc2UgbWV0aG9kcyBgc3VjY2Vzc2AgYW5kIGBlcnJvcmAgaGF2ZSBiZWVuIGRlcHJlY2F0ZWQuXG5cdCAgICAgKiAgIFVzZSB0aGUgc3RhbmRhcmQgYHRoZW5gIG1ldGhvZCBpbnN0ZWFkLlxuXHQgICAgICogICBJZiB7QGxpbmsgJGh0dHBQcm92aWRlciN1c2VMZWdhY3lQcm9taXNlRXh0ZW5zaW9ucyBgJGh0dHBQcm92aWRlci51c2VMZWdhY3lQcm9taXNlRXh0ZW5zaW9uc2B9IGlzIHNldCB0b1xuXHQgICAgICogICBgZmFsc2VgIHRoZW4gdGhlc2UgbWV0aG9kcyB3aWxsIHRocm93IHtAbGluayAkaHR0cDpsZWdhY3kgYCRodHRwL2xlZ2FjeWB9IGVycm9yLlxuXHQgICAgICogPC9kaXY+XG5cdCAgICAgKlxuXHQgICAgICogIyMgU2V0dGluZyBIVFRQIEhlYWRlcnNcblx0ICAgICAqXG5cdCAgICAgKiBUaGUgJGh0dHAgc2VydmljZSB3aWxsIGF1dG9tYXRpY2FsbHkgYWRkIGNlcnRhaW4gSFRUUCBoZWFkZXJzIHRvIGFsbCByZXF1ZXN0cy4gVGhlc2UgZGVmYXVsdHNcblx0ICAgICAqIGNhbiBiZSBmdWxseSBjb25maWd1cmVkIGJ5IGFjY2Vzc2luZyB0aGUgYCRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVyc2AgY29uZmlndXJhdGlvblxuXHQgICAgICogb2JqZWN0LCB3aGljaCBjdXJyZW50bHkgY29udGFpbnMgdGhpcyBkZWZhdWx0IGNvbmZpZ3VyYXRpb246XG5cdCAgICAgKlxuXHQgICAgICogLSBgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vbmAgKGhlYWRlcnMgdGhhdCBhcmUgY29tbW9uIGZvciBhbGwgcmVxdWVzdHMpOlxuXHQgICAgICogICAtIGBBY2NlcHQ6IGFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICogLyAqYFxuXHQgICAgICogLSBgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLnBvc3RgOiAoaGVhZGVyIGRlZmF1bHRzIGZvciBQT1NUIHJlcXVlc3RzKVxuXHQgICAgICogICAtIGBDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb25gXG5cdCAgICAgKiAtIGAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMucHV0YCAoaGVhZGVyIGRlZmF1bHRzIGZvciBQVVQgcmVxdWVzdHMpXG5cdCAgICAgKiAgIC0gYENvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbmBcblx0ICAgICAqXG5cdCAgICAgKiBUbyBhZGQgb3Igb3ZlcndyaXRlIHRoZXNlIGRlZmF1bHRzLCBzaW1wbHkgYWRkIG9yIHJlbW92ZSBhIHByb3BlcnR5IGZyb20gdGhlc2UgY29uZmlndXJhdGlvblxuXHQgICAgICogb2JqZWN0cy4gVG8gYWRkIGhlYWRlcnMgZm9yIGFuIEhUVFAgbWV0aG9kIG90aGVyIHRoYW4gUE9TVCBvciBQVVQsIHNpbXBseSBhZGQgYSBuZXcgb2JqZWN0XG5cdCAgICAgKiB3aXRoIHRoZSBsb3dlcmNhc2VkIEhUVFAgbWV0aG9kIG5hbWUgYXMgdGhlIGtleSwgZS5nLlxuXHQgICAgICogYCRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXQgPSB7ICdNeS1IZWFkZXInIDogJ3ZhbHVlJyB9YC5cblx0ICAgICAqXG5cdCAgICAgKiBUaGUgZGVmYXVsdHMgY2FuIGFsc28gYmUgc2V0IGF0IHJ1bnRpbWUgdmlhIHRoZSBgJGh0dHAuZGVmYXVsdHNgIG9iamVjdCBpbiB0aGUgc2FtZVxuXHQgICAgICogZmFzaGlvbi4gRm9yIGV4YW1wbGU6XG5cdCAgICAgKlxuXHQgICAgICogYGBgXG5cdCAgICAgKiBtb2R1bGUucnVuKGZ1bmN0aW9uKCRodHRwKSB7XG5cdCAgICAgKiAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uLkF1dGhvcml6YXRpb24gPSAnQmFzaWMgWW1WbGNEcGliMjl3Jztcblx0ICAgICAqIH0pO1xuXHQgICAgICogYGBgXG5cdCAgICAgKlxuXHQgICAgICogSW4gYWRkaXRpb24sIHlvdSBjYW4gc3VwcGx5IGEgYGhlYWRlcnNgIHByb3BlcnR5IGluIHRoZSBjb25maWcgb2JqZWN0IHBhc3NlZCB3aGVuXG5cdCAgICAgKiBjYWxsaW5nIGAkaHR0cChjb25maWcpYCwgd2hpY2ggb3ZlcnJpZGVzIHRoZSBkZWZhdWx0cyB3aXRob3V0IGNoYW5naW5nIHRoZW0gZ2xvYmFsbHkuXG5cdCAgICAgKlxuXHQgICAgICogVG8gZXhwbGljaXRseSByZW1vdmUgYSBoZWFkZXIgYXV0b21hdGljYWxseSBhZGRlZCB2aWEgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzIG9uIGEgcGVyIHJlcXVlc3QgYmFzaXMsXG5cdCAgICAgKiBVc2UgdGhlIGBoZWFkZXJzYCBwcm9wZXJ0eSwgc2V0dGluZyB0aGUgZGVzaXJlZCBoZWFkZXIgdG8gYHVuZGVmaW5lZGAuIEZvciBleGFtcGxlOlxuXHQgICAgICpcblx0ICAgICAqIGBgYGpzXG5cdCAgICAgKiB2YXIgcmVxID0ge1xuXHQgICAgICogIG1ldGhvZDogJ1BPU1QnLFxuXHQgICAgICogIHVybDogJ2h0dHA6Ly9leGFtcGxlLmNvbScsXG5cdCAgICAgKiAgaGVhZGVyczoge1xuXHQgICAgICogICAgJ0NvbnRlbnQtVHlwZSc6IHVuZGVmaW5lZFxuXHQgICAgICogIH0sXG5cdCAgICAgKiAgZGF0YTogeyB0ZXN0OiAndGVzdCcgfVxuXHQgICAgICogfVxuXHQgICAgICpcblx0ICAgICAqICRodHRwKHJlcSkudGhlbihmdW5jdGlvbigpey4uLn0sIGZ1bmN0aW9uKCl7Li4ufSk7XG5cdCAgICAgKiBgYGBcblx0ICAgICAqXG5cdCAgICAgKiAjIyBUcmFuc2Zvcm1pbmcgUmVxdWVzdHMgYW5kIFJlc3BvbnNlc1xuXHQgICAgICpcblx0ICAgICAqIEJvdGggcmVxdWVzdHMgYW5kIHJlc3BvbnNlcyBjYW4gYmUgdHJhbnNmb3JtZWQgdXNpbmcgdHJhbnNmb3JtYXRpb24gZnVuY3Rpb25zOiBgdHJhbnNmb3JtUmVxdWVzdGBcblx0ICAgICAqIGFuZCBgdHJhbnNmb3JtUmVzcG9uc2VgLiBUaGVzZSBwcm9wZXJ0aWVzIGNhbiBiZSBhIHNpbmdsZSBmdW5jdGlvbiB0aGF0IHJldHVybnNcblx0ICAgICAqIHRoZSB0cmFuc2Zvcm1lZCB2YWx1ZSAoYGZ1bmN0aW9uKGRhdGEsIGhlYWRlcnNHZXR0ZXIsIHN0YXR1cylgKSBvciBhbiBhcnJheSBvZiBzdWNoIHRyYW5zZm9ybWF0aW9uIGZ1bmN0aW9ucyxcblx0ICAgICAqIHdoaWNoIGFsbG93cyB5b3UgdG8gYHB1c2hgIG9yIGB1bnNoaWZ0YCBhIG5ldyB0cmFuc2Zvcm1hdGlvbiBmdW5jdGlvbiBpbnRvIHRoZSB0cmFuc2Zvcm1hdGlvbiBjaGFpbi5cblx0ICAgICAqXG5cdCAgICAgKiAjIyMgRGVmYXVsdCBUcmFuc2Zvcm1hdGlvbnNcblx0ICAgICAqXG5cdCAgICAgKiBUaGUgYCRodHRwUHJvdmlkZXJgIHByb3ZpZGVyIGFuZCBgJGh0dHBgIHNlcnZpY2UgZXhwb3NlIGBkZWZhdWx0cy50cmFuc2Zvcm1SZXF1ZXN0YCBhbmRcblx0ICAgICAqIGBkZWZhdWx0cy50cmFuc2Zvcm1SZXNwb25zZWAgcHJvcGVydGllcy4gSWYgYSByZXF1ZXN0IGRvZXMgbm90IHByb3ZpZGUgaXRzIG93biB0cmFuc2Zvcm1hdGlvbnNcblx0ICAgICAqIHRoZW4gdGhlc2Ugd2lsbCBiZSBhcHBsaWVkLlxuXHQgICAgICpcblx0ICAgICAqIFlvdSBjYW4gYXVnbWVudCBvciByZXBsYWNlIHRoZSBkZWZhdWx0IHRyYW5zZm9ybWF0aW9ucyBieSBtb2RpZnlpbmcgdGhlc2UgcHJvcGVydGllcyBieSBhZGRpbmcgdG8gb3Jcblx0ICAgICAqIHJlcGxhY2luZyB0aGUgYXJyYXkuXG5cdCAgICAgKlxuXHQgICAgICogQW5ndWxhciBwcm92aWRlcyB0aGUgZm9sbG93aW5nIGRlZmF1bHQgdHJhbnNmb3JtYXRpb25zOlxuXHQgICAgICpcblx0ICAgICAqIFJlcXVlc3QgdHJhbnNmb3JtYXRpb25zIChgJGh0dHBQcm92aWRlci5kZWZhdWx0cy50cmFuc2Zvcm1SZXF1ZXN0YCBhbmQgYCRodHRwLmRlZmF1bHRzLnRyYW5zZm9ybVJlcXVlc3RgKTpcblx0ICAgICAqXG5cdCAgICAgKiAtIElmIHRoZSBgZGF0YWAgcHJvcGVydHkgb2YgdGhlIHJlcXVlc3QgY29uZmlndXJhdGlvbiBvYmplY3QgY29udGFpbnMgYW4gb2JqZWN0LCBzZXJpYWxpemUgaXRcblx0ICAgICAqICAgaW50byBKU09OIGZvcm1hdC5cblx0ICAgICAqXG5cdCAgICAgKiBSZXNwb25zZSB0cmFuc2Zvcm1hdGlvbnMgKGAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLnRyYW5zZm9ybVJlc3BvbnNlYCBhbmQgYCRodHRwLmRlZmF1bHRzLnRyYW5zZm9ybVJlc3BvbnNlYCk6XG5cdCAgICAgKlxuXHQgICAgICogIC0gSWYgWFNSRiBwcmVmaXggaXMgZGV0ZWN0ZWQsIHN0cmlwIGl0IChzZWUgU2VjdXJpdHkgQ29uc2lkZXJhdGlvbnMgc2VjdGlvbiBiZWxvdykuXG5cdCAgICAgKiAgLSBJZiBKU09OIHJlc3BvbnNlIGlzIGRldGVjdGVkLCBkZXNlcmlhbGl6ZSBpdCB1c2luZyBhIEpTT04gcGFyc2VyLlxuXHQgICAgICpcblx0ICAgICAqXG5cdCAgICAgKiAjIyMgT3ZlcnJpZGluZyB0aGUgRGVmYXVsdCBUcmFuc2Zvcm1hdGlvbnMgUGVyIFJlcXVlc3Rcblx0ICAgICAqXG5cdCAgICAgKiBJZiB5b3Ugd2lzaCBvdmVycmlkZSB0aGUgcmVxdWVzdC9yZXNwb25zZSB0cmFuc2Zvcm1hdGlvbnMgb25seSBmb3IgYSBzaW5nbGUgcmVxdWVzdCB0aGVuIHByb3ZpZGVcblx0ICAgICAqIGB0cmFuc2Zvcm1SZXF1ZXN0YCBhbmQvb3IgYHRyYW5zZm9ybVJlc3BvbnNlYCBwcm9wZXJ0aWVzIG9uIHRoZSBjb25maWd1cmF0aW9uIG9iamVjdCBwYXNzZWRcblx0ICAgICAqIGludG8gYCRodHRwYC5cblx0ICAgICAqXG5cdCAgICAgKiBOb3RlIHRoYXQgaWYgeW91IHByb3ZpZGUgdGhlc2UgcHJvcGVydGllcyBvbiB0aGUgY29uZmlnIG9iamVjdCB0aGUgZGVmYXVsdCB0cmFuc2Zvcm1hdGlvbnMgd2lsbCBiZVxuXHQgICAgICogb3ZlcndyaXR0ZW4uIElmIHlvdSB3aXNoIHRvIGF1Z21lbnQgdGhlIGRlZmF1bHQgdHJhbnNmb3JtYXRpb25zIHRoZW4geW91IG11c3QgaW5jbHVkZSB0aGVtIGluIHlvdXJcblx0ICAgICAqIGxvY2FsIHRyYW5zZm9ybWF0aW9uIGFycmF5LlxuXHQgICAgICpcblx0ICAgICAqIFRoZSBmb2xsb3dpbmcgY29kZSBkZW1vbnN0cmF0ZXMgYWRkaW5nIGEgbmV3IHJlc3BvbnNlIHRyYW5zZm9ybWF0aW9uIHRvIGJlIHJ1biBhZnRlciB0aGUgZGVmYXVsdCByZXNwb25zZVxuXHQgICAgICogdHJhbnNmb3JtYXRpb25zIGhhdmUgYmVlbiBydW4uXG5cdCAgICAgKlxuXHQgICAgICogYGBganNcblx0ICAgICAqIGZ1bmN0aW9uIGFwcGVuZFRyYW5zZm9ybShkZWZhdWx0cywgdHJhbnNmb3JtKSB7XG5cdCAgICAgKlxuXHQgICAgICogICAvLyBXZSBjYW4ndCBndWFyYW50ZWUgdGhhdCB0aGUgZGVmYXVsdCB0cmFuc2Zvcm1hdGlvbiBpcyBhbiBhcnJheVxuXHQgICAgICogICBkZWZhdWx0cyA9IGFuZ3VsYXIuaXNBcnJheShkZWZhdWx0cykgPyBkZWZhdWx0cyA6IFtkZWZhdWx0c107XG5cdCAgICAgKlxuXHQgICAgICogICAvLyBBcHBlbmQgdGhlIG5ldyB0cmFuc2Zvcm1hdGlvbiB0byB0aGUgZGVmYXVsdHNcblx0ICAgICAqICAgcmV0dXJuIGRlZmF1bHRzLmNvbmNhdCh0cmFuc2Zvcm0pO1xuXHQgICAgICogfVxuXHQgICAgICpcblx0ICAgICAqICRodHRwKHtcblx0ICAgICAqICAgdXJsOiAnLi4uJyxcblx0ICAgICAqICAgbWV0aG9kOiAnR0VUJyxcblx0ICAgICAqICAgdHJhbnNmb3JtUmVzcG9uc2U6IGFwcGVuZFRyYW5zZm9ybSgkaHR0cC5kZWZhdWx0cy50cmFuc2Zvcm1SZXNwb25zZSwgZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAqICAgICByZXR1cm4gZG9UcmFuc2Zvcm0odmFsdWUpO1xuXHQgICAgICogICB9KVxuXHQgICAgICogfSk7XG5cdCAgICAgKiBgYGBcblx0ICAgICAqXG5cdCAgICAgKlxuXHQgICAgICogIyMgQ2FjaGluZ1xuXHQgICAgICpcblx0ICAgICAqIFRvIGVuYWJsZSBjYWNoaW5nLCBzZXQgdGhlIHJlcXVlc3QgY29uZmlndXJhdGlvbiBgY2FjaGVgIHByb3BlcnR5IHRvIGB0cnVlYCAodG8gdXNlIGRlZmF1bHRcblx0ICAgICAqIGNhY2hlKSBvciB0byBhIGN1c3RvbSBjYWNoZSBvYmplY3QgKGJ1aWx0IHdpdGgge0BsaW5rIG5nLiRjYWNoZUZhY3RvcnkgYCRjYWNoZUZhY3RvcnlgfSkuXG5cdCAgICAgKiBXaGVuIHRoZSBjYWNoZSBpcyBlbmFibGVkLCBgJGh0dHBgIHN0b3JlcyB0aGUgcmVzcG9uc2UgZnJvbSB0aGUgc2VydmVyIGluIHRoZSBzcGVjaWZpZWRcblx0ICAgICAqIGNhY2hlLiBUaGUgbmV4dCB0aW1lIHRoZSBzYW1lIHJlcXVlc3QgaXMgbWFkZSwgdGhlIHJlc3BvbnNlIGlzIHNlcnZlZCBmcm9tIHRoZSBjYWNoZSB3aXRob3V0XG5cdCAgICAgKiBzZW5kaW5nIGEgcmVxdWVzdCB0byB0aGUgc2VydmVyLlxuXHQgICAgICpcblx0ICAgICAqIE5vdGUgdGhhdCBldmVuIGlmIHRoZSByZXNwb25zZSBpcyBzZXJ2ZWQgZnJvbSBjYWNoZSwgZGVsaXZlcnkgb2YgdGhlIGRhdGEgaXMgYXN5bmNocm9ub3VzIGluXG5cdCAgICAgKiB0aGUgc2FtZSB3YXkgdGhhdCByZWFsIHJlcXVlc3RzIGFyZS5cblx0ICAgICAqXG5cdCAgICAgKiBJZiB0aGVyZSBhcmUgbXVsdGlwbGUgR0VUIHJlcXVlc3RzIGZvciB0aGUgc2FtZSBVUkwgdGhhdCBzaG91bGQgYmUgY2FjaGVkIHVzaW5nIHRoZSBzYW1lXG5cdCAgICAgKiBjYWNoZSwgYnV0IHRoZSBjYWNoZSBpcyBub3QgcG9wdWxhdGVkIHlldCwgb25seSBvbmUgcmVxdWVzdCB0byB0aGUgc2VydmVyIHdpbGwgYmUgbWFkZSBhbmRcblx0ICAgICAqIHRoZSByZW1haW5pbmcgcmVxdWVzdHMgd2lsbCBiZSBmdWxmaWxsZWQgdXNpbmcgdGhlIHJlc3BvbnNlIGZyb20gdGhlIGZpcnN0IHJlcXVlc3QuXG5cdCAgICAgKlxuXHQgICAgICogWW91IGNhbiBjaGFuZ2UgdGhlIGRlZmF1bHQgY2FjaGUgdG8gYSBuZXcgb2JqZWN0IChidWlsdCB3aXRoXG5cdCAgICAgKiB7QGxpbmsgbmcuJGNhY2hlRmFjdG9yeSBgJGNhY2hlRmFjdG9yeWB9KSBieSB1cGRhdGluZyB0aGVcblx0ICAgICAqIHtAbGluayBuZy4kaHR0cCNkZWZhdWx0cyBgJGh0dHAuZGVmYXVsdHMuY2FjaGVgfSBwcm9wZXJ0eS4gQWxsIHJlcXVlc3RzIHdobyBzZXRcblx0ICAgICAqIHRoZWlyIGBjYWNoZWAgcHJvcGVydHkgdG8gYHRydWVgIHdpbGwgbm93IHVzZSB0aGlzIGNhY2hlIG9iamVjdC5cblx0ICAgICAqXG5cdCAgICAgKiBJZiB5b3Ugc2V0IHRoZSBkZWZhdWx0IGNhY2hlIHRvIGBmYWxzZWAgdGhlbiBvbmx5IHJlcXVlc3RzIHRoYXQgc3BlY2lmeSB0aGVpciBvd24gY3VzdG9tXG5cdCAgICAgKiBjYWNoZSBvYmplY3Qgd2lsbCBiZSBjYWNoZWQuXG5cdCAgICAgKlxuXHQgICAgICogIyMgSW50ZXJjZXB0b3JzXG5cdCAgICAgKlxuXHQgICAgICogQmVmb3JlIHlvdSBzdGFydCBjcmVhdGluZyBpbnRlcmNlcHRvcnMsIGJlIHN1cmUgdG8gdW5kZXJzdGFuZCB0aGVcblx0ICAgICAqIHtAbGluayBuZy4kcSAkcSBhbmQgZGVmZXJyZWQvcHJvbWlzZSBBUElzfS5cblx0ICAgICAqXG5cdCAgICAgKiBGb3IgcHVycG9zZXMgb2YgZ2xvYmFsIGVycm9yIGhhbmRsaW5nLCBhdXRoZW50aWNhdGlvbiwgb3IgYW55IGtpbmQgb2Ygc3luY2hyb25vdXMgb3Jcblx0ICAgICAqIGFzeW5jaHJvbm91cyBwcmUtcHJvY2Vzc2luZyBvZiByZXF1ZXN0IG9yIHBvc3Rwcm9jZXNzaW5nIG9mIHJlc3BvbnNlcywgaXQgaXMgZGVzaXJhYmxlIHRvIGJlXG5cdCAgICAgKiBhYmxlIHRvIGludGVyY2VwdCByZXF1ZXN0cyBiZWZvcmUgdGhleSBhcmUgaGFuZGVkIHRvIHRoZSBzZXJ2ZXIgYW5kXG5cdCAgICAgKiByZXNwb25zZXMgYmVmb3JlIHRoZXkgYXJlIGhhbmRlZCBvdmVyIHRvIHRoZSBhcHBsaWNhdGlvbiBjb2RlIHRoYXRcblx0ICAgICAqIGluaXRpYXRlZCB0aGVzZSByZXF1ZXN0cy4gVGhlIGludGVyY2VwdG9ycyBsZXZlcmFnZSB0aGUge0BsaW5rIG5nLiRxXG5cdCAgICAgKiBwcm9taXNlIEFQSXN9IHRvIGZ1bGZpbGwgdGhpcyBuZWVkIGZvciBib3RoIHN5bmNocm9ub3VzIGFuZCBhc3luY2hyb25vdXMgcHJlLXByb2Nlc3NpbmcuXG5cdCAgICAgKlxuXHQgICAgICogVGhlIGludGVyY2VwdG9ycyBhcmUgc2VydmljZSBmYWN0b3JpZXMgdGhhdCBhcmUgcmVnaXN0ZXJlZCB3aXRoIHRoZSBgJGh0dHBQcm92aWRlcmAgYnlcblx0ICAgICAqIGFkZGluZyB0aGVtIHRvIHRoZSBgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnNgIGFycmF5LiBUaGUgZmFjdG9yeSBpcyBjYWxsZWQgYW5kXG5cdCAgICAgKiBpbmplY3RlZCB3aXRoIGRlcGVuZGVuY2llcyAoaWYgc3BlY2lmaWVkKSBhbmQgcmV0dXJucyB0aGUgaW50ZXJjZXB0b3IuXG5cdCAgICAgKlxuXHQgICAgICogVGhlcmUgYXJlIHR3byBraW5kcyBvZiBpbnRlcmNlcHRvcnMgKGFuZCB0d28ga2luZHMgb2YgcmVqZWN0aW9uIGludGVyY2VwdG9ycyk6XG5cdCAgICAgKlxuXHQgICAgICogICAqIGByZXF1ZXN0YDogaW50ZXJjZXB0b3JzIGdldCBjYWxsZWQgd2l0aCBhIGh0dHAge0BsaW5rICRodHRwI3VzYWdlIGNvbmZpZ30gb2JqZWN0LiBUaGUgZnVuY3Rpb24gaXMgZnJlZSB0b1xuXHQgICAgICogICAgIG1vZGlmeSB0aGUgYGNvbmZpZ2Agb2JqZWN0IG9yIGNyZWF0ZSBhIG5ldyBvbmUuIFRoZSBmdW5jdGlvbiBuZWVkcyB0byByZXR1cm4gdGhlIGBjb25maWdgXG5cdCAgICAgKiAgICAgb2JqZWN0IGRpcmVjdGx5LCBvciBhIHByb21pc2UgY29udGFpbmluZyB0aGUgYGNvbmZpZ2Agb3IgYSBuZXcgYGNvbmZpZ2Agb2JqZWN0LlxuXHQgICAgICogICAqIGByZXF1ZXN0RXJyb3JgOiBpbnRlcmNlcHRvciBnZXRzIGNhbGxlZCB3aGVuIGEgcHJldmlvdXMgaW50ZXJjZXB0b3IgdGhyZXcgYW4gZXJyb3Igb3Jcblx0ICAgICAqICAgICByZXNvbHZlZCB3aXRoIGEgcmVqZWN0aW9uLlxuXHQgICAgICogICAqIGByZXNwb25zZWA6IGludGVyY2VwdG9ycyBnZXQgY2FsbGVkIHdpdGggaHR0cCBgcmVzcG9uc2VgIG9iamVjdC4gVGhlIGZ1bmN0aW9uIGlzIGZyZWUgdG9cblx0ICAgICAqICAgICBtb2RpZnkgdGhlIGByZXNwb25zZWAgb2JqZWN0IG9yIGNyZWF0ZSBhIG5ldyBvbmUuIFRoZSBmdW5jdGlvbiBuZWVkcyB0byByZXR1cm4gdGhlIGByZXNwb25zZWBcblx0ICAgICAqICAgICBvYmplY3QgZGlyZWN0bHksIG9yIGFzIGEgcHJvbWlzZSBjb250YWluaW5nIHRoZSBgcmVzcG9uc2VgIG9yIGEgbmV3IGByZXNwb25zZWAgb2JqZWN0LlxuXHQgICAgICogICAqIGByZXNwb25zZUVycm9yYDogaW50ZXJjZXB0b3IgZ2V0cyBjYWxsZWQgd2hlbiBhIHByZXZpb3VzIGludGVyY2VwdG9yIHRocmV3IGFuIGVycm9yIG9yXG5cdCAgICAgKiAgICAgcmVzb2x2ZWQgd2l0aCBhIHJlamVjdGlvbi5cblx0ICAgICAqXG5cdCAgICAgKlxuXHQgICAgICogYGBganNcblx0ICAgICAqICAgLy8gcmVnaXN0ZXIgdGhlIGludGVyY2VwdG9yIGFzIGEgc2VydmljZVxuXHQgICAgICogICAkcHJvdmlkZS5mYWN0b3J5KCdteUh0dHBJbnRlcmNlcHRvcicsIGZ1bmN0aW9uKCRxLCBkZXBlbmRlbmN5MSwgZGVwZW5kZW5jeTIpIHtcblx0ICAgICAqICAgICByZXR1cm4ge1xuXHQgICAgICogICAgICAgLy8gb3B0aW9uYWwgbWV0aG9kXG5cdCAgICAgKiAgICAgICAncmVxdWVzdCc6IGZ1bmN0aW9uKGNvbmZpZykge1xuXHQgICAgICogICAgICAgICAvLyBkbyBzb21ldGhpbmcgb24gc3VjY2Vzc1xuXHQgICAgICogICAgICAgICByZXR1cm4gY29uZmlnO1xuXHQgICAgICogICAgICAgfSxcblx0ICAgICAqXG5cdCAgICAgKiAgICAgICAvLyBvcHRpb25hbCBtZXRob2Rcblx0ICAgICAqICAgICAgJ3JlcXVlc3RFcnJvcic6IGZ1bmN0aW9uKHJlamVjdGlvbikge1xuXHQgICAgICogICAgICAgICAvLyBkbyBzb21ldGhpbmcgb24gZXJyb3Jcblx0ICAgICAqICAgICAgICAgaWYgKGNhblJlY292ZXIocmVqZWN0aW9uKSkge1xuXHQgICAgICogICAgICAgICAgIHJldHVybiByZXNwb25zZU9yTmV3UHJvbWlzZVxuXHQgICAgICogICAgICAgICB9XG5cdCAgICAgKiAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVqZWN0aW9uKTtcblx0ICAgICAqICAgICAgIH0sXG5cdCAgICAgKlxuXHQgICAgICpcblx0ICAgICAqXG5cdCAgICAgKiAgICAgICAvLyBvcHRpb25hbCBtZXRob2Rcblx0ICAgICAqICAgICAgICdyZXNwb25zZSc6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdCAgICAgKiAgICAgICAgIC8vIGRvIHNvbWV0aGluZyBvbiBzdWNjZXNzXG5cdCAgICAgKiAgICAgICAgIHJldHVybiByZXNwb25zZTtcblx0ICAgICAqICAgICAgIH0sXG5cdCAgICAgKlxuXHQgICAgICogICAgICAgLy8gb3B0aW9uYWwgbWV0aG9kXG5cdCAgICAgKiAgICAgICdyZXNwb25zZUVycm9yJzogZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG5cdCAgICAgKiAgICAgICAgIC8vIGRvIHNvbWV0aGluZyBvbiBlcnJvclxuXHQgICAgICogICAgICAgICBpZiAoY2FuUmVjb3ZlcihyZWplY3Rpb24pKSB7XG5cdCAgICAgKiAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlT3JOZXdQcm9taXNlXG5cdCAgICAgKiAgICAgICAgIH1cblx0ICAgICAqICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZWplY3Rpb24pO1xuXHQgICAgICogICAgICAgfVxuXHQgICAgICogICAgIH07XG5cdCAgICAgKiAgIH0pO1xuXHQgICAgICpcblx0ICAgICAqICAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnbXlIdHRwSW50ZXJjZXB0b3InKTtcblx0ICAgICAqXG5cdCAgICAgKlxuXHQgICAgICogICAvLyBhbHRlcm5hdGl2ZWx5LCByZWdpc3RlciB0aGUgaW50ZXJjZXB0b3IgdmlhIGFuIGFub255bW91cyBmYWN0b3J5XG5cdCAgICAgKiAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goZnVuY3Rpb24oJHEsIGRlcGVuZGVuY3kxLCBkZXBlbmRlbmN5Mikge1xuXHQgICAgICogICAgIHJldHVybiB7XG5cdCAgICAgKiAgICAgICdyZXF1ZXN0JzogZnVuY3Rpb24oY29uZmlnKSB7XG5cdCAgICAgKiAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlXG5cdCAgICAgKiAgICAgICB9LFxuXHQgICAgICpcblx0ICAgICAqICAgICAgICdyZXNwb25zZSc6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdCAgICAgKiAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlXG5cdCAgICAgKiAgICAgICB9XG5cdCAgICAgKiAgICAgfTtcblx0ICAgICAqICAgfSk7XG5cdCAgICAgKiBgYGBcblx0ICAgICAqXG5cdCAgICAgKiAjIyBTZWN1cml0eSBDb25zaWRlcmF0aW9uc1xuXHQgICAgICpcblx0ICAgICAqIFdoZW4gZGVzaWduaW5nIHdlYiBhcHBsaWNhdGlvbnMsIGNvbnNpZGVyIHNlY3VyaXR5IHRocmVhdHMgZnJvbTpcblx0ICAgICAqXG5cdCAgICAgKiAtIFtKU09OIHZ1bG5lcmFiaWxpdHldKGh0dHA6Ly9oYWFja2VkLmNvbS9hcmNoaXZlLzIwMDgvMTEvMjAvYW5hdG9teS1vZi1hLXN1YnRsZS1qc29uLXZ1bG5lcmFiaWxpdHkuYXNweClcblx0ICAgICAqIC0gW1hTUkZdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ3Jvc3Mtc2l0ZV9yZXF1ZXN0X2ZvcmdlcnkpXG5cdCAgICAgKlxuXHQgICAgICogQm90aCBzZXJ2ZXIgYW5kIHRoZSBjbGllbnQgbXVzdCBjb29wZXJhdGUgaW4gb3JkZXIgdG8gZWxpbWluYXRlIHRoZXNlIHRocmVhdHMuIEFuZ3VsYXIgY29tZXNcblx0ICAgICAqIHByZS1jb25maWd1cmVkIHdpdGggc3RyYXRlZ2llcyB0aGF0IGFkZHJlc3MgdGhlc2UgaXNzdWVzLCBidXQgZm9yIHRoaXMgdG8gd29yayBiYWNrZW5kIHNlcnZlclxuXHQgICAgICogY29vcGVyYXRpb24gaXMgcmVxdWlyZWQuXG5cdCAgICAgKlxuXHQgICAgICogIyMjIEpTT04gVnVsbmVyYWJpbGl0eSBQcm90ZWN0aW9uXG5cdCAgICAgKlxuXHQgICAgICogQSBbSlNPTiB2dWxuZXJhYmlsaXR5XShodHRwOi8vaGFhY2tlZC5jb20vYXJjaGl2ZS8yMDA4LzExLzIwL2FuYXRvbXktb2YtYS1zdWJ0bGUtanNvbi12dWxuZXJhYmlsaXR5LmFzcHgpXG5cdCAgICAgKiBhbGxvd3MgdGhpcmQgcGFydHkgd2Vic2l0ZSB0byB0dXJuIHlvdXIgSlNPTiByZXNvdXJjZSBVUkwgaW50b1xuXHQgICAgICogW0pTT05QXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0pTT05QKSByZXF1ZXN0IHVuZGVyIHNvbWUgY29uZGl0aW9ucy4gVG9cblx0ICAgICAqIGNvdW50ZXIgdGhpcyB5b3VyIHNlcnZlciBjYW4gcHJlZml4IGFsbCBKU09OIHJlcXVlc3RzIHdpdGggZm9sbG93aW5nIHN0cmluZyBgXCIpXX0nLFxcblwiYC5cblx0ICAgICAqIEFuZ3VsYXIgd2lsbCBhdXRvbWF0aWNhbGx5IHN0cmlwIHRoZSBwcmVmaXggYmVmb3JlIHByb2Nlc3NpbmcgaXQgYXMgSlNPTi5cblx0ICAgICAqXG5cdCAgICAgKiBGb3IgZXhhbXBsZSBpZiB5b3VyIHNlcnZlciBuZWVkcyB0byByZXR1cm46XG5cdCAgICAgKiBgYGBqc1xuXHQgICAgICogWydvbmUnLCd0d28nXVxuXHQgICAgICogYGBgXG5cdCAgICAgKlxuXHQgICAgICogd2hpY2ggaXMgdnVsbmVyYWJsZSB0byBhdHRhY2ssIHlvdXIgc2VydmVyIGNhbiByZXR1cm46XG5cdCAgICAgKiBgYGBqc1xuXHQgICAgICogKV19Jyxcblx0ICAgICAqIFsnb25lJywndHdvJ11cblx0ICAgICAqIGBgYFxuXHQgICAgICpcblx0ICAgICAqIEFuZ3VsYXIgd2lsbCBzdHJpcCB0aGUgcHJlZml4LCBiZWZvcmUgcHJvY2Vzc2luZyB0aGUgSlNPTi5cblx0ICAgICAqXG5cdCAgICAgKlxuXHQgICAgICogIyMjIENyb3NzIFNpdGUgUmVxdWVzdCBGb3JnZXJ5IChYU1JGKSBQcm90ZWN0aW9uXG5cdCAgICAgKlxuXHQgICAgICogW1hTUkZdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ3Jvc3Mtc2l0ZV9yZXF1ZXN0X2ZvcmdlcnkpIGlzIGFuIGF0dGFjayB0ZWNobmlxdWUgYnlcblx0ICAgICAqIHdoaWNoIHRoZSBhdHRhY2tlciBjYW4gdHJpY2sgYW4gYXV0aGVudGljYXRlZCB1c2VyIGludG8gdW5rbm93aW5nbHkgZXhlY3V0aW5nIGFjdGlvbnMgb24geW91clxuXHQgICAgICogd2Vic2l0ZS4gQW5ndWxhciBwcm92aWRlcyBhIG1lY2hhbmlzbSB0byBjb3VudGVyIFhTUkYuIFdoZW4gcGVyZm9ybWluZyBYSFIgcmVxdWVzdHMsIHRoZVxuXHQgICAgICogJGh0dHAgc2VydmljZSByZWFkcyBhIHRva2VuIGZyb20gYSBjb29raWUgKGJ5IGRlZmF1bHQsIGBYU1JGLVRPS0VOYCkgYW5kIHNldHMgaXQgYXMgYW4gSFRUUFxuXHQgICAgICogaGVhZGVyIChgWC1YU1JGLVRPS0VOYCkuIFNpbmNlIG9ubHkgSmF2YVNjcmlwdCB0aGF0IHJ1bnMgb24geW91ciBkb21haW4gY291bGQgcmVhZCB0aGVcblx0ICAgICAqIGNvb2tpZSwgeW91ciBzZXJ2ZXIgY2FuIGJlIGFzc3VyZWQgdGhhdCB0aGUgWEhSIGNhbWUgZnJvbSBKYXZhU2NyaXB0IHJ1bm5pbmcgb24geW91ciBkb21haW4uXG5cdCAgICAgKiBUaGUgaGVhZGVyIHdpbGwgbm90IGJlIHNldCBmb3IgY3Jvc3MtZG9tYWluIHJlcXVlc3RzLlxuXHQgICAgICpcblx0ICAgICAqIFRvIHRha2UgYWR2YW50YWdlIG9mIHRoaXMsIHlvdXIgc2VydmVyIG5lZWRzIHRvIHNldCBhIHRva2VuIGluIGEgSmF2YVNjcmlwdCByZWFkYWJsZSBzZXNzaW9uXG5cdCAgICAgKiBjb29raWUgY2FsbGVkIGBYU1JGLVRPS0VOYCBvbiB0aGUgZmlyc3QgSFRUUCBHRVQgcmVxdWVzdC4gT24gc3Vic2VxdWVudCBYSFIgcmVxdWVzdHMgdGhlXG5cdCAgICAgKiBzZXJ2ZXIgY2FuIHZlcmlmeSB0aGF0IHRoZSBjb29raWUgbWF0Y2hlcyBgWC1YU1JGLVRPS0VOYCBIVFRQIGhlYWRlciwgYW5kIHRoZXJlZm9yZSBiZSBzdXJlXG5cdCAgICAgKiB0aGF0IG9ubHkgSmF2YVNjcmlwdCBydW5uaW5nIG9uIHlvdXIgZG9tYWluIGNvdWxkIGhhdmUgc2VudCB0aGUgcmVxdWVzdC4gVGhlIHRva2VuIG11c3QgYmVcblx0ICAgICAqIHVuaXF1ZSBmb3IgZWFjaCB1c2VyIGFuZCBtdXN0IGJlIHZlcmlmaWFibGUgYnkgdGhlIHNlcnZlciAodG8gcHJldmVudCB0aGUgSmF2YVNjcmlwdCBmcm9tXG5cdCAgICAgKiBtYWtpbmcgdXAgaXRzIG93biB0b2tlbnMpLiBXZSByZWNvbW1lbmQgdGhhdCB0aGUgdG9rZW4gaXMgYSBkaWdlc3Qgb2YgeW91ciBzaXRlJ3Ncblx0ICAgICAqIGF1dGhlbnRpY2F0aW9uIGNvb2tpZSB3aXRoIGEgW3NhbHRdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1NhbHRfKGNyeXB0b2dyYXBoeSYjNDE7KVxuXHQgICAgICogZm9yIGFkZGVkIHNlY3VyaXR5LlxuXHQgICAgICpcblx0ICAgICAqIFRoZSBuYW1lIG9mIHRoZSBoZWFkZXJzIGNhbiBiZSBzcGVjaWZpZWQgdXNpbmcgdGhlIHhzcmZIZWFkZXJOYW1lIGFuZCB4c3JmQ29va2llTmFtZVxuXHQgICAgICogcHJvcGVydGllcyBvZiBlaXRoZXIgJGh0dHBQcm92aWRlci5kZWZhdWx0cyBhdCBjb25maWctdGltZSwgJGh0dHAuZGVmYXVsdHMgYXQgcnVuLXRpbWUsXG5cdCAgICAgKiBvciB0aGUgcGVyLXJlcXVlc3QgY29uZmlnIG9iamVjdC5cblx0ICAgICAqXG5cdCAgICAgKiBJbiBvcmRlciB0byBwcmV2ZW50IGNvbGxpc2lvbnMgaW4gZW52aXJvbm1lbnRzIHdoZXJlIG11bHRpcGxlIEFuZ3VsYXIgYXBwcyBzaGFyZSB0aGVcblx0ICAgICAqIHNhbWUgZG9tYWluIG9yIHN1YmRvbWFpbiwgd2UgcmVjb21tZW5kIHRoYXQgZWFjaCBhcHBsaWNhdGlvbiB1c2VzIHVuaXF1ZSBjb29raWUgbmFtZS5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge29iamVjdH0gY29uZmlnIE9iamVjdCBkZXNjcmliaW5nIHRoZSByZXF1ZXN0IHRvIGJlIG1hZGUgYW5kIGhvdyBpdCBzaG91bGQgYmVcblx0ICAgICAqICAgIHByb2Nlc3NlZC4gVGhlIG9iamVjdCBoYXMgZm9sbG93aW5nIHByb3BlcnRpZXM6XG5cdCAgICAgKlxuXHQgICAgICogICAgLSAqKm1ldGhvZCoqIOKAkyBge3N0cmluZ31gIOKAkyBIVFRQIG1ldGhvZCAoZS5nLiAnR0VUJywgJ1BPU1QnLCBldGMpXG5cdCAgICAgKiAgICAtICoqdXJsKiog4oCTIGB7c3RyaW5nfWAg4oCTIEFic29sdXRlIG9yIHJlbGF0aXZlIFVSTCBvZiB0aGUgcmVzb3VyY2UgdGhhdCBpcyBiZWluZyByZXF1ZXN0ZWQuXG5cdCAgICAgKiAgICAtICoqcGFyYW1zKiog4oCTIGB7T2JqZWN0LjxzdHJpbmd8T2JqZWN0Pn1gIOKAkyBNYXAgb2Ygc3RyaW5ncyBvciBvYmplY3RzIHdoaWNoIHdpbGwgYmUgc2VyaWFsaXplZFxuXHQgICAgICogICAgICB3aXRoIHRoZSBgcGFyYW1TZXJpYWxpemVyYCBhbmQgYXBwZW5kZWQgYXMgR0VUIHBhcmFtZXRlcnMuXG5cdCAgICAgKiAgICAtICoqZGF0YSoqIOKAkyBge3N0cmluZ3xPYmplY3R9YCDigJMgRGF0YSB0byBiZSBzZW50IGFzIHRoZSByZXF1ZXN0IG1lc3NhZ2UgZGF0YS5cblx0ICAgICAqICAgIC0gKipoZWFkZXJzKiog4oCTIGB7T2JqZWN0fWAg4oCTIE1hcCBvZiBzdHJpbmdzIG9yIGZ1bmN0aW9ucyB3aGljaCByZXR1cm4gc3RyaW5ncyByZXByZXNlbnRpbmdcblx0ICAgICAqICAgICAgSFRUUCBoZWFkZXJzIHRvIHNlbmQgdG8gdGhlIHNlcnZlci4gSWYgdGhlIHJldHVybiB2YWx1ZSBvZiBhIGZ1bmN0aW9uIGlzIG51bGwsIHRoZVxuXHQgICAgICogICAgICBoZWFkZXIgd2lsbCBub3QgYmUgc2VudC4gRnVuY3Rpb25zIGFjY2VwdCBhIGNvbmZpZyBvYmplY3QgYXMgYW4gYXJndW1lbnQuXG5cdCAgICAgKiAgICAtICoqeHNyZkhlYWRlck5hbWUqKiDigJMgYHtzdHJpbmd9YCDigJMgTmFtZSBvZiBIVFRQIGhlYWRlciB0byBwb3B1bGF0ZSB3aXRoIHRoZSBYU1JGIHRva2VuLlxuXHQgICAgICogICAgLSAqKnhzcmZDb29raWVOYW1lKiog4oCTIGB7c3RyaW5nfWAg4oCTIE5hbWUgb2YgY29va2llIGNvbnRhaW5pbmcgdGhlIFhTUkYgdG9rZW4uXG5cdCAgICAgKiAgICAtICoqdHJhbnNmb3JtUmVxdWVzdCoqIOKAk1xuXHQgICAgICogICAgICBge2Z1bmN0aW9uKGRhdGEsIGhlYWRlcnNHZXR0ZXIpfEFycmF5LjxmdW5jdGlvbihkYXRhLCBoZWFkZXJzR2V0dGVyKT59YCDigJNcblx0ICAgICAqICAgICAgdHJhbnNmb3JtIGZ1bmN0aW9uIG9yIGFuIGFycmF5IG9mIHN1Y2ggZnVuY3Rpb25zLiBUaGUgdHJhbnNmb3JtIGZ1bmN0aW9uIHRha2VzIHRoZSBodHRwXG5cdCAgICAgKiAgICAgIHJlcXVlc3QgYm9keSBhbmQgaGVhZGVycyBhbmQgcmV0dXJucyBpdHMgdHJhbnNmb3JtZWQgKHR5cGljYWxseSBzZXJpYWxpemVkKSB2ZXJzaW9uLlxuXHQgICAgICogICAgICBTZWUge0BsaW5rIG5nLiRodHRwI292ZXJyaWRpbmctdGhlLWRlZmF1bHQtdHJhbnNmb3JtYXRpb25zLXBlci1yZXF1ZXN0XG5cdCAgICAgKiAgICAgIE92ZXJyaWRpbmcgdGhlIERlZmF1bHQgVHJhbnNmb3JtYXRpb25zfVxuXHQgICAgICogICAgLSAqKnRyYW5zZm9ybVJlc3BvbnNlKiog4oCTXG5cdCAgICAgKiAgICAgIGB7ZnVuY3Rpb24oZGF0YSwgaGVhZGVyc0dldHRlciwgc3RhdHVzKXxBcnJheS48ZnVuY3Rpb24oZGF0YSwgaGVhZGVyc0dldHRlciwgc3RhdHVzKT59YCDigJNcblx0ICAgICAqICAgICAgdHJhbnNmb3JtIGZ1bmN0aW9uIG9yIGFuIGFycmF5IG9mIHN1Y2ggZnVuY3Rpb25zLiBUaGUgdHJhbnNmb3JtIGZ1bmN0aW9uIHRha2VzIHRoZSBodHRwXG5cdCAgICAgKiAgICAgIHJlc3BvbnNlIGJvZHksIGhlYWRlcnMgYW5kIHN0YXR1cyBhbmQgcmV0dXJucyBpdHMgdHJhbnNmb3JtZWQgKHR5cGljYWxseSBkZXNlcmlhbGl6ZWQpIHZlcnNpb24uXG5cdCAgICAgKiAgICAgIFNlZSB7QGxpbmsgbmcuJGh0dHAjb3ZlcnJpZGluZy10aGUtZGVmYXVsdC10cmFuc2Zvcm1hdGlvbnMtcGVyLXJlcXVlc3Rcblx0ICAgICAqICAgICAgT3ZlcnJpZGluZyB0aGUgRGVmYXVsdCBUcmFuc2Zvcm1hdGlvbmpxTGlrc31cblx0ICAgICAqICAgIC0gKipwYXJhbVNlcmlhbGl6ZXIqKiAtIGB7c3RyaW5nfGZ1bmN0aW9uKE9iamVjdDxzdHJpbmcsc3RyaW5nPik6c3RyaW5nfWAgLSBBIGZ1bmN0aW9uIHVzZWQgdG9cblx0ICAgICAqICAgICAgcHJlcGFyZSB0aGUgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHJlcXVlc3QgcGFyYW1ldGVycyAoc3BlY2lmaWVkIGFzIGFuIG9iamVjdCkuXG5cdCAgICAgKiAgICAgIElmIHNwZWNpZmllZCBhcyBzdHJpbmcsIGl0IGlzIGludGVycHJldGVkIGFzIGZ1bmN0aW9uIHJlZ2lzdGVyZWQgd2l0aCB0aGVcblx0ICAgICAqICAgICAge0BsaW5rICRpbmplY3RvciAkaW5qZWN0b3J9LCB3aGljaCBtZWFucyB5b3UgY2FuIGNyZWF0ZSB5b3VyIG93biBzZXJpYWxpemVyXG5cdCAgICAgKiAgICAgIGJ5IHJlZ2lzdGVyaW5nIGl0IGFzIGEge0BsaW5rIGF1dG8uJHByb3ZpZGUjc2VydmljZSBzZXJ2aWNlfS5cblx0ICAgICAqICAgICAgVGhlIGRlZmF1bHQgc2VyaWFsaXplciBpcyB0aGUge0BsaW5rICRodHRwUGFyYW1TZXJpYWxpemVyICRodHRwUGFyYW1TZXJpYWxpemVyfTtcblx0ICAgICAqICAgICAgYWx0ZXJuYXRpdmVseSwgeW91IGNhbiB1c2UgdGhlIHtAbGluayAkaHR0cFBhcmFtU2VyaWFsaXplckpRTGlrZSAkaHR0cFBhcmFtU2VyaWFsaXplckpRTGlrZX1cblx0ICAgICAqICAgIC0gKipjYWNoZSoqIOKAkyBge2Jvb2xlYW58Q2FjaGV9YCDigJMgSWYgdHJ1ZSwgYSBkZWZhdWx0ICRodHRwIGNhY2hlIHdpbGwgYmUgdXNlZCB0byBjYWNoZSB0aGVcblx0ICAgICAqICAgICAgR0VUIHJlcXVlc3QsIG90aGVyd2lzZSBpZiBhIGNhY2hlIGluc3RhbmNlIGJ1aWx0IHdpdGhcblx0ICAgICAqICAgICAge0BsaW5rIG5nLiRjYWNoZUZhY3RvcnkgJGNhY2hlRmFjdG9yeX0sIHRoaXMgY2FjaGUgd2lsbCBiZSB1c2VkIGZvclxuXHQgICAgICogICAgICBjYWNoaW5nLlxuXHQgICAgICogICAgLSAqKnRpbWVvdXQqKiDigJMgYHtudW1iZXJ8UHJvbWlzZX1gIOKAkyB0aW1lb3V0IGluIG1pbGxpc2Vjb25kcywgb3Ige0BsaW5rIG5nLiRxIHByb21pc2V9XG5cdCAgICAgKiAgICAgIHRoYXQgc2hvdWxkIGFib3J0IHRoZSByZXF1ZXN0IHdoZW4gcmVzb2x2ZWQuXG5cdCAgICAgKiAgICAtICoqd2l0aENyZWRlbnRpYWxzKiogLSBge2Jvb2xlYW59YCAtIHdoZXRoZXIgdG8gc2V0IHRoZSBgd2l0aENyZWRlbnRpYWxzYCBmbGFnIG9uIHRoZVxuXHQgICAgICogICAgICBYSFIgb2JqZWN0LiBTZWUgW3JlcXVlc3RzIHdpdGggY3JlZGVudGlhbHNdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2RvY3MvV2ViL0hUVFAvQWNjZXNzX2NvbnRyb2xfQ09SUyNSZXF1ZXN0c193aXRoX2NyZWRlbnRpYWxzKVxuXHQgICAgICogICAgICBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cblx0ICAgICAqICAgIC0gKipyZXNwb25zZVR5cGUqKiAtIGB7c3RyaW5nfWAgLSBzZWVcblx0ICAgICAqICAgICAgW1hNTEh0dHBSZXF1ZXN0LnJlc3BvbnNlVHlwZV0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1hNTEh0dHBSZXF1ZXN0I3htbGh0dHByZXF1ZXN0LXJlc3BvbnNldHlwZSkuXG5cdCAgICAgKlxuXHQgICAgICogQHJldHVybnMge0h0dHBQcm9taXNlfSBSZXR1cm5zIGEge0BsaW5rIG5nLiRxIGBQcm9taXNlfWAgdGhhdCB3aWxsIGJlIHJlc29sdmVkIHRvIGEgcmVzcG9uc2Ugb2JqZWN0XG5cdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdGhlIHJlcXVlc3Qgc3VjY2VlZHMgb3IgZmFpbHMuXG5cdCAgICAgKlxuXHQgICAgICpcblx0ICAgICAqIEBwcm9wZXJ0eSB7QXJyYXkuPE9iamVjdD59IHBlbmRpbmdSZXF1ZXN0cyBBcnJheSBvZiBjb25maWcgb2JqZWN0cyBmb3IgY3VycmVudGx5IHBlbmRpbmdcblx0ICAgICAqICAgcmVxdWVzdHMuIFRoaXMgaXMgcHJpbWFyaWx5IG1lYW50IHRvIGJlIHVzZWQgZm9yIGRlYnVnZ2luZyBwdXJwb3Nlcy5cblx0ICAgICAqXG5cdCAgICAgKlxuXHQgICAgICogQGV4YW1wbGVcblx0PGV4YW1wbGUgbW9kdWxlPVwiaHR0cEV4YW1wbGVcIj5cblx0PGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJGZXRjaENvbnRyb2xsZXJcIj5cblx0ICAgIDxzZWxlY3QgbmctbW9kZWw9XCJtZXRob2RcIiBhcmlhLWxhYmVsPVwiUmVxdWVzdCBtZXRob2RcIj5cblx0ICAgICAgPG9wdGlvbj5HRVQ8L29wdGlvbj5cblx0ICAgICAgPG9wdGlvbj5KU09OUDwvb3B0aW9uPlxuXHQgICAgPC9zZWxlY3Q+XG5cdCAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cInVybFwiIHNpemU9XCI4MFwiIGFyaWEtbGFiZWw9XCJVUkxcIiAvPlxuXHQgICAgPGJ1dHRvbiBpZD1cImZldGNoYnRuXCIgbmctY2xpY2s9XCJmZXRjaCgpXCI+ZmV0Y2g8L2J1dHRvbj48YnI+XG5cdCAgICA8YnV0dG9uIGlkPVwic2FtcGxlZ2V0YnRuXCIgbmctY2xpY2s9XCJ1cGRhdGVNb2RlbCgnR0VUJywgJ2h0dHAtaGVsbG8uaHRtbCcpXCI+U2FtcGxlIEdFVDwvYnV0dG9uPlxuXHQgICAgPGJ1dHRvbiBpZD1cInNhbXBsZWpzb25wYnRuXCJcblx0ICAgICAgbmctY2xpY2s9XCJ1cGRhdGVNb2RlbCgnSlNPTlAnLFxuXHQgICAgICAgICAgICAgICAgICAgICdodHRwczovL2FuZ3VsYXJqcy5vcmcvZ3JlZXQucGhwP2NhbGxiYWNrPUpTT05fQ0FMTEJBQ0smbmFtZT1TdXBlciUyMEhlcm8nKVwiPlxuXHQgICAgICBTYW1wbGUgSlNPTlBcblx0ICAgIDwvYnV0dG9uPlxuXHQgICAgPGJ1dHRvbiBpZD1cImludmFsaWRqc29ucGJ0blwiXG5cdCAgICAgIG5nLWNsaWNrPVwidXBkYXRlTW9kZWwoJ0pTT05QJywgJ2h0dHBzOi8vYW5ndWxhcmpzLm9yZy9kb2VzbnRleGlzdCZjYWxsYmFjaz1KU09OX0NBTExCQUNLJylcIj5cblx0ICAgICAgICBJbnZhbGlkIEpTT05QXG5cdCAgICAgIDwvYnV0dG9uPlxuXHQgICAgPHByZT5odHRwIHN0YXR1cyBjb2RlOiB7e3N0YXR1c319PC9wcmU+XG5cdCAgICA8cHJlPmh0dHAgcmVzcG9uc2UgZGF0YToge3tkYXRhfX08L3ByZT5cblx0ICA8L2Rpdj5cblx0PC9maWxlPlxuXHQ8ZmlsZSBuYW1lPVwic2NyaXB0LmpzXCI+XG5cdCAgYW5ndWxhci5tb2R1bGUoJ2h0dHBFeGFtcGxlJywgW10pXG5cdCAgICAuY29udHJvbGxlcignRmV0Y2hDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnJHRlbXBsYXRlQ2FjaGUnLFxuXHQgICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkdGVtcGxhdGVDYWNoZSkge1xuXHQgICAgICAgICRzY29wZS5tZXRob2QgPSAnR0VUJztcblx0ICAgICAgICAkc2NvcGUudXJsID0gJ2h0dHAtaGVsbG8uaHRtbCc7XG5cdFxuXHQgICAgICAgICRzY29wZS5mZXRjaCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgJHNjb3BlLmNvZGUgPSBudWxsO1xuXHQgICAgICAgICAgJHNjb3BlLnJlc3BvbnNlID0gbnVsbDtcblx0XG5cdCAgICAgICAgICAkaHR0cCh7bWV0aG9kOiAkc2NvcGUubWV0aG9kLCB1cmw6ICRzY29wZS51cmwsIGNhY2hlOiAkdGVtcGxhdGVDYWNoZX0pLlxuXHQgICAgICAgICAgICB0aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdCAgICAgICAgICAgICAgJHNjb3BlLnN0YXR1cyA9IHJlc3BvbnNlLnN0YXR1cztcblx0ICAgICAgICAgICAgICAkc2NvcGUuZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG5cdCAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdCAgICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSByZXNwb25zZS5kYXRhIHx8IFwiUmVxdWVzdCBmYWlsZWRcIjtcblx0ICAgICAgICAgICAgICAkc2NvcGUuc3RhdHVzID0gcmVzcG9uc2Uuc3RhdHVzO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfTtcblx0XG5cdCAgICAgICAgJHNjb3BlLnVwZGF0ZU1vZGVsID0gZnVuY3Rpb24obWV0aG9kLCB1cmwpIHtcblx0ICAgICAgICAgICRzY29wZS5tZXRob2QgPSBtZXRob2Q7XG5cdCAgICAgICAgICAkc2NvcGUudXJsID0gdXJsO1xuXHQgICAgICAgIH07XG5cdCAgICAgIH1dKTtcblx0PC9maWxlPlxuXHQ8ZmlsZSBuYW1lPVwiaHR0cC1oZWxsby5odG1sXCI+XG5cdCAgSGVsbG8sICRodHRwIVxuXHQ8L2ZpbGU+XG5cdDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICB2YXIgc3RhdHVzID0gZWxlbWVudChieS5iaW5kaW5nKCdzdGF0dXMnKSk7XG5cdCAgdmFyIGRhdGEgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2RhdGEnKSk7XG5cdCAgdmFyIGZldGNoQnRuID0gZWxlbWVudChieS5pZCgnZmV0Y2hidG4nKSk7XG5cdCAgdmFyIHNhbXBsZUdldEJ0biA9IGVsZW1lbnQoYnkuaWQoJ3NhbXBsZWdldGJ0bicpKTtcblx0ICB2YXIgc2FtcGxlSnNvbnBCdG4gPSBlbGVtZW50KGJ5LmlkKCdzYW1wbGVqc29ucGJ0bicpKTtcblx0ICB2YXIgaW52YWxpZEpzb25wQnRuID0gZWxlbWVudChieS5pZCgnaW52YWxpZGpzb25wYnRuJykpO1xuXHRcblx0ICBpdCgnc2hvdWxkIG1ha2UgYW4geGhyIEdFVCByZXF1ZXN0JywgZnVuY3Rpb24oKSB7XG5cdCAgICBzYW1wbGVHZXRCdG4uY2xpY2soKTtcblx0ICAgIGZldGNoQnRuLmNsaWNrKCk7XG5cdCAgICBleHBlY3Qoc3RhdHVzLmdldFRleHQoKSkudG9NYXRjaCgnMjAwJyk7XG5cdCAgICBleHBlY3QoZGF0YS5nZXRUZXh0KCkpLnRvTWF0Y2goL0hlbGxvLCBcXCRodHRwIS8pO1xuXHQgIH0pO1xuXHRcblx0Ly8gQ29tbWVudGVkIG91dCBkdWUgdG8gZmxha2VzLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy9pc3N1ZXMvOTE4NVxuXHQvLyBpdCgnc2hvdWxkIG1ha2UgYSBKU09OUCByZXF1ZXN0IHRvIGFuZ3VsYXJqcy5vcmcnLCBmdW5jdGlvbigpIHtcblx0Ly8gICBzYW1wbGVKc29ucEJ0bi5jbGljaygpO1xuXHQvLyAgIGZldGNoQnRuLmNsaWNrKCk7XG5cdC8vICAgZXhwZWN0KHN0YXR1cy5nZXRUZXh0KCkpLnRvTWF0Y2goJzIwMCcpO1xuXHQvLyAgIGV4cGVjdChkYXRhLmdldFRleHQoKSkudG9NYXRjaCgvU3VwZXIgSGVybyEvKTtcblx0Ly8gfSk7XG5cdFxuXHQgIGl0KCdzaG91bGQgbWFrZSBKU09OUCByZXF1ZXN0IHRvIGludmFsaWQgVVJMIGFuZCBpbnZva2UgdGhlIGVycm9yIGhhbmRsZXInLFxuXHQgICAgICBmdW5jdGlvbigpIHtcblx0ICAgIGludmFsaWRKc29ucEJ0bi5jbGljaygpO1xuXHQgICAgZmV0Y2hCdG4uY2xpY2soKTtcblx0ICAgIGV4cGVjdChzdGF0dXMuZ2V0VGV4dCgpKS50b01hdGNoKCcwJyk7XG5cdCAgICBleHBlY3QoZGF0YS5nZXRUZXh0KCkpLnRvTWF0Y2goJ1JlcXVlc3QgZmFpbGVkJyk7XG5cdCAgfSk7XG5cdDwvZmlsZT5cblx0PC9leGFtcGxlPlxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiAkaHR0cChyZXF1ZXN0Q29uZmlnKSB7XG5cdFxuXHQgICAgICBpZiAoIWlzT2JqZWN0KHJlcXVlc3RDb25maWcpKSB7XG5cdCAgICAgICAgdGhyb3cgbWluRXJyKCckaHR0cCcpKCdiYWRyZXEnLCAnSHR0cCByZXF1ZXN0IGNvbmZpZ3VyYXRpb24gbXVzdCBiZSBhbiBvYmplY3QuICBSZWNlaXZlZDogezB9JywgcmVxdWVzdENvbmZpZyk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGlmICghaXNTdHJpbmcocmVxdWVzdENvbmZpZy51cmwpKSB7XG5cdCAgICAgICAgdGhyb3cgbWluRXJyKCckaHR0cCcpKCdiYWRyZXEnLCAnSHR0cCByZXF1ZXN0IGNvbmZpZ3VyYXRpb24gdXJsIG11c3QgYmUgYSBzdHJpbmcuICBSZWNlaXZlZDogezB9JywgcmVxdWVzdENvbmZpZy51cmwpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICB2YXIgY29uZmlnID0gZXh0ZW5kKHtcblx0ICAgICAgICBtZXRob2Q6ICdnZXQnLFxuXHQgICAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IGRlZmF1bHRzLnRyYW5zZm9ybVJlcXVlc3QsXG5cdCAgICAgICAgdHJhbnNmb3JtUmVzcG9uc2U6IGRlZmF1bHRzLnRyYW5zZm9ybVJlc3BvbnNlLFxuXHQgICAgICAgIHBhcmFtU2VyaWFsaXplcjogZGVmYXVsdHMucGFyYW1TZXJpYWxpemVyXG5cdCAgICAgIH0sIHJlcXVlc3RDb25maWcpO1xuXHRcblx0ICAgICAgY29uZmlnLmhlYWRlcnMgPSBtZXJnZUhlYWRlcnMocmVxdWVzdENvbmZpZyk7XG5cdCAgICAgIGNvbmZpZy5tZXRob2QgPSB1cHBlcmNhc2UoY29uZmlnLm1ldGhvZCk7XG5cdCAgICAgIGNvbmZpZy5wYXJhbVNlcmlhbGl6ZXIgPSBpc1N0cmluZyhjb25maWcucGFyYW1TZXJpYWxpemVyKSA/XG5cdCAgICAgICAgJGluamVjdG9yLmdldChjb25maWcucGFyYW1TZXJpYWxpemVyKSA6IGNvbmZpZy5wYXJhbVNlcmlhbGl6ZXI7XG5cdFxuXHQgICAgICB2YXIgc2VydmVyUmVxdWVzdCA9IGZ1bmN0aW9uKGNvbmZpZykge1xuXHQgICAgICAgIHZhciBoZWFkZXJzID0gY29uZmlnLmhlYWRlcnM7XG5cdCAgICAgICAgdmFyIHJlcURhdGEgPSB0cmFuc2Zvcm1EYXRhKGNvbmZpZy5kYXRhLCBoZWFkZXJzR2V0dGVyKGhlYWRlcnMpLCB1bmRlZmluZWQsIGNvbmZpZy50cmFuc2Zvcm1SZXF1ZXN0KTtcblx0XG5cdCAgICAgICAgLy8gc3RyaXAgY29udGVudC10eXBlIGlmIGRhdGEgaXMgdW5kZWZpbmVkXG5cdCAgICAgICAgaWYgKGlzVW5kZWZpbmVkKHJlcURhdGEpKSB7XG5cdCAgICAgICAgICBmb3JFYWNoKGhlYWRlcnMsIGZ1bmN0aW9uKHZhbHVlLCBoZWFkZXIpIHtcblx0ICAgICAgICAgICAgaWYgKGxvd2VyY2FzZShoZWFkZXIpID09PSAnY29udGVudC10eXBlJykge1xuXHQgICAgICAgICAgICAgICAgZGVsZXRlIGhlYWRlcnNbaGVhZGVyXTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAoaXNVbmRlZmluZWQoY29uZmlnLndpdGhDcmVkZW50aWFscykgJiYgIWlzVW5kZWZpbmVkKGRlZmF1bHRzLndpdGhDcmVkZW50aWFscykpIHtcblx0ICAgICAgICAgIGNvbmZpZy53aXRoQ3JlZGVudGlhbHMgPSBkZWZhdWx0cy53aXRoQ3JlZGVudGlhbHM7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvLyBzZW5kIHJlcXVlc3Rcblx0ICAgICAgICByZXR1cm4gc2VuZFJlcShjb25maWcsIHJlcURhdGEpLnRoZW4odHJhbnNmb3JtUmVzcG9uc2UsIHRyYW5zZm9ybVJlc3BvbnNlKTtcblx0ICAgICAgfTtcblx0XG5cdCAgICAgIHZhciBjaGFpbiA9IFtzZXJ2ZXJSZXF1ZXN0LCB1bmRlZmluZWRdO1xuXHQgICAgICB2YXIgcHJvbWlzZSA9ICRxLndoZW4oY29uZmlnKTtcblx0XG5cdCAgICAgIC8vIGFwcGx5IGludGVyY2VwdG9yc1xuXHQgICAgICBmb3JFYWNoKHJldmVyc2VkSW50ZXJjZXB0b3JzLCBmdW5jdGlvbihpbnRlcmNlcHRvcikge1xuXHQgICAgICAgIGlmIChpbnRlcmNlcHRvci5yZXF1ZXN0IHx8IGludGVyY2VwdG9yLnJlcXVlc3RFcnJvcikge1xuXHQgICAgICAgICAgY2hhaW4udW5zaGlmdChpbnRlcmNlcHRvci5yZXF1ZXN0LCBpbnRlcmNlcHRvci5yZXF1ZXN0RXJyb3IpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAoaW50ZXJjZXB0b3IucmVzcG9uc2UgfHwgaW50ZXJjZXB0b3IucmVzcG9uc2VFcnJvcikge1xuXHQgICAgICAgICAgY2hhaW4ucHVzaChpbnRlcmNlcHRvci5yZXNwb25zZSwgaW50ZXJjZXB0b3IucmVzcG9uc2VFcnJvcik7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHdoaWxlIChjaGFpbi5sZW5ndGgpIHtcblx0ICAgICAgICB2YXIgdGhlbkZuID0gY2hhaW4uc2hpZnQoKTtcblx0ICAgICAgICB2YXIgcmVqZWN0Rm4gPSBjaGFpbi5zaGlmdCgpO1xuXHRcblx0ICAgICAgICBwcm9taXNlID0gcHJvbWlzZS50aGVuKHRoZW5GbiwgcmVqZWN0Rm4pO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBpZiAodXNlTGVnYWN5UHJvbWlzZSkge1xuXHQgICAgICAgIHByb21pc2Uuc3VjY2VzcyA9IGZ1bmN0aW9uKGZuKSB7XG5cdCAgICAgICAgICBhc3NlcnRBcmdGbihmbiwgJ2ZuJyk7XG5cdFxuXHQgICAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdCAgICAgICAgICAgIGZuKHJlc3BvbnNlLmRhdGEsIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2UuaGVhZGVycywgY29uZmlnKTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG5cdCAgICAgICAgfTtcblx0XG5cdCAgICAgICAgcHJvbWlzZS5lcnJvciA9IGZ1bmN0aW9uKGZuKSB7XG5cdCAgICAgICAgICBhc3NlcnRBcmdGbihmbiwgJ2ZuJyk7XG5cdFxuXHQgICAgICAgICAgcHJvbWlzZS50aGVuKG51bGwsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdCAgICAgICAgICAgIGZuKHJlc3BvbnNlLmRhdGEsIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2UuaGVhZGVycywgY29uZmlnKTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG5cdCAgICAgICAgfTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBwcm9taXNlLnN1Y2Nlc3MgPSAkaHR0cE1pbkVyckxlZ2FjeUZuKCdzdWNjZXNzJyk7XG5cdCAgICAgICAgcHJvbWlzZS5lcnJvciA9ICRodHRwTWluRXJyTGVnYWN5Rm4oJ2Vycm9yJyk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBwcm9taXNlO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gdHJhbnNmb3JtUmVzcG9uc2UocmVzcG9uc2UpIHtcblx0ICAgICAgICAvLyBtYWtlIGEgY29weSBzaW5jZSB0aGUgcmVzcG9uc2UgbXVzdCBiZSBjYWNoZWFibGVcblx0ICAgICAgICB2YXIgcmVzcCA9IGV4dGVuZCh7fSwgcmVzcG9uc2UpO1xuXHQgICAgICAgIHJlc3AuZGF0YSA9IHRyYW5zZm9ybURhdGEocmVzcG9uc2UuZGF0YSwgcmVzcG9uc2UuaGVhZGVycywgcmVzcG9uc2Uuc3RhdHVzLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLnRyYW5zZm9ybVJlc3BvbnNlKTtcblx0ICAgICAgICByZXR1cm4gKGlzU3VjY2VzcyhyZXNwb25zZS5zdGF0dXMpKVxuXHQgICAgICAgICAgPyByZXNwXG5cdCAgICAgICAgICA6ICRxLnJlamVjdChyZXNwKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgZnVuY3Rpb24gZXhlY3V0ZUhlYWRlckZucyhoZWFkZXJzLCBjb25maWcpIHtcblx0ICAgICAgICB2YXIgaGVhZGVyQ29udGVudCwgcHJvY2Vzc2VkSGVhZGVycyA9IHt9O1xuXHRcblx0ICAgICAgICBmb3JFYWNoKGhlYWRlcnMsIGZ1bmN0aW9uKGhlYWRlckZuLCBoZWFkZXIpIHtcblx0ICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGhlYWRlckZuKSkge1xuXHQgICAgICAgICAgICBoZWFkZXJDb250ZW50ID0gaGVhZGVyRm4oY29uZmlnKTtcblx0ICAgICAgICAgICAgaWYgKGhlYWRlckNvbnRlbnQgIT0gbnVsbCkge1xuXHQgICAgICAgICAgICAgIHByb2Nlc3NlZEhlYWRlcnNbaGVhZGVyXSA9IGhlYWRlckNvbnRlbnQ7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHByb2Nlc3NlZEhlYWRlcnNbaGVhZGVyXSA9IGhlYWRlckZuO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICByZXR1cm4gcHJvY2Vzc2VkSGVhZGVycztcblx0ICAgICAgfVxuXHRcblx0ICAgICAgZnVuY3Rpb24gbWVyZ2VIZWFkZXJzKGNvbmZpZykge1xuXHQgICAgICAgIHZhciBkZWZIZWFkZXJzID0gZGVmYXVsdHMuaGVhZGVycyxcblx0ICAgICAgICAgICAgcmVxSGVhZGVycyA9IGV4dGVuZCh7fSwgY29uZmlnLmhlYWRlcnMpLFxuXHQgICAgICAgICAgICBkZWZIZWFkZXJOYW1lLCBsb3dlcmNhc2VEZWZIZWFkZXJOYW1lLCByZXFIZWFkZXJOYW1lO1xuXHRcblx0ICAgICAgICBkZWZIZWFkZXJzID0gZXh0ZW5kKHt9LCBkZWZIZWFkZXJzLmNvbW1vbiwgZGVmSGVhZGVyc1tsb3dlcmNhc2UoY29uZmlnLm1ldGhvZCldKTtcblx0XG5cdCAgICAgICAgLy8gdXNpbmcgZm9yLWluIGluc3RlYWQgb2YgZm9yRWFjaCB0byBhdm9pZCB1bm5lY2Vzc2FyeSBpdGVyYXRpb24gYWZ0ZXIgaGVhZGVyIGhhcyBiZWVuIGZvdW5kXG5cdCAgICAgICAgZGVmYXVsdEhlYWRlcnNJdGVyYXRpb246XG5cdCAgICAgICAgZm9yIChkZWZIZWFkZXJOYW1lIGluIGRlZkhlYWRlcnMpIHtcblx0ICAgICAgICAgIGxvd2VyY2FzZURlZkhlYWRlck5hbWUgPSBsb3dlcmNhc2UoZGVmSGVhZGVyTmFtZSk7XG5cdFxuXHQgICAgICAgICAgZm9yIChyZXFIZWFkZXJOYW1lIGluIHJlcUhlYWRlcnMpIHtcblx0ICAgICAgICAgICAgaWYgKGxvd2VyY2FzZShyZXFIZWFkZXJOYW1lKSA9PT0gbG93ZXJjYXNlRGVmSGVhZGVyTmFtZSkge1xuXHQgICAgICAgICAgICAgIGNvbnRpbnVlIGRlZmF1bHRIZWFkZXJzSXRlcmF0aW9uO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgcmVxSGVhZGVyc1tkZWZIZWFkZXJOYW1lXSA9IGRlZkhlYWRlcnNbZGVmSGVhZGVyTmFtZV07XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvLyBleGVjdXRlIGlmIGhlYWRlciB2YWx1ZSBpcyBhIGZ1bmN0aW9uIGZvciBtZXJnZWQgaGVhZGVyc1xuXHQgICAgICAgIHJldHVybiBleGVjdXRlSGVhZGVyRm5zKHJlcUhlYWRlcnMsIHNoYWxsb3dDb3B5KGNvbmZpZykpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgJGh0dHAucGVuZGluZ1JlcXVlc3RzID0gW107XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgKiBAbmFtZSAkaHR0cCNnZXRcblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFNob3J0Y3V0IG1ldGhvZCB0byBwZXJmb3JtIGBHRVRgIHJlcXVlc3QuXG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCBSZWxhdGl2ZSBvciBhYnNvbHV0ZSBVUkwgc3BlY2lmeWluZyB0aGUgZGVzdGluYXRpb24gb2YgdGhlIHJlcXVlc3Rcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0PX0gY29uZmlnIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb24gb2JqZWN0XG5cdCAgICAgKiBAcmV0dXJucyB7SHR0cFByb21pc2V9IEZ1dHVyZSBvYmplY3Rcblx0ICAgICAqL1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICogQG5hbWUgJGh0dHAjZGVsZXRlXG5cdCAgICAgKlxuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKiBTaG9ydGN1dCBtZXRob2QgdG8gcGVyZm9ybSBgREVMRVRFYCByZXF1ZXN0LlxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgUmVsYXRpdmUgb3IgYWJzb2x1dGUgVVJMIHNwZWNpZnlpbmcgdGhlIGRlc3RpbmF0aW9uIG9mIHRoZSByZXF1ZXN0XG5cdCAgICAgKiBAcGFyYW0ge09iamVjdD19IGNvbmZpZyBPcHRpb25hbCBjb25maWd1cmF0aW9uIG9iamVjdFxuXHQgICAgICogQHJldHVybnMge0h0dHBQcm9taXNlfSBGdXR1cmUgb2JqZWN0XG5cdCAgICAgKi9cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAqIEBuYW1lICRodHRwI2hlYWRcblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFNob3J0Y3V0IG1ldGhvZCB0byBwZXJmb3JtIGBIRUFEYCByZXF1ZXN0LlxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgUmVsYXRpdmUgb3IgYWJzb2x1dGUgVVJMIHNwZWNpZnlpbmcgdGhlIGRlc3RpbmF0aW9uIG9mIHRoZSByZXF1ZXN0XG5cdCAgICAgKiBAcGFyYW0ge09iamVjdD19IGNvbmZpZyBPcHRpb25hbCBjb25maWd1cmF0aW9uIG9iamVjdFxuXHQgICAgICogQHJldHVybnMge0h0dHBQcm9taXNlfSBGdXR1cmUgb2JqZWN0XG5cdCAgICAgKi9cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAqIEBuYW1lICRodHRwI2pzb25wXG5cdCAgICAgKlxuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKiBTaG9ydGN1dCBtZXRob2QgdG8gcGVyZm9ybSBgSlNPTlBgIHJlcXVlc3QuXG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCBSZWxhdGl2ZSBvciBhYnNvbHV0ZSBVUkwgc3BlY2lmeWluZyB0aGUgZGVzdGluYXRpb24gb2YgdGhlIHJlcXVlc3QuXG5cdCAgICAgKiAgICAgICAgICAgICAgICAgICAgIFRoZSBuYW1lIG9mIHRoZSBjYWxsYmFjayBzaG91bGQgYmUgdGhlIHN0cmluZyBgSlNPTl9DQUxMQkFDS2AuXG5cdCAgICAgKiBAcGFyYW0ge09iamVjdD19IGNvbmZpZyBPcHRpb25hbCBjb25maWd1cmF0aW9uIG9iamVjdFxuXHQgICAgICogQHJldHVybnMge0h0dHBQcm9taXNlfSBGdXR1cmUgb2JqZWN0XG5cdCAgICAgKi9cblx0ICAgIGNyZWF0ZVNob3J0TWV0aG9kcygnZ2V0JywgJ2RlbGV0ZScsICdoZWFkJywgJ2pzb25wJyk7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgKiBAbmFtZSAkaHR0cCNwb3N0XG5cdCAgICAgKlxuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKiBTaG9ydGN1dCBtZXRob2QgdG8gcGVyZm9ybSBgUE9TVGAgcmVxdWVzdC5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIFJlbGF0aXZlIG9yIGFic29sdXRlIFVSTCBzcGVjaWZ5aW5nIHRoZSBkZXN0aW5hdGlvbiBvZiB0aGUgcmVxdWVzdFxuXHQgICAgICogQHBhcmFtIHsqfSBkYXRhIFJlcXVlc3QgY29udGVudFxuXHQgICAgICogQHBhcmFtIHtPYmplY3Q9fSBjb25maWcgT3B0aW9uYWwgY29uZmlndXJhdGlvbiBvYmplY3Rcblx0ICAgICAqIEByZXR1cm5zIHtIdHRwUHJvbWlzZX0gRnV0dXJlIG9iamVjdFxuXHQgICAgICovXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgKiBAbmFtZSAkaHR0cCNwdXRcblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFNob3J0Y3V0IG1ldGhvZCB0byBwZXJmb3JtIGBQVVRgIHJlcXVlc3QuXG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCBSZWxhdGl2ZSBvciBhYnNvbHV0ZSBVUkwgc3BlY2lmeWluZyB0aGUgZGVzdGluYXRpb24gb2YgdGhlIHJlcXVlc3Rcblx0ICAgICAqIEBwYXJhbSB7Kn0gZGF0YSBSZXF1ZXN0IGNvbnRlbnRcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0PX0gY29uZmlnIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb24gb2JqZWN0XG5cdCAgICAgKiBAcmV0dXJucyB7SHR0cFByb21pc2V9IEZ1dHVyZSBvYmplY3Rcblx0ICAgICAqL1xuXHRcblx0ICAgICAvKipcblx0ICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICogQG5hbWUgJGh0dHAjcGF0Y2hcblx0ICAgICAgKlxuXHQgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAqIFNob3J0Y3V0IG1ldGhvZCB0byBwZXJmb3JtIGBQQVRDSGAgcmVxdWVzdC5cblx0ICAgICAgKlxuXHQgICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgUmVsYXRpdmUgb3IgYWJzb2x1dGUgVVJMIHNwZWNpZnlpbmcgdGhlIGRlc3RpbmF0aW9uIG9mIHRoZSByZXF1ZXN0XG5cdCAgICAgICogQHBhcmFtIHsqfSBkYXRhIFJlcXVlc3QgY29udGVudFxuXHQgICAgICAqIEBwYXJhbSB7T2JqZWN0PX0gY29uZmlnIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb24gb2JqZWN0XG5cdCAgICAgICogQHJldHVybnMge0h0dHBQcm9taXNlfSBGdXR1cmUgb2JqZWN0XG5cdCAgICAgICovXG5cdCAgICBjcmVhdGVTaG9ydE1ldGhvZHNXaXRoRGF0YSgncG9zdCcsICdwdXQnLCAncGF0Y2gnKTtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQG5nZG9jIHByb3BlcnR5XG5cdCAgICAgICAgICogQG5hbWUgJGh0dHAjZGVmYXVsdHNcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgICAqIFJ1bnRpbWUgZXF1aXZhbGVudCBvZiB0aGUgYCRodHRwUHJvdmlkZXIuZGVmYXVsdHNgIHByb3BlcnR5LiBBbGxvd3MgY29uZmlndXJhdGlvbiBvZlxuXHQgICAgICAgICAqIGRlZmF1bHQgaGVhZGVycywgd2l0aENyZWRlbnRpYWxzIGFzIHdlbGwgYXMgcmVxdWVzdCBhbmQgcmVzcG9uc2UgdHJhbnNmb3JtYXRpb25zLlxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogU2VlIFwiU2V0dGluZyBIVFRQIEhlYWRlcnNcIiBhbmQgXCJUcmFuc2Zvcm1pbmcgUmVxdWVzdHMgYW5kIFJlc3BvbnNlc1wiIHNlY3Rpb25zIGFib3ZlLlxuXHQgICAgICAgICAqL1xuXHQgICAgJGh0dHAuZGVmYXVsdHMgPSBkZWZhdWx0cztcblx0XG5cdFxuXHQgICAgcmV0dXJuICRodHRwO1xuXHRcblx0XG5cdCAgICBmdW5jdGlvbiBjcmVhdGVTaG9ydE1ldGhvZHMobmFtZXMpIHtcblx0ICAgICAgZm9yRWFjaChhcmd1bWVudHMsIGZ1bmN0aW9uKG5hbWUpIHtcblx0ICAgICAgICAkaHR0cFtuYW1lXSA9IGZ1bmN0aW9uKHVybCwgY29uZmlnKSB7XG5cdCAgICAgICAgICByZXR1cm4gJGh0dHAoZXh0ZW5kKHt9LCBjb25maWcgfHwge30sIHtcblx0ICAgICAgICAgICAgbWV0aG9kOiBuYW1lLFxuXHQgICAgICAgICAgICB1cmw6IHVybFxuXHQgICAgICAgICAgfSkpO1xuXHQgICAgICAgIH07XG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHRcblx0XG5cdCAgICBmdW5jdGlvbiBjcmVhdGVTaG9ydE1ldGhvZHNXaXRoRGF0YShuYW1lKSB7XG5cdCAgICAgIGZvckVhY2goYXJndW1lbnRzLCBmdW5jdGlvbihuYW1lKSB7XG5cdCAgICAgICAgJGh0dHBbbmFtZV0gPSBmdW5jdGlvbih1cmwsIGRhdGEsIGNvbmZpZykge1xuXHQgICAgICAgICAgcmV0dXJuICRodHRwKGV4dGVuZCh7fSwgY29uZmlnIHx8IHt9LCB7XG5cdCAgICAgICAgICAgIG1ldGhvZDogbmFtZSxcblx0ICAgICAgICAgICAgdXJsOiB1cmwsXG5cdCAgICAgICAgICAgIGRhdGE6IGRhdGFcblx0ICAgICAgICAgIH0pKTtcblx0ICAgICAgICB9O1xuXHQgICAgICB9KTtcblx0ICAgIH1cblx0XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBNYWtlcyB0aGUgcmVxdWVzdC5cblx0ICAgICAqXG5cdCAgICAgKiAhISEgQUNDRVNTRVMgQ0xPU1VSRSBWQVJTOlxuXHQgICAgICogJGh0dHBCYWNrZW5kLCBkZWZhdWx0cywgJGxvZywgJHJvb3RTY29wZSwgZGVmYXVsdENhY2hlLCAkaHR0cC5wZW5kaW5nUmVxdWVzdHNcblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gc2VuZFJlcShjb25maWcsIHJlcURhdGEpIHtcblx0ICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKSxcblx0ICAgICAgICAgIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlLFxuXHQgICAgICAgICAgY2FjaGUsXG5cdCAgICAgICAgICBjYWNoZWRSZXNwLFxuXHQgICAgICAgICAgcmVxSGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzLFxuXHQgICAgICAgICAgdXJsID0gYnVpbGRVcmwoY29uZmlnLnVybCwgY29uZmlnLnBhcmFtU2VyaWFsaXplcihjb25maWcucGFyYW1zKSk7XG5cdFxuXHQgICAgICAkaHR0cC5wZW5kaW5nUmVxdWVzdHMucHVzaChjb25maWcpO1xuXHQgICAgICBwcm9taXNlLnRoZW4ocmVtb3ZlUGVuZGluZ1JlcSwgcmVtb3ZlUGVuZGluZ1JlcSk7XG5cdFxuXHRcblx0ICAgICAgaWYgKChjb25maWcuY2FjaGUgfHwgZGVmYXVsdHMuY2FjaGUpICYmIGNvbmZpZy5jYWNoZSAhPT0gZmFsc2UgJiZcblx0ICAgICAgICAgIChjb25maWcubWV0aG9kID09PSAnR0VUJyB8fCBjb25maWcubWV0aG9kID09PSAnSlNPTlAnKSkge1xuXHQgICAgICAgIGNhY2hlID0gaXNPYmplY3QoY29uZmlnLmNhY2hlKSA/IGNvbmZpZy5jYWNoZVxuXHQgICAgICAgICAgICAgIDogaXNPYmplY3QoZGVmYXVsdHMuY2FjaGUpID8gZGVmYXVsdHMuY2FjaGVcblx0ICAgICAgICAgICAgICA6IGRlZmF1bHRDYWNoZTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgaWYgKGNhY2hlKSB7XG5cdCAgICAgICAgY2FjaGVkUmVzcCA9IGNhY2hlLmdldCh1cmwpO1xuXHQgICAgICAgIGlmIChpc0RlZmluZWQoY2FjaGVkUmVzcCkpIHtcblx0ICAgICAgICAgIGlmIChpc1Byb21pc2VMaWtlKGNhY2hlZFJlc3ApKSB7XG5cdCAgICAgICAgICAgIC8vIGNhY2hlZCByZXF1ZXN0IGhhcyBhbHJlYWR5IGJlZW4gc2VudCwgYnV0IHRoZXJlIGlzIG5vIHJlc3BvbnNlIHlldFxuXHQgICAgICAgICAgICBjYWNoZWRSZXNwLnRoZW4ocmVzb2x2ZVByb21pc2VXaXRoUmVzdWx0LCByZXNvbHZlUHJvbWlzZVdpdGhSZXN1bHQpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgLy8gc2VydmluZyBmcm9tIGNhY2hlXG5cdCAgICAgICAgICAgIGlmIChpc0FycmF5KGNhY2hlZFJlc3ApKSB7XG5cdCAgICAgICAgICAgICAgcmVzb2x2ZVByb21pc2UoY2FjaGVkUmVzcFsxXSwgY2FjaGVkUmVzcFswXSwgc2hhbGxvd0NvcHkoY2FjaGVkUmVzcFsyXSksIGNhY2hlZFJlc3BbM10pO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIHJlc29sdmVQcm9taXNlKGNhY2hlZFJlc3AsIDIwMCwge30sICdPSycpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIC8vIHB1dCB0aGUgcHJvbWlzZSBmb3IgdGhlIG5vbi10cmFuc2Zvcm1lZCByZXNwb25zZSBpbnRvIGNhY2hlIGFzIGEgcGxhY2Vob2xkZXJcblx0ICAgICAgICAgIGNhY2hlLnB1dCh1cmwsIHByb21pc2UpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHRcblx0XG5cdCAgICAgIC8vIGlmIHdlIHdvbid0IGhhdmUgdGhlIHJlc3BvbnNlIGluIGNhY2hlLCBzZXQgdGhlIHhzcmYgaGVhZGVycyBhbmRcblx0ICAgICAgLy8gc2VuZCB0aGUgcmVxdWVzdCB0byB0aGUgYmFja2VuZFxuXHQgICAgICBpZiAoaXNVbmRlZmluZWQoY2FjaGVkUmVzcCkpIHtcblx0ICAgICAgICB2YXIgeHNyZlZhbHVlID0gdXJsSXNTYW1lT3JpZ2luKGNvbmZpZy51cmwpXG5cdCAgICAgICAgICAgID8gJCRjb29raWVSZWFkZXIoKVtjb25maWcueHNyZkNvb2tpZU5hbWUgfHwgZGVmYXVsdHMueHNyZkNvb2tpZU5hbWVdXG5cdCAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuXHQgICAgICAgIGlmICh4c3JmVmFsdWUpIHtcblx0ICAgICAgICAgIHJlcUhlYWRlcnNbKGNvbmZpZy54c3JmSGVhZGVyTmFtZSB8fCBkZWZhdWx0cy54c3JmSGVhZGVyTmFtZSldID0geHNyZlZhbHVlO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgJGh0dHBCYWNrZW5kKGNvbmZpZy5tZXRob2QsIHVybCwgcmVxRGF0YSwgZG9uZSwgcmVxSGVhZGVycywgY29uZmlnLnRpbWVvdXQsXG5cdCAgICAgICAgICAgIGNvbmZpZy53aXRoQ3JlZGVudGlhbHMsIGNvbmZpZy5yZXNwb25zZVR5cGUpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gcHJvbWlzZTtcblx0XG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQ2FsbGJhY2sgcmVnaXN0ZXJlZCB0byAkaHR0cEJhY2tlbmQoKTpcblx0ICAgICAgICogIC0gY2FjaGVzIHRoZSByZXNwb25zZSBpZiBkZXNpcmVkXG5cdCAgICAgICAqICAtIHJlc29sdmVzIHRoZSByYXcgJGh0dHAgcHJvbWlzZVxuXHQgICAgICAgKiAgLSBjYWxscyAkYXBwbHlcblx0ICAgICAgICovXG5cdCAgICAgIGZ1bmN0aW9uIGRvbmUoc3RhdHVzLCByZXNwb25zZSwgaGVhZGVyc1N0cmluZywgc3RhdHVzVGV4dCkge1xuXHQgICAgICAgIGlmIChjYWNoZSkge1xuXHQgICAgICAgICAgaWYgKGlzU3VjY2VzcyhzdGF0dXMpKSB7XG5cdCAgICAgICAgICAgIGNhY2hlLnB1dCh1cmwsIFtzdGF0dXMsIHJlc3BvbnNlLCBwYXJzZUhlYWRlcnMoaGVhZGVyc1N0cmluZyksIHN0YXR1c1RleHRdKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIC8vIHJlbW92ZSBwcm9taXNlIGZyb20gdGhlIGNhY2hlXG5cdCAgICAgICAgICAgIGNhY2hlLnJlbW92ZSh1cmwpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZUh0dHBQcm9taXNlKCkge1xuXHQgICAgICAgICAgcmVzb2x2ZVByb21pc2UocmVzcG9uc2UsIHN0YXR1cywgaGVhZGVyc1N0cmluZywgc3RhdHVzVGV4dCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAodXNlQXBwbHlBc3luYykge1xuXHQgICAgICAgICAgJHJvb3RTY29wZS4kYXBwbHlBc3luYyhyZXNvbHZlSHR0cFByb21pc2UpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICByZXNvbHZlSHR0cFByb21pc2UoKTtcblx0ICAgICAgICAgIGlmICghJHJvb3RTY29wZS4kJHBoYXNlKSAkcm9vdFNjb3BlLiRhcHBseSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHRcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBSZXNvbHZlcyB0aGUgcmF3ICRodHRwIHByb21pc2UuXG5cdCAgICAgICAqL1xuXHQgICAgICBmdW5jdGlvbiByZXNvbHZlUHJvbWlzZShyZXNwb25zZSwgc3RhdHVzLCBoZWFkZXJzLCBzdGF0dXNUZXh0KSB7XG5cdCAgICAgICAgLy9zdGF0dXM6IEhUVFAgcmVzcG9uc2Ugc3RhdHVzIGNvZGUsIDAsIC0xIChhYm9ydGVkIGJ5IHRpbWVvdXQgLyBwcm9taXNlKVxuXHQgICAgICAgIHN0YXR1cyA9IHN0YXR1cyA+PSAtMSA/IHN0YXR1cyA6IDA7XG5cdFxuXHQgICAgICAgIChpc1N1Y2Nlc3Moc3RhdHVzKSA/IGRlZmVycmVkLnJlc29sdmUgOiBkZWZlcnJlZC5yZWplY3QpKHtcblx0ICAgICAgICAgIGRhdGE6IHJlc3BvbnNlLFxuXHQgICAgICAgICAgc3RhdHVzOiBzdGF0dXMsXG5cdCAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzR2V0dGVyKGhlYWRlcnMpLFxuXHQgICAgICAgICAgY29uZmlnOiBjb25maWcsXG5cdCAgICAgICAgICBzdGF0dXNUZXh0OiBzdGF0dXNUZXh0XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGZ1bmN0aW9uIHJlc29sdmVQcm9taXNlV2l0aFJlc3VsdChyZXN1bHQpIHtcblx0ICAgICAgICByZXNvbHZlUHJvbWlzZShyZXN1bHQuZGF0YSwgcmVzdWx0LnN0YXR1cywgc2hhbGxvd0NvcHkocmVzdWx0LmhlYWRlcnMoKSksIHJlc3VsdC5zdGF0dXNUZXh0KTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgZnVuY3Rpb24gcmVtb3ZlUGVuZGluZ1JlcSgpIHtcblx0ICAgICAgICB2YXIgaWR4ID0gJGh0dHAucGVuZGluZ1JlcXVlc3RzLmluZGV4T2YoY29uZmlnKTtcblx0ICAgICAgICBpZiAoaWR4ICE9PSAtMSkgJGh0dHAucGVuZGluZ1JlcXVlc3RzLnNwbGljZShpZHgsIDEpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIGZ1bmN0aW9uIGJ1aWxkVXJsKHVybCwgc2VyaWFsaXplZFBhcmFtcykge1xuXHQgICAgICBpZiAoc2VyaWFsaXplZFBhcmFtcy5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgdXJsICs9ICgodXJsLmluZGV4T2YoJz8nKSA9PSAtMSkgPyAnPycgOiAnJicpICsgc2VyaWFsaXplZFBhcmFtcztcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gdXJsO1xuXHQgICAgfVxuXHQgIH1dO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHNlcnZpY2Vcblx0ICogQG5hbWUgJHhockZhY3Rvcnlcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEZhY3RvcnkgZnVuY3Rpb24gdXNlZCB0byBjcmVhdGUgWE1MSHR0cFJlcXVlc3Qgb2JqZWN0cy5cblx0ICpcblx0ICogUmVwbGFjZSBvciBkZWNvcmF0ZSB0aGlzIHNlcnZpY2UgdG8gY3JlYXRlIHlvdXIgb3duIGN1c3RvbSBYTUxIdHRwUmVxdWVzdCBvYmplY3RzLlxuXHQgKlxuXHQgKiBgYGBcblx0ICogYW5ndWxhci5tb2R1bGUoJ215QXBwJywgW10pXG5cdCAqIC5mYWN0b3J5KCckeGhyRmFjdG9yeScsIGZ1bmN0aW9uKCkge1xuXHQgKiAgIHJldHVybiBmdW5jdGlvbiBjcmVhdGVYaHIobWV0aG9kLCB1cmwpIHtcblx0ICogICAgIHJldHVybiBuZXcgd2luZG93LlhNTEh0dHBSZXF1ZXN0KHttb3pTeXN0ZW06IHRydWV9KTtcblx0ICogICB9O1xuXHQgKiB9KTtcblx0ICogYGBgXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBtZXRob2QgSFRUUCBtZXRob2Qgb2YgdGhlIHJlcXVlc3QgKEdFVCwgUE9TVCwgUFVULCAuLilcblx0ICogQHBhcmFtIHtzdHJpbmd9IHVybCBVUkwgb2YgdGhlIHJlcXVlc3QuXG5cdCAqL1xuXHRmdW5jdGlvbiAkeGhyRmFjdG9yeVByb3ZpZGVyKCkge1xuXHQgIHRoaXMuJGdldCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uIGNyZWF0ZVhocigpIHtcblx0ICAgICAgcmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTtcblx0ICAgIH07XG5cdCAgfTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBzZXJ2aWNlXG5cdCAqIEBuYW1lICRodHRwQmFja2VuZFxuXHQgKiBAcmVxdWlyZXMgJHdpbmRvd1xuXHQgKiBAcmVxdWlyZXMgJGRvY3VtZW50XG5cdCAqIEByZXF1aXJlcyAkeGhyRmFjdG9yeVxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogSFRUUCBiYWNrZW5kIHVzZWQgYnkgdGhlIHtAbGluayBuZy4kaHR0cCBzZXJ2aWNlfSB0aGF0IGRlbGVnYXRlcyB0b1xuXHQgKiBYTUxIdHRwUmVxdWVzdCBvYmplY3Qgb3IgSlNPTlAgYW5kIGRlYWxzIHdpdGggYnJvd3NlciBpbmNvbXBhdGliaWxpdGllcy5cblx0ICpcblx0ICogWW91IHNob3VsZCBuZXZlciBuZWVkIHRvIHVzZSB0aGlzIHNlcnZpY2UgZGlyZWN0bHksIGluc3RlYWQgdXNlIHRoZSBoaWdoZXItbGV2ZWwgYWJzdHJhY3Rpb25zOlxuXHQgKiB7QGxpbmsgbmcuJGh0dHAgJGh0dHB9IG9yIHtAbGluayBuZ1Jlc291cmNlLiRyZXNvdXJjZSAkcmVzb3VyY2V9LlxuXHQgKlxuXHQgKiBEdXJpbmcgdGVzdGluZyB0aGlzIGltcGxlbWVudGF0aW9uIGlzIHN3YXBwZWQgd2l0aCB7QGxpbmsgbmdNb2NrLiRodHRwQmFja2VuZCBtb2NrXG5cdCAqICRodHRwQmFja2VuZH0gd2hpY2ggY2FuIGJlIHRyYWluZWQgd2l0aCByZXNwb25zZXMuXG5cdCAqL1xuXHRmdW5jdGlvbiAkSHR0cEJhY2tlbmRQcm92aWRlcigpIHtcblx0ICB0aGlzLiRnZXQgPSBbJyRicm93c2VyJywgJyR3aW5kb3cnLCAnJGRvY3VtZW50JywgJyR4aHJGYWN0b3J5JywgZnVuY3Rpb24oJGJyb3dzZXIsICR3aW5kb3csICRkb2N1bWVudCwgJHhockZhY3RvcnkpIHtcblx0ICAgIHJldHVybiBjcmVhdGVIdHRwQmFja2VuZCgkYnJvd3NlciwgJHhockZhY3RvcnksICRicm93c2VyLmRlZmVyLCAkd2luZG93LmFuZ3VsYXIuY2FsbGJhY2tzLCAkZG9jdW1lbnRbMF0pO1xuXHQgIH1dO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBjcmVhdGVIdHRwQmFja2VuZCgkYnJvd3NlciwgY3JlYXRlWGhyLCAkYnJvd3NlckRlZmVyLCBjYWxsYmFja3MsIHJhd0RvY3VtZW50KSB7XG5cdCAgLy8gVE9ETyh2b2p0YSk6IGZpeCB0aGUgc2lnbmF0dXJlXG5cdCAgcmV0dXJuIGZ1bmN0aW9uKG1ldGhvZCwgdXJsLCBwb3N0LCBjYWxsYmFjaywgaGVhZGVycywgdGltZW91dCwgd2l0aENyZWRlbnRpYWxzLCByZXNwb25zZVR5cGUpIHtcblx0ICAgICRicm93c2VyLiQkaW5jT3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQoKTtcblx0ICAgIHVybCA9IHVybCB8fCAkYnJvd3Nlci51cmwoKTtcblx0XG5cdCAgICBpZiAobG93ZXJjYXNlKG1ldGhvZCkgPT0gJ2pzb25wJykge1xuXHQgICAgICB2YXIgY2FsbGJhY2tJZCA9ICdfJyArIChjYWxsYmFja3MuY291bnRlcisrKS50b1N0cmluZygzNik7XG5cdCAgICAgIGNhbGxiYWNrc1tjYWxsYmFja0lkXSA9IGZ1bmN0aW9uKGRhdGEpIHtcblx0ICAgICAgICBjYWxsYmFja3NbY2FsbGJhY2tJZF0uZGF0YSA9IGRhdGE7XG5cdCAgICAgICAgY2FsbGJhY2tzW2NhbGxiYWNrSWRdLmNhbGxlZCA9IHRydWU7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICB2YXIganNvbnBEb25lID0ganNvbnBSZXEodXJsLnJlcGxhY2UoJ0pTT05fQ0FMTEJBQ0snLCAnYW5ndWxhci5jYWxsYmFja3MuJyArIGNhbGxiYWNrSWQpLFxuXHQgICAgICAgICAgY2FsbGJhY2tJZCwgZnVuY3Rpb24oc3RhdHVzLCB0ZXh0KSB7XG5cdCAgICAgICAgY29tcGxldGVSZXF1ZXN0KGNhbGxiYWNrLCBzdGF0dXMsIGNhbGxiYWNrc1tjYWxsYmFja0lkXS5kYXRhLCBcIlwiLCB0ZXh0KTtcblx0ICAgICAgICBjYWxsYmFja3NbY2FsbGJhY2tJZF0gPSBub29wO1xuXHQgICAgICB9KTtcblx0ICAgIH0gZWxzZSB7XG5cdFxuXHQgICAgICB2YXIgeGhyID0gY3JlYXRlWGhyKG1ldGhvZCwgdXJsKTtcblx0XG5cdCAgICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsLCB0cnVlKTtcblx0ICAgICAgZm9yRWFjaChoZWFkZXJzLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG5cdCAgICAgICAgaWYgKGlzRGVmaW5lZCh2YWx1ZSkpIHtcblx0ICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCB2YWx1ZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiByZXF1ZXN0TG9hZGVkKCkge1xuXHQgICAgICAgIHZhciBzdGF0dXNUZXh0ID0geGhyLnN0YXR1c1RleHQgfHwgJyc7XG5cdFxuXHQgICAgICAgIC8vIHJlc3BvbnNlVGV4dCBpcyB0aGUgb2xkLXNjaG9vbCB3YXkgb2YgcmV0cmlldmluZyByZXNwb25zZSAoc3VwcG9ydGVkIGJ5IElFOSlcblx0ICAgICAgICAvLyByZXNwb25zZS9yZXNwb25zZVR5cGUgcHJvcGVydGllcyB3ZXJlIGludHJvZHVjZWQgaW4gWEhSIExldmVsMiBzcGVjIChzdXBwb3J0ZWQgYnkgSUUxMClcblx0ICAgICAgICB2YXIgcmVzcG9uc2UgPSAoJ3Jlc3BvbnNlJyBpbiB4aHIpID8geGhyLnJlc3BvbnNlIDogeGhyLnJlc3BvbnNlVGV4dDtcblx0XG5cdCAgICAgICAgLy8gbm9ybWFsaXplIElFOSBidWcgKGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzE0NTApXG5cdCAgICAgICAgdmFyIHN0YXR1cyA9IHhoci5zdGF0dXMgPT09IDEyMjMgPyAyMDQgOiB4aHIuc3RhdHVzO1xuXHRcblx0ICAgICAgICAvLyBmaXggc3RhdHVzIGNvZGUgd2hlbiBpdCBpcyAwICgwIHN0YXR1cyBpcyB1bmRvY3VtZW50ZWQpLlxuXHQgICAgICAgIC8vIE9jY3VycyB3aGVuIGFjY2Vzc2luZyBmaWxlIHJlc291cmNlcyBvciBvbiBBbmRyb2lkIDQuMSBzdG9jayBicm93c2VyXG5cdCAgICAgICAgLy8gd2hpbGUgcmV0cmlldmluZyBmaWxlcyBmcm9tIGFwcGxpY2F0aW9uIGNhY2hlLlxuXHQgICAgICAgIGlmIChzdGF0dXMgPT09IDApIHtcblx0ICAgICAgICAgIHN0YXR1cyA9IHJlc3BvbnNlID8gMjAwIDogdXJsUmVzb2x2ZSh1cmwpLnByb3RvY29sID09ICdmaWxlJyA/IDQwNCA6IDA7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBjb21wbGV0ZVJlcXVlc3QoY2FsbGJhY2ssXG5cdCAgICAgICAgICAgIHN0YXR1cyxcblx0ICAgICAgICAgICAgcmVzcG9uc2UsXG5cdCAgICAgICAgICAgIHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSxcblx0ICAgICAgICAgICAgc3RhdHVzVGV4dCk7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICB2YXIgcmVxdWVzdEVycm9yID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgLy8gVGhlIHJlc3BvbnNlIGlzIGFsd2F5cyBlbXB0eVxuXHQgICAgICAgIC8vIFNlZSBodHRwczovL3hoci5zcGVjLndoYXR3Zy5vcmcvI3JlcXVlc3QtZXJyb3Itc3RlcHMgYW5kIGh0dHBzOi8vZmV0Y2guc3BlYy53aGF0d2cub3JnLyNjb25jZXB0LW5ldHdvcmstZXJyb3Jcblx0ICAgICAgICBjb21wbGV0ZVJlcXVlc3QoY2FsbGJhY2ssIC0xLCBudWxsLCBudWxsLCAnJyk7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICB4aHIub25lcnJvciA9IHJlcXVlc3RFcnJvcjtcblx0ICAgICAgeGhyLm9uYWJvcnQgPSByZXF1ZXN0RXJyb3I7XG5cdFxuXHQgICAgICBpZiAod2l0aENyZWRlbnRpYWxzKSB7XG5cdCAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWU7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGlmIChyZXNwb25zZVR5cGUpIHtcblx0ICAgICAgICB0cnkge1xuXHQgICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9IHJlc3BvbnNlVHlwZTtcblx0ICAgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgICAvLyBXZWJLaXQgYWRkZWQgc3VwcG9ydCBmb3IgdGhlIGpzb24gcmVzcG9uc2VUeXBlIHZhbHVlIG9uIDA5LzAzLzIwMTNcblx0ICAgICAgICAgIC8vIGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD03MzY0OC4gVmVyc2lvbnMgb2YgU2FmYXJpIHByaW9yIHRvIDcgYXJlXG5cdCAgICAgICAgICAvLyBrbm93biB0byB0aHJvdyB3aGVuIHNldHRpbmcgdGhlIHZhbHVlIFwianNvblwiIGFzIHRoZSByZXNwb25zZSB0eXBlLiBPdGhlciBvbGRlclxuXHQgICAgICAgICAgLy8gYnJvd3NlcnMgaW1wbGVtZW50aW5nIHRoZSByZXNwb25zZVR5cGVcblx0ICAgICAgICAgIC8vXG5cdCAgICAgICAgICAvLyBUaGUganNvbiByZXNwb25zZSB0eXBlIGNhbiBiZSBpZ25vcmVkIGlmIG5vdCBzdXBwb3J0ZWQsIGJlY2F1c2UgSlNPTiBwYXlsb2FkcyBhcmVcblx0ICAgICAgICAgIC8vIHBhcnNlZCBvbiB0aGUgY2xpZW50LXNpZGUgcmVnYXJkbGVzcy5cblx0ICAgICAgICAgIGlmIChyZXNwb25zZVR5cGUgIT09ICdqc29uJykge1xuXHQgICAgICAgICAgICB0aHJvdyBlO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHRcblx0ICAgICAgeGhyLnNlbmQoaXNVbmRlZmluZWQocG9zdCkgPyBudWxsIDogcG9zdCk7XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKHRpbWVvdXQgPiAwKSB7XG5cdCAgICAgIHZhciB0aW1lb3V0SWQgPSAkYnJvd3NlckRlZmVyKHRpbWVvdXRSZXF1ZXN0LCB0aW1lb3V0KTtcblx0ICAgIH0gZWxzZSBpZiAoaXNQcm9taXNlTGlrZSh0aW1lb3V0KSkge1xuXHQgICAgICB0aW1lb3V0LnRoZW4odGltZW91dFJlcXVlc3QpO1xuXHQgICAgfVxuXHRcblx0XG5cdCAgICBmdW5jdGlvbiB0aW1lb3V0UmVxdWVzdCgpIHtcblx0ICAgICAganNvbnBEb25lICYmIGpzb25wRG9uZSgpO1xuXHQgICAgICB4aHIgJiYgeGhyLmFib3J0KCk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gY29tcGxldGVSZXF1ZXN0KGNhbGxiYWNrLCBzdGF0dXMsIHJlc3BvbnNlLCBoZWFkZXJzU3RyaW5nLCBzdGF0dXNUZXh0KSB7XG5cdCAgICAgIC8vIGNhbmNlbCB0aW1lb3V0IGFuZCBzdWJzZXF1ZW50IHRpbWVvdXQgcHJvbWlzZSByZXNvbHV0aW9uXG5cdCAgICAgIGlmIChpc0RlZmluZWQodGltZW91dElkKSkge1xuXHQgICAgICAgICRicm93c2VyRGVmZXIuY2FuY2VsKHRpbWVvdXRJZCk7XG5cdCAgICAgIH1cblx0ICAgICAganNvbnBEb25lID0geGhyID0gbnVsbDtcblx0XG5cdCAgICAgIGNhbGxiYWNrKHN0YXR1cywgcmVzcG9uc2UsIGhlYWRlcnNTdHJpbmcsIHN0YXR1c1RleHQpO1xuXHQgICAgICAkYnJvd3Nlci4kJGNvbXBsZXRlT3V0c3RhbmRpbmdSZXF1ZXN0KG5vb3ApO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIGpzb25wUmVxKHVybCwgY2FsbGJhY2tJZCwgZG9uZSkge1xuXHQgICAgLy8gd2UgY2FuJ3QgdXNlIGpRdWVyeS9qcUxpdGUgaGVyZSBiZWNhdXNlIGpRdWVyeSBkb2VzIGNyYXp5IHN0dWZmIHdpdGggc2NyaXB0IGVsZW1lbnRzLCBlLmcuOlxuXHQgICAgLy8gLSBmZXRjaGVzIGxvY2FsIHNjcmlwdHMgdmlhIFhIUiBhbmQgZXZhbHMgdGhlbVxuXHQgICAgLy8gLSBhZGRzIGFuZCBpbW1lZGlhdGVseSByZW1vdmVzIHNjcmlwdCBlbGVtZW50cyBmcm9tIHRoZSBkb2N1bWVudFxuXHQgICAgdmFyIHNjcmlwdCA9IHJhd0RvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpLCBjYWxsYmFjayA9IG51bGw7XG5cdCAgICBzY3JpcHQudHlwZSA9IFwidGV4dC9qYXZhc2NyaXB0XCI7XG5cdCAgICBzY3JpcHQuc3JjID0gdXJsO1xuXHQgICAgc2NyaXB0LmFzeW5jID0gdHJ1ZTtcblx0XG5cdCAgICBjYWxsYmFjayA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdCAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXJGbihzY3JpcHQsIFwibG9hZFwiLCBjYWxsYmFjayk7XG5cdCAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXJGbihzY3JpcHQsIFwiZXJyb3JcIiwgY2FsbGJhY2spO1xuXHQgICAgICByYXdEb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHNjcmlwdCk7XG5cdCAgICAgIHNjcmlwdCA9IG51bGw7XG5cdCAgICAgIHZhciBzdGF0dXMgPSAtMTtcblx0ICAgICAgdmFyIHRleHQgPSBcInVua25vd25cIjtcblx0XG5cdCAgICAgIGlmIChldmVudCkge1xuXHQgICAgICAgIGlmIChldmVudC50eXBlID09PSBcImxvYWRcIiAmJiAhY2FsbGJhY2tzW2NhbGxiYWNrSWRdLmNhbGxlZCkge1xuXHQgICAgICAgICAgZXZlbnQgPSB7IHR5cGU6IFwiZXJyb3JcIiB9O1xuXHQgICAgICAgIH1cblx0ICAgICAgICB0ZXh0ID0gZXZlbnQudHlwZTtcblx0ICAgICAgICBzdGF0dXMgPSBldmVudC50eXBlID09PSBcImVycm9yXCIgPyA0MDQgOiAyMDA7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGlmIChkb25lKSB7XG5cdCAgICAgICAgZG9uZShzdGF0dXMsIHRleHQpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIGFkZEV2ZW50TGlzdGVuZXJGbihzY3JpcHQsIFwibG9hZFwiLCBjYWxsYmFjayk7XG5cdCAgICBhZGRFdmVudExpc3RlbmVyRm4oc2NyaXB0LCBcImVycm9yXCIsIGNhbGxiYWNrKTtcblx0ICAgIHJhd0RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcblx0ICAgIHJldHVybiBjYWxsYmFjaztcblx0ICB9XG5cdH1cblx0XG5cdHZhciAkaW50ZXJwb2xhdGVNaW5FcnIgPSBhbmd1bGFyLiRpbnRlcnBvbGF0ZU1pbkVyciA9IG1pbkVycignJGludGVycG9sYXRlJyk7XG5cdCRpbnRlcnBvbGF0ZU1pbkVyci50aHJvd05vY29uY2F0ID0gZnVuY3Rpb24odGV4dCkge1xuXHQgIHRocm93ICRpbnRlcnBvbGF0ZU1pbkVycignbm9jb25jYXQnLFxuXHQgICAgICBcIkVycm9yIHdoaWxlIGludGVycG9sYXRpbmc6IHswfVxcblN0cmljdCBDb250ZXh0dWFsIEVzY2FwaW5nIGRpc2FsbG93cyBcIiArXG5cdCAgICAgIFwiaW50ZXJwb2xhdGlvbnMgdGhhdCBjb25jYXRlbmF0ZSBtdWx0aXBsZSBleHByZXNzaW9ucyB3aGVuIGEgdHJ1c3RlZCB2YWx1ZSBpcyBcIiArXG5cdCAgICAgIFwicmVxdWlyZWQuICBTZWUgaHR0cDovL2RvY3MuYW5ndWxhcmpzLm9yZy9hcGkvbmcuJHNjZVwiLCB0ZXh0KTtcblx0fTtcblx0XG5cdCRpbnRlcnBvbGF0ZU1pbkVyci5pbnRlcnIgPSBmdW5jdGlvbih0ZXh0LCBlcnIpIHtcblx0ICByZXR1cm4gJGludGVycG9sYXRlTWluRXJyKCdpbnRlcnInLCBcIkNhbid0IGludGVycG9sYXRlOiB7MH1cXG57MX1cIiwgdGV4dCwgZXJyLnRvU3RyaW5nKCkpO1xuXHR9O1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBwcm92aWRlclxuXHQgKiBAbmFtZSAkaW50ZXJwb2xhdGVQcm92aWRlclxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogVXNlZCBmb3IgY29uZmlndXJpbmcgdGhlIGludGVycG9sYXRpb24gbWFya3VwLiBEZWZhdWx0cyB0byBge3tgIGFuZCBgfX1gLlxuXHQgKlxuXHQgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtZGFuZ2VyXCI+XG5cdCAqIFRoaXMgZmVhdHVyZSBpcyBzb21ldGltZXMgdXNlZCB0byBtaXggZGlmZmVyZW50IG1hcmt1cCBsYW5ndWFnZXMsIGUuZy4gdG8gd3JhcCBhbiBBbmd1bGFyXG5cdCAqIHRlbXBsYXRlIHdpdGhpbiBhIFB5dGhvbiBKaW5qYSB0ZW1wbGF0ZSAob3IgYW55IG90aGVyIHRlbXBsYXRlIGxhbmd1YWdlKS4gTWl4aW5nIHRlbXBsYXRpbmdcblx0ICogbGFuZ3VhZ2VzIGlzICoqdmVyeSBkYW5nZXJvdXMqKi4gVGhlIGVtYmVkZGluZyB0ZW1wbGF0ZSBsYW5ndWFnZSB3aWxsIG5vdCBzYWZlbHkgZXNjYXBlIEFuZ3VsYXJcblx0ICogZXhwcmVzc2lvbnMsIHNvIGFueSB1c2VyLWNvbnRyb2xsZWQgdmFsdWVzIGluIHRoZSB0ZW1wbGF0ZSB3aWxsIGNhdXNlIENyb3NzIFNpdGUgU2NyaXB0aW5nIChYU1MpXG5cdCAqIHNlY3VyaXR5IGJ1Z3MhXG5cdCAqIDwvZGl2PlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQ8ZXhhbXBsZSBuYW1lPVwiY3VzdG9tLWludGVycG9sYXRpb24tbWFya3VwXCIgbW9kdWxlPVwiY3VzdG9tSW50ZXJwb2xhdGlvbkFwcFwiPlxuXHQ8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQ8c2NyaXB0PlxuXHQgIHZhciBjdXN0b21JbnRlcnBvbGF0aW9uQXBwID0gYW5ndWxhci5tb2R1bGUoJ2N1c3RvbUludGVycG9sYXRpb25BcHAnLCBbXSk7XG5cdFxuXHQgIGN1c3RvbUludGVycG9sYXRpb25BcHAuY29uZmlnKGZ1bmN0aW9uKCRpbnRlcnBvbGF0ZVByb3ZpZGVyKSB7XG5cdCAgICAkaW50ZXJwb2xhdGVQcm92aWRlci5zdGFydFN5bWJvbCgnLy8nKTtcblx0ICAgICRpbnRlcnBvbGF0ZVByb3ZpZGVyLmVuZFN5bWJvbCgnLy8nKTtcblx0ICB9KTtcblx0XG5cdFxuXHQgIGN1c3RvbUludGVycG9sYXRpb25BcHAuY29udHJvbGxlcignRGVtb0NvbnRyb2xsZXInLCBmdW5jdGlvbigpIHtcblx0ICAgICAgdGhpcy5sYWJlbCA9IFwiVGhpcyBiaW5kaW5nIGlzIGJyb3VnaHQgeW91IGJ5IC8vIGludGVycG9sYXRpb24gc3ltYm9scy5cIjtcblx0ICB9KTtcblx0PC9zY3JpcHQ+XG5cdDxkaXYgbmctY29udHJvbGxlcj1cIkRlbW9Db250cm9sbGVyIGFzIGRlbW9cIj5cblx0ICAgIC8vZGVtby5sYWJlbC8vXG5cdDwvZGl2PlxuXHQ8L2ZpbGU+XG5cdDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICBpdCgnc2hvdWxkIGludGVycG9sYXRlIGJpbmRpbmcgd2l0aCBjdXN0b20gc3ltYm9scycsIGZ1bmN0aW9uKCkge1xuXHQgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygnZGVtby5sYWJlbCcpKS5nZXRUZXh0KCkpLnRvQmUoJ1RoaXMgYmluZGluZyBpcyBicm91Z2h0IHlvdSBieSAvLyBpbnRlcnBvbGF0aW9uIHN5bWJvbHMuJyk7XG5cdCAgfSk7XG5cdDwvZmlsZT5cblx0PC9leGFtcGxlPlxuXHQgKi9cblx0ZnVuY3Rpb24gJEludGVycG9sYXRlUHJvdmlkZXIoKSB7XG5cdCAgdmFyIHN0YXJ0U3ltYm9sID0gJ3t7Jztcblx0ICB2YXIgZW5kU3ltYm9sID0gJ319Jztcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRpbnRlcnBvbGF0ZVByb3ZpZGVyI3N0YXJ0U3ltYm9sXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogU3ltYm9sIHRvIGRlbm90ZSBzdGFydCBvZiBleHByZXNzaW9uIGluIHRoZSBpbnRlcnBvbGF0ZWQgc3RyaW5nLiBEZWZhdWx0cyB0byBge3tgLlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSB2YWx1ZSBuZXcgdmFsdWUgdG8gc2V0IHRoZSBzdGFydGluZyBzeW1ib2wgdG8uXG5cdCAgICogQHJldHVybnMge3N0cmluZ3xzZWxmfSBSZXR1cm5zIHRoZSBzeW1ib2wgd2hlbiB1c2VkIGFzIGdldHRlciBhbmQgc2VsZiBpZiB1c2VkIGFzIHNldHRlci5cblx0ICAgKi9cblx0ICB0aGlzLnN0YXJ0U3ltYm9sID0gZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgIGlmICh2YWx1ZSkge1xuXHQgICAgICBzdGFydFN5bWJvbCA9IHZhbHVlO1xuXHQgICAgICByZXR1cm4gdGhpcztcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHJldHVybiBzdGFydFN5bWJvbDtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgJGludGVycG9sYXRlUHJvdmlkZXIjZW5kU3ltYm9sXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogU3ltYm9sIHRvIGRlbm90ZSB0aGUgZW5kIG9mIGV4cHJlc3Npb24gaW4gdGhlIGludGVycG9sYXRlZCBzdHJpbmcuIERlZmF1bHRzIHRvIGB9fWAuXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IHZhbHVlIG5ldyB2YWx1ZSB0byBzZXQgdGhlIGVuZGluZyBzeW1ib2wgdG8uXG5cdCAgICogQHJldHVybnMge3N0cmluZ3xzZWxmfSBSZXR1cm5zIHRoZSBzeW1ib2wgd2hlbiB1c2VkIGFzIGdldHRlciBhbmQgc2VsZiBpZiB1c2VkIGFzIHNldHRlci5cblx0ICAgKi9cblx0ICB0aGlzLmVuZFN5bWJvbCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICBpZiAodmFsdWUpIHtcblx0ICAgICAgZW5kU3ltYm9sID0gdmFsdWU7XG5cdCAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgcmV0dXJuIGVuZFN5bWJvbDtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0XG5cdCAgdGhpcy4kZ2V0ID0gWyckcGFyc2UnLCAnJGV4Y2VwdGlvbkhhbmRsZXInLCAnJHNjZScsIGZ1bmN0aW9uKCRwYXJzZSwgJGV4Y2VwdGlvbkhhbmRsZXIsICRzY2UpIHtcblx0ICAgIHZhciBzdGFydFN5bWJvbExlbmd0aCA9IHN0YXJ0U3ltYm9sLmxlbmd0aCxcblx0ICAgICAgICBlbmRTeW1ib2xMZW5ndGggPSBlbmRTeW1ib2wubGVuZ3RoLFxuXHQgICAgICAgIGVzY2FwZWRTdGFydFJlZ2V4cCA9IG5ldyBSZWdFeHAoc3RhcnRTeW1ib2wucmVwbGFjZSgvLi9nLCBlc2NhcGUpLCAnZycpLFxuXHQgICAgICAgIGVzY2FwZWRFbmRSZWdleHAgPSBuZXcgUmVnRXhwKGVuZFN5bWJvbC5yZXBsYWNlKC8uL2csIGVzY2FwZSksICdnJyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gZXNjYXBlKGNoKSB7XG5cdCAgICAgIHJldHVybiAnXFxcXFxcXFxcXFxcJyArIGNoO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHVuZXNjYXBlVGV4dCh0ZXh0KSB7XG5cdCAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoZXNjYXBlZFN0YXJ0UmVnZXhwLCBzdGFydFN5bWJvbCkuXG5cdCAgICAgICAgcmVwbGFjZShlc2NhcGVkRW5kUmVnZXhwLCBlbmRTeW1ib2wpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHN0cmluZ2lmeSh2YWx1ZSkge1xuXHQgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgeyAvLyBudWxsIHx8IHVuZGVmaW5lZFxuXHQgICAgICAgIHJldHVybiAnJztcblx0ICAgICAgfVxuXHQgICAgICBzd2l0Y2ggKHR5cGVvZiB2YWx1ZSkge1xuXHQgICAgICAgIGNhc2UgJ3N0cmluZyc6XG5cdCAgICAgICAgICBicmVhaztcblx0ICAgICAgICBjYXNlICdudW1iZXInOlxuXHQgICAgICAgICAgdmFsdWUgPSAnJyArIHZhbHVlO1xuXHQgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgZGVmYXVsdDpcblx0ICAgICAgICAgIHZhbHVlID0gdG9Kc29uKHZhbHVlKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIHZhbHVlO1xuXHQgICAgfVxuXHRcblx0ICAgIC8vVE9ETzogdGhpcyBpcyB0aGUgc2FtZSBhcyB0aGUgY29uc3RhbnRXYXRjaERlbGVnYXRlIGluIHBhcnNlLmpzXG5cdCAgICBmdW5jdGlvbiBjb25zdGFudFdhdGNoRGVsZWdhdGUoc2NvcGUsIGxpc3RlbmVyLCBvYmplY3RFcXVhbGl0eSwgY29uc3RhbnRJbnRlcnApIHtcblx0ICAgICAgdmFyIHVud2F0Y2g7XG5cdCAgICAgIHJldHVybiB1bndhdGNoID0gc2NvcGUuJHdhdGNoKGZ1bmN0aW9uIGNvbnN0YW50SW50ZXJwb2xhdGVXYXRjaChzY29wZSkge1xuXHQgICAgICAgIHVud2F0Y2goKTtcblx0ICAgICAgICByZXR1cm4gY29uc3RhbnRJbnRlcnAoc2NvcGUpO1xuXHQgICAgICB9LCBsaXN0ZW5lciwgb2JqZWN0RXF1YWxpdHkpO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIHNlcnZpY2Vcblx0ICAgICAqIEBuYW1lICRpbnRlcnBvbGF0ZVxuXHQgICAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgICAqXG5cdCAgICAgKiBAcmVxdWlyZXMgJHBhcnNlXG5cdCAgICAgKiBAcmVxdWlyZXMgJHNjZVxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICpcblx0ICAgICAqIENvbXBpbGVzIGEgc3RyaW5nIHdpdGggbWFya3VwIGludG8gYW4gaW50ZXJwb2xhdGlvbiBmdW5jdGlvbi4gVGhpcyBzZXJ2aWNlIGlzIHVzZWQgYnkgdGhlXG5cdCAgICAgKiBIVE1MIHtAbGluayBuZy4kY29tcGlsZSAkY29tcGlsZX0gc2VydmljZSBmb3IgZGF0YSBiaW5kaW5nLiBTZWVcblx0ICAgICAqIHtAbGluayBuZy4kaW50ZXJwb2xhdGVQcm92aWRlciAkaW50ZXJwb2xhdGVQcm92aWRlcn0gZm9yIGNvbmZpZ3VyaW5nIHRoZVxuXHQgICAgICogaW50ZXJwb2xhdGlvbiBtYXJrdXAuXG5cdCAgICAgKlxuXHQgICAgICpcblx0ICAgICAqIGBgYGpzXG5cdCAgICAgKiAgIHZhciAkaW50ZXJwb2xhdGUgPSAuLi47IC8vIGluamVjdGVkXG5cdCAgICAgKiAgIHZhciBleHAgPSAkaW50ZXJwb2xhdGUoJ0hlbGxvIHt7bmFtZSB8IHVwcGVyY2FzZX19IScpO1xuXHQgICAgICogICBleHBlY3QoZXhwKHtuYW1lOidBbmd1bGFyJ30pKS50b0VxdWFsKCdIZWxsbyBBTkdVTEFSIScpO1xuXHQgICAgICogYGBgXG5cdCAgICAgKlxuXHQgICAgICogYCRpbnRlcnBvbGF0ZWAgdGFrZXMgYW4gb3B0aW9uYWwgZm91cnRoIGFyZ3VtZW50LCBgYWxsT3JOb3RoaW5nYC4gSWYgYGFsbE9yTm90aGluZ2AgaXNcblx0ICAgICAqIGB0cnVlYCwgdGhlIGludGVycG9sYXRpb24gZnVuY3Rpb24gd2lsbCByZXR1cm4gYHVuZGVmaW5lZGAgdW5sZXNzIGFsbCBlbWJlZGRlZCBleHByZXNzaW9uc1xuXHQgICAgICogZXZhbHVhdGUgdG8gYSB2YWx1ZSBvdGhlciB0aGFuIGB1bmRlZmluZWRgLlxuXHQgICAgICpcblx0ICAgICAqIGBgYGpzXG5cdCAgICAgKiAgIHZhciAkaW50ZXJwb2xhdGUgPSAuLi47IC8vIGluamVjdGVkXG5cdCAgICAgKiAgIHZhciBjb250ZXh0ID0ge2dyZWV0aW5nOiAnSGVsbG8nLCBuYW1lOiB1bmRlZmluZWQgfTtcblx0ICAgICAqXG5cdCAgICAgKiAgIC8vIGRlZmF1bHQgXCJmb3JnaXZpbmdcIiBtb2RlXG5cdCAgICAgKiAgIHZhciBleHAgPSAkaW50ZXJwb2xhdGUoJ3t7Z3JlZXRpbmd9fSB7e25hbWV9fSEnKTtcblx0ICAgICAqICAgZXhwZWN0KGV4cChjb250ZXh0KSkudG9FcXVhbCgnSGVsbG8gIScpO1xuXHQgICAgICpcblx0ICAgICAqICAgLy8gXCJhbGxPck5vdGhpbmdcIiBtb2RlXG5cdCAgICAgKiAgIGV4cCA9ICRpbnRlcnBvbGF0ZSgne3tncmVldGluZ319IHt7bmFtZX19IScsIGZhbHNlLCBudWxsLCB0cnVlKTtcblx0ICAgICAqICAgZXhwZWN0KGV4cChjb250ZXh0KSkudG9CZVVuZGVmaW5lZCgpO1xuXHQgICAgICogICBjb250ZXh0Lm5hbWUgPSAnQW5ndWxhcic7XG5cdCAgICAgKiAgIGV4cGVjdChleHAoY29udGV4dCkpLnRvRXF1YWwoJ0hlbGxvIEFuZ3VsYXIhJyk7XG5cdCAgICAgKiBgYGBcblx0ICAgICAqXG5cdCAgICAgKiBgYWxsT3JOb3RoaW5nYCBpcyB1c2VmdWwgZm9yIGludGVycG9sYXRpbmcgVVJMcy4gYG5nU3JjYCBhbmQgYG5nU3Jjc2V0YCB1c2UgdGhpcyBiZWhhdmlvci5cblx0ICAgICAqXG5cdCAgICAgKiAjIyMjRXNjYXBlZCBJbnRlcnBvbGF0aW9uXG5cdCAgICAgKiAkaW50ZXJwb2xhdGUgcHJvdmlkZXMgYSBtZWNoYW5pc20gZm9yIGVzY2FwaW5nIGludGVycG9sYXRpb24gbWFya2Vycy4gU3RhcnQgYW5kIGVuZCBtYXJrZXJzXG5cdCAgICAgKiBjYW4gYmUgZXNjYXBlZCBieSBwcmVjZWRpbmcgZWFjaCBvZiB0aGVpciBjaGFyYWN0ZXJzIHdpdGggYSBSRVZFUlNFIFNPTElEVVMgVSswMDVDIChiYWNrc2xhc2gpLlxuXHQgICAgICogSXQgd2lsbCBiZSByZW5kZXJlZCBhcyBhIHJlZ3VsYXIgc3RhcnQvZW5kIG1hcmtlciwgYW5kIHdpbGwgbm90IGJlIGludGVycHJldGVkIGFzIGFuIGV4cHJlc3Npb25cblx0ICAgICAqIG9yIGJpbmRpbmcuXG5cdCAgICAgKlxuXHQgICAgICogVGhpcyBlbmFibGVzIHdlYi1zZXJ2ZXJzIHRvIHByZXZlbnQgc2NyaXB0IGluamVjdGlvbiBhdHRhY2tzIGFuZCBkZWZhY2luZyBhdHRhY2tzLCB0byBzb21lXG5cdCAgICAgKiBkZWdyZWUsIHdoaWxlIGFsc28gZW5hYmxpbmcgY29kZSBleGFtcGxlcyB0byB3b3JrIHdpdGhvdXQgcmVseWluZyBvbiB0aGVcblx0ICAgICAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdOb25CaW5kYWJsZSBuZ05vbkJpbmRhYmxlfSBkaXJlY3RpdmUuXG5cdCAgICAgKlxuXHQgICAgICogKipGb3Igc2VjdXJpdHkgcHVycG9zZXMsIGl0IGlzIHN0cm9uZ2x5IGVuY291cmFnZWQgdGhhdCB3ZWIgc2VydmVycyBlc2NhcGUgdXNlci1zdXBwbGllZCBkYXRhLFxuXHQgICAgICogcmVwbGFjaW5nIGFuZ2xlIGJyYWNrZXRzICgmbHQ7LCAmZ3Q7KSB3aXRoICZhbXA7bHQ7IGFuZCAmYW1wO2d0OyByZXNwZWN0aXZlbHksIGFuZCByZXBsYWNpbmcgYWxsXG5cdCAgICAgKiBpbnRlcnBvbGF0aW9uIHN0YXJ0L2VuZCBtYXJrZXJzIHdpdGggdGhlaXIgZXNjYXBlZCBjb3VudGVycGFydHMuKipcblx0ICAgICAqXG5cdCAgICAgKiBFc2NhcGVkIGludGVycG9sYXRpb24gbWFya2VycyBhcmUgb25seSByZXBsYWNlZCB3aXRoIHRoZSBhY3R1YWwgaW50ZXJwb2xhdGlvbiBtYXJrZXJzIGluIHJlbmRlcmVkXG5cdCAgICAgKiBvdXRwdXQgd2hlbiB0aGUgJGludGVycG9sYXRlIHNlcnZpY2UgcHJvY2Vzc2VzIHRoZSB0ZXh0LiBTbywgZm9yIEhUTUwgZWxlbWVudHMgaW50ZXJwb2xhdGVkXG5cdCAgICAgKiBieSB7QGxpbmsgbmcuJGNvbXBpbGUgJGNvbXBpbGV9LCBvciBvdGhlcndpc2UgaW50ZXJwb2xhdGVkIHdpdGggdGhlIGBtdXN0SGF2ZUV4cHJlc3Npb25gIHBhcmFtZXRlclxuXHQgICAgICogc2V0IHRvIGB0cnVlYCwgdGhlIGludGVycG9sYXRlZCB0ZXh0IG11c3QgY29udGFpbiBhbiB1bmVzY2FwZWQgaW50ZXJwb2xhdGlvbiBleHByZXNzaW9uLiBBcyBzdWNoLFxuXHQgICAgICogdGhpcyBpcyB0eXBpY2FsbHkgdXNlZnVsIG9ubHkgd2hlbiB1c2VyLWRhdGEgaXMgdXNlZCBpbiByZW5kZXJpbmcgYSB0ZW1wbGF0ZSBmcm9tIHRoZSBzZXJ2ZXIsIG9yXG5cdCAgICAgKiB3aGVuIG90aGVyd2lzZSB1bnRydXN0ZWQgZGF0YSBpcyB1c2VkIGJ5IGEgZGlyZWN0aXZlLlxuXHQgICAgICpcblx0ICAgICAqIDxleGFtcGxlPlxuXHQgICAgICogIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgKiAgICA8ZGl2IG5nLWluaXQ9XCJ1c2VybmFtZT0nQSB1c2VyJ1wiPlxuXHQgICAgICogICAgICA8cCBuZy1pbml0PVwiYXBwdGl0bGU9J0VzY2FwaW5nIGRlbW8nXCI+e3thcHB0aXRsZX19OiBcXHtcXHsgdXNlcm5hbWUgPSBcImRlZmFjZWQgdmFsdWVcIjsgXFx9XFx9XG5cdCAgICAgKiAgICAgICAgPC9wPlxuXHQgICAgICogICAgICA8cD48c3Ryb25nPnt7dXNlcm5hbWV9fTwvc3Ryb25nPiBhdHRlbXB0cyB0byBpbmplY3QgY29kZSB3aGljaCB3aWxsIGRlZmFjZSB0aGVcblx0ICAgICAqICAgICAgICBhcHBsaWNhdGlvbiwgYnV0IGZhaWxzIHRvIGFjY29tcGxpc2ggdGhlaXIgdGFzaywgYmVjYXVzZSB0aGUgc2VydmVyIGhhcyBjb3JyZWN0bHlcblx0ICAgICAqICAgICAgICBlc2NhcGVkIHRoZSBpbnRlcnBvbGF0aW9uIHN0YXJ0L2VuZCBtYXJrZXJzIHdpdGggUkVWRVJTRSBTT0xJRFVTIFUrMDA1QyAoYmFja3NsYXNoKVxuXHQgICAgICogICAgICAgIGNoYXJhY3RlcnMuPC9wPlxuXHQgICAgICogICAgICA8cD5JbnN0ZWFkLCB0aGUgcmVzdWx0IG9mIHRoZSBhdHRlbXB0ZWQgc2NyaXB0IGluamVjdGlvbiBpcyB2aXNpYmxlLCBhbmQgY2FuIGJlIHJlbW92ZWRcblx0ICAgICAqICAgICAgICBmcm9tIHRoZSBkYXRhYmFzZSBieSBhbiBhZG1pbmlzdHJhdG9yLjwvcD5cblx0ICAgICAqICAgIDwvZGl2PlxuXHQgICAgICogIDwvZmlsZT5cblx0ICAgICAqIDwvZXhhbXBsZT5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dCBUaGUgdGV4dCB3aXRoIG1hcmt1cCB0byBpbnRlcnBvbGF0ZS5cblx0ICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IG11c3RIYXZlRXhwcmVzc2lvbiBpZiBzZXQgdG8gdHJ1ZSB0aGVuIHRoZSBpbnRlcnBvbGF0aW9uIHN0cmluZyBtdXN0IGhhdmVcblx0ICAgICAqICAgIGVtYmVkZGVkIGV4cHJlc3Npb24gaW4gb3JkZXIgdG8gcmV0dXJuIGFuIGludGVycG9sYXRpb24gZnVuY3Rpb24uIFN0cmluZ3Mgd2l0aCBub1xuXHQgICAgICogICAgZW1iZWRkZWQgZXhwcmVzc2lvbiB3aWxsIHJldHVybiBudWxsIGZvciB0aGUgaW50ZXJwb2xhdGlvbiBmdW5jdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gdHJ1c3RlZENvbnRleHQgd2hlbiBwcm92aWRlZCwgdGhlIHJldHVybmVkIGZ1bmN0aW9uIHBhc3NlcyB0aGUgaW50ZXJwb2xhdGVkXG5cdCAgICAgKiAgICByZXN1bHQgdGhyb3VnaCB7QGxpbmsgbmcuJHNjZSNnZXRUcnVzdGVkICRzY2UuZ2V0VHJ1c3RlZChpbnRlcnBvbGF0ZWRSZXN1bHQsXG5cdCAgICAgKiAgICB0cnVzdGVkQ29udGV4dCl9IGJlZm9yZSByZXR1cm5pbmcgaXQuICBSZWZlciB0byB0aGUge0BsaW5rIG5nLiRzY2UgJHNjZX0gc2VydmljZSB0aGF0XG5cdCAgICAgKiAgICBwcm92aWRlcyBTdHJpY3QgQ29udGV4dHVhbCBFc2NhcGluZyBmb3IgZGV0YWlscy5cblx0ICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IGFsbE9yTm90aGluZyBpZiBgdHJ1ZWAsIHRoZW4gdGhlIHJldHVybmVkIGZ1bmN0aW9uIHJldHVybnMgdW5kZWZpbmVkXG5cdCAgICAgKiAgICB1bmxlc3MgYWxsIGVtYmVkZGVkIGV4cHJlc3Npb25zIGV2YWx1YXRlIHRvIGEgdmFsdWUgb3RoZXIgdGhhbiBgdW5kZWZpbmVkYC5cblx0ICAgICAqIEByZXR1cm5zIHtmdW5jdGlvbihjb250ZXh0KX0gYW4gaW50ZXJwb2xhdGlvbiBmdW5jdGlvbiB3aGljaCBpcyB1c2VkIHRvIGNvbXB1dGUgdGhlXG5cdCAgICAgKiAgICBpbnRlcnBvbGF0ZWQgc3RyaW5nLiBUaGUgZnVuY3Rpb24gaGFzIHRoZXNlIHBhcmFtZXRlcnM6XG5cdCAgICAgKlxuXHQgICAgICogLSBgY29udGV4dGA6IGV2YWx1YXRpb24gY29udGV4dCBmb3IgYWxsIGV4cHJlc3Npb25zIGVtYmVkZGVkIGluIHRoZSBpbnRlcnBvbGF0ZWQgdGV4dFxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiAkaW50ZXJwb2xhdGUodGV4dCwgbXVzdEhhdmVFeHByZXNzaW9uLCB0cnVzdGVkQ29udGV4dCwgYWxsT3JOb3RoaW5nKSB7XG5cdCAgICAgIC8vIFByb3ZpZGUgYSBxdWljayBleGl0IGFuZCBzaW1wbGlmaWVkIHJlc3VsdCBmdW5jdGlvbiBmb3IgdGV4dCB3aXRoIG5vIGludGVycG9sYXRpb25cblx0ICAgICAgaWYgKCF0ZXh0Lmxlbmd0aCB8fCB0ZXh0LmluZGV4T2Yoc3RhcnRTeW1ib2wpID09PSAtMSkge1xuXHQgICAgICAgIHZhciBjb25zdGFudEludGVycDtcblx0ICAgICAgICBpZiAoIW11c3RIYXZlRXhwcmVzc2lvbikge1xuXHQgICAgICAgICAgdmFyIHVuZXNjYXBlZFRleHQgPSB1bmVzY2FwZVRleHQodGV4dCk7XG5cdCAgICAgICAgICBjb25zdGFudEludGVycCA9IHZhbHVlRm4odW5lc2NhcGVkVGV4dCk7XG5cdCAgICAgICAgICBjb25zdGFudEludGVycC5leHAgPSB0ZXh0O1xuXHQgICAgICAgICAgY29uc3RhbnRJbnRlcnAuZXhwcmVzc2lvbnMgPSBbXTtcblx0ICAgICAgICAgIGNvbnN0YW50SW50ZXJwLiQkd2F0Y2hEZWxlZ2F0ZSA9IGNvbnN0YW50V2F0Y2hEZWxlZ2F0ZTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIGNvbnN0YW50SW50ZXJwO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBhbGxPck5vdGhpbmcgPSAhIWFsbE9yTm90aGluZztcblx0ICAgICAgdmFyIHN0YXJ0SW5kZXgsXG5cdCAgICAgICAgICBlbmRJbmRleCxcblx0ICAgICAgICAgIGluZGV4ID0gMCxcblx0ICAgICAgICAgIGV4cHJlc3Npb25zID0gW10sXG5cdCAgICAgICAgICBwYXJzZUZucyA9IFtdLFxuXHQgICAgICAgICAgdGV4dExlbmd0aCA9IHRleHQubGVuZ3RoLFxuXHQgICAgICAgICAgZXhwLFxuXHQgICAgICAgICAgY29uY2F0ID0gW10sXG5cdCAgICAgICAgICBleHByZXNzaW9uUG9zaXRpb25zID0gW107XG5cdFxuXHQgICAgICB3aGlsZSAoaW5kZXggPCB0ZXh0TGVuZ3RoKSB7XG5cdCAgICAgICAgaWYgKCgoc3RhcnRJbmRleCA9IHRleHQuaW5kZXhPZihzdGFydFN5bWJvbCwgaW5kZXgpKSAhPSAtMSkgJiZcblx0ICAgICAgICAgICAgICgoZW5kSW5kZXggPSB0ZXh0LmluZGV4T2YoZW5kU3ltYm9sLCBzdGFydEluZGV4ICsgc3RhcnRTeW1ib2xMZW5ndGgpKSAhPSAtMSkpIHtcblx0ICAgICAgICAgIGlmIChpbmRleCAhPT0gc3RhcnRJbmRleCkge1xuXHQgICAgICAgICAgICBjb25jYXQucHVzaCh1bmVzY2FwZVRleHQodGV4dC5zdWJzdHJpbmcoaW5kZXgsIHN0YXJ0SW5kZXgpKSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBleHAgPSB0ZXh0LnN1YnN0cmluZyhzdGFydEluZGV4ICsgc3RhcnRTeW1ib2xMZW5ndGgsIGVuZEluZGV4KTtcblx0ICAgICAgICAgIGV4cHJlc3Npb25zLnB1c2goZXhwKTtcblx0ICAgICAgICAgIHBhcnNlRm5zLnB1c2goJHBhcnNlKGV4cCwgcGFyc2VTdHJpbmdpZnlJbnRlcmNlcHRvcikpO1xuXHQgICAgICAgICAgaW5kZXggPSBlbmRJbmRleCArIGVuZFN5bWJvbExlbmd0aDtcblx0ICAgICAgICAgIGV4cHJlc3Npb25Qb3NpdGlvbnMucHVzaChjb25jYXQubGVuZ3RoKTtcblx0ICAgICAgICAgIGNvbmNhdC5wdXNoKCcnKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgLy8gd2UgZGlkIG5vdCBmaW5kIGFuIGludGVycG9sYXRpb24sIHNvIHdlIGhhdmUgdG8gYWRkIHRoZSByZW1haW5kZXIgdG8gdGhlIHNlcGFyYXRvcnMgYXJyYXlcblx0ICAgICAgICAgIGlmIChpbmRleCAhPT0gdGV4dExlbmd0aCkge1xuXHQgICAgICAgICAgICBjb25jYXQucHVzaCh1bmVzY2FwZVRleHQodGV4dC5zdWJzdHJpbmcoaW5kZXgpKSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBicmVhaztcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vIENvbmNhdGVuYXRpbmcgZXhwcmVzc2lvbnMgbWFrZXMgaXQgaGFyZCB0byByZWFzb24gYWJvdXQgd2hldGhlciBzb21lIGNvbWJpbmF0aW9uIG9mXG5cdCAgICAgIC8vIGNvbmNhdGVuYXRlZCB2YWx1ZXMgYXJlIHVuc2FmZSB0byB1c2UgYW5kIGNvdWxkIGVhc2lseSBsZWFkIHRvIFhTUy4gIEJ5IHJlcXVpcmluZyB0aGF0IGFcblx0ICAgICAgLy8gc2luZ2xlIGV4cHJlc3Npb24gYmUgdXNlZCBmb3IgaWZyYW1lW3NyY10sIG9iamVjdFtzcmNdLCBldGMuLCB3ZSBlbnN1cmUgdGhhdCB0aGUgdmFsdWVcblx0ICAgICAgLy8gdGhhdCdzIHVzZWQgaXMgYXNzaWduZWQgb3IgY29uc3RydWN0ZWQgYnkgc29tZSBKUyBjb2RlIHNvbWV3aGVyZSB0aGF0IGlzIG1vcmUgdGVzdGFibGUgb3Jcblx0ICAgICAgLy8gbWFrZSBpdCBvYnZpb3VzIHRoYXQgeW91IGJvdW5kIHRoZSB2YWx1ZSB0byBzb21lIHVzZXIgY29udHJvbGxlZCB2YWx1ZS4gIFRoaXMgaGVscHMgcmVkdWNlXG5cdCAgICAgIC8vIHRoZSBsb2FkIHdoZW4gYXVkaXRpbmcgZm9yIFhTUyBpc3N1ZXMuXG5cdCAgICAgIGlmICh0cnVzdGVkQ29udGV4dCAmJiBjb25jYXQubGVuZ3RoID4gMSkge1xuXHQgICAgICAgICAgJGludGVycG9sYXRlTWluRXJyLnRocm93Tm9jb25jYXQodGV4dCk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGlmICghbXVzdEhhdmVFeHByZXNzaW9uIHx8IGV4cHJlc3Npb25zLmxlbmd0aCkge1xuXHQgICAgICAgIHZhciBjb21wdXRlID0gZnVuY3Rpb24odmFsdWVzKSB7XG5cdCAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBleHByZXNzaW9ucy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdCAgICAgICAgICAgIGlmIChhbGxPck5vdGhpbmcgJiYgaXNVbmRlZmluZWQodmFsdWVzW2ldKSkgcmV0dXJuO1xuXHQgICAgICAgICAgICBjb25jYXRbZXhwcmVzc2lvblBvc2l0aW9uc1tpXV0gPSB2YWx1ZXNbaV07XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICByZXR1cm4gY29uY2F0LmpvaW4oJycpO1xuXHQgICAgICAgIH07XG5cdFxuXHQgICAgICAgIHZhciBnZXRWYWx1ZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgICByZXR1cm4gdHJ1c3RlZENvbnRleHQgP1xuXHQgICAgICAgICAgICAkc2NlLmdldFRydXN0ZWQodHJ1c3RlZENvbnRleHQsIHZhbHVlKSA6XG5cdCAgICAgICAgICAgICRzY2UudmFsdWVPZih2YWx1ZSk7XG5cdCAgICAgICAgfTtcblx0XG5cdCAgICAgICAgcmV0dXJuIGV4dGVuZChmdW5jdGlvbiBpbnRlcnBvbGF0aW9uRm4oY29udGV4dCkge1xuXHQgICAgICAgICAgICB2YXIgaSA9IDA7XG5cdCAgICAgICAgICAgIHZhciBpaSA9IGV4cHJlc3Npb25zLmxlbmd0aDtcblx0ICAgICAgICAgICAgdmFyIHZhbHVlcyA9IG5ldyBBcnJheShpaSk7XG5cdFxuXHQgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgIGZvciAoOyBpIDwgaWk7IGkrKykge1xuXHQgICAgICAgICAgICAgICAgdmFsdWVzW2ldID0gcGFyc2VGbnNbaV0oY29udGV4dCk7XG5cdCAgICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgICByZXR1cm4gY29tcHV0ZSh2YWx1ZXMpO1xuXHQgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcblx0ICAgICAgICAgICAgICAkZXhjZXB0aW9uSGFuZGxlcigkaW50ZXJwb2xhdGVNaW5FcnIuaW50ZXJyKHRleHQsIGVycikpO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgfSwge1xuXHQgICAgICAgICAgLy8gYWxsIG9mIHRoZXNlIHByb3BlcnRpZXMgYXJlIHVuZG9jdW1lbnRlZCBmb3Igbm93XG5cdCAgICAgICAgICBleHA6IHRleHQsIC8vanVzdCBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIHJlZ3VsYXIgd2F0Y2hlcnMgY3JlYXRlZCB2aWEgJHdhdGNoXG5cdCAgICAgICAgICBleHByZXNzaW9uczogZXhwcmVzc2lvbnMsXG5cdCAgICAgICAgICAkJHdhdGNoRGVsZWdhdGU6IGZ1bmN0aW9uKHNjb3BlLCBsaXN0ZW5lcikge1xuXHQgICAgICAgICAgICB2YXIgbGFzdFZhbHVlO1xuXHQgICAgICAgICAgICByZXR1cm4gc2NvcGUuJHdhdGNoR3JvdXAocGFyc2VGbnMsIGZ1bmN0aW9uIGludGVycG9sYXRlRm5XYXRjaGVyKHZhbHVlcywgb2xkVmFsdWVzKSB7XG5cdCAgICAgICAgICAgICAgdmFyIGN1cnJWYWx1ZSA9IGNvbXB1dGUodmFsdWVzKTtcblx0ICAgICAgICAgICAgICBpZiAoaXNGdW5jdGlvbihsaXN0ZW5lcikpIHtcblx0ICAgICAgICAgICAgICAgIGxpc3RlbmVyLmNhbGwodGhpcywgY3VyclZhbHVlLCB2YWx1ZXMgIT09IG9sZFZhbHVlcyA/IGxhc3RWYWx1ZSA6IGN1cnJWYWx1ZSwgc2NvcGUpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICBsYXN0VmFsdWUgPSBjdXJyVmFsdWU7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBmdW5jdGlvbiBwYXJzZVN0cmluZ2lmeUludGVyY2VwdG9yKHZhbHVlKSB7XG5cdCAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgIHZhbHVlID0gZ2V0VmFsdWUodmFsdWUpO1xuXHQgICAgICAgICAgcmV0dXJuIGFsbE9yTm90aGluZyAmJiAhaXNEZWZpbmVkKHZhbHVlKSA/IHZhbHVlIDogc3RyaW5naWZ5KHZhbHVlKTtcblx0ICAgICAgICB9IGNhdGNoIChlcnIpIHtcblx0ICAgICAgICAgICRleGNlcHRpb25IYW5kbGVyKCRpbnRlcnBvbGF0ZU1pbkVyci5pbnRlcnIodGV4dCwgZXJyKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICogQG5hbWUgJGludGVycG9sYXRlI3N0YXJ0U3ltYm9sXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFN5bWJvbCB0byBkZW5vdGUgdGhlIHN0YXJ0IG9mIGV4cHJlc3Npb24gaW4gdGhlIGludGVycG9sYXRlZCBzdHJpbmcuIERlZmF1bHRzIHRvIGB7e2AuXG5cdCAgICAgKlxuXHQgICAgICogVXNlIHtAbGluayBuZy4kaW50ZXJwb2xhdGVQcm92aWRlciNzdGFydFN5bWJvbCBgJGludGVycG9sYXRlUHJvdmlkZXIuc3RhcnRTeW1ib2xgfSB0byBjaGFuZ2Vcblx0ICAgICAqIHRoZSBzeW1ib2wuXG5cdCAgICAgKlxuXHQgICAgICogQHJldHVybnMge3N0cmluZ30gc3RhcnQgc3ltYm9sLlxuXHQgICAgICovXG5cdCAgICAkaW50ZXJwb2xhdGUuc3RhcnRTeW1ib2wgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIHN0YXJ0U3ltYm9sO1xuXHQgICAgfTtcblx0XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgKiBAbmFtZSAkaW50ZXJwb2xhdGUjZW5kU3ltYm9sXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFN5bWJvbCB0byBkZW5vdGUgdGhlIGVuZCBvZiBleHByZXNzaW9uIGluIHRoZSBpbnRlcnBvbGF0ZWQgc3RyaW5nLiBEZWZhdWx0cyB0byBgfX1gLlxuXHQgICAgICpcblx0ICAgICAqIFVzZSB7QGxpbmsgbmcuJGludGVycG9sYXRlUHJvdmlkZXIjZW5kU3ltYm9sIGAkaW50ZXJwb2xhdGVQcm92aWRlci5lbmRTeW1ib2xgfSB0byBjaGFuZ2Vcblx0ICAgICAqIHRoZSBzeW1ib2wuXG5cdCAgICAgKlxuXHQgICAgICogQHJldHVybnMge3N0cmluZ30gZW5kIHN5bWJvbC5cblx0ICAgICAqL1xuXHQgICAgJGludGVycG9sYXRlLmVuZFN5bWJvbCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICByZXR1cm4gZW5kU3ltYm9sO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gJGludGVycG9sYXRlO1xuXHQgIH1dO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiAkSW50ZXJ2YWxQcm92aWRlcigpIHtcblx0ICB0aGlzLiRnZXQgPSBbJyRyb290U2NvcGUnLCAnJHdpbmRvdycsICckcScsICckJHEnLCAnJGJyb3dzZXInLFxuXHQgICAgICAgZnVuY3Rpb24oJHJvb3RTY29wZSwgICAkd2luZG93LCAgICRxLCAgICQkcSwgICAkYnJvd3Nlcikge1xuXHQgICAgdmFyIGludGVydmFscyA9IHt9O1xuXHRcblx0XG5cdCAgICAgLyoqXG5cdCAgICAgICogQG5nZG9jIHNlcnZpY2Vcblx0ICAgICAgKiBAbmFtZSAkaW50ZXJ2YWxcblx0ICAgICAgKlxuXHQgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAqIEFuZ3VsYXIncyB3cmFwcGVyIGZvciBgd2luZG93LnNldEludGVydmFsYC4gVGhlIGBmbmAgZnVuY3Rpb24gaXMgZXhlY3V0ZWQgZXZlcnkgYGRlbGF5YFxuXHQgICAgICAqIG1pbGxpc2Vjb25kcy5cblx0ICAgICAgKlxuXHQgICAgICAqIFRoZSByZXR1cm4gdmFsdWUgb2YgcmVnaXN0ZXJpbmcgYW4gaW50ZXJ2YWwgZnVuY3Rpb24gaXMgYSBwcm9taXNlLiBUaGlzIHByb21pc2Ugd2lsbCBiZVxuXHQgICAgICAqIG5vdGlmaWVkIHVwb24gZWFjaCB0aWNrIG9mIHRoZSBpbnRlcnZhbCwgYW5kIHdpbGwgYmUgcmVzb2x2ZWQgYWZ0ZXIgYGNvdW50YCBpdGVyYXRpb25zLCBvclxuXHQgICAgICAqIHJ1biBpbmRlZmluaXRlbHkgaWYgYGNvdW50YCBpcyBub3QgZGVmaW5lZC4gVGhlIHZhbHVlIG9mIHRoZSBub3RpZmljYXRpb24gd2lsbCBiZSB0aGVcblx0ICAgICAgKiBudW1iZXIgb2YgaXRlcmF0aW9ucyB0aGF0IGhhdmUgcnVuLlxuXHQgICAgICAqIFRvIGNhbmNlbCBhbiBpbnRlcnZhbCwgY2FsbCBgJGludGVydmFsLmNhbmNlbChwcm9taXNlKWAuXG5cdCAgICAgICpcblx0ICAgICAgKiBJbiB0ZXN0cyB5b3UgY2FuIHVzZSB7QGxpbmsgbmdNb2NrLiRpbnRlcnZhbCNmbHVzaCBgJGludGVydmFsLmZsdXNoKG1pbGxpcylgfSB0b1xuXHQgICAgICAqIG1vdmUgZm9yd2FyZCBieSBgbWlsbGlzYCBtaWxsaXNlY29uZHMgYW5kIHRyaWdnZXIgYW55IGZ1bmN0aW9ucyBzY2hlZHVsZWQgdG8gcnVuIGluIHRoYXRcblx0ICAgICAgKiB0aW1lLlxuXHQgICAgICAqXG5cdCAgICAgICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cblx0ICAgICAgKiAqKk5vdGUqKjogSW50ZXJ2YWxzIGNyZWF0ZWQgYnkgdGhpcyBzZXJ2aWNlIG11c3QgYmUgZXhwbGljaXRseSBkZXN0cm95ZWQgd2hlbiB5b3UgYXJlIGZpbmlzaGVkXG5cdCAgICAgICogd2l0aCB0aGVtLiAgSW4gcGFydGljdWxhciB0aGV5IGFyZSBub3QgYXV0b21hdGljYWxseSBkZXN0cm95ZWQgd2hlbiBhIGNvbnRyb2xsZXIncyBzY29wZSBvciBhXG5cdCAgICAgICogZGlyZWN0aXZlJ3MgZWxlbWVudCBhcmUgZGVzdHJveWVkLlxuXHQgICAgICAqIFlvdSBzaG91bGQgdGFrZSB0aGlzIGludG8gY29uc2lkZXJhdGlvbiBhbmQgbWFrZSBzdXJlIHRvIGFsd2F5cyBjYW5jZWwgdGhlIGludGVydmFsIGF0IHRoZVxuXHQgICAgICAqIGFwcHJvcHJpYXRlIG1vbWVudC4gIFNlZSB0aGUgZXhhbXBsZSBiZWxvdyBmb3IgbW9yZSBkZXRhaWxzIG9uIGhvdyBhbmQgd2hlbiB0byBkbyB0aGlzLlxuXHQgICAgICAqIDwvZGl2PlxuXHQgICAgICAqXG5cdCAgICAgICogQHBhcmFtIHtmdW5jdGlvbigpfSBmbiBBIGZ1bmN0aW9uIHRoYXQgc2hvdWxkIGJlIGNhbGxlZCByZXBlYXRlZGx5LlxuXHQgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkZWxheSBOdW1iZXIgb2YgbWlsbGlzZWNvbmRzIGJldHdlZW4gZWFjaCBmdW5jdGlvbiBjYWxsLlxuXHQgICAgICAqIEBwYXJhbSB7bnVtYmVyPX0gW2NvdW50PTBdIE51bWJlciBvZiB0aW1lcyB0byByZXBlYXQuIElmIG5vdCBzZXQsIG9yIDAsIHdpbGwgcmVwZWF0XG5cdCAgICAgICogICBpbmRlZmluaXRlbHkuXG5cdCAgICAgICogQHBhcmFtIHtib29sZWFuPX0gW2ludm9rZUFwcGx5PXRydWVdIElmIHNldCB0byBgZmFsc2VgIHNraXBzIG1vZGVsIGRpcnR5IGNoZWNraW5nLCBvdGhlcndpc2Vcblx0ICAgICAgKiAgIHdpbGwgaW52b2tlIGBmbmAgd2l0aGluIHRoZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkYXBwbHkgJGFwcGx5fSBibG9jay5cblx0ICAgICAgKiBAcGFyYW0gey4uLio9fSBQYXNzIGFkZGl0aW9uYWwgcGFyYW1ldGVycyB0byB0aGUgZXhlY3V0ZWQgZnVuY3Rpb24uXG5cdCAgICAgICogQHJldHVybnMge3Byb21pc2V9IEEgcHJvbWlzZSB3aGljaCB3aWxsIGJlIG5vdGlmaWVkIG9uIGVhY2ggaXRlcmF0aW9uLlxuXHQgICAgICAqXG5cdCAgICAgICogQGV4YW1wbGVcblx0ICAgICAgKiA8ZXhhbXBsZSBtb2R1bGU9XCJpbnRlcnZhbEV4YW1wbGVcIj5cblx0ICAgICAgKiA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAqICAgPHNjcmlwdD5cblx0ICAgICAgKiAgICAgYW5ndWxhci5tb2R1bGUoJ2ludGVydmFsRXhhbXBsZScsIFtdKVxuXHQgICAgICAqICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRpbnRlcnZhbCcsXG5cdCAgICAgICogICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRpbnRlcnZhbCkge1xuXHQgICAgICAqICAgICAgICAgICAkc2NvcGUuZm9ybWF0ID0gJ00vZC95eSBoOm1tOnNzIGEnO1xuXHQgICAgICAqICAgICAgICAgICAkc2NvcGUuYmxvb2RfMSA9IDEwMDtcblx0ICAgICAgKiAgICAgICAgICAgJHNjb3BlLmJsb29kXzIgPSAxMjA7XG5cdCAgICAgICpcblx0ICAgICAgKiAgICAgICAgICAgdmFyIHN0b3A7XG5cdCAgICAgICogICAgICAgICAgICRzY29wZS5maWdodCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAqICAgICAgICAgICAgIC8vIERvbid0IHN0YXJ0IGEgbmV3IGZpZ2h0IGlmIHdlIGFyZSBhbHJlYWR5IGZpZ2h0aW5nXG5cdCAgICAgICogICAgICAgICAgICAgaWYgKCBhbmd1bGFyLmlzRGVmaW5lZChzdG9wKSApIHJldHVybjtcblx0ICAgICAgKlxuXHQgICAgICAqICAgICAgICAgICAgIHN0b3AgPSAkaW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG5cdCAgICAgICogICAgICAgICAgICAgICBpZiAoJHNjb3BlLmJsb29kXzEgPiAwICYmICRzY29wZS5ibG9vZF8yID4gMCkge1xuXHQgICAgICAqICAgICAgICAgICAgICAgICAkc2NvcGUuYmxvb2RfMSA9ICRzY29wZS5ibG9vZF8xIC0gMztcblx0ICAgICAgKiAgICAgICAgICAgICAgICAgJHNjb3BlLmJsb29kXzIgPSAkc2NvcGUuYmxvb2RfMiAtIDQ7XG5cdCAgICAgICogICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAqICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcEZpZ2h0KCk7XG5cdCAgICAgICogICAgICAgICAgICAgICB9XG5cdCAgICAgICogICAgICAgICAgICAgfSwgMTAwKTtcblx0ICAgICAgKiAgICAgICAgICAgfTtcblx0ICAgICAgKlxuXHQgICAgICAqICAgICAgICAgICAkc2NvcGUuc3RvcEZpZ2h0ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICogICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHN0b3ApKSB7XG5cdCAgICAgICogICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHN0b3ApO1xuXHQgICAgICAqICAgICAgICAgICAgICAgc3RvcCA9IHVuZGVmaW5lZDtcblx0ICAgICAgKiAgICAgICAgICAgICB9XG5cdCAgICAgICogICAgICAgICAgIH07XG5cdCAgICAgICpcblx0ICAgICAgKiAgICAgICAgICAgJHNjb3BlLnJlc2V0RmlnaHQgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgKiAgICAgICAgICAgICAkc2NvcGUuYmxvb2RfMSA9IDEwMDtcblx0ICAgICAgKiAgICAgICAgICAgICAkc2NvcGUuYmxvb2RfMiA9IDEyMDtcblx0ICAgICAgKiAgICAgICAgICAgfTtcblx0ICAgICAgKlxuXHQgICAgICAqICAgICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAqICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBpbnRlcnZhbCBpcyBkZXN0cm95ZWQgdG9vXG5cdCAgICAgICogICAgICAgICAgICAgJHNjb3BlLnN0b3BGaWdodCgpO1xuXHQgICAgICAqICAgICAgICAgICB9KTtcblx0ICAgICAgKiAgICAgICAgIH1dKVxuXHQgICAgICAqICAgICAgIC8vIFJlZ2lzdGVyIHRoZSAnbXlDdXJyZW50VGltZScgZGlyZWN0aXZlIGZhY3RvcnkgbWV0aG9kLlxuXHQgICAgICAqICAgICAgIC8vIFdlIGluamVjdCAkaW50ZXJ2YWwgYW5kIGRhdGVGaWx0ZXIgc2VydmljZSBzaW5jZSB0aGUgZmFjdG9yeSBtZXRob2QgaXMgREkuXG5cdCAgICAgICogICAgICAgLmRpcmVjdGl2ZSgnbXlDdXJyZW50VGltZScsIFsnJGludGVydmFsJywgJ2RhdGVGaWx0ZXInLFxuXHQgICAgICAqICAgICAgICAgZnVuY3Rpb24oJGludGVydmFsLCBkYXRlRmlsdGVyKSB7XG5cdCAgICAgICogICAgICAgICAgIC8vIHJldHVybiB0aGUgZGlyZWN0aXZlIGxpbmsgZnVuY3Rpb24uIChjb21waWxlIGZ1bmN0aW9uIG5vdCBuZWVkZWQpXG5cdCAgICAgICogICAgICAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcblx0ICAgICAgKiAgICAgICAgICAgICB2YXIgZm9ybWF0LCAgLy8gZGF0ZSBmb3JtYXRcblx0ICAgICAgKiAgICAgICAgICAgICAgICAgc3RvcFRpbWU7IC8vIHNvIHRoYXQgd2UgY2FuIGNhbmNlbCB0aGUgdGltZSB1cGRhdGVzXG5cdCAgICAgICpcblx0ICAgICAgKiAgICAgICAgICAgICAvLyB1c2VkIHRvIHVwZGF0ZSB0aGUgVUlcblx0ICAgICAgKiAgICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVUaW1lKCkge1xuXHQgICAgICAqICAgICAgICAgICAgICAgZWxlbWVudC50ZXh0KGRhdGVGaWx0ZXIobmV3IERhdGUoKSwgZm9ybWF0KSk7XG5cdCAgICAgICogICAgICAgICAgICAgfVxuXHQgICAgICAqXG5cdCAgICAgICogICAgICAgICAgICAgLy8gd2F0Y2ggdGhlIGV4cHJlc3Npb24sIGFuZCB1cGRhdGUgdGhlIFVJIG9uIGNoYW5nZS5cblx0ICAgICAgKiAgICAgICAgICAgICBzY29wZS4kd2F0Y2goYXR0cnMubXlDdXJyZW50VGltZSwgZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgKiAgICAgICAgICAgICAgIGZvcm1hdCA9IHZhbHVlO1xuXHQgICAgICAqICAgICAgICAgICAgICAgdXBkYXRlVGltZSgpO1xuXHQgICAgICAqICAgICAgICAgICAgIH0pO1xuXHQgICAgICAqXG5cdCAgICAgICogICAgICAgICAgICAgc3RvcFRpbWUgPSAkaW50ZXJ2YWwodXBkYXRlVGltZSwgMTAwMCk7XG5cdCAgICAgICpcblx0ICAgICAgKiAgICAgICAgICAgICAvLyBsaXN0ZW4gb24gRE9NIGRlc3Ryb3kgKHJlbW92YWwpIGV2ZW50LCBhbmQgY2FuY2VsIHRoZSBuZXh0IFVJIHVwZGF0ZVxuXHQgICAgICAqICAgICAgICAgICAgIC8vIHRvIHByZXZlbnQgdXBkYXRpbmcgdGltZSBhZnRlciB0aGUgRE9NIGVsZW1lbnQgd2FzIHJlbW92ZWQuXG5cdCAgICAgICogICAgICAgICAgICAgZWxlbWVudC5vbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcblx0ICAgICAgKiAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwoc3RvcFRpbWUpO1xuXHQgICAgICAqICAgICAgICAgICAgIH0pO1xuXHQgICAgICAqICAgICAgICAgICB9XG5cdCAgICAgICogICAgICAgICB9XSk7XG5cdCAgICAgICogICA8L3NjcmlwdD5cblx0ICAgICAgKlxuXHQgICAgICAqICAgPGRpdj5cblx0ICAgICAgKiAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgKiAgICAgICA8bGFiZWw+RGF0ZSBmb3JtYXQ6IDxpbnB1dCBuZy1tb2RlbD1cImZvcm1hdFwiPjwvbGFiZWw+IDxoci8+XG5cdCAgICAgICogICAgICAgQ3VycmVudCB0aW1lIGlzOiA8c3BhbiBteS1jdXJyZW50LXRpbWU9XCJmb3JtYXRcIj48L3NwYW4+XG5cdCAgICAgICogICAgICAgPGhyLz5cblx0ICAgICAgKiAgICAgICBCbG9vZCAxIDogPGZvbnQgY29sb3I9J3JlZCc+e3tibG9vZF8xfX08L2ZvbnQ+XG5cdCAgICAgICogICAgICAgQmxvb2QgMiA6IDxmb250IGNvbG9yPSdyZWQnPnt7Ymxvb2RfMn19PC9mb250PlxuXHQgICAgICAqICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGRhdGEtbmctY2xpY2s9XCJmaWdodCgpXCI+RmlnaHQ8L2J1dHRvbj5cblx0ICAgICAgKiAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBkYXRhLW5nLWNsaWNrPVwic3RvcEZpZ2h0KClcIj5TdG9wRmlnaHQ8L2J1dHRvbj5cblx0ICAgICAgKiAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBkYXRhLW5nLWNsaWNrPVwicmVzZXRGaWdodCgpXCI+cmVzZXRGaWdodDwvYnV0dG9uPlxuXHQgICAgICAqICAgICA8L2Rpdj5cblx0ICAgICAgKiAgIDwvZGl2PlxuXHQgICAgICAqXG5cdCAgICAgICogPC9maWxlPlxuXHQgICAgICAqIDwvZXhhbXBsZT5cblx0ICAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIGludGVydmFsKGZuLCBkZWxheSwgY291bnQsIGludm9rZUFwcGx5KSB7XG5cdCAgICAgIHZhciBoYXNQYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gNCxcblx0ICAgICAgICAgIGFyZ3MgPSBoYXNQYXJhbXMgPyBzbGljZUFyZ3MoYXJndW1lbnRzLCA0KSA6IFtdLFxuXHQgICAgICAgICAgc2V0SW50ZXJ2YWwgPSAkd2luZG93LnNldEludGVydmFsLFxuXHQgICAgICAgICAgY2xlYXJJbnRlcnZhbCA9ICR3aW5kb3cuY2xlYXJJbnRlcnZhbCxcblx0ICAgICAgICAgIGl0ZXJhdGlvbiA9IDAsXG5cdCAgICAgICAgICBza2lwQXBwbHkgPSAoaXNEZWZpbmVkKGludm9rZUFwcGx5KSAmJiAhaW52b2tlQXBwbHkpLFxuXHQgICAgICAgICAgZGVmZXJyZWQgPSAoc2tpcEFwcGx5ID8gJCRxIDogJHEpLmRlZmVyKCksXG5cdCAgICAgICAgICBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcblx0XG5cdCAgICAgIGNvdW50ID0gaXNEZWZpbmVkKGNvdW50KSA/IGNvdW50IDogMDtcblx0XG5cdCAgICAgIHByb21pc2UuJCRpbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gdGljaygpIHtcblx0ICAgICAgICBpZiAoc2tpcEFwcGx5KSB7XG5cdCAgICAgICAgICAkYnJvd3Nlci5kZWZlcihjYWxsYmFjayk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICRyb290U2NvcGUuJGV2YWxBc3luYyhjYWxsYmFjayk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGRlZmVycmVkLm5vdGlmeShpdGVyYXRpb24rKyk7XG5cdFxuXHQgICAgICAgIGlmIChjb3VudCA+IDAgJiYgaXRlcmF0aW9uID49IGNvdW50KSB7XG5cdCAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGl0ZXJhdGlvbik7XG5cdCAgICAgICAgICBjbGVhckludGVydmFsKHByb21pc2UuJCRpbnRlcnZhbElkKTtcblx0ICAgICAgICAgIGRlbGV0ZSBpbnRlcnZhbHNbcHJvbWlzZS4kJGludGVydmFsSWRdO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKCFza2lwQXBwbHkpICRyb290U2NvcGUuJGFwcGx5KCk7XG5cdFxuXHQgICAgICB9LCBkZWxheSk7XG5cdFxuXHQgICAgICBpbnRlcnZhbHNbcHJvbWlzZS4kJGludGVydmFsSWRdID0gZGVmZXJyZWQ7XG5cdFxuXHQgICAgICByZXR1cm4gcHJvbWlzZTtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKCkge1xuXHQgICAgICAgIGlmICghaGFzUGFyYW1zKSB7XG5cdCAgICAgICAgICBmbihpdGVyYXRpb24pO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBmbi5hcHBseShudWxsLCBhcmdzKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdFxuXHQgICAgIC8qKlxuXHQgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgKiBAbmFtZSAkaW50ZXJ2YWwjY2FuY2VsXG5cdCAgICAgICpcblx0ICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgKiBDYW5jZWxzIGEgdGFzayBhc3NvY2lhdGVkIHdpdGggdGhlIGBwcm9taXNlYC5cblx0ICAgICAgKlxuXHQgICAgICAqIEBwYXJhbSB7UHJvbWlzZT19IHByb21pc2UgcmV0dXJuZWQgYnkgdGhlIGAkaW50ZXJ2YWxgIGZ1bmN0aW9uLlxuXHQgICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgdGFzayB3YXMgc3VjY2Vzc2Z1bGx5IGNhbmNlbGVkLlxuXHQgICAgICAqL1xuXHQgICAgaW50ZXJ2YWwuY2FuY2VsID0gZnVuY3Rpb24ocHJvbWlzZSkge1xuXHQgICAgICBpZiAocHJvbWlzZSAmJiBwcm9taXNlLiQkaW50ZXJ2YWxJZCBpbiBpbnRlcnZhbHMpIHtcblx0ICAgICAgICBpbnRlcnZhbHNbcHJvbWlzZS4kJGludGVydmFsSWRdLnJlamVjdCgnY2FuY2VsZWQnKTtcblx0ICAgICAgICAkd2luZG93LmNsZWFySW50ZXJ2YWwocHJvbWlzZS4kJGludGVydmFsSWQpO1xuXHQgICAgICAgIGRlbGV0ZSBpbnRlcnZhbHNbcHJvbWlzZS4kJGludGVydmFsSWRdO1xuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIGludGVydmFsO1xuXHQgIH1dO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHNlcnZpY2Vcblx0ICogQG5hbWUgJGxvY2FsZVxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogJGxvY2FsZSBzZXJ2aWNlIHByb3ZpZGVzIGxvY2FsaXphdGlvbiBydWxlcyBmb3IgdmFyaW91cyBBbmd1bGFyIGNvbXBvbmVudHMuIEFzIG9mIHJpZ2h0IG5vdyB0aGVcblx0ICogb25seSBwdWJsaWMgYXBpIGlzOlxuXHQgKlxuXHQgKiAqIGBpZGAg4oCTIGB7c3RyaW5nfWAg4oCTIGxvY2FsZSBpZCBmb3JtYXR0ZWQgYXMgYGxhbmd1YWdlSWQtY291bnRyeUlkYCAoZS5nLiBgZW4tdXNgKVxuXHQgKi9cblx0XG5cdHZhciBQQVRIX01BVENIID0gL14oW15cXD8jXSopKFxcPyhbXiNdKikpPygjKC4qKSk/JC8sXG5cdCAgICBERUZBVUxUX1BPUlRTID0geydodHRwJzogODAsICdodHRwcyc6IDQ0MywgJ2Z0cCc6IDIxfTtcblx0dmFyICRsb2NhdGlvbk1pbkVyciA9IG1pbkVycignJGxvY2F0aW9uJyk7XG5cdFxuXHRcblx0LyoqXG5cdCAqIEVuY29kZSBwYXRoIHVzaW5nIGVuY29kZVVyaVNlZ21lbnQsIGlnbm9yaW5nIGZvcndhcmQgc2xhc2hlc1xuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gcGF0aCBQYXRoIHRvIGVuY29kZVxuXHQgKiBAcmV0dXJucyB7c3RyaW5nfVxuXHQgKi9cblx0ZnVuY3Rpb24gZW5jb2RlUGF0aChwYXRoKSB7XG5cdCAgdmFyIHNlZ21lbnRzID0gcGF0aC5zcGxpdCgnLycpLFxuXHQgICAgICBpID0gc2VnbWVudHMubGVuZ3RoO1xuXHRcblx0ICB3aGlsZSAoaS0tKSB7XG5cdCAgICBzZWdtZW50c1tpXSA9IGVuY29kZVVyaVNlZ21lbnQoc2VnbWVudHNbaV0pO1xuXHQgIH1cblx0XG5cdCAgcmV0dXJuIHNlZ21lbnRzLmpvaW4oJy8nKTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gcGFyc2VBYnNvbHV0ZVVybChhYnNvbHV0ZVVybCwgbG9jYXRpb25PYmopIHtcblx0ICB2YXIgcGFyc2VkVXJsID0gdXJsUmVzb2x2ZShhYnNvbHV0ZVVybCk7XG5cdFxuXHQgIGxvY2F0aW9uT2JqLiQkcHJvdG9jb2wgPSBwYXJzZWRVcmwucHJvdG9jb2w7XG5cdCAgbG9jYXRpb25PYmouJCRob3N0ID0gcGFyc2VkVXJsLmhvc3RuYW1lO1xuXHQgIGxvY2F0aW9uT2JqLiQkcG9ydCA9IHRvSW50KHBhcnNlZFVybC5wb3J0KSB8fCBERUZBVUxUX1BPUlRTW3BhcnNlZFVybC5wcm90b2NvbF0gfHwgbnVsbDtcblx0fVxuXHRcblx0XG5cdGZ1bmN0aW9uIHBhcnNlQXBwVXJsKHJlbGF0aXZlVXJsLCBsb2NhdGlvbk9iaikge1xuXHQgIHZhciBwcmVmaXhlZCA9IChyZWxhdGl2ZVVybC5jaGFyQXQoMCkgIT09ICcvJyk7XG5cdCAgaWYgKHByZWZpeGVkKSB7XG5cdCAgICByZWxhdGl2ZVVybCA9ICcvJyArIHJlbGF0aXZlVXJsO1xuXHQgIH1cblx0ICB2YXIgbWF0Y2ggPSB1cmxSZXNvbHZlKHJlbGF0aXZlVXJsKTtcblx0ICBsb2NhdGlvbk9iai4kJHBhdGggPSBkZWNvZGVVUklDb21wb25lbnQocHJlZml4ZWQgJiYgbWF0Y2gucGF0aG5hbWUuY2hhckF0KDApID09PSAnLycgP1xuXHQgICAgICBtYXRjaC5wYXRobmFtZS5zdWJzdHJpbmcoMSkgOiBtYXRjaC5wYXRobmFtZSk7XG5cdCAgbG9jYXRpb25PYmouJCRzZWFyY2ggPSBwYXJzZUtleVZhbHVlKG1hdGNoLnNlYXJjaCk7XG5cdCAgbG9jYXRpb25PYmouJCRoYXNoID0gZGVjb2RlVVJJQ29tcG9uZW50KG1hdGNoLmhhc2gpO1xuXHRcblx0ICAvLyBtYWtlIHN1cmUgcGF0aCBzdGFydHMgd2l0aCAnLyc7XG5cdCAgaWYgKGxvY2F0aW9uT2JqLiQkcGF0aCAmJiBsb2NhdGlvbk9iai4kJHBhdGguY2hhckF0KDApICE9ICcvJykge1xuXHQgICAgbG9jYXRpb25PYmouJCRwYXRoID0gJy8nICsgbG9jYXRpb25PYmouJCRwYXRoO1xuXHQgIH1cblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gYmVnaW5cblx0ICogQHBhcmFtIHtzdHJpbmd9IHdob2xlXG5cdCAqIEByZXR1cm5zIHtzdHJpbmd9IHJldHVybnMgdGV4dCBmcm9tIHdob2xlIGFmdGVyIGJlZ2luIG9yIHVuZGVmaW5lZCBpZiBpdCBkb2VzIG5vdCBiZWdpbiB3aXRoXG5cdCAqICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkIHN0cmluZy5cblx0ICovXG5cdGZ1bmN0aW9uIGJlZ2luc1dpdGgoYmVnaW4sIHdob2xlKSB7XG5cdCAgaWYgKHdob2xlLmluZGV4T2YoYmVnaW4pID09PSAwKSB7XG5cdCAgICByZXR1cm4gd2hvbGUuc3Vic3RyKGJlZ2luLmxlbmd0aCk7XG5cdCAgfVxuXHR9XG5cdFxuXHRcblx0ZnVuY3Rpb24gc3RyaXBIYXNoKHVybCkge1xuXHQgIHZhciBpbmRleCA9IHVybC5pbmRleE9mKCcjJyk7XG5cdCAgcmV0dXJuIGluZGV4ID09IC0xID8gdXJsIDogdXJsLnN1YnN0cigwLCBpbmRleCk7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHRyaW1FbXB0eUhhc2godXJsKSB7XG5cdCAgcmV0dXJuIHVybC5yZXBsYWNlKC8oIy4rKXwjJC8sICckMScpO1xuXHR9XG5cdFxuXHRcblx0ZnVuY3Rpb24gc3RyaXBGaWxlKHVybCkge1xuXHQgIHJldHVybiB1cmwuc3Vic3RyKDAsIHN0cmlwSGFzaCh1cmwpLmxhc3RJbmRleE9mKCcvJykgKyAxKTtcblx0fVxuXHRcblx0LyogcmV0dXJuIHRoZSBzZXJ2ZXIgb25seSAoc2NoZW1lOi8vaG9zdDpwb3J0KSAqL1xuXHRmdW5jdGlvbiBzZXJ2ZXJCYXNlKHVybCkge1xuXHQgIHJldHVybiB1cmwuc3Vic3RyaW5nKDAsIHVybC5pbmRleE9mKCcvJywgdXJsLmluZGV4T2YoJy8vJykgKyAyKSk7XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogTG9jYXRpb25IdG1sNVVybCByZXByZXNlbnRzIGFuIHVybFxuXHQgKiBUaGlzIG9iamVjdCBpcyBleHBvc2VkIGFzICRsb2NhdGlvbiBzZXJ2aWNlIHdoZW4gSFRNTDUgbW9kZSBpcyBlbmFibGVkIGFuZCBzdXBwb3J0ZWRcblx0ICpcblx0ICogQGNvbnN0cnVjdG9yXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBhcHBCYXNlIGFwcGxpY2F0aW9uIGJhc2UgVVJMXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBhcHBCYXNlTm9GaWxlIGFwcGxpY2F0aW9uIGJhc2UgVVJMIHN0cmlwcGVkIG9mIGFueSBmaWxlbmFtZVxuXHQgKiBAcGFyYW0ge3N0cmluZ30gYmFzZVByZWZpeCB1cmwgcGF0aCBwcmVmaXhcblx0ICovXG5cdGZ1bmN0aW9uIExvY2F0aW9uSHRtbDVVcmwoYXBwQmFzZSwgYXBwQmFzZU5vRmlsZSwgYmFzZVByZWZpeCkge1xuXHQgIHRoaXMuJCRodG1sNSA9IHRydWU7XG5cdCAgYmFzZVByZWZpeCA9IGJhc2VQcmVmaXggfHwgJyc7XG5cdCAgcGFyc2VBYnNvbHV0ZVVybChhcHBCYXNlLCB0aGlzKTtcblx0XG5cdFxuXHQgIC8qKlxuXHQgICAqIFBhcnNlIGdpdmVuIGh0bWw1IChyZWd1bGFyKSB1cmwgc3RyaW5nIGludG8gcHJvcGVydGllc1xuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgSFRNTDUgdXJsXG5cdCAgICogQHByaXZhdGVcblx0ICAgKi9cblx0ICB0aGlzLiQkcGFyc2UgPSBmdW5jdGlvbih1cmwpIHtcblx0ICAgIHZhciBwYXRoVXJsID0gYmVnaW5zV2l0aChhcHBCYXNlTm9GaWxlLCB1cmwpO1xuXHQgICAgaWYgKCFpc1N0cmluZyhwYXRoVXJsKSkge1xuXHQgICAgICB0aHJvdyAkbG9jYXRpb25NaW5FcnIoJ2lwdGhwcmZ4JywgJ0ludmFsaWQgdXJsIFwiezB9XCIsIG1pc3NpbmcgcGF0aCBwcmVmaXggXCJ7MX1cIi4nLCB1cmwsXG5cdCAgICAgICAgICBhcHBCYXNlTm9GaWxlKTtcblx0ICAgIH1cblx0XG5cdCAgICBwYXJzZUFwcFVybChwYXRoVXJsLCB0aGlzKTtcblx0XG5cdCAgICBpZiAoIXRoaXMuJCRwYXRoKSB7XG5cdCAgICAgIHRoaXMuJCRwYXRoID0gJy8nO1xuXHQgICAgfVxuXHRcblx0ICAgIHRoaXMuJCRjb21wb3NlKCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ29tcG9zZSB1cmwgYW5kIHVwZGF0ZSBgYWJzVXJsYCBwcm9wZXJ0eVxuXHQgICAqIEBwcml2YXRlXG5cdCAgICovXG5cdCAgdGhpcy4kJGNvbXBvc2UgPSBmdW5jdGlvbigpIHtcblx0ICAgIHZhciBzZWFyY2ggPSB0b0tleVZhbHVlKHRoaXMuJCRzZWFyY2gpLFxuXHQgICAgICAgIGhhc2ggPSB0aGlzLiQkaGFzaCA/ICcjJyArIGVuY29kZVVyaVNlZ21lbnQodGhpcy4kJGhhc2gpIDogJyc7XG5cdFxuXHQgICAgdGhpcy4kJHVybCA9IGVuY29kZVBhdGgodGhpcy4kJHBhdGgpICsgKHNlYXJjaCA/ICc/JyArIHNlYXJjaCA6ICcnKSArIGhhc2g7XG5cdCAgICB0aGlzLiQkYWJzVXJsID0gYXBwQmFzZU5vRmlsZSArIHRoaXMuJCR1cmwuc3Vic3RyKDEpOyAvLyBmaXJzdCBjaGFyIGlzIGFsd2F5cyAnLydcblx0ICB9O1xuXHRcblx0ICB0aGlzLiQkcGFyc2VMaW5rVXJsID0gZnVuY3Rpb24odXJsLCByZWxIcmVmKSB7XG5cdCAgICBpZiAocmVsSHJlZiAmJiByZWxIcmVmWzBdID09PSAnIycpIHtcblx0ICAgICAgLy8gc3BlY2lhbCBjYXNlIGZvciBsaW5rcyB0byBoYXNoIGZyYWdtZW50czpcblx0ICAgICAgLy8ga2VlcCB0aGUgb2xkIHVybCBhbmQgb25seSByZXBsYWNlIHRoZSBoYXNoIGZyYWdtZW50XG5cdCAgICAgIHRoaXMuaGFzaChyZWxIcmVmLnNsaWNlKDEpKTtcblx0ICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9XG5cdCAgICB2YXIgYXBwVXJsLCBwcmV2QXBwVXJsO1xuXHQgICAgdmFyIHJld3JpdHRlblVybDtcblx0XG5cdCAgICBpZiAoaXNEZWZpbmVkKGFwcFVybCA9IGJlZ2luc1dpdGgoYXBwQmFzZSwgdXJsKSkpIHtcblx0ICAgICAgcHJldkFwcFVybCA9IGFwcFVybDtcblx0ICAgICAgaWYgKGlzRGVmaW5lZChhcHBVcmwgPSBiZWdpbnNXaXRoKGJhc2VQcmVmaXgsIGFwcFVybCkpKSB7XG5cdCAgICAgICAgcmV3cml0dGVuVXJsID0gYXBwQmFzZU5vRmlsZSArIChiZWdpbnNXaXRoKCcvJywgYXBwVXJsKSB8fCBhcHBVcmwpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHJld3JpdHRlblVybCA9IGFwcEJhc2UgKyBwcmV2QXBwVXJsO1xuXHQgICAgICB9XG5cdCAgICB9IGVsc2UgaWYgKGlzRGVmaW5lZChhcHBVcmwgPSBiZWdpbnNXaXRoKGFwcEJhc2VOb0ZpbGUsIHVybCkpKSB7XG5cdCAgICAgIHJld3JpdHRlblVybCA9IGFwcEJhc2VOb0ZpbGUgKyBhcHBVcmw7XG5cdCAgICB9IGVsc2UgaWYgKGFwcEJhc2VOb0ZpbGUgPT0gdXJsICsgJy8nKSB7XG5cdCAgICAgIHJld3JpdHRlblVybCA9IGFwcEJhc2VOb0ZpbGU7XG5cdCAgICB9XG5cdCAgICBpZiAocmV3cml0dGVuVXJsKSB7XG5cdCAgICAgIHRoaXMuJCRwYXJzZShyZXdyaXR0ZW5VcmwpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuICEhcmV3cml0dGVuVXJsO1xuXHQgIH07XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogTG9jYXRpb25IYXNoYmFuZ1VybCByZXByZXNlbnRzIHVybFxuXHQgKiBUaGlzIG9iamVjdCBpcyBleHBvc2VkIGFzICRsb2NhdGlvbiBzZXJ2aWNlIHdoZW4gZGV2ZWxvcGVyIGRvZXNuJ3Qgb3B0IGludG8gaHRtbDUgbW9kZS5cblx0ICogSXQgYWxzbyBzZXJ2ZXMgYXMgdGhlIGJhc2UgY2xhc3MgZm9yIGh0bWw1IG1vZGUgZmFsbGJhY2sgb24gbGVnYWN5IGJyb3dzZXJzLlxuXHQgKlxuXHQgKiBAY29uc3RydWN0b3Jcblx0ICogQHBhcmFtIHtzdHJpbmd9IGFwcEJhc2UgYXBwbGljYXRpb24gYmFzZSBVUkxcblx0ICogQHBhcmFtIHtzdHJpbmd9IGFwcEJhc2VOb0ZpbGUgYXBwbGljYXRpb24gYmFzZSBVUkwgc3RyaXBwZWQgb2YgYW55IGZpbGVuYW1lXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBoYXNoUHJlZml4IGhhc2hiYW5nIHByZWZpeFxuXHQgKi9cblx0ZnVuY3Rpb24gTG9jYXRpb25IYXNoYmFuZ1VybChhcHBCYXNlLCBhcHBCYXNlTm9GaWxlLCBoYXNoUHJlZml4KSB7XG5cdFxuXHQgIHBhcnNlQWJzb2x1dGVVcmwoYXBwQmFzZSwgdGhpcyk7XG5cdFxuXHRcblx0ICAvKipcblx0ICAgKiBQYXJzZSBnaXZlbiBoYXNoYmFuZyB1cmwgaW50byBwcm9wZXJ0aWVzXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHVybCBIYXNoYmFuZyB1cmxcblx0ICAgKiBAcHJpdmF0ZVxuXHQgICAqL1xuXHQgIHRoaXMuJCRwYXJzZSA9IGZ1bmN0aW9uKHVybCkge1xuXHQgICAgdmFyIHdpdGhvdXRCYXNlVXJsID0gYmVnaW5zV2l0aChhcHBCYXNlLCB1cmwpIHx8IGJlZ2luc1dpdGgoYXBwQmFzZU5vRmlsZSwgdXJsKTtcblx0ICAgIHZhciB3aXRob3V0SGFzaFVybDtcblx0XG5cdCAgICBpZiAoIWlzVW5kZWZpbmVkKHdpdGhvdXRCYXNlVXJsKSAmJiB3aXRob3V0QmFzZVVybC5jaGFyQXQoMCkgPT09ICcjJykge1xuXHRcblx0ICAgICAgLy8gVGhlIHJlc3Qgb2YgdGhlIHVybCBzdGFydHMgd2l0aCBhIGhhc2ggc28gd2UgaGF2ZVxuXHQgICAgICAvLyBnb3QgZWl0aGVyIGEgaGFzaGJhbmcgcGF0aCBvciBhIHBsYWluIGhhc2ggZnJhZ21lbnRcblx0ICAgICAgd2l0aG91dEhhc2hVcmwgPSBiZWdpbnNXaXRoKGhhc2hQcmVmaXgsIHdpdGhvdXRCYXNlVXJsKTtcblx0ICAgICAgaWYgKGlzVW5kZWZpbmVkKHdpdGhvdXRIYXNoVXJsKSkge1xuXHQgICAgICAgIC8vIFRoZXJlIHdhcyBubyBoYXNoYmFuZyBwcmVmaXggc28gd2UganVzdCBoYXZlIGEgaGFzaCBmcmFnbWVudFxuXHQgICAgICAgIHdpdGhvdXRIYXNoVXJsID0gd2l0aG91dEJhc2VVcmw7XG5cdCAgICAgIH1cblx0XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICAvLyBUaGVyZSB3YXMgbm8gaGFzaGJhbmcgcGF0aCBub3IgaGFzaCBmcmFnbWVudDpcblx0ICAgICAgLy8gSWYgd2UgYXJlIGluIEhUTUw1IG1vZGUgd2UgdXNlIHdoYXQgaXMgbGVmdCBhcyB0aGUgcGF0aDtcblx0ICAgICAgLy8gT3RoZXJ3aXNlIHdlIGlnbm9yZSB3aGF0IGlzIGxlZnRcblx0ICAgICAgaWYgKHRoaXMuJCRodG1sNSkge1xuXHQgICAgICAgIHdpdGhvdXRIYXNoVXJsID0gd2l0aG91dEJhc2VVcmw7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgd2l0aG91dEhhc2hVcmwgPSAnJztcblx0ICAgICAgICBpZiAoaXNVbmRlZmluZWQod2l0aG91dEJhc2VVcmwpKSB7XG5cdCAgICAgICAgICBhcHBCYXNlID0gdXJsO1xuXHQgICAgICAgICAgdGhpcy5yZXBsYWNlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgcGFyc2VBcHBVcmwod2l0aG91dEhhc2hVcmwsIHRoaXMpO1xuXHRcblx0ICAgIHRoaXMuJCRwYXRoID0gcmVtb3ZlV2luZG93c0RyaXZlTmFtZSh0aGlzLiQkcGF0aCwgd2l0aG91dEhhc2hVcmwsIGFwcEJhc2UpO1xuXHRcblx0ICAgIHRoaXMuJCRjb21wb3NlKCk7XG5cdFxuXHQgICAgLypcblx0ICAgICAqIEluIFdpbmRvd3MsIG9uIGFuIGFuY2hvciBub2RlIG9uIGRvY3VtZW50cyBsb2FkZWQgZnJvbVxuXHQgICAgICogdGhlIGZpbGVzeXN0ZW0sIHRoZSBicm93c2VyIHdpbGwgcmV0dXJuIGEgcGF0aG5hbWVcblx0ICAgICAqIHByZWZpeGVkIHdpdGggdGhlIGRyaXZlIG5hbWUgKCcvQzovcGF0aCcpIHdoZW4gYVxuXHQgICAgICogcGF0aG5hbWUgd2l0aG91dCBhIGRyaXZlIGlzIHNldDpcblx0ICAgICAqICAqIGEuc2V0QXR0cmlidXRlKCdocmVmJywgJy9mb28nKVxuXHQgICAgICogICAqIGEucGF0aG5hbWUgPT09ICcvQzovZm9vJyAvL3RydWVcblx0ICAgICAqXG5cdCAgICAgKiBJbnNpZGUgb2YgQW5ndWxhciwgd2UncmUgYWx3YXlzIHVzaW5nIHBhdGhuYW1lcyB0aGF0XG5cdCAgICAgKiBkbyBub3QgaW5jbHVkZSBkcml2ZSBuYW1lcyBmb3Igcm91dGluZy5cblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gcmVtb3ZlV2luZG93c0RyaXZlTmFtZShwYXRoLCB1cmwsIGJhc2UpIHtcblx0ICAgICAgLypcblx0ICAgICAgTWF0Y2hlcyBwYXRocyBmb3IgZmlsZSBwcm90b2NvbCBvbiB3aW5kb3dzLFxuXHQgICAgICBzdWNoIGFzIC9DOi9mb28vYmFyLCBhbmQgY2FwdHVyZXMgb25seSAvZm9vL2Jhci5cblx0ICAgICAgKi9cblx0ICAgICAgdmFyIHdpbmRvd3NGaWxlUGF0aEV4cCA9IC9eXFwvW0EtWl06KFxcLy4qKS87XG5cdFxuXHQgICAgICB2YXIgZmlyc3RQYXRoU2VnbWVudE1hdGNoO1xuXHRcblx0ICAgICAgLy9HZXQgdGhlIHJlbGF0aXZlIHBhdGggZnJvbSB0aGUgaW5wdXQgVVJMLlxuXHQgICAgICBpZiAodXJsLmluZGV4T2YoYmFzZSkgPT09IDApIHtcblx0ICAgICAgICB1cmwgPSB1cmwucmVwbGFjZShiYXNlLCAnJyk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vIFRoZSBpbnB1dCBVUkwgaW50ZW50aW9uYWxseSBjb250YWlucyBhIGZpcnN0IHBhdGggc2VnbWVudCB0aGF0IGVuZHMgd2l0aCBhIGNvbG9uLlxuXHQgICAgICBpZiAod2luZG93c0ZpbGVQYXRoRXhwLmV4ZWModXJsKSkge1xuXHQgICAgICAgIHJldHVybiBwYXRoO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBmaXJzdFBhdGhTZWdtZW50TWF0Y2ggPSB3aW5kb3dzRmlsZVBhdGhFeHAuZXhlYyhwYXRoKTtcblx0ICAgICAgcmV0dXJuIGZpcnN0UGF0aFNlZ21lbnRNYXRjaCA/IGZpcnN0UGF0aFNlZ21lbnRNYXRjaFsxXSA6IHBhdGg7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ29tcG9zZSBoYXNoYmFuZyB1cmwgYW5kIHVwZGF0ZSBgYWJzVXJsYCBwcm9wZXJ0eVxuXHQgICAqIEBwcml2YXRlXG5cdCAgICovXG5cdCAgdGhpcy4kJGNvbXBvc2UgPSBmdW5jdGlvbigpIHtcblx0ICAgIHZhciBzZWFyY2ggPSB0b0tleVZhbHVlKHRoaXMuJCRzZWFyY2gpLFxuXHQgICAgICAgIGhhc2ggPSB0aGlzLiQkaGFzaCA/ICcjJyArIGVuY29kZVVyaVNlZ21lbnQodGhpcy4kJGhhc2gpIDogJyc7XG5cdFxuXHQgICAgdGhpcy4kJHVybCA9IGVuY29kZVBhdGgodGhpcy4kJHBhdGgpICsgKHNlYXJjaCA/ICc/JyArIHNlYXJjaCA6ICcnKSArIGhhc2g7XG5cdCAgICB0aGlzLiQkYWJzVXJsID0gYXBwQmFzZSArICh0aGlzLiQkdXJsID8gaGFzaFByZWZpeCArIHRoaXMuJCR1cmwgOiAnJyk7XG5cdCAgfTtcblx0XG5cdCAgdGhpcy4kJHBhcnNlTGlua1VybCA9IGZ1bmN0aW9uKHVybCwgcmVsSHJlZikge1xuXHQgICAgaWYgKHN0cmlwSGFzaChhcHBCYXNlKSA9PSBzdHJpcEhhc2godXJsKSkge1xuXHQgICAgICB0aGlzLiQkcGFyc2UodXJsKTtcblx0ICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gZmFsc2U7XG5cdCAgfTtcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBMb2NhdGlvbkhhc2hiYW5nVXJsIHJlcHJlc2VudHMgdXJsXG5cdCAqIFRoaXMgb2JqZWN0IGlzIGV4cG9zZWQgYXMgJGxvY2F0aW9uIHNlcnZpY2Ugd2hlbiBodG1sNSBoaXN0b3J5IGFwaSBpcyBlbmFibGVkIGJ1dCB0aGUgYnJvd3NlclxuXHQgKiBkb2VzIG5vdCBzdXBwb3J0IGl0LlxuXHQgKlxuXHQgKiBAY29uc3RydWN0b3Jcblx0ICogQHBhcmFtIHtzdHJpbmd9IGFwcEJhc2UgYXBwbGljYXRpb24gYmFzZSBVUkxcblx0ICogQHBhcmFtIHtzdHJpbmd9IGFwcEJhc2VOb0ZpbGUgYXBwbGljYXRpb24gYmFzZSBVUkwgc3RyaXBwZWQgb2YgYW55IGZpbGVuYW1lXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBoYXNoUHJlZml4IGhhc2hiYW5nIHByZWZpeFxuXHQgKi9cblx0ZnVuY3Rpb24gTG9jYXRpb25IYXNoYmFuZ0luSHRtbDVVcmwoYXBwQmFzZSwgYXBwQmFzZU5vRmlsZSwgaGFzaFByZWZpeCkge1xuXHQgIHRoaXMuJCRodG1sNSA9IHRydWU7XG5cdCAgTG9jYXRpb25IYXNoYmFuZ1VybC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcblx0ICB0aGlzLiQkcGFyc2VMaW5rVXJsID0gZnVuY3Rpb24odXJsLCByZWxIcmVmKSB7XG5cdCAgICBpZiAocmVsSHJlZiAmJiByZWxIcmVmWzBdID09PSAnIycpIHtcblx0ICAgICAgLy8gc3BlY2lhbCBjYXNlIGZvciBsaW5rcyB0byBoYXNoIGZyYWdtZW50czpcblx0ICAgICAgLy8ga2VlcCB0aGUgb2xkIHVybCBhbmQgb25seSByZXBsYWNlIHRoZSBoYXNoIGZyYWdtZW50XG5cdCAgICAgIHRoaXMuaGFzaChyZWxIcmVmLnNsaWNlKDEpKTtcblx0ICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIHJld3JpdHRlblVybDtcblx0ICAgIHZhciBhcHBVcmw7XG5cdFxuXHQgICAgaWYgKGFwcEJhc2UgPT0gc3RyaXBIYXNoKHVybCkpIHtcblx0ICAgICAgcmV3cml0dGVuVXJsID0gdXJsO1xuXHQgICAgfSBlbHNlIGlmICgoYXBwVXJsID0gYmVnaW5zV2l0aChhcHBCYXNlTm9GaWxlLCB1cmwpKSkge1xuXHQgICAgICByZXdyaXR0ZW5VcmwgPSBhcHBCYXNlICsgaGFzaFByZWZpeCArIGFwcFVybDtcblx0ICAgIH0gZWxzZSBpZiAoYXBwQmFzZU5vRmlsZSA9PT0gdXJsICsgJy8nKSB7XG5cdCAgICAgIHJld3JpdHRlblVybCA9IGFwcEJhc2VOb0ZpbGU7XG5cdCAgICB9XG5cdCAgICBpZiAocmV3cml0dGVuVXJsKSB7XG5cdCAgICAgIHRoaXMuJCRwYXJzZShyZXdyaXR0ZW5VcmwpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuICEhcmV3cml0dGVuVXJsO1xuXHQgIH07XG5cdFxuXHQgIHRoaXMuJCRjb21wb3NlID0gZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgc2VhcmNoID0gdG9LZXlWYWx1ZSh0aGlzLiQkc2VhcmNoKSxcblx0ICAgICAgICBoYXNoID0gdGhpcy4kJGhhc2ggPyAnIycgKyBlbmNvZGVVcmlTZWdtZW50KHRoaXMuJCRoYXNoKSA6ICcnO1xuXHRcblx0ICAgIHRoaXMuJCR1cmwgPSBlbmNvZGVQYXRoKHRoaXMuJCRwYXRoKSArIChzZWFyY2ggPyAnPycgKyBzZWFyY2ggOiAnJykgKyBoYXNoO1xuXHQgICAgLy8gaW5jbHVkZSBoYXNoUHJlZml4IGluICQkYWJzVXJsIHdoZW4gJCR1cmwgaXMgZW1wdHkgc28gSUU5IGRvZXMgbm90IHJlbG9hZCBwYWdlIGJlY2F1c2Ugb2YgcmVtb3ZhbCBvZiAnIydcblx0ICAgIHRoaXMuJCRhYnNVcmwgPSBhcHBCYXNlICsgaGFzaFByZWZpeCArIHRoaXMuJCR1cmw7XG5cdCAgfTtcblx0XG5cdH1cblx0XG5cdFxuXHR2YXIgbG9jYXRpb25Qcm90b3R5cGUgPSB7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEFyZSB3ZSBpbiBodG1sNSBtb2RlP1xuXHQgICAqIEBwcml2YXRlXG5cdCAgICovXG5cdCAgJCRodG1sNTogZmFsc2UsXG5cdFxuXHQgIC8qKlxuXHQgICAqIEhhcyBhbnkgY2hhbmdlIGJlZW4gcmVwbGFjaW5nP1xuXHQgICAqIEBwcml2YXRlXG5cdCAgICovXG5cdCAgJCRyZXBsYWNlOiBmYWxzZSxcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRsb2NhdGlvbiNhYnNVcmxcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFRoaXMgbWV0aG9kIGlzIGdldHRlciBvbmx5LlxuXHQgICAqXG5cdCAgICogUmV0dXJuIGZ1bGwgdXJsIHJlcHJlc2VudGF0aW9uIHdpdGggYWxsIHNlZ21lbnRzIGVuY29kZWQgYWNjb3JkaW5nIHRvIHJ1bGVzIHNwZWNpZmllZCBpblxuXHQgICAqIFtSRkMgMzk4Nl0oaHR0cDovL3d3dy5pZXRmLm9yZy9yZmMvcmZjMzk4Ni50eHQpLlxuXHQgICAqXG5cdCAgICpcblx0ICAgKiBgYGBqc1xuXHQgICAqIC8vIGdpdmVuIHVybCBodHRwOi8vZXhhbXBsZS5jb20vIy9zb21lL3BhdGg/Zm9vPWJhciZiYXo9eG94b1xuXHQgICAqIHZhciBhYnNVcmwgPSAkbG9jYXRpb24uYWJzVXJsKCk7XG5cdCAgICogLy8gPT4gXCJodHRwOi8vZXhhbXBsZS5jb20vIy9zb21lL3BhdGg/Zm9vPWJhciZiYXo9eG94b1wiXG5cdCAgICogYGBgXG5cdCAgICpcblx0ICAgKiBAcmV0dXJuIHtzdHJpbmd9IGZ1bGwgdXJsXG5cdCAgICovXG5cdCAgYWJzVXJsOiBsb2NhdGlvbkdldHRlcignJCRhYnNVcmwnKSxcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRsb2NhdGlvbiN1cmxcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFRoaXMgbWV0aG9kIGlzIGdldHRlciAvIHNldHRlci5cblx0ICAgKlxuXHQgICAqIFJldHVybiB1cmwgKGUuZy4gYC9wYXRoP2E9YiNoYXNoYCkgd2hlbiBjYWxsZWQgd2l0aG91dCBhbnkgcGFyYW1ldGVyLlxuXHQgICAqXG5cdCAgICogQ2hhbmdlIHBhdGgsIHNlYXJjaCBhbmQgaGFzaCwgd2hlbiBjYWxsZWQgd2l0aCBwYXJhbWV0ZXIgYW5kIHJldHVybiBgJGxvY2F0aW9uYC5cblx0ICAgKlxuXHQgICAqXG5cdCAgICogYGBganNcblx0ICAgKiAvLyBnaXZlbiB1cmwgaHR0cDovL2V4YW1wbGUuY29tLyMvc29tZS9wYXRoP2Zvbz1iYXImYmF6PXhveG9cblx0ICAgKiB2YXIgdXJsID0gJGxvY2F0aW9uLnVybCgpO1xuXHQgICAqIC8vID0+IFwiL3NvbWUvcGF0aD9mb289YmFyJmJhej14b3hvXCJcblx0ICAgKiBgYGBcblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gdXJsIE5ldyB1cmwgd2l0aG91dCBiYXNlIHByZWZpeCAoZS5nLiBgL3BhdGg/YT1iI2hhc2hgKVxuXHQgICAqIEByZXR1cm4ge3N0cmluZ30gdXJsXG5cdCAgICovXG5cdCAgdXJsOiBmdW5jdGlvbih1cmwpIHtcblx0ICAgIGlmIChpc1VuZGVmaW5lZCh1cmwpKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLiQkdXJsO1xuXHQgICAgfVxuXHRcblx0ICAgIHZhciBtYXRjaCA9IFBBVEhfTUFUQ0guZXhlYyh1cmwpO1xuXHQgICAgaWYgKG1hdGNoWzFdIHx8IHVybCA9PT0gJycpIHRoaXMucGF0aChkZWNvZGVVUklDb21wb25lbnQobWF0Y2hbMV0pKTtcblx0ICAgIGlmIChtYXRjaFsyXSB8fCBtYXRjaFsxXSB8fCB1cmwgPT09ICcnKSB0aGlzLnNlYXJjaChtYXRjaFszXSB8fCAnJyk7XG5cdCAgICB0aGlzLmhhc2gobWF0Y2hbNV0gfHwgJycpO1xuXHRcblx0ICAgIHJldHVybiB0aGlzO1xuXHQgIH0sXG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkbG9jYXRpb24jcHJvdG9jb2xcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFRoaXMgbWV0aG9kIGlzIGdldHRlciBvbmx5LlxuXHQgICAqXG5cdCAgICogUmV0dXJuIHByb3RvY29sIG9mIGN1cnJlbnQgdXJsLlxuXHQgICAqXG5cdCAgICpcblx0ICAgKiBgYGBqc1xuXHQgICAqIC8vIGdpdmVuIHVybCBodHRwOi8vZXhhbXBsZS5jb20vIy9zb21lL3BhdGg/Zm9vPWJhciZiYXo9eG94b1xuXHQgICAqIHZhciBwcm90b2NvbCA9ICRsb2NhdGlvbi5wcm90b2NvbCgpO1xuXHQgICAqIC8vID0+IFwiaHR0cFwiXG5cdCAgICogYGBgXG5cdCAgICpcblx0ICAgKiBAcmV0dXJuIHtzdHJpbmd9IHByb3RvY29sIG9mIGN1cnJlbnQgdXJsXG5cdCAgICovXG5cdCAgcHJvdG9jb2w6IGxvY2F0aW9uR2V0dGVyKCckJHByb3RvY29sJyksXG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkbG9jYXRpb24jaG9zdFxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogVGhpcyBtZXRob2QgaXMgZ2V0dGVyIG9ubHkuXG5cdCAgICpcblx0ICAgKiBSZXR1cm4gaG9zdCBvZiBjdXJyZW50IHVybC5cblx0ICAgKlxuXHQgICAqIE5vdGU6IGNvbXBhcmVkIHRvIHRoZSBub24tYW5ndWxhciB2ZXJzaW9uIGBsb2NhdGlvbi5ob3N0YCB3aGljaCByZXR1cm5zIGBob3N0bmFtZTpwb3J0YCwgdGhpcyByZXR1cm5zIHRoZSBgaG9zdG5hbWVgIHBvcnRpb24gb25seS5cblx0ICAgKlxuXHQgICAqXG5cdCAgICogYGBganNcblx0ICAgKiAvLyBnaXZlbiB1cmwgaHR0cDovL2V4YW1wbGUuY29tLyMvc29tZS9wYXRoP2Zvbz1iYXImYmF6PXhveG9cblx0ICAgKiB2YXIgaG9zdCA9ICRsb2NhdGlvbi5ob3N0KCk7XG5cdCAgICogLy8gPT4gXCJleGFtcGxlLmNvbVwiXG5cdCAgICpcblx0ICAgKiAvLyBnaXZlbiB1cmwgaHR0cDovL3VzZXI6cGFzc3dvcmRAZXhhbXBsZS5jb206ODA4MC8jL3NvbWUvcGF0aD9mb289YmFyJmJhej14b3hvXG5cdCAgICogaG9zdCA9ICRsb2NhdGlvbi5ob3N0KCk7XG5cdCAgICogLy8gPT4gXCJleGFtcGxlLmNvbVwiXG5cdCAgICogaG9zdCA9IGxvY2F0aW9uLmhvc3Q7XG5cdCAgICogLy8gPT4gXCJleGFtcGxlLmNvbTo4MDgwXCJcblx0ICAgKiBgYGBcblx0ICAgKlxuXHQgICAqIEByZXR1cm4ge3N0cmluZ30gaG9zdCBvZiBjdXJyZW50IHVybC5cblx0ICAgKi9cblx0ICBob3N0OiBsb2NhdGlvbkdldHRlcignJCRob3N0JyksXG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkbG9jYXRpb24jcG9ydFxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogVGhpcyBtZXRob2QgaXMgZ2V0dGVyIG9ubHkuXG5cdCAgICpcblx0ICAgKiBSZXR1cm4gcG9ydCBvZiBjdXJyZW50IHVybC5cblx0ICAgKlxuXHQgICAqXG5cdCAgICogYGBganNcblx0ICAgKiAvLyBnaXZlbiB1cmwgaHR0cDovL2V4YW1wbGUuY29tLyMvc29tZS9wYXRoP2Zvbz1iYXImYmF6PXhveG9cblx0ICAgKiB2YXIgcG9ydCA9ICRsb2NhdGlvbi5wb3J0KCk7XG5cdCAgICogLy8gPT4gODBcblx0ICAgKiBgYGBcblx0ICAgKlxuXHQgICAqIEByZXR1cm4ge051bWJlcn0gcG9ydFxuXHQgICAqL1xuXHQgIHBvcnQ6IGxvY2F0aW9uR2V0dGVyKCckJHBvcnQnKSxcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRsb2NhdGlvbiNwYXRoXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBUaGlzIG1ldGhvZCBpcyBnZXR0ZXIgLyBzZXR0ZXIuXG5cdCAgICpcblx0ICAgKiBSZXR1cm4gcGF0aCBvZiBjdXJyZW50IHVybCB3aGVuIGNhbGxlZCB3aXRob3V0IGFueSBwYXJhbWV0ZXIuXG5cdCAgICpcblx0ICAgKiBDaGFuZ2UgcGF0aCB3aGVuIGNhbGxlZCB3aXRoIHBhcmFtZXRlciBhbmQgcmV0dXJuIGAkbG9jYXRpb25gLlxuXHQgICAqXG5cdCAgICogTm90ZTogUGF0aCBzaG91bGQgYWx3YXlzIGJlZ2luIHdpdGggZm9yd2FyZCBzbGFzaCAoLyksIHRoaXMgbWV0aG9kIHdpbGwgYWRkIHRoZSBmb3J3YXJkIHNsYXNoXG5cdCAgICogaWYgaXQgaXMgbWlzc2luZy5cblx0ICAgKlxuXHQgICAqXG5cdCAgICogYGBganNcblx0ICAgKiAvLyBnaXZlbiB1cmwgaHR0cDovL2V4YW1wbGUuY29tLyMvc29tZS9wYXRoP2Zvbz1iYXImYmF6PXhveG9cblx0ICAgKiB2YXIgcGF0aCA9ICRsb2NhdGlvbi5wYXRoKCk7XG5cdCAgICogLy8gPT4gXCIvc29tZS9wYXRoXCJcblx0ICAgKiBgYGBcblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7KHN0cmluZ3xudW1iZXIpPX0gcGF0aCBOZXcgcGF0aFxuXHQgICAqIEByZXR1cm4ge3N0cmluZ30gcGF0aFxuXHQgICAqL1xuXHQgIHBhdGg6IGxvY2F0aW9uR2V0dGVyU2V0dGVyKCckJHBhdGgnLCBmdW5jdGlvbihwYXRoKSB7XG5cdCAgICBwYXRoID0gcGF0aCAhPT0gbnVsbCA/IHBhdGgudG9TdHJpbmcoKSA6ICcnO1xuXHQgICAgcmV0dXJuIHBhdGguY2hhckF0KDApID09ICcvJyA/IHBhdGggOiAnLycgKyBwYXRoO1xuXHQgIH0pLFxuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgJGxvY2F0aW9uI3NlYXJjaFxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogVGhpcyBtZXRob2QgaXMgZ2V0dGVyIC8gc2V0dGVyLlxuXHQgICAqXG5cdCAgICogUmV0dXJuIHNlYXJjaCBwYXJ0IChhcyBvYmplY3QpIG9mIGN1cnJlbnQgdXJsIHdoZW4gY2FsbGVkIHdpdGhvdXQgYW55IHBhcmFtZXRlci5cblx0ICAgKlxuXHQgICAqIENoYW5nZSBzZWFyY2ggcGFydCB3aGVuIGNhbGxlZCB3aXRoIHBhcmFtZXRlciBhbmQgcmV0dXJuIGAkbG9jYXRpb25gLlxuXHQgICAqXG5cdCAgICpcblx0ICAgKiBgYGBqc1xuXHQgICAqIC8vIGdpdmVuIHVybCBodHRwOi8vZXhhbXBsZS5jb20vIy9zb21lL3BhdGg/Zm9vPWJhciZiYXo9eG94b1xuXHQgICAqIHZhciBzZWFyY2hPYmplY3QgPSAkbG9jYXRpb24uc2VhcmNoKCk7XG5cdCAgICogLy8gPT4ge2ZvbzogJ2JhcicsIGJhejogJ3hveG8nfVxuXHQgICAqXG5cdCAgICogLy8gc2V0IGZvbyB0byAneWlwZWUnXG5cdCAgICogJGxvY2F0aW9uLnNlYXJjaCgnZm9vJywgJ3lpcGVlJyk7XG5cdCAgICogLy8gJGxvY2F0aW9uLnNlYXJjaCgpID0+IHtmb286ICd5aXBlZScsIGJhejogJ3hveG8nfVxuXHQgICAqIGBgYFxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtzdHJpbmd8T2JqZWN0LjxzdHJpbmc+fE9iamVjdC48QXJyYXkuPHN0cmluZz4+fSBzZWFyY2ggTmV3IHNlYXJjaCBwYXJhbXMgLSBzdHJpbmcgb3Jcblx0ICAgKiBoYXNoIG9iamVjdC5cblx0ICAgKlxuXHQgICAqIFdoZW4gY2FsbGVkIHdpdGggYSBzaW5nbGUgYXJndW1lbnQgdGhlIG1ldGhvZCBhY3RzIGFzIGEgc2V0dGVyLCBzZXR0aW5nIHRoZSBgc2VhcmNoYCBjb21wb25lbnRcblx0ICAgKiBvZiBgJGxvY2F0aW9uYCB0byB0aGUgc3BlY2lmaWVkIHZhbHVlLlxuXHQgICAqXG5cdCAgICogSWYgdGhlIGFyZ3VtZW50IGlzIGEgaGFzaCBvYmplY3QgY29udGFpbmluZyBhbiBhcnJheSBvZiB2YWx1ZXMsIHRoZXNlIHZhbHVlcyB3aWxsIGJlIGVuY29kZWRcblx0ICAgKiBhcyBkdXBsaWNhdGUgc2VhcmNoIHBhcmFtZXRlcnMgaW4gdGhlIHVybC5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7KHN0cmluZ3xOdW1iZXJ8QXJyYXk8c3RyaW5nPnxib29sZWFuKT19IHBhcmFtVmFsdWUgSWYgYHNlYXJjaGAgaXMgYSBzdHJpbmcgb3IgbnVtYmVyLCB0aGVuIGBwYXJhbVZhbHVlYFxuXHQgICAqIHdpbGwgb3ZlcnJpZGUgb25seSBhIHNpbmdsZSBzZWFyY2ggcHJvcGVydHkuXG5cdCAgICpcblx0ICAgKiBJZiBgcGFyYW1WYWx1ZWAgaXMgYW4gYXJyYXksIGl0IHdpbGwgb3ZlcnJpZGUgdGhlIHByb3BlcnR5IG9mIHRoZSBgc2VhcmNoYCBjb21wb25lbnQgb2Zcblx0ICAgKiBgJGxvY2F0aW9uYCBzcGVjaWZpZWQgdmlhIHRoZSBmaXJzdCBhcmd1bWVudC5cblx0ICAgKlxuXHQgICAqIElmIGBwYXJhbVZhbHVlYCBpcyBgbnVsbGAsIHRoZSBwcm9wZXJ0eSBzcGVjaWZpZWQgdmlhIHRoZSBmaXJzdCBhcmd1bWVudCB3aWxsIGJlIGRlbGV0ZWQuXG5cdCAgICpcblx0ICAgKiBJZiBgcGFyYW1WYWx1ZWAgaXMgYHRydWVgLCB0aGUgcHJvcGVydHkgc3BlY2lmaWVkIHZpYSB0aGUgZmlyc3QgYXJndW1lbnQgd2lsbCBiZSBhZGRlZCB3aXRoIG5vXG5cdCAgICogdmFsdWUgbm9yIHRyYWlsaW5nIGVxdWFsIHNpZ24uXG5cdCAgICpcblx0ICAgKiBAcmV0dXJuIHtPYmplY3R9IElmIGNhbGxlZCB3aXRoIG5vIGFyZ3VtZW50cyByZXR1cm5zIHRoZSBwYXJzZWQgYHNlYXJjaGAgb2JqZWN0LiBJZiBjYWxsZWQgd2l0aFxuXHQgICAqIG9uZSBvciBtb3JlIGFyZ3VtZW50cyByZXR1cm5zIGAkbG9jYXRpb25gIG9iamVjdCBpdHNlbGYuXG5cdCAgICovXG5cdCAgc2VhcmNoOiBmdW5jdGlvbihzZWFyY2gsIHBhcmFtVmFsdWUpIHtcblx0ICAgIHN3aXRjaCAoYXJndW1lbnRzLmxlbmd0aCkge1xuXHQgICAgICBjYXNlIDA6XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuJCRzZWFyY2g7XG5cdCAgICAgIGNhc2UgMTpcblx0ICAgICAgICBpZiAoaXNTdHJpbmcoc2VhcmNoKSB8fCBpc051bWJlcihzZWFyY2gpKSB7XG5cdCAgICAgICAgICBzZWFyY2ggPSBzZWFyY2gudG9TdHJpbmcoKTtcblx0ICAgICAgICAgIHRoaXMuJCRzZWFyY2ggPSBwYXJzZUtleVZhbHVlKHNlYXJjaCk7XG5cdCAgICAgICAgfSBlbHNlIGlmIChpc09iamVjdChzZWFyY2gpKSB7XG5cdCAgICAgICAgICBzZWFyY2ggPSBjb3B5KHNlYXJjaCwge30pO1xuXHQgICAgICAgICAgLy8gcmVtb3ZlIG9iamVjdCB1bmRlZmluZWQgb3IgbnVsbCBwcm9wZXJ0aWVzXG5cdCAgICAgICAgICBmb3JFYWNoKHNlYXJjaCwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuXHQgICAgICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgZGVsZXRlIHNlYXJjaFtrZXldO1xuXHQgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgdGhpcy4kJHNlYXJjaCA9IHNlYXJjaDtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgdGhyb3cgJGxvY2F0aW9uTWluRXJyKCdpc3JjaGFyZycsXG5cdCAgICAgICAgICAgICAgJ1RoZSBmaXJzdCBhcmd1bWVudCBvZiB0aGUgYCRsb2NhdGlvbiNzZWFyY2goKWAgY2FsbCBtdXN0IGJlIGEgc3RyaW5nIG9yIGFuIG9iamVjdC4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgYnJlYWs7XG5cdCAgICAgIGRlZmF1bHQ6XG5cdCAgICAgICAgaWYgKGlzVW5kZWZpbmVkKHBhcmFtVmFsdWUpIHx8IHBhcmFtVmFsdWUgPT09IG51bGwpIHtcblx0ICAgICAgICAgIGRlbGV0ZSB0aGlzLiQkc2VhcmNoW3NlYXJjaF07XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHRoaXMuJCRzZWFyY2hbc2VhcmNoXSA9IHBhcmFtVmFsdWU7XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIHRoaXMuJCRjb21wb3NlKCk7XG5cdCAgICByZXR1cm4gdGhpcztcblx0ICB9LFxuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgJGxvY2F0aW9uI2hhc2hcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFRoaXMgbWV0aG9kIGlzIGdldHRlciAvIHNldHRlci5cblx0ICAgKlxuXHQgICAqIFJldHVybnMgdGhlIGhhc2ggZnJhZ21lbnQgd2hlbiBjYWxsZWQgd2l0aG91dCBhbnkgcGFyYW1ldGVycy5cblx0ICAgKlxuXHQgICAqIENoYW5nZXMgdGhlIGhhc2ggZnJhZ21lbnQgd2hlbiBjYWxsZWQgd2l0aCBhIHBhcmFtZXRlciBhbmQgcmV0dXJucyBgJGxvY2F0aW9uYC5cblx0ICAgKlxuXHQgICAqXG5cdCAgICogYGBganNcblx0ICAgKiAvLyBnaXZlbiB1cmwgaHR0cDovL2V4YW1wbGUuY29tLyMvc29tZS9wYXRoP2Zvbz1iYXImYmF6PXhveG8jaGFzaFZhbHVlXG5cdCAgICogdmFyIGhhc2ggPSAkbG9jYXRpb24uaGFzaCgpO1xuXHQgICAqIC8vID0+IFwiaGFzaFZhbHVlXCJcblx0ICAgKiBgYGBcblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7KHN0cmluZ3xudW1iZXIpPX0gaGFzaCBOZXcgaGFzaCBmcmFnbWVudFxuXHQgICAqIEByZXR1cm4ge3N0cmluZ30gaGFzaFxuXHQgICAqL1xuXHQgIGhhc2g6IGxvY2F0aW9uR2V0dGVyU2V0dGVyKCckJGhhc2gnLCBmdW5jdGlvbihoYXNoKSB7XG5cdCAgICByZXR1cm4gaGFzaCAhPT0gbnVsbCA/IGhhc2gudG9TdHJpbmcoKSA6ICcnO1xuXHQgIH0pLFxuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgJGxvY2F0aW9uI3JlcGxhY2Vcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIElmIGNhbGxlZCwgYWxsIGNoYW5nZXMgdG8gJGxvY2F0aW9uIGR1cmluZyB0aGUgY3VycmVudCBgJGRpZ2VzdGAgd2lsbCByZXBsYWNlIHRoZSBjdXJyZW50IGhpc3Rvcnlcblx0ICAgKiByZWNvcmQsIGluc3RlYWQgb2YgYWRkaW5nIGEgbmV3IG9uZS5cblx0ICAgKi9cblx0ICByZXBsYWNlOiBmdW5jdGlvbigpIHtcblx0ICAgIHRoaXMuJCRyZXBsYWNlID0gdHJ1ZTtcblx0ICAgIHJldHVybiB0aGlzO1xuXHQgIH1cblx0fTtcblx0XG5cdGZvckVhY2goW0xvY2F0aW9uSGFzaGJhbmdJbkh0bWw1VXJsLCBMb2NhdGlvbkhhc2hiYW5nVXJsLCBMb2NhdGlvbkh0bWw1VXJsXSwgZnVuY3Rpb24oTG9jYXRpb24pIHtcblx0ICBMb2NhdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKGxvY2F0aW9uUHJvdG90eXBlKTtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRsb2NhdGlvbiNzdGF0ZVxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogVGhpcyBtZXRob2QgaXMgZ2V0dGVyIC8gc2V0dGVyLlxuXHQgICAqXG5cdCAgICogUmV0dXJuIHRoZSBoaXN0b3J5IHN0YXRlIG9iamVjdCB3aGVuIGNhbGxlZCB3aXRob3V0IGFueSBwYXJhbWV0ZXIuXG5cdCAgICpcblx0ICAgKiBDaGFuZ2UgdGhlIGhpc3Rvcnkgc3RhdGUgb2JqZWN0IHdoZW4gY2FsbGVkIHdpdGggb25lIHBhcmFtZXRlciBhbmQgcmV0dXJuIGAkbG9jYXRpb25gLlxuXHQgICAqIFRoZSBzdGF0ZSBvYmplY3QgaXMgbGF0ZXIgcGFzc2VkIHRvIGBwdXNoU3RhdGVgIG9yIGByZXBsYWNlU3RhdGVgLlxuXHQgICAqXG5cdCAgICogTk9URTogVGhpcyBtZXRob2QgaXMgc3VwcG9ydGVkIG9ubHkgaW4gSFRNTDUgbW9kZSBhbmQgb25seSBpbiBicm93c2VycyBzdXBwb3J0aW5nXG5cdCAgICogdGhlIEhUTUw1IEhpc3RvcnkgQVBJIChpLmUuIG1ldGhvZHMgYHB1c2hTdGF0ZWAgYW5kIGByZXBsYWNlU3RhdGVgKS4gSWYgeW91IG5lZWQgdG8gc3VwcG9ydFxuXHQgICAqIG9sZGVyIGJyb3dzZXJzIChsaWtlIElFOSBvciBBbmRyb2lkIDwgNC4wKSwgZG9uJ3QgdXNlIHRoaXMgbWV0aG9kLlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtvYmplY3Q9fSBzdGF0ZSBTdGF0ZSBvYmplY3QgZm9yIHB1c2hTdGF0ZSBvciByZXBsYWNlU3RhdGVcblx0ICAgKiBAcmV0dXJuIHtvYmplY3R9IHN0YXRlXG5cdCAgICovXG5cdCAgTG9jYXRpb24ucHJvdG90eXBlLnN0YXRlID0gZnVuY3Rpb24oc3RhdGUpIHtcblx0ICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkge1xuXHQgICAgICByZXR1cm4gdGhpcy4kJHN0YXRlO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmIChMb2NhdGlvbiAhPT0gTG9jYXRpb25IdG1sNVVybCB8fCAhdGhpcy4kJGh0bWw1KSB7XG5cdCAgICAgIHRocm93ICRsb2NhdGlvbk1pbkVycignbm9zdGF0ZScsICdIaXN0b3J5IEFQSSBzdGF0ZSBzdXBwb3J0IGlzIGF2YWlsYWJsZSBvbmx5ICcgK1xuXHQgICAgICAgICdpbiBIVE1MNSBtb2RlIGFuZCBvbmx5IGluIGJyb3dzZXJzIHN1cHBvcnRpbmcgSFRNTDUgSGlzdG9yeSBBUEknKTtcblx0ICAgIH1cblx0ICAgIC8vIFRoZSB1c2VyIG1pZ2h0IG1vZGlmeSBgc3RhdGVPYmplY3RgIGFmdGVyIGludm9raW5nIGAkbG9jYXRpb24uc3RhdGUoc3RhdGVPYmplY3QpYFxuXHQgICAgLy8gYnV0IHdlJ3JlIGNoYW5naW5nIHRoZSAkJHN0YXRlIHJlZmVyZW5jZSB0byAkYnJvd3Nlci5zdGF0ZSgpIGR1cmluZyB0aGUgJGRpZ2VzdFxuXHQgICAgLy8gc28gdGhlIG1vZGlmaWNhdGlvbiB3aW5kb3cgaXMgbmFycm93LlxuXHQgICAgdGhpcy4kJHN0YXRlID0gaXNVbmRlZmluZWQoc3RhdGUpID8gbnVsbCA6IHN0YXRlO1xuXHRcblx0ICAgIHJldHVybiB0aGlzO1xuXHQgIH07XG5cdH0pO1xuXHRcblx0XG5cdGZ1bmN0aW9uIGxvY2F0aW9uR2V0dGVyKHByb3BlcnR5KSB7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgcmV0dXJuIHRoaXNbcHJvcGVydHldO1xuXHQgIH07XG5cdH1cblx0XG5cdFxuXHRmdW5jdGlvbiBsb2NhdGlvbkdldHRlclNldHRlcihwcm9wZXJ0eSwgcHJlcHJvY2Vzcykge1xuXHQgIHJldHVybiBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgaWYgKGlzVW5kZWZpbmVkKHZhbHVlKSkge1xuXHQgICAgICByZXR1cm4gdGhpc1twcm9wZXJ0eV07XG5cdCAgICB9XG5cdFxuXHQgICAgdGhpc1twcm9wZXJ0eV0gPSBwcmVwcm9jZXNzKHZhbHVlKTtcblx0ICAgIHRoaXMuJCRjb21wb3NlKCk7XG5cdFxuXHQgICAgcmV0dXJuIHRoaXM7XG5cdCAgfTtcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2Mgc2VydmljZVxuXHQgKiBAbmFtZSAkbG9jYXRpb25cblx0ICpcblx0ICogQHJlcXVpcmVzICRyb290RWxlbWVudFxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogVGhlICRsb2NhdGlvbiBzZXJ2aWNlIHBhcnNlcyB0aGUgVVJMIGluIHRoZSBicm93c2VyIGFkZHJlc3MgYmFyIChiYXNlZCBvbiB0aGVcblx0ICogW3dpbmRvdy5sb2NhdGlvbl0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vd2luZG93LmxvY2F0aW9uKSkgYW5kIG1ha2VzIHRoZSBVUkxcblx0ICogYXZhaWxhYmxlIHRvIHlvdXIgYXBwbGljYXRpb24uIENoYW5nZXMgdG8gdGhlIFVSTCBpbiB0aGUgYWRkcmVzcyBiYXIgYXJlIHJlZmxlY3RlZCBpbnRvXG5cdCAqICRsb2NhdGlvbiBzZXJ2aWNlIGFuZCBjaGFuZ2VzIHRvICRsb2NhdGlvbiBhcmUgcmVmbGVjdGVkIGludG8gdGhlIGJyb3dzZXIgYWRkcmVzcyBiYXIuXG5cdCAqXG5cdCAqICoqVGhlICRsb2NhdGlvbiBzZXJ2aWNlOioqXG5cdCAqXG5cdCAqIC0gRXhwb3NlcyB0aGUgY3VycmVudCBVUkwgaW4gdGhlIGJyb3dzZXIgYWRkcmVzcyBiYXIsIHNvIHlvdSBjYW5cblx0ICogICAtIFdhdGNoIGFuZCBvYnNlcnZlIHRoZSBVUkwuXG5cdCAqICAgLSBDaGFuZ2UgdGhlIFVSTC5cblx0ICogLSBTeW5jaHJvbml6ZXMgdGhlIFVSTCB3aXRoIHRoZSBicm93c2VyIHdoZW4gdGhlIHVzZXJcblx0ICogICAtIENoYW5nZXMgdGhlIGFkZHJlc3MgYmFyLlxuXHQgKiAgIC0gQ2xpY2tzIHRoZSBiYWNrIG9yIGZvcndhcmQgYnV0dG9uIChvciBjbGlja3MgYSBIaXN0b3J5IGxpbmspLlxuXHQgKiAgIC0gQ2xpY2tzIG9uIGEgbGluay5cblx0ICogLSBSZXByZXNlbnRzIHRoZSBVUkwgb2JqZWN0IGFzIGEgc2V0IG9mIG1ldGhvZHMgKHByb3RvY29sLCBob3N0LCBwb3J0LCBwYXRoLCBzZWFyY2gsIGhhc2gpLlxuXHQgKlxuXHQgKiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBzZWUge0BsaW5rIGd1aWRlLyRsb2NhdGlvbiBEZXZlbG9wZXIgR3VpZGU6IFVzaW5nICRsb2NhdGlvbn1cblx0ICovXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHByb3ZpZGVyXG5cdCAqIEBuYW1lICRsb2NhdGlvblByb3ZpZGVyXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBVc2UgdGhlIGAkbG9jYXRpb25Qcm92aWRlcmAgdG8gY29uZmlndXJlIGhvdyB0aGUgYXBwbGljYXRpb24gZGVlcCBsaW5raW5nIHBhdGhzIGFyZSBzdG9yZWQuXG5cdCAqL1xuXHRmdW5jdGlvbiAkTG9jYXRpb25Qcm92aWRlcigpIHtcblx0ICB2YXIgaGFzaFByZWZpeCA9ICcnLFxuXHQgICAgICBodG1sNU1vZGUgPSB7XG5cdCAgICAgICAgZW5hYmxlZDogZmFsc2UsXG5cdCAgICAgICAgcmVxdWlyZUJhc2U6IHRydWUsXG5cdCAgICAgICAgcmV3cml0ZUxpbmtzOiB0cnVlXG5cdCAgICAgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkbG9jYXRpb25Qcm92aWRlciNoYXNoUHJlZml4XG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBwcmVmaXggUHJlZml4IGZvciBoYXNoIHBhcnQgKGNvbnRhaW5pbmcgcGF0aCBhbmQgc2VhcmNoKVxuXHQgICAqIEByZXR1cm5zIHsqfSBjdXJyZW50IHZhbHVlIGlmIHVzZWQgYXMgZ2V0dGVyIG9yIGl0c2VsZiAoY2hhaW5pbmcpIGlmIHVzZWQgYXMgc2V0dGVyXG5cdCAgICovXG5cdCAgdGhpcy5oYXNoUHJlZml4ID0gZnVuY3Rpb24ocHJlZml4KSB7XG5cdCAgICBpZiAoaXNEZWZpbmVkKHByZWZpeCkpIHtcblx0ICAgICAgaGFzaFByZWZpeCA9IHByZWZpeDtcblx0ICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICByZXR1cm4gaGFzaFByZWZpeDtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgJGxvY2F0aW9uUHJvdmlkZXIjaHRtbDVNb2RlXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogQHBhcmFtIHsoYm9vbGVhbnxPYmplY3QpPX0gbW9kZSBJZiBib29sZWFuLCBzZXRzIGBodG1sNU1vZGUuZW5hYmxlZGAgdG8gdmFsdWUuXG5cdCAgICogICBJZiBvYmplY3QsIHNldHMgYGVuYWJsZWRgLCBgcmVxdWlyZUJhc2VgIGFuZCBgcmV3cml0ZUxpbmtzYCB0byByZXNwZWN0aXZlIHZhbHVlcy4gU3VwcG9ydGVkXG5cdCAgICogICBwcm9wZXJ0aWVzOlxuXHQgICAqICAgLSAqKmVuYWJsZWQqKiDigJMgYHtib29sZWFufWAg4oCTIChkZWZhdWx0OiBmYWxzZSkgSWYgdHJ1ZSwgd2lsbCByZWx5IG9uIGBoaXN0b3J5LnB1c2hTdGF0ZWAgdG9cblx0ICAgKiAgICAgY2hhbmdlIHVybHMgd2hlcmUgc3VwcG9ydGVkLiBXaWxsIGZhbGwgYmFjayB0byBoYXNoLXByZWZpeGVkIHBhdGhzIGluIGJyb3dzZXJzIHRoYXQgZG8gbm90XG5cdCAgICogICAgIHN1cHBvcnQgYHB1c2hTdGF0ZWAuXG5cdCAgICogICAtICoqcmVxdWlyZUJhc2UqKiAtIGB7Ym9vbGVhbn1gIC0gKGRlZmF1bHQ6IGB0cnVlYCkgV2hlbiBodG1sNU1vZGUgaXMgZW5hYmxlZCwgc3BlY2lmaWVzXG5cdCAgICogICAgIHdoZXRoZXIgb3Igbm90IGEgPGJhc2U+IHRhZyBpcyByZXF1aXJlZCB0byBiZSBwcmVzZW50LiBJZiBgZW5hYmxlZGAgYW5kIGByZXF1aXJlQmFzZWAgYXJlXG5cdCAgICogICAgIHRydWUsIGFuZCBhIGJhc2UgdGFnIGlzIG5vdCBwcmVzZW50LCBhbiBlcnJvciB3aWxsIGJlIHRocm93biB3aGVuIGAkbG9jYXRpb25gIGlzIGluamVjdGVkLlxuXHQgICAqICAgICBTZWUgdGhlIHtAbGluayBndWlkZS8kbG9jYXRpb24gJGxvY2F0aW9uIGd1aWRlIGZvciBtb3JlIGluZm9ybWF0aW9ufVxuXHQgICAqICAgLSAqKnJld3JpdGVMaW5rcyoqIC0gYHtib29sZWFufWAgLSAoZGVmYXVsdDogYHRydWVgKSBXaGVuIGh0bWw1TW9kZSBpcyBlbmFibGVkLFxuXHQgICAqICAgICBlbmFibGVzL2Rpc2FibGVzIHVybCByZXdyaXRpbmcgZm9yIHJlbGF0aXZlIGxpbmtzLlxuXHQgICAqXG5cdCAgICogQHJldHVybnMge09iamVjdH0gaHRtbDVNb2RlIG9iamVjdCBpZiB1c2VkIGFzIGdldHRlciBvciBpdHNlbGYgKGNoYWluaW5nKSBpZiB1c2VkIGFzIHNldHRlclxuXHQgICAqL1xuXHQgIHRoaXMuaHRtbDVNb2RlID0gZnVuY3Rpb24obW9kZSkge1xuXHQgICAgaWYgKGlzQm9vbGVhbihtb2RlKSkge1xuXHQgICAgICBodG1sNU1vZGUuZW5hYmxlZCA9IG1vZGU7XG5cdCAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfSBlbHNlIGlmIChpc09iamVjdChtb2RlKSkge1xuXHRcblx0ICAgICAgaWYgKGlzQm9vbGVhbihtb2RlLmVuYWJsZWQpKSB7XG5cdCAgICAgICAgaHRtbDVNb2RlLmVuYWJsZWQgPSBtb2RlLmVuYWJsZWQ7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGlmIChpc0Jvb2xlYW4obW9kZS5yZXF1aXJlQmFzZSkpIHtcblx0ICAgICAgICBodG1sNU1vZGUucmVxdWlyZUJhc2UgPSBtb2RlLnJlcXVpcmVCYXNlO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBpZiAoaXNCb29sZWFuKG1vZGUucmV3cml0ZUxpbmtzKSkge1xuXHQgICAgICAgIGh0bWw1TW9kZS5yZXdyaXRlTGlua3MgPSBtb2RlLnJld3JpdGVMaW5rcztcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICByZXR1cm4gaHRtbDVNb2RlO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBldmVudFxuXHQgICAqIEBuYW1lICRsb2NhdGlvbiMkbG9jYXRpb25DaGFuZ2VTdGFydFxuXHQgICAqIEBldmVudFR5cGUgYnJvYWRjYXN0IG9uIHJvb3Qgc2NvcGVcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBCcm9hZGNhc3RlZCBiZWZvcmUgYSBVUkwgd2lsbCBjaGFuZ2UuXG5cdCAgICpcblx0ICAgKiBUaGlzIGNoYW5nZSBjYW4gYmUgcHJldmVudGVkIGJ5IGNhbGxpbmdcblx0ICAgKiBgcHJldmVudERlZmF1bHRgIG1ldGhvZCBvZiB0aGUgZXZlbnQuIFNlZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkb259IGZvciBtb3JlXG5cdCAgICogZGV0YWlscyBhYm91dCBldmVudCBvYmplY3QuIFVwb24gc3VjY2Vzc2Z1bCBjaGFuZ2Vcblx0ICAgKiB7QGxpbmsgbmcuJGxvY2F0aW9uIyRsb2NhdGlvbkNoYW5nZVN1Y2Nlc3MgJGxvY2F0aW9uQ2hhbmdlU3VjY2Vzc30gaXMgZmlyZWQuXG5cdCAgICpcblx0ICAgKiBUaGUgYG5ld1N0YXRlYCBhbmQgYG9sZFN0YXRlYCBwYXJhbWV0ZXJzIG1heSBiZSBkZWZpbmVkIG9ubHkgaW4gSFRNTDUgbW9kZSBhbmQgd2hlblxuXHQgICAqIHRoZSBicm93c2VyIHN1cHBvcnRzIHRoZSBIVE1MNSBIaXN0b3J5IEFQSS5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7T2JqZWN0fSBhbmd1bGFyRXZlbnQgU3ludGhldGljIGV2ZW50IG9iamVjdC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gbmV3VXJsIE5ldyBVUkxcblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG9sZFVybCBVUkwgdGhhdCB3YXMgYmVmb3JlIGl0IHdhcyBjaGFuZ2VkLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmV3U3RhdGUgTmV3IGhpc3Rvcnkgc3RhdGUgb2JqZWN0XG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBvbGRTdGF0ZSBIaXN0b3J5IHN0YXRlIG9iamVjdCB0aGF0IHdhcyBiZWZvcmUgaXQgd2FzIGNoYW5nZWQuXG5cdCAgICovXG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBldmVudFxuXHQgICAqIEBuYW1lICRsb2NhdGlvbiMkbG9jYXRpb25DaGFuZ2VTdWNjZXNzXG5cdCAgICogQGV2ZW50VHlwZSBicm9hZGNhc3Qgb24gcm9vdCBzY29wZVxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIEJyb2FkY2FzdGVkIGFmdGVyIGEgVVJMIHdhcyBjaGFuZ2VkLlxuXHQgICAqXG5cdCAgICogVGhlIGBuZXdTdGF0ZWAgYW5kIGBvbGRTdGF0ZWAgcGFyYW1ldGVycyBtYXkgYmUgZGVmaW5lZCBvbmx5IGluIEhUTUw1IG1vZGUgYW5kIHdoZW5cblx0ICAgKiB0aGUgYnJvd3NlciBzdXBwb3J0cyB0aGUgSFRNTDUgSGlzdG9yeSBBUEkuXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge09iamVjdH0gYW5ndWxhckV2ZW50IFN5bnRoZXRpYyBldmVudCBvYmplY3QuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IG5ld1VybCBOZXcgVVJMXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBvbGRVcmwgVVJMIHRoYXQgd2FzIGJlZm9yZSBpdCB3YXMgY2hhbmdlZC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5ld1N0YXRlIE5ldyBoaXN0b3J5IHN0YXRlIG9iamVjdFxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gb2xkU3RhdGUgSGlzdG9yeSBzdGF0ZSBvYmplY3QgdGhhdCB3YXMgYmVmb3JlIGl0IHdhcyBjaGFuZ2VkLlxuXHQgICAqL1xuXHRcblx0ICB0aGlzLiRnZXQgPSBbJyRyb290U2NvcGUnLCAnJGJyb3dzZXInLCAnJHNuaWZmZXInLCAnJHJvb3RFbGVtZW50JywgJyR3aW5kb3cnLFxuXHQgICAgICBmdW5jdGlvbigkcm9vdFNjb3BlLCAkYnJvd3NlciwgJHNuaWZmZXIsICRyb290RWxlbWVudCwgJHdpbmRvdykge1xuXHQgICAgdmFyICRsb2NhdGlvbixcblx0ICAgICAgICBMb2NhdGlvbk1vZGUsXG5cdCAgICAgICAgYmFzZUhyZWYgPSAkYnJvd3Nlci5iYXNlSHJlZigpLCAvLyBpZiBiYXNlW2hyZWZdIGlzIHVuZGVmaW5lZCwgaXQgZGVmYXVsdHMgdG8gJydcblx0ICAgICAgICBpbml0aWFsVXJsID0gJGJyb3dzZXIudXJsKCksXG5cdCAgICAgICAgYXBwQmFzZTtcblx0XG5cdCAgICBpZiAoaHRtbDVNb2RlLmVuYWJsZWQpIHtcblx0ICAgICAgaWYgKCFiYXNlSHJlZiAmJiBodG1sNU1vZGUucmVxdWlyZUJhc2UpIHtcblx0ICAgICAgICB0aHJvdyAkbG9jYXRpb25NaW5FcnIoJ25vYmFzZScsXG5cdCAgICAgICAgICBcIiRsb2NhdGlvbiBpbiBIVE1MNSBtb2RlIHJlcXVpcmVzIGEgPGJhc2U+IHRhZyB0byBiZSBwcmVzZW50IVwiKTtcblx0ICAgICAgfVxuXHQgICAgICBhcHBCYXNlID0gc2VydmVyQmFzZShpbml0aWFsVXJsKSArIChiYXNlSHJlZiB8fCAnLycpO1xuXHQgICAgICBMb2NhdGlvbk1vZGUgPSAkc25pZmZlci5oaXN0b3J5ID8gTG9jYXRpb25IdG1sNVVybCA6IExvY2F0aW9uSGFzaGJhbmdJbkh0bWw1VXJsO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgYXBwQmFzZSA9IHN0cmlwSGFzaChpbml0aWFsVXJsKTtcblx0ICAgICAgTG9jYXRpb25Nb2RlID0gTG9jYXRpb25IYXNoYmFuZ1VybDtcblx0ICAgIH1cblx0ICAgIHZhciBhcHBCYXNlTm9GaWxlID0gc3RyaXBGaWxlKGFwcEJhc2UpO1xuXHRcblx0ICAgICRsb2NhdGlvbiA9IG5ldyBMb2NhdGlvbk1vZGUoYXBwQmFzZSwgYXBwQmFzZU5vRmlsZSwgJyMnICsgaGFzaFByZWZpeCk7XG5cdCAgICAkbG9jYXRpb24uJCRwYXJzZUxpbmtVcmwoaW5pdGlhbFVybCwgaW5pdGlhbFVybCk7XG5cdFxuXHQgICAgJGxvY2F0aW9uLiQkc3RhdGUgPSAkYnJvd3Nlci5zdGF0ZSgpO1xuXHRcblx0ICAgIHZhciBJR05PUkVfVVJJX1JFR0VYUCA9IC9eXFxzKihqYXZhc2NyaXB0fG1haWx0byk6L2k7XG5cdFxuXHQgICAgZnVuY3Rpb24gc2V0QnJvd3NlclVybFdpdGhGYWxsYmFjayh1cmwsIHJlcGxhY2UsIHN0YXRlKSB7XG5cdCAgICAgIHZhciBvbGRVcmwgPSAkbG9jYXRpb24udXJsKCk7XG5cdCAgICAgIHZhciBvbGRTdGF0ZSA9ICRsb2NhdGlvbi4kJHN0YXRlO1xuXHQgICAgICB0cnkge1xuXHQgICAgICAgICRicm93c2VyLnVybCh1cmwsIHJlcGxhY2UsIHN0YXRlKTtcblx0XG5cdCAgICAgICAgLy8gTWFrZSBzdXJlICRsb2NhdGlvbi5zdGF0ZSgpIHJldHVybnMgcmVmZXJlbnRpYWxseSBpZGVudGljYWwgKG5vdCBqdXN0IGRlZXBseSBlcXVhbClcblx0ICAgICAgICAvLyBzdGF0ZSBvYmplY3Q7IHRoaXMgbWFrZXMgcG9zc2libGUgcXVpY2sgY2hlY2tpbmcgaWYgdGhlIHN0YXRlIGNoYW5nZWQgaW4gdGhlIGRpZ2VzdFxuXHQgICAgICAgIC8vIGxvb3AuIENoZWNraW5nIGRlZXAgZXF1YWxpdHkgd291bGQgYmUgdG9vIGV4cGVuc2l2ZS5cblx0ICAgICAgICAkbG9jYXRpb24uJCRzdGF0ZSA9ICRicm93c2VyLnN0YXRlKCk7XG5cdCAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICAvLyBSZXN0b3JlIG9sZCB2YWx1ZXMgaWYgcHVzaFN0YXRlIGZhaWxzXG5cdCAgICAgICAgJGxvY2F0aW9uLnVybChvbGRVcmwpO1xuXHQgICAgICAgICRsb2NhdGlvbi4kJHN0YXRlID0gb2xkU3RhdGU7XG5cdFxuXHQgICAgICAgIHRocm93IGU7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICAkcm9vdEVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcblx0ICAgICAgLy8gVE9ETyh2b2p0YSk6IHJld3JpdGUgbGluayB3aGVuIG9wZW5pbmcgaW4gbmV3IHRhYi93aW5kb3cgKGluIGxlZ2FjeSBicm93c2VyKVxuXHQgICAgICAvLyBjdXJyZW50bHkgd2Ugb3BlbiBuaWNlIHVybCBsaW5rIGFuZCByZWRpcmVjdCB0aGVuXG5cdFxuXHQgICAgICBpZiAoIWh0bWw1TW9kZS5yZXdyaXRlTGlua3MgfHwgZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5IHx8IGV2ZW50LnNoaWZ0S2V5IHx8IGV2ZW50LndoaWNoID09IDIgfHwgZXZlbnQuYnV0dG9uID09IDIpIHJldHVybjtcblx0XG5cdCAgICAgIHZhciBlbG0gPSBqcUxpdGUoZXZlbnQudGFyZ2V0KTtcblx0XG5cdCAgICAgIC8vIHRyYXZlcnNlIHRoZSBET00gdXAgdG8gZmluZCBmaXJzdCBBIHRhZ1xuXHQgICAgICB3aGlsZSAobm9kZU5hbWVfKGVsbVswXSkgIT09ICdhJykge1xuXHQgICAgICAgIC8vIGlnbm9yZSByZXdyaXRpbmcgaWYgbm8gQSB0YWcgKHJlYWNoZWQgcm9vdCBlbGVtZW50LCBvciBubyBwYXJlbnQgLSByZW1vdmVkIGZyb20gZG9jdW1lbnQpXG5cdCAgICAgICAgaWYgKGVsbVswXSA9PT0gJHJvb3RFbGVtZW50WzBdIHx8ICEoZWxtID0gZWxtLnBhcmVudCgpKVswXSkgcmV0dXJuO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICB2YXIgYWJzSHJlZiA9IGVsbS5wcm9wKCdocmVmJyk7XG5cdCAgICAgIC8vIGdldCB0aGUgYWN0dWFsIGhyZWYgYXR0cmlidXRlIC0gc2VlXG5cdCAgICAgIC8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9pZS9kZDM0NzE0OCh2PXZzLjg1KS5hc3B4XG5cdCAgICAgIHZhciByZWxIcmVmID0gZWxtLmF0dHIoJ2hyZWYnKSB8fCBlbG0uYXR0cigneGxpbms6aHJlZicpO1xuXHRcblx0ICAgICAgaWYgKGlzT2JqZWN0KGFic0hyZWYpICYmIGFic0hyZWYudG9TdHJpbmcoKSA9PT0gJ1tvYmplY3QgU1ZHQW5pbWF0ZWRTdHJpbmddJykge1xuXHQgICAgICAgIC8vIFNWR0FuaW1hdGVkU3RyaW5nLmFuaW1WYWwgc2hvdWxkIGJlIGlkZW50aWNhbCB0byBTVkdBbmltYXRlZFN0cmluZy5iYXNlVmFsLCB1bmxlc3MgZHVyaW5nXG5cdCAgICAgICAgLy8gYW4gYW5pbWF0aW9uLlxuXHQgICAgICAgIGFic0hyZWYgPSB1cmxSZXNvbHZlKGFic0hyZWYuYW5pbVZhbCkuaHJlZjtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLy8gSWdub3JlIHdoZW4gdXJsIGlzIHN0YXJ0ZWQgd2l0aCBqYXZhc2NyaXB0OiBvciBtYWlsdG86XG5cdCAgICAgIGlmIChJR05PUkVfVVJJX1JFR0VYUC50ZXN0KGFic0hyZWYpKSByZXR1cm47XG5cdFxuXHQgICAgICBpZiAoYWJzSHJlZiAmJiAhZWxtLmF0dHIoJ3RhcmdldCcpICYmICFldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkge1xuXHQgICAgICAgIGlmICgkbG9jYXRpb24uJCRwYXJzZUxpbmtVcmwoYWJzSHJlZiwgcmVsSHJlZikpIHtcblx0ICAgICAgICAgIC8vIFdlIGRvIGEgcHJldmVudERlZmF1bHQgZm9yIGFsbCB1cmxzIHRoYXQgYXJlIHBhcnQgb2YgdGhlIGFuZ3VsYXIgYXBwbGljYXRpb24sXG5cdCAgICAgICAgICAvLyBpbiBodG1sNW1vZGUgYW5kIGFsc28gd2l0aG91dCwgc28gdGhhdCB3ZSBhcmUgYWJsZSB0byBhYm9ydCBuYXZpZ2F0aW9uIHdpdGhvdXRcblx0ICAgICAgICAgIC8vIGdldHRpbmcgZG91YmxlIGVudHJpZXMgaW4gdGhlIGxvY2F0aW9uIGhpc3RvcnkuXG5cdCAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgICAgICAgICAgLy8gdXBkYXRlIGxvY2F0aW9uIG1hbnVhbGx5XG5cdCAgICAgICAgICBpZiAoJGxvY2F0aW9uLmFic1VybCgpICE9ICRicm93c2VyLnVybCgpKSB7XG5cdCAgICAgICAgICAgICRyb290U2NvcGUuJGFwcGx5KCk7XG5cdCAgICAgICAgICAgIC8vIGhhY2sgdG8gd29yayBhcm91bmQgRkY2IGJ1ZyA2ODQyMDggd2hlbiBzY2VuYXJpbyBydW5uZXIgY2xpY2tzIG9uIGxpbmtzXG5cdCAgICAgICAgICAgICR3aW5kb3cuYW5ndWxhclsnZmYtNjg0MjA4LXByZXZlbnREZWZhdWx0J10gPSB0cnVlO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfSk7XG5cdFxuXHRcblx0ICAgIC8vIHJld3JpdGUgaGFzaGJhbmcgdXJsIDw+IGh0bWw1IHVybFxuXHQgICAgaWYgKHRyaW1FbXB0eUhhc2goJGxvY2F0aW9uLmFic1VybCgpKSAhPSB0cmltRW1wdHlIYXNoKGluaXRpYWxVcmwpKSB7XG5cdCAgICAgICRicm93c2VyLnVybCgkbG9jYXRpb24uYWJzVXJsKCksIHRydWUpO1xuXHQgICAgfVxuXHRcblx0ICAgIHZhciBpbml0aWFsaXppbmcgPSB0cnVlO1xuXHRcblx0ICAgIC8vIHVwZGF0ZSAkbG9jYXRpb24gd2hlbiAkYnJvd3NlciB1cmwgY2hhbmdlc1xuXHQgICAgJGJyb3dzZXIub25VcmxDaGFuZ2UoZnVuY3Rpb24obmV3VXJsLCBuZXdTdGF0ZSkge1xuXHRcblx0ICAgICAgaWYgKGlzVW5kZWZpbmVkKGJlZ2luc1dpdGgoYXBwQmFzZU5vRmlsZSwgbmV3VXJsKSkpIHtcblx0ICAgICAgICAvLyBJZiB3ZSBhcmUgbmF2aWdhdGluZyBvdXRzaWRlIG9mIHRoZSBhcHAgdGhlbiBmb3JjZSBhIHJlbG9hZFxuXHQgICAgICAgICR3aW5kb3cubG9jYXRpb24uaHJlZiA9IG5ld1VybDtcblx0ICAgICAgICByZXR1cm47XG5cdCAgICAgIH1cblx0XG5cdCAgICAgICRyb290U2NvcGUuJGV2YWxBc3luYyhmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgb2xkVXJsID0gJGxvY2F0aW9uLmFic1VybCgpO1xuXHQgICAgICAgIHZhciBvbGRTdGF0ZSA9ICRsb2NhdGlvbi4kJHN0YXRlO1xuXHQgICAgICAgIHZhciBkZWZhdWx0UHJldmVudGVkO1xuXHQgICAgICAgIG5ld1VybCA9IHRyaW1FbXB0eUhhc2gobmV3VXJsKTtcblx0ICAgICAgICAkbG9jYXRpb24uJCRwYXJzZShuZXdVcmwpO1xuXHQgICAgICAgICRsb2NhdGlvbi4kJHN0YXRlID0gbmV3U3RhdGU7XG5cdFxuXHQgICAgICAgIGRlZmF1bHRQcmV2ZW50ZWQgPSAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJyRsb2NhdGlvbkNoYW5nZVN0YXJ0JywgbmV3VXJsLCBvbGRVcmwsXG5cdCAgICAgICAgICAgIG5ld1N0YXRlLCBvbGRTdGF0ZSkuZGVmYXVsdFByZXZlbnRlZDtcblx0XG5cdCAgICAgICAgLy8gaWYgdGhlIGxvY2F0aW9uIHdhcyBjaGFuZ2VkIGJ5IGEgYCRsb2NhdGlvbkNoYW5nZVN0YXJ0YCBoYW5kbGVyIHRoZW4gc3RvcFxuXHQgICAgICAgIC8vIHByb2Nlc3NpbmcgdGhpcyBsb2NhdGlvbiBjaGFuZ2Vcblx0ICAgICAgICBpZiAoJGxvY2F0aW9uLmFic1VybCgpICE9PSBuZXdVcmwpIHJldHVybjtcblx0XG5cdCAgICAgICAgaWYgKGRlZmF1bHRQcmV2ZW50ZWQpIHtcblx0ICAgICAgICAgICRsb2NhdGlvbi4kJHBhcnNlKG9sZFVybCk7XG5cdCAgICAgICAgICAkbG9jYXRpb24uJCRzdGF0ZSA9IG9sZFN0YXRlO1xuXHQgICAgICAgICAgc2V0QnJvd3NlclVybFdpdGhGYWxsYmFjayhvbGRVcmwsIGZhbHNlLCBvbGRTdGF0ZSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGluaXRpYWxpemluZyA9IGZhbHNlO1xuXHQgICAgICAgICAgYWZ0ZXJMb2NhdGlvbkNoYW5nZShvbGRVcmwsIG9sZFN0YXRlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHQgICAgICBpZiAoISRyb290U2NvcGUuJCRwaGFzZSkgJHJvb3RTY29wZS4kZGlnZXN0KCk7XG5cdCAgICB9KTtcblx0XG5cdCAgICAvLyB1cGRhdGUgYnJvd3NlclxuXHQgICAgJHJvb3RTY29wZS4kd2F0Y2goZnVuY3Rpb24gJGxvY2F0aW9uV2F0Y2goKSB7XG5cdCAgICAgIHZhciBvbGRVcmwgPSB0cmltRW1wdHlIYXNoKCRicm93c2VyLnVybCgpKTtcblx0ICAgICAgdmFyIG5ld1VybCA9IHRyaW1FbXB0eUhhc2goJGxvY2F0aW9uLmFic1VybCgpKTtcblx0ICAgICAgdmFyIG9sZFN0YXRlID0gJGJyb3dzZXIuc3RhdGUoKTtcblx0ICAgICAgdmFyIGN1cnJlbnRSZXBsYWNlID0gJGxvY2F0aW9uLiQkcmVwbGFjZTtcblx0ICAgICAgdmFyIHVybE9yU3RhdGVDaGFuZ2VkID0gb2xkVXJsICE9PSBuZXdVcmwgfHxcblx0ICAgICAgICAoJGxvY2F0aW9uLiQkaHRtbDUgJiYgJHNuaWZmZXIuaGlzdG9yeSAmJiBvbGRTdGF0ZSAhPT0gJGxvY2F0aW9uLiQkc3RhdGUpO1xuXHRcblx0ICAgICAgaWYgKGluaXRpYWxpemluZyB8fCB1cmxPclN0YXRlQ2hhbmdlZCkge1xuXHQgICAgICAgIGluaXRpYWxpemluZyA9IGZhbHNlO1xuXHRcblx0ICAgICAgICAkcm9vdFNjb3BlLiRldmFsQXN5bmMoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICB2YXIgbmV3VXJsID0gJGxvY2F0aW9uLmFic1VybCgpO1xuXHQgICAgICAgICAgdmFyIGRlZmF1bHRQcmV2ZW50ZWQgPSAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJyRsb2NhdGlvbkNoYW5nZVN0YXJ0JywgbmV3VXJsLCBvbGRVcmwsXG5cdCAgICAgICAgICAgICAgJGxvY2F0aW9uLiQkc3RhdGUsIG9sZFN0YXRlKS5kZWZhdWx0UHJldmVudGVkO1xuXHRcblx0ICAgICAgICAgIC8vIGlmIHRoZSBsb2NhdGlvbiB3YXMgY2hhbmdlZCBieSBhIGAkbG9jYXRpb25DaGFuZ2VTdGFydGAgaGFuZGxlciB0aGVuIHN0b3Bcblx0ICAgICAgICAgIC8vIHByb2Nlc3NpbmcgdGhpcyBsb2NhdGlvbiBjaGFuZ2Vcblx0ICAgICAgICAgIGlmICgkbG9jYXRpb24uYWJzVXJsKCkgIT09IG5ld1VybCkgcmV0dXJuO1xuXHRcblx0ICAgICAgICAgIGlmIChkZWZhdWx0UHJldmVudGVkKSB7XG5cdCAgICAgICAgICAgICRsb2NhdGlvbi4kJHBhcnNlKG9sZFVybCk7XG5cdCAgICAgICAgICAgICRsb2NhdGlvbi4kJHN0YXRlID0gb2xkU3RhdGU7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBpZiAodXJsT3JTdGF0ZUNoYW5nZWQpIHtcblx0ICAgICAgICAgICAgICBzZXRCcm93c2VyVXJsV2l0aEZhbGxiYWNrKG5ld1VybCwgY3VycmVudFJlcGxhY2UsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRTdGF0ZSA9PT0gJGxvY2F0aW9uLiQkc3RhdGUgPyBudWxsIDogJGxvY2F0aW9uLiQkc3RhdGUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGFmdGVyTG9jYXRpb25DaGFuZ2Uob2xkVXJsLCBvbGRTdGF0ZSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgICRsb2NhdGlvbi4kJHJlcGxhY2UgPSBmYWxzZTtcblx0XG5cdCAgICAgIC8vIHdlIGRvbid0IG5lZWQgdG8gcmV0dXJuIGFueXRoaW5nIGJlY2F1c2UgJGV2YWxBc3luYyB3aWxsIG1ha2UgdGhlIGRpZ2VzdCBsb29wIGRpcnR5IHdoZW5cblx0ICAgICAgLy8gdGhlcmUgaXMgYSBjaGFuZ2Vcblx0ICAgIH0pO1xuXHRcblx0ICAgIHJldHVybiAkbG9jYXRpb247XG5cdFxuXHQgICAgZnVuY3Rpb24gYWZ0ZXJMb2NhdGlvbkNoYW5nZShvbGRVcmwsIG9sZFN0YXRlKSB7XG5cdCAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnJGxvY2F0aW9uQ2hhbmdlU3VjY2VzcycsICRsb2NhdGlvbi5hYnNVcmwoKSwgb2xkVXJsLFxuXHQgICAgICAgICRsb2NhdGlvbi4kJHN0YXRlLCBvbGRTdGF0ZSk7XG5cdCAgICB9XG5cdH1dO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHNlcnZpY2Vcblx0ICogQG5hbWUgJGxvZ1xuXHQgKiBAcmVxdWlyZXMgJHdpbmRvd1xuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogU2ltcGxlIHNlcnZpY2UgZm9yIGxvZ2dpbmcuIERlZmF1bHQgaW1wbGVtZW50YXRpb24gc2FmZWx5IHdyaXRlcyB0aGUgbWVzc2FnZVxuXHQgKiBpbnRvIHRoZSBicm93c2VyJ3MgY29uc29sZSAoaWYgcHJlc2VudCkuXG5cdCAqXG5cdCAqIFRoZSBtYWluIHB1cnBvc2Ugb2YgdGhpcyBzZXJ2aWNlIGlzIHRvIHNpbXBsaWZ5IGRlYnVnZ2luZyBhbmQgdHJvdWJsZXNob290aW5nLlxuXHQgKlxuXHQgKiBUaGUgZGVmYXVsdCBpcyB0byBsb2cgYGRlYnVnYCBtZXNzYWdlcy4gWW91IGNhbiB1c2Vcblx0ICoge0BsaW5rIG5nLiRsb2dQcm92aWRlciBuZy4kbG9nUHJvdmlkZXIjZGVidWdFbmFibGVkfSB0byBjaGFuZ2UgdGhpcy5cblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICAgPGV4YW1wbGUgbW9kdWxlPVwibG9nRXhhbXBsZVwiPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cblx0ICAgICAgIGFuZ3VsYXIubW9kdWxlKCdsb2dFeGFtcGxlJywgW10pXG5cdCAgICAgICAgIC5jb250cm9sbGVyKCdMb2dDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGxvZycsIGZ1bmN0aW9uKCRzY29wZSwgJGxvZykge1xuXHQgICAgICAgICAgICRzY29wZS4kbG9nID0gJGxvZztcblx0ICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9ICdIZWxsbyBXb3JsZCEnO1xuXHQgICAgICAgICB9XSk7XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJMb2dDb250cm9sbGVyXCI+XG5cdCAgICAgICAgIDxwPlJlbG9hZCB0aGlzIHBhZ2Ugd2l0aCBvcGVuIGNvbnNvbGUsIGVudGVyIHRleHQgYW5kIGhpdCB0aGUgbG9nIGJ1dHRvbi4uLjwvcD5cblx0ICAgICAgICAgPGxhYmVsPk1lc3NhZ2U6XG5cdCAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwibWVzc2FnZVwiIC8+PC9sYWJlbD5cblx0ICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cIiRsb2cubG9nKG1lc3NhZ2UpXCI+bG9nPC9idXR0b24+XG5cdCAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCIkbG9nLndhcm4obWVzc2FnZSlcIj53YXJuPC9idXR0b24+XG5cdCAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCIkbG9nLmluZm8obWVzc2FnZSlcIj5pbmZvPC9idXR0b24+XG5cdCAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCIkbG9nLmVycm9yKG1lc3NhZ2UpXCI+ZXJyb3I8L2J1dHRvbj5cblx0ICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cIiRsb2cuZGVidWcobWVzc2FnZSlcIj5kZWJ1ZzwvYnV0dG9uPlxuXHQgICAgICAgPC9kaXY+XG5cdCAgICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCAqL1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBwcm92aWRlclxuXHQgKiBAbmFtZSAkbG9nUHJvdmlkZXJcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFVzZSB0aGUgYCRsb2dQcm92aWRlcmAgdG8gY29uZmlndXJlIGhvdyB0aGUgYXBwbGljYXRpb24gbG9ncyBtZXNzYWdlc1xuXHQgKi9cblx0ZnVuY3Rpb24gJExvZ1Byb3ZpZGVyKCkge1xuXHQgIHZhciBkZWJ1ZyA9IHRydWUsXG5cdCAgICAgIHNlbGYgPSB0aGlzO1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgJGxvZ1Byb3ZpZGVyI2RlYnVnRW5hYmxlZFxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIEBwYXJhbSB7Ym9vbGVhbj19IGZsYWcgZW5hYmxlIG9yIGRpc2FibGUgZGVidWcgbGV2ZWwgbWVzc2FnZXNcblx0ICAgKiBAcmV0dXJucyB7Kn0gY3VycmVudCB2YWx1ZSBpZiB1c2VkIGFzIGdldHRlciBvciBpdHNlbGYgKGNoYWluaW5nKSBpZiB1c2VkIGFzIHNldHRlclxuXHQgICAqL1xuXHQgIHRoaXMuZGVidWdFbmFibGVkID0gZnVuY3Rpb24oZmxhZykge1xuXHQgICAgaWYgKGlzRGVmaW5lZChmbGFnKSkge1xuXHQgICAgICBkZWJ1ZyA9IGZsYWc7XG5cdCAgICByZXR1cm4gdGhpcztcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHJldHVybiBkZWJ1Zztcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICB0aGlzLiRnZXQgPSBbJyR3aW5kb3cnLCBmdW5jdGlvbigkd2luZG93KSB7XG5cdCAgICByZXR1cm4ge1xuXHQgICAgICAvKipcblx0ICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgKiBAbmFtZSAkbG9nI2xvZ1xuXHQgICAgICAgKlxuXHQgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICogV3JpdGUgYSBsb2cgbWVzc2FnZVxuXHQgICAgICAgKi9cblx0ICAgICAgbG9nOiBjb25zb2xlTG9nKCdsb2cnKSxcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAqIEBuYW1lICRsb2cjaW5mb1xuXHQgICAgICAgKlxuXHQgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICogV3JpdGUgYW4gaW5mb3JtYXRpb24gbWVzc2FnZVxuXHQgICAgICAgKi9cblx0ICAgICAgaW5mbzogY29uc29sZUxvZygnaW5mbycpLFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJGxvZyN3YXJuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBXcml0ZSBhIHdhcm5pbmcgbWVzc2FnZVxuXHQgICAgICAgKi9cblx0ICAgICAgd2FybjogY29uc29sZUxvZygnd2FybicpLFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJGxvZyNlcnJvclxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICogV3JpdGUgYW4gZXJyb3IgbWVzc2FnZVxuXHQgICAgICAgKi9cblx0ICAgICAgZXJyb3I6IGNvbnNvbGVMb2coJ2Vycm9yJyksXG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgKiBAbmFtZSAkbG9nI2RlYnVnXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBXcml0ZSBhIGRlYnVnIG1lc3NhZ2Vcblx0ICAgICAgICovXG5cdCAgICAgIGRlYnVnOiAoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIGZuID0gY29uc29sZUxvZygnZGVidWcnKTtcblx0XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgaWYgKGRlYnVnKSB7XG5cdCAgICAgICAgICAgIGZuLmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfTtcblx0ICAgICAgfSgpKVxuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBmb3JtYXRFcnJvcihhcmcpIHtcblx0ICAgICAgaWYgKGFyZyBpbnN0YW5jZW9mIEVycm9yKSB7XG5cdCAgICAgICAgaWYgKGFyZy5zdGFjaykge1xuXHQgICAgICAgICAgYXJnID0gKGFyZy5tZXNzYWdlICYmIGFyZy5zdGFjay5pbmRleE9mKGFyZy5tZXNzYWdlKSA9PT0gLTEpXG5cdCAgICAgICAgICAgICAgPyAnRXJyb3I6ICcgKyBhcmcubWVzc2FnZSArICdcXG4nICsgYXJnLnN0YWNrXG5cdCAgICAgICAgICAgICAgOiBhcmcuc3RhY2s7XG5cdCAgICAgICAgfSBlbHNlIGlmIChhcmcuc291cmNlVVJMKSB7XG5cdCAgICAgICAgICBhcmcgPSBhcmcubWVzc2FnZSArICdcXG4nICsgYXJnLnNvdXJjZVVSTCArICc6JyArIGFyZy5saW5lO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gYXJnO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGNvbnNvbGVMb2codHlwZSkge1xuXHQgICAgICB2YXIgY29uc29sZSA9ICR3aW5kb3cuY29uc29sZSB8fCB7fSxcblx0ICAgICAgICAgIGxvZ0ZuID0gY29uc29sZVt0eXBlXSB8fCBjb25zb2xlLmxvZyB8fCBub29wLFxuXHQgICAgICAgICAgaGFzQXBwbHkgPSBmYWxzZTtcblx0XG5cdCAgICAgIC8vIE5vdGU6IHJlYWRpbmcgbG9nRm4uYXBwbHkgdGhyb3dzIGFuIGVycm9yIGluIElFMTEgaW4gSUU4IGRvY3VtZW50IG1vZGUuXG5cdCAgICAgIC8vIFRoZSByZWFzb24gYmVoaW5kIHRoaXMgaXMgdGhhdCBjb25zb2xlLmxvZyBoYXMgdHlwZSBcIm9iamVjdFwiIGluIElFOC4uLlxuXHQgICAgICB0cnkge1xuXHQgICAgICAgIGhhc0FwcGx5ID0gISFsb2dGbi5hcHBseTtcblx0ICAgICAgfSBjYXRjaCAoZSkge31cblx0XG5cdCAgICAgIGlmIChoYXNBcHBseSkge1xuXHQgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHZhciBhcmdzID0gW107XG5cdCAgICAgICAgICBmb3JFYWNoKGFyZ3VtZW50cywgZnVuY3Rpb24oYXJnKSB7XG5cdCAgICAgICAgICAgIGFyZ3MucHVzaChmb3JtYXRFcnJvcihhcmcpKTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgcmV0dXJuIGxvZ0ZuLmFwcGx5KGNvbnNvbGUsIGFyZ3MpO1xuXHQgICAgICAgIH07XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vIHdlIGFyZSBJRSB3aGljaCBlaXRoZXIgZG9lc24ndCBoYXZlIHdpbmRvdy5jb25zb2xlID0+IHRoaXMgaXMgbm9vcCBhbmQgd2UgZG8gbm90aGluZyxcblx0ICAgICAgLy8gb3Igd2UgYXJlIElFIHdoZXJlIGNvbnNvbGUubG9nIGRvZXNuJ3QgaGF2ZSBhcHBseSBzbyB3ZSBsb2cgYXQgbGVhc3QgZmlyc3QgMiBhcmdzXG5cdCAgICAgIHJldHVybiBmdW5jdGlvbihhcmcxLCBhcmcyKSB7XG5cdCAgICAgICAgbG9nRm4oYXJnMSwgYXJnMiA9PSBudWxsID8gJycgOiBhcmcyKTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0ICB9XTtcblx0fVxuXHRcblx0LyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKlxuXHQgKiAgICAgQW55IGNvbW1pdHMgdG8gdGhpcyBmaWxlIHNob3VsZCBiZSByZXZpZXdlZCB3aXRoIHNlY3VyaXR5IGluIG1pbmQuICAqXG5cdCAqICAgQ2hhbmdlcyB0byB0aGlzIGZpbGUgY2FuIHBvdGVudGlhbGx5IGNyZWF0ZSBzZWN1cml0eSB2dWxuZXJhYmlsaXRpZXMuICpcblx0ICogICAgICAgICAgQW4gYXBwcm92YWwgZnJvbSAyIENvcmUgbWVtYmVycyB3aXRoIGhpc3Rvcnkgb2YgbW9kaWZ5aW5nICAgICAgKlxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzIGZpbGUgaXMgcmVxdWlyZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAqXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcblx0ICogIERvZXMgdGhlIGNoYW5nZSBzb21laG93IGFsbG93IGZvciBhcmJpdHJhcnkgamF2YXNjcmlwdCB0byBiZSBleGVjdXRlZD8gKlxuXHQgKiAgICBPciBhbGxvd3MgZm9yIHNvbWVvbmUgdG8gY2hhbmdlIHRoZSBwcm90b3R5cGUgb2YgYnVpbHQtaW4gb2JqZWN0cz8gICAqXG5cdCAqICAgICBPciBnaXZlcyB1bmRlc2lyZWQgYWNjZXNzIHRvIHZhcmlhYmxlcyBsaWtlcyBkb2N1bWVudCBvciB3aW5kb3c/ICAgICpcblx0ICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi9cblx0XG5cdHZhciAkcGFyc2VNaW5FcnIgPSBtaW5FcnIoJyRwYXJzZScpO1xuXHRcblx0Ly8gU2FuZGJveGluZyBBbmd1bGFyIEV4cHJlc3Npb25zXG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvLyBBbmd1bGFyIGV4cHJlc3Npb25zIGFyZSBnZW5lcmFsbHkgY29uc2lkZXJlZCBzYWZlIGJlY2F1c2UgdGhlc2UgZXhwcmVzc2lvbnMgb25seSBoYXZlIGRpcmVjdFxuXHQvLyBhY2Nlc3MgdG8gYCRzY29wZWAgYW5kIGxvY2Fscy4gSG93ZXZlciwgb25lIGNhbiBvYnRhaW4gdGhlIGFiaWxpdHkgdG8gZXhlY3V0ZSBhcmJpdHJhcnkgSlMgY29kZSBieVxuXHQvLyBvYnRhaW5pbmcgYSByZWZlcmVuY2UgdG8gbmF0aXZlIEpTIGZ1bmN0aW9ucyBzdWNoIGFzIHRoZSBGdW5jdGlvbiBjb25zdHJ1Y3Rvci5cblx0Ly9cblx0Ly8gQXMgYW4gZXhhbXBsZSwgY29uc2lkZXIgdGhlIGZvbGxvd2luZyBBbmd1bGFyIGV4cHJlc3Npb246XG5cdC8vXG5cdC8vICAge30udG9TdHJpbmcuY29uc3RydWN0b3IoJ2FsZXJ0KFwiZXZpbCBKUyBjb2RlXCIpJylcblx0Ly9cblx0Ly8gVGhpcyBzYW5kYm94aW5nIHRlY2huaXF1ZSBpcyBub3QgcGVyZmVjdCBhbmQgZG9lc24ndCBhaW0gdG8gYmUuIFRoZSBnb2FsIGlzIHRvIHByZXZlbnQgZXhwbG9pdHNcblx0Ly8gYWdhaW5zdCB0aGUgZXhwcmVzc2lvbiBsYW5ndWFnZSwgYnV0IG5vdCB0byBwcmV2ZW50IGV4cGxvaXRzIHRoYXQgd2VyZSBlbmFibGVkIGJ5IGV4cG9zaW5nXG5cdC8vIHNlbnNpdGl2ZSBKYXZhU2NyaXB0IG9yIGJyb3dzZXIgQVBJcyBvbiBTY29wZS4gRXhwb3Npbmcgc3VjaCBvYmplY3RzIG9uIGEgU2NvcGUgaXMgbmV2ZXIgYSBnb29kXG5cdC8vIHByYWN0aWNlIGFuZCB0aGVyZWZvcmUgd2UgYXJlIG5vdCBldmVuIHRyeWluZyB0byBwcm90ZWN0IGFnYWluc3QgaW50ZXJhY3Rpb24gd2l0aCBhbiBvYmplY3Rcblx0Ly8gZXhwbGljaXRseSBleHBvc2VkIGluIHRoaXMgd2F5LlxuXHQvL1xuXHQvLyBJbiBnZW5lcmFsLCBpdCBpcyBub3QgcG9zc2libGUgdG8gYWNjZXNzIGEgV2luZG93IG9iamVjdCBmcm9tIGFuIGFuZ3VsYXIgZXhwcmVzc2lvbiB1bmxlc3MgYVxuXHQvLyB3aW5kb3cgb3Igc29tZSBET00gb2JqZWN0IHRoYXQgaGFzIGEgcmVmZXJlbmNlIHRvIHdpbmRvdyBpcyBwdWJsaXNoZWQgb250byBhIFNjb3BlLlxuXHQvLyBTaW1pbGFybHkgd2UgcHJldmVudCBpbnZvY2F0aW9ucyBvZiBmdW5jdGlvbiBrbm93biB0byBiZSBkYW5nZXJvdXMsIGFzIHdlbGwgYXMgYXNzaWdubWVudHMgdG9cblx0Ly8gbmF0aXZlIG9iamVjdHMuXG5cdC8vXG5cdC8vIFNlZSBodHRwczovL2RvY3MuYW5ndWxhcmpzLm9yZy9ndWlkZS9zZWN1cml0eVxuXHRcblx0XG5cdGZ1bmN0aW9uIGVuc3VyZVNhZmVNZW1iZXJOYW1lKG5hbWUsIGZ1bGxFeHByZXNzaW9uKSB7XG5cdCAgaWYgKG5hbWUgPT09IFwiX19kZWZpbmVHZXR0ZXJfX1wiIHx8IG5hbWUgPT09IFwiX19kZWZpbmVTZXR0ZXJfX1wiXG5cdCAgICAgIHx8IG5hbWUgPT09IFwiX19sb29rdXBHZXR0ZXJfX1wiIHx8IG5hbWUgPT09IFwiX19sb29rdXBTZXR0ZXJfX1wiXG5cdCAgICAgIHx8IG5hbWUgPT09IFwiX19wcm90b19fXCIpIHtcblx0ICAgIHRocm93ICRwYXJzZU1pbkVycignaXNlY2ZsZCcsXG5cdCAgICAgICAgJ0F0dGVtcHRpbmcgdG8gYWNjZXNzIGEgZGlzYWxsb3dlZCBmaWVsZCBpbiBBbmd1bGFyIGV4cHJlc3Npb25zISAnXG5cdCAgICAgICAgKyAnRXhwcmVzc2lvbjogezB9JywgZnVsbEV4cHJlc3Npb24pO1xuXHQgIH1cblx0ICByZXR1cm4gbmFtZTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gZ2V0U3RyaW5nVmFsdWUobmFtZSkge1xuXHQgIC8vIFByb3BlcnR5IG5hbWVzIG11c3QgYmUgc3RyaW5ncy4gVGhpcyBtZWFucyB0aGF0IG5vbi1zdHJpbmcgb2JqZWN0cyBjYW5ub3QgYmUgdXNlZFxuXHQgIC8vIGFzIGtleXMgaW4gYW4gb2JqZWN0LiBBbnkgbm9uLXN0cmluZyBvYmplY3QsIGluY2x1ZGluZyBhIG51bWJlciwgaXMgdHlwZWNhc3RlZFxuXHQgIC8vIGludG8gYSBzdHJpbmcgdmlhIHRoZSB0b1N0cmluZyBtZXRob2QuXG5cdCAgLy8gLS0gTUROLCBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9PcGVyYXRvcnMvUHJvcGVydHlfYWNjZXNzb3JzI1Byb3BlcnR5X25hbWVzXG5cdCAgLy9cblx0ICAvLyBTbywgdG8gZW5zdXJlIHRoYXQgd2UgYXJlIGNoZWNraW5nIHRoZSBzYW1lIGBuYW1lYCB0aGF0IEphdmFTY3JpcHQgd291bGQgdXNlLCB3ZSBjYXN0IGl0XG5cdCAgLy8gdG8gYSBzdHJpbmcuIEl0J3Mgbm90IGFsd2F5cyBwb3NzaWJsZS4gSWYgYG5hbWVgIGlzIGFuIG9iamVjdCBhbmQgaXRzIGB0b1N0cmluZ2AgbWV0aG9kIGlzXG5cdCAgLy8gJ2Jyb2tlbicgKGRvZXNuJ3QgcmV0dXJuIGEgc3RyaW5nLCBpc24ndCBhIGZ1bmN0aW9uLCBldGMuKSwgYW4gZXJyb3Igd2lsbCBiZSB0aHJvd246XG5cdCAgLy9cblx0ICAvLyBUeXBlRXJyb3I6IENhbm5vdCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWVcblx0ICAvL1xuXHQgIC8vIEZvciBwZXJmb3JtYW5jZSByZWFzb25zLCB3ZSBkb24ndCBjYXRjaCB0aGlzIGVycm9yIGhlcmUgYW5kIGFsbG93IGl0IHRvIHByb3BhZ2F0ZSB1cCB0aGUgY2FsbFxuXHQgIC8vIHN0YWNrLiBOb3RlIHRoYXQgeW91J2xsIGdldCB0aGUgc2FtZSBlcnJvciBpbiBKYXZhU2NyaXB0IGlmIHlvdSB0cnkgdG8gYWNjZXNzIGEgcHJvcGVydHkgdXNpbmdcblx0ICAvLyBzdWNoIGEgJ2Jyb2tlbicgb2JqZWN0IGFzIGEga2V5LlxuXHQgIHJldHVybiBuYW1lICsgJyc7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGVuc3VyZVNhZmVPYmplY3Qob2JqLCBmdWxsRXhwcmVzc2lvbikge1xuXHQgIC8vIG5pZnR5IGNoZWNrIGlmIG9iaiBpcyBGdW5jdGlvbiB0aGF0IGlzIGZhc3QgYW5kIHdvcmtzIGFjcm9zcyBpZnJhbWVzIGFuZCBvdGhlciBjb250ZXh0c1xuXHQgIGlmIChvYmopIHtcblx0ICAgIGlmIChvYmouY29uc3RydWN0b3IgPT09IG9iaikge1xuXHQgICAgICB0aHJvdyAkcGFyc2VNaW5FcnIoJ2lzZWNmbicsXG5cdCAgICAgICAgICAnUmVmZXJlbmNpbmcgRnVuY3Rpb24gaW4gQW5ndWxhciBleHByZXNzaW9ucyBpcyBkaXNhbGxvd2VkISBFeHByZXNzaW9uOiB7MH0nLFxuXHQgICAgICAgICAgZnVsbEV4cHJlc3Npb24pO1xuXHQgICAgfSBlbHNlIGlmICgvLyBpc1dpbmRvdyhvYmopXG5cdCAgICAgICAgb2JqLndpbmRvdyA9PT0gb2JqKSB7XG5cdCAgICAgIHRocm93ICRwYXJzZU1pbkVycignaXNlY3dpbmRvdycsXG5cdCAgICAgICAgICAnUmVmZXJlbmNpbmcgdGhlIFdpbmRvdyBpbiBBbmd1bGFyIGV4cHJlc3Npb25zIGlzIGRpc2FsbG93ZWQhIEV4cHJlc3Npb246IHswfScsXG5cdCAgICAgICAgICBmdWxsRXhwcmVzc2lvbik7XG5cdCAgICB9IGVsc2UgaWYgKC8vIGlzRWxlbWVudChvYmopXG5cdCAgICAgICAgb2JqLmNoaWxkcmVuICYmIChvYmoubm9kZU5hbWUgfHwgKG9iai5wcm9wICYmIG9iai5hdHRyICYmIG9iai5maW5kKSkpIHtcblx0ICAgICAgdGhyb3cgJHBhcnNlTWluRXJyKCdpc2VjZG9tJyxcblx0ICAgICAgICAgICdSZWZlcmVuY2luZyBET00gbm9kZXMgaW4gQW5ndWxhciBleHByZXNzaW9ucyBpcyBkaXNhbGxvd2VkISBFeHByZXNzaW9uOiB7MH0nLFxuXHQgICAgICAgICAgZnVsbEV4cHJlc3Npb24pO1xuXHQgICAgfSBlbHNlIGlmICgvLyBibG9jayBPYmplY3Qgc28gdGhhdCB3ZSBjYW4ndCBnZXQgaG9sZCBvZiBkYW5nZXJvdXMgT2JqZWN0LiogbWV0aG9kc1xuXHQgICAgICAgIG9iaiA9PT0gT2JqZWN0KSB7XG5cdCAgICAgIHRocm93ICRwYXJzZU1pbkVycignaXNlY29iaicsXG5cdCAgICAgICAgICAnUmVmZXJlbmNpbmcgT2JqZWN0IGluIEFuZ3VsYXIgZXhwcmVzc2lvbnMgaXMgZGlzYWxsb3dlZCEgRXhwcmVzc2lvbjogezB9Jyxcblx0ICAgICAgICAgIGZ1bGxFeHByZXNzaW9uKTtcblx0ICAgIH1cblx0ICB9XG5cdCAgcmV0dXJuIG9iajtcblx0fVxuXHRcblx0dmFyIENBTEwgPSBGdW5jdGlvbi5wcm90b3R5cGUuY2FsbDtcblx0dmFyIEFQUExZID0gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5O1xuXHR2YXIgQklORCA9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kO1xuXHRcblx0ZnVuY3Rpb24gZW5zdXJlU2FmZUZ1bmN0aW9uKG9iaiwgZnVsbEV4cHJlc3Npb24pIHtcblx0ICBpZiAob2JqKSB7XG5cdCAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBvYmopIHtcblx0ICAgICAgdGhyb3cgJHBhcnNlTWluRXJyKCdpc2VjZm4nLFxuXHQgICAgICAgICdSZWZlcmVuY2luZyBGdW5jdGlvbiBpbiBBbmd1bGFyIGV4cHJlc3Npb25zIGlzIGRpc2FsbG93ZWQhIEV4cHJlc3Npb246IHswfScsXG5cdCAgICAgICAgZnVsbEV4cHJlc3Npb24pO1xuXHQgICAgfSBlbHNlIGlmIChvYmogPT09IENBTEwgfHwgb2JqID09PSBBUFBMWSB8fCBvYmogPT09IEJJTkQpIHtcblx0ICAgICAgdGhyb3cgJHBhcnNlTWluRXJyKCdpc2VjZmYnLFxuXHQgICAgICAgICdSZWZlcmVuY2luZyBjYWxsLCBhcHBseSBvciBiaW5kIGluIEFuZ3VsYXIgZXhwcmVzc2lvbnMgaXMgZGlzYWxsb3dlZCEgRXhwcmVzc2lvbjogezB9Jyxcblx0ICAgICAgICBmdWxsRXhwcmVzc2lvbik7XG5cdCAgICB9XG5cdCAgfVxuXHR9XG5cdFxuXHRmdW5jdGlvbiBlbnN1cmVTYWZlQXNzaWduQ29udGV4dChvYmosIGZ1bGxFeHByZXNzaW9uKSB7XG5cdCAgaWYgKG9iaikge1xuXHQgICAgaWYgKG9iaiA9PT0gKDApLmNvbnN0cnVjdG9yIHx8IG9iaiA9PT0gKGZhbHNlKS5jb25zdHJ1Y3RvciB8fCBvYmogPT09ICcnLmNvbnN0cnVjdG9yIHx8XG5cdCAgICAgICAgb2JqID09PSB7fS5jb25zdHJ1Y3RvciB8fCBvYmogPT09IFtdLmNvbnN0cnVjdG9yIHx8IG9iaiA9PT0gRnVuY3Rpb24uY29uc3RydWN0b3IpIHtcblx0ICAgICAgdGhyb3cgJHBhcnNlTWluRXJyKCdpc2VjYWYnLFxuXHQgICAgICAgICdBc3NpZ25pbmcgdG8gYSBjb25zdHJ1Y3RvciBpcyBkaXNhbGxvd2VkISBFeHByZXNzaW9uOiB7MH0nLCBmdWxsRXhwcmVzc2lvbik7XG5cdCAgICB9XG5cdCAgfVxuXHR9XG5cdFxuXHR2YXIgT1BFUkFUT1JTID0gY3JlYXRlTWFwKCk7XG5cdGZvckVhY2goJysgLSAqIC8gJSA9PT0gIT09ID09ICE9IDwgPiA8PSA+PSAmJiB8fCAhID0gfCcuc3BsaXQoJyAnKSwgZnVuY3Rpb24ob3BlcmF0b3IpIHsgT1BFUkFUT1JTW29wZXJhdG9yXSA9IHRydWU7IH0pO1xuXHR2YXIgRVNDQVBFID0ge1wiblwiOlwiXFxuXCIsIFwiZlwiOlwiXFxmXCIsIFwiclwiOlwiXFxyXCIsIFwidFwiOlwiXFx0XCIsIFwidlwiOlwiXFx2XCIsIFwiJ1wiOlwiJ1wiLCAnXCInOidcIid9O1xuXHRcblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHRcblx0LyoqXG5cdCAqIEBjb25zdHJ1Y3RvclxuXHQgKi9cblx0dmFyIExleGVyID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHQgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG5cdH07XG5cdFxuXHRMZXhlci5wcm90b3R5cGUgPSB7XG5cdCAgY29uc3RydWN0b3I6IExleGVyLFxuXHRcblx0ICBsZXg6IGZ1bmN0aW9uKHRleHQpIHtcblx0ICAgIHRoaXMudGV4dCA9IHRleHQ7XG5cdCAgICB0aGlzLmluZGV4ID0gMDtcblx0ICAgIHRoaXMudG9rZW5zID0gW107XG5cdFxuXHQgICAgd2hpbGUgKHRoaXMuaW5kZXggPCB0aGlzLnRleHQubGVuZ3RoKSB7XG5cdCAgICAgIHZhciBjaCA9IHRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCk7XG5cdCAgICAgIGlmIChjaCA9PT0gJ1wiJyB8fCBjaCA9PT0gXCInXCIpIHtcblx0ICAgICAgICB0aGlzLnJlYWRTdHJpbmcoY2gpO1xuXHQgICAgICB9IGVsc2UgaWYgKHRoaXMuaXNOdW1iZXIoY2gpIHx8IGNoID09PSAnLicgJiYgdGhpcy5pc051bWJlcih0aGlzLnBlZWsoKSkpIHtcblx0ICAgICAgICB0aGlzLnJlYWROdW1iZXIoKTtcblx0ICAgICAgfSBlbHNlIGlmICh0aGlzLmlzSWRlbnQoY2gpKSB7XG5cdCAgICAgICAgdGhpcy5yZWFkSWRlbnQoKTtcblx0ICAgICAgfSBlbHNlIGlmICh0aGlzLmlzKGNoLCAnKCl7fVtdLiw7Oj8nKSkge1xuXHQgICAgICAgIHRoaXMudG9rZW5zLnB1c2goe2luZGV4OiB0aGlzLmluZGV4LCB0ZXh0OiBjaH0pO1xuXHQgICAgICAgIHRoaXMuaW5kZXgrKztcblx0ICAgICAgfSBlbHNlIGlmICh0aGlzLmlzV2hpdGVzcGFjZShjaCkpIHtcblx0ICAgICAgICB0aGlzLmluZGV4Kys7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdmFyIGNoMiA9IGNoICsgdGhpcy5wZWVrKCk7XG5cdCAgICAgICAgdmFyIGNoMyA9IGNoMiArIHRoaXMucGVlaygyKTtcblx0ICAgICAgICB2YXIgb3AxID0gT1BFUkFUT1JTW2NoXTtcblx0ICAgICAgICB2YXIgb3AyID0gT1BFUkFUT1JTW2NoMl07XG5cdCAgICAgICAgdmFyIG9wMyA9IE9QRVJBVE9SU1tjaDNdO1xuXHQgICAgICAgIGlmIChvcDEgfHwgb3AyIHx8IG9wMykge1xuXHQgICAgICAgICAgdmFyIHRva2VuID0gb3AzID8gY2gzIDogKG9wMiA/IGNoMiA6IGNoKTtcblx0ICAgICAgICAgIHRoaXMudG9rZW5zLnB1c2goe2luZGV4OiB0aGlzLmluZGV4LCB0ZXh0OiB0b2tlbiwgb3BlcmF0b3I6IHRydWV9KTtcblx0ICAgICAgICAgIHRoaXMuaW5kZXggKz0gdG9rZW4ubGVuZ3RoO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB0aGlzLnRocm93RXJyb3IoJ1VuZXhwZWN0ZWQgbmV4dCBjaGFyYWN0ZXIgJywgdGhpcy5pbmRleCwgdGhpcy5pbmRleCArIDEpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIHRoaXMudG9rZW5zO1xuXHQgIH0sXG5cdFxuXHQgIGlzOiBmdW5jdGlvbihjaCwgY2hhcnMpIHtcblx0ICAgIHJldHVybiBjaGFycy5pbmRleE9mKGNoKSAhPT0gLTE7XG5cdCAgfSxcblx0XG5cdCAgcGVlazogZnVuY3Rpb24oaSkge1xuXHQgICAgdmFyIG51bSA9IGkgfHwgMTtcblx0ICAgIHJldHVybiAodGhpcy5pbmRleCArIG51bSA8IHRoaXMudGV4dC5sZW5ndGgpID8gdGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4ICsgbnVtKSA6IGZhbHNlO1xuXHQgIH0sXG5cdFxuXHQgIGlzTnVtYmVyOiBmdW5jdGlvbihjaCkge1xuXHQgICAgcmV0dXJuICgnMCcgPD0gY2ggJiYgY2ggPD0gJzknKSAmJiB0eXBlb2YgY2ggPT09IFwic3RyaW5nXCI7XG5cdCAgfSxcblx0XG5cdCAgaXNXaGl0ZXNwYWNlOiBmdW5jdGlvbihjaCkge1xuXHQgICAgLy8gSUUgdHJlYXRzIG5vbi1icmVha2luZyBzcGFjZSBhcyBcXHUwMEEwXG5cdCAgICByZXR1cm4gKGNoID09PSAnICcgfHwgY2ggPT09ICdcXHInIHx8IGNoID09PSAnXFx0JyB8fFxuXHQgICAgICAgICAgICBjaCA9PT0gJ1xcbicgfHwgY2ggPT09ICdcXHYnIHx8IGNoID09PSAnXFx1MDBBMCcpO1xuXHQgIH0sXG5cdFxuXHQgIGlzSWRlbnQ6IGZ1bmN0aW9uKGNoKSB7XG5cdCAgICByZXR1cm4gKCdhJyA8PSBjaCAmJiBjaCA8PSAneicgfHxcblx0ICAgICAgICAgICAgJ0EnIDw9IGNoICYmIGNoIDw9ICdaJyB8fFxuXHQgICAgICAgICAgICAnXycgPT09IGNoIHx8IGNoID09PSAnJCcpO1xuXHQgIH0sXG5cdFxuXHQgIGlzRXhwT3BlcmF0b3I6IGZ1bmN0aW9uKGNoKSB7XG5cdCAgICByZXR1cm4gKGNoID09PSAnLScgfHwgY2ggPT09ICcrJyB8fCB0aGlzLmlzTnVtYmVyKGNoKSk7XG5cdCAgfSxcblx0XG5cdCAgdGhyb3dFcnJvcjogZnVuY3Rpb24oZXJyb3IsIHN0YXJ0LCBlbmQpIHtcblx0ICAgIGVuZCA9IGVuZCB8fCB0aGlzLmluZGV4O1xuXHQgICAgdmFyIGNvbFN0ciA9IChpc0RlZmluZWQoc3RhcnQpXG5cdCAgICAgICAgICAgID8gJ3MgJyArIHN0YXJ0ICsgICctJyArIHRoaXMuaW5kZXggKyAnIFsnICsgdGhpcy50ZXh0LnN1YnN0cmluZyhzdGFydCwgZW5kKSArICddJ1xuXHQgICAgICAgICAgICA6ICcgJyArIGVuZCk7XG5cdCAgICB0aHJvdyAkcGFyc2VNaW5FcnIoJ2xleGVycicsICdMZXhlciBFcnJvcjogezB9IGF0IGNvbHVtbnsxfSBpbiBleHByZXNzaW9uIFt7Mn1dLicsXG5cdCAgICAgICAgZXJyb3IsIGNvbFN0ciwgdGhpcy50ZXh0KTtcblx0ICB9LFxuXHRcblx0ICByZWFkTnVtYmVyOiBmdW5jdGlvbigpIHtcblx0ICAgIHZhciBudW1iZXIgPSAnJztcblx0ICAgIHZhciBzdGFydCA9IHRoaXMuaW5kZXg7XG5cdCAgICB3aGlsZSAodGhpcy5pbmRleCA8IHRoaXMudGV4dC5sZW5ndGgpIHtcblx0ICAgICAgdmFyIGNoID0gbG93ZXJjYXNlKHRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCkpO1xuXHQgICAgICBpZiAoY2ggPT0gJy4nIHx8IHRoaXMuaXNOdW1iZXIoY2gpKSB7XG5cdCAgICAgICAgbnVtYmVyICs9IGNoO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHZhciBwZWVrQ2ggPSB0aGlzLnBlZWsoKTtcblx0ICAgICAgICBpZiAoY2ggPT0gJ2UnICYmIHRoaXMuaXNFeHBPcGVyYXRvcihwZWVrQ2gpKSB7XG5cdCAgICAgICAgICBudW1iZXIgKz0gY2g7XG5cdCAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzRXhwT3BlcmF0b3IoY2gpICYmXG5cdCAgICAgICAgICAgIHBlZWtDaCAmJiB0aGlzLmlzTnVtYmVyKHBlZWtDaCkgJiZcblx0ICAgICAgICAgICAgbnVtYmVyLmNoYXJBdChudW1iZXIubGVuZ3RoIC0gMSkgPT0gJ2UnKSB7XG5cdCAgICAgICAgICBudW1iZXIgKz0gY2g7XG5cdCAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzRXhwT3BlcmF0b3IoY2gpICYmXG5cdCAgICAgICAgICAgICghcGVla0NoIHx8ICF0aGlzLmlzTnVtYmVyKHBlZWtDaCkpICYmXG5cdCAgICAgICAgICAgIG51bWJlci5jaGFyQXQobnVtYmVyLmxlbmd0aCAtIDEpID09ICdlJykge1xuXHQgICAgICAgICAgdGhpcy50aHJvd0Vycm9yKCdJbnZhbGlkIGV4cG9uZW50Jyk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICB0aGlzLmluZGV4Kys7XG5cdCAgICB9XG5cdCAgICB0aGlzLnRva2Vucy5wdXNoKHtcblx0ICAgICAgaW5kZXg6IHN0YXJ0LFxuXHQgICAgICB0ZXh0OiBudW1iZXIsXG5cdCAgICAgIGNvbnN0YW50OiB0cnVlLFxuXHQgICAgICB2YWx1ZTogTnVtYmVyKG51bWJlcilcblx0ICAgIH0pO1xuXHQgIH0sXG5cdFxuXHQgIHJlYWRJZGVudDogZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgc3RhcnQgPSB0aGlzLmluZGV4O1xuXHQgICAgd2hpbGUgKHRoaXMuaW5kZXggPCB0aGlzLnRleHQubGVuZ3RoKSB7XG5cdCAgICAgIHZhciBjaCA9IHRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCk7XG5cdCAgICAgIGlmICghKHRoaXMuaXNJZGVudChjaCkgfHwgdGhpcy5pc051bWJlcihjaCkpKSB7XG5cdCAgICAgICAgYnJlYWs7XG5cdCAgICAgIH1cblx0ICAgICAgdGhpcy5pbmRleCsrO1xuXHQgICAgfVxuXHQgICAgdGhpcy50b2tlbnMucHVzaCh7XG5cdCAgICAgIGluZGV4OiBzdGFydCxcblx0ICAgICAgdGV4dDogdGhpcy50ZXh0LnNsaWNlKHN0YXJ0LCB0aGlzLmluZGV4KSxcblx0ICAgICAgaWRlbnRpZmllcjogdHJ1ZVxuXHQgICAgfSk7XG5cdCAgfSxcblx0XG5cdCAgcmVhZFN0cmluZzogZnVuY3Rpb24ocXVvdGUpIHtcblx0ICAgIHZhciBzdGFydCA9IHRoaXMuaW5kZXg7XG5cdCAgICB0aGlzLmluZGV4Kys7XG5cdCAgICB2YXIgc3RyaW5nID0gJyc7XG5cdCAgICB2YXIgcmF3U3RyaW5nID0gcXVvdGU7XG5cdCAgICB2YXIgZXNjYXBlID0gZmFsc2U7XG5cdCAgICB3aGlsZSAodGhpcy5pbmRleCA8IHRoaXMudGV4dC5sZW5ndGgpIHtcblx0ICAgICAgdmFyIGNoID0gdGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KTtcblx0ICAgICAgcmF3U3RyaW5nICs9IGNoO1xuXHQgICAgICBpZiAoZXNjYXBlKSB7XG5cdCAgICAgICAgaWYgKGNoID09PSAndScpIHtcblx0ICAgICAgICAgIHZhciBoZXggPSB0aGlzLnRleHQuc3Vic3RyaW5nKHRoaXMuaW5kZXggKyAxLCB0aGlzLmluZGV4ICsgNSk7XG5cdCAgICAgICAgICBpZiAoIWhleC5tYXRjaCgvW1xcZGEtZl17NH0vaSkpIHtcblx0ICAgICAgICAgICAgdGhpcy50aHJvd0Vycm9yKCdJbnZhbGlkIHVuaWNvZGUgZXNjYXBlIFtcXFxcdScgKyBoZXggKyAnXScpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgdGhpcy5pbmRleCArPSA0O1xuXHQgICAgICAgICAgc3RyaW5nICs9IFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoaGV4LCAxNikpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB2YXIgcmVwID0gRVNDQVBFW2NoXTtcblx0ICAgICAgICAgIHN0cmluZyA9IHN0cmluZyArIChyZXAgfHwgY2gpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlc2NhcGUgPSBmYWxzZTtcblx0ICAgICAgfSBlbHNlIGlmIChjaCA9PT0gJ1xcXFwnKSB7XG5cdCAgICAgICAgZXNjYXBlID0gdHJ1ZTtcblx0ICAgICAgfSBlbHNlIGlmIChjaCA9PT0gcXVvdGUpIHtcblx0ICAgICAgICB0aGlzLmluZGV4Kys7XG5cdCAgICAgICAgdGhpcy50b2tlbnMucHVzaCh7XG5cdCAgICAgICAgICBpbmRleDogc3RhcnQsXG5cdCAgICAgICAgICB0ZXh0OiByYXdTdHJpbmcsXG5cdCAgICAgICAgICBjb25zdGFudDogdHJ1ZSxcblx0ICAgICAgICAgIHZhbHVlOiBzdHJpbmdcblx0ICAgICAgICB9KTtcblx0ICAgICAgICByZXR1cm47XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgc3RyaW5nICs9IGNoO1xuXHQgICAgICB9XG5cdCAgICAgIHRoaXMuaW5kZXgrKztcblx0ICAgIH1cblx0ICAgIHRoaXMudGhyb3dFcnJvcignVW50ZXJtaW5hdGVkIHF1b3RlJywgc3RhcnQpO1xuXHQgIH1cblx0fTtcblx0XG5cdHZhciBBU1QgPSBmdW5jdGlvbihsZXhlciwgb3B0aW9ucykge1xuXHQgIHRoaXMubGV4ZXIgPSBsZXhlcjtcblx0ICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuXHR9O1xuXHRcblx0QVNULlByb2dyYW0gPSAnUHJvZ3JhbSc7XG5cdEFTVC5FeHByZXNzaW9uU3RhdGVtZW50ID0gJ0V4cHJlc3Npb25TdGF0ZW1lbnQnO1xuXHRBU1QuQXNzaWdubWVudEV4cHJlc3Npb24gPSAnQXNzaWdubWVudEV4cHJlc3Npb24nO1xuXHRBU1QuQ29uZGl0aW9uYWxFeHByZXNzaW9uID0gJ0NvbmRpdGlvbmFsRXhwcmVzc2lvbic7XG5cdEFTVC5Mb2dpY2FsRXhwcmVzc2lvbiA9ICdMb2dpY2FsRXhwcmVzc2lvbic7XG5cdEFTVC5CaW5hcnlFeHByZXNzaW9uID0gJ0JpbmFyeUV4cHJlc3Npb24nO1xuXHRBU1QuVW5hcnlFeHByZXNzaW9uID0gJ1VuYXJ5RXhwcmVzc2lvbic7XG5cdEFTVC5DYWxsRXhwcmVzc2lvbiA9ICdDYWxsRXhwcmVzc2lvbic7XG5cdEFTVC5NZW1iZXJFeHByZXNzaW9uID0gJ01lbWJlckV4cHJlc3Npb24nO1xuXHRBU1QuSWRlbnRpZmllciA9ICdJZGVudGlmaWVyJztcblx0QVNULkxpdGVyYWwgPSAnTGl0ZXJhbCc7XG5cdEFTVC5BcnJheUV4cHJlc3Npb24gPSAnQXJyYXlFeHByZXNzaW9uJztcblx0QVNULlByb3BlcnR5ID0gJ1Byb3BlcnR5Jztcblx0QVNULk9iamVjdEV4cHJlc3Npb24gPSAnT2JqZWN0RXhwcmVzc2lvbic7XG5cdEFTVC5UaGlzRXhwcmVzc2lvbiA9ICdUaGlzRXhwcmVzc2lvbic7XG5cdEFTVC5Mb2NhbHNFeHByZXNzaW9uID0gJ0xvY2Fsc0V4cHJlc3Npb24nO1xuXHRcblx0Ly8gSW50ZXJuYWwgdXNlIG9ubHlcblx0QVNULk5HVmFsdWVQYXJhbWV0ZXIgPSAnTkdWYWx1ZVBhcmFtZXRlcic7XG5cdFxuXHRBU1QucHJvdG90eXBlID0ge1xuXHQgIGFzdDogZnVuY3Rpb24odGV4dCkge1xuXHQgICAgdGhpcy50ZXh0ID0gdGV4dDtcblx0ICAgIHRoaXMudG9rZW5zID0gdGhpcy5sZXhlci5sZXgodGV4dCk7XG5cdFxuXHQgICAgdmFyIHZhbHVlID0gdGhpcy5wcm9ncmFtKCk7XG5cdFxuXHQgICAgaWYgKHRoaXMudG9rZW5zLmxlbmd0aCAhPT0gMCkge1xuXHQgICAgICB0aGlzLnRocm93RXJyb3IoJ2lzIGFuIHVuZXhwZWN0ZWQgdG9rZW4nLCB0aGlzLnRva2Vuc1swXSk7XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIHZhbHVlO1xuXHQgIH0sXG5cdFxuXHQgIHByb2dyYW06IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIGJvZHkgPSBbXTtcblx0ICAgIHdoaWxlICh0cnVlKSB7XG5cdCAgICAgIGlmICh0aGlzLnRva2Vucy5sZW5ndGggPiAwICYmICF0aGlzLnBlZWsoJ30nLCAnKScsICc7JywgJ10nKSlcblx0ICAgICAgICBib2R5LnB1c2godGhpcy5leHByZXNzaW9uU3RhdGVtZW50KCkpO1xuXHQgICAgICBpZiAoIXRoaXMuZXhwZWN0KCc7JykpIHtcblx0ICAgICAgICByZXR1cm4geyB0eXBlOiBBU1QuUHJvZ3JhbSwgYm9keTogYm9keX07XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9LFxuXHRcblx0ICBleHByZXNzaW9uU3RhdGVtZW50OiBmdW5jdGlvbigpIHtcblx0ICAgIHJldHVybiB7IHR5cGU6IEFTVC5FeHByZXNzaW9uU3RhdGVtZW50LCBleHByZXNzaW9uOiB0aGlzLmZpbHRlckNoYWluKCkgfTtcblx0ICB9LFxuXHRcblx0ICBmaWx0ZXJDaGFpbjogZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgbGVmdCA9IHRoaXMuZXhwcmVzc2lvbigpO1xuXHQgICAgdmFyIHRva2VuO1xuXHQgICAgd2hpbGUgKCh0b2tlbiA9IHRoaXMuZXhwZWN0KCd8JykpKSB7XG5cdCAgICAgIGxlZnQgPSB0aGlzLmZpbHRlcihsZWZ0KTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBsZWZ0O1xuXHQgIH0sXG5cdFxuXHQgIGV4cHJlc3Npb246IGZ1bmN0aW9uKCkge1xuXHQgICAgcmV0dXJuIHRoaXMuYXNzaWdubWVudCgpO1xuXHQgIH0sXG5cdFxuXHQgIGFzc2lnbm1lbnQ6IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIHJlc3VsdCA9IHRoaXMudGVybmFyeSgpO1xuXHQgICAgaWYgKHRoaXMuZXhwZWN0KCc9JykpIHtcblx0ICAgICAgcmVzdWx0ID0geyB0eXBlOiBBU1QuQXNzaWdubWVudEV4cHJlc3Npb24sIGxlZnQ6IHJlc3VsdCwgcmlnaHQ6IHRoaXMuYXNzaWdubWVudCgpLCBvcGVyYXRvcjogJz0nfTtcblx0ICAgIH1cblx0ICAgIHJldHVybiByZXN1bHQ7XG5cdCAgfSxcblx0XG5cdCAgdGVybmFyeTogZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgdGVzdCA9IHRoaXMubG9naWNhbE9SKCk7XG5cdCAgICB2YXIgYWx0ZXJuYXRlO1xuXHQgICAgdmFyIGNvbnNlcXVlbnQ7XG5cdCAgICBpZiAodGhpcy5leHBlY3QoJz8nKSkge1xuXHQgICAgICBhbHRlcm5hdGUgPSB0aGlzLmV4cHJlc3Npb24oKTtcblx0ICAgICAgaWYgKHRoaXMuY29uc3VtZSgnOicpKSB7XG5cdCAgICAgICAgY29uc2VxdWVudCA9IHRoaXMuZXhwcmVzc2lvbigpO1xuXHQgICAgICAgIHJldHVybiB7IHR5cGU6IEFTVC5Db25kaXRpb25hbEV4cHJlc3Npb24sIHRlc3Q6IHRlc3QsIGFsdGVybmF0ZTogYWx0ZXJuYXRlLCBjb25zZXF1ZW50OiBjb25zZXF1ZW50fTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIHRlc3Q7XG5cdCAgfSxcblx0XG5cdCAgbG9naWNhbE9SOiBmdW5jdGlvbigpIHtcblx0ICAgIHZhciBsZWZ0ID0gdGhpcy5sb2dpY2FsQU5EKCk7XG5cdCAgICB3aGlsZSAodGhpcy5leHBlY3QoJ3x8JykpIHtcblx0ICAgICAgbGVmdCA9IHsgdHlwZTogQVNULkxvZ2ljYWxFeHByZXNzaW9uLCBvcGVyYXRvcjogJ3x8JywgbGVmdDogbGVmdCwgcmlnaHQ6IHRoaXMubG9naWNhbEFORCgpIH07XG5cdCAgICB9XG5cdCAgICByZXR1cm4gbGVmdDtcblx0ICB9LFxuXHRcblx0ICBsb2dpY2FsQU5EOiBmdW5jdGlvbigpIHtcblx0ICAgIHZhciBsZWZ0ID0gdGhpcy5lcXVhbGl0eSgpO1xuXHQgICAgd2hpbGUgKHRoaXMuZXhwZWN0KCcmJicpKSB7XG5cdCAgICAgIGxlZnQgPSB7IHR5cGU6IEFTVC5Mb2dpY2FsRXhwcmVzc2lvbiwgb3BlcmF0b3I6ICcmJicsIGxlZnQ6IGxlZnQsIHJpZ2h0OiB0aGlzLmVxdWFsaXR5KCl9O1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIGxlZnQ7XG5cdCAgfSxcblx0XG5cdCAgZXF1YWxpdHk6IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIGxlZnQgPSB0aGlzLnJlbGF0aW9uYWwoKTtcblx0ICAgIHZhciB0b2tlbjtcblx0ICAgIHdoaWxlICgodG9rZW4gPSB0aGlzLmV4cGVjdCgnPT0nLCchPScsJz09PScsJyE9PScpKSkge1xuXHQgICAgICBsZWZ0ID0geyB0eXBlOiBBU1QuQmluYXJ5RXhwcmVzc2lvbiwgb3BlcmF0b3I6IHRva2VuLnRleHQsIGxlZnQ6IGxlZnQsIHJpZ2h0OiB0aGlzLnJlbGF0aW9uYWwoKSB9O1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIGxlZnQ7XG5cdCAgfSxcblx0XG5cdCAgcmVsYXRpb25hbDogZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgbGVmdCA9IHRoaXMuYWRkaXRpdmUoKTtcblx0ICAgIHZhciB0b2tlbjtcblx0ICAgIHdoaWxlICgodG9rZW4gPSB0aGlzLmV4cGVjdCgnPCcsICc+JywgJzw9JywgJz49JykpKSB7XG5cdCAgICAgIGxlZnQgPSB7IHR5cGU6IEFTVC5CaW5hcnlFeHByZXNzaW9uLCBvcGVyYXRvcjogdG9rZW4udGV4dCwgbGVmdDogbGVmdCwgcmlnaHQ6IHRoaXMuYWRkaXRpdmUoKSB9O1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIGxlZnQ7XG5cdCAgfSxcblx0XG5cdCAgYWRkaXRpdmU6IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIGxlZnQgPSB0aGlzLm11bHRpcGxpY2F0aXZlKCk7XG5cdCAgICB2YXIgdG9rZW47XG5cdCAgICB3aGlsZSAoKHRva2VuID0gdGhpcy5leHBlY3QoJysnLCctJykpKSB7XG5cdCAgICAgIGxlZnQgPSB7IHR5cGU6IEFTVC5CaW5hcnlFeHByZXNzaW9uLCBvcGVyYXRvcjogdG9rZW4udGV4dCwgbGVmdDogbGVmdCwgcmlnaHQ6IHRoaXMubXVsdGlwbGljYXRpdmUoKSB9O1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIGxlZnQ7XG5cdCAgfSxcblx0XG5cdCAgbXVsdGlwbGljYXRpdmU6IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIGxlZnQgPSB0aGlzLnVuYXJ5KCk7XG5cdCAgICB2YXIgdG9rZW47XG5cdCAgICB3aGlsZSAoKHRva2VuID0gdGhpcy5leHBlY3QoJyonLCcvJywnJScpKSkge1xuXHQgICAgICBsZWZ0ID0geyB0eXBlOiBBU1QuQmluYXJ5RXhwcmVzc2lvbiwgb3BlcmF0b3I6IHRva2VuLnRleHQsIGxlZnQ6IGxlZnQsIHJpZ2h0OiB0aGlzLnVuYXJ5KCkgfTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBsZWZ0O1xuXHQgIH0sXG5cdFxuXHQgIHVuYXJ5OiBmdW5jdGlvbigpIHtcblx0ICAgIHZhciB0b2tlbjtcblx0ICAgIGlmICgodG9rZW4gPSB0aGlzLmV4cGVjdCgnKycsICctJywgJyEnKSkpIHtcblx0ICAgICAgcmV0dXJuIHsgdHlwZTogQVNULlVuYXJ5RXhwcmVzc2lvbiwgb3BlcmF0b3I6IHRva2VuLnRleHQsIHByZWZpeDogdHJ1ZSwgYXJndW1lbnQ6IHRoaXMudW5hcnkoKSB9O1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgcmV0dXJuIHRoaXMucHJpbWFyeSgpO1xuXHQgICAgfVxuXHQgIH0sXG5cdFxuXHQgIHByaW1hcnk6IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIHByaW1hcnk7XG5cdCAgICBpZiAodGhpcy5leHBlY3QoJygnKSkge1xuXHQgICAgICBwcmltYXJ5ID0gdGhpcy5maWx0ZXJDaGFpbigpO1xuXHQgICAgICB0aGlzLmNvbnN1bWUoJyknKTtcblx0ICAgIH0gZWxzZSBpZiAodGhpcy5leHBlY3QoJ1snKSkge1xuXHQgICAgICBwcmltYXJ5ID0gdGhpcy5hcnJheURlY2xhcmF0aW9uKCk7XG5cdCAgICB9IGVsc2UgaWYgKHRoaXMuZXhwZWN0KCd7JykpIHtcblx0ICAgICAgcHJpbWFyeSA9IHRoaXMub2JqZWN0KCk7XG5cdCAgICB9IGVsc2UgaWYgKHRoaXMuY29uc3RhbnRzLmhhc093blByb3BlcnR5KHRoaXMucGVlaygpLnRleHQpKSB7XG5cdCAgICAgIHByaW1hcnkgPSBjb3B5KHRoaXMuY29uc3RhbnRzW3RoaXMuY29uc3VtZSgpLnRleHRdKTtcblx0ICAgIH0gZWxzZSBpZiAodGhpcy5wZWVrKCkuaWRlbnRpZmllcikge1xuXHQgICAgICBwcmltYXJ5ID0gdGhpcy5pZGVudGlmaWVyKCk7XG5cdCAgICB9IGVsc2UgaWYgKHRoaXMucGVlaygpLmNvbnN0YW50KSB7XG5cdCAgICAgIHByaW1hcnkgPSB0aGlzLmNvbnN0YW50KCk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB0aGlzLnRocm93RXJyb3IoJ25vdCBhIHByaW1hcnkgZXhwcmVzc2lvbicsIHRoaXMucGVlaygpKTtcblx0ICAgIH1cblx0XG5cdCAgICB2YXIgbmV4dDtcblx0ICAgIHdoaWxlICgobmV4dCA9IHRoaXMuZXhwZWN0KCcoJywgJ1snLCAnLicpKSkge1xuXHQgICAgICBpZiAobmV4dC50ZXh0ID09PSAnKCcpIHtcblx0ICAgICAgICBwcmltYXJ5ID0ge3R5cGU6IEFTVC5DYWxsRXhwcmVzc2lvbiwgY2FsbGVlOiBwcmltYXJ5LCBhcmd1bWVudHM6IHRoaXMucGFyc2VBcmd1bWVudHMoKSB9O1xuXHQgICAgICAgIHRoaXMuY29uc3VtZSgnKScpO1xuXHQgICAgICB9IGVsc2UgaWYgKG5leHQudGV4dCA9PT0gJ1snKSB7XG5cdCAgICAgICAgcHJpbWFyeSA9IHsgdHlwZTogQVNULk1lbWJlckV4cHJlc3Npb24sIG9iamVjdDogcHJpbWFyeSwgcHJvcGVydHk6IHRoaXMuZXhwcmVzc2lvbigpLCBjb21wdXRlZDogdHJ1ZSB9O1xuXHQgICAgICAgIHRoaXMuY29uc3VtZSgnXScpO1xuXHQgICAgICB9IGVsc2UgaWYgKG5leHQudGV4dCA9PT0gJy4nKSB7XG5cdCAgICAgICAgcHJpbWFyeSA9IHsgdHlwZTogQVNULk1lbWJlckV4cHJlc3Npb24sIG9iamVjdDogcHJpbWFyeSwgcHJvcGVydHk6IHRoaXMuaWRlbnRpZmllcigpLCBjb21wdXRlZDogZmFsc2UgfTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB0aGlzLnRocm93RXJyb3IoJ0lNUE9TU0lCTEUnKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIHByaW1hcnk7XG5cdCAgfSxcblx0XG5cdCAgZmlsdGVyOiBmdW5jdGlvbihiYXNlRXhwcmVzc2lvbikge1xuXHQgICAgdmFyIGFyZ3MgPSBbYmFzZUV4cHJlc3Npb25dO1xuXHQgICAgdmFyIHJlc3VsdCA9IHt0eXBlOiBBU1QuQ2FsbEV4cHJlc3Npb24sIGNhbGxlZTogdGhpcy5pZGVudGlmaWVyKCksIGFyZ3VtZW50czogYXJncywgZmlsdGVyOiB0cnVlfTtcblx0XG5cdCAgICB3aGlsZSAodGhpcy5leHBlY3QoJzonKSkge1xuXHQgICAgICBhcmdzLnB1c2godGhpcy5leHByZXNzaW9uKCkpO1xuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiByZXN1bHQ7XG5cdCAgfSxcblx0XG5cdCAgcGFyc2VBcmd1bWVudHM6IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIGFyZ3MgPSBbXTtcblx0ICAgIGlmICh0aGlzLnBlZWtUb2tlbigpLnRleHQgIT09ICcpJykge1xuXHQgICAgICBkbyB7XG5cdCAgICAgICAgYXJncy5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKTtcblx0ICAgICAgfSB3aGlsZSAodGhpcy5leHBlY3QoJywnKSk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gYXJncztcblx0ICB9LFxuXHRcblx0ICBpZGVudGlmaWVyOiBmdW5jdGlvbigpIHtcblx0ICAgIHZhciB0b2tlbiA9IHRoaXMuY29uc3VtZSgpO1xuXHQgICAgaWYgKCF0b2tlbi5pZGVudGlmaWVyKSB7XG5cdCAgICAgIHRoaXMudGhyb3dFcnJvcignaXMgbm90IGEgdmFsaWQgaWRlbnRpZmllcicsIHRva2VuKTtcblx0ICAgIH1cblx0ICAgIHJldHVybiB7IHR5cGU6IEFTVC5JZGVudGlmaWVyLCBuYW1lOiB0b2tlbi50ZXh0IH07XG5cdCAgfSxcblx0XG5cdCAgY29uc3RhbnQ6IGZ1bmN0aW9uKCkge1xuXHQgICAgLy8gVE9ETyBjaGVjayB0aGF0IGl0IGlzIGEgY29uc3RhbnRcblx0ICAgIHJldHVybiB7IHR5cGU6IEFTVC5MaXRlcmFsLCB2YWx1ZTogdGhpcy5jb25zdW1lKCkudmFsdWUgfTtcblx0ICB9LFxuXHRcblx0ICBhcnJheURlY2xhcmF0aW9uOiBmdW5jdGlvbigpIHtcblx0ICAgIHZhciBlbGVtZW50cyA9IFtdO1xuXHQgICAgaWYgKHRoaXMucGVla1Rva2VuKCkudGV4dCAhPT0gJ10nKSB7XG5cdCAgICAgIGRvIHtcblx0ICAgICAgICBpZiAodGhpcy5wZWVrKCddJykpIHtcblx0ICAgICAgICAgIC8vIFN1cHBvcnQgdHJhaWxpbmcgY29tbWFzIHBlciBFUzUuMS5cblx0ICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbGVtZW50cy5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKTtcblx0ICAgICAgfSB3aGlsZSAodGhpcy5leHBlY3QoJywnKSk7XG5cdCAgICB9XG5cdCAgICB0aGlzLmNvbnN1bWUoJ10nKTtcblx0XG5cdCAgICByZXR1cm4geyB0eXBlOiBBU1QuQXJyYXlFeHByZXNzaW9uLCBlbGVtZW50czogZWxlbWVudHMgfTtcblx0ICB9LFxuXHRcblx0ICBvYmplY3Q6IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIHByb3BlcnRpZXMgPSBbXSwgcHJvcGVydHk7XG5cdCAgICBpZiAodGhpcy5wZWVrVG9rZW4oKS50ZXh0ICE9PSAnfScpIHtcblx0ICAgICAgZG8ge1xuXHQgICAgICAgIGlmICh0aGlzLnBlZWsoJ30nKSkge1xuXHQgICAgICAgICAgLy8gU3VwcG9ydCB0cmFpbGluZyBjb21tYXMgcGVyIEVTNS4xLlxuXHQgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHByb3BlcnR5ID0ge3R5cGU6IEFTVC5Qcm9wZXJ0eSwga2luZDogJ2luaXQnfTtcblx0ICAgICAgICBpZiAodGhpcy5wZWVrKCkuY29uc3RhbnQpIHtcblx0ICAgICAgICAgIHByb3BlcnR5LmtleSA9IHRoaXMuY29uc3RhbnQoKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGVlaygpLmlkZW50aWZpZXIpIHtcblx0ICAgICAgICAgIHByb3BlcnR5LmtleSA9IHRoaXMuaWRlbnRpZmllcigpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB0aGlzLnRocm93RXJyb3IoXCJpbnZhbGlkIGtleVwiLCB0aGlzLnBlZWsoKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMuY29uc3VtZSgnOicpO1xuXHQgICAgICAgIHByb3BlcnR5LnZhbHVlID0gdGhpcy5leHByZXNzaW9uKCk7XG5cdCAgICAgICAgcHJvcGVydGllcy5wdXNoKHByb3BlcnR5KTtcblx0ICAgICAgfSB3aGlsZSAodGhpcy5leHBlY3QoJywnKSk7XG5cdCAgICB9XG5cdCAgICB0aGlzLmNvbnN1bWUoJ30nKTtcblx0XG5cdCAgICByZXR1cm4ge3R5cGU6IEFTVC5PYmplY3RFeHByZXNzaW9uLCBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzIH07XG5cdCAgfSxcblx0XG5cdCAgdGhyb3dFcnJvcjogZnVuY3Rpb24obXNnLCB0b2tlbikge1xuXHQgICAgdGhyb3cgJHBhcnNlTWluRXJyKCdzeW50YXgnLFxuXHQgICAgICAgICdTeW50YXggRXJyb3I6IFRva2VuIFxcJ3swfVxcJyB7MX0gYXQgY29sdW1uIHsyfSBvZiB0aGUgZXhwcmVzc2lvbiBbezN9XSBzdGFydGluZyBhdCBbezR9XS4nLFxuXHQgICAgICAgICAgdG9rZW4udGV4dCwgbXNnLCAodG9rZW4uaW5kZXggKyAxKSwgdGhpcy50ZXh0LCB0aGlzLnRleHQuc3Vic3RyaW5nKHRva2VuLmluZGV4KSk7XG5cdCAgfSxcblx0XG5cdCAgY29uc3VtZTogZnVuY3Rpb24oZTEpIHtcblx0ICAgIGlmICh0aGlzLnRva2Vucy5sZW5ndGggPT09IDApIHtcblx0ICAgICAgdGhyb3cgJHBhcnNlTWluRXJyKCd1ZW9lJywgJ1VuZXhwZWN0ZWQgZW5kIG9mIGV4cHJlc3Npb246IHswfScsIHRoaXMudGV4dCk7XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIHRva2VuID0gdGhpcy5leHBlY3QoZTEpO1xuXHQgICAgaWYgKCF0b2tlbikge1xuXHQgICAgICB0aGlzLnRocm93RXJyb3IoJ2lzIHVuZXhwZWN0ZWQsIGV4cGVjdGluZyBbJyArIGUxICsgJ10nLCB0aGlzLnBlZWsoKSk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gdG9rZW47XG5cdCAgfSxcblx0XG5cdCAgcGVla1Rva2VuOiBmdW5jdGlvbigpIHtcblx0ICAgIGlmICh0aGlzLnRva2Vucy5sZW5ndGggPT09IDApIHtcblx0ICAgICAgdGhyb3cgJHBhcnNlTWluRXJyKCd1ZW9lJywgJ1VuZXhwZWN0ZWQgZW5kIG9mIGV4cHJlc3Npb246IHswfScsIHRoaXMudGV4dCk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gdGhpcy50b2tlbnNbMF07XG5cdCAgfSxcblx0XG5cdCAgcGVlazogZnVuY3Rpb24oZTEsIGUyLCBlMywgZTQpIHtcblx0ICAgIHJldHVybiB0aGlzLnBlZWtBaGVhZCgwLCBlMSwgZTIsIGUzLCBlNCk7XG5cdCAgfSxcblx0XG5cdCAgcGVla0FoZWFkOiBmdW5jdGlvbihpLCBlMSwgZTIsIGUzLCBlNCkge1xuXHQgICAgaWYgKHRoaXMudG9rZW5zLmxlbmd0aCA+IGkpIHtcblx0ICAgICAgdmFyIHRva2VuID0gdGhpcy50b2tlbnNbaV07XG5cdCAgICAgIHZhciB0ID0gdG9rZW4udGV4dDtcblx0ICAgICAgaWYgKHQgPT09IGUxIHx8IHQgPT09IGUyIHx8IHQgPT09IGUzIHx8IHQgPT09IGU0IHx8XG5cdCAgICAgICAgICAoIWUxICYmICFlMiAmJiAhZTMgJiYgIWU0KSkge1xuXHQgICAgICAgIHJldHVybiB0b2tlbjtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIGZhbHNlO1xuXHQgIH0sXG5cdFxuXHQgIGV4cGVjdDogZnVuY3Rpb24oZTEsIGUyLCBlMywgZTQpIHtcblx0ICAgIHZhciB0b2tlbiA9IHRoaXMucGVlayhlMSwgZTIsIGUzLCBlNCk7XG5cdCAgICBpZiAodG9rZW4pIHtcblx0ICAgICAgdGhpcy50b2tlbnMuc2hpZnQoKTtcblx0ICAgICAgcmV0dXJuIHRva2VuO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIGZhbHNlO1xuXHQgIH0sXG5cdFxuXHRcblx0ICAvKiBgdW5kZWZpbmVkYCBpcyBub3QgYSBjb25zdGFudCwgaXQgaXMgYW4gaWRlbnRpZmllcixcblx0ICAgKiBidXQgdXNpbmcgaXQgYXMgYW4gaWRlbnRpZmllciBpcyBub3Qgc3VwcG9ydGVkXG5cdCAgICovXG5cdCAgY29uc3RhbnRzOiB7XG5cdCAgICAndHJ1ZSc6IHsgdHlwZTogQVNULkxpdGVyYWwsIHZhbHVlOiB0cnVlIH0sXG5cdCAgICAnZmFsc2UnOiB7IHR5cGU6IEFTVC5MaXRlcmFsLCB2YWx1ZTogZmFsc2UgfSxcblx0ICAgICdudWxsJzogeyB0eXBlOiBBU1QuTGl0ZXJhbCwgdmFsdWU6IG51bGwgfSxcblx0ICAgICd1bmRlZmluZWQnOiB7dHlwZTogQVNULkxpdGVyYWwsIHZhbHVlOiB1bmRlZmluZWQgfSxcblx0ICAgICd0aGlzJzoge3R5cGU6IEFTVC5UaGlzRXhwcmVzc2lvbiB9LFxuXHQgICAgJyRsb2NhbHMnOiB7dHlwZTogQVNULkxvY2Fsc0V4cHJlc3Npb24gfVxuXHQgIH1cblx0fTtcblx0XG5cdGZ1bmN0aW9uIGlmRGVmaW5lZCh2LCBkKSB7XG5cdCAgcmV0dXJuIHR5cGVvZiB2ICE9PSAndW5kZWZpbmVkJyA/IHYgOiBkO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBwbHVzRm4obCwgcikge1xuXHQgIGlmICh0eXBlb2YgbCA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybiByO1xuXHQgIGlmICh0eXBlb2YgciA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybiBsO1xuXHQgIHJldHVybiBsICsgcjtcblx0fVxuXHRcblx0ZnVuY3Rpb24gaXNTdGF0ZWxlc3MoJGZpbHRlciwgZmlsdGVyTmFtZSkge1xuXHQgIHZhciBmbiA9ICRmaWx0ZXIoZmlsdGVyTmFtZSk7XG5cdCAgcmV0dXJuICFmbi4kc3RhdGVmdWw7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LCAkZmlsdGVyKSB7XG5cdCAgdmFyIGFsbENvbnN0YW50cztcblx0ICB2YXIgYXJnc1RvV2F0Y2g7XG5cdCAgc3dpdGNoIChhc3QudHlwZSkge1xuXHQgIGNhc2UgQVNULlByb2dyYW06XG5cdCAgICBhbGxDb25zdGFudHMgPSB0cnVlO1xuXHQgICAgZm9yRWFjaChhc3QuYm9keSwgZnVuY3Rpb24oZXhwcikge1xuXHQgICAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGV4cHIuZXhwcmVzc2lvbiwgJGZpbHRlcik7XG5cdCAgICAgIGFsbENvbnN0YW50cyA9IGFsbENvbnN0YW50cyAmJiBleHByLmV4cHJlc3Npb24uY29uc3RhbnQ7XG5cdCAgICB9KTtcblx0ICAgIGFzdC5jb25zdGFudCA9IGFsbENvbnN0YW50cztcblx0ICAgIGJyZWFrO1xuXHQgIGNhc2UgQVNULkxpdGVyYWw6XG5cdCAgICBhc3QuY29uc3RhbnQgPSB0cnVlO1xuXHQgICAgYXN0LnRvV2F0Y2ggPSBbXTtcblx0ICAgIGJyZWFrO1xuXHQgIGNhc2UgQVNULlVuYXJ5RXhwcmVzc2lvbjpcblx0ICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LmFyZ3VtZW50LCAkZmlsdGVyKTtcblx0ICAgIGFzdC5jb25zdGFudCA9IGFzdC5hcmd1bWVudC5jb25zdGFudDtcblx0ICAgIGFzdC50b1dhdGNoID0gYXN0LmFyZ3VtZW50LnRvV2F0Y2g7XG5cdCAgICBicmVhaztcblx0ICBjYXNlIEFTVC5CaW5hcnlFeHByZXNzaW9uOlxuXHQgICAgZmluZENvbnN0YW50QW5kV2F0Y2hFeHByZXNzaW9ucyhhc3QubGVmdCwgJGZpbHRlcik7XG5cdCAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGFzdC5yaWdodCwgJGZpbHRlcik7XG5cdCAgICBhc3QuY29uc3RhbnQgPSBhc3QubGVmdC5jb25zdGFudCAmJiBhc3QucmlnaHQuY29uc3RhbnQ7XG5cdCAgICBhc3QudG9XYXRjaCA9IGFzdC5sZWZ0LnRvV2F0Y2guY29uY2F0KGFzdC5yaWdodC50b1dhdGNoKTtcblx0ICAgIGJyZWFrO1xuXHQgIGNhc2UgQVNULkxvZ2ljYWxFeHByZXNzaW9uOlxuXHQgICAgZmluZENvbnN0YW50QW5kV2F0Y2hFeHByZXNzaW9ucyhhc3QubGVmdCwgJGZpbHRlcik7XG5cdCAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGFzdC5yaWdodCwgJGZpbHRlcik7XG5cdCAgICBhc3QuY29uc3RhbnQgPSBhc3QubGVmdC5jb25zdGFudCAmJiBhc3QucmlnaHQuY29uc3RhbnQ7XG5cdCAgICBhc3QudG9XYXRjaCA9IGFzdC5jb25zdGFudCA/IFtdIDogW2FzdF07XG5cdCAgICBicmVhaztcblx0ICBjYXNlIEFTVC5Db25kaXRpb25hbEV4cHJlc3Npb246XG5cdCAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGFzdC50ZXN0LCAkZmlsdGVyKTtcblx0ICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LmFsdGVybmF0ZSwgJGZpbHRlcik7XG5cdCAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGFzdC5jb25zZXF1ZW50LCAkZmlsdGVyKTtcblx0ICAgIGFzdC5jb25zdGFudCA9IGFzdC50ZXN0LmNvbnN0YW50ICYmIGFzdC5hbHRlcm5hdGUuY29uc3RhbnQgJiYgYXN0LmNvbnNlcXVlbnQuY29uc3RhbnQ7XG5cdCAgICBhc3QudG9XYXRjaCA9IGFzdC5jb25zdGFudCA/IFtdIDogW2FzdF07XG5cdCAgICBicmVhaztcblx0ICBjYXNlIEFTVC5JZGVudGlmaWVyOlxuXHQgICAgYXN0LmNvbnN0YW50ID0gZmFsc2U7XG5cdCAgICBhc3QudG9XYXRjaCA9IFthc3RdO1xuXHQgICAgYnJlYWs7XG5cdCAgY2FzZSBBU1QuTWVtYmVyRXhwcmVzc2lvbjpcblx0ICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0Lm9iamVjdCwgJGZpbHRlcik7XG5cdCAgICBpZiAoYXN0LmNvbXB1dGVkKSB7XG5cdCAgICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LnByb3BlcnR5LCAkZmlsdGVyKTtcblx0ICAgIH1cblx0ICAgIGFzdC5jb25zdGFudCA9IGFzdC5vYmplY3QuY29uc3RhbnQgJiYgKCFhc3QuY29tcHV0ZWQgfHwgYXN0LnByb3BlcnR5LmNvbnN0YW50KTtcblx0ICAgIGFzdC50b1dhdGNoID0gW2FzdF07XG5cdCAgICBicmVhaztcblx0ICBjYXNlIEFTVC5DYWxsRXhwcmVzc2lvbjpcblx0ICAgIGFsbENvbnN0YW50cyA9IGFzdC5maWx0ZXIgPyBpc1N0YXRlbGVzcygkZmlsdGVyLCBhc3QuY2FsbGVlLm5hbWUpIDogZmFsc2U7XG5cdCAgICBhcmdzVG9XYXRjaCA9IFtdO1xuXHQgICAgZm9yRWFjaChhc3QuYXJndW1lbnRzLCBmdW5jdGlvbihleHByKSB7XG5cdCAgICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoZXhwciwgJGZpbHRlcik7XG5cdCAgICAgIGFsbENvbnN0YW50cyA9IGFsbENvbnN0YW50cyAmJiBleHByLmNvbnN0YW50O1xuXHQgICAgICBpZiAoIWV4cHIuY29uc3RhbnQpIHtcblx0ICAgICAgICBhcmdzVG9XYXRjaC5wdXNoLmFwcGx5KGFyZ3NUb1dhdGNoLCBleHByLnRvV2F0Y2gpO1xuXHQgICAgICB9XG5cdCAgICB9KTtcblx0ICAgIGFzdC5jb25zdGFudCA9IGFsbENvbnN0YW50cztcblx0ICAgIGFzdC50b1dhdGNoID0gYXN0LmZpbHRlciAmJiBpc1N0YXRlbGVzcygkZmlsdGVyLCBhc3QuY2FsbGVlLm5hbWUpID8gYXJnc1RvV2F0Y2ggOiBbYXN0XTtcblx0ICAgIGJyZWFrO1xuXHQgIGNhc2UgQVNULkFzc2lnbm1lbnRFeHByZXNzaW9uOlxuXHQgICAgZmluZENvbnN0YW50QW5kV2F0Y2hFeHByZXNzaW9ucyhhc3QubGVmdCwgJGZpbHRlcik7XG5cdCAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGFzdC5yaWdodCwgJGZpbHRlcik7XG5cdCAgICBhc3QuY29uc3RhbnQgPSBhc3QubGVmdC5jb25zdGFudCAmJiBhc3QucmlnaHQuY29uc3RhbnQ7XG5cdCAgICBhc3QudG9XYXRjaCA9IFthc3RdO1xuXHQgICAgYnJlYWs7XG5cdCAgY2FzZSBBU1QuQXJyYXlFeHByZXNzaW9uOlxuXHQgICAgYWxsQ29uc3RhbnRzID0gdHJ1ZTtcblx0ICAgIGFyZ3NUb1dhdGNoID0gW107XG5cdCAgICBmb3JFYWNoKGFzdC5lbGVtZW50cywgZnVuY3Rpb24oZXhwcikge1xuXHQgICAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGV4cHIsICRmaWx0ZXIpO1xuXHQgICAgICBhbGxDb25zdGFudHMgPSBhbGxDb25zdGFudHMgJiYgZXhwci5jb25zdGFudDtcblx0ICAgICAgaWYgKCFleHByLmNvbnN0YW50KSB7XG5cdCAgICAgICAgYXJnc1RvV2F0Y2gucHVzaC5hcHBseShhcmdzVG9XYXRjaCwgZXhwci50b1dhdGNoKTtcblx0ICAgICAgfVxuXHQgICAgfSk7XG5cdCAgICBhc3QuY29uc3RhbnQgPSBhbGxDb25zdGFudHM7XG5cdCAgICBhc3QudG9XYXRjaCA9IGFyZ3NUb1dhdGNoO1xuXHQgICAgYnJlYWs7XG5cdCAgY2FzZSBBU1QuT2JqZWN0RXhwcmVzc2lvbjpcblx0ICAgIGFsbENvbnN0YW50cyA9IHRydWU7XG5cdCAgICBhcmdzVG9XYXRjaCA9IFtdO1xuXHQgICAgZm9yRWFjaChhc3QucHJvcGVydGllcywgZnVuY3Rpb24ocHJvcGVydHkpIHtcblx0ICAgICAgZmluZENvbnN0YW50QW5kV2F0Y2hFeHByZXNzaW9ucyhwcm9wZXJ0eS52YWx1ZSwgJGZpbHRlcik7XG5cdCAgICAgIGFsbENvbnN0YW50cyA9IGFsbENvbnN0YW50cyAmJiBwcm9wZXJ0eS52YWx1ZS5jb25zdGFudDtcblx0ICAgICAgaWYgKCFwcm9wZXJ0eS52YWx1ZS5jb25zdGFudCkge1xuXHQgICAgICAgIGFyZ3NUb1dhdGNoLnB1c2guYXBwbHkoYXJnc1RvV2F0Y2gsIHByb3BlcnR5LnZhbHVlLnRvV2F0Y2gpO1xuXHQgICAgICB9XG5cdCAgICB9KTtcblx0ICAgIGFzdC5jb25zdGFudCA9IGFsbENvbnN0YW50cztcblx0ICAgIGFzdC50b1dhdGNoID0gYXJnc1RvV2F0Y2g7XG5cdCAgICBicmVhaztcblx0ICBjYXNlIEFTVC5UaGlzRXhwcmVzc2lvbjpcblx0ICAgIGFzdC5jb25zdGFudCA9IGZhbHNlO1xuXHQgICAgYXN0LnRvV2F0Y2ggPSBbXTtcblx0ICAgIGJyZWFrO1xuXHQgIGNhc2UgQVNULkxvY2Fsc0V4cHJlc3Npb246XG5cdCAgICBhc3QuY29uc3RhbnQgPSBmYWxzZTtcblx0ICAgIGFzdC50b1dhdGNoID0gW107XG5cdCAgICBicmVhaztcblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGdldElucHV0cyhib2R5KSB7XG5cdCAgaWYgKGJvZHkubGVuZ3RoICE9IDEpIHJldHVybjtcblx0ICB2YXIgbGFzdEV4cHJlc3Npb24gPSBib2R5WzBdLmV4cHJlc3Npb247XG5cdCAgdmFyIGNhbmRpZGF0ZSA9IGxhc3RFeHByZXNzaW9uLnRvV2F0Y2g7XG5cdCAgaWYgKGNhbmRpZGF0ZS5sZW5ndGggIT09IDEpIHJldHVybiBjYW5kaWRhdGU7XG5cdCAgcmV0dXJuIGNhbmRpZGF0ZVswXSAhPT0gbGFzdEV4cHJlc3Npb24gPyBjYW5kaWRhdGUgOiB1bmRlZmluZWQ7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGlzQXNzaWduYWJsZShhc3QpIHtcblx0ICByZXR1cm4gYXN0LnR5cGUgPT09IEFTVC5JZGVudGlmaWVyIHx8IGFzdC50eXBlID09PSBBU1QuTWVtYmVyRXhwcmVzc2lvbjtcblx0fVxuXHRcblx0ZnVuY3Rpb24gYXNzaWduYWJsZUFTVChhc3QpIHtcblx0ICBpZiAoYXN0LmJvZHkubGVuZ3RoID09PSAxICYmIGlzQXNzaWduYWJsZShhc3QuYm9keVswXS5leHByZXNzaW9uKSkge1xuXHQgICAgcmV0dXJuIHt0eXBlOiBBU1QuQXNzaWdubWVudEV4cHJlc3Npb24sIGxlZnQ6IGFzdC5ib2R5WzBdLmV4cHJlc3Npb24sIHJpZ2h0OiB7dHlwZTogQVNULk5HVmFsdWVQYXJhbWV0ZXJ9LCBvcGVyYXRvcjogJz0nfTtcblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGlzTGl0ZXJhbChhc3QpIHtcblx0ICByZXR1cm4gYXN0LmJvZHkubGVuZ3RoID09PSAwIHx8XG5cdCAgICAgIGFzdC5ib2R5Lmxlbmd0aCA9PT0gMSAmJiAoXG5cdCAgICAgIGFzdC5ib2R5WzBdLmV4cHJlc3Npb24udHlwZSA9PT0gQVNULkxpdGVyYWwgfHxcblx0ICAgICAgYXN0LmJvZHlbMF0uZXhwcmVzc2lvbi50eXBlID09PSBBU1QuQXJyYXlFeHByZXNzaW9uIHx8XG5cdCAgICAgIGFzdC5ib2R5WzBdLmV4cHJlc3Npb24udHlwZSA9PT0gQVNULk9iamVjdEV4cHJlc3Npb24pO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBpc0NvbnN0YW50KGFzdCkge1xuXHQgIHJldHVybiBhc3QuY29uc3RhbnQ7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIEFTVENvbXBpbGVyKGFzdEJ1aWxkZXIsICRmaWx0ZXIpIHtcblx0ICB0aGlzLmFzdEJ1aWxkZXIgPSBhc3RCdWlsZGVyO1xuXHQgIHRoaXMuJGZpbHRlciA9ICRmaWx0ZXI7XG5cdH1cblx0XG5cdEFTVENvbXBpbGVyLnByb3RvdHlwZSA9IHtcblx0ICBjb21waWxlOiBmdW5jdGlvbihleHByZXNzaW9uLCBleHBlbnNpdmVDaGVja3MpIHtcblx0ICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgIHZhciBhc3QgPSB0aGlzLmFzdEJ1aWxkZXIuYXN0KGV4cHJlc3Npb24pO1xuXHQgICAgdGhpcy5zdGF0ZSA9IHtcblx0ICAgICAgbmV4dElkOiAwLFxuXHQgICAgICBmaWx0ZXJzOiB7fSxcblx0ICAgICAgZXhwZW5zaXZlQ2hlY2tzOiBleHBlbnNpdmVDaGVja3MsXG5cdCAgICAgIGZuOiB7dmFyczogW10sIGJvZHk6IFtdLCBvd246IHt9fSxcblx0ICAgICAgYXNzaWduOiB7dmFyczogW10sIGJvZHk6IFtdLCBvd246IHt9fSxcblx0ICAgICAgaW5wdXRzOiBbXVxuXHQgICAgfTtcblx0ICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LCBzZWxmLiRmaWx0ZXIpO1xuXHQgICAgdmFyIGV4dHJhID0gJyc7XG5cdCAgICB2YXIgYXNzaWduYWJsZTtcblx0ICAgIHRoaXMuc3RhZ2UgPSAnYXNzaWduJztcblx0ICAgIGlmICgoYXNzaWduYWJsZSA9IGFzc2lnbmFibGVBU1QoYXN0KSkpIHtcblx0ICAgICAgdGhpcy5zdGF0ZS5jb21wdXRpbmcgPSAnYXNzaWduJztcblx0ICAgICAgdmFyIHJlc3VsdCA9IHRoaXMubmV4dElkKCk7XG5cdCAgICAgIHRoaXMucmVjdXJzZShhc3NpZ25hYmxlLCByZXN1bHQpO1xuXHQgICAgICB0aGlzLnJldHVybl8ocmVzdWx0KTtcblx0ICAgICAgZXh0cmEgPSAnZm4uYXNzaWduPScgKyB0aGlzLmdlbmVyYXRlRnVuY3Rpb24oJ2Fzc2lnbicsICdzLHYsbCcpO1xuXHQgICAgfVxuXHQgICAgdmFyIHRvV2F0Y2ggPSBnZXRJbnB1dHMoYXN0LmJvZHkpO1xuXHQgICAgc2VsZi5zdGFnZSA9ICdpbnB1dHMnO1xuXHQgICAgZm9yRWFjaCh0b1dhdGNoLCBmdW5jdGlvbih3YXRjaCwga2V5KSB7XG5cdCAgICAgIHZhciBmbktleSA9ICdmbicgKyBrZXk7XG5cdCAgICAgIHNlbGYuc3RhdGVbZm5LZXldID0ge3ZhcnM6IFtdLCBib2R5OiBbXSwgb3duOiB7fX07XG5cdCAgICAgIHNlbGYuc3RhdGUuY29tcHV0aW5nID0gZm5LZXk7XG5cdCAgICAgIHZhciBpbnRvSWQgPSBzZWxmLm5leHRJZCgpO1xuXHQgICAgICBzZWxmLnJlY3Vyc2Uod2F0Y2gsIGludG9JZCk7XG5cdCAgICAgIHNlbGYucmV0dXJuXyhpbnRvSWQpO1xuXHQgICAgICBzZWxmLnN0YXRlLmlucHV0cy5wdXNoKGZuS2V5KTtcblx0ICAgICAgd2F0Y2gud2F0Y2hJZCA9IGtleTtcblx0ICAgIH0pO1xuXHQgICAgdGhpcy5zdGF0ZS5jb21wdXRpbmcgPSAnZm4nO1xuXHQgICAgdGhpcy5zdGFnZSA9ICdtYWluJztcblx0ICAgIHRoaXMucmVjdXJzZShhc3QpO1xuXHQgICAgdmFyIGZuU3RyaW5nID1cblx0ICAgICAgLy8gVGhlIGJ1aWxkIGFuZCBtaW5pZmljYXRpb24gc3RlcHMgcmVtb3ZlIHRoZSBzdHJpbmcgXCJ1c2Ugc3RyaWN0XCIgZnJvbSB0aGUgY29kZSwgYnV0IHRoaXMgaXMgZG9uZSB1c2luZyBhIHJlZ2V4LlxuXHQgICAgICAvLyBUaGlzIGlzIGEgd29ya2Fyb3VuZCBmb3IgdGhpcyB1bnRpbCB3ZSBkbyBhIGJldHRlciBqb2IgYXQgb25seSByZW1vdmluZyB0aGUgcHJlZml4IG9ubHkgd2hlbiB3ZSBzaG91bGQuXG5cdCAgICAgICdcIicgKyB0aGlzLlVTRSArICcgJyArIHRoaXMuU1RSSUNUICsgJ1wiO1xcbicgK1xuXHQgICAgICB0aGlzLmZpbHRlclByZWZpeCgpICtcblx0ICAgICAgJ3ZhciBmbj0nICsgdGhpcy5nZW5lcmF0ZUZ1bmN0aW9uKCdmbicsICdzLGwsYSxpJykgK1xuXHQgICAgICBleHRyYSArXG5cdCAgICAgIHRoaXMud2F0Y2hGbnMoKSArXG5cdCAgICAgICdyZXR1cm4gZm47Jztcblx0XG5cdCAgICAvKiBqc2hpbnQgLVcwNTQgKi9cblx0ICAgIHZhciBmbiA9IChuZXcgRnVuY3Rpb24oJyRmaWx0ZXInLFxuXHQgICAgICAgICdlbnN1cmVTYWZlTWVtYmVyTmFtZScsXG5cdCAgICAgICAgJ2Vuc3VyZVNhZmVPYmplY3QnLFxuXHQgICAgICAgICdlbnN1cmVTYWZlRnVuY3Rpb24nLFxuXHQgICAgICAgICdnZXRTdHJpbmdWYWx1ZScsXG5cdCAgICAgICAgJ2Vuc3VyZVNhZmVBc3NpZ25Db250ZXh0Jyxcblx0ICAgICAgICAnaWZEZWZpbmVkJyxcblx0ICAgICAgICAncGx1cycsXG5cdCAgICAgICAgJ3RleHQnLFxuXHQgICAgICAgIGZuU3RyaW5nKSkoXG5cdCAgICAgICAgICB0aGlzLiRmaWx0ZXIsXG5cdCAgICAgICAgICBlbnN1cmVTYWZlTWVtYmVyTmFtZSxcblx0ICAgICAgICAgIGVuc3VyZVNhZmVPYmplY3QsXG5cdCAgICAgICAgICBlbnN1cmVTYWZlRnVuY3Rpb24sXG5cdCAgICAgICAgICBnZXRTdHJpbmdWYWx1ZSxcblx0ICAgICAgICAgIGVuc3VyZVNhZmVBc3NpZ25Db250ZXh0LFxuXHQgICAgICAgICAgaWZEZWZpbmVkLFxuXHQgICAgICAgICAgcGx1c0ZuLFxuXHQgICAgICAgICAgZXhwcmVzc2lvbik7XG5cdCAgICAvKiBqc2hpbnQgK1cwNTQgKi9cblx0ICAgIHRoaXMuc3RhdGUgPSB0aGlzLnN0YWdlID0gdW5kZWZpbmVkO1xuXHQgICAgZm4ubGl0ZXJhbCA9IGlzTGl0ZXJhbChhc3QpO1xuXHQgICAgZm4uY29uc3RhbnQgPSBpc0NvbnN0YW50KGFzdCk7XG5cdCAgICByZXR1cm4gZm47XG5cdCAgfSxcblx0XG5cdCAgVVNFOiAndXNlJyxcblx0XG5cdCAgU1RSSUNUOiAnc3RyaWN0Jyxcblx0XG5cdCAgd2F0Y2hGbnM6IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIHJlc3VsdCA9IFtdO1xuXHQgICAgdmFyIGZucyA9IHRoaXMuc3RhdGUuaW5wdXRzO1xuXHQgICAgdmFyIHNlbGYgPSB0aGlzO1xuXHQgICAgZm9yRWFjaChmbnMsIGZ1bmN0aW9uKG5hbWUpIHtcblx0ICAgICAgcmVzdWx0LnB1c2goJ3ZhciAnICsgbmFtZSArICc9JyArIHNlbGYuZ2VuZXJhdGVGdW5jdGlvbihuYW1lLCAncycpKTtcblx0ICAgIH0pO1xuXHQgICAgaWYgKGZucy5sZW5ndGgpIHtcblx0ICAgICAgcmVzdWx0LnB1c2goJ2ZuLmlucHV0cz1bJyArIGZucy5qb2luKCcsJykgKyAnXTsnKTtcblx0ICAgIH1cblx0ICAgIHJldHVybiByZXN1bHQuam9pbignJyk7XG5cdCAgfSxcblx0XG5cdCAgZ2VuZXJhdGVGdW5jdGlvbjogZnVuY3Rpb24obmFtZSwgcGFyYW1zKSB7XG5cdCAgICByZXR1cm4gJ2Z1bmN0aW9uKCcgKyBwYXJhbXMgKyAnKXsnICtcblx0ICAgICAgICB0aGlzLnZhcnNQcmVmaXgobmFtZSkgK1xuXHQgICAgICAgIHRoaXMuYm9keShuYW1lKSArXG5cdCAgICAgICAgJ307Jztcblx0ICB9LFxuXHRcblx0ICBmaWx0ZXJQcmVmaXg6IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIHBhcnRzID0gW107XG5cdCAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAgICBmb3JFYWNoKHRoaXMuc3RhdGUuZmlsdGVycywgZnVuY3Rpb24oaWQsIGZpbHRlcikge1xuXHQgICAgICBwYXJ0cy5wdXNoKGlkICsgJz0kZmlsdGVyKCcgKyBzZWxmLmVzY2FwZShmaWx0ZXIpICsgJyknKTtcblx0ICAgIH0pO1xuXHQgICAgaWYgKHBhcnRzLmxlbmd0aCkgcmV0dXJuICd2YXIgJyArIHBhcnRzLmpvaW4oJywnKSArICc7Jztcblx0ICAgIHJldHVybiAnJztcblx0ICB9LFxuXHRcblx0ICB2YXJzUHJlZml4OiBmdW5jdGlvbihzZWN0aW9uKSB7XG5cdCAgICByZXR1cm4gdGhpcy5zdGF0ZVtzZWN0aW9uXS52YXJzLmxlbmd0aCA/ICd2YXIgJyArIHRoaXMuc3RhdGVbc2VjdGlvbl0udmFycy5qb2luKCcsJykgKyAnOycgOiAnJztcblx0ICB9LFxuXHRcblx0ICBib2R5OiBmdW5jdGlvbihzZWN0aW9uKSB7XG5cdCAgICByZXR1cm4gdGhpcy5zdGF0ZVtzZWN0aW9uXS5ib2R5LmpvaW4oJycpO1xuXHQgIH0sXG5cdFxuXHQgIHJlY3Vyc2U6IGZ1bmN0aW9uKGFzdCwgaW50b0lkLCBuYW1lSWQsIHJlY3Vyc2lvbkZuLCBjcmVhdGUsIHNraXBXYXRjaElkQ2hlY2spIHtcblx0ICAgIHZhciBsZWZ0LCByaWdodCwgc2VsZiA9IHRoaXMsIGFyZ3MsIGV4cHJlc3Npb247XG5cdCAgICByZWN1cnNpb25GbiA9IHJlY3Vyc2lvbkZuIHx8IG5vb3A7XG5cdCAgICBpZiAoIXNraXBXYXRjaElkQ2hlY2sgJiYgaXNEZWZpbmVkKGFzdC53YXRjaElkKSkge1xuXHQgICAgICBpbnRvSWQgPSBpbnRvSWQgfHwgdGhpcy5uZXh0SWQoKTtcblx0ICAgICAgdGhpcy5pZl8oJ2knLFxuXHQgICAgICAgIHRoaXMubGF6eUFzc2lnbihpbnRvSWQsIHRoaXMuY29tcHV0ZWRNZW1iZXIoJ2knLCBhc3Qud2F0Y2hJZCkpLFxuXHQgICAgICAgIHRoaXMubGF6eVJlY3Vyc2UoYXN0LCBpbnRvSWQsIG5hbWVJZCwgcmVjdXJzaW9uRm4sIGNyZWF0ZSwgdHJ1ZSlcblx0ICAgICAgKTtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHQgICAgc3dpdGNoIChhc3QudHlwZSkge1xuXHQgICAgY2FzZSBBU1QuUHJvZ3JhbTpcblx0ICAgICAgZm9yRWFjaChhc3QuYm9keSwgZnVuY3Rpb24oZXhwcmVzc2lvbiwgcG9zKSB7XG5cdCAgICAgICAgc2VsZi5yZWN1cnNlKGV4cHJlc3Npb24uZXhwcmVzc2lvbiwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGZ1bmN0aW9uKGV4cHIpIHsgcmlnaHQgPSBleHByOyB9KTtcblx0ICAgICAgICBpZiAocG9zICE9PSBhc3QuYm9keS5sZW5ndGggLSAxKSB7XG5cdCAgICAgICAgICBzZWxmLmN1cnJlbnQoKS5ib2R5LnB1c2gocmlnaHQsICc7Jyk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHNlbGYucmV0dXJuXyhyaWdodCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0ICAgICAgYnJlYWs7XG5cdCAgICBjYXNlIEFTVC5MaXRlcmFsOlxuXHQgICAgICBleHByZXNzaW9uID0gdGhpcy5lc2NhcGUoYXN0LnZhbHVlKTtcblx0ICAgICAgdGhpcy5hc3NpZ24oaW50b0lkLCBleHByZXNzaW9uKTtcblx0ICAgICAgcmVjdXJzaW9uRm4oZXhwcmVzc2lvbik7XG5cdCAgICAgIGJyZWFrO1xuXHQgICAgY2FzZSBBU1QuVW5hcnlFeHByZXNzaW9uOlxuXHQgICAgICB0aGlzLnJlY3Vyc2UoYXN0LmFyZ3VtZW50LCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgZnVuY3Rpb24oZXhwcikgeyByaWdodCA9IGV4cHI7IH0pO1xuXHQgICAgICBleHByZXNzaW9uID0gYXN0Lm9wZXJhdG9yICsgJygnICsgdGhpcy5pZkRlZmluZWQocmlnaHQsIDApICsgJyknO1xuXHQgICAgICB0aGlzLmFzc2lnbihpbnRvSWQsIGV4cHJlc3Npb24pO1xuXHQgICAgICByZWN1cnNpb25GbihleHByZXNzaW9uKTtcblx0ICAgICAgYnJlYWs7XG5cdCAgICBjYXNlIEFTVC5CaW5hcnlFeHByZXNzaW9uOlxuXHQgICAgICB0aGlzLnJlY3Vyc2UoYXN0LmxlZnQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBmdW5jdGlvbihleHByKSB7IGxlZnQgPSBleHByOyB9KTtcblx0ICAgICAgdGhpcy5yZWN1cnNlKGFzdC5yaWdodCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGZ1bmN0aW9uKGV4cHIpIHsgcmlnaHQgPSBleHByOyB9KTtcblx0ICAgICAgaWYgKGFzdC5vcGVyYXRvciA9PT0gJysnKSB7XG5cdCAgICAgICAgZXhwcmVzc2lvbiA9IHRoaXMucGx1cyhsZWZ0LCByaWdodCk7XG5cdCAgICAgIH0gZWxzZSBpZiAoYXN0Lm9wZXJhdG9yID09PSAnLScpIHtcblx0ICAgICAgICBleHByZXNzaW9uID0gdGhpcy5pZkRlZmluZWQobGVmdCwgMCkgKyBhc3Qub3BlcmF0b3IgKyB0aGlzLmlmRGVmaW5lZChyaWdodCwgMCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgZXhwcmVzc2lvbiA9ICcoJyArIGxlZnQgKyAnKScgKyBhc3Qub3BlcmF0b3IgKyAnKCcgKyByaWdodCArICcpJztcblx0ICAgICAgfVxuXHQgICAgICB0aGlzLmFzc2lnbihpbnRvSWQsIGV4cHJlc3Npb24pO1xuXHQgICAgICByZWN1cnNpb25GbihleHByZXNzaW9uKTtcblx0ICAgICAgYnJlYWs7XG5cdCAgICBjYXNlIEFTVC5Mb2dpY2FsRXhwcmVzc2lvbjpcblx0ICAgICAgaW50b0lkID0gaW50b0lkIHx8IHRoaXMubmV4dElkKCk7XG5cdCAgICAgIHNlbGYucmVjdXJzZShhc3QubGVmdCwgaW50b0lkKTtcblx0ICAgICAgc2VsZi5pZl8oYXN0Lm9wZXJhdG9yID09PSAnJiYnID8gaW50b0lkIDogc2VsZi5ub3QoaW50b0lkKSwgc2VsZi5sYXp5UmVjdXJzZShhc3QucmlnaHQsIGludG9JZCkpO1xuXHQgICAgICByZWN1cnNpb25GbihpbnRvSWQpO1xuXHQgICAgICBicmVhaztcblx0ICAgIGNhc2UgQVNULkNvbmRpdGlvbmFsRXhwcmVzc2lvbjpcblx0ICAgICAgaW50b0lkID0gaW50b0lkIHx8IHRoaXMubmV4dElkKCk7XG5cdCAgICAgIHNlbGYucmVjdXJzZShhc3QudGVzdCwgaW50b0lkKTtcblx0ICAgICAgc2VsZi5pZl8oaW50b0lkLCBzZWxmLmxhenlSZWN1cnNlKGFzdC5hbHRlcm5hdGUsIGludG9JZCksIHNlbGYubGF6eVJlY3Vyc2UoYXN0LmNvbnNlcXVlbnQsIGludG9JZCkpO1xuXHQgICAgICByZWN1cnNpb25GbihpbnRvSWQpO1xuXHQgICAgICBicmVhaztcblx0ICAgIGNhc2UgQVNULklkZW50aWZpZXI6XG5cdCAgICAgIGludG9JZCA9IGludG9JZCB8fCB0aGlzLm5leHRJZCgpO1xuXHQgICAgICBpZiAobmFtZUlkKSB7XG5cdCAgICAgICAgbmFtZUlkLmNvbnRleHQgPSBzZWxmLnN0YWdlID09PSAnaW5wdXRzJyA/ICdzJyA6IHRoaXMuYXNzaWduKHRoaXMubmV4dElkKCksIHRoaXMuZ2V0SGFzT3duUHJvcGVydHkoJ2wnLCBhc3QubmFtZSkgKyAnP2w6cycpO1xuXHQgICAgICAgIG5hbWVJZC5jb21wdXRlZCA9IGZhbHNlO1xuXHQgICAgICAgIG5hbWVJZC5uYW1lID0gYXN0Lm5hbWU7XG5cdCAgICAgIH1cblx0ICAgICAgZW5zdXJlU2FmZU1lbWJlck5hbWUoYXN0Lm5hbWUpO1xuXHQgICAgICBzZWxmLmlmXyhzZWxmLnN0YWdlID09PSAnaW5wdXRzJyB8fCBzZWxmLm5vdChzZWxmLmdldEhhc093blByb3BlcnR5KCdsJywgYXN0Lm5hbWUpKSxcblx0ICAgICAgICBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHNlbGYuaWZfKHNlbGYuc3RhZ2UgPT09ICdpbnB1dHMnIHx8ICdzJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGlmIChjcmVhdGUgJiYgY3JlYXRlICE9PSAxKSB7XG5cdCAgICAgICAgICAgICAgc2VsZi5pZl8oXG5cdCAgICAgICAgICAgICAgICBzZWxmLm5vdChzZWxmLm5vbkNvbXB1dGVkTWVtYmVyKCdzJywgYXN0Lm5hbWUpKSxcblx0ICAgICAgICAgICAgICAgIHNlbGYubGF6eUFzc2lnbihzZWxmLm5vbkNvbXB1dGVkTWVtYmVyKCdzJywgYXN0Lm5hbWUpLCAne30nKSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgc2VsZi5hc3NpZ24oaW50b0lkLCBzZWxmLm5vbkNvbXB1dGVkTWVtYmVyKCdzJywgYXN0Lm5hbWUpKTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH0sIGludG9JZCAmJiBzZWxmLmxhenlBc3NpZ24oaW50b0lkLCBzZWxmLm5vbkNvbXB1dGVkTWVtYmVyKCdsJywgYXN0Lm5hbWUpKVxuXHQgICAgICAgICk7XG5cdCAgICAgIGlmIChzZWxmLnN0YXRlLmV4cGVuc2l2ZUNoZWNrcyB8fCBpc1Bvc3NpYmx5RGFuZ2Vyb3VzTWVtYmVyTmFtZShhc3QubmFtZSkpIHtcblx0ICAgICAgICBzZWxmLmFkZEVuc3VyZVNhZmVPYmplY3QoaW50b0lkKTtcblx0ICAgICAgfVxuXHQgICAgICByZWN1cnNpb25GbihpbnRvSWQpO1xuXHQgICAgICBicmVhaztcblx0ICAgIGNhc2UgQVNULk1lbWJlckV4cHJlc3Npb246XG5cdCAgICAgIGxlZnQgPSBuYW1lSWQgJiYgKG5hbWVJZC5jb250ZXh0ID0gdGhpcy5uZXh0SWQoKSkgfHwgdGhpcy5uZXh0SWQoKTtcblx0ICAgICAgaW50b0lkID0gaW50b0lkIHx8IHRoaXMubmV4dElkKCk7XG5cdCAgICAgIHNlbGYucmVjdXJzZShhc3Qub2JqZWN0LCBsZWZ0LCB1bmRlZmluZWQsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHNlbGYuaWZfKHNlbGYubm90TnVsbChsZWZ0KSwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBpZiAoY3JlYXRlICYmIGNyZWF0ZSAhPT0gMSkge1xuXHQgICAgICAgICAgICBzZWxmLmFkZEVuc3VyZVNhZmVBc3NpZ25Db250ZXh0KGxlZnQpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgaWYgKGFzdC5jb21wdXRlZCkge1xuXHQgICAgICAgICAgICByaWdodCA9IHNlbGYubmV4dElkKCk7XG5cdCAgICAgICAgICAgIHNlbGYucmVjdXJzZShhc3QucHJvcGVydHksIHJpZ2h0KTtcblx0ICAgICAgICAgICAgc2VsZi5nZXRTdHJpbmdWYWx1ZShyaWdodCk7XG5cdCAgICAgICAgICAgIHNlbGYuYWRkRW5zdXJlU2FmZU1lbWJlck5hbWUocmlnaHQpO1xuXHQgICAgICAgICAgICBpZiAoY3JlYXRlICYmIGNyZWF0ZSAhPT0gMSkge1xuXHQgICAgICAgICAgICAgIHNlbGYuaWZfKHNlbGYubm90KHNlbGYuY29tcHV0ZWRNZW1iZXIobGVmdCwgcmlnaHQpKSwgc2VsZi5sYXp5QXNzaWduKHNlbGYuY29tcHV0ZWRNZW1iZXIobGVmdCwgcmlnaHQpLCAne30nKSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgZXhwcmVzc2lvbiA9IHNlbGYuZW5zdXJlU2FmZU9iamVjdChzZWxmLmNvbXB1dGVkTWVtYmVyKGxlZnQsIHJpZ2h0KSk7XG5cdCAgICAgICAgICAgIHNlbGYuYXNzaWduKGludG9JZCwgZXhwcmVzc2lvbik7XG5cdCAgICAgICAgICAgIGlmIChuYW1lSWQpIHtcblx0ICAgICAgICAgICAgICBuYW1lSWQuY29tcHV0ZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICAgIG5hbWVJZC5uYW1lID0gcmlnaHQ7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGVuc3VyZVNhZmVNZW1iZXJOYW1lKGFzdC5wcm9wZXJ0eS5uYW1lKTtcblx0ICAgICAgICAgICAgaWYgKGNyZWF0ZSAmJiBjcmVhdGUgIT09IDEpIHtcblx0ICAgICAgICAgICAgICBzZWxmLmlmXyhzZWxmLm5vdChzZWxmLm5vbkNvbXB1dGVkTWVtYmVyKGxlZnQsIGFzdC5wcm9wZXJ0eS5uYW1lKSksIHNlbGYubGF6eUFzc2lnbihzZWxmLm5vbkNvbXB1dGVkTWVtYmVyKGxlZnQsIGFzdC5wcm9wZXJ0eS5uYW1lKSwgJ3t9JykpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGV4cHJlc3Npb24gPSBzZWxmLm5vbkNvbXB1dGVkTWVtYmVyKGxlZnQsIGFzdC5wcm9wZXJ0eS5uYW1lKTtcblx0ICAgICAgICAgICAgaWYgKHNlbGYuc3RhdGUuZXhwZW5zaXZlQ2hlY2tzIHx8IGlzUG9zc2libHlEYW5nZXJvdXNNZW1iZXJOYW1lKGFzdC5wcm9wZXJ0eS5uYW1lKSkge1xuXHQgICAgICAgICAgICAgIGV4cHJlc3Npb24gPSBzZWxmLmVuc3VyZVNhZmVPYmplY3QoZXhwcmVzc2lvbik7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgc2VsZi5hc3NpZ24oaW50b0lkLCBleHByZXNzaW9uKTtcblx0ICAgICAgICAgICAgaWYgKG5hbWVJZCkge1xuXHQgICAgICAgICAgICAgIG5hbWVJZC5jb21wdXRlZCA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgIG5hbWVJZC5uYW1lID0gYXN0LnByb3BlcnR5Lm5hbWU7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9LCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHNlbGYuYXNzaWduKGludG9JZCwgJ3VuZGVmaW5lZCcpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHJlY3Vyc2lvbkZuKGludG9JZCk7XG5cdCAgICAgIH0sICEhY3JlYXRlKTtcblx0ICAgICAgYnJlYWs7XG5cdCAgICBjYXNlIEFTVC5DYWxsRXhwcmVzc2lvbjpcblx0ICAgICAgaW50b0lkID0gaW50b0lkIHx8IHRoaXMubmV4dElkKCk7XG5cdCAgICAgIGlmIChhc3QuZmlsdGVyKSB7XG5cdCAgICAgICAgcmlnaHQgPSBzZWxmLmZpbHRlcihhc3QuY2FsbGVlLm5hbWUpO1xuXHQgICAgICAgIGFyZ3MgPSBbXTtcblx0ICAgICAgICBmb3JFYWNoKGFzdC5hcmd1bWVudHMsIGZ1bmN0aW9uKGV4cHIpIHtcblx0ICAgICAgICAgIHZhciBhcmd1bWVudCA9IHNlbGYubmV4dElkKCk7XG5cdCAgICAgICAgICBzZWxmLnJlY3Vyc2UoZXhwciwgYXJndW1lbnQpO1xuXHQgICAgICAgICAgYXJncy5wdXNoKGFyZ3VtZW50KTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgICBleHByZXNzaW9uID0gcmlnaHQgKyAnKCcgKyBhcmdzLmpvaW4oJywnKSArICcpJztcblx0ICAgICAgICBzZWxmLmFzc2lnbihpbnRvSWQsIGV4cHJlc3Npb24pO1xuXHQgICAgICAgIHJlY3Vyc2lvbkZuKGludG9JZCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmlnaHQgPSBzZWxmLm5leHRJZCgpO1xuXHQgICAgICAgIGxlZnQgPSB7fTtcblx0ICAgICAgICBhcmdzID0gW107XG5cdCAgICAgICAgc2VsZi5yZWN1cnNlKGFzdC5jYWxsZWUsIHJpZ2h0LCBsZWZ0LCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHNlbGYuaWZfKHNlbGYubm90TnVsbChyaWdodCksIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBzZWxmLmFkZEVuc3VyZVNhZmVGdW5jdGlvbihyaWdodCk7XG5cdCAgICAgICAgICAgIGZvckVhY2goYXN0LmFyZ3VtZW50cywgZnVuY3Rpb24oZXhwcikge1xuXHQgICAgICAgICAgICAgIHNlbGYucmVjdXJzZShleHByLCBzZWxmLm5leHRJZCgpLCB1bmRlZmluZWQsIGZ1bmN0aW9uKGFyZ3VtZW50KSB7XG5cdCAgICAgICAgICAgICAgICBhcmdzLnB1c2goc2VsZi5lbnN1cmVTYWZlT2JqZWN0KGFyZ3VtZW50KSk7XG5cdCAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICBpZiAobGVmdC5uYW1lKSB7XG5cdCAgICAgICAgICAgICAgaWYgKCFzZWxmLnN0YXRlLmV4cGVuc2l2ZUNoZWNrcykge1xuXHQgICAgICAgICAgICAgICAgc2VsZi5hZGRFbnN1cmVTYWZlT2JqZWN0KGxlZnQuY29udGV4dCk7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIGV4cHJlc3Npb24gPSBzZWxmLm1lbWJlcihsZWZ0LmNvbnRleHQsIGxlZnQubmFtZSwgbGVmdC5jb21wdXRlZCkgKyAnKCcgKyBhcmdzLmpvaW4oJywnKSArICcpJztcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICBleHByZXNzaW9uID0gcmlnaHQgKyAnKCcgKyBhcmdzLmpvaW4oJywnKSArICcpJztcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBleHByZXNzaW9uID0gc2VsZi5lbnN1cmVTYWZlT2JqZWN0KGV4cHJlc3Npb24pO1xuXHQgICAgICAgICAgICBzZWxmLmFzc2lnbihpbnRvSWQsIGV4cHJlc3Npb24pO1xuXHQgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIHNlbGYuYXNzaWduKGludG9JZCwgJ3VuZGVmaW5lZCcpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgICByZWN1cnNpb25GbihpbnRvSWQpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdCAgICAgIGJyZWFrO1xuXHQgICAgY2FzZSBBU1QuQXNzaWdubWVudEV4cHJlc3Npb246XG5cdCAgICAgIHJpZ2h0ID0gdGhpcy5uZXh0SWQoKTtcblx0ICAgICAgbGVmdCA9IHt9O1xuXHQgICAgICBpZiAoIWlzQXNzaWduYWJsZShhc3QubGVmdCkpIHtcblx0ICAgICAgICB0aHJvdyAkcGFyc2VNaW5FcnIoJ2x2YWwnLCAnVHJ5aW5nIHRvIGFzc2lnbiBhIHZhbHVlIHRvIGEgbm9uIGwtdmFsdWUnKTtcblx0ICAgICAgfVxuXHQgICAgICB0aGlzLnJlY3Vyc2UoYXN0LmxlZnQsIHVuZGVmaW5lZCwgbGVmdCwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgc2VsZi5pZl8oc2VsZi5ub3ROdWxsKGxlZnQuY29udGV4dCksIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgc2VsZi5yZWN1cnNlKGFzdC5yaWdodCwgcmlnaHQpO1xuXHQgICAgICAgICAgc2VsZi5hZGRFbnN1cmVTYWZlT2JqZWN0KHNlbGYubWVtYmVyKGxlZnQuY29udGV4dCwgbGVmdC5uYW1lLCBsZWZ0LmNvbXB1dGVkKSk7XG5cdCAgICAgICAgICBzZWxmLmFkZEVuc3VyZVNhZmVBc3NpZ25Db250ZXh0KGxlZnQuY29udGV4dCk7XG5cdCAgICAgICAgICBleHByZXNzaW9uID0gc2VsZi5tZW1iZXIobGVmdC5jb250ZXh0LCBsZWZ0Lm5hbWUsIGxlZnQuY29tcHV0ZWQpICsgYXN0Lm9wZXJhdG9yICsgcmlnaHQ7XG5cdCAgICAgICAgICBzZWxmLmFzc2lnbihpbnRvSWQsIGV4cHJlc3Npb24pO1xuXHQgICAgICAgICAgcmVjdXJzaW9uRm4oaW50b0lkIHx8IGV4cHJlc3Npb24pO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9LCAxKTtcblx0ICAgICAgYnJlYWs7XG5cdCAgICBjYXNlIEFTVC5BcnJheUV4cHJlc3Npb246XG5cdCAgICAgIGFyZ3MgPSBbXTtcblx0ICAgICAgZm9yRWFjaChhc3QuZWxlbWVudHMsIGZ1bmN0aW9uKGV4cHIpIHtcblx0ICAgICAgICBzZWxmLnJlY3Vyc2UoZXhwciwgc2VsZi5uZXh0SWQoKSwgdW5kZWZpbmVkLCBmdW5jdGlvbihhcmd1bWVudCkge1xuXHQgICAgICAgICAgYXJncy5wdXNoKGFyZ3VtZW50KTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSk7XG5cdCAgICAgIGV4cHJlc3Npb24gPSAnWycgKyBhcmdzLmpvaW4oJywnKSArICddJztcblx0ICAgICAgdGhpcy5hc3NpZ24oaW50b0lkLCBleHByZXNzaW9uKTtcblx0ICAgICAgcmVjdXJzaW9uRm4oZXhwcmVzc2lvbik7XG5cdCAgICAgIGJyZWFrO1xuXHQgICAgY2FzZSBBU1QuT2JqZWN0RXhwcmVzc2lvbjpcblx0ICAgICAgYXJncyA9IFtdO1xuXHQgICAgICBmb3JFYWNoKGFzdC5wcm9wZXJ0aWVzLCBmdW5jdGlvbihwcm9wZXJ0eSkge1xuXHQgICAgICAgIHNlbGYucmVjdXJzZShwcm9wZXJ0eS52YWx1ZSwgc2VsZi5uZXh0SWQoKSwgdW5kZWZpbmVkLCBmdW5jdGlvbihleHByKSB7XG5cdCAgICAgICAgICBhcmdzLnB1c2goc2VsZi5lc2NhcGUoXG5cdCAgICAgICAgICAgICAgcHJvcGVydHkua2V5LnR5cGUgPT09IEFTVC5JZGVudGlmaWVyID8gcHJvcGVydHkua2V5Lm5hbWUgOlxuXHQgICAgICAgICAgICAgICAgKCcnICsgcHJvcGVydHkua2V5LnZhbHVlKSkgK1xuXHQgICAgICAgICAgICAgICc6JyArIGV4cHIpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9KTtcblx0ICAgICAgZXhwcmVzc2lvbiA9ICd7JyArIGFyZ3Muam9pbignLCcpICsgJ30nO1xuXHQgICAgICB0aGlzLmFzc2lnbihpbnRvSWQsIGV4cHJlc3Npb24pO1xuXHQgICAgICByZWN1cnNpb25GbihleHByZXNzaW9uKTtcblx0ICAgICAgYnJlYWs7XG5cdCAgICBjYXNlIEFTVC5UaGlzRXhwcmVzc2lvbjpcblx0ICAgICAgdGhpcy5hc3NpZ24oaW50b0lkLCAncycpO1xuXHQgICAgICByZWN1cnNpb25GbigncycpO1xuXHQgICAgICBicmVhaztcblx0ICAgIGNhc2UgQVNULkxvY2Fsc0V4cHJlc3Npb246XG5cdCAgICAgIHRoaXMuYXNzaWduKGludG9JZCwgJ2wnKTtcblx0ICAgICAgcmVjdXJzaW9uRm4oJ2wnKTtcblx0ICAgICAgYnJlYWs7XG5cdCAgICBjYXNlIEFTVC5OR1ZhbHVlUGFyYW1ldGVyOlxuXHQgICAgICB0aGlzLmFzc2lnbihpbnRvSWQsICd2Jyk7XG5cdCAgICAgIHJlY3Vyc2lvbkZuKCd2Jyk7XG5cdCAgICAgIGJyZWFrO1xuXHQgICAgfVxuXHQgIH0sXG5cdFxuXHQgIGdldEhhc093blByb3BlcnR5OiBmdW5jdGlvbihlbGVtZW50LCBwcm9wZXJ0eSkge1xuXHQgICAgdmFyIGtleSA9IGVsZW1lbnQgKyAnLicgKyBwcm9wZXJ0eTtcblx0ICAgIHZhciBvd24gPSB0aGlzLmN1cnJlbnQoKS5vd247XG5cdCAgICBpZiAoIW93bi5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdCAgICAgIG93bltrZXldID0gdGhpcy5uZXh0SWQoZmFsc2UsIGVsZW1lbnQgKyAnJiYoJyArIHRoaXMuZXNjYXBlKHByb3BlcnR5KSArICcgaW4gJyArIGVsZW1lbnQgKyAnKScpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIG93bltrZXldO1xuXHQgIH0sXG5cdFxuXHQgIGFzc2lnbjogZnVuY3Rpb24oaWQsIHZhbHVlKSB7XG5cdCAgICBpZiAoIWlkKSByZXR1cm47XG5cdCAgICB0aGlzLmN1cnJlbnQoKS5ib2R5LnB1c2goaWQsICc9JywgdmFsdWUsICc7Jyk7XG5cdCAgICByZXR1cm4gaWQ7XG5cdCAgfSxcblx0XG5cdCAgZmlsdGVyOiBmdW5jdGlvbihmaWx0ZXJOYW1lKSB7XG5cdCAgICBpZiAoIXRoaXMuc3RhdGUuZmlsdGVycy5oYXNPd25Qcm9wZXJ0eShmaWx0ZXJOYW1lKSkge1xuXHQgICAgICB0aGlzLnN0YXRlLmZpbHRlcnNbZmlsdGVyTmFtZV0gPSB0aGlzLm5leHRJZCh0cnVlKTtcblx0ICAgIH1cblx0ICAgIHJldHVybiB0aGlzLnN0YXRlLmZpbHRlcnNbZmlsdGVyTmFtZV07XG5cdCAgfSxcblx0XG5cdCAgaWZEZWZpbmVkOiBmdW5jdGlvbihpZCwgZGVmYXVsdFZhbHVlKSB7XG5cdCAgICByZXR1cm4gJ2lmRGVmaW5lZCgnICsgaWQgKyAnLCcgKyB0aGlzLmVzY2FwZShkZWZhdWx0VmFsdWUpICsgJyknO1xuXHQgIH0sXG5cdFxuXHQgIHBsdXM6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0KSB7XG5cdCAgICByZXR1cm4gJ3BsdXMoJyArIGxlZnQgKyAnLCcgKyByaWdodCArICcpJztcblx0ICB9LFxuXHRcblx0ICByZXR1cm5fOiBmdW5jdGlvbihpZCkge1xuXHQgICAgdGhpcy5jdXJyZW50KCkuYm9keS5wdXNoKCdyZXR1cm4gJywgaWQsICc7Jyk7XG5cdCAgfSxcblx0XG5cdCAgaWZfOiBmdW5jdGlvbih0ZXN0LCBhbHRlcm5hdGUsIGNvbnNlcXVlbnQpIHtcblx0ICAgIGlmICh0ZXN0ID09PSB0cnVlKSB7XG5cdCAgICAgIGFsdGVybmF0ZSgpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdmFyIGJvZHkgPSB0aGlzLmN1cnJlbnQoKS5ib2R5O1xuXHQgICAgICBib2R5LnB1c2goJ2lmKCcsIHRlc3QsICcpeycpO1xuXHQgICAgICBhbHRlcm5hdGUoKTtcblx0ICAgICAgYm9keS5wdXNoKCd9Jyk7XG5cdCAgICAgIGlmIChjb25zZXF1ZW50KSB7XG5cdCAgICAgICAgYm9keS5wdXNoKCdlbHNleycpO1xuXHQgICAgICAgIGNvbnNlcXVlbnQoKTtcblx0ICAgICAgICBib2R5LnB1c2goJ30nKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH0sXG5cdFxuXHQgIG5vdDogZnVuY3Rpb24oZXhwcmVzc2lvbikge1xuXHQgICAgcmV0dXJuICchKCcgKyBleHByZXNzaW9uICsgJyknO1xuXHQgIH0sXG5cdFxuXHQgIG5vdE51bGw6IGZ1bmN0aW9uKGV4cHJlc3Npb24pIHtcblx0ICAgIHJldHVybiBleHByZXNzaW9uICsgJyE9bnVsbCc7XG5cdCAgfSxcblx0XG5cdCAgbm9uQ29tcHV0ZWRNZW1iZXI6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0KSB7XG5cdCAgICByZXR1cm4gbGVmdCArICcuJyArIHJpZ2h0O1xuXHQgIH0sXG5cdFxuXHQgIGNvbXB1dGVkTWVtYmVyOiBmdW5jdGlvbihsZWZ0LCByaWdodCkge1xuXHQgICAgcmV0dXJuIGxlZnQgKyAnWycgKyByaWdodCArICddJztcblx0ICB9LFxuXHRcblx0ICBtZW1iZXI6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb21wdXRlZCkge1xuXHQgICAgaWYgKGNvbXB1dGVkKSByZXR1cm4gdGhpcy5jb21wdXRlZE1lbWJlcihsZWZ0LCByaWdodCk7XG5cdCAgICByZXR1cm4gdGhpcy5ub25Db21wdXRlZE1lbWJlcihsZWZ0LCByaWdodCk7XG5cdCAgfSxcblx0XG5cdCAgYWRkRW5zdXJlU2FmZU9iamVjdDogZnVuY3Rpb24oaXRlbSkge1xuXHQgICAgdGhpcy5jdXJyZW50KCkuYm9keS5wdXNoKHRoaXMuZW5zdXJlU2FmZU9iamVjdChpdGVtKSwgJzsnKTtcblx0ICB9LFxuXHRcblx0ICBhZGRFbnN1cmVTYWZlTWVtYmVyTmFtZTogZnVuY3Rpb24oaXRlbSkge1xuXHQgICAgdGhpcy5jdXJyZW50KCkuYm9keS5wdXNoKHRoaXMuZW5zdXJlU2FmZU1lbWJlck5hbWUoaXRlbSksICc7Jyk7XG5cdCAgfSxcblx0XG5cdCAgYWRkRW5zdXJlU2FmZUZ1bmN0aW9uOiBmdW5jdGlvbihpdGVtKSB7XG5cdCAgICB0aGlzLmN1cnJlbnQoKS5ib2R5LnB1c2godGhpcy5lbnN1cmVTYWZlRnVuY3Rpb24oaXRlbSksICc7Jyk7XG5cdCAgfSxcblx0XG5cdCAgYWRkRW5zdXJlU2FmZUFzc2lnbkNvbnRleHQ6IGZ1bmN0aW9uKGl0ZW0pIHtcblx0ICAgIHRoaXMuY3VycmVudCgpLmJvZHkucHVzaCh0aGlzLmVuc3VyZVNhZmVBc3NpZ25Db250ZXh0KGl0ZW0pLCAnOycpO1xuXHQgIH0sXG5cdFxuXHQgIGVuc3VyZVNhZmVPYmplY3Q6IGZ1bmN0aW9uKGl0ZW0pIHtcblx0ICAgIHJldHVybiAnZW5zdXJlU2FmZU9iamVjdCgnICsgaXRlbSArICcsdGV4dCknO1xuXHQgIH0sXG5cdFxuXHQgIGVuc3VyZVNhZmVNZW1iZXJOYW1lOiBmdW5jdGlvbihpdGVtKSB7XG5cdCAgICByZXR1cm4gJ2Vuc3VyZVNhZmVNZW1iZXJOYW1lKCcgKyBpdGVtICsgJyx0ZXh0KSc7XG5cdCAgfSxcblx0XG5cdCAgZW5zdXJlU2FmZUZ1bmN0aW9uOiBmdW5jdGlvbihpdGVtKSB7XG5cdCAgICByZXR1cm4gJ2Vuc3VyZVNhZmVGdW5jdGlvbignICsgaXRlbSArICcsdGV4dCknO1xuXHQgIH0sXG5cdFxuXHQgIGdldFN0cmluZ1ZhbHVlOiBmdW5jdGlvbihpdGVtKSB7XG5cdCAgICB0aGlzLmFzc2lnbihpdGVtLCAnZ2V0U3RyaW5nVmFsdWUoJyArIGl0ZW0gKyAnKScpO1xuXHQgIH0sXG5cdFxuXHQgIGVuc3VyZVNhZmVBc3NpZ25Db250ZXh0OiBmdW5jdGlvbihpdGVtKSB7XG5cdCAgICByZXR1cm4gJ2Vuc3VyZVNhZmVBc3NpZ25Db250ZXh0KCcgKyBpdGVtICsgJyx0ZXh0KSc7XG5cdCAgfSxcblx0XG5cdCAgbGF6eVJlY3Vyc2U6IGZ1bmN0aW9uKGFzdCwgaW50b0lkLCBuYW1lSWQsIHJlY3Vyc2lvbkZuLCBjcmVhdGUsIHNraXBXYXRjaElkQ2hlY2spIHtcblx0ICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgIHJldHVybiBmdW5jdGlvbigpIHtcblx0ICAgICAgc2VsZi5yZWN1cnNlKGFzdCwgaW50b0lkLCBuYW1lSWQsIHJlY3Vyc2lvbkZuLCBjcmVhdGUsIHNraXBXYXRjaElkQ2hlY2spO1xuXHQgICAgfTtcblx0ICB9LFxuXHRcblx0ICBsYXp5QXNzaWduOiBmdW5jdGlvbihpZCwgdmFsdWUpIHtcblx0ICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgIHJldHVybiBmdW5jdGlvbigpIHtcblx0ICAgICAgc2VsZi5hc3NpZ24oaWQsIHZhbHVlKTtcblx0ICAgIH07XG5cdCAgfSxcblx0XG5cdCAgc3RyaW5nRXNjYXBlUmVnZXg6IC9bXiBhLXpBLVowLTldL2csXG5cdFxuXHQgIHN0cmluZ0VzY2FwZUZuOiBmdW5jdGlvbihjKSB7XG5cdCAgICByZXR1cm4gJ1xcXFx1JyArICgnMDAwMCcgKyBjLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpKS5zbGljZSgtNCk7XG5cdCAgfSxcblx0XG5cdCAgZXNjYXBlOiBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgaWYgKGlzU3RyaW5nKHZhbHVlKSkgcmV0dXJuIFwiJ1wiICsgdmFsdWUucmVwbGFjZSh0aGlzLnN0cmluZ0VzY2FwZVJlZ2V4LCB0aGlzLnN0cmluZ0VzY2FwZUZuKSArIFwiJ1wiO1xuXHQgICAgaWYgKGlzTnVtYmVyKHZhbHVlKSkgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCk7XG5cdCAgICBpZiAodmFsdWUgPT09IHRydWUpIHJldHVybiAndHJ1ZSc7XG5cdCAgICBpZiAodmFsdWUgPT09IGZhbHNlKSByZXR1cm4gJ2ZhbHNlJztcblx0ICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkgcmV0dXJuICdudWxsJztcblx0ICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnKSByZXR1cm4gJ3VuZGVmaW5lZCc7XG5cdFxuXHQgICAgdGhyb3cgJHBhcnNlTWluRXJyKCdlc2MnLCAnSU1QT1NTSUJMRScpO1xuXHQgIH0sXG5cdFxuXHQgIG5leHRJZDogZnVuY3Rpb24oc2tpcCwgaW5pdCkge1xuXHQgICAgdmFyIGlkID0gJ3YnICsgKHRoaXMuc3RhdGUubmV4dElkKyspO1xuXHQgICAgaWYgKCFza2lwKSB7XG5cdCAgICAgIHRoaXMuY3VycmVudCgpLnZhcnMucHVzaChpZCArIChpbml0ID8gJz0nICsgaW5pdCA6ICcnKSk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gaWQ7XG5cdCAgfSxcblx0XG5cdCAgY3VycmVudDogZnVuY3Rpb24oKSB7XG5cdCAgICByZXR1cm4gdGhpcy5zdGF0ZVt0aGlzLnN0YXRlLmNvbXB1dGluZ107XG5cdCAgfVxuXHR9O1xuXHRcblx0XG5cdGZ1bmN0aW9uIEFTVEludGVycHJldGVyKGFzdEJ1aWxkZXIsICRmaWx0ZXIpIHtcblx0ICB0aGlzLmFzdEJ1aWxkZXIgPSBhc3RCdWlsZGVyO1xuXHQgIHRoaXMuJGZpbHRlciA9ICRmaWx0ZXI7XG5cdH1cblx0XG5cdEFTVEludGVycHJldGVyLnByb3RvdHlwZSA9IHtcblx0ICBjb21waWxlOiBmdW5jdGlvbihleHByZXNzaW9uLCBleHBlbnNpdmVDaGVja3MpIHtcblx0ICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgIHZhciBhc3QgPSB0aGlzLmFzdEJ1aWxkZXIuYXN0KGV4cHJlc3Npb24pO1xuXHQgICAgdGhpcy5leHByZXNzaW9uID0gZXhwcmVzc2lvbjtcblx0ICAgIHRoaXMuZXhwZW5zaXZlQ2hlY2tzID0gZXhwZW5zaXZlQ2hlY2tzO1xuXHQgICAgZmluZENvbnN0YW50QW5kV2F0Y2hFeHByZXNzaW9ucyhhc3QsIHNlbGYuJGZpbHRlcik7XG5cdCAgICB2YXIgYXNzaWduYWJsZTtcblx0ICAgIHZhciBhc3NpZ247XG5cdCAgICBpZiAoKGFzc2lnbmFibGUgPSBhc3NpZ25hYmxlQVNUKGFzdCkpKSB7XG5cdCAgICAgIGFzc2lnbiA9IHRoaXMucmVjdXJzZShhc3NpZ25hYmxlKTtcblx0ICAgIH1cblx0ICAgIHZhciB0b1dhdGNoID0gZ2V0SW5wdXRzKGFzdC5ib2R5KTtcblx0ICAgIHZhciBpbnB1dHM7XG5cdCAgICBpZiAodG9XYXRjaCkge1xuXHQgICAgICBpbnB1dHMgPSBbXTtcblx0ICAgICAgZm9yRWFjaCh0b1dhdGNoLCBmdW5jdGlvbih3YXRjaCwga2V5KSB7XG5cdCAgICAgICAgdmFyIGlucHV0ID0gc2VsZi5yZWN1cnNlKHdhdGNoKTtcblx0ICAgICAgICB3YXRjaC5pbnB1dCA9IGlucHV0O1xuXHQgICAgICAgIGlucHV0cy5wdXNoKGlucHV0KTtcblx0ICAgICAgICB3YXRjaC53YXRjaElkID0ga2V5O1xuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICAgIHZhciBleHByZXNzaW9ucyA9IFtdO1xuXHQgICAgZm9yRWFjaChhc3QuYm9keSwgZnVuY3Rpb24oZXhwcmVzc2lvbikge1xuXHQgICAgICBleHByZXNzaW9ucy5wdXNoKHNlbGYucmVjdXJzZShleHByZXNzaW9uLmV4cHJlc3Npb24pKTtcblx0ICAgIH0pO1xuXHQgICAgdmFyIGZuID0gYXN0LmJvZHkubGVuZ3RoID09PSAwID8gZnVuY3Rpb24oKSB7fSA6XG5cdCAgICAgICAgICAgICBhc3QuYm9keS5sZW5ndGggPT09IDEgPyBleHByZXNzaW9uc1swXSA6XG5cdCAgICAgICAgICAgICBmdW5jdGlvbihzY29wZSwgbG9jYWxzKSB7XG5cdCAgICAgICAgICAgICAgIHZhciBsYXN0VmFsdWU7XG5cdCAgICAgICAgICAgICAgIGZvckVhY2goZXhwcmVzc2lvbnMsIGZ1bmN0aW9uKGV4cCkge1xuXHQgICAgICAgICAgICAgICAgIGxhc3RWYWx1ZSA9IGV4cChzY29wZSwgbG9jYWxzKTtcblx0ICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgIHJldHVybiBsYXN0VmFsdWU7XG5cdCAgICAgICAgICAgICB9O1xuXHQgICAgaWYgKGFzc2lnbikge1xuXHQgICAgICBmbi5hc3NpZ24gPSBmdW5jdGlvbihzY29wZSwgdmFsdWUsIGxvY2Fscykge1xuXHQgICAgICAgIHJldHVybiBhc3NpZ24oc2NvcGUsIGxvY2FscywgdmFsdWUpO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHQgICAgaWYgKGlucHV0cykge1xuXHQgICAgICBmbi5pbnB1dHMgPSBpbnB1dHM7XG5cdCAgICB9XG5cdCAgICBmbi5saXRlcmFsID0gaXNMaXRlcmFsKGFzdCk7XG5cdCAgICBmbi5jb25zdGFudCA9IGlzQ29uc3RhbnQoYXN0KTtcblx0ICAgIHJldHVybiBmbjtcblx0ICB9LFxuXHRcblx0ICByZWN1cnNlOiBmdW5jdGlvbihhc3QsIGNvbnRleHQsIGNyZWF0ZSkge1xuXHQgICAgdmFyIGxlZnQsIHJpZ2h0LCBzZWxmID0gdGhpcywgYXJncywgZXhwcmVzc2lvbjtcblx0ICAgIGlmIChhc3QuaW5wdXQpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuaW5wdXRzKGFzdC5pbnB1dCwgYXN0LndhdGNoSWQpO1xuXHQgICAgfVxuXHQgICAgc3dpdGNoIChhc3QudHlwZSkge1xuXHQgICAgY2FzZSBBU1QuTGl0ZXJhbDpcblx0ICAgICAgcmV0dXJuIHRoaXMudmFsdWUoYXN0LnZhbHVlLCBjb250ZXh0KTtcblx0ICAgIGNhc2UgQVNULlVuYXJ5RXhwcmVzc2lvbjpcblx0ICAgICAgcmlnaHQgPSB0aGlzLnJlY3Vyc2UoYXN0LmFyZ3VtZW50KTtcblx0ICAgICAgcmV0dXJuIHRoaXNbJ3VuYXJ5JyArIGFzdC5vcGVyYXRvcl0ocmlnaHQsIGNvbnRleHQpO1xuXHQgICAgY2FzZSBBU1QuQmluYXJ5RXhwcmVzc2lvbjpcblx0ICAgICAgbGVmdCA9IHRoaXMucmVjdXJzZShhc3QubGVmdCk7XG5cdCAgICAgIHJpZ2h0ID0gdGhpcy5yZWN1cnNlKGFzdC5yaWdodCk7XG5cdCAgICAgIHJldHVybiB0aGlzWydiaW5hcnknICsgYXN0Lm9wZXJhdG9yXShsZWZ0LCByaWdodCwgY29udGV4dCk7XG5cdCAgICBjYXNlIEFTVC5Mb2dpY2FsRXhwcmVzc2lvbjpcblx0ICAgICAgbGVmdCA9IHRoaXMucmVjdXJzZShhc3QubGVmdCk7XG5cdCAgICAgIHJpZ2h0ID0gdGhpcy5yZWN1cnNlKGFzdC5yaWdodCk7XG5cdCAgICAgIHJldHVybiB0aGlzWydiaW5hcnknICsgYXN0Lm9wZXJhdG9yXShsZWZ0LCByaWdodCwgY29udGV4dCk7XG5cdCAgICBjYXNlIEFTVC5Db25kaXRpb25hbEV4cHJlc3Npb246XG5cdCAgICAgIHJldHVybiB0aGlzWyd0ZXJuYXJ5PzonXShcblx0ICAgICAgICB0aGlzLnJlY3Vyc2UoYXN0LnRlc3QpLFxuXHQgICAgICAgIHRoaXMucmVjdXJzZShhc3QuYWx0ZXJuYXRlKSxcblx0ICAgICAgICB0aGlzLnJlY3Vyc2UoYXN0LmNvbnNlcXVlbnQpLFxuXHQgICAgICAgIGNvbnRleHRcblx0ICAgICAgKTtcblx0ICAgIGNhc2UgQVNULklkZW50aWZpZXI6XG5cdCAgICAgIGVuc3VyZVNhZmVNZW1iZXJOYW1lKGFzdC5uYW1lLCBzZWxmLmV4cHJlc3Npb24pO1xuXHQgICAgICByZXR1cm4gc2VsZi5pZGVudGlmaWVyKGFzdC5uYW1lLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZXhwZW5zaXZlQ2hlY2tzIHx8IGlzUG9zc2libHlEYW5nZXJvdXNNZW1iZXJOYW1lKGFzdC5uYW1lKSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LCBjcmVhdGUsIHNlbGYuZXhwcmVzc2lvbik7XG5cdCAgICBjYXNlIEFTVC5NZW1iZXJFeHByZXNzaW9uOlxuXHQgICAgICBsZWZ0ID0gdGhpcy5yZWN1cnNlKGFzdC5vYmplY3QsIGZhbHNlLCAhIWNyZWF0ZSk7XG5cdCAgICAgIGlmICghYXN0LmNvbXB1dGVkKSB7XG5cdCAgICAgICAgZW5zdXJlU2FmZU1lbWJlck5hbWUoYXN0LnByb3BlcnR5Lm5hbWUsIHNlbGYuZXhwcmVzc2lvbik7XG5cdCAgICAgICAgcmlnaHQgPSBhc3QucHJvcGVydHkubmFtZTtcblx0ICAgICAgfVxuXHQgICAgICBpZiAoYXN0LmNvbXB1dGVkKSByaWdodCA9IHRoaXMucmVjdXJzZShhc3QucHJvcGVydHkpO1xuXHQgICAgICByZXR1cm4gYXN0LmNvbXB1dGVkID9cblx0ICAgICAgICB0aGlzLmNvbXB1dGVkTWVtYmVyKGxlZnQsIHJpZ2h0LCBjb250ZXh0LCBjcmVhdGUsIHNlbGYuZXhwcmVzc2lvbikgOlxuXHQgICAgICAgIHRoaXMubm9uQ29tcHV0ZWRNZW1iZXIobGVmdCwgcmlnaHQsIHNlbGYuZXhwZW5zaXZlQ2hlY2tzLCBjb250ZXh0LCBjcmVhdGUsIHNlbGYuZXhwcmVzc2lvbik7XG5cdCAgICBjYXNlIEFTVC5DYWxsRXhwcmVzc2lvbjpcblx0ICAgICAgYXJncyA9IFtdO1xuXHQgICAgICBmb3JFYWNoKGFzdC5hcmd1bWVudHMsIGZ1bmN0aW9uKGV4cHIpIHtcblx0ICAgICAgICBhcmdzLnB1c2goc2VsZi5yZWN1cnNlKGV4cHIpKTtcblx0ICAgICAgfSk7XG5cdCAgICAgIGlmIChhc3QuZmlsdGVyKSByaWdodCA9IHRoaXMuJGZpbHRlcihhc3QuY2FsbGVlLm5hbWUpO1xuXHQgICAgICBpZiAoIWFzdC5maWx0ZXIpIHJpZ2h0ID0gdGhpcy5yZWN1cnNlKGFzdC5jYWxsZWUsIHRydWUpO1xuXHQgICAgICByZXR1cm4gYXN0LmZpbHRlciA/XG5cdCAgICAgICAgZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgICAgIHZhciB2YWx1ZXMgPSBbXTtcblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7ICsraSkge1xuXHQgICAgICAgICAgICB2YWx1ZXMucHVzaChhcmdzW2ldKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICB2YXIgdmFsdWUgPSByaWdodC5hcHBseSh1bmRlZmluZWQsIHZhbHVlcywgaW5wdXRzKTtcblx0ICAgICAgICAgIHJldHVybiBjb250ZXh0ID8ge2NvbnRleHQ6IHVuZGVmaW5lZCwgbmFtZTogdW5kZWZpbmVkLCB2YWx1ZTogdmFsdWV9IDogdmFsdWU7XG5cdCAgICAgICAgfSA6XG5cdCAgICAgICAgZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgICAgIHZhciByaHMgPSByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG5cdCAgICAgICAgICB2YXIgdmFsdWU7XG5cdCAgICAgICAgICBpZiAocmhzLnZhbHVlICE9IG51bGwpIHtcblx0ICAgICAgICAgICAgZW5zdXJlU2FmZU9iamVjdChyaHMuY29udGV4dCwgc2VsZi5leHByZXNzaW9uKTtcblx0ICAgICAgICAgICAgZW5zdXJlU2FmZUZ1bmN0aW9uKHJocy52YWx1ZSwgc2VsZi5leHByZXNzaW9uKTtcblx0ICAgICAgICAgICAgdmFyIHZhbHVlcyA9IFtdO1xuXHQgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyArK2kpIHtcblx0ICAgICAgICAgICAgICB2YWx1ZXMucHVzaChlbnN1cmVTYWZlT2JqZWN0KGFyZ3NbaV0oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpLCBzZWxmLmV4cHJlc3Npb24pKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB2YWx1ZSA9IGVuc3VyZVNhZmVPYmplY3QocmhzLnZhbHVlLmFwcGx5KHJocy5jb250ZXh0LCB2YWx1ZXMpLCBzZWxmLmV4cHJlc3Npb24pO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgcmV0dXJuIGNvbnRleHQgPyB7dmFsdWU6IHZhbHVlfSA6IHZhbHVlO1xuXHQgICAgICAgIH07XG5cdCAgICBjYXNlIEFTVC5Bc3NpZ25tZW50RXhwcmVzc2lvbjpcblx0ICAgICAgbGVmdCA9IHRoaXMucmVjdXJzZShhc3QubGVmdCwgdHJ1ZSwgMSk7XG5cdCAgICAgIHJpZ2h0ID0gdGhpcy5yZWN1cnNlKGFzdC5yaWdodCk7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICAgIHZhciBsaHMgPSBsZWZ0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcblx0ICAgICAgICB2YXIgcmhzID0gcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuXHQgICAgICAgIGVuc3VyZVNhZmVPYmplY3QobGhzLnZhbHVlLCBzZWxmLmV4cHJlc3Npb24pO1xuXHQgICAgICAgIGVuc3VyZVNhZmVBc3NpZ25Db250ZXh0KGxocy5jb250ZXh0KTtcblx0ICAgICAgICBsaHMuY29udGV4dFtsaHMubmFtZV0gPSByaHM7XG5cdCAgICAgICAgcmV0dXJuIGNvbnRleHQgPyB7dmFsdWU6IHJoc30gOiByaHM7XG5cdCAgICAgIH07XG5cdCAgICBjYXNlIEFTVC5BcnJheUV4cHJlc3Npb246XG5cdCAgICAgIGFyZ3MgPSBbXTtcblx0ICAgICAgZm9yRWFjaChhc3QuZWxlbWVudHMsIGZ1bmN0aW9uKGV4cHIpIHtcblx0ICAgICAgICBhcmdzLnB1c2goc2VsZi5yZWN1cnNlKGV4cHIpKTtcblx0ICAgICAgfSk7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICAgIHZhciB2YWx1ZSA9IFtdO1xuXHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7ICsraSkge1xuXHQgICAgICAgICAgdmFsdWUucHVzaChhcmdzW2ldKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiB2YWx1ZX0gOiB2YWx1ZTtcblx0ICAgICAgfTtcblx0ICAgIGNhc2UgQVNULk9iamVjdEV4cHJlc3Npb246XG5cdCAgICAgIGFyZ3MgPSBbXTtcblx0ICAgICAgZm9yRWFjaChhc3QucHJvcGVydGllcywgZnVuY3Rpb24ocHJvcGVydHkpIHtcblx0ICAgICAgICBhcmdzLnB1c2goe2tleTogcHJvcGVydHkua2V5LnR5cGUgPT09IEFTVC5JZGVudGlmaWVyID9cblx0ICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHkua2V5Lm5hbWUgOlxuXHQgICAgICAgICAgICAgICAgICAgICAgICAoJycgKyBwcm9wZXJ0eS5rZXkudmFsdWUpLFxuXHQgICAgICAgICAgICAgICAgICAgdmFsdWU6IHNlbGYucmVjdXJzZShwcm9wZXJ0eS52YWx1ZSlcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSk7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICAgIHZhciB2YWx1ZSA9IHt9O1xuXHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7ICsraSkge1xuXHQgICAgICAgICAgdmFsdWVbYXJnc1tpXS5rZXldID0gYXJnc1tpXS52YWx1ZShzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiB2YWx1ZX0gOiB2YWx1ZTtcblx0ICAgICAgfTtcblx0ICAgIGNhc2UgQVNULlRoaXNFeHByZXNzaW9uOlxuXHQgICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUpIHtcblx0ICAgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogc2NvcGV9IDogc2NvcGU7XG5cdCAgICAgIH07XG5cdCAgICBjYXNlIEFTVC5Mb2NhbHNFeHByZXNzaW9uOlxuXHQgICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2Fscykge1xuXHQgICAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBsb2NhbHN9IDogbG9jYWxzO1xuXHQgICAgICB9O1xuXHQgICAgY2FzZSBBU1QuTkdWYWx1ZVBhcmFtZXRlcjpcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG5cdCAgICAgICAgcmV0dXJuIGNvbnRleHQgPyB7dmFsdWU6IGFzc2lnbn0gOiBhc3NpZ247XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfSxcblx0XG5cdCAgJ3VuYXJ5Kyc6IGZ1bmN0aW9uKGFyZ3VtZW50LCBjb250ZXh0KSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcblx0ICAgICAgaWYgKGlzRGVmaW5lZChhcmcpKSB7XG5cdCAgICAgICAgYXJnID0gK2FyZztcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBhcmcgPSAwO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuXHQgICAgfTtcblx0ICB9LFxuXHQgICd1bmFyeS0nOiBmdW5jdGlvbihhcmd1bWVudCwgY29udGV4dCkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG5cdCAgICAgIHZhciBhcmcgPSBhcmd1bWVudChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG5cdCAgICAgIGlmIChpc0RlZmluZWQoYXJnKSkge1xuXHQgICAgICAgIGFyZyA9IC1hcmc7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgYXJnID0gMDtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcblx0ICAgIH07XG5cdCAgfSxcblx0ICAndW5hcnkhJzogZnVuY3Rpb24oYXJndW1lbnQsIGNvbnRleHQpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICB2YXIgYXJnID0gIWFyZ3VtZW50KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcblx0ICAgICAgcmV0dXJuIGNvbnRleHQgPyB7dmFsdWU6IGFyZ30gOiBhcmc7XG5cdCAgICB9O1xuXHQgIH0sXG5cdCAgJ2JpbmFyeSsnOiBmdW5jdGlvbihsZWZ0LCByaWdodCwgY29udGV4dCkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG5cdCAgICAgIHZhciBsaHMgPSBsZWZ0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcblx0ICAgICAgdmFyIHJocyA9IHJpZ2h0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcblx0ICAgICAgdmFyIGFyZyA9IHBsdXNGbihsaHMsIHJocyk7XG5cdCAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuXHQgICAgfTtcblx0ICB9LFxuXHQgICdiaW5hcnktJzogZnVuY3Rpb24obGVmdCwgcmlnaHQsIGNvbnRleHQpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICB2YXIgbGhzID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG5cdCAgICAgIHZhciByaHMgPSByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG5cdCAgICAgIHZhciBhcmcgPSAoaXNEZWZpbmVkKGxocykgPyBsaHMgOiAwKSAtIChpc0RlZmluZWQocmhzKSA/IHJocyA6IDApO1xuXHQgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcblx0ICAgIH07XG5cdCAgfSxcblx0ICAnYmluYXJ5Kic6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgdmFyIGFyZyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpICogcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuXHQgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcblx0ICAgIH07XG5cdCAgfSxcblx0ICAnYmluYXJ5Lyc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgdmFyIGFyZyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIC8gcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuXHQgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcblx0ICAgIH07XG5cdCAgfSxcblx0ICAnYmluYXJ5JSc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgdmFyIGFyZyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpICUgcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuXHQgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcblx0ICAgIH07XG5cdCAgfSxcblx0ICAnYmluYXJ5PT09JzogZnVuY3Rpb24obGVmdCwgcmlnaHQsIGNvbnRleHQpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICB2YXIgYXJnID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgPT09IHJpZ2h0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcblx0ICAgICAgcmV0dXJuIGNvbnRleHQgPyB7dmFsdWU6IGFyZ30gOiBhcmc7XG5cdCAgICB9O1xuXHQgIH0sXG5cdCAgJ2JpbmFyeSE9PSc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgdmFyIGFyZyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpICE9PSByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG5cdCAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuXHQgICAgfTtcblx0ICB9LFxuXHQgICdiaW5hcnk9PSc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgdmFyIGFyZyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpID09IHJpZ2h0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcblx0ICAgICAgcmV0dXJuIGNvbnRleHQgPyB7dmFsdWU6IGFyZ30gOiBhcmc7XG5cdCAgICB9O1xuXHQgIH0sXG5cdCAgJ2JpbmFyeSE9JzogZnVuY3Rpb24obGVmdCwgcmlnaHQsIGNvbnRleHQpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICB2YXIgYXJnID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgIT0gcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuXHQgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcblx0ICAgIH07XG5cdCAgfSxcblx0ICAnYmluYXJ5PCc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgdmFyIGFyZyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIDwgcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuXHQgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcblx0ICAgIH07XG5cdCAgfSxcblx0ICAnYmluYXJ5Pic6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgdmFyIGFyZyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpID4gcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuXHQgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcblx0ICAgIH07XG5cdCAgfSxcblx0ICAnYmluYXJ5PD0nOiBmdW5jdGlvbihsZWZ0LCByaWdodCwgY29udGV4dCkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG5cdCAgICAgIHZhciBhcmcgPSBsZWZ0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSA8PSByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG5cdCAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuXHQgICAgfTtcblx0ICB9LFxuXHQgICdiaW5hcnk+PSc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgdmFyIGFyZyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpID49IHJpZ2h0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcblx0ICAgICAgcmV0dXJuIGNvbnRleHQgPyB7dmFsdWU6IGFyZ30gOiBhcmc7XG5cdCAgICB9O1xuXHQgIH0sXG5cdCAgJ2JpbmFyeSYmJzogZnVuY3Rpb24obGVmdCwgcmlnaHQsIGNvbnRleHQpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICB2YXIgYXJnID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgJiYgcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuXHQgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcblx0ICAgIH07XG5cdCAgfSxcblx0ICAnYmluYXJ5fHwnOiBmdW5jdGlvbihsZWZ0LCByaWdodCwgY29udGV4dCkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG5cdCAgICAgIHZhciBhcmcgPSBsZWZ0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB8fCByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG5cdCAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuXHQgICAgfTtcblx0ICB9LFxuXHQgICd0ZXJuYXJ5PzonOiBmdW5jdGlvbih0ZXN0LCBhbHRlcm5hdGUsIGNvbnNlcXVlbnQsIGNvbnRleHQpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICB2YXIgYXJnID0gdGVzdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgPyBhbHRlcm5hdGUoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIDogY29uc2VxdWVudChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG5cdCAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuXHQgICAgfTtcblx0ICB9LFxuXHQgIHZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgY29udGV4dCkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gY29udGV4dCA/IHtjb250ZXh0OiB1bmRlZmluZWQsIG5hbWU6IHVuZGVmaW5lZCwgdmFsdWU6IHZhbHVlfSA6IHZhbHVlOyB9O1xuXHQgIH0sXG5cdCAgaWRlbnRpZmllcjogZnVuY3Rpb24obmFtZSwgZXhwZW5zaXZlQ2hlY2tzLCBjb250ZXh0LCBjcmVhdGUsIGV4cHJlc3Npb24pIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICB2YXIgYmFzZSA9IGxvY2FscyAmJiAobmFtZSBpbiBsb2NhbHMpID8gbG9jYWxzIDogc2NvcGU7XG5cdCAgICAgIGlmIChjcmVhdGUgJiYgY3JlYXRlICE9PSAxICYmIGJhc2UgJiYgIShiYXNlW25hbWVdKSkge1xuXHQgICAgICAgIGJhc2VbbmFtZV0gPSB7fTtcblx0ICAgICAgfVxuXHQgICAgICB2YXIgdmFsdWUgPSBiYXNlID8gYmFzZVtuYW1lXSA6IHVuZGVmaW5lZDtcblx0ICAgICAgaWYgKGV4cGVuc2l2ZUNoZWNrcykge1xuXHQgICAgICAgIGVuc3VyZVNhZmVPYmplY3QodmFsdWUsIGV4cHJlc3Npb24pO1xuXHQgICAgICB9XG5cdCAgICAgIGlmIChjb250ZXh0KSB7XG5cdCAgICAgICAgcmV0dXJuIHtjb250ZXh0OiBiYXNlLCBuYW1lOiBuYW1lLCB2YWx1ZTogdmFsdWV9O1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHJldHVybiB2YWx1ZTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICB9LFxuXHQgIGNvbXB1dGVkTWVtYmVyOiBmdW5jdGlvbihsZWZ0LCByaWdodCwgY29udGV4dCwgY3JlYXRlLCBleHByZXNzaW9uKSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgdmFyIGxocyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuXHQgICAgICB2YXIgcmhzO1xuXHQgICAgICB2YXIgdmFsdWU7XG5cdCAgICAgIGlmIChsaHMgIT0gbnVsbCkge1xuXHQgICAgICAgIHJocyA9IHJpZ2h0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcblx0ICAgICAgICByaHMgPSBnZXRTdHJpbmdWYWx1ZShyaHMpO1xuXHQgICAgICAgIGVuc3VyZVNhZmVNZW1iZXJOYW1lKHJocywgZXhwcmVzc2lvbik7XG5cdCAgICAgICAgaWYgKGNyZWF0ZSAmJiBjcmVhdGUgIT09IDEpIHtcblx0ICAgICAgICAgIGVuc3VyZVNhZmVBc3NpZ25Db250ZXh0KGxocyk7XG5cdCAgICAgICAgICBpZiAobGhzICYmICEobGhzW3Joc10pKSB7XG5cdCAgICAgICAgICAgIGxoc1tyaHNdID0ge307XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHZhbHVlID0gbGhzW3Joc107XG5cdCAgICAgICAgZW5zdXJlU2FmZU9iamVjdCh2YWx1ZSwgZXhwcmVzc2lvbik7XG5cdCAgICAgIH1cblx0ICAgICAgaWYgKGNvbnRleHQpIHtcblx0ICAgICAgICByZXR1cm4ge2NvbnRleHQ6IGxocywgbmFtZTogcmhzLCB2YWx1ZTogdmFsdWV9O1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHJldHVybiB2YWx1ZTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICB9LFxuXHQgIG5vbkNvbXB1dGVkTWVtYmVyOiBmdW5jdGlvbihsZWZ0LCByaWdodCwgZXhwZW5zaXZlQ2hlY2tzLCBjb250ZXh0LCBjcmVhdGUsIGV4cHJlc3Npb24pIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICB2YXIgbGhzID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG5cdCAgICAgIGlmIChjcmVhdGUgJiYgY3JlYXRlICE9PSAxKSB7XG5cdCAgICAgICAgZW5zdXJlU2FmZUFzc2lnbkNvbnRleHQobGhzKTtcblx0ICAgICAgICBpZiAobGhzICYmICEobGhzW3JpZ2h0XSkpIHtcblx0ICAgICAgICAgIGxoc1tyaWdodF0gPSB7fTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgICAgdmFyIHZhbHVlID0gbGhzICE9IG51bGwgPyBsaHNbcmlnaHRdIDogdW5kZWZpbmVkO1xuXHQgICAgICBpZiAoZXhwZW5zaXZlQ2hlY2tzIHx8IGlzUG9zc2libHlEYW5nZXJvdXNNZW1iZXJOYW1lKHJpZ2h0KSkge1xuXHQgICAgICAgIGVuc3VyZVNhZmVPYmplY3QodmFsdWUsIGV4cHJlc3Npb24pO1xuXHQgICAgICB9XG5cdCAgICAgIGlmIChjb250ZXh0KSB7XG5cdCAgICAgICAgcmV0dXJuIHtjb250ZXh0OiBsaHMsIG5hbWU6IHJpZ2h0LCB2YWx1ZTogdmFsdWV9O1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHJldHVybiB2YWx1ZTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICB9LFxuXHQgIGlucHV0czogZnVuY3Rpb24oaW5wdXQsIHdhdGNoSWQpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgdmFsdWUsIGxvY2FscywgaW5wdXRzKSB7XG5cdCAgICAgIGlmIChpbnB1dHMpIHJldHVybiBpbnB1dHNbd2F0Y2hJZF07XG5cdCAgICAgIHJldHVybiBpbnB1dChzY29wZSwgdmFsdWUsIGxvY2Fscyk7XG5cdCAgICB9O1xuXHQgIH1cblx0fTtcblx0XG5cdC8qKlxuXHQgKiBAY29uc3RydWN0b3Jcblx0ICovXG5cdHZhciBQYXJzZXIgPSBmdW5jdGlvbihsZXhlciwgJGZpbHRlciwgb3B0aW9ucykge1xuXHQgIHRoaXMubGV4ZXIgPSBsZXhlcjtcblx0ICB0aGlzLiRmaWx0ZXIgPSAkZmlsdGVyO1xuXHQgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG5cdCAgdGhpcy5hc3QgPSBuZXcgQVNUKHRoaXMubGV4ZXIpO1xuXHQgIHRoaXMuYXN0Q29tcGlsZXIgPSBvcHRpb25zLmNzcCA/IG5ldyBBU1RJbnRlcnByZXRlcih0aGlzLmFzdCwgJGZpbHRlcikgOlxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBBU1RDb21waWxlcih0aGlzLmFzdCwgJGZpbHRlcik7XG5cdH07XG5cdFxuXHRQYXJzZXIucHJvdG90eXBlID0ge1xuXHQgIGNvbnN0cnVjdG9yOiBQYXJzZXIsXG5cdFxuXHQgIHBhcnNlOiBmdW5jdGlvbih0ZXh0KSB7XG5cdCAgICByZXR1cm4gdGhpcy5hc3RDb21waWxlci5jb21waWxlKHRleHQsIHRoaXMub3B0aW9ucy5leHBlbnNpdmVDaGVja3MpO1xuXHQgIH1cblx0fTtcblx0XG5cdGZ1bmN0aW9uIGlzUG9zc2libHlEYW5nZXJvdXNNZW1iZXJOYW1lKG5hbWUpIHtcblx0ICByZXR1cm4gbmFtZSA9PSAnY29uc3RydWN0b3InO1xuXHR9XG5cdFxuXHR2YXIgb2JqZWN0VmFsdWVPZiA9IE9iamVjdC5wcm90b3R5cGUudmFsdWVPZjtcblx0XG5cdGZ1bmN0aW9uIGdldFZhbHVlT2YodmFsdWUpIHtcblx0ICByZXR1cm4gaXNGdW5jdGlvbih2YWx1ZS52YWx1ZU9mKSA/IHZhbHVlLnZhbHVlT2YoKSA6IG9iamVjdFZhbHVlT2YuY2FsbCh2YWx1ZSk7XG5cdH1cblx0XG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHNlcnZpY2Vcblx0ICogQG5hbWUgJHBhcnNlXG5cdCAqIEBraW5kIGZ1bmN0aW9uXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKlxuXHQgKiBDb252ZXJ0cyBBbmd1bGFyIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259IGludG8gYSBmdW5jdGlvbi5cblx0ICpcblx0ICogYGBganNcblx0ICogICB2YXIgZ2V0dGVyID0gJHBhcnNlKCd1c2VyLm5hbWUnKTtcblx0ICogICB2YXIgc2V0dGVyID0gZ2V0dGVyLmFzc2lnbjtcblx0ICogICB2YXIgY29udGV4dCA9IHt1c2VyOntuYW1lOidhbmd1bGFyJ319O1xuXHQgKiAgIHZhciBsb2NhbHMgPSB7dXNlcjp7bmFtZTonbG9jYWwnfX07XG5cdCAqXG5cdCAqICAgZXhwZWN0KGdldHRlcihjb250ZXh0KSkudG9FcXVhbCgnYW5ndWxhcicpO1xuXHQgKiAgIHNldHRlcihjb250ZXh0LCAnbmV3VmFsdWUnKTtcblx0ICogICBleHBlY3QoY29udGV4dC51c2VyLm5hbWUpLnRvRXF1YWwoJ25ld1ZhbHVlJyk7XG5cdCAqICAgZXhwZWN0KGdldHRlcihjb250ZXh0LCBsb2NhbHMpKS50b0VxdWFsKCdsb2NhbCcpO1xuXHQgKiBgYGBcblx0ICpcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IGV4cHJlc3Npb24gU3RyaW5nIGV4cHJlc3Npb24gdG8gY29tcGlsZS5cblx0ICogQHJldHVybnMge2Z1bmN0aW9uKGNvbnRleHQsIGxvY2Fscyl9IGEgZnVuY3Rpb24gd2hpY2ggcmVwcmVzZW50cyB0aGUgY29tcGlsZWQgZXhwcmVzc2lvbjpcblx0ICpcblx0ICogICAgKiBgY29udGV4dGAg4oCTIGB7b2JqZWN0fWAg4oCTIGFuIG9iamVjdCBhZ2FpbnN0IHdoaWNoIGFueSBleHByZXNzaW9ucyBlbWJlZGRlZCBpbiB0aGUgc3RyaW5nc1xuXHQgKiAgICAgIGFyZSBldmFsdWF0ZWQgYWdhaW5zdCAodHlwaWNhbGx5IGEgc2NvcGUgb2JqZWN0KS5cblx0ICogICAgKiBgbG9jYWxzYCDigJMgYHtvYmplY3Q9fWAg4oCTIGxvY2FsIHZhcmlhYmxlcyBjb250ZXh0IG9iamVjdCwgdXNlZnVsIGZvciBvdmVycmlkaW5nIHZhbHVlcyBpblxuXHQgKiAgICAgIGBjb250ZXh0YC5cblx0ICpcblx0ICogICAgVGhlIHJldHVybmVkIGZ1bmN0aW9uIGFsc28gaGFzIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcblx0ICogICAgICAqIGBsaXRlcmFsYCDigJMgYHtib29sZWFufWAg4oCTIHdoZXRoZXIgdGhlIGV4cHJlc3Npb24ncyB0b3AtbGV2ZWwgbm9kZSBpcyBhIEphdmFTY3JpcHRcblx0ICogICAgICAgIGxpdGVyYWwuXG5cdCAqICAgICAgKiBgY29uc3RhbnRgIOKAkyBge2Jvb2xlYW59YCDigJMgd2hldGhlciB0aGUgZXhwcmVzc2lvbiBpcyBtYWRlIGVudGlyZWx5IG9mIEphdmFTY3JpcHRcblx0ICogICAgICAgIGNvbnN0YW50IGxpdGVyYWxzLlxuXHQgKiAgICAgICogYGFzc2lnbmAg4oCTIGB7P2Z1bmN0aW9uKGNvbnRleHQsIHZhbHVlKX1gIOKAkyBpZiB0aGUgZXhwcmVzc2lvbiBpcyBhc3NpZ25hYmxlLCB0aGlzIHdpbGwgYmVcblx0ICogICAgICAgIHNldCB0byBhIGZ1bmN0aW9uIHRvIGNoYW5nZSBpdHMgdmFsdWUgb24gdGhlIGdpdmVuIGNvbnRleHQuXG5cdCAqXG5cdCAqL1xuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgcHJvdmlkZXJcblx0ICogQG5hbWUgJHBhcnNlUHJvdmlkZXJcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIGAkcGFyc2VQcm92aWRlcmAgY2FuIGJlIHVzZWQgZm9yIGNvbmZpZ3VyaW5nIHRoZSBkZWZhdWx0IGJlaGF2aW9yIG9mIHRoZSB7QGxpbmsgbmcuJHBhcnNlICRwYXJzZX1cblx0ICogIHNlcnZpY2UuXG5cdCAqL1xuXHRmdW5jdGlvbiAkUGFyc2VQcm92aWRlcigpIHtcblx0ICB2YXIgY2FjaGVEZWZhdWx0ID0gY3JlYXRlTWFwKCk7XG5cdCAgdmFyIGNhY2hlRXhwZW5zaXZlID0gY3JlYXRlTWFwKCk7XG5cdFxuXHQgIHRoaXMuJGdldCA9IFsnJGZpbHRlcicsIGZ1bmN0aW9uKCRmaWx0ZXIpIHtcblx0ICAgIHZhciBub1Vuc2FmZUV2YWwgPSBjc3AoKS5ub1Vuc2FmZUV2YWw7XG5cdCAgICB2YXIgJHBhcnNlT3B0aW9ucyA9IHtcblx0ICAgICAgICAgIGNzcDogbm9VbnNhZmVFdmFsLFxuXHQgICAgICAgICAgZXhwZW5zaXZlQ2hlY2tzOiBmYWxzZVxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgJHBhcnNlT3B0aW9uc0V4cGVuc2l2ZSA9IHtcblx0ICAgICAgICAgIGNzcDogbm9VbnNhZmVFdmFsLFxuXHQgICAgICAgICAgZXhwZW5zaXZlQ2hlY2tzOiB0cnVlXG5cdCAgICAgICAgfTtcblx0ICAgIHZhciBydW5uaW5nQ2hlY2tzRW5hYmxlZCA9IGZhbHNlO1xuXHRcblx0ICAgICRwYXJzZS4kJHJ1bm5pbmdFeHBlbnNpdmVDaGVja3MgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIHJ1bm5pbmdDaGVja3NFbmFibGVkO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gJHBhcnNlO1xuXHRcblx0ICAgIGZ1bmN0aW9uICRwYXJzZShleHAsIGludGVyY2VwdG9yRm4sIGV4cGVuc2l2ZUNoZWNrcykge1xuXHQgICAgICB2YXIgcGFyc2VkRXhwcmVzc2lvbiwgb25lVGltZSwgY2FjaGVLZXk7XG5cdFxuXHQgICAgICBleHBlbnNpdmVDaGVja3MgPSBleHBlbnNpdmVDaGVja3MgfHwgcnVubmluZ0NoZWNrc0VuYWJsZWQ7XG5cdFxuXHQgICAgICBzd2l0Y2ggKHR5cGVvZiBleHApIHtcblx0ICAgICAgICBjYXNlICdzdHJpbmcnOlxuXHQgICAgICAgICAgZXhwID0gZXhwLnRyaW0oKTtcblx0ICAgICAgICAgIGNhY2hlS2V5ID0gZXhwO1xuXHRcblx0ICAgICAgICAgIHZhciBjYWNoZSA9IChleHBlbnNpdmVDaGVja3MgPyBjYWNoZUV4cGVuc2l2ZSA6IGNhY2hlRGVmYXVsdCk7XG5cdCAgICAgICAgICBwYXJzZWRFeHByZXNzaW9uID0gY2FjaGVbY2FjaGVLZXldO1xuXHRcblx0ICAgICAgICAgIGlmICghcGFyc2VkRXhwcmVzc2lvbikge1xuXHQgICAgICAgICAgICBpZiAoZXhwLmNoYXJBdCgwKSA9PT0gJzonICYmIGV4cC5jaGFyQXQoMSkgPT09ICc6Jykge1xuXHQgICAgICAgICAgICAgIG9uZVRpbWUgPSB0cnVlO1xuXHQgICAgICAgICAgICAgIGV4cCA9IGV4cC5zdWJzdHJpbmcoMik7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgdmFyIHBhcnNlT3B0aW9ucyA9IGV4cGVuc2l2ZUNoZWNrcyA/ICRwYXJzZU9wdGlvbnNFeHBlbnNpdmUgOiAkcGFyc2VPcHRpb25zO1xuXHQgICAgICAgICAgICB2YXIgbGV4ZXIgPSBuZXcgTGV4ZXIocGFyc2VPcHRpb25zKTtcblx0ICAgICAgICAgICAgdmFyIHBhcnNlciA9IG5ldyBQYXJzZXIobGV4ZXIsICRmaWx0ZXIsIHBhcnNlT3B0aW9ucyk7XG5cdCAgICAgICAgICAgIHBhcnNlZEV4cHJlc3Npb24gPSBwYXJzZXIucGFyc2UoZXhwKTtcblx0ICAgICAgICAgICAgaWYgKHBhcnNlZEV4cHJlc3Npb24uY29uc3RhbnQpIHtcblx0ICAgICAgICAgICAgICBwYXJzZWRFeHByZXNzaW9uLiQkd2F0Y2hEZWxlZ2F0ZSA9IGNvbnN0YW50V2F0Y2hEZWxlZ2F0ZTtcblx0ICAgICAgICAgICAgfSBlbHNlIGlmIChvbmVUaW1lKSB7XG5cdCAgICAgICAgICAgICAgcGFyc2VkRXhwcmVzc2lvbi4kJHdhdGNoRGVsZWdhdGUgPSBwYXJzZWRFeHByZXNzaW9uLmxpdGVyYWwgP1xuXHQgICAgICAgICAgICAgICAgICBvbmVUaW1lTGl0ZXJhbFdhdGNoRGVsZWdhdGUgOiBvbmVUaW1lV2F0Y2hEZWxlZ2F0ZTtcblx0ICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJzZWRFeHByZXNzaW9uLmlucHV0cykge1xuXHQgICAgICAgICAgICAgIHBhcnNlZEV4cHJlc3Npb24uJCR3YXRjaERlbGVnYXRlID0gaW5wdXRzV2F0Y2hEZWxlZ2F0ZTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBpZiAoZXhwZW5zaXZlQ2hlY2tzKSB7XG5cdCAgICAgICAgICAgICAgcGFyc2VkRXhwcmVzc2lvbiA9IGV4cGVuc2l2ZUNoZWNrc0ludGVyY2VwdG9yKHBhcnNlZEV4cHJlc3Npb24pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGNhY2hlW2NhY2hlS2V5XSA9IHBhcnNlZEV4cHJlc3Npb247XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICByZXR1cm4gYWRkSW50ZXJjZXB0b3IocGFyc2VkRXhwcmVzc2lvbiwgaW50ZXJjZXB0b3JGbik7XG5cdFxuXHQgICAgICAgIGNhc2UgJ2Z1bmN0aW9uJzpcblx0ICAgICAgICAgIHJldHVybiBhZGRJbnRlcmNlcHRvcihleHAsIGludGVyY2VwdG9yRm4pO1xuXHRcblx0ICAgICAgICBkZWZhdWx0OlxuXHQgICAgICAgICAgcmV0dXJuIGFkZEludGVyY2VwdG9yKG5vb3AsIGludGVyY2VwdG9yRm4pO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gZXhwZW5zaXZlQ2hlY2tzSW50ZXJjZXB0b3IoZm4pIHtcblx0ICAgICAgaWYgKCFmbikgcmV0dXJuIGZuO1xuXHQgICAgICBleHBlbnNpdmVDaGVja0ZuLiQkd2F0Y2hEZWxlZ2F0ZSA9IGZuLiQkd2F0Y2hEZWxlZ2F0ZTtcblx0ICAgICAgZXhwZW5zaXZlQ2hlY2tGbi5hc3NpZ24gPSBleHBlbnNpdmVDaGVja3NJbnRlcmNlcHRvcihmbi5hc3NpZ24pO1xuXHQgICAgICBleHBlbnNpdmVDaGVja0ZuLmNvbnN0YW50ID0gZm4uY29uc3RhbnQ7XG5cdCAgICAgIGV4cGVuc2l2ZUNoZWNrRm4ubGl0ZXJhbCA9IGZuLmxpdGVyYWw7XG5cdCAgICAgIGZvciAodmFyIGkgPSAwOyBmbi5pbnB1dHMgJiYgaSA8IGZuLmlucHV0cy5sZW5ndGg7ICsraSkge1xuXHQgICAgICAgIGZuLmlucHV0c1tpXSA9IGV4cGVuc2l2ZUNoZWNrc0ludGVyY2VwdG9yKGZuLmlucHV0c1tpXSk7XG5cdCAgICAgIH1cblx0ICAgICAgZXhwZW5zaXZlQ2hlY2tGbi5pbnB1dHMgPSBmbi5pbnB1dHM7XG5cdFxuXHQgICAgICByZXR1cm4gZXhwZW5zaXZlQ2hlY2tGbjtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIGV4cGVuc2l2ZUNoZWNrRm4oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgICB2YXIgZXhwZW5zaXZlQ2hlY2tPbGRWYWx1ZSA9IHJ1bm5pbmdDaGVja3NFbmFibGVkO1xuXHQgICAgICAgIHJ1bm5pbmdDaGVja3NFbmFibGVkID0gdHJ1ZTtcblx0ICAgICAgICB0cnkge1xuXHQgICAgICAgICAgcmV0dXJuIGZuKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcblx0ICAgICAgICB9IGZpbmFsbHkge1xuXHQgICAgICAgICAgcnVubmluZ0NoZWNrc0VuYWJsZWQgPSBleHBlbnNpdmVDaGVja09sZFZhbHVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGV4cHJlc3Npb25JbnB1dERpcnR5Q2hlY2sobmV3VmFsdWUsIG9sZFZhbHVlT2ZWYWx1ZSkge1xuXHRcblx0ICAgICAgaWYgKG5ld1ZhbHVlID09IG51bGwgfHwgb2xkVmFsdWVPZlZhbHVlID09IG51bGwpIHsgLy8gbnVsbC91bmRlZmluZWRcblx0ICAgICAgICByZXR1cm4gbmV3VmFsdWUgPT09IG9sZFZhbHVlT2ZWYWx1ZTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgaWYgKHR5cGVvZiBuZXdWYWx1ZSA9PT0gJ29iamVjdCcpIHtcblx0XG5cdCAgICAgICAgLy8gYXR0ZW1wdCB0byBjb252ZXJ0IHRoZSB2YWx1ZSB0byBhIHByaW1pdGl2ZSB0eXBlXG5cdCAgICAgICAgLy8gVE9ETyhkb2NzKTogYWRkIGEgbm90ZSB0byBkb2NzIHRoYXQgYnkgaW1wbGVtZW50aW5nIHZhbHVlT2YgZXZlbiBvYmplY3RzIGFuZCBhcnJheXMgY2FuXG5cdCAgICAgICAgLy8gICAgICAgICAgICAgYmUgY2hlYXBseSBkaXJ0eS1jaGVja2VkXG5cdCAgICAgICAgbmV3VmFsdWUgPSBnZXRWYWx1ZU9mKG5ld1ZhbHVlKTtcblx0XG5cdCAgICAgICAgaWYgKHR5cGVvZiBuZXdWYWx1ZSA9PT0gJ29iamVjdCcpIHtcblx0ICAgICAgICAgIC8vIG9iamVjdHMvYXJyYXlzIGFyZSBub3Qgc3VwcG9ydGVkIC0gZGVlcC13YXRjaGluZyB0aGVtIHdvdWxkIGJlIHRvbyBleHBlbnNpdmVcblx0ICAgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8vIGZhbGwtdGhyb3VnaCB0byB0aGUgcHJpbWl0aXZlIGVxdWFsaXR5IGNoZWNrXG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vUHJpbWl0aXZlIG9yIE5hTlxuXHQgICAgICByZXR1cm4gbmV3VmFsdWUgPT09IG9sZFZhbHVlT2ZWYWx1ZSB8fCAobmV3VmFsdWUgIT09IG5ld1ZhbHVlICYmIG9sZFZhbHVlT2ZWYWx1ZSAhPT0gb2xkVmFsdWVPZlZhbHVlKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBpbnB1dHNXYXRjaERlbGVnYXRlKHNjb3BlLCBsaXN0ZW5lciwgb2JqZWN0RXF1YWxpdHksIHBhcnNlZEV4cHJlc3Npb24sIHByZXR0eVByaW50RXhwcmVzc2lvbikge1xuXHQgICAgICB2YXIgaW5wdXRFeHByZXNzaW9ucyA9IHBhcnNlZEV4cHJlc3Npb24uaW5wdXRzO1xuXHQgICAgICB2YXIgbGFzdFJlc3VsdDtcblx0XG5cdCAgICAgIGlmIChpbnB1dEV4cHJlc3Npb25zLmxlbmd0aCA9PT0gMSkge1xuXHQgICAgICAgIHZhciBvbGRJbnB1dFZhbHVlT2YgPSBleHByZXNzaW9uSW5wdXREaXJ0eUNoZWNrOyAvLyBpbml0IHRvIHNvbWV0aGluZyB1bmlxdWUgc28gdGhhdCBlcXVhbHMgY2hlY2sgZmFpbHNcblx0ICAgICAgICBpbnB1dEV4cHJlc3Npb25zID0gaW5wdXRFeHByZXNzaW9uc1swXTtcblx0ICAgICAgICByZXR1cm4gc2NvcGUuJHdhdGNoKGZ1bmN0aW9uIGV4cHJlc3Npb25JbnB1dFdhdGNoKHNjb3BlKSB7XG5cdCAgICAgICAgICB2YXIgbmV3SW5wdXRWYWx1ZSA9IGlucHV0RXhwcmVzc2lvbnMoc2NvcGUpO1xuXHQgICAgICAgICAgaWYgKCFleHByZXNzaW9uSW5wdXREaXJ0eUNoZWNrKG5ld0lucHV0VmFsdWUsIG9sZElucHV0VmFsdWVPZikpIHtcblx0ICAgICAgICAgICAgbGFzdFJlc3VsdCA9IHBhcnNlZEV4cHJlc3Npb24oc2NvcGUsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBbbmV3SW5wdXRWYWx1ZV0pO1xuXHQgICAgICAgICAgICBvbGRJbnB1dFZhbHVlT2YgPSBuZXdJbnB1dFZhbHVlICYmIGdldFZhbHVlT2YobmV3SW5wdXRWYWx1ZSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICByZXR1cm4gbGFzdFJlc3VsdDtcblx0ICAgICAgICB9LCBsaXN0ZW5lciwgb2JqZWN0RXF1YWxpdHksIHByZXR0eVByaW50RXhwcmVzc2lvbik7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHZhciBvbGRJbnB1dFZhbHVlT2ZWYWx1ZXMgPSBbXTtcblx0ICAgICAgdmFyIG9sZElucHV0VmFsdWVzID0gW107XG5cdCAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGlucHV0RXhwcmVzc2lvbnMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHQgICAgICAgIG9sZElucHV0VmFsdWVPZlZhbHVlc1tpXSA9IGV4cHJlc3Npb25JbnB1dERpcnR5Q2hlY2s7IC8vIGluaXQgdG8gc29tZXRoaW5nIHVuaXF1ZSBzbyB0aGF0IGVxdWFscyBjaGVjayBmYWlsc1xuXHQgICAgICAgIG9sZElucHV0VmFsdWVzW2ldID0gbnVsbDtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIHNjb3BlLiR3YXRjaChmdW5jdGlvbiBleHByZXNzaW9uSW5wdXRzV2F0Y2goc2NvcGUpIHtcblx0ICAgICAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xuXHRcblx0ICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBpbnB1dEV4cHJlc3Npb25zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0ICAgICAgICAgIHZhciBuZXdJbnB1dFZhbHVlID0gaW5wdXRFeHByZXNzaW9uc1tpXShzY29wZSk7XG5cdCAgICAgICAgICBpZiAoY2hhbmdlZCB8fCAoY2hhbmdlZCA9ICFleHByZXNzaW9uSW5wdXREaXJ0eUNoZWNrKG5ld0lucHV0VmFsdWUsIG9sZElucHV0VmFsdWVPZlZhbHVlc1tpXSkpKSB7XG5cdCAgICAgICAgICAgIG9sZElucHV0VmFsdWVzW2ldID0gbmV3SW5wdXRWYWx1ZTtcblx0ICAgICAgICAgICAgb2xkSW5wdXRWYWx1ZU9mVmFsdWVzW2ldID0gbmV3SW5wdXRWYWx1ZSAmJiBnZXRWYWx1ZU9mKG5ld0lucHV0VmFsdWUpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKGNoYW5nZWQpIHtcblx0ICAgICAgICAgIGxhc3RSZXN1bHQgPSBwYXJzZWRFeHByZXNzaW9uKHNjb3BlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgb2xkSW5wdXRWYWx1ZXMpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIGxhc3RSZXN1bHQ7XG5cdCAgICAgIH0sIGxpc3RlbmVyLCBvYmplY3RFcXVhbGl0eSwgcHJldHR5UHJpbnRFeHByZXNzaW9uKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBvbmVUaW1lV2F0Y2hEZWxlZ2F0ZShzY29wZSwgbGlzdGVuZXIsIG9iamVjdEVxdWFsaXR5LCBwYXJzZWRFeHByZXNzaW9uKSB7XG5cdCAgICAgIHZhciB1bndhdGNoLCBsYXN0VmFsdWU7XG5cdCAgICAgIHJldHVybiB1bndhdGNoID0gc2NvcGUuJHdhdGNoKGZ1bmN0aW9uIG9uZVRpbWVXYXRjaChzY29wZSkge1xuXHQgICAgICAgIHJldHVybiBwYXJzZWRFeHByZXNzaW9uKHNjb3BlKTtcblx0ICAgICAgfSwgZnVuY3Rpb24gb25lVGltZUxpc3RlbmVyKHZhbHVlLCBvbGQsIHNjb3BlKSB7XG5cdCAgICAgICAgbGFzdFZhbHVlID0gdmFsdWU7XG5cdCAgICAgICAgaWYgKGlzRnVuY3Rpb24obGlzdGVuZXIpKSB7XG5cdCAgICAgICAgICBsaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAoaXNEZWZpbmVkKHZhbHVlKSkge1xuXHQgICAgICAgICAgc2NvcGUuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBpZiAoaXNEZWZpbmVkKGxhc3RWYWx1ZSkpIHtcblx0ICAgICAgICAgICAgICB1bndhdGNoKCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSwgb2JqZWN0RXF1YWxpdHkpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIG9uZVRpbWVMaXRlcmFsV2F0Y2hEZWxlZ2F0ZShzY29wZSwgbGlzdGVuZXIsIG9iamVjdEVxdWFsaXR5LCBwYXJzZWRFeHByZXNzaW9uKSB7XG5cdCAgICAgIHZhciB1bndhdGNoLCBsYXN0VmFsdWU7XG5cdCAgICAgIHJldHVybiB1bndhdGNoID0gc2NvcGUuJHdhdGNoKGZ1bmN0aW9uIG9uZVRpbWVXYXRjaChzY29wZSkge1xuXHQgICAgICAgIHJldHVybiBwYXJzZWRFeHByZXNzaW9uKHNjb3BlKTtcblx0ICAgICAgfSwgZnVuY3Rpb24gb25lVGltZUxpc3RlbmVyKHZhbHVlLCBvbGQsIHNjb3BlKSB7XG5cdCAgICAgICAgbGFzdFZhbHVlID0gdmFsdWU7XG5cdCAgICAgICAgaWYgKGlzRnVuY3Rpb24obGlzdGVuZXIpKSB7XG5cdCAgICAgICAgICBsaXN0ZW5lci5jYWxsKHRoaXMsIHZhbHVlLCBvbGQsIHNjb3BlKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKGlzQWxsRGVmaW5lZCh2YWx1ZSkpIHtcblx0ICAgICAgICAgIHNjb3BlLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgaWYgKGlzQWxsRGVmaW5lZChsYXN0VmFsdWUpKSB1bndhdGNoKCk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sIG9iamVjdEVxdWFsaXR5KTtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIGlzQWxsRGVmaW5lZCh2YWx1ZSkge1xuXHQgICAgICAgIHZhciBhbGxEZWZpbmVkID0gdHJ1ZTtcblx0ICAgICAgICBmb3JFYWNoKHZhbHVlLCBmdW5jdGlvbih2YWwpIHtcblx0ICAgICAgICAgIGlmICghaXNEZWZpbmVkKHZhbCkpIGFsbERlZmluZWQgPSBmYWxzZTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgICByZXR1cm4gYWxsRGVmaW5lZDtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGNvbnN0YW50V2F0Y2hEZWxlZ2F0ZShzY29wZSwgbGlzdGVuZXIsIG9iamVjdEVxdWFsaXR5LCBwYXJzZWRFeHByZXNzaW9uKSB7XG5cdCAgICAgIHZhciB1bndhdGNoO1xuXHQgICAgICByZXR1cm4gdW53YXRjaCA9IHNjb3BlLiR3YXRjaChmdW5jdGlvbiBjb25zdGFudFdhdGNoKHNjb3BlKSB7XG5cdCAgICAgICAgdW53YXRjaCgpO1xuXHQgICAgICAgIHJldHVybiBwYXJzZWRFeHByZXNzaW9uKHNjb3BlKTtcblx0ICAgICAgfSwgbGlzdGVuZXIsIG9iamVjdEVxdWFsaXR5KTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBhZGRJbnRlcmNlcHRvcihwYXJzZWRFeHByZXNzaW9uLCBpbnRlcmNlcHRvckZuKSB7XG5cdCAgICAgIGlmICghaW50ZXJjZXB0b3JGbikgcmV0dXJuIHBhcnNlZEV4cHJlc3Npb247XG5cdCAgICAgIHZhciB3YXRjaERlbGVnYXRlID0gcGFyc2VkRXhwcmVzc2lvbi4kJHdhdGNoRGVsZWdhdGU7XG5cdCAgICAgIHZhciB1c2VJbnB1dHMgPSBmYWxzZTtcblx0XG5cdCAgICAgIHZhciByZWd1bGFyV2F0Y2ggPVxuXHQgICAgICAgICAgd2F0Y2hEZWxlZ2F0ZSAhPT0gb25lVGltZUxpdGVyYWxXYXRjaERlbGVnYXRlICYmXG5cdCAgICAgICAgICB3YXRjaERlbGVnYXRlICE9PSBvbmVUaW1lV2F0Y2hEZWxlZ2F0ZTtcblx0XG5cdCAgICAgIHZhciBmbiA9IHJlZ3VsYXJXYXRjaCA/IGZ1bmN0aW9uIHJlZ3VsYXJJbnRlcmNlcHRlZEV4cHJlc3Npb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcblx0ICAgICAgICB2YXIgdmFsdWUgPSB1c2VJbnB1dHMgJiYgaW5wdXRzID8gaW5wdXRzWzBdIDogcGFyc2VkRXhwcmVzc2lvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG5cdCAgICAgICAgcmV0dXJuIGludGVyY2VwdG9yRm4odmFsdWUsIHNjb3BlLCBsb2NhbHMpO1xuXHQgICAgICB9IDogZnVuY3Rpb24gb25lVGltZUludGVyY2VwdGVkRXhwcmVzc2lvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuXHQgICAgICAgIHZhciB2YWx1ZSA9IHBhcnNlZEV4cHJlc3Npb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuXHQgICAgICAgIHZhciByZXN1bHQgPSBpbnRlcmNlcHRvckZuKHZhbHVlLCBzY29wZSwgbG9jYWxzKTtcblx0ICAgICAgICAvLyB3ZSBvbmx5IHJldHVybiB0aGUgaW50ZXJjZXB0b3IncyByZXN1bHQgaWYgdGhlXG5cdCAgICAgICAgLy8gaW5pdGlhbCB2YWx1ZSBpcyBkZWZpbmVkIChmb3IgYmluZC1vbmNlKVxuXHQgICAgICAgIHJldHVybiBpc0RlZmluZWQodmFsdWUpID8gcmVzdWx0IDogdmFsdWU7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICAvLyBQcm9wYWdhdGUgJCR3YXRjaERlbGVnYXRlcyBvdGhlciB0aGVuIGlucHV0c1dhdGNoRGVsZWdhdGVcblx0ICAgICAgaWYgKHBhcnNlZEV4cHJlc3Npb24uJCR3YXRjaERlbGVnYXRlICYmXG5cdCAgICAgICAgICBwYXJzZWRFeHByZXNzaW9uLiQkd2F0Y2hEZWxlZ2F0ZSAhPT0gaW5wdXRzV2F0Y2hEZWxlZ2F0ZSkge1xuXHQgICAgICAgIGZuLiQkd2F0Y2hEZWxlZ2F0ZSA9IHBhcnNlZEV4cHJlc3Npb24uJCR3YXRjaERlbGVnYXRlO1xuXHQgICAgICB9IGVsc2UgaWYgKCFpbnRlcmNlcHRvckZuLiRzdGF0ZWZ1bCkge1xuXHQgICAgICAgIC8vIElmIHRoZXJlIGlzIGFuIGludGVyY2VwdG9yLCBidXQgbm8gd2F0Y2hEZWxlZ2F0ZSB0aGVuIHRyZWF0IHRoZSBpbnRlcmNlcHRvciBsaWtlXG5cdCAgICAgICAgLy8gd2UgdHJlYXQgZmlsdGVycyAtIGl0IGlzIGFzc3VtZWQgdG8gYmUgYSBwdXJlIGZ1bmN0aW9uIHVubGVzcyBmbGFnZ2VkIHdpdGggJHN0YXRlZnVsXG5cdCAgICAgICAgZm4uJCR3YXRjaERlbGVnYXRlID0gaW5wdXRzV2F0Y2hEZWxlZ2F0ZTtcblx0ICAgICAgICB1c2VJbnB1dHMgPSAhcGFyc2VkRXhwcmVzc2lvbi5pbnB1dHM7XG5cdCAgICAgICAgZm4uaW5wdXRzID0gcGFyc2VkRXhwcmVzc2lvbi5pbnB1dHMgPyBwYXJzZWRFeHByZXNzaW9uLmlucHV0cyA6IFtwYXJzZWRFeHByZXNzaW9uXTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIGZuO1xuXHQgICAgfVxuXHQgIH1dO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHNlcnZpY2Vcblx0ICogQG5hbWUgJHFcblx0ICogQHJlcXVpcmVzICRyb290U2NvcGVcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEEgc2VydmljZSB0aGF0IGhlbHBzIHlvdSBydW4gZnVuY3Rpb25zIGFzeW5jaHJvbm91c2x5LCBhbmQgdXNlIHRoZWlyIHJldHVybiB2YWx1ZXMgKG9yIGV4Y2VwdGlvbnMpXG5cdCAqIHdoZW4gdGhleSBhcmUgZG9uZSBwcm9jZXNzaW5nLlxuXHQgKlxuXHQgKiBUaGlzIGlzIGFuIGltcGxlbWVudGF0aW9uIG9mIHByb21pc2VzL2RlZmVycmVkIG9iamVjdHMgaW5zcGlyZWQgYnlcblx0ICogW0tyaXMgS293YWwncyBRXShodHRwczovL2dpdGh1Yi5jb20va3Jpc2tvd2FsL3EpLlxuXHQgKlxuXHQgKiAkcSBjYW4gYmUgdXNlZCBpbiB0d28gZmFzaGlvbnMgLS0tIG9uZSB3aGljaCBpcyBtb3JlIHNpbWlsYXIgdG8gS3JpcyBLb3dhbCdzIFEgb3IgalF1ZXJ5J3MgRGVmZXJyZWRcblx0ICogaW1wbGVtZW50YXRpb25zLCBhbmQgdGhlIG90aGVyIHdoaWNoIHJlc2VtYmxlcyBFUzYgcHJvbWlzZXMgdG8gc29tZSBkZWdyZWUuXG5cdCAqXG5cdCAqICMgJHEgY29uc3RydWN0b3Jcblx0ICpcblx0ICogVGhlIHN0cmVhbWxpbmVkIEVTNiBzdHlsZSBwcm9taXNlIGlzIGVzc2VudGlhbGx5IGp1c3QgdXNpbmcgJHEgYXMgYSBjb25zdHJ1Y3RvciB3aGljaCB0YWtlcyBhIGByZXNvbHZlcmBcblx0ICogZnVuY3Rpb24gYXMgdGhlIGZpcnN0IGFyZ3VtZW50LiBUaGlzIGlzIHNpbWlsYXIgdG8gdGhlIG5hdGl2ZSBQcm9taXNlIGltcGxlbWVudGF0aW9uIGZyb20gRVM2IEhhcm1vbnksXG5cdCAqIHNlZSBbTUROXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9Qcm9taXNlKS5cblx0ICpcblx0ICogV2hpbGUgdGhlIGNvbnN0cnVjdG9yLXN0eWxlIHVzZSBpcyBzdXBwb3J0ZWQsIG5vdCBhbGwgb2YgdGhlIHN1cHBvcnRpbmcgbWV0aG9kcyBmcm9tIEVTNiBIYXJtb255IHByb21pc2VzIGFyZVxuXHQgKiBhdmFpbGFibGUgeWV0LlxuXHQgKlxuXHQgKiBJdCBjYW4gYmUgdXNlZCBsaWtlIHNvOlxuXHQgKlxuXHQgKiBgYGBqc1xuXHQgKiAgIC8vIGZvciB0aGUgcHVycG9zZSBvZiB0aGlzIGV4YW1wbGUgbGV0J3MgYXNzdW1lIHRoYXQgdmFyaWFibGVzIGAkcWAgYW5kIGBva1RvR3JlZXRgXG5cdCAqICAgLy8gYXJlIGF2YWlsYWJsZSBpbiB0aGUgY3VycmVudCBsZXhpY2FsIHNjb3BlICh0aGV5IGNvdWxkIGhhdmUgYmVlbiBpbmplY3RlZCBvciBwYXNzZWQgaW4pLlxuXHQgKlxuXHQgKiAgIGZ1bmN0aW9uIGFzeW5jR3JlZXQobmFtZSkge1xuXHQgKiAgICAgLy8gcGVyZm9ybSBzb21lIGFzeW5jaHJvbm91cyBvcGVyYXRpb24sIHJlc29sdmUgb3IgcmVqZWN0IHRoZSBwcm9taXNlIHdoZW4gYXBwcm9wcmlhdGUuXG5cdCAqICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAqICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAqICAgICAgICAgaWYgKG9rVG9HcmVldChuYW1lKSkge1xuXHQgKiAgICAgICAgICAgcmVzb2x2ZSgnSGVsbG8sICcgKyBuYW1lICsgJyEnKTtcblx0ICogICAgICAgICB9IGVsc2Uge1xuXHQgKiAgICAgICAgICAgcmVqZWN0KCdHcmVldGluZyAnICsgbmFtZSArICcgaXMgbm90IGFsbG93ZWQuJyk7XG5cdCAqICAgICAgICAgfVxuXHQgKiAgICAgICB9LCAxMDAwKTtcblx0ICogICAgIH0pO1xuXHQgKiAgIH1cblx0ICpcblx0ICogICB2YXIgcHJvbWlzZSA9IGFzeW5jR3JlZXQoJ1JvYmluIEhvb2QnKTtcblx0ICogICBwcm9taXNlLnRoZW4oZnVuY3Rpb24oZ3JlZXRpbmcpIHtcblx0ICogICAgIGFsZXJ0KCdTdWNjZXNzOiAnICsgZ3JlZXRpbmcpO1xuXHQgKiAgIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuXHQgKiAgICAgYWxlcnQoJ0ZhaWxlZDogJyArIHJlYXNvbik7XG5cdCAqICAgfSk7XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBOb3RlOiBwcm9ncmVzcy9ub3RpZnkgY2FsbGJhY2tzIGFyZSBub3QgY3VycmVudGx5IHN1cHBvcnRlZCB2aWEgdGhlIEVTNi1zdHlsZSBpbnRlcmZhY2UuXG5cdCAqXG5cdCAqIE5vdGU6IHVubGlrZSBFUzYgYmVoYXZpb3IsIGFuIGV4Y2VwdGlvbiB0aHJvd24gaW4gdGhlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHdpbGwgTk9UIGltcGxpY2l0bHkgcmVqZWN0IHRoZSBwcm9taXNlLlxuXHQgKlxuXHQgKiBIb3dldmVyLCB0aGUgbW9yZSB0cmFkaXRpb25hbCBDb21tb25KUy1zdHlsZSB1c2FnZSBpcyBzdGlsbCBhdmFpbGFibGUsIGFuZCBkb2N1bWVudGVkIGJlbG93LlxuXHQgKlxuXHQgKiBbVGhlIENvbW1vbkpTIFByb21pc2UgcHJvcG9zYWxdKGh0dHA6Ly93aWtpLmNvbW1vbmpzLm9yZy93aWtpL1Byb21pc2VzKSBkZXNjcmliZXMgYSBwcm9taXNlIGFzIGFuXG5cdCAqIGludGVyZmFjZSBmb3IgaW50ZXJhY3Rpbmcgd2l0aCBhbiBvYmplY3QgdGhhdCByZXByZXNlbnRzIHRoZSByZXN1bHQgb2YgYW4gYWN0aW9uIHRoYXQgaXNcblx0ICogcGVyZm9ybWVkIGFzeW5jaHJvbm91c2x5LCBhbmQgbWF5IG9yIG1heSBub3QgYmUgZmluaXNoZWQgYXQgYW55IGdpdmVuIHBvaW50IGluIHRpbWUuXG5cdCAqXG5cdCAqIEZyb20gdGhlIHBlcnNwZWN0aXZlIG9mIGRlYWxpbmcgd2l0aCBlcnJvciBoYW5kbGluZywgZGVmZXJyZWQgYW5kIHByb21pc2UgQVBJcyBhcmUgdG9cblx0ICogYXN5bmNocm9ub3VzIHByb2dyYW1taW5nIHdoYXQgYHRyeWAsIGBjYXRjaGAgYW5kIGB0aHJvd2Aga2V5d29yZHMgYXJlIHRvIHN5bmNocm9ub3VzIHByb2dyYW1taW5nLlxuXHQgKlxuXHQgKiBgYGBqc1xuXHQgKiAgIC8vIGZvciB0aGUgcHVycG9zZSBvZiB0aGlzIGV4YW1wbGUgbGV0J3MgYXNzdW1lIHRoYXQgdmFyaWFibGVzIGAkcWAgYW5kIGBva1RvR3JlZXRgXG5cdCAqICAgLy8gYXJlIGF2YWlsYWJsZSBpbiB0aGUgY3VycmVudCBsZXhpY2FsIHNjb3BlICh0aGV5IGNvdWxkIGhhdmUgYmVlbiBpbmplY3RlZCBvciBwYXNzZWQgaW4pLlxuXHQgKlxuXHQgKiAgIGZ1bmN0aW9uIGFzeW5jR3JlZXQobmFtZSkge1xuXHQgKiAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblx0ICpcblx0ICogICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAqICAgICAgIGRlZmVycmVkLm5vdGlmeSgnQWJvdXQgdG8gZ3JlZXQgJyArIG5hbWUgKyAnLicpO1xuXHQgKlxuXHQgKiAgICAgICBpZiAob2tUb0dyZWV0KG5hbWUpKSB7XG5cdCAqICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgnSGVsbG8sICcgKyBuYW1lICsgJyEnKTtcblx0ICogICAgICAgfSBlbHNlIHtcblx0ICogICAgICAgICBkZWZlcnJlZC5yZWplY3QoJ0dyZWV0aW5nICcgKyBuYW1lICsgJyBpcyBub3QgYWxsb3dlZC4nKTtcblx0ICogICAgICAgfVxuXHQgKiAgICAgfSwgMTAwMCk7XG5cdCAqXG5cdCAqICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcblx0ICogICB9XG5cdCAqXG5cdCAqICAgdmFyIHByb21pc2UgPSBhc3luY0dyZWV0KCdSb2JpbiBIb29kJyk7XG5cdCAqICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKGdyZWV0aW5nKSB7XG5cdCAqICAgICBhbGVydCgnU3VjY2VzczogJyArIGdyZWV0aW5nKTtcblx0ICogICB9LCBmdW5jdGlvbihyZWFzb24pIHtcblx0ICogICAgIGFsZXJ0KCdGYWlsZWQ6ICcgKyByZWFzb24pO1xuXHQgKiAgIH0sIGZ1bmN0aW9uKHVwZGF0ZSkge1xuXHQgKiAgICAgYWxlcnQoJ0dvdCBub3RpZmljYXRpb246ICcgKyB1cGRhdGUpO1xuXHQgKiAgIH0pO1xuXHQgKiBgYGBcblx0ICpcblx0ICogQXQgZmlyc3QgaXQgbWlnaHQgbm90IGJlIG9idmlvdXMgd2h5IHRoaXMgZXh0cmEgY29tcGxleGl0eSBpcyB3b3J0aCB0aGUgdHJvdWJsZS4gVGhlIHBheW9mZlxuXHQgKiBjb21lcyBpbiB0aGUgd2F5IG9mIGd1YXJhbnRlZXMgdGhhdCBwcm9taXNlIGFuZCBkZWZlcnJlZCBBUElzIG1ha2UsIHNlZVxuXHQgKiBodHRwczovL2dpdGh1Yi5jb20va3Jpc2tvd2FsL3VuY29tbW9uanMvYmxvYi9tYXN0ZXIvcHJvbWlzZXMvc3BlY2lmaWNhdGlvbi5tZC5cblx0ICpcblx0ICogQWRkaXRpb25hbGx5IHRoZSBwcm9taXNlIGFwaSBhbGxvd3MgZm9yIGNvbXBvc2l0aW9uIHRoYXQgaXMgdmVyeSBoYXJkIHRvIGRvIHdpdGggdGhlXG5cdCAqIHRyYWRpdGlvbmFsIGNhbGxiYWNrIChbQ1BTXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NvbnRpbnVhdGlvbi1wYXNzaW5nX3N0eWxlKSkgYXBwcm9hY2guXG5cdCAqIEZvciBtb3JlIG9uIHRoaXMgcGxlYXNlIHNlZSB0aGUgW1EgZG9jdW1lbnRhdGlvbl0oaHR0cHM6Ly9naXRodWIuY29tL2tyaXNrb3dhbC9xKSBlc3BlY2lhbGx5IHRoZVxuXHQgKiBzZWN0aW9uIG9uIHNlcmlhbCBvciBwYXJhbGxlbCBqb2luaW5nIG9mIHByb21pc2VzLlxuXHQgKlxuXHQgKiAjIFRoZSBEZWZlcnJlZCBBUElcblx0ICpcblx0ICogQSBuZXcgaW5zdGFuY2Ugb2YgZGVmZXJyZWQgaXMgY29uc3RydWN0ZWQgYnkgY2FsbGluZyBgJHEuZGVmZXIoKWAuXG5cdCAqXG5cdCAqIFRoZSBwdXJwb3NlIG9mIHRoZSBkZWZlcnJlZCBvYmplY3QgaXMgdG8gZXhwb3NlIHRoZSBhc3NvY2lhdGVkIFByb21pc2UgaW5zdGFuY2UgYXMgd2VsbCBhcyBBUElzXG5cdCAqIHRoYXQgY2FuIGJlIHVzZWQgZm9yIHNpZ25hbGluZyB0aGUgc3VjY2Vzc2Z1bCBvciB1bnN1Y2Nlc3NmdWwgY29tcGxldGlvbiwgYXMgd2VsbCBhcyB0aGUgc3RhdHVzXG5cdCAqIG9mIHRoZSB0YXNrLlxuXHQgKlxuXHQgKiAqKk1ldGhvZHMqKlxuXHQgKlxuXHQgKiAtIGByZXNvbHZlKHZhbHVlKWAg4oCTIHJlc29sdmVzIHRoZSBkZXJpdmVkIHByb21pc2Ugd2l0aCB0aGUgYHZhbHVlYC4gSWYgdGhlIHZhbHVlIGlzIGEgcmVqZWN0aW9uXG5cdCAqICAgY29uc3RydWN0ZWQgdmlhIGAkcS5yZWplY3RgLCB0aGUgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIGluc3RlYWQuXG5cdCAqIC0gYHJlamVjdChyZWFzb24pYCDigJMgcmVqZWN0cyB0aGUgZGVyaXZlZCBwcm9taXNlIHdpdGggdGhlIGByZWFzb25gLiBUaGlzIGlzIGVxdWl2YWxlbnQgdG9cblx0ICogICByZXNvbHZpbmcgaXQgd2l0aCBhIHJlamVjdGlvbiBjb25zdHJ1Y3RlZCB2aWEgYCRxLnJlamVjdGAuXG5cdCAqIC0gYG5vdGlmeSh2YWx1ZSlgIC0gcHJvdmlkZXMgdXBkYXRlcyBvbiB0aGUgc3RhdHVzIG9mIHRoZSBwcm9taXNlJ3MgZXhlY3V0aW9uLiBUaGlzIG1heSBiZSBjYWxsZWRcblx0ICogICBtdWx0aXBsZSB0aW1lcyBiZWZvcmUgdGhlIHByb21pc2UgaXMgZWl0aGVyIHJlc29sdmVkIG9yIHJlamVjdGVkLlxuXHQgKlxuXHQgKiAqKlByb3BlcnRpZXMqKlxuXHQgKlxuXHQgKiAtIHByb21pc2Ug4oCTIGB7UHJvbWlzZX1gIOKAkyBwcm9taXNlIG9iamVjdCBhc3NvY2lhdGVkIHdpdGggdGhpcyBkZWZlcnJlZC5cblx0ICpcblx0ICpcblx0ICogIyBUaGUgUHJvbWlzZSBBUElcblx0ICpcblx0ICogQSBuZXcgcHJvbWlzZSBpbnN0YW5jZSBpcyBjcmVhdGVkIHdoZW4gYSBkZWZlcnJlZCBpbnN0YW5jZSBpcyBjcmVhdGVkIGFuZCBjYW4gYmUgcmV0cmlldmVkIGJ5XG5cdCAqIGNhbGxpbmcgYGRlZmVycmVkLnByb21pc2VgLlxuXHQgKlxuXHQgKiBUaGUgcHVycG9zZSBvZiB0aGUgcHJvbWlzZSBvYmplY3QgaXMgdG8gYWxsb3cgZm9yIGludGVyZXN0ZWQgcGFydGllcyB0byBnZXQgYWNjZXNzIHRvIHRoZSByZXN1bHRcblx0ICogb2YgdGhlIGRlZmVycmVkIHRhc2sgd2hlbiBpdCBjb21wbGV0ZXMuXG5cdCAqXG5cdCAqICoqTWV0aG9kcyoqXG5cdCAqXG5cdCAqIC0gYHRoZW4oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBub3RpZnlDYWxsYmFjaylgIOKAkyByZWdhcmRsZXNzIG9mIHdoZW4gdGhlIHByb21pc2Ugd2FzIG9yXG5cdCAqICAgd2lsbCBiZSByZXNvbHZlZCBvciByZWplY3RlZCwgYHRoZW5gIGNhbGxzIG9uZSBvZiB0aGUgc3VjY2VzcyBvciBlcnJvciBjYWxsYmFja3MgYXN5bmNocm9ub3VzbHlcblx0ICogICBhcyBzb29uIGFzIHRoZSByZXN1bHQgaXMgYXZhaWxhYmxlLiBUaGUgY2FsbGJhY2tzIGFyZSBjYWxsZWQgd2l0aCBhIHNpbmdsZSBhcmd1bWVudDogdGhlIHJlc3VsdFxuXHQgKiAgIG9yIHJlamVjdGlvbiByZWFzb24uIEFkZGl0aW9uYWxseSwgdGhlIG5vdGlmeSBjYWxsYmFjayBtYXkgYmUgY2FsbGVkIHplcm8gb3IgbW9yZSB0aW1lcyB0b1xuXHQgKiAgIHByb3ZpZGUgYSBwcm9ncmVzcyBpbmRpY2F0aW9uLCBiZWZvcmUgdGhlIHByb21pc2UgaXMgcmVzb2x2ZWQgb3IgcmVqZWN0ZWQuXG5cdCAqXG5cdCAqICAgVGhpcyBtZXRob2QgKnJldHVybnMgYSBuZXcgcHJvbWlzZSogd2hpY2ggaXMgcmVzb2x2ZWQgb3IgcmVqZWN0ZWQgdmlhIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlXG5cdCAqICAgYHN1Y2Nlc3NDYWxsYmFja2AsIGBlcnJvckNhbGxiYWNrYCAodW5sZXNzIHRoYXQgdmFsdWUgaXMgYSBwcm9taXNlLCBpbiB3aGljaCBjYXNlIGl0IGlzIHJlc29sdmVkXG5cdCAqICAgd2l0aCB0aGUgdmFsdWUgd2hpY2ggaXMgcmVzb2x2ZWQgaW4gdGhhdCBwcm9taXNlIHVzaW5nXG5cdCAqICAgW3Byb21pc2UgY2hhaW5pbmddKGh0dHA6Ly93d3cuaHRtbDVyb2Nrcy5jb20vZW4vdHV0b3JpYWxzL2VzNi9wcm9taXNlcy8jdG9jLXByb21pc2VzLXF1ZXVlcykpLlxuXHQgKiAgIEl0IGFsc28gbm90aWZpZXMgdmlhIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGBub3RpZnlDYWxsYmFja2AgbWV0aG9kLiBUaGUgcHJvbWlzZSBjYW5ub3QgYmVcblx0ICogICByZXNvbHZlZCBvciByZWplY3RlZCBmcm9tIHRoZSBub3RpZnlDYWxsYmFjayBtZXRob2QuXG5cdCAqXG5cdCAqIC0gYGNhdGNoKGVycm9yQ2FsbGJhY2spYCDigJMgc2hvcnRoYW5kIGZvciBgcHJvbWlzZS50aGVuKG51bGwsIGVycm9yQ2FsbGJhY2spYFxuXHQgKlxuXHQgKiAtIGBmaW5hbGx5KGNhbGxiYWNrLCBub3RpZnlDYWxsYmFjaylgIOKAkyBhbGxvd3MgeW91IHRvIG9ic2VydmUgZWl0aGVyIHRoZSBmdWxmaWxsbWVudCBvciByZWplY3Rpb24gb2YgYSBwcm9taXNlLFxuXHQgKiAgIGJ1dCB0byBkbyBzbyB3aXRob3V0IG1vZGlmeWluZyB0aGUgZmluYWwgdmFsdWUuIFRoaXMgaXMgdXNlZnVsIHRvIHJlbGVhc2UgcmVzb3VyY2VzIG9yIGRvIHNvbWVcblx0ICogICBjbGVhbi11cCB0aGF0IG5lZWRzIHRvIGJlIGRvbmUgd2hldGhlciB0aGUgcHJvbWlzZSB3YXMgcmVqZWN0ZWQgb3IgcmVzb2x2ZWQuIFNlZSB0aGUgW2Z1bGxcblx0ICogICBzcGVjaWZpY2F0aW9uXShodHRwczovL2dpdGh1Yi5jb20va3Jpc2tvd2FsL3Evd2lraS9BUEktUmVmZXJlbmNlI3Byb21pc2VmaW5hbGx5Y2FsbGJhY2spIGZvclxuXHQgKiAgIG1vcmUgaW5mb3JtYXRpb24uXG5cdCAqXG5cdCAqICMgQ2hhaW5pbmcgcHJvbWlzZXNcblx0ICpcblx0ICogQmVjYXVzZSBjYWxsaW5nIHRoZSBgdGhlbmAgbWV0aG9kIG9mIGEgcHJvbWlzZSByZXR1cm5zIGEgbmV3IGRlcml2ZWQgcHJvbWlzZSwgaXQgaXMgZWFzaWx5XG5cdCAqIHBvc3NpYmxlIHRvIGNyZWF0ZSBhIGNoYWluIG9mIHByb21pc2VzOlxuXHQgKlxuXHQgKiBgYGBqc1xuXHQgKiAgIHByb21pc2VCID0gcHJvbWlzZUEudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblx0ICogICAgIHJldHVybiByZXN1bHQgKyAxO1xuXHQgKiAgIH0pO1xuXHQgKlxuXHQgKiAgIC8vIHByb21pc2VCIHdpbGwgYmUgcmVzb2x2ZWQgaW1tZWRpYXRlbHkgYWZ0ZXIgcHJvbWlzZUEgaXMgcmVzb2x2ZWQgYW5kIGl0cyB2YWx1ZVxuXHQgKiAgIC8vIHdpbGwgYmUgdGhlIHJlc3VsdCBvZiBwcm9taXNlQSBpbmNyZW1lbnRlZCBieSAxXG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBJdCBpcyBwb3NzaWJsZSB0byBjcmVhdGUgY2hhaW5zIG9mIGFueSBsZW5ndGggYW5kIHNpbmNlIGEgcHJvbWlzZSBjYW4gYmUgcmVzb2x2ZWQgd2l0aCBhbm90aGVyXG5cdCAqIHByb21pc2UgKHdoaWNoIHdpbGwgZGVmZXIgaXRzIHJlc29sdXRpb24gZnVydGhlciksIGl0IGlzIHBvc3NpYmxlIHRvIHBhdXNlL2RlZmVyIHJlc29sdXRpb24gb2Zcblx0ICogdGhlIHByb21pc2VzIGF0IGFueSBwb2ludCBpbiB0aGUgY2hhaW4uIFRoaXMgbWFrZXMgaXQgcG9zc2libGUgdG8gaW1wbGVtZW50IHBvd2VyZnVsIEFQSXMgbGlrZVxuXHQgKiAkaHR0cCdzIHJlc3BvbnNlIGludGVyY2VwdG9ycy5cblx0ICpcblx0ICpcblx0ICogIyBEaWZmZXJlbmNlcyBiZXR3ZWVuIEtyaXMgS293YWwncyBRIGFuZCAkcVxuXHQgKlxuXHQgKiAgVGhlcmUgYXJlIHR3byBtYWluIGRpZmZlcmVuY2VzOlxuXHQgKlxuXHQgKiAtICRxIGlzIGludGVncmF0ZWQgd2l0aCB0aGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGV9IFNjb3BlIG1vZGVsIG9ic2VydmF0aW9uXG5cdCAqICAgbWVjaGFuaXNtIGluIGFuZ3VsYXIsIHdoaWNoIG1lYW5zIGZhc3RlciBwcm9wYWdhdGlvbiBvZiByZXNvbHV0aW9uIG9yIHJlamVjdGlvbiBpbnRvIHlvdXJcblx0ICogICBtb2RlbHMgYW5kIGF2b2lkaW5nIHVubmVjZXNzYXJ5IGJyb3dzZXIgcmVwYWludHMsIHdoaWNoIHdvdWxkIHJlc3VsdCBpbiBmbGlja2VyaW5nIFVJLlxuXHQgKiAtIFEgaGFzIG1hbnkgbW9yZSBmZWF0dXJlcyB0aGFuICRxLCBidXQgdGhhdCBjb21lcyBhdCBhIGNvc3Qgb2YgYnl0ZXMuICRxIGlzIHRpbnksIGJ1dCBjb250YWluc1xuXHQgKiAgIGFsbCB0aGUgaW1wb3J0YW50IGZ1bmN0aW9uYWxpdHkgbmVlZGVkIGZvciBjb21tb24gYXN5bmMgdGFza3MuXG5cdCAqXG5cdCAqICAjIFRlc3Rpbmdcblx0ICpcblx0ICogIGBgYGpzXG5cdCAqICAgIGl0KCdzaG91bGQgc2ltdWxhdGUgcHJvbWlzZScsIGluamVjdChmdW5jdGlvbigkcSwgJHJvb3RTY29wZSkge1xuXHQgKiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cdCAqICAgICAgdmFyIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlO1xuXHQgKiAgICAgIHZhciByZXNvbHZlZFZhbHVlO1xuXHQgKlxuXHQgKiAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSkgeyByZXNvbHZlZFZhbHVlID0gdmFsdWU7IH0pO1xuXHQgKiAgICAgIGV4cGVjdChyZXNvbHZlZFZhbHVlKS50b0JlVW5kZWZpbmVkKCk7XG5cdCAqXG5cdCAqICAgICAgLy8gU2ltdWxhdGUgcmVzb2x2aW5nIG9mIHByb21pc2Vcblx0ICogICAgICBkZWZlcnJlZC5yZXNvbHZlKDEyMyk7XG5cdCAqICAgICAgLy8gTm90ZSB0aGF0IHRoZSAndGhlbicgZnVuY3Rpb24gZG9lcyBub3QgZ2V0IGNhbGxlZCBzeW5jaHJvbm91c2x5LlxuXHQgKiAgICAgIC8vIFRoaXMgaXMgYmVjYXVzZSB3ZSB3YW50IHRoZSBwcm9taXNlIEFQSSB0byBhbHdheXMgYmUgYXN5bmMsIHdoZXRoZXIgb3Igbm90XG5cdCAqICAgICAgLy8gaXQgZ290IGNhbGxlZCBzeW5jaHJvbm91c2x5IG9yIGFzeW5jaHJvbm91c2x5LlxuXHQgKiAgICAgIGV4cGVjdChyZXNvbHZlZFZhbHVlKS50b0JlVW5kZWZpbmVkKCk7XG5cdCAqXG5cdCAqICAgICAgLy8gUHJvcGFnYXRlIHByb21pc2UgcmVzb2x1dGlvbiB0byAndGhlbicgZnVuY3Rpb25zIHVzaW5nICRhcHBseSgpLlxuXHQgKiAgICAgICRyb290U2NvcGUuJGFwcGx5KCk7XG5cdCAqICAgICAgZXhwZWN0KHJlc29sdmVkVmFsdWUpLnRvRXF1YWwoMTIzKTtcblx0ICogICAgfSkpO1xuXHQgKiAgYGBgXG5cdCAqXG5cdCAqIEBwYXJhbSB7ZnVuY3Rpb24oZnVuY3Rpb24sIGZ1bmN0aW9uKX0gcmVzb2x2ZXIgRnVuY3Rpb24gd2hpY2ggaXMgcmVzcG9uc2libGUgZm9yIHJlc29sdmluZyBvclxuXHQgKiAgIHJlamVjdGluZyB0aGUgbmV3bHkgY3JlYXRlZCBwcm9taXNlLiBUaGUgZmlyc3QgcGFyYW1ldGVyIGlzIGEgZnVuY3Rpb24gd2hpY2ggcmVzb2x2ZXMgdGhlXG5cdCAqICAgcHJvbWlzZSwgdGhlIHNlY29uZCBwYXJhbWV0ZXIgaXMgYSBmdW5jdGlvbiB3aGljaCByZWplY3RzIHRoZSBwcm9taXNlLlxuXHQgKlxuXHQgKiBAcmV0dXJucyB7UHJvbWlzZX0gVGhlIG5ld2x5IGNyZWF0ZWQgcHJvbWlzZS5cblx0ICovXG5cdGZ1bmN0aW9uICRRUHJvdmlkZXIoKSB7XG5cdFxuXHQgIHRoaXMuJGdldCA9IFsnJHJvb3RTY29wZScsICckZXhjZXB0aW9uSGFuZGxlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRleGNlcHRpb25IYW5kbGVyKSB7XG5cdCAgICByZXR1cm4gcUZhY3RvcnkoZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0ICAgICAgJHJvb3RTY29wZS4kZXZhbEFzeW5jKGNhbGxiYWNrKTtcblx0ICAgIH0sICRleGNlcHRpb25IYW5kbGVyKTtcblx0ICB9XTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gJCRRUHJvdmlkZXIoKSB7XG5cdCAgdGhpcy4kZ2V0ID0gWyckYnJvd3NlcicsICckZXhjZXB0aW9uSGFuZGxlcicsIGZ1bmN0aW9uKCRicm93c2VyLCAkZXhjZXB0aW9uSGFuZGxlcikge1xuXHQgICAgcmV0dXJuIHFGYWN0b3J5KGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG5cdCAgICAgICRicm93c2VyLmRlZmVyKGNhbGxiYWNrKTtcblx0ICAgIH0sICRleGNlcHRpb25IYW5kbGVyKTtcblx0ICB9XTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENvbnN0cnVjdHMgYSBwcm9taXNlIG1hbmFnZXIuXG5cdCAqXG5cdCAqIEBwYXJhbSB7ZnVuY3Rpb24oZnVuY3Rpb24pfSBuZXh0VGljayBGdW5jdGlvbiBmb3IgZXhlY3V0aW5nIGZ1bmN0aW9ucyBpbiB0aGUgbmV4dCB0dXJuLlxuXHQgKiBAcGFyYW0ge2Z1bmN0aW9uKC4uLiopfSBleGNlcHRpb25IYW5kbGVyIEZ1bmN0aW9uIGludG8gd2hpY2ggdW5leHBlY3RlZCBleGNlcHRpb25zIGFyZSBwYXNzZWQgZm9yXG5cdCAqICAgICBkZWJ1Z2dpbmcgcHVycG9zZXMuXG5cdCAqIEByZXR1cm5zIHtvYmplY3R9IFByb21pc2UgbWFuYWdlci5cblx0ICovXG5cdGZ1bmN0aW9uIHFGYWN0b3J5KG5leHRUaWNrLCBleGNlcHRpb25IYW5kbGVyKSB7XG5cdCAgdmFyICRxTWluRXJyID0gbWluRXJyKCckcScsIFR5cGVFcnJvcik7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSBuZy4kcSNkZWZlclxuXHQgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBDcmVhdGVzIGEgYERlZmVycmVkYCBvYmplY3Qgd2hpY2ggcmVwcmVzZW50cyBhIHRhc2sgd2hpY2ggd2lsbCBmaW5pc2ggaW4gdGhlIGZ1dHVyZS5cblx0ICAgKlxuXHQgICAqIEByZXR1cm5zIHtEZWZlcnJlZH0gUmV0dXJucyBhIG5ldyBpbnN0YW5jZSBvZiBkZWZlcnJlZC5cblx0ICAgKi9cblx0ICB2YXIgZGVmZXIgPSBmdW5jdGlvbigpIHtcblx0ICAgIHZhciBkID0gbmV3IERlZmVycmVkKCk7XG5cdCAgICAvL05lY2Vzc2FyeSB0byBzdXBwb3J0IHVuYm91bmQgZXhlY3V0aW9uIDovXG5cdCAgICBkLnJlc29sdmUgPSBzaW1wbGVCaW5kKGQsIGQucmVzb2x2ZSk7XG5cdCAgICBkLnJlamVjdCA9IHNpbXBsZUJpbmQoZCwgZC5yZWplY3QpO1xuXHQgICAgZC5ub3RpZnkgPSBzaW1wbGVCaW5kKGQsIGQubm90aWZ5KTtcblx0ICAgIHJldHVybiBkO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIFByb21pc2UoKSB7XG5cdCAgICB0aGlzLiQkc3RhdGUgPSB7IHN0YXR1czogMCB9O1xuXHQgIH1cblx0XG5cdCAgZXh0ZW5kKFByb21pc2UucHJvdG90eXBlLCB7XG5cdCAgICB0aGVuOiBmdW5jdGlvbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCwgcHJvZ3Jlc3NCYWNrKSB7XG5cdCAgICAgIGlmIChpc1VuZGVmaW5lZChvbkZ1bGZpbGxlZCkgJiYgaXNVbmRlZmluZWQob25SZWplY3RlZCkgJiYgaXNVbmRlZmluZWQocHJvZ3Jlc3NCYWNrKSkge1xuXHQgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgICB9XG5cdCAgICAgIHZhciByZXN1bHQgPSBuZXcgRGVmZXJyZWQoKTtcblx0XG5cdCAgICAgIHRoaXMuJCRzdGF0ZS5wZW5kaW5nID0gdGhpcy4kJHN0YXRlLnBlbmRpbmcgfHwgW107XG5cdCAgICAgIHRoaXMuJCRzdGF0ZS5wZW5kaW5nLnB1c2goW3Jlc3VsdCwgb25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQsIHByb2dyZXNzQmFja10pO1xuXHQgICAgICBpZiAodGhpcy4kJHN0YXRlLnN0YXR1cyA+IDApIHNjaGVkdWxlUHJvY2Vzc1F1ZXVlKHRoaXMuJCRzdGF0ZSk7XG5cdFxuXHQgICAgICByZXR1cm4gcmVzdWx0LnByb21pc2U7XG5cdCAgICB9LFxuXHRcblx0ICAgIFwiY2F0Y2hcIjogZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0ICAgICAgcmV0dXJuIHRoaXMudGhlbihudWxsLCBjYWxsYmFjayk7XG5cdCAgICB9LFxuXHRcblx0ICAgIFwiZmluYWxseVwiOiBmdW5jdGlvbihjYWxsYmFjaywgcHJvZ3Jlc3NCYWNrKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICByZXR1cm4gaGFuZGxlQ2FsbGJhY2sodmFsdWUsIHRydWUsIGNhbGxiYWNrKTtcblx0ICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcblx0ICAgICAgICByZXR1cm4gaGFuZGxlQ2FsbGJhY2soZXJyb3IsIGZhbHNlLCBjYWxsYmFjayk7XG5cdCAgICAgIH0sIHByb2dyZXNzQmFjayk7XG5cdCAgICB9XG5cdCAgfSk7XG5cdFxuXHQgIC8vRmFzdGVyLCBtb3JlIGJhc2ljIHRoYW4gYW5ndWxhci5iaW5kIGh0dHA6Ly9qc3BlcmYuY29tL2FuZ3VsYXItYmluZC12cy1jdXN0b20tdnMtbmF0aXZlXG5cdCAgZnVuY3Rpb24gc2ltcGxlQmluZChjb250ZXh0LCBmbikge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgIGZuLmNhbGwoY29udGV4dCwgdmFsdWUpO1xuXHQgICAgfTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIHByb2Nlc3NRdWV1ZShzdGF0ZSkge1xuXHQgICAgdmFyIGZuLCBkZWZlcnJlZCwgcGVuZGluZztcblx0XG5cdCAgICBwZW5kaW5nID0gc3RhdGUucGVuZGluZztcblx0ICAgIHN0YXRlLnByb2Nlc3NTY2hlZHVsZWQgPSBmYWxzZTtcblx0ICAgIHN0YXRlLnBlbmRpbmcgPSB1bmRlZmluZWQ7XG5cdCAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBwZW5kaW5nLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcblx0ICAgICAgZGVmZXJyZWQgPSBwZW5kaW5nW2ldWzBdO1xuXHQgICAgICBmbiA9IHBlbmRpbmdbaV1bc3RhdGUuc3RhdHVzXTtcblx0ICAgICAgdHJ5IHtcblx0ICAgICAgICBpZiAoaXNGdW5jdGlvbihmbikpIHtcblx0ICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZm4oc3RhdGUudmFsdWUpKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLnN0YXR1cyA9PT0gMSkge1xuXHQgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShzdGF0ZS52YWx1ZSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGRlZmVycmVkLnJlamVjdChzdGF0ZS52YWx1ZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgZGVmZXJyZWQucmVqZWN0KGUpO1xuXHQgICAgICAgIGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIHNjaGVkdWxlUHJvY2Vzc1F1ZXVlKHN0YXRlKSB7XG5cdCAgICBpZiAoc3RhdGUucHJvY2Vzc1NjaGVkdWxlZCB8fCAhc3RhdGUucGVuZGluZykgcmV0dXJuO1xuXHQgICAgc3RhdGUucHJvY2Vzc1NjaGVkdWxlZCA9IHRydWU7XG5cdCAgICBuZXh0VGljayhmdW5jdGlvbigpIHsgcHJvY2Vzc1F1ZXVlKHN0YXRlKTsgfSk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBEZWZlcnJlZCgpIHtcblx0ICAgIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKCk7XG5cdCAgfVxuXHRcblx0ICBleHRlbmQoRGVmZXJyZWQucHJvdG90eXBlLCB7XG5cdCAgICByZXNvbHZlOiBmdW5jdGlvbih2YWwpIHtcblx0ICAgICAgaWYgKHRoaXMucHJvbWlzZS4kJHN0YXRlLnN0YXR1cykgcmV0dXJuO1xuXHQgICAgICBpZiAodmFsID09PSB0aGlzLnByb21pc2UpIHtcblx0ICAgICAgICB0aGlzLiQkcmVqZWN0KCRxTWluRXJyKFxuXHQgICAgICAgICAgJ3FjeWNsZScsXG5cdCAgICAgICAgICBcIkV4cGVjdGVkIHByb21pc2UgdG8gYmUgcmVzb2x2ZWQgd2l0aCB2YWx1ZSBvdGhlciB0aGFuIGl0c2VsZiAnezB9J1wiLFxuXHQgICAgICAgICAgdmFsKSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdGhpcy4kJHJlc29sdmUodmFsKTtcblx0ICAgICAgfVxuXHRcblx0ICAgIH0sXG5cdFxuXHQgICAgJCRyZXNvbHZlOiBmdW5jdGlvbih2YWwpIHtcblx0ICAgICAgdmFyIHRoZW47XG5cdCAgICAgIHZhciB0aGF0ID0gdGhpcztcblx0ICAgICAgdmFyIGRvbmUgPSBmYWxzZTtcblx0ICAgICAgdHJ5IHtcblx0ICAgICAgICBpZiAoKGlzT2JqZWN0KHZhbCkgfHwgaXNGdW5jdGlvbih2YWwpKSkgdGhlbiA9IHZhbCAmJiB2YWwudGhlbjtcblx0ICAgICAgICBpZiAoaXNGdW5jdGlvbih0aGVuKSkge1xuXHQgICAgICAgICAgdGhpcy5wcm9taXNlLiQkc3RhdGUuc3RhdHVzID0gLTE7XG5cdCAgICAgICAgICB0aGVuLmNhbGwodmFsLCByZXNvbHZlUHJvbWlzZSwgcmVqZWN0UHJvbWlzZSwgc2ltcGxlQmluZCh0aGlzLCB0aGlzLm5vdGlmeSkpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB0aGlzLnByb21pc2UuJCRzdGF0ZS52YWx1ZSA9IHZhbDtcblx0ICAgICAgICAgIHRoaXMucHJvbWlzZS4kJHN0YXRlLnN0YXR1cyA9IDE7XG5cdCAgICAgICAgICBzY2hlZHVsZVByb2Nlc3NRdWV1ZSh0aGlzLnByb21pc2UuJCRzdGF0ZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgcmVqZWN0UHJvbWlzZShlKTtcblx0ICAgICAgICBleGNlcHRpb25IYW5kbGVyKGUpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBmdW5jdGlvbiByZXNvbHZlUHJvbWlzZSh2YWwpIHtcblx0ICAgICAgICBpZiAoZG9uZSkgcmV0dXJuO1xuXHQgICAgICAgIGRvbmUgPSB0cnVlO1xuXHQgICAgICAgIHRoYXQuJCRyZXNvbHZlKHZhbCk7XG5cdCAgICAgIH1cblx0ICAgICAgZnVuY3Rpb24gcmVqZWN0UHJvbWlzZSh2YWwpIHtcblx0ICAgICAgICBpZiAoZG9uZSkgcmV0dXJuO1xuXHQgICAgICAgIGRvbmUgPSB0cnVlO1xuXHQgICAgICAgIHRoYXQuJCRyZWplY3QodmFsKTtcblx0ICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICByZWplY3Q6IGZ1bmN0aW9uKHJlYXNvbikge1xuXHQgICAgICBpZiAodGhpcy5wcm9taXNlLiQkc3RhdGUuc3RhdHVzKSByZXR1cm47XG5cdCAgICAgIHRoaXMuJCRyZWplY3QocmVhc29uKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgJCRyZWplY3Q6IGZ1bmN0aW9uKHJlYXNvbikge1xuXHQgICAgICB0aGlzLnByb21pc2UuJCRzdGF0ZS52YWx1ZSA9IHJlYXNvbjtcblx0ICAgICAgdGhpcy5wcm9taXNlLiQkc3RhdGUuc3RhdHVzID0gMjtcblx0ICAgICAgc2NoZWR1bGVQcm9jZXNzUXVldWUodGhpcy5wcm9taXNlLiQkc3RhdGUpO1xuXHQgICAgfSxcblx0XG5cdCAgICBub3RpZnk6IGZ1bmN0aW9uKHByb2dyZXNzKSB7XG5cdCAgICAgIHZhciBjYWxsYmFja3MgPSB0aGlzLnByb21pc2UuJCRzdGF0ZS5wZW5kaW5nO1xuXHRcblx0ICAgICAgaWYgKCh0aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXMgPD0gMCkgJiYgY2FsbGJhY2tzICYmIGNhbGxiYWNrcy5sZW5ndGgpIHtcblx0ICAgICAgICBuZXh0VGljayhmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHZhciBjYWxsYmFjaywgcmVzdWx0O1xuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gY2FsbGJhY2tzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0ICAgICAgICAgICAgcmVzdWx0ID0gY2FsbGJhY2tzW2ldWzBdO1xuXHQgICAgICAgICAgICBjYWxsYmFjayA9IGNhbGxiYWNrc1tpXVszXTtcblx0ICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICByZXN1bHQubm90aWZ5KGlzRnVuY3Rpb24oY2FsbGJhY2spID8gY2FsbGJhY2socHJvZ3Jlc3MpIDogcHJvZ3Jlc3MpO1xuXHQgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgICAgICAgZXhjZXB0aW9uSGFuZGxlcihlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkcSNyZWplY3Rcblx0ICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogQ3JlYXRlcyBhIHByb21pc2UgdGhhdCBpcyByZXNvbHZlZCBhcyByZWplY3RlZCB3aXRoIHRoZSBzcGVjaWZpZWQgYHJlYXNvbmAuIFRoaXMgYXBpIHNob3VsZCBiZVxuXHQgICAqIHVzZWQgdG8gZm9yd2FyZCByZWplY3Rpb24gaW4gYSBjaGFpbiBvZiBwcm9taXNlcy4gSWYgeW91IGFyZSBkZWFsaW5nIHdpdGggdGhlIGxhc3QgcHJvbWlzZSBpblxuXHQgICAqIGEgcHJvbWlzZSBjaGFpbiwgeW91IGRvbid0IG5lZWQgdG8gd29ycnkgYWJvdXQgaXQuXG5cdCAgICpcblx0ICAgKiBXaGVuIGNvbXBhcmluZyBkZWZlcnJlZHMvcHJvbWlzZXMgdG8gdGhlIGZhbWlsaWFyIGJlaGF2aW9yIG9mIHRyeS9jYXRjaC90aHJvdywgdGhpbmsgb2Zcblx0ICAgKiBgcmVqZWN0YCBhcyB0aGUgYHRocm93YCBrZXl3b3JkIGluIEphdmFTY3JpcHQuIFRoaXMgYWxzbyBtZWFucyB0aGF0IGlmIHlvdSBcImNhdGNoXCIgYW4gZXJyb3IgdmlhXG5cdCAgICogYSBwcm9taXNlIGVycm9yIGNhbGxiYWNrIGFuZCB5b3Ugd2FudCB0byBmb3J3YXJkIHRoZSBlcnJvciB0byB0aGUgcHJvbWlzZSBkZXJpdmVkIGZyb20gdGhlXG5cdCAgICogY3VycmVudCBwcm9taXNlLCB5b3UgaGF2ZSB0byBcInJldGhyb3dcIiB0aGUgZXJyb3IgYnkgcmV0dXJuaW5nIGEgcmVqZWN0aW9uIGNvbnN0cnVjdGVkIHZpYVxuXHQgICAqIGByZWplY3RgLlxuXHQgICAqXG5cdCAgICogYGBganNcblx0ICAgKiAgIHByb21pc2VCID0gcHJvbWlzZUEudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblx0ICAgKiAgICAgLy8gc3VjY2VzczogZG8gc29tZXRoaW5nIGFuZCByZXNvbHZlIHByb21pc2VCXG5cdCAgICogICAgIC8vICAgICAgICAgIHdpdGggdGhlIG9sZCBvciBhIG5ldyByZXN1bHRcblx0ICAgKiAgICAgcmV0dXJuIHJlc3VsdDtcblx0ICAgKiAgIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuXHQgICAqICAgICAvLyBlcnJvcjogaGFuZGxlIHRoZSBlcnJvciBpZiBwb3NzaWJsZSBhbmRcblx0ICAgKiAgICAgLy8gICAgICAgIHJlc29sdmUgcHJvbWlzZUIgd2l0aCBuZXdQcm9taXNlT3JWYWx1ZSxcblx0ICAgKiAgICAgLy8gICAgICAgIG90aGVyd2lzZSBmb3J3YXJkIHRoZSByZWplY3Rpb24gdG8gcHJvbWlzZUJcblx0ICAgKiAgICAgaWYgKGNhbkhhbmRsZShyZWFzb24pKSB7XG5cdCAgICogICAgICAvLyBoYW5kbGUgdGhlIGVycm9yIGFuZCByZWNvdmVyXG5cdCAgICogICAgICByZXR1cm4gbmV3UHJvbWlzZU9yVmFsdWU7XG5cdCAgICogICAgIH1cblx0ICAgKiAgICAgcmV0dXJuICRxLnJlamVjdChyZWFzb24pO1xuXHQgICAqICAgfSk7XG5cdCAgICogYGBgXG5cdCAgICpcblx0ICAgKiBAcGFyYW0geyp9IHJlYXNvbiBDb25zdGFudCwgbWVzc2FnZSwgZXhjZXB0aW9uIG9yIGFuIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIHJlamVjdGlvbiByZWFzb24uXG5cdCAgICogQHJldHVybnMge1Byb21pc2V9IFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2FzIGFscmVhZHkgcmVzb2x2ZWQgYXMgcmVqZWN0ZWQgd2l0aCB0aGUgYHJlYXNvbmAuXG5cdCAgICovXG5cdCAgdmFyIHJlamVjdCA9IGZ1bmN0aW9uKHJlYXNvbikge1xuXHQgICAgdmFyIHJlc3VsdCA9IG5ldyBEZWZlcnJlZCgpO1xuXHQgICAgcmVzdWx0LnJlamVjdChyZWFzb24pO1xuXHQgICAgcmV0dXJuIHJlc3VsdC5wcm9taXNlO1xuXHQgIH07XG5cdFxuXHQgIHZhciBtYWtlUHJvbWlzZSA9IGZ1bmN0aW9uIG1ha2VQcm9taXNlKHZhbHVlLCByZXNvbHZlZCkge1xuXHQgICAgdmFyIHJlc3VsdCA9IG5ldyBEZWZlcnJlZCgpO1xuXHQgICAgaWYgKHJlc29sdmVkKSB7XG5cdCAgICAgIHJlc3VsdC5yZXNvbHZlKHZhbHVlKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHJlc3VsdC5yZWplY3QodmFsdWUpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIHJlc3VsdC5wcm9taXNlO1xuXHQgIH07XG5cdFxuXHQgIHZhciBoYW5kbGVDYWxsYmFjayA9IGZ1bmN0aW9uIGhhbmRsZUNhbGxiYWNrKHZhbHVlLCBpc1Jlc29sdmVkLCBjYWxsYmFjaykge1xuXHQgICAgdmFyIGNhbGxiYWNrT3V0cHV0ID0gbnVsbDtcblx0ICAgIHRyeSB7XG5cdCAgICAgIGlmIChpc0Z1bmN0aW9uKGNhbGxiYWNrKSkgY2FsbGJhY2tPdXRwdXQgPSBjYWxsYmFjaygpO1xuXHQgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICByZXR1cm4gbWFrZVByb21pc2UoZSwgZmFsc2UpO1xuXHQgICAgfVxuXHQgICAgaWYgKGlzUHJvbWlzZUxpa2UoY2FsbGJhY2tPdXRwdXQpKSB7XG5cdCAgICAgIHJldHVybiBjYWxsYmFja091dHB1dC50aGVuKGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHJldHVybiBtYWtlUHJvbWlzZSh2YWx1ZSwgaXNSZXNvbHZlZCk7XG5cdCAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG5cdCAgICAgICAgcmV0dXJuIG1ha2VQcm9taXNlKGVycm9yLCBmYWxzZSk7XG5cdCAgICAgIH0pO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgcmV0dXJuIG1ha2VQcm9taXNlKHZhbHVlLCBpc1Jlc29sdmVkKTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgJHEjd2hlblxuXHQgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBXcmFwcyBhbiBvYmplY3QgdGhhdCBtaWdodCBiZSBhIHZhbHVlIG9yIGEgKDNyZCBwYXJ0eSkgdGhlbi1hYmxlIHByb21pc2UgaW50byBhICRxIHByb21pc2UuXG5cdCAgICogVGhpcyBpcyB1c2VmdWwgd2hlbiB5b3UgYXJlIGRlYWxpbmcgd2l0aCBhbiBvYmplY3QgdGhhdCBtaWdodCBvciBtaWdodCBub3QgYmUgYSBwcm9taXNlLCBvciBpZlxuXHQgICAqIHRoZSBwcm9taXNlIGNvbWVzIGZyb20gYSBzb3VyY2UgdGhhdCBjYW4ndCBiZSB0cnVzdGVkLlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHsqfSB2YWx1ZSBWYWx1ZSBvciBhIHByb21pc2Vcblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9uPX0gc3VjY2Vzc0NhbGxiYWNrXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbj19IGVycm9yQ2FsbGJhY2tcblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9uPX0gcHJvZ3Jlc3NDYWxsYmFja1xuXHQgICAqIEByZXR1cm5zIHtQcm9taXNlfSBSZXR1cm5zIGEgcHJvbWlzZSBvZiB0aGUgcGFzc2VkIHZhbHVlIG9yIHByb21pc2Vcblx0ICAgKi9cblx0XG5cdFxuXHQgIHZhciB3aGVuID0gZnVuY3Rpb24odmFsdWUsIGNhbGxiYWNrLCBlcnJiYWNrLCBwcm9ncmVzc0JhY2spIHtcblx0ICAgIHZhciByZXN1bHQgPSBuZXcgRGVmZXJyZWQoKTtcblx0ICAgIHJlc3VsdC5yZXNvbHZlKHZhbHVlKTtcblx0ICAgIHJldHVybiByZXN1bHQucHJvbWlzZS50aGVuKGNhbGxiYWNrLCBlcnJiYWNrLCBwcm9ncmVzc0JhY2spO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkcSNyZXNvbHZlXG5cdCAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIEFsaWFzIG9mIHtAbGluayBuZy4kcSN3aGVuIHdoZW59IHRvIG1haW50YWluIG5hbWluZyBjb25zaXN0ZW5jeSB3aXRoIEVTNi5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVmFsdWUgb3IgYSBwcm9taXNlXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbj19IHN1Y2Nlc3NDYWxsYmFja1xuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb249fSBlcnJvckNhbGxiYWNrXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbj19IHByb2dyZXNzQ2FsbGJhY2tcblx0ICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gUmV0dXJucyBhIHByb21pc2Ugb2YgdGhlIHBhc3NlZCB2YWx1ZSBvciBwcm9taXNlXG5cdCAgICovXG5cdCAgdmFyIHJlc29sdmUgPSB3aGVuO1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgJHEjYWxsXG5cdCAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIENvbWJpbmVzIG11bHRpcGxlIHByb21pc2VzIGludG8gYSBzaW5nbGUgcHJvbWlzZSB0aGF0IGlzIHJlc29sdmVkIHdoZW4gYWxsIG9mIHRoZSBpbnB1dFxuXHQgICAqIHByb21pc2VzIGFyZSByZXNvbHZlZC5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7QXJyYXkuPFByb21pc2U+fE9iamVjdC48UHJvbWlzZT59IHByb21pc2VzIEFuIGFycmF5IG9yIGhhc2ggb2YgcHJvbWlzZXMuXG5cdCAgICogQHJldHVybnMge1Byb21pc2V9IFJldHVybnMgYSBzaW5nbGUgcHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCBhbiBhcnJheS9oYXNoIG9mIHZhbHVlcyxcblx0ICAgKiAgIGVhY2ggdmFsdWUgY29ycmVzcG9uZGluZyB0byB0aGUgcHJvbWlzZSBhdCB0aGUgc2FtZSBpbmRleC9rZXkgaW4gdGhlIGBwcm9taXNlc2AgYXJyYXkvaGFzaC5cblx0ICAgKiAgIElmIGFueSBvZiB0aGUgcHJvbWlzZXMgaXMgcmVzb2x2ZWQgd2l0aCBhIHJlamVjdGlvbiwgdGhpcyByZXN1bHRpbmcgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkXG5cdCAgICogICB3aXRoIHRoZSBzYW1lIHJlamVjdGlvbiB2YWx1ZS5cblx0ICAgKi9cblx0XG5cdCAgZnVuY3Rpb24gYWxsKHByb21pc2VzKSB7XG5cdCAgICB2YXIgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKSxcblx0ICAgICAgICBjb3VudGVyID0gMCxcblx0ICAgICAgICByZXN1bHRzID0gaXNBcnJheShwcm9taXNlcykgPyBbXSA6IHt9O1xuXHRcblx0ICAgIGZvckVhY2gocHJvbWlzZXMsIGZ1bmN0aW9uKHByb21pc2UsIGtleSkge1xuXHQgICAgICBjb3VudGVyKys7XG5cdCAgICAgIHdoZW4ocHJvbWlzZSkudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgIGlmIChyZXN1bHRzLmhhc093blByb3BlcnR5KGtleSkpIHJldHVybjtcblx0ICAgICAgICByZXN1bHRzW2tleV0gPSB2YWx1ZTtcblx0ICAgICAgICBpZiAoISgtLWNvdW50ZXIpKSBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdHMpO1xuXHQgICAgICB9LCBmdW5jdGlvbihyZWFzb24pIHtcblx0ICAgICAgICBpZiAocmVzdWx0cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSByZXR1cm47XG5cdCAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlYXNvbik7XG5cdCAgICAgIH0pO1xuXHQgICAgfSk7XG5cdFxuXHQgICAgaWYgKGNvdW50ZXIgPT09IDApIHtcblx0ICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHRzKTtcblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcblx0ICB9XG5cdFxuXHQgIHZhciAkUSA9IGZ1bmN0aW9uIFEocmVzb2x2ZXIpIHtcblx0ICAgIGlmICghaXNGdW5jdGlvbihyZXNvbHZlcikpIHtcblx0ICAgICAgdGhyb3cgJHFNaW5FcnIoJ25vcnNsdnInLCBcIkV4cGVjdGVkIHJlc29sdmVyRm4sIGdvdCAnezB9J1wiLCByZXNvbHZlcik7XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIGRlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XG5cdFxuXHQgICAgZnVuY3Rpb24gcmVzb2x2ZUZuKHZhbHVlKSB7XG5cdCAgICAgIGRlZmVycmVkLnJlc29sdmUodmFsdWUpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHJlamVjdEZuKHJlYXNvbikge1xuXHQgICAgICBkZWZlcnJlZC5yZWplY3QocmVhc29uKTtcblx0ICAgIH1cblx0XG5cdCAgICByZXNvbHZlcihyZXNvbHZlRm4sIHJlamVjdEZuKTtcblx0XG5cdCAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcblx0ICB9O1xuXHRcblx0ICAvLyBMZXQncyBtYWtlIHRoZSBpbnN0YW5jZW9mIG9wZXJhdG9yIHdvcmsgZm9yIHByb21pc2VzLCBzbyB0aGF0XG5cdCAgLy8gYG5ldyAkcShmbikgaW5zdGFuY2VvZiAkcWAgd291bGQgZXZhbHVhdGUgdG8gdHJ1ZS5cblx0ICAkUS5wcm90b3R5cGUgPSBQcm9taXNlLnByb3RvdHlwZTtcblx0XG5cdCAgJFEuZGVmZXIgPSBkZWZlcjtcblx0ICAkUS5yZWplY3QgPSByZWplY3Q7XG5cdCAgJFEud2hlbiA9IHdoZW47XG5cdCAgJFEucmVzb2x2ZSA9IHJlc29sdmU7XG5cdCAgJFEuYWxsID0gYWxsO1xuXHRcblx0ICByZXR1cm4gJFE7XG5cdH1cblx0XG5cdGZ1bmN0aW9uICQkUkFGUHJvdmlkZXIoKSB7IC8vckFGXG5cdCAgdGhpcy4kZ2V0ID0gWyckd2luZG93JywgJyR0aW1lb3V0JywgZnVuY3Rpb24oJHdpbmRvdywgJHRpbWVvdXQpIHtcblx0ICAgIHZhciByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSAkd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xuXHRcblx0ICAgIHZhciBjYW5jZWxBbmltYXRpb25GcmFtZSA9ICR3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUgfHxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR3aW5kb3cud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWUgfHxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR3aW5kb3cud2Via2l0Q2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xuXHRcblx0ICAgIHZhciByYWZTdXBwb3J0ZWQgPSAhIXJlcXVlc3RBbmltYXRpb25GcmFtZTtcblx0ICAgIHZhciByYWYgPSByYWZTdXBwb3J0ZWRcblx0ICAgICAgPyBmdW5jdGlvbihmbikge1xuXHQgICAgICAgICAgdmFyIGlkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZuKTtcblx0ICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoaWQpO1xuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9XG5cdCAgICAgIDogZnVuY3Rpb24oZm4pIHtcblx0ICAgICAgICAgIHZhciB0aW1lciA9ICR0aW1lb3V0KGZuLCAxNi42NiwgZmFsc2UpOyAvLyAxMDAwIC8gNjAgPSAxNi42NjZcblx0ICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcblx0ICAgICAgICAgIH07XG5cdCAgICAgICAgfTtcblx0XG5cdCAgICByYWYuc3VwcG9ydGVkID0gcmFmU3VwcG9ydGVkO1xuXHRcblx0ICAgIHJldHVybiByYWY7XG5cdCAgfV07XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBERVNJR04gTk9URVNcblx0ICpcblx0ICogVGhlIGRlc2lnbiBkZWNpc2lvbnMgYmVoaW5kIHRoZSBzY29wZSBhcmUgaGVhdmlseSBmYXZvcmVkIGZvciBzcGVlZCBhbmQgbWVtb3J5IGNvbnN1bXB0aW9uLlxuXHQgKlxuXHQgKiBUaGUgdHlwaWNhbCB1c2Ugb2Ygc2NvcGUgaXMgdG8gd2F0Y2ggdGhlIGV4cHJlc3Npb25zLCB3aGljaCBtb3N0IG9mIHRoZSB0aW1lIHJldHVybiB0aGUgc2FtZVxuXHQgKiB2YWx1ZSBhcyBsYXN0IHRpbWUgc28gd2Ugb3B0aW1pemUgdGhlIG9wZXJhdGlvbi5cblx0ICpcblx0ICogQ2xvc3VyZXMgY29uc3RydWN0aW9uIGlzIGV4cGVuc2l2ZSBpbiB0ZXJtcyBvZiBzcGVlZCBhcyB3ZWxsIGFzIG1lbW9yeTpcblx0ICogICAtIE5vIGNsb3N1cmVzLCBpbnN0ZWFkIHVzZSBwcm90b3R5cGljYWwgaW5oZXJpdGFuY2UgZm9yIEFQSVxuXHQgKiAgIC0gSW50ZXJuYWwgc3RhdGUgbmVlZHMgdG8gYmUgc3RvcmVkIG9uIHNjb3BlIGRpcmVjdGx5LCB3aGljaCBtZWFucyB0aGF0IHByaXZhdGUgc3RhdGUgaXNcblx0ICogICAgIGV4cG9zZWQgYXMgJCRfX19fIHByb3BlcnRpZXNcblx0ICpcblx0ICogTG9vcCBvcGVyYXRpb25zIGFyZSBvcHRpbWl6ZWQgYnkgdXNpbmcgd2hpbGUoY291bnQtLSkgeyAuLi4gfVxuXHQgKiAgIC0gVGhpcyBtZWFucyB0aGF0IGluIG9yZGVyIHRvIGtlZXAgdGhlIHNhbWUgb3JkZXIgb2YgZXhlY3V0aW9uIGFzIGFkZGl0aW9uIHdlIGhhdmUgdG8gYWRkXG5cdCAqICAgICBpdGVtcyB0byB0aGUgYXJyYXkgYXQgdGhlIGJlZ2lubmluZyAodW5zaGlmdCkgaW5zdGVhZCBvZiBhdCB0aGUgZW5kIChwdXNoKVxuXHQgKlxuXHQgKiBDaGlsZCBzY29wZXMgYXJlIGNyZWF0ZWQgYW5kIHJlbW92ZWQgb2Z0ZW5cblx0ICogICAtIFVzaW5nIGFuIGFycmF5IHdvdWxkIGJlIHNsb3cgc2luY2UgaW5zZXJ0cyBpbiB0aGUgbWlkZGxlIGFyZSBleHBlbnNpdmU7IHNvIHdlIHVzZSBsaW5rZWQgbGlzdHNcblx0ICpcblx0ICogVGhlcmUgYXJlIGZld2VyIHdhdGNoZXMgdGhhbiBvYnNlcnZlcnMuIFRoaXMgaXMgd2h5IHlvdSBkb24ndCB3YW50IHRoZSBvYnNlcnZlciB0byBiZSBpbXBsZW1lbnRlZFxuXHQgKiBpbiB0aGUgc2FtZSB3YXkgYXMgd2F0Y2guIFdhdGNoIHJlcXVpcmVzIHJldHVybiBvZiB0aGUgaW5pdGlhbGl6YXRpb24gZnVuY3Rpb24gd2hpY2ggaXMgZXhwZW5zaXZlXG5cdCAqIHRvIGNvbnN0cnVjdC5cblx0ICovXG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBwcm92aWRlclxuXHQgKiBAbmFtZSAkcm9vdFNjb3BlUHJvdmlkZXJcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqXG5cdCAqIFByb3ZpZGVyIGZvciB0aGUgJHJvb3RTY29wZSBzZXJ2aWNlLlxuXHQgKi9cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgbWV0aG9kXG5cdCAqIEBuYW1lICRyb290U2NvcGVQcm92aWRlciNkaWdlc3RUdGxcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqXG5cdCAqIFNldHMgdGhlIG51bWJlciBvZiBgJGRpZ2VzdGAgaXRlcmF0aW9ucyB0aGUgc2NvcGUgc2hvdWxkIGF0dGVtcHQgdG8gZXhlY3V0ZSBiZWZvcmUgZ2l2aW5nIHVwIGFuZFxuXHQgKiBhc3N1bWluZyB0aGF0IHRoZSBtb2RlbCBpcyB1bnN0YWJsZS5cblx0ICpcblx0ICogVGhlIGN1cnJlbnQgZGVmYXVsdCBpcyAxMCBpdGVyYXRpb25zLlxuXHQgKlxuXHQgKiBJbiBjb21wbGV4IGFwcGxpY2F0aW9ucyBpdCdzIHBvc3NpYmxlIHRoYXQgdGhlIGRlcGVuZGVuY2llcyBiZXR3ZWVuIGAkd2F0Y2hgcyB3aWxsIHJlc3VsdCBpblxuXHQgKiBzZXZlcmFsIGRpZ2VzdCBpdGVyYXRpb25zLiBIb3dldmVyIGlmIGFuIGFwcGxpY2F0aW9uIG5lZWRzIG1vcmUgdGhhbiB0aGUgZGVmYXVsdCAxMCBkaWdlc3Rcblx0ICogaXRlcmF0aW9ucyBmb3IgaXRzIG1vZGVsIHRvIHN0YWJpbGl6ZSB0aGVuIHlvdSBzaG91bGQgaW52ZXN0aWdhdGUgd2hhdCBpcyBjYXVzaW5nIHRoZSBtb2RlbCB0b1xuXHQgKiBjb250aW51b3VzbHkgY2hhbmdlIGR1cmluZyB0aGUgZGlnZXN0LlxuXHQgKlxuXHQgKiBJbmNyZWFzaW5nIHRoZSBUVEwgY291bGQgaGF2ZSBwZXJmb3JtYW5jZSBpbXBsaWNhdGlvbnMsIHNvIHlvdSBzaG91bGQgbm90IGNoYW5nZSBpdCB3aXRob3V0XG5cdCAqIHByb3BlciBqdXN0aWZpY2F0aW9uLlxuXHQgKlxuXHQgKiBAcGFyYW0ge251bWJlcn0gbGltaXQgVGhlIG51bWJlciBvZiBkaWdlc3QgaXRlcmF0aW9ucy5cblx0ICovXG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBzZXJ2aWNlXG5cdCAqIEBuYW1lICRyb290U2NvcGVcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqXG5cdCAqIEV2ZXJ5IGFwcGxpY2F0aW9uIGhhcyBhIHNpbmdsZSByb290IHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIHNjb3BlfS5cblx0ICogQWxsIG90aGVyIHNjb3BlcyBhcmUgZGVzY2VuZGFudCBzY29wZXMgb2YgdGhlIHJvb3Qgc2NvcGUuIFNjb3BlcyBwcm92aWRlIHNlcGFyYXRpb25cblx0ICogYmV0d2VlbiB0aGUgbW9kZWwgYW5kIHRoZSB2aWV3LCB2aWEgYSBtZWNoYW5pc20gZm9yIHdhdGNoaW5nIHRoZSBtb2RlbCBmb3IgY2hhbmdlcy5cblx0ICogVGhleSBhbHNvIHByb3ZpZGUgZXZlbnQgZW1pc3Npb24vYnJvYWRjYXN0IGFuZCBzdWJzY3JpcHRpb24gZmFjaWxpdHkuIFNlZSB0aGVcblx0ICoge0BsaW5rIGd1aWRlL3Njb3BlIGRldmVsb3BlciBndWlkZSBvbiBzY29wZXN9LlxuXHQgKi9cblx0ZnVuY3Rpb24gJFJvb3RTY29wZVByb3ZpZGVyKCkge1xuXHQgIHZhciBUVEwgPSAxMDtcblx0ICB2YXIgJHJvb3RTY29wZU1pbkVyciA9IG1pbkVycignJHJvb3RTY29wZScpO1xuXHQgIHZhciBsYXN0RGlydHlXYXRjaCA9IG51bGw7XG5cdCAgdmFyIGFwcGx5QXN5bmNJZCA9IG51bGw7XG5cdFxuXHQgIHRoaXMuZGlnZXN0VHRsID0gZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoKSB7XG5cdCAgICAgIFRUTCA9IHZhbHVlO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIFRUTDtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBjcmVhdGVDaGlsZFNjb3BlQ2xhc3MocGFyZW50KSB7XG5cdCAgICBmdW5jdGlvbiBDaGlsZFNjb3BlKCkge1xuXHQgICAgICB0aGlzLiQkd2F0Y2hlcnMgPSB0aGlzLiQkbmV4dFNpYmxpbmcgPVxuXHQgICAgICAgICAgdGhpcy4kJGNoaWxkSGVhZCA9IHRoaXMuJCRjaGlsZFRhaWwgPSBudWxsO1xuXHQgICAgICB0aGlzLiQkbGlzdGVuZXJzID0ge307XG5cdCAgICAgIHRoaXMuJCRsaXN0ZW5lckNvdW50ID0ge307XG5cdCAgICAgIHRoaXMuJCR3YXRjaGVyc0NvdW50ID0gMDtcblx0ICAgICAgdGhpcy4kaWQgPSBuZXh0VWlkKCk7XG5cdCAgICAgIHRoaXMuJCRDaGlsZFNjb3BlID0gbnVsbDtcblx0ICAgIH1cblx0ICAgIENoaWxkU2NvcGUucHJvdG90eXBlID0gcGFyZW50O1xuXHQgICAgcmV0dXJuIENoaWxkU2NvcGU7XG5cdCAgfVxuXHRcblx0ICB0aGlzLiRnZXQgPSBbJyRleGNlcHRpb25IYW5kbGVyJywgJyRwYXJzZScsICckYnJvd3NlcicsXG5cdCAgICAgIGZ1bmN0aW9uKCRleGNlcHRpb25IYW5kbGVyLCAkcGFyc2UsICRicm93c2VyKSB7XG5cdFxuXHQgICAgZnVuY3Rpb24gZGVzdHJveUNoaWxkU2NvcGUoJGV2ZW50KSB7XG5cdCAgICAgICAgJGV2ZW50LmN1cnJlbnRTY29wZS4kJGRlc3Ryb3llZCA9IHRydWU7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gY2xlYW5VcFNjb3BlKCRzY29wZSkge1xuXHRcblx0ICAgICAgaWYgKG1zaWUgPT09IDkpIHtcblx0ICAgICAgICAvLyBUaGVyZSBpcyBhIG1lbW9yeSBsZWFrIGluIElFOSBpZiBhbGwgY2hpbGQgc2NvcGVzIGFyZSBub3QgZGlzY29ubmVjdGVkXG5cdCAgICAgICAgLy8gY29tcGxldGVseSB3aGVuIGEgc2NvcGUgaXMgZGVzdHJveWVkLiBTbyB0aGlzIGNvZGUgd2lsbCByZWN1cnNlIHVwIHRocm91Z2hcblx0ICAgICAgICAvLyBhbGwgdGhpcyBzY29wZXMgY2hpbGRyZW5cblx0ICAgICAgICAvL1xuXHQgICAgICAgIC8vIFNlZSBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL2lzc3Vlcy8xMDcwNlxuXHQgICAgICAgICRzY29wZS4kJGNoaWxkSGVhZCAmJiBjbGVhblVwU2NvcGUoJHNjb3BlLiQkY2hpbGRIZWFkKTtcblx0ICAgICAgICAkc2NvcGUuJCRuZXh0U2libGluZyAmJiBjbGVhblVwU2NvcGUoJHNjb3BlLiQkbmV4dFNpYmxpbmcpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvLyBUaGUgY29kZSBiZWxvdyB3b3JrcyBhcm91bmQgSUU5IGFuZCBWOCdzIG1lbW9yeSBsZWFrc1xuXHQgICAgICAvL1xuXHQgICAgICAvLyBTZWU6XG5cdCAgICAgIC8vIC0gaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTIwNzMjYzI2XG5cdCAgICAgIC8vIC0gaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy9pc3N1ZXMvNjc5NCNpc3N1ZWNvbW1lbnQtMzg2NDg5MDlcblx0ICAgICAgLy8gLSBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL2lzc3Vlcy8xMzEzI2lzc3VlY29tbWVudC0xMDM3ODQ1MVxuXHRcblx0ICAgICAgJHNjb3BlLiRwYXJlbnQgPSAkc2NvcGUuJCRuZXh0U2libGluZyA9ICRzY29wZS4kJHByZXZTaWJsaW5nID0gJHNjb3BlLiQkY2hpbGRIZWFkID1cblx0ICAgICAgICAgICRzY29wZS4kJGNoaWxkVGFpbCA9ICRzY29wZS4kcm9vdCA9ICRzY29wZS4kJHdhdGNoZXJzID0gbnVsbDtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyB0eXBlXG5cdCAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlXG5cdCAgICAgKlxuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKiBBIHJvb3Qgc2NvcGUgY2FuIGJlIHJldHJpZXZlZCB1c2luZyB0aGUge0BsaW5rIG5nLiRyb290U2NvcGUgJHJvb3RTY29wZX0ga2V5IGZyb20gdGhlXG5cdCAgICAgKiB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfS4gQ2hpbGQgc2NvcGVzIGFyZSBjcmVhdGVkIHVzaW5nIHRoZVxuXHQgICAgICoge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJG5ldyAkbmV3KCl9IG1ldGhvZC4gKE1vc3Qgc2NvcGVzIGFyZSBjcmVhdGVkIGF1dG9tYXRpY2FsbHkgd2hlblxuXHQgICAgICogY29tcGlsZWQgSFRNTCB0ZW1wbGF0ZSBpcyBleGVjdXRlZC4pIFNlZSBhbHNvIHRoZSB7QGxpbmsgZ3VpZGUvc2NvcGUgU2NvcGVzIGd1aWRlfSBmb3Jcblx0ICAgICAqIGFuIGluLWRlcHRoIGludHJvZHVjdGlvbiBhbmQgdXNhZ2UgZXhhbXBsZXMuXG5cdCAgICAgKlxuXHQgICAgICpcblx0ICAgICAqICMgSW5oZXJpdGFuY2Vcblx0ICAgICAqIEEgc2NvcGUgY2FuIGluaGVyaXQgZnJvbSBhIHBhcmVudCBzY29wZSwgYXMgaW4gdGhpcyBleGFtcGxlOlxuXHQgICAgICogYGBganNcblx0ICAgICAgICAgdmFyIHBhcmVudCA9ICRyb290U2NvcGU7XG5cdCAgICAgICAgIHZhciBjaGlsZCA9IHBhcmVudC4kbmV3KCk7XG5cdFxuXHQgICAgICAgICBwYXJlbnQuc2FsdXRhdGlvbiA9IFwiSGVsbG9cIjtcblx0ICAgICAgICAgZXhwZWN0KGNoaWxkLnNhbHV0YXRpb24pLnRvRXF1YWwoJ0hlbGxvJyk7XG5cdFxuXHQgICAgICAgICBjaGlsZC5zYWx1dGF0aW9uID0gXCJXZWxjb21lXCI7XG5cdCAgICAgICAgIGV4cGVjdChjaGlsZC5zYWx1dGF0aW9uKS50b0VxdWFsKCdXZWxjb21lJyk7XG5cdCAgICAgICAgIGV4cGVjdChwYXJlbnQuc2FsdXRhdGlvbikudG9FcXVhbCgnSGVsbG8nKTtcblx0ICAgICAqIGBgYFxuXHQgICAgICpcblx0ICAgICAqIFdoZW4gaW50ZXJhY3Rpbmcgd2l0aCBgU2NvcGVgIGluIHRlc3RzLCBhZGRpdGlvbmFsIGhlbHBlciBtZXRob2RzIGFyZSBhdmFpbGFibGUgb24gdGhlXG5cdCAgICAgKiBpbnN0YW5jZXMgb2YgYFNjb3BlYCB0eXBlLiBTZWUge0BsaW5rIG5nTW9jay4kcm9vdFNjb3BlLlNjb3BlIG5nTW9jayBTY29wZX0gZm9yIGFkZGl0aW9uYWxcblx0ICAgICAqIGRldGFpbHMuXG5cdCAgICAgKlxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0LjxzdHJpbmcsIGZ1bmN0aW9uKCk+PX0gcHJvdmlkZXJzIE1hcCBvZiBzZXJ2aWNlIGZhY3Rvcnkgd2hpY2ggbmVlZCB0byBiZVxuXHQgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZCBmb3IgdGhlIGN1cnJlbnQgc2NvcGUuIERlZmF1bHRzIHRvIHtAbGluayBuZ30uXG5cdCAgICAgKiBAcGFyYW0ge09iamVjdC48c3RyaW5nLCAqPj19IGluc3RhbmNlQ2FjaGUgUHJvdmlkZXMgcHJlLWluc3RhbnRpYXRlZCBzZXJ2aWNlcyB3aGljaCBzaG91bGRcblx0ICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kL292ZXJyaWRlIHNlcnZpY2VzIHByb3ZpZGVkIGJ5IGBwcm92aWRlcnNgLiBUaGlzIGlzIGhhbmR5XG5cdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdW5pdC10ZXN0aW5nIGFuZCBoYXZpbmcgdGhlIG5lZWQgdG8gb3ZlcnJpZGUgYSBkZWZhdWx0XG5cdCAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2UuXG5cdCAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBOZXdseSBjcmVhdGVkIHNjb3BlLlxuXHQgICAgICpcblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gU2NvcGUoKSB7XG5cdCAgICAgIHRoaXMuJGlkID0gbmV4dFVpZCgpO1xuXHQgICAgICB0aGlzLiQkcGhhc2UgPSB0aGlzLiRwYXJlbnQgPSB0aGlzLiQkd2F0Y2hlcnMgPVxuXHQgICAgICAgICAgICAgICAgICAgICB0aGlzLiQkbmV4dFNpYmxpbmcgPSB0aGlzLiQkcHJldlNpYmxpbmcgPVxuXHQgICAgICAgICAgICAgICAgICAgICB0aGlzLiQkY2hpbGRIZWFkID0gdGhpcy4kJGNoaWxkVGFpbCA9IG51bGw7XG5cdCAgICAgIHRoaXMuJHJvb3QgPSB0aGlzO1xuXHQgICAgICB0aGlzLiQkZGVzdHJveWVkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuJCRsaXN0ZW5lcnMgPSB7fTtcblx0ICAgICAgdGhpcy4kJGxpc3RlbmVyQ291bnQgPSB7fTtcblx0ICAgICAgdGhpcy4kJHdhdGNoZXJzQ291bnQgPSAwO1xuXHQgICAgICB0aGlzLiQkaXNvbGF0ZUJpbmRpbmdzID0gbnVsbDtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBwcm9wZXJ0eVxuXHQgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkaWRcblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFVuaXF1ZSBzY29wZSBJRCAobW9ub3RvbmljYWxseSBpbmNyZWFzaW5nKSB1c2VmdWwgZm9yIGRlYnVnZ2luZy5cblx0ICAgICAqL1xuXHRcblx0ICAgICAvKipcblx0ICAgICAgKiBAbmdkb2MgcHJvcGVydHlcblx0ICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRwYXJlbnRcblx0ICAgICAgKlxuXHQgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAqIFJlZmVyZW5jZSB0byB0aGUgcGFyZW50IHNjb3BlLlxuXHQgICAgICAqL1xuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBwcm9wZXJ0eVxuXHQgICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRyb290XG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBSZWZlcmVuY2UgdG8gdGhlIHJvb3Qgc2NvcGUuXG5cdCAgICAgICAqL1xuXHRcblx0ICAgIFNjb3BlLnByb3RvdHlwZSA9IHtcblx0ICAgICAgY29uc3RydWN0b3I6IFNjb3BlLFxuXHQgICAgICAvKipcblx0ICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRuZXdcblx0ICAgICAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgICAgICpcblx0ICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAqIENyZWF0ZXMgYSBuZXcgY2hpbGQge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUgc2NvcGV9LlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBUaGUgcGFyZW50IHNjb3BlIHdpbGwgcHJvcGFnYXRlIHRoZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0ICRkaWdlc3QoKX0gZXZlbnQuXG5cdCAgICAgICAqIFRoZSBzY29wZSBjYW4gYmUgcmVtb3ZlZCBmcm9tIHRoZSBzY29wZSBoaWVyYXJjaHkgdXNpbmcge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGRlc3Ryb3kgJGRlc3Ryb3koKX0uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRkZXN0cm95ICRkZXN0cm95KCl9IG11c3QgYmUgY2FsbGVkIG9uIGEgc2NvcGUgd2hlbiBpdCBpc1xuXHQgICAgICAgKiBkZXNpcmVkIGZvciB0aGUgc2NvcGUgYW5kIGl0cyBjaGlsZCBzY29wZXMgdG8gYmUgcGVybWFuZW50bHkgZGV0YWNoZWQgZnJvbSB0aGUgcGFyZW50IGFuZFxuXHQgICAgICAgKiB0aHVzIHN0b3AgcGFydGljaXBhdGluZyBpbiBtb2RlbCBjaGFuZ2UgZGV0ZWN0aW9uIGFuZCBsaXN0ZW5lciBub3RpZmljYXRpb24gYnkgaW52b2tpbmcuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNvbGF0ZSBJZiB0cnVlLCB0aGVuIHRoZSBzY29wZSBkb2VzIG5vdCBwcm90b3R5cGljYWxseSBpbmhlcml0IGZyb20gdGhlXG5cdCAgICAgICAqICAgICAgICAgcGFyZW50IHNjb3BlLiBUaGUgc2NvcGUgaXMgaXNvbGF0ZWQsIGFzIGl0IGNhbiBub3Qgc2VlIHBhcmVudCBzY29wZSBwcm9wZXJ0aWVzLlxuXHQgICAgICAgKiAgICAgICAgIFdoZW4gY3JlYXRpbmcgd2lkZ2V0cywgaXQgaXMgdXNlZnVsIGZvciB0aGUgd2lkZ2V0IHRvIG5vdCBhY2NpZGVudGFsbHkgcmVhZCBwYXJlbnRcblx0ICAgICAgICogICAgICAgICBzdGF0ZS5cblx0ICAgICAgICpcblx0ICAgICAgICogQHBhcmFtIHtTY29wZX0gW3BhcmVudD10aGlzXSBUaGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUgYFNjb3BlYH0gdGhhdCB3aWxsIGJlIHRoZSBgJHBhcmVudGBcblx0ICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZiB0aGUgbmV3bHkgY3JlYXRlZCBzY29wZS4gRGVmYXVsdHMgdG8gYHRoaXNgIHNjb3BlIGlmIG5vdCBwcm92aWRlZC5cblx0ICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaGlzIGlzIHVzZWQgd2hlbiBjcmVhdGluZyBhIHRyYW5zY2x1ZGUgc2NvcGUgdG8gY29ycmVjdGx5IHBsYWNlIGl0XG5cdCAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gdGhlIHNjb3BlIGhpZXJhcmNoeSB3aGlsZSBtYWludGFpbmluZyB0aGUgY29ycmVjdCBwcm90b3R5cGljYWxcblx0ICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmhlcml0YW5jZS5cblx0ICAgICAgICpcblx0ICAgICAgICogQHJldHVybnMge09iamVjdH0gVGhlIG5ld2x5IGNyZWF0ZWQgY2hpbGQgc2NvcGUuXG5cdCAgICAgICAqXG5cdCAgICAgICAqL1xuXHQgICAgICAkbmV3OiBmdW5jdGlvbihpc29sYXRlLCBwYXJlbnQpIHtcblx0ICAgICAgICB2YXIgY2hpbGQ7XG5cdFxuXHQgICAgICAgIHBhcmVudCA9IHBhcmVudCB8fCB0aGlzO1xuXHRcblx0ICAgICAgICBpZiAoaXNvbGF0ZSkge1xuXHQgICAgICAgICAgY2hpbGQgPSBuZXcgU2NvcGUoKTtcblx0ICAgICAgICAgIGNoaWxkLiRyb290ID0gdGhpcy4kcm9vdDtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgLy8gT25seSBjcmVhdGUgYSBjaGlsZCBzY29wZSBjbGFzcyBpZiBzb21lYm9keSBhc2tzIGZvciBvbmUsXG5cdCAgICAgICAgICAvLyBidXQgY2FjaGUgaXQgdG8gYWxsb3cgdGhlIFZNIHRvIG9wdGltaXplIGxvb2t1cHMuXG5cdCAgICAgICAgICBpZiAoIXRoaXMuJCRDaGlsZFNjb3BlKSB7XG5cdCAgICAgICAgICAgIHRoaXMuJCRDaGlsZFNjb3BlID0gY3JlYXRlQ2hpbGRTY29wZUNsYXNzKHRoaXMpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgY2hpbGQgPSBuZXcgdGhpcy4kJENoaWxkU2NvcGUoKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgY2hpbGQuJHBhcmVudCA9IHBhcmVudDtcblx0ICAgICAgICBjaGlsZC4kJHByZXZTaWJsaW5nID0gcGFyZW50LiQkY2hpbGRUYWlsO1xuXHQgICAgICAgIGlmIChwYXJlbnQuJCRjaGlsZEhlYWQpIHtcblx0ICAgICAgICAgIHBhcmVudC4kJGNoaWxkVGFpbC4kJG5leHRTaWJsaW5nID0gY2hpbGQ7XG5cdCAgICAgICAgICBwYXJlbnQuJCRjaGlsZFRhaWwgPSBjaGlsZDtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgcGFyZW50LiQkY2hpbGRIZWFkID0gcGFyZW50LiQkY2hpbGRUYWlsID0gY2hpbGQ7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvLyBXaGVuIHRoZSBuZXcgc2NvcGUgaXMgbm90IGlzb2xhdGVkIG9yIHdlIGluaGVyaXQgZnJvbSBgdGhpc2AsIGFuZFxuXHQgICAgICAgIC8vIHRoZSBwYXJlbnQgc2NvcGUgaXMgZGVzdHJveWVkLCB0aGUgcHJvcGVydHkgYCQkZGVzdHJveWVkYCBpcyBpbmhlcml0ZWRcblx0ICAgICAgICAvLyBwcm90b3R5cGljYWxseS4gSW4gYWxsIG90aGVyIGNhc2VzLCB0aGlzIHByb3BlcnR5IG5lZWRzIHRvIGJlIHNldFxuXHQgICAgICAgIC8vIHdoZW4gdGhlIHBhcmVudCBzY29wZSBpcyBkZXN0cm95ZWQuXG5cdCAgICAgICAgLy8gVGhlIGxpc3RlbmVyIG5lZWRzIHRvIGJlIGFkZGVkIGFmdGVyIHRoZSBwYXJlbnQgaXMgc2V0XG5cdCAgICAgICAgaWYgKGlzb2xhdGUgfHwgcGFyZW50ICE9IHRoaXMpIGNoaWxkLiRvbignJGRlc3Ryb3knLCBkZXN0cm95Q2hpbGRTY29wZSk7XG5cdFxuXHQgICAgICAgIHJldHVybiBjaGlsZDtcblx0ICAgICAgfSxcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAqIEBuYW1lICRyb290U2NvcGUuU2NvcGUjJHdhdGNoXG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBSZWdpc3RlcnMgYSBgbGlzdGVuZXJgIGNhbGxiYWNrIHRvIGJlIGV4ZWN1dGVkIHdoZW5ldmVyIHRoZSBgd2F0Y2hFeHByZXNzaW9uYCBjaGFuZ2VzLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiAtIFRoZSBgd2F0Y2hFeHByZXNzaW9uYCBpcyBjYWxsZWQgb24gZXZlcnkgY2FsbCB0byB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0XG5cdCAgICAgICAqICAgJGRpZ2VzdCgpfSBhbmQgc2hvdWxkIHJldHVybiB0aGUgdmFsdWUgdGhhdCB3aWxsIGJlIHdhdGNoZWQuIChgd2F0Y2hFeHByZXNzaW9uYCBzaG91bGQgbm90IGNoYW5nZVxuXHQgICAgICAgKiAgIGl0cyB2YWx1ZSB3aGVuIGV4ZWN1dGVkIG11bHRpcGxlIHRpbWVzIHdpdGggdGhlIHNhbWUgaW5wdXQgYmVjYXVzZSBpdCBtYXkgYmUgZXhlY3V0ZWQgbXVsdGlwbGVcblx0ICAgICAgICogICB0aW1lcyBieSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0ICRkaWdlc3QoKX0uIFRoYXQgaXMsIGB3YXRjaEV4cHJlc3Npb25gIHNob3VsZCBiZVxuXHQgICAgICAgKiAgIFtpZGVtcG90ZW50XShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0lkZW1wb3RlbmNlKS5cblx0ICAgICAgICogLSBUaGUgYGxpc3RlbmVyYCBpcyBjYWxsZWQgb25seSB3aGVuIHRoZSB2YWx1ZSBmcm9tIHRoZSBjdXJyZW50IGB3YXRjaEV4cHJlc3Npb25gIGFuZCB0aGVcblx0ICAgICAgICogICBwcmV2aW91cyBjYWxsIHRvIGB3YXRjaEV4cHJlc3Npb25gIGFyZSBub3QgZXF1YWwgKHdpdGggdGhlIGV4Y2VwdGlvbiBvZiB0aGUgaW5pdGlhbCBydW4sXG5cdCAgICAgICAqICAgc2VlIGJlbG93KS4gSW5lcXVhbGl0eSBpcyBkZXRlcm1pbmVkIGFjY29yZGluZyB0byByZWZlcmVuY2UgaW5lcXVhbGl0eSxcblx0ICAgICAgICogICBbc3RyaWN0IGNvbXBhcmlzb25dKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL09wZXJhdG9ycy9Db21wYXJpc29uX09wZXJhdG9ycylcblx0ICAgICAgICogICAgdmlhIHRoZSBgIT09YCBKYXZhc2NyaXB0IG9wZXJhdG9yLCB1bmxlc3MgYG9iamVjdEVxdWFsaXR5ID09IHRydWVgXG5cdCAgICAgICAqICAgKHNlZSBuZXh0IHBvaW50KVxuXHQgICAgICAgKiAtIFdoZW4gYG9iamVjdEVxdWFsaXR5ID09IHRydWVgLCBpbmVxdWFsaXR5IG9mIHRoZSBgd2F0Y2hFeHByZXNzaW9uYCBpcyBkZXRlcm1pbmVkXG5cdCAgICAgICAqICAgYWNjb3JkaW5nIHRvIHRoZSB7QGxpbmsgYW5ndWxhci5lcXVhbHN9IGZ1bmN0aW9uLiBUbyBzYXZlIHRoZSB2YWx1ZSBvZiB0aGUgb2JqZWN0IGZvclxuXHQgICAgICAgKiAgIGxhdGVyIGNvbXBhcmlzb24sIHRoZSB7QGxpbmsgYW5ndWxhci5jb3B5fSBmdW5jdGlvbiBpcyB1c2VkLiBUaGlzIHRoZXJlZm9yZSBtZWFucyB0aGF0XG5cdCAgICAgICAqICAgd2F0Y2hpbmcgY29tcGxleCBvYmplY3RzIHdpbGwgaGF2ZSBhZHZlcnNlIG1lbW9yeSBhbmQgcGVyZm9ybWFuY2UgaW1wbGljYXRpb25zLlxuXHQgICAgICAgKiAtIFRoZSB3YXRjaCBgbGlzdGVuZXJgIG1heSBjaGFuZ2UgdGhlIG1vZGVsLCB3aGljaCBtYXkgdHJpZ2dlciBvdGhlciBgbGlzdGVuZXJgcyB0byBmaXJlLlxuXHQgICAgICAgKiAgIFRoaXMgaXMgYWNoaWV2ZWQgYnkgcmVydW5uaW5nIHRoZSB3YXRjaGVycyB1bnRpbCBubyBjaGFuZ2VzIGFyZSBkZXRlY3RlZC4gVGhlIHJlcnVuXG5cdCAgICAgICAqICAgaXRlcmF0aW9uIGxpbWl0IGlzIDEwIHRvIHByZXZlbnQgYW4gaW5maW5pdGUgbG9vcCBkZWFkbG9jay5cblx0ICAgICAgICpcblx0ICAgICAgICpcblx0ICAgICAgICogSWYgeW91IHdhbnQgdG8gYmUgbm90aWZpZWQgd2hlbmV2ZXIge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGRpZ2VzdCAkZGlnZXN0fSBpcyBjYWxsZWQsXG5cdCAgICAgICAqIHlvdSBjYW4gcmVnaXN0ZXIgYSBgd2F0Y2hFeHByZXNzaW9uYCBmdW5jdGlvbiB3aXRoIG5vIGBsaXN0ZW5lcmAuIChCZSBwcmVwYXJlZCBmb3Jcblx0ICAgICAgICogbXVsdGlwbGUgY2FsbHMgdG8geW91ciBgd2F0Y2hFeHByZXNzaW9uYCBiZWNhdXNlIGl0IHdpbGwgZXhlY3V0ZSBtdWx0aXBsZSB0aW1lcyBpbiBhXG5cdCAgICAgICAqIHNpbmdsZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0ICRkaWdlc3R9IGN5Y2xlIGlmIGEgY2hhbmdlIGlzIGRldGVjdGVkLilcblx0ICAgICAgICpcblx0ICAgICAgICogQWZ0ZXIgYSB3YXRjaGVyIGlzIHJlZ2lzdGVyZWQgd2l0aCB0aGUgc2NvcGUsIHRoZSBgbGlzdGVuZXJgIGZuIGlzIGNhbGxlZCBhc3luY2hyb25vdXNseVxuXHQgICAgICAgKiAodmlhIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRldmFsQXN5bmMgJGV2YWxBc3luY30pIHRvIGluaXRpYWxpemUgdGhlXG5cdCAgICAgICAqIHdhdGNoZXIuIEluIHJhcmUgY2FzZXMsIHRoaXMgaXMgdW5kZXNpcmFibGUgYmVjYXVzZSB0aGUgbGlzdGVuZXIgaXMgY2FsbGVkIHdoZW4gdGhlIHJlc3VsdFxuXHQgICAgICAgKiBvZiBgd2F0Y2hFeHByZXNzaW9uYCBkaWRuJ3QgY2hhbmdlLiBUbyBkZXRlY3QgdGhpcyBzY2VuYXJpbyB3aXRoaW4gdGhlIGBsaXN0ZW5lcmAgZm4sIHlvdVxuXHQgICAgICAgKiBjYW4gY29tcGFyZSB0aGUgYG5ld1ZhbGAgYW5kIGBvbGRWYWxgLiBJZiB0aGVzZSB0d28gdmFsdWVzIGFyZSBpZGVudGljYWwgKGA9PT1gKSB0aGVuIHRoZVxuXHQgICAgICAgKiBsaXN0ZW5lciB3YXMgY2FsbGVkIGR1ZSB0byBpbml0aWFsaXphdGlvbi5cblx0ICAgICAgICpcblx0ICAgICAgICpcblx0ICAgICAgICpcblx0ICAgICAgICogIyBFeGFtcGxlXG5cdCAgICAgICAqIGBgYGpzXG5cdCAgICAgICAgICAgLy8gbGV0J3MgYXNzdW1lIHRoYXQgc2NvcGUgd2FzIGRlcGVuZGVuY3kgaW5qZWN0ZWQgYXMgdGhlICRyb290U2NvcGVcblx0ICAgICAgICAgICB2YXIgc2NvcGUgPSAkcm9vdFNjb3BlO1xuXHQgICAgICAgICAgIHNjb3BlLm5hbWUgPSAnbWlza28nO1xuXHQgICAgICAgICAgIHNjb3BlLmNvdW50ZXIgPSAwO1xuXHRcblx0ICAgICAgICAgICBleHBlY3Qoc2NvcGUuY291bnRlcikudG9FcXVhbCgwKTtcblx0ICAgICAgICAgICBzY29wZS4kd2F0Y2goJ25hbWUnLCBmdW5jdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcblx0ICAgICAgICAgICAgIHNjb3BlLmNvdW50ZXIgPSBzY29wZS5jb3VudGVyICsgMTtcblx0ICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICBleHBlY3Qoc2NvcGUuY291bnRlcikudG9FcXVhbCgwKTtcblx0XG5cdCAgICAgICAgICAgc2NvcGUuJGRpZ2VzdCgpO1xuXHQgICAgICAgICAgIC8vIHRoZSBsaXN0ZW5lciBpcyBhbHdheXMgY2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgJGRpZ2VzdCBsb29wIGFmdGVyIGl0IHdhcyByZWdpc3RlcmVkXG5cdCAgICAgICAgICAgZXhwZWN0KHNjb3BlLmNvdW50ZXIpLnRvRXF1YWwoMSk7XG5cdFxuXHQgICAgICAgICAgIHNjb3BlLiRkaWdlc3QoKTtcblx0ICAgICAgICAgICAvLyBidXQgbm93IGl0IHdpbGwgbm90IGJlIGNhbGxlZCB1bmxlc3MgdGhlIHZhbHVlIGNoYW5nZXNcblx0ICAgICAgICAgICBleHBlY3Qoc2NvcGUuY291bnRlcikudG9FcXVhbCgxKTtcblx0XG5cdCAgICAgICAgICAgc2NvcGUubmFtZSA9ICdhZGFtJztcblx0ICAgICAgICAgICBzY29wZS4kZGlnZXN0KCk7XG5cdCAgICAgICAgICAgZXhwZWN0KHNjb3BlLmNvdW50ZXIpLnRvRXF1YWwoMik7XG5cdFxuXHRcblx0XG5cdCAgICAgICAgICAgLy8gVXNpbmcgYSBmdW5jdGlvbiBhcyBhIHdhdGNoRXhwcmVzc2lvblxuXHQgICAgICAgICAgIHZhciBmb29kO1xuXHQgICAgICAgICAgIHNjb3BlLmZvb2RDb3VudGVyID0gMDtcblx0ICAgICAgICAgICBleHBlY3Qoc2NvcGUuZm9vZENvdW50ZXIpLnRvRXF1YWwoMCk7XG5cdCAgICAgICAgICAgc2NvcGUuJHdhdGNoKFxuXHQgICAgICAgICAgICAgLy8gVGhpcyBmdW5jdGlvbiByZXR1cm5zIHRoZSB2YWx1ZSBiZWluZyB3YXRjaGVkLiBJdCBpcyBjYWxsZWQgZm9yIGVhY2ggdHVybiBvZiB0aGUgJGRpZ2VzdCBsb29wXG5cdCAgICAgICAgICAgICBmdW5jdGlvbigpIHsgcmV0dXJuIGZvb2Q7IH0sXG5cdCAgICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBjaGFuZ2UgbGlzdGVuZXIsIGNhbGxlZCB3aGVuIHRoZSB2YWx1ZSByZXR1cm5lZCBmcm9tIHRoZSBhYm92ZSBmdW5jdGlvbiBjaGFuZ2VzXG5cdCAgICAgICAgICAgICBmdW5jdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcblx0ICAgICAgICAgICAgICAgaWYgKCBuZXdWYWx1ZSAhPT0gb2xkVmFsdWUgKSB7XG5cdCAgICAgICAgICAgICAgICAgLy8gT25seSBpbmNyZW1lbnQgdGhlIGNvdW50ZXIgaWYgdGhlIHZhbHVlIGNoYW5nZWRcblx0ICAgICAgICAgICAgICAgICBzY29wZS5mb29kQ291bnRlciA9IHNjb3BlLmZvb2RDb3VudGVyICsgMTtcblx0ICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICk7XG5cdCAgICAgICAgICAgLy8gTm8gZGlnZXN0IGhhcyBiZWVuIHJ1biBzbyB0aGUgY291bnRlciB3aWxsIGJlIHplcm9cblx0ICAgICAgICAgICBleHBlY3Qoc2NvcGUuZm9vZENvdW50ZXIpLnRvRXF1YWwoMCk7XG5cdFxuXHQgICAgICAgICAgIC8vIFJ1biB0aGUgZGlnZXN0IGJ1dCBzaW5jZSBmb29kIGhhcyBub3QgY2hhbmdlZCBjb3VudCB3aWxsIHN0aWxsIGJlIHplcm9cblx0ICAgICAgICAgICBzY29wZS4kZGlnZXN0KCk7XG5cdCAgICAgICAgICAgZXhwZWN0KHNjb3BlLmZvb2RDb3VudGVyKS50b0VxdWFsKDApO1xuXHRcblx0ICAgICAgICAgICAvLyBVcGRhdGUgZm9vZCBhbmQgcnVuIGRpZ2VzdC4gIE5vdyB0aGUgY291bnRlciB3aWxsIGluY3JlbWVudFxuXHQgICAgICAgICAgIGZvb2QgPSAnY2hlZXNlYnVyZ2VyJztcblx0ICAgICAgICAgICBzY29wZS4kZGlnZXN0KCk7XG5cdCAgICAgICAgICAgZXhwZWN0KHNjb3BlLmZvb2RDb3VudGVyKS50b0VxdWFsKDEpO1xuXHRcblx0ICAgICAgICogYGBgXG5cdCAgICAgICAqXG5cdCAgICAgICAqXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7KGZ1bmN0aW9uKCl8c3RyaW5nKX0gd2F0Y2hFeHByZXNzaW9uIEV4cHJlc3Npb24gdGhhdCBpcyBldmFsdWF0ZWQgb24gZWFjaFxuXHQgICAgICAgKiAgICB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0ICRkaWdlc3R9IGN5Y2xlLiBBIGNoYW5nZSBpbiB0aGUgcmV0dXJuIHZhbHVlIHRyaWdnZXJzXG5cdCAgICAgICAqICAgIGEgY2FsbCB0byB0aGUgYGxpc3RlbmVyYC5cblx0ICAgICAgICpcblx0ICAgICAgICogICAgLSBgc3RyaW5nYDogRXZhbHVhdGVkIGFzIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259XG5cdCAgICAgICAqICAgIC0gYGZ1bmN0aW9uKHNjb3BlKWA6IGNhbGxlZCB3aXRoIGN1cnJlbnQgYHNjb3BlYCBhcyBhIHBhcmFtZXRlci5cblx0ICAgICAgICogQHBhcmFtIHtmdW5jdGlvbihuZXdWYWwsIG9sZFZhbCwgc2NvcGUpfSBsaXN0ZW5lciBDYWxsYmFjayBjYWxsZWQgd2hlbmV2ZXIgdGhlIHZhbHVlXG5cdCAgICAgICAqICAgIG9mIGB3YXRjaEV4cHJlc3Npb25gIGNoYW5nZXMuXG5cdCAgICAgICAqXG5cdCAgICAgICAqICAgIC0gYG5ld1ZhbGAgY29udGFpbnMgdGhlIGN1cnJlbnQgdmFsdWUgb2YgdGhlIGB3YXRjaEV4cHJlc3Npb25gXG5cdCAgICAgICAqICAgIC0gYG9sZFZhbGAgY29udGFpbnMgdGhlIHByZXZpb3VzIHZhbHVlIG9mIHRoZSBgd2F0Y2hFeHByZXNzaW9uYFxuXHQgICAgICAgKiAgICAtIGBzY29wZWAgcmVmZXJzIHRvIHRoZSBjdXJyZW50IHNjb3BlXG5cdCAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IFtvYmplY3RFcXVhbGl0eT1mYWxzZV0gQ29tcGFyZSBmb3Igb2JqZWN0IGVxdWFsaXR5IHVzaW5nIHtAbGluayBhbmd1bGFyLmVxdWFsc30gaW5zdGVhZCBvZlxuXHQgICAgICAgKiAgICAgY29tcGFyaW5nIGZvciByZWZlcmVuY2UgZXF1YWxpdHkuXG5cdCAgICAgICAqIEByZXR1cm5zIHtmdW5jdGlvbigpfSBSZXR1cm5zIGEgZGVyZWdpc3RyYXRpb24gZnVuY3Rpb24gZm9yIHRoaXMgbGlzdGVuZXIuXG5cdCAgICAgICAqL1xuXHQgICAgICAkd2F0Y2g6IGZ1bmN0aW9uKHdhdGNoRXhwLCBsaXN0ZW5lciwgb2JqZWN0RXF1YWxpdHksIHByZXR0eVByaW50RXhwcmVzc2lvbikge1xuXHQgICAgICAgIHZhciBnZXQgPSAkcGFyc2Uod2F0Y2hFeHApO1xuXHRcblx0ICAgICAgICBpZiAoZ2V0LiQkd2F0Y2hEZWxlZ2F0ZSkge1xuXHQgICAgICAgICAgcmV0dXJuIGdldC4kJHdhdGNoRGVsZWdhdGUodGhpcywgbGlzdGVuZXIsIG9iamVjdEVxdWFsaXR5LCBnZXQsIHdhdGNoRXhwKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdmFyIHNjb3BlID0gdGhpcyxcblx0ICAgICAgICAgICAgYXJyYXkgPSBzY29wZS4kJHdhdGNoZXJzLFxuXHQgICAgICAgICAgICB3YXRjaGVyID0ge1xuXHQgICAgICAgICAgICAgIGZuOiBsaXN0ZW5lcixcblx0ICAgICAgICAgICAgICBsYXN0OiBpbml0V2F0Y2hWYWwsXG5cdCAgICAgICAgICAgICAgZ2V0OiBnZXQsXG5cdCAgICAgICAgICAgICAgZXhwOiBwcmV0dHlQcmludEV4cHJlc3Npb24gfHwgd2F0Y2hFeHAsXG5cdCAgICAgICAgICAgICAgZXE6ICEhb2JqZWN0RXF1YWxpdHlcblx0ICAgICAgICAgICAgfTtcblx0XG5cdCAgICAgICAgbGFzdERpcnR5V2F0Y2ggPSBudWxsO1xuXHRcblx0ICAgICAgICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKSB7XG5cdCAgICAgICAgICB3YXRjaGVyLmZuID0gbm9vcDtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmICghYXJyYXkpIHtcblx0ICAgICAgICAgIGFycmF5ID0gc2NvcGUuJCR3YXRjaGVycyA9IFtdO1xuXHQgICAgICAgIH1cblx0ICAgICAgICAvLyB3ZSB1c2UgdW5zaGlmdCBzaW5jZSB3ZSB1c2UgYSB3aGlsZSBsb29wIGluICRkaWdlc3QgZm9yIHNwZWVkLlxuXHQgICAgICAgIC8vIHRoZSB3aGlsZSBsb29wIHJlYWRzIGluIHJldmVyc2Ugb3JkZXIuXG5cdCAgICAgICAgYXJyYXkudW5zaGlmdCh3YXRjaGVyKTtcblx0ICAgICAgICBpbmNyZW1lbnRXYXRjaGVyc0NvdW50KHRoaXMsIDEpO1xuXHRcblx0ICAgICAgICByZXR1cm4gZnVuY3Rpb24gZGVyZWdpc3RlcldhdGNoKCkge1xuXHQgICAgICAgICAgaWYgKGFycmF5UmVtb3ZlKGFycmF5LCB3YXRjaGVyKSA+PSAwKSB7XG5cdCAgICAgICAgICAgIGluY3JlbWVudFdhdGNoZXJzQ291bnQoc2NvcGUsIC0xKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGxhc3REaXJ0eVdhdGNoID0gbnVsbDtcblx0ICAgICAgICB9O1xuXHQgICAgICB9LFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkd2F0Y2hHcm91cFxuXHQgICAgICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICogQSB2YXJpYW50IG9mIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyR3YXRjaCAkd2F0Y2goKX0gd2hlcmUgaXQgd2F0Y2hlcyBhbiBhcnJheSBvZiBgd2F0Y2hFeHByZXNzaW9uc2AuXG5cdCAgICAgICAqIElmIGFueSBvbmUgZXhwcmVzc2lvbiBpbiB0aGUgY29sbGVjdGlvbiBjaGFuZ2VzIHRoZSBgbGlzdGVuZXJgIGlzIGV4ZWN1dGVkLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiAtIFRoZSBpdGVtcyBpbiB0aGUgYHdhdGNoRXhwcmVzc2lvbnNgIGFycmF5IGFyZSBvYnNlcnZlZCB2aWEgc3RhbmRhcmQgJHdhdGNoIG9wZXJhdGlvbiBhbmQgYXJlIGV4YW1pbmVkIG9uIGV2ZXJ5XG5cdCAgICAgICAqICAgY2FsbCB0byAkZGlnZXN0KCkgdG8gc2VlIGlmIGFueSBpdGVtcyBjaGFuZ2VzLlxuXHQgICAgICAgKiAtIFRoZSBgbGlzdGVuZXJgIGlzIGNhbGxlZCB3aGVuZXZlciBhbnkgZXhwcmVzc2lvbiBpbiB0aGUgYHdhdGNoRXhwcmVzc2lvbnNgIGFycmF5IGNoYW5nZXMuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7QXJyYXkuPHN0cmluZ3xGdW5jdGlvbihzY29wZSk+fSB3YXRjaEV4cHJlc3Npb25zIEFycmF5IG9mIGV4cHJlc3Npb25zIHRoYXQgd2lsbCBiZSBpbmRpdmlkdWFsbHlcblx0ICAgICAgICogd2F0Y2hlZCB1c2luZyB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkd2F0Y2ggJHdhdGNoKCl9XG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24obmV3VmFsdWVzLCBvbGRWYWx1ZXMsIHNjb3BlKX0gbGlzdGVuZXIgQ2FsbGJhY2sgY2FsbGVkIHdoZW5ldmVyIHRoZSByZXR1cm4gdmFsdWUgb2YgYW55XG5cdCAgICAgICAqICAgIGV4cHJlc3Npb24gaW4gYHdhdGNoRXhwcmVzc2lvbnNgIGNoYW5nZXNcblx0ICAgICAgICogICAgVGhlIGBuZXdWYWx1ZXNgIGFycmF5IGNvbnRhaW5zIHRoZSBjdXJyZW50IHZhbHVlcyBvZiB0aGUgYHdhdGNoRXhwcmVzc2lvbnNgLCB3aXRoIHRoZSBpbmRleGVzIG1hdGNoaW5nXG5cdCAgICAgICAqICAgIHRob3NlIG9mIGB3YXRjaEV4cHJlc3Npb25gXG5cdCAgICAgICAqICAgIGFuZCB0aGUgYG9sZFZhbHVlc2AgYXJyYXkgY29udGFpbnMgdGhlIHByZXZpb3VzIHZhbHVlcyBvZiB0aGUgYHdhdGNoRXhwcmVzc2lvbnNgLCB3aXRoIHRoZSBpbmRleGVzIG1hdGNoaW5nXG5cdCAgICAgICAqICAgIHRob3NlIG9mIGB3YXRjaEV4cHJlc3Npb25gXG5cdCAgICAgICAqICAgIFRoZSBgc2NvcGVgIHJlZmVycyB0byB0aGUgY3VycmVudCBzY29wZS5cblx0ICAgICAgICogQHJldHVybnMge2Z1bmN0aW9uKCl9IFJldHVybnMgYSBkZS1yZWdpc3RyYXRpb24gZnVuY3Rpb24gZm9yIGFsbCBsaXN0ZW5lcnMuXG5cdCAgICAgICAqL1xuXHQgICAgICAkd2F0Y2hHcm91cDogZnVuY3Rpb24od2F0Y2hFeHByZXNzaW9ucywgbGlzdGVuZXIpIHtcblx0ICAgICAgICB2YXIgb2xkVmFsdWVzID0gbmV3IEFycmF5KHdhdGNoRXhwcmVzc2lvbnMubGVuZ3RoKTtcblx0ICAgICAgICB2YXIgbmV3VmFsdWVzID0gbmV3IEFycmF5KHdhdGNoRXhwcmVzc2lvbnMubGVuZ3RoKTtcblx0ICAgICAgICB2YXIgZGVyZWdpc3RlckZucyA9IFtdO1xuXHQgICAgICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgICAgICB2YXIgY2hhbmdlUmVhY3Rpb25TY2hlZHVsZWQgPSBmYWxzZTtcblx0ICAgICAgICB2YXIgZmlyc3RSdW4gPSB0cnVlO1xuXHRcblx0ICAgICAgICBpZiAoIXdhdGNoRXhwcmVzc2lvbnMubGVuZ3RoKSB7XG5cdCAgICAgICAgICAvLyBObyBleHByZXNzaW9ucyBtZWFucyB3ZSBjYWxsIHRoZSBsaXN0ZW5lciBBU0FQXG5cdCAgICAgICAgICB2YXIgc2hvdWxkQ2FsbCA9IHRydWU7XG5cdCAgICAgICAgICBzZWxmLiRldmFsQXN5bmMoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGlmIChzaG91bGRDYWxsKSBsaXN0ZW5lcihuZXdWYWx1ZXMsIG5ld1ZhbHVlcywgc2VsZik7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBkZXJlZ2lzdGVyV2F0Y2hHcm91cCgpIHtcblx0ICAgICAgICAgICAgc2hvdWxkQ2FsbCA9IGZhbHNlO1xuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmICh3YXRjaEV4cHJlc3Npb25zLmxlbmd0aCA9PT0gMSkge1xuXHQgICAgICAgICAgLy8gU3BlY2lhbCBjYXNlIHNpemUgb2Ygb25lXG5cdCAgICAgICAgICByZXR1cm4gdGhpcy4kd2F0Y2god2F0Y2hFeHByZXNzaW9uc1swXSwgZnVuY3Rpb24gd2F0Y2hHcm91cEFjdGlvbih2YWx1ZSwgb2xkVmFsdWUsIHNjb3BlKSB7XG5cdCAgICAgICAgICAgIG5ld1ZhbHVlc1swXSA9IHZhbHVlO1xuXHQgICAgICAgICAgICBvbGRWYWx1ZXNbMF0gPSBvbGRWYWx1ZTtcblx0ICAgICAgICAgICAgbGlzdGVuZXIobmV3VmFsdWVzLCAodmFsdWUgPT09IG9sZFZhbHVlKSA/IG5ld1ZhbHVlcyA6IG9sZFZhbHVlcywgc2NvcGUpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBmb3JFYWNoKHdhdGNoRXhwcmVzc2lvbnMsIGZ1bmN0aW9uKGV4cHIsIGkpIHtcblx0ICAgICAgICAgIHZhciB1bndhdGNoRm4gPSBzZWxmLiR3YXRjaChleHByLCBmdW5jdGlvbiB3YXRjaEdyb3VwU3ViQWN0aW9uKHZhbHVlLCBvbGRWYWx1ZSkge1xuXHQgICAgICAgICAgICBuZXdWYWx1ZXNbaV0gPSB2YWx1ZTtcblx0ICAgICAgICAgICAgb2xkVmFsdWVzW2ldID0gb2xkVmFsdWU7XG5cdCAgICAgICAgICAgIGlmICghY2hhbmdlUmVhY3Rpb25TY2hlZHVsZWQpIHtcblx0ICAgICAgICAgICAgICBjaGFuZ2VSZWFjdGlvblNjaGVkdWxlZCA9IHRydWU7XG5cdCAgICAgICAgICAgICAgc2VsZi4kZXZhbEFzeW5jKHdhdGNoR3JvdXBBY3Rpb24pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICAgIGRlcmVnaXN0ZXJGbnMucHVzaCh1bndhdGNoRm4pO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBmdW5jdGlvbiB3YXRjaEdyb3VwQWN0aW9uKCkge1xuXHQgICAgICAgICAgY2hhbmdlUmVhY3Rpb25TY2hlZHVsZWQgPSBmYWxzZTtcblx0XG5cdCAgICAgICAgICBpZiAoZmlyc3RSdW4pIHtcblx0ICAgICAgICAgICAgZmlyc3RSdW4gPSBmYWxzZTtcblx0ICAgICAgICAgICAgbGlzdGVuZXIobmV3VmFsdWVzLCBuZXdWYWx1ZXMsIHNlbGYpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgbGlzdGVuZXIobmV3VmFsdWVzLCBvbGRWYWx1ZXMsIHNlbGYpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGRlcmVnaXN0ZXJXYXRjaEdyb3VwKCkge1xuXHQgICAgICAgICAgd2hpbGUgKGRlcmVnaXN0ZXJGbnMubGVuZ3RoKSB7XG5cdCAgICAgICAgICAgIGRlcmVnaXN0ZXJGbnMuc2hpZnQoKSgpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH07XG5cdCAgICAgIH0sXG5cdFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkd2F0Y2hDb2xsZWN0aW9uXG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBTaGFsbG93IHdhdGNoZXMgdGhlIHByb3BlcnRpZXMgb2YgYW4gb2JqZWN0IGFuZCBmaXJlcyB3aGVuZXZlciBhbnkgb2YgdGhlIHByb3BlcnRpZXMgY2hhbmdlXG5cdCAgICAgICAqIChmb3IgYXJyYXlzLCB0aGlzIGltcGxpZXMgd2F0Y2hpbmcgdGhlIGFycmF5IGl0ZW1zOyBmb3Igb2JqZWN0IG1hcHMsIHRoaXMgaW1wbGllcyB3YXRjaGluZ1xuXHQgICAgICAgKiB0aGUgcHJvcGVydGllcykuIElmIGEgY2hhbmdlIGlzIGRldGVjdGVkLCB0aGUgYGxpc3RlbmVyYCBjYWxsYmFjayBpcyBmaXJlZC5cblx0ICAgICAgICpcblx0ICAgICAgICogLSBUaGUgYG9iamAgY29sbGVjdGlvbiBpcyBvYnNlcnZlZCB2aWEgc3RhbmRhcmQgJHdhdGNoIG9wZXJhdGlvbiBhbmQgaXMgZXhhbWluZWQgb24gZXZlcnlcblx0ICAgICAgICogICBjYWxsIHRvICRkaWdlc3QoKSB0byBzZWUgaWYgYW55IGl0ZW1zIGhhdmUgYmVlbiBhZGRlZCwgcmVtb3ZlZCwgb3IgbW92ZWQuXG5cdCAgICAgICAqIC0gVGhlIGBsaXN0ZW5lcmAgaXMgY2FsbGVkIHdoZW5ldmVyIGFueXRoaW5nIHdpdGhpbiB0aGUgYG9iamAgaGFzIGNoYW5nZWQuIEV4YW1wbGVzIGluY2x1ZGVcblx0ICAgICAgICogICBhZGRpbmcsIHJlbW92aW5nLCBhbmQgbW92aW5nIGl0ZW1zIGJlbG9uZ2luZyB0byBhbiBvYmplY3Qgb3IgYXJyYXkuXG5cdCAgICAgICAqXG5cdCAgICAgICAqXG5cdCAgICAgICAqICMgRXhhbXBsZVxuXHQgICAgICAgKiBgYGBqc1xuXHQgICAgICAgICAgJHNjb3BlLm5hbWVzID0gWydpZ29yJywgJ21hdGlhcycsICdtaXNrbycsICdqYW1lcyddO1xuXHQgICAgICAgICAgJHNjb3BlLmRhdGFDb3VudCA9IDQ7XG5cdFxuXHQgICAgICAgICAgJHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oJ25hbWVzJywgZnVuY3Rpb24obmV3TmFtZXMsIG9sZE5hbWVzKSB7XG5cdCAgICAgICAgICAgICRzY29wZS5kYXRhQ291bnQgPSBuZXdOYW1lcy5sZW5ndGg7XG5cdCAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICBleHBlY3QoJHNjb3BlLmRhdGFDb3VudCkudG9FcXVhbCg0KTtcblx0ICAgICAgICAgICRzY29wZS4kZGlnZXN0KCk7XG5cdFxuXHQgICAgICAgICAgLy9zdGlsbCBhdCA0IC4uLiBubyBjaGFuZ2VzXG5cdCAgICAgICAgICBleHBlY3QoJHNjb3BlLmRhdGFDb3VudCkudG9FcXVhbCg0KTtcblx0XG5cdCAgICAgICAgICAkc2NvcGUubmFtZXMucG9wKCk7XG5cdCAgICAgICAgICAkc2NvcGUuJGRpZ2VzdCgpO1xuXHRcblx0ICAgICAgICAgIC8vbm93IHRoZXJlJ3MgYmVlbiBhIGNoYW5nZVxuXHQgICAgICAgICAgZXhwZWN0KCRzY29wZS5kYXRhQ291bnQpLnRvRXF1YWwoMyk7XG5cdCAgICAgICAqIGBgYFxuXHQgICAgICAgKlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAcGFyYW0ge3N0cmluZ3xmdW5jdGlvbihzY29wZSl9IG9iaiBFdmFsdWF0ZWQgYXMge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gZXhwcmVzc2lvbn0uIFRoZVxuXHQgICAgICAgKiAgICBleHByZXNzaW9uIHZhbHVlIHNob3VsZCBldmFsdWF0ZSB0byBhbiBvYmplY3Qgb3IgYW4gYXJyYXkgd2hpY2ggaXMgb2JzZXJ2ZWQgb24gZWFjaFxuXHQgICAgICAgKiAgICB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0ICRkaWdlc3R9IGN5Y2xlLiBBbnkgc2hhbGxvdyBjaGFuZ2Ugd2l0aGluIHRoZVxuXHQgICAgICAgKiAgICBjb2xsZWN0aW9uIHdpbGwgdHJpZ2dlciBhIGNhbGwgdG8gdGhlIGBsaXN0ZW5lcmAuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24obmV3Q29sbGVjdGlvbiwgb2xkQ29sbGVjdGlvbiwgc2NvcGUpfSBsaXN0ZW5lciBhIGNhbGxiYWNrIGZ1bmN0aW9uIGNhbGxlZFxuXHQgICAgICAgKiAgICB3aGVuIGEgY2hhbmdlIGlzIGRldGVjdGVkLlxuXHQgICAgICAgKiAgICAtIFRoZSBgbmV3Q29sbGVjdGlvbmAgb2JqZWN0IGlzIHRoZSBuZXdseSBtb2RpZmllZCBkYXRhIG9idGFpbmVkIGZyb20gdGhlIGBvYmpgIGV4cHJlc3Npb25cblx0ICAgICAgICogICAgLSBUaGUgYG9sZENvbGxlY3Rpb25gIG9iamVjdCBpcyBhIGNvcHkgb2YgdGhlIGZvcm1lciBjb2xsZWN0aW9uIGRhdGEuXG5cdCAgICAgICAqICAgICAgRHVlIHRvIHBlcmZvcm1hbmNlIGNvbnNpZGVyYXRpb25zLCB0aGVgb2xkQ29sbGVjdGlvbmAgdmFsdWUgaXMgY29tcHV0ZWQgb25seSBpZiB0aGVcblx0ICAgICAgICogICAgICBgbGlzdGVuZXJgIGZ1bmN0aW9uIGRlY2xhcmVzIHR3byBvciBtb3JlIGFyZ3VtZW50cy5cblx0ICAgICAgICogICAgLSBUaGUgYHNjb3BlYCBhcmd1bWVudCByZWZlcnMgdG8gdGhlIGN1cnJlbnQgc2NvcGUuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEByZXR1cm5zIHtmdW5jdGlvbigpfSBSZXR1cm5zIGEgZGUtcmVnaXN0cmF0aW9uIGZ1bmN0aW9uIGZvciB0aGlzIGxpc3RlbmVyLiBXaGVuIHRoZVxuXHQgICAgICAgKiAgICBkZS1yZWdpc3RyYXRpb24gZnVuY3Rpb24gaXMgZXhlY3V0ZWQsIHRoZSBpbnRlcm5hbCB3YXRjaCBvcGVyYXRpb24gaXMgdGVybWluYXRlZC5cblx0ICAgICAgICovXG5cdCAgICAgICR3YXRjaENvbGxlY3Rpb246IGZ1bmN0aW9uKG9iaiwgbGlzdGVuZXIpIHtcblx0ICAgICAgICAkd2F0Y2hDb2xsZWN0aW9uSW50ZXJjZXB0b3IuJHN0YXRlZnVsID0gdHJ1ZTtcblx0XG5cdCAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXHQgICAgICAgIC8vIHRoZSBjdXJyZW50IHZhbHVlLCB1cGRhdGVkIG9uIGVhY2ggZGlydHktY2hlY2sgcnVuXG5cdCAgICAgICAgdmFyIG5ld1ZhbHVlO1xuXHQgICAgICAgIC8vIGEgc2hhbGxvdyBjb3B5IG9mIHRoZSBuZXdWYWx1ZSBmcm9tIHRoZSBsYXN0IGRpcnR5LWNoZWNrIHJ1bixcblx0ICAgICAgICAvLyB1cGRhdGVkIHRvIG1hdGNoIG5ld1ZhbHVlIGR1cmluZyBkaXJ0eS1jaGVjayBydW5cblx0ICAgICAgICB2YXIgb2xkVmFsdWU7XG5cdCAgICAgICAgLy8gYSBzaGFsbG93IGNvcHkgb2YgdGhlIG5ld1ZhbHVlIGZyb20gd2hlbiB0aGUgbGFzdCBjaGFuZ2UgaGFwcGVuZWRcblx0ICAgICAgICB2YXIgdmVyeU9sZFZhbHVlO1xuXHQgICAgICAgIC8vIG9ubHkgdHJhY2sgdmVyeU9sZFZhbHVlIGlmIHRoZSBsaXN0ZW5lciBpcyBhc2tpbmcgZm9yIGl0XG5cdCAgICAgICAgdmFyIHRyYWNrVmVyeU9sZFZhbHVlID0gKGxpc3RlbmVyLmxlbmd0aCA+IDEpO1xuXHQgICAgICAgIHZhciBjaGFuZ2VEZXRlY3RlZCA9IDA7XG5cdCAgICAgICAgdmFyIGNoYW5nZURldGVjdG9yID0gJHBhcnNlKG9iaiwgJHdhdGNoQ29sbGVjdGlvbkludGVyY2VwdG9yKTtcblx0ICAgICAgICB2YXIgaW50ZXJuYWxBcnJheSA9IFtdO1xuXHQgICAgICAgIHZhciBpbnRlcm5hbE9iamVjdCA9IHt9O1xuXHQgICAgICAgIHZhciBpbml0UnVuID0gdHJ1ZTtcblx0ICAgICAgICB2YXIgb2xkTGVuZ3RoID0gMDtcblx0XG5cdCAgICAgICAgZnVuY3Rpb24gJHdhdGNoQ29sbGVjdGlvbkludGVyY2VwdG9yKF92YWx1ZSkge1xuXHQgICAgICAgICAgbmV3VmFsdWUgPSBfdmFsdWU7XG5cdCAgICAgICAgICB2YXIgbmV3TGVuZ3RoLCBrZXksIGJvdGhOYU4sIG5ld0l0ZW0sIG9sZEl0ZW07XG5cdFxuXHQgICAgICAgICAgLy8gSWYgdGhlIG5ldyB2YWx1ZSBpcyB1bmRlZmluZWQsIHRoZW4gcmV0dXJuIHVuZGVmaW5lZCBhcyB0aGUgd2F0Y2ggbWF5IGJlIGEgb25lLXRpbWUgd2F0Y2hcblx0ICAgICAgICAgIGlmIChpc1VuZGVmaW5lZChuZXdWYWx1ZSkpIHJldHVybjtcblx0XG5cdCAgICAgICAgICBpZiAoIWlzT2JqZWN0KG5ld1ZhbHVlKSkgeyAvLyBpZiBwcmltaXRpdmVcblx0ICAgICAgICAgICAgaWYgKG9sZFZhbHVlICE9PSBuZXdWYWx1ZSkge1xuXHQgICAgICAgICAgICAgIG9sZFZhbHVlID0gbmV3VmFsdWU7XG5cdCAgICAgICAgICAgICAgY2hhbmdlRGV0ZWN0ZWQrKztcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5TGlrZShuZXdWYWx1ZSkpIHtcblx0ICAgICAgICAgICAgaWYgKG9sZFZhbHVlICE9PSBpbnRlcm5hbEFycmF5KSB7XG5cdCAgICAgICAgICAgICAgLy8gd2UgYXJlIHRyYW5zaXRpb25pbmcgZnJvbSBzb21ldGhpbmcgd2hpY2ggd2FzIG5vdCBhbiBhcnJheSBpbnRvIGFycmF5LlxuXHQgICAgICAgICAgICAgIG9sZFZhbHVlID0gaW50ZXJuYWxBcnJheTtcblx0ICAgICAgICAgICAgICBvbGRMZW5ndGggPSBvbGRWYWx1ZS5sZW5ndGggPSAwO1xuXHQgICAgICAgICAgICAgIGNoYW5nZURldGVjdGVkKys7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIG5ld0xlbmd0aCA9IG5ld1ZhbHVlLmxlbmd0aDtcblx0XG5cdCAgICAgICAgICAgIGlmIChvbGRMZW5ndGggIT09IG5ld0xlbmd0aCkge1xuXHQgICAgICAgICAgICAgIC8vIGlmIGxlbmd0aHMgZG8gbm90IG1hdGNoIHdlIG5lZWQgdG8gdHJpZ2dlciBjaGFuZ2Ugbm90aWZpY2F0aW9uXG5cdCAgICAgICAgICAgICAgY2hhbmdlRGV0ZWN0ZWQrKztcblx0ICAgICAgICAgICAgICBvbGRWYWx1ZS5sZW5ndGggPSBvbGRMZW5ndGggPSBuZXdMZW5ndGg7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgLy8gY29weSB0aGUgaXRlbXMgdG8gb2xkVmFsdWUgYW5kIGxvb2sgZm9yIGNoYW5nZXMuXG5cdCAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbmV3TGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgICAgICBvbGRJdGVtID0gb2xkVmFsdWVbaV07XG5cdCAgICAgICAgICAgICAgbmV3SXRlbSA9IG5ld1ZhbHVlW2ldO1xuXHRcblx0ICAgICAgICAgICAgICBib3RoTmFOID0gKG9sZEl0ZW0gIT09IG9sZEl0ZW0pICYmIChuZXdJdGVtICE9PSBuZXdJdGVtKTtcblx0ICAgICAgICAgICAgICBpZiAoIWJvdGhOYU4gJiYgKG9sZEl0ZW0gIT09IG5ld0l0ZW0pKSB7XG5cdCAgICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3RlZCsrO1xuXHQgICAgICAgICAgICAgICAgb2xkVmFsdWVbaV0gPSBuZXdJdGVtO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgaWYgKG9sZFZhbHVlICE9PSBpbnRlcm5hbE9iamVjdCkge1xuXHQgICAgICAgICAgICAgIC8vIHdlIGFyZSB0cmFuc2l0aW9uaW5nIGZyb20gc29tZXRoaW5nIHdoaWNoIHdhcyBub3QgYW4gb2JqZWN0IGludG8gb2JqZWN0LlxuXHQgICAgICAgICAgICAgIG9sZFZhbHVlID0gaW50ZXJuYWxPYmplY3QgPSB7fTtcblx0ICAgICAgICAgICAgICBvbGRMZW5ndGggPSAwO1xuXHQgICAgICAgICAgICAgIGNoYW5nZURldGVjdGVkKys7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgLy8gY29weSB0aGUgaXRlbXMgdG8gb2xkVmFsdWUgYW5kIGxvb2sgZm9yIGNoYW5nZXMuXG5cdCAgICAgICAgICAgIG5ld0xlbmd0aCA9IDA7XG5cdCAgICAgICAgICAgIGZvciAoa2V5IGluIG5ld1ZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwobmV3VmFsdWUsIGtleSkpIHtcblx0ICAgICAgICAgICAgICAgIG5ld0xlbmd0aCsrO1xuXHQgICAgICAgICAgICAgICAgbmV3SXRlbSA9IG5ld1ZhbHVlW2tleV07XG5cdCAgICAgICAgICAgICAgICBvbGRJdGVtID0gb2xkVmFsdWVba2V5XTtcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAoa2V5IGluIG9sZFZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgICAgIGJvdGhOYU4gPSAob2xkSXRlbSAhPT0gb2xkSXRlbSkgJiYgKG5ld0l0ZW0gIT09IG5ld0l0ZW0pO1xuXHQgICAgICAgICAgICAgICAgICBpZiAoIWJvdGhOYU4gJiYgKG9sZEl0ZW0gIT09IG5ld0l0ZW0pKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgY2hhbmdlRGV0ZWN0ZWQrKztcblx0ICAgICAgICAgICAgICAgICAgICBvbGRWYWx1ZVtrZXldID0gbmV3SXRlbTtcblx0ICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgb2xkTGVuZ3RoKys7XG5cdCAgICAgICAgICAgICAgICAgIG9sZFZhbHVlW2tleV0gPSBuZXdJdGVtO1xuXHQgICAgICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3RlZCsrO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBpZiAob2xkTGVuZ3RoID4gbmV3TGVuZ3RoKSB7XG5cdCAgICAgICAgICAgICAgLy8gd2UgdXNlZCB0byBoYXZlIG1vcmUga2V5cywgbmVlZCB0byBmaW5kIHRoZW0gYW5kIGRlc3Ryb3kgdGhlbS5cblx0ICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3RlZCsrO1xuXHQgICAgICAgICAgICAgIGZvciAoa2V5IGluIG9sZFZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAoIWhhc093blByb3BlcnR5LmNhbGwobmV3VmFsdWUsIGtleSkpIHtcblx0ICAgICAgICAgICAgICAgICAgb2xkTGVuZ3RoLS07XG5cdCAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvbGRWYWx1ZVtrZXldO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgcmV0dXJuIGNoYW5nZURldGVjdGVkO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgZnVuY3Rpb24gJHdhdGNoQ29sbGVjdGlvbkFjdGlvbigpIHtcblx0ICAgICAgICAgIGlmIChpbml0UnVuKSB7XG5cdCAgICAgICAgICAgIGluaXRSdW4gPSBmYWxzZTtcblx0ICAgICAgICAgICAgbGlzdGVuZXIobmV3VmFsdWUsIG5ld1ZhbHVlLCBzZWxmKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGxpc3RlbmVyKG5ld1ZhbHVlLCB2ZXJ5T2xkVmFsdWUsIHNlbGYpO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIC8vIG1ha2UgYSBjb3B5IGZvciB0aGUgbmV4dCB0aW1lIGEgY29sbGVjdGlvbiBpcyBjaGFuZ2VkXG5cdCAgICAgICAgICBpZiAodHJhY2tWZXJ5T2xkVmFsdWUpIHtcblx0ICAgICAgICAgICAgaWYgKCFpc09iamVjdChuZXdWYWx1ZSkpIHtcblx0ICAgICAgICAgICAgICAvL3ByaW1pdGl2ZVxuXHQgICAgICAgICAgICAgIHZlcnlPbGRWYWx1ZSA9IG5ld1ZhbHVlO1xuXHQgICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXlMaWtlKG5ld1ZhbHVlKSkge1xuXHQgICAgICAgICAgICAgIHZlcnlPbGRWYWx1ZSA9IG5ldyBBcnJheShuZXdWYWx1ZS5sZW5ndGgpO1xuXHQgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbmV3VmFsdWUubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgICAgICAgIHZlcnlPbGRWYWx1ZVtpXSA9IG5ld1ZhbHVlW2ldO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSBlbHNlIHsgLy8gaWYgb2JqZWN0XG5cdCAgICAgICAgICAgICAgdmVyeU9sZFZhbHVlID0ge307XG5cdCAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG5ld1ZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChuZXdWYWx1ZSwga2V5KSkge1xuXHQgICAgICAgICAgICAgICAgICB2ZXJ5T2xkVmFsdWVba2V5XSA9IG5ld1ZhbHVlW2tleV07XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZXR1cm4gdGhpcy4kd2F0Y2goY2hhbmdlRGV0ZWN0b3IsICR3YXRjaENvbGxlY3Rpb25BY3Rpb24pO1xuXHQgICAgICB9LFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0XG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBQcm9jZXNzZXMgYWxsIG9mIHRoZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkd2F0Y2ggd2F0Y2hlcnN9IG9mIHRoZSBjdXJyZW50IHNjb3BlIGFuZFxuXHQgICAgICAgKiBpdHMgY2hpbGRyZW4uIEJlY2F1c2UgYSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkd2F0Y2ggd2F0Y2hlcn0ncyBsaXN0ZW5lciBjYW4gY2hhbmdlXG5cdCAgICAgICAqIHRoZSBtb2RlbCwgdGhlIGAkZGlnZXN0KClgIGtlZXBzIGNhbGxpbmcgdGhlIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyR3YXRjaCB3YXRjaGVyc31cblx0ICAgICAgICogdW50aWwgbm8gbW9yZSBsaXN0ZW5lcnMgYXJlIGZpcmluZy4gVGhpcyBtZWFucyB0aGF0IGl0IGlzIHBvc3NpYmxlIHRvIGdldCBpbnRvIGFuIGluZmluaXRlXG5cdCAgICAgICAqIGxvb3AuIFRoaXMgZnVuY3Rpb24gd2lsbCB0aHJvdyBgJ01heGltdW0gaXRlcmF0aW9uIGxpbWl0IGV4Y2VlZGVkLidgIGlmIHRoZSBudW1iZXIgb2Zcblx0ICAgICAgICogaXRlcmF0aW9ucyBleGNlZWRzIDEwLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBVc3VhbGx5LCB5b3UgZG9uJ3QgY2FsbCBgJGRpZ2VzdCgpYCBkaXJlY3RseSBpblxuXHQgICAgICAgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nQ29udHJvbGxlciBjb250cm9sbGVyc30gb3IgaW5cblx0ICAgICAgICoge0BsaW5rIG5nLiRjb21waWxlUHJvdmlkZXIjZGlyZWN0aXZlIGRpcmVjdGl2ZXN9LlxuXHQgICAgICAgKiBJbnN0ZWFkLCB5b3Ugc2hvdWxkIGNhbGwge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGFwcGx5ICRhcHBseSgpfSAodHlwaWNhbGx5IGZyb20gd2l0aGluXG5cdCAgICAgICAqIGEge0BsaW5rIG5nLiRjb21waWxlUHJvdmlkZXIjZGlyZWN0aXZlIGRpcmVjdGl2ZX0pLCB3aGljaCB3aWxsIGZvcmNlIGEgYCRkaWdlc3QoKWAuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIElmIHlvdSB3YW50IHRvIGJlIG5vdGlmaWVkIHdoZW5ldmVyIGAkZGlnZXN0KClgIGlzIGNhbGxlZCxcblx0ICAgICAgICogeW91IGNhbiByZWdpc3RlciBhIGB3YXRjaEV4cHJlc3Npb25gIGZ1bmN0aW9uIHdpdGhcblx0ICAgICAgICoge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJHdhdGNoICR3YXRjaCgpfSB3aXRoIG5vIGBsaXN0ZW5lcmAuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEluIHVuaXQgdGVzdHMsIHlvdSBtYXkgbmVlZCB0byBjYWxsIGAkZGlnZXN0KClgIHRvIHNpbXVsYXRlIHRoZSBzY29wZSBsaWZlIGN5Y2xlLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiAjIEV4YW1wbGVcblx0ICAgICAgICogYGBganNcblx0ICAgICAgICAgICB2YXIgc2NvcGUgPSAuLi47XG5cdCAgICAgICAgICAgc2NvcGUubmFtZSA9ICdtaXNrbyc7XG5cdCAgICAgICAgICAgc2NvcGUuY291bnRlciA9IDA7XG5cdFxuXHQgICAgICAgICAgIGV4cGVjdChzY29wZS5jb3VudGVyKS50b0VxdWFsKDApO1xuXHQgICAgICAgICAgIHNjb3BlLiR3YXRjaCgnbmFtZScsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuXHQgICAgICAgICAgICAgc2NvcGUuY291bnRlciA9IHNjb3BlLmNvdW50ZXIgKyAxO1xuXHQgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgIGV4cGVjdChzY29wZS5jb3VudGVyKS50b0VxdWFsKDApO1xuXHRcblx0ICAgICAgICAgICBzY29wZS4kZGlnZXN0KCk7XG5cdCAgICAgICAgICAgLy8gdGhlIGxpc3RlbmVyIGlzIGFsd2F5cyBjYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCAkZGlnZXN0IGxvb3AgYWZ0ZXIgaXQgd2FzIHJlZ2lzdGVyZWRcblx0ICAgICAgICAgICBleHBlY3Qoc2NvcGUuY291bnRlcikudG9FcXVhbCgxKTtcblx0XG5cdCAgICAgICAgICAgc2NvcGUuJGRpZ2VzdCgpO1xuXHQgICAgICAgICAgIC8vIGJ1dCBub3cgaXQgd2lsbCBub3QgYmUgY2FsbGVkIHVubGVzcyB0aGUgdmFsdWUgY2hhbmdlc1xuXHQgICAgICAgICAgIGV4cGVjdChzY29wZS5jb3VudGVyKS50b0VxdWFsKDEpO1xuXHRcblx0ICAgICAgICAgICBzY29wZS5uYW1lID0gJ2FkYW0nO1xuXHQgICAgICAgICAgIHNjb3BlLiRkaWdlc3QoKTtcblx0ICAgICAgICAgICBleHBlY3Qoc2NvcGUuY291bnRlcikudG9FcXVhbCgyKTtcblx0ICAgICAgICogYGBgXG5cdCAgICAgICAqXG5cdCAgICAgICAqL1xuXHQgICAgICAkZGlnZXN0OiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgd2F0Y2gsIHZhbHVlLCBsYXN0LCBmbiwgZ2V0LFxuXHQgICAgICAgICAgICB3YXRjaGVycyxcblx0ICAgICAgICAgICAgbGVuZ3RoLFxuXHQgICAgICAgICAgICBkaXJ0eSwgdHRsID0gVFRMLFxuXHQgICAgICAgICAgICBuZXh0LCBjdXJyZW50LCB0YXJnZXQgPSB0aGlzLFxuXHQgICAgICAgICAgICB3YXRjaExvZyA9IFtdLFxuXHQgICAgICAgICAgICBsb2dJZHgsIGxvZ01zZywgYXN5bmNUYXNrO1xuXHRcblx0ICAgICAgICBiZWdpblBoYXNlKCckZGlnZXN0Jyk7XG5cdCAgICAgICAgLy8gQ2hlY2sgZm9yIGNoYW5nZXMgdG8gYnJvd3NlciB1cmwgdGhhdCBoYXBwZW5lZCBpbiBzeW5jIGJlZm9yZSB0aGUgY2FsbCB0byAkZGlnZXN0XG5cdCAgICAgICAgJGJyb3dzZXIuJCRjaGVja1VybENoYW5nZSgpO1xuXHRcblx0ICAgICAgICBpZiAodGhpcyA9PT0gJHJvb3RTY29wZSAmJiBhcHBseUFzeW5jSWQgIT09IG51bGwpIHtcblx0ICAgICAgICAgIC8vIElmIHRoaXMgaXMgdGhlIHJvb3Qgc2NvcGUsIGFuZCAkYXBwbHlBc3luYyBoYXMgc2NoZWR1bGVkIGEgZGVmZXJyZWQgJGFwcGx5KCksIHRoZW5cblx0ICAgICAgICAgIC8vIGNhbmNlbCB0aGUgc2NoZWR1bGVkICRhcHBseSBhbmQgZmx1c2ggdGhlIHF1ZXVlIG9mIGV4cHJlc3Npb25zIHRvIGJlIGV2YWx1YXRlZC5cblx0ICAgICAgICAgICRicm93c2VyLmRlZmVyLmNhbmNlbChhcHBseUFzeW5jSWQpO1xuXHQgICAgICAgICAgZmx1c2hBcHBseUFzeW5jKCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBsYXN0RGlydHlXYXRjaCA9IG51bGw7XG5cdFxuXHQgICAgICAgIGRvIHsgLy8gXCJ3aGlsZSBkaXJ0eVwiIGxvb3Bcblx0ICAgICAgICAgIGRpcnR5ID0gZmFsc2U7XG5cdCAgICAgICAgICBjdXJyZW50ID0gdGFyZ2V0O1xuXHRcblx0ICAgICAgICAgIHdoaWxlIChhc3luY1F1ZXVlLmxlbmd0aCkge1xuXHQgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgIGFzeW5jVGFzayA9IGFzeW5jUXVldWUuc2hpZnQoKTtcblx0ICAgICAgICAgICAgICBhc3luY1Rhc2suc2NvcGUuJGV2YWwoYXN5bmNUYXNrLmV4cHJlc3Npb24sIGFzeW5jVGFzay5sb2NhbHMpO1xuXHQgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgbGFzdERpcnR5V2F0Y2ggPSBudWxsO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIHRyYXZlcnNlU2NvcGVzTG9vcDpcblx0ICAgICAgICAgIGRvIHsgLy8gXCJ0cmF2ZXJzZSB0aGUgc2NvcGVzXCIgbG9vcFxuXHQgICAgICAgICAgICBpZiAoKHdhdGNoZXJzID0gY3VycmVudC4kJHdhdGNoZXJzKSkge1xuXHQgICAgICAgICAgICAgIC8vIHByb2Nlc3Mgb3VyIHdhdGNoZXNcblx0ICAgICAgICAgICAgICBsZW5ndGggPSB3YXRjaGVycy5sZW5ndGg7XG5cdCAgICAgICAgICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG5cdCAgICAgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgICAgICB3YXRjaCA9IHdhdGNoZXJzW2xlbmd0aF07XG5cdCAgICAgICAgICAgICAgICAgIC8vIE1vc3QgY29tbW9uIHdhdGNoZXMgYXJlIG9uIHByaW1pdGl2ZXMsIGluIHdoaWNoIGNhc2Ugd2UgY2FuIHNob3J0XG5cdCAgICAgICAgICAgICAgICAgIC8vIGNpcmN1aXQgaXQgd2l0aCA9PT0gb3BlcmF0b3IsIG9ubHkgd2hlbiA9PT0gZmFpbHMgZG8gd2UgdXNlIC5lcXVhbHNcblx0ICAgICAgICAgICAgICAgICAgaWYgKHdhdGNoKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgZ2V0ID0gd2F0Y2guZ2V0O1xuXHQgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgPSBnZXQoY3VycmVudCkpICE9PSAobGFzdCA9IHdhdGNoLmxhc3QpICYmXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICEod2F0Y2guZXFcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZXF1YWxzKHZhbHVlLCBsYXN0KVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgbGFzdCA9PT0gJ251bWJlcidcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGlzTmFOKHZhbHVlKSAmJiBpc05hTihsYXN0KSkpKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICBkaXJ0eSA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICAgICAgICBsYXN0RGlydHlXYXRjaCA9IHdhdGNoO1xuXHQgICAgICAgICAgICAgICAgICAgICAgd2F0Y2gubGFzdCA9IHdhdGNoLmVxID8gY29weSh2YWx1ZSwgbnVsbCkgOiB2YWx1ZTtcblx0ICAgICAgICAgICAgICAgICAgICAgIGZuID0gd2F0Y2guZm47XG5cdCAgICAgICAgICAgICAgICAgICAgICBmbih2YWx1ZSwgKChsYXN0ID09PSBpbml0V2F0Y2hWYWwpID8gdmFsdWUgOiBsYXN0KSwgY3VycmVudCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICBpZiAodHRsIDwgNSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBsb2dJZHggPSA0IC0gdHRsO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXdhdGNoTG9nW2xvZ0lkeF0pIHdhdGNoTG9nW2xvZ0lkeF0gPSBbXTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgd2F0Y2hMb2dbbG9nSWR4XS5wdXNoKHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICBtc2c6IGlzRnVuY3Rpb24od2F0Y2guZXhwKSA/ICdmbjogJyArICh3YXRjaC5leHAubmFtZSB8fCB3YXRjaC5leHAudG9TdHJpbmcoKSkgOiB3YXRjaC5leHAsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsOiB2YWx1ZSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRWYWw6IGxhc3Rcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh3YXRjaCA9PT0gbGFzdERpcnR5V2F0Y2gpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBtb3N0IHJlY2VudGx5IGRpcnR5IHdhdGNoZXIgaXMgbm93IGNsZWFuLCBzaG9ydCBjaXJjdWl0IHNpbmNlIHRoZSByZW1haW5pbmcgd2F0Y2hlcnNcblx0ICAgICAgICAgICAgICAgICAgICAgIC8vIGhhdmUgYWxyZWFkeSBiZWVuIHRlc3RlZC5cblx0ICAgICAgICAgICAgICAgICAgICAgIGRpcnR5ID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgICAgICAgICBicmVhayB0cmF2ZXJzZVNjb3Blc0xvb3A7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgICAgICAgICAgICRleGNlcHRpb25IYW5kbGVyKGUpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgLy8gSW5zYW5pdHkgV2FybmluZzogc2NvcGUgZGVwdGgtZmlyc3QgdHJhdmVyc2FsXG5cdCAgICAgICAgICAgIC8vIHllcywgdGhpcyBjb2RlIGlzIGEgYml0IGNyYXp5LCBidXQgaXQgd29ya3MgYW5kIHdlIGhhdmUgdGVzdHMgdG8gcHJvdmUgaXQhXG5cdCAgICAgICAgICAgIC8vIHRoaXMgcGllY2Ugc2hvdWxkIGJlIGtlcHQgaW4gc3luYyB3aXRoIHRoZSB0cmF2ZXJzYWwgaW4gJGJyb2FkY2FzdFxuXHQgICAgICAgICAgICBpZiAoIShuZXh0ID0gKChjdXJyZW50LiQkd2F0Y2hlcnNDb3VudCAmJiBjdXJyZW50LiQkY2hpbGRIZWFkKSB8fFxuXHQgICAgICAgICAgICAgICAgKGN1cnJlbnQgIT09IHRhcmdldCAmJiBjdXJyZW50LiQkbmV4dFNpYmxpbmcpKSkpIHtcblx0ICAgICAgICAgICAgICB3aGlsZSAoY3VycmVudCAhPT0gdGFyZ2V0ICYmICEobmV4dCA9IGN1cnJlbnQuJCRuZXh0U2libGluZykpIHtcblx0ICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50LiRwYXJlbnQ7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9IHdoaWxlICgoY3VycmVudCA9IG5leHQpKTtcblx0XG5cdCAgICAgICAgICAvLyBgYnJlYWsgdHJhdmVyc2VTY29wZXNMb29wO2AgdGFrZXMgdXMgdG8gaGVyZVxuXHRcblx0ICAgICAgICAgIGlmICgoZGlydHkgfHwgYXN5bmNRdWV1ZS5sZW5ndGgpICYmICEodHRsLS0pKSB7XG5cdCAgICAgICAgICAgIGNsZWFyUGhhc2UoKTtcblx0ICAgICAgICAgICAgdGhyb3cgJHJvb3RTY29wZU1pbkVycignaW5mZGlnJyxcblx0ICAgICAgICAgICAgICAgICd7MH0gJGRpZ2VzdCgpIGl0ZXJhdGlvbnMgcmVhY2hlZC4gQWJvcnRpbmchXFxuJyArXG5cdCAgICAgICAgICAgICAgICAnV2F0Y2hlcnMgZmlyZWQgaW4gdGhlIGxhc3QgNSBpdGVyYXRpb25zOiB7MX0nLFxuXHQgICAgICAgICAgICAgICAgVFRMLCB3YXRjaExvZyk7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgIH0gd2hpbGUgKGRpcnR5IHx8IGFzeW5jUXVldWUubGVuZ3RoKTtcblx0XG5cdCAgICAgICAgY2xlYXJQaGFzZSgpO1xuXHRcblx0ICAgICAgICB3aGlsZSAocG9zdERpZ2VzdFF1ZXVlLmxlbmd0aCkge1xuXHQgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgcG9zdERpZ2VzdFF1ZXVlLnNoaWZ0KCkoKTtcblx0ICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHRcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBAbmdkb2MgZXZlbnRcblx0ICAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkZGVzdHJveVxuXHQgICAgICAgKiBAZXZlbnRUeXBlIGJyb2FkY2FzdCBvbiBzY29wZSBiZWluZyBkZXN0cm95ZWRcblx0ICAgICAgICpcblx0ICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAqIEJyb2FkY2FzdGVkIHdoZW4gYSBzY29wZSBhbmQgaXRzIGNoaWxkcmVuIGFyZSBiZWluZyBkZXN0cm95ZWQuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIE5vdGUgdGhhdCwgaW4gQW5ndWxhckpTLCB0aGVyZSBpcyBhbHNvIGEgYCRkZXN0cm95YCBqUXVlcnkgZXZlbnQsIHdoaWNoIGNhbiBiZSB1c2VkIHRvXG5cdCAgICAgICAqIGNsZWFuIHVwIERPTSBiaW5kaW5ncyBiZWZvcmUgYW4gZWxlbWVudCBpcyByZW1vdmVkIGZyb20gdGhlIERPTS5cblx0ICAgICAgICovXG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRkZXN0cm95XG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBSZW1vdmVzIHRoZSBjdXJyZW50IHNjb3BlIChhbmQgYWxsIG9mIGl0cyBjaGlsZHJlbikgZnJvbSB0aGUgcGFyZW50IHNjb3BlLiBSZW1vdmFsIGltcGxpZXNcblx0ICAgICAgICogdGhhdCBjYWxscyB0byB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0ICRkaWdlc3QoKX0gd2lsbCBubyBsb25nZXJcblx0ICAgICAgICogcHJvcGFnYXRlIHRvIHRoZSBjdXJyZW50IHNjb3BlIGFuZCBpdHMgY2hpbGRyZW4uIFJlbW92YWwgYWxzbyBpbXBsaWVzIHRoYXQgdGhlIGN1cnJlbnRcblx0ICAgICAgICogc2NvcGUgaXMgZWxpZ2libGUgZm9yIGdhcmJhZ2UgY29sbGVjdGlvbi5cblx0ICAgICAgICpcblx0ICAgICAgICogVGhlIGAkZGVzdHJveSgpYCBpcyB1c3VhbGx5IHVzZWQgYnkgZGlyZWN0aXZlcyBzdWNoIGFzXG5cdCAgICAgICAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdSZXBlYXQgbmdSZXBlYXR9IGZvciBtYW5hZ2luZyB0aGVcblx0ICAgICAgICogdW5yb2xsaW5nIG9mIHRoZSBsb29wLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBKdXN0IGJlZm9yZSBhIHNjb3BlIGlzIGRlc3Ryb3llZCwgYSBgJGRlc3Ryb3lgIGV2ZW50IGlzIGJyb2FkY2FzdGVkIG9uIHRoaXMgc2NvcGUuXG5cdCAgICAgICAqIEFwcGxpY2F0aW9uIGNvZGUgY2FuIHJlZ2lzdGVyIGEgYCRkZXN0cm95YCBldmVudCBoYW5kbGVyIHRoYXQgd2lsbCBnaXZlIGl0IGEgY2hhbmNlIHRvXG5cdCAgICAgICAqIHBlcmZvcm0gYW55IG5lY2Vzc2FyeSBjbGVhbnVwLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBOb3RlIHRoYXQsIGluIEFuZ3VsYXJKUywgdGhlcmUgaXMgYWxzbyBhIGAkZGVzdHJveWAgalF1ZXJ5IGV2ZW50LCB3aGljaCBjYW4gYmUgdXNlZCB0b1xuXHQgICAgICAgKiBjbGVhbiB1cCBET00gYmluZGluZ3MgYmVmb3JlIGFuIGVsZW1lbnQgaXMgcmVtb3ZlZCBmcm9tIHRoZSBET00uXG5cdCAgICAgICAqL1xuXHQgICAgICAkZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgLy8gV2UgY2FuJ3QgZGVzdHJveSBhIHNjb3BlIHRoYXQgaGFzIGJlZW4gYWxyZWFkeSBkZXN0cm95ZWQuXG5cdCAgICAgICAgaWYgKHRoaXMuJCRkZXN0cm95ZWQpIHJldHVybjtcblx0ICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy4kcGFyZW50O1xuXHRcblx0ICAgICAgICB0aGlzLiRicm9hZGNhc3QoJyRkZXN0cm95Jyk7XG5cdCAgICAgICAgdGhpcy4kJGRlc3Ryb3llZCA9IHRydWU7XG5cdFxuXHQgICAgICAgIGlmICh0aGlzID09PSAkcm9vdFNjb3BlKSB7XG5cdCAgICAgICAgICAvL1JlbW92ZSBoYW5kbGVycyBhdHRhY2hlZCB0byB3aW5kb3cgd2hlbiAkcm9vdFNjb3BlIGlzIHJlbW92ZWRcblx0ICAgICAgICAgICRicm93c2VyLiQkYXBwbGljYXRpb25EZXN0cm95ZWQoKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGluY3JlbWVudFdhdGNoZXJzQ291bnQodGhpcywgLXRoaXMuJCR3YXRjaGVyc0NvdW50KTtcblx0ICAgICAgICBmb3IgKHZhciBldmVudE5hbWUgaW4gdGhpcy4kJGxpc3RlbmVyQ291bnQpIHtcblx0ICAgICAgICAgIGRlY3JlbWVudExpc3RlbmVyQ291bnQodGhpcywgdGhpcy4kJGxpc3RlbmVyQ291bnRbZXZlbnROYW1lXSwgZXZlbnROYW1lKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8vIHNldmVyIGFsbCB0aGUgcmVmZXJlbmNlcyB0byBwYXJlbnQgc2NvcGVzIChhZnRlciB0aGlzIGNsZWFudXAsIHRoZSBjdXJyZW50IHNjb3BlIHNob3VsZFxuXHQgICAgICAgIC8vIG5vdCBiZSByZXRhaW5lZCBieSBhbnkgb2Ygb3VyIHJlZmVyZW5jZXMgYW5kIHNob3VsZCBiZSBlbGlnaWJsZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uKVxuXHQgICAgICAgIGlmIChwYXJlbnQgJiYgcGFyZW50LiQkY2hpbGRIZWFkID09IHRoaXMpIHBhcmVudC4kJGNoaWxkSGVhZCA9IHRoaXMuJCRuZXh0U2libGluZztcblx0ICAgICAgICBpZiAocGFyZW50ICYmIHBhcmVudC4kJGNoaWxkVGFpbCA9PSB0aGlzKSBwYXJlbnQuJCRjaGlsZFRhaWwgPSB0aGlzLiQkcHJldlNpYmxpbmc7XG5cdCAgICAgICAgaWYgKHRoaXMuJCRwcmV2U2libGluZykgdGhpcy4kJHByZXZTaWJsaW5nLiQkbmV4dFNpYmxpbmcgPSB0aGlzLiQkbmV4dFNpYmxpbmc7XG5cdCAgICAgICAgaWYgKHRoaXMuJCRuZXh0U2libGluZykgdGhpcy4kJG5leHRTaWJsaW5nLiQkcHJldlNpYmxpbmcgPSB0aGlzLiQkcHJldlNpYmxpbmc7XG5cdFxuXHQgICAgICAgIC8vIERpc2FibGUgbGlzdGVuZXJzLCB3YXRjaGVycyBhbmQgYXBwbHkvZGlnZXN0IG1ldGhvZHNcblx0ICAgICAgICB0aGlzLiRkZXN0cm95ID0gdGhpcy4kZGlnZXN0ID0gdGhpcy4kYXBwbHkgPSB0aGlzLiRldmFsQXN5bmMgPSB0aGlzLiRhcHBseUFzeW5jID0gbm9vcDtcblx0ICAgICAgICB0aGlzLiRvbiA9IHRoaXMuJHdhdGNoID0gdGhpcy4kd2F0Y2hHcm91cCA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gbm9vcDsgfTtcblx0ICAgICAgICB0aGlzLiQkbGlzdGVuZXJzID0ge307XG5cdFxuXHQgICAgICAgIC8vIERpc2Nvbm5lY3QgdGhlIG5leHQgc2libGluZyB0byBwcmV2ZW50IGBjbGVhblVwU2NvcGVgIGRlc3Ryb3lpbmcgdGhvc2UgdG9vXG5cdCAgICAgICAgdGhpcy4kJG5leHRTaWJsaW5nID0gbnVsbDtcblx0ICAgICAgICBjbGVhblVwU2NvcGUodGhpcyk7XG5cdCAgICAgIH0sXG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRldmFsXG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBFeGVjdXRlcyB0aGUgYGV4cHJlc3Npb25gIG9uIHRoZSBjdXJyZW50IHNjb3BlIGFuZCByZXR1cm5zIHRoZSByZXN1bHQuIEFueSBleGNlcHRpb25zIGluXG5cdCAgICAgICAqIHRoZSBleHByZXNzaW9uIGFyZSBwcm9wYWdhdGVkICh1bmNhdWdodCkuIFRoaXMgaXMgdXNlZnVsIHdoZW4gZXZhbHVhdGluZyBBbmd1bGFyXG5cdCAgICAgICAqIGV4cHJlc3Npb25zLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiAjIEV4YW1wbGVcblx0ICAgICAgICogYGBganNcblx0ICAgICAgICAgICB2YXIgc2NvcGUgPSBuZy4kcm9vdFNjb3BlLlNjb3BlKCk7XG5cdCAgICAgICAgICAgc2NvcGUuYSA9IDE7XG5cdCAgICAgICAgICAgc2NvcGUuYiA9IDI7XG5cdFxuXHQgICAgICAgICAgIGV4cGVjdChzY29wZS4kZXZhbCgnYStiJykpLnRvRXF1YWwoMyk7XG5cdCAgICAgICAgICAgZXhwZWN0KHNjb3BlLiRldmFsKGZ1bmN0aW9uKHNjb3BlKXsgcmV0dXJuIHNjb3BlLmEgKyBzY29wZS5iOyB9KSkudG9FcXVhbCgzKTtcblx0ICAgICAgICogYGBgXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7KHN0cmluZ3xmdW5jdGlvbigpKT19IGV4cHJlc3Npb24gQW4gYW5ndWxhciBleHByZXNzaW9uIHRvIGJlIGV4ZWN1dGVkLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiAgICAtIGBzdHJpbmdgOiBleGVjdXRlIHVzaW5nIHRoZSBydWxlcyBhcyBkZWZpbmVkIGluICB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufS5cblx0ICAgICAgICogICAgLSBgZnVuY3Rpb24oc2NvcGUpYDogZXhlY3V0ZSB0aGUgZnVuY3Rpb24gd2l0aCB0aGUgY3VycmVudCBgc2NvcGVgIHBhcmFtZXRlci5cblx0ICAgICAgICpcblx0ICAgICAgICogQHBhcmFtIHsob2JqZWN0KT19IGxvY2FscyBMb2NhbCB2YXJpYWJsZXMgb2JqZWN0LCB1c2VmdWwgZm9yIG92ZXJyaWRpbmcgdmFsdWVzIGluIHNjb3BlLlxuXHQgICAgICAgKiBAcmV0dXJucyB7Kn0gVGhlIHJlc3VsdCBvZiBldmFsdWF0aW5nIHRoZSBleHByZXNzaW9uLlxuXHQgICAgICAgKi9cblx0ICAgICAgJGV2YWw6IGZ1bmN0aW9uKGV4cHIsIGxvY2Fscykge1xuXHQgICAgICAgIHJldHVybiAkcGFyc2UoZXhwcikodGhpcywgbG9jYWxzKTtcblx0ICAgICAgfSxcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAqIEBuYW1lICRyb290U2NvcGUuU2NvcGUjJGV2YWxBc3luY1xuXHQgICAgICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICogRXhlY3V0ZXMgdGhlIGV4cHJlc3Npb24gb24gdGhlIGN1cnJlbnQgc2NvcGUgYXQgYSBsYXRlciBwb2ludCBpbiB0aW1lLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBUaGUgYCRldmFsQXN5bmNgIG1ha2VzIG5vIGd1YXJhbnRlZXMgYXMgdG8gd2hlbiB0aGUgYGV4cHJlc3Npb25gIHdpbGwgYmUgZXhlY3V0ZWQsIG9ubHlcblx0ICAgICAgICogdGhhdDpcblx0ICAgICAgICpcblx0ICAgICAgICogICAtIGl0IHdpbGwgZXhlY3V0ZSBhZnRlciB0aGUgZnVuY3Rpb24gdGhhdCBzY2hlZHVsZWQgdGhlIGV2YWx1YXRpb24gKHByZWZlcmFibHkgYmVmb3JlIERPTVxuXHQgICAgICAgKiAgICAgcmVuZGVyaW5nKS5cblx0ICAgICAgICogICAtIGF0IGxlYXN0IG9uZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0ICRkaWdlc3QgY3ljbGV9IHdpbGwgYmUgcGVyZm9ybWVkIGFmdGVyXG5cdCAgICAgICAqICAgICBgZXhwcmVzc2lvbmAgZXhlY3V0aW9uLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBBbnkgZXhjZXB0aW9ucyBmcm9tIHRoZSBleGVjdXRpb24gb2YgdGhlIGV4cHJlc3Npb24gYXJlIGZvcndhcmRlZCB0byB0aGVcblx0ICAgICAgICoge0BsaW5rIG5nLiRleGNlcHRpb25IYW5kbGVyICRleGNlcHRpb25IYW5kbGVyfSBzZXJ2aWNlLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBfX05vdGU6X18gaWYgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgb3V0c2lkZSBvZiBhIGAkZGlnZXN0YCBjeWNsZSwgYSBuZXcgYCRkaWdlc3RgIGN5Y2xlXG5cdCAgICAgICAqIHdpbGwgYmUgc2NoZWR1bGVkLiBIb3dldmVyLCBpdCBpcyBlbmNvdXJhZ2VkIHRvIGFsd2F5cyBjYWxsIGNvZGUgdGhhdCBjaGFuZ2VzIHRoZSBtb2RlbFxuXHQgICAgICAgKiBmcm9tIHdpdGhpbiBhbiBgJGFwcGx5YCBjYWxsLiBUaGF0IGluY2x1ZGVzIGNvZGUgZXZhbHVhdGVkIHZpYSBgJGV2YWxBc3luY2AuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7KHN0cmluZ3xmdW5jdGlvbigpKT19IGV4cHJlc3Npb24gQW4gYW5ndWxhciBleHByZXNzaW9uIHRvIGJlIGV4ZWN1dGVkLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiAgICAtIGBzdHJpbmdgOiBleGVjdXRlIHVzaW5nIHRoZSBydWxlcyBhcyBkZWZpbmVkIGluIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259LlxuXHQgICAgICAgKiAgICAtIGBmdW5jdGlvbihzY29wZSlgOiBleGVjdXRlIHRoZSBmdW5jdGlvbiB3aXRoIHRoZSBjdXJyZW50IGBzY29wZWAgcGFyYW1ldGVyLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAcGFyYW0geyhvYmplY3QpPX0gbG9jYWxzIExvY2FsIHZhcmlhYmxlcyBvYmplY3QsIHVzZWZ1bCBmb3Igb3ZlcnJpZGluZyB2YWx1ZXMgaW4gc2NvcGUuXG5cdCAgICAgICAqL1xuXHQgICAgICAkZXZhbEFzeW5jOiBmdW5jdGlvbihleHByLCBsb2NhbHMpIHtcblx0ICAgICAgICAvLyBpZiB3ZSBhcmUgb3V0c2lkZSBvZiBhbiAkZGlnZXN0IGxvb3AgYW5kIHRoaXMgaXMgdGhlIGZpcnN0IHRpbWUgd2UgYXJlIHNjaGVkdWxpbmcgYXN5bmNcblx0ICAgICAgICAvLyB0YXNrIGFsc28gc2NoZWR1bGUgYXN5bmMgYXV0by1mbHVzaFxuXHQgICAgICAgIGlmICghJHJvb3RTY29wZS4kJHBoYXNlICYmICFhc3luY1F1ZXVlLmxlbmd0aCkge1xuXHQgICAgICAgICAgJGJyb3dzZXIuZGVmZXIoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGlmIChhc3luY1F1ZXVlLmxlbmd0aCkge1xuXHQgICAgICAgICAgICAgICRyb290U2NvcGUuJGRpZ2VzdCgpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGFzeW5jUXVldWUucHVzaCh7c2NvcGU6IHRoaXMsIGV4cHJlc3Npb246ICRwYXJzZShleHByKSwgbG9jYWxzOiBsb2NhbHN9KTtcblx0ICAgICAgfSxcblx0XG5cdCAgICAgICQkcG9zdERpZ2VzdDogZnVuY3Rpb24oZm4pIHtcblx0ICAgICAgICBwb3N0RGlnZXN0UXVldWUucHVzaChmbik7XG5cdCAgICAgIH0sXG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRhcHBseVxuXHQgICAgICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICogYCRhcHBseSgpYCBpcyB1c2VkIHRvIGV4ZWN1dGUgYW4gZXhwcmVzc2lvbiBpbiBhbmd1bGFyIGZyb20gb3V0c2lkZSBvZiB0aGUgYW5ndWxhclxuXHQgICAgICAgKiBmcmFtZXdvcmsuIChGb3IgZXhhbXBsZSBmcm9tIGJyb3dzZXIgRE9NIGV2ZW50cywgc2V0VGltZW91dCwgWEhSIG9yIHRoaXJkIHBhcnR5IGxpYnJhcmllcykuXG5cdCAgICAgICAqIEJlY2F1c2Ugd2UgYXJlIGNhbGxpbmcgaW50byB0aGUgYW5ndWxhciBmcmFtZXdvcmsgd2UgbmVlZCB0byBwZXJmb3JtIHByb3BlciBzY29wZSBsaWZlXG5cdCAgICAgICAqIGN5Y2xlIG9mIHtAbGluayBuZy4kZXhjZXB0aW9uSGFuZGxlciBleGNlcHRpb24gaGFuZGxpbmd9LFxuXHQgICAgICAgKiB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0IGV4ZWN1dGluZyB3YXRjaGVzfS5cblx0ICAgICAgICpcblx0ICAgICAgICogIyMgTGlmZSBjeWNsZVxuXHQgICAgICAgKlxuXHQgICAgICAgKiAjIFBzZXVkby1Db2RlIG9mIGAkYXBwbHkoKWBcblx0ICAgICAgICogYGBganNcblx0ICAgICAgICAgICBmdW5jdGlvbiAkYXBwbHkoZXhwcikge1xuXHQgICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgcmV0dXJuICRldmFsKGV4cHIpO1xuXHQgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgICAgICAkZXhjZXB0aW9uSGFuZGxlcihlKTtcblx0ICAgICAgICAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgICAgICAgICRyb290LiRkaWdlc3QoKTtcblx0ICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICB9XG5cdCAgICAgICAqIGBgYFxuXHQgICAgICAgKlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBTY29wZSdzIGAkYXBwbHkoKWAgbWV0aG9kIHRyYW5zaXRpb25zIHRocm91Z2ggdGhlIGZvbGxvd2luZyBzdGFnZXM6XG5cdCAgICAgICAqXG5cdCAgICAgICAqIDEuIFRoZSB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufSBpcyBleGVjdXRlZCB1c2luZyB0aGVcblx0ICAgICAgICogICAge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGV2YWwgJGV2YWwoKX0gbWV0aG9kLlxuXHQgICAgICAgKiAyLiBBbnkgZXhjZXB0aW9ucyBmcm9tIHRoZSBleGVjdXRpb24gb2YgdGhlIGV4cHJlc3Npb24gYXJlIGZvcndhcmRlZCB0byB0aGVcblx0ICAgICAgICogICAge0BsaW5rIG5nLiRleGNlcHRpb25IYW5kbGVyICRleGNlcHRpb25IYW5kbGVyfSBzZXJ2aWNlLlxuXHQgICAgICAgKiAzLiBUaGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJHdhdGNoIHdhdGNofSBsaXN0ZW5lcnMgYXJlIGZpcmVkIGltbWVkaWF0ZWx5IGFmdGVyIHRoZVxuXHQgICAgICAgKiAgICBleHByZXNzaW9uIHdhcyBleGVjdXRlZCB1c2luZyB0aGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGRpZ2VzdCAkZGlnZXN0KCl9IG1ldGhvZC5cblx0ICAgICAgICpcblx0ICAgICAgICpcblx0ICAgICAgICogQHBhcmFtIHsoc3RyaW5nfGZ1bmN0aW9uKCkpPX0gZXhwIEFuIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZC5cblx0ICAgICAgICpcblx0ICAgICAgICogICAgLSBgc3RyaW5nYDogZXhlY3V0ZSB1c2luZyB0aGUgcnVsZXMgYXMgZGVmaW5lZCBpbiB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufS5cblx0ICAgICAgICogICAgLSBgZnVuY3Rpb24oc2NvcGUpYDogZXhlY3V0ZSB0aGUgZnVuY3Rpb24gd2l0aCBjdXJyZW50IGBzY29wZWAgcGFyYW1ldGVyLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAcmV0dXJucyB7Kn0gVGhlIHJlc3VsdCBvZiBldmFsdWF0aW5nIHRoZSBleHByZXNzaW9uLlxuXHQgICAgICAgKi9cblx0ICAgICAgJGFwcGx5OiBmdW5jdGlvbihleHByKSB7XG5cdCAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgIGJlZ2luUGhhc2UoJyRhcHBseScpO1xuXHQgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGV2YWwoZXhwcik7XG5cdCAgICAgICAgICB9IGZpbmFsbHkge1xuXHQgICAgICAgICAgICBjbGVhclBoYXNlKCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG5cdCAgICAgICAgfSBmaW5hbGx5IHtcblx0ICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgICRyb290U2NvcGUuJGRpZ2VzdCgpO1xuXHQgICAgICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgICAkZXhjZXB0aW9uSGFuZGxlcihlKTtcblx0ICAgICAgICAgICAgdGhyb3cgZTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRhcHBseUFzeW5jXG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBTY2hlZHVsZSB0aGUgaW52b2NhdGlvbiBvZiAkYXBwbHkgdG8gb2NjdXIgYXQgYSBsYXRlciB0aW1lLiBUaGUgYWN0dWFsIHRpbWUgZGlmZmVyZW5jZVxuXHQgICAgICAgKiB2YXJpZXMgYWNyb3NzIGJyb3dzZXJzLCBidXQgaXMgdHlwaWNhbGx5IGFyb3VuZCB+MTAgbWlsbGlzZWNvbmRzLlxuXHQgICAgICAgKlxuXHQgICAgICAgKiBUaGlzIGNhbiBiZSB1c2VkIHRvIHF1ZXVlIHVwIG11bHRpcGxlIGV4cHJlc3Npb25zIHdoaWNoIG5lZWQgdG8gYmUgZXZhbHVhdGVkIGluIHRoZSBzYW1lXG5cdCAgICAgICAqIGRpZ2VzdC5cblx0ICAgICAgICpcblx0ICAgICAgICogQHBhcmFtIHsoc3RyaW5nfGZ1bmN0aW9uKCkpPX0gZXhwIEFuIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZC5cblx0ICAgICAgICpcblx0ICAgICAgICogICAgLSBgc3RyaW5nYDogZXhlY3V0ZSB1c2luZyB0aGUgcnVsZXMgYXMgZGVmaW5lZCBpbiB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufS5cblx0ICAgICAgICogICAgLSBgZnVuY3Rpb24oc2NvcGUpYDogZXhlY3V0ZSB0aGUgZnVuY3Rpb24gd2l0aCBjdXJyZW50IGBzY29wZWAgcGFyYW1ldGVyLlxuXHQgICAgICAgKi9cblx0ICAgICAgJGFwcGx5QXN5bmM6IGZ1bmN0aW9uKGV4cHIpIHtcblx0ICAgICAgICB2YXIgc2NvcGUgPSB0aGlzO1xuXHQgICAgICAgIGV4cHIgJiYgYXBwbHlBc3luY1F1ZXVlLnB1c2goJGFwcGx5QXN5bmNFeHByZXNzaW9uKTtcblx0ICAgICAgICBleHByID0gJHBhcnNlKGV4cHIpO1xuXHQgICAgICAgIHNjaGVkdWxlQXBwbHlBc3luYygpO1xuXHRcblx0ICAgICAgICBmdW5jdGlvbiAkYXBwbHlBc3luY0V4cHJlc3Npb24oKSB7XG5cdCAgICAgICAgICBzY29wZS4kZXZhbChleHByKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRvblxuXHQgICAgICAgKiBAa2luZCBmdW5jdGlvblxuXHQgICAgICAgKlxuXHQgICAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAgICogTGlzdGVucyBvbiBldmVudHMgb2YgYSBnaXZlbiB0eXBlLiBTZWUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGVtaXQgJGVtaXR9IGZvclxuXHQgICAgICAgKiBkaXNjdXNzaW9uIG9mIGV2ZW50IGxpZmUgY3ljbGUuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIFRoZSBldmVudCBsaXN0ZW5lciBmdW5jdGlvbiBmb3JtYXQgaXM6IGBmdW5jdGlvbihldmVudCwgYXJncy4uLilgLiBUaGUgYGV2ZW50YCBvYmplY3Rcblx0ICAgICAgICogcGFzc2VkIGludG8gdGhlIGxpc3RlbmVyIGhhcyB0aGUgZm9sbG93aW5nIGF0dHJpYnV0ZXM6XG5cdCAgICAgICAqXG5cdCAgICAgICAqICAgLSBgdGFyZ2V0U2NvcGVgIC0gYHtTY29wZX1gOiB0aGUgc2NvcGUgb24gd2hpY2ggdGhlIGV2ZW50IHdhcyBgJGVtaXRgLWVkIG9yXG5cdCAgICAgICAqICAgICBgJGJyb2FkY2FzdGAtZWQuXG5cdCAgICAgICAqICAgLSBgY3VycmVudFNjb3BlYCAtIGB7U2NvcGV9YDogdGhlIHNjb3BlIHRoYXQgaXMgY3VycmVudGx5IGhhbmRsaW5nIHRoZSBldmVudC4gT25jZSB0aGVcblx0ICAgICAgICogICAgIGV2ZW50IHByb3BhZ2F0ZXMgdGhyb3VnaCB0aGUgc2NvcGUgaGllcmFyY2h5LCB0aGlzIHByb3BlcnR5IGlzIHNldCB0byBudWxsLlxuXHQgICAgICAgKiAgIC0gYG5hbWVgIC0gYHtzdHJpbmd9YDogbmFtZSBvZiB0aGUgZXZlbnQuXG5cdCAgICAgICAqICAgLSBgc3RvcFByb3BhZ2F0aW9uYCAtIGB7ZnVuY3Rpb249fWA6IGNhbGxpbmcgYHN0b3BQcm9wYWdhdGlvbmAgZnVuY3Rpb24gd2lsbCBjYW5jZWxcblx0ICAgICAgICogICAgIGZ1cnRoZXIgZXZlbnQgcHJvcGFnYXRpb24gKGF2YWlsYWJsZSBvbmx5IGZvciBldmVudHMgdGhhdCB3ZXJlIGAkZW1pdGAtZWQpLlxuXHQgICAgICAgKiAgIC0gYHByZXZlbnREZWZhdWx0YCAtIGB7ZnVuY3Rpb259YDogY2FsbGluZyBgcHJldmVudERlZmF1bHRgIHNldHMgYGRlZmF1bHRQcmV2ZW50ZWRgIGZsYWdcblx0ICAgICAgICogICAgIHRvIHRydWUuXG5cdCAgICAgICAqICAgLSBgZGVmYXVsdFByZXZlbnRlZGAgLSBge2Jvb2xlYW59YDogdHJ1ZSBpZiBgcHJldmVudERlZmF1bHRgIHdhcyBjYWxsZWQuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIEV2ZW50IG5hbWUgdG8gbGlzdGVuIG9uLlxuXHQgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50LCAuLi5hcmdzKX0gbGlzdGVuZXIgRnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZSBldmVudCBpcyBlbWl0dGVkLlxuXHQgICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb24oKX0gUmV0dXJucyBhIGRlcmVnaXN0cmF0aW9uIGZ1bmN0aW9uIGZvciB0aGlzIGxpc3RlbmVyLlxuXHQgICAgICAgKi9cblx0ICAgICAgJG9uOiBmdW5jdGlvbihuYW1lLCBsaXN0ZW5lcikge1xuXHQgICAgICAgIHZhciBuYW1lZExpc3RlbmVycyA9IHRoaXMuJCRsaXN0ZW5lcnNbbmFtZV07XG5cdCAgICAgICAgaWYgKCFuYW1lZExpc3RlbmVycykge1xuXHQgICAgICAgICAgdGhpcy4kJGxpc3RlbmVyc1tuYW1lXSA9IG5hbWVkTGlzdGVuZXJzID0gW107XG5cdCAgICAgICAgfVxuXHQgICAgICAgIG5hbWVkTGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpO1xuXHRcblx0ICAgICAgICB2YXIgY3VycmVudCA9IHRoaXM7XG5cdCAgICAgICAgZG8ge1xuXHQgICAgICAgICAgaWYgKCFjdXJyZW50LiQkbGlzdGVuZXJDb3VudFtuYW1lXSkge1xuXHQgICAgICAgICAgICBjdXJyZW50LiQkbGlzdGVuZXJDb3VudFtuYW1lXSA9IDA7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBjdXJyZW50LiQkbGlzdGVuZXJDb3VudFtuYW1lXSsrO1xuXHQgICAgICAgIH0gd2hpbGUgKChjdXJyZW50ID0gY3VycmVudC4kcGFyZW50KSk7XG5cdFxuXHQgICAgICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICB2YXIgaW5kZXhPZkxpc3RlbmVyID0gbmFtZWRMaXN0ZW5lcnMuaW5kZXhPZihsaXN0ZW5lcik7XG5cdCAgICAgICAgICBpZiAoaW5kZXhPZkxpc3RlbmVyICE9PSAtMSkge1xuXHQgICAgICAgICAgICBuYW1lZExpc3RlbmVyc1tpbmRleE9mTGlzdGVuZXJdID0gbnVsbDtcblx0ICAgICAgICAgICAgZGVjcmVtZW50TGlzdGVuZXJDb3VudChzZWxmLCAxLCBuYW1lKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9O1xuXHQgICAgICB9LFxuXHRcblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgICAqIEBuYW1lICRyb290U2NvcGUuU2NvcGUjJGVtaXRcblx0ICAgICAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgICAgICpcblx0ICAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICAqIERpc3BhdGNoZXMgYW4gZXZlbnQgYG5hbWVgIHVwd2FyZHMgdGhyb3VnaCB0aGUgc2NvcGUgaGllcmFyY2h5IG5vdGlmeWluZyB0aGVcblx0ICAgICAgICogcmVnaXN0ZXJlZCB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkb259IGxpc3RlbmVycy5cblx0ICAgICAgICpcblx0ICAgICAgICogVGhlIGV2ZW50IGxpZmUgY3ljbGUgc3RhcnRzIGF0IHRoZSBzY29wZSBvbiB3aGljaCBgJGVtaXRgIHdhcyBjYWxsZWQuIEFsbFxuXHQgICAgICAgKiB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkb24gbGlzdGVuZXJzfSBsaXN0ZW5pbmcgZm9yIGBuYW1lYCBldmVudCBvbiB0aGlzIHNjb3BlIGdldFxuXHQgICAgICAgKiBub3RpZmllZC4gQWZ0ZXJ3YXJkcywgdGhlIGV2ZW50IHRyYXZlcnNlcyB1cHdhcmRzIHRvd2FyZCB0aGUgcm9vdCBzY29wZSBhbmQgY2FsbHMgYWxsXG5cdCAgICAgICAqIHJlZ2lzdGVyZWQgbGlzdGVuZXJzIGFsb25nIHRoZSB3YXkuIFRoZSBldmVudCB3aWxsIHN0b3AgcHJvcGFnYXRpbmcgaWYgb25lIG9mIHRoZSBsaXN0ZW5lcnNcblx0ICAgICAgICogY2FuY2VscyBpdC5cblx0ICAgICAgICpcblx0ICAgICAgICogQW55IGV4Y2VwdGlvbiBlbWl0dGVkIGZyb20gdGhlIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRvbiBsaXN0ZW5lcnN9IHdpbGwgYmUgcGFzc2VkXG5cdCAgICAgICAqIG9udG8gdGhlIHtAbGluayBuZy4kZXhjZXB0aW9uSGFuZGxlciAkZXhjZXB0aW9uSGFuZGxlcn0gc2VydmljZS5cblx0ICAgICAgICpcblx0ICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgRXZlbnQgbmFtZSB0byBlbWl0LlxuXHQgICAgICAgKiBAcGFyYW0gey4uLip9IGFyZ3MgT3B0aW9uYWwgb25lIG9yIG1vcmUgYXJndW1lbnRzIHdoaWNoIHdpbGwgYmUgcGFzc2VkIG9udG8gdGhlIGV2ZW50IGxpc3RlbmVycy5cblx0ICAgICAgICogQHJldHVybiB7T2JqZWN0fSBFdmVudCBvYmplY3QgKHNlZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkb259KS5cblx0ICAgICAgICovXG5cdCAgICAgICRlbWl0OiBmdW5jdGlvbihuYW1lLCBhcmdzKSB7XG5cdCAgICAgICAgdmFyIGVtcHR5ID0gW10sXG5cdCAgICAgICAgICAgIG5hbWVkTGlzdGVuZXJzLFxuXHQgICAgICAgICAgICBzY29wZSA9IHRoaXMsXG5cdCAgICAgICAgICAgIHN0b3BQcm9wYWdhdGlvbiA9IGZhbHNlLFxuXHQgICAgICAgICAgICBldmVudCA9IHtcblx0ICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuXHQgICAgICAgICAgICAgIHRhcmdldFNjb3BlOiBzY29wZSxcblx0ICAgICAgICAgICAgICBzdG9wUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkge3N0b3BQcm9wYWdhdGlvbiA9IHRydWU7fSxcblx0ICAgICAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgICAgICBldmVudC5kZWZhdWx0UHJldmVudGVkID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICAgIGRlZmF1bHRQcmV2ZW50ZWQ6IGZhbHNlXG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIGxpc3RlbmVyQXJncyA9IGNvbmNhdChbZXZlbnRdLCBhcmd1bWVudHMsIDEpLFxuXHQgICAgICAgICAgICBpLCBsZW5ndGg7XG5cdFxuXHQgICAgICAgIGRvIHtcblx0ICAgICAgICAgIG5hbWVkTGlzdGVuZXJzID0gc2NvcGUuJCRsaXN0ZW5lcnNbbmFtZV0gfHwgZW1wdHk7XG5cdCAgICAgICAgICBldmVudC5jdXJyZW50U2NvcGUgPSBzY29wZTtcblx0ICAgICAgICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IG5hbWVkTGlzdGVuZXJzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG5cdFxuXHQgICAgICAgICAgICAvLyBpZiBsaXN0ZW5lcnMgd2VyZSBkZXJlZ2lzdGVyZWQsIGRlZnJhZ21lbnQgdGhlIGFycmF5XG5cdCAgICAgICAgICAgIGlmICghbmFtZWRMaXN0ZW5lcnNbaV0pIHtcblx0ICAgICAgICAgICAgICBuYW1lZExpc3RlbmVycy5zcGxpY2UoaSwgMSk7XG5cdCAgICAgICAgICAgICAgaS0tO1xuXHQgICAgICAgICAgICAgIGxlbmd0aC0tO1xuXHQgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgICAgLy9hbGxvdyBhbGwgbGlzdGVuZXJzIGF0dGFjaGVkIHRvIHRoZSBjdXJyZW50IHNjb3BlIHRvIHJ1blxuXHQgICAgICAgICAgICAgIG5hbWVkTGlzdGVuZXJzW2ldLmFwcGx5KG51bGwsIGxpc3RlbmVyQXJncyk7XG5cdCAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICAgICAgICAkZXhjZXB0aW9uSGFuZGxlcihlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgLy9pZiBhbnkgbGlzdGVuZXIgb24gdGhlIGN1cnJlbnQgc2NvcGUgc3RvcHMgcHJvcGFnYXRpb24sIHByZXZlbnQgYnViYmxpbmdcblx0ICAgICAgICAgIGlmIChzdG9wUHJvcGFnYXRpb24pIHtcblx0ICAgICAgICAgICAgZXZlbnQuY3VycmVudFNjb3BlID0gbnVsbDtcblx0ICAgICAgICAgICAgcmV0dXJuIGV2ZW50O1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgLy90cmF2ZXJzZSB1cHdhcmRzXG5cdCAgICAgICAgICBzY29wZSA9IHNjb3BlLiRwYXJlbnQ7XG5cdCAgICAgICAgfSB3aGlsZSAoc2NvcGUpO1xuXHRcblx0ICAgICAgICBldmVudC5jdXJyZW50U2NvcGUgPSBudWxsO1xuXHRcblx0ICAgICAgICByZXR1cm4gZXZlbnQ7XG5cdCAgICAgIH0sXG5cdFxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkYnJvYWRjYXN0XG5cdCAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICAgICAqXG5cdCAgICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICAgKiBEaXNwYXRjaGVzIGFuIGV2ZW50IGBuYW1lYCBkb3dud2FyZHMgdG8gYWxsIGNoaWxkIHNjb3BlcyAoYW5kIHRoZWlyIGNoaWxkcmVuKSBub3RpZnlpbmcgdGhlXG5cdCAgICAgICAqIHJlZ2lzdGVyZWQge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJG9ufSBsaXN0ZW5lcnMuXG5cdCAgICAgICAqXG5cdCAgICAgICAqIFRoZSBldmVudCBsaWZlIGN5Y2xlIHN0YXJ0cyBhdCB0aGUgc2NvcGUgb24gd2hpY2ggYCRicm9hZGNhc3RgIHdhcyBjYWxsZWQuIEFsbFxuXHQgICAgICAgKiB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkb24gbGlzdGVuZXJzfSBsaXN0ZW5pbmcgZm9yIGBuYW1lYCBldmVudCBvbiB0aGlzIHNjb3BlIGdldFxuXHQgICAgICAgKiBub3RpZmllZC4gQWZ0ZXJ3YXJkcywgdGhlIGV2ZW50IHByb3BhZ2F0ZXMgdG8gYWxsIGRpcmVjdCBhbmQgaW5kaXJlY3Qgc2NvcGVzIG9mIHRoZSBjdXJyZW50XG5cdCAgICAgICAqIHNjb3BlIGFuZCBjYWxscyBhbGwgcmVnaXN0ZXJlZCBsaXN0ZW5lcnMgYWxvbmcgdGhlIHdheS4gVGhlIGV2ZW50IGNhbm5vdCBiZSBjYW5jZWxlZC5cblx0ICAgICAgICpcblx0ICAgICAgICogQW55IGV4Y2VwdGlvbiBlbWl0dGVkIGZyb20gdGhlIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRvbiBsaXN0ZW5lcnN9IHdpbGwgYmUgcGFzc2VkXG5cdCAgICAgICAqIG9udG8gdGhlIHtAbGluayBuZy4kZXhjZXB0aW9uSGFuZGxlciAkZXhjZXB0aW9uSGFuZGxlcn0gc2VydmljZS5cblx0ICAgICAgICpcblx0ICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgRXZlbnQgbmFtZSB0byBicm9hZGNhc3QuXG5cdCAgICAgICAqIEBwYXJhbSB7Li4uKn0gYXJncyBPcHRpb25hbCBvbmUgb3IgbW9yZSBhcmd1bWVudHMgd2hpY2ggd2lsbCBiZSBwYXNzZWQgb250byB0aGUgZXZlbnQgbGlzdGVuZXJzLlxuXHQgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IEV2ZW50IG9iamVjdCwgc2VlIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRvbn1cblx0ICAgICAgICovXG5cdCAgICAgICRicm9hZGNhc3Q6IGZ1bmN0aW9uKG5hbWUsIGFyZ3MpIHtcblx0ICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcyxcblx0ICAgICAgICAgICAgY3VycmVudCA9IHRhcmdldCxcblx0ICAgICAgICAgICAgbmV4dCA9IHRhcmdldCxcblx0ICAgICAgICAgICAgZXZlbnQgPSB7XG5cdCAgICAgICAgICAgICAgbmFtZTogbmFtZSxcblx0ICAgICAgICAgICAgICB0YXJnZXRTY29wZTogdGFyZ2V0LFxuXHQgICAgICAgICAgICAgIHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgICAgIGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgICAgZGVmYXVsdFByZXZlbnRlZDogZmFsc2Vcblx0ICAgICAgICAgICAgfTtcblx0XG5cdCAgICAgICAgaWYgKCF0YXJnZXQuJCRsaXN0ZW5lckNvdW50W25hbWVdKSByZXR1cm4gZXZlbnQ7XG5cdFxuXHQgICAgICAgIHZhciBsaXN0ZW5lckFyZ3MgPSBjb25jYXQoW2V2ZW50XSwgYXJndW1lbnRzLCAxKSxcblx0ICAgICAgICAgICAgbGlzdGVuZXJzLCBpLCBsZW5ndGg7XG5cdFxuXHQgICAgICAgIC8vZG93biB3aGlsZSB5b3UgY2FuLCB0aGVuIHVwIGFuZCBuZXh0IHNpYmxpbmcgb3IgdXAgYW5kIG5leHQgc2libGluZyB1bnRpbCBiYWNrIGF0IHJvb3Rcblx0ICAgICAgICB3aGlsZSAoKGN1cnJlbnQgPSBuZXh0KSkge1xuXHQgICAgICAgICAgZXZlbnQuY3VycmVudFNjb3BlID0gY3VycmVudDtcblx0ICAgICAgICAgIGxpc3RlbmVycyA9IGN1cnJlbnQuJCRsaXN0ZW5lcnNbbmFtZV0gfHwgW107XG5cdCAgICAgICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBsaXN0ZW5lcnMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgICAgLy8gaWYgbGlzdGVuZXJzIHdlcmUgZGVyZWdpc3RlcmVkLCBkZWZyYWdtZW50IHRoZSBhcnJheVxuXHQgICAgICAgICAgICBpZiAoIWxpc3RlbmVyc1tpXSkge1xuXHQgICAgICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaSwgMSk7XG5cdCAgICAgICAgICAgICAgaS0tO1xuXHQgICAgICAgICAgICAgIGxlbmd0aC0tO1xuXHQgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgIGxpc3RlbmVyc1tpXS5hcHBseShudWxsLCBsaXN0ZW5lckFyZ3MpO1xuXHQgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAvLyBJbnNhbml0eSBXYXJuaW5nOiBzY29wZSBkZXB0aC1maXJzdCB0cmF2ZXJzYWxcblx0ICAgICAgICAgIC8vIHllcywgdGhpcyBjb2RlIGlzIGEgYml0IGNyYXp5LCBidXQgaXQgd29ya3MgYW5kIHdlIGhhdmUgdGVzdHMgdG8gcHJvdmUgaXQhXG5cdCAgICAgICAgICAvLyB0aGlzIHBpZWNlIHNob3VsZCBiZSBrZXB0IGluIHN5bmMgd2l0aCB0aGUgdHJhdmVyc2FsIGluICRkaWdlc3Rcblx0ICAgICAgICAgIC8vICh0aG91Z2ggaXQgZGlmZmVycyBkdWUgdG8gaGF2aW5nIHRoZSBleHRyYSBjaGVjayBmb3IgJCRsaXN0ZW5lckNvdW50KVxuXHQgICAgICAgICAgaWYgKCEobmV4dCA9ICgoY3VycmVudC4kJGxpc3RlbmVyQ291bnRbbmFtZV0gJiYgY3VycmVudC4kJGNoaWxkSGVhZCkgfHxcblx0ICAgICAgICAgICAgICAoY3VycmVudCAhPT0gdGFyZ2V0ICYmIGN1cnJlbnQuJCRuZXh0U2libGluZykpKSkge1xuXHQgICAgICAgICAgICB3aGlsZSAoY3VycmVudCAhPT0gdGFyZ2V0ICYmICEobmV4dCA9IGN1cnJlbnQuJCRuZXh0U2libGluZykpIHtcblx0ICAgICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC4kcGFyZW50O1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBldmVudC5jdXJyZW50U2NvcGUgPSBudWxsO1xuXHQgICAgICAgIHJldHVybiBldmVudDtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICB2YXIgJHJvb3RTY29wZSA9IG5ldyBTY29wZSgpO1xuXHRcblx0ICAgIC8vVGhlIGludGVybmFsIHF1ZXVlcy4gRXhwb3NlIHRoZW0gb24gdGhlICRyb290U2NvcGUgZm9yIGRlYnVnZ2luZy90ZXN0aW5nIHB1cnBvc2VzLlxuXHQgICAgdmFyIGFzeW5jUXVldWUgPSAkcm9vdFNjb3BlLiQkYXN5bmNRdWV1ZSA9IFtdO1xuXHQgICAgdmFyIHBvc3REaWdlc3RRdWV1ZSA9ICRyb290U2NvcGUuJCRwb3N0RGlnZXN0UXVldWUgPSBbXTtcblx0ICAgIHZhciBhcHBseUFzeW5jUXVldWUgPSAkcm9vdFNjb3BlLiQkYXBwbHlBc3luY1F1ZXVlID0gW107XG5cdFxuXHQgICAgcmV0dXJuICRyb290U2NvcGU7XG5cdFxuXHRcblx0ICAgIGZ1bmN0aW9uIGJlZ2luUGhhc2UocGhhc2UpIHtcblx0ICAgICAgaWYgKCRyb290U2NvcGUuJCRwaGFzZSkge1xuXHQgICAgICAgIHRocm93ICRyb290U2NvcGVNaW5FcnIoJ2lucHJvZycsICd7MH0gYWxyZWFkeSBpbiBwcm9ncmVzcycsICRyb290U2NvcGUuJCRwaGFzZSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgICRyb290U2NvcGUuJCRwaGFzZSA9IHBoYXNlO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGNsZWFyUGhhc2UoKSB7XG5cdCAgICAgICRyb290U2NvcGUuJCRwaGFzZSA9IG51bGw7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gaW5jcmVtZW50V2F0Y2hlcnNDb3VudChjdXJyZW50LCBjb3VudCkge1xuXHQgICAgICBkbyB7XG5cdCAgICAgICAgY3VycmVudC4kJHdhdGNoZXJzQ291bnQgKz0gY291bnQ7XG5cdCAgICAgIH0gd2hpbGUgKChjdXJyZW50ID0gY3VycmVudC4kcGFyZW50KSk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gZGVjcmVtZW50TGlzdGVuZXJDb3VudChjdXJyZW50LCBjb3VudCwgbmFtZSkge1xuXHQgICAgICBkbyB7XG5cdCAgICAgICAgY3VycmVudC4kJGxpc3RlbmVyQ291bnRbbmFtZV0gLT0gY291bnQ7XG5cdFxuXHQgICAgICAgIGlmIChjdXJyZW50LiQkbGlzdGVuZXJDb3VudFtuYW1lXSA9PT0gMCkge1xuXHQgICAgICAgICAgZGVsZXRlIGN1cnJlbnQuJCRsaXN0ZW5lckNvdW50W25hbWVdO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSB3aGlsZSAoKGN1cnJlbnQgPSBjdXJyZW50LiRwYXJlbnQpKTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIGZ1bmN0aW9uIHVzZWQgYXMgYW4gaW5pdGlhbCB2YWx1ZSBmb3Igd2F0Y2hlcnMuXG5cdCAgICAgKiBiZWNhdXNlIGl0J3MgdW5pcXVlIHdlIGNhbiBlYXNpbHkgdGVsbCBpdCBhcGFydCBmcm9tIG90aGVyIHZhbHVlc1xuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBpbml0V2F0Y2hWYWwoKSB7fVxuXHRcblx0ICAgIGZ1bmN0aW9uIGZsdXNoQXBwbHlBc3luYygpIHtcblx0ICAgICAgd2hpbGUgKGFwcGx5QXN5bmNRdWV1ZS5sZW5ndGgpIHtcblx0ICAgICAgICB0cnkge1xuXHQgICAgICAgICAgYXBwbHlBc3luY1F1ZXVlLnNoaWZ0KCkoKTtcblx0ICAgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgICAkZXhjZXB0aW9uSGFuZGxlcihlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgICAgYXBwbHlBc3luY0lkID0gbnVsbDtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBzY2hlZHVsZUFwcGx5QXN5bmMoKSB7XG5cdCAgICAgIGlmIChhcHBseUFzeW5jSWQgPT09IG51bGwpIHtcblx0ICAgICAgICBhcHBseUFzeW5jSWQgPSAkYnJvd3Nlci5kZWZlcihmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICRyb290U2NvcGUuJGFwcGx5KGZsdXNoQXBwbHlBc3luYyk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBzZXJ2aWNlXG5cdCAqIEBuYW1lICRyb290RWxlbWVudFxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogVGhlIHJvb3QgZWxlbWVudCBvZiBBbmd1bGFyIGFwcGxpY2F0aW9uLiBUaGlzIGlzIGVpdGhlciB0aGUgZWxlbWVudCB3aGVyZSB7QGxpbmtcblx0ICogbmcuZGlyZWN0aXZlOm5nQXBwIG5nQXBwfSB3YXMgZGVjbGFyZWQgb3IgdGhlIGVsZW1lbnQgcGFzc2VkIGludG9cblx0ICoge0BsaW5rIGFuZ3VsYXIuYm9vdHN0cmFwfS4gVGhlIGVsZW1lbnQgcmVwcmVzZW50cyB0aGUgcm9vdCBlbGVtZW50IG9mIGFwcGxpY2F0aW9uLiBJdCBpcyBhbHNvIHRoZVxuXHQgKiBsb2NhdGlvbiB3aGVyZSB0aGUgYXBwbGljYXRpb24ncyB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfSBzZXJ2aWNlIGdldHNcblx0ICogcHVibGlzaGVkLCBhbmQgY2FuIGJlIHJldHJpZXZlZCB1c2luZyBgJHJvb3RFbGVtZW50LmluamVjdG9yKClgLlxuXHQgKi9cblx0XG5cdFxuXHQvLyB0aGUgaW1wbGVtZW50YXRpb24gaXMgaW4gYW5ndWxhci5ib290c3RyYXBcblx0XG5cdC8qKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogUHJpdmF0ZSBzZXJ2aWNlIHRvIHNhbml0aXplIHVyaXMgZm9yIGxpbmtzIGFuZCBpbWFnZXMuIFVzZWQgYnkgJGNvbXBpbGUgYW5kICRzYW5pdGl6ZS5cblx0ICovXG5cdGZ1bmN0aW9uICQkU2FuaXRpemVVcmlQcm92aWRlcigpIHtcblx0ICB2YXIgYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3QgPSAvXlxccyooaHR0cHM/fGZ0cHxtYWlsdG98dGVsfGZpbGUpOi8sXG5cdCAgICBpbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3QgPSAvXlxccyooKGh0dHBzP3xmdHB8ZmlsZXxibG9iKTp8ZGF0YTppbWFnZVxcLykvO1xuXHRcblx0ICAvKipcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBSZXRyaWV2ZXMgb3Igb3ZlcnJpZGVzIHRoZSBkZWZhdWx0IHJlZ3VsYXIgZXhwcmVzc2lvbiB0aGF0IGlzIHVzZWQgZm9yIHdoaXRlbGlzdGluZyBvZiBzYWZlXG5cdCAgICogdXJscyBkdXJpbmcgYVtocmVmXSBzYW5pdGl6YXRpb24uXG5cdCAgICpcblx0ICAgKiBUaGUgc2FuaXRpemF0aW9uIGlzIGEgc2VjdXJpdHkgbWVhc3VyZSBhaW1lZCBhdCBwcmV2ZW50IFhTUyBhdHRhY2tzIHZpYSBodG1sIGxpbmtzLlxuXHQgICAqXG5cdCAgICogQW55IHVybCBhYm91dCB0byBiZSBhc3NpZ25lZCB0byBhW2hyZWZdIHZpYSBkYXRhLWJpbmRpbmcgaXMgZmlyc3Qgbm9ybWFsaXplZCBhbmQgdHVybmVkIGludG9cblx0ICAgKiBhbiBhYnNvbHV0ZSB1cmwuIEFmdGVyd2FyZHMsIHRoZSB1cmwgaXMgbWF0Y2hlZCBhZ2FpbnN0IHRoZSBgYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3RgXG5cdCAgICogcmVndWxhciBleHByZXNzaW9uLiBJZiBhIG1hdGNoIGlzIGZvdW5kLCB0aGUgb3JpZ2luYWwgdXJsIGlzIHdyaXR0ZW4gaW50byB0aGUgZG9tLiBPdGhlcndpc2UsXG5cdCAgICogdGhlIGFic29sdXRlIHVybCBpcyBwcmVmaXhlZCB3aXRoIGAndW5zYWZlOidgIHN0cmluZyBhbmQgb25seSB0aGVuIGlzIGl0IHdyaXR0ZW4gaW50byB0aGUgRE9NLlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtSZWdFeHA9fSByZWdleHAgTmV3IHJlZ2V4cCB0byB3aGl0ZWxpc3QgdXJscyB3aXRoLlxuXHQgICAqIEByZXR1cm5zIHtSZWdFeHB8bmcuJGNvbXBpbGVQcm92aWRlcn0gQ3VycmVudCBSZWdFeHAgaWYgY2FsbGVkIHdpdGhvdXQgdmFsdWUgb3Igc2VsZiBmb3Jcblx0ICAgKiAgICBjaGFpbmluZyBvdGhlcndpc2UuXG5cdCAgICovXG5cdCAgdGhpcy5hSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdCA9IGZ1bmN0aW9uKHJlZ2V4cCkge1xuXHQgICAgaWYgKGlzRGVmaW5lZChyZWdleHApKSB7XG5cdCAgICAgIGFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0ID0gcmVnZXhwO1xuXHQgICAgICByZXR1cm4gdGhpcztcblx0ICAgIH1cblx0ICAgIHJldHVybiBhSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdDtcblx0ICB9O1xuXHRcblx0XG5cdCAgLyoqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogUmV0cmlldmVzIG9yIG92ZXJyaWRlcyB0aGUgZGVmYXVsdCByZWd1bGFyIGV4cHJlc3Npb24gdGhhdCBpcyB1c2VkIGZvciB3aGl0ZWxpc3Rpbmcgb2Ygc2FmZVxuXHQgICAqIHVybHMgZHVyaW5nIGltZ1tzcmNdIHNhbml0aXphdGlvbi5cblx0ICAgKlxuXHQgICAqIFRoZSBzYW5pdGl6YXRpb24gaXMgYSBzZWN1cml0eSBtZWFzdXJlIGFpbWVkIGF0IHByZXZlbnQgWFNTIGF0dGFja3MgdmlhIGh0bWwgbGlua3MuXG5cdCAgICpcblx0ICAgKiBBbnkgdXJsIGFib3V0IHRvIGJlIGFzc2lnbmVkIHRvIGltZ1tzcmNdIHZpYSBkYXRhLWJpbmRpbmcgaXMgZmlyc3Qgbm9ybWFsaXplZCBhbmQgdHVybmVkIGludG9cblx0ICAgKiBhbiBhYnNvbHV0ZSB1cmwuIEFmdGVyd2FyZHMsIHRoZSB1cmwgaXMgbWF0Y2hlZCBhZ2FpbnN0IHRoZSBgaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0YFxuXHQgICAqIHJlZ3VsYXIgZXhwcmVzc2lvbi4gSWYgYSBtYXRjaCBpcyBmb3VuZCwgdGhlIG9yaWdpbmFsIHVybCBpcyB3cml0dGVuIGludG8gdGhlIGRvbS4gT3RoZXJ3aXNlLFxuXHQgICAqIHRoZSBhYnNvbHV0ZSB1cmwgaXMgcHJlZml4ZWQgd2l0aCBgJ3Vuc2FmZTonYCBzdHJpbmcgYW5kIG9ubHkgdGhlbiBpcyBpdCB3cml0dGVuIGludG8gdGhlIERPTS5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7UmVnRXhwPX0gcmVnZXhwIE5ldyByZWdleHAgdG8gd2hpdGVsaXN0IHVybHMgd2l0aC5cblx0ICAgKiBAcmV0dXJucyB7UmVnRXhwfG5nLiRjb21waWxlUHJvdmlkZXJ9IEN1cnJlbnQgUmVnRXhwIGlmIGNhbGxlZCB3aXRob3V0IHZhbHVlIG9yIHNlbGYgZm9yXG5cdCAgICogICAgY2hhaW5pbmcgb3RoZXJ3aXNlLlxuXHQgICAqL1xuXHQgIHRoaXMuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0ID0gZnVuY3Rpb24ocmVnZXhwKSB7XG5cdCAgICBpZiAoaXNEZWZpbmVkKHJlZ2V4cCkpIHtcblx0ICAgICAgaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0ID0gcmVnZXhwO1xuXHQgICAgICByZXR1cm4gdGhpcztcblx0ICAgIH1cblx0ICAgIHJldHVybiBpbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3Q7XG5cdCAgfTtcblx0XG5cdCAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24oKSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24gc2FuaXRpemVVcmkodXJpLCBpc0ltYWdlKSB7XG5cdCAgICAgIHZhciByZWdleCA9IGlzSW1hZ2UgPyBpbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3QgOiBhSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdDtcblx0ICAgICAgdmFyIG5vcm1hbGl6ZWRWYWw7XG5cdCAgICAgIG5vcm1hbGl6ZWRWYWwgPSB1cmxSZXNvbHZlKHVyaSkuaHJlZjtcblx0ICAgICAgaWYgKG5vcm1hbGl6ZWRWYWwgIT09ICcnICYmICFub3JtYWxpemVkVmFsLm1hdGNoKHJlZ2V4KSkge1xuXHQgICAgICAgIHJldHVybiAndW5zYWZlOicgKyBub3JtYWxpemVkVmFsO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiB1cmk7XG5cdCAgICB9O1xuXHQgIH07XG5cdH1cblx0XG5cdC8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICpcblx0ICogICAgIEFueSBjb21taXRzIHRvIHRoaXMgZmlsZSBzaG91bGQgYmUgcmV2aWV3ZWQgd2l0aCBzZWN1cml0eSBpbiBtaW5kLiAgKlxuXHQgKiAgIENoYW5nZXMgdG8gdGhpcyBmaWxlIGNhbiBwb3RlbnRpYWxseSBjcmVhdGUgc2VjdXJpdHkgdnVsbmVyYWJpbGl0aWVzLiAqXG5cdCAqICAgICAgICAgIEFuIGFwcHJvdmFsIGZyb20gMiBDb3JlIG1lbWJlcnMgd2l0aCBoaXN0b3J5IG9mIG1vZGlmeWluZyAgICAgICpcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyBmaWxlIGlzIHJlcXVpcmVkLiAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG5cdCAqICBEb2VzIHRoZSBjaGFuZ2Ugc29tZWhvdyBhbGxvdyBmb3IgYXJiaXRyYXJ5IGphdmFzY3JpcHQgdG8gYmUgZXhlY3V0ZWQ/ICpcblx0ICogICAgT3IgYWxsb3dzIGZvciBzb21lb25lIHRvIGNoYW5nZSB0aGUgcHJvdG90eXBlIG9mIGJ1aWx0LWluIG9iamVjdHM/ICAgKlxuXHQgKiAgICAgT3IgZ2l2ZXMgdW5kZXNpcmVkIGFjY2VzcyB0byB2YXJpYWJsZXMgbGlrZXMgZG9jdW1lbnQgb3Igd2luZG93PyAgICAqXG5cdCAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovXG5cdFxuXHR2YXIgJHNjZU1pbkVyciA9IG1pbkVycignJHNjZScpO1xuXHRcblx0dmFyIFNDRV9DT05URVhUUyA9IHtcblx0ICBIVE1MOiAnaHRtbCcsXG5cdCAgQ1NTOiAnY3NzJyxcblx0ICBVUkw6ICd1cmwnLFxuXHQgIC8vIFJFU09VUkNFX1VSTCBpcyBhIHN1YnR5cGUgb2YgVVJMIHVzZWQgaW4gY29udGV4dHMgd2hlcmUgYSBwcml2aWxlZ2VkIHJlc291cmNlIGlzIHNvdXJjZWQgZnJvbSBhXG5cdCAgLy8gdXJsLiAgKGUuZy4gbmctaW5jbHVkZSwgc2NyaXB0IHNyYywgdGVtcGxhdGVVcmwpXG5cdCAgUkVTT1VSQ0VfVVJMOiAncmVzb3VyY2VVcmwnLFxuXHQgIEpTOiAnanMnXG5cdH07XG5cdFxuXHQvLyBIZWxwZXIgZnVuY3Rpb25zIGZvbGxvdy5cblx0XG5cdGZ1bmN0aW9uIGFkanVzdE1hdGNoZXIobWF0Y2hlcikge1xuXHQgIGlmIChtYXRjaGVyID09PSAnc2VsZicpIHtcblx0ICAgIHJldHVybiBtYXRjaGVyO1xuXHQgIH0gZWxzZSBpZiAoaXNTdHJpbmcobWF0Y2hlcikpIHtcblx0ICAgIC8vIFN0cmluZ3MgbWF0Y2ggZXhhY3RseSBleGNlcHQgZm9yIDIgd2lsZGNhcmRzIC0gJyonIGFuZCAnKionLlxuXHQgICAgLy8gJyonIG1hdGNoZXMgYW55IGNoYXJhY3RlciBleGNlcHQgdGhvc2UgZnJvbSB0aGUgc2V0ICc6Ly4/JicuXG5cdCAgICAvLyAnKionIG1hdGNoZXMgYW55IGNoYXJhY3RlciAobGlrZSAuKiBpbiBhIFJlZ0V4cCkuXG5cdCAgICAvLyBNb3JlIHRoYW4gMiAqJ3MgcmFpc2VzIGFuIGVycm9yIGFzIGl0J3MgaWxsIGRlZmluZWQuXG5cdCAgICBpZiAobWF0Y2hlci5pbmRleE9mKCcqKionKSA+IC0xKSB7XG5cdCAgICAgIHRocm93ICRzY2VNaW5FcnIoJ2l3Y2FyZCcsXG5cdCAgICAgICAgICAnSWxsZWdhbCBzZXF1ZW5jZSAqKiogaW4gc3RyaW5nIG1hdGNoZXIuICBTdHJpbmc6IHswfScsIG1hdGNoZXIpO1xuXHQgICAgfVxuXHQgICAgbWF0Y2hlciA9IGVzY2FwZUZvclJlZ2V4cChtYXRjaGVyKS5cblx0ICAgICAgICAgICAgICAgICAgcmVwbGFjZSgnXFxcXCpcXFxcKicsICcuKicpLlxuXHQgICAgICAgICAgICAgICAgICByZXBsYWNlKCdcXFxcKicsICdbXjovLj8mO10qJyk7XG5cdCAgICByZXR1cm4gbmV3IFJlZ0V4cCgnXicgKyBtYXRjaGVyICsgJyQnKTtcblx0ICB9IGVsc2UgaWYgKGlzUmVnRXhwKG1hdGNoZXIpKSB7XG5cdCAgICAvLyBUaGUgb25seSBvdGhlciB0eXBlIG9mIG1hdGNoZXIgYWxsb3dlZCBpcyBhIFJlZ2V4cC5cblx0ICAgIC8vIE1hdGNoIGVudGlyZSBVUkwgLyBkaXNhbGxvdyBwYXJ0aWFsIG1hdGNoZXMuXG5cdCAgICAvLyBGbGFncyBhcmUgcmVzZXQgKGkuZS4gbm8gZ2xvYmFsLCBpZ25vcmVDYXNlIG9yIG11bHRpbGluZSlcblx0ICAgIHJldHVybiBuZXcgUmVnRXhwKCdeJyArIG1hdGNoZXIuc291cmNlICsgJyQnKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgdGhyb3cgJHNjZU1pbkVycignaW1hdGNoZXInLFxuXHQgICAgICAgICdNYXRjaGVycyBtYXkgb25seSBiZSBcInNlbGZcIiwgc3RyaW5nIHBhdHRlcm5zIG9yIFJlZ0V4cCBvYmplY3RzJyk7XG5cdCAgfVxuXHR9XG5cdFxuXHRcblx0ZnVuY3Rpb24gYWRqdXN0TWF0Y2hlcnMobWF0Y2hlcnMpIHtcblx0ICB2YXIgYWRqdXN0ZWRNYXRjaGVycyA9IFtdO1xuXHQgIGlmIChpc0RlZmluZWQobWF0Y2hlcnMpKSB7XG5cdCAgICBmb3JFYWNoKG1hdGNoZXJzLCBmdW5jdGlvbihtYXRjaGVyKSB7XG5cdCAgICAgIGFkanVzdGVkTWF0Y2hlcnMucHVzaChhZGp1c3RNYXRjaGVyKG1hdGNoZXIpKTtcblx0ICAgIH0pO1xuXHQgIH1cblx0ICByZXR1cm4gYWRqdXN0ZWRNYXRjaGVycztcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2Mgc2VydmljZVxuXHQgKiBAbmFtZSAkc2NlRGVsZWdhdGVcblx0ICogQGtpbmQgZnVuY3Rpb25cblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqXG5cdCAqIGAkc2NlRGVsZWdhdGVgIGlzIGEgc2VydmljZSB0aGF0IGlzIHVzZWQgYnkgdGhlIGAkc2NlYCBzZXJ2aWNlIHRvIHByb3ZpZGUge0BsaW5rIG5nLiRzY2UgU3RyaWN0XG5cdCAqIENvbnRleHR1YWwgRXNjYXBpbmcgKFNDRSl9IHNlcnZpY2VzIHRvIEFuZ3VsYXJKUy5cblx0ICpcblx0ICogVHlwaWNhbGx5LCB5b3Ugd291bGQgY29uZmlndXJlIG9yIG92ZXJyaWRlIHRoZSB7QGxpbmsgbmcuJHNjZURlbGVnYXRlICRzY2VEZWxlZ2F0ZX0gaW5zdGVhZCBvZlxuXHQgKiB0aGUgYCRzY2VgIHNlcnZpY2UgdG8gY3VzdG9taXplIHRoZSB3YXkgU3RyaWN0IENvbnRleHR1YWwgRXNjYXBpbmcgd29ya3MgaW4gQW5ndWxhckpTLiAgVGhpcyBpc1xuXHQgKiBiZWNhdXNlLCB3aGlsZSB0aGUgYCRzY2VgIHByb3ZpZGVzIG51bWVyb3VzIHNob3J0aGFuZCBtZXRob2RzLCBldGMuLCB5b3UgcmVhbGx5IG9ubHkgbmVlZCB0b1xuXHQgKiBvdmVycmlkZSAzIGNvcmUgZnVuY3Rpb25zIChgdHJ1c3RBc2AsIGBnZXRUcnVzdGVkYCBhbmQgYHZhbHVlT2ZgKSB0byByZXBsYWNlIHRoZSB3YXkgdGhpbmdzXG5cdCAqIHdvcmsgYmVjYXVzZSBgJHNjZWAgZGVsZWdhdGVzIHRvIGAkc2NlRGVsZWdhdGVgIGZvciB0aGVzZSBvcGVyYXRpb25zLlxuXHQgKlxuXHQgKiBSZWZlciB7QGxpbmsgbmcuJHNjZURlbGVnYXRlUHJvdmlkZXIgJHNjZURlbGVnYXRlUHJvdmlkZXJ9IHRvIGNvbmZpZ3VyZSB0aGlzIHNlcnZpY2UuXG5cdCAqXG5cdCAqIFRoZSBkZWZhdWx0IGluc3RhbmNlIG9mIGAkc2NlRGVsZWdhdGVgIHNob3VsZCB3b3JrIG91dCBvZiB0aGUgYm94IHdpdGggbGl0dGxlIHBhaW4uICBXaGlsZSB5b3Vcblx0ICogY2FuIG92ZXJyaWRlIGl0IGNvbXBsZXRlbHkgdG8gY2hhbmdlIHRoZSBiZWhhdmlvciBvZiBgJHNjZWAsIHRoZSBjb21tb24gY2FzZSB3b3VsZFxuXHQgKiBpbnZvbHZlIGNvbmZpZ3VyaW5nIHRoZSB7QGxpbmsgbmcuJHNjZURlbGVnYXRlUHJvdmlkZXIgJHNjZURlbGVnYXRlUHJvdmlkZXJ9IGluc3RlYWQgYnkgc2V0dGluZ1xuXHQgKiB5b3VyIG93biB3aGl0ZWxpc3RzIGFuZCBibGFja2xpc3RzIGZvciB0cnVzdGluZyBVUkxzIHVzZWQgZm9yIGxvYWRpbmcgQW5ndWxhckpTIHJlc291cmNlcyBzdWNoIGFzXG5cdCAqIHRlbXBsYXRlcy4gIFJlZmVyIHtAbGluayBuZy4kc2NlRGVsZWdhdGVQcm92aWRlciNyZXNvdXJjZVVybFdoaXRlbGlzdFxuXHQgKiAkc2NlRGVsZWdhdGVQcm92aWRlci5yZXNvdXJjZVVybFdoaXRlbGlzdH0gYW5kIHtAbGlua1xuXHQgKiBuZy4kc2NlRGVsZWdhdGVQcm92aWRlciNyZXNvdXJjZVVybEJsYWNrbGlzdCAkc2NlRGVsZWdhdGVQcm92aWRlci5yZXNvdXJjZVVybEJsYWNrbGlzdH1cblx0ICovXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHByb3ZpZGVyXG5cdCAqIEBuYW1lICRzY2VEZWxlZ2F0ZVByb3ZpZGVyXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKlxuXHQgKiBUaGUgYCRzY2VEZWxlZ2F0ZVByb3ZpZGVyYCBwcm92aWRlciBhbGxvd3MgZGV2ZWxvcGVycyB0byBjb25maWd1cmUgdGhlIHtAbGluayBuZy4kc2NlRGVsZWdhdGVcblx0ICogJHNjZURlbGVnYXRlfSBzZXJ2aWNlLiAgVGhpcyBhbGxvd3Mgb25lIHRvIGdldC9zZXQgdGhlIHdoaXRlbGlzdHMgYW5kIGJsYWNrbGlzdHMgdXNlZCB0byBlbnN1cmVcblx0ICogdGhhdCB0aGUgVVJMcyB1c2VkIGZvciBzb3VyY2luZyBBbmd1bGFyIHRlbXBsYXRlcyBhcmUgc2FmZS4gIFJlZmVyIHtAbGlua1xuXHQgKiBuZy4kc2NlRGVsZWdhdGVQcm92aWRlciNyZXNvdXJjZVVybFdoaXRlbGlzdCAkc2NlRGVsZWdhdGVQcm92aWRlci5yZXNvdXJjZVVybFdoaXRlbGlzdH0gYW5kXG5cdCAqIHtAbGluayBuZy4kc2NlRGVsZWdhdGVQcm92aWRlciNyZXNvdXJjZVVybEJsYWNrbGlzdCAkc2NlRGVsZWdhdGVQcm92aWRlci5yZXNvdXJjZVVybEJsYWNrbGlzdH1cblx0ICpcblx0ICogRm9yIHRoZSBnZW5lcmFsIGRldGFpbHMgYWJvdXQgdGhpcyBzZXJ2aWNlIGluIEFuZ3VsYXIsIHJlYWQgdGhlIG1haW4gcGFnZSBmb3Ige0BsaW5rIG5nLiRzY2Vcblx0ICogU3RyaWN0IENvbnRleHR1YWwgRXNjYXBpbmcgKFNDRSl9LlxuXHQgKlxuXHQgKiAqKkV4YW1wbGUqKjogIENvbnNpZGVyIHRoZSBmb2xsb3dpbmcgY2FzZS4gPGEgbmFtZT1cImV4YW1wbGVcIj48L2E+XG5cdCAqXG5cdCAqIC0geW91ciBhcHAgaXMgaG9zdGVkIGF0IHVybCBgaHR0cDovL215YXBwLmV4YW1wbGUuY29tL2Bcblx0ICogLSBidXQgc29tZSBvZiB5b3VyIHRlbXBsYXRlcyBhcmUgaG9zdGVkIG9uIG90aGVyIGRvbWFpbnMgeW91IGNvbnRyb2wgc3VjaCBhc1xuXHQgKiAgIGBodHRwOi8vc3J2MDEuYXNzZXRzLmV4YW1wbGUuY29tL2AswqAgYGh0dHA6Ly9zcnYwMi5hc3NldHMuZXhhbXBsZS5jb20vYCwgZXRjLlxuXHQgKiAtIGFuZCB5b3UgaGF2ZSBhbiBvcGVuIHJlZGlyZWN0IGF0IGBodHRwOi8vbXlhcHAuZXhhbXBsZS5jb20vY2xpY2tUaHJ1Py4uLmAuXG5cdCAqXG5cdCAqIEhlcmUgaXMgd2hhdCBhIHNlY3VyZSBjb25maWd1cmF0aW9uIGZvciB0aGlzIHNjZW5hcmlvIG1pZ2h0IGxvb2sgbGlrZTpcblx0ICpcblx0ICogYGBgXG5cdCAqICBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnLCBbXSkuY29uZmlnKGZ1bmN0aW9uKCRzY2VEZWxlZ2F0ZVByb3ZpZGVyKSB7XG5cdCAqICAgICRzY2VEZWxlZ2F0ZVByb3ZpZGVyLnJlc291cmNlVXJsV2hpdGVsaXN0KFtcblx0ICogICAgICAvLyBBbGxvdyBzYW1lIG9yaWdpbiByZXNvdXJjZSBsb2Fkcy5cblx0ICogICAgICAnc2VsZicsXG5cdCAqICAgICAgLy8gQWxsb3cgbG9hZGluZyBmcm9tIG91ciBhc3NldHMgZG9tYWluLiAgTm90aWNlIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gKiBhbmQgKiouXG5cdCAqICAgICAgJ2h0dHA6Ly9zcnYqLmFzc2V0cy5leGFtcGxlLmNvbS8qKidcblx0ICogICAgXSk7XG5cdCAqXG5cdCAqICAgIC8vIFRoZSBibGFja2xpc3Qgb3ZlcnJpZGVzIHRoZSB3aGl0ZWxpc3Qgc28gdGhlIG9wZW4gcmVkaXJlY3QgaGVyZSBpcyBibG9ja2VkLlxuXHQgKiAgICAkc2NlRGVsZWdhdGVQcm92aWRlci5yZXNvdXJjZVVybEJsYWNrbGlzdChbXG5cdCAqICAgICAgJ2h0dHA6Ly9teWFwcC5leGFtcGxlLmNvbS9jbGlja1RocnUqKidcblx0ICogICAgXSk7XG5cdCAqICB9KTtcblx0ICogYGBgXG5cdCAqL1xuXHRcblx0ZnVuY3Rpb24gJFNjZURlbGVnYXRlUHJvdmlkZXIoKSB7XG5cdCAgdGhpcy5TQ0VfQ09OVEVYVFMgPSBTQ0VfQ09OVEVYVFM7XG5cdFxuXHQgIC8vIFJlc291cmNlIFVSTHMgY2FuIGFsc28gYmUgdHJ1c3RlZCBieSBwb2xpY3kuXG5cdCAgdmFyIHJlc291cmNlVXJsV2hpdGVsaXN0ID0gWydzZWxmJ10sXG5cdCAgICAgIHJlc291cmNlVXJsQmxhY2tsaXN0ID0gW107XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkc2NlRGVsZWdhdGVQcm92aWRlciNyZXNvdXJjZVVybFdoaXRlbGlzdFxuXHQgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge0FycmF5PX0gd2hpdGVsaXN0IFdoZW4gcHJvdmlkZWQsIHJlcGxhY2VzIHRoZSByZXNvdXJjZVVybFdoaXRlbGlzdCB3aXRoIHRoZSB2YWx1ZVxuXHQgICAqICAgIHByb3ZpZGVkLiAgVGhpcyBtdXN0IGJlIGFuIGFycmF5IG9yIG51bGwuICBBIHNuYXBzaG90IG9mIHRoaXMgYXJyYXkgaXMgdXNlZCBzbyBmdXJ0aGVyXG5cdCAgICogICAgY2hhbmdlcyB0byB0aGUgYXJyYXkgYXJlIGlnbm9yZWQuXG5cdCAgICpcblx0ICAgKiAgICBGb2xsb3cge0BsaW5rIG5nLiRzY2UjcmVzb3VyY2VVcmxQYXR0ZXJuSXRlbSB0aGlzIGxpbmt9IGZvciBhIGRlc2NyaXB0aW9uIG9mIHRoZSBpdGVtc1xuXHQgICAqICAgIGFsbG93ZWQgaW4gdGhpcyBhcnJheS5cblx0ICAgKlxuXHQgICAqICAgIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG5cdCAgICogICAgKipOb3RlOioqIGFuIGVtcHR5IHdoaXRlbGlzdCBhcnJheSB3aWxsIGJsb2NrIGFsbCBVUkxzIVxuXHQgICAqICAgIDwvZGl2PlxuXHQgICAqXG5cdCAgICogQHJldHVybiB7QXJyYXl9IHRoZSBjdXJyZW50bHkgc2V0IHdoaXRlbGlzdCBhcnJheS5cblx0ICAgKlxuXHQgICAqIFRoZSAqKmRlZmF1bHQgdmFsdWUqKiB3aGVuIG5vIHdoaXRlbGlzdCBoYXMgYmVlbiBleHBsaWNpdGx5IHNldCBpcyBgWydzZWxmJ11gIGFsbG93aW5nIG9ubHlcblx0ICAgKiBzYW1lIG9yaWdpbiByZXNvdXJjZSByZXF1ZXN0cy5cblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFNldHMvR2V0cyB0aGUgd2hpdGVsaXN0IG9mIHRydXN0ZWQgcmVzb3VyY2UgVVJMcy5cblx0ICAgKi9cblx0ICB0aGlzLnJlc291cmNlVXJsV2hpdGVsaXN0ID0gZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoKSB7XG5cdCAgICAgIHJlc291cmNlVXJsV2hpdGVsaXN0ID0gYWRqdXN0TWF0Y2hlcnModmFsdWUpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIHJlc291cmNlVXJsV2hpdGVsaXN0O1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkc2NlRGVsZWdhdGVQcm92aWRlciNyZXNvdXJjZVVybEJsYWNrbGlzdFxuXHQgICAqIEBraW5kIGZ1bmN0aW9uXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge0FycmF5PX0gYmxhY2tsaXN0IFdoZW4gcHJvdmlkZWQsIHJlcGxhY2VzIHRoZSByZXNvdXJjZVVybEJsYWNrbGlzdCB3aXRoIHRoZSB2YWx1ZVxuXHQgICAqICAgIHByb3ZpZGVkLiAgVGhpcyBtdXN0IGJlIGFuIGFycmF5IG9yIG51bGwuICBBIHNuYXBzaG90IG9mIHRoaXMgYXJyYXkgaXMgdXNlZCBzbyBmdXJ0aGVyXG5cdCAgICogICAgY2hhbmdlcyB0byB0aGUgYXJyYXkgYXJlIGlnbm9yZWQuXG5cdCAgICpcblx0ICAgKiAgICBGb2xsb3cge0BsaW5rIG5nLiRzY2UjcmVzb3VyY2VVcmxQYXR0ZXJuSXRlbSB0aGlzIGxpbmt9IGZvciBhIGRlc2NyaXB0aW9uIG9mIHRoZSBpdGVtc1xuXHQgICAqICAgIGFsbG93ZWQgaW4gdGhpcyBhcnJheS5cblx0ICAgKlxuXHQgICAqICAgIFRoZSB0eXBpY2FsIHVzYWdlIGZvciB0aGUgYmxhY2tsaXN0IGlzIHRvICoqYmxvY2tcblx0ICAgKiAgICBbb3BlbiByZWRpcmVjdHNdKGh0dHA6Ly9jd2UubWl0cmUub3JnL2RhdGEvZGVmaW5pdGlvbnMvNjAxLmh0bWwpKiogc2VydmVkIGJ5IHlvdXIgZG9tYWluIGFzXG5cdCAgICogICAgdGhlc2Ugd291bGQgb3RoZXJ3aXNlIGJlIHRydXN0ZWQgYnV0IGFjdHVhbGx5IHJldHVybiBjb250ZW50IGZyb20gdGhlIHJlZGlyZWN0ZWQgZG9tYWluLlxuXHQgICAqXG5cdCAgICogICAgRmluYWxseSwgKip0aGUgYmxhY2tsaXN0IG92ZXJyaWRlcyB0aGUgd2hpdGVsaXN0KiogYW5kIGhhcyB0aGUgZmluYWwgc2F5LlxuXHQgICAqXG5cdCAgICogQHJldHVybiB7QXJyYXl9IHRoZSBjdXJyZW50bHkgc2V0IGJsYWNrbGlzdCBhcnJheS5cblx0ICAgKlxuXHQgICAqIFRoZSAqKmRlZmF1bHQgdmFsdWUqKiB3aGVuIG5vIHdoaXRlbGlzdCBoYXMgYmVlbiBleHBsaWNpdGx5IHNldCBpcyB0aGUgZW1wdHkgYXJyYXkgKGkuZS4gdGhlcmVcblx0ICAgKiBpcyBubyBibGFja2xpc3QuKVxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogU2V0cy9HZXRzIHRoZSBibGFja2xpc3Qgb2YgdHJ1c3RlZCByZXNvdXJjZSBVUkxzLlxuXHQgICAqL1xuXHRcblx0ICB0aGlzLnJlc291cmNlVXJsQmxhY2tsaXN0ID0gZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoKSB7XG5cdCAgICAgIHJlc291cmNlVXJsQmxhY2tsaXN0ID0gYWRqdXN0TWF0Y2hlcnModmFsdWUpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIHJlc291cmNlVXJsQmxhY2tsaXN0O1xuXHQgIH07XG5cdFxuXHQgIHRoaXMuJGdldCA9IFsnJGluamVjdG9yJywgZnVuY3Rpb24oJGluamVjdG9yKSB7XG5cdFxuXHQgICAgdmFyIGh0bWxTYW5pdGl6ZXIgPSBmdW5jdGlvbiBodG1sU2FuaXRpemVyKGh0bWwpIHtcblx0ICAgICAgdGhyb3cgJHNjZU1pbkVycigndW5zYWZlJywgJ0F0dGVtcHRpbmcgdG8gdXNlIGFuIHVuc2FmZSB2YWx1ZSBpbiBhIHNhZmUgY29udGV4dC4nKTtcblx0ICAgIH07XG5cdFxuXHQgICAgaWYgKCRpbmplY3Rvci5oYXMoJyRzYW5pdGl6ZScpKSB7XG5cdCAgICAgIGh0bWxTYW5pdGl6ZXIgPSAkaW5qZWN0b3IuZ2V0KCckc2FuaXRpemUnKTtcblx0ICAgIH1cblx0XG5cdFxuXHQgICAgZnVuY3Rpb24gbWF0Y2hVcmwobWF0Y2hlciwgcGFyc2VkVXJsKSB7XG5cdCAgICAgIGlmIChtYXRjaGVyID09PSAnc2VsZicpIHtcblx0ICAgICAgICByZXR1cm4gdXJsSXNTYW1lT3JpZ2luKHBhcnNlZFVybCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgLy8gZGVmaW5pdGVseSBhIHJlZ2V4LiAgU2VlIGFkanVzdE1hdGNoZXJzKClcblx0ICAgICAgICByZXR1cm4gISFtYXRjaGVyLmV4ZWMocGFyc2VkVXJsLmhyZWYpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gaXNSZXNvdXJjZVVybEFsbG93ZWRCeVBvbGljeSh1cmwpIHtcblx0ICAgICAgdmFyIHBhcnNlZFVybCA9IHVybFJlc29sdmUodXJsLnRvU3RyaW5nKCkpO1xuXHQgICAgICB2YXIgaSwgbiwgYWxsb3dlZCA9IGZhbHNlO1xuXHQgICAgICAvLyBFbnN1cmUgdGhhdCBhdCBsZWFzdCBvbmUgaXRlbSBmcm9tIHRoZSB3aGl0ZWxpc3QgYWxsb3dzIHRoaXMgdXJsLlxuXHQgICAgICBmb3IgKGkgPSAwLCBuID0gcmVzb3VyY2VVcmxXaGl0ZWxpc3QubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG5cdCAgICAgICAgaWYgKG1hdGNoVXJsKHJlc291cmNlVXJsV2hpdGVsaXN0W2ldLCBwYXJzZWRVcmwpKSB7XG5cdCAgICAgICAgICBhbGxvd2VkID0gdHJ1ZTtcblx0ICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICBpZiAoYWxsb3dlZCkge1xuXHQgICAgICAgIC8vIEVuc3VyZSB0aGF0IG5vIGl0ZW0gZnJvbSB0aGUgYmxhY2tsaXN0IGJsb2NrZWQgdGhpcyB1cmwuXG5cdCAgICAgICAgZm9yIChpID0gMCwgbiA9IHJlc291cmNlVXJsQmxhY2tsaXN0Lmxlbmd0aDsgaSA8IG47IGkrKykge1xuXHQgICAgICAgICAgaWYgKG1hdGNoVXJsKHJlc291cmNlVXJsQmxhY2tsaXN0W2ldLCBwYXJzZWRVcmwpKSB7XG5cdCAgICAgICAgICAgIGFsbG93ZWQgPSBmYWxzZTtcblx0ICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBhbGxvd2VkO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGdlbmVyYXRlSG9sZGVyVHlwZShCYXNlKSB7XG5cdCAgICAgIHZhciBob2xkZXJUeXBlID0gZnVuY3Rpb24gVHJ1c3RlZFZhbHVlSG9sZGVyVHlwZSh0cnVzdGVkVmFsdWUpIHtcblx0ICAgICAgICB0aGlzLiQkdW53cmFwVHJ1c3RlZFZhbHVlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICByZXR1cm4gdHJ1c3RlZFZhbHVlO1xuXHQgICAgICAgIH07XG5cdCAgICAgIH07XG5cdCAgICAgIGlmIChCYXNlKSB7XG5cdCAgICAgICAgaG9sZGVyVHlwZS5wcm90b3R5cGUgPSBuZXcgQmFzZSgpO1xuXHQgICAgICB9XG5cdCAgICAgIGhvbGRlclR5cGUucHJvdG90eXBlLnZhbHVlT2YgPSBmdW5jdGlvbiBzY2VWYWx1ZU9mKCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCk7XG5cdCAgICAgIH07XG5cdCAgICAgIGhvbGRlclR5cGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gc2NlVG9TdHJpbmcoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuJCR1bndyYXBUcnVzdGVkVmFsdWUoKS50b1N0cmluZygpO1xuXHQgICAgICB9O1xuXHQgICAgICByZXR1cm4gaG9sZGVyVHlwZTtcblx0ICAgIH1cblx0XG5cdCAgICB2YXIgdHJ1c3RlZFZhbHVlSG9sZGVyQmFzZSA9IGdlbmVyYXRlSG9sZGVyVHlwZSgpLFxuXHQgICAgICAgIGJ5VHlwZSA9IHt9O1xuXHRcblx0ICAgIGJ5VHlwZVtTQ0VfQ09OVEVYVFMuSFRNTF0gPSBnZW5lcmF0ZUhvbGRlclR5cGUodHJ1c3RlZFZhbHVlSG9sZGVyQmFzZSk7XG5cdCAgICBieVR5cGVbU0NFX0NPTlRFWFRTLkNTU10gPSBnZW5lcmF0ZUhvbGRlclR5cGUodHJ1c3RlZFZhbHVlSG9sZGVyQmFzZSk7XG5cdCAgICBieVR5cGVbU0NFX0NPTlRFWFRTLlVSTF0gPSBnZW5lcmF0ZUhvbGRlclR5cGUodHJ1c3RlZFZhbHVlSG9sZGVyQmFzZSk7XG5cdCAgICBieVR5cGVbU0NFX0NPTlRFWFRTLkpTXSA9IGdlbmVyYXRlSG9sZGVyVHlwZSh0cnVzdGVkVmFsdWVIb2xkZXJCYXNlKTtcblx0ICAgIGJ5VHlwZVtTQ0VfQ09OVEVYVFMuUkVTT1VSQ0VfVVJMXSA9IGdlbmVyYXRlSG9sZGVyVHlwZShieVR5cGVbU0NFX0NPTlRFWFRTLlVSTF0pO1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICogQG5hbWUgJHNjZURlbGVnYXRlI3RydXN0QXNcblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFJldHVybnMgYW4gb2JqZWN0IHRoYXQgaXMgdHJ1c3RlZCBieSBhbmd1bGFyIGZvciB1c2UgaW4gc3BlY2lmaWVkIHN0cmljdFxuXHQgICAgICogY29udGV4dHVhbCBlc2NhcGluZyBjb250ZXh0cyAoc3VjaCBhcyBuZy1iaW5kLWh0bWwsIG5nLWluY2x1ZGUsIGFueSBzcmNcblx0ICAgICAqIGF0dHJpYnV0ZSBpbnRlcnBvbGF0aW9uLCBhbnkgZG9tIGV2ZW50IGJpbmRpbmcgYXR0cmlidXRlIGludGVycG9sYXRpb25cblx0ICAgICAqIHN1Y2ggYXMgZm9yIG9uY2xpY2ssICBldGMuKSB0aGF0IHVzZXMgdGhlIHByb3ZpZGVkIHZhbHVlLlxuXHQgICAgICogU2VlIHtAbGluayBuZy4kc2NlICRzY2V9IGZvciBlbmFibGluZyBzdHJpY3QgY29udGV4dHVhbCBlc2NhcGluZy5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBUaGUga2luZCBvZiBjb250ZXh0IGluIHdoaWNoIHRoaXMgdmFsdWUgaXMgc2FmZSBmb3IgdXNlLiAgZS5nLiB1cmwsXG5cdCAgICAgKiAgIHJlc291cmNlVXJsLCBodG1sLCBqcyBhbmQgY3NzLlxuXHQgICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdGhhdCB0aGF0IHNob3VsZCBiZSBjb25zaWRlcmVkIHRydXN0ZWQvc2FmZS5cblx0ICAgICAqIEByZXR1cm5zIHsqfSBBIHZhbHVlIHRoYXQgY2FuIGJlIHVzZWQgdG8gc3RhbmQgaW4gZm9yIHRoZSBwcm92aWRlZCBgdmFsdWVgIGluIHBsYWNlc1xuXHQgICAgICogd2hlcmUgQW5ndWxhciBleHBlY3RzIGEgJHNjZS50cnVzdEFzKCkgcmV0dXJuIHZhbHVlLlxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiB0cnVzdEFzKHR5cGUsIHRydXN0ZWRWYWx1ZSkge1xuXHQgICAgICB2YXIgQ29uc3RydWN0b3IgPSAoYnlUeXBlLmhhc093blByb3BlcnR5KHR5cGUpID8gYnlUeXBlW3R5cGVdIDogbnVsbCk7XG5cdCAgICAgIGlmICghQ29uc3RydWN0b3IpIHtcblx0ICAgICAgICB0aHJvdyAkc2NlTWluRXJyKCdpY29udGV4dCcsXG5cdCAgICAgICAgICAgICdBdHRlbXB0ZWQgdG8gdHJ1c3QgYSB2YWx1ZSBpbiBpbnZhbGlkIGNvbnRleHQuIENvbnRleHQ6IHswfTsgVmFsdWU6IHsxfScsXG5cdCAgICAgICAgICAgIHR5cGUsIHRydXN0ZWRWYWx1ZSk7XG5cdCAgICAgIH1cblx0ICAgICAgaWYgKHRydXN0ZWRWYWx1ZSA9PT0gbnVsbCB8fCBpc1VuZGVmaW5lZCh0cnVzdGVkVmFsdWUpIHx8IHRydXN0ZWRWYWx1ZSA9PT0gJycpIHtcblx0ICAgICAgICByZXR1cm4gdHJ1c3RlZFZhbHVlO1xuXHQgICAgICB9XG5cdCAgICAgIC8vIEFsbCB0aGUgY3VycmVudCBjb250ZXh0cyBpbiBTQ0VfQ09OVEVYVFMgaGFwcGVuIHRvIGJlIHN0cmluZ3MuICBJbiBvcmRlciB0byBhdm9pZCB0cnVzdGluZ1xuXHQgICAgICAvLyBtdXRhYmxlIG9iamVjdHMsIHdlIGVuc3VyZSBoZXJlIHRoYXQgdGhlIHZhbHVlIHBhc3NlZCBpbiBpcyBhY3R1YWxseSBhIHN0cmluZy5cblx0ICAgICAgaWYgKHR5cGVvZiB0cnVzdGVkVmFsdWUgIT09ICdzdHJpbmcnKSB7XG5cdCAgICAgICAgdGhyb3cgJHNjZU1pbkVycignaXR5cGUnLFxuXHQgICAgICAgICAgICAnQXR0ZW1wdGVkIHRvIHRydXN0IGEgbm9uLXN0cmluZyB2YWx1ZSBpbiBhIGNvbnRlbnQgcmVxdWlyaW5nIGEgc3RyaW5nOiBDb250ZXh0OiB7MH0nLFxuXHQgICAgICAgICAgICB0eXBlKTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRydXN0ZWRWYWx1ZSk7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgKiBAbmFtZSAkc2NlRGVsZWdhdGUjdmFsdWVPZlxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogSWYgdGhlIHBhc3NlZCBwYXJhbWV0ZXIgaGFkIGJlZW4gcmV0dXJuZWQgYnkgYSBwcmlvciBjYWxsIHRvIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjdHJ1c3RBc1xuXHQgICAgICogYCRzY2VEZWxlZ2F0ZS50cnVzdEFzYH0sIHJldHVybnMgdGhlIHZhbHVlIHRoYXQgaGFkIGJlZW4gcGFzc2VkIHRvIHtAbGlua1xuXHQgICAgICogbmcuJHNjZURlbGVnYXRlI3RydXN0QXMgYCRzY2VEZWxlZ2F0ZS50cnVzdEFzYH0uXG5cdCAgICAgKlxuXHQgICAgICogSWYgdGhlIHBhc3NlZCBwYXJhbWV0ZXIgaXMgbm90IGEgdmFsdWUgdGhhdCBoYWQgYmVlbiByZXR1cm5lZCBieSB7QGxpbmtcblx0ICAgICAqIG5nLiRzY2VEZWxlZ2F0ZSN0cnVzdEFzIGAkc2NlRGVsZWdhdGUudHJ1c3RBc2B9LCByZXR1cm5zIGl0IGFzLWlzLlxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHJlc3VsdCBvZiBhIHByaW9yIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjdHJ1c3RBcyBgJHNjZURlbGVnYXRlLnRydXN0QXNgfVxuXHQgICAgICogICAgICBjYWxsIG9yIGFueXRoaW5nIGVsc2UuXG5cdCAgICAgKiBAcmV0dXJucyB7Kn0gVGhlIGB2YWx1ZWAgdGhhdCB3YXMgb3JpZ2luYWxseSBwcm92aWRlZCB0byB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI3RydXN0QXNcblx0ICAgICAqICAgICBgJHNjZURlbGVnYXRlLnRydXN0QXNgfSBpZiBgdmFsdWVgIGlzIHRoZSByZXN1bHQgb2Ygc3VjaCBhIGNhbGwuICBPdGhlcndpc2UsIHJldHVybnNcblx0ICAgICAqICAgICBgdmFsdWVgIHVuY2hhbmdlZC5cblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gdmFsdWVPZihtYXliZVRydXN0ZWQpIHtcblx0ICAgICAgaWYgKG1heWJlVHJ1c3RlZCBpbnN0YW5jZW9mIHRydXN0ZWRWYWx1ZUhvbGRlckJhc2UpIHtcblx0ICAgICAgICByZXR1cm4gbWF5YmVUcnVzdGVkLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIG1heWJlVHJ1c3RlZDtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICogQG5hbWUgJHNjZURlbGVnYXRlI2dldFRydXN0ZWRcblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFRha2VzIHRoZSByZXN1bHQgb2YgYSB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI3RydXN0QXMgYCRzY2VEZWxlZ2F0ZS50cnVzdEFzYH0gY2FsbCBhbmRcblx0ICAgICAqIHJldHVybnMgdGhlIG9yaWdpbmFsbHkgc3VwcGxpZWQgdmFsdWUgaWYgdGhlIHF1ZXJpZWQgY29udGV4dCB0eXBlIGlzIGEgc3VwZXJ0eXBlIG9mIHRoZVxuXHQgICAgICogY3JlYXRlZCB0eXBlLiAgSWYgdGhpcyBjb25kaXRpb24gaXNuJ3Qgc2F0aXNmaWVkLCB0aHJvd3MgYW4gZXhjZXB0aW9uLlxuXHQgICAgICpcblx0ICAgICAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1kYW5nZXJcIj5cblx0ICAgICAqIERpc2FibGluZyBhdXRvLWVzY2FwaW5nIGlzIGV4dHJlbWVseSBkYW5nZXJvdXMsIGl0IHVzdWFsbHkgY3JlYXRlcyBhIENyb3NzIFNpdGUgU2NyaXB0aW5nXG5cdCAgICAgKiAoWFNTKSB2dWxuZXJhYmlsaXR5IGluIHlvdXIgYXBwbGljYXRpb24uXG5cdCAgICAgKiA8L2Rpdj5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBUaGUga2luZCBvZiBjb250ZXh0IGluIHdoaWNoIHRoaXMgdmFsdWUgaXMgdG8gYmUgdXNlZC5cblx0ICAgICAqIEBwYXJhbSB7Kn0gbWF5YmVUcnVzdGVkIFRoZSByZXN1bHQgb2YgYSBwcmlvciB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI3RydXN0QXNcblx0ICAgICAqICAgICBgJHNjZURlbGVnYXRlLnRydXN0QXNgfSBjYWxsLlxuXHQgICAgICogQHJldHVybnMgeyp9IFRoZSB2YWx1ZSB0aGUgd2FzIG9yaWdpbmFsbHkgcHJvdmlkZWQgdG8ge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZSN0cnVzdEFzXG5cdCAgICAgKiAgICAgYCRzY2VEZWxlZ2F0ZS50cnVzdEFzYH0gaWYgdmFsaWQgaW4gdGhpcyBjb250ZXh0LiAgT3RoZXJ3aXNlLCB0aHJvd3MgYW4gZXhjZXB0aW9uLlxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBnZXRUcnVzdGVkKHR5cGUsIG1heWJlVHJ1c3RlZCkge1xuXHQgICAgICBpZiAobWF5YmVUcnVzdGVkID09PSBudWxsIHx8IGlzVW5kZWZpbmVkKG1heWJlVHJ1c3RlZCkgfHwgbWF5YmVUcnVzdGVkID09PSAnJykge1xuXHQgICAgICAgIHJldHVybiBtYXliZVRydXN0ZWQ7XG5cdCAgICAgIH1cblx0ICAgICAgdmFyIGNvbnN0cnVjdG9yID0gKGJ5VHlwZS5oYXNPd25Qcm9wZXJ0eSh0eXBlKSA/IGJ5VHlwZVt0eXBlXSA6IG51bGwpO1xuXHQgICAgICBpZiAoY29uc3RydWN0b3IgJiYgbWF5YmVUcnVzdGVkIGluc3RhbmNlb2YgY29uc3RydWN0b3IpIHtcblx0ICAgICAgICByZXR1cm4gbWF5YmVUcnVzdGVkLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCk7XG5cdCAgICAgIH1cblx0ICAgICAgLy8gSWYgd2UgZ2V0IGhlcmUsIHRoZW4gd2UgbWF5IG9ubHkgdGFrZSBvbmUgb2YgdHdvIGFjdGlvbnMuXG5cdCAgICAgIC8vIDEuIHNhbml0aXplIHRoZSB2YWx1ZSBmb3IgdGhlIHJlcXVlc3RlZCB0eXBlLCBvclxuXHQgICAgICAvLyAyLiB0aHJvdyBhbiBleGNlcHRpb24uXG5cdCAgICAgIGlmICh0eXBlID09PSBTQ0VfQ09OVEVYVFMuUkVTT1VSQ0VfVVJMKSB7XG5cdCAgICAgICAgaWYgKGlzUmVzb3VyY2VVcmxBbGxvd2VkQnlQb2xpY3kobWF5YmVUcnVzdGVkKSkge1xuXHQgICAgICAgICAgcmV0dXJuIG1heWJlVHJ1c3RlZDtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgdGhyb3cgJHNjZU1pbkVycignaW5zZWN1cmwnLFxuXHQgICAgICAgICAgICAgICdCbG9ja2VkIGxvYWRpbmcgcmVzb3VyY2UgZnJvbSB1cmwgbm90IGFsbG93ZWQgYnkgJHNjZURlbGVnYXRlIHBvbGljeS4gIFVSTDogezB9Jyxcblx0ICAgICAgICAgICAgICBtYXliZVRydXN0ZWQudG9TdHJpbmcoKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFNDRV9DT05URVhUUy5IVE1MKSB7XG5cdCAgICAgICAgcmV0dXJuIGh0bWxTYW5pdGl6ZXIobWF5YmVUcnVzdGVkKTtcblx0ICAgICAgfVxuXHQgICAgICB0aHJvdyAkc2NlTWluRXJyKCd1bnNhZmUnLCAnQXR0ZW1wdGluZyB0byB1c2UgYW4gdW5zYWZlIHZhbHVlIGluIGEgc2FmZSBjb250ZXh0LicpO1xuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiB7IHRydXN0QXM6IHRydXN0QXMsXG5cdCAgICAgICAgICAgICBnZXRUcnVzdGVkOiBnZXRUcnVzdGVkLFxuXHQgICAgICAgICAgICAgdmFsdWVPZjogdmFsdWVPZiB9O1xuXHQgIH1dO1xuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBwcm92aWRlclxuXHQgKiBAbmFtZSAkc2NlUHJvdmlkZXJcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqXG5cdCAqIFRoZSAkc2NlUHJvdmlkZXIgcHJvdmlkZXIgYWxsb3dzIGRldmVsb3BlcnMgdG8gY29uZmlndXJlIHRoZSB7QGxpbmsgbmcuJHNjZSAkc2NlfSBzZXJ2aWNlLlxuXHQgKiAtICAgZW5hYmxlL2Rpc2FibGUgU3RyaWN0IENvbnRleHR1YWwgRXNjYXBpbmcgKFNDRSkgaW4gYSBtb2R1bGVcblx0ICogLSAgIG92ZXJyaWRlIHRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHdpdGggYSBjdXN0b20gZGVsZWdhdGVcblx0ICpcblx0ICogUmVhZCBtb3JlIGFib3V0IHtAbGluayBuZy4kc2NlIFN0cmljdCBDb250ZXh0dWFsIEVzY2FwaW5nIChTQ0UpfS5cblx0ICovXG5cdFxuXHQvKiBqc2hpbnQgbWF4bGVuOiBmYWxzZSovXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHNlcnZpY2Vcblx0ICogQG5hbWUgJHNjZVxuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogYCRzY2VgIGlzIGEgc2VydmljZSB0aGF0IHByb3ZpZGVzIFN0cmljdCBDb250ZXh0dWFsIEVzY2FwaW5nIHNlcnZpY2VzIHRvIEFuZ3VsYXJKUy5cblx0ICpcblx0ICogIyBTdHJpY3QgQ29udGV4dHVhbCBFc2NhcGluZ1xuXHQgKlxuXHQgKiBTdHJpY3QgQ29udGV4dHVhbCBFc2NhcGluZyAoU0NFKSBpcyBhIG1vZGUgaW4gd2hpY2ggQW5ndWxhckpTIHJlcXVpcmVzIGJpbmRpbmdzIGluIGNlcnRhaW5cblx0ICogY29udGV4dHMgdG8gcmVzdWx0IGluIGEgdmFsdWUgdGhhdCBpcyBtYXJrZWQgYXMgc2FmZSB0byB1c2UgZm9yIHRoYXQgY29udGV4dC4gIE9uZSBleGFtcGxlIG9mXG5cdCAqIHN1Y2ggYSBjb250ZXh0IGlzIGJpbmRpbmcgYXJiaXRyYXJ5IGh0bWwgY29udHJvbGxlZCBieSB0aGUgdXNlciB2aWEgYG5nLWJpbmQtaHRtbGAuICBXZSByZWZlclxuXHQgKiB0byB0aGVzZSBjb250ZXh0cyBhcyBwcml2aWxlZ2VkIG9yIFNDRSBjb250ZXh0cy5cblx0ICpcblx0ICogQXMgb2YgdmVyc2lvbiAxLjIsIEFuZ3VsYXIgc2hpcHMgd2l0aCBTQ0UgZW5hYmxlZCBieSBkZWZhdWx0LlxuXHQgKlxuXHQgKiBOb3RlOiAgV2hlbiBlbmFibGVkICh0aGUgZGVmYXVsdCksIElFPDExIGluIHF1aXJrcyBtb2RlIGlzIG5vdCBzdXBwb3J0ZWQuICBJbiB0aGlzIG1vZGUsIElFPDExIGFsbG93XG5cdCAqIG9uZSB0byBleGVjdXRlIGFyYml0cmFyeSBqYXZhc2NyaXB0IGJ5IHRoZSB1c2Ugb2YgdGhlIGV4cHJlc3Npb24oKSBzeW50YXguICBSZWZlclxuXHQgKiA8aHR0cDovL2Jsb2dzLm1zZG4uY29tL2IvaWUvYXJjaGl2ZS8yMDA4LzEwLzE2L2VuZGluZy1leHByZXNzaW9ucy5hc3B4PiB0byBsZWFybiBtb3JlIGFib3V0IHRoZW0uXG5cdCAqIFlvdSBjYW4gZW5zdXJlIHlvdXIgZG9jdW1lbnQgaXMgaW4gc3RhbmRhcmRzIG1vZGUgYW5kIG5vdCBxdWlya3MgbW9kZSBieSBhZGRpbmcgYDwhZG9jdHlwZSBodG1sPmBcblx0ICogdG8gdGhlIHRvcCBvZiB5b3VyIEhUTUwgZG9jdW1lbnQuXG5cdCAqXG5cdCAqIFNDRSBhc3Npc3RzIGluIHdyaXRpbmcgY29kZSBpbiB3YXkgdGhhdCAoYSkgaXMgc2VjdXJlIGJ5IGRlZmF1bHQgYW5kIChiKSBtYWtlcyBhdWRpdGluZyBmb3Jcblx0ICogc2VjdXJpdHkgdnVsbmVyYWJpbGl0aWVzIHN1Y2ggYXMgWFNTLCBjbGlja2phY2tpbmcsIGV0Yy4gYSBsb3QgZWFzaWVyLlxuXHQgKlxuXHQgKiBIZXJlJ3MgYW4gZXhhbXBsZSBvZiBhIGJpbmRpbmcgaW4gYSBwcml2aWxlZ2VkIGNvbnRleHQ6XG5cdCAqXG5cdCAqIGBgYFxuXHQgKiA8aW5wdXQgbmctbW9kZWw9XCJ1c2VySHRtbFwiIGFyaWEtbGFiZWw9XCJVc2VyIGlucHV0XCI+XG5cdCAqIDxkaXYgbmctYmluZC1odG1sPVwidXNlckh0bWxcIj48L2Rpdj5cblx0ICogYGBgXG5cdCAqXG5cdCAqIE5vdGljZSB0aGF0IGBuZy1iaW5kLWh0bWxgIGlzIGJvdW5kIHRvIGB1c2VySHRtbGAgY29udHJvbGxlZCBieSB0aGUgdXNlci4gIFdpdGggU0NFXG5cdCAqIGRpc2FibGVkLCB0aGlzIGFwcGxpY2F0aW9uIGFsbG93cyB0aGUgdXNlciB0byByZW5kZXIgYXJiaXRyYXJ5IEhUTUwgaW50byB0aGUgRElWLlxuXHQgKiBJbiBhIG1vcmUgcmVhbGlzdGljIGV4YW1wbGUsIG9uZSBtYXkgYmUgcmVuZGVyaW5nIHVzZXIgY29tbWVudHMsIGJsb2cgYXJ0aWNsZXMsIGV0Yy4gdmlhXG5cdCAqIGJpbmRpbmdzLiAgKEhUTUwgaXMganVzdCBvbmUgZXhhbXBsZSBvZiBhIGNvbnRleHQgd2hlcmUgcmVuZGVyaW5nIHVzZXIgY29udHJvbGxlZCBpbnB1dCBjcmVhdGVzXG5cdCAqIHNlY3VyaXR5IHZ1bG5lcmFiaWxpdGllcy4pXG5cdCAqXG5cdCAqIEZvciB0aGUgY2FzZSBvZiBIVE1MLCB5b3UgbWlnaHQgdXNlIGEgbGlicmFyeSwgZWl0aGVyIG9uIHRoZSBjbGllbnQgc2lkZSwgb3Igb24gdGhlIHNlcnZlciBzaWRlLFxuXHQgKiB0byBzYW5pdGl6ZSB1bnNhZmUgSFRNTCBiZWZvcmUgYmluZGluZyB0byB0aGUgdmFsdWUgYW5kIHJlbmRlcmluZyBpdCBpbiB0aGUgZG9jdW1lbnQuXG5cdCAqXG5cdCAqIEhvdyB3b3VsZCB5b3UgZW5zdXJlIHRoYXQgZXZlcnkgcGxhY2UgdGhhdCB1c2VkIHRoZXNlIHR5cGVzIG9mIGJpbmRpbmdzIHdhcyBib3VuZCB0byBhIHZhbHVlIHRoYXRcblx0ICogd2FzIHNhbml0aXplZCBieSB5b3VyIGxpYnJhcnkgKG9yIHJldHVybmVkIGFzIHNhZmUgZm9yIHJlbmRlcmluZyBieSB5b3VyIHNlcnZlcj8pICBIb3cgY2FuIHlvdVxuXHQgKiBlbnN1cmUgdGhhdCB5b3UgZGlkbid0IGFjY2lkZW50YWxseSBkZWxldGUgdGhlIGxpbmUgdGhhdCBzYW5pdGl6ZWQgdGhlIHZhbHVlLCBvciByZW5hbWVkIHNvbWVcblx0ICogcHJvcGVydGllcy9maWVsZHMgYW5kIGZvcmdvdCB0byB1cGRhdGUgdGhlIGJpbmRpbmcgdG8gdGhlIHNhbml0aXplZCB2YWx1ZT9cblx0ICpcblx0ICogVG8gYmUgc2VjdXJlIGJ5IGRlZmF1bHQsIHlvdSB3YW50IHRvIGVuc3VyZSB0aGF0IGFueSBzdWNoIGJpbmRpbmdzIGFyZSBkaXNhbGxvd2VkIHVubGVzcyB5b3UgY2FuXG5cdCAqIGRldGVybWluZSB0aGF0IHNvbWV0aGluZyBleHBsaWNpdGx5IHNheXMgaXQncyBzYWZlIHRvIHVzZSBhIHZhbHVlIGZvciBiaW5kaW5nIGluIHRoYXRcblx0ICogY29udGV4dC4gIFlvdSBjYW4gdGhlbiBhdWRpdCB5b3VyIGNvZGUgKGEgc2ltcGxlIGdyZXAgd291bGQgZG8pIHRvIGVuc3VyZSB0aGF0IHRoaXMgaXMgb25seSBkb25lXG5cdCAqIGZvciB0aG9zZSB2YWx1ZXMgdGhhdCB5b3UgY2FuIGVhc2lseSB0ZWxsIGFyZSBzYWZlIC0gYmVjYXVzZSB0aGV5IHdlcmUgcmVjZWl2ZWQgZnJvbSB5b3VyIHNlcnZlcixcblx0ICogc2FuaXRpemVkIGJ5IHlvdXIgbGlicmFyeSwgZXRjLiAgWW91IGNhbiBvcmdhbml6ZSB5b3VyIGNvZGViYXNlIHRvIGhlbHAgd2l0aCB0aGlzIC0gcGVyaGFwc1xuXHQgKiBhbGxvd2luZyBvbmx5IHRoZSBmaWxlcyBpbiBhIHNwZWNpZmljIGRpcmVjdG9yeSB0byBkbyB0aGlzLiAgRW5zdXJpbmcgdGhhdCB0aGUgaW50ZXJuYWwgQVBJXG5cdCAqIGV4cG9zZWQgYnkgdGhhdCBjb2RlIGRvZXNuJ3QgbWFya3VwIGFyYml0cmFyeSB2YWx1ZXMgYXMgc2FmZSB0aGVuIGJlY29tZXMgYSBtb3JlIG1hbmFnZWFibGUgdGFzay5cblx0ICpcblx0ICogSW4gdGhlIGNhc2Ugb2YgQW5ndWxhckpTJyBTQ0Ugc2VydmljZSwgb25lIHVzZXMge0BsaW5rIG5nLiRzY2UjdHJ1c3RBcyAkc2NlLnRydXN0QXN9XG5cdCAqIChhbmQgc2hvcnRoYW5kIG1ldGhvZHMgc3VjaCBhcyB7QGxpbmsgbmcuJHNjZSN0cnVzdEFzSHRtbCAkc2NlLnRydXN0QXNIdG1sfSwgZXRjLikgdG9cblx0ICogb2J0YWluIHZhbHVlcyB0aGF0IHdpbGwgYmUgYWNjZXB0ZWQgYnkgU0NFIC8gcHJpdmlsZWdlZCBjb250ZXh0cy5cblx0ICpcblx0ICpcblx0ICogIyMgSG93IGRvZXMgaXQgd29yaz9cblx0ICpcblx0ICogSW4gcHJpdmlsZWdlZCBjb250ZXh0cywgZGlyZWN0aXZlcyBhbmQgY29kZSB3aWxsIGJpbmQgdG8gdGhlIHJlc3VsdCBvZiB7QGxpbmsgbmcuJHNjZSNnZXRUcnVzdGVkXG5cdCAqICRzY2UuZ2V0VHJ1c3RlZChjb250ZXh0LCB2YWx1ZSl9IHJhdGhlciB0aGFuIHRvIHRoZSB2YWx1ZSBkaXJlY3RseS4gIERpcmVjdGl2ZXMgdXNlIHtAbGlua1xuXHQgKiBuZy4kc2NlI3BhcnNlQXMgJHNjZS5wYXJzZUFzfSByYXRoZXIgdGhhbiBgJHBhcnNlYCB0byB3YXRjaCBhdHRyaWJ1dGUgYmluZGluZ3MsIHdoaWNoIHBlcmZvcm1zIHRoZVxuXHQgKiB7QGxpbmsgbmcuJHNjZSNnZXRUcnVzdGVkICRzY2UuZ2V0VHJ1c3RlZH0gYmVoaW5kIHRoZSBzY2VuZXMgb24gbm9uLWNvbnN0YW50IGxpdGVyYWxzLlxuXHQgKlxuXHQgKiBBcyBhbiBleGFtcGxlLCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nQmluZEh0bWwgbmdCaW5kSHRtbH0gdXNlcyB7QGxpbmtcblx0ICogbmcuJHNjZSNwYXJzZUFzSHRtbCAkc2NlLnBhcnNlQXNIdG1sKGJpbmRpbmcgZXhwcmVzc2lvbil9LiAgSGVyZSdzIHRoZSBhY3R1YWwgY29kZSAoc2xpZ2h0bHlcblx0ICogc2ltcGxpZmllZCk6XG5cdCAqXG5cdCAqIGBgYFxuXHQgKiB2YXIgbmdCaW5kSHRtbERpcmVjdGl2ZSA9IFsnJHNjZScsIGZ1bmN0aW9uKCRzY2UpIHtcblx0ICogICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcblx0ICogICAgIHNjb3BlLiR3YXRjaCgkc2NlLnBhcnNlQXNIdG1sKGF0dHIubmdCaW5kSHRtbCksIGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAqICAgICAgIGVsZW1lbnQuaHRtbCh2YWx1ZSB8fCAnJyk7XG5cdCAqICAgICB9KTtcblx0ICogICB9O1xuXHQgKiB9XTtcblx0ICogYGBgXG5cdCAqXG5cdCAqICMjIEltcGFjdCBvbiBsb2FkaW5nIHRlbXBsYXRlc1xuXHQgKlxuXHQgKiBUaGlzIGFwcGxpZXMgYm90aCB0byB0aGUge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0luY2x1ZGUgYG5nLWluY2x1ZGVgfSBkaXJlY3RpdmUgYXMgd2VsbCBhc1xuXHQgKiBgdGVtcGxhdGVVcmxgJ3Mgc3BlY2lmaWVkIGJ5IHtAbGluayBndWlkZS9kaXJlY3RpdmUgZGlyZWN0aXZlc30uXG5cdCAqXG5cdCAqIEJ5IGRlZmF1bHQsIEFuZ3VsYXIgb25seSBsb2FkcyB0ZW1wbGF0ZXMgZnJvbSB0aGUgc2FtZSBkb21haW4gYW5kIHByb3RvY29sIGFzIHRoZSBhcHBsaWNhdGlvblxuXHQgKiBkb2N1bWVudC4gIFRoaXMgaXMgZG9uZSBieSBjYWxsaW5nIHtAbGluayBuZy4kc2NlI2dldFRydXN0ZWRSZXNvdXJjZVVybFxuXHQgKiAkc2NlLmdldFRydXN0ZWRSZXNvdXJjZVVybH0gb24gdGhlIHRlbXBsYXRlIFVSTC4gIFRvIGxvYWQgdGVtcGxhdGVzIGZyb20gb3RoZXIgZG9tYWlucyBhbmQvb3Jcblx0ICogcHJvdG9jb2xzLCB5b3UgbWF5IGVpdGhlciB7QGxpbmsgbmcuJHNjZURlbGVnYXRlUHJvdmlkZXIjcmVzb3VyY2VVcmxXaGl0ZWxpc3Qgd2hpdGVsaXN0XG5cdCAqIHRoZW19IG9yIHtAbGluayBuZy4kc2NlI3RydXN0QXNSZXNvdXJjZVVybCB3cmFwIGl0fSBpbnRvIGEgdHJ1c3RlZCB2YWx1ZS5cblx0ICpcblx0ICogKlBsZWFzZSBub3RlKjpcblx0ICogVGhlIGJyb3dzZXInc1xuXHQgKiBbU2FtZSBPcmlnaW4gUG9saWN5XShodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Jyb3dzZXJzZWMvd2lraS9QYXJ0MiNTYW1lLW9yaWdpbl9wb2xpY3lfZm9yX1hNTEh0dHBSZXF1ZXN0KVxuXHQgKiBhbmQgW0Nyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nIChDT1JTKV0oaHR0cDovL3d3dy53My5vcmcvVFIvY29ycy8pXG5cdCAqIHBvbGljeSBhcHBseSBpbiBhZGRpdGlvbiB0byB0aGlzIGFuZCBtYXkgZnVydGhlciByZXN0cmljdCB3aGV0aGVyIHRoZSB0ZW1wbGF0ZSBpcyBzdWNjZXNzZnVsbHlcblx0ICogbG9hZGVkLiAgVGhpcyBtZWFucyB0aGF0IHdpdGhvdXQgdGhlIHJpZ2h0IENPUlMgcG9saWN5LCBsb2FkaW5nIHRlbXBsYXRlcyBmcm9tIGEgZGlmZmVyZW50IGRvbWFpblxuXHQgKiB3b24ndCB3b3JrIG9uIGFsbCBicm93c2Vycy4gIEFsc28sIGxvYWRpbmcgdGVtcGxhdGVzIGZyb20gYGZpbGU6Ly9gIFVSTCBkb2VzIG5vdCB3b3JrIG9uIHNvbWVcblx0ICogYnJvd3NlcnMuXG5cdCAqXG5cdCAqICMjIFRoaXMgZmVlbHMgbGlrZSB0b28gbXVjaCBvdmVyaGVhZFxuXHQgKlxuXHQgKiBJdCdzIGltcG9ydGFudCB0byByZW1lbWJlciB0aGF0IFNDRSBvbmx5IGFwcGxpZXMgdG8gaW50ZXJwb2xhdGlvbiBleHByZXNzaW9ucy5cblx0ICpcblx0ICogSWYgeW91ciBleHByZXNzaW9ucyBhcmUgY29uc3RhbnQgbGl0ZXJhbHMsIHRoZXkncmUgYXV0b21hdGljYWxseSB0cnVzdGVkIGFuZCB5b3UgZG9uJ3QgbmVlZCB0b1xuXHQgKiBjYWxsIGAkc2NlLnRydXN0QXNgIG9uIHRoZW0gKHJlbWVtYmVyIHRvIGluY2x1ZGUgdGhlIGBuZ1Nhbml0aXplYCBtb2R1bGUpIChlLmcuXG5cdCAqIGA8ZGl2IG5nLWJpbmQtaHRtbD1cIic8Yj5pbXBsaWNpdGx5IHRydXN0ZWQ8L2I+J1wiPjwvZGl2PmApIGp1c3Qgd29ya3MuXG5cdCAqXG5cdCAqIEFkZGl0aW9uYWxseSwgYGFbaHJlZl1gIGFuZCBgaW1nW3NyY11gIGF1dG9tYXRpY2FsbHkgc2FuaXRpemUgdGhlaXIgVVJMcyBhbmQgZG8gbm90IHBhc3MgdGhlbVxuXHQgKiB0aHJvdWdoIHtAbGluayBuZy4kc2NlI2dldFRydXN0ZWQgJHNjZS5nZXRUcnVzdGVkfS4gIFNDRSBkb2Vzbid0IHBsYXkgYSByb2xlIGhlcmUuXG5cdCAqXG5cdCAqIFRoZSBpbmNsdWRlZCB7QGxpbmsgbmcuJHNjZURlbGVnYXRlICRzY2VEZWxlZ2F0ZX0gY29tZXMgd2l0aCBzYW5lIGRlZmF1bHRzIHRvIGFsbG93IHlvdSB0byBsb2FkXG5cdCAqIHRlbXBsYXRlcyBpbiBgbmctaW5jbHVkZWAgZnJvbSB5b3VyIGFwcGxpY2F0aW9uJ3MgZG9tYWluIHdpdGhvdXQgaGF2aW5nIHRvIGV2ZW4ga25vdyBhYm91dCBTQ0UuXG5cdCAqIEl0IGJsb2NrcyBsb2FkaW5nIHRlbXBsYXRlcyBmcm9tIG90aGVyIGRvbWFpbnMgb3IgbG9hZGluZyB0ZW1wbGF0ZXMgb3ZlciBodHRwIGZyb20gYW4gaHR0cHNcblx0ICogc2VydmVkIGRvY3VtZW50LiAgWW91IGNhbiBjaGFuZ2UgdGhlc2UgYnkgc2V0dGluZyB5b3VyIG93biBjdXN0b20ge0BsaW5rXG5cdCAqIG5nLiRzY2VEZWxlZ2F0ZVByb3ZpZGVyI3Jlc291cmNlVXJsV2hpdGVsaXN0IHdoaXRlbGlzdHN9IGFuZCB7QGxpbmtcblx0ICogbmcuJHNjZURlbGVnYXRlUHJvdmlkZXIjcmVzb3VyY2VVcmxCbGFja2xpc3QgYmxhY2tsaXN0c30gZm9yIG1hdGNoaW5nIHN1Y2ggVVJMcy5cblx0ICpcblx0ICogVGhpcyBzaWduaWZpY2FudGx5IHJlZHVjZXMgdGhlIG92ZXJoZWFkLiAgSXQgaXMgZmFyIGVhc2llciB0byBwYXkgdGhlIHNtYWxsIG92ZXJoZWFkIGFuZCBoYXZlIGFuXG5cdCAqIGFwcGxpY2F0aW9uIHRoYXQncyBzZWN1cmUgYW5kIGNhbiBiZSBhdWRpdGVkIHRvIHZlcmlmeSB0aGF0IHdpdGggbXVjaCBtb3JlIGVhc2UgdGhhbiBib2x0aW5nXG5cdCAqIHNlY3VyaXR5IG9udG8gYW4gYXBwbGljYXRpb24gbGF0ZXIuXG5cdCAqXG5cdCAqIDxhIG5hbWU9XCJjb250ZXh0c1wiPjwvYT5cblx0ICogIyMgV2hhdCB0cnVzdGVkIGNvbnRleHQgdHlwZXMgYXJlIHN1cHBvcnRlZD9cblx0ICpcblx0ICogfCBDb250ZXh0ICAgICAgICAgICAgIHwgTm90ZXMgICAgICAgICAgfFxuXHQgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS18XG5cdCAqIHwgYCRzY2UuSFRNTGAgICAgICAgICB8IEZvciBIVE1MIHRoYXQncyBzYWZlIHRvIHNvdXJjZSBpbnRvIHRoZSBhcHBsaWNhdGlvbi4gIFRoZSB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nQmluZEh0bWwgbmdCaW5kSHRtbH0gZGlyZWN0aXZlIHVzZXMgdGhpcyBjb250ZXh0IGZvciBiaW5kaW5ncy4gSWYgYW4gdW5zYWZlIHZhbHVlIGlzIGVuY291bnRlcmVkIGFuZCB0aGUge0BsaW5rIG5nU2FuaXRpemUgJHNhbml0aXplfSBtb2R1bGUgaXMgcHJlc2VudCB0aGlzIHdpbGwgc2FuaXRpemUgdGhlIHZhbHVlIGluc3RlYWQgb2YgdGhyb3dpbmcgYW4gZXJyb3IuIHxcblx0ICogfCBgJHNjZS5DU1NgICAgICAgICAgIHwgRm9yIENTUyB0aGF0J3Mgc2FmZSB0byBzb3VyY2UgaW50byB0aGUgYXBwbGljYXRpb24uICBDdXJyZW50bHkgdW51c2VkLiAgRmVlbCBmcmVlIHRvIHVzZSBpdCBpbiB5b3VyIG93biBkaXJlY3RpdmVzLiB8XG5cdCAqIHwgYCRzY2UuVVJMYCAgICAgICAgICB8IEZvciBVUkxzIHRoYXQgYXJlIHNhZmUgdG8gZm9sbG93IGFzIGxpbmtzLiAgQ3VycmVudGx5IHVudXNlZCAoYDxhIGhyZWY9YCBhbmQgYDxpbWcgc3JjPWAgc2FuaXRpemUgdGhlaXIgdXJscyBhbmQgZG9uJ3QgY29uc3RpdHV0ZSBhbiBTQ0UgY29udGV4dC4gfFxuXHQgKiB8IGAkc2NlLlJFU09VUkNFX1VSTGAgfCBGb3IgVVJMcyB0aGF0IGFyZSBub3Qgb25seSBzYWZlIHRvIGZvbGxvdyBhcyBsaW5rcywgYnV0IHdob3NlIGNvbnRlbnRzIGFyZSBhbHNvIHNhZmUgdG8gaW5jbHVkZSBpbiB5b3VyIGFwcGxpY2F0aW9uLiAgRXhhbXBsZXMgaW5jbHVkZSBgbmctaW5jbHVkZWAsIGBzcmNgIC8gYG5nU3JjYCBiaW5kaW5ncyBmb3IgdGFncyBvdGhlciB0aGFuIGBJTUdgIChlLmcuIGBJRlJBTUVgLCBgT0JKRUNUYCwgZXRjLikgIDxicj48YnI+Tm90ZSB0aGF0IGAkc2NlLlJFU09VUkNFX1VSTGAgbWFrZXMgYSBzdHJvbmdlciBzdGF0ZW1lbnQgYWJvdXQgdGhlIFVSTCB0aGFuIGAkc2NlLlVSTGAgZG9lcyBhbmQgdGhlcmVmb3JlIGNvbnRleHRzIHJlcXVpcmluZyB2YWx1ZXMgdHJ1c3RlZCBmb3IgYCRzY2UuUkVTT1VSQ0VfVVJMYCBjYW4gYmUgdXNlZCBhbnl3aGVyZSB0aGF0IHZhbHVlcyB0cnVzdGVkIGZvciBgJHNjZS5VUkxgIGFyZSByZXF1aXJlZC4gfFxuXHQgKiB8IGAkc2NlLkpTYCAgICAgICAgICAgfCBGb3IgSmF2YVNjcmlwdCB0aGF0IGlzIHNhZmUgdG8gZXhlY3V0ZSBpbiB5b3VyIGFwcGxpY2F0aW9uJ3MgY29udGV4dC4gIEN1cnJlbnRseSB1bnVzZWQuICBGZWVsIGZyZWUgdG8gdXNlIGl0IGluIHlvdXIgb3duIGRpcmVjdGl2ZXMuIHxcblx0ICpcblx0ICogIyMgRm9ybWF0IG9mIGl0ZW1zIGluIHtAbGluayBuZy4kc2NlRGVsZWdhdGVQcm92aWRlciNyZXNvdXJjZVVybFdoaXRlbGlzdCByZXNvdXJjZVVybFdoaXRlbGlzdH0ve0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZVByb3ZpZGVyI3Jlc291cmNlVXJsQmxhY2tsaXN0IEJsYWNrbGlzdH0gPGEgbmFtZT1cInJlc291cmNlVXJsUGF0dGVybkl0ZW1cIj48L2E+XG5cdCAqXG5cdCAqICBFYWNoIGVsZW1lbnQgaW4gdGhlc2UgYXJyYXlzIG11c3QgYmUgb25lIG9mIHRoZSBmb2xsb3dpbmc6XG5cdCAqXG5cdCAqICAtICoqJ3NlbGYnKipcblx0ICogICAgLSBUaGUgc3BlY2lhbCAqKnN0cmluZyoqLCBgJ3NlbGYnYCwgY2FuIGJlIHVzZWQgdG8gbWF0Y2ggYWdhaW5zdCBhbGwgVVJMcyBvZiB0aGUgKipzYW1lXG5cdCAqICAgICAgZG9tYWluKiogYXMgdGhlIGFwcGxpY2F0aW9uIGRvY3VtZW50IHVzaW5nIHRoZSAqKnNhbWUgcHJvdG9jb2wqKi5cblx0ICogIC0gKipTdHJpbmcqKiAoZXhjZXB0IHRoZSBzcGVjaWFsIHZhbHVlIGAnc2VsZidgKVxuXHQgKiAgICAtIFRoZSBzdHJpbmcgaXMgbWF0Y2hlZCBhZ2FpbnN0IHRoZSBmdWxsICpub3JtYWxpemVkIC8gYWJzb2x1dGUgVVJMKiBvZiB0aGUgcmVzb3VyY2Vcblx0ICogICAgICBiZWluZyB0ZXN0ZWQgKHN1YnN0cmluZyBtYXRjaGVzIGFyZSBub3QgZ29vZCBlbm91Z2guKVxuXHQgKiAgICAtIFRoZXJlIGFyZSBleGFjdGx5ICoqdHdvIHdpbGRjYXJkIHNlcXVlbmNlcyoqIC0gYCpgIGFuZCBgKipgLiAgQWxsIG90aGVyIGNoYXJhY3RlcnNcblx0ICogICAgICBtYXRjaCB0aGVtc2VsdmVzLlxuXHQgKiAgICAtIGAqYDogbWF0Y2hlcyB6ZXJvIG9yIG1vcmUgb2NjdXJyZW5jZXMgb2YgYW55IGNoYXJhY3RlciBvdGhlciB0aGFuIG9uZSBvZiB0aGUgZm9sbG93aW5nIDZcblx0ICogICAgICBjaGFyYWN0ZXJzOiAnYDpgJywgJ2AvYCcsICdgLmAnLCAnYD9gJywgJ2AmYCcgYW5kICdgO2AnLiAgSXQncyBhIHVzZWZ1bCB3aWxkY2FyZCBmb3IgdXNlXG5cdCAqICAgICAgaW4gYSB3aGl0ZWxpc3QuXG5cdCAqICAgIC0gYCoqYDogbWF0Y2hlcyB6ZXJvIG9yIG1vcmUgb2NjdXJyZW5jZXMgb2YgKmFueSogY2hhcmFjdGVyLiAgQXMgc3VjaCwgaXQncyBub3Rcblx0ICogICAgICBhcHByb3ByaWF0ZSBmb3IgdXNlIGluIGEgc2NoZW1lLCBkb21haW4sIGV0Yy4gYXMgaXQgd291bGQgbWF0Y2ggdG9vIG11Y2guICAoZS5nLlxuXHQgKiAgICAgIGh0dHA6Ly8qKi5leGFtcGxlLmNvbS8gd291bGQgbWF0Y2ggaHR0cDovL2V2aWwuY29tLz9pZ25vcmU9LmV4YW1wbGUuY29tLyBhbmQgdGhhdCBtaWdodFxuXHQgKiAgICAgIG5vdCBoYXZlIGJlZW4gdGhlIGludGVudGlvbi4pICBJdHMgdXNhZ2UgYXQgdGhlIHZlcnkgZW5kIG9mIHRoZSBwYXRoIGlzIG9rLiAgKGUuZy5cblx0ICogICAgICBodHRwOi8vZm9vLmV4YW1wbGUuY29tL3RlbXBsYXRlcy8qKikuXG5cdCAqICAtICoqUmVnRXhwKiogKCpzZWUgY2F2ZWF0IGJlbG93Kilcblx0ICogICAgLSAqQ2F2ZWF0KjogIFdoaWxlIHJlZ3VsYXIgZXhwcmVzc2lvbnMgYXJlIHBvd2VyZnVsIGFuZCBvZmZlciBncmVhdCBmbGV4aWJpbGl0eSwgIHRoZWlyIHN5bnRheFxuXHQgKiAgICAgIChhbmQgYWxsIHRoZSBpbmV2aXRhYmxlIGVzY2FwaW5nKSBtYWtlcyB0aGVtICpoYXJkZXIgdG8gbWFpbnRhaW4qLiAgSXQncyBlYXN5IHRvXG5cdCAqICAgICAgYWNjaWRlbnRhbGx5IGludHJvZHVjZSBhIGJ1ZyB3aGVuIG9uZSB1cGRhdGVzIGEgY29tcGxleCBleHByZXNzaW9uIChpbWhvLCBhbGwgcmVnZXhlcyBzaG91bGRcblx0ICogICAgICBoYXZlIGdvb2QgdGVzdCBjb3ZlcmFnZSkuICBGb3IgaW5zdGFuY2UsIHRoZSB1c2Ugb2YgYC5gIGluIHRoZSByZWdleCBpcyBjb3JyZWN0IG9ubHkgaW4gYVxuXHQgKiAgICAgIHNtYWxsIG51bWJlciBvZiBjYXNlcy4gIEEgYC5gIGNoYXJhY3RlciBpbiB0aGUgcmVnZXggdXNlZCB3aGVuIG1hdGNoaW5nIHRoZSBzY2hlbWUgb3IgYVxuXHQgKiAgICAgIHN1YmRvbWFpbiBjb3VsZCBiZSBtYXRjaGVkIGFnYWluc3QgYSBgOmAgb3IgbGl0ZXJhbCBgLmAgdGhhdCB3YXMgbGlrZWx5IG5vdCBpbnRlbmRlZC4gICBJdFxuXHQgKiAgICAgIGlzIGhpZ2hseSByZWNvbW1lbmRlZCB0byB1c2UgdGhlIHN0cmluZyBwYXR0ZXJucyBhbmQgb25seSBmYWxsIGJhY2sgdG8gcmVndWxhciBleHByZXNzaW9uc1xuXHQgKiAgICAgIGFzIGEgbGFzdCByZXNvcnQuXG5cdCAqICAgIC0gVGhlIHJlZ3VsYXIgZXhwcmVzc2lvbiBtdXN0IGJlIGFuIGluc3RhbmNlIG9mIFJlZ0V4cCAoaS5lLiBub3QgYSBzdHJpbmcuKSAgSXQgaXNcblx0ICogICAgICBtYXRjaGVkIGFnYWluc3QgdGhlICoqZW50aXJlKiogKm5vcm1hbGl6ZWQgLyBhYnNvbHV0ZSBVUkwqIG9mIHRoZSByZXNvdXJjZSBiZWluZyB0ZXN0ZWRcblx0ICogICAgICAoZXZlbiB3aGVuIHRoZSBSZWdFeHAgZGlkIG5vdCBoYXZlIHRoZSBgXmAgYW5kIGAkYCBjb2Rlcy4pICBJbiBhZGRpdGlvbiwgYW55IGZsYWdzXG5cdCAqICAgICAgcHJlc2VudCBvbiB0aGUgUmVnRXhwIChzdWNoIGFzIG11bHRpbGluZSwgZ2xvYmFsLCBpZ25vcmVDYXNlKSBhcmUgaWdub3JlZC5cblx0ICogICAgLSBJZiB5b3UgYXJlIGdlbmVyYXRpbmcgeW91ciBKYXZhU2NyaXB0IGZyb20gc29tZSBvdGhlciB0ZW1wbGF0aW5nIGVuZ2luZSAobm90XG5cdCAqICAgICAgcmVjb21tZW5kZWQsIGUuZy4gaW4gaXNzdWUgWyM0MDA2XShodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL2lzc3Vlcy80MDA2KSksXG5cdCAqICAgICAgcmVtZW1iZXIgdG8gZXNjYXBlIHlvdXIgcmVndWxhciBleHByZXNzaW9uIChhbmQgYmUgYXdhcmUgdGhhdCB5b3UgbWlnaHQgbmVlZCBtb3JlIHRoYW5cblx0ICogICAgICBvbmUgbGV2ZWwgb2YgZXNjYXBpbmcgZGVwZW5kaW5nIG9uIHlvdXIgdGVtcGxhdGluZyBlbmdpbmUgYW5kIHRoZSB3YXkgeW91IGludGVycG9sYXRlZFxuXHQgKiAgICAgIHRoZSB2YWx1ZS4pICBEbyBtYWtlIHVzZSBvZiB5b3VyIHBsYXRmb3JtJ3MgZXNjYXBpbmcgbWVjaGFuaXNtIGFzIGl0IG1pZ2h0IGJlIGdvb2Rcblx0ICogICAgICBlbm91Z2ggYmVmb3JlIGNvZGluZyB5b3VyIG93bi4gIEUuZy4gUnVieSBoYXNcblx0ICogICAgICBbUmVnZXhwLmVzY2FwZShzdHIpXShodHRwOi8vd3d3LnJ1YnktZG9jLm9yZy9jb3JlLTIuMC4wL1JlZ2V4cC5odG1sI21ldGhvZC1jLWVzY2FwZSlcblx0ICogICAgICBhbmQgUHl0aG9uIGhhcyBbcmUuZXNjYXBlXShodHRwOi8vZG9jcy5weXRob24ub3JnL2xpYnJhcnkvcmUuaHRtbCNyZS5lc2NhcGUpLlxuXHQgKiAgICAgIEphdmFzY3JpcHQgbGFja3MgYSBzaW1pbGFyIGJ1aWx0IGluIGZ1bmN0aW9uIGZvciBlc2NhcGluZy4gIFRha2UgYSBsb29rIGF0IEdvb2dsZVxuXHQgKiAgICAgIENsb3N1cmUgbGlicmFyeSdzIFtnb29nLnN0cmluZy5yZWdFeHBFc2NhcGUocyldKFxuXHQgKiAgICAgIGh0dHA6Ly9kb2NzLmNsb3N1cmUtbGlicmFyeS5nb29nbGVjb2RlLmNvbS9naXQvY2xvc3VyZV9nb29nX3N0cmluZ19zdHJpbmcuanMuc291cmNlLmh0bWwjbGluZTk2MikuXG5cdCAqXG5cdCAqIFJlZmVyIHtAbGluayBuZy4kc2NlRGVsZWdhdGVQcm92aWRlciAkc2NlRGVsZWdhdGVQcm92aWRlcn0gZm9yIGFuIGV4YW1wbGUuXG5cdCAqXG5cdCAqICMjIFNob3cgbWUgYW4gZXhhbXBsZSB1c2luZyBTQ0UuXG5cdCAqXG5cdCAqIDxleGFtcGxlIG1vZHVsZT1cIm15U2NlQXBwXCIgZGVwcz1cImFuZ3VsYXItc2FuaXRpemUuanNcIj5cblx0ICogPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICogICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJBcHBDb250cm9sbGVyIGFzIG15Q3RybFwiPlxuXHQgKiAgICAgPGkgbmctYmluZC1odG1sPVwibXlDdHJsLmV4cGxpY2l0bHlUcnVzdGVkSHRtbFwiIGlkPVwiZXhwbGljaXRseVRydXN0ZWRIdG1sXCI+PC9pPjxicj48YnI+XG5cdCAqICAgICA8Yj5Vc2VyIGNvbW1lbnRzPC9iPjxicj5cblx0ICogICAgIEJ5IGRlZmF1bHQsIEhUTUwgdGhhdCBpc24ndCBleHBsaWNpdGx5IHRydXN0ZWQgKGUuZy4gQWxpY2UncyBjb21tZW50KSBpcyBzYW5pdGl6ZWQgd2hlblxuXHQgKiAgICAgJHNhbml0aXplIGlzIGF2YWlsYWJsZS4gIElmICRzYW5pdGl6ZSBpc24ndCBhdmFpbGFibGUsIHRoaXMgcmVzdWx0cyBpbiBhbiBlcnJvciBpbnN0ZWFkIG9mIGFuXG5cdCAqICAgICBleHBsb2l0LlxuXHQgKiAgICAgPGRpdiBjbGFzcz1cIndlbGxcIj5cblx0ICogICAgICAgPGRpdiBuZy1yZXBlYXQ9XCJ1c2VyQ29tbWVudCBpbiBteUN0cmwudXNlckNvbW1lbnRzXCI+XG5cdCAqICAgICAgICAgPGI+e3t1c2VyQ29tbWVudC5uYW1lfX08L2I+OlxuXHQgKiAgICAgICAgIDxzcGFuIG5nLWJpbmQtaHRtbD1cInVzZXJDb21tZW50Lmh0bWxDb21tZW50XCIgY2xhc3M9XCJodG1sQ29tbWVudFwiPjwvc3Bhbj5cblx0ICogICAgICAgICA8YnI+XG5cdCAqICAgICAgIDwvZGl2PlxuXHQgKiAgICAgPC9kaXY+XG5cdCAqICAgPC9kaXY+XG5cdCAqIDwvZmlsZT5cblx0ICpcblx0ICogPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuXHQgKiAgIGFuZ3VsYXIubW9kdWxlKCdteVNjZUFwcCcsIFsnbmdTYW5pdGl6ZSddKVxuXHQgKiAgICAgLmNvbnRyb2xsZXIoJ0FwcENvbnRyb2xsZXInLCBbJyRodHRwJywgJyR0ZW1wbGF0ZUNhY2hlJywgJyRzY2UnLFxuXHQgKiAgICAgICBmdW5jdGlvbigkaHR0cCwgJHRlbXBsYXRlQ2FjaGUsICRzY2UpIHtcblx0ICogICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAqICAgICAgICAgJGh0dHAuZ2V0KFwidGVzdF9kYXRhLmpzb25cIiwge2NhY2hlOiAkdGVtcGxhdGVDYWNoZX0pLnN1Y2Nlc3MoZnVuY3Rpb24odXNlckNvbW1lbnRzKSB7XG5cdCAqICAgICAgICAgICBzZWxmLnVzZXJDb21tZW50cyA9IHVzZXJDb21tZW50cztcblx0ICogICAgICAgICB9KTtcblx0ICogICAgICAgICBzZWxmLmV4cGxpY2l0bHlUcnVzdGVkSHRtbCA9ICRzY2UudHJ1c3RBc0h0bWwoXG5cdCAqICAgICAgICAgICAgICc8c3BhbiBvbm1vdXNlb3Zlcj1cInRoaXMudGV4dENvbnRlbnQ9JnF1b3Q7RXhwbGljaXRseSB0cnVzdGVkIEhUTUwgYnlwYXNzZXMgJyArXG5cdCAqICAgICAgICAgICAgICdzYW5pdGl6YXRpb24uJnF1b3Q7XCI+SG92ZXIgb3ZlciB0aGlzIHRleHQuPC9zcGFuPicpO1xuXHQgKiAgICAgICB9XSk7XG5cdCAqIDwvZmlsZT5cblx0ICpcblx0ICogPGZpbGUgbmFtZT1cInRlc3RfZGF0YS5qc29uXCI+XG5cdCAqIFtcblx0ICogICB7IFwibmFtZVwiOiBcIkFsaWNlXCIsXG5cdCAqICAgICBcImh0bWxDb21tZW50XCI6XG5cdCAqICAgICAgICAgXCI8c3BhbiBvbm1vdXNlb3Zlcj0ndGhpcy50ZXh0Q29udGVudD1cXFwiUFdOM0QhXFxcIic+SXMgPGk+YW55b25lPC9pPiByZWFkaW5nIHRoaXM/PC9zcGFuPlwiXG5cdCAqICAgfSxcblx0ICogICB7IFwibmFtZVwiOiBcIkJvYlwiLFxuXHQgKiAgICAgXCJodG1sQ29tbWVudFwiOiBcIjxpPlllcyE8L2k+ICBBbSBJIHRoZSBvbmx5IG90aGVyIG9uZT9cIlxuXHQgKiAgIH1cblx0ICogXVxuXHQgKiA8L2ZpbGU+XG5cdCAqXG5cdCAqIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICogICBkZXNjcmliZSgnU0NFIGRvYyBkZW1vJywgZnVuY3Rpb24oKSB7XG5cdCAqICAgICBpdCgnc2hvdWxkIHNhbml0aXplIHVudHJ1c3RlZCB2YWx1ZXMnLCBmdW5jdGlvbigpIHtcblx0ICogICAgICAgZXhwZWN0KGVsZW1lbnQuYWxsKGJ5LmNzcygnLmh0bWxDb21tZW50JykpLmZpcnN0KCkuZ2V0SW5uZXJIdG1sKCkpXG5cdCAqICAgICAgICAgICAudG9CZSgnPHNwYW4+SXMgPGk+YW55b25lPC9pPiByZWFkaW5nIHRoaXM/PC9zcGFuPicpO1xuXHQgKiAgICAgfSk7XG5cdCAqXG5cdCAqICAgICBpdCgnc2hvdWxkIE5PVCBzYW5pdGl6ZSBleHBsaWNpdGx5IHRydXN0ZWQgdmFsdWVzJywgZnVuY3Rpb24oKSB7XG5cdCAqICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmlkKCdleHBsaWNpdGx5VHJ1c3RlZEh0bWwnKSkuZ2V0SW5uZXJIdG1sKCkpLnRvQmUoXG5cdCAqICAgICAgICAgICAnPHNwYW4gb25tb3VzZW92ZXI9XCJ0aGlzLnRleHRDb250ZW50PSZxdW90O0V4cGxpY2l0bHkgdHJ1c3RlZCBIVE1MIGJ5cGFzc2VzICcgK1xuXHQgKiAgICAgICAgICAgJ3Nhbml0aXphdGlvbi4mcXVvdDtcIj5Ib3ZlciBvdmVyIHRoaXMgdGV4dC48L3NwYW4+Jyk7XG5cdCAqICAgICB9KTtcblx0ICogICB9KTtcblx0ICogPC9maWxlPlxuXHQgKiA8L2V4YW1wbGU+XG5cdCAqXG5cdCAqXG5cdCAqXG5cdCAqICMjIENhbiBJIGRpc2FibGUgU0NFIGNvbXBsZXRlbHk/XG5cdCAqXG5cdCAqIFllcywgeW91IGNhbi4gIEhvd2V2ZXIsIHRoaXMgaXMgc3Ryb25nbHkgZGlzY291cmFnZWQuICBTQ0UgZ2l2ZXMgeW91IGEgbG90IG9mIHNlY3VyaXR5IGJlbmVmaXRzXG5cdCAqIGZvciBsaXR0bGUgY29kaW5nIG92ZXJoZWFkLiAgSXQgd2lsbCBiZSBtdWNoIGhhcmRlciB0byB0YWtlIGFuIFNDRSBkaXNhYmxlZCBhcHBsaWNhdGlvbiBhbmRcblx0ICogZWl0aGVyIHNlY3VyZSBpdCBvbiB5b3VyIG93biBvciBlbmFibGUgU0NFIGF0IGEgbGF0ZXIgc3RhZ2UuICBJdCBtaWdodCBtYWtlIHNlbnNlIHRvIGRpc2FibGUgU0NFXG5cdCAqIGZvciBjYXNlcyB3aGVyZSB5b3UgaGF2ZSBhIGxvdCBvZiBleGlzdGluZyBjb2RlIHRoYXQgd2FzIHdyaXR0ZW4gYmVmb3JlIFNDRSB3YXMgaW50cm9kdWNlZCBhbmRcblx0ICogeW91J3JlIG1pZ3JhdGluZyB0aGVtIGEgbW9kdWxlIGF0IGEgdGltZS5cblx0ICpcblx0ICogVGhhdCBzYWlkLCBoZXJlJ3MgaG93IHlvdSBjYW4gY29tcGxldGVseSBkaXNhYmxlIFNDRTpcblx0ICpcblx0ICogYGBgXG5cdCAqIGFuZ3VsYXIubW9kdWxlKCdteUFwcFdpdGhTY2VEaXNhYmxlZG15QXBwJywgW10pLmNvbmZpZyhmdW5jdGlvbigkc2NlUHJvdmlkZXIpIHtcblx0ICogICAvLyBDb21wbGV0ZWx5IGRpc2FibGUgU0NFLiAgRm9yIGRlbW9uc3RyYXRpb24gcHVycG9zZXMgb25seSFcblx0ICogICAvLyBEbyBub3QgdXNlIGluIG5ldyBwcm9qZWN0cy5cblx0ICogICAkc2NlUHJvdmlkZXIuZW5hYmxlZChmYWxzZSk7XG5cdCAqIH0pO1xuXHQgKiBgYGBcblx0ICpcblx0ICovXG5cdC8qIGpzaGludCBtYXhsZW46IDEwMCAqL1xuXHRcblx0ZnVuY3Rpb24gJFNjZVByb3ZpZGVyKCkge1xuXHQgIHZhciBlbmFibGVkID0gdHJ1ZTtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lICRzY2VQcm92aWRlciNlbmFibGVkXG5cdCAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7Ym9vbGVhbj19IHZhbHVlIElmIHByb3ZpZGVkLCB0aGVuIGVuYWJsZXMvZGlzYWJsZXMgU0NFLlxuXHQgICAqIEByZXR1cm4ge2Jvb2xlYW59IHRydWUgaWYgU0NFIGlzIGVuYWJsZWQsIGZhbHNlIG90aGVyd2lzZS5cblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIEVuYWJsZXMvZGlzYWJsZXMgU0NFIGFuZCByZXR1cm5zIHRoZSBjdXJyZW50IHZhbHVlLlxuXHQgICAqL1xuXHQgIHRoaXMuZW5hYmxlZCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkge1xuXHQgICAgICBlbmFibGVkID0gISF2YWx1ZTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBlbmFibGVkO1xuXHQgIH07XG5cdFxuXHRcblx0ICAvKiBEZXNpZ24gbm90ZXMgb24gdGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gZm9yIFNDRS5cblx0ICAgKlxuXHQgICAqIFRoZSBBUEkgY29udHJhY3QgZm9yIHRoZSBTQ0UgZGVsZWdhdGVcblx0ICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdCAgICogVGhlIFNDRSBkZWxlZ2F0ZSBvYmplY3QgbXVzdCBwcm92aWRlIHRoZSBmb2xsb3dpbmcgMyBtZXRob2RzOlxuXHQgICAqXG5cdCAgICogLSB0cnVzdEFzKGNvbnRleHRFbnVtLCB2YWx1ZSlcblx0ICAgKiAgICAgVGhpcyBtZXRob2QgaXMgdXNlZCB0byB0ZWxsIHRoZSBTQ0Ugc2VydmljZSB0aGF0IHRoZSBwcm92aWRlZCB2YWx1ZSBpcyBPSyB0byB1c2UgaW4gdGhlXG5cdCAgICogICAgIGNvbnRleHRzIHNwZWNpZmllZCBieSBjb250ZXh0RW51bS4gIEl0IG11c3QgcmV0dXJuIGFuIG9iamVjdCB0aGF0IHdpbGwgYmUgYWNjZXB0ZWQgYnlcblx0ICAgKiAgICAgZ2V0VHJ1c3RlZCgpIGZvciBhIGNvbXBhdGlibGUgY29udGV4dEVudW0gYW5kIHJldHVybiB0aGlzIHZhbHVlLlxuXHQgICAqXG5cdCAgICogLSB2YWx1ZU9mKHZhbHVlKVxuXHQgICAqICAgICBGb3IgdmFsdWVzIHRoYXQgd2VyZSBub3QgcHJvZHVjZWQgYnkgdHJ1c3RBcygpLCByZXR1cm4gdGhlbSBhcyBpcy4gIEZvciB2YWx1ZXMgdGhhdCB3ZXJlXG5cdCAgICogICAgIHByb2R1Y2VkIGJ5IHRydXN0QXMoKSwgcmV0dXJuIHRoZSBjb3JyZXNwb25kaW5nIGlucHV0IHZhbHVlIHRvIHRydXN0QXMuICBCYXNpY2FsbHksIGlmXG5cdCAgICogICAgIHRydXN0QXMgaXMgd3JhcHBpbmcgdGhlIGdpdmVuIHZhbHVlcyBpbnRvIHNvbWUgdHlwZSwgdGhpcyBvcGVyYXRpb24gdW53cmFwcyBpdCB3aGVuIGdpdmVuXG5cdCAgICogICAgIHN1Y2ggYSB2YWx1ZS5cblx0ICAgKlxuXHQgICAqIC0gZ2V0VHJ1c3RlZChjb250ZXh0RW51bSwgdmFsdWUpXG5cdCAgICogICAgIFRoaXMgZnVuY3Rpb24gc2hvdWxkIHJldHVybiB0aGUgYSB2YWx1ZSB0aGF0IGlzIHNhZmUgdG8gdXNlIGluIHRoZSBjb250ZXh0IHNwZWNpZmllZCBieVxuXHQgICAqICAgICBjb250ZXh0RW51bSBvciB0aHJvdyBhbmQgZXhjZXB0aW9uIG90aGVyd2lzZS5cblx0ICAgKlxuXHQgICAqIE5PVEU6IFRoaXMgY29udHJhY3QgZGVsaWJlcmF0ZWx5IGRvZXMgTk9UIHN0YXRlIHRoYXQgdmFsdWVzIHJldHVybmVkIGJ5IHRydXN0QXMoKSBtdXN0IGJlXG5cdCAgICogb3BhcXVlIG9yIHdyYXBwZWQgaW4gc29tZSBob2xkZXIgb2JqZWN0LiAgVGhhdCBoYXBwZW5zIHRvIGJlIGFuIGltcGxlbWVudGF0aW9uIGRldGFpbC4gIEZvclxuXHQgICAqIGluc3RhbmNlLCBhbiBpbXBsZW1lbnRhdGlvbiBjb3VsZCBtYWludGFpbiBhIHJlZ2lzdHJ5IG9mIGFsbCB0cnVzdGVkIG9iamVjdHMgYnkgY29udGV4dC4gIEluXG5cdCAgICogc3VjaCBhIGNhc2UsIHRydXN0QXMoKSB3b3VsZCByZXR1cm4gdGhlIHNhbWUgb2JqZWN0IHRoYXQgd2FzIHBhc3NlZCBpbi4gIGdldFRydXN0ZWQoKSB3b3VsZFxuXHQgICAqIHJldHVybiB0aGUgc2FtZSBvYmplY3QgcGFzc2VkIGluIGlmIGl0IHdhcyBmb3VuZCBpbiB0aGUgcmVnaXN0cnkgdW5kZXIgYSBjb21wYXRpYmxlIGNvbnRleHQgb3Jcblx0ICAgKiB0aHJvdyBhbiBleGNlcHRpb24gb3RoZXJ3aXNlLiAgQW4gaW1wbGVtZW50YXRpb24gbWlnaHQgb25seSB3cmFwIHZhbHVlcyBzb21lIG9mIHRoZSB0aW1lIGJhc2VkXG5cdCAgICogb24gc29tZSBjcml0ZXJpYS4gIGdldFRydXN0ZWQoKSBtaWdodCByZXR1cm4gYSB2YWx1ZSBhbmQgbm90IHRocm93IGFuIGV4Y2VwdGlvbiBmb3Igc3BlY2lhbFxuXHQgICAqIGNvbnN0YW50cyBvciBvYmplY3RzIGV2ZW4gaWYgbm90IHdyYXBwZWQuICBBbGwgc3VjaCBpbXBsZW1lbnRhdGlvbnMgZnVsZmlsbCB0aGlzIGNvbnRyYWN0LlxuXHQgICAqXG5cdCAgICpcblx0ICAgKiBBIG5vdGUgb24gdGhlIGluaGVyaXRhbmNlIG1vZGVsIGZvciBTQ0UgY29udGV4dHNcblx0ICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0ICAgKiBJJ3ZlIHVzZWQgaW5oZXJpdGFuY2UgYW5kIG1hZGUgUkVTT1VSQ0VfVVJMIHdyYXBwZWQgdHlwZXMgYSBzdWJ0eXBlIG9mIFVSTCB3cmFwcGVkIHR5cGVzLiAgVGhpc1xuXHQgICAqIGlzIHB1cmVseSBhbiBpbXBsZW1lbnRhdGlvbiBkZXRhaWxzLlxuXHQgICAqXG5cdCAgICogVGhlIGNvbnRyYWN0IGlzIHNpbXBseSB0aGlzOlxuXHQgICAqXG5cdCAgICogICAgIGdldFRydXN0ZWQoJHNjZS5SRVNPVVJDRV9VUkwsIHZhbHVlKSBzdWNjZWVkaW5nIGltcGxpZXMgdGhhdCBnZXRUcnVzdGVkKCRzY2UuVVJMLCB2YWx1ZSlcblx0ICAgKiAgICAgd2lsbCBhbHNvIHN1Y2NlZWQuXG5cdCAgICpcblx0ICAgKiBJbmhlcml0YW5jZSBoYXBwZW5zIHRvIGNhcHR1cmUgdGhpcyBpbiBhIG5hdHVyYWwgd2F5LiAgSW4gc29tZSBmdXR1cmUsIHdlXG5cdCAgICogbWF5IG5vdCB1c2UgaW5oZXJpdGFuY2UgYW55bW9yZS4gIFRoYXQgaXMgT0sgYmVjYXVzZSBubyBjb2RlIG91dHNpZGUgb2Zcblx0ICAgKiBzY2UuanMgYW5kIHNjZVNwZWNzLmpzIHdvdWxkIG5lZWQgdG8gYmUgYXdhcmUgb2YgdGhpcyBkZXRhaWwuXG5cdCAgICovXG5cdFxuXHQgIHRoaXMuJGdldCA9IFsnJHBhcnNlJywgJyRzY2VEZWxlZ2F0ZScsIGZ1bmN0aW9uKFxuXHQgICAgICAgICAgICAgICAgJHBhcnNlLCAgICRzY2VEZWxlZ2F0ZSkge1xuXHQgICAgLy8gUHJlcmVxOiBFbnN1cmUgdGhhdCB3ZSdyZSBub3QgcnVubmluZyBpbiBJRTwxMSBxdWlya3MgbW9kZS4gIEluIHRoYXQgbW9kZSwgSUUgPCAxMSBhbGxvd1xuXHQgICAgLy8gdGhlIFwiZXhwcmVzc2lvbihqYXZhc2NyaXB0IGV4cHJlc3Npb24pXCIgc3ludGF4IHdoaWNoIGlzIGluc2VjdXJlLlxuXHQgICAgaWYgKGVuYWJsZWQgJiYgbXNpZSA8IDgpIHtcblx0ICAgICAgdGhyb3cgJHNjZU1pbkVycignaWVxdWlya3MnLFxuXHQgICAgICAgICdTdHJpY3QgQ29udGV4dHVhbCBFc2NhcGluZyBkb2VzIG5vdCBzdXBwb3J0IEludGVybmV0IEV4cGxvcmVyIHZlcnNpb24gPCAxMSBpbiBxdWlya3MgJyArXG5cdCAgICAgICAgJ21vZGUuICBZb3UgY2FuIGZpeCB0aGlzIGJ5IGFkZGluZyB0aGUgdGV4dCA8IWRvY3R5cGUgaHRtbD4gdG8gdGhlIHRvcCBvZiB5b3VyIEhUTUwgJyArXG5cdCAgICAgICAgJ2RvY3VtZW50LiAgU2VlIGh0dHA6Ly9kb2NzLmFuZ3VsYXJqcy5vcmcvYXBpL25nLiRzY2UgZm9yIG1vcmUgaW5mb3JtYXRpb24uJyk7XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIHNjZSA9IHNoYWxsb3dDb3B5KFNDRV9DT05URVhUUyk7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgKiBAbmFtZSAkc2NlI2lzRW5hYmxlZFxuXHQgICAgICogQGtpbmQgZnVuY3Rpb25cblx0ICAgICAqXG5cdCAgICAgKiBAcmV0dXJuIHtCb29sZWFufSB0cnVlIGlmIFNDRSBpcyBlbmFibGVkLCBmYWxzZSBvdGhlcndpc2UuICBJZiB5b3Ugd2FudCB0byBzZXQgdGhlIHZhbHVlLCB5b3Vcblx0ICAgICAqIGhhdmUgdG8gZG8gaXQgYXQgbW9kdWxlIGNvbmZpZyB0aW1lIG9uIHtAbGluayBuZy4kc2NlUHJvdmlkZXIgJHNjZVByb3ZpZGVyfS5cblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFJldHVybnMgYSBib29sZWFuIGluZGljYXRpbmcgaWYgU0NFIGlzIGVuYWJsZWQuXG5cdCAgICAgKi9cblx0ICAgIHNjZS5pc0VuYWJsZWQgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIGVuYWJsZWQ7XG5cdCAgICB9O1xuXHQgICAgc2NlLnRydXN0QXMgPSAkc2NlRGVsZWdhdGUudHJ1c3RBcztcblx0ICAgIHNjZS5nZXRUcnVzdGVkID0gJHNjZURlbGVnYXRlLmdldFRydXN0ZWQ7XG5cdCAgICBzY2UudmFsdWVPZiA9ICRzY2VEZWxlZ2F0ZS52YWx1ZU9mO1xuXHRcblx0ICAgIGlmICghZW5hYmxlZCkge1xuXHQgICAgICBzY2UudHJ1c3RBcyA9IHNjZS5nZXRUcnVzdGVkID0gZnVuY3Rpb24odHlwZSwgdmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9O1xuXHQgICAgICBzY2UudmFsdWVPZiA9IGlkZW50aXR5O1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICogQG5hbWUgJHNjZSNwYXJzZUFzXG5cdCAgICAgKlxuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKiBDb252ZXJ0cyBBbmd1bGFyIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259IGludG8gYSBmdW5jdGlvbi4gIFRoaXMgaXMgbGlrZSB7QGxpbmtcblx0ICAgICAqIG5nLiRwYXJzZSAkcGFyc2V9IGFuZCBpcyBpZGVudGljYWwgd2hlbiB0aGUgZXhwcmVzc2lvbiBpcyBhIGxpdGVyYWwgY29uc3RhbnQuICBPdGhlcndpc2UsIGl0XG5cdCAgICAgKiB3cmFwcyB0aGUgZXhwcmVzc2lvbiBpbiBhIGNhbGwgdG8ge0BsaW5rIG5nLiRzY2UjZ2V0VHJ1c3RlZCAkc2NlLmdldFRydXN0ZWQoKnR5cGUqLFxuXHQgICAgICogKnJlc3VsdCopfVxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFRoZSBraW5kIG9mIFNDRSBjb250ZXh0IGluIHdoaWNoIHRoaXMgcmVzdWx0IHdpbGwgYmUgdXNlZC5cblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBleHByZXNzaW9uIFN0cmluZyBleHByZXNzaW9uIHRvIGNvbXBpbGUuXG5cdCAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb24oY29udGV4dCwgbG9jYWxzKX0gYSBmdW5jdGlvbiB3aGljaCByZXByZXNlbnRzIHRoZSBjb21waWxlZCBleHByZXNzaW9uOlxuXHQgICAgICpcblx0ICAgICAqICAgICogYGNvbnRleHRgIOKAkyBge29iamVjdH1gIOKAkyBhbiBvYmplY3QgYWdhaW5zdCB3aGljaCBhbnkgZXhwcmVzc2lvbnMgZW1iZWRkZWQgaW4gdGhlIHN0cmluZ3Ncblx0ICAgICAqICAgICAgYXJlIGV2YWx1YXRlZCBhZ2FpbnN0ICh0eXBpY2FsbHkgYSBzY29wZSBvYmplY3QpLlxuXHQgICAgICogICAgKiBgbG9jYWxzYCDigJMgYHtvYmplY3Q9fWAg4oCTIGxvY2FsIHZhcmlhYmxlcyBjb250ZXh0IG9iamVjdCwgdXNlZnVsIGZvciBvdmVycmlkaW5nIHZhbHVlcyBpblxuXHQgICAgICogICAgICBgY29udGV4dGAuXG5cdCAgICAgKi9cblx0ICAgIHNjZS5wYXJzZUFzID0gZnVuY3Rpb24gc2NlUGFyc2VBcyh0eXBlLCBleHByKSB7XG5cdCAgICAgIHZhciBwYXJzZWQgPSAkcGFyc2UoZXhwcik7XG5cdCAgICAgIGlmIChwYXJzZWQubGl0ZXJhbCAmJiBwYXJzZWQuY29uc3RhbnQpIHtcblx0ICAgICAgICByZXR1cm4gcGFyc2VkO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHJldHVybiAkcGFyc2UoZXhwciwgZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICAgIHJldHVybiBzY2UuZ2V0VHJ1c3RlZCh0eXBlLCB2YWx1ZSk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgKiBAbmFtZSAkc2NlI3RydXN0QXNcblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIERlbGVnYXRlcyB0byB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI3RydXN0QXMgYCRzY2VEZWxlZ2F0ZS50cnVzdEFzYH0uICBBcyBzdWNoLFxuXHQgICAgICogcmV0dXJucyBhbiBvYmplY3QgdGhhdCBpcyB0cnVzdGVkIGJ5IGFuZ3VsYXIgZm9yIHVzZSBpbiBzcGVjaWZpZWQgc3RyaWN0IGNvbnRleHR1YWxcblx0ICAgICAqIGVzY2FwaW5nIGNvbnRleHRzIChzdWNoIGFzIG5nLWJpbmQtaHRtbCwgbmctaW5jbHVkZSwgYW55IHNyYyBhdHRyaWJ1dGVcblx0ICAgICAqIGludGVycG9sYXRpb24sIGFueSBkb20gZXZlbnQgYmluZGluZyBhdHRyaWJ1dGUgaW50ZXJwb2xhdGlvbiBzdWNoIGFzIGZvciBvbmNsaWNrLCAgZXRjLilcblx0ICAgICAqIHRoYXQgdXNlcyB0aGUgcHJvdmlkZWQgdmFsdWUuICBTZWUgKiB7QGxpbmsgbmcuJHNjZSAkc2NlfSBmb3IgZW5hYmxpbmcgc3RyaWN0IGNvbnRleHR1YWxcblx0ICAgICAqIGVzY2FwaW5nLlxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFRoZSBraW5kIG9mIGNvbnRleHQgaW4gd2hpY2ggdGhpcyB2YWx1ZSBpcyBzYWZlIGZvciB1c2UuICBlLmcuIHVybCxcblx0ICAgICAqICAgcmVzb3VyY2VVcmwsIGh0bWwsIGpzIGFuZCBjc3MuXG5cdCAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0aGF0IHRoYXQgc2hvdWxkIGJlIGNvbnNpZGVyZWQgdHJ1c3RlZC9zYWZlLlxuXHQgICAgICogQHJldHVybnMgeyp9IEEgdmFsdWUgdGhhdCBjYW4gYmUgdXNlZCB0byBzdGFuZCBpbiBmb3IgdGhlIHByb3ZpZGVkIGB2YWx1ZWAgaW4gcGxhY2VzXG5cdCAgICAgKiB3aGVyZSBBbmd1bGFyIGV4cGVjdHMgYSAkc2NlLnRydXN0QXMoKSByZXR1cm4gdmFsdWUuXG5cdCAgICAgKi9cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAqIEBuYW1lICRzY2UjdHJ1c3RBc0h0bWxcblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS50cnVzdEFzSHRtbCh2YWx1ZSlgIOKGklxuXHQgICAgICogICAgIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjdHJ1c3RBcyBgJHNjZURlbGVnYXRlLnRydXN0QXMoJHNjZS5IVE1MLCB2YWx1ZSlgfVxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHRydXN0QXMuXG5cdCAgICAgKiBAcmV0dXJucyB7Kn0gQW4gb2JqZWN0IHRoYXQgY2FuIGJlIHBhc3NlZCB0byB7QGxpbmsgbmcuJHNjZSNnZXRUcnVzdGVkSHRtbFxuXHQgICAgICogICAgICRzY2UuZ2V0VHJ1c3RlZEh0bWwodmFsdWUpfSB0byBvYnRhaW4gdGhlIG9yaWdpbmFsIHZhbHVlLiAgKHByaXZpbGVnZWQgZGlyZWN0aXZlc1xuXHQgICAgICogICAgIG9ubHkgYWNjZXB0IGV4cHJlc3Npb25zIHRoYXQgYXJlIGVpdGhlciBsaXRlcmFsIGNvbnN0YW50cyBvciBhcmUgdGhlXG5cdCAgICAgKiAgICAgcmV0dXJuIHZhbHVlIG9mIHtAbGluayBuZy4kc2NlI3RydXN0QXMgJHNjZS50cnVzdEFzfS4pXG5cdCAgICAgKi9cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAqIEBuYW1lICRzY2UjdHJ1c3RBc1VybFxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogU2hvcnRoYW5kIG1ldGhvZC4gIGAkc2NlLnRydXN0QXNVcmwodmFsdWUpYCDihpJcblx0ICAgICAqICAgICB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI3RydXN0QXMgYCRzY2VEZWxlZ2F0ZS50cnVzdEFzKCRzY2UuVVJMLCB2YWx1ZSlgfVxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHRydXN0QXMuXG5cdCAgICAgKiBAcmV0dXJucyB7Kn0gQW4gb2JqZWN0IHRoYXQgY2FuIGJlIHBhc3NlZCB0byB7QGxpbmsgbmcuJHNjZSNnZXRUcnVzdGVkVXJsXG5cdCAgICAgKiAgICAgJHNjZS5nZXRUcnVzdGVkVXJsKHZhbHVlKX0gdG8gb2J0YWluIHRoZSBvcmlnaW5hbCB2YWx1ZS4gIChwcml2aWxlZ2VkIGRpcmVjdGl2ZXNcblx0ICAgICAqICAgICBvbmx5IGFjY2VwdCBleHByZXNzaW9ucyB0aGF0IGFyZSBlaXRoZXIgbGl0ZXJhbCBjb25zdGFudHMgb3IgYXJlIHRoZVxuXHQgICAgICogICAgIHJldHVybiB2YWx1ZSBvZiB7QGxpbmsgbmcuJHNjZSN0cnVzdEFzICRzY2UudHJ1c3RBc30uKVxuXHQgICAgICovXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgKiBAbmFtZSAkc2NlI3RydXN0QXNSZXNvdXJjZVVybFxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogU2hvcnRoYW5kIG1ldGhvZC4gIGAkc2NlLnRydXN0QXNSZXNvdXJjZVVybCh2YWx1ZSlgIOKGklxuXHQgICAgICogICAgIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjdHJ1c3RBcyBgJHNjZURlbGVnYXRlLnRydXN0QXMoJHNjZS5SRVNPVVJDRV9VUkwsIHZhbHVlKWB9XG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gdHJ1c3RBcy5cblx0ICAgICAqIEByZXR1cm5zIHsqfSBBbiBvYmplY3QgdGhhdCBjYW4gYmUgcGFzc2VkIHRvIHtAbGluayBuZy4kc2NlI2dldFRydXN0ZWRSZXNvdXJjZVVybFxuXHQgICAgICogICAgICRzY2UuZ2V0VHJ1c3RlZFJlc291cmNlVXJsKHZhbHVlKX0gdG8gb2J0YWluIHRoZSBvcmlnaW5hbCB2YWx1ZS4gIChwcml2aWxlZ2VkIGRpcmVjdGl2ZXNcblx0ICAgICAqICAgICBvbmx5IGFjY2VwdCBleHByZXNzaW9ucyB0aGF0IGFyZSBlaXRoZXIgbGl0ZXJhbCBjb25zdGFudHMgb3IgYXJlIHRoZSByZXR1cm5cblx0ICAgICAqICAgICB2YWx1ZSBvZiB7QGxpbmsgbmcuJHNjZSN0cnVzdEFzICRzY2UudHJ1c3RBc30uKVxuXHQgICAgICovXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgKiBAbmFtZSAkc2NlI3RydXN0QXNKc1xuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogU2hvcnRoYW5kIG1ldGhvZC4gIGAkc2NlLnRydXN0QXNKcyh2YWx1ZSlgIOKGklxuXHQgICAgICogICAgIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjdHJ1c3RBcyBgJHNjZURlbGVnYXRlLnRydXN0QXMoJHNjZS5KUywgdmFsdWUpYH1cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byB0cnVzdEFzLlxuXHQgICAgICogQHJldHVybnMgeyp9IEFuIG9iamVjdCB0aGF0IGNhbiBiZSBwYXNzZWQgdG8ge0BsaW5rIG5nLiRzY2UjZ2V0VHJ1c3RlZEpzXG5cdCAgICAgKiAgICAgJHNjZS5nZXRUcnVzdGVkSnModmFsdWUpfSB0byBvYnRhaW4gdGhlIG9yaWdpbmFsIHZhbHVlLiAgKHByaXZpbGVnZWQgZGlyZWN0aXZlc1xuXHQgICAgICogICAgIG9ubHkgYWNjZXB0IGV4cHJlc3Npb25zIHRoYXQgYXJlIGVpdGhlciBsaXRlcmFsIGNvbnN0YW50cyBvciBhcmUgdGhlXG5cdCAgICAgKiAgICAgcmV0dXJuIHZhbHVlIG9mIHtAbGluayBuZy4kc2NlI3RydXN0QXMgJHNjZS50cnVzdEFzfS4pXG5cdCAgICAgKi9cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAqIEBuYW1lICRzY2UjZ2V0VHJ1c3RlZFxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogRGVsZWdhdGVzIHRvIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjZ2V0VHJ1c3RlZCBgJHNjZURlbGVnYXRlLmdldFRydXN0ZWRgfS4gIEFzIHN1Y2gsXG5cdCAgICAgKiB0YWtlcyB0aGUgcmVzdWx0IG9mIGEge0BsaW5rIG5nLiRzY2UjdHJ1c3RBcyBgJHNjZS50cnVzdEFzYH0oKSBjYWxsIGFuZCByZXR1cm5zIHRoZVxuXHQgICAgICogb3JpZ2luYWxseSBzdXBwbGllZCB2YWx1ZSBpZiB0aGUgcXVlcmllZCBjb250ZXh0IHR5cGUgaXMgYSBzdXBlcnR5cGUgb2YgdGhlIGNyZWF0ZWQgdHlwZS5cblx0ICAgICAqIElmIHRoaXMgY29uZGl0aW9uIGlzbid0IHNhdGlzZmllZCwgdGhyb3dzIGFuIGV4Y2VwdGlvbi5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBUaGUga2luZCBvZiBjb250ZXh0IGluIHdoaWNoIHRoaXMgdmFsdWUgaXMgdG8gYmUgdXNlZC5cblx0ICAgICAqIEBwYXJhbSB7Kn0gbWF5YmVUcnVzdGVkIFRoZSByZXN1bHQgb2YgYSBwcmlvciB7QGxpbmsgbmcuJHNjZSN0cnVzdEFzIGAkc2NlLnRydXN0QXNgfVxuXHQgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgY2FsbC5cblx0ICAgICAqIEByZXR1cm5zIHsqfSBUaGUgdmFsdWUgdGhlIHdhcyBvcmlnaW5hbGx5IHByb3ZpZGVkIHRvXG5cdCAgICAgKiAgICAgICAgICAgICAge0BsaW5rIG5nLiRzY2UjdHJ1c3RBcyBgJHNjZS50cnVzdEFzYH0gaWYgdmFsaWQgaW4gdGhpcyBjb250ZXh0LlxuXHQgICAgICogICAgICAgICAgICAgIE90aGVyd2lzZSwgdGhyb3dzIGFuIGV4Y2VwdGlvbi5cblx0ICAgICAqL1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICogQG5hbWUgJHNjZSNnZXRUcnVzdGVkSHRtbFxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogU2hvcnRoYW5kIG1ldGhvZC4gIGAkc2NlLmdldFRydXN0ZWRIdG1sKHZhbHVlKWAg4oaSXG5cdCAgICAgKiAgICAge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZSNnZXRUcnVzdGVkIGAkc2NlRGVsZWdhdGUuZ2V0VHJ1c3RlZCgkc2NlLkhUTUwsIHZhbHVlKWB9XG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gcGFzcyB0byBgJHNjZS5nZXRUcnVzdGVkYC5cblx0ICAgICAqIEByZXR1cm5zIHsqfSBUaGUgcmV0dXJuIHZhbHVlIG9mIGAkc2NlLmdldFRydXN0ZWQoJHNjZS5IVE1MLCB2YWx1ZSlgXG5cdCAgICAgKi9cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAqIEBuYW1lICRzY2UjZ2V0VHJ1c3RlZENzc1xuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogU2hvcnRoYW5kIG1ldGhvZC4gIGAkc2NlLmdldFRydXN0ZWRDc3ModmFsdWUpYCDihpJcblx0ICAgICAqICAgICB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI2dldFRydXN0ZWQgYCRzY2VEZWxlZ2F0ZS5nZXRUcnVzdGVkKCRzY2UuQ1NTLCB2YWx1ZSlgfVxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHBhc3MgdG8gYCRzY2UuZ2V0VHJ1c3RlZGAuXG5cdCAgICAgKiBAcmV0dXJucyB7Kn0gVGhlIHJldHVybiB2YWx1ZSBvZiBgJHNjZS5nZXRUcnVzdGVkKCRzY2UuQ1NTLCB2YWx1ZSlgXG5cdCAgICAgKi9cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAqIEBuYW1lICRzY2UjZ2V0VHJ1c3RlZFVybFxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogU2hvcnRoYW5kIG1ldGhvZC4gIGAkc2NlLmdldFRydXN0ZWRVcmwodmFsdWUpYCDihpJcblx0ICAgICAqICAgICB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI2dldFRydXN0ZWQgYCRzY2VEZWxlZ2F0ZS5nZXRUcnVzdGVkKCRzY2UuVVJMLCB2YWx1ZSlgfVxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHBhc3MgdG8gYCRzY2UuZ2V0VHJ1c3RlZGAuXG5cdCAgICAgKiBAcmV0dXJucyB7Kn0gVGhlIHJldHVybiB2YWx1ZSBvZiBgJHNjZS5nZXRUcnVzdGVkKCRzY2UuVVJMLCB2YWx1ZSlgXG5cdCAgICAgKi9cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAqIEBuYW1lICRzY2UjZ2V0VHJ1c3RlZFJlc291cmNlVXJsXG5cdCAgICAgKlxuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKiBTaG9ydGhhbmQgbWV0aG9kLiAgYCRzY2UuZ2V0VHJ1c3RlZFJlc291cmNlVXJsKHZhbHVlKWAg4oaSXG5cdCAgICAgKiAgICAge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZSNnZXRUcnVzdGVkIGAkc2NlRGVsZWdhdGUuZ2V0VHJ1c3RlZCgkc2NlLlJFU09VUkNFX1VSTCwgdmFsdWUpYH1cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBwYXNzIHRvIGAkc2NlRGVsZWdhdGUuZ2V0VHJ1c3RlZGAuXG5cdCAgICAgKiBAcmV0dXJucyB7Kn0gVGhlIHJldHVybiB2YWx1ZSBvZiBgJHNjZS5nZXRUcnVzdGVkKCRzY2UuUkVTT1VSQ0VfVVJMLCB2YWx1ZSlgXG5cdCAgICAgKi9cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAqIEBuYW1lICRzY2UjZ2V0VHJ1c3RlZEpzXG5cdCAgICAgKlxuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKiBTaG9ydGhhbmQgbWV0aG9kLiAgYCRzY2UuZ2V0VHJ1c3RlZEpzKHZhbHVlKWAg4oaSXG5cdCAgICAgKiAgICAge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZSNnZXRUcnVzdGVkIGAkc2NlRGVsZWdhdGUuZ2V0VHJ1c3RlZCgkc2NlLkpTLCB2YWx1ZSlgfVxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHBhc3MgdG8gYCRzY2UuZ2V0VHJ1c3RlZGAuXG5cdCAgICAgKiBAcmV0dXJucyB7Kn0gVGhlIHJldHVybiB2YWx1ZSBvZiBgJHNjZS5nZXRUcnVzdGVkKCRzY2UuSlMsIHZhbHVlKWBcblx0ICAgICAqL1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICogQG5hbWUgJHNjZSNwYXJzZUFzSHRtbFxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogU2hvcnRoYW5kIG1ldGhvZC4gIGAkc2NlLnBhcnNlQXNIdG1sKGV4cHJlc3Npb24gc3RyaW5nKWAg4oaSXG5cdCAgICAgKiAgICAge0BsaW5rIG5nLiRzY2UjcGFyc2VBcyBgJHNjZS5wYXJzZUFzKCRzY2UuSFRNTCwgdmFsdWUpYH1cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXhwcmVzc2lvbiBTdHJpbmcgZXhwcmVzc2lvbiB0byBjb21waWxlLlxuXHQgICAgICogQHJldHVybnMge2Z1bmN0aW9uKGNvbnRleHQsIGxvY2Fscyl9IGEgZnVuY3Rpb24gd2hpY2ggcmVwcmVzZW50cyB0aGUgY29tcGlsZWQgZXhwcmVzc2lvbjpcblx0ICAgICAqXG5cdCAgICAgKiAgICAqIGBjb250ZXh0YCDigJMgYHtvYmplY3R9YCDigJMgYW4gb2JqZWN0IGFnYWluc3Qgd2hpY2ggYW55IGV4cHJlc3Npb25zIGVtYmVkZGVkIGluIHRoZSBzdHJpbmdzXG5cdCAgICAgKiAgICAgIGFyZSBldmFsdWF0ZWQgYWdhaW5zdCAodHlwaWNhbGx5IGEgc2NvcGUgb2JqZWN0KS5cblx0ICAgICAqICAgICogYGxvY2Fsc2Ag4oCTIGB7b2JqZWN0PX1gIOKAkyBsb2NhbCB2YXJpYWJsZXMgY29udGV4dCBvYmplY3QsIHVzZWZ1bCBmb3Igb3ZlcnJpZGluZyB2YWx1ZXMgaW5cblx0ICAgICAqICAgICAgYGNvbnRleHRgLlxuXHQgICAgICovXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICAgKiBAbmFtZSAkc2NlI3BhcnNlQXNDc3Ncblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS5wYXJzZUFzQ3NzKHZhbHVlKWAg4oaSXG5cdCAgICAgKiAgICAge0BsaW5rIG5nLiRzY2UjcGFyc2VBcyBgJHNjZS5wYXJzZUFzKCRzY2UuQ1NTLCB2YWx1ZSlgfVxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBleHByZXNzaW9uIFN0cmluZyBleHByZXNzaW9uIHRvIGNvbXBpbGUuXG5cdCAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb24oY29udGV4dCwgbG9jYWxzKX0gYSBmdW5jdGlvbiB3aGljaCByZXByZXNlbnRzIHRoZSBjb21waWxlZCBleHByZXNzaW9uOlxuXHQgICAgICpcblx0ICAgICAqICAgICogYGNvbnRleHRgIOKAkyBge29iamVjdH1gIOKAkyBhbiBvYmplY3QgYWdhaW5zdCB3aGljaCBhbnkgZXhwcmVzc2lvbnMgZW1iZWRkZWQgaW4gdGhlIHN0cmluZ3Ncblx0ICAgICAqICAgICAgYXJlIGV2YWx1YXRlZCBhZ2FpbnN0ICh0eXBpY2FsbHkgYSBzY29wZSBvYmplY3QpLlxuXHQgICAgICogICAgKiBgbG9jYWxzYCDigJMgYHtvYmplY3Q9fWAg4oCTIGxvY2FsIHZhcmlhYmxlcyBjb250ZXh0IG9iamVjdCwgdXNlZnVsIGZvciBvdmVycmlkaW5nIHZhbHVlcyBpblxuXHQgICAgICogICAgICBgY29udGV4dGAuXG5cdCAgICAgKi9cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgICAqIEBuYW1lICRzY2UjcGFyc2VBc1VybFxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogU2hvcnRoYW5kIG1ldGhvZC4gIGAkc2NlLnBhcnNlQXNVcmwodmFsdWUpYCDihpJcblx0ICAgICAqICAgICB7QGxpbmsgbmcuJHNjZSNwYXJzZUFzIGAkc2NlLnBhcnNlQXMoJHNjZS5VUkwsIHZhbHVlKWB9XG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IGV4cHJlc3Npb24gU3RyaW5nIGV4cHJlc3Npb24gdG8gY29tcGlsZS5cblx0ICAgICAqIEByZXR1cm5zIHtmdW5jdGlvbihjb250ZXh0LCBsb2NhbHMpfSBhIGZ1bmN0aW9uIHdoaWNoIHJlcHJlc2VudHMgdGhlIGNvbXBpbGVkIGV4cHJlc3Npb246XG5cdCAgICAgKlxuXHQgICAgICogICAgKiBgY29udGV4dGAg4oCTIGB7b2JqZWN0fWAg4oCTIGFuIG9iamVjdCBhZ2FpbnN0IHdoaWNoIGFueSBleHByZXNzaW9ucyBlbWJlZGRlZCBpbiB0aGUgc3RyaW5nc1xuXHQgICAgICogICAgICBhcmUgZXZhbHVhdGVkIGFnYWluc3QgKHR5cGljYWxseSBhIHNjb3BlIG9iamVjdCkuXG5cdCAgICAgKiAgICAqIGBsb2NhbHNgIOKAkyBge29iamVjdD19YCDigJMgbG9jYWwgdmFyaWFibGVzIGNvbnRleHQgb2JqZWN0LCB1c2VmdWwgZm9yIG92ZXJyaWRpbmcgdmFsdWVzIGluXG5cdCAgICAgKiAgICAgIGBjb250ZXh0YC5cblx0ICAgICAqL1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICogQG5hbWUgJHNjZSNwYXJzZUFzUmVzb3VyY2VVcmxcblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS5wYXJzZUFzUmVzb3VyY2VVcmwodmFsdWUpYCDihpJcblx0ICAgICAqICAgICB7QGxpbmsgbmcuJHNjZSNwYXJzZUFzIGAkc2NlLnBhcnNlQXMoJHNjZS5SRVNPVVJDRV9VUkwsIHZhbHVlKWB9XG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IGV4cHJlc3Npb24gU3RyaW5nIGV4cHJlc3Npb24gdG8gY29tcGlsZS5cblx0ICAgICAqIEByZXR1cm5zIHtmdW5jdGlvbihjb250ZXh0LCBsb2NhbHMpfSBhIGZ1bmN0aW9uIHdoaWNoIHJlcHJlc2VudHMgdGhlIGNvbXBpbGVkIGV4cHJlc3Npb246XG5cdCAgICAgKlxuXHQgICAgICogICAgKiBgY29udGV4dGAg4oCTIGB7b2JqZWN0fWAg4oCTIGFuIG9iamVjdCBhZ2FpbnN0IHdoaWNoIGFueSBleHByZXNzaW9ucyBlbWJlZGRlZCBpbiB0aGUgc3RyaW5nc1xuXHQgICAgICogICAgICBhcmUgZXZhbHVhdGVkIGFnYWluc3QgKHR5cGljYWxseSBhIHNjb3BlIG9iamVjdCkuXG5cdCAgICAgKiAgICAqIGBsb2NhbHNgIOKAkyBge29iamVjdD19YCDigJMgbG9jYWwgdmFyaWFibGVzIGNvbnRleHQgb2JqZWN0LCB1c2VmdWwgZm9yIG92ZXJyaWRpbmcgdmFsdWVzIGluXG5cdCAgICAgKiAgICAgIGBjb250ZXh0YC5cblx0ICAgICAqL1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICogQG5hbWUgJHNjZSNwYXJzZUFzSnNcblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS5wYXJzZUFzSnModmFsdWUpYCDihpJcblx0ICAgICAqICAgICB7QGxpbmsgbmcuJHNjZSNwYXJzZUFzIGAkc2NlLnBhcnNlQXMoJHNjZS5KUywgdmFsdWUpYH1cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXhwcmVzc2lvbiBTdHJpbmcgZXhwcmVzc2lvbiB0byBjb21waWxlLlxuXHQgICAgICogQHJldHVybnMge2Z1bmN0aW9uKGNvbnRleHQsIGxvY2Fscyl9IGEgZnVuY3Rpb24gd2hpY2ggcmVwcmVzZW50cyB0aGUgY29tcGlsZWQgZXhwcmVzc2lvbjpcblx0ICAgICAqXG5cdCAgICAgKiAgICAqIGBjb250ZXh0YCDigJMgYHtvYmplY3R9YCDigJMgYW4gb2JqZWN0IGFnYWluc3Qgd2hpY2ggYW55IGV4cHJlc3Npb25zIGVtYmVkZGVkIGluIHRoZSBzdHJpbmdzXG5cdCAgICAgKiAgICAgIGFyZSBldmFsdWF0ZWQgYWdhaW5zdCAodHlwaWNhbGx5IGEgc2NvcGUgb2JqZWN0KS5cblx0ICAgICAqICAgICogYGxvY2Fsc2Ag4oCTIGB7b2JqZWN0PX1gIOKAkyBsb2NhbCB2YXJpYWJsZXMgY29udGV4dCBvYmplY3QsIHVzZWZ1bCBmb3Igb3ZlcnJpZGluZyB2YWx1ZXMgaW5cblx0ICAgICAqICAgICAgYGNvbnRleHRgLlxuXHQgICAgICovXG5cdFxuXHQgICAgLy8gU2hvcnRoYW5kIGRlbGVnYXRpb25zLlxuXHQgICAgdmFyIHBhcnNlID0gc2NlLnBhcnNlQXMsXG5cdCAgICAgICAgZ2V0VHJ1c3RlZCA9IHNjZS5nZXRUcnVzdGVkLFxuXHQgICAgICAgIHRydXN0QXMgPSBzY2UudHJ1c3RBcztcblx0XG5cdCAgICBmb3JFYWNoKFNDRV9DT05URVhUUywgZnVuY3Rpb24oZW51bVZhbHVlLCBuYW1lKSB7XG5cdCAgICAgIHZhciBsTmFtZSA9IGxvd2VyY2FzZShuYW1lKTtcblx0ICAgICAgc2NlW2NhbWVsQ2FzZShcInBhcnNlX2FzX1wiICsgbE5hbWUpXSA9IGZ1bmN0aW9uKGV4cHIpIHtcblx0ICAgICAgICByZXR1cm4gcGFyc2UoZW51bVZhbHVlLCBleHByKTtcblx0ICAgICAgfTtcblx0ICAgICAgc2NlW2NhbWVsQ2FzZShcImdldF90cnVzdGVkX1wiICsgbE5hbWUpXSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgcmV0dXJuIGdldFRydXN0ZWQoZW51bVZhbHVlLCB2YWx1ZSk7XG5cdCAgICAgIH07XG5cdCAgICAgIHNjZVtjYW1lbENhc2UoXCJ0cnVzdF9hc19cIiArIGxOYW1lKV0gPSBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgIHJldHVybiB0cnVzdEFzKGVudW1WYWx1ZSwgdmFsdWUpO1xuXHQgICAgICB9O1xuXHQgICAgfSk7XG5cdFxuXHQgICAgcmV0dXJuIHNjZTtcblx0ICB9XTtcblx0fVxuXHRcblx0LyoqXG5cdCAqICEhISBUaGlzIGlzIGFuIHVuZG9jdW1lbnRlZCBcInByaXZhdGVcIiBzZXJ2aWNlICEhIVxuXHQgKlxuXHQgKiBAbmFtZSAkc25pZmZlclxuXHQgKiBAcmVxdWlyZXMgJHdpbmRvd1xuXHQgKiBAcmVxdWlyZXMgJGRvY3VtZW50XG5cdCAqXG5cdCAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gaGlzdG9yeSBEb2VzIHRoZSBicm93c2VyIHN1cHBvcnQgaHRtbDUgaGlzdG9yeSBhcGkgP1xuXHQgKiBAcHJvcGVydHkge2Jvb2xlYW59IHRyYW5zaXRpb25zIERvZXMgdGhlIGJyb3dzZXIgc3VwcG9ydCBDU1MgdHJhbnNpdGlvbiBldmVudHMgP1xuXHQgKiBAcHJvcGVydHkge2Jvb2xlYW59IGFuaW1hdGlvbnMgRG9lcyB0aGUgYnJvd3NlciBzdXBwb3J0IENTUyBhbmltYXRpb24gZXZlbnRzID9cblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFRoaXMgaXMgdmVyeSBzaW1wbGUgaW1wbGVtZW50YXRpb24gb2YgdGVzdGluZyBicm93c2VyJ3MgZmVhdHVyZXMuXG5cdCAqL1xuXHRmdW5jdGlvbiAkU25pZmZlclByb3ZpZGVyKCkge1xuXHQgIHRoaXMuJGdldCA9IFsnJHdpbmRvdycsICckZG9jdW1lbnQnLCBmdW5jdGlvbigkd2luZG93LCAkZG9jdW1lbnQpIHtcblx0ICAgIHZhciBldmVudFN1cHBvcnQgPSB7fSxcblx0ICAgICAgICBhbmRyb2lkID1cblx0ICAgICAgICAgIHRvSW50KCgvYW5kcm9pZCAoXFxkKykvLmV4ZWMobG93ZXJjYXNlKCgkd2luZG93Lm5hdmlnYXRvciB8fCB7fSkudXNlckFnZW50KSkgfHwgW10pWzFdKSxcblx0ICAgICAgICBib3hlZSA9IC9Cb3hlZS9pLnRlc3QoKCR3aW5kb3cubmF2aWdhdG9yIHx8IHt9KS51c2VyQWdlbnQpLFxuXHQgICAgICAgIGRvY3VtZW50ID0gJGRvY3VtZW50WzBdIHx8IHt9LFxuXHQgICAgICAgIHZlbmRvclByZWZpeCxcblx0ICAgICAgICB2ZW5kb3JSZWdleCA9IC9eKE1venx3ZWJraXR8bXMpKD89W0EtWl0pLyxcblx0ICAgICAgICBib2R5U3R5bGUgPSBkb2N1bWVudC5ib2R5ICYmIGRvY3VtZW50LmJvZHkuc3R5bGUsXG5cdCAgICAgICAgdHJhbnNpdGlvbnMgPSBmYWxzZSxcblx0ICAgICAgICBhbmltYXRpb25zID0gZmFsc2UsXG5cdCAgICAgICAgbWF0Y2g7XG5cdFxuXHQgICAgaWYgKGJvZHlTdHlsZSkge1xuXHQgICAgICBmb3IgKHZhciBwcm9wIGluIGJvZHlTdHlsZSkge1xuXHQgICAgICAgIGlmIChtYXRjaCA9IHZlbmRvclJlZ2V4LmV4ZWMocHJvcCkpIHtcblx0ICAgICAgICAgIHZlbmRvclByZWZpeCA9IG1hdGNoWzBdO1xuXHQgICAgICAgICAgdmVuZG9yUHJlZml4ID0gdmVuZG9yUHJlZml4LnN1YnN0cigwLCAxKS50b1VwcGVyQ2FzZSgpICsgdmVuZG9yUHJlZml4LnN1YnN0cigxKTtcblx0ICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHRcblx0ICAgICAgaWYgKCF2ZW5kb3JQcmVmaXgpIHtcblx0ICAgICAgICB2ZW5kb3JQcmVmaXggPSAoJ1dlYmtpdE9wYWNpdHknIGluIGJvZHlTdHlsZSkgJiYgJ3dlYmtpdCc7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHRyYW5zaXRpb25zID0gISEoKCd0cmFuc2l0aW9uJyBpbiBib2R5U3R5bGUpIHx8ICh2ZW5kb3JQcmVmaXggKyAnVHJhbnNpdGlvbicgaW4gYm9keVN0eWxlKSk7XG5cdCAgICAgIGFuaW1hdGlvbnMgID0gISEoKCdhbmltYXRpb24nIGluIGJvZHlTdHlsZSkgfHwgKHZlbmRvclByZWZpeCArICdBbmltYXRpb24nIGluIGJvZHlTdHlsZSkpO1xuXHRcblx0ICAgICAgaWYgKGFuZHJvaWQgJiYgKCF0cmFuc2l0aW9ucyB8fCAgIWFuaW1hdGlvbnMpKSB7XG5cdCAgICAgICAgdHJhbnNpdGlvbnMgPSBpc1N0cmluZyhib2R5U3R5bGUud2Via2l0VHJhbnNpdGlvbik7XG5cdCAgICAgICAgYW5pbWF0aW9ucyA9IGlzU3RyaW5nKGJvZHlTdHlsZS53ZWJraXRBbmltYXRpb24pO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHRcblx0ICAgIHJldHVybiB7XG5cdCAgICAgIC8vIEFuZHJvaWQgaGFzIGhpc3RvcnkucHVzaFN0YXRlLCBidXQgaXQgZG9lcyBub3QgdXBkYXRlIGxvY2F0aW9uIGNvcnJlY3RseVxuXHQgICAgICAvLyBzbyBsZXQncyBub3QgdXNlIHRoZSBoaXN0b3J5IEFQSSBhdCBhbGwuXG5cdCAgICAgIC8vIGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9hbmRyb2lkL2lzc3Vlcy9kZXRhaWw/aWQ9MTc0NzFcblx0ICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy9pc3N1ZXMvOTA0XG5cdFxuXHQgICAgICAvLyBvbGRlciB3ZWJraXQgYnJvd3NlciAoNTMzLjkpIG9uIEJveGVlIGJveCBoYXMgZXhhY3RseSB0aGUgc2FtZSBwcm9ibGVtIGFzIEFuZHJvaWQgaGFzXG5cdCAgICAgIC8vIHNvIGxldCdzIG5vdCB1c2UgdGhlIGhpc3RvcnkgQVBJIGFsc29cblx0ICAgICAgLy8gV2UgYXJlIHB1cnBvc2VmdWxseSB1c2luZyBgIShhbmRyb2lkIDwgNClgIHRvIGNvdmVyIHRoZSBjYXNlIHdoZW4gYGFuZHJvaWRgIGlzIHVuZGVmaW5lZFxuXHQgICAgICAvLyBqc2hpbnQgLVcwMThcblx0ICAgICAgaGlzdG9yeTogISEoJHdpbmRvdy5oaXN0b3J5ICYmICR3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUgJiYgIShhbmRyb2lkIDwgNCkgJiYgIWJveGVlKSxcblx0ICAgICAgLy8ganNoaW50ICtXMDE4XG5cdCAgICAgIGhhc0V2ZW50OiBmdW5jdGlvbihldmVudCkge1xuXHQgICAgICAgIC8vIElFOSBpbXBsZW1lbnRzICdpbnB1dCcgZXZlbnQgaXQncyBzbyBmdWJhcmVkIHRoYXQgd2UgcmF0aGVyIHByZXRlbmQgdGhhdCBpdCBkb2Vzbid0IGhhdmVcblx0ICAgICAgICAvLyBpdC4gSW4gcGFydGljdWxhciB0aGUgZXZlbnQgaXMgbm90IGZpcmVkIHdoZW4gYmFja3NwYWNlIG9yIGRlbGV0ZSBrZXkgYXJlIHByZXNzZWQgb3Jcblx0ICAgICAgICAvLyB3aGVuIGN1dCBvcGVyYXRpb24gaXMgcGVyZm9ybWVkLlxuXHQgICAgICAgIC8vIElFMTArIGltcGxlbWVudHMgJ2lucHV0JyBldmVudCBidXQgaXQgZXJyb25lb3VzbHkgZmlyZXMgdW5kZXIgdmFyaW91cyBzaXR1YXRpb25zLFxuXHQgICAgICAgIC8vIGUuZy4gd2hlbiBwbGFjZWhvbGRlciBjaGFuZ2VzLCBvciBhIGZvcm0gaXMgZm9jdXNlZC5cblx0ICAgICAgICBpZiAoZXZlbnQgPT09ICdpbnB1dCcgJiYgbXNpZSA8PSAxMSkgcmV0dXJuIGZhbHNlO1xuXHRcblx0ICAgICAgICBpZiAoaXNVbmRlZmluZWQoZXZlbnRTdXBwb3J0W2V2ZW50XSkpIHtcblx0ICAgICAgICAgIHZhciBkaXZFbG0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0ICAgICAgICAgIGV2ZW50U3VwcG9ydFtldmVudF0gPSAnb24nICsgZXZlbnQgaW4gZGl2RWxtO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIGV2ZW50U3VwcG9ydFtldmVudF07XG5cdCAgICAgIH0sXG5cdCAgICAgIGNzcDogY3NwKCksXG5cdCAgICAgIHZlbmRvclByZWZpeDogdmVuZG9yUHJlZml4LFxuXHQgICAgICB0cmFuc2l0aW9uczogdHJhbnNpdGlvbnMsXG5cdCAgICAgIGFuaW1hdGlvbnM6IGFuaW1hdGlvbnMsXG5cdCAgICAgIGFuZHJvaWQ6IGFuZHJvaWRcblx0ICAgIH07XG5cdCAgfV07XG5cdH1cblx0XG5cdHZhciAkY29tcGlsZU1pbkVyciA9IG1pbkVycignJGNvbXBpbGUnKTtcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgcHJvdmlkZXJcblx0ICogQG5hbWUgJHRlbXBsYXRlUmVxdWVzdFByb3ZpZGVyXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBVc2VkIHRvIGNvbmZpZ3VyZSB0aGUgb3B0aW9ucyBwYXNzZWQgdG8gdGhlIHtAbGluayAkaHR0cH0gc2VydmljZSB3aGVuIG1ha2luZyBhIHRlbXBsYXRlIHJlcXVlc3QuXG5cdCAqXG5cdCAqIEZvciBleGFtcGxlLCBpdCBjYW4gYmUgdXNlZCBmb3Igc3BlY2lmeWluZyB0aGUgXCJBY2NlcHRcIiBoZWFkZXIgdGhhdCBpcyBzZW50IHRvIHRoZSBzZXJ2ZXIsIHdoZW5cblx0ICogcmVxdWVzdGluZyBhIHRlbXBsYXRlLlxuXHQgKi9cblx0ZnVuY3Rpb24gJFRlbXBsYXRlUmVxdWVzdFByb3ZpZGVyKCkge1xuXHRcblx0ICB2YXIgaHR0cE9wdGlvbnM7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSAkdGVtcGxhdGVSZXF1ZXN0UHJvdmlkZXIjaHR0cE9wdGlvbnNcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBUaGUgb3B0aW9ucyB0byBiZSBwYXNzZWQgdG8gdGhlIHtAbGluayAkaHR0cH0gc2VydmljZSB3aGVuIG1ha2luZyB0aGUgcmVxdWVzdC5cblx0ICAgKiBZb3UgY2FuIHVzZSB0aGlzIHRvIG92ZXJyaWRlIG9wdGlvbnMgc3VjaCBhcyB0aGUgXCJBY2NlcHRcIiBoZWFkZXIgZm9yIHRlbXBsYXRlIHJlcXVlc3RzLlxuXHQgICAqXG5cdCAgICogVGhlIHtAbGluayAkdGVtcGxhdGVSZXF1ZXN0fSB3aWxsIHNldCB0aGUgYGNhY2hlYCBhbmQgdGhlIGB0cmFuc2Zvcm1SZXNwb25zZWAgcHJvcGVydGllcyBvZiB0aGVcblx0ICAgKiBvcHRpb25zIGlmIG5vdCBvdmVycmlkZGVuIGhlcmUuXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IHZhbHVlIG5ldyB2YWx1ZSBmb3IgdGhlIHtAbGluayAkaHR0cH0gb3B0aW9ucy5cblx0ICAgKiBAcmV0dXJucyB7c3RyaW5nfHNlbGZ9IFJldHVybnMgdGhlIHtAbGluayAkaHR0cH0gb3B0aW9ucyB3aGVuIHVzZWQgYXMgZ2V0dGVyIGFuZCBzZWxmIGlmIHVzZWQgYXMgc2V0dGVyLlxuXHQgICAqL1xuXHQgIHRoaXMuaHR0cE9wdGlvbnMgPSBmdW5jdGlvbih2YWwpIHtcblx0ICAgIGlmICh2YWwpIHtcblx0ICAgICAgaHR0cE9wdGlvbnMgPSB2YWw7XG5cdCAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIGh0dHBPcHRpb25zO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBzZXJ2aWNlXG5cdCAgICogQG5hbWUgJHRlbXBsYXRlUmVxdWVzdFxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogVGhlIGAkdGVtcGxhdGVSZXF1ZXN0YCBzZXJ2aWNlIHJ1bnMgc2VjdXJpdHkgY2hlY2tzIHRoZW4gZG93bmxvYWRzIHRoZSBwcm92aWRlZCB0ZW1wbGF0ZSB1c2luZ1xuXHQgICAqIGAkaHR0cGAgYW5kLCB1cG9uIHN1Y2Nlc3MsIHN0b3JlcyB0aGUgY29udGVudHMgaW5zaWRlIG9mIGAkdGVtcGxhdGVDYWNoZWAuIElmIHRoZSBIVFRQIHJlcXVlc3Rcblx0ICAgKiBmYWlscyBvciB0aGUgcmVzcG9uc2UgZGF0YSBvZiB0aGUgSFRUUCByZXF1ZXN0IGlzIGVtcHR5LCBhIGAkY29tcGlsZWAgZXJyb3Igd2lsbCBiZSB0aHJvd24gKHRoZVxuXHQgICAqIGV4Y2VwdGlvbiBjYW4gYmUgdGh3YXJ0ZWQgYnkgc2V0dGluZyB0aGUgMm5kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gdG8gdHJ1ZSkuIE5vdGUgdGhhdCB0aGVcblx0ICAgKiBjb250ZW50cyBvZiBgJHRlbXBsYXRlQ2FjaGVgIGFyZSB0cnVzdGVkLCBzbyB0aGUgY2FsbCB0byBgJHNjZS5nZXRUcnVzdGVkVXJsKHRwbClgIGlzIG9taXR0ZWRcblx0ICAgKiB3aGVuIGB0cGxgIGlzIG9mIHR5cGUgc3RyaW5nIGFuZCBgJHRlbXBsYXRlQ2FjaGVgIGhhcyB0aGUgbWF0Y2hpbmcgZW50cnkuXG5cdCAgICpcblx0ICAgKiBJZiB5b3Ugd2FudCB0byBwYXNzIGN1c3RvbSBvcHRpb25zIHRvIHRoZSBgJGh0dHBgIHNlcnZpY2UsIHN1Y2ggYXMgc2V0dGluZyB0aGUgQWNjZXB0IGhlYWRlciB5b3Vcblx0ICAgKiBjYW4gY29uZmlndXJlIHRoaXMgdmlhIHtAbGluayAkdGVtcGxhdGVSZXF1ZXN0UHJvdmlkZXIjaHR0cE9wdGlvbnN9LlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtzdHJpbmd8VHJ1c3RlZFJlc291cmNlVXJsfSB0cGwgVGhlIEhUVFAgcmVxdWVzdCB0ZW1wbGF0ZSBVUkxcblx0ICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBpZ25vcmVSZXF1ZXN0RXJyb3IgV2hldGhlciBvciBub3QgdG8gaWdub3JlIHRoZSBleGNlcHRpb24gd2hlbiB0aGUgcmVxdWVzdCBmYWlscyBvciB0aGUgdGVtcGxhdGUgaXMgZW1wdHlcblx0ICAgKlxuXHQgICAqIEByZXR1cm4ge1Byb21pc2V9IGEgcHJvbWlzZSBmb3IgdGhlIEhUVFAgcmVzcG9uc2UgZGF0YSBvZiB0aGUgZ2l2ZW4gVVJMLlxuXHQgICAqXG5cdCAgICogQHByb3BlcnR5IHtudW1iZXJ9IHRvdGFsUGVuZGluZ1JlcXVlc3RzIHRvdGFsIGFtb3VudCBvZiBwZW5kaW5nIHRlbXBsYXRlIHJlcXVlc3RzIGJlaW5nIGRvd25sb2FkZWQuXG5cdCAgICovXG5cdCAgdGhpcy4kZ2V0ID0gWyckdGVtcGxhdGVDYWNoZScsICckaHR0cCcsICckcScsICckc2NlJywgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUsICRodHRwLCAkcSwgJHNjZSkge1xuXHRcblx0ICAgIGZ1bmN0aW9uIGhhbmRsZVJlcXVlc3RGbih0cGwsIGlnbm9yZVJlcXVlc3RFcnJvcikge1xuXHQgICAgICBoYW5kbGVSZXF1ZXN0Rm4udG90YWxQZW5kaW5nUmVxdWVzdHMrKztcblx0XG5cdCAgICAgIC8vIFdlIGNvbnNpZGVyIHRoZSB0ZW1wbGF0ZSBjYWNoZSBob2xkcyBvbmx5IHRydXN0ZWQgdGVtcGxhdGVzLCBzb1xuXHQgICAgICAvLyB0aGVyZSdzIG5vIG5lZWQgdG8gZ28gdGhyb3VnaCB3aGl0ZWxpc3RpbmcgYWdhaW4gZm9yIGtleXMgdGhhdCBhbHJlYWR5XG5cdCAgICAgIC8vIGFyZSBpbmNsdWRlZCBpbiB0aGVyZS4gVGhpcyBhbHNvIG1ha2VzIEFuZ3VsYXIgYWNjZXB0IGFueSBzY3JpcHRcblx0ICAgICAgLy8gZGlyZWN0aXZlLCBubyBtYXR0ZXIgaXRzIG5hbWUuIEhvd2V2ZXIsIHdlIHN0aWxsIG5lZWQgdG8gdW53cmFwIHRydXN0ZWRcblx0ICAgICAgLy8gdHlwZXMuXG5cdCAgICAgIGlmICghaXNTdHJpbmcodHBsKSB8fCAhJHRlbXBsYXRlQ2FjaGUuZ2V0KHRwbCkpIHtcblx0ICAgICAgICB0cGwgPSAkc2NlLmdldFRydXN0ZWRSZXNvdXJjZVVybCh0cGwpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICB2YXIgdHJhbnNmb3JtUmVzcG9uc2UgPSAkaHR0cC5kZWZhdWx0cyAmJiAkaHR0cC5kZWZhdWx0cy50cmFuc2Zvcm1SZXNwb25zZTtcblx0XG5cdCAgICAgIGlmIChpc0FycmF5KHRyYW5zZm9ybVJlc3BvbnNlKSkge1xuXHQgICAgICAgIHRyYW5zZm9ybVJlc3BvbnNlID0gdHJhbnNmb3JtUmVzcG9uc2UuZmlsdGVyKGZ1bmN0aW9uKHRyYW5zZm9ybWVyKSB7XG5cdCAgICAgICAgICByZXR1cm4gdHJhbnNmb3JtZXIgIT09IGRlZmF1bHRIdHRwUmVzcG9uc2VUcmFuc2Zvcm07XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH0gZWxzZSBpZiAodHJhbnNmb3JtUmVzcG9uc2UgPT09IGRlZmF1bHRIdHRwUmVzcG9uc2VUcmFuc2Zvcm0pIHtcblx0ICAgICAgICB0cmFuc2Zvcm1SZXNwb25zZSA9IG51bGw7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiAkaHR0cC5nZXQodHBsLCBleHRlbmQoe1xuXHQgICAgICAgICAgY2FjaGU6ICR0ZW1wbGF0ZUNhY2hlLFxuXHQgICAgICAgICAgdHJhbnNmb3JtUmVzcG9uc2U6IHRyYW5zZm9ybVJlc3BvbnNlXG5cdCAgICAgICAgfSwgaHR0cE9wdGlvbnMpKVxuXHQgICAgICAgIFsnZmluYWxseSddKGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgaGFuZGxlUmVxdWVzdEZuLnRvdGFsUGVuZGluZ1JlcXVlc3RzLS07XG5cdCAgICAgICAgfSlcblx0ICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuXHQgICAgICAgICAgJHRlbXBsYXRlQ2FjaGUucHV0KHRwbCwgcmVzcG9uc2UuZGF0YSk7XG5cdCAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcblx0ICAgICAgICB9LCBoYW5kbGVFcnJvcik7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBoYW5kbGVFcnJvcihyZXNwKSB7XG5cdCAgICAgICAgaWYgKCFpZ25vcmVSZXF1ZXN0RXJyb3IpIHtcblx0ICAgICAgICAgIHRocm93ICRjb21waWxlTWluRXJyKCd0cGxvYWQnLCAnRmFpbGVkIHRvIGxvYWQgdGVtcGxhdGU6IHswfSAoSFRUUCBzdGF0dXM6IHsxfSB7Mn0pJyxcblx0ICAgICAgICAgICAgdHBsLCByZXNwLnN0YXR1cywgcmVzcC5zdGF0dXNUZXh0KTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGhhbmRsZVJlcXVlc3RGbi50b3RhbFBlbmRpbmdSZXF1ZXN0cyA9IDA7XG5cdFxuXHQgICAgcmV0dXJuIGhhbmRsZVJlcXVlc3RGbjtcblx0ICB9XTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gJCRUZXN0YWJpbGl0eVByb3ZpZGVyKCkge1xuXHQgIHRoaXMuJGdldCA9IFsnJHJvb3RTY29wZScsICckYnJvd3NlcicsICckbG9jYXRpb24nLFxuXHQgICAgICAgZnVuY3Rpb24oJHJvb3RTY29wZSwgICAkYnJvd3NlciwgICAkbG9jYXRpb24pIHtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuYW1lICR0ZXN0YWJpbGl0eVxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogVGhlIHByaXZhdGUgJCR0ZXN0YWJpbGl0eSBzZXJ2aWNlIHByb3ZpZGVzIGEgY29sbGVjdGlvbiBvZiBtZXRob2RzIGZvciB1c2Ugd2hlbiBkZWJ1Z2dpbmdcblx0ICAgICAqIG9yIGJ5IGF1dG9tYXRlZCB0ZXN0IGFuZCBkZWJ1Z2dpbmcgdG9vbHMuXG5cdCAgICAgKi9cblx0ICAgIHZhciB0ZXN0YWJpbGl0eSA9IHt9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5hbWUgJCR0ZXN0YWJpbGl0eSNmaW5kQmluZGluZ3Ncblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIFJldHVybnMgYW4gYXJyYXkgb2YgZWxlbWVudHMgdGhhdCBhcmUgYm91bmQgKHZpYSBuZy1iaW5kIG9yIHt7fX0pXG5cdCAgICAgKiB0byBleHByZXNzaW9ucyBtYXRjaGluZyB0aGUgaW5wdXQuXG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IFRoZSBlbGVtZW50IHJvb3QgdG8gc2VhcmNoIGZyb20uXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXhwcmVzc2lvbiBUaGUgYmluZGluZyBleHByZXNzaW9uIHRvIG1hdGNoLlxuXHQgICAgICogQHBhcmFtIHtib29sZWFufSBvcHRfZXhhY3RNYXRjaCBJZiB0cnVlLCBvbmx5IHJldHVybnMgZXhhY3QgbWF0Y2hlc1xuXHQgICAgICogICAgIGZvciB0aGUgZXhwcmVzc2lvbi4gRmlsdGVycyBhbmQgd2hpdGVzcGFjZSBhcmUgaWdub3JlZC5cblx0ICAgICAqL1xuXHQgICAgdGVzdGFiaWxpdHkuZmluZEJpbmRpbmdzID0gZnVuY3Rpb24oZWxlbWVudCwgZXhwcmVzc2lvbiwgb3B0X2V4YWN0TWF0Y2gpIHtcblx0ICAgICAgdmFyIGJpbmRpbmdzID0gZWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCduZy1iaW5kaW5nJyk7XG5cdCAgICAgIHZhciBtYXRjaGVzID0gW107XG5cdCAgICAgIGZvckVhY2goYmluZGluZ3MsIGZ1bmN0aW9uKGJpbmRpbmcpIHtcblx0ICAgICAgICB2YXIgZGF0YUJpbmRpbmcgPSBhbmd1bGFyLmVsZW1lbnQoYmluZGluZykuZGF0YSgnJGJpbmRpbmcnKTtcblx0ICAgICAgICBpZiAoZGF0YUJpbmRpbmcpIHtcblx0ICAgICAgICAgIGZvckVhY2goZGF0YUJpbmRpbmcsIGZ1bmN0aW9uKGJpbmRpbmdOYW1lKSB7XG5cdCAgICAgICAgICAgIGlmIChvcHRfZXhhY3RNYXRjaCkge1xuXHQgICAgICAgICAgICAgIHZhciBtYXRjaGVyID0gbmV3IFJlZ0V4cCgnKF58XFxcXHMpJyArIGVzY2FwZUZvclJlZ2V4cChleHByZXNzaW9uKSArICcoXFxcXHN8XFxcXHx8JCknKTtcblx0ICAgICAgICAgICAgICBpZiAobWF0Y2hlci50ZXN0KGJpbmRpbmdOYW1lKSkge1xuXHQgICAgICAgICAgICAgICAgbWF0Y2hlcy5wdXNoKGJpbmRpbmcpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICBpZiAoYmluZGluZ05hbWUuaW5kZXhPZihleHByZXNzaW9uKSAhPSAtMSkge1xuXHQgICAgICAgICAgICAgICAgbWF0Y2hlcy5wdXNoKGJpbmRpbmcpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0ICAgICAgcmV0dXJuIG1hdGNoZXM7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5hbWUgJCR0ZXN0YWJpbGl0eSNmaW5kTW9kZWxzXG5cdCAgICAgKlxuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIGVsZW1lbnRzIHRoYXQgYXJlIHR3by13YXkgZm91bmQgdmlhIG5nLW1vZGVsIHRvXG5cdCAgICAgKiBleHByZXNzaW9ucyBtYXRjaGluZyB0aGUgaW5wdXQuXG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IFRoZSBlbGVtZW50IHJvb3QgdG8gc2VhcmNoIGZyb20uXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXhwcmVzc2lvbiBUaGUgbW9kZWwgZXhwcmVzc2lvbiB0byBtYXRjaC5cblx0ICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0X2V4YWN0TWF0Y2ggSWYgdHJ1ZSwgb25seSByZXR1cm5zIGV4YWN0IG1hdGNoZXNcblx0ICAgICAqICAgICBmb3IgdGhlIGV4cHJlc3Npb24uXG5cdCAgICAgKi9cblx0ICAgIHRlc3RhYmlsaXR5LmZpbmRNb2RlbHMgPSBmdW5jdGlvbihlbGVtZW50LCBleHByZXNzaW9uLCBvcHRfZXhhY3RNYXRjaCkge1xuXHQgICAgICB2YXIgcHJlZml4ZXMgPSBbJ25nLScsICdkYXRhLW5nLScsICduZ1xcXFw6J107XG5cdCAgICAgIGZvciAodmFyIHAgPSAwOyBwIDwgcHJlZml4ZXMubGVuZ3RoOyArK3ApIHtcblx0ICAgICAgICB2YXIgYXR0cmlidXRlRXF1YWxzID0gb3B0X2V4YWN0TWF0Y2ggPyAnPScgOiAnKj0nO1xuXHQgICAgICAgIHZhciBzZWxlY3RvciA9ICdbJyArIHByZWZpeGVzW3BdICsgJ21vZGVsJyArIGF0dHJpYnV0ZUVxdWFscyArICdcIicgKyBleHByZXNzaW9uICsgJ1wiXSc7XG5cdCAgICAgICAgdmFyIGVsZW1lbnRzID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcblx0ICAgICAgICBpZiAoZWxlbWVudHMubGVuZ3RoKSB7XG5cdCAgICAgICAgICByZXR1cm4gZWxlbWVudHM7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5hbWUgJCR0ZXN0YWJpbGl0eSNnZXRMb2NhdGlvblxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogU2hvcnRjdXQgZm9yIGdldHRpbmcgdGhlIGxvY2F0aW9uIGluIGEgYnJvd3NlciBhZ25vc3RpYyB3YXkuIFJldHVybnNcblx0ICAgICAqICAgICB0aGUgcGF0aCwgc2VhcmNoLCBhbmQgaGFzaC4gKGUuZy4gL3BhdGg/YT1iI2hhc2gpXG5cdCAgICAgKi9cblx0ICAgIHRlc3RhYmlsaXR5LmdldExvY2F0aW9uID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHJldHVybiAkbG9jYXRpb24udXJsKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5hbWUgJCR0ZXN0YWJpbGl0eSNzZXRMb2NhdGlvblxuXHQgICAgICpcblx0ICAgICAqIEBkZXNjcmlwdGlvblxuXHQgICAgICogU2hvcnRjdXQgZm9yIG5hdmlnYXRpbmcgdG8gYSBsb2NhdGlvbiB3aXRob3V0IGRvaW5nIGEgZnVsbCBwYWdlIHJlbG9hZC5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIFRoZSBsb2NhdGlvbiB1cmwgKHBhdGgsIHNlYXJjaCBhbmQgaGFzaCxcblx0ICAgICAqICAgICBlLmcuIC9wYXRoP2E9YiNoYXNoKSB0byBnbyB0by5cblx0ICAgICAqL1xuXHQgICAgdGVzdGFiaWxpdHkuc2V0TG9jYXRpb24gPSBmdW5jdGlvbih1cmwpIHtcblx0ICAgICAgaWYgKHVybCAhPT0gJGxvY2F0aW9uLnVybCgpKSB7XG5cdCAgICAgICAgJGxvY2F0aW9uLnVybCh1cmwpO1xuXHQgICAgICAgICRyb290U2NvcGUuJGRpZ2VzdCgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQG5hbWUgJCR0ZXN0YWJpbGl0eSN3aGVuU3RhYmxlXG5cdCAgICAgKlxuXHQgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgKiBDYWxscyB0aGUgY2FsbGJhY2sgd2hlbiAkdGltZW91dCBhbmQgJGh0dHAgcmVxdWVzdHMgYXJlIGNvbXBsZXRlZC5cblx0ICAgICAqXG5cdCAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFja1xuXHQgICAgICovXG5cdCAgICB0ZXN0YWJpbGl0eS53aGVuU3RhYmxlID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0ICAgICAgJGJyb3dzZXIubm90aWZ5V2hlbk5vT3V0c3RhbmRpbmdSZXF1ZXN0cyhjYWxsYmFjayk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiB0ZXN0YWJpbGl0eTtcblx0ICB9XTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gJFRpbWVvdXRQcm92aWRlcigpIHtcblx0ICB0aGlzLiRnZXQgPSBbJyRyb290U2NvcGUnLCAnJGJyb3dzZXInLCAnJHEnLCAnJCRxJywgJyRleGNlcHRpb25IYW5kbGVyJyxcblx0ICAgICAgIGZ1bmN0aW9uKCRyb290U2NvcGUsICAgJGJyb3dzZXIsICAgJHEsICAgJCRxLCAgICRleGNlcHRpb25IYW5kbGVyKSB7XG5cdFxuXHQgICAgdmFyIGRlZmVycmVkcyA9IHt9O1xuXHRcblx0XG5cdCAgICAgLyoqXG5cdCAgICAgICogQG5nZG9jIHNlcnZpY2Vcblx0ICAgICAgKiBAbmFtZSAkdGltZW91dFxuXHQgICAgICAqXG5cdCAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICogQW5ndWxhcidzIHdyYXBwZXIgZm9yIGB3aW5kb3cuc2V0VGltZW91dGAuIFRoZSBgZm5gIGZ1bmN0aW9uIGlzIHdyYXBwZWQgaW50byBhIHRyeS9jYXRjaFxuXHQgICAgICAqIGJsb2NrIGFuZCBkZWxlZ2F0ZXMgYW55IGV4Y2VwdGlvbnMgdG9cblx0ICAgICAgKiB7QGxpbmsgbmcuJGV4Y2VwdGlvbkhhbmRsZXIgJGV4Y2VwdGlvbkhhbmRsZXJ9IHNlcnZpY2UuXG5cdCAgICAgICpcblx0ICAgICAgKiBUaGUgcmV0dXJuIHZhbHVlIG9mIGNhbGxpbmcgYCR0aW1lb3V0YCBpcyBhIHByb21pc2UsIHdoaWNoIHdpbGwgYmUgcmVzb2x2ZWQgd2hlblxuXHQgICAgICAqIHRoZSBkZWxheSBoYXMgcGFzc2VkIGFuZCB0aGUgdGltZW91dCBmdW5jdGlvbiwgaWYgcHJvdmlkZWQsIGlzIGV4ZWN1dGVkLlxuXHQgICAgICAqXG5cdCAgICAgICogVG8gY2FuY2VsIGEgdGltZW91dCByZXF1ZXN0LCBjYWxsIGAkdGltZW91dC5jYW5jZWwocHJvbWlzZSlgLlxuXHQgICAgICAqXG5cdCAgICAgICogSW4gdGVzdHMgeW91IGNhbiB1c2Uge0BsaW5rIG5nTW9jay4kdGltZW91dCBgJHRpbWVvdXQuZmx1c2goKWB9IHRvXG5cdCAgICAgICogc3luY2hyb25vdXNseSBmbHVzaCB0aGUgcXVldWUgb2YgZGVmZXJyZWQgZnVuY3Rpb25zLlxuXHQgICAgICAqXG5cdCAgICAgICogSWYgeW91IG9ubHkgd2FudCBhIHByb21pc2UgdGhhdCB3aWxsIGJlIHJlc29sdmVkIGFmdGVyIHNvbWUgc3BlY2lmaWVkIGRlbGF5XG5cdCAgICAgICogdGhlbiB5b3UgY2FuIGNhbGwgYCR0aW1lb3V0YCB3aXRob3V0IHRoZSBgZm5gIGZ1bmN0aW9uLlxuXHQgICAgICAqXG5cdCAgICAgICogQHBhcmFtIHtmdW5jdGlvbigpPX0gZm4gQSBmdW5jdGlvbiwgd2hvc2UgZXhlY3V0aW9uIHNob3VsZCBiZSBkZWxheWVkLlxuXHQgICAgICAqIEBwYXJhbSB7bnVtYmVyPX0gW2RlbGF5PTBdIERlbGF5IGluIG1pbGxpc2Vjb25kcy5cblx0ICAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBbaW52b2tlQXBwbHk9dHJ1ZV0gSWYgc2V0IHRvIGBmYWxzZWAgc2tpcHMgbW9kZWwgZGlydHkgY2hlY2tpbmcsIG90aGVyd2lzZVxuXHQgICAgICAqICAgd2lsbCBpbnZva2UgYGZuYCB3aXRoaW4gdGhlIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRhcHBseSAkYXBwbHl9IGJsb2NrLlxuXHQgICAgICAqIEBwYXJhbSB7Li4uKj19IFBhc3MgYWRkaXRpb25hbCBwYXJhbWV0ZXJzIHRvIHRoZSBleGVjdXRlZCBmdW5jdGlvbi5cblx0ICAgICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gUHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2hlbiB0aGUgdGltZW91dCBpcyByZWFjaGVkLiBUaGUgcHJvbWlzZVxuXHQgICAgICAqICAgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGBmbmAgZnVuY3Rpb24uXG5cdCAgICAgICpcblx0ICAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIHRpbWVvdXQoZm4sIGRlbGF5LCBpbnZva2VBcHBseSkge1xuXHQgICAgICBpZiAoIWlzRnVuY3Rpb24oZm4pKSB7XG5cdCAgICAgICAgaW52b2tlQXBwbHkgPSBkZWxheTtcblx0ICAgICAgICBkZWxheSA9IGZuO1xuXHQgICAgICAgIGZuID0gbm9vcDtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgdmFyIGFyZ3MgPSBzbGljZUFyZ3MoYXJndW1lbnRzLCAzKSxcblx0ICAgICAgICAgIHNraXBBcHBseSA9IChpc0RlZmluZWQoaW52b2tlQXBwbHkpICYmICFpbnZva2VBcHBseSksXG5cdCAgICAgICAgICBkZWZlcnJlZCA9IChza2lwQXBwbHkgPyAkJHEgOiAkcSkuZGVmZXIoKSxcblx0ICAgICAgICAgIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlLFxuXHQgICAgICAgICAgdGltZW91dElkO1xuXHRcblx0ICAgICAgdGltZW91dElkID0gJGJyb3dzZXIuZGVmZXIoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZm4uYXBwbHkobnVsbCwgYXJncykpO1xuXHQgICAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICAgIGRlZmVycmVkLnJlamVjdChlKTtcblx0ICAgICAgICAgICRleGNlcHRpb25IYW5kbGVyKGUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBmaW5hbGx5IHtcblx0ICAgICAgICAgIGRlbGV0ZSBkZWZlcnJlZHNbcHJvbWlzZS4kJHRpbWVvdXRJZF07XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAoIXNraXBBcHBseSkgJHJvb3RTY29wZS4kYXBwbHkoKTtcblx0ICAgICAgfSwgZGVsYXkpO1xuXHRcblx0ICAgICAgcHJvbWlzZS4kJHRpbWVvdXRJZCA9IHRpbWVvdXRJZDtcblx0ICAgICAgZGVmZXJyZWRzW3RpbWVvdXRJZF0gPSBkZWZlcnJlZDtcblx0XG5cdCAgICAgIHJldHVybiBwcm9taXNlO1xuXHQgICAgfVxuXHRcblx0XG5cdCAgICAgLyoqXG5cdCAgICAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAgICAqIEBuYW1lICR0aW1lb3V0I2NhbmNlbFxuXHQgICAgICAqXG5cdCAgICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAgICogQ2FuY2VscyBhIHRhc2sgYXNzb2NpYXRlZCB3aXRoIHRoZSBgcHJvbWlzZWAuIEFzIGEgcmVzdWx0IG9mIHRoaXMsIHRoZSBwcm9taXNlIHdpbGwgYmVcblx0ICAgICAgKiByZXNvbHZlZCB3aXRoIGEgcmVqZWN0aW9uLlxuXHQgICAgICAqXG5cdCAgICAgICogQHBhcmFtIHtQcm9taXNlPX0gcHJvbWlzZSBQcm9taXNlIHJldHVybmVkIGJ5IHRoZSBgJHRpbWVvdXRgIGZ1bmN0aW9uLlxuXHQgICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgdGFzayBoYXNuJ3QgZXhlY3V0ZWQgeWV0IGFuZCB3YXMgc3VjY2Vzc2Z1bGx5XG5cdCAgICAgICogICBjYW5jZWxlZC5cblx0ICAgICAgKi9cblx0ICAgIHRpbWVvdXQuY2FuY2VsID0gZnVuY3Rpb24ocHJvbWlzZSkge1xuXHQgICAgICBpZiAocHJvbWlzZSAmJiBwcm9taXNlLiQkdGltZW91dElkIGluIGRlZmVycmVkcykge1xuXHQgICAgICAgIGRlZmVycmVkc1twcm9taXNlLiQkdGltZW91dElkXS5yZWplY3QoJ2NhbmNlbGVkJyk7XG5cdCAgICAgICAgZGVsZXRlIGRlZmVycmVkc1twcm9taXNlLiQkdGltZW91dElkXTtcblx0ICAgICAgICByZXR1cm4gJGJyb3dzZXIuZGVmZXIuY2FuY2VsKHByb21pc2UuJCR0aW1lb3V0SWQpO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIHRpbWVvdXQ7XG5cdCAgfV07XG5cdH1cblx0XG5cdC8vIE5PVEU6ICBUaGUgdXNhZ2Ugb2Ygd2luZG93IGFuZCBkb2N1bWVudCBpbnN0ZWFkIG9mICR3aW5kb3cgYW5kICRkb2N1bWVudCBoZXJlIGlzXG5cdC8vIGRlbGliZXJhdGUuICBUaGlzIHNlcnZpY2UgZGVwZW5kcyBvbiB0aGUgc3BlY2lmaWMgYmVoYXZpb3Igb2YgYW5jaG9yIG5vZGVzIGNyZWF0ZWQgYnkgdGhlXG5cdC8vIGJyb3dzZXIgKHJlc29sdmluZyBhbmQgcGFyc2luZyBVUkxzKSB0aGF0IGlzIHVubGlrZWx5IHRvIGJlIHByb3ZpZGVkIGJ5IG1vY2sgb2JqZWN0cyBhbmRcblx0Ly8gY2F1c2UgdXMgdG8gYnJlYWsgdGVzdHMuICBJbiBhZGRpdGlvbiwgd2hlbiB0aGUgYnJvd3NlciByZXNvbHZlcyBhIFVSTCBmb3IgWEhSLCBpdFxuXHQvLyBkb2Vzbid0IGtub3cgYWJvdXQgbW9ja2VkIGxvY2F0aW9ucyBhbmQgcmVzb2x2ZXMgVVJMcyB0byB0aGUgcmVhbCBkb2N1bWVudCAtIHdoaWNoIGlzXG5cdC8vIGV4YWN0bHkgdGhlIGJlaGF2aW9yIG5lZWRlZCBoZXJlLiAgVGhlcmUgaXMgbGl0dGxlIHZhbHVlIGlzIG1vY2tpbmcgdGhlc2Ugb3V0IGZvciB0aGlzXG5cdC8vIHNlcnZpY2UuXG5cdHZhciB1cmxQYXJzaW5nTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xuXHR2YXIgb3JpZ2luVXJsID0gdXJsUmVzb2x2ZSh3aW5kb3cubG9jYXRpb24uaHJlZik7XG5cdFxuXHRcblx0LyoqXG5cdCAqXG5cdCAqIEltcGxlbWVudGF0aW9uIE5vdGVzIGZvciBub24tSUUgYnJvd3NlcnNcblx0ICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQgKiBBc3NpZ25pbmcgYSBVUkwgdG8gdGhlIGhyZWYgcHJvcGVydHkgb2YgYW4gYW5jaG9yIERPTSBub2RlLCBldmVuIG9uZSBhdHRhY2hlZCB0byB0aGUgRE9NLFxuXHQgKiByZXN1bHRzIGJvdGggaW4gdGhlIG5vcm1hbGl6aW5nIGFuZCBwYXJzaW5nIG9mIHRoZSBVUkwuICBOb3JtYWxpemluZyBtZWFucyB0aGF0IGEgcmVsYXRpdmVcblx0ICogVVJMIHdpbGwgYmUgcmVzb2x2ZWQgaW50byBhbiBhYnNvbHV0ZSBVUkwgaW4gdGhlIGNvbnRleHQgb2YgdGhlIGFwcGxpY2F0aW9uIGRvY3VtZW50LlxuXHQgKiBQYXJzaW5nIG1lYW5zIHRoYXQgdGhlIGFuY2hvciBub2RlJ3MgaG9zdCwgaG9zdG5hbWUsIHByb3RvY29sLCBwb3J0LCBwYXRobmFtZSBhbmQgcmVsYXRlZFxuXHQgKiBwcm9wZXJ0aWVzIGFyZSBhbGwgcG9wdWxhdGVkIHRvIHJlZmxlY3QgdGhlIG5vcm1hbGl6ZWQgVVJMLiAgVGhpcyBhcHByb2FjaCBoYXMgd2lkZVxuXHQgKiBjb21wYXRpYmlsaXR5IC0gU2FmYXJpIDErLCBNb3ppbGxhIDErLCBPcGVyYSA3KyxlIGV0Yy4gIFNlZVxuXHQgKiBodHRwOi8vd3d3LmFwdGFuYS5jb20vcmVmZXJlbmNlL2h0bWwvYXBpL0hUTUxBbmNob3JFbGVtZW50Lmh0bWxcblx0ICpcblx0ICogSW1wbGVtZW50YXRpb24gTm90ZXMgZm9yIElFXG5cdCAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQgKiBJRSA8PSAxMCBub3JtYWxpemVzIHRoZSBVUkwgd2hlbiBhc3NpZ25lZCB0byB0aGUgYW5jaG9yIG5vZGUgc2ltaWxhciB0byB0aGUgb3RoZXJcblx0ICogYnJvd3NlcnMuICBIb3dldmVyLCB0aGUgcGFyc2VkIGNvbXBvbmVudHMgd2lsbCBub3QgYmUgc2V0IGlmIHRoZSBVUkwgYXNzaWduZWQgZGlkIG5vdCBzcGVjaWZ5XG5cdCAqIHRoZW0uICAoZS5nLiBpZiB5b3UgYXNzaWduIGEuaHJlZiA9IFwiZm9vXCIsIHRoZW4gYS5wcm90b2NvbCwgYS5ob3N0LCBldGMuIHdpbGwgYmUgZW1wdHkuKSAgV2Vcblx0ICogd29yayBhcm91bmQgdGhhdCBieSBwZXJmb3JtaW5nIHRoZSBwYXJzaW5nIGluIGEgMm5kIHN0ZXAgYnkgdGFraW5nIGEgcHJldmlvdXNseSBub3JtYWxpemVkXG5cdCAqIFVSTCAoZS5nLiBieSBhc3NpZ25pbmcgdG8gYS5ocmVmKSBhbmQgYXNzaWduaW5nIGl0IGEuaHJlZiBhZ2Fpbi4gIFRoaXMgY29ycmVjdGx5IHBvcHVsYXRlcyB0aGVcblx0ICogcHJvcGVydGllcyBzdWNoIGFzIHByb3RvY29sLCBob3N0bmFtZSwgcG9ydCwgZXRjLlxuXHQgKlxuXHQgKiBSZWZlcmVuY2VzOlxuXHQgKiAgIGh0dHA6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hUTUxBbmNob3JFbGVtZW50XG5cdCAqICAgaHR0cDovL3d3dy5hcHRhbmEuY29tL3JlZmVyZW5jZS9odG1sL2FwaS9IVE1MQW5jaG9yRWxlbWVudC5odG1sXG5cdCAqICAgaHR0cDovL3VybC5zcGVjLndoYXR3Zy5vcmcvI3VybHV0aWxzXG5cdCAqICAgaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy9wdWxsLzI5MDJcblx0ICogICBodHRwOi8vamFtZXMucGFkb2xzZXkuY29tL2phdmFzY3JpcHQvcGFyc2luZy11cmxzLXdpdGgtdGhlLWRvbS9cblx0ICpcblx0ICogQGtpbmQgZnVuY3Rpb25cblx0ICogQHBhcmFtIHtzdHJpbmd9IHVybCBUaGUgVVJMIHRvIGJlIHBhcnNlZC5cblx0ICogQGRlc2NyaXB0aW9uIE5vcm1hbGl6ZXMgYW5kIHBhcnNlcyBhIFVSTC5cblx0ICogQHJldHVybnMge29iamVjdH0gUmV0dXJucyB0aGUgbm9ybWFsaXplZCBVUkwgYXMgYSBkaWN0aW9uYXJ5LlxuXHQgKlxuXHQgKiAgIHwgbWVtYmVyIG5hbWUgICB8IERlc2NyaXB0aW9uICAgIHxcblx0ICogICB8LS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS18XG5cdCAqICAgfCBocmVmICAgICAgICAgIHwgQSBub3JtYWxpemVkIHZlcnNpb24gb2YgdGhlIHByb3ZpZGVkIFVSTCBpZiBpdCB3YXMgbm90IGFuIGFic29sdXRlIFVSTCB8XG5cdCAqICAgfCBwcm90b2NvbCAgICAgIHwgVGhlIHByb3RvY29sIGluY2x1ZGluZyB0aGUgdHJhaWxpbmcgY29sb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG5cdCAqICAgfCBob3N0ICAgICAgICAgIHwgVGhlIGhvc3QgYW5kIHBvcnQgKGlmIHRoZSBwb3J0IGlzIG5vbi1kZWZhdWx0KSBvZiB0aGUgbm9ybWFsaXplZFVybCAgICB8XG5cdCAqICAgfCBzZWFyY2ggICAgICAgIHwgVGhlIHNlYXJjaCBwYXJhbXMsIG1pbnVzIHRoZSBxdWVzdGlvbiBtYXJrICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG5cdCAqICAgfCBoYXNoICAgICAgICAgIHwgVGhlIGhhc2ggc3RyaW5nLCBtaW51cyB0aGUgaGFzaCBzeW1ib2xcblx0ICogICB8IGhvc3RuYW1lICAgICAgfCBUaGUgaG9zdG5hbWVcblx0ICogICB8IHBvcnQgICAgICAgICAgfCBUaGUgcG9ydCwgd2l0aG91dCBcIjpcIlxuXHQgKiAgIHwgcGF0aG5hbWUgICAgICB8IFRoZSBwYXRobmFtZSwgYmVnaW5uaW5nIHdpdGggXCIvXCJcblx0ICpcblx0ICovXG5cdGZ1bmN0aW9uIHVybFJlc29sdmUodXJsKSB7XG5cdCAgdmFyIGhyZWYgPSB1cmw7XG5cdFxuXHQgIGlmIChtc2llKSB7XG5cdCAgICAvLyBOb3JtYWxpemUgYmVmb3JlIHBhcnNlLiAgUmVmZXIgSW1wbGVtZW50YXRpb24gTm90ZXMgb24gd2h5IHRoaXMgaXNcblx0ICAgIC8vIGRvbmUgaW4gdHdvIHN0ZXBzIG9uIElFLlxuXHQgICAgdXJsUGFyc2luZ05vZGUuc2V0QXR0cmlidXRlKFwiaHJlZlwiLCBocmVmKTtcblx0ICAgIGhyZWYgPSB1cmxQYXJzaW5nTm9kZS5ocmVmO1xuXHQgIH1cblx0XG5cdCAgdXJsUGFyc2luZ05vZGUuc2V0QXR0cmlidXRlKCdocmVmJywgaHJlZik7XG5cdFxuXHQgIC8vIHVybFBhcnNpbmdOb2RlIHByb3ZpZGVzIHRoZSBVcmxVdGlscyBpbnRlcmZhY2UgLSBodHRwOi8vdXJsLnNwZWMud2hhdHdnLm9yZy8jdXJsdXRpbHNcblx0ICByZXR1cm4ge1xuXHQgICAgaHJlZjogdXJsUGFyc2luZ05vZGUuaHJlZixcblx0ICAgIHByb3RvY29sOiB1cmxQYXJzaW5nTm9kZS5wcm90b2NvbCA/IHVybFBhcnNpbmdOb2RlLnByb3RvY29sLnJlcGxhY2UoLzokLywgJycpIDogJycsXG5cdCAgICBob3N0OiB1cmxQYXJzaW5nTm9kZS5ob3N0LFxuXHQgICAgc2VhcmNoOiB1cmxQYXJzaW5nTm9kZS5zZWFyY2ggPyB1cmxQYXJzaW5nTm9kZS5zZWFyY2gucmVwbGFjZSgvXlxcPy8sICcnKSA6ICcnLFxuXHQgICAgaGFzaDogdXJsUGFyc2luZ05vZGUuaGFzaCA/IHVybFBhcnNpbmdOb2RlLmhhc2gucmVwbGFjZSgvXiMvLCAnJykgOiAnJyxcblx0ICAgIGhvc3RuYW1lOiB1cmxQYXJzaW5nTm9kZS5ob3N0bmFtZSxcblx0ICAgIHBvcnQ6IHVybFBhcnNpbmdOb2RlLnBvcnQsXG5cdCAgICBwYXRobmFtZTogKHVybFBhcnNpbmdOb2RlLnBhdGhuYW1lLmNoYXJBdCgwKSA9PT0gJy8nKVxuXHQgICAgICA/IHVybFBhcnNpbmdOb2RlLnBhdGhuYW1lXG5cdCAgICAgIDogJy8nICsgdXJsUGFyc2luZ05vZGUucGF0aG5hbWVcblx0ICB9O1xuXHR9XG5cdFxuXHQvKipcblx0ICogUGFyc2UgYSByZXF1ZXN0IFVSTCBhbmQgZGV0ZXJtaW5lIHdoZXRoZXIgdGhpcyBpcyBhIHNhbWUtb3JpZ2luIHJlcXVlc3QgYXMgdGhlIGFwcGxpY2F0aW9uIGRvY3VtZW50LlxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ3xvYmplY3R9IHJlcXVlc3RVcmwgVGhlIHVybCBvZiB0aGUgcmVxdWVzdCBhcyBhIHN0cmluZyB0aGF0IHdpbGwgYmUgcmVzb2x2ZWRcblx0ICogb3IgYSBwYXJzZWQgVVJMIG9iamVjdC5cblx0ICogQHJldHVybnMge2Jvb2xlYW59IFdoZXRoZXIgdGhlIHJlcXVlc3QgaXMgZm9yIHRoZSBzYW1lIG9yaWdpbiBhcyB0aGUgYXBwbGljYXRpb24gZG9jdW1lbnQuXG5cdCAqL1xuXHRmdW5jdGlvbiB1cmxJc1NhbWVPcmlnaW4ocmVxdWVzdFVybCkge1xuXHQgIHZhciBwYXJzZWQgPSAoaXNTdHJpbmcocmVxdWVzdFVybCkpID8gdXJsUmVzb2x2ZShyZXF1ZXN0VXJsKSA6IHJlcXVlc3RVcmw7XG5cdCAgcmV0dXJuIChwYXJzZWQucHJvdG9jb2wgPT09IG9yaWdpblVybC5wcm90b2NvbCAmJlxuXHQgICAgICAgICAgcGFyc2VkLmhvc3QgPT09IG9yaWdpblVybC5ob3N0KTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBzZXJ2aWNlXG5cdCAqIEBuYW1lICR3aW5kb3dcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEEgcmVmZXJlbmNlIHRvIHRoZSBicm93c2VyJ3MgYHdpbmRvd2Agb2JqZWN0LiBXaGlsZSBgd2luZG93YFxuXHQgKiBpcyBnbG9iYWxseSBhdmFpbGFibGUgaW4gSmF2YVNjcmlwdCwgaXQgY2F1c2VzIHRlc3RhYmlsaXR5IHByb2JsZW1zLCBiZWNhdXNlXG5cdCAqIGl0IGlzIGEgZ2xvYmFsIHZhcmlhYmxlLiBJbiBhbmd1bGFyIHdlIGFsd2F5cyByZWZlciB0byBpdCB0aHJvdWdoIHRoZVxuXHQgKiBgJHdpbmRvd2Agc2VydmljZSwgc28gaXQgbWF5IGJlIG92ZXJyaWRkZW4sIHJlbW92ZWQgb3IgbW9ja2VkIGZvciB0ZXN0aW5nLlxuXHQgKlxuXHQgKiBFeHByZXNzaW9ucywgbGlrZSB0aGUgb25lIGRlZmluZWQgZm9yIHRoZSBgbmdDbGlja2AgZGlyZWN0aXZlIGluIHRoZSBleGFtcGxlXG5cdCAqIGJlbG93LCBhcmUgZXZhbHVhdGVkIHdpdGggcmVzcGVjdCB0byB0aGUgY3VycmVudCBzY29wZS4gIFRoZXJlZm9yZSwgdGhlcmUgaXNcblx0ICogbm8gcmlzayBvZiBpbmFkdmVydGVudGx5IGNvZGluZyBpbiBhIGRlcGVuZGVuY3kgb24gYSBnbG9iYWwgdmFsdWUgaW4gc3VjaCBhblxuXHQgKiBleHByZXNzaW9uLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZSBtb2R1bGU9XCJ3aW5kb3dFeGFtcGxlXCI+XG5cdCAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgIDxzY3JpcHQ+XG5cdCAgICAgICAgIGFuZ3VsYXIubW9kdWxlKCd3aW5kb3dFeGFtcGxlJywgW10pXG5cdCAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHdpbmRvdycsIGZ1bmN0aW9uKCRzY29wZSwgJHdpbmRvdykge1xuXHQgICAgICAgICAgICAgJHNjb3BlLmdyZWV0aW5nID0gJ0hlbGxvLCBXb3JsZCEnO1xuXHQgICAgICAgICAgICAgJHNjb3BlLmRvR3JlZXRpbmcgPSBmdW5jdGlvbihncmVldGluZykge1xuXHQgICAgICAgICAgICAgICAkd2luZG93LmFsZXJ0KGdyZWV0aW5nKTtcblx0ICAgICAgICAgICAgIH07XG5cdCAgICAgICAgICAgfV0pO1xuXHQgICAgICAgPC9zY3JpcHQ+XG5cdCAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cImdyZWV0aW5nXCIgYXJpYS1sYWJlbD1cImdyZWV0aW5nXCIgLz5cblx0ICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cImRvR3JlZXRpbmcoZ3JlZXRpbmcpXCI+QUxFUlQ8L2J1dHRvbj5cblx0ICAgICAgIDwvZGl2PlxuXHQgICAgIDwvZmlsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgIGl0KCdzaG91bGQgZGlzcGxheSB0aGUgZ3JlZXRpbmcgaW4gdGhlIGlucHV0IGJveCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgZWxlbWVudChieS5tb2RlbCgnZ3JlZXRpbmcnKSkuc2VuZEtleXMoJ0hlbGxvLCBFMkUgVGVzdHMnKTtcblx0ICAgICAgIC8vIElmIHdlIGNsaWNrIHRoZSBidXR0b24gaXQgd2lsbCBibG9jayB0aGUgdGVzdCBydW5uZXJcblx0ICAgICAgIC8vIGVsZW1lbnQoJzpidXR0b24nKS5jbGljaygpO1xuXHQgICAgICB9KTtcblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICovXG5cdGZ1bmN0aW9uICRXaW5kb3dQcm92aWRlcigpIHtcblx0ICB0aGlzLiRnZXQgPSB2YWx1ZUZuKHdpbmRvdyk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBAbmFtZSAkJGNvb2tpZVJlYWRlclxuXHQgKiBAcmVxdWlyZXMgJGRvY3VtZW50XG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUaGlzIGlzIGEgcHJpdmF0ZSBzZXJ2aWNlIGZvciByZWFkaW5nIGNvb2tpZXMgdXNlZCBieSAkaHR0cCBhbmQgbmdDb29raWVzXG5cdCAqXG5cdCAqIEByZXR1cm4ge09iamVjdH0gYSBrZXkvdmFsdWUgbWFwIG9mIHRoZSBjdXJyZW50IGNvb2tpZXNcblx0ICovXG5cdGZ1bmN0aW9uICQkQ29va2llUmVhZGVyKCRkb2N1bWVudCkge1xuXHQgIHZhciByYXdEb2N1bWVudCA9ICRkb2N1bWVudFswXSB8fCB7fTtcblx0ICB2YXIgbGFzdENvb2tpZXMgPSB7fTtcblx0ICB2YXIgbGFzdENvb2tpZVN0cmluZyA9ICcnO1xuXHRcblx0ICBmdW5jdGlvbiBzYWZlRGVjb2RlVVJJQ29tcG9uZW50KHN0cikge1xuXHQgICAgdHJ5IHtcblx0ICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzdHIpO1xuXHQgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICByZXR1cm4gc3RyO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIGNvb2tpZUFycmF5LCBjb29raWUsIGksIGluZGV4LCBuYW1lO1xuXHQgICAgdmFyIGN1cnJlbnRDb29raWVTdHJpbmcgPSByYXdEb2N1bWVudC5jb29raWUgfHwgJyc7XG5cdFxuXHQgICAgaWYgKGN1cnJlbnRDb29raWVTdHJpbmcgIT09IGxhc3RDb29raWVTdHJpbmcpIHtcblx0ICAgICAgbGFzdENvb2tpZVN0cmluZyA9IGN1cnJlbnRDb29raWVTdHJpbmc7XG5cdCAgICAgIGNvb2tpZUFycmF5ID0gbGFzdENvb2tpZVN0cmluZy5zcGxpdCgnOyAnKTtcblx0ICAgICAgbGFzdENvb2tpZXMgPSB7fTtcblx0XG5cdCAgICAgIGZvciAoaSA9IDA7IGkgPCBjb29raWVBcnJheS5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIGNvb2tpZSA9IGNvb2tpZUFycmF5W2ldO1xuXHQgICAgICAgIGluZGV4ID0gY29va2llLmluZGV4T2YoJz0nKTtcblx0ICAgICAgICBpZiAoaW5kZXggPiAwKSB7IC8vaWdub3JlIG5hbWVsZXNzIGNvb2tpZXNcblx0ICAgICAgICAgIG5hbWUgPSBzYWZlRGVjb2RlVVJJQ29tcG9uZW50KGNvb2tpZS5zdWJzdHJpbmcoMCwgaW5kZXgpKTtcblx0ICAgICAgICAgIC8vIHRoZSBmaXJzdCB2YWx1ZSB0aGF0IGlzIHNlZW4gZm9yIGEgY29va2llIGlzIHRoZSBtb3N0XG5cdCAgICAgICAgICAvLyBzcGVjaWZpYyBvbmUuICB2YWx1ZXMgZm9yIHRoZSBzYW1lIGNvb2tpZSBuYW1lIHRoYXRcblx0ICAgICAgICAgIC8vIGZvbGxvdyBhcmUgZm9yIGxlc3Mgc3BlY2lmaWMgcGF0aHMuXG5cdCAgICAgICAgICBpZiAoaXNVbmRlZmluZWQobGFzdENvb2tpZXNbbmFtZV0pKSB7XG5cdCAgICAgICAgICAgIGxhc3RDb29raWVzW25hbWVdID0gc2FmZURlY29kZVVSSUNvbXBvbmVudChjb29raWUuc3Vic3RyaW5nKGluZGV4ICsgMSkpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIGxhc3RDb29raWVzO1xuXHQgIH07XG5cdH1cblx0XG5cdCQkQ29va2llUmVhZGVyLiRpbmplY3QgPSBbJyRkb2N1bWVudCddO1xuXHRcblx0ZnVuY3Rpb24gJCRDb29raWVSZWFkZXJQcm92aWRlcigpIHtcblx0ICB0aGlzLiRnZXQgPSAkJENvb2tpZVJlYWRlcjtcblx0fVxuXHRcblx0LyogZ2xvYmFsIGN1cnJlbmN5RmlsdGVyOiB0cnVlLFxuXHQgZGF0ZUZpbHRlcjogdHJ1ZSxcblx0IGZpbHRlckZpbHRlcjogdHJ1ZSxcblx0IGpzb25GaWx0ZXI6IHRydWUsXG5cdCBsaW1pdFRvRmlsdGVyOiB0cnVlLFxuXHQgbG93ZXJjYXNlRmlsdGVyOiB0cnVlLFxuXHQgbnVtYmVyRmlsdGVyOiB0cnVlLFxuXHQgb3JkZXJCeUZpbHRlcjogdHJ1ZSxcblx0IHVwcGVyY2FzZUZpbHRlcjogdHJ1ZSxcblx0ICovXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHByb3ZpZGVyXG5cdCAqIEBuYW1lICRmaWx0ZXJQcm92aWRlclxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogRmlsdGVycyBhcmUganVzdCBmdW5jdGlvbnMgd2hpY2ggdHJhbnNmb3JtIGlucHV0IHRvIGFuIG91dHB1dC4gSG93ZXZlciBmaWx0ZXJzIG5lZWQgdG8gYmVcblx0ICogRGVwZW5kZW5jeSBJbmplY3RlZC4gVG8gYWNoaWV2ZSB0aGlzIGEgZmlsdGVyIGRlZmluaXRpb24gY29uc2lzdHMgb2YgYSBmYWN0b3J5IGZ1bmN0aW9uIHdoaWNoIGlzXG5cdCAqIGFubm90YXRlZCB3aXRoIGRlcGVuZGVuY2llcyBhbmQgaXMgcmVzcG9uc2libGUgZm9yIGNyZWF0aW5nIGEgZmlsdGVyIGZ1bmN0aW9uLlxuXHQgKlxuXHQgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuXHQgKiAqKk5vdGU6KiogRmlsdGVyIG5hbWVzIG11c3QgYmUgdmFsaWQgYW5ndWxhciB7QGxpbmsgZXhwcmVzc2lvbn0gaWRlbnRpZmllcnMsIHN1Y2ggYXMgYHVwcGVyY2FzZWAgb3IgYG9yZGVyQnlgLlxuXHQgKiBOYW1lcyB3aXRoIHNwZWNpYWwgY2hhcmFjdGVycywgc3VjaCBhcyBoeXBoZW5zIGFuZCBkb3RzLCBhcmUgbm90IGFsbG93ZWQuIElmIHlvdSB3aXNoIHRvIG5hbWVzcGFjZVxuXHQgKiB5b3VyIGZpbHRlcnMsIHRoZW4geW91IGNhbiB1c2UgY2FwaXRhbGl6YXRpb24gKGBteWFwcFN1YnNlY3Rpb25GaWx0ZXJ4YCkgb3IgdW5kZXJzY29yZXNcblx0ICogKGBteWFwcF9zdWJzZWN0aW9uX2ZpbHRlcnhgKS5cblx0ICogPC9kaXY+XG5cdCAqXG5cdCAqIGBgYGpzXG5cdCAqICAgLy8gRmlsdGVyIHJlZ2lzdHJhdGlvblxuXHQgKiAgIGZ1bmN0aW9uIE15TW9kdWxlKCRwcm92aWRlLCAkZmlsdGVyUHJvdmlkZXIpIHtcblx0ICogICAgIC8vIGNyZWF0ZSBhIHNlcnZpY2UgdG8gZGVtb25zdHJhdGUgaW5qZWN0aW9uIChub3QgYWx3YXlzIG5lZWRlZClcblx0ICogICAgICRwcm92aWRlLnZhbHVlKCdncmVldCcsIGZ1bmN0aW9uKG5hbWUpe1xuXHQgKiAgICAgICByZXR1cm4gJ0hlbGxvICcgKyBuYW1lICsgJyEnO1xuXHQgKiAgICAgfSk7XG5cdCAqXG5cdCAqICAgICAvLyByZWdpc3RlciBhIGZpbHRlciBmYWN0b3J5IHdoaWNoIHVzZXMgdGhlXG5cdCAqICAgICAvLyBncmVldCBzZXJ2aWNlIHRvIGRlbW9uc3RyYXRlIERJLlxuXHQgKiAgICAgJGZpbHRlclByb3ZpZGVyLnJlZ2lzdGVyKCdncmVldCcsIGZ1bmN0aW9uKGdyZWV0KXtcblx0ICogICAgICAgLy8gcmV0dXJuIHRoZSBmaWx0ZXIgZnVuY3Rpb24gd2hpY2ggdXNlcyB0aGUgZ3JlZXQgc2VydmljZVxuXHQgKiAgICAgICAvLyB0byBnZW5lcmF0ZSBzYWx1dGF0aW9uXG5cdCAqICAgICAgIHJldHVybiBmdW5jdGlvbih0ZXh0KSB7XG5cdCAqICAgICAgICAgLy8gZmlsdGVycyBuZWVkIHRvIGJlIGZvcmdpdmluZyBzbyBjaGVjayBpbnB1dCB2YWxpZGl0eVxuXHQgKiAgICAgICAgIHJldHVybiB0ZXh0ICYmIGdyZWV0KHRleHQpIHx8IHRleHQ7XG5cdCAqICAgICAgIH07XG5cdCAqICAgICB9KTtcblx0ICogICB9XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBUaGUgZmlsdGVyIGZ1bmN0aW9uIGlzIHJlZ2lzdGVyZWQgd2l0aCB0aGUgYCRpbmplY3RvcmAgdW5kZXIgdGhlIGZpbHRlciBuYW1lIHN1ZmZpeCB3aXRoXG5cdCAqIGBGaWx0ZXJgLlxuXHQgKlxuXHQgKiBgYGBqc1xuXHQgKiAgIGl0KCdzaG91bGQgYmUgdGhlIHNhbWUgaW5zdGFuY2UnLCBpbmplY3QoXG5cdCAqICAgICBmdW5jdGlvbigkZmlsdGVyUHJvdmlkZXIpIHtcblx0ICogICAgICAgJGZpbHRlclByb3ZpZGVyLnJlZ2lzdGVyKCdyZXZlcnNlJywgZnVuY3Rpb24oKXtcblx0ICogICAgICAgICByZXR1cm4gLi4uO1xuXHQgKiAgICAgICB9KTtcblx0ICogICAgIH0sXG5cdCAqICAgICBmdW5jdGlvbigkZmlsdGVyLCByZXZlcnNlRmlsdGVyKSB7XG5cdCAqICAgICAgIGV4cGVjdCgkZmlsdGVyKCdyZXZlcnNlJykpLnRvQmUocmV2ZXJzZUZpbHRlcik7XG5cdCAqICAgICB9KTtcblx0ICogYGBgXG5cdCAqXG5cdCAqXG5cdCAqIEZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGhvdyBhbmd1bGFyIGZpbHRlcnMgd29yaywgYW5kIGhvdyB0byBjcmVhdGUgeW91ciBvd24gZmlsdGVycywgc2VlXG5cdCAqIHtAbGluayBndWlkZS9maWx0ZXIgRmlsdGVyc30gaW4gdGhlIEFuZ3VsYXIgRGV2ZWxvcGVyIEd1aWRlLlxuXHQgKi9cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2Mgc2VydmljZVxuXHQgKiBAbmFtZSAkZmlsdGVyXG5cdCAqIEBraW5kIGZ1bmN0aW9uXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBGaWx0ZXJzIGFyZSB1c2VkIGZvciBmb3JtYXR0aW5nIGRhdGEgZGlzcGxheWVkIHRvIHRoZSB1c2VyLlxuXHQgKlxuXHQgKiBUaGUgZ2VuZXJhbCBzeW50YXggaW4gdGVtcGxhdGVzIGlzIGFzIGZvbGxvd3M6XG5cdCAqXG5cdCAqICAgICAgICAge3sgZXhwcmVzc2lvbiBbfCBmaWx0ZXJfbmFtZVs6cGFyYW1ldGVyX3ZhbHVlXSAuLi4gXSB9fVxuXHQgKlxuXHQgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBOYW1lIG9mIHRoZSBmaWx0ZXIgZnVuY3Rpb24gdG8gcmV0cmlldmVcblx0ICogQHJldHVybiB7RnVuY3Rpb259IHRoZSBmaWx0ZXIgZnVuY3Rpb25cblx0ICogQGV4YW1wbGVcblx0ICAgPGV4YW1wbGUgbmFtZT1cIiRmaWx0ZXJcIiBtb2R1bGU9XCJmaWx0ZXJFeGFtcGxlXCI+XG5cdCAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIk1haW5DdHJsXCI+XG5cdCAgICAgICAgPGgzPnt7IG9yaWdpbmFsVGV4dCB9fTwvaDM+XG5cdCAgICAgICAgPGgzPnt7IGZpbHRlcmVkVGV4dCB9fTwvaDM+XG5cdCAgICAgICA8L2Rpdj5cblx0ICAgICA8L2ZpbGU+XG5cdFxuXHQgICAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cblx0ICAgICAgYW5ndWxhci5tb2R1bGUoJ2ZpbHRlckV4YW1wbGUnLCBbXSlcblx0ICAgICAgLmNvbnRyb2xsZXIoJ01haW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkZmlsdGVyKSB7XG5cdCAgICAgICAgJHNjb3BlLm9yaWdpbmFsVGV4dCA9ICdoZWxsbyc7XG5cdCAgICAgICAgJHNjb3BlLmZpbHRlcmVkVGV4dCA9ICRmaWx0ZXIoJ3VwcGVyY2FzZScpKCRzY29wZS5vcmlnaW5hbFRleHQpO1xuXHQgICAgICB9KTtcblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICAqL1xuXHQkRmlsdGVyUHJvdmlkZXIuJGluamVjdCA9IFsnJHByb3ZpZGUnXTtcblx0ZnVuY3Rpb24gJEZpbHRlclByb3ZpZGVyKCRwcm92aWRlKSB7XG5cdCAgdmFyIHN1ZmZpeCA9ICdGaWx0ZXInO1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgJGZpbHRlclByb3ZpZGVyI3JlZ2lzdGVyXG5cdCAgICogQHBhcmFtIHtzdHJpbmd8T2JqZWN0fSBuYW1lIE5hbWUgb2YgdGhlIGZpbHRlciBmdW5jdGlvbiwgb3IgYW4gb2JqZWN0IG1hcCBvZiBmaWx0ZXJzIHdoZXJlXG5cdCAgICogICAgdGhlIGtleXMgYXJlIHRoZSBmaWx0ZXIgbmFtZXMgYW5kIHRoZSB2YWx1ZXMgYXJlIHRoZSBmaWx0ZXIgZmFjdG9yaWVzLlxuXHQgICAqXG5cdCAgICogICAgPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cblx0ICAgKiAgICAqKk5vdGU6KiogRmlsdGVyIG5hbWVzIG11c3QgYmUgdmFsaWQgYW5ndWxhciB7QGxpbmsgZXhwcmVzc2lvbn0gaWRlbnRpZmllcnMsIHN1Y2ggYXMgYHVwcGVyY2FzZWAgb3IgYG9yZGVyQnlgLlxuXHQgICAqICAgIE5hbWVzIHdpdGggc3BlY2lhbCBjaGFyYWN0ZXJzLCBzdWNoIGFzIGh5cGhlbnMgYW5kIGRvdHMsIGFyZSBub3QgYWxsb3dlZC4gSWYgeW91IHdpc2ggdG8gbmFtZXNwYWNlXG5cdCAgICogICAgeW91ciBmaWx0ZXJzLCB0aGVuIHlvdSBjYW4gdXNlIGNhcGl0YWxpemF0aW9uIChgbXlhcHBTdWJzZWN0aW9uRmlsdGVyeGApIG9yIHVuZGVyc2NvcmVzXG5cdCAgICogICAgKGBteWFwcF9zdWJzZWN0aW9uX2ZpbHRlcnhgKS5cblx0ICAgKiAgICA8L2Rpdj5cblx0ICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZmFjdG9yeSBJZiB0aGUgZmlyc3QgYXJndW1lbnQgd2FzIGEgc3RyaW5nLCBhIGZhY3RvcnkgZnVuY3Rpb24gZm9yIHRoZSBmaWx0ZXIgdG8gYmUgcmVnaXN0ZXJlZC5cblx0ICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZWdpc3RlcmVkIGZpbHRlciBpbnN0YW5jZSwgb3IgaWYgYSBtYXAgb2YgZmlsdGVycyB3YXMgcHJvdmlkZWQgdGhlbiBhIG1hcFxuXHQgICAqICAgIG9mIHRoZSByZWdpc3RlcmVkIGZpbHRlciBpbnN0YW5jZXMuXG5cdCAgICovXG5cdCAgZnVuY3Rpb24gcmVnaXN0ZXIobmFtZSwgZmFjdG9yeSkge1xuXHQgICAgaWYgKGlzT2JqZWN0KG5hbWUpKSB7XG5cdCAgICAgIHZhciBmaWx0ZXJzID0ge307XG5cdCAgICAgIGZvckVhY2gobmFtZSwgZnVuY3Rpb24oZmlsdGVyLCBrZXkpIHtcblx0ICAgICAgICBmaWx0ZXJzW2tleV0gPSByZWdpc3RlcihrZXksIGZpbHRlcik7XG5cdCAgICAgIH0pO1xuXHQgICAgICByZXR1cm4gZmlsdGVycztcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHJldHVybiAkcHJvdmlkZS5mYWN0b3J5KG5hbWUgKyBzdWZmaXgsIGZhY3RvcnkpO1xuXHQgICAgfVxuXHQgIH1cblx0ICB0aGlzLnJlZ2lzdGVyID0gcmVnaXN0ZXI7XG5cdFxuXHQgIHRoaXMuJGdldCA9IFsnJGluamVjdG9yJywgZnVuY3Rpb24oJGluamVjdG9yKSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24obmFtZSkge1xuXHQgICAgICByZXR1cm4gJGluamVjdG9yLmdldChuYW1lICsgc3VmZml4KTtcblx0ICAgIH07XG5cdCAgfV07XG5cdFxuXHQgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XG5cdCAgLyogZ2xvYmFsXG5cdCAgICBjdXJyZW5jeUZpbHRlcjogZmFsc2UsXG5cdCAgICBkYXRlRmlsdGVyOiBmYWxzZSxcblx0ICAgIGZpbHRlckZpbHRlcjogZmFsc2UsXG5cdCAgICBqc29uRmlsdGVyOiBmYWxzZSxcblx0ICAgIGxpbWl0VG9GaWx0ZXI6IGZhbHNlLFxuXHQgICAgbG93ZXJjYXNlRmlsdGVyOiBmYWxzZSxcblx0ICAgIG51bWJlckZpbHRlcjogZmFsc2UsXG5cdCAgICBvcmRlckJ5RmlsdGVyOiBmYWxzZSxcblx0ICAgIHVwcGVyY2FzZUZpbHRlcjogZmFsc2UsXG5cdCAgKi9cblx0XG5cdCAgcmVnaXN0ZXIoJ2N1cnJlbmN5JywgY3VycmVuY3lGaWx0ZXIpO1xuXHQgIHJlZ2lzdGVyKCdkYXRlJywgZGF0ZUZpbHRlcik7XG5cdCAgcmVnaXN0ZXIoJ2ZpbHRlcicsIGZpbHRlckZpbHRlcik7XG5cdCAgcmVnaXN0ZXIoJ2pzb24nLCBqc29uRmlsdGVyKTtcblx0ICByZWdpc3RlcignbGltaXRUbycsIGxpbWl0VG9GaWx0ZXIpO1xuXHQgIHJlZ2lzdGVyKCdsb3dlcmNhc2UnLCBsb3dlcmNhc2VGaWx0ZXIpO1xuXHQgIHJlZ2lzdGVyKCdudW1iZXInLCBudW1iZXJGaWx0ZXIpO1xuXHQgIHJlZ2lzdGVyKCdvcmRlckJ5Jywgb3JkZXJCeUZpbHRlcik7XG5cdCAgcmVnaXN0ZXIoJ3VwcGVyY2FzZScsIHVwcGVyY2FzZUZpbHRlcik7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZmlsdGVyXG5cdCAqIEBuYW1lIGZpbHRlclxuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogU2VsZWN0cyBhIHN1YnNldCBvZiBpdGVtcyBmcm9tIGBhcnJheWAgYW5kIHJldHVybnMgaXQgYXMgYSBuZXcgYXJyYXkuXG5cdCAqXG5cdCAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBzb3VyY2UgYXJyYXkuXG5cdCAqIEBwYXJhbSB7c3RyaW5nfE9iamVjdHxmdW5jdGlvbigpfSBleHByZXNzaW9uIFRoZSBwcmVkaWNhdGUgdG8gYmUgdXNlZCBmb3Igc2VsZWN0aW5nIGl0ZW1zIGZyb21cblx0ICogICBgYXJyYXlgLlxuXHQgKlxuXHQgKiAgIENhbiBiZSBvbmUgb2Y6XG5cdCAqXG5cdCAqICAgLSBgc3RyaW5nYDogVGhlIHN0cmluZyBpcyB1c2VkIGZvciBtYXRjaGluZyBhZ2FpbnN0IHRoZSBjb250ZW50cyBvZiB0aGUgYGFycmF5YC4gQWxsIHN0cmluZ3Mgb3Jcblx0ICogICAgIG9iamVjdHMgd2l0aCBzdHJpbmcgcHJvcGVydGllcyBpbiBgYXJyYXlgIHRoYXQgbWF0Y2ggdGhpcyBzdHJpbmcgd2lsbCBiZSByZXR1cm5lZC4gVGhpcyBhbHNvXG5cdCAqICAgICBhcHBsaWVzIHRvIG5lc3RlZCBvYmplY3QgcHJvcGVydGllcy5cblx0ICogICAgIFRoZSBwcmVkaWNhdGUgY2FuIGJlIG5lZ2F0ZWQgYnkgcHJlZml4aW5nIHRoZSBzdHJpbmcgd2l0aCBgIWAuXG5cdCAqXG5cdCAqICAgLSBgT2JqZWN0YDogQSBwYXR0ZXJuIG9iamVjdCBjYW4gYmUgdXNlZCB0byBmaWx0ZXIgc3BlY2lmaWMgcHJvcGVydGllcyBvbiBvYmplY3RzIGNvbnRhaW5lZFxuXHQgKiAgICAgYnkgYGFycmF5YC4gRm9yIGV4YW1wbGUgYHtuYW1lOlwiTVwiLCBwaG9uZTpcIjFcIn1gIHByZWRpY2F0ZSB3aWxsIHJldHVybiBhbiBhcnJheSBvZiBpdGVtc1xuXHQgKiAgICAgd2hpY2ggaGF2ZSBwcm9wZXJ0eSBgbmFtZWAgY29udGFpbmluZyBcIk1cIiBhbmQgcHJvcGVydHkgYHBob25lYCBjb250YWluaW5nIFwiMVwiLiBBIHNwZWNpYWxcblx0ICogICAgIHByb3BlcnR5IG5hbWUgYCRgIGNhbiBiZSB1c2VkIChhcyBpbiBgeyQ6XCJ0ZXh0XCJ9YCkgdG8gYWNjZXB0IGEgbWF0Y2ggYWdhaW5zdCBhbnlcblx0ICogICAgIHByb3BlcnR5IG9mIHRoZSBvYmplY3Qgb3IgaXRzIG5lc3RlZCBvYmplY3QgcHJvcGVydGllcy4gVGhhdCdzIGVxdWl2YWxlbnQgdG8gdGhlIHNpbXBsZVxuXHQgKiAgICAgc3Vic3RyaW5nIG1hdGNoIHdpdGggYSBgc3RyaW5nYCBhcyBkZXNjcmliZWQgYWJvdmUuIFRoZSBwcmVkaWNhdGUgY2FuIGJlIG5lZ2F0ZWQgYnkgcHJlZml4aW5nXG5cdCAqICAgICB0aGUgc3RyaW5nIHdpdGggYCFgLlxuXHQgKiAgICAgRm9yIGV4YW1wbGUgYHtuYW1lOiBcIiFNXCJ9YCBwcmVkaWNhdGUgd2lsbCByZXR1cm4gYW4gYXJyYXkgb2YgaXRlbXMgd2hpY2ggaGF2ZSBwcm9wZXJ0eSBgbmFtZWBcblx0ICogICAgIG5vdCBjb250YWluaW5nIFwiTVwiLlxuXHQgKlxuXHQgKiAgICAgTm90ZSB0aGF0IGEgbmFtZWQgcHJvcGVydHkgd2lsbCBtYXRjaCBwcm9wZXJ0aWVzIG9uIHRoZSBzYW1lIGxldmVsIG9ubHksIHdoaWxlIHRoZSBzcGVjaWFsXG5cdCAqICAgICBgJGAgcHJvcGVydHkgd2lsbCBtYXRjaCBwcm9wZXJ0aWVzIG9uIHRoZSBzYW1lIGxldmVsIG9yIGRlZXBlci4gRS5nLiBhbiBhcnJheSBpdGVtIGxpa2Vcblx0ICogICAgIGB7bmFtZToge2ZpcnN0OiAnSm9obicsIGxhc3Q6ICdEb2UnfX1gIHdpbGwgKipub3QqKiBiZSBtYXRjaGVkIGJ5IGB7bmFtZTogJ0pvaG4nfWAsIGJ1dFxuXHQgKiAgICAgKip3aWxsKiogYmUgbWF0Y2hlZCBieSBgeyQ6ICdKb2huJ31gLlxuXHQgKlxuXHQgKiAgIC0gYGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgYXJyYXkpYDogQSBwcmVkaWNhdGUgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gd3JpdGUgYXJiaXRyYXJ5IGZpbHRlcnMuXG5cdCAqICAgICBUaGUgZnVuY3Rpb24gaXMgY2FsbGVkIGZvciBlYWNoIGVsZW1lbnQgb2YgdGhlIGFycmF5LCB3aXRoIHRoZSBlbGVtZW50LCBpdHMgaW5kZXgsIGFuZFxuXHQgKiAgICAgdGhlIGVudGlyZSBhcnJheSBpdHNlbGYgYXMgYXJndW1lbnRzLlxuXHQgKlxuXHQgKiAgICAgVGhlIGZpbmFsIHJlc3VsdCBpcyBhbiBhcnJheSBvZiB0aG9zZSBlbGVtZW50cyB0aGF0IHRoZSBwcmVkaWNhdGUgcmV0dXJuZWQgdHJ1ZSBmb3IuXG5cdCAqXG5cdCAqIEBwYXJhbSB7ZnVuY3Rpb24oYWN0dWFsLCBleHBlY3RlZCl8dHJ1ZXx1bmRlZmluZWR9IGNvbXBhcmF0b3IgQ29tcGFyYXRvciB3aGljaCBpcyB1c2VkIGluXG5cdCAqICAgICBkZXRlcm1pbmluZyBpZiB0aGUgZXhwZWN0ZWQgdmFsdWUgKGZyb20gdGhlIGZpbHRlciBleHByZXNzaW9uKSBhbmQgYWN0dWFsIHZhbHVlIChmcm9tXG5cdCAqICAgICB0aGUgb2JqZWN0IGluIHRoZSBhcnJheSkgc2hvdWxkIGJlIGNvbnNpZGVyZWQgYSBtYXRjaC5cblx0ICpcblx0ICogICBDYW4gYmUgb25lIG9mOlxuXHQgKlxuXHQgKiAgIC0gYGZ1bmN0aW9uKGFjdHVhbCwgZXhwZWN0ZWQpYDpcblx0ICogICAgIFRoZSBmdW5jdGlvbiB3aWxsIGJlIGdpdmVuIHRoZSBvYmplY3QgdmFsdWUgYW5kIHRoZSBwcmVkaWNhdGUgdmFsdWUgdG8gY29tcGFyZSBhbmRcblx0ICogICAgIHNob3VsZCByZXR1cm4gdHJ1ZSBpZiBib3RoIHZhbHVlcyBzaG91bGQgYmUgY29uc2lkZXJlZCBlcXVhbC5cblx0ICpcblx0ICogICAtIGB0cnVlYDogQSBzaG9ydGhhbmQgZm9yIGBmdW5jdGlvbihhY3R1YWwsIGV4cGVjdGVkKSB7IHJldHVybiBhbmd1bGFyLmVxdWFscyhhY3R1YWwsIGV4cGVjdGVkKX1gLlxuXHQgKiAgICAgVGhpcyBpcyBlc3NlbnRpYWxseSBzdHJpY3QgY29tcGFyaXNvbiBvZiBleHBlY3RlZCBhbmQgYWN0dWFsLlxuXHQgKlxuXHQgKiAgIC0gYGZhbHNlfHVuZGVmaW5lZGA6IEEgc2hvcnQgaGFuZCBmb3IgYSBmdW5jdGlvbiB3aGljaCB3aWxsIGxvb2sgZm9yIGEgc3Vic3RyaW5nIG1hdGNoIGluIGNhc2Vcblx0ICogICAgIGluc2Vuc2l0aXZlIHdheS5cblx0ICpcblx0ICogICAgIFByaW1pdGl2ZSB2YWx1ZXMgYXJlIGNvbnZlcnRlZCB0byBzdHJpbmdzLiBPYmplY3RzIGFyZSBub3QgY29tcGFyZWQgYWdhaW5zdCBwcmltaXRpdmVzLFxuXHQgKiAgICAgdW5sZXNzIHRoZXkgaGF2ZSBhIGN1c3RvbSBgdG9TdHJpbmdgIG1ldGhvZCAoZS5nLiBgRGF0ZWAgb2JqZWN0cykuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICA8ZGl2IG5nLWluaXQ9XCJmcmllbmRzID0gW3tuYW1lOidKb2huJywgcGhvbmU6JzU1NS0xMjc2J30sXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge25hbWU6J01hcnknLCBwaG9uZTonODAwLUJJRy1NQVJZJ30sXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge25hbWU6J01pa2UnLCBwaG9uZTonNTU1LTQzMjEnfSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bmFtZTonQWRhbScsIHBob25lOic1NTUtNTY3OCd9LFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtuYW1lOidKdWxpZScsIHBob25lOic1NTUtODc2NSd9LFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtuYW1lOidKdWxpZXR0ZScsIHBob25lOic1NTUtNTY3OCd9XVwiPjwvZGl2PlxuXHRcblx0ICAgICAgIDxsYWJlbD5TZWFyY2g6IDxpbnB1dCBuZy1tb2RlbD1cInNlYXJjaFRleHRcIj48L2xhYmVsPlxuXHQgICAgICAgPHRhYmxlIGlkPVwic2VhcmNoVGV4dFJlc3VsdHNcIj5cblx0ICAgICAgICAgPHRyPjx0aD5OYW1lPC90aD48dGg+UGhvbmU8L3RoPjwvdHI+XG5cdCAgICAgICAgIDx0ciBuZy1yZXBlYXQ9XCJmcmllbmQgaW4gZnJpZW5kcyB8IGZpbHRlcjpzZWFyY2hUZXh0XCI+XG5cdCAgICAgICAgICAgPHRkPnt7ZnJpZW5kLm5hbWV9fTwvdGQ+XG5cdCAgICAgICAgICAgPHRkPnt7ZnJpZW5kLnBob25lfX08L3RkPlxuXHQgICAgICAgICA8L3RyPlxuXHQgICAgICAgPC90YWJsZT5cblx0ICAgICAgIDxocj5cblx0ICAgICAgIDxsYWJlbD5Bbnk6IDxpbnB1dCBuZy1tb2RlbD1cInNlYXJjaC4kXCI+PC9sYWJlbD4gPGJyPlxuXHQgICAgICAgPGxhYmVsPk5hbWUgb25seSA8aW5wdXQgbmctbW9kZWw9XCJzZWFyY2gubmFtZVwiPjwvbGFiZWw+PGJyPlxuXHQgICAgICAgPGxhYmVsPlBob25lIG9ubHkgPGlucHV0IG5nLW1vZGVsPVwic2VhcmNoLnBob25lXCI+PC9sYWJlbD48YnI+XG5cdCAgICAgICA8bGFiZWw+RXF1YWxpdHkgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwic3RyaWN0XCI+PC9sYWJlbD48YnI+XG5cdCAgICAgICA8dGFibGUgaWQ9XCJzZWFyY2hPYmpSZXN1bHRzXCI+XG5cdCAgICAgICAgIDx0cj48dGg+TmFtZTwvdGg+PHRoPlBob25lPC90aD48L3RyPlxuXHQgICAgICAgICA8dHIgbmctcmVwZWF0PVwiZnJpZW5kT2JqIGluIGZyaWVuZHMgfCBmaWx0ZXI6c2VhcmNoOnN0cmljdFwiPlxuXHQgICAgICAgICAgIDx0ZD57e2ZyaWVuZE9iai5uYW1lfX08L3RkPlxuXHQgICAgICAgICAgIDx0ZD57e2ZyaWVuZE9iai5waG9uZX19PC90ZD5cblx0ICAgICAgICAgPC90cj5cblx0ICAgICAgIDwvdGFibGU+XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgIHZhciBleHBlY3RGcmllbmROYW1lcyA9IGZ1bmN0aW9uKGV4cGVjdGVkTmFtZXMsIGtleSkge1xuXHQgICAgICAgICBlbGVtZW50LmFsbChieS5yZXBlYXRlcihrZXkgKyAnIGluIGZyaWVuZHMnKS5jb2x1bW4oa2V5ICsgJy5uYW1lJykpLnRoZW4oZnVuY3Rpb24oYXJyKSB7XG5cdCAgICAgICAgICAgYXJyLmZvckVhY2goZnVuY3Rpb24od2QsIGkpIHtcblx0ICAgICAgICAgICAgIGV4cGVjdCh3ZC5nZXRUZXh0KCkpLnRvTWF0Y2goZXhwZWN0ZWROYW1lc1tpXSk7XG5cdCAgICAgICAgICAgfSk7XG5cdCAgICAgICAgIH0pO1xuXHQgICAgICAgfTtcblx0XG5cdCAgICAgICBpdCgnc2hvdWxkIHNlYXJjaCBhY3Jvc3MgYWxsIGZpZWxkcyB3aGVuIGZpbHRlcmluZyB3aXRoIGEgc3RyaW5nJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgIHZhciBzZWFyY2hUZXh0ID0gZWxlbWVudChieS5tb2RlbCgnc2VhcmNoVGV4dCcpKTtcblx0ICAgICAgICAgc2VhcmNoVGV4dC5jbGVhcigpO1xuXHQgICAgICAgICBzZWFyY2hUZXh0LnNlbmRLZXlzKCdtJyk7XG5cdCAgICAgICAgIGV4cGVjdEZyaWVuZE5hbWVzKFsnTWFyeScsICdNaWtlJywgJ0FkYW0nXSwgJ2ZyaWVuZCcpO1xuXHRcblx0ICAgICAgICAgc2VhcmNoVGV4dC5jbGVhcigpO1xuXHQgICAgICAgICBzZWFyY2hUZXh0LnNlbmRLZXlzKCc3NicpO1xuXHQgICAgICAgICBleHBlY3RGcmllbmROYW1lcyhbJ0pvaG4nLCAnSnVsaWUnXSwgJ2ZyaWVuZCcpO1xuXHQgICAgICAgfSk7XG5cdFxuXHQgICAgICAgaXQoJ3Nob3VsZCBzZWFyY2ggaW4gc3BlY2lmaWMgZmllbGRzIHdoZW4gZmlsdGVyaW5nIHdpdGggYSBwcmVkaWNhdGUgb2JqZWN0JywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgIHZhciBzZWFyY2hBbnkgPSBlbGVtZW50KGJ5Lm1vZGVsKCdzZWFyY2guJCcpKTtcblx0ICAgICAgICAgc2VhcmNoQW55LmNsZWFyKCk7XG5cdCAgICAgICAgIHNlYXJjaEFueS5zZW5kS2V5cygnaScpO1xuXHQgICAgICAgICBleHBlY3RGcmllbmROYW1lcyhbJ01hcnknLCAnTWlrZScsICdKdWxpZScsICdKdWxpZXR0ZSddLCAnZnJpZW5kT2JqJyk7XG5cdCAgICAgICB9KTtcblx0ICAgICAgIGl0KCdzaG91bGQgdXNlIGEgZXF1YWwgY29tcGFyaXNvbiB3aGVuIGNvbXBhcmF0b3IgaXMgdHJ1ZScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICB2YXIgc2VhcmNoTmFtZSA9IGVsZW1lbnQoYnkubW9kZWwoJ3NlYXJjaC5uYW1lJykpO1xuXHQgICAgICAgICB2YXIgc3RyaWN0ID0gZWxlbWVudChieS5tb2RlbCgnc3RyaWN0JykpO1xuXHQgICAgICAgICBzZWFyY2hOYW1lLmNsZWFyKCk7XG5cdCAgICAgICAgIHNlYXJjaE5hbWUuc2VuZEtleXMoJ0p1bGllJyk7XG5cdCAgICAgICAgIHN0cmljdC5jbGljaygpO1xuXHQgICAgICAgICBleHBlY3RGcmllbmROYW1lcyhbJ0p1bGllJ10sICdmcmllbmRPYmonKTtcblx0ICAgICAgIH0pO1xuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKi9cblx0ZnVuY3Rpb24gZmlsdGVyRmlsdGVyKCkge1xuXHQgIHJldHVybiBmdW5jdGlvbihhcnJheSwgZXhwcmVzc2lvbiwgY29tcGFyYXRvcikge1xuXHQgICAgaWYgKCFpc0FycmF5TGlrZShhcnJheSkpIHtcblx0ICAgICAgaWYgKGFycmF5ID09IG51bGwpIHtcblx0ICAgICAgICByZXR1cm4gYXJyYXk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdGhyb3cgbWluRXJyKCdmaWx0ZXInKSgnbm90YXJyYXknLCAnRXhwZWN0ZWQgYXJyYXkgYnV0IHJlY2VpdmVkOiB7MH0nLCBhcnJheSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICB2YXIgZXhwcmVzc2lvblR5cGUgPSBnZXRUeXBlRm9yRmlsdGVyKGV4cHJlc3Npb24pO1xuXHQgICAgdmFyIHByZWRpY2F0ZUZuO1xuXHQgICAgdmFyIG1hdGNoQWdhaW5zdEFueVByb3A7XG5cdFxuXHQgICAgc3dpdGNoIChleHByZXNzaW9uVHlwZSkge1xuXHQgICAgICBjYXNlICdmdW5jdGlvbic6XG5cdCAgICAgICAgcHJlZGljYXRlRm4gPSBleHByZXNzaW9uO1xuXHQgICAgICAgIGJyZWFrO1xuXHQgICAgICBjYXNlICdib29sZWFuJzpcblx0ICAgICAgY2FzZSAnbnVsbCc6XG5cdCAgICAgIGNhc2UgJ251bWJlcic6XG5cdCAgICAgIGNhc2UgJ3N0cmluZyc6XG5cdCAgICAgICAgbWF0Y2hBZ2FpbnN0QW55UHJvcCA9IHRydWU7XG5cdCAgICAgICAgLy9qc2hpbnQgLVcwODZcblx0ICAgICAgY2FzZSAnb2JqZWN0Jzpcblx0ICAgICAgICAvL2pzaGludCArVzA4NlxuXHQgICAgICAgIHByZWRpY2F0ZUZuID0gY3JlYXRlUHJlZGljYXRlRm4oZXhwcmVzc2lvbiwgY29tcGFyYXRvciwgbWF0Y2hBZ2FpbnN0QW55UHJvcCk7XG5cdCAgICAgICAgYnJlYWs7XG5cdCAgICAgIGRlZmF1bHQ6XG5cdCAgICAgICAgcmV0dXJuIGFycmF5O1xuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuZmlsdGVyLmNhbGwoYXJyYXksIHByZWRpY2F0ZUZuKTtcblx0ICB9O1xuXHR9XG5cdFxuXHQvLyBIZWxwZXIgZnVuY3Rpb25zIGZvciBgZmlsdGVyRmlsdGVyYFxuXHRmdW5jdGlvbiBjcmVhdGVQcmVkaWNhdGVGbihleHByZXNzaW9uLCBjb21wYXJhdG9yLCBtYXRjaEFnYWluc3RBbnlQcm9wKSB7XG5cdCAgdmFyIHNob3VsZE1hdGNoUHJpbWl0aXZlcyA9IGlzT2JqZWN0KGV4cHJlc3Npb24pICYmICgnJCcgaW4gZXhwcmVzc2lvbik7XG5cdCAgdmFyIHByZWRpY2F0ZUZuO1xuXHRcblx0ICBpZiAoY29tcGFyYXRvciA9PT0gdHJ1ZSkge1xuXHQgICAgY29tcGFyYXRvciA9IGVxdWFscztcblx0ICB9IGVsc2UgaWYgKCFpc0Z1bmN0aW9uKGNvbXBhcmF0b3IpKSB7XG5cdCAgICBjb21wYXJhdG9yID0gZnVuY3Rpb24oYWN0dWFsLCBleHBlY3RlZCkge1xuXHQgICAgICBpZiAoaXNVbmRlZmluZWQoYWN0dWFsKSkge1xuXHQgICAgICAgIC8vIE5vIHN1YnN0cmluZyBtYXRjaGluZyBhZ2FpbnN0IGB1bmRlZmluZWRgXG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9XG5cdCAgICAgIGlmICgoYWN0dWFsID09PSBudWxsKSB8fCAoZXhwZWN0ZWQgPT09IG51bGwpKSB7XG5cdCAgICAgICAgLy8gTm8gc3Vic3RyaW5nIG1hdGNoaW5nIGFnYWluc3QgYG51bGxgOyBvbmx5IG1hdGNoIGFnYWluc3QgYG51bGxgXG5cdCAgICAgICAgcmV0dXJuIGFjdHVhbCA9PT0gZXhwZWN0ZWQ7XG5cdCAgICAgIH1cblx0ICAgICAgaWYgKGlzT2JqZWN0KGV4cGVjdGVkKSB8fCAoaXNPYmplY3QoYWN0dWFsKSAmJiAhaGFzQ3VzdG9tVG9TdHJpbmcoYWN0dWFsKSkpIHtcblx0ICAgICAgICAvLyBTaG91bGQgbm90IGNvbXBhcmUgcHJpbWl0aXZlcyBhZ2FpbnN0IG9iamVjdHMsIHVubGVzcyB0aGV5IGhhdmUgY3VzdG9tIGB0b1N0cmluZ2AgbWV0aG9kXG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBhY3R1YWwgPSBsb3dlcmNhc2UoJycgKyBhY3R1YWwpO1xuXHQgICAgICBleHBlY3RlZCA9IGxvd2VyY2FzZSgnJyArIGV4cGVjdGVkKTtcblx0ICAgICAgcmV0dXJuIGFjdHVhbC5pbmRleE9mKGV4cGVjdGVkKSAhPT0gLTE7XG5cdCAgICB9O1xuXHQgIH1cblx0XG5cdCAgcHJlZGljYXRlRm4gPSBmdW5jdGlvbihpdGVtKSB7XG5cdCAgICBpZiAoc2hvdWxkTWF0Y2hQcmltaXRpdmVzICYmICFpc09iamVjdChpdGVtKSkge1xuXHQgICAgICByZXR1cm4gZGVlcENvbXBhcmUoaXRlbSwgZXhwcmVzc2lvbi4kLCBjb21wYXJhdG9yLCBmYWxzZSk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gZGVlcENvbXBhcmUoaXRlbSwgZXhwcmVzc2lvbiwgY29tcGFyYXRvciwgbWF0Y2hBZ2FpbnN0QW55UHJvcCk7XG5cdCAgfTtcblx0XG5cdCAgcmV0dXJuIHByZWRpY2F0ZUZuO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBkZWVwQ29tcGFyZShhY3R1YWwsIGV4cGVjdGVkLCBjb21wYXJhdG9yLCBtYXRjaEFnYWluc3RBbnlQcm9wLCBkb250TWF0Y2hXaG9sZU9iamVjdCkge1xuXHQgIHZhciBhY3R1YWxUeXBlID0gZ2V0VHlwZUZvckZpbHRlcihhY3R1YWwpO1xuXHQgIHZhciBleHBlY3RlZFR5cGUgPSBnZXRUeXBlRm9yRmlsdGVyKGV4cGVjdGVkKTtcblx0XG5cdCAgaWYgKChleHBlY3RlZFR5cGUgPT09ICdzdHJpbmcnKSAmJiAoZXhwZWN0ZWQuY2hhckF0KDApID09PSAnIScpKSB7XG5cdCAgICByZXR1cm4gIWRlZXBDb21wYXJlKGFjdHVhbCwgZXhwZWN0ZWQuc3Vic3RyaW5nKDEpLCBjb21wYXJhdG9yLCBtYXRjaEFnYWluc3RBbnlQcm9wKTtcblx0ICB9IGVsc2UgaWYgKGlzQXJyYXkoYWN0dWFsKSkge1xuXHQgICAgLy8gSW4gY2FzZSBgYWN0dWFsYCBpcyBhbiBhcnJheSwgY29uc2lkZXIgaXQgYSBtYXRjaFxuXHQgICAgLy8gaWYgQU5ZIG9mIGl0J3MgaXRlbXMgbWF0Y2hlcyBgZXhwZWN0ZWRgXG5cdCAgICByZXR1cm4gYWN0dWFsLnNvbWUoZnVuY3Rpb24oaXRlbSkge1xuXHQgICAgICByZXR1cm4gZGVlcENvbXBhcmUoaXRlbSwgZXhwZWN0ZWQsIGNvbXBhcmF0b3IsIG1hdGNoQWdhaW5zdEFueVByb3ApO1xuXHQgICAgfSk7XG5cdCAgfVxuXHRcblx0ICBzd2l0Y2ggKGFjdHVhbFR5cGUpIHtcblx0ICAgIGNhc2UgJ29iamVjdCc6XG5cdCAgICAgIHZhciBrZXk7XG5cdCAgICAgIGlmIChtYXRjaEFnYWluc3RBbnlQcm9wKSB7XG5cdCAgICAgICAgZm9yIChrZXkgaW4gYWN0dWFsKSB7XG5cdCAgICAgICAgICBpZiAoKGtleS5jaGFyQXQoMCkgIT09ICckJykgJiYgZGVlcENvbXBhcmUoYWN0dWFsW2tleV0sIGV4cGVjdGVkLCBjb21wYXJhdG9yLCB0cnVlKSkge1xuXHQgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIGRvbnRNYXRjaFdob2xlT2JqZWN0ID8gZmFsc2UgOiBkZWVwQ29tcGFyZShhY3R1YWwsIGV4cGVjdGVkLCBjb21wYXJhdG9yLCBmYWxzZSk7XG5cdCAgICAgIH0gZWxzZSBpZiAoZXhwZWN0ZWRUeXBlID09PSAnb2JqZWN0Jykge1xuXHQgICAgICAgIGZvciAoa2V5IGluIGV4cGVjdGVkKSB7XG5cdCAgICAgICAgICB2YXIgZXhwZWN0ZWRWYWwgPSBleHBlY3RlZFtrZXldO1xuXHQgICAgICAgICAgaWYgKGlzRnVuY3Rpb24oZXhwZWN0ZWRWYWwpIHx8IGlzVW5kZWZpbmVkKGV4cGVjdGVkVmFsKSkge1xuXHQgICAgICAgICAgICBjb250aW51ZTtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICB2YXIgbWF0Y2hBbnlQcm9wZXJ0eSA9IGtleSA9PT0gJyQnO1xuXHQgICAgICAgICAgdmFyIGFjdHVhbFZhbCA9IG1hdGNoQW55UHJvcGVydHkgPyBhY3R1YWwgOiBhY3R1YWxba2V5XTtcblx0ICAgICAgICAgIGlmICghZGVlcENvbXBhcmUoYWN0dWFsVmFsLCBleHBlY3RlZFZhbCwgY29tcGFyYXRvciwgbWF0Y2hBbnlQcm9wZXJ0eSwgbWF0Y2hBbnlQcm9wZXJ0eSkpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICByZXR1cm4gY29tcGFyYXRvcihhY3R1YWwsIGV4cGVjdGVkKTtcblx0ICAgICAgfVxuXHQgICAgICBicmVhaztcblx0ICAgIGNhc2UgJ2Z1bmN0aW9uJzpcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgZGVmYXVsdDpcblx0ICAgICAgcmV0dXJuIGNvbXBhcmF0b3IoYWN0dWFsLCBleHBlY3RlZCk7XG5cdCAgfVxuXHR9XG5cdFxuXHQvLyBVc2VkIGZvciBlYXNpbHkgZGlmZmVyZW50aWF0aW5nIGJldHdlZW4gYG51bGxgIGFuZCBhY3R1YWwgYG9iamVjdGBcblx0ZnVuY3Rpb24gZ2V0VHlwZUZvckZpbHRlcih2YWwpIHtcblx0ICByZXR1cm4gKHZhbCA9PT0gbnVsbCkgPyAnbnVsbCcgOiB0eXBlb2YgdmFsO1xuXHR9XG5cdFxuXHR2YXIgTUFYX0RJR0lUUyA9IDIyO1xuXHR2YXIgREVDSU1BTF9TRVAgPSAnLic7XG5cdHZhciBaRVJPX0NIQVIgPSAnMCc7XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGZpbHRlclxuXHQgKiBAbmFtZSBjdXJyZW5jeVxuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogRm9ybWF0cyBhIG51bWJlciBhcyBhIGN1cnJlbmN5IChpZSAkMSwyMzQuNTYpLiBXaGVuIG5vIGN1cnJlbmN5IHN5bWJvbCBpcyBwcm92aWRlZCwgZGVmYXVsdFxuXHQgKiBzeW1ib2wgZm9yIGN1cnJlbnQgbG9jYWxlIGlzIHVzZWQuXG5cdCAqXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBhbW91bnQgSW5wdXQgdG8gZmlsdGVyLlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IHN5bWJvbCBDdXJyZW5jeSBzeW1ib2wgb3IgaWRlbnRpZmllciB0byBiZSBkaXNwbGF5ZWQuXG5cdCAqIEBwYXJhbSB7bnVtYmVyPX0gZnJhY3Rpb25TaXplIE51bWJlciBvZiBkZWNpbWFsIHBsYWNlcyB0byByb3VuZCB0aGUgYW1vdW50IHRvLCBkZWZhdWx0cyB0byBkZWZhdWx0IG1heCBmcmFjdGlvbiBzaXplIGZvciBjdXJyZW50IGxvY2FsZVxuXHQgKiBAcmV0dXJucyB7c3RyaW5nfSBGb3JtYXR0ZWQgbnVtYmVyLlxuXHQgKlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZSBtb2R1bGU9XCJjdXJyZW5jeUV4YW1wbGVcIj5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgPHNjcmlwdD5cblx0ICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2N1cnJlbmN5RXhhbXBsZScsIFtdKVxuXHQgICAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAgICAgICAgICAgICAkc2NvcGUuYW1vdW50ID0gMTIzNC41Njtcblx0ICAgICAgICAgICB9XSk7XG5cdCAgICAgICA8L3NjcmlwdD5cblx0ICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAgICAgICAgIDxpbnB1dCB0eXBlPVwibnVtYmVyXCIgbmctbW9kZWw9XCJhbW91bnRcIiBhcmlhLWxhYmVsPVwiYW1vdW50XCI+IDxicj5cblx0ICAgICAgICAgZGVmYXVsdCBjdXJyZW5jeSBzeW1ib2wgKCQpOiA8c3BhbiBpZD1cImN1cnJlbmN5LWRlZmF1bHRcIj57e2Ftb3VudCB8IGN1cnJlbmN5fX08L3NwYW4+PGJyPlxuXHQgICAgICAgICBjdXN0b20gY3VycmVuY3kgaWRlbnRpZmllciAoVVNEJCk6IDxzcGFuIGlkPVwiY3VycmVuY3ktY3VzdG9tXCI+e3thbW91bnQgfCBjdXJyZW5jeTpcIlVTRCRcIn19PC9zcGFuPlxuXHQgICAgICAgICBubyBmcmFjdGlvbnMgKDApOiA8c3BhbiBpZD1cImN1cnJlbmN5LW5vLWZyYWN0aW9uc1wiPnt7YW1vdW50IHwgY3VycmVuY3k6XCJVU0QkXCI6MH19PC9zcGFuPlxuXHQgICAgICAgPC9kaXY+XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgIGl0KCdzaG91bGQgaW5pdCB3aXRoIDEyMzQuNTYnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2N1cnJlbmN5LWRlZmF1bHQnKSkuZ2V0VGV4dCgpKS50b0JlKCckMSwyMzQuNTYnKTtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2N1cnJlbmN5LWN1c3RvbScpKS5nZXRUZXh0KCkpLnRvQmUoJ1VTRCQxLDIzNC41NicpO1xuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnY3VycmVuY3ktbm8tZnJhY3Rpb25zJykpLmdldFRleHQoKSkudG9CZSgnVVNEJDEsMjM1Jyk7XG5cdCAgICAgICB9KTtcblx0ICAgICAgIGl0KCdzaG91bGQgdXBkYXRlJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgIGlmIChicm93c2VyLnBhcmFtcy5icm93c2VyID09ICdzYWZhcmknKSB7XG5cdCAgICAgICAgICAgLy8gU2FmYXJpIGRvZXMgbm90IHVuZGVyc3RhbmQgdGhlIG1pbnVzIGtleS4gU2VlXG5cdCAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvcHJvdHJhY3Rvci9pc3N1ZXMvNDgxXG5cdCAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICB9XG5cdCAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ2Ftb3VudCcpKS5jbGVhcigpO1xuXHQgICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCdhbW91bnQnKSkuc2VuZEtleXMoJy0xMjM0Jyk7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmlkKCdjdXJyZW5jeS1kZWZhdWx0JykpLmdldFRleHQoKSkudG9CZSgnLSQxLDIzNC4wMCcpO1xuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnY3VycmVuY3ktY3VzdG9tJykpLmdldFRleHQoKSkudG9CZSgnLVVTRCQxLDIzNC4wMCcpO1xuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnY3VycmVuY3ktbm8tZnJhY3Rpb25zJykpLmdldFRleHQoKSkudG9CZSgnLVVTRCQxLDIzNCcpO1xuXHQgICAgICAgfSk7XG5cdCAgICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCAqL1xuXHRjdXJyZW5jeUZpbHRlci4kaW5qZWN0ID0gWyckbG9jYWxlJ107XG5cdGZ1bmN0aW9uIGN1cnJlbmN5RmlsdGVyKCRsb2NhbGUpIHtcblx0ICB2YXIgZm9ybWF0cyA9ICRsb2NhbGUuTlVNQkVSX0ZPUk1BVFM7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uKGFtb3VudCwgY3VycmVuY3lTeW1ib2wsIGZyYWN0aW9uU2l6ZSkge1xuXHQgICAgaWYgKGlzVW5kZWZpbmVkKGN1cnJlbmN5U3ltYm9sKSkge1xuXHQgICAgICBjdXJyZW5jeVN5bWJvbCA9IGZvcm1hdHMuQ1VSUkVOQ1lfU1lNO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmIChpc1VuZGVmaW5lZChmcmFjdGlvblNpemUpKSB7XG5cdCAgICAgIGZyYWN0aW9uU2l6ZSA9IGZvcm1hdHMuUEFUVEVSTlNbMV0ubWF4RnJhYztcblx0ICAgIH1cblx0XG5cdCAgICAvLyBpZiBudWxsIG9yIHVuZGVmaW5lZCBwYXNzIGl0IHRocm91Z2hcblx0ICAgIHJldHVybiAoYW1vdW50ID09IG51bGwpXG5cdCAgICAgICAgPyBhbW91bnRcblx0ICAgICAgICA6IGZvcm1hdE51bWJlcihhbW91bnQsIGZvcm1hdHMuUEFUVEVSTlNbMV0sIGZvcm1hdHMuR1JPVVBfU0VQLCBmb3JtYXRzLkRFQ0lNQUxfU0VQLCBmcmFjdGlvblNpemUpLlxuXHQgICAgICAgICAgICByZXBsYWNlKC9cXHUwMEE0L2csIGN1cnJlbmN5U3ltYm9sKTtcblx0ICB9O1xuXHR9XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGZpbHRlclxuXHQgKiBAbmFtZSBudW1iZXJcblx0ICogQGtpbmQgZnVuY3Rpb25cblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEZvcm1hdHMgYSBudW1iZXIgYXMgdGV4dC5cblx0ICpcblx0ICogSWYgdGhlIGlucHV0IGlzIG51bGwgb3IgdW5kZWZpbmVkLCBpdCB3aWxsIGp1c3QgYmUgcmV0dXJuZWQuXG5cdCAqIElmIHRoZSBpbnB1dCBpcyBpbmZpbml0ZSAoSW5maW5pdHkvLUluZmluaXR5KSB0aGUgSW5maW5pdHkgc3ltYm9sICfiiJ4nIGlzIHJldHVybmVkLlxuXHQgKiBJZiB0aGUgaW5wdXQgaXMgbm90IGEgbnVtYmVyIGFuIGVtcHR5IHN0cmluZyBpcyByZXR1cm5lZC5cblx0ICpcblx0ICpcblx0ICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSBudW1iZXIgTnVtYmVyIHRvIGZvcm1hdC5cblx0ICogQHBhcmFtIHsobnVtYmVyfHN0cmluZyk9fSBmcmFjdGlvblNpemUgTnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzIHRvIHJvdW5kIHRoZSBudW1iZXIgdG8uXG5cdCAqIElmIHRoaXMgaXMgbm90IHByb3ZpZGVkIHRoZW4gdGhlIGZyYWN0aW9uIHNpemUgaXMgY29tcHV0ZWQgZnJvbSB0aGUgY3VycmVudCBsb2NhbGUncyBudW1iZXJcblx0ICogZm9ybWF0dGluZyBwYXR0ZXJuLiBJbiB0aGUgY2FzZSBvZiB0aGUgZGVmYXVsdCBsb2NhbGUsIGl0IHdpbGwgYmUgMy5cblx0ICogQHJldHVybnMge3N0cmluZ30gTnVtYmVyIHJvdW5kZWQgdG8gZnJhY3Rpb25TaXplIGFuZCBwbGFjZXMgYSDigJws4oCdIGFmdGVyIGVhY2ggdGhpcmQgZGlnaXQuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlIG1vZHVsZT1cIm51bWJlckZpbHRlckV4YW1wbGVcIj5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgPHNjcmlwdD5cblx0ICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ251bWJlckZpbHRlckV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgICAgJHNjb3BlLnZhbCA9IDEyMzQuNTY3ODk7XG5cdCAgICAgICAgICAgfV0pO1xuXHQgICAgICAgPC9zY3JpcHQ+XG5cdCAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgICAgICAgICA8bGFiZWw+RW50ZXIgbnVtYmVyOiA8aW5wdXQgbmctbW9kZWw9J3ZhbCc+PC9sYWJlbD48YnI+XG5cdCAgICAgICAgIERlZmF1bHQgZm9ybWF0dGluZzogPHNwYW4gaWQ9J251bWJlci1kZWZhdWx0Jz57e3ZhbCB8IG51bWJlcn19PC9zcGFuPjxicj5cblx0ICAgICAgICAgTm8gZnJhY3Rpb25zOiA8c3Bhbj57e3ZhbCB8IG51bWJlcjowfX08L3NwYW4+PGJyPlxuXHQgICAgICAgICBOZWdhdGl2ZSBudW1iZXI6IDxzcGFuPnt7LXZhbCB8IG51bWJlcjo0fX08L3NwYW4+XG5cdCAgICAgICA8L2Rpdj5cblx0ICAgICA8L2ZpbGU+XG5cdCAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgaXQoJ3Nob3VsZCBmb3JtYXQgbnVtYmVycycsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnbnVtYmVyLWRlZmF1bHQnKSkuZ2V0VGV4dCgpKS50b0JlKCcxLDIzNC41NjgnKTtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygndmFsIHwgbnVtYmVyOjAnKSkuZ2V0VGV4dCgpKS50b0JlKCcxLDIzNScpO1xuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKCctdmFsIHwgbnVtYmVyOjQnKSkuZ2V0VGV4dCgpKS50b0JlKCctMSwyMzQuNTY3OScpO1xuXHQgICAgICAgfSk7XG5cdFxuXHQgICAgICAgaXQoJ3Nob3VsZCB1cGRhdGUnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgZWxlbWVudChieS5tb2RlbCgndmFsJykpLmNsZWFyKCk7XG5cdCAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ3ZhbCcpKS5zZW5kS2V5cygnMzM3NC4zMzMnKTtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ251bWJlci1kZWZhdWx0JykpLmdldFRleHQoKSkudG9CZSgnMywzNzQuMzMzJyk7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ3ZhbCB8IG51bWJlcjowJykpLmdldFRleHQoKSkudG9CZSgnMywzNzQnKTtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygnLXZhbCB8IG51bWJlcjo0JykpLmdldFRleHQoKSkudG9CZSgnLTMsMzc0LjMzMzAnKTtcblx0ICAgICAgfSk7XG5cdCAgICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCAqL1xuXHRudW1iZXJGaWx0ZXIuJGluamVjdCA9IFsnJGxvY2FsZSddO1xuXHRmdW5jdGlvbiBudW1iZXJGaWx0ZXIoJGxvY2FsZSkge1xuXHQgIHZhciBmb3JtYXRzID0gJGxvY2FsZS5OVU1CRVJfRk9STUFUUztcblx0ICByZXR1cm4gZnVuY3Rpb24obnVtYmVyLCBmcmFjdGlvblNpemUpIHtcblx0XG5cdCAgICAvLyBpZiBudWxsIG9yIHVuZGVmaW5lZCBwYXNzIGl0IHRocm91Z2hcblx0ICAgIHJldHVybiAobnVtYmVyID09IG51bGwpXG5cdCAgICAgICAgPyBudW1iZXJcblx0ICAgICAgICA6IGZvcm1hdE51bWJlcihudW1iZXIsIGZvcm1hdHMuUEFUVEVSTlNbMF0sIGZvcm1hdHMuR1JPVVBfU0VQLCBmb3JtYXRzLkRFQ0lNQUxfU0VQLFxuXHQgICAgICAgICAgICAgICAgICAgICAgIGZyYWN0aW9uU2l6ZSk7XG5cdCAgfTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIFBhcnNlIGEgbnVtYmVyIChhcyBhIHN0cmluZykgaW50byB0aHJlZSBjb21wb25lbnRzIHRoYXQgY2FuIGJlIHVzZWRcblx0ICogZm9yIGZvcm1hdHRpbmcgdGhlIG51bWJlci5cblx0ICpcblx0ICogKFNpZ25pZmljYW50IGJpdHMgb2YgdGhpcyBwYXJzZSBhbGdvcml0aG0gY2FtZSBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWtlTWNsL2JpZy5qcy8pXG5cdCAqXG5cdCAqIEBwYXJhbSAge3N0cmluZ30gbnVtU3RyIFRoZSBudW1iZXIgdG8gcGFyc2Vcblx0ICogQHJldHVybiB7b2JqZWN0fSBBbiBvYmplY3QgZGVzY3JpYmluZyB0aGlzIG51bWJlciwgY29udGFpbmluZyB0aGUgZm9sbG93aW5nIGtleXM6XG5cdCAqICAtIGQgOiBhbiBhcnJheSBvZiBkaWdpdHMgY29udGFpbmluZyBsZWFkaW5nIHplcm9zIGFzIG5lY2Vzc2FyeVxuXHQgKiAgLSBpIDogdGhlIG51bWJlciBvZiB0aGUgZGlnaXRzIGluIGBkYCB0aGF0IGFyZSB0byB0aGUgbGVmdCBvZiB0aGUgZGVjaW1hbCBwb2ludFxuXHQgKiAgLSBlIDogdGhlIGV4cG9uZW50IGZvciBudW1iZXJzIHRoYXQgd291bGQgbmVlZCBtb3JlIHRoYW4gYE1BWF9ESUdJVFNgIGRpZ2l0cyBpbiBgZGBcblx0ICpcblx0ICovXG5cdGZ1bmN0aW9uIHBhcnNlKG51bVN0cikge1xuXHQgIHZhciBleHBvbmVudCA9IDAsIGRpZ2l0cywgbnVtYmVyT2ZJbnRlZ2VyRGlnaXRzO1xuXHQgIHZhciBpLCBqLCB6ZXJvcztcblx0XG5cdCAgLy8gRGVjaW1hbCBwb2ludD9cblx0ICBpZiAoKG51bWJlck9mSW50ZWdlckRpZ2l0cyA9IG51bVN0ci5pbmRleE9mKERFQ0lNQUxfU0VQKSkgPiAtMSkge1xuXHQgICAgbnVtU3RyID0gbnVtU3RyLnJlcGxhY2UoREVDSU1BTF9TRVAsICcnKTtcblx0ICB9XG5cdFxuXHQgIC8vIEV4cG9uZW50aWFsIGZvcm0/XG5cdCAgaWYgKChpID0gbnVtU3RyLnNlYXJjaCgvZS9pKSkgPiAwKSB7XG5cdCAgICAvLyBXb3JrIG91dCB0aGUgZXhwb25lbnQuXG5cdCAgICBpZiAobnVtYmVyT2ZJbnRlZ2VyRGlnaXRzIDwgMCkgbnVtYmVyT2ZJbnRlZ2VyRGlnaXRzID0gaTtcblx0ICAgIG51bWJlck9mSW50ZWdlckRpZ2l0cyArPSArbnVtU3RyLnNsaWNlKGkgKyAxKTtcblx0ICAgIG51bVN0ciA9IG51bVN0ci5zdWJzdHJpbmcoMCwgaSk7XG5cdCAgfSBlbHNlIGlmIChudW1iZXJPZkludGVnZXJEaWdpdHMgPCAwKSB7XG5cdCAgICAvLyBUaGVyZSB3YXMgbm8gZGVjaW1hbCBwb2ludCBvciBleHBvbmVudCBzbyBpdCBpcyBhbiBpbnRlZ2VyLlxuXHQgICAgbnVtYmVyT2ZJbnRlZ2VyRGlnaXRzID0gbnVtU3RyLmxlbmd0aDtcblx0ICB9XG5cdFxuXHQgIC8vIENvdW50IHRoZSBudW1iZXIgb2YgbGVhZGluZyB6ZXJvcy5cblx0ICBmb3IgKGkgPSAwOyBudW1TdHIuY2hhckF0KGkpID09IFpFUk9fQ0hBUjsgaSsrKTtcblx0XG5cdCAgaWYgKGkgPT0gKHplcm9zID0gbnVtU3RyLmxlbmd0aCkpIHtcblx0ICAgIC8vIFRoZSBkaWdpdHMgYXJlIGFsbCB6ZXJvLlxuXHQgICAgZGlnaXRzID0gWzBdO1xuXHQgICAgbnVtYmVyT2ZJbnRlZ2VyRGlnaXRzID0gMTtcblx0ICB9IGVsc2Uge1xuXHQgICAgLy8gQ291bnQgdGhlIG51bWJlciBvZiB0cmFpbGluZyB6ZXJvc1xuXHQgICAgemVyb3MtLTtcblx0ICAgIHdoaWxlIChudW1TdHIuY2hhckF0KHplcm9zKSA9PSBaRVJPX0NIQVIpIHplcm9zLS07XG5cdFxuXHQgICAgLy8gVHJhaWxpbmcgemVyb3MgYXJlIGluc2lnbmlmaWNhbnQgc28gaWdub3JlIHRoZW1cblx0ICAgIG51bWJlck9mSW50ZWdlckRpZ2l0cyAtPSBpO1xuXHQgICAgZGlnaXRzID0gW107XG5cdCAgICAvLyBDb252ZXJ0IHN0cmluZyB0byBhcnJheSBvZiBkaWdpdHMgd2l0aG91dCBsZWFkaW5nL3RyYWlsaW5nIHplcm9zLlxuXHQgICAgZm9yIChqID0gMDsgaSA8PSB6ZXJvczsgaSsrLCBqKyspIHtcblx0ICAgICAgZGlnaXRzW2pdID0gK251bVN0ci5jaGFyQXQoaSk7XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICAvLyBJZiB0aGUgbnVtYmVyIG92ZXJmbG93cyB0aGUgbWF4aW11bSBhbGxvd2VkIGRpZ2l0cyB0aGVuIHVzZSBhbiBleHBvbmVudC5cblx0ICBpZiAobnVtYmVyT2ZJbnRlZ2VyRGlnaXRzID4gTUFYX0RJR0lUUykge1xuXHQgICAgZGlnaXRzID0gZGlnaXRzLnNwbGljZSgwLCBNQVhfRElHSVRTIC0gMSk7XG5cdCAgICBleHBvbmVudCA9IG51bWJlck9mSW50ZWdlckRpZ2l0cyAtIDE7XG5cdCAgICBudW1iZXJPZkludGVnZXJEaWdpdHMgPSAxO1xuXHQgIH1cblx0XG5cdCAgcmV0dXJuIHsgZDogZGlnaXRzLCBlOiBleHBvbmVudCwgaTogbnVtYmVyT2ZJbnRlZ2VyRGlnaXRzIH07XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBSb3VuZCB0aGUgcGFyc2VkIG51bWJlciB0byB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlc1xuXHQgKiBUaGlzIGZ1bmN0aW9uIGNoYW5nZWQgdGhlIHBhcnNlZE51bWJlciBpbi1wbGFjZVxuXHQgKi9cblx0ZnVuY3Rpb24gcm91bmROdW1iZXIocGFyc2VkTnVtYmVyLCBmcmFjdGlvblNpemUsIG1pbkZyYWMsIG1heEZyYWMpIHtcblx0ICAgIHZhciBkaWdpdHMgPSBwYXJzZWROdW1iZXIuZDtcblx0ICAgIHZhciBmcmFjdGlvbkxlbiA9IGRpZ2l0cy5sZW5ndGggLSBwYXJzZWROdW1iZXIuaTtcblx0XG5cdCAgICAvLyBkZXRlcm1pbmUgZnJhY3Rpb25TaXplIGlmIGl0IGlzIG5vdCBzcGVjaWZpZWQ7IGArZnJhY3Rpb25TaXplYCBjb252ZXJ0cyBpdCB0byBhIG51bWJlclxuXHQgICAgZnJhY3Rpb25TaXplID0gKGlzVW5kZWZpbmVkKGZyYWN0aW9uU2l6ZSkpID8gTWF0aC5taW4oTWF0aC5tYXgobWluRnJhYywgZnJhY3Rpb25MZW4pLCBtYXhGcmFjKSA6ICtmcmFjdGlvblNpemU7XG5cdFxuXHQgICAgLy8gVGhlIGluZGV4IG9mIHRoZSBkaWdpdCB0byB3aGVyZSByb3VuZGluZyBpcyB0byBvY2N1clxuXHQgICAgdmFyIHJvdW5kQXQgPSBmcmFjdGlvblNpemUgKyBwYXJzZWROdW1iZXIuaTtcblx0ICAgIHZhciBkaWdpdCA9IGRpZ2l0c1tyb3VuZEF0XTtcblx0XG5cdCAgICBpZiAocm91bmRBdCA+IDApIHtcblx0ICAgICAgZGlnaXRzLnNwbGljZShyb3VuZEF0KTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIC8vIFdlIHJvdW5kZWQgdG8gemVybyBzbyByZXNldCB0aGUgcGFyc2VkTnVtYmVyXG5cdCAgICAgIHBhcnNlZE51bWJlci5pID0gMTtcblx0ICAgICAgZGlnaXRzLmxlbmd0aCA9IHJvdW5kQXQgPSBmcmFjdGlvblNpemUgKyAxO1xuXHQgICAgICBmb3IgKHZhciBpPTA7IGkgPCByb3VuZEF0OyBpKyspIGRpZ2l0c1tpXSA9IDA7XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKGRpZ2l0ID49IDUpIGRpZ2l0c1tyb3VuZEF0IC0gMV0rKztcblx0XG5cdCAgICAvLyBQYWQgb3V0IHdpdGggemVyb3MgdG8gZ2V0IHRoZSByZXF1aXJlZCBmcmFjdGlvbiBsZW5ndGhcblx0ICAgIGZvciAoOyBmcmFjdGlvbkxlbiA8IGZyYWN0aW9uU2l6ZTsgZnJhY3Rpb25MZW4rKykgZGlnaXRzLnB1c2goMCk7XG5cdFxuXHRcblx0ICAgIC8vIERvIGFueSBjYXJyeWluZywgZS5nLiBhIGRpZ2l0IHdhcyByb3VuZGVkIHVwIHRvIDEwXG5cdCAgICB2YXIgY2FycnkgPSBkaWdpdHMucmVkdWNlUmlnaHQoZnVuY3Rpb24oY2FycnksIGQsIGksIGRpZ2l0cykge1xuXHQgICAgICBkID0gZCArIGNhcnJ5O1xuXHQgICAgICBkaWdpdHNbaV0gPSBkICUgMTA7XG5cdCAgICAgIHJldHVybiBNYXRoLmZsb29yKGQgLyAxMCk7XG5cdCAgICB9LCAwKTtcblx0ICAgIGlmIChjYXJyeSkge1xuXHQgICAgICBkaWdpdHMudW5zaGlmdChjYXJyeSk7XG5cdCAgICAgIHBhcnNlZE51bWJlci5pKys7XG5cdCAgICB9XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBGb3JtYXQgYSBudW1iZXIgaW50byBhIHN0cmluZ1xuXHQgKiBAcGFyYW0gIHtudW1iZXJ9IG51bWJlciAgICAgICBUaGUgbnVtYmVyIHRvIGZvcm1hdFxuXHQgKiBAcGFyYW0gIHt7XG5cdCAqICAgICAgICAgICBtaW5GcmFjLCAvLyB0aGUgbWluaW11bSBudW1iZXIgb2YgZGlnaXRzIHJlcXVpcmVkIGluIHRoZSBmcmFjdGlvbiBwYXJ0IG9mIHRoZSBudW1iZXJcblx0ICogICAgICAgICAgIG1heEZyYWMsIC8vIHRoZSBtYXhpbXVtIG51bWJlciBvZiBkaWdpdHMgcmVxdWlyZWQgaW4gdGhlIGZyYWN0aW9uIHBhcnQgb2YgdGhlIG51bWJlclxuXHQgKiAgICAgICAgICAgZ1NpemUsICAgLy8gbnVtYmVyIG9mIGRpZ2l0cyBpbiBlYWNoIGdyb3VwIG9mIHNlcGFyYXRlZCBkaWdpdHNcblx0ICogICAgICAgICAgIGxnU2l6ZSwgIC8vIG51bWJlciBvZiBkaWdpdHMgaW4gdGhlIGxhc3QgZ3JvdXAgb2YgZGlnaXRzIGJlZm9yZSB0aGUgZGVjaW1hbCBzZXBhcmF0b3Jcblx0ICogICAgICAgICAgIG5lZ1ByZSwgIC8vIHRoZSBzdHJpbmcgdG8gZ28gaW4gZnJvbnQgb2YgYSBuZWdhdGl2ZSBudW1iZXIgKGUuZy4gYC1gIG9yIGAoYCkpXG5cdCAqICAgICAgICAgICBwb3NQcmUsICAvLyB0aGUgc3RyaW5nIHRvIGdvIGluIGZyb250IG9mIGEgcG9zaXRpdmUgbnVtYmVyXG5cdCAqICAgICAgICAgICBuZWdTdWYsICAvLyB0aGUgc3RyaW5nIHRvIGdvIGFmdGVyIGEgbmVnYXRpdmUgbnVtYmVyIChlLmcuIGApYClcblx0ICogICAgICAgICAgIHBvc1N1ZiAgIC8vIHRoZSBzdHJpbmcgdG8gZ28gYWZ0ZXIgYSBwb3NpdGl2ZSBudW1iZXJcblx0ICogICAgICAgICB9fSBwYXR0ZXJuXG5cdCAqIEBwYXJhbSAge3N0cmluZ30gZ3JvdXBTZXAgICAgIFRoZSBzdHJpbmcgdG8gc2VwYXJhdGUgZ3JvdXBzIG9mIG51bWJlciAoZS5nLiBgLGApXG5cdCAqIEBwYXJhbSAge3N0cmluZ30gZGVjaW1hbFNlcCAgIFRoZSBzdHJpbmcgdG8gYWN0IGFzIHRoZSBkZWNpbWFsIHNlcGFyYXRvciAoZS5nLiBgLmApXG5cdCAqIEBwYXJhbSAge1t0eXBlXX0gZnJhY3Rpb25TaXplIFRoZSBzaXplIG9mIHRoZSBmcmFjdGlvbmFsIHBhcnQgb2YgdGhlIG51bWJlclxuXHQgKiBAcmV0dXJuIHtzdHJpbmd9ICAgICAgICAgICAgICBUaGUgbnVtYmVyIGZvcm1hdHRlZCBhcyBhIHN0cmluZ1xuXHQgKi9cblx0ZnVuY3Rpb24gZm9ybWF0TnVtYmVyKG51bWJlciwgcGF0dGVybiwgZ3JvdXBTZXAsIGRlY2ltYWxTZXAsIGZyYWN0aW9uU2l6ZSkge1xuXHRcblx0ICBpZiAoIShpc1N0cmluZyhudW1iZXIpIHx8IGlzTnVtYmVyKG51bWJlcikpIHx8IGlzTmFOKG51bWJlcikpIHJldHVybiAnJztcblx0XG5cdCAgdmFyIGlzSW5maW5pdHkgPSAhaXNGaW5pdGUobnVtYmVyKTtcblx0ICB2YXIgaXNaZXJvID0gZmFsc2U7XG5cdCAgdmFyIG51bVN0ciA9IE1hdGguYWJzKG51bWJlcikgKyAnJyxcblx0ICAgICAgZm9ybWF0dGVkVGV4dCA9ICcnLFxuXHQgICAgICBwYXJzZWROdW1iZXI7XG5cdFxuXHQgIGlmIChpc0luZmluaXR5KSB7XG5cdCAgICBmb3JtYXR0ZWRUZXh0ID0gJ1xcdTIyMWUnO1xuXHQgIH0gZWxzZSB7XG5cdCAgICBwYXJzZWROdW1iZXIgPSBwYXJzZShudW1TdHIpO1xuXHRcblx0ICAgIHJvdW5kTnVtYmVyKHBhcnNlZE51bWJlciwgZnJhY3Rpb25TaXplLCBwYXR0ZXJuLm1pbkZyYWMsIHBhdHRlcm4ubWF4RnJhYyk7XG5cdFxuXHQgICAgdmFyIGRpZ2l0cyA9IHBhcnNlZE51bWJlci5kO1xuXHQgICAgdmFyIGludGVnZXJMZW4gPSBwYXJzZWROdW1iZXIuaTtcblx0ICAgIHZhciBleHBvbmVudCA9IHBhcnNlZE51bWJlci5lO1xuXHQgICAgdmFyIGRlY2ltYWxzID0gW107XG5cdCAgICBpc1plcm8gPSBkaWdpdHMucmVkdWNlKGZ1bmN0aW9uKGlzWmVybywgZCkgeyByZXR1cm4gaXNaZXJvICYmICFkOyB9LCB0cnVlKTtcblx0XG5cdCAgICAvLyBwYWQgemVyb3MgZm9yIHNtYWxsIG51bWJlcnNcblx0ICAgIHdoaWxlIChpbnRlZ2VyTGVuIDwgMCkge1xuXHQgICAgICBkaWdpdHMudW5zaGlmdCgwKTtcblx0ICAgICAgaW50ZWdlckxlbisrO1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIGV4dHJhY3QgZGVjaW1hbHMgZGlnaXRzXG5cdCAgICBpZiAoaW50ZWdlckxlbiA+IDApIHtcblx0ICAgICAgZGVjaW1hbHMgPSBkaWdpdHMuc3BsaWNlKGludGVnZXJMZW4pO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgZGVjaW1hbHMgPSBkaWdpdHM7XG5cdCAgICAgIGRpZ2l0cyA9IFswXTtcblx0ICAgIH1cblx0XG5cdCAgICAvLyBmb3JtYXQgdGhlIGludGVnZXIgZGlnaXRzIHdpdGggZ3JvdXBpbmcgc2VwYXJhdG9yc1xuXHQgICAgdmFyIGdyb3VwcyA9IFtdO1xuXHQgICAgaWYgKGRpZ2l0cy5sZW5ndGggPiBwYXR0ZXJuLmxnU2l6ZSkge1xuXHQgICAgICBncm91cHMudW5zaGlmdChkaWdpdHMuc3BsaWNlKC1wYXR0ZXJuLmxnU2l6ZSkuam9pbignJykpO1xuXHQgICAgfVxuXHQgICAgd2hpbGUgKGRpZ2l0cy5sZW5ndGggPiBwYXR0ZXJuLmdTaXplKSB7XG5cdCAgICAgIGdyb3Vwcy51bnNoaWZ0KGRpZ2l0cy5zcGxpY2UoLXBhdHRlcm4uZ1NpemUpLmpvaW4oJycpKTtcblx0ICAgIH1cblx0ICAgIGlmIChkaWdpdHMubGVuZ3RoKSB7XG5cdCAgICAgIGdyb3Vwcy51bnNoaWZ0KGRpZ2l0cy5qb2luKCcnKSk7XG5cdCAgICB9XG5cdCAgICBmb3JtYXR0ZWRUZXh0ID0gZ3JvdXBzLmpvaW4oZ3JvdXBTZXApO1xuXHRcblx0ICAgIC8vIGFwcGVuZCB0aGUgZGVjaW1hbCBkaWdpdHNcblx0ICAgIGlmIChkZWNpbWFscy5sZW5ndGgpIHtcblx0ICAgICAgZm9ybWF0dGVkVGV4dCArPSBkZWNpbWFsU2VwICsgZGVjaW1hbHMuam9pbignJyk7XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKGV4cG9uZW50KSB7XG5cdCAgICAgIGZvcm1hdHRlZFRleHQgKz0gJ2UrJyArIGV4cG9uZW50O1xuXHQgICAgfVxuXHQgIH1cblx0ICBpZiAobnVtYmVyIDwgMCAmJiAhaXNaZXJvKSB7XG5cdCAgICByZXR1cm4gcGF0dGVybi5uZWdQcmUgKyBmb3JtYXR0ZWRUZXh0ICsgcGF0dGVybi5uZWdTdWY7XG5cdCAgfSBlbHNlIHtcblx0ICAgIHJldHVybiBwYXR0ZXJuLnBvc1ByZSArIGZvcm1hdHRlZFRleHQgKyBwYXR0ZXJuLnBvc1N1Zjtcblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHBhZE51bWJlcihudW0sIGRpZ2l0cywgdHJpbSkge1xuXHQgIHZhciBuZWcgPSAnJztcblx0ICBpZiAobnVtIDwgMCkge1xuXHQgICAgbmVnID0gICctJztcblx0ICAgIG51bSA9IC1udW07XG5cdCAgfVxuXHQgIG51bSA9ICcnICsgbnVtO1xuXHQgIHdoaWxlIChudW0ubGVuZ3RoIDwgZGlnaXRzKSBudW0gPSBaRVJPX0NIQVIgKyBudW07XG5cdCAgaWYgKHRyaW0pIHtcblx0ICAgIG51bSA9IG51bS5zdWJzdHIobnVtLmxlbmd0aCAtIGRpZ2l0cyk7XG5cdCAgfVxuXHQgIHJldHVybiBuZWcgKyBudW07XG5cdH1cblx0XG5cdFxuXHRmdW5jdGlvbiBkYXRlR2V0dGVyKG5hbWUsIHNpemUsIG9mZnNldCwgdHJpbSkge1xuXHQgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXHQgIHJldHVybiBmdW5jdGlvbihkYXRlKSB7XG5cdCAgICB2YXIgdmFsdWUgPSBkYXRlWydnZXQnICsgbmFtZV0oKTtcblx0ICAgIGlmIChvZmZzZXQgPiAwIHx8IHZhbHVlID4gLW9mZnNldCkge1xuXHQgICAgICB2YWx1ZSArPSBvZmZzZXQ7XG5cdCAgICB9XG5cdCAgICBpZiAodmFsdWUgPT09IDAgJiYgb2Zmc2V0ID09IC0xMikgdmFsdWUgPSAxMjtcblx0ICAgIHJldHVybiBwYWROdW1iZXIodmFsdWUsIHNpemUsIHRyaW0pO1xuXHQgIH07XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGRhdGVTdHJHZXR0ZXIobmFtZSwgc2hvcnRGb3JtKSB7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uKGRhdGUsIGZvcm1hdHMpIHtcblx0ICAgIHZhciB2YWx1ZSA9IGRhdGVbJ2dldCcgKyBuYW1lXSgpO1xuXHQgICAgdmFyIGdldCA9IHVwcGVyY2FzZShzaG9ydEZvcm0gPyAoJ1NIT1JUJyArIG5hbWUpIDogbmFtZSk7XG5cdFxuXHQgICAgcmV0dXJuIGZvcm1hdHNbZ2V0XVt2YWx1ZV07XG5cdCAgfTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gdGltZVpvbmVHZXR0ZXIoZGF0ZSwgZm9ybWF0cywgb2Zmc2V0KSB7XG5cdCAgdmFyIHpvbmUgPSAtMSAqIG9mZnNldDtcblx0ICB2YXIgcGFkZGVkWm9uZSA9ICh6b25lID49IDApID8gXCIrXCIgOiBcIlwiO1xuXHRcblx0ICBwYWRkZWRab25lICs9IHBhZE51bWJlcihNYXRoW3pvbmUgPiAwID8gJ2Zsb29yJyA6ICdjZWlsJ10oem9uZSAvIDYwKSwgMikgK1xuXHQgICAgICAgICAgICAgICAgcGFkTnVtYmVyKE1hdGguYWJzKHpvbmUgJSA2MCksIDIpO1xuXHRcblx0ICByZXR1cm4gcGFkZGVkWm9uZTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gZ2V0Rmlyc3RUaHVyc2RheU9mWWVhcih5ZWFyKSB7XG5cdCAgICAvLyAwID0gaW5kZXggb2YgSmFudWFyeVxuXHQgICAgdmFyIGRheU9mV2Vla09uRmlyc3QgPSAobmV3IERhdGUoeWVhciwgMCwgMSkpLmdldERheSgpO1xuXHQgICAgLy8gNCA9IGluZGV4IG9mIFRodXJzZGF5ICgrMSB0byBhY2NvdW50IGZvciAxc3QgPSA1KVxuXHQgICAgLy8gMTEgPSBpbmRleCBvZiAqbmV4dCogVGh1cnNkYXkgKCsxIGFjY291bnQgZm9yIDFzdCA9IDEyKVxuXHQgICAgcmV0dXJuIG5ldyBEYXRlKHllYXIsIDAsICgoZGF5T2ZXZWVrT25GaXJzdCA8PSA0KSA/IDUgOiAxMikgLSBkYXlPZldlZWtPbkZpcnN0KTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gZ2V0VGh1cnNkYXlUaGlzV2VlayhkYXRldGltZSkge1xuXHQgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGV0aW1lLmdldEZ1bGxZZWFyKCksIGRhdGV0aW1lLmdldE1vbnRoKCksXG5cdCAgICAgIC8vIDQgPSBpbmRleCBvZiBUaHVyc2RheVxuXHQgICAgICBkYXRldGltZS5nZXREYXRlKCkgKyAoNCAtIGRhdGV0aW1lLmdldERheSgpKSk7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHdlZWtHZXR0ZXIoc2l6ZSkge1xuXHQgICByZXR1cm4gZnVuY3Rpb24oZGF0ZSkge1xuXHQgICAgICB2YXIgZmlyc3RUaHVycyA9IGdldEZpcnN0VGh1cnNkYXlPZlllYXIoZGF0ZS5nZXRGdWxsWWVhcigpKSxcblx0ICAgICAgICAgdGhpc1RodXJzID0gZ2V0VGh1cnNkYXlUaGlzV2VlayhkYXRlKTtcblx0XG5cdCAgICAgIHZhciBkaWZmID0gK3RoaXNUaHVycyAtICtmaXJzdFRodXJzLFxuXHQgICAgICAgICByZXN1bHQgPSAxICsgTWF0aC5yb3VuZChkaWZmIC8gNi4wNDhlOCk7IC8vIDYuMDQ4ZTggbXMgcGVyIHdlZWtcblx0XG5cdCAgICAgIHJldHVybiBwYWROdW1iZXIocmVzdWx0LCBzaXplKTtcblx0ICAgfTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gYW1wbUdldHRlcihkYXRlLCBmb3JtYXRzKSB7XG5cdCAgcmV0dXJuIGRhdGUuZ2V0SG91cnMoKSA8IDEyID8gZm9ybWF0cy5BTVBNU1swXSA6IGZvcm1hdHMuQU1QTVNbMV07XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGVyYUdldHRlcihkYXRlLCBmb3JtYXRzKSB7XG5cdCAgcmV0dXJuIGRhdGUuZ2V0RnVsbFllYXIoKSA8PSAwID8gZm9ybWF0cy5FUkFTWzBdIDogZm9ybWF0cy5FUkFTWzFdO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBsb25nRXJhR2V0dGVyKGRhdGUsIGZvcm1hdHMpIHtcblx0ICByZXR1cm4gZGF0ZS5nZXRGdWxsWWVhcigpIDw9IDAgPyBmb3JtYXRzLkVSQU5BTUVTWzBdIDogZm9ybWF0cy5FUkFOQU1FU1sxXTtcblx0fVxuXHRcblx0dmFyIERBVEVfRk9STUFUUyA9IHtcblx0ICB5eXl5OiBkYXRlR2V0dGVyKCdGdWxsWWVhcicsIDQpLFxuXHQgICAgeXk6IGRhdGVHZXR0ZXIoJ0Z1bGxZZWFyJywgMiwgMCwgdHJ1ZSksXG5cdCAgICAgeTogZGF0ZUdldHRlcignRnVsbFllYXInLCAxKSxcblx0ICBNTU1NOiBkYXRlU3RyR2V0dGVyKCdNb250aCcpLFxuXHQgICBNTU06IGRhdGVTdHJHZXR0ZXIoJ01vbnRoJywgdHJ1ZSksXG5cdCAgICBNTTogZGF0ZUdldHRlcignTW9udGgnLCAyLCAxKSxcblx0ICAgICBNOiBkYXRlR2V0dGVyKCdNb250aCcsIDEsIDEpLFxuXHQgICAgZGQ6IGRhdGVHZXR0ZXIoJ0RhdGUnLCAyKSxcblx0ICAgICBkOiBkYXRlR2V0dGVyKCdEYXRlJywgMSksXG5cdCAgICBISDogZGF0ZUdldHRlcignSG91cnMnLCAyKSxcblx0ICAgICBIOiBkYXRlR2V0dGVyKCdIb3VycycsIDEpLFxuXHQgICAgaGg6IGRhdGVHZXR0ZXIoJ0hvdXJzJywgMiwgLTEyKSxcblx0ICAgICBoOiBkYXRlR2V0dGVyKCdIb3VycycsIDEsIC0xMiksXG5cdCAgICBtbTogZGF0ZUdldHRlcignTWludXRlcycsIDIpLFxuXHQgICAgIG06IGRhdGVHZXR0ZXIoJ01pbnV0ZXMnLCAxKSxcblx0ICAgIHNzOiBkYXRlR2V0dGVyKCdTZWNvbmRzJywgMiksXG5cdCAgICAgczogZGF0ZUdldHRlcignU2Vjb25kcycsIDEpLFxuXHQgICAgIC8vIHdoaWxlIElTTyA4NjAxIHJlcXVpcmVzIGZyYWN0aW9ucyB0byBiZSBwcmVmaXhlZCB3aXRoIGAuYCBvciBgLGBcblx0ICAgICAvLyB3ZSBjYW4gYmUganVzdCBzYWZlbHkgcmVseSBvbiB1c2luZyBgc3NzYCBzaW5jZSB3ZSBjdXJyZW50bHkgZG9uJ3Qgc3VwcG9ydCBzaW5nbGUgb3IgdHdvIGRpZ2l0IGZyYWN0aW9uc1xuXHQgICBzc3M6IGRhdGVHZXR0ZXIoJ01pbGxpc2Vjb25kcycsIDMpLFxuXHQgIEVFRUU6IGRhdGVTdHJHZXR0ZXIoJ0RheScpLFxuXHQgICBFRUU6IGRhdGVTdHJHZXR0ZXIoJ0RheScsIHRydWUpLFxuXHQgICAgIGE6IGFtcG1HZXR0ZXIsXG5cdCAgICAgWjogdGltZVpvbmVHZXR0ZXIsXG5cdCAgICB3dzogd2Vla0dldHRlcigyKSxcblx0ICAgICB3OiB3ZWVrR2V0dGVyKDEpLFxuXHQgICAgIEc6IGVyYUdldHRlcixcblx0ICAgICBHRzogZXJhR2V0dGVyLFxuXHQgICAgIEdHRzogZXJhR2V0dGVyLFxuXHQgICAgIEdHR0c6IGxvbmdFcmFHZXR0ZXJcblx0fTtcblx0XG5cdHZhciBEQVRFX0ZPUk1BVFNfU1BMSVQgPSAvKCg/OlteeU1kSGhtc2FaRXdHJ10rKXwoPzonKD86W14nXXwnJykqJyl8KD86RSt8eSt8TSt8ZCt8SCt8aCt8bSt8cyt8YXxafEcrfHcrKSkoLiopLyxcblx0ICAgIE5VTUJFUl9TVFJJTkcgPSAvXlxcLT9cXGQrJC87XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGZpbHRlclxuXHQgKiBAbmFtZSBkYXRlXG5cdCAqIEBraW5kIGZ1bmN0aW9uXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiAgIEZvcm1hdHMgYGRhdGVgIHRvIGEgc3RyaW5nIGJhc2VkIG9uIHRoZSByZXF1ZXN0ZWQgYGZvcm1hdGAuXG5cdCAqXG5cdCAqICAgYGZvcm1hdGAgc3RyaW5nIGNhbiBiZSBjb21wb3NlZCBvZiB0aGUgZm9sbG93aW5nIGVsZW1lbnRzOlxuXHQgKlxuXHQgKiAgICogYCd5eXl5J2A6IDQgZGlnaXQgcmVwcmVzZW50YXRpb24gb2YgeWVhciAoZS5nLiBBRCAxID0+IDAwMDEsIEFEIDIwMTAgPT4gMjAxMClcblx0ICogICAqIGAneXknYDogMiBkaWdpdCByZXByZXNlbnRhdGlvbiBvZiB5ZWFyLCBwYWRkZWQgKDAwLTk5KS4gKGUuZy4gQUQgMjAwMSA9PiAwMSwgQUQgMjAxMCA9PiAxMClcblx0ICogICAqIGAneSdgOiAxIGRpZ2l0IHJlcHJlc2VudGF0aW9uIG9mIHllYXIsIGUuZy4gKEFEIDEgPT4gMSwgQUQgMTk5ID0+IDE5OSlcblx0ICogICAqIGAnTU1NTSdgOiBNb250aCBpbiB5ZWFyIChKYW51YXJ5LURlY2VtYmVyKVxuXHQgKiAgICogYCdNTU0nYDogTW9udGggaW4geWVhciAoSmFuLURlYylcblx0ICogICAqIGAnTU0nYDogTW9udGggaW4geWVhciwgcGFkZGVkICgwMS0xMilcblx0ICogICAqIGAnTSdgOiBNb250aCBpbiB5ZWFyICgxLTEyKVxuXHQgKiAgICogYCdkZCdgOiBEYXkgaW4gbW9udGgsIHBhZGRlZCAoMDEtMzEpXG5cdCAqICAgKiBgJ2QnYDogRGF5IGluIG1vbnRoICgxLTMxKVxuXHQgKiAgICogYCdFRUVFJ2A6IERheSBpbiBXZWVrLChTdW5kYXktU2F0dXJkYXkpXG5cdCAqICAgKiBgJ0VFRSdgOiBEYXkgaW4gV2VlaywgKFN1bi1TYXQpXG5cdCAqICAgKiBgJ0hIJ2A6IEhvdXIgaW4gZGF5LCBwYWRkZWQgKDAwLTIzKVxuXHQgKiAgICogYCdIJ2A6IEhvdXIgaW4gZGF5ICgwLTIzKVxuXHQgKiAgICogYCdoaCdgOiBIb3VyIGluIEFNL1BNLCBwYWRkZWQgKDAxLTEyKVxuXHQgKiAgICogYCdoJ2A6IEhvdXIgaW4gQU0vUE0sICgxLTEyKVxuXHQgKiAgICogYCdtbSdgOiBNaW51dGUgaW4gaG91ciwgcGFkZGVkICgwMC01OSlcblx0ICogICAqIGAnbSdgOiBNaW51dGUgaW4gaG91ciAoMC01OSlcblx0ICogICAqIGAnc3MnYDogU2Vjb25kIGluIG1pbnV0ZSwgcGFkZGVkICgwMC01OSlcblx0ICogICAqIGAncydgOiBTZWNvbmQgaW4gbWludXRlICgwLTU5KVxuXHQgKiAgICogYCdzc3MnYDogTWlsbGlzZWNvbmQgaW4gc2Vjb25kLCBwYWRkZWQgKDAwMC05OTkpXG5cdCAqICAgKiBgJ2EnYDogQU0vUE0gbWFya2VyXG5cdCAqICAgKiBgJ1onYDogNCBkaWdpdCAoK3NpZ24pIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB0aW1lem9uZSBvZmZzZXQgKC0xMjAwLSsxMjAwKVxuXHQgKiAgICogYCd3dydgOiBXZWVrIG9mIHllYXIsIHBhZGRlZCAoMDAtNTMpLiBXZWVrIDAxIGlzIHRoZSB3ZWVrIHdpdGggdGhlIGZpcnN0IFRodXJzZGF5IG9mIHRoZSB5ZWFyXG5cdCAqICAgKiBgJ3cnYDogV2VlayBvZiB5ZWFyICgwLTUzKS4gV2VlayAxIGlzIHRoZSB3ZWVrIHdpdGggdGhlIGZpcnN0IFRodXJzZGF5IG9mIHRoZSB5ZWFyXG5cdCAqICAgKiBgJ0cnYCwgYCdHRydgLCBgJ0dHRydgOiBUaGUgYWJicmV2aWF0ZWQgZm9ybSBvZiB0aGUgZXJhIHN0cmluZyAoZS5nLiAnQUQnKVxuXHQgKiAgICogYCdHR0dHJ2A6IFRoZSBsb25nIGZvcm0gb2YgdGhlIGVyYSBzdHJpbmcgKGUuZy4gJ0Fubm8gRG9taW5pJylcblx0ICpcblx0ICogICBgZm9ybWF0YCBzdHJpbmcgY2FuIGFsc28gYmUgb25lIG9mIHRoZSBmb2xsb3dpbmcgcHJlZGVmaW5lZFxuXHQgKiAgIHtAbGluayBndWlkZS9pMThuIGxvY2FsaXphYmxlIGZvcm1hdHN9OlxuXHQgKlxuXHQgKiAgICogYCdtZWRpdW0nYDogZXF1aXZhbGVudCB0byBgJ01NTSBkLCB5IGg6bW06c3MgYSdgIGZvciBlbl9VUyBsb2NhbGVcblx0ICogICAgIChlLmcuIFNlcCAzLCAyMDEwIDEyOjA1OjA4IFBNKVxuXHQgKiAgICogYCdzaG9ydCdgOiBlcXVpdmFsZW50IHRvIGAnTS9kL3l5IGg6bW0gYSdgIGZvciBlbl9VUyAgbG9jYWxlIChlLmcuIDkvMy8xMCAxMjowNSBQTSlcblx0ICogICAqIGAnZnVsbERhdGUnYDogZXF1aXZhbGVudCB0byBgJ0VFRUUsIE1NTU0gZCwgeSdgIGZvciBlbl9VUyAgbG9jYWxlXG5cdCAqICAgICAoZS5nLiBGcmlkYXksIFNlcHRlbWJlciAzLCAyMDEwKVxuXHQgKiAgICogYCdsb25nRGF0ZSdgOiBlcXVpdmFsZW50IHRvIGAnTU1NTSBkLCB5J2AgZm9yIGVuX1VTICBsb2NhbGUgKGUuZy4gU2VwdGVtYmVyIDMsIDIwMTApXG5cdCAqICAgKiBgJ21lZGl1bURhdGUnYDogZXF1aXZhbGVudCB0byBgJ01NTSBkLCB5J2AgZm9yIGVuX1VTICBsb2NhbGUgKGUuZy4gU2VwIDMsIDIwMTApXG5cdCAqICAgKiBgJ3Nob3J0RGF0ZSdgOiBlcXVpdmFsZW50IHRvIGAnTS9kL3l5J2AgZm9yIGVuX1VTIGxvY2FsZSAoZS5nLiA5LzMvMTApXG5cdCAqICAgKiBgJ21lZGl1bVRpbWUnYDogZXF1aXZhbGVudCB0byBgJ2g6bW06c3MgYSdgIGZvciBlbl9VUyBsb2NhbGUgKGUuZy4gMTI6MDU6MDggUE0pXG5cdCAqICAgKiBgJ3Nob3J0VGltZSdgOiBlcXVpdmFsZW50IHRvIGAnaDptbSBhJ2AgZm9yIGVuX1VTIGxvY2FsZSAoZS5nLiAxMjowNSBQTSlcblx0ICpcblx0ICogICBgZm9ybWF0YCBzdHJpbmcgY2FuIGNvbnRhaW4gbGl0ZXJhbCB2YWx1ZXMuIFRoZXNlIG5lZWQgdG8gYmUgZXNjYXBlZCBieSBzdXJyb3VuZGluZyB3aXRoIHNpbmdsZSBxdW90ZXMgKGUuZy5cblx0ICogICBgXCJoICdpbiB0aGUgbW9ybmluZydcImApLiBJbiBvcmRlciB0byBvdXRwdXQgYSBzaW5nbGUgcXVvdGUsIGVzY2FwZSBpdCAtIGkuZS4sIHR3byBzaW5nbGUgcXVvdGVzIGluIGEgc2VxdWVuY2Vcblx0ICogICAoZS5nLiBgXCJoICdvJydjbG9jaydcImApLlxuXHQgKlxuXHQgKiBAcGFyYW0geyhEYXRlfG51bWJlcnxzdHJpbmcpfSBkYXRlIERhdGUgdG8gZm9ybWF0IGVpdGhlciBhcyBEYXRlIG9iamVjdCwgbWlsbGlzZWNvbmRzIChzdHJpbmcgb3Jcblx0ICogICAgbnVtYmVyKSBvciB2YXJpb3VzIElTTyA4NjAxIGRhdGV0aW1lIHN0cmluZyBmb3JtYXRzIChlLmcuIHl5eXktTU0tZGRUSEg6bW06c3Muc3NzWiBhbmQgaXRzXG5cdCAqICAgIHNob3J0ZXIgdmVyc2lvbnMgbGlrZSB5eXl5LU1NLWRkVEhIOm1tWiwgeXl5eS1NTS1kZCBvciB5eXl5TU1kZFRISG1tc3NaKS4gSWYgbm8gdGltZXpvbmUgaXNcblx0ICogICAgc3BlY2lmaWVkIGluIHRoZSBzdHJpbmcgaW5wdXQsIHRoZSB0aW1lIGlzIGNvbnNpZGVyZWQgdG8gYmUgaW4gdGhlIGxvY2FsIHRpbWV6b25lLlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IGZvcm1hdCBGb3JtYXR0aW5nIHJ1bGVzIChzZWUgRGVzY3JpcHRpb24pLiBJZiBub3Qgc3BlY2lmaWVkLFxuXHQgKiAgICBgbWVkaXVtRGF0ZWAgaXMgdXNlZC5cblx0ICogQHBhcmFtIHtzdHJpbmc9fSB0aW1lem9uZSBUaW1lem9uZSB0byBiZSB1c2VkIGZvciBmb3JtYXR0aW5nLiBJdCB1bmRlcnN0YW5kcyBVVEMvR01UIGFuZCB0aGVcblx0ICogICAgY29udGluZW50YWwgVVMgdGltZSB6b25lIGFiYnJldmlhdGlvbnMsIGJ1dCBmb3IgZ2VuZXJhbCB1c2UsIHVzZSBhIHRpbWUgem9uZSBvZmZzZXQsIGZvclxuXHQgKiAgICBleGFtcGxlLCBgJyswNDMwJ2AgKDQgaG91cnMsIDMwIG1pbnV0ZXMgZWFzdCBvZiB0aGUgR3JlZW53aWNoIG1lcmlkaWFuKVxuXHQgKiAgICBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgdGltZXpvbmUgb2YgdGhlIGJyb3dzZXIgd2lsbCBiZSB1c2VkLlxuXHQgKiBAcmV0dXJucyB7c3RyaW5nfSBGb3JtYXR0ZWQgc3RyaW5nIG9yIHRoZSBpbnB1dCBpZiBpbnB1dCBpcyBub3QgcmVjb2duaXplZCBhcyBkYXRlL21pbGxpcy5cblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICAgPGV4YW1wbGU+XG5cdCAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgIDxzcGFuIG5nLW5vbi1iaW5kYWJsZT57ezEyODgzMjM2MjMwMDYgfCBkYXRlOidtZWRpdW0nfX08L3NwYW4+OlxuXHQgICAgICAgICAgIDxzcGFuPnt7MTI4ODMyMzYyMzAwNiB8IGRhdGU6J21lZGl1bSd9fTwvc3Bhbj48YnI+XG5cdCAgICAgICA8c3BhbiBuZy1ub24tYmluZGFibGU+e3sxMjg4MzIzNjIzMDA2IHwgZGF0ZToneXl5eS1NTS1kZCBISDptbTpzcyBaJ319PC9zcGFuPjpcblx0ICAgICAgICAgIDxzcGFuPnt7MTI4ODMyMzYyMzAwNiB8IGRhdGU6J3l5eXktTU0tZGQgSEg6bW06c3MgWid9fTwvc3Bhbj48YnI+XG5cdCAgICAgICA8c3BhbiBuZy1ub24tYmluZGFibGU+e3sxMjg4MzIzNjIzMDA2IHwgZGF0ZTonTU0vZGQveXl5eSBAIGg6bW1hJ319PC9zcGFuPjpcblx0ICAgICAgICAgIDxzcGFuPnt7JzEyODgzMjM2MjMwMDYnIHwgZGF0ZTonTU0vZGQveXl5eSBAIGg6bW1hJ319PC9zcGFuPjxicj5cblx0ICAgICAgIDxzcGFuIG5nLW5vbi1iaW5kYWJsZT57ezEyODgzMjM2MjMwMDYgfCBkYXRlOlwiTU0vZGQveXl5eSAnYXQnIGg6bW1hXCJ9fTwvc3Bhbj46XG5cdCAgICAgICAgICA8c3Bhbj57eycxMjg4MzIzNjIzMDA2JyB8IGRhdGU6XCJNTS9kZC95eXl5ICdhdCcgaDptbWFcIn19PC9zcGFuPjxicj5cblx0ICAgICA8L2ZpbGU+XG5cdCAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgaXQoJ3Nob3VsZCBmb3JtYXQgZGF0ZScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKFwiMTI4ODMyMzYyMzAwNiB8IGRhdGU6J21lZGl1bSdcIikpLmdldFRleHQoKSkuXG5cdCAgICAgICAgICAgIHRvTWF0Y2goL09jdCAyXFxkLCAyMDEwIFxcZHsxLDJ9OlxcZHsyfTpcXGR7Mn0gKEFNfFBNKS8pO1xuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKFwiMTI4ODMyMzYyMzAwNiB8IGRhdGU6J3l5eXktTU0tZGQgSEg6bW06c3MgWidcIikpLmdldFRleHQoKSkuXG5cdCAgICAgICAgICAgIHRvTWF0Y2goLzIwMTBcXC0xMFxcLTJcXGQgXFxkezJ9OlxcZHsyfTpcXGR7Mn0gKFxcLXxcXCspP1xcZHs0fS8pO1xuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKFwiJzEyODgzMjM2MjMwMDYnIHwgZGF0ZTonTU0vZGQveXl5eSBAIGg6bW1hJ1wiKSkuZ2V0VGV4dCgpKS5cblx0ICAgICAgICAgICAgdG9NYXRjaCgvMTBcXC8yXFxkXFwvMjAxMCBAIFxcZHsxLDJ9OlxcZHsyfShBTXxQTSkvKTtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZyhcIicxMjg4MzIzNjIzMDA2JyB8IGRhdGU6XFxcIk1NL2RkL3l5eXkgJ2F0JyBoOm1tYVxcXCJcIikpLmdldFRleHQoKSkuXG5cdCAgICAgICAgICAgIHRvTWF0Y2goLzEwXFwvMlxcZFxcLzIwMTAgYXQgXFxkezEsMn06XFxkezJ9KEFNfFBNKS8pO1xuXHQgICAgICAgfSk7XG5cdCAgICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCAqL1xuXHRkYXRlRmlsdGVyLiRpbmplY3QgPSBbJyRsb2NhbGUnXTtcblx0ZnVuY3Rpb24gZGF0ZUZpbHRlcigkbG9jYWxlKSB7XG5cdFxuXHRcblx0ICB2YXIgUl9JU084NjAxX1NUUiA9IC9eKFxcZHs0fSktPyhcXGRcXGQpLT8oXFxkXFxkKSg/OlQoXFxkXFxkKSg/Ojo/KFxcZFxcZCkoPzo6PyhcXGRcXGQpKD86XFwuKFxcZCspKT8pPyk/KFp8KFsrLV0pKFxcZFxcZCk6PyhcXGRcXGQpKT8pPyQvO1xuXHQgICAgICAgICAgICAgICAgICAgICAvLyAxICAgICAgICAyICAgICAgIDMgICAgICAgICA0ICAgICAgICAgIDUgICAgICAgICAgNiAgICAgICAgICA3ICAgICAgICAgIDggIDkgICAgIDEwICAgICAgMTFcblx0ICBmdW5jdGlvbiBqc29uU3RyaW5nVG9EYXRlKHN0cmluZykge1xuXHQgICAgdmFyIG1hdGNoO1xuXHQgICAgaWYgKG1hdGNoID0gc3RyaW5nLm1hdGNoKFJfSVNPODYwMV9TVFIpKSB7XG5cdCAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoMCksXG5cdCAgICAgICAgICB0ekhvdXIgPSAwLFxuXHQgICAgICAgICAgdHpNaW4gID0gMCxcblx0ICAgICAgICAgIGRhdGVTZXR0ZXIgPSBtYXRjaFs4XSA/IGRhdGUuc2V0VVRDRnVsbFllYXIgOiBkYXRlLnNldEZ1bGxZZWFyLFxuXHQgICAgICAgICAgdGltZVNldHRlciA9IG1hdGNoWzhdID8gZGF0ZS5zZXRVVENIb3VycyA6IGRhdGUuc2V0SG91cnM7XG5cdFxuXHQgICAgICBpZiAobWF0Y2hbOV0pIHtcblx0ICAgICAgICB0ekhvdXIgPSB0b0ludChtYXRjaFs5XSArIG1hdGNoWzEwXSk7XG5cdCAgICAgICAgdHpNaW4gPSB0b0ludChtYXRjaFs5XSArIG1hdGNoWzExXSk7XG5cdCAgICAgIH1cblx0ICAgICAgZGF0ZVNldHRlci5jYWxsKGRhdGUsIHRvSW50KG1hdGNoWzFdKSwgdG9JbnQobWF0Y2hbMl0pIC0gMSwgdG9JbnQobWF0Y2hbM10pKTtcblx0ICAgICAgdmFyIGggPSB0b0ludChtYXRjaFs0XSB8fCAwKSAtIHR6SG91cjtcblx0ICAgICAgdmFyIG0gPSB0b0ludChtYXRjaFs1XSB8fCAwKSAtIHR6TWluO1xuXHQgICAgICB2YXIgcyA9IHRvSW50KG1hdGNoWzZdIHx8IDApO1xuXHQgICAgICB2YXIgbXMgPSBNYXRoLnJvdW5kKHBhcnNlRmxvYXQoJzAuJyArIChtYXRjaFs3XSB8fCAwKSkgKiAxMDAwKTtcblx0ICAgICAgdGltZVNldHRlci5jYWxsKGRhdGUsIGgsIG0sIHMsIG1zKTtcblx0ICAgICAgcmV0dXJuIGRhdGU7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gc3RyaW5nO1xuXHQgIH1cblx0XG5cdFxuXHQgIHJldHVybiBmdW5jdGlvbihkYXRlLCBmb3JtYXQsIHRpbWV6b25lKSB7XG5cdCAgICB2YXIgdGV4dCA9ICcnLFxuXHQgICAgICAgIHBhcnRzID0gW10sXG5cdCAgICAgICAgZm4sIG1hdGNoO1xuXHRcblx0ICAgIGZvcm1hdCA9IGZvcm1hdCB8fCAnbWVkaXVtRGF0ZSc7XG5cdCAgICBmb3JtYXQgPSAkbG9jYWxlLkRBVEVUSU1FX0ZPUk1BVFNbZm9ybWF0XSB8fCBmb3JtYXQ7XG5cdCAgICBpZiAoaXNTdHJpbmcoZGF0ZSkpIHtcblx0ICAgICAgZGF0ZSA9IE5VTUJFUl9TVFJJTkcudGVzdChkYXRlKSA/IHRvSW50KGRhdGUpIDoganNvblN0cmluZ1RvRGF0ZShkYXRlKTtcblx0ICAgIH1cblx0XG5cdCAgICBpZiAoaXNOdW1iZXIoZGF0ZSkpIHtcblx0ICAgICAgZGF0ZSA9IG5ldyBEYXRlKGRhdGUpO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmICghaXNEYXRlKGRhdGUpIHx8ICFpc0Zpbml0ZShkYXRlLmdldFRpbWUoKSkpIHtcblx0ICAgICAgcmV0dXJuIGRhdGU7XG5cdCAgICB9XG5cdFxuXHQgICAgd2hpbGUgKGZvcm1hdCkge1xuXHQgICAgICBtYXRjaCA9IERBVEVfRk9STUFUU19TUExJVC5leGVjKGZvcm1hdCk7XG5cdCAgICAgIGlmIChtYXRjaCkge1xuXHQgICAgICAgIHBhcnRzID0gY29uY2F0KHBhcnRzLCBtYXRjaCwgMSk7XG5cdCAgICAgICAgZm9ybWF0ID0gcGFydHMucG9wKCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcGFydHMucHVzaChmb3JtYXQpO1xuXHQgICAgICAgIGZvcm1hdCA9IG51bGw7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICB2YXIgZGF0ZVRpbWV6b25lT2Zmc2V0ID0gZGF0ZS5nZXRUaW1lem9uZU9mZnNldCgpO1xuXHQgICAgaWYgKHRpbWV6b25lKSB7XG5cdCAgICAgIGRhdGVUaW1lem9uZU9mZnNldCA9IHRpbWV6b25lVG9PZmZzZXQodGltZXpvbmUsIGRhdGVUaW1lem9uZU9mZnNldCk7XG5cdCAgICAgIGRhdGUgPSBjb252ZXJ0VGltZXpvbmVUb0xvY2FsKGRhdGUsIHRpbWV6b25lLCB0cnVlKTtcblx0ICAgIH1cblx0ICAgIGZvckVhY2gocGFydHMsIGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgIGZuID0gREFURV9GT1JNQVRTW3ZhbHVlXTtcblx0ICAgICAgdGV4dCArPSBmbiA/IGZuKGRhdGUsICRsb2NhbGUuREFURVRJTUVfRk9STUFUUywgZGF0ZVRpbWV6b25lT2Zmc2V0KVxuXHQgICAgICAgICAgICAgICAgIDogdmFsdWUgPT09IFwiJydcIiA/IFwiJ1wiIDogdmFsdWUucmVwbGFjZSgvKF4nfCckKS9nLCAnJykucmVwbGFjZSgvJycvZywgXCInXCIpO1xuXHQgICAgfSk7XG5cdFxuXHQgICAgcmV0dXJuIHRleHQ7XG5cdCAgfTtcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZmlsdGVyXG5cdCAqIEBuYW1lIGpzb25cblx0ICogQGtpbmQgZnVuY3Rpb25cblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqICAgQWxsb3dzIHlvdSB0byBjb252ZXJ0IGEgSmF2YVNjcmlwdCBvYmplY3QgaW50byBKU09OIHN0cmluZy5cblx0ICpcblx0ICogICBUaGlzIGZpbHRlciBpcyBtb3N0bHkgdXNlZnVsIGZvciBkZWJ1Z2dpbmcuIFdoZW4gdXNpbmcgdGhlIGRvdWJsZSBjdXJseSB7e3ZhbHVlfX0gbm90YXRpb25cblx0ICogICB0aGUgYmluZGluZyBpcyBhdXRvbWF0aWNhbGx5IGNvbnZlcnRlZCB0byBKU09OLlxuXHQgKlxuXHQgKiBAcGFyYW0geyp9IG9iamVjdCBBbnkgSmF2YVNjcmlwdCBvYmplY3QgKGluY2x1ZGluZyBhcnJheXMgYW5kIHByaW1pdGl2ZSB0eXBlcykgdG8gZmlsdGVyLlxuXHQgKiBAcGFyYW0ge251bWJlcj19IHNwYWNpbmcgVGhlIG51bWJlciBvZiBzcGFjZXMgdG8gdXNlIHBlciBpbmRlbnRhdGlvbiwgZGVmYXVsdHMgdG8gMi5cblx0ICogQHJldHVybnMge3N0cmluZ30gSlNPTiBzdHJpbmcuXG5cdCAqXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICA8cHJlIGlkPVwiZGVmYXVsdC1zcGFjaW5nXCI+e3sgeyduYW1lJzondmFsdWUnfSB8IGpzb24gfX08L3ByZT5cblx0ICAgICAgIDxwcmUgaWQ9XCJjdXN0b20tc3BhY2luZ1wiPnt7IHsnbmFtZSc6J3ZhbHVlJ30gfCBqc29uOjQgfX08L3ByZT5cblx0ICAgICA8L2ZpbGU+XG5cdCAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgaXQoJ3Nob3VsZCBqc29uaWZ5IGZpbHRlcmVkIG9iamVjdHMnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2RlZmF1bHQtc3BhY2luZycpKS5nZXRUZXh0KCkpLnRvTWF0Y2goL1xce1xcbiAgXCJuYW1lXCI6ID9cInZhbHVlXCJcXG59Lyk7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmlkKCdjdXN0b20tc3BhY2luZycpKS5nZXRUZXh0KCkpLnRvTWF0Y2goL1xce1xcbiAgICBcIm5hbWVcIjogP1widmFsdWVcIlxcbn0vKTtcblx0ICAgICAgIH0pO1xuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKlxuXHQgKi9cblx0ZnVuY3Rpb24ganNvbkZpbHRlcigpIHtcblx0ICByZXR1cm4gZnVuY3Rpb24ob2JqZWN0LCBzcGFjaW5nKSB7XG5cdCAgICBpZiAoaXNVbmRlZmluZWQoc3BhY2luZykpIHtcblx0ICAgICAgICBzcGFjaW5nID0gMjtcblx0ICAgIH1cblx0ICAgIHJldHVybiB0b0pzb24ob2JqZWN0LCBzcGFjaW5nKTtcblx0ICB9O1xuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBmaWx0ZXJcblx0ICogQG5hbWUgbG93ZXJjYXNlXG5cdCAqIEBraW5kIGZ1bmN0aW9uXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBDb252ZXJ0cyBzdHJpbmcgdG8gbG93ZXJjYXNlLlxuXHQgKiBAc2VlIGFuZ3VsYXIubG93ZXJjYXNlXG5cdCAqL1xuXHR2YXIgbG93ZXJjYXNlRmlsdGVyID0gdmFsdWVGbihsb3dlcmNhc2UpO1xuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZmlsdGVyXG5cdCAqIEBuYW1lIHVwcGVyY2FzZVxuXHQgKiBAa2luZCBmdW5jdGlvblxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogQ29udmVydHMgc3RyaW5nIHRvIHVwcGVyY2FzZS5cblx0ICogQHNlZSBhbmd1bGFyLnVwcGVyY2FzZVxuXHQgKi9cblx0dmFyIHVwcGVyY2FzZUZpbHRlciA9IHZhbHVlRm4odXBwZXJjYXNlKTtcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZmlsdGVyXG5cdCAqIEBuYW1lIGxpbWl0VG9cblx0ICogQGtpbmQgZnVuY3Rpb25cblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIENyZWF0ZXMgYSBuZXcgYXJyYXkgb3Igc3RyaW5nIGNvbnRhaW5pbmcgb25seSBhIHNwZWNpZmllZCBudW1iZXIgb2YgZWxlbWVudHMuIFRoZSBlbGVtZW50c1xuXHQgKiBhcmUgdGFrZW4gZnJvbSBlaXRoZXIgdGhlIGJlZ2lubmluZyBvciB0aGUgZW5kIG9mIHRoZSBzb3VyY2UgYXJyYXksIHN0cmluZyBvciBudW1iZXIsIGFzIHNwZWNpZmllZCBieVxuXHQgKiB0aGUgdmFsdWUgYW5kIHNpZ24gKHBvc2l0aXZlIG9yIG5lZ2F0aXZlKSBvZiBgbGltaXRgLiBJZiBhIG51bWJlciBpcyB1c2VkIGFzIGlucHV0LCBpdCBpc1xuXHQgKiBjb252ZXJ0ZWQgdG8gYSBzdHJpbmcuXG5cdCAqXG5cdCAqIEBwYXJhbSB7QXJyYXl8c3RyaW5nfG51bWJlcn0gaW5wdXQgU291cmNlIGFycmF5LCBzdHJpbmcgb3IgbnVtYmVyIHRvIGJlIGxpbWl0ZWQuXG5cdCAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gbGltaXQgVGhlIGxlbmd0aCBvZiB0aGUgcmV0dXJuZWQgYXJyYXkgb3Igc3RyaW5nLiBJZiB0aGUgYGxpbWl0YCBudW1iZXJcblx0ICogICAgIGlzIHBvc2l0aXZlLCBgbGltaXRgIG51bWJlciBvZiBpdGVtcyBmcm9tIHRoZSBiZWdpbm5pbmcgb2YgdGhlIHNvdXJjZSBhcnJheS9zdHJpbmcgYXJlIGNvcGllZC5cblx0ICogICAgIElmIHRoZSBudW1iZXIgaXMgbmVnYXRpdmUsIGBsaW1pdGAgbnVtYmVyICBvZiBpdGVtcyBmcm9tIHRoZSBlbmQgb2YgdGhlIHNvdXJjZSBhcnJheS9zdHJpbmdcblx0ICogICAgIGFyZSBjb3BpZWQuIFRoZSBgbGltaXRgIHdpbGwgYmUgdHJpbW1lZCBpZiBpdCBleGNlZWRzIGBhcnJheS5sZW5ndGhgLiBJZiBgbGltaXRgIGlzIHVuZGVmaW5lZCxcblx0ICogICAgIHRoZSBpbnB1dCB3aWxsIGJlIHJldHVybmVkIHVuY2hhbmdlZC5cblx0ICogQHBhcmFtIHsoc3RyaW5nfG51bWJlcik9fSBiZWdpbiBJbmRleCBhdCB3aGljaCB0byBiZWdpbiBsaW1pdGF0aW9uLiBBcyBhIG5lZ2F0aXZlIGluZGV4LCBgYmVnaW5gXG5cdCAqICAgICBpbmRpY2F0ZXMgYW4gb2Zmc2V0IGZyb20gdGhlIGVuZCBvZiBgaW5wdXRgLiBEZWZhdWx0cyB0byBgMGAuXG5cdCAqIEByZXR1cm5zIHtBcnJheXxzdHJpbmd9IEEgbmV3IHN1Yi1hcnJheSBvciBzdWJzdHJpbmcgb2YgbGVuZ3RoIGBsaW1pdGAgb3IgbGVzcyBpZiBpbnB1dCBhcnJheVxuXHQgKiAgICAgaGFkIGxlc3MgdGhhbiBgbGltaXRgIGVsZW1lbnRzLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZSBtb2R1bGU9XCJsaW1pdFRvRXhhbXBsZVwiPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICA8c2NyaXB0PlxuXHQgICAgICAgICBhbmd1bGFyLm1vZHVsZSgnbGltaXRUb0V4YW1wbGUnLCBbXSlcblx0ICAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgICAgJHNjb3BlLm51bWJlcnMgPSBbMSwyLDMsNCw1LDYsNyw4LDldO1xuXHQgICAgICAgICAgICAgJHNjb3BlLmxldHRlcnMgPSBcImFiY2RlZmdoaVwiO1xuXHQgICAgICAgICAgICAgJHNjb3BlLmxvbmdOdW1iZXIgPSAyMzQ1NDMyMzQyO1xuXHQgICAgICAgICAgICAgJHNjb3BlLm51bUxpbWl0ID0gMztcblx0ICAgICAgICAgICAgICRzY29wZS5sZXR0ZXJMaW1pdCA9IDM7XG5cdCAgICAgICAgICAgICAkc2NvcGUubG9uZ051bWJlckxpbWl0ID0gMztcblx0ICAgICAgICAgICB9XSk7XG5cdCAgICAgICA8L3NjcmlwdD5cblx0ICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAgICAgICAgIDxsYWJlbD5cblx0ICAgICAgICAgICAgTGltaXQge3tudW1iZXJzfX0gdG86XG5cdCAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwibnVtYmVyXCIgc3RlcD1cIjFcIiBuZy1tb2RlbD1cIm51bUxpbWl0XCI+XG5cdCAgICAgICAgIDwvbGFiZWw+XG5cdCAgICAgICAgIDxwPk91dHB1dCBudW1iZXJzOiB7eyBudW1iZXJzIHwgbGltaXRUbzpudW1MaW1pdCB9fTwvcD5cblx0ICAgICAgICAgPGxhYmVsPlxuXHQgICAgICAgICAgICBMaW1pdCB7e2xldHRlcnN9fSB0bzpcblx0ICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJudW1iZXJcIiBzdGVwPVwiMVwiIG5nLW1vZGVsPVwibGV0dGVyTGltaXRcIj5cblx0ICAgICAgICAgPC9sYWJlbD5cblx0ICAgICAgICAgPHA+T3V0cHV0IGxldHRlcnM6IHt7IGxldHRlcnMgfCBsaW1pdFRvOmxldHRlckxpbWl0IH19PC9wPlxuXHQgICAgICAgICA8bGFiZWw+XG5cdCAgICAgICAgICAgIExpbWl0IHt7bG9uZ051bWJlcn19IHRvOlxuXHQgICAgICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIHN0ZXA9XCIxXCIgbmctbW9kZWw9XCJsb25nTnVtYmVyTGltaXRcIj5cblx0ICAgICAgICAgPC9sYWJlbD5cblx0ICAgICAgICAgPHA+T3V0cHV0IGxvbmcgbnVtYmVyOiB7eyBsb25nTnVtYmVyIHwgbGltaXRUbzpsb25nTnVtYmVyTGltaXQgfX08L3A+XG5cdCAgICAgICA8L2Rpdj5cblx0ICAgICA8L2ZpbGU+XG5cdCAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgdmFyIG51bUxpbWl0SW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdudW1MaW1pdCcpKTtcblx0ICAgICAgIHZhciBsZXR0ZXJMaW1pdElucHV0ID0gZWxlbWVudChieS5tb2RlbCgnbGV0dGVyTGltaXQnKSk7XG5cdCAgICAgICB2YXIgbG9uZ051bWJlckxpbWl0SW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdsb25nTnVtYmVyTGltaXQnKSk7XG5cdCAgICAgICB2YXIgbGltaXRlZE51bWJlcnMgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ251bWJlcnMgfCBsaW1pdFRvOm51bUxpbWl0JykpO1xuXHQgICAgICAgdmFyIGxpbWl0ZWRMZXR0ZXJzID0gZWxlbWVudChieS5iaW5kaW5nKCdsZXR0ZXJzIHwgbGltaXRUbzpsZXR0ZXJMaW1pdCcpKTtcblx0ICAgICAgIHZhciBsaW1pdGVkTG9uZ051bWJlciA9IGVsZW1lbnQoYnkuYmluZGluZygnbG9uZ051bWJlciB8IGxpbWl0VG86bG9uZ051bWJlckxpbWl0JykpO1xuXHRcblx0ICAgICAgIGl0KCdzaG91bGQgbGltaXQgdGhlIG51bWJlciBhcnJheSB0byBmaXJzdCB0aHJlZSBpdGVtcycsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICBleHBlY3QobnVtTGltaXRJbnB1dC5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpLnRvQmUoJzMnKTtcblx0ICAgICAgICAgZXhwZWN0KGxldHRlckxpbWl0SW5wdXQuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKS50b0JlKCczJyk7XG5cdCAgICAgICAgIGV4cGVjdChsb25nTnVtYmVyTGltaXRJbnB1dC5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpLnRvQmUoJzMnKTtcblx0ICAgICAgICAgZXhwZWN0KGxpbWl0ZWROdW1iZXJzLmdldFRleHQoKSkudG9FcXVhbCgnT3V0cHV0IG51bWJlcnM6IFsxLDIsM10nKTtcblx0ICAgICAgICAgZXhwZWN0KGxpbWl0ZWRMZXR0ZXJzLmdldFRleHQoKSkudG9FcXVhbCgnT3V0cHV0IGxldHRlcnM6IGFiYycpO1xuXHQgICAgICAgICBleHBlY3QobGltaXRlZExvbmdOdW1iZXIuZ2V0VGV4dCgpKS50b0VxdWFsKCdPdXRwdXQgbG9uZyBudW1iZXI6IDIzNCcpO1xuXHQgICAgICAgfSk7XG5cdFxuXHQgICAgICAgLy8gVGhlcmUgaXMgYSBidWcgaW4gc2FmYXJpIGFuZCBwcm90cmFjdG9yIHRoYXQgZG9lc24ndCBsaWtlIHRoZSBtaW51cyBrZXlcblx0ICAgICAgIC8vIGl0KCdzaG91bGQgdXBkYXRlIHRoZSBvdXRwdXQgd2hlbiAtMyBpcyBlbnRlcmVkJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAvLyAgIG51bUxpbWl0SW5wdXQuY2xlYXIoKTtcblx0ICAgICAgIC8vICAgbnVtTGltaXRJbnB1dC5zZW5kS2V5cygnLTMnKTtcblx0ICAgICAgIC8vICAgbGV0dGVyTGltaXRJbnB1dC5jbGVhcigpO1xuXHQgICAgICAgLy8gICBsZXR0ZXJMaW1pdElucHV0LnNlbmRLZXlzKCctMycpO1xuXHQgICAgICAgLy8gICBsb25nTnVtYmVyTGltaXRJbnB1dC5jbGVhcigpO1xuXHQgICAgICAgLy8gICBsb25nTnVtYmVyTGltaXRJbnB1dC5zZW5kS2V5cygnLTMnKTtcblx0ICAgICAgIC8vICAgZXhwZWN0KGxpbWl0ZWROdW1iZXJzLmdldFRleHQoKSkudG9FcXVhbCgnT3V0cHV0IG51bWJlcnM6IFs3LDgsOV0nKTtcblx0ICAgICAgIC8vICAgZXhwZWN0KGxpbWl0ZWRMZXR0ZXJzLmdldFRleHQoKSkudG9FcXVhbCgnT3V0cHV0IGxldHRlcnM6IGdoaScpO1xuXHQgICAgICAgLy8gICBleHBlY3QobGltaXRlZExvbmdOdW1iZXIuZ2V0VGV4dCgpKS50b0VxdWFsKCdPdXRwdXQgbG9uZyBudW1iZXI6IDM0MicpO1xuXHQgICAgICAgLy8gfSk7XG5cdFxuXHQgICAgICAgaXQoJ3Nob3VsZCBub3QgZXhjZWVkIHRoZSBtYXhpbXVtIHNpemUgb2YgaW5wdXQgYXJyYXknLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgbnVtTGltaXRJbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICBudW1MaW1pdElucHV0LnNlbmRLZXlzKCcxMDAnKTtcblx0ICAgICAgICAgbGV0dGVyTGltaXRJbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICBsZXR0ZXJMaW1pdElucHV0LnNlbmRLZXlzKCcxMDAnKTtcblx0ICAgICAgICAgbG9uZ051bWJlckxpbWl0SW5wdXQuY2xlYXIoKTtcblx0ICAgICAgICAgbG9uZ051bWJlckxpbWl0SW5wdXQuc2VuZEtleXMoJzEwMCcpO1xuXHQgICAgICAgICBleHBlY3QobGltaXRlZE51bWJlcnMuZ2V0VGV4dCgpKS50b0VxdWFsKCdPdXRwdXQgbnVtYmVyczogWzEsMiwzLDQsNSw2LDcsOCw5XScpO1xuXHQgICAgICAgICBleHBlY3QobGltaXRlZExldHRlcnMuZ2V0VGV4dCgpKS50b0VxdWFsKCdPdXRwdXQgbGV0dGVyczogYWJjZGVmZ2hpJyk7XG5cdCAgICAgICAgIGV4cGVjdChsaW1pdGVkTG9uZ051bWJlci5nZXRUZXh0KCkpLnRvRXF1YWwoJ091dHB1dCBsb25nIG51bWJlcjogMjM0NTQzMjM0MicpO1xuXHQgICAgICAgfSk7XG5cdCAgICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCovXG5cdGZ1bmN0aW9uIGxpbWl0VG9GaWx0ZXIoKSB7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0LCBsaW1pdCwgYmVnaW4pIHtcblx0ICAgIGlmIChNYXRoLmFicyhOdW1iZXIobGltaXQpKSA9PT0gSW5maW5pdHkpIHtcblx0ICAgICAgbGltaXQgPSBOdW1iZXIobGltaXQpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgbGltaXQgPSB0b0ludChsaW1pdCk7XG5cdCAgICB9XG5cdCAgICBpZiAoaXNOYU4obGltaXQpKSByZXR1cm4gaW5wdXQ7XG5cdFxuXHQgICAgaWYgKGlzTnVtYmVyKGlucHV0KSkgaW5wdXQgPSBpbnB1dC50b1N0cmluZygpO1xuXHQgICAgaWYgKCFpc0FycmF5KGlucHV0KSAmJiAhaXNTdHJpbmcoaW5wdXQpKSByZXR1cm4gaW5wdXQ7XG5cdFxuXHQgICAgYmVnaW4gPSAoIWJlZ2luIHx8IGlzTmFOKGJlZ2luKSkgPyAwIDogdG9JbnQoYmVnaW4pO1xuXHQgICAgYmVnaW4gPSAoYmVnaW4gPCAwKSA/IE1hdGgubWF4KDAsIGlucHV0Lmxlbmd0aCArIGJlZ2luKSA6IGJlZ2luO1xuXHRcblx0ICAgIGlmIChsaW1pdCA+PSAwKSB7XG5cdCAgICAgIHJldHVybiBpbnB1dC5zbGljZShiZWdpbiwgYmVnaW4gKyBsaW1pdCk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBpZiAoYmVnaW4gPT09IDApIHtcblx0ICAgICAgICByZXR1cm4gaW5wdXQuc2xpY2UobGltaXQsIGlucHV0Lmxlbmd0aCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIGlucHV0LnNsaWNlKE1hdGgubWF4KDAsIGJlZ2luICsgbGltaXQpLCBiZWdpbik7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9O1xuXHR9XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGZpbHRlclxuXHQgKiBAbmFtZSBvcmRlckJ5XG5cdCAqIEBraW5kIGZ1bmN0aW9uXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBPcmRlcnMgYSBzcGVjaWZpZWQgYGFycmF5YCBieSB0aGUgYGV4cHJlc3Npb25gIHByZWRpY2F0ZS4gSXQgaXMgb3JkZXJlZCBhbHBoYWJldGljYWxseVxuXHQgKiBmb3Igc3RyaW5ncyBhbmQgbnVtZXJpY2FsbHkgZm9yIG51bWJlcnMuIE5vdGU6IGlmIHlvdSBub3RpY2UgbnVtYmVycyBhcmUgbm90IGJlaW5nIHNvcnRlZFxuXHQgKiBhcyBleHBlY3RlZCwgbWFrZSBzdXJlIHRoZXkgYXJlIGFjdHVhbGx5IGJlaW5nIHNhdmVkIGFzIG51bWJlcnMgYW5kIG5vdCBzdHJpbmdzLlxuXHQgKiBBcnJheS1saWtlIHZhbHVlcyAoZS5nLiBOb2RlTGlzdHMsIGpRdWVyeSBvYmplY3RzLCBUeXBlZEFycmF5cywgU3RyaW5ncywgZXRjKSBhcmUgYWxzbyBzdXBwb3J0ZWQuXG5cdCAqXG5cdCAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSAob3IgYXJyYXktbGlrZSBvYmplY3QpIHRvIHNvcnQuXG5cdCAqIEBwYXJhbSB7ZnVuY3Rpb24oKil8c3RyaW5nfEFycmF5LjwoZnVuY3Rpb24oKil8c3RyaW5nKT49fSBleHByZXNzaW9uIEEgcHJlZGljYXRlIHRvIGJlXG5cdCAqICAgIHVzZWQgYnkgdGhlIGNvbXBhcmF0b3IgdG8gZGV0ZXJtaW5lIHRoZSBvcmRlciBvZiBlbGVtZW50cy5cblx0ICpcblx0ICogICAgQ2FuIGJlIG9uZSBvZjpcblx0ICpcblx0ICogICAgLSBgZnVuY3Rpb25gOiBHZXR0ZXIgZnVuY3Rpb24uIFRoZSByZXN1bHQgb2YgdGhpcyBmdW5jdGlvbiB3aWxsIGJlIHNvcnRlZCB1c2luZyB0aGVcblx0ICogICAgICBgPGAsIGA9PT1gLCBgPmAgb3BlcmF0b3IuXG5cdCAqICAgIC0gYHN0cmluZ2A6IEFuIEFuZ3VsYXIgZXhwcmVzc2lvbi4gVGhlIHJlc3VsdCBvZiB0aGlzIGV4cHJlc3Npb24gaXMgdXNlZCB0byBjb21wYXJlIGVsZW1lbnRzXG5cdCAqICAgICAgKGZvciBleGFtcGxlIGBuYW1lYCB0byBzb3J0IGJ5IGEgcHJvcGVydHkgY2FsbGVkIGBuYW1lYCBvciBgbmFtZS5zdWJzdHIoMCwgMylgIHRvIHNvcnQgYnlcblx0ICogICAgICAzIGZpcnN0IGNoYXJhY3RlcnMgb2YgYSBwcm9wZXJ0eSBjYWxsZWQgYG5hbWVgKS4gVGhlIHJlc3VsdCBvZiBhIGNvbnN0YW50IGV4cHJlc3Npb25cblx0ICogICAgICBpcyBpbnRlcnByZXRlZCBhcyBhIHByb3BlcnR5IG5hbWUgdG8gYmUgdXNlZCBpbiBjb21wYXJpc29ucyAoZm9yIGV4YW1wbGUgYFwic3BlY2lhbCBuYW1lXCJgXG5cdCAqICAgICAgdG8gc29ydCBvYmplY3QgYnkgdGhlIHZhbHVlIG9mIHRoZWlyIGBzcGVjaWFsIG5hbWVgIHByb3BlcnR5KS4gQW4gZXhwcmVzc2lvbiBjYW4gYmVcblx0ICogICAgICBvcHRpb25hbGx5IHByZWZpeGVkIHdpdGggYCtgIG9yIGAtYCB0byBjb250cm9sIGFzY2VuZGluZyBvciBkZXNjZW5kaW5nIHNvcnQgb3JkZXJcblx0ICogICAgICAoZm9yIGV4YW1wbGUsIGArbmFtZWAgb3IgYC1uYW1lYCkuIElmIG5vIHByb3BlcnR5IGlzIHByb3ZpZGVkLCAoZS5nLiBgJysnYCkgdGhlbiB0aGUgYXJyYXlcblx0ICogICAgICBlbGVtZW50IGl0c2VsZiBpcyB1c2VkIHRvIGNvbXBhcmUgd2hlcmUgc29ydGluZy5cblx0ICogICAgLSBgQXJyYXlgOiBBbiBhcnJheSBvZiBmdW5jdGlvbiBvciBzdHJpbmcgcHJlZGljYXRlcy4gVGhlIGZpcnN0IHByZWRpY2F0ZSBpbiB0aGUgYXJyYXlcblx0ICogICAgICBpcyB1c2VkIGZvciBzb3J0aW5nLCBidXQgd2hlbiB0d28gaXRlbXMgYXJlIGVxdWl2YWxlbnQsIHRoZSBuZXh0IHByZWRpY2F0ZSBpcyB1c2VkLlxuXHQgKlxuXHQgKiAgICBJZiB0aGUgcHJlZGljYXRlIGlzIG1pc3Npbmcgb3IgZW1wdHkgdGhlbiBpdCBkZWZhdWx0cyB0byBgJysnYC5cblx0ICpcblx0ICogQHBhcmFtIHtib29sZWFuPX0gcmV2ZXJzZSBSZXZlcnNlIHRoZSBvcmRlciBvZiB0aGUgYXJyYXkuXG5cdCAqIEByZXR1cm5zIHtBcnJheX0gU29ydGVkIGNvcHkgb2YgdGhlIHNvdXJjZSBhcnJheS5cblx0ICpcblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICogVGhlIGV4YW1wbGUgYmVsb3cgZGVtb25zdHJhdGVzIGEgc2ltcGxlIG5nUmVwZWF0LCB3aGVyZSB0aGUgZGF0YSBpcyBzb3J0ZWRcblx0ICogYnkgYWdlIGluIGRlc2NlbmRpbmcgb3JkZXIgKHByZWRpY2F0ZSBpcyBzZXQgdG8gYCctYWdlJ2ApLlxuXHQgKiBgcmV2ZXJzZWAgaXMgbm90IHNldCwgd2hpY2ggbWVhbnMgaXQgZGVmYXVsdHMgdG8gYGZhbHNlYC5cblx0ICAgPGV4YW1wbGUgbW9kdWxlPVwib3JkZXJCeUV4YW1wbGVcIj5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgICAgPHRhYmxlIGNsYXNzPVwiZnJpZW5kXCI+XG5cdCAgICAgICAgICAgPHRyPlxuXHQgICAgICAgICAgICAgPHRoPk5hbWU8L3RoPlxuXHQgICAgICAgICAgICAgPHRoPlBob25lIE51bWJlcjwvdGg+XG5cdCAgICAgICAgICAgICA8dGg+QWdlPC90aD5cblx0ICAgICAgICAgICA8L3RyPlxuXHQgICAgICAgICAgIDx0ciBuZy1yZXBlYXQ9XCJmcmllbmQgaW4gZnJpZW5kcyB8IG9yZGVyQnk6Jy1hZ2UnXCI+XG5cdCAgICAgICAgICAgICA8dGQ+e3tmcmllbmQubmFtZX19PC90ZD5cblx0ICAgICAgICAgICAgIDx0ZD57e2ZyaWVuZC5waG9uZX19PC90ZD5cblx0ICAgICAgICAgICAgIDx0ZD57e2ZyaWVuZC5hZ2V9fTwvdGQ+XG5cdCAgICAgICAgICAgPC90cj5cblx0ICAgICAgICAgPC90YWJsZT5cblx0ICAgICAgIDwvZGl2PlxuXHQgICAgIDwvZmlsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwic2NyaXB0LmpzXCI+XG5cdCAgICAgICBhbmd1bGFyLm1vZHVsZSgnb3JkZXJCeUV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICAkc2NvcGUuZnJpZW5kcyA9XG5cdCAgICAgICAgICAgICAgIFt7bmFtZTonSm9obicsIHBob25lOic1NTUtMTIxMicsIGFnZToxMH0sXG5cdCAgICAgICAgICAgICAgICB7bmFtZTonTWFyeScsIHBob25lOic1NTUtOTg3NicsIGFnZToxOX0sXG5cdCAgICAgICAgICAgICAgICB7bmFtZTonTWlrZScsIHBob25lOic1NTUtNDMyMScsIGFnZToyMX0sXG5cdCAgICAgICAgICAgICAgICB7bmFtZTonQWRhbScsIHBob25lOic1NTUtNTY3OCcsIGFnZTozNX0sXG5cdCAgICAgICAgICAgICAgICB7bmFtZTonSnVsaWUnLCBwaG9uZTonNTU1LTg3NjUnLCBhZ2U6Mjl9XTtcblx0ICAgICAgICAgfV0pO1xuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKlxuXHQgKiBUaGUgcHJlZGljYXRlIGFuZCByZXZlcnNlIHBhcmFtZXRlcnMgY2FuIGJlIGNvbnRyb2xsZWQgZHluYW1pY2FsbHkgdGhyb3VnaCBzY29wZSBwcm9wZXJ0aWVzLFxuXHQgKiBhcyBzaG93biBpbiB0aGUgbmV4dCBleGFtcGxlLlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZSBtb2R1bGU9XCJvcmRlckJ5RXhhbXBsZVwiPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgICAgICAgICA8cHJlPlNvcnRpbmcgcHJlZGljYXRlID0ge3twcmVkaWNhdGV9fTsgcmV2ZXJzZSA9IHt7cmV2ZXJzZX19PC9wcmU+XG5cdCAgICAgICAgIDxoci8+XG5cdCAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJwcmVkaWNhdGU9JydcIj5TZXQgdG8gdW5zb3J0ZWQ8L2J1dHRvbj5cblx0ICAgICAgICAgPHRhYmxlIGNsYXNzPVwiZnJpZW5kXCI+XG5cdCAgICAgICAgICAgPHRyPlxuXHQgICAgICAgICAgICA8dGg+XG5cdCAgICAgICAgICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwib3JkZXIoJ25hbWUnKVwiPk5hbWU8L2J1dHRvbj5cblx0ICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwic29ydG9yZGVyXCIgbmctc2hvdz1cInByZWRpY2F0ZSA9PT0gJ25hbWUnXCIgbmctY2xhc3M9XCJ7cmV2ZXJzZTpyZXZlcnNlfVwiPjwvc3Bhbj5cblx0ICAgICAgICAgICAgPC90aD5cblx0ICAgICAgICAgICAgPHRoPlxuXHQgICAgICAgICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cIm9yZGVyKCdwaG9uZScpXCI+UGhvbmUgTnVtYmVyPC9idXR0b24+XG5cdCAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInNvcnRvcmRlclwiIG5nLXNob3c9XCJwcmVkaWNhdGUgPT09ICdwaG9uZSdcIiBuZy1jbGFzcz1cIntyZXZlcnNlOnJldmVyc2V9XCI+PC9zcGFuPlxuXHQgICAgICAgICAgICA8L3RoPlxuXHQgICAgICAgICAgICA8dGg+XG5cdCAgICAgICAgICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwib3JkZXIoJ2FnZScpXCI+QWdlPC9idXR0b24+XG5cdCAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInNvcnRvcmRlclwiIG5nLXNob3c9XCJwcmVkaWNhdGUgPT09ICdhZ2UnXCIgbmctY2xhc3M9XCJ7cmV2ZXJzZTpyZXZlcnNlfVwiPjwvc3Bhbj5cblx0ICAgICAgICAgICAgPC90aD5cblx0ICAgICAgICAgICA8L3RyPlxuXHQgICAgICAgICAgIDx0ciBuZy1yZXBlYXQ9XCJmcmllbmQgaW4gZnJpZW5kcyB8IG9yZGVyQnk6cHJlZGljYXRlOnJldmVyc2VcIj5cblx0ICAgICAgICAgICAgIDx0ZD57e2ZyaWVuZC5uYW1lfX08L3RkPlxuXHQgICAgICAgICAgICAgPHRkPnt7ZnJpZW5kLnBob25lfX08L3RkPlxuXHQgICAgICAgICAgICAgPHRkPnt7ZnJpZW5kLmFnZX19PC90ZD5cblx0ICAgICAgICAgICA8L3RyPlxuXHQgICAgICAgICA8L3RhYmxlPlxuXHQgICAgICAgPC9kaXY+XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cblx0ICAgICAgIGFuZ3VsYXIubW9kdWxlKCdvcmRlckJ5RXhhbXBsZScsIFtdKVxuXHQgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgICRzY29wZS5mcmllbmRzID1cblx0ICAgICAgICAgICAgICAgW3tuYW1lOidKb2huJywgcGhvbmU6JzU1NS0xMjEyJywgYWdlOjEwfSxcblx0ICAgICAgICAgICAgICAgIHtuYW1lOidNYXJ5JywgcGhvbmU6JzU1NS05ODc2JywgYWdlOjE5fSxcblx0ICAgICAgICAgICAgICAgIHtuYW1lOidNaWtlJywgcGhvbmU6JzU1NS00MzIxJywgYWdlOjIxfSxcblx0ICAgICAgICAgICAgICAgIHtuYW1lOidBZGFtJywgcGhvbmU6JzU1NS01Njc4JywgYWdlOjM1fSxcblx0ICAgICAgICAgICAgICAgIHtuYW1lOidKdWxpZScsIHBob25lOic1NTUtODc2NScsIGFnZToyOX1dO1xuXHQgICAgICAgICAgICRzY29wZS5wcmVkaWNhdGUgPSAnYWdlJztcblx0ICAgICAgICAgICAkc2NvcGUucmV2ZXJzZSA9IHRydWU7XG5cdCAgICAgICAgICAgJHNjb3BlLm9yZGVyID0gZnVuY3Rpb24ocHJlZGljYXRlKSB7XG5cdCAgICAgICAgICAgICAkc2NvcGUucmV2ZXJzZSA9ICgkc2NvcGUucHJlZGljYXRlID09PSBwcmVkaWNhdGUpID8gISRzY29wZS5yZXZlcnNlIDogZmFsc2U7XG5cdCAgICAgICAgICAgICAkc2NvcGUucHJlZGljYXRlID0gcHJlZGljYXRlO1xuXHQgICAgICAgICAgIH07XG5cdCAgICAgICAgIH1dKTtcblx0ICAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJzdHlsZS5jc3NcIj5cblx0ICAgICAgIC5zb3J0b3JkZXI6YWZ0ZXIge1xuXHQgICAgICAgICBjb250ZW50OiAnXFwyNWIyJztcblx0ICAgICAgIH1cblx0ICAgICAgIC5zb3J0b3JkZXIucmV2ZXJzZTphZnRlciB7XG5cdCAgICAgICAgIGNvbnRlbnQ6ICdcXDI1YmMnO1xuXHQgICAgICAgfVxuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKlxuXHQgKiBJdCdzIGFsc28gcG9zc2libGUgdG8gY2FsbCB0aGUgb3JkZXJCeSBmaWx0ZXIgbWFudWFsbHksIGJ5IGluamVjdGluZyBgJGZpbHRlcmAsIHJldHJpZXZpbmcgdGhlXG5cdCAqIGZpbHRlciByb3V0aW5lIHdpdGggYCRmaWx0ZXIoJ29yZGVyQnknKWAsIGFuZCBjYWxsaW5nIHRoZSByZXR1cm5lZCBmaWx0ZXIgcm91dGluZSB3aXRoIHRoZVxuXHQgKiBkZXNpcmVkIHBhcmFtZXRlcnMuXG5cdCAqXG5cdCAqIEV4YW1wbGU6XG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgPGV4YW1wbGUgbW9kdWxlPVwib3JkZXJCeUV4YW1wbGVcIj5cblx0ICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgICAgICA8cHJlPlNvcnRpbmcgcHJlZGljYXRlID0ge3twcmVkaWNhdGV9fTsgcmV2ZXJzZSA9IHt7cmV2ZXJzZX19PC9wcmU+XG5cdCAgICAgIDx0YWJsZSBjbGFzcz1cImZyaWVuZFwiPlxuXHQgICAgICAgIDx0cj5cblx0ICAgICAgICAgIDx0aD5cblx0ICAgICAgICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwib3JkZXIoJ25hbWUnKVwiPk5hbWU8L2J1dHRvbj5cblx0ICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInNvcnRvcmRlclwiIG5nLXNob3c9XCJwcmVkaWNhdGUgPT09ICduYW1lJ1wiIG5nLWNsYXNzPVwie3JldmVyc2U6cmV2ZXJzZX1cIj48L3NwYW4+XG5cdCAgICAgICAgICA8L3RoPlxuXHQgICAgICAgICAgPHRoPlxuXHQgICAgICAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJvcmRlcigncGhvbmUnKVwiPlBob25lIE51bWJlcjwvYnV0dG9uPlxuXHQgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwic29ydG9yZGVyXCIgbmctc2hvdz1cInByZWRpY2F0ZSA9PT0gJ3Bob25lJ1wiIG5nLWNsYXNzPVwie3JldmVyc2U6cmV2ZXJzZX1cIj48L3NwYW4+XG5cdCAgICAgICAgICA8L3RoPlxuXHQgICAgICAgICAgPHRoPlxuXHQgICAgICAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJvcmRlcignYWdlJylcIj5BZ2U8L2J1dHRvbj5cblx0ICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInNvcnRvcmRlclwiIG5nLXNob3c9XCJwcmVkaWNhdGUgPT09ICdhZ2UnXCIgbmctY2xhc3M9XCJ7cmV2ZXJzZTpyZXZlcnNlfVwiPjwvc3Bhbj5cblx0ICAgICAgICAgIDwvdGg+XG5cdCAgICAgICAgPC90cj5cblx0ICAgICAgICA8dHIgbmctcmVwZWF0PVwiZnJpZW5kIGluIGZyaWVuZHNcIj5cblx0ICAgICAgICAgIDx0ZD57e2ZyaWVuZC5uYW1lfX08L3RkPlxuXHQgICAgICAgICAgPHRkPnt7ZnJpZW5kLnBob25lfX08L3RkPlxuXHQgICAgICAgICAgPHRkPnt7ZnJpZW5kLmFnZX19PC90ZD5cblx0ICAgICAgICA8L3RyPlxuXHQgICAgICA8L3RhYmxlPlxuXHQgICAgPC9kaXY+XG5cdCAgICA8L2ZpbGU+XG5cdFxuXHQgICAgPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuXHQgICAgICBhbmd1bGFyLm1vZHVsZSgnb3JkZXJCeUV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsICckZmlsdGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkZmlsdGVyKSB7XG5cdCAgICAgICAgICB2YXIgb3JkZXJCeSA9ICRmaWx0ZXIoJ29yZGVyQnknKTtcblx0ICAgICAgICAgICRzY29wZS5mcmllbmRzID0gW1xuXHQgICAgICAgICAgICB7IG5hbWU6ICdKb2huJywgICAgcGhvbmU6ICc1NTUtMTIxMicsICAgIGFnZTogMTAgfSxcblx0ICAgICAgICAgICAgeyBuYW1lOiAnTWFyeScsICAgIHBob25lOiAnNTU1LTk4NzYnLCAgICBhZ2U6IDE5IH0sXG5cdCAgICAgICAgICAgIHsgbmFtZTogJ01pa2UnLCAgICBwaG9uZTogJzU1NS00MzIxJywgICAgYWdlOiAyMSB9LFxuXHQgICAgICAgICAgICB7IG5hbWU6ICdBZGFtJywgICAgcGhvbmU6ICc1NTUtNTY3OCcsICAgIGFnZTogMzUgfSxcblx0ICAgICAgICAgICAgeyBuYW1lOiAnSnVsaWUnLCAgIHBob25lOiAnNTU1LTg3NjUnLCAgICBhZ2U6IDI5IH1cblx0ICAgICAgICAgIF07XG5cdCAgICAgICAgICAkc2NvcGUub3JkZXIgPSBmdW5jdGlvbihwcmVkaWNhdGUpIHtcblx0ICAgICAgICAgICAgJHNjb3BlLnByZWRpY2F0ZSA9IHByZWRpY2F0ZTtcblx0ICAgICAgICAgICAgJHNjb3BlLnJldmVyc2UgPSAoJHNjb3BlLnByZWRpY2F0ZSA9PT0gcHJlZGljYXRlKSA/ICEkc2NvcGUucmV2ZXJzZSA6IGZhbHNlO1xuXHQgICAgICAgICAgICAkc2NvcGUuZnJpZW5kcyA9IG9yZGVyQnkoJHNjb3BlLmZyaWVuZHMsIHByZWRpY2F0ZSwgJHNjb3BlLnJldmVyc2UpO1xuXHQgICAgICAgICAgfTtcblx0ICAgICAgICAgICRzY29wZS5vcmRlcignYWdlJywgdHJ1ZSk7XG5cdCAgICAgICAgfV0pO1xuXHQgICAgPC9maWxlPlxuXHRcblx0ICAgIDxmaWxlIG5hbWU9XCJzdHlsZS5jc3NcIj5cblx0ICAgICAgIC5zb3J0b3JkZXI6YWZ0ZXIge1xuXHQgICAgICAgICBjb250ZW50OiAnXFwyNWIyJztcblx0ICAgICAgIH1cblx0ICAgICAgIC5zb3J0b3JkZXIucmV2ZXJzZTphZnRlciB7XG5cdCAgICAgICAgIGNvbnRlbnQ6ICdcXDI1YmMnO1xuXHQgICAgICAgfVxuXHQgICAgPC9maWxlPlxuXHQ8L2V4YW1wbGU+XG5cdCAqL1xuXHRvcmRlckJ5RmlsdGVyLiRpbmplY3QgPSBbJyRwYXJzZSddO1xuXHRmdW5jdGlvbiBvcmRlckJ5RmlsdGVyKCRwYXJzZSkge1xuXHQgIHJldHVybiBmdW5jdGlvbihhcnJheSwgc29ydFByZWRpY2F0ZSwgcmV2ZXJzZU9yZGVyKSB7XG5cdFxuXHQgICAgaWYgKGFycmF5ID09IG51bGwpIHJldHVybiBhcnJheTtcblx0ICAgIGlmICghaXNBcnJheUxpa2UoYXJyYXkpKSB7XG5cdCAgICAgIHRocm93IG1pbkVycignb3JkZXJCeScpKCdub3RhcnJheScsICdFeHBlY3RlZCBhcnJheSBidXQgcmVjZWl2ZWQ6IHswfScsIGFycmF5KTtcblx0ICAgIH1cblx0XG5cdCAgICBpZiAoIWlzQXJyYXkoc29ydFByZWRpY2F0ZSkpIHsgc29ydFByZWRpY2F0ZSA9IFtzb3J0UHJlZGljYXRlXTsgfVxuXHQgICAgaWYgKHNvcnRQcmVkaWNhdGUubGVuZ3RoID09PSAwKSB7IHNvcnRQcmVkaWNhdGUgPSBbJysnXTsgfVxuXHRcblx0ICAgIHZhciBwcmVkaWNhdGVzID0gcHJvY2Vzc1ByZWRpY2F0ZXMoc29ydFByZWRpY2F0ZSwgcmV2ZXJzZU9yZGVyKTtcblx0ICAgIC8vIEFkZCBhIHByZWRpY2F0ZSBhdCB0aGUgZW5kIHRoYXQgZXZhbHVhdGVzIHRvIHRoZSBlbGVtZW50IGluZGV4LiBUaGlzIG1ha2VzIHRoZVxuXHQgICAgLy8gc29ydCBzdGFibGUgYXMgaXQgd29ya3MgYXMgYSB0aWUtYnJlYWtlciB3aGVuIGFsbCB0aGUgaW5wdXQgcHJlZGljYXRlcyBjYW5ub3Rcblx0ICAgIC8vIGRpc3Rpbmd1aXNoIGJldHdlZW4gdHdvIGVsZW1lbnRzLlxuXHQgICAgcHJlZGljYXRlcy5wdXNoKHsgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIHt9OyB9LCBkZXNjZW5kaW5nOiByZXZlcnNlT3JkZXIgPyAtMSA6IDF9KTtcblx0XG5cdCAgICAvLyBUaGUgbmV4dCB0aHJlZSBsaW5lcyBhcmUgYSB2ZXJzaW9uIG9mIGEgU3dhcnR6aWFuIFRyYW5zZm9ybSBpZGlvbSBmcm9tIFBlcmxcblx0ICAgIC8vIChzb21ldGltZXMgY2FsbGVkIHRoZSBEZWNvcmF0ZS1Tb3J0LVVuZGVjb3JhdGUgaWRpb20pXG5cdCAgICAvLyBTZWUgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU2Nod2FydHppYW5fdHJhbnNmb3JtXG5cdCAgICB2YXIgY29tcGFyZVZhbHVlcyA9IEFycmF5LnByb3RvdHlwZS5tYXAuY2FsbChhcnJheSwgZ2V0Q29tcGFyaXNvbk9iamVjdCk7XG5cdCAgICBjb21wYXJlVmFsdWVzLnNvcnQoZG9Db21wYXJpc29uKTtcblx0ICAgIGFycmF5ID0gY29tcGFyZVZhbHVlcy5tYXAoZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRlbS52YWx1ZTsgfSk7XG5cdFxuXHQgICAgcmV0dXJuIGFycmF5O1xuXHRcblx0ICAgIGZ1bmN0aW9uIGdldENvbXBhcmlzb25PYmplY3QodmFsdWUsIGluZGV4KSB7XG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgdmFsdWU6IHZhbHVlLFxuXHQgICAgICAgIHByZWRpY2F0ZVZhbHVlczogcHJlZGljYXRlcy5tYXAoZnVuY3Rpb24ocHJlZGljYXRlKSB7XG5cdCAgICAgICAgICByZXR1cm4gZ2V0UHJlZGljYXRlVmFsdWUocHJlZGljYXRlLmdldCh2YWx1ZSksIGluZGV4KTtcblx0ICAgICAgICB9KVxuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGRvQ29tcGFyaXNvbih2MSwgdjIpIHtcblx0ICAgICAgdmFyIHJlc3VsdCA9IDA7XG5cdCAgICAgIGZvciAodmFyIGluZGV4PTAsIGxlbmd0aCA9IHByZWRpY2F0ZXMubGVuZ3RoOyBpbmRleCA8IGxlbmd0aDsgKytpbmRleCkge1xuXHQgICAgICAgIHJlc3VsdCA9IGNvbXBhcmUodjEucHJlZGljYXRlVmFsdWVzW2luZGV4XSwgdjIucHJlZGljYXRlVmFsdWVzW2luZGV4XSkgKiBwcmVkaWNhdGVzW2luZGV4XS5kZXNjZW5kaW5nO1xuXHQgICAgICAgIGlmIChyZXN1bHQpIGJyZWFrO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiByZXN1bHQ7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gcHJvY2Vzc1ByZWRpY2F0ZXMoc29ydFByZWRpY2F0ZSwgcmV2ZXJzZU9yZGVyKSB7XG5cdCAgICByZXZlcnNlT3JkZXIgPSByZXZlcnNlT3JkZXIgPyAtMSA6IDE7XG5cdCAgICByZXR1cm4gc29ydFByZWRpY2F0ZS5tYXAoZnVuY3Rpb24ocHJlZGljYXRlKSB7XG5cdCAgICAgIHZhciBkZXNjZW5kaW5nID0gMSwgZ2V0ID0gaWRlbnRpdHk7XG5cdFxuXHQgICAgICBpZiAoaXNGdW5jdGlvbihwcmVkaWNhdGUpKSB7XG5cdCAgICAgICAgZ2V0ID0gcHJlZGljYXRlO1xuXHQgICAgICB9IGVsc2UgaWYgKGlzU3RyaW5nKHByZWRpY2F0ZSkpIHtcblx0ICAgICAgICBpZiAoKHByZWRpY2F0ZS5jaGFyQXQoMCkgPT0gJysnIHx8IHByZWRpY2F0ZS5jaGFyQXQoMCkgPT0gJy0nKSkge1xuXHQgICAgICAgICAgZGVzY2VuZGluZyA9IHByZWRpY2F0ZS5jaGFyQXQoMCkgPT0gJy0nID8gLTEgOiAxO1xuXHQgICAgICAgICAgcHJlZGljYXRlID0gcHJlZGljYXRlLnN1YnN0cmluZygxKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKHByZWRpY2F0ZSAhPT0gJycpIHtcblx0ICAgICAgICAgIGdldCA9ICRwYXJzZShwcmVkaWNhdGUpO1xuXHQgICAgICAgICAgaWYgKGdldC5jb25zdGFudCkge1xuXHQgICAgICAgICAgICB2YXIga2V5ID0gZ2V0KCk7XG5cdCAgICAgICAgICAgIGdldCA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZVtrZXldOyB9O1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4geyBnZXQ6IGdldCwgZGVzY2VuZGluZzogZGVzY2VuZGluZyAqIHJldmVyc2VPcmRlciB9O1xuXHQgICAgfSk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBpc1ByaW1pdGl2ZSh2YWx1ZSkge1xuXHQgICAgc3dpdGNoICh0eXBlb2YgdmFsdWUpIHtcblx0ICAgICAgY2FzZSAnbnVtYmVyJzogLyogZmFsbHMgdGhyb3VnaCAqL1xuXHQgICAgICBjYXNlICdib29sZWFuJzogLyogZmFsbHMgdGhyb3VnaCAqL1xuXHQgICAgICBjYXNlICdzdHJpbmcnOlxuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICBkZWZhdWx0OlxuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIG9iamVjdFZhbHVlKHZhbHVlLCBpbmRleCkge1xuXHQgICAgLy8gSWYgYHZhbHVlT2ZgIGlzIGEgdmFsaWQgZnVuY3Rpb24gdXNlIHRoYXRcblx0ICAgIGlmICh0eXBlb2YgdmFsdWUudmFsdWVPZiA9PT0gJ2Z1bmN0aW9uJykge1xuXHQgICAgICB2YWx1ZSA9IHZhbHVlLnZhbHVlT2YoKTtcblx0ICAgICAgaWYgKGlzUHJpbWl0aXZlKHZhbHVlKSkgcmV0dXJuIHZhbHVlO1xuXHQgICAgfVxuXHQgICAgLy8gSWYgYHRvU3RyaW5nYCBpcyBhIHZhbGlkIGZ1bmN0aW9uIGFuZCBub3QgdGhlIG9uZSBmcm9tIGBPYmplY3QucHJvdG90eXBlYCB1c2UgdGhhdFxuXHQgICAgaWYgKGhhc0N1c3RvbVRvU3RyaW5nKHZhbHVlKSkge1xuXHQgICAgICB2YWx1ZSA9IHZhbHVlLnRvU3RyaW5nKCk7XG5cdCAgICAgIGlmIChpc1ByaW1pdGl2ZSh2YWx1ZSkpIHJldHVybiB2YWx1ZTtcblx0ICAgIH1cblx0ICAgIC8vIFdlIGhhdmUgYSBiYXNpYyBvYmplY3Qgc28gd2UgdXNlIHRoZSBwb3NpdGlvbiBvZiB0aGUgb2JqZWN0IGluIHRoZSBjb2xsZWN0aW9uXG5cdCAgICByZXR1cm4gaW5kZXg7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBnZXRQcmVkaWNhdGVWYWx1ZSh2YWx1ZSwgaW5kZXgpIHtcblx0ICAgIHZhciB0eXBlID0gdHlwZW9mIHZhbHVlO1xuXHQgICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG5cdCAgICAgIHR5cGUgPSAnc3RyaW5nJztcblx0ICAgICAgdmFsdWUgPSAnbnVsbCc7XG5cdCAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdzdHJpbmcnKSB7XG5cdCAgICAgIHZhbHVlID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcblx0ICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ29iamVjdCcpIHtcblx0ICAgICAgdmFsdWUgPSBvYmplY3RWYWx1ZSh2YWx1ZSwgaW5kZXgpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIHsgdmFsdWU6IHZhbHVlLCB0eXBlOiB0eXBlIH07XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBjb21wYXJlKHYxLCB2Mikge1xuXHQgICAgdmFyIHJlc3VsdCA9IDA7XG5cdCAgICBpZiAodjEudHlwZSA9PT0gdjIudHlwZSkge1xuXHQgICAgICBpZiAodjEudmFsdWUgIT09IHYyLnZhbHVlKSB7XG5cdCAgICAgICAgcmVzdWx0ID0gdjEudmFsdWUgPCB2Mi52YWx1ZSA/IC0xIDogMTtcblx0ICAgICAgfVxuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgcmVzdWx0ID0gdjEudHlwZSA8IHYyLnR5cGUgPyAtMSA6IDE7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gcmVzdWx0O1xuXHQgIH1cblx0fVxuXHRcblx0ZnVuY3Rpb24gbmdEaXJlY3RpdmUoZGlyZWN0aXZlKSB7XG5cdCAgaWYgKGlzRnVuY3Rpb24oZGlyZWN0aXZlKSkge1xuXHQgICAgZGlyZWN0aXZlID0ge1xuXHQgICAgICBsaW5rOiBkaXJlY3RpdmVcblx0ICAgIH07XG5cdCAgfVxuXHQgIGRpcmVjdGl2ZS5yZXN0cmljdCA9IGRpcmVjdGl2ZS5yZXN0cmljdCB8fCAnQUMnO1xuXHQgIHJldHVybiB2YWx1ZUZuKGRpcmVjdGl2ZSk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIGFcblx0ICogQHJlc3RyaWN0IEVcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIE1vZGlmaWVzIHRoZSBkZWZhdWx0IGJlaGF2aW9yIG9mIHRoZSBodG1sIEEgdGFnIHNvIHRoYXQgdGhlIGRlZmF1bHQgYWN0aW9uIGlzIHByZXZlbnRlZCB3aGVuXG5cdCAqIHRoZSBocmVmIGF0dHJpYnV0ZSBpcyBlbXB0eS5cblx0ICpcblx0ICogVGhpcyBjaGFuZ2UgcGVybWl0cyB0aGUgZWFzeSBjcmVhdGlvbiBvZiBhY3Rpb24gbGlua3Mgd2l0aCB0aGUgYG5nQ2xpY2tgIGRpcmVjdGl2ZVxuXHQgKiB3aXRob3V0IGNoYW5naW5nIHRoZSBsb2NhdGlvbiBvciBjYXVzaW5nIHBhZ2UgcmVsb2FkcywgZS5nLjpcblx0ICogYDxhIGhyZWY9XCJcIiBuZy1jbGljaz1cImxpc3QuYWRkSXRlbSgpXCI+QWRkIEl0ZW08L2E+YFxuXHQgKi9cblx0dmFyIGh0bWxBbmNob3JEaXJlY3RpdmUgPSB2YWx1ZUZuKHtcblx0ICByZXN0cmljdDogJ0UnLFxuXHQgIGNvbXBpbGU6IGZ1bmN0aW9uKGVsZW1lbnQsIGF0dHIpIHtcblx0ICAgIGlmICghYXR0ci5ocmVmICYmICFhdHRyLnhsaW5rSHJlZikge1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQpIHtcblx0ICAgICAgICAvLyBJZiB0aGUgbGlua2VkIGVsZW1lbnQgaXMgbm90IGFuIGFuY2hvciB0YWcgYW55bW9yZSwgZG8gbm90aGluZ1xuXHQgICAgICAgIGlmIChlbGVtZW50WzBdLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICdhJykgcmV0dXJuO1xuXHRcblx0ICAgICAgICAvLyBTVkdBRWxlbWVudCBkb2VzIG5vdCB1c2UgdGhlIGhyZWYgYXR0cmlidXRlLCBidXQgcmF0aGVyIHRoZSAneGxpbmtIcmVmJyBhdHRyaWJ1dGUuXG5cdCAgICAgICAgdmFyIGhyZWYgPSB0b1N0cmluZy5jYWxsKGVsZW1lbnQucHJvcCgnaHJlZicpKSA9PT0gJ1tvYmplY3QgU1ZHQW5pbWF0ZWRTdHJpbmddJyA/XG5cdCAgICAgICAgICAgICAgICAgICAneGxpbms6aHJlZicgOiAnaHJlZic7XG5cdCAgICAgICAgZWxlbWVudC5vbignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuXHQgICAgICAgICAgLy8gaWYgd2UgaGF2ZSBubyBocmVmIHVybCwgdGhlbiBkb24ndCBuYXZpZ2F0ZSBhbnl3aGVyZS5cblx0ICAgICAgICAgIGlmICghZWxlbWVudC5hdHRyKGhyZWYpKSB7XG5cdCAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfVxuXHR9KTtcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIG5nSHJlZlxuXHQgKiBAcmVzdHJpY3QgQVxuXHQgKiBAcHJpb3JpdHkgOTlcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFVzaW5nIEFuZ3VsYXIgbWFya3VwIGxpa2UgYHt7aGFzaH19YCBpbiBhbiBocmVmIGF0dHJpYnV0ZSB3aWxsXG5cdCAqIG1ha2UgdGhlIGxpbmsgZ28gdG8gdGhlIHdyb25nIFVSTCBpZiB0aGUgdXNlciBjbGlja3MgaXQgYmVmb3JlXG5cdCAqIEFuZ3VsYXIgaGFzIGEgY2hhbmNlIHRvIHJlcGxhY2UgdGhlIGB7e2hhc2h9fWAgbWFya3VwIHdpdGggaXRzXG5cdCAqIHZhbHVlLiBVbnRpbCBBbmd1bGFyIHJlcGxhY2VzIHRoZSBtYXJrdXAgdGhlIGxpbmsgd2lsbCBiZSBicm9rZW5cblx0ICogYW5kIHdpbGwgbW9zdCBsaWtlbHkgcmV0dXJuIGEgNDA0IGVycm9yLiBUaGUgYG5nSHJlZmAgZGlyZWN0aXZlXG5cdCAqIHNvbHZlcyB0aGlzIHByb2JsZW0uXG5cdCAqXG5cdCAqIFRoZSB3cm9uZyB3YXkgdG8gd3JpdGUgaXQ6XG5cdCAqIGBgYGh0bWxcblx0ICogPGEgaHJlZj1cImh0dHA6Ly93d3cuZ3JhdmF0YXIuY29tL2F2YXRhci97e2hhc2h9fVwiPmxpbmsxPC9hPlxuXHQgKiBgYGBcblx0ICpcblx0ICogVGhlIGNvcnJlY3Qgd2F5IHRvIHdyaXRlIGl0OlxuXHQgKiBgYGBodG1sXG5cdCAqIDxhIG5nLWhyZWY9XCJodHRwOi8vd3d3LmdyYXZhdGFyLmNvbS9hdmF0YXIve3toYXNofX1cIj5saW5rMTwvYT5cblx0ICogYGBgXG5cdCAqXG5cdCAqIEBlbGVtZW50IEFcblx0ICogQHBhcmFtIHt0ZW1wbGF0ZX0gbmdIcmVmIGFueSBzdHJpbmcgd2hpY2ggY2FuIGNvbnRhaW4gYHt7fX1gIG1hcmt1cC5cblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICogVGhpcyBleGFtcGxlIHNob3dzIHZhcmlvdXMgY29tYmluYXRpb25zIG9mIGBocmVmYCwgYG5nLWhyZWZgIGFuZCBgbmctY2xpY2tgIGF0dHJpYnV0ZXNcblx0ICogaW4gbGlua3MgYW5kIHRoZWlyIGRpZmZlcmVudCBiZWhhdmlvcnM6XG5cdCAgICA8ZXhhbXBsZT5cblx0ICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgICA8aW5wdXQgbmctbW9kZWw9XCJ2YWx1ZVwiIC8+PGJyIC8+XG5cdCAgICAgICAgPGEgaWQ9XCJsaW5rLTFcIiBocmVmIG5nLWNsaWNrPVwidmFsdWUgPSAxXCI+bGluayAxPC9hPiAobGluaywgZG9uJ3QgcmVsb2FkKTxiciAvPlxuXHQgICAgICAgIDxhIGlkPVwibGluay0yXCIgaHJlZj1cIlwiIG5nLWNsaWNrPVwidmFsdWUgPSAyXCI+bGluayAyPC9hPiAobGluaywgZG9uJ3QgcmVsb2FkKTxiciAvPlxuXHQgICAgICAgIDxhIGlkPVwibGluay0zXCIgbmctaHJlZj1cIi97eycxMjMnfX1cIj5saW5rIDM8L2E+IChsaW5rLCByZWxvYWQhKTxiciAvPlxuXHQgICAgICAgIDxhIGlkPVwibGluay00XCIgaHJlZj1cIlwiIG5hbWU9XCJ4eFwiIG5nLWNsaWNrPVwidmFsdWUgPSA0XCI+YW5jaG9yPC9hPiAobGluaywgZG9uJ3QgcmVsb2FkKTxiciAvPlxuXHQgICAgICAgIDxhIGlkPVwibGluay01XCIgbmFtZT1cInh4eFwiIG5nLWNsaWNrPVwidmFsdWUgPSA1XCI+YW5jaG9yPC9hPiAobm8gbGluayk8YnIgLz5cblx0ICAgICAgICA8YSBpZD1cImxpbmstNlwiIG5nLWhyZWY9XCJ7e3ZhbHVlfX1cIj5saW5rPC9hPiAobGluaywgY2hhbmdlIGxvY2F0aW9uKVxuXHQgICAgICA8L2ZpbGU+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgICBpdCgnc2hvdWxkIGV4ZWN1dGUgbmctY2xpY2sgYnV0IG5vdCByZWxvYWQgd2hlbiBocmVmIHdpdGhvdXQgdmFsdWUnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIGVsZW1lbnQoYnkuaWQoJ2xpbmstMScpKS5jbGljaygpO1xuXHQgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkubW9kZWwoJ3ZhbHVlJykpLmdldEF0dHJpYnV0ZSgndmFsdWUnKSkudG9FcXVhbCgnMScpO1xuXHQgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2xpbmstMScpKS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSkudG9CZSgnJyk7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBuZy1jbGljayBidXQgbm90IHJlbG9hZCB3aGVuIGhyZWYgZW1wdHkgc3RyaW5nJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBlbGVtZW50KGJ5LmlkKCdsaW5rLTInKSkuY2xpY2soKTtcblx0ICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5Lm1vZGVsKCd2YWx1ZScpKS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpLnRvRXF1YWwoJzInKTtcblx0ICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmlkKCdsaW5rLTInKSkuZ2V0QXR0cmlidXRlKCdocmVmJykpLnRvQmUoJycpO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBpdCgnc2hvdWxkIGV4ZWN1dGUgbmctY2xpY2sgYW5kIGNoYW5nZSB1cmwgd2hlbiBuZy1ocmVmIHNwZWNpZmllZCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2xpbmstMycpKS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSkudG9NYXRjaCgvXFwvMTIzJC8pO1xuXHRcblx0ICAgICAgICAgIGVsZW1lbnQoYnkuaWQoJ2xpbmstMycpKS5jbGljaygpO1xuXHRcblx0ICAgICAgICAgIC8vIEF0IHRoaXMgcG9pbnQsIHdlIG5hdmlnYXRlIGF3YXkgZnJvbSBhbiBBbmd1bGFyIHBhZ2UsIHNvIHdlIG5lZWRcblx0ICAgICAgICAgIC8vIHRvIHVzZSBicm93c2VyLmRyaXZlciB0byBnZXQgdGhlIGJhc2Ugd2ViZHJpdmVyLlxuXHRcblx0ICAgICAgICAgIGJyb3dzZXIud2FpdChmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGJyb3dzZXIuZHJpdmVyLmdldEN1cnJlbnRVcmwoKS50aGVuKGZ1bmN0aW9uKHVybCkge1xuXHQgICAgICAgICAgICAgIHJldHVybiB1cmwubWF0Y2goL1xcLzEyMyQvKTtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICB9LCA1MDAwLCAncGFnZSBzaG91bGQgbmF2aWdhdGUgdG8gLzEyMycpO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBpdCgnc2hvdWxkIGV4ZWN1dGUgbmctY2xpY2sgYnV0IG5vdCByZWxvYWQgd2hlbiBocmVmIGVtcHR5IHN0cmluZyBhbmQgbmFtZSBzcGVjaWZpZWQnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIGVsZW1lbnQoYnkuaWQoJ2xpbmstNCcpKS5jbGljaygpO1xuXHQgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkubW9kZWwoJ3ZhbHVlJykpLmdldEF0dHJpYnV0ZSgndmFsdWUnKSkudG9FcXVhbCgnNCcpO1xuXHQgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2xpbmstNCcpKS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSkudG9CZSgnJyk7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBuZy1jbGljayBidXQgbm90IHJlbG9hZCB3aGVuIG5vIGhyZWYgYnV0IG5hbWUgc3BlY2lmaWVkJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBlbGVtZW50KGJ5LmlkKCdsaW5rLTUnKSkuY2xpY2soKTtcblx0ICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5Lm1vZGVsKCd2YWx1ZScpKS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpLnRvRXF1YWwoJzUnKTtcblx0ICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmlkKCdsaW5rLTUnKSkuZ2V0QXR0cmlidXRlKCdocmVmJykpLnRvQmUobnVsbCk7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIGl0KCdzaG91bGQgb25seSBjaGFuZ2UgdXJsIHdoZW4gb25seSBuZy1ocmVmJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCd2YWx1ZScpKS5jbGVhcigpO1xuXHQgICAgICAgICAgZWxlbWVudChieS5tb2RlbCgndmFsdWUnKSkuc2VuZEtleXMoJzYnKTtcblx0ICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmlkKCdsaW5rLTYnKSkuZ2V0QXR0cmlidXRlKCdocmVmJykpLnRvTWF0Y2goL1xcLzYkLyk7XG5cdFxuXHQgICAgICAgICAgZWxlbWVudChieS5pZCgnbGluay02JykpLmNsaWNrKCk7XG5cdFxuXHQgICAgICAgICAgLy8gQXQgdGhpcyBwb2ludCwgd2UgbmF2aWdhdGUgYXdheSBmcm9tIGFuIEFuZ3VsYXIgcGFnZSwgc28gd2UgbmVlZFxuXHQgICAgICAgICAgLy8gdG8gdXNlIGJyb3dzZXIuZHJpdmVyIHRvIGdldCB0aGUgYmFzZSB3ZWJkcml2ZXIuXG5cdCAgICAgICAgICBicm93c2VyLndhaXQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBicm93c2VyLmRyaXZlci5nZXRDdXJyZW50VXJsKCkudGhlbihmdW5jdGlvbih1cmwpIHtcblx0ICAgICAgICAgICAgICByZXR1cm4gdXJsLm1hdGNoKC9cXC82JC8pO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgIH0sIDUwMDAsICdwYWdlIHNob3VsZCBuYXZpZ2F0ZSB0byAvNicpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICA8L2ZpbGU+XG5cdCAgICA8L2V4YW1wbGU+XG5cdCAqL1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdTcmNcblx0ICogQHJlc3RyaWN0IEFcblx0ICogQHByaW9yaXR5IDk5XG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBVc2luZyBBbmd1bGFyIG1hcmt1cCBsaWtlIGB7e2hhc2h9fWAgaW4gYSBgc3JjYCBhdHRyaWJ1dGUgZG9lc24ndFxuXHQgKiB3b3JrIHJpZ2h0OiBUaGUgYnJvd3NlciB3aWxsIGZldGNoIGZyb20gdGhlIFVSTCB3aXRoIHRoZSBsaXRlcmFsXG5cdCAqIHRleHQgYHt7aGFzaH19YCB1bnRpbCBBbmd1bGFyIHJlcGxhY2VzIHRoZSBleHByZXNzaW9uIGluc2lkZVxuXHQgKiBge3toYXNofX1gLiBUaGUgYG5nU3JjYCBkaXJlY3RpdmUgc29sdmVzIHRoaXMgcHJvYmxlbS5cblx0ICpcblx0ICogVGhlIGJ1Z2d5IHdheSB0byB3cml0ZSBpdDpcblx0ICogYGBgaHRtbFxuXHQgKiA8aW1nIHNyYz1cImh0dHA6Ly93d3cuZ3JhdmF0YXIuY29tL2F2YXRhci97e2hhc2h9fVwiIGFsdD1cIkRlc2NyaXB0aW9uXCIvPlxuXHQgKiBgYGBcblx0ICpcblx0ICogVGhlIGNvcnJlY3Qgd2F5IHRvIHdyaXRlIGl0OlxuXHQgKiBgYGBodG1sXG5cdCAqIDxpbWcgbmctc3JjPVwiaHR0cDovL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyL3t7aGFzaH19XCIgYWx0PVwiRGVzY3JpcHRpb25cIiAvPlxuXHQgKiBgYGBcblx0ICpcblx0ICogQGVsZW1lbnQgSU1HXG5cdCAqIEBwYXJhbSB7dGVtcGxhdGV9IG5nU3JjIGFueSBzdHJpbmcgd2hpY2ggY2FuIGNvbnRhaW4gYHt7fX1gIG1hcmt1cC5cblx0ICovXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ1NyY3NldFxuXHQgKiBAcmVzdHJpY3QgQVxuXHQgKiBAcHJpb3JpdHkgOTlcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFVzaW5nIEFuZ3VsYXIgbWFya3VwIGxpa2UgYHt7aGFzaH19YCBpbiBhIGBzcmNzZXRgIGF0dHJpYnV0ZSBkb2Vzbid0XG5cdCAqIHdvcmsgcmlnaHQ6IFRoZSBicm93c2VyIHdpbGwgZmV0Y2ggZnJvbSB0aGUgVVJMIHdpdGggdGhlIGxpdGVyYWxcblx0ICogdGV4dCBge3toYXNofX1gIHVudGlsIEFuZ3VsYXIgcmVwbGFjZXMgdGhlIGV4cHJlc3Npb24gaW5zaWRlXG5cdCAqIGB7e2hhc2h9fWAuIFRoZSBgbmdTcmNzZXRgIGRpcmVjdGl2ZSBzb2x2ZXMgdGhpcyBwcm9ibGVtLlxuXHQgKlxuXHQgKiBUaGUgYnVnZ3kgd2F5IHRvIHdyaXRlIGl0OlxuXHQgKiBgYGBodG1sXG5cdCAqIDxpbWcgc3Jjc2V0PVwiaHR0cDovL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyL3t7aGFzaH19IDJ4XCIgYWx0PVwiRGVzY3JpcHRpb25cIi8+XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBUaGUgY29ycmVjdCB3YXkgdG8gd3JpdGUgaXQ6XG5cdCAqIGBgYGh0bWxcblx0ICogPGltZyBuZy1zcmNzZXQ9XCJodHRwOi8vd3d3LmdyYXZhdGFyLmNvbS9hdmF0YXIve3toYXNofX0gMnhcIiBhbHQ9XCJEZXNjcmlwdGlvblwiIC8+XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBAZWxlbWVudCBJTUdcblx0ICogQHBhcmFtIHt0ZW1wbGF0ZX0gbmdTcmNzZXQgYW55IHN0cmluZyB3aGljaCBjYW4gY29udGFpbiBge3t9fWAgbWFya3VwLlxuXHQgKi9cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIG5nRGlzYWJsZWRcblx0ICogQHJlc3RyaWN0IEFcblx0ICogQHByaW9yaXR5IDEwMFxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogVGhpcyBkaXJlY3RpdmUgc2V0cyB0aGUgYGRpc2FibGVkYCBhdHRyaWJ1dGUgb24gdGhlIGVsZW1lbnQgaWYgdGhlXG5cdCAqIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259IGluc2lkZSBgbmdEaXNhYmxlZGAgZXZhbHVhdGVzIHRvIHRydXRoeS5cblx0ICpcblx0ICogQSBzcGVjaWFsIGRpcmVjdGl2ZSBpcyBuZWNlc3NhcnkgYmVjYXVzZSB3ZSBjYW5ub3QgdXNlIGludGVycG9sYXRpb24gaW5zaWRlIHRoZSBgZGlzYWJsZWRgXG5cdCAqIGF0dHJpYnV0ZS4gU2VlIHRoZSB7QGxpbmsgZ3VpZGUvaW50ZXJwb2xhdGlvbiBpbnRlcnBvbGF0aW9uIGd1aWRlfSBmb3IgbW9yZSBpbmZvLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICAgPGV4YW1wbGU+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgPGxhYmVsPkNsaWNrIG1lIHRvIHRvZ2dsZTogPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiY2hlY2tlZFwiPjwvbGFiZWw+PGJyLz5cblx0ICAgICAgICA8YnV0dG9uIG5nLW1vZGVsPVwiYnV0dG9uXCIgbmctZGlzYWJsZWQ9XCJjaGVja2VkXCI+QnV0dG9uPC9idXR0b24+XG5cdCAgICAgIDwvZmlsZT5cblx0ICAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgIGl0KCdzaG91bGQgdG9nZ2xlIGJ1dHRvbicsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuY3NzKCdidXR0b24nKSkuZ2V0QXR0cmlidXRlKCdkaXNhYmxlZCcpKS50b0JlRmFsc3koKTtcblx0ICAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ2NoZWNrZWQnKSkuY2xpY2soKTtcblx0ICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmNzcygnYnV0dG9uJykpLmdldEF0dHJpYnV0ZSgnZGlzYWJsZWQnKSkudG9CZVRydXRoeSgpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICA8L2ZpbGU+XG5cdCAgICA8L2V4YW1wbGU+XG5cdCAqXG5cdCAqIEBlbGVtZW50IElOUFVUXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdEaXNhYmxlZCBJZiB0aGUge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gZXhwcmVzc2lvbn0gaXMgdHJ1dGh5LFxuXHQgKiAgICAgdGhlbiB0aGUgYGRpc2FibGVkYCBhdHRyaWJ1dGUgd2lsbCBiZSBzZXQgb24gdGhlIGVsZW1lbnRcblx0ICovXG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdDaGVja2VkXG5cdCAqIEByZXN0cmljdCBBXG5cdCAqIEBwcmlvcml0eSAxMDBcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFNldHMgdGhlIGBjaGVja2VkYCBhdHRyaWJ1dGUgb24gdGhlIGVsZW1lbnQsIGlmIHRoZSBleHByZXNzaW9uIGluc2lkZSBgbmdDaGVja2VkYCBpcyB0cnV0aHkuXG5cdCAqXG5cdCAqIE5vdGUgdGhhdCB0aGlzIGRpcmVjdGl2ZSBzaG91bGQgbm90IGJlIHVzZWQgdG9nZXRoZXIgd2l0aCB7QGxpbmsgbmdNb2RlbCBgbmdNb2RlbGB9LFxuXHQgKiBhcyB0aGlzIGNhbiBsZWFkIHRvIHVuZXhwZWN0ZWQgYmVoYXZpb3IuXG5cdCAqXG5cdCAqIEEgc3BlY2lhbCBkaXJlY3RpdmUgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugd2UgY2Fubm90IHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSB0aGUgYGNoZWNrZWRgXG5cdCAqIGF0dHJpYnV0ZS4gU2VlIHRoZSB7QGxpbmsgZ3VpZGUvaW50ZXJwb2xhdGlvbiBpbnRlcnBvbGF0aW9uIGd1aWRlfSBmb3IgbW9yZSBpbmZvLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICAgPGV4YW1wbGU+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgPGxhYmVsPkNoZWNrIG1lIHRvIGNoZWNrIGJvdGg6IDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cIm1hc3RlclwiPjwvbGFiZWw+PGJyLz5cblx0ICAgICAgICA8aW5wdXQgaWQ9XCJjaGVja1NsYXZlXCIgdHlwZT1cImNoZWNrYm94XCIgbmctY2hlY2tlZD1cIm1hc3RlclwiIGFyaWEtbGFiZWw9XCJTbGF2ZSBpbnB1dFwiPlxuXHQgICAgICA8L2ZpbGU+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgICBpdCgnc2hvdWxkIGNoZWNrIGJvdGggY2hlY2tCb3hlcycsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2NoZWNrU2xhdmUnKSkuZ2V0QXR0cmlidXRlKCdjaGVja2VkJykpLnRvQmVGYWxzeSgpO1xuXHQgICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnbWFzdGVyJykpLmNsaWNrKCk7XG5cdCAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnY2hlY2tTbGF2ZScpKS5nZXRBdHRyaWJ1dGUoJ2NoZWNrZWQnKSkudG9CZVRydXRoeSgpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICA8L2ZpbGU+XG5cdCAgICA8L2V4YW1wbGU+XG5cdCAqXG5cdCAqIEBlbGVtZW50IElOUFVUXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdDaGVja2VkIElmIHRoZSB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufSBpcyB0cnV0aHksXG5cdCAqICAgICB0aGVuIHRoZSBgY2hlY2tlZGAgYXR0cmlidXRlIHdpbGwgYmUgc2V0IG9uIHRoZSBlbGVtZW50XG5cdCAqL1xuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIG5nUmVhZG9ubHlcblx0ICogQHJlc3RyaWN0IEFcblx0ICogQHByaW9yaXR5IDEwMFxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogU2V0cyB0aGUgYHJlYWRPbmx5YCBhdHRyaWJ1dGUgb24gdGhlIGVsZW1lbnQsIGlmIHRoZSBleHByZXNzaW9uIGluc2lkZSBgbmdSZWFkb25seWAgaXMgdHJ1dGh5LlxuXHQgKlxuXHQgKiBBIHNwZWNpYWwgZGlyZWN0aXZlIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHdlIGNhbm5vdCB1c2UgaW50ZXJwb2xhdGlvbiBpbnNpZGUgdGhlIGByZWFkT25seWBcblx0ICogYXR0cmlidXRlLiBTZWUgdGhlIHtAbGluayBndWlkZS9pbnRlcnBvbGF0aW9uIGludGVycG9sYXRpb24gZ3VpZGV9IGZvciBtb3JlIGluZm8uXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgICA8ZXhhbXBsZT5cblx0ICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgICA8bGFiZWw+Q2hlY2sgbWUgdG8gbWFrZSB0ZXh0IHJlYWRvbmx5OiA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmctbW9kZWw9XCJjaGVja2VkXCI+PC9sYWJlbD48YnIvPlxuXHQgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLXJlYWRvbmx5PVwiY2hlY2tlZFwiIHZhbHVlPVwiSSdtIEFuZ3VsYXJcIiBhcmlhLWxhYmVsPVwiUmVhZG9ubHkgZmllbGRcIiAvPlxuXHQgICAgICA8L2ZpbGU+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgICBpdCgnc2hvdWxkIHRvZ2dsZSByZWFkb25seSBhdHRyJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5jc3MoJ1t0eXBlPVwidGV4dFwiXScpKS5nZXRBdHRyaWJ1dGUoJ3JlYWRvbmx5JykpLnRvQmVGYWxzeSgpO1xuXHQgICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnY2hlY2tlZCcpKS5jbGljaygpO1xuXHQgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuY3NzKCdbdHlwZT1cInRleHRcIl0nKSkuZ2V0QXR0cmlidXRlKCdyZWFkb25seScpKS50b0JlVHJ1dGh5KCk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIDwvZmlsZT5cblx0ICAgIDwvZXhhbXBsZT5cblx0ICpcblx0ICogQGVsZW1lbnQgSU5QVVRcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ1JlYWRvbmx5IElmIHRoZSB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufSBpcyB0cnV0aHksXG5cdCAqICAgICB0aGVuIHNwZWNpYWwgYXR0cmlidXRlIFwicmVhZG9ubHlcIiB3aWxsIGJlIHNldCBvbiB0aGUgZWxlbWVudFxuXHQgKi9cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ1NlbGVjdGVkXG5cdCAqIEByZXN0cmljdCBBXG5cdCAqIEBwcmlvcml0eSAxMDBcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqXG5cdCAqIFNldHMgdGhlIGBzZWxlY3RlZGAgYXR0cmlidXRlIG9uIHRoZSBlbGVtZW50LCBpZiB0aGUgZXhwcmVzc2lvbiBpbnNpZGUgYG5nU2VsZWN0ZWRgIGlzIHRydXRoeS5cblx0ICpcblx0ICogQSBzcGVjaWFsIGRpcmVjdGl2ZSBpcyBuZWNlc3NhcnkgYmVjYXVzZSB3ZSBjYW5ub3QgdXNlIGludGVycG9sYXRpb24gaW5zaWRlIHRoZSBgc2VsZWN0ZWRgXG5cdCAqIGF0dHJpYnV0ZS4gU2VlIHRoZSB7QGxpbmsgZ3VpZGUvaW50ZXJwb2xhdGlvbiBpbnRlcnBvbGF0aW9uIGd1aWRlfSBmb3IgbW9yZSBpbmZvLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICAgPGV4YW1wbGU+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgPGxhYmVsPkNoZWNrIG1lIHRvIHNlbGVjdDogPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwic2VsZWN0ZWRcIj48L2xhYmVsPjxici8+XG5cdCAgICAgICAgPHNlbGVjdCBhcmlhLWxhYmVsPVwibmdTZWxlY3RlZCBkZW1vXCI+XG5cdCAgICAgICAgICA8b3B0aW9uPkhlbGxvITwvb3B0aW9uPlxuXHQgICAgICAgICAgPG9wdGlvbiBpZD1cImdyZWV0XCIgbmctc2VsZWN0ZWQ9XCJzZWxlY3RlZFwiPkdyZWV0aW5ncyE8L29wdGlvbj5cblx0ICAgICAgICA8L3NlbGVjdD5cblx0ICAgICAgPC9maWxlPlxuXHQgICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgICAgaXQoJ3Nob3VsZCBzZWxlY3QgR3JlZXRpbmdzIScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2dyZWV0JykpLmdldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnKSkudG9CZUZhbHN5KCk7XG5cdCAgICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCdzZWxlY3RlZCcpKS5jbGljaygpO1xuXHQgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2dyZWV0JykpLmdldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnKSkudG9CZVRydXRoeSgpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICA8L2ZpbGU+XG5cdCAgICA8L2V4YW1wbGU+XG5cdCAqXG5cdCAqIEBlbGVtZW50IE9QVElPTlxuXHQgKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nU2VsZWN0ZWQgSWYgdGhlIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259IGlzIHRydXRoeSxcblx0ICogICAgIHRoZW4gc3BlY2lhbCBhdHRyaWJ1dGUgXCJzZWxlY3RlZFwiIHdpbGwgYmUgc2V0IG9uIHRoZSBlbGVtZW50XG5cdCAqL1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdPcGVuXG5cdCAqIEByZXN0cmljdCBBXG5cdCAqIEBwcmlvcml0eSAxMDBcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqXG5cdCAqIFNldHMgdGhlIGBvcGVuYCBhdHRyaWJ1dGUgb24gdGhlIGVsZW1lbnQsIGlmIHRoZSBleHByZXNzaW9uIGluc2lkZSBgbmdPcGVuYCBpcyB0cnV0aHkuXG5cdCAqXG5cdCAqIEEgc3BlY2lhbCBkaXJlY3RpdmUgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugd2UgY2Fubm90IHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSB0aGUgYG9wZW5gXG5cdCAqIGF0dHJpYnV0ZS4gU2VlIHRoZSB7QGxpbmsgZ3VpZGUvaW50ZXJwb2xhdGlvbiBpbnRlcnBvbGF0aW9uIGd1aWRlfSBmb3IgbW9yZSBpbmZvLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICAgIDxleGFtcGxlPlxuXHQgICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgICAgPGxhYmVsPkNoZWNrIG1lIGNoZWNrIG11bHRpcGxlOiA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmctbW9kZWw9XCJvcGVuXCI+PC9sYWJlbD48YnIvPlxuXHQgICAgICAgICA8ZGV0YWlscyBpZD1cImRldGFpbHNcIiBuZy1vcGVuPVwib3BlblwiPlxuXHQgICAgICAgICAgICA8c3VtbWFyeT5TaG93L0hpZGUgbWU8L3N1bW1hcnk+XG5cdCAgICAgICAgIDwvZGV0YWlscz5cblx0ICAgICAgIDwvZmlsZT5cblx0ICAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgICAgaXQoJ3Nob3VsZCB0b2dnbGUgb3BlbicsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmlkKCdkZXRhaWxzJykpLmdldEF0dHJpYnV0ZSgnb3BlbicpKS50b0JlRmFsc3koKTtcblx0ICAgICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCdvcGVuJykpLmNsaWNrKCk7XG5cdCAgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2RldGFpbHMnKSkuZ2V0QXR0cmlidXRlKCdvcGVuJykpLnRvQmVUcnV0aHkoKTtcblx0ICAgICAgICAgfSk7XG5cdCAgICAgICA8L2ZpbGU+XG5cdCAgICAgPC9leGFtcGxlPlxuXHQgKlxuXHQgKiBAZWxlbWVudCBERVRBSUxTXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdPcGVuIElmIHRoZSB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufSBpcyB0cnV0aHksXG5cdCAqICAgICB0aGVuIHNwZWNpYWwgYXR0cmlidXRlIFwib3BlblwiIHdpbGwgYmUgc2V0IG9uIHRoZSBlbGVtZW50XG5cdCAqL1xuXHRcblx0dmFyIG5nQXR0cmlidXRlQWxpYXNEaXJlY3RpdmVzID0ge307XG5cdFxuXHQvLyBib29sZWFuIGF0dHJzIGFyZSBldmFsdWF0ZWRcblx0Zm9yRWFjaChCT09MRUFOX0FUVFIsIGZ1bmN0aW9uKHByb3BOYW1lLCBhdHRyTmFtZSkge1xuXHQgIC8vIGJpbmRpbmcgdG8gbXVsdGlwbGUgaXMgbm90IHN1cHBvcnRlZFxuXHQgIGlmIChwcm9wTmFtZSA9PSBcIm11bHRpcGxlXCIpIHJldHVybjtcblx0XG5cdCAgZnVuY3Rpb24gZGVmYXVsdExpbmtGbihzY29wZSwgZWxlbWVudCwgYXR0cikge1xuXHQgICAgc2NvcGUuJHdhdGNoKGF0dHJbbm9ybWFsaXplZF0sIGZ1bmN0aW9uIG5nQm9vbGVhbkF0dHJXYXRjaEFjdGlvbih2YWx1ZSkge1xuXHQgICAgICBhdHRyLiRzZXQoYXR0ck5hbWUsICEhdmFsdWUpO1xuXHQgICAgfSk7XG5cdCAgfVxuXHRcblx0ICB2YXIgbm9ybWFsaXplZCA9IGRpcmVjdGl2ZU5vcm1hbGl6ZSgnbmctJyArIGF0dHJOYW1lKTtcblx0ICB2YXIgbGlua0ZuID0gZGVmYXVsdExpbmtGbjtcblx0XG5cdCAgaWYgKHByb3BOYW1lID09PSAnY2hlY2tlZCcpIHtcblx0ICAgIGxpbmtGbiA9IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG5cdCAgICAgIC8vIGVuc3VyaW5nIG5nQ2hlY2tlZCBkb2Vzbid0IGludGVyZmVyZSB3aXRoIG5nTW9kZWwgd2hlbiBib3RoIGFyZSBzZXQgb24gdGhlIHNhbWUgaW5wdXRcblx0ICAgICAgaWYgKGF0dHIubmdNb2RlbCAhPT0gYXR0cltub3JtYWxpemVkXSkge1xuXHQgICAgICAgIGRlZmF1bHRMaW5rRm4oc2NvcGUsIGVsZW1lbnQsIGF0dHIpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgIH1cblx0XG5cdCAgbmdBdHRyaWJ1dGVBbGlhc0RpcmVjdGl2ZXNbbm9ybWFsaXplZF0gPSBmdW5jdGlvbigpIHtcblx0ICAgIHJldHVybiB7XG5cdCAgICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICAgIHByaW9yaXR5OiAxMDAsXG5cdCAgICAgIGxpbms6IGxpbmtGblxuXHQgICAgfTtcblx0ICB9O1xuXHR9KTtcblx0XG5cdC8vIGFsaWFzZWQgaW5wdXQgYXR0cnMgYXJlIGV2YWx1YXRlZFxuXHRmb3JFYWNoKEFMSUFTRURfQVRUUiwgZnVuY3Rpb24oaHRtbEF0dHIsIG5nQXR0cikge1xuXHQgIG5nQXR0cmlidXRlQWxpYXNEaXJlY3RpdmVzW25nQXR0cl0gPSBmdW5jdGlvbigpIHtcblx0ICAgIHJldHVybiB7XG5cdCAgICAgIHByaW9yaXR5OiAxMDAsXG5cdCAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG5cdCAgICAgICAgLy9zcGVjaWFsIGNhc2UgbmdQYXR0ZXJuIHdoZW4gYSBsaXRlcmFsIHJlZ3VsYXIgZXhwcmVzc2lvbiB2YWx1ZVxuXHQgICAgICAgIC8vaXMgdXNlZCBhcyB0aGUgZXhwcmVzc2lvbiAodGhpcyB3YXkgd2UgZG9uJ3QgaGF2ZSB0byB3YXRjaCBhbnl0aGluZykuXG5cdCAgICAgICAgaWYgKG5nQXR0ciA9PT0gXCJuZ1BhdHRlcm5cIiAmJiBhdHRyLm5nUGF0dGVybi5jaGFyQXQoMCkgPT0gXCIvXCIpIHtcblx0ICAgICAgICAgIHZhciBtYXRjaCA9IGF0dHIubmdQYXR0ZXJuLm1hdGNoKFJFR0VYX1NUUklOR19SRUdFWFApO1xuXHQgICAgICAgICAgaWYgKG1hdGNoKSB7XG5cdCAgICAgICAgICAgIGF0dHIuJHNldChcIm5nUGF0dGVyblwiLCBuZXcgUmVnRXhwKG1hdGNoWzFdLCBtYXRjaFsyXSkpO1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBzY29wZS4kd2F0Y2goYXR0cltuZ0F0dHJdLCBmdW5jdGlvbiBuZ0F0dHJBbGlhc1dhdGNoQWN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgICBhdHRyLiRzZXQobmdBdHRyLCB2YWx1ZSk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgfTtcblx0fSk7XG5cdFxuXHQvLyBuZy1zcmMsIG5nLXNyY3NldCwgbmctaHJlZiBhcmUgaW50ZXJwb2xhdGVkXG5cdGZvckVhY2goWydzcmMnLCAnc3Jjc2V0JywgJ2hyZWYnXSwgZnVuY3Rpb24oYXR0ck5hbWUpIHtcblx0ICB2YXIgbm9ybWFsaXplZCA9IGRpcmVjdGl2ZU5vcm1hbGl6ZSgnbmctJyArIGF0dHJOYW1lKTtcblx0ICBuZ0F0dHJpYnV0ZUFsaWFzRGlyZWN0aXZlc1tub3JtYWxpemVkXSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgcmV0dXJuIHtcblx0ICAgICAgcHJpb3JpdHk6IDk5LCAvLyBpdCBuZWVkcyB0byBydW4gYWZ0ZXIgdGhlIGF0dHJpYnV0ZXMgYXJlIGludGVycG9sYXRlZFxuXHQgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cikge1xuXHQgICAgICAgIHZhciBwcm9wTmFtZSA9IGF0dHJOYW1lLFxuXHQgICAgICAgICAgICBuYW1lID0gYXR0ck5hbWU7XG5cdFxuXHQgICAgICAgIGlmIChhdHRyTmFtZSA9PT0gJ2hyZWYnICYmXG5cdCAgICAgICAgICAgIHRvU3RyaW5nLmNhbGwoZWxlbWVudC5wcm9wKCdocmVmJykpID09PSAnW29iamVjdCBTVkdBbmltYXRlZFN0cmluZ10nKSB7XG5cdCAgICAgICAgICBuYW1lID0gJ3hsaW5rSHJlZic7XG5cdCAgICAgICAgICBhdHRyLiRhdHRyW25hbWVdID0gJ3hsaW5rOmhyZWYnO1xuXHQgICAgICAgICAgcHJvcE5hbWUgPSBudWxsO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgYXR0ci4kb2JzZXJ2ZShub3JtYWxpemVkLCBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuXHQgICAgICAgICAgICBpZiAoYXR0ck5hbWUgPT09ICdocmVmJykge1xuXHQgICAgICAgICAgICAgIGF0dHIuJHNldChuYW1lLCBudWxsKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgYXR0ci4kc2V0KG5hbWUsIHZhbHVlKTtcblx0XG5cdCAgICAgICAgICAvLyBvbiBJRSwgaWYgXCJuZzpzcmNcIiBkaXJlY3RpdmUgZGVjbGFyYXRpb24gaXMgdXNlZCBhbmQgXCJzcmNcIiBhdHRyaWJ1dGUgZG9lc24ndCBleGlzdFxuXHQgICAgICAgICAgLy8gdGhlbiBjYWxsaW5nIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdzcmMnLCAnZm9vJykgZG9lc24ndCBkbyBhbnl0aGluZywgc28gd2UgbmVlZFxuXHQgICAgICAgICAgLy8gdG8gc2V0IHRoZSBwcm9wZXJ0eSBhcyB3ZWxsIHRvIGFjaGlldmUgdGhlIGRlc2lyZWQgZWZmZWN0LlxuXHQgICAgICAgICAgLy8gd2UgdXNlIGF0dHJbYXR0ck5hbWVdIHZhbHVlIHNpbmNlICRzZXQgY2FuIHNhbml0aXplIHRoZSB1cmwuXG5cdCAgICAgICAgICBpZiAobXNpZSAmJiBwcm9wTmFtZSkgZWxlbWVudC5wcm9wKHByb3BOYW1lLCBhdHRyW25hbWVdKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICB9O1xuXHR9KTtcblx0XG5cdC8qIGdsb2JhbCAtbnVsbEZvcm1DdHJsLCAtU1VCTUlUVEVEX0NMQVNTLCBhZGRTZXRWYWxpZGl0eU1ldGhvZDogdHJ1ZVxuXHQgKi9cblx0dmFyIG51bGxGb3JtQ3RybCA9IHtcblx0ICAkYWRkQ29udHJvbDogbm9vcCxcblx0ICAkJHJlbmFtZUNvbnRyb2w6IG51bGxGb3JtUmVuYW1lQ29udHJvbCxcblx0ICAkcmVtb3ZlQ29udHJvbDogbm9vcCxcblx0ICAkc2V0VmFsaWRpdHk6IG5vb3AsXG5cdCAgJHNldERpcnR5OiBub29wLFxuXHQgICRzZXRQcmlzdGluZTogbm9vcCxcblx0ICAkc2V0U3VibWl0dGVkOiBub29wXG5cdH0sXG5cdFNVQk1JVFRFRF9DTEFTUyA9ICduZy1zdWJtaXR0ZWQnO1xuXHRcblx0ZnVuY3Rpb24gbnVsbEZvcm1SZW5hbWVDb250cm9sKGNvbnRyb2wsIG5hbWUpIHtcblx0ICBjb250cm9sLiRuYW1lID0gbmFtZTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyB0eXBlXG5cdCAqIEBuYW1lIGZvcm0uRm9ybUNvbnRyb2xsZXJcblx0ICpcblx0ICogQHByb3BlcnR5IHtib29sZWFufSAkcHJpc3RpbmUgVHJ1ZSBpZiB1c2VyIGhhcyBub3QgaW50ZXJhY3RlZCB3aXRoIHRoZSBmb3JtIHlldC5cblx0ICogQHByb3BlcnR5IHtib29sZWFufSAkZGlydHkgVHJ1ZSBpZiB1c2VyIGhhcyBhbHJlYWR5IGludGVyYWN0ZWQgd2l0aCB0aGUgZm9ybS5cblx0ICogQHByb3BlcnR5IHtib29sZWFufSAkdmFsaWQgVHJ1ZSBpZiBhbGwgb2YgdGhlIGNvbnRhaW5pbmcgZm9ybXMgYW5kIGNvbnRyb2xzIGFyZSB2YWxpZC5cblx0ICogQHByb3BlcnR5IHtib29sZWFufSAkaW52YWxpZCBUcnVlIGlmIGF0IGxlYXN0IG9uZSBjb250YWluaW5nIGNvbnRyb2wgb3IgZm9ybSBpcyBpbnZhbGlkLlxuXHQgKiBAcHJvcGVydHkge2Jvb2xlYW59ICRwZW5kaW5nIFRydWUgaWYgYXQgbGVhc3Qgb25lIGNvbnRhaW5pbmcgY29udHJvbCBvciBmb3JtIGlzIHBlbmRpbmcuXG5cdCAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gJHN1Ym1pdHRlZCBUcnVlIGlmIHVzZXIgaGFzIHN1Ym1pdHRlZCB0aGUgZm9ybSBldmVuIGlmIGl0cyBpbnZhbGlkLlxuXHQgKlxuXHQgKiBAcHJvcGVydHkge09iamVjdH0gJGVycm9yIElzIGFuIG9iamVjdCBoYXNoLCBjb250YWluaW5nIHJlZmVyZW5jZXMgdG8gY29udHJvbHMgb3Jcblx0ICogIGZvcm1zIHdpdGggZmFpbGluZyB2YWxpZGF0b3JzLCB3aGVyZTpcblx0ICpcblx0ICogIC0ga2V5cyBhcmUgdmFsaWRhdGlvbiB0b2tlbnMgKGVycm9yIG5hbWVzKSxcblx0ICogIC0gdmFsdWVzIGFyZSBhcnJheXMgb2YgY29udHJvbHMgb3IgZm9ybXMgdGhhdCBoYXZlIGEgZmFpbGluZyB2YWxpZGF0b3IgZm9yIGdpdmVuIGVycm9yIG5hbWUuXG5cdCAqXG5cdCAqICBCdWlsdC1pbiB2YWxpZGF0aW9uIHRva2Vuczpcblx0ICpcblx0ICogIC0gYGVtYWlsYFxuXHQgKiAgLSBgbWF4YFxuXHQgKiAgLSBgbWF4bGVuZ3RoYFxuXHQgKiAgLSBgbWluYFxuXHQgKiAgLSBgbWlubGVuZ3RoYFxuXHQgKiAgLSBgbnVtYmVyYFxuXHQgKiAgLSBgcGF0dGVybmBcblx0ICogIC0gYHJlcXVpcmVkYFxuXHQgKiAgLSBgdXJsYFxuXHQgKiAgLSBgZGF0ZWBcblx0ICogIC0gYGRhdGV0aW1lbG9jYWxgXG5cdCAqICAtIGB0aW1lYFxuXHQgKiAgLSBgd2Vla2Bcblx0ICogIC0gYG1vbnRoYFxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogYEZvcm1Db250cm9sbGVyYCBrZWVwcyB0cmFjayBvZiBhbGwgaXRzIGNvbnRyb2xzIGFuZCBuZXN0ZWQgZm9ybXMgYXMgd2VsbCBhcyB0aGUgc3RhdGUgb2YgdGhlbSxcblx0ICogc3VjaCBhcyBiZWluZyB2YWxpZC9pbnZhbGlkIG9yIGRpcnR5L3ByaXN0aW5lLlxuXHQgKlxuXHQgKiBFYWNoIHtAbGluayBuZy5kaXJlY3RpdmU6Zm9ybSBmb3JtfSBkaXJlY3RpdmUgY3JlYXRlcyBhbiBpbnN0YW5jZVxuXHQgKiBvZiBgRm9ybUNvbnRyb2xsZXJgLlxuXHQgKlxuXHQgKi9cblx0Ly9hc2tzIGZvciAkc2NvcGUgdG8gZm9vbCB0aGUgQkMgY29udHJvbGxlciBtb2R1bGVcblx0Rm9ybUNvbnRyb2xsZXIuJGluamVjdCA9IFsnJGVsZW1lbnQnLCAnJGF0dHJzJywgJyRzY29wZScsICckYW5pbWF0ZScsICckaW50ZXJwb2xhdGUnXTtcblx0ZnVuY3Rpb24gRm9ybUNvbnRyb2xsZXIoZWxlbWVudCwgYXR0cnMsICRzY29wZSwgJGFuaW1hdGUsICRpbnRlcnBvbGF0ZSkge1xuXHQgIHZhciBmb3JtID0gdGhpcyxcblx0ICAgICAgY29udHJvbHMgPSBbXTtcblx0XG5cdCAgLy8gaW5pdCBzdGF0ZVxuXHQgIGZvcm0uJGVycm9yID0ge307XG5cdCAgZm9ybS4kJHN1Y2Nlc3MgPSB7fTtcblx0ICBmb3JtLiRwZW5kaW5nID0gdW5kZWZpbmVkO1xuXHQgIGZvcm0uJG5hbWUgPSAkaW50ZXJwb2xhdGUoYXR0cnMubmFtZSB8fCBhdHRycy5uZ0Zvcm0gfHwgJycpKCRzY29wZSk7XG5cdCAgZm9ybS4kZGlydHkgPSBmYWxzZTtcblx0ICBmb3JtLiRwcmlzdGluZSA9IHRydWU7XG5cdCAgZm9ybS4kdmFsaWQgPSB0cnVlO1xuXHQgIGZvcm0uJGludmFsaWQgPSBmYWxzZTtcblx0ICBmb3JtLiRzdWJtaXR0ZWQgPSBmYWxzZTtcblx0ICBmb3JtLiQkcGFyZW50Rm9ybSA9IG51bGxGb3JtQ3RybDtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lIGZvcm0uRm9ybUNvbnRyb2xsZXIjJHJvbGxiYWNrVmlld1ZhbHVlXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBSb2xsYmFjayBhbGwgZm9ybSBjb250cm9scyBwZW5kaW5nIHVwZGF0ZXMgdG8gdGhlIGAkbW9kZWxWYWx1ZWAuXG5cdCAgICpcblx0ICAgKiBVcGRhdGVzIG1heSBiZSBwZW5kaW5nIGJ5IGEgZGVib3VuY2VkIGV2ZW50IG9yIGJlY2F1c2UgdGhlIGlucHV0IGlzIHdhaXRpbmcgZm9yIGEgc29tZSBmdXR1cmVcblx0ICAgKiBldmVudCBkZWZpbmVkIGluIGBuZy1tb2RlbC1vcHRpb25zYC4gVGhpcyBtZXRob2QgaXMgdHlwaWNhbGx5IG5lZWRlZCBieSB0aGUgcmVzZXQgYnV0dG9uIG9mXG5cdCAgICogYSBmb3JtIHRoYXQgdXNlcyBgbmctbW9kZWwtb3B0aW9uc2AgdG8gcGVuZCB1cGRhdGVzLlxuXHQgICAqL1xuXHQgIGZvcm0uJHJvbGxiYWNrVmlld1ZhbHVlID0gZnVuY3Rpb24oKSB7XG5cdCAgICBmb3JFYWNoKGNvbnRyb2xzLCBmdW5jdGlvbihjb250cm9sKSB7XG5cdCAgICAgIGNvbnRyb2wuJHJvbGxiYWNrVmlld1ZhbHVlKCk7XG5cdCAgICB9KTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgZm9ybS5Gb3JtQ29udHJvbGxlciMkY29tbWl0Vmlld1ZhbHVlXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBDb21taXQgYWxsIGZvcm0gY29udHJvbHMgcGVuZGluZyB1cGRhdGVzIHRvIHRoZSBgJG1vZGVsVmFsdWVgLlxuXHQgICAqXG5cdCAgICogVXBkYXRlcyBtYXkgYmUgcGVuZGluZyBieSBhIGRlYm91bmNlZCBldmVudCBvciBiZWNhdXNlIHRoZSBpbnB1dCBpcyB3YWl0aW5nIGZvciBhIHNvbWUgZnV0dXJlXG5cdCAgICogZXZlbnQgZGVmaW5lZCBpbiBgbmctbW9kZWwtb3B0aW9uc2AuIFRoaXMgbWV0aG9kIGlzIHJhcmVseSBuZWVkZWQgYXMgYE5nTW9kZWxDb250cm9sbGVyYFxuXHQgICAqIHVzdWFsbHkgaGFuZGxlcyBjYWxsaW5nIHRoaXMgaW4gcmVzcG9uc2UgdG8gaW5wdXQgZXZlbnRzLlxuXHQgICAqL1xuXHQgIGZvcm0uJGNvbW1pdFZpZXdWYWx1ZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgZm9yRWFjaChjb250cm9scywgZnVuY3Rpb24oY29udHJvbCkge1xuXHQgICAgICBjb250cm9sLiRjb21taXRWaWV3VmFsdWUoKTtcblx0ICAgIH0pO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSBmb3JtLkZvcm1Db250cm9sbGVyIyRhZGRDb250cm9sXG5cdCAgICogQHBhcmFtIHtvYmplY3R9IGNvbnRyb2wgY29udHJvbCBvYmplY3QsIGVpdGhlciBhIHtAbGluayBmb3JtLkZvcm1Db250cm9sbGVyfSBvciBhblxuXHQgICAqIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyfVxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogUmVnaXN0ZXIgYSBjb250cm9sIHdpdGggdGhlIGZvcm0uIElucHV0IGVsZW1lbnRzIHVzaW5nIG5nTW9kZWxDb250cm9sbGVyIGRvIHRoaXMgYXV0b21hdGljYWxseVxuXHQgICAqIHdoZW4gdGhleSBhcmUgbGlua2VkLlxuXHQgICAqXG5cdCAgICogTm90ZSB0aGF0IHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBjb250cm9sIHdpbGwgbm90IGJlIHJlZmxlY3RlZCBvbiB0aGUgbmV3IHBhcmVudCBmb3JtLiBUaGlzXG5cdCAgICogaXMgbm90IGFuIGlzc3VlIHdpdGggbm9ybWFsIHVzZSwgYXMgZnJlc2hseSBjb21waWxlZCBhbmQgbGlua2VkIGNvbnRyb2xzIGFyZSBpbiBhIGAkcHJpc3RpbmVgXG5cdCAgICogc3RhdGUuXG5cdCAgICpcblx0ICAgKiBIb3dldmVyLCBpZiB0aGUgbWV0aG9kIGlzIHVzZWQgcHJvZ3JhbW1hdGljYWxseSwgZm9yIGV4YW1wbGUgYnkgYWRkaW5nIGR5bmFtaWNhbGx5IGNyZWF0ZWQgY29udHJvbHMsXG5cdCAgICogb3IgY29udHJvbHMgdGhhdCBoYXZlIGJlZW4gcHJldmlvdXNseSByZW1vdmVkIHdpdGhvdXQgZGVzdHJveWluZyB0aGVpciBjb3JyZXNwb25kaW5nIERPTSBlbGVtZW50LFxuXHQgICAqIGl0J3MgdGhlIGRldmVsb3BlcnMgcmVzcG9uc2liaWxpdHkgdG8gbWFrZSBzdXJlIHRoZSBjdXJyZW50IHN0YXRlIHByb3BhZ2F0ZXMgdG8gdGhlIHBhcmVudCBmb3JtLlxuXHQgICAqXG5cdCAgICogRm9yIGV4YW1wbGUsIGlmIGFuIGlucHV0IGNvbnRyb2wgaXMgYWRkZWQgdGhhdCBpcyBhbHJlYWR5IGAkZGlydHlgIGFuZCBoYXMgYCRlcnJvcmAgcHJvcGVydGllcyxcblx0ICAgKiBjYWxsaW5nIGAkc2V0RGlydHkoKWAgYW5kIGAkdmFsaWRhdGUoKWAgYWZ0ZXJ3YXJkcyB3aWxsIHByb3BhZ2F0ZSB0aGUgc3RhdGUgdG8gdGhlIHBhcmVudCBmb3JtLlxuXHQgICAqL1xuXHQgIGZvcm0uJGFkZENvbnRyb2wgPSBmdW5jdGlvbihjb250cm9sKSB7XG5cdCAgICAvLyBCcmVha2luZyBjaGFuZ2UgLSBiZWZvcmUsIGlucHV0cyB3aG9zZSBuYW1lIHdhcyBcImhhc093blByb3BlcnR5XCIgd2VyZSBxdWlldGx5IGlnbm9yZWRcblx0ICAgIC8vIGFuZCBub3QgYWRkZWQgdG8gdGhlIHNjb3BlLiAgTm93IHdlIHRocm93IGFuIGVycm9yLlxuXHQgICAgYXNzZXJ0Tm90SGFzT3duUHJvcGVydHkoY29udHJvbC4kbmFtZSwgJ2lucHV0Jyk7XG5cdCAgICBjb250cm9scy5wdXNoKGNvbnRyb2wpO1xuXHRcblx0ICAgIGlmIChjb250cm9sLiRuYW1lKSB7XG5cdCAgICAgIGZvcm1bY29udHJvbC4kbmFtZV0gPSBjb250cm9sO1xuXHQgICAgfVxuXHRcblx0ICAgIGNvbnRyb2wuJCRwYXJlbnRGb3JtID0gZm9ybTtcblx0ICB9O1xuXHRcblx0ICAvLyBQcml2YXRlIEFQSTogcmVuYW1lIGEgZm9ybSBjb250cm9sXG5cdCAgZm9ybS4kJHJlbmFtZUNvbnRyb2wgPSBmdW5jdGlvbihjb250cm9sLCBuZXdOYW1lKSB7XG5cdCAgICB2YXIgb2xkTmFtZSA9IGNvbnRyb2wuJG5hbWU7XG5cdFxuXHQgICAgaWYgKGZvcm1bb2xkTmFtZV0gPT09IGNvbnRyb2wpIHtcblx0ICAgICAgZGVsZXRlIGZvcm1bb2xkTmFtZV07XG5cdCAgICB9XG5cdCAgICBmb3JtW25ld05hbWVdID0gY29udHJvbDtcblx0ICAgIGNvbnRyb2wuJG5hbWUgPSBuZXdOYW1lO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSBmb3JtLkZvcm1Db250cm9sbGVyIyRyZW1vdmVDb250cm9sXG5cdCAgICogQHBhcmFtIHtvYmplY3R9IGNvbnRyb2wgY29udHJvbCBvYmplY3QsIGVpdGhlciBhIHtAbGluayBmb3JtLkZvcm1Db250cm9sbGVyfSBvciBhblxuXHQgICAqIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyfVxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogRGVyZWdpc3RlciBhIGNvbnRyb2wgZnJvbSB0aGUgZm9ybS5cblx0ICAgKlxuXHQgICAqIElucHV0IGVsZW1lbnRzIHVzaW5nIG5nTW9kZWxDb250cm9sbGVyIGRvIHRoaXMgYXV0b21hdGljYWxseSB3aGVuIHRoZXkgYXJlIGRlc3Ryb3llZC5cblx0ICAgKlxuXHQgICAqIE5vdGUgdGhhdCBvbmx5IHRoZSByZW1vdmVkIGNvbnRyb2wncyB2YWxpZGF0aW9uIHN0YXRlIChgJGVycm9yc2BldGMuKSB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGVcblx0ICAgKiBmb3JtLiBgJGRpcnR5YCwgYCRzdWJtaXR0ZWRgIHN0YXRlcyB3aWxsIG5vdCBiZSBjaGFuZ2VkLCBiZWNhdXNlIHRoZSBleHBlY3RlZCBiZWhhdmlvciBjYW4gYmVcblx0ICAgKiBkaWZmZXJlbnQgZnJvbSBjYXNlIHRvIGNhc2UuIEZvciBleGFtcGxlLCByZW1vdmluZyB0aGUgb25seSBgJGRpcnR5YCBjb250cm9sIGZyb20gYSBmb3JtIG1heSBvclxuXHQgICAqIG1heSBub3QgbWVhbiB0aGF0IHRoZSBmb3JtIGlzIHN0aWxsIGAkZGlydHlgLlxuXHQgICAqL1xuXHQgIGZvcm0uJHJlbW92ZUNvbnRyb2wgPSBmdW5jdGlvbihjb250cm9sKSB7XG5cdCAgICBpZiAoY29udHJvbC4kbmFtZSAmJiBmb3JtW2NvbnRyb2wuJG5hbWVdID09PSBjb250cm9sKSB7XG5cdCAgICAgIGRlbGV0ZSBmb3JtW2NvbnRyb2wuJG5hbWVdO1xuXHQgICAgfVxuXHQgICAgZm9yRWFjaChmb3JtLiRwZW5kaW5nLCBmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuXHQgICAgICBmb3JtLiRzZXRWYWxpZGl0eShuYW1lLCBudWxsLCBjb250cm9sKTtcblx0ICAgIH0pO1xuXHQgICAgZm9yRWFjaChmb3JtLiRlcnJvciwgZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcblx0ICAgICAgZm9ybS4kc2V0VmFsaWRpdHkobmFtZSwgbnVsbCwgY29udHJvbCk7XG5cdCAgICB9KTtcblx0ICAgIGZvckVhY2goZm9ybS4kJHN1Y2Nlc3MsIGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG5cdCAgICAgIGZvcm0uJHNldFZhbGlkaXR5KG5hbWUsIG51bGwsIGNvbnRyb2wpO1xuXHQgICAgfSk7XG5cdFxuXHQgICAgYXJyYXlSZW1vdmUoY29udHJvbHMsIGNvbnRyb2wpO1xuXHQgICAgY29udHJvbC4kJHBhcmVudEZvcm0gPSBudWxsRm9ybUN0cmw7XG5cdCAgfTtcblx0XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSBmb3JtLkZvcm1Db250cm9sbGVyIyRzZXRWYWxpZGl0eVxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogU2V0cyB0aGUgdmFsaWRpdHkgb2YgYSBmb3JtIGNvbnRyb2wuXG5cdCAgICpcblx0ICAgKiBUaGlzIG1ldGhvZCB3aWxsIGFsc28gcHJvcGFnYXRlIHRvIHBhcmVudCBmb3Jtcy5cblx0ICAgKi9cblx0ICBhZGRTZXRWYWxpZGl0eU1ldGhvZCh7XG5cdCAgICBjdHJsOiB0aGlzLFxuXHQgICAgJGVsZW1lbnQ6IGVsZW1lbnQsXG5cdCAgICBzZXQ6IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHksIGNvbnRyb2xsZXIpIHtcblx0ICAgICAgdmFyIGxpc3QgPSBvYmplY3RbcHJvcGVydHldO1xuXHQgICAgICBpZiAoIWxpc3QpIHtcblx0ICAgICAgICBvYmplY3RbcHJvcGVydHldID0gW2NvbnRyb2xsZXJdO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHZhciBpbmRleCA9IGxpc3QuaW5kZXhPZihjb250cm9sbGVyKTtcblx0ICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG5cdCAgICAgICAgICBsaXN0LnB1c2goY29udHJvbGxlcik7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9LFxuXHQgICAgdW5zZXQ6IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHksIGNvbnRyb2xsZXIpIHtcblx0ICAgICAgdmFyIGxpc3QgPSBvYmplY3RbcHJvcGVydHldO1xuXHQgICAgICBpZiAoIWxpc3QpIHtcblx0ICAgICAgICByZXR1cm47XG5cdCAgICAgIH1cblx0ICAgICAgYXJyYXlSZW1vdmUobGlzdCwgY29udHJvbGxlcik7XG5cdCAgICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMCkge1xuXHQgICAgICAgIGRlbGV0ZSBvYmplY3RbcHJvcGVydHldO1xuXHQgICAgICB9XG5cdCAgICB9LFxuXHQgICAgJGFuaW1hdGU6ICRhbmltYXRlXG5cdCAgfSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSBmb3JtLkZvcm1Db250cm9sbGVyIyRzZXREaXJ0eVxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogU2V0cyB0aGUgZm9ybSB0byBhIGRpcnR5IHN0YXRlLlxuXHQgICAqXG5cdCAgICogVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byBhZGQgdGhlICduZy1kaXJ0eScgY2xhc3MgYW5kIHNldCB0aGUgZm9ybSB0byBhIGRpcnR5XG5cdCAgICogc3RhdGUgKG5nLWRpcnR5IGNsYXNzKS4gVGhpcyBtZXRob2Qgd2lsbCBhbHNvIHByb3BhZ2F0ZSB0byBwYXJlbnQgZm9ybXMuXG5cdCAgICovXG5cdCAgZm9ybS4kc2V0RGlydHkgPSBmdW5jdGlvbigpIHtcblx0ICAgICRhbmltYXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIFBSSVNUSU5FX0NMQVNTKTtcblx0ICAgICRhbmltYXRlLmFkZENsYXNzKGVsZW1lbnQsIERJUlRZX0NMQVNTKTtcblx0ICAgIGZvcm0uJGRpcnR5ID0gdHJ1ZTtcblx0ICAgIGZvcm0uJHByaXN0aW5lID0gZmFsc2U7XG5cdCAgICBmb3JtLiQkcGFyZW50Rm9ybS4kc2V0RGlydHkoKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgZm9ybS5Gb3JtQ29udHJvbGxlciMkc2V0UHJpc3RpbmVcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFNldHMgdGhlIGZvcm0gdG8gaXRzIHByaXN0aW5lIHN0YXRlLlxuXHQgICAqXG5cdCAgICogVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byByZW1vdmUgdGhlICduZy1kaXJ0eScgY2xhc3MgYW5kIHNldCB0aGUgZm9ybSB0byBpdHMgcHJpc3RpbmVcblx0ICAgKiBzdGF0ZSAobmctcHJpc3RpbmUgY2xhc3MpLiBUaGlzIG1ldGhvZCB3aWxsIGFsc28gcHJvcGFnYXRlIHRvIGFsbCB0aGUgY29udHJvbHMgY29udGFpbmVkXG5cdCAgICogaW4gdGhpcyBmb3JtLlxuXHQgICAqXG5cdCAgICogU2V0dGluZyBhIGZvcm0gYmFjayB0byBhIHByaXN0aW5lIHN0YXRlIGlzIG9mdGVuIHVzZWZ1bCB3aGVuIHdlIHdhbnQgdG8gJ3JldXNlJyBhIGZvcm0gYWZ0ZXJcblx0ICAgKiBzYXZpbmcgb3IgcmVzZXR0aW5nIGl0LlxuXHQgICAqL1xuXHQgIGZvcm0uJHNldFByaXN0aW5lID0gZnVuY3Rpb24oKSB7XG5cdCAgICAkYW5pbWF0ZS5zZXRDbGFzcyhlbGVtZW50LCBQUklTVElORV9DTEFTUywgRElSVFlfQ0xBU1MgKyAnICcgKyBTVUJNSVRURURfQ0xBU1MpO1xuXHQgICAgZm9ybS4kZGlydHkgPSBmYWxzZTtcblx0ICAgIGZvcm0uJHByaXN0aW5lID0gdHJ1ZTtcblx0ICAgIGZvcm0uJHN1Ym1pdHRlZCA9IGZhbHNlO1xuXHQgICAgZm9yRWFjaChjb250cm9scywgZnVuY3Rpb24oY29udHJvbCkge1xuXHQgICAgICBjb250cm9sLiRzZXRQcmlzdGluZSgpO1xuXHQgICAgfSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lIGZvcm0uRm9ybUNvbnRyb2xsZXIjJHNldFVudG91Y2hlZFxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogU2V0cyB0aGUgZm9ybSB0byBpdHMgdW50b3VjaGVkIHN0YXRlLlxuXHQgICAqXG5cdCAgICogVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byByZW1vdmUgdGhlICduZy10b3VjaGVkJyBjbGFzcyBhbmQgc2V0IHRoZSBmb3JtIGNvbnRyb2xzIHRvIHRoZWlyXG5cdCAgICogdW50b3VjaGVkIHN0YXRlIChuZy11bnRvdWNoZWQgY2xhc3MpLlxuXHQgICAqXG5cdCAgICogU2V0dGluZyBhIGZvcm0gY29udHJvbHMgYmFjayB0byB0aGVpciB1bnRvdWNoZWQgc3RhdGUgaXMgb2Z0ZW4gdXNlZnVsIHdoZW4gc2V0dGluZyB0aGUgZm9ybVxuXHQgICAqIGJhY2sgdG8gaXRzIHByaXN0aW5lIHN0YXRlLlxuXHQgICAqL1xuXHQgIGZvcm0uJHNldFVudG91Y2hlZCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgZm9yRWFjaChjb250cm9scywgZnVuY3Rpb24oY29udHJvbCkge1xuXHQgICAgICBjb250cm9sLiRzZXRVbnRvdWNoZWQoKTtcblx0ICAgIH0pO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSBmb3JtLkZvcm1Db250cm9sbGVyIyRzZXRTdWJtaXR0ZWRcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFNldHMgdGhlIGZvcm0gdG8gaXRzIHN1Ym1pdHRlZCBzdGF0ZS5cblx0ICAgKi9cblx0ICBmb3JtLiRzZXRTdWJtaXR0ZWQgPSBmdW5jdGlvbigpIHtcblx0ICAgICRhbmltYXRlLmFkZENsYXNzKGVsZW1lbnQsIFNVQk1JVFRFRF9DTEFTUyk7XG5cdCAgICBmb3JtLiRzdWJtaXR0ZWQgPSB0cnVlO1xuXHQgICAgZm9ybS4kJHBhcmVudEZvcm0uJHNldFN1Ym1pdHRlZCgpO1xuXHQgIH07XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIG5nRm9ybVxuXHQgKiBAcmVzdHJpY3QgRUFDXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBOZXN0YWJsZSBhbGlhcyBvZiB7QGxpbmsgbmcuZGlyZWN0aXZlOmZvcm0gYGZvcm1gfSBkaXJlY3RpdmUuIEhUTUxcblx0ICogZG9lcyBub3QgYWxsb3cgbmVzdGluZyBvZiBmb3JtIGVsZW1lbnRzLiBJdCBpcyB1c2VmdWwgdG8gbmVzdCBmb3JtcywgZm9yIGV4YW1wbGUgaWYgdGhlIHZhbGlkaXR5IG9mIGFcblx0ICogc3ViLWdyb3VwIG9mIGNvbnRyb2xzIG5lZWRzIHRvIGJlIGRldGVybWluZWQuXG5cdCAqXG5cdCAqIE5vdGU6IHRoZSBwdXJwb3NlIG9mIGBuZ0Zvcm1gIGlzIHRvIGdyb3VwIGNvbnRyb2xzLFxuXHQgKiBidXQgbm90IHRvIGJlIGEgcmVwbGFjZW1lbnQgZm9yIHRoZSBgPGZvcm0+YCB0YWcgd2l0aCBhbGwgb2YgaXRzIGNhcGFiaWxpdGllc1xuXHQgKiAoZS5nLiBwb3N0aW5nIHRvIHRoZSBzZXJ2ZXIsIC4uLikuXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nPX0gbmdGb3JtfG5hbWUgTmFtZSBvZiB0aGUgZm9ybS4gSWYgc3BlY2lmaWVkLCB0aGUgZm9ybSBjb250cm9sbGVyIHdpbGwgYmUgcHVibGlzaGVkIGludG9cblx0ICogICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWQgc2NvcGUsIHVuZGVyIHRoaXMgbmFtZS5cblx0ICpcblx0ICovXG5cdFxuXHQgLyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgZm9ybVxuXHQgKiBAcmVzdHJpY3QgRVxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogRGlyZWN0aXZlIHRoYXQgaW5zdGFudGlhdGVzXG5cdCAqIHtAbGluayBmb3JtLkZvcm1Db250cm9sbGVyIEZvcm1Db250cm9sbGVyfS5cblx0ICpcblx0ICogSWYgdGhlIGBuYW1lYCBhdHRyaWJ1dGUgaXMgc3BlY2lmaWVkLCB0aGUgZm9ybSBjb250cm9sbGVyIGlzIHB1Ymxpc2hlZCBvbnRvIHRoZSBjdXJyZW50IHNjb3BlIHVuZGVyXG5cdCAqIHRoaXMgbmFtZS5cblx0ICpcblx0ICogIyBBbGlhczoge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0Zvcm0gYG5nRm9ybWB9XG5cdCAqXG5cdCAqIEluIEFuZ3VsYXIsIGZvcm1zIGNhbiBiZSBuZXN0ZWQuIFRoaXMgbWVhbnMgdGhhdCB0aGUgb3V0ZXIgZm9ybSBpcyB2YWxpZCB3aGVuIGFsbCBvZiB0aGUgY2hpbGRcblx0ICogZm9ybXMgYXJlIHZhbGlkIGFzIHdlbGwuIEhvd2V2ZXIsIGJyb3dzZXJzIGRvIG5vdCBhbGxvdyBuZXN0aW5nIG9mIGA8Zm9ybT5gIGVsZW1lbnRzLCBzb1xuXHQgKiBBbmd1bGFyIHByb3ZpZGVzIHRoZSB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nRm9ybSBgbmdGb3JtYH0gZGlyZWN0aXZlLCB3aGljaCBiZWhhdmVzIGlkZW50aWNhbGx5IHRvXG5cdCAqIGBmb3JtYCBidXQgY2FuIGJlIG5lc3RlZC4gTmVzdGVkIGZvcm1zIGNhbiBiZSB1c2VmdWwsIGZvciBleGFtcGxlLCBpZiB0aGUgdmFsaWRpdHkgb2YgYSBzdWItZ3JvdXBcblx0ICogb2YgY29udHJvbHMgbmVlZHMgdG8gYmUgZGV0ZXJtaW5lZC5cblx0ICpcblx0ICogIyBDU1MgY2xhc3Nlc1xuXHQgKiAgLSBgbmctdmFsaWRgIGlzIHNldCBpZiB0aGUgZm9ybSBpcyB2YWxpZC5cblx0ICogIC0gYG5nLWludmFsaWRgIGlzIHNldCBpZiB0aGUgZm9ybSBpcyBpbnZhbGlkLlxuXHQgKiAgLSBgbmctcGVuZGluZ2AgaXMgc2V0IGlmIHRoZSBmb3JtIGlzIHBlbmRpbmcuXG5cdCAqICAtIGBuZy1wcmlzdGluZWAgaXMgc2V0IGlmIHRoZSBmb3JtIGlzIHByaXN0aW5lLlxuXHQgKiAgLSBgbmctZGlydHlgIGlzIHNldCBpZiB0aGUgZm9ybSBpcyBkaXJ0eS5cblx0ICogIC0gYG5nLXN1Ym1pdHRlZGAgaXMgc2V0IGlmIHRoZSBmb3JtIHdhcyBzdWJtaXR0ZWQuXG5cdCAqXG5cdCAqIEtlZXAgaW4gbWluZCB0aGF0IG5nQW5pbWF0ZSBjYW4gZGV0ZWN0IGVhY2ggb2YgdGhlc2UgY2xhc3NlcyB3aGVuIGFkZGVkIGFuZCByZW1vdmVkLlxuXHQgKlxuXHQgKlxuXHQgKiAjIFN1Ym1pdHRpbmcgYSBmb3JtIGFuZCBwcmV2ZW50aW5nIHRoZSBkZWZhdWx0IGFjdGlvblxuXHQgKlxuXHQgKiBTaW5jZSB0aGUgcm9sZSBvZiBmb3JtcyBpbiBjbGllbnQtc2lkZSBBbmd1bGFyIGFwcGxpY2F0aW9ucyBpcyBkaWZmZXJlbnQgdGhhbiBpbiBjbGFzc2ljYWxcblx0ICogcm91bmR0cmlwIGFwcHMsIGl0IGlzIGRlc2lyYWJsZSBmb3IgdGhlIGJyb3dzZXIgbm90IHRvIHRyYW5zbGF0ZSB0aGUgZm9ybSBzdWJtaXNzaW9uIGludG8gYSBmdWxsXG5cdCAqIHBhZ2UgcmVsb2FkIHRoYXQgc2VuZHMgdGhlIGRhdGEgdG8gdGhlIHNlcnZlci4gSW5zdGVhZCBzb21lIGphdmFzY3JpcHQgbG9naWMgc2hvdWxkIGJlIHRyaWdnZXJlZFxuXHQgKiB0byBoYW5kbGUgdGhlIGZvcm0gc3VibWlzc2lvbiBpbiBhbiBhcHBsaWNhdGlvbi1zcGVjaWZpYyB3YXkuXG5cdCAqXG5cdCAqIEZvciB0aGlzIHJlYXNvbiwgQW5ndWxhciBwcmV2ZW50cyB0aGUgZGVmYXVsdCBhY3Rpb24gKGZvcm0gc3VibWlzc2lvbiB0byB0aGUgc2VydmVyKSB1bmxlc3MgdGhlXG5cdCAqIGA8Zm9ybT5gIGVsZW1lbnQgaGFzIGFuIGBhY3Rpb25gIGF0dHJpYnV0ZSBzcGVjaWZpZWQuXG5cdCAqXG5cdCAqIFlvdSBjYW4gdXNlIG9uZSBvZiB0aGUgZm9sbG93aW5nIHR3byB3YXlzIHRvIHNwZWNpZnkgd2hhdCBqYXZhc2NyaXB0IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkIHdoZW5cblx0ICogYSBmb3JtIGlzIHN1Ym1pdHRlZDpcblx0ICpcblx0ICogLSB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nU3VibWl0IG5nU3VibWl0fSBkaXJlY3RpdmUgb24gdGhlIGZvcm0gZWxlbWVudFxuXHQgKiAtIHtAbGluayBuZy5kaXJlY3RpdmU6bmdDbGljayBuZ0NsaWNrfSBkaXJlY3RpdmUgb24gdGhlIGZpcnN0XG5cdCAgKiAgYnV0dG9uIG9yIGlucHV0IGZpZWxkIG9mIHR5cGUgc3VibWl0IChpbnB1dFt0eXBlPXN1Ym1pdF0pXG5cdCAqXG5cdCAqIFRvIHByZXZlbnQgZG91YmxlIGV4ZWN1dGlvbiBvZiB0aGUgaGFuZGxlciwgdXNlIG9ubHkgb25lIG9mIHRoZSB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nU3VibWl0IG5nU3VibWl0fVxuXHQgKiBvciB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nQ2xpY2sgbmdDbGlja30gZGlyZWN0aXZlcy5cblx0ICogVGhpcyBpcyBiZWNhdXNlIG9mIHRoZSBmb2xsb3dpbmcgZm9ybSBzdWJtaXNzaW9uIHJ1bGVzIGluIHRoZSBIVE1MIHNwZWNpZmljYXRpb246XG5cdCAqXG5cdCAqIC0gSWYgYSBmb3JtIGhhcyBvbmx5IG9uZSBpbnB1dCBmaWVsZCB0aGVuIGhpdHRpbmcgZW50ZXIgaW4gdGhpcyBmaWVsZCB0cmlnZ2VycyBmb3JtIHN1Ym1pdFxuXHQgKiAoYG5nU3VibWl0YClcblx0ICogLSBpZiBhIGZvcm0gaGFzIDIrIGlucHV0IGZpZWxkcyBhbmQgbm8gYnV0dG9ucyBvciBpbnB1dFt0eXBlPXN1Ym1pdF0gdGhlbiBoaXR0aW5nIGVudGVyXG5cdCAqIGRvZXNuJ3QgdHJpZ2dlciBzdWJtaXRcblx0ICogLSBpZiBhIGZvcm0gaGFzIG9uZSBvciBtb3JlIGlucHV0IGZpZWxkcyBhbmQgb25lIG9yIG1vcmUgYnV0dG9ucyBvciBpbnB1dFt0eXBlPXN1Ym1pdF0gdGhlblxuXHQgKiBoaXR0aW5nIGVudGVyIGluIGFueSBvZiB0aGUgaW5wdXQgZmllbGRzIHdpbGwgdHJpZ2dlciB0aGUgY2xpY2sgaGFuZGxlciBvbiB0aGUgKmZpcnN0KiBidXR0b24gb3Jcblx0ICogaW5wdXRbdHlwZT1zdWJtaXRdIChgbmdDbGlja2ApICphbmQqIGEgc3VibWl0IGhhbmRsZXIgb24gdGhlIGVuY2xvc2luZyBmb3JtIChgbmdTdWJtaXRgKVxuXHQgKlxuXHQgKiBBbnkgcGVuZGluZyBgbmdNb2RlbE9wdGlvbnNgIGNoYW5nZXMgd2lsbCB0YWtlIHBsYWNlIGltbWVkaWF0ZWx5IHdoZW4gYW4gZW5jbG9zaW5nIGZvcm0gaXNcblx0ICogc3VibWl0dGVkLiBOb3RlIHRoYXQgYG5nQ2xpY2tgIGV2ZW50cyB3aWxsIG9jY3VyIGJlZm9yZSB0aGUgbW9kZWwgaXMgdXBkYXRlZC4gVXNlIGBuZ1N1Ym1pdGBcblx0ICogdG8gaGF2ZSBhY2Nlc3MgdG8gdGhlIHVwZGF0ZWQgbW9kZWwuXG5cdCAqXG5cdCAqICMjIEFuaW1hdGlvbiBIb29rc1xuXHQgKlxuXHQgKiBBbmltYXRpb25zIGluIG5nRm9ybSBhcmUgdHJpZ2dlcmVkIHdoZW4gYW55IG9mIHRoZSBhc3NvY2lhdGVkIENTUyBjbGFzc2VzIGFyZSBhZGRlZCBhbmQgcmVtb3ZlZC5cblx0ICogVGhlc2UgY2xhc3NlcyBhcmU6IGAubmctcHJpc3RpbmVgLCBgLm5nLWRpcnR5YCwgYC5uZy1pbnZhbGlkYCBhbmQgYC5uZy12YWxpZGAgYXMgd2VsbCBhcyBhbnlcblx0ICogb3RoZXIgdmFsaWRhdGlvbnMgdGhhdCBhcmUgcGVyZm9ybWVkIHdpdGhpbiB0aGUgZm9ybS4gQW5pbWF0aW9ucyBpbiBuZ0Zvcm0gYXJlIHNpbWlsYXIgdG8gaG93XG5cdCAqIHRoZXkgd29yayBpbiBuZ0NsYXNzIGFuZCBhbmltYXRpb25zIGNhbiBiZSBob29rZWQgaW50byB1c2luZyBDU1MgdHJhbnNpdGlvbnMsIGtleWZyYW1lcyBhcyB3ZWxsXG5cdCAqIGFzIEpTIGFuaW1hdGlvbnMuXG5cdCAqXG5cdCAqIFRoZSBmb2xsb3dpbmcgZXhhbXBsZSBzaG93cyBhIHNpbXBsZSB3YXkgdG8gdXRpbGl6ZSBDU1MgdHJhbnNpdGlvbnMgdG8gc3R5bGUgYSBmb3JtIGVsZW1lbnRcblx0ICogdGhhdCBoYXMgYmVlbiByZW5kZXJlZCBhcyBpbnZhbGlkIGFmdGVyIGl0IGhhcyBiZWVuIHZhbGlkYXRlZDpcblx0ICpcblx0ICogPHByZT5cblx0ICogLy9iZSBzdXJlIHRvIGluY2x1ZGUgbmdBbmltYXRlIGFzIGEgbW9kdWxlIHRvIGhvb2sgaW50byBtb3JlXG5cdCAqIC8vYWR2YW5jZWQgYW5pbWF0aW9uc1xuXHQgKiAubXktZm9ybSB7XG5cdCAqICAgdHJhbnNpdGlvbjowLjVzIGxpbmVhciBhbGw7XG5cdCAqICAgYmFja2dyb3VuZDogd2hpdGU7XG5cdCAqIH1cblx0ICogLm15LWZvcm0ubmctaW52YWxpZCB7XG5cdCAqICAgYmFja2dyb3VuZDogcmVkO1xuXHQgKiAgIGNvbG9yOndoaXRlO1xuXHQgKiB9XG5cdCAqIDwvcHJlPlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICAgPGV4YW1wbGUgZGVwcz1cImFuZ3VsYXItYW5pbWF0ZS5qc1wiIGFuaW1hdGlvbnM9XCJ0cnVlXCIgZml4QmFzZT1cInRydWVcIiBtb2R1bGU9XCJmb3JtRXhhbXBsZVwiPlxuXHQgICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgPHNjcmlwdD5cblx0ICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2Zvcm1FeGFtcGxlJywgW10pXG5cdCAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0Zvcm1Db250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICAgICRzY29wZS51c2VyVHlwZSA9ICdndWVzdCc7XG5cdCAgICAgICAgICAgfV0pO1xuXHQgICAgICAgPC9zY3JpcHQ+XG5cdCAgICAgICA8c3R5bGU+XG5cdCAgICAgICAgLm15LWZvcm0ge1xuXHQgICAgICAgICAgdHJhbnNpdGlvbjphbGwgbGluZWFyIDAuNXM7XG5cdCAgICAgICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgLm15LWZvcm0ubmctaW52YWxpZCB7XG5cdCAgICAgICAgICBiYWNrZ3JvdW5kOiByZWQ7XG5cdCAgICAgICAgfVxuXHQgICAgICAgPC9zdHlsZT5cblx0ICAgICAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIiBuZy1jb250cm9sbGVyPVwiRm9ybUNvbnRyb2xsZXJcIiBjbGFzcz1cIm15LWZvcm1cIj5cblx0ICAgICAgICAgdXNlclR5cGU6IDxpbnB1dCBuYW1lPVwiaW5wdXRcIiBuZy1tb2RlbD1cInVzZXJUeXBlXCIgcmVxdWlyZWQ+XG5cdCAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5yZXF1aXJlZFwiPlJlcXVpcmVkITwvc3Bhbj48YnI+XG5cdCAgICAgICAgIDxjb2RlPnVzZXJUeXBlID0ge3t1c2VyVHlwZX19PC9jb2RlPjxicj5cblx0ICAgICAgICAgPGNvZGU+bXlGb3JtLmlucHV0LiR2YWxpZCA9IHt7bXlGb3JtLmlucHV0LiR2YWxpZH19PC9jb2RlPjxicj5cblx0ICAgICAgICAgPGNvZGU+bXlGb3JtLmlucHV0LiRlcnJvciA9IHt7bXlGb3JtLmlucHV0LiRlcnJvcn19PC9jb2RlPjxicj5cblx0ICAgICAgICAgPGNvZGU+bXlGb3JtLiR2YWxpZCA9IHt7bXlGb3JtLiR2YWxpZH19PC9jb2RlPjxicj5cblx0ICAgICAgICAgPGNvZGU+bXlGb3JtLiRlcnJvci5yZXF1aXJlZCA9IHt7ISFteUZvcm0uJGVycm9yLnJlcXVpcmVkfX08L2NvZGU+PGJyPlxuXHQgICAgICAgIDwvZm9ybT5cblx0ICAgICAgPC9maWxlPlxuXHQgICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICB2YXIgdXNlclR5cGUgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ3VzZXJUeXBlJykpO1xuXHQgICAgICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuXHRcblx0ICAgICAgICAgIGV4cGVjdCh1c2VyVHlwZS5nZXRUZXh0KCkpLnRvQ29udGFpbignZ3Vlc3QnKTtcblx0ICAgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbigndHJ1ZScpO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgZW1wdHknLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHZhciB1c2VyVHlwZSA9IGVsZW1lbnQoYnkuYmluZGluZygndXNlclR5cGUnKSk7XG5cdCAgICAgICAgICB2YXIgdmFsaWQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ215Rm9ybS5pbnB1dC4kdmFsaWQnKSk7XG5cdCAgICAgICAgICB2YXIgdXNlcklucHV0ID0gZWxlbWVudChieS5tb2RlbCgndXNlclR5cGUnKSk7XG5cdFxuXHQgICAgICAgICAgdXNlcklucHV0LmNsZWFyKCk7XG5cdCAgICAgICAgICB1c2VySW5wdXQuc2VuZEtleXMoJycpO1xuXHRcblx0ICAgICAgICAgIGV4cGVjdCh1c2VyVHlwZS5nZXRUZXh0KCkpLnRvRXF1YWwoJ3VzZXJUeXBlID0nKTtcblx0ICAgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgPC9maWxlPlxuXHQgICAgPC9leGFtcGxlPlxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgTmFtZSBvZiB0aGUgZm9ybS4gSWYgc3BlY2lmaWVkLCB0aGUgZm9ybSBjb250cm9sbGVyIHdpbGwgYmUgcHVibGlzaGVkIGludG9cblx0ICogICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWQgc2NvcGUsIHVuZGVyIHRoaXMgbmFtZS5cblx0ICovXG5cdHZhciBmb3JtRGlyZWN0aXZlRmFjdG9yeSA9IGZ1bmN0aW9uKGlzTmdGb3JtKSB7XG5cdCAgcmV0dXJuIFsnJHRpbWVvdXQnLCAnJHBhcnNlJywgZnVuY3Rpb24oJHRpbWVvdXQsICRwYXJzZSkge1xuXHQgICAgdmFyIGZvcm1EaXJlY3RpdmUgPSB7XG5cdCAgICAgIG5hbWU6ICdmb3JtJyxcblx0ICAgICAgcmVzdHJpY3Q6IGlzTmdGb3JtID8gJ0VBQycgOiAnRScsXG5cdCAgICAgIHJlcXVpcmU6IFsnZm9ybScsICdeXj9mb3JtJ10sIC8vZmlyc3QgaXMgdGhlIGZvcm0ncyBvd24gY3RybCwgc2Vjb25kIGlzIGFuIG9wdGlvbmFsIHBhcmVudCBmb3JtXG5cdCAgICAgIGNvbnRyb2xsZXI6IEZvcm1Db250cm9sbGVyLFxuXHQgICAgICBjb21waWxlOiBmdW5jdGlvbiBuZ0Zvcm1Db21waWxlKGZvcm1FbGVtZW50LCBhdHRyKSB7XG5cdCAgICAgICAgLy8gU2V0dXAgaW5pdGlhbCBzdGF0ZSBvZiB0aGUgY29udHJvbFxuXHQgICAgICAgIGZvcm1FbGVtZW50LmFkZENsYXNzKFBSSVNUSU5FX0NMQVNTKS5hZGRDbGFzcyhWQUxJRF9DTEFTUyk7XG5cdFxuXHQgICAgICAgIHZhciBuYW1lQXR0ciA9IGF0dHIubmFtZSA/ICduYW1lJyA6IChpc05nRm9ybSAmJiBhdHRyLm5nRm9ybSA/ICduZ0Zvcm0nIDogZmFsc2UpO1xuXHRcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgcHJlOiBmdW5jdGlvbiBuZ0Zvcm1QcmVMaW5rKHNjb3BlLCBmb3JtRWxlbWVudCwgYXR0ciwgY3RybHMpIHtcblx0ICAgICAgICAgICAgdmFyIGNvbnRyb2xsZXIgPSBjdHJsc1swXTtcblx0XG5cdCAgICAgICAgICAgIC8vIGlmIGBhY3Rpb25gIGF0dHIgaXMgbm90IHByZXNlbnQgb24gdGhlIGZvcm0sIHByZXZlbnQgdGhlIGRlZmF1bHQgYWN0aW9uIChzdWJtaXNzaW9uKVxuXHQgICAgICAgICAgICBpZiAoISgnYWN0aW9uJyBpbiBhdHRyKSkge1xuXHQgICAgICAgICAgICAgIC8vIHdlIGNhbid0IHVzZSBqcSBldmVudHMgYmVjYXVzZSBpZiBhIGZvcm0gaXMgZGVzdHJveWVkIGR1cmluZyBzdWJtaXNzaW9uIHRoZSBkZWZhdWx0XG5cdCAgICAgICAgICAgICAgLy8gYWN0aW9uIGlzIG5vdCBwcmV2ZW50ZWQuIHNlZSAjMTIzOFxuXHQgICAgICAgICAgICAgIC8vXG5cdCAgICAgICAgICAgICAgLy8gSUUgOSBpcyBub3QgYWZmZWN0ZWQgYmVjYXVzZSBpdCBkb2Vzbid0IGZpcmUgYSBzdWJtaXQgZXZlbnQgYW5kIHRyeSB0byBkbyBhIGZ1bGxcblx0ICAgICAgICAgICAgICAvLyBwYWdlIHJlbG9hZCBpZiB0aGUgZm9ybSB3YXMgZGVzdHJveWVkIGJ5IHN1Ym1pc3Npb24gb2YgdGhlIGZvcm0gdmlhIGEgY2xpY2sgaGFuZGxlclxuXHQgICAgICAgICAgICAgIC8vIG9uIGEgYnV0dG9uIGluIHRoZSBmb3JtLiBMb29rcyBsaWtlIGFuIElFOSBzcGVjaWZpYyBidWcuXG5cdCAgICAgICAgICAgICAgdmFyIGhhbmRsZUZvcm1TdWJtaXNzaW9uID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0ICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgICAgICAgY29udHJvbGxlci4kY29tbWl0Vmlld1ZhbHVlKCk7XG5cdCAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuJHNldFN1Ym1pdHRlZCgpO1xuXHQgICAgICAgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgICAgICAgICB9O1xuXHRcblx0ICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyRm4oZm9ybUVsZW1lbnRbMF0sICdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWlzc2lvbik7XG5cdFxuXHQgICAgICAgICAgICAgIC8vIHVucmVnaXN0ZXIgdGhlIHByZXZlbnREZWZhdWx0IGxpc3RlbmVyIHNvIHRoYXQgd2UgZG9uJ3Qgbm90IGxlYWsgbWVtb3J5IGJ1dCBpbiBhXG5cdCAgICAgICAgICAgICAgLy8gd2F5IHRoYXQgd2lsbCBhY2hpZXZlIHRoZSBwcmV2ZW50aW9uIG9mIHRoZSBkZWZhdWx0IGFjdGlvbi5cblx0ICAgICAgICAgICAgICBmb3JtRWxlbWVudC5vbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICAgICAgICByZW1vdmVFdmVudExpc3RlbmVyRm4oZm9ybUVsZW1lbnRbMF0sICdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWlzc2lvbik7XG5cdCAgICAgICAgICAgICAgICB9LCAwLCBmYWxzZSk7XG5cdCAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHZhciBwYXJlbnRGb3JtQ3RybCA9IGN0cmxzWzFdIHx8IGNvbnRyb2xsZXIuJCRwYXJlbnRGb3JtO1xuXHQgICAgICAgICAgICBwYXJlbnRGb3JtQ3RybC4kYWRkQ29udHJvbChjb250cm9sbGVyKTtcblx0XG5cdCAgICAgICAgICAgIHZhciBzZXR0ZXIgPSBuYW1lQXR0ciA/IGdldFNldHRlcihjb250cm9sbGVyLiRuYW1lKSA6IG5vb3A7XG5cdFxuXHQgICAgICAgICAgICBpZiAobmFtZUF0dHIpIHtcblx0ICAgICAgICAgICAgICBzZXR0ZXIoc2NvcGUsIGNvbnRyb2xsZXIpO1xuXHQgICAgICAgICAgICAgIGF0dHIuJG9ic2VydmUobmFtZUF0dHIsIGZ1bmN0aW9uKG5ld1ZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAoY29udHJvbGxlci4kbmFtZSA9PT0gbmV3VmFsdWUpIHJldHVybjtcblx0ICAgICAgICAgICAgICAgIHNldHRlcihzY29wZSwgdW5kZWZpbmVkKTtcblx0ICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuJCRwYXJlbnRGb3JtLiQkcmVuYW1lQ29udHJvbChjb250cm9sbGVyLCBuZXdWYWx1ZSk7XG5cdCAgICAgICAgICAgICAgICBzZXR0ZXIgPSBnZXRTZXR0ZXIoY29udHJvbGxlci4kbmFtZSk7XG5cdCAgICAgICAgICAgICAgICBzZXR0ZXIoc2NvcGUsIGNvbnRyb2xsZXIpO1xuXHQgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGZvcm1FbGVtZW50Lm9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICAgIGNvbnRyb2xsZXIuJCRwYXJlbnRGb3JtLiRyZW1vdmVDb250cm9sKGNvbnRyb2xsZXIpO1xuXHQgICAgICAgICAgICAgIHNldHRlcihzY29wZSwgdW5kZWZpbmVkKTtcblx0ICAgICAgICAgICAgICBleHRlbmQoY29udHJvbGxlciwgbnVsbEZvcm1DdHJsKTsgLy9zdG9wIHByb3BhZ2F0aW5nIGNoaWxkIGRlc3RydWN0aW9uIGhhbmRsZXJzIHVwd2FyZHNcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gZm9ybURpcmVjdGl2ZTtcblx0XG5cdCAgICBmdW5jdGlvbiBnZXRTZXR0ZXIoZXhwcmVzc2lvbikge1xuXHQgICAgICBpZiAoZXhwcmVzc2lvbiA9PT0gJycpIHtcblx0ICAgICAgICAvL2NyZWF0ZSBhbiBhc3NpZ25hYmxlIGV4cHJlc3Npb24sIHNvIGZvcm1zIHdpdGggYW4gZW1wdHkgbmFtZSBjYW4gYmUgcmVuYW1lZCBsYXRlclxuXHQgICAgICAgIHJldHVybiAkcGFyc2UoJ3RoaXNbXCJcIl0nKS5hc3NpZ247XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuICRwYXJzZShleHByZXNzaW9uKS5hc3NpZ24gfHwgbm9vcDtcblx0ICAgIH1cblx0ICB9XTtcblx0fTtcblx0XG5cdHZhciBmb3JtRGlyZWN0aXZlID0gZm9ybURpcmVjdGl2ZUZhY3RvcnkoKTtcblx0dmFyIG5nRm9ybURpcmVjdGl2ZSA9IGZvcm1EaXJlY3RpdmVGYWN0b3J5KHRydWUpO1xuXHRcblx0LyogZ2xvYmFsIFZBTElEX0NMQVNTOiBmYWxzZSxcblx0ICBJTlZBTElEX0NMQVNTOiBmYWxzZSxcblx0ICBQUklTVElORV9DTEFTUzogZmFsc2UsXG5cdCAgRElSVFlfQ0xBU1M6IGZhbHNlLFxuXHQgIFVOVE9VQ0hFRF9DTEFTUzogZmFsc2UsXG5cdCAgVE9VQ0hFRF9DTEFTUzogZmFsc2UsXG5cdCAgbmdNb2RlbE1pbkVycjogZmFsc2UsXG5cdCovXG5cdFxuXHQvLyBSZWdleCBjb2RlIGlzIG9idGFpbmVkIGZyb20gU086IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzMxNDMwNzAvamF2YXNjcmlwdC1yZWdleC1pc28tZGF0ZXRpbWUjYW5zd2VyLTMxNDMyMzFcblx0dmFyIElTT19EQVRFX1JFR0VYUCA9IC9cXGR7NH0tWzAxXVxcZC1bMC0zXVxcZFRbMC0yXVxcZDpbMC01XVxcZDpbMC01XVxcZFxcLlxcZCsoWystXVswLTJdXFxkOlswLTVdXFxkfFopLztcblx0Ly8gU2VlIHZhbGlkIFVSTHMgaW4gUkZDMzk4NyAoaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzk4Nylcblx0Ly8gTm90ZTogV2UgYXJlIGJlaW5nIG1vcmUgbGVuaWVudCwgYmVjYXVzZSBicm93c2VycyBhcmUgdG9vLlxuXHQvLyAgIDEuIFNjaGVtZVxuXHQvLyAgIDIuIFNsYXNoZXNcblx0Ly8gICAzLiBVc2VybmFtZVxuXHQvLyAgIDQuIFBhc3N3b3JkXG5cdC8vICAgNS4gSG9zdG5hbWVcblx0Ly8gICA2LiBQb3J0XG5cdC8vICAgNy4gUGF0aFxuXHQvLyAgIDguIFF1ZXJ5XG5cdC8vICAgOS4gRnJhZ21lbnRcblx0Ly8gICAgICAgICAgICAgICAgIDExMTExMTExMTExMTExMTEgMjIyICAgMzMzMzMzICAgIDQ0NDQ0ICAgICAgICA1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTUgICAgNjY2ICAgICA3Nzc3Nzc3NyAgICAgODg4ODg4OCAgICAgOTk5XG5cdHZhciBVUkxfUkVHRVhQID0gL15bYS16XVthLXpcXGQuKy1dKjpcXC8qKD86W146QF0rKD86OlteQF0rKT9AKT8oPzpbXlxcczovPyNdK3xcXFtbYS1mXFxkOl0rXFxdKSg/OjpcXGQrKT8oPzpcXC9bXj8jXSopPyg/OlxcP1teI10qKT8oPzojLiopPyQvaTtcblx0dmFyIEVNQUlMX1JFR0VYUCA9IC9eW2EtejAtOSEjJCUmJyorXFwvPT9eX2B7fH1+Li1dK0BbYS16MC05XShbYS16MC05LV0qW2EtejAtOV0pPyhcXC5bYS16MC05XShbYS16MC05LV0qW2EtejAtOV0pPykqJC9pO1xuXHR2YXIgTlVNQkVSX1JFR0VYUCA9IC9eXFxzKihcXC18XFwrKT8oXFxkK3woXFxkKihcXC5cXGQqKSkpKFtlRV1bKy1dP1xcZCspP1xccyokLztcblx0dmFyIERBVEVfUkVHRVhQID0gL14oXFxkezR9KS0oXFxkezJ9KS0oXFxkezJ9KSQvO1xuXHR2YXIgREFURVRJTUVMT0NBTF9SRUdFWFAgPSAvXihcXGR7NH0pLShcXGRcXGQpLShcXGRcXGQpVChcXGRcXGQpOihcXGRcXGQpKD86OihcXGRcXGQpKFxcLlxcZHsxLDN9KT8pPyQvO1xuXHR2YXIgV0VFS19SRUdFWFAgPSAvXihcXGR7NH0pLVcoXFxkXFxkKSQvO1xuXHR2YXIgTU9OVEhfUkVHRVhQID0gL14oXFxkezR9KS0oXFxkXFxkKSQvO1xuXHR2YXIgVElNRV9SRUdFWFAgPSAvXihcXGRcXGQpOihcXGRcXGQpKD86OihcXGRcXGQpKFxcLlxcZHsxLDN9KT8pPyQvO1xuXHRcblx0dmFyIGlucHV0VHlwZSA9IHtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIGlucHV0XG5cdCAgICogQG5hbWUgaW5wdXRbdGV4dF1cblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFN0YW5kYXJkIEhUTUwgdGV4dCBpbnB1dCB3aXRoIGFuZ3VsYXIgZGF0YSBiaW5kaW5nLCBpbmhlcml0ZWQgYnkgbW9zdCBvZiB0aGUgYGlucHV0YCBlbGVtZW50cy5cblx0ICAgKlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIEFkZHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ1JlcXVpcmVkIEFkZHMgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgYW5kIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvXG5cdCAgICogICAgdGhlIGVsZW1lbnQgd2hlbiB0aGUgbmdSZXF1aXJlZCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLiBVc2UgYG5nUmVxdWlyZWRgIGluc3RlYWQgb2Zcblx0ICAgKiAgICBgcmVxdWlyZWRgIHdoZW4geW91IHdhbnQgdG8gZGF0YS1iaW5kIHRvIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0ZS5cblx0ICAgKiBAcGFyYW0ge251bWJlcj19IG5nTWlubGVuZ3RoIFNldHMgYG1pbmxlbmd0aGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIHNob3J0ZXIgdGhhblxuXHQgICAqICAgIG1pbmxlbmd0aC5cblx0ICAgKiBAcGFyYW0ge251bWJlcj19IG5nTWF4bGVuZ3RoIFNldHMgYG1heGxlbmd0aGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIGxvbmdlciB0aGFuXG5cdCAgICogICAgbWF4bGVuZ3RoLiBTZXR0aW5nIHRoZSBhdHRyaWJ1dGUgdG8gYSBuZWdhdGl2ZSBvciBub24tbnVtZXJpYyB2YWx1ZSwgYWxsb3dzIHZpZXcgdmFsdWVzIG9mXG5cdCAgICogICAgYW55IGxlbmd0aC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IHBhdHRlcm4gU2ltaWxhciB0byBgbmdQYXR0ZXJuYCBleGNlcHQgdGhhdCB0aGUgYXR0cmlidXRlIHZhbHVlIGlzIHRoZSBhY3R1YWwgc3RyaW5nXG5cdCAgICogICAgdGhhdCBjb250YWlucyB0aGUgcmVndWxhciBleHByZXNzaW9uIGJvZHkgdGhhdCB3aWxsIGJlIGNvbnZlcnRlZCB0byBhIHJlZ3VsYXIgZXhwcmVzc2lvblxuXHQgICAqICAgIGFzIGluIHRoZSBuZ1BhdHRlcm4gZGlyZWN0aXZlLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdQYXR0ZXJuIFNldHMgYHBhdHRlcm5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSBuZ01vZGVsIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2aWV3VmFsdWUgJHZpZXdWYWx1ZX1cblx0ICAgKiAgICBkb2VzIG5vdCBtYXRjaCBhIFJlZ0V4cCBmb3VuZCBieSBldmFsdWF0aW5nIHRoZSBBbmd1bGFyIGV4cHJlc3Npb24gZ2l2ZW4gaW4gdGhlIGF0dHJpYnV0ZSB2YWx1ZS5cblx0ICAgKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBSZWdFeHAgb2JqZWN0LCB0aGVuIHRoaXMgaXMgdXNlZCBkaXJlY3RseS5cblx0ICAgKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBzdHJpbmcsIHRoZW4gaXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSBSZWdFeHBcblx0ICAgKiAgICBhZnRlciB3cmFwcGluZyBpdCBpbiBgXmAgYW5kIGAkYCBjaGFyYWN0ZXJzLiBGb3IgaW5zdGFuY2UsIGBcImFiY1wiYCB3aWxsIGJlIGNvbnZlcnRlZCB0b1xuXHQgICAqICAgIGBuZXcgUmVnRXhwKCdeYWJjJCcpYC48YnIgLz5cblx0ICAgKiAgICAqKk5vdGU6KiogQXZvaWQgdXNpbmcgdGhlIGBnYCBmbGFnIG9uIHRoZSBSZWdFeHAsIGFzIGl0IHdpbGwgY2F1c2UgZWFjaCBzdWNjZXNzaXZlIHNlYXJjaCB0b1xuXHQgICAqICAgIHN0YXJ0IGF0IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBzZWFyY2gncyBtYXRjaCwgdGh1cyBub3QgdGFraW5nIHRoZSB3aG9sZSBpbnB1dCB2YWx1ZSBpbnRvXG5cdCAgICogICAgYWNjb3VudC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcblx0ICAgKiAgICBpbnRlcmFjdGlvbiB3aXRoIHRoZSBpbnB1dCBlbGVtZW50LlxuXHQgICAqIEBwYXJhbSB7Ym9vbGVhbj19IFtuZ1RyaW09dHJ1ZV0gSWYgc2V0IHRvIGZhbHNlIEFuZ3VsYXIgd2lsbCBub3QgYXV0b21hdGljYWxseSB0cmltIHRoZSBpbnB1dC5cblx0ICAgKiAgICBUaGlzIHBhcmFtZXRlciBpcyBpZ25vcmVkIGZvciBpbnB1dFt0eXBlPXBhc3N3b3JkXSBjb250cm9scywgd2hpY2ggd2lsbCBuZXZlciB0cmltIHRoZVxuXHQgICAqICAgIGlucHV0LlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgICAgPGV4YW1wbGUgbmFtZT1cInRleHQtaW5wdXQtZGlyZWN0aXZlXCIgbW9kdWxlPVwidGV4dElucHV0RXhhbXBsZVwiPlxuXHQgICAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgIDxzY3JpcHQ+XG5cdCAgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ3RleHRJbnB1dEV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAgICAgICAgICAgICAgICRzY29wZS5leGFtcGxlID0ge1xuXHQgICAgICAgICAgICAgICAgIHRleHQ6ICdndWVzdCcsXG5cdCAgICAgICAgICAgICAgICAgd29yZDogL15cXHMqXFx3KlxccyokL1xuXHQgICAgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICAgfV0pO1xuXHQgICAgICAgICA8L3NjcmlwdD5cblx0ICAgICAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiIG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgICAgICAgICAgIDxsYWJlbD5TaW5nbGUgd29yZDpcblx0ICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJpbnB1dFwiIG5nLW1vZGVsPVwiZXhhbXBsZS50ZXh0XCJcblx0ICAgICAgICAgICAgICAgICAgICBuZy1wYXR0ZXJuPVwiZXhhbXBsZS53b3JkXCIgcmVxdWlyZWQgbmctdHJpbT1cImZhbHNlXCI+XG5cdCAgICAgICAgICAgPC9sYWJlbD5cblx0ICAgICAgICAgICA8ZGl2IHJvbGU9XCJhbGVydFwiPlxuXHQgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLnJlcXVpcmVkXCI+XG5cdCAgICAgICAgICAgICAgIFJlcXVpcmVkITwvc3Bhbj5cblx0ICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5wYXR0ZXJuXCI+XG5cdCAgICAgICAgICAgICAgIFNpbmdsZSB3b3JkIG9ubHkhPC9zcGFuPlxuXHQgICAgICAgICAgIDwvZGl2PlxuXHQgICAgICAgICAgIDx0dD50ZXh0ID0ge3tleGFtcGxlLnRleHR9fTwvdHQ+PGJyLz5cblx0ICAgICAgICAgICA8dHQ+bXlGb3JtLmlucHV0LiR2YWxpZCA9IHt7bXlGb3JtLmlucHV0LiR2YWxpZH19PC90dD48YnIvPlxuXHQgICAgICAgICAgIDx0dD5teUZvcm0uaW5wdXQuJGVycm9yID0ge3tteUZvcm0uaW5wdXQuJGVycm9yfX08L3R0Pjxici8+XG5cdCAgICAgICAgICAgPHR0Pm15Rm9ybS4kdmFsaWQgPSB7e215Rm9ybS4kdmFsaWR9fTwvdHQ+PGJyLz5cblx0ICAgICAgICAgICA8dHQ+bXlGb3JtLiRlcnJvci5yZXF1aXJlZCA9IHt7ISFteUZvcm0uJGVycm9yLnJlcXVpcmVkfX08L3R0Pjxici8+XG5cdCAgICAgICAgICA8L2Zvcm0+XG5cdCAgICAgICAgPC9maWxlPlxuXHQgICAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgICAgIHZhciB0ZXh0ID0gZWxlbWVudChieS5iaW5kaW5nKCdleGFtcGxlLnRleHQnKSk7XG5cdCAgICAgICAgICB2YXIgdmFsaWQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ215Rm9ybS5pbnB1dC4kdmFsaWQnKSk7XG5cdCAgICAgICAgICB2YXIgaW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdleGFtcGxlLnRleHQnKSk7XG5cdFxuXHQgICAgICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGV4cGVjdCh0ZXh0LmdldFRleHQoKSkudG9Db250YWluKCdndWVzdCcpO1xuXHQgICAgICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcblx0ICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBpbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygnJyk7XG5cdFxuXHQgICAgICAgICAgICBleHBlY3QodGV4dC5nZXRUZXh0KCkpLnRvRXF1YWwoJ3RleHQgPScpO1xuXHQgICAgICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2ZhbHNlJyk7XG5cdCAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgbXVsdGkgd29yZCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBpbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygnaGVsbG8gd29ybGQnKTtcblx0XG5cdCAgICAgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIDwvZmlsZT5cblx0ICAgICAgPC9leGFtcGxlPlxuXHQgICAqL1xuXHQgICd0ZXh0JzogdGV4dElucHV0VHlwZSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBuZ2RvYyBpbnB1dFxuXHQgICAgICogQG5hbWUgaW5wdXRbZGF0ZV1cblx0ICAgICAqXG5cdCAgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICAqIElucHV0IHdpdGggZGF0ZSB2YWxpZGF0aW9uIGFuZCB0cmFuc2Zvcm1hdGlvbi4gSW4gYnJvd3NlcnMgdGhhdCBkbyBub3QgeWV0IHN1cHBvcnRcblx0ICAgICAqIHRoZSBIVE1MNSBkYXRlIGlucHV0LCBhIHRleHQgZWxlbWVudCB3aWxsIGJlIHVzZWQuIEluIHRoYXQgY2FzZSwgdGV4dCBtdXN0IGJlIGVudGVyZWQgaW4gYSB2YWxpZCBJU08tODYwMVxuXHQgICAgICogZGF0ZSBmb3JtYXQgKHl5eXktTU0tZGQpLCBmb3IgZXhhbXBsZTogYDIwMDktMDEtMDZgLiBTaW5jZSBtYW55XG5cdCAgICAgKiBtb2Rlcm4gYnJvd3NlcnMgZG8gbm90IHlldCBzdXBwb3J0IHRoaXMgaW5wdXQgdHlwZSwgaXQgaXMgaW1wb3J0YW50IHRvIHByb3ZpZGUgY3VlcyB0byB1c2VycyBvbiB0aGVcblx0ICAgICAqIGV4cGVjdGVkIGlucHV0IGZvcm1hdCB2aWEgYSBwbGFjZWhvbGRlciBvciBsYWJlbC5cblx0ICAgICAqXG5cdCAgICAgKiBUaGUgbW9kZWwgbXVzdCBhbHdheXMgYmUgYSBEYXRlIG9iamVjdCwgb3RoZXJ3aXNlIEFuZ3VsYXIgd2lsbCB0aHJvdyBhbiBlcnJvci5cblx0ICAgICAqIEludmFsaWQgYERhdGVgIG9iamVjdHMgKGRhdGVzIHdob3NlIGBnZXRUaW1lKClgIGlzIGBOYU5gKSB3aWxsIGJlIHJlbmRlcmVkIGFzIGFuIGVtcHR5IHN0cmluZy5cblx0ICAgICAqXG5cdCAgICAgKiBUaGUgdGltZXpvbmUgdG8gYmUgdXNlZCB0byByZWFkL3dyaXRlIHRoZSBgRGF0ZWAgaW5zdGFuY2UgaW4gdGhlIG1vZGVsIGNhbiBiZSBkZWZpbmVkIHVzaW5nXG5cdCAgICAgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nTW9kZWxPcHRpb25zIG5nTW9kZWxPcHRpb25zfS4gQnkgZGVmYXVsdCwgdGhpcyBpcyB0aGUgdGltZXpvbmUgb2YgdGhlIGJyb3dzZXIuXG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmc9fSBtaW4gU2V0cyB0aGUgYG1pbmAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGVudGVyZWQgaXMgbGVzcyB0aGFuIGBtaW5gLiBUaGlzIG11c3QgYmUgYVxuXHQgICAgICogICB2YWxpZCBJU08gZGF0ZSBzdHJpbmcgKHl5eXktTU0tZGQpLiBZb3UgY2FuIGFsc28gdXNlIGludGVycG9sYXRpb24gaW5zaWRlIHRoaXMgYXR0cmlidXRlXG5cdCAgICAgKiAgIChlLmcuIGBtaW49XCJ7e21pbkRhdGUgfCBkYXRlOid5eXl5LU1NLWRkJ319XCJgKS4gTm90ZSB0aGF0IGBtaW5gIHdpbGwgYWxzbyBhZGQgbmF0aXZlIEhUTUw1XG5cdCAgICAgKiAgIGNvbnN0cmFpbnQgdmFsaWRhdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gbWF4IFNldHMgdGhlIGBtYXhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBlbnRlcmVkIGlzIGdyZWF0ZXIgdGhhbiBgbWF4YC4gVGhpcyBtdXN0IGJlXG5cdCAgICAgKiAgIGEgdmFsaWQgSVNPIGRhdGUgc3RyaW5nICh5eXl5LU1NLWRkKS4gWW91IGNhbiBhbHNvIHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSB0aGlzIGF0dHJpYnV0ZVxuXHQgICAgICogICAoZS5nLiBgbWF4PVwie3ttYXhEYXRlIHwgZGF0ZToneXl5eS1NTS1kZCd9fVwiYCkuIE5vdGUgdGhhdCBgbWF4YCB3aWxsIGFsc28gYWRkIG5hdGl2ZSBIVE1MNVxuXHQgICAgICogICBjb25zdHJhaW50IHZhbGlkYXRpb24uXG5cdCAgICAgKiBAcGFyYW0geyhkYXRlfHN0cmluZyk9fSBuZ01pbiBTZXRzIHRoZSBgbWluYCB2YWxpZGF0aW9uIGNvbnN0cmFpbnQgdG8gdGhlIERhdGUgLyBJU08gZGF0ZSBzdHJpbmdcblx0ICAgICAqICAgdGhlIGBuZ01pbmAgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8uIE5vdGUgdGhhdCBpdCBkb2VzIG5vdCBzZXQgdGhlIGBtaW5gIGF0dHJpYnV0ZS5cblx0ICAgICAqIEBwYXJhbSB7KGRhdGV8c3RyaW5nKT19IG5nTWF4IFNldHMgdGhlIGBtYXhgIHZhbGlkYXRpb24gY29uc3RyYWludCB0byB0aGUgRGF0ZSAvIElTTyBkYXRlIHN0cmluZ1xuXHQgICAgICogICB0aGUgYG5nTWF4YCBleHByZXNzaW9uIGV2YWx1YXRlcyB0by4gTm90ZSB0aGF0IGl0IGRvZXMgbm90IHNldCB0aGUgYG1heGAgYXR0cmlidXRlLlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmc9fSByZXF1aXJlZCBTZXRzIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIG5vdCBlbnRlcmVkLlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ1JlcXVpcmVkIEFkZHMgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgYW5kIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvXG5cdCAgICAgKiAgICB0aGUgZWxlbWVudCB3aGVuIHRoZSBuZ1JlcXVpcmVkIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIHRydWUuIFVzZSBgbmdSZXF1aXJlZGAgaW5zdGVhZCBvZlxuXHQgICAgICogICAgYHJlcXVpcmVkYCB3aGVuIHlvdSB3YW50IHRvIGRhdGEtYmluZCB0byB0aGUgYHJlcXVpcmVkYCBhdHRyaWJ1dGUuXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcblx0ICAgICAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG5cdCAgICAgKlxuXHQgICAgICogQGV4YW1wbGVcblx0ICAgICA8ZXhhbXBsZSBuYW1lPVwiZGF0ZS1pbnB1dC1kaXJlY3RpdmVcIiBtb2R1bGU9XCJkYXRlSW5wdXRFeGFtcGxlXCI+XG5cdCAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgIDxzY3JpcHQ+XG5cdCAgICAgICAgICBhbmd1bGFyLm1vZHVsZSgnZGF0ZUlucHV0RXhhbXBsZScsIFtdKVxuXHQgICAgICAgICAgICAuY29udHJvbGxlcignRGF0ZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgICAgICRzY29wZS5leGFtcGxlID0ge1xuXHQgICAgICAgICAgICAgICAgdmFsdWU6IG5ldyBEYXRlKDIwMTMsIDksIDIyKVxuXHQgICAgICAgICAgICAgIH07XG5cdCAgICAgICAgICAgIH1dKTtcblx0ICAgICAgIDwvc2NyaXB0PlxuXHQgICAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiIG5nLWNvbnRyb2xsZXI9XCJEYXRlQ29udHJvbGxlciBhcyBkYXRlQ3RybFwiPlxuXHQgICAgICAgICAgPGxhYmVsIGZvcj1cImV4YW1wbGVJbnB1dFwiPlBpY2sgYSBkYXRlIGluIDIwMTM6PC9sYWJlbD5cblx0ICAgICAgICAgIDxpbnB1dCB0eXBlPVwiZGF0ZVwiIGlkPVwiZXhhbXBsZUlucHV0XCIgbmFtZT1cImlucHV0XCIgbmctbW9kZWw9XCJleGFtcGxlLnZhbHVlXCJcblx0ICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cInl5eXktTU0tZGRcIiBtaW49XCIyMDEzLTAxLTAxXCIgbWF4PVwiMjAxMy0xMi0zMVwiIHJlcXVpcmVkIC8+XG5cdCAgICAgICAgICA8ZGl2IHJvbGU9XCJhbGVydFwiPlxuXHQgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS5pbnB1dC4kZXJyb3IucmVxdWlyZWRcIj5cblx0ICAgICAgICAgICAgICAgIFJlcXVpcmVkITwvc3Bhbj5cblx0ICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLmRhdGVcIj5cblx0ICAgICAgICAgICAgICAgIE5vdCBhIHZhbGlkIGRhdGUhPC9zcGFuPlxuXHQgICAgICAgICAgIDwvZGl2PlxuXHQgICAgICAgICAgIDx0dD52YWx1ZSA9IHt7ZXhhbXBsZS52YWx1ZSB8IGRhdGU6IFwieXl5eS1NTS1kZFwifX08L3R0Pjxici8+XG5cdCAgICAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kdmFsaWQgPSB7e215Rm9ybS5pbnB1dC4kdmFsaWR9fTwvdHQ+PGJyLz5cblx0ICAgICAgICAgICA8dHQ+bXlGb3JtLmlucHV0LiRlcnJvciA9IHt7bXlGb3JtLmlucHV0LiRlcnJvcn19PC90dD48YnIvPlxuXHQgICAgICAgICAgIDx0dD5teUZvcm0uJHZhbGlkID0ge3tteUZvcm0uJHZhbGlkfX08L3R0Pjxici8+XG5cdCAgICAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IucmVxdWlyZWQgPSB7eyEhbXlGb3JtLiRlcnJvci5yZXF1aXJlZH19PC90dD48YnIvPlxuXHQgICAgICAgPC9mb3JtPlxuXHQgICAgIDwvZmlsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgICAgdmFyIHZhbHVlID0gZWxlbWVudChieS5iaW5kaW5nKCdleGFtcGxlLnZhbHVlIHwgZGF0ZTogXCJ5eXl5LU1NLWRkXCInKSk7XG5cdCAgICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuXHQgICAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ2V4YW1wbGUudmFsdWUnKSk7XG5cdFxuXHQgICAgICAgIC8vIGN1cnJlbnRseSBwcm90cmFjdG9yL3dlYmRyaXZlciBkb2VzIG5vdCBzdXBwb3J0XG5cdCAgICAgICAgLy8gc2VuZGluZyBrZXlzIHRvIGFsbCBrbm93biBIVE1MNSBpbnB1dCBjb250cm9sc1xuXHQgICAgICAgIC8vIGZvciB2YXJpb3VzIGJyb3dzZXJzIChzZWUgaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvcHJvdHJhY3Rvci9pc3N1ZXMvNTYyKS5cblx0ICAgICAgICBmdW5jdGlvbiBzZXRJbnB1dCh2YWwpIHtcblx0ICAgICAgICAgIC8vIHNldCB0aGUgdmFsdWUgb2YgdGhlIGVsZW1lbnQgYW5kIGZvcmNlIHZhbGlkYXRpb24uXG5cdCAgICAgICAgICB2YXIgc2NyID0gXCJ2YXIgaXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4YW1wbGVJbnB1dCcpOyBcIiArXG5cdCAgICAgICAgICBcImlwdC52YWx1ZSA9ICdcIiArIHZhbCArIFwiJztcIiArXG5cdCAgICAgICAgICBcImFuZ3VsYXIuZWxlbWVudChpcHQpLnNjb3BlKCkuJGFwcGx5KGZ1bmN0aW9uKHMpIHsgcy5teUZvcm1baXB0Lm5hbWVdLiRzZXRWaWV3VmFsdWUoJ1wiICsgdmFsICsgXCInKTsgfSk7XCI7XG5cdCAgICAgICAgICBicm93c2VyLmV4ZWN1dGVTY3JpcHQoc2NyKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB0byBtb2RlbCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9Db250YWluKCcyMDEzLTEwLTIyJyk7XG5cdCAgICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ215Rm9ybS5pbnB1dC4kdmFsaWQgPSB0cnVlJyk7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgc2V0SW5wdXQoJycpO1xuXHQgICAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9FcXVhbCgndmFsdWUgPScpO1xuXHQgICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gZmFsc2UnKTtcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIG92ZXIgbWF4JywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBzZXRJbnB1dCgnMjAxNS0wMS0wMScpO1xuXHQgICAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9Db250YWluKCcnKTtcblx0ICAgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignbXlGb3JtLmlucHV0LiR2YWxpZCA9IGZhbHNlJyk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDwvZXhhbXBsZT5cblx0ICAgICAqL1xuXHQgICdkYXRlJzogY3JlYXRlRGF0ZUlucHV0VHlwZSgnZGF0ZScsIERBVEVfUkVHRVhQLFxuXHQgICAgICAgICBjcmVhdGVEYXRlUGFyc2VyKERBVEVfUkVHRVhQLCBbJ3l5eXknLCAnTU0nLCAnZGQnXSksXG5cdCAgICAgICAgICd5eXl5LU1NLWRkJyksXG5cdFxuXHQgICAvKipcblx0ICAgICogQG5nZG9jIGlucHV0XG5cdCAgICAqIEBuYW1lIGlucHV0W2RhdGV0aW1lLWxvY2FsXVxuXHQgICAgKlxuXHQgICAgKiBAZGVzY3JpcHRpb25cblx0ICAgICogSW5wdXQgd2l0aCBkYXRldGltZSB2YWxpZGF0aW9uIGFuZCB0cmFuc2Zvcm1hdGlvbi4gSW4gYnJvd3NlcnMgdGhhdCBkbyBub3QgeWV0IHN1cHBvcnRcblx0ICAgICogdGhlIEhUTUw1IGRhdGUgaW5wdXQsIGEgdGV4dCBlbGVtZW50IHdpbGwgYmUgdXNlZC4gSW4gdGhhdCBjYXNlLCB0aGUgdGV4dCBtdXN0IGJlIGVudGVyZWQgaW4gYSB2YWxpZCBJU08tODYwMVxuXHQgICAgKiBsb2NhbCBkYXRldGltZSBmb3JtYXQgKHl5eXktTU0tZGRUSEg6bW06c3MpLCBmb3IgZXhhbXBsZTogYDIwMTAtMTItMjhUMTQ6NTc6MDBgLlxuXHQgICAgKlxuXHQgICAgKiBUaGUgbW9kZWwgbXVzdCBhbHdheXMgYmUgYSBEYXRlIG9iamVjdCwgb3RoZXJ3aXNlIEFuZ3VsYXIgd2lsbCB0aHJvdyBhbiBlcnJvci5cblx0ICAgICogSW52YWxpZCBgRGF0ZWAgb2JqZWN0cyAoZGF0ZXMgd2hvc2UgYGdldFRpbWUoKWAgaXMgYE5hTmApIHdpbGwgYmUgcmVuZGVyZWQgYXMgYW4gZW1wdHkgc3RyaW5nLlxuXHQgICAgKlxuXHQgICAgKiBUaGUgdGltZXpvbmUgdG8gYmUgdXNlZCB0byByZWFkL3dyaXRlIHRoZSBgRGF0ZWAgaW5zdGFuY2UgaW4gdGhlIG1vZGVsIGNhbiBiZSBkZWZpbmVkIHVzaW5nXG5cdCAgICAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdNb2RlbE9wdGlvbnMgbmdNb2RlbE9wdGlvbnN9LiBCeSBkZWZhdWx0LCB0aGlzIGlzIHRoZSB0aW1lem9uZSBvZiB0aGUgYnJvd3Nlci5cblx0ICAgICpcblx0ICAgICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuXHQgICAgKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG5cdCAgICAqIEBwYXJhbSB7c3RyaW5nPX0gbWluIFNldHMgdGhlIGBtaW5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBlbnRlcmVkIGlzIGxlc3MgdGhhbiBgbWluYC5cblx0ICAgICogICBUaGlzIG11c3QgYmUgYSB2YWxpZCBJU08gZGF0ZXRpbWUgZm9ybWF0ICh5eXl5LU1NLWRkVEhIOm1tOnNzKS4gWW91IGNhbiBhbHNvIHVzZSBpbnRlcnBvbGF0aW9uXG5cdCAgICAqICAgaW5zaWRlIHRoaXMgYXR0cmlidXRlIChlLmcuIGBtaW49XCJ7e21pbkRhdGV0aW1lTG9jYWwgfCBkYXRlOid5eXl5LU1NLWRkVEhIOm1tOnNzJ319XCJgKS5cblx0ICAgICogICBOb3RlIHRoYXQgYG1pbmAgd2lsbCBhbHNvIGFkZCBuYXRpdmUgSFRNTDUgY29uc3RyYWludCB2YWxpZGF0aW9uLlxuXHQgICAgKiBAcGFyYW0ge3N0cmluZz19IG1heCBTZXRzIHRoZSBgbWF4YCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgZW50ZXJlZCBpcyBncmVhdGVyIHRoYW4gYG1heGAuXG5cdCAgICAqICAgVGhpcyBtdXN0IGJlIGEgdmFsaWQgSVNPIGRhdGV0aW1lIGZvcm1hdCAoeXl5eS1NTS1kZFRISDptbTpzcykuIFlvdSBjYW4gYWxzbyB1c2UgaW50ZXJwb2xhdGlvblxuXHQgICAgKiAgIGluc2lkZSB0aGlzIGF0dHJpYnV0ZSAoZS5nLiBgbWF4PVwie3ttYXhEYXRldGltZUxvY2FsIHwgZGF0ZToneXl5eS1NTS1kZFRISDptbTpzcyd9fVwiYCkuXG5cdCAgICAqICAgTm90ZSB0aGF0IGBtYXhgIHdpbGwgYWxzbyBhZGQgbmF0aXZlIEhUTUw1IGNvbnN0cmFpbnQgdmFsaWRhdGlvbi5cblx0ICAgICogQHBhcmFtIHsoZGF0ZXxzdHJpbmcpPX0gbmdNaW4gU2V0cyB0aGUgYG1pbmAgdmFsaWRhdGlvbiBlcnJvciBrZXkgdG8gdGhlIERhdGUgLyBJU08gZGF0ZXRpbWUgc3RyaW5nXG5cdCAgICAqICAgdGhlIGBuZ01pbmAgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8uIE5vdGUgdGhhdCBpdCBkb2VzIG5vdCBzZXQgdGhlIGBtaW5gIGF0dHJpYnV0ZS5cblx0ICAgICogQHBhcmFtIHsoZGF0ZXxzdHJpbmcpPX0gbmdNYXggU2V0cyB0aGUgYG1heGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgdG8gdGhlIERhdGUgLyBJU08gZGF0ZXRpbWUgc3RyaW5nXG5cdCAgICAqICAgdGhlIGBuZ01heGAgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8uIE5vdGUgdGhhdCBpdCBkb2VzIG5vdCBzZXQgdGhlIGBtYXhgIGF0dHJpYnV0ZS5cblx0ICAgICogQHBhcmFtIHtzdHJpbmc9fSByZXF1aXJlZCBTZXRzIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIG5vdCBlbnRlcmVkLlxuXHQgICAgKiBAcGFyYW0ge3N0cmluZz19IG5nUmVxdWlyZWQgQWRkcyBgcmVxdWlyZWRgIGF0dHJpYnV0ZSBhbmQgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGNvbnN0cmFpbnQgdG9cblx0ICAgICogICAgdGhlIGVsZW1lbnQgd2hlbiB0aGUgbmdSZXF1aXJlZCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLiBVc2UgYG5nUmVxdWlyZWRgIGluc3RlYWQgb2Zcblx0ICAgICogICAgYHJlcXVpcmVkYCB3aGVuIHlvdSB3YW50IHRvIGRhdGEtYmluZCB0byB0aGUgYHJlcXVpcmVkYCBhdHRyaWJ1dGUuXG5cdCAgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdDaGFuZ2UgQW5ndWxhciBleHByZXNzaW9uIHRvIGJlIGV4ZWN1dGVkIHdoZW4gaW5wdXQgY2hhbmdlcyBkdWUgdG8gdXNlclxuXHQgICAgKiAgICBpbnRlcmFjdGlvbiB3aXRoIHRoZSBpbnB1dCBlbGVtZW50LlxuXHQgICAgKlxuXHQgICAgKiBAZXhhbXBsZVxuXHQgICAgPGV4YW1wbGUgbmFtZT1cImRhdGV0aW1lbG9jYWwtaW5wdXQtZGlyZWN0aXZlXCIgbW9kdWxlPVwiZGF0ZUV4YW1wbGVcIj5cblx0ICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgIDxzY3JpcHQ+XG5cdCAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2RhdGVFeGFtcGxlJywgW10pXG5cdCAgICAgICAgICAuY29udHJvbGxlcignRGF0ZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgICAkc2NvcGUuZXhhbXBsZSA9IHtcblx0ICAgICAgICAgICAgICB2YWx1ZTogbmV3IERhdGUoMjAxMCwgMTEsIDI4LCAxNCwgNTcpXG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgICB9XSk7XG5cdCAgICAgIDwvc2NyaXB0PlxuXHQgICAgICA8Zm9ybSBuYW1lPVwibXlGb3JtXCIgbmctY29udHJvbGxlcj1cIkRhdGVDb250cm9sbGVyIGFzIGRhdGVDdHJsXCI+XG5cdCAgICAgICAgPGxhYmVsIGZvcj1cImV4YW1wbGVJbnB1dFwiPlBpY2sgYSBkYXRlIGJldHdlZW4gaW4gMjAxMzo8L2xhYmVsPlxuXHQgICAgICAgIDxpbnB1dCB0eXBlPVwiZGF0ZXRpbWUtbG9jYWxcIiBpZD1cImV4YW1wbGVJbnB1dFwiIG5hbWU9XCJpbnB1dFwiIG5nLW1vZGVsPVwiZXhhbXBsZS52YWx1ZVwiXG5cdCAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwieXl5eS1NTS1kZFRISDptbTpzc1wiIG1pbj1cIjIwMDEtMDEtMDFUMDA6MDA6MDBcIiBtYXg9XCIyMDEzLTEyLTMxVDAwOjAwOjAwXCIgcmVxdWlyZWQgLz5cblx0ICAgICAgICA8ZGl2IHJvbGU9XCJhbGVydFwiPlxuXHQgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLnJlcXVpcmVkXCI+XG5cdCAgICAgICAgICAgICAgUmVxdWlyZWQhPC9zcGFuPlxuXHQgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLmRhdGV0aW1lbG9jYWxcIj5cblx0ICAgICAgICAgICAgICBOb3QgYSB2YWxpZCBkYXRlITwvc3Bhbj5cblx0ICAgICAgICA8L2Rpdj5cblx0ICAgICAgICA8dHQ+dmFsdWUgPSB7e2V4YW1wbGUudmFsdWUgfCBkYXRlOiBcInl5eXktTU0tZGRUSEg6bW06c3NcIn19PC90dD48YnIvPlxuXHQgICAgICAgIDx0dD5teUZvcm0uaW5wdXQuJHZhbGlkID0ge3tteUZvcm0uaW5wdXQuJHZhbGlkfX08L3R0Pjxici8+XG5cdCAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kZXJyb3IgPSB7e215Rm9ybS5pbnB1dC4kZXJyb3J9fTwvdHQ+PGJyLz5cblx0ICAgICAgICA8dHQ+bXlGb3JtLiR2YWxpZCA9IHt7bXlGb3JtLiR2YWxpZH19PC90dD48YnIvPlxuXHQgICAgICAgIDx0dD5teUZvcm0uJGVycm9yLnJlcXVpcmVkID0ge3shIW15Rm9ybS4kZXJyb3IucmVxdWlyZWR9fTwvdHQ+PGJyLz5cblx0ICAgICAgPC9mb3JtPlxuXHQgICAgPC9maWxlPlxuXHQgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICB2YXIgdmFsdWUgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2V4YW1wbGUudmFsdWUgfCBkYXRlOiBcInl5eXktTU0tZGRUSEg6bW06c3NcIicpKTtcblx0ICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuXHQgICAgICB2YXIgaW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdleGFtcGxlLnZhbHVlJykpO1xuXHRcblx0ICAgICAgLy8gY3VycmVudGx5IHByb3RyYWN0b3Ivd2ViZHJpdmVyIGRvZXMgbm90IHN1cHBvcnRcblx0ICAgICAgLy8gc2VuZGluZyBrZXlzIHRvIGFsbCBrbm93biBIVE1MNSBpbnB1dCBjb250cm9sc1xuXHQgICAgICAvLyBmb3IgdmFyaW91cyBicm93c2VycyAoaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvcHJvdHJhY3Rvci9pc3N1ZXMvNTYyKS5cblx0ICAgICAgZnVuY3Rpb24gc2V0SW5wdXQodmFsKSB7XG5cdCAgICAgICAgLy8gc2V0IHRoZSB2YWx1ZSBvZiB0aGUgZWxlbWVudCBhbmQgZm9yY2UgdmFsaWRhdGlvbi5cblx0ICAgICAgICB2YXIgc2NyID0gXCJ2YXIgaXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4YW1wbGVJbnB1dCcpOyBcIiArXG5cdCAgICAgICAgXCJpcHQudmFsdWUgPSAnXCIgKyB2YWwgKyBcIic7XCIgK1xuXHQgICAgICAgIFwiYW5ndWxhci5lbGVtZW50KGlwdCkuc2NvcGUoKS4kYXBwbHkoZnVuY3Rpb24ocykgeyBzLm15Rm9ybVtpcHQubmFtZV0uJHNldFZpZXdWYWx1ZSgnXCIgKyB2YWwgKyBcIicpOyB9KTtcIjtcblx0ICAgICAgICBicm93c2VyLmV4ZWN1dGVTY3JpcHQoc2NyKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9Db250YWluKCcyMDEwLTEyLTI4VDE0OjU3OjAwJyk7XG5cdCAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gdHJ1ZScpO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHNldElucHV0KCcnKTtcblx0ICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0VxdWFsKCd2YWx1ZSA9Jyk7XG5cdCAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gZmFsc2UnKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgb3ZlciBtYXgnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBzZXRJbnB1dCgnMjAxNS0wMS0wMVQyMzo1OTowMCcpO1xuXHQgICAgICAgIGV4cGVjdCh2YWx1ZS5nZXRUZXh0KCkpLnRvQ29udGFpbignJyk7XG5cdCAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gZmFsc2UnKTtcblx0ICAgICAgfSk7XG5cdCAgICA8L2ZpbGU+XG5cdCAgICA8L2V4YW1wbGU+XG5cdCAgICAqL1xuXHQgICdkYXRldGltZS1sb2NhbCc6IGNyZWF0ZURhdGVJbnB1dFR5cGUoJ2RhdGV0aW1lbG9jYWwnLCBEQVRFVElNRUxPQ0FMX1JFR0VYUCxcblx0ICAgICAgY3JlYXRlRGF0ZVBhcnNlcihEQVRFVElNRUxPQ0FMX1JFR0VYUCwgWyd5eXl5JywgJ01NJywgJ2RkJywgJ0hIJywgJ21tJywgJ3NzJywgJ3NzcyddKSxcblx0ICAgICAgJ3l5eXktTU0tZGRUSEg6bW06c3Muc3NzJyksXG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBpbnB1dFxuXHQgICAqIEBuYW1lIGlucHV0W3RpbWVdXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBJbnB1dCB3aXRoIHRpbWUgdmFsaWRhdGlvbiBhbmQgdHJhbnNmb3JtYXRpb24uIEluIGJyb3dzZXJzIHRoYXQgZG8gbm90IHlldCBzdXBwb3J0XG5cdCAgICogdGhlIEhUTUw1IHRpbWUgaW5wdXQsIGEgdGV4dCBlbGVtZW50IHdpbGwgYmUgdXNlZC4gSW4gdGhhdCBjYXNlLCB0aGUgdGV4dCBtdXN0IGJlIGVudGVyZWQgaW4gYSB2YWxpZCBJU08tODYwMVxuXHQgICAqIGxvY2FsIHRpbWUgZm9ybWF0IChISDptbTpzcyksIGZvciBleGFtcGxlOiBgMTQ6NTc6MDBgLiBNb2RlbCBtdXN0IGJlIGEgRGF0ZSBvYmplY3QuIFRoaXMgYmluZGluZyB3aWxsIGFsd2F5cyBvdXRwdXQgYVxuXHQgICAqIERhdGUgb2JqZWN0IHRvIHRoZSBtb2RlbCBvZiBKYW51YXJ5IDEsIDE5NzAsIG9yIGxvY2FsIGRhdGUgYG5ldyBEYXRlKDE5NzAsIDAsIDEsIEhILCBtbSwgc3MpYC5cblx0ICAgKlxuXHQgICAqIFRoZSBtb2RlbCBtdXN0IGFsd2F5cyBiZSBhIERhdGUgb2JqZWN0LCBvdGhlcndpc2UgQW5ndWxhciB3aWxsIHRocm93IGFuIGVycm9yLlxuXHQgICAqIEludmFsaWQgYERhdGVgIG9iamVjdHMgKGRhdGVzIHdob3NlIGBnZXRUaW1lKClgIGlzIGBOYU5gKSB3aWxsIGJlIHJlbmRlcmVkIGFzIGFuIGVtcHR5IHN0cmluZy5cblx0ICAgKlxuXHQgICAqIFRoZSB0aW1lem9uZSB0byBiZSB1c2VkIHRvIHJlYWQvd3JpdGUgdGhlIGBEYXRlYCBpbnN0YW5jZSBpbiB0aGUgbW9kZWwgY2FuIGJlIGRlZmluZWQgdXNpbmdcblx0ICAgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nTW9kZWxPcHRpb25zIG5nTW9kZWxPcHRpb25zfS4gQnkgZGVmYXVsdCwgdGhpcyBpcyB0aGUgdGltZXpvbmUgb2YgdGhlIGJyb3dzZXIuXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gbmdNb2RlbCBBc3NpZ25hYmxlIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBkYXRhLWJpbmQgdG8uXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gbWluIFNldHMgdGhlIGBtaW5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBlbnRlcmVkIGlzIGxlc3MgdGhhbiBgbWluYC5cblx0ICAgKiAgIFRoaXMgbXVzdCBiZSBhIHZhbGlkIElTTyB0aW1lIGZvcm1hdCAoSEg6bW06c3MpLiBZb3UgY2FuIGFsc28gdXNlIGludGVycG9sYXRpb24gaW5zaWRlIHRoaXNcblx0ICAgKiAgIGF0dHJpYnV0ZSAoZS5nLiBgbWluPVwie3ttaW5UaW1lIHwgZGF0ZTonSEg6bW06c3MnfX1cImApLiBOb3RlIHRoYXQgYG1pbmAgd2lsbCBhbHNvIGFkZFxuXHQgICAqICAgbmF0aXZlIEhUTUw1IGNvbnN0cmFpbnQgdmFsaWRhdGlvbi5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG1heCBTZXRzIHRoZSBgbWF4YCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgZW50ZXJlZCBpcyBncmVhdGVyIHRoYW4gYG1heGAuXG5cdCAgICogICBUaGlzIG11c3QgYmUgYSB2YWxpZCBJU08gdGltZSBmb3JtYXQgKEhIOm1tOnNzKS4gWW91IGNhbiBhbHNvIHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSB0aGlzXG5cdCAgICogICBhdHRyaWJ1dGUgKGUuZy4gYG1heD1cInt7bWF4VGltZSB8IGRhdGU6J0hIOm1tOnNzJ319XCJgKS4gTm90ZSB0aGF0IGBtYXhgIHdpbGwgYWxzbyBhZGRcblx0ICAgKiAgIG5hdGl2ZSBIVE1MNSBjb25zdHJhaW50IHZhbGlkYXRpb24uXG5cdCAgICogQHBhcmFtIHsoZGF0ZXxzdHJpbmcpPX0gbmdNaW4gU2V0cyB0aGUgYG1pbmAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvIHRoZSBEYXRlIC8gSVNPIHRpbWUgc3RyaW5nIHRoZVxuXHQgICAqICAgYG5nTWluYCBleHByZXNzaW9uIGV2YWx1YXRlcyB0by4gTm90ZSB0aGF0IGl0IGRvZXMgbm90IHNldCB0aGUgYG1pbmAgYXR0cmlidXRlLlxuXHQgICAqIEBwYXJhbSB7KGRhdGV8c3RyaW5nKT19IG5nTWF4IFNldHMgdGhlIGBtYXhgIHZhbGlkYXRpb24gY29uc3RyYWludCB0byB0aGUgRGF0ZSAvIElTTyB0aW1lIHN0cmluZyB0aGVcblx0ICAgKiAgIGBuZ01heGAgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8uIE5vdGUgdGhhdCBpdCBkb2VzIG5vdCBzZXQgdGhlIGBtYXhgIGF0dHJpYnV0ZS5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ1JlcXVpcmVkIEFkZHMgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgYW5kIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvXG5cdCAgICogICAgdGhlIGVsZW1lbnQgd2hlbiB0aGUgbmdSZXF1aXJlZCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLiBVc2UgYG5nUmVxdWlyZWRgIGluc3RlYWQgb2Zcblx0ICAgKiAgICBgcmVxdWlyZWRgIHdoZW4geW91IHdhbnQgdG8gZGF0YS1iaW5kIHRvIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0ZS5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcblx0ICAgKiAgICBpbnRlcmFjdGlvbiB3aXRoIHRoZSBpbnB1dCBlbGVtZW50LlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgPGV4YW1wbGUgbmFtZT1cInRpbWUtaW5wdXQtZGlyZWN0aXZlXCIgbW9kdWxlPVwidGltZUV4YW1wbGVcIj5cblx0ICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICA8c2NyaXB0PlxuXHQgICAgICBhbmd1bGFyLm1vZHVsZSgndGltZUV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAuY29udHJvbGxlcignRGF0ZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgJHNjb3BlLmV4YW1wbGUgPSB7XG5cdCAgICAgICAgICAgIHZhbHVlOiBuZXcgRGF0ZSgxOTcwLCAwLCAxLCAxNCwgNTcsIDApXG5cdCAgICAgICAgICB9O1xuXHQgICAgICAgIH1dKTtcblx0ICAgICA8L3NjcmlwdD5cblx0ICAgICA8Zm9ybSBuYW1lPVwibXlGb3JtXCIgbmctY29udHJvbGxlcj1cIkRhdGVDb250cm9sbGVyIGFzIGRhdGVDdHJsXCI+XG5cdCAgICAgICAgPGxhYmVsIGZvcj1cImV4YW1wbGVJbnB1dFwiPlBpY2sgYSBiZXR3ZWVuIDhhbSBhbmQgNXBtOjwvbGFiZWw+XG5cdCAgICAgICAgPGlucHV0IHR5cGU9XCJ0aW1lXCIgaWQ9XCJleGFtcGxlSW5wdXRcIiBuYW1lPVwiaW5wdXRcIiBuZy1tb2RlbD1cImV4YW1wbGUudmFsdWVcIlxuXHQgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkhIOm1tOnNzXCIgbWluPVwiMDg6MDA6MDBcIiBtYXg9XCIxNzowMDowMFwiIHJlcXVpcmVkIC8+XG5cdCAgICAgICAgPGRpdiByb2xlPVwiYWxlcnRcIj5cblx0ICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5yZXF1aXJlZFwiPlxuXHQgICAgICAgICAgICAgIFJlcXVpcmVkITwvc3Bhbj5cblx0ICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci50aW1lXCI+XG5cdCAgICAgICAgICAgICAgTm90IGEgdmFsaWQgZGF0ZSE8L3NwYW4+XG5cdCAgICAgICAgPC9kaXY+XG5cdCAgICAgICAgPHR0PnZhbHVlID0ge3tleGFtcGxlLnZhbHVlIHwgZGF0ZTogXCJISDptbTpzc1wifX08L3R0Pjxici8+XG5cdCAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kdmFsaWQgPSB7e215Rm9ybS5pbnB1dC4kdmFsaWR9fTwvdHQ+PGJyLz5cblx0ICAgICAgICA8dHQ+bXlGb3JtLmlucHV0LiRlcnJvciA9IHt7bXlGb3JtLmlucHV0LiRlcnJvcn19PC90dD48YnIvPlxuXHQgICAgICAgIDx0dD5teUZvcm0uJHZhbGlkID0ge3tteUZvcm0uJHZhbGlkfX08L3R0Pjxici8+XG5cdCAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IucmVxdWlyZWQgPSB7eyEhbXlGb3JtLiRlcnJvci5yZXF1aXJlZH19PC90dD48YnIvPlxuXHQgICAgIDwvZm9ybT5cblx0ICAgPC9maWxlPlxuXHQgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQoYnkuYmluZGluZygnZXhhbXBsZS52YWx1ZSB8IGRhdGU6IFwiSEg6bW06c3NcIicpKTtcblx0ICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuXHQgICAgICB2YXIgaW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdleGFtcGxlLnZhbHVlJykpO1xuXHRcblx0ICAgICAgLy8gY3VycmVudGx5IHByb3RyYWN0b3Ivd2ViZHJpdmVyIGRvZXMgbm90IHN1cHBvcnRcblx0ICAgICAgLy8gc2VuZGluZyBrZXlzIHRvIGFsbCBrbm93biBIVE1MNSBpbnB1dCBjb250cm9sc1xuXHQgICAgICAvLyBmb3IgdmFyaW91cyBicm93c2VycyAoaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvcHJvdHJhY3Rvci9pc3N1ZXMvNTYyKS5cblx0ICAgICAgZnVuY3Rpb24gc2V0SW5wdXQodmFsKSB7XG5cdCAgICAgICAgLy8gc2V0IHRoZSB2YWx1ZSBvZiB0aGUgZWxlbWVudCBhbmQgZm9yY2UgdmFsaWRhdGlvbi5cblx0ICAgICAgICB2YXIgc2NyID0gXCJ2YXIgaXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4YW1wbGVJbnB1dCcpOyBcIiArXG5cdCAgICAgICAgXCJpcHQudmFsdWUgPSAnXCIgKyB2YWwgKyBcIic7XCIgK1xuXHQgICAgICAgIFwiYW5ndWxhci5lbGVtZW50KGlwdCkuc2NvcGUoKS4kYXBwbHkoZnVuY3Rpb24ocykgeyBzLm15Rm9ybVtpcHQubmFtZV0uJHNldFZpZXdWYWx1ZSgnXCIgKyB2YWwgKyBcIicpOyB9KTtcIjtcblx0ICAgICAgICBicm93c2VyLmV4ZWN1dGVTY3JpcHQoc2NyKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9Db250YWluKCcxNDo1NzowMCcpO1xuXHQgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignbXlGb3JtLmlucHV0LiR2YWxpZCA9IHRydWUnKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgZW1wdHknLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBzZXRJbnB1dCgnJyk7XG5cdCAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9FcXVhbCgndmFsdWUgPScpO1xuXHQgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignbXlGb3JtLmlucHV0LiR2YWxpZCA9IGZhbHNlJyk7XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIG92ZXIgbWF4JywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgc2V0SW5wdXQoJzIzOjU5OjAwJyk7XG5cdCAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9Db250YWluKCcnKTtcblx0ICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ215Rm9ybS5pbnB1dC4kdmFsaWQgPSBmYWxzZScpO1xuXHQgICAgICB9KTtcblx0ICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCAgICovXG5cdCAgJ3RpbWUnOiBjcmVhdGVEYXRlSW5wdXRUeXBlKCd0aW1lJywgVElNRV9SRUdFWFAsXG5cdCAgICAgIGNyZWF0ZURhdGVQYXJzZXIoVElNRV9SRUdFWFAsIFsnSEgnLCAnbW0nLCAnc3MnLCAnc3NzJ10pLFxuXHQgICAgICdISDptbTpzcy5zc3MnKSxcblx0XG5cdCAgIC8qKlxuXHQgICAgKiBAbmdkb2MgaW5wdXRcblx0ICAgICogQG5hbWUgaW5wdXRbd2Vla11cblx0ICAgICpcblx0ICAgICogQGRlc2NyaXB0aW9uXG5cdCAgICAqIElucHV0IHdpdGggd2Vlay1vZi10aGUteWVhciB2YWxpZGF0aW9uIGFuZCB0cmFuc2Zvcm1hdGlvbiB0byBEYXRlLiBJbiBicm93c2VycyB0aGF0IGRvIG5vdCB5ZXQgc3VwcG9ydFxuXHQgICAgKiB0aGUgSFRNTDUgd2VlayBpbnB1dCwgYSB0ZXh0IGVsZW1lbnQgd2lsbCBiZSB1c2VkLiBJbiB0aGF0IGNhc2UsIHRoZSB0ZXh0IG11c3QgYmUgZW50ZXJlZCBpbiBhIHZhbGlkIElTTy04NjAxXG5cdCAgICAqIHdlZWsgZm9ybWF0ICh5eXl5LVcjIyksIGZvciBleGFtcGxlOiBgMjAxMy1XMDJgLlxuXHQgICAgKlxuXHQgICAgKiBUaGUgbW9kZWwgbXVzdCBhbHdheXMgYmUgYSBEYXRlIG9iamVjdCwgb3RoZXJ3aXNlIEFuZ3VsYXIgd2lsbCB0aHJvdyBhbiBlcnJvci5cblx0ICAgICogSW52YWxpZCBgRGF0ZWAgb2JqZWN0cyAoZGF0ZXMgd2hvc2UgYGdldFRpbWUoKWAgaXMgYE5hTmApIHdpbGwgYmUgcmVuZGVyZWQgYXMgYW4gZW1wdHkgc3RyaW5nLlxuXHQgICAgKlxuXHQgICAgKiBUaGUgdGltZXpvbmUgdG8gYmUgdXNlZCB0byByZWFkL3dyaXRlIHRoZSBgRGF0ZWAgaW5zdGFuY2UgaW4gdGhlIG1vZGVsIGNhbiBiZSBkZWZpbmVkIHVzaW5nXG5cdCAgICAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdNb2RlbE9wdGlvbnMgbmdNb2RlbE9wdGlvbnN9LiBCeSBkZWZhdWx0LCB0aGlzIGlzIHRoZSB0aW1lem9uZSBvZiB0aGUgYnJvd3Nlci5cblx0ICAgICpcblx0ICAgICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuXHQgICAgKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG5cdCAgICAqIEBwYXJhbSB7c3RyaW5nPX0gbWluIFNldHMgdGhlIGBtaW5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBlbnRlcmVkIGlzIGxlc3MgdGhhbiBgbWluYC5cblx0ICAgICogICBUaGlzIG11c3QgYmUgYSB2YWxpZCBJU08gd2VlayBmb3JtYXQgKHl5eXktVyMjKS4gWW91IGNhbiBhbHNvIHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSB0aGlzXG5cdCAgICAqICAgYXR0cmlidXRlIChlLmcuIGBtaW49XCJ7e21pbldlZWsgfCBkYXRlOid5eXl5LVd3dyd9fVwiYCkuIE5vdGUgdGhhdCBgbWluYCB3aWxsIGFsc28gYWRkXG5cdCAgICAqICAgbmF0aXZlIEhUTUw1IGNvbnN0cmFpbnQgdmFsaWRhdGlvbi5cblx0ICAgICogQHBhcmFtIHtzdHJpbmc9fSBtYXggU2V0cyB0aGUgYG1heGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGVudGVyZWQgaXMgZ3JlYXRlciB0aGFuIGBtYXhgLlxuXHQgICAgKiAgIFRoaXMgbXVzdCBiZSBhIHZhbGlkIElTTyB3ZWVrIGZvcm1hdCAoeXl5eS1XIyMpLiBZb3UgY2FuIGFsc28gdXNlIGludGVycG9sYXRpb24gaW5zaWRlIHRoaXNcblx0ICAgICogICBhdHRyaWJ1dGUgKGUuZy4gYG1heD1cInt7bWF4V2VlayB8IGRhdGU6J3l5eXktV3d3J319XCJgKS4gTm90ZSB0aGF0IGBtYXhgIHdpbGwgYWxzbyBhZGRcblx0ICAgICogICBuYXRpdmUgSFRNTDUgY29uc3RyYWludCB2YWxpZGF0aW9uLlxuXHQgICAgKiBAcGFyYW0geyhkYXRlfHN0cmluZyk9fSBuZ01pbiBTZXRzIHRoZSBgbWluYCB2YWxpZGF0aW9uIGNvbnN0cmFpbnQgdG8gdGhlIERhdGUgLyBJU08gd2VlayBzdHJpbmdcblx0ICAgICogICB0aGUgYG5nTWluYCBleHByZXNzaW9uIGV2YWx1YXRlcyB0by4gTm90ZSB0aGF0IGl0IGRvZXMgbm90IHNldCB0aGUgYG1pbmAgYXR0cmlidXRlLlxuXHQgICAgKiBAcGFyYW0geyhkYXRlfHN0cmluZyk9fSBuZ01heCBTZXRzIHRoZSBgbWF4YCB2YWxpZGF0aW9uIGNvbnN0cmFpbnQgdG8gdGhlIERhdGUgLyBJU08gd2VlayBzdHJpbmdcblx0ICAgICogICB0aGUgYG5nTWF4YCBleHByZXNzaW9uIGV2YWx1YXRlcyB0by4gTm90ZSB0aGF0IGl0IGRvZXMgbm90IHNldCB0aGUgYG1heGAgYXR0cmlidXRlLlxuXHQgICAgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG5cdCAgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdSZXF1aXJlZCBBZGRzIGByZXF1aXJlZGAgYXR0cmlidXRlIGFuZCBgcmVxdWlyZWRgIHZhbGlkYXRpb24gY29uc3RyYWludCB0b1xuXHQgICAgKiAgICB0aGUgZWxlbWVudCB3aGVuIHRoZSBuZ1JlcXVpcmVkIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIHRydWUuIFVzZSBgbmdSZXF1aXJlZGAgaW5zdGVhZCBvZlxuXHQgICAgKiAgICBgcmVxdWlyZWRgIHdoZW4geW91IHdhbnQgdG8gZGF0YS1iaW5kIHRvIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0ZS5cblx0ICAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ0NoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyXG5cdCAgICAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG5cdCAgICAqXG5cdCAgICAqIEBleGFtcGxlXG5cdCAgICA8ZXhhbXBsZSBuYW1lPVwid2Vlay1pbnB1dC1kaXJlY3RpdmVcIiBtb2R1bGU9XCJ3ZWVrRXhhbXBsZVwiPlxuXHQgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgPHNjcmlwdD5cblx0ICAgICAgYW5ndWxhci5tb2R1bGUoJ3dlZWtFeGFtcGxlJywgW10pXG5cdCAgICAgICAgLmNvbnRyb2xsZXIoJ0RhdGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICRzY29wZS5leGFtcGxlID0ge1xuXHQgICAgICAgICAgICB2YWx1ZTogbmV3IERhdGUoMjAxMywgMCwgMylcblx0ICAgICAgICAgIH07XG5cdCAgICAgICAgfV0pO1xuXHQgICAgICA8L3NjcmlwdD5cblx0ICAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiIG5nLWNvbnRyb2xsZXI9XCJEYXRlQ29udHJvbGxlciBhcyBkYXRlQ3RybFwiPlxuXHQgICAgICAgIDxsYWJlbD5QaWNrIGEgZGF0ZSBiZXR3ZWVuIGluIDIwMTM6XG5cdCAgICAgICAgICA8aW5wdXQgaWQ9XCJleGFtcGxlSW5wdXRcIiB0eXBlPVwid2Vla1wiIG5hbWU9XCJpbnB1dFwiIG5nLW1vZGVsPVwiZXhhbXBsZS52YWx1ZVwiXG5cdCAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJZWVlZLVcjI1wiIG1pbj1cIjIwMTItVzMyXCJcblx0ICAgICAgICAgICAgICAgICBtYXg9XCIyMDEzLVc1MlwiIHJlcXVpcmVkIC8+XG5cdCAgICAgICAgPC9sYWJlbD5cblx0ICAgICAgICA8ZGl2IHJvbGU9XCJhbGVydFwiPlxuXHQgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLnJlcXVpcmVkXCI+XG5cdCAgICAgICAgICAgICAgUmVxdWlyZWQhPC9zcGFuPlxuXHQgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLndlZWtcIj5cblx0ICAgICAgICAgICAgICBOb3QgYSB2YWxpZCBkYXRlITwvc3Bhbj5cblx0ICAgICAgICA8L2Rpdj5cblx0ICAgICAgICA8dHQ+dmFsdWUgPSB7e2V4YW1wbGUudmFsdWUgfCBkYXRlOiBcInl5eXktV3d3XCJ9fTwvdHQ+PGJyLz5cblx0ICAgICAgICA8dHQ+bXlGb3JtLmlucHV0LiR2YWxpZCA9IHt7bXlGb3JtLmlucHV0LiR2YWxpZH19PC90dD48YnIvPlxuXHQgICAgICAgIDx0dD5teUZvcm0uaW5wdXQuJGVycm9yID0ge3tteUZvcm0uaW5wdXQuJGVycm9yfX08L3R0Pjxici8+XG5cdCAgICAgICAgPHR0Pm15Rm9ybS4kdmFsaWQgPSB7e215Rm9ybS4kdmFsaWR9fTwvdHQ+PGJyLz5cblx0ICAgICAgICA8dHQ+bXlGb3JtLiRlcnJvci5yZXF1aXJlZCA9IHt7ISFteUZvcm0uJGVycm9yLnJlcXVpcmVkfX08L3R0Pjxici8+XG5cdCAgICAgIDwvZm9ybT5cblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgdmFyIHZhbHVlID0gZWxlbWVudChieS5iaW5kaW5nKCdleGFtcGxlLnZhbHVlIHwgZGF0ZTogXCJ5eXl5LVd3d1wiJykpO1xuXHQgICAgICB2YXIgdmFsaWQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ215Rm9ybS5pbnB1dC4kdmFsaWQnKSk7XG5cdCAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ2V4YW1wbGUudmFsdWUnKSk7XG5cdFxuXHQgICAgICAvLyBjdXJyZW50bHkgcHJvdHJhY3Rvci93ZWJkcml2ZXIgZG9lcyBub3Qgc3VwcG9ydFxuXHQgICAgICAvLyBzZW5kaW5nIGtleXMgdG8gYWxsIGtub3duIEhUTUw1IGlucHV0IGNvbnRyb2xzXG5cdCAgICAgIC8vIGZvciB2YXJpb3VzIGJyb3dzZXJzIChodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9wcm90cmFjdG9yL2lzc3Vlcy81NjIpLlxuXHQgICAgICBmdW5jdGlvbiBzZXRJbnB1dCh2YWwpIHtcblx0ICAgICAgICAvLyBzZXQgdGhlIHZhbHVlIG9mIHRoZSBlbGVtZW50IGFuZCBmb3JjZSB2YWxpZGF0aW9uLlxuXHQgICAgICAgIHZhciBzY3IgPSBcInZhciBpcHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhhbXBsZUlucHV0Jyk7IFwiICtcblx0ICAgICAgICBcImlwdC52YWx1ZSA9ICdcIiArIHZhbCArIFwiJztcIiArXG5cdCAgICAgICAgXCJhbmd1bGFyLmVsZW1lbnQoaXB0KS5zY29wZSgpLiRhcHBseShmdW5jdGlvbihzKSB7IHMubXlGb3JtW2lwdC5uYW1lXS4kc2V0Vmlld1ZhbHVlKCdcIiArIHZhbCArIFwiJyk7IH0pO1wiO1xuXHQgICAgICAgIGJyb3dzZXIuZXhlY3V0ZVNjcmlwdChzY3IpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgdG8gbW9kZWwnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJzIwMTMtVzAxJyk7XG5cdCAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gdHJ1ZScpO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHNldElucHV0KCcnKTtcblx0ICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0VxdWFsKCd2YWx1ZSA9Jyk7XG5cdCAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gZmFsc2UnKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgb3ZlciBtYXgnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBzZXRJbnB1dCgnMjAxNS1XMDEnKTtcblx0ICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJycpO1xuXHQgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignbXlGb3JtLmlucHV0LiR2YWxpZCA9IGZhbHNlJyk7XG5cdCAgICAgIH0pO1xuXHQgICAgPC9maWxlPlxuXHQgICAgPC9leGFtcGxlPlxuXHQgICAgKi9cblx0ICAnd2Vlayc6IGNyZWF0ZURhdGVJbnB1dFR5cGUoJ3dlZWsnLCBXRUVLX1JFR0VYUCwgd2Vla1BhcnNlciwgJ3l5eXktV3d3JyksXG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBpbnB1dFxuXHQgICAqIEBuYW1lIGlucHV0W21vbnRoXVxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogSW5wdXQgd2l0aCBtb250aCB2YWxpZGF0aW9uIGFuZCB0cmFuc2Zvcm1hdGlvbi4gSW4gYnJvd3NlcnMgdGhhdCBkbyBub3QgeWV0IHN1cHBvcnRcblx0ICAgKiB0aGUgSFRNTDUgbW9udGggaW5wdXQsIGEgdGV4dCBlbGVtZW50IHdpbGwgYmUgdXNlZC4gSW4gdGhhdCBjYXNlLCB0aGUgdGV4dCBtdXN0IGJlIGVudGVyZWQgaW4gYSB2YWxpZCBJU08tODYwMVxuXHQgICAqIG1vbnRoIGZvcm1hdCAoeXl5eS1NTSksIGZvciBleGFtcGxlOiBgMjAwOS0wMWAuXG5cdCAgICpcblx0ICAgKiBUaGUgbW9kZWwgbXVzdCBhbHdheXMgYmUgYSBEYXRlIG9iamVjdCwgb3RoZXJ3aXNlIEFuZ3VsYXIgd2lsbCB0aHJvdyBhbiBlcnJvci5cblx0ICAgKiBJbnZhbGlkIGBEYXRlYCBvYmplY3RzIChkYXRlcyB3aG9zZSBgZ2V0VGltZSgpYCBpcyBgTmFOYCkgd2lsbCBiZSByZW5kZXJlZCBhcyBhbiBlbXB0eSBzdHJpbmcuXG5cdCAgICogSWYgdGhlIG1vZGVsIGlzIG5vdCBzZXQgdG8gdGhlIGZpcnN0IG9mIHRoZSBtb250aCwgdGhlIG5leHQgdmlldyB0byBtb2RlbCB1cGRhdGUgd2lsbCBzZXQgaXRcblx0ICAgKiB0byB0aGUgZmlyc3Qgb2YgdGhlIG1vbnRoLlxuXHQgICAqXG5cdCAgICogVGhlIHRpbWV6b25lIHRvIGJlIHVzZWQgdG8gcmVhZC93cml0ZSB0aGUgYERhdGVgIGluc3RhbmNlIGluIHRoZSBtb2RlbCBjYW4gYmUgZGVmaW5lZCB1c2luZ1xuXHQgICAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdNb2RlbE9wdGlvbnMgbmdNb2RlbE9wdGlvbnN9LiBCeSBkZWZhdWx0LCB0aGlzIGlzIHRoZSB0aW1lem9uZSBvZiB0aGUgYnJvd3Nlci5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSBuZ01vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBtaW4gU2V0cyB0aGUgYG1pbmAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGVudGVyZWQgaXMgbGVzcyB0aGFuIGBtaW5gLlxuXHQgICAqICAgVGhpcyBtdXN0IGJlIGEgdmFsaWQgSVNPIG1vbnRoIGZvcm1hdCAoeXl5eS1NTSkuIFlvdSBjYW4gYWxzbyB1c2UgaW50ZXJwb2xhdGlvbiBpbnNpZGUgdGhpc1xuXHQgICAqICAgYXR0cmlidXRlIChlLmcuIGBtaW49XCJ7e21pbk1vbnRoIHwgZGF0ZToneXl5eS1NTSd9fVwiYCkuIE5vdGUgdGhhdCBgbWluYCB3aWxsIGFsc28gYWRkXG5cdCAgICogICBuYXRpdmUgSFRNTDUgY29uc3RyYWludCB2YWxpZGF0aW9uLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gbWF4IFNldHMgdGhlIGBtYXhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBlbnRlcmVkIGlzIGdyZWF0ZXIgdGhhbiBgbWF4YC5cblx0ICAgKiAgIFRoaXMgbXVzdCBiZSBhIHZhbGlkIElTTyBtb250aCBmb3JtYXQgKHl5eXktTU0pLiBZb3UgY2FuIGFsc28gdXNlIGludGVycG9sYXRpb24gaW5zaWRlIHRoaXNcblx0ICAgKiAgIGF0dHJpYnV0ZSAoZS5nLiBgbWF4PVwie3ttYXhNb250aCB8IGRhdGU6J3l5eXktTU0nfX1cImApLiBOb3RlIHRoYXQgYG1heGAgd2lsbCBhbHNvIGFkZFxuXHQgICAqICAgbmF0aXZlIEhUTUw1IGNvbnN0cmFpbnQgdmFsaWRhdGlvbi5cblx0ICAgKiBAcGFyYW0geyhkYXRlfHN0cmluZyk9fSBuZ01pbiBTZXRzIHRoZSBgbWluYCB2YWxpZGF0aW9uIGNvbnN0cmFpbnQgdG8gdGhlIERhdGUgLyBJU08gd2VlayBzdHJpbmdcblx0ICAgKiAgIHRoZSBgbmdNaW5gIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvLiBOb3RlIHRoYXQgaXQgZG9lcyBub3Qgc2V0IHRoZSBgbWluYCBhdHRyaWJ1dGUuXG5cdCAgICogQHBhcmFtIHsoZGF0ZXxzdHJpbmcpPX0gbmdNYXggU2V0cyB0aGUgYG1heGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvIHRoZSBEYXRlIC8gSVNPIHdlZWsgc3RyaW5nXG5cdCAgICogICB0aGUgYG5nTWF4YCBleHByZXNzaW9uIGV2YWx1YXRlcyB0by4gTm90ZSB0aGF0IGl0IGRvZXMgbm90IHNldCB0aGUgYG1heGAgYXR0cmlidXRlLlxuXHRcblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ1JlcXVpcmVkIEFkZHMgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgYW5kIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvXG5cdCAgICogICAgdGhlIGVsZW1lbnQgd2hlbiB0aGUgbmdSZXF1aXJlZCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLiBVc2UgYG5nUmVxdWlyZWRgIGluc3RlYWQgb2Zcblx0ICAgKiAgICBgcmVxdWlyZWRgIHdoZW4geW91IHdhbnQgdG8gZGF0YS1iaW5kIHRvIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0ZS5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcblx0ICAgKiAgICBpbnRlcmFjdGlvbiB3aXRoIHRoZSBpbnB1dCBlbGVtZW50LlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgPGV4YW1wbGUgbmFtZT1cIm1vbnRoLWlucHV0LWRpcmVjdGl2ZVwiIG1vZHVsZT1cIm1vbnRoRXhhbXBsZVwiPlxuXHQgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgIDxzY3JpcHQ+XG5cdCAgICAgIGFuZ3VsYXIubW9kdWxlKCdtb250aEV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAuY29udHJvbGxlcignRGF0ZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgJHNjb3BlLmV4YW1wbGUgPSB7XG5cdCAgICAgICAgICAgIHZhbHVlOiBuZXcgRGF0ZSgyMDEzLCA5LCAxKVxuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9XSk7XG5cdCAgICAgPC9zY3JpcHQ+XG5cdCAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiIG5nLWNvbnRyb2xsZXI9XCJEYXRlQ29udHJvbGxlciBhcyBkYXRlQ3RybFwiPlxuXHQgICAgICAgPGxhYmVsIGZvcj1cImV4YW1wbGVJbnB1dFwiPlBpY2sgYSBtb250aCBpbiAyMDEzOjwvbGFiZWw+XG5cdCAgICAgICA8aW5wdXQgaWQ9XCJleGFtcGxlSW5wdXRcIiB0eXBlPVwibW9udGhcIiBuYW1lPVwiaW5wdXRcIiBuZy1tb2RlbD1cImV4YW1wbGUudmFsdWVcIlxuXHQgICAgICAgICAgcGxhY2Vob2xkZXI9XCJ5eXl5LU1NXCIgbWluPVwiMjAxMy0wMVwiIG1heD1cIjIwMTMtMTJcIiByZXF1aXJlZCAvPlxuXHQgICAgICAgPGRpdiByb2xlPVwiYWxlcnRcIj5cblx0ICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLnJlcXVpcmVkXCI+XG5cdCAgICAgICAgICAgIFJlcXVpcmVkITwvc3Bhbj5cblx0ICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLm1vbnRoXCI+XG5cdCAgICAgICAgICAgIE5vdCBhIHZhbGlkIG1vbnRoITwvc3Bhbj5cblx0ICAgICAgIDwvZGl2PlxuXHQgICAgICAgPHR0PnZhbHVlID0ge3tleGFtcGxlLnZhbHVlIHwgZGF0ZTogXCJ5eXl5LU1NXCJ9fTwvdHQ+PGJyLz5cblx0ICAgICAgIDx0dD5teUZvcm0uaW5wdXQuJHZhbGlkID0ge3tteUZvcm0uaW5wdXQuJHZhbGlkfX08L3R0Pjxici8+XG5cdCAgICAgICA8dHQ+bXlGb3JtLmlucHV0LiRlcnJvciA9IHt7bXlGb3JtLmlucHV0LiRlcnJvcn19PC90dD48YnIvPlxuXHQgICAgICAgPHR0Pm15Rm9ybS4kdmFsaWQgPSB7e215Rm9ybS4kdmFsaWR9fTwvdHQ+PGJyLz5cblx0ICAgICAgIDx0dD5teUZvcm0uJGVycm9yLnJlcXVpcmVkID0ge3shIW15Rm9ybS4kZXJyb3IucmVxdWlyZWR9fTwvdHQ+PGJyLz5cblx0ICAgICA8L2Zvcm0+XG5cdCAgIDwvZmlsZT5cblx0ICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICB2YXIgdmFsdWUgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2V4YW1wbGUudmFsdWUgfCBkYXRlOiBcInl5eXktTU1cIicpKTtcblx0ICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuXHQgICAgICB2YXIgaW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdleGFtcGxlLnZhbHVlJykpO1xuXHRcblx0ICAgICAgLy8gY3VycmVudGx5IHByb3RyYWN0b3Ivd2ViZHJpdmVyIGRvZXMgbm90IHN1cHBvcnRcblx0ICAgICAgLy8gc2VuZGluZyBrZXlzIHRvIGFsbCBrbm93biBIVE1MNSBpbnB1dCBjb250cm9sc1xuXHQgICAgICAvLyBmb3IgdmFyaW91cyBicm93c2VycyAoaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvcHJvdHJhY3Rvci9pc3N1ZXMvNTYyKS5cblx0ICAgICAgZnVuY3Rpb24gc2V0SW5wdXQodmFsKSB7XG5cdCAgICAgICAgLy8gc2V0IHRoZSB2YWx1ZSBvZiB0aGUgZWxlbWVudCBhbmQgZm9yY2UgdmFsaWRhdGlvbi5cblx0ICAgICAgICB2YXIgc2NyID0gXCJ2YXIgaXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4YW1wbGVJbnB1dCcpOyBcIiArXG5cdCAgICAgICAgXCJpcHQudmFsdWUgPSAnXCIgKyB2YWwgKyBcIic7XCIgK1xuXHQgICAgICAgIFwiYW5ndWxhci5lbGVtZW50KGlwdCkuc2NvcGUoKS4kYXBwbHkoZnVuY3Rpb24ocykgeyBzLm15Rm9ybVtpcHQubmFtZV0uJHNldFZpZXdWYWx1ZSgnXCIgKyB2YWwgKyBcIicpOyB9KTtcIjtcblx0ICAgICAgICBicm93c2VyLmV4ZWN1dGVTY3JpcHQoc2NyKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9Db250YWluKCcyMDEzLTEwJyk7XG5cdCAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gdHJ1ZScpO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHNldElucHV0KCcnKTtcblx0ICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0VxdWFsKCd2YWx1ZSA9Jyk7XG5cdCAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gZmFsc2UnKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgb3ZlciBtYXgnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBzZXRJbnB1dCgnMjAxNS0wMScpO1xuXHQgICAgICAgIGV4cGVjdCh2YWx1ZS5nZXRUZXh0KCkpLnRvQ29udGFpbignJyk7XG5cdCAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gZmFsc2UnKTtcblx0ICAgICAgfSk7XG5cdCAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgICAqL1xuXHQgICdtb250aCc6IGNyZWF0ZURhdGVJbnB1dFR5cGUoJ21vbnRoJywgTU9OVEhfUkVHRVhQLFxuXHQgICAgIGNyZWF0ZURhdGVQYXJzZXIoTU9OVEhfUkVHRVhQLCBbJ3l5eXknLCAnTU0nXSksXG5cdCAgICAgJ3l5eXktTU0nKSxcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIGlucHV0XG5cdCAgICogQG5hbWUgaW5wdXRbbnVtYmVyXVxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogVGV4dCBpbnB1dCB3aXRoIG51bWJlciB2YWxpZGF0aW9uIGFuZCB0cmFuc2Zvcm1hdGlvbi4gU2V0cyB0aGUgYG51bWJlcmAgdmFsaWRhdGlvblxuXHQgICAqIGVycm9yIGlmIG5vdCBhIHZhbGlkIG51bWJlci5cblx0ICAgKlxuXHQgICAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG5cdCAgICogVGhlIG1vZGVsIG11c3QgYWx3YXlzIGJlIG9mIHR5cGUgYG51bWJlcmAgb3RoZXJ3aXNlIEFuZ3VsYXIgd2lsbCB0aHJvdyBhbiBlcnJvci5cblx0ICAgKiBCZSBhd2FyZSB0aGF0IGEgc3RyaW5nIGNvbnRhaW5pbmcgYSBudW1iZXIgaXMgbm90IGVub3VnaC4gU2VlIHRoZSB7QGxpbmsgbmdNb2RlbDpudW1mbXR9XG5cdCAgICogZXJyb3IgZG9jcyBmb3IgbW9yZSBpbmZvcm1hdGlvbiBhbmQgYW4gZXhhbXBsZSBvZiBob3cgdG8gY29udmVydCB5b3VyIG1vZGVsIGlmIG5lY2Vzc2FyeS5cblx0ICAgKiA8L2Rpdj5cblx0ICAgKlxuXHQgICAqICMjIElzc3VlcyB3aXRoIEhUTUw1IGNvbnN0cmFpbnQgdmFsaWRhdGlvblxuXHQgICAqXG5cdCAgICogSW4gYnJvd3NlcnMgdGhhdCBmb2xsb3cgdGhlXG5cdCAgICogW0hUTUw1IHNwZWNpZmljYXRpb25dKGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2Zvcm1zLmh0bWwjbnVtYmVyLXN0YXRlLSUyOHR5cGU9bnVtYmVyJTI5KSxcblx0ICAgKiBgaW5wdXRbbnVtYmVyXWAgZG9lcyBub3Qgd29yayBhcyBleHBlY3RlZCB3aXRoIHtAbGluayBuZ01vZGVsT3B0aW9ucyBgbmdNb2RlbE9wdGlvbnMuYWxsb3dJbnZhbGlkYH0uXG5cdCAgICogSWYgYSBub24tbnVtYmVyIGlzIGVudGVyZWQgaW4gdGhlIGlucHV0LCB0aGUgYnJvd3NlciB3aWxsIHJlcG9ydCB0aGUgdmFsdWUgYXMgYW4gZW1wdHkgc3RyaW5nLFxuXHQgICAqIHdoaWNoIG1lYW5zIHRoZSB2aWV3IC8gbW9kZWwgdmFsdWVzIGluIGBuZ01vZGVsYCBhbmQgc3Vic2VxdWVudGx5IHRoZSBzY29wZSB2YWx1ZVxuXHQgICAqIHdpbGwgYWxzbyBiZSBhbiBlbXB0eSBzdHJpbmcuXG5cdCAgICpcblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSBuZ01vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBtaW4gU2V0cyB0aGUgYG1pbmAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGVudGVyZWQgaXMgbGVzcyB0aGFuIGBtaW5gLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gbWF4IFNldHMgdGhlIGBtYXhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBlbnRlcmVkIGlzIGdyZWF0ZXIgdGhhbiBgbWF4YC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ1JlcXVpcmVkIEFkZHMgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgYW5kIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvXG5cdCAgICogICAgdGhlIGVsZW1lbnQgd2hlbiB0aGUgbmdSZXF1aXJlZCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLiBVc2UgYG5nUmVxdWlyZWRgIGluc3RlYWQgb2Zcblx0ICAgKiAgICBgcmVxdWlyZWRgIHdoZW4geW91IHdhbnQgdG8gZGF0YS1iaW5kIHRvIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0ZS5cblx0ICAgKiBAcGFyYW0ge251bWJlcj19IG5nTWlubGVuZ3RoIFNldHMgYG1pbmxlbmd0aGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIHNob3J0ZXIgdGhhblxuXHQgICAqICAgIG1pbmxlbmd0aC5cblx0ICAgKiBAcGFyYW0ge251bWJlcj19IG5nTWF4bGVuZ3RoIFNldHMgYG1heGxlbmd0aGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIGxvbmdlciB0aGFuXG5cdCAgICogICAgbWF4bGVuZ3RoLiBTZXR0aW5nIHRoZSBhdHRyaWJ1dGUgdG8gYSBuZWdhdGl2ZSBvciBub24tbnVtZXJpYyB2YWx1ZSwgYWxsb3dzIHZpZXcgdmFsdWVzIG9mXG5cdCAgICogICAgYW55IGxlbmd0aC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IHBhdHRlcm4gU2ltaWxhciB0byBgbmdQYXR0ZXJuYCBleGNlcHQgdGhhdCB0aGUgYXR0cmlidXRlIHZhbHVlIGlzIHRoZSBhY3R1YWwgc3RyaW5nXG5cdCAgICogICAgdGhhdCBjb250YWlucyB0aGUgcmVndWxhciBleHByZXNzaW9uIGJvZHkgdGhhdCB3aWxsIGJlIGNvbnZlcnRlZCB0byBhIHJlZ3VsYXIgZXhwcmVzc2lvblxuXHQgICAqICAgIGFzIGluIHRoZSBuZ1BhdHRlcm4gZGlyZWN0aXZlLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdQYXR0ZXJuIFNldHMgYHBhdHRlcm5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSBuZ01vZGVsIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2aWV3VmFsdWUgJHZpZXdWYWx1ZX1cblx0ICAgKiAgICBkb2VzIG5vdCBtYXRjaCBhIFJlZ0V4cCBmb3VuZCBieSBldmFsdWF0aW5nIHRoZSBBbmd1bGFyIGV4cHJlc3Npb24gZ2l2ZW4gaW4gdGhlIGF0dHJpYnV0ZSB2YWx1ZS5cblx0ICAgKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBSZWdFeHAgb2JqZWN0LCB0aGVuIHRoaXMgaXMgdXNlZCBkaXJlY3RseS5cblx0ICAgKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBzdHJpbmcsIHRoZW4gaXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSBSZWdFeHBcblx0ICAgKiAgICBhZnRlciB3cmFwcGluZyBpdCBpbiBgXmAgYW5kIGAkYCBjaGFyYWN0ZXJzLiBGb3IgaW5zdGFuY2UsIGBcImFiY1wiYCB3aWxsIGJlIGNvbnZlcnRlZCB0b1xuXHQgICAqICAgIGBuZXcgUmVnRXhwKCdeYWJjJCcpYC48YnIgLz5cblx0ICAgKiAgICAqKk5vdGU6KiogQXZvaWQgdXNpbmcgdGhlIGBnYCBmbGFnIG9uIHRoZSBSZWdFeHAsIGFzIGl0IHdpbGwgY2F1c2UgZWFjaCBzdWNjZXNzaXZlIHNlYXJjaCB0b1xuXHQgICAqICAgIHN0YXJ0IGF0IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBzZWFyY2gncyBtYXRjaCwgdGh1cyBub3QgdGFraW5nIHRoZSB3aG9sZSBpbnB1dCB2YWx1ZSBpbnRvXG5cdCAgICogICAgYWNjb3VudC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcblx0ICAgKiAgICBpbnRlcmFjdGlvbiB3aXRoIHRoZSBpbnB1dCBlbGVtZW50LlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgICAgPGV4YW1wbGUgbmFtZT1cIm51bWJlci1pbnB1dC1kaXJlY3RpdmVcIiBtb2R1bGU9XCJudW1iZXJFeGFtcGxlXCI+XG5cdCAgICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgICAgPHNjcmlwdD5cblx0ICAgICAgICAgICBhbmd1bGFyLm1vZHVsZSgnbnVtYmVyRXhhbXBsZScsIFtdKVxuXHQgICAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICAgICAgJHNjb3BlLmV4YW1wbGUgPSB7XG5cdCAgICAgICAgICAgICAgICAgdmFsdWU6IDEyXG5cdCAgICAgICAgICAgICAgIH07XG5cdCAgICAgICAgICAgICB9XSk7XG5cdCAgICAgICAgIDwvc2NyaXB0PlxuXHQgICAgICAgICA8Zm9ybSBuYW1lPVwibXlGb3JtXCIgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAgICAgICAgICAgPGxhYmVsPk51bWJlcjpcblx0ICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwibnVtYmVyXCIgbmFtZT1cImlucHV0XCIgbmctbW9kZWw9XCJleGFtcGxlLnZhbHVlXCJcblx0ICAgICAgICAgICAgICAgICAgICBtaW49XCIwXCIgbWF4PVwiOTlcIiByZXF1aXJlZD5cblx0ICAgICAgICAgIDwvbGFiZWw+XG5cdCAgICAgICAgICAgPGRpdiByb2xlPVwiYWxlcnRcIj5cblx0ICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5yZXF1aXJlZFwiPlxuXHQgICAgICAgICAgICAgICBSZXF1aXJlZCE8L3NwYW4+XG5cdCAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS5pbnB1dC4kZXJyb3IubnVtYmVyXCI+XG5cdCAgICAgICAgICAgICAgIE5vdCB2YWxpZCBudW1iZXIhPC9zcGFuPlxuXHQgICAgICAgICAgIDwvZGl2PlxuXHQgICAgICAgICAgIDx0dD52YWx1ZSA9IHt7ZXhhbXBsZS52YWx1ZX19PC90dD48YnIvPlxuXHQgICAgICAgICAgIDx0dD5teUZvcm0uaW5wdXQuJHZhbGlkID0ge3tteUZvcm0uaW5wdXQuJHZhbGlkfX08L3R0Pjxici8+XG5cdCAgICAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kZXJyb3IgPSB7e215Rm9ybS5pbnB1dC4kZXJyb3J9fTwvdHQ+PGJyLz5cblx0ICAgICAgICAgICA8dHQ+bXlGb3JtLiR2YWxpZCA9IHt7bXlGb3JtLiR2YWxpZH19PC90dD48YnIvPlxuXHQgICAgICAgICAgIDx0dD5teUZvcm0uJGVycm9yLnJlcXVpcmVkID0ge3shIW15Rm9ybS4kZXJyb3IucmVxdWlyZWR9fTwvdHQ+PGJyLz5cblx0ICAgICAgICAgIDwvZm9ybT5cblx0ICAgICAgICA8L2ZpbGU+XG5cdCAgICAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgICAgdmFyIHZhbHVlID0gZWxlbWVudChieS5iaW5kaW5nKCdleGFtcGxlLnZhbHVlJykpO1xuXHQgICAgICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuXHQgICAgICAgICAgdmFyIGlucHV0ID0gZWxlbWVudChieS5tb2RlbCgnZXhhbXBsZS52YWx1ZScpKTtcblx0XG5cdCAgICAgICAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgdG8gbW9kZWwnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9Db250YWluKCcxMicpO1xuXHQgICAgICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcblx0ICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBpbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygnJyk7XG5cdCAgICAgICAgICAgIGV4cGVjdCh2YWx1ZS5nZXRUZXh0KCkpLnRvRXF1YWwoJ3ZhbHVlID0nKTtcblx0ICAgICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdmYWxzZScpO1xuXHQgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIG92ZXIgbWF4JywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGlucHV0LmNsZWFyKCk7XG5cdCAgICAgICAgICAgIGlucHV0LnNlbmRLZXlzKCcxMjMnKTtcblx0ICAgICAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9FcXVhbCgndmFsdWUgPScpO1xuXHQgICAgICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2ZhbHNlJyk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICA8L2ZpbGU+XG5cdCAgICAgIDwvZXhhbXBsZT5cblx0ICAgKi9cblx0ICAnbnVtYmVyJzogbnVtYmVySW5wdXRUeXBlLFxuXHRcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIGlucHV0XG5cdCAgICogQG5hbWUgaW5wdXRbdXJsXVxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogVGV4dCBpbnB1dCB3aXRoIFVSTCB2YWxpZGF0aW9uLiBTZXRzIHRoZSBgdXJsYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgY29udGVudCBpcyBub3QgYVxuXHQgICAqIHZhbGlkIFVSTC5cblx0ICAgKlxuXHQgICAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG5cdCAgICogKipOb3RlOioqIGBpbnB1dFt1cmxdYCB1c2VzIGEgcmVnZXggdG8gdmFsaWRhdGUgdXJscyB0aGF0IGlzIGRlcml2ZWQgZnJvbSB0aGUgcmVnZXhcblx0ICAgKiB1c2VkIGluIENocm9taXVtLiBJZiB5b3UgbmVlZCBzdHJpY3RlciB2YWxpZGF0aW9uLCB5b3UgY2FuIHVzZSBgbmctcGF0dGVybmAgb3IgbW9kaWZ5XG5cdCAgICogdGhlIGJ1aWx0LWluIHZhbGlkYXRvcnMgKHNlZSB0aGUge0BsaW5rIGd1aWRlL2Zvcm1zIEZvcm1zIGd1aWRlfSlcblx0ICAgKiA8L2Rpdj5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSBuZ01vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSByZXF1aXJlZCBTZXRzIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIG5vdCBlbnRlcmVkLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdSZXF1aXJlZCBBZGRzIGByZXF1aXJlZGAgYXR0cmlidXRlIGFuZCBgcmVxdWlyZWRgIHZhbGlkYXRpb24gY29uc3RyYWludCB0b1xuXHQgICAqICAgIHRoZSBlbGVtZW50IHdoZW4gdGhlIG5nUmVxdWlyZWQgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gdHJ1ZS4gVXNlIGBuZ1JlcXVpcmVkYCBpbnN0ZWFkIG9mXG5cdCAgICogICAgYHJlcXVpcmVkYCB3aGVuIHlvdSB3YW50IHRvIGRhdGEtYmluZCB0byB0aGUgYHJlcXVpcmVkYCBhdHRyaWJ1dGUuXG5cdCAgICogQHBhcmFtIHtudW1iZXI9fSBuZ01pbmxlbmd0aCBTZXRzIGBtaW5sZW5ndGhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBzaG9ydGVyIHRoYW5cblx0ICAgKiAgICBtaW5sZW5ndGguXG5cdCAgICogQHBhcmFtIHtudW1iZXI9fSBuZ01heGxlbmd0aCBTZXRzIGBtYXhsZW5ndGhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBsb25nZXIgdGhhblxuXHQgICAqICAgIG1heGxlbmd0aC4gU2V0dGluZyB0aGUgYXR0cmlidXRlIHRvIGEgbmVnYXRpdmUgb3Igbm9uLW51bWVyaWMgdmFsdWUsIGFsbG93cyB2aWV3IHZhbHVlcyBvZlxuXHQgICAqICAgIGFueSBsZW5ndGguXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBwYXR0ZXJuIFNpbWlsYXIgdG8gYG5nUGF0dGVybmAgZXhjZXB0IHRoYXQgdGhlIGF0dHJpYnV0ZSB2YWx1ZSBpcyB0aGUgYWN0dWFsIHN0cmluZ1xuXHQgICAqICAgIHRoYXQgY29udGFpbnMgdGhlIHJlZ3VsYXIgZXhwcmVzc2lvbiBib2R5IHRoYXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSByZWd1bGFyIGV4cHJlc3Npb25cblx0ICAgKiAgICBhcyBpbiB0aGUgbmdQYXR0ZXJuIGRpcmVjdGl2ZS5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5nUGF0dGVybiBTZXRzIGBwYXR0ZXJuYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgbmdNb2RlbCB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmlld1ZhbHVlICR2aWV3VmFsdWV9XG5cdCAgICogICAgZG9lcyBub3QgbWF0Y2ggYSBSZWdFeHAgZm91bmQgYnkgZXZhbHVhdGluZyB0aGUgQW5ndWxhciBleHByZXNzaW9uIGdpdmVuIGluIHRoZSBhdHRyaWJ1dGUgdmFsdWUuXG5cdCAgICogICAgSWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgUmVnRXhwIG9iamVjdCwgdGhlbiB0aGlzIGlzIHVzZWQgZGlyZWN0bHkuXG5cdCAgICogICAgSWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgc3RyaW5nLCB0aGVuIGl0IHdpbGwgYmUgY29udmVydGVkIHRvIGEgUmVnRXhwXG5cdCAgICogICAgYWZ0ZXIgd3JhcHBpbmcgaXQgaW4gYF5gIGFuZCBgJGAgY2hhcmFjdGVycy4gRm9yIGluc3RhbmNlLCBgXCJhYmNcImAgd2lsbCBiZSBjb252ZXJ0ZWQgdG9cblx0ICAgKiAgICBgbmV3IFJlZ0V4cCgnXmFiYyQnKWAuPGJyIC8+XG5cdCAgICogICAgKipOb3RlOioqIEF2b2lkIHVzaW5nIHRoZSBgZ2AgZmxhZyBvbiB0aGUgUmVnRXhwLCBhcyBpdCB3aWxsIGNhdXNlIGVhY2ggc3VjY2Vzc2l2ZSBzZWFyY2ggdG9cblx0ICAgKiAgICBzdGFydCBhdCB0aGUgaW5kZXggb2YgdGhlIGxhc3Qgc2VhcmNoJ3MgbWF0Y2gsIHRodXMgbm90IHRha2luZyB0aGUgd2hvbGUgaW5wdXQgdmFsdWUgaW50b1xuXHQgICAqICAgIGFjY291bnQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ0NoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyXG5cdCAgICogICAgaW50ZXJhY3Rpb24gd2l0aCB0aGUgaW5wdXQgZWxlbWVudC5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICAgIDxleGFtcGxlIG5hbWU9XCJ1cmwtaW5wdXQtZGlyZWN0aXZlXCIgbW9kdWxlPVwidXJsRXhhbXBsZVwiPlxuXHQgICAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgIDxzY3JpcHQ+XG5cdCAgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ3VybEV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAgICAgICAgICAgICAgICRzY29wZS51cmwgPSB7XG5cdCAgICAgICAgICAgICAgICAgdGV4dDogJ2h0dHA6Ly9nb29nbGUuY29tJ1xuXHQgICAgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICAgfV0pO1xuXHQgICAgICAgICA8L3NjcmlwdD5cblx0ICAgICAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiIG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgICAgICAgICAgIDxsYWJlbD5VUkw6XG5cdCAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInVybFwiIG5hbWU9XCJpbnB1dFwiIG5nLW1vZGVsPVwidXJsLnRleHRcIiByZXF1aXJlZD5cblx0ICAgICAgICAgICA8bGFiZWw+XG5cdCAgICAgICAgICAgPGRpdiByb2xlPVwiYWxlcnRcIj5cblx0ICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5yZXF1aXJlZFwiPlxuXHQgICAgICAgICAgICAgICBSZXF1aXJlZCE8L3NwYW4+XG5cdCAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS5pbnB1dC4kZXJyb3IudXJsXCI+XG5cdCAgICAgICAgICAgICAgIE5vdCB2YWxpZCB1cmwhPC9zcGFuPlxuXHQgICAgICAgICAgIDwvZGl2PlxuXHQgICAgICAgICAgIDx0dD50ZXh0ID0ge3t1cmwudGV4dH19PC90dD48YnIvPlxuXHQgICAgICAgICAgIDx0dD5teUZvcm0uaW5wdXQuJHZhbGlkID0ge3tteUZvcm0uaW5wdXQuJHZhbGlkfX08L3R0Pjxici8+XG5cdCAgICAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kZXJyb3IgPSB7e215Rm9ybS5pbnB1dC4kZXJyb3J9fTwvdHQ+PGJyLz5cblx0ICAgICAgICAgICA8dHQ+bXlGb3JtLiR2YWxpZCA9IHt7bXlGb3JtLiR2YWxpZH19PC90dD48YnIvPlxuXHQgICAgICAgICAgIDx0dD5teUZvcm0uJGVycm9yLnJlcXVpcmVkID0ge3shIW15Rm9ybS4kZXJyb3IucmVxdWlyZWR9fTwvdHQ+PGJyLz5cblx0ICAgICAgICAgICA8dHQ+bXlGb3JtLiRlcnJvci51cmwgPSB7eyEhbXlGb3JtLiRlcnJvci51cmx9fTwvdHQ+PGJyLz5cblx0ICAgICAgICAgIDwvZm9ybT5cblx0ICAgICAgICA8L2ZpbGU+XG5cdCAgICAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgICAgdmFyIHRleHQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ3VybC50ZXh0JykpO1xuXHQgICAgICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuXHQgICAgICAgICAgdmFyIGlucHV0ID0gZWxlbWVudChieS5tb2RlbCgndXJsLnRleHQnKSk7XG5cdFxuXHQgICAgICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGV4cGVjdCh0ZXh0LmdldFRleHQoKSkudG9Db250YWluKCdodHRwOi8vZ29vZ2xlLmNvbScpO1xuXHQgICAgICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcblx0ICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBpbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygnJyk7XG5cdFxuXHQgICAgICAgICAgICBleHBlY3QodGV4dC5nZXRUZXh0KCkpLnRvRXF1YWwoJ3RleHQgPScpO1xuXHQgICAgICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2ZhbHNlJyk7XG5cdCAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgbm90IHVybCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBpbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygnYm94Jyk7XG5cdFxuXHQgICAgICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2ZhbHNlJyk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICA8L2ZpbGU+XG5cdCAgICAgIDwvZXhhbXBsZT5cblx0ICAgKi9cblx0ICAndXJsJzogdXJsSW5wdXRUeXBlLFxuXHRcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIGlucHV0XG5cdCAgICogQG5hbWUgaW5wdXRbZW1haWxdXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBUZXh0IGlucHV0IHdpdGggZW1haWwgdmFsaWRhdGlvbi4gU2V0cyB0aGUgYGVtYWlsYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiBub3QgYSB2YWxpZCBlbWFpbFxuXHQgICAqIGFkZHJlc3MuXG5cdCAgICpcblx0ICAgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuXHQgICAqICoqTm90ZToqKiBgaW5wdXRbZW1haWxdYCB1c2VzIGEgcmVnZXggdG8gdmFsaWRhdGUgZW1haWwgYWRkcmVzc2VzIHRoYXQgaXMgZGVyaXZlZCBmcm9tIHRoZSByZWdleFxuXHQgICAqIHVzZWQgaW4gQ2hyb21pdW0uIElmIHlvdSBuZWVkIHN0cmljdGVyIHZhbGlkYXRpb24gKGUuZy4gcmVxdWlyaW5nIGEgdG9wLWxldmVsIGRvbWFpbiksIHlvdSBjYW5cblx0ICAgKiB1c2UgYG5nLXBhdHRlcm5gIG9yIG1vZGlmeSB0aGUgYnVpbHQtaW4gdmFsaWRhdG9ycyAoc2VlIHRoZSB7QGxpbmsgZ3VpZGUvZm9ybXMgRm9ybXMgZ3VpZGV9KVxuXHQgICAqIDwvZGl2PlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ1JlcXVpcmVkIEFkZHMgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgYW5kIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvXG5cdCAgICogICAgdGhlIGVsZW1lbnQgd2hlbiB0aGUgbmdSZXF1aXJlZCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLiBVc2UgYG5nUmVxdWlyZWRgIGluc3RlYWQgb2Zcblx0ICAgKiAgICBgcmVxdWlyZWRgIHdoZW4geW91IHdhbnQgdG8gZGF0YS1iaW5kIHRvIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0ZS5cblx0ICAgKiBAcGFyYW0ge251bWJlcj19IG5nTWlubGVuZ3RoIFNldHMgYG1pbmxlbmd0aGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIHNob3J0ZXIgdGhhblxuXHQgICAqICAgIG1pbmxlbmd0aC5cblx0ICAgKiBAcGFyYW0ge251bWJlcj19IG5nTWF4bGVuZ3RoIFNldHMgYG1heGxlbmd0aGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIGxvbmdlciB0aGFuXG5cdCAgICogICAgbWF4bGVuZ3RoLiBTZXR0aW5nIHRoZSBhdHRyaWJ1dGUgdG8gYSBuZWdhdGl2ZSBvciBub24tbnVtZXJpYyB2YWx1ZSwgYWxsb3dzIHZpZXcgdmFsdWVzIG9mXG5cdCAgICogICAgYW55IGxlbmd0aC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IHBhdHRlcm4gU2ltaWxhciB0byBgbmdQYXR0ZXJuYCBleGNlcHQgdGhhdCB0aGUgYXR0cmlidXRlIHZhbHVlIGlzIHRoZSBhY3R1YWwgc3RyaW5nXG5cdCAgICogICAgdGhhdCBjb250YWlucyB0aGUgcmVndWxhciBleHByZXNzaW9uIGJvZHkgdGhhdCB3aWxsIGJlIGNvbnZlcnRlZCB0byBhIHJlZ3VsYXIgZXhwcmVzc2lvblxuXHQgICAqICAgIGFzIGluIHRoZSBuZ1BhdHRlcm4gZGlyZWN0aXZlLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdQYXR0ZXJuIFNldHMgYHBhdHRlcm5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSBuZ01vZGVsIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2aWV3VmFsdWUgJHZpZXdWYWx1ZX1cblx0ICAgKiAgICBkb2VzIG5vdCBtYXRjaCBhIFJlZ0V4cCBmb3VuZCBieSBldmFsdWF0aW5nIHRoZSBBbmd1bGFyIGV4cHJlc3Npb24gZ2l2ZW4gaW4gdGhlIGF0dHJpYnV0ZSB2YWx1ZS5cblx0ICAgKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBSZWdFeHAgb2JqZWN0LCB0aGVuIHRoaXMgaXMgdXNlZCBkaXJlY3RseS5cblx0ICAgKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBzdHJpbmcsIHRoZW4gaXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSBSZWdFeHBcblx0ICAgKiAgICBhZnRlciB3cmFwcGluZyBpdCBpbiBgXmAgYW5kIGAkYCBjaGFyYWN0ZXJzLiBGb3IgaW5zdGFuY2UsIGBcImFiY1wiYCB3aWxsIGJlIGNvbnZlcnRlZCB0b1xuXHQgICAqICAgIGBuZXcgUmVnRXhwKCdeYWJjJCcpYC48YnIgLz5cblx0ICAgKiAgICAqKk5vdGU6KiogQXZvaWQgdXNpbmcgdGhlIGBnYCBmbGFnIG9uIHRoZSBSZWdFeHAsIGFzIGl0IHdpbGwgY2F1c2UgZWFjaCBzdWNjZXNzaXZlIHNlYXJjaCB0b1xuXHQgICAqICAgIHN0YXJ0IGF0IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBzZWFyY2gncyBtYXRjaCwgdGh1cyBub3QgdGFraW5nIHRoZSB3aG9sZSBpbnB1dCB2YWx1ZSBpbnRvXG5cdCAgICogICAgYWNjb3VudC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcblx0ICAgKiAgICBpbnRlcmFjdGlvbiB3aXRoIHRoZSBpbnB1dCBlbGVtZW50LlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgICAgPGV4YW1wbGUgbmFtZT1cImVtYWlsLWlucHV0LWRpcmVjdGl2ZVwiIG1vZHVsZT1cImVtYWlsRXhhbXBsZVwiPlxuXHQgICAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgIDxzY3JpcHQ+XG5cdCAgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2VtYWlsRXhhbXBsZScsIFtdKVxuXHQgICAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICAgICAgJHNjb3BlLmVtYWlsID0ge1xuXHQgICAgICAgICAgICAgICAgIHRleHQ6ICdtZUBleGFtcGxlLmNvbSdcblx0ICAgICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgIH1dKTtcblx0ICAgICAgICAgPC9zY3JpcHQ+XG5cdCAgICAgICAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiIG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgICAgICAgICAgICAgPGxhYmVsPkVtYWlsOlxuXHQgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImVtYWlsXCIgbmFtZT1cImlucHV0XCIgbmctbW9kZWw9XCJlbWFpbC50ZXh0XCIgcmVxdWlyZWQ+XG5cdCAgICAgICAgICAgICA8L2xhYmVsPlxuXHQgICAgICAgICAgICAgPGRpdiByb2xlPVwiYWxlcnRcIj5cblx0ICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLnJlcXVpcmVkXCI+XG5cdCAgICAgICAgICAgICAgICAgUmVxdWlyZWQhPC9zcGFuPlxuXHQgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS5pbnB1dC4kZXJyb3IuZW1haWxcIj5cblx0ICAgICAgICAgICAgICAgICBOb3QgdmFsaWQgZW1haWwhPC9zcGFuPlxuXHQgICAgICAgICAgICAgPC9kaXY+XG5cdCAgICAgICAgICAgICA8dHQ+dGV4dCA9IHt7ZW1haWwudGV4dH19PC90dD48YnIvPlxuXHQgICAgICAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kdmFsaWQgPSB7e215Rm9ybS5pbnB1dC4kdmFsaWR9fTwvdHQ+PGJyLz5cblx0ICAgICAgICAgICAgIDx0dD5teUZvcm0uaW5wdXQuJGVycm9yID0ge3tteUZvcm0uaW5wdXQuJGVycm9yfX08L3R0Pjxici8+XG5cdCAgICAgICAgICAgICA8dHQ+bXlGb3JtLiR2YWxpZCA9IHt7bXlGb3JtLiR2YWxpZH19PC90dD48YnIvPlxuXHQgICAgICAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IucmVxdWlyZWQgPSB7eyEhbXlGb3JtLiRlcnJvci5yZXF1aXJlZH19PC90dD48YnIvPlxuXHQgICAgICAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IuZW1haWwgPSB7eyEhbXlGb3JtLiRlcnJvci5lbWFpbH19PC90dD48YnIvPlxuXHQgICAgICAgICAgIDwvZm9ybT5cblx0ICAgICAgICAgPC9maWxlPlxuXHQgICAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgICAgIHZhciB0ZXh0ID0gZWxlbWVudChieS5iaW5kaW5nKCdlbWFpbC50ZXh0JykpO1xuXHQgICAgICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuXHQgICAgICAgICAgdmFyIGlucHV0ID0gZWxlbWVudChieS5tb2RlbCgnZW1haWwudGV4dCcpKTtcblx0XG5cdCAgICAgICAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgdG8gbW9kZWwnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgZXhwZWN0KHRleHQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ21lQGV4YW1wbGUuY29tJyk7XG5cdCAgICAgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbigndHJ1ZScpO1xuXHQgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIGVtcHR5JywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGlucHV0LmNsZWFyKCk7XG5cdCAgICAgICAgICAgIGlucHV0LnNlbmRLZXlzKCcnKTtcblx0ICAgICAgICAgICAgZXhwZWN0KHRleHQuZ2V0VGV4dCgpKS50b0VxdWFsKCd0ZXh0ID0nKTtcblx0ICAgICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdmYWxzZScpO1xuXHQgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIG5vdCBlbWFpbCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBpbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygneHh4Jyk7XG5cdFxuXHQgICAgICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2ZhbHNlJyk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICA8L2ZpbGU+XG5cdCAgICAgIDwvZXhhbXBsZT5cblx0ICAgKi9cblx0ICAnZW1haWwnOiBlbWFpbElucHV0VHlwZSxcblx0XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBpbnB1dFxuXHQgICAqIEBuYW1lIGlucHV0W3JhZGlvXVxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogSFRNTCByYWRpbyBidXR0b24uXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gbmdNb2RlbCBBc3NpZ25hYmxlIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBkYXRhLWJpbmQgdG8uXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIFRoZSB2YWx1ZSB0byB3aGljaCB0aGUgYG5nTW9kZWxgIGV4cHJlc3Npb24gc2hvdWxkIGJlIHNldCB3aGVuIHNlbGVjdGVkLlxuXHQgICAqICAgIE5vdGUgdGhhdCBgdmFsdWVgIG9ubHkgc3VwcG9ydHMgYHN0cmluZ2AgdmFsdWVzLCBpLmUuIHRoZSBzY29wZSBtb2RlbCBuZWVkcyB0byBiZSBhIHN0cmluZyxcblx0ICAgKiAgICB0b28uIFVzZSBgbmdWYWx1ZWAgaWYgeW91IG5lZWQgY29tcGxleCBtb2RlbHMgKGBudW1iZXJgLCBgb2JqZWN0YCwgLi4uKS5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ0NoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyXG5cdCAgICogICAgaW50ZXJhY3Rpb24gd2l0aCB0aGUgaW5wdXQgZWxlbWVudC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gbmdWYWx1ZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gd2hpY2ggYG5nTW9kZWxgIHdpbGwgYmUgYmUgc2V0IHdoZW4gdGhlIHJhZGlvXG5cdCAgICogICAgaXMgc2VsZWN0ZWQuIFNob3VsZCBiZSB1c2VkIGluc3RlYWQgb2YgdGhlIGB2YWx1ZWAgYXR0cmlidXRlIGlmIHlvdSBuZWVkXG5cdCAgICogICAgYSBub24tc3RyaW5nIGBuZ01vZGVsYCAoYGJvb2xlYW5gLCBgYXJyYXlgLCAuLi4pLlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgICAgPGV4YW1wbGUgbmFtZT1cInJhZGlvLWlucHV0LWRpcmVjdGl2ZVwiIG1vZHVsZT1cInJhZGlvRXhhbXBsZVwiPlxuXHQgICAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgIDxzY3JpcHQ+XG5cdCAgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ3JhZGlvRXhhbXBsZScsIFtdKVxuXHQgICAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICAgICAgJHNjb3BlLmNvbG9yID0ge1xuXHQgICAgICAgICAgICAgICAgIG5hbWU6ICdibHVlJ1xuXHQgICAgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICAgICAkc2NvcGUuc3BlY2lhbFZhbHVlID0ge1xuXHQgICAgICAgICAgICAgICAgIFwiaWRcIjogXCIxMjM0NVwiLFxuXHQgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogXCJncmVlblwiXG5cdCAgICAgICAgICAgICAgIH07XG5cdCAgICAgICAgICAgICB9XSk7XG5cdCAgICAgICAgIDwvc2NyaXB0PlxuXHQgICAgICAgICA8Zm9ybSBuYW1lPVwibXlGb3JtXCIgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAgICAgICAgICAgPGxhYmVsPlxuXHQgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5nLW1vZGVsPVwiY29sb3IubmFtZVwiIHZhbHVlPVwicmVkXCI+XG5cdCAgICAgICAgICAgICBSZWRcblx0ICAgICAgICAgICA8L2xhYmVsPjxici8+XG5cdCAgICAgICAgICAgPGxhYmVsPlxuXHQgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5nLW1vZGVsPVwiY29sb3IubmFtZVwiIG5nLXZhbHVlPVwic3BlY2lhbFZhbHVlXCI+XG5cdCAgICAgICAgICAgICBHcmVlblxuXHQgICAgICAgICAgIDwvbGFiZWw+PGJyLz5cblx0ICAgICAgICAgICA8bGFiZWw+XG5cdCAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInJhZGlvXCIgbmctbW9kZWw9XCJjb2xvci5uYW1lXCIgdmFsdWU9XCJibHVlXCI+XG5cdCAgICAgICAgICAgICBCbHVlXG5cdCAgICAgICAgICAgPC9sYWJlbD48YnIvPlxuXHQgICAgICAgICAgIDx0dD5jb2xvciA9IHt7Y29sb3IubmFtZSB8IGpzb259fTwvdHQ+PGJyLz5cblx0ICAgICAgICAgIDwvZm9ybT5cblx0ICAgICAgICAgIE5vdGUgdGhhdCBgbmctdmFsdWU9XCJzcGVjaWFsVmFsdWVcImAgc2V0cyByYWRpbyBpdGVtJ3MgdmFsdWUgdG8gYmUgdGhlIHZhbHVlIG9mIGAkc2NvcGUuc3BlY2lhbFZhbHVlYC5cblx0ICAgICAgICA8L2ZpbGU+XG5cdCAgICAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgICAgaXQoJ3Nob3VsZCBjaGFuZ2Ugc3RhdGUnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgdmFyIGNvbG9yID0gZWxlbWVudChieS5iaW5kaW5nKCdjb2xvci5uYW1lJykpO1xuXHRcblx0ICAgICAgICAgICAgZXhwZWN0KGNvbG9yLmdldFRleHQoKSkudG9Db250YWluKCdibHVlJyk7XG5cdFxuXHQgICAgICAgICAgICBlbGVtZW50LmFsbChieS5tb2RlbCgnY29sb3IubmFtZScpKS5nZXQoMCkuY2xpY2soKTtcblx0XG5cdCAgICAgICAgICAgIGV4cGVjdChjb2xvci5nZXRUZXh0KCkpLnRvQ29udGFpbigncmVkJyk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICA8L2ZpbGU+XG5cdCAgICAgIDwvZXhhbXBsZT5cblx0ICAgKi9cblx0ICAncmFkaW8nOiByYWRpb0lucHV0VHlwZSxcblx0XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBpbnB1dFxuXHQgICAqIEBuYW1lIGlucHV0W2NoZWNrYm94XVxuXHQgICAqXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogSFRNTCBjaGVja2JveC5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSBuZ01vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cblx0ICAgKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG5cdCAgICogQHBhcmFtIHtleHByZXNzaW9uPX0gbmdUcnVlVmFsdWUgVGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBleHByZXNzaW9uIHNob3VsZCBiZSBzZXQgd2hlbiBzZWxlY3RlZC5cblx0ICAgKiBAcGFyYW0ge2V4cHJlc3Npb249fSBuZ0ZhbHNlVmFsdWUgVGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBleHByZXNzaW9uIHNob3VsZCBiZSBzZXQgd2hlbiBub3Qgc2VsZWN0ZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ0NoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyXG5cdCAgICogICAgaW50ZXJhY3Rpb24gd2l0aCB0aGUgaW5wdXQgZWxlbWVudC5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICAgIDxleGFtcGxlIG5hbWU9XCJjaGVja2JveC1pbnB1dC1kaXJlY3RpdmVcIiBtb2R1bGU9XCJjaGVja2JveEV4YW1wbGVcIj5cblx0ICAgICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgICA8c2NyaXB0PlxuXHQgICAgICAgICAgIGFuZ3VsYXIubW9kdWxlKCdjaGVja2JveEV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAgICAgICAgICAgICAgICRzY29wZS5jaGVja2JveE1vZGVsID0ge1xuXHQgICAgICAgICAgICAgICAgdmFsdWUxIDogdHJ1ZSxcblx0ICAgICAgICAgICAgICAgIHZhbHVlMiA6ICdZRVMnXG5cdCAgICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgIH1dKTtcblx0ICAgICAgICAgPC9zY3JpcHQ+XG5cdCAgICAgICAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgICAgICA8bGFiZWw+VmFsdWUxOlxuXHQgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiY2hlY2tib3hNb2RlbC52YWx1ZTFcIj5cblx0ICAgICAgICAgICA8L2xhYmVsPjxici8+XG5cdCAgICAgICAgICAgPGxhYmVsPlZhbHVlMjpcblx0ICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cImNoZWNrYm94TW9kZWwudmFsdWUyXCJcblx0ICAgICAgICAgICAgICAgICAgICBuZy10cnVlLXZhbHVlPVwiJ1lFUydcIiBuZy1mYWxzZS12YWx1ZT1cIidOTydcIj5cblx0ICAgICAgICAgICAgPC9sYWJlbD48YnIvPlxuXHQgICAgICAgICAgIDx0dD52YWx1ZTEgPSB7e2NoZWNrYm94TW9kZWwudmFsdWUxfX08L3R0Pjxici8+XG5cdCAgICAgICAgICAgPHR0PnZhbHVlMiA9IHt7Y2hlY2tib3hNb2RlbC52YWx1ZTJ9fTwvdHQ+PGJyLz5cblx0ICAgICAgICAgIDwvZm9ybT5cblx0ICAgICAgICA8L2ZpbGU+XG5cdCAgICAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgICAgaXQoJ3Nob3VsZCBjaGFuZ2Ugc3RhdGUnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgdmFyIHZhbHVlMSA9IGVsZW1lbnQoYnkuYmluZGluZygnY2hlY2tib3hNb2RlbC52YWx1ZTEnKSk7XG5cdCAgICAgICAgICAgIHZhciB2YWx1ZTIgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2NoZWNrYm94TW9kZWwudmFsdWUyJykpO1xuXHRcblx0ICAgICAgICAgICAgZXhwZWN0KHZhbHVlMS5nZXRUZXh0KCkpLnRvQ29udGFpbigndHJ1ZScpO1xuXHQgICAgICAgICAgICBleHBlY3QodmFsdWUyLmdldFRleHQoKSkudG9Db250YWluKCdZRVMnKTtcblx0XG5cdCAgICAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ2NoZWNrYm94TW9kZWwudmFsdWUxJykpLmNsaWNrKCk7XG5cdCAgICAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ2NoZWNrYm94TW9kZWwudmFsdWUyJykpLmNsaWNrKCk7XG5cdFxuXHQgICAgICAgICAgICBleHBlY3QodmFsdWUxLmdldFRleHQoKSkudG9Db250YWluKCdmYWxzZScpO1xuXHQgICAgICAgICAgICBleHBlY3QodmFsdWUyLmdldFRleHQoKSkudG9Db250YWluKCdOTycpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgPC9maWxlPlxuXHQgICAgICA8L2V4YW1wbGU+XG5cdCAgICovXG5cdCAgJ2NoZWNrYm94JzogY2hlY2tib3hJbnB1dFR5cGUsXG5cdFxuXHQgICdoaWRkZW4nOiBub29wLFxuXHQgICdidXR0b24nOiBub29wLFxuXHQgICdzdWJtaXQnOiBub29wLFxuXHQgICdyZXNldCc6IG5vb3AsXG5cdCAgJ2ZpbGUnOiBub29wXG5cdH07XG5cdFxuXHRmdW5jdGlvbiBzdHJpbmdCYXNlZElucHV0VHlwZShjdHJsKSB7XG5cdCAgY3RybC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICByZXR1cm4gY3RybC4kaXNFbXB0eSh2YWx1ZSkgPyB2YWx1ZSA6IHZhbHVlLnRvU3RyaW5nKCk7XG5cdCAgfSk7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHRleHRJbnB1dFR5cGUoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwsICRzbmlmZmVyLCAkYnJvd3Nlcikge1xuXHQgIGJhc2VJbnB1dFR5cGUoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwsICRzbmlmZmVyLCAkYnJvd3Nlcik7XG5cdCAgc3RyaW5nQmFzZWRJbnB1dFR5cGUoY3RybCk7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGJhc2VJbnB1dFR5cGUoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwsICRzbmlmZmVyLCAkYnJvd3Nlcikge1xuXHQgIHZhciB0eXBlID0gbG93ZXJjYXNlKGVsZW1lbnRbMF0udHlwZSk7XG5cdFxuXHQgIC8vIEluIGNvbXBvc2l0aW9uIG1vZGUsIHVzZXJzIGFyZSBzdGlsbCBpbnB1dGluZyBpbnRlcm1lZGlhdGUgdGV4dCBidWZmZXIsXG5cdCAgLy8gaG9sZCB0aGUgbGlzdGVuZXIgdW50aWwgY29tcG9zaXRpb24gaXMgZG9uZS5cblx0ICAvLyBNb3JlIGFib3V0IGNvbXBvc2l0aW9uIGV2ZW50czogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0NvbXBvc2l0aW9uRXZlbnRcblx0ICBpZiAoISRzbmlmZmVyLmFuZHJvaWQpIHtcblx0ICAgIHZhciBjb21wb3NpbmcgPSBmYWxzZTtcblx0XG5cdCAgICBlbGVtZW50Lm9uKCdjb21wb3NpdGlvbnN0YXJ0JywgZnVuY3Rpb24oZGF0YSkge1xuXHQgICAgICBjb21wb3NpbmcgPSB0cnVlO1xuXHQgICAgfSk7XG5cdFxuXHQgICAgZWxlbWVudC5vbignY29tcG9zaXRpb25lbmQnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgY29tcG9zaW5nID0gZmFsc2U7XG5cdCAgICAgIGxpc3RlbmVyKCk7XG5cdCAgICB9KTtcblx0ICB9XG5cdFxuXHQgIHZhciBsaXN0ZW5lciA9IGZ1bmN0aW9uKGV2KSB7XG5cdCAgICBpZiAodGltZW91dCkge1xuXHQgICAgICAkYnJvd3Nlci5kZWZlci5jYW5jZWwodGltZW91dCk7XG5cdCAgICAgIHRpbWVvdXQgPSBudWxsO1xuXHQgICAgfVxuXHQgICAgaWYgKGNvbXBvc2luZykgcmV0dXJuO1xuXHQgICAgdmFyIHZhbHVlID0gZWxlbWVudC52YWwoKSxcblx0ICAgICAgICBldmVudCA9IGV2ICYmIGV2LnR5cGU7XG5cdFxuXHQgICAgLy8gQnkgZGVmYXVsdCB3ZSB3aWxsIHRyaW0gdGhlIHZhbHVlXG5cdCAgICAvLyBJZiB0aGUgYXR0cmlidXRlIG5nLXRyaW0gZXhpc3RzIHdlIHdpbGwgYXZvaWQgdHJpbW1pbmdcblx0ICAgIC8vIElmIGlucHV0IHR5cGUgaXMgJ3Bhc3N3b3JkJywgdGhlIHZhbHVlIGlzIG5ldmVyIHRyaW1tZWRcblx0ICAgIGlmICh0eXBlICE9PSAncGFzc3dvcmQnICYmICghYXR0ci5uZ1RyaW0gfHwgYXR0ci5uZ1RyaW0gIT09ICdmYWxzZScpKSB7XG5cdCAgICAgIHZhbHVlID0gdHJpbSh2YWx1ZSk7XG5cdCAgICB9XG5cdFxuXHQgICAgLy8gSWYgYSBjb250cm9sIGlzIHN1ZmZlcmluZyBmcm9tIGJhZCBpbnB1dCAoZHVlIHRvIG5hdGl2ZSB2YWxpZGF0b3JzKSwgYnJvd3NlcnMgZGlzY2FyZCBpdHNcblx0ICAgIC8vIHZhbHVlLCBzbyBpdCBtYXkgYmUgbmVjZXNzYXJ5IHRvIHJldmFsaWRhdGUgKGJ5IGNhbGxpbmcgJHNldFZpZXdWYWx1ZSBhZ2FpbikgZXZlbiBpZiB0aGVcblx0ICAgIC8vIGNvbnRyb2wncyB2YWx1ZSBpcyB0aGUgc2FtZSBlbXB0eSB2YWx1ZSB0d2ljZSBpbiBhIHJvdy5cblx0ICAgIGlmIChjdHJsLiR2aWV3VmFsdWUgIT09IHZhbHVlIHx8ICh2YWx1ZSA9PT0gJycgJiYgY3RybC4kJGhhc05hdGl2ZVZhbGlkYXRvcnMpKSB7XG5cdCAgICAgIGN0cmwuJHNldFZpZXdWYWx1ZSh2YWx1ZSwgZXZlbnQpO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8vIGlmIHRoZSBicm93c2VyIGRvZXMgc3VwcG9ydCBcImlucHV0XCIgZXZlbnQsIHdlIGFyZSBmaW5lIC0gZXhjZXB0IG9uIElFOSB3aGljaCBkb2Vzbid0IGZpcmUgdGhlXG5cdCAgLy8gaW5wdXQgZXZlbnQgb24gYmFja3NwYWNlLCBkZWxldGUgb3IgY3V0XG5cdCAgaWYgKCRzbmlmZmVyLmhhc0V2ZW50KCdpbnB1dCcpKSB7XG5cdCAgICBlbGVtZW50Lm9uKCdpbnB1dCcsIGxpc3RlbmVyKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgdmFyIHRpbWVvdXQ7XG5cdFxuXHQgICAgdmFyIGRlZmVyTGlzdGVuZXIgPSBmdW5jdGlvbihldiwgaW5wdXQsIG9yaWdWYWx1ZSkge1xuXHQgICAgICBpZiAoIXRpbWVvdXQpIHtcblx0ICAgICAgICB0aW1lb3V0ID0gJGJyb3dzZXIuZGVmZXIoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICB0aW1lb3V0ID0gbnVsbDtcblx0ICAgICAgICAgIGlmICghaW5wdXQgfHwgaW5wdXQudmFsdWUgIT09IG9yaWdWYWx1ZSkge1xuXHQgICAgICAgICAgICBsaXN0ZW5lcihldik7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgZWxlbWVudC5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdCAgICAgIHZhciBrZXkgPSBldmVudC5rZXlDb2RlO1xuXHRcblx0ICAgICAgLy8gaWdub3JlXG5cdCAgICAgIC8vICAgIGNvbW1hbmQgICAgICAgICAgICBtb2RpZmllcnMgICAgICAgICAgICAgICAgICAgYXJyb3dzXG5cdCAgICAgIGlmIChrZXkgPT09IDkxIHx8ICgxNSA8IGtleSAmJiBrZXkgPCAxOSkgfHwgKDM3IDw9IGtleSAmJiBrZXkgPD0gNDApKSByZXR1cm47XG5cdFxuXHQgICAgICBkZWZlckxpc3RlbmVyKGV2ZW50LCB0aGlzLCB0aGlzLnZhbHVlKTtcblx0ICAgIH0pO1xuXHRcblx0ICAgIC8vIGlmIHVzZXIgbW9kaWZpZXMgaW5wdXQgdmFsdWUgdXNpbmcgY29udGV4dCBtZW51IGluIElFLCB3ZSBuZWVkIFwicGFzdGVcIiBhbmQgXCJjdXRcIiBldmVudHMgdG8gY2F0Y2ggaXRcblx0ICAgIGlmICgkc25pZmZlci5oYXNFdmVudCgncGFzdGUnKSkge1xuXHQgICAgICBlbGVtZW50Lm9uKCdwYXN0ZSBjdXQnLCBkZWZlckxpc3RlbmVyKTtcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIC8vIGlmIHVzZXIgcGFzdGUgaW50byBpbnB1dCB1c2luZyBtb3VzZSBvbiBvbGRlciBicm93c2VyXG5cdCAgLy8gb3IgZm9ybSBhdXRvY29tcGxldGUgb24gbmV3ZXIgYnJvd3Nlciwgd2UgbmVlZCBcImNoYW5nZVwiIGV2ZW50IHRvIGNhdGNoIGl0XG5cdCAgZWxlbWVudC5vbignY2hhbmdlJywgbGlzdGVuZXIpO1xuXHRcblx0ICBjdHJsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHtcblx0ICAgIC8vIFdvcmthcm91bmQgZm9yIEZpcmVmb3ggdmFsaWRhdGlvbiAjMTIxMDIuXG5cdCAgICB2YXIgdmFsdWUgPSBjdHJsLiRpc0VtcHR5KGN0cmwuJHZpZXdWYWx1ZSkgPyAnJyA6IGN0cmwuJHZpZXdWYWx1ZTtcblx0ICAgIGlmIChlbGVtZW50LnZhbCgpICE9PSB2YWx1ZSkge1xuXHQgICAgICBlbGVtZW50LnZhbCh2YWx1ZSk7XG5cdCAgICB9XG5cdCAgfTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gd2Vla1BhcnNlcihpc29XZWVrLCBleGlzdGluZ0RhdGUpIHtcblx0ICBpZiAoaXNEYXRlKGlzb1dlZWspKSB7XG5cdCAgICByZXR1cm4gaXNvV2Vlaztcblx0ICB9XG5cdFxuXHQgIGlmIChpc1N0cmluZyhpc29XZWVrKSkge1xuXHQgICAgV0VFS19SRUdFWFAubGFzdEluZGV4ID0gMDtcblx0ICAgIHZhciBwYXJ0cyA9IFdFRUtfUkVHRVhQLmV4ZWMoaXNvV2Vlayk7XG5cdCAgICBpZiAocGFydHMpIHtcblx0ICAgICAgdmFyIHllYXIgPSArcGFydHNbMV0sXG5cdCAgICAgICAgICB3ZWVrID0gK3BhcnRzWzJdLFxuXHQgICAgICAgICAgaG91cnMgPSAwLFxuXHQgICAgICAgICAgbWludXRlcyA9IDAsXG5cdCAgICAgICAgICBzZWNvbmRzID0gMCxcblx0ICAgICAgICAgIG1pbGxpc2Vjb25kcyA9IDAsXG5cdCAgICAgICAgICBmaXJzdFRodXJzID0gZ2V0Rmlyc3RUaHVyc2RheU9mWWVhcih5ZWFyKSxcblx0ICAgICAgICAgIGFkZERheXMgPSAod2VlayAtIDEpICogNztcblx0XG5cdCAgICAgIGlmIChleGlzdGluZ0RhdGUpIHtcblx0ICAgICAgICBob3VycyA9IGV4aXN0aW5nRGF0ZS5nZXRIb3VycygpO1xuXHQgICAgICAgIG1pbnV0ZXMgPSBleGlzdGluZ0RhdGUuZ2V0TWludXRlcygpO1xuXHQgICAgICAgIHNlY29uZHMgPSBleGlzdGluZ0RhdGUuZ2V0U2Vjb25kcygpO1xuXHQgICAgICAgIG1pbGxpc2Vjb25kcyA9IGV4aXN0aW5nRGF0ZS5nZXRNaWxsaXNlY29uZHMoKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBEYXRlKHllYXIsIDAsIGZpcnN0VGh1cnMuZ2V0RGF0ZSgpICsgYWRkRGF5cywgaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMsIG1pbGxpc2Vjb25kcyk7XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICByZXR1cm4gTmFOO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBjcmVhdGVEYXRlUGFyc2VyKHJlZ2V4cCwgbWFwcGluZykge1xuXHQgIHJldHVybiBmdW5jdGlvbihpc28sIGRhdGUpIHtcblx0ICAgIHZhciBwYXJ0cywgbWFwO1xuXHRcblx0ICAgIGlmIChpc0RhdGUoaXNvKSkge1xuXHQgICAgICByZXR1cm4gaXNvO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmIChpc1N0cmluZyhpc28pKSB7XG5cdCAgICAgIC8vIFdoZW4gYSBkYXRlIGlzIEpTT04naWZpZWQgdG8gd3JhcHMgaXRzZWxmIGluc2lkZSBvZiBhbiBleHRyYVxuXHQgICAgICAvLyBzZXQgb2YgZG91YmxlIHF1b3Rlcy4gVGhpcyBtYWtlcyB0aGUgZGF0ZSBwYXJzaW5nIGNvZGUgdW5hYmxlXG5cdCAgICAgIC8vIHRvIG1hdGNoIHRoZSBkYXRlIHN0cmluZyBhbmQgcGFyc2UgaXQgYXMgYSBkYXRlLlxuXHQgICAgICBpZiAoaXNvLmNoYXJBdCgwKSA9PSAnXCInICYmIGlzby5jaGFyQXQoaXNvLmxlbmd0aCAtIDEpID09ICdcIicpIHtcblx0ICAgICAgICBpc28gPSBpc28uc3Vic3RyaW5nKDEsIGlzby5sZW5ndGggLSAxKTtcblx0ICAgICAgfVxuXHQgICAgICBpZiAoSVNPX0RBVEVfUkVHRVhQLnRlc3QoaXNvKSkge1xuXHQgICAgICAgIHJldHVybiBuZXcgRGF0ZShpc28pO1xuXHQgICAgICB9XG5cdCAgICAgIHJlZ2V4cC5sYXN0SW5kZXggPSAwO1xuXHQgICAgICBwYXJ0cyA9IHJlZ2V4cC5leGVjKGlzbyk7XG5cdFxuXHQgICAgICBpZiAocGFydHMpIHtcblx0ICAgICAgICBwYXJ0cy5zaGlmdCgpO1xuXHQgICAgICAgIGlmIChkYXRlKSB7XG5cdCAgICAgICAgICBtYXAgPSB7XG5cdCAgICAgICAgICAgIHl5eXk6IGRhdGUuZ2V0RnVsbFllYXIoKSxcblx0ICAgICAgICAgICAgTU06IGRhdGUuZ2V0TW9udGgoKSArIDEsXG5cdCAgICAgICAgICAgIGRkOiBkYXRlLmdldERhdGUoKSxcblx0ICAgICAgICAgICAgSEg6IGRhdGUuZ2V0SG91cnMoKSxcblx0ICAgICAgICAgICAgbW06IGRhdGUuZ2V0TWludXRlcygpLFxuXHQgICAgICAgICAgICBzczogZGF0ZS5nZXRTZWNvbmRzKCksXG5cdCAgICAgICAgICAgIHNzczogZGF0ZS5nZXRNaWxsaXNlY29uZHMoKSAvIDEwMDBcblx0ICAgICAgICAgIH07XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIG1hcCA9IHsgeXl5eTogMTk3MCwgTU06IDEsIGRkOiAxLCBISDogMCwgbW06IDAsIHNzOiAwLCBzc3M6IDAgfTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGZvckVhY2gocGFydHMsIGZ1bmN0aW9uKHBhcnQsIGluZGV4KSB7XG5cdCAgICAgICAgICBpZiAoaW5kZXggPCBtYXBwaW5nLmxlbmd0aCkge1xuXHQgICAgICAgICAgICBtYXBbbWFwcGluZ1tpbmRleF1dID0gK3BhcnQ7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBEYXRlKG1hcC55eXl5LCBtYXAuTU0gLSAxLCBtYXAuZGQsIG1hcC5ISCwgbWFwLm1tLCBtYXAuc3MgfHwgMCwgbWFwLnNzcyAqIDEwMDAgfHwgMCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gTmFOO1xuXHQgIH07XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGNyZWF0ZURhdGVJbnB1dFR5cGUodHlwZSwgcmVnZXhwLCBwYXJzZURhdGUsIGZvcm1hdCkge1xuXHQgIHJldHVybiBmdW5jdGlvbiBkeW5hbWljRGF0ZUlucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyLCAkZmlsdGVyKSB7XG5cdCAgICBiYWRJbnB1dENoZWNrZXIoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwpO1xuXHQgICAgYmFzZUlucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyKTtcblx0ICAgIHZhciB0aW1lem9uZSA9IGN0cmwgJiYgY3RybC4kb3B0aW9ucyAmJiBjdHJsLiRvcHRpb25zLnRpbWV6b25lO1xuXHQgICAgdmFyIHByZXZpb3VzRGF0ZTtcblx0XG5cdCAgICBjdHJsLiQkcGFyc2VyTmFtZSA9IHR5cGU7XG5cdCAgICBjdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgaWYgKGN0cmwuJGlzRW1wdHkodmFsdWUpKSByZXR1cm4gbnVsbDtcblx0ICAgICAgaWYgKHJlZ2V4cC50ZXN0KHZhbHVlKSkge1xuXHQgICAgICAgIC8vIE5vdGU6IFdlIGNhbm5vdCByZWFkIGN0cmwuJG1vZGVsVmFsdWUsIGFzIHRoZXJlIG1pZ2h0IGJlIGEgZGlmZmVyZW50XG5cdCAgICAgICAgLy8gcGFyc2VyL2Zvcm1hdHRlciBpbiB0aGUgcHJvY2Vzc2luZyBjaGFpbiBzbyB0aGF0IHRoZSBtb2RlbFxuXHQgICAgICAgIC8vIGNvbnRhaW5zIHNvbWUgZGlmZmVyZW50IGRhdGEgZm9ybWF0IVxuXHQgICAgICAgIHZhciBwYXJzZWREYXRlID0gcGFyc2VEYXRlKHZhbHVlLCBwcmV2aW91c0RhdGUpO1xuXHQgICAgICAgIGlmICh0aW1lem9uZSkge1xuXHQgICAgICAgICAgcGFyc2VkRGF0ZSA9IGNvbnZlcnRUaW1lem9uZVRvTG9jYWwocGFyc2VkRGF0ZSwgdGltZXpvbmUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gcGFyc2VkRGF0ZTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuXHQgICAgfSk7XG5cdFxuXHQgICAgY3RybC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgIGlmICh2YWx1ZSAmJiAhaXNEYXRlKHZhbHVlKSkge1xuXHQgICAgICAgIHRocm93IG5nTW9kZWxNaW5FcnIoJ2RhdGVmbXQnLCAnRXhwZWN0ZWQgYHswfWAgdG8gYmUgYSBkYXRlJywgdmFsdWUpO1xuXHQgICAgICB9XG5cdCAgICAgIGlmIChpc1ZhbGlkRGF0ZSh2YWx1ZSkpIHtcblx0ICAgICAgICBwcmV2aW91c0RhdGUgPSB2YWx1ZTtcblx0ICAgICAgICBpZiAocHJldmlvdXNEYXRlICYmIHRpbWV6b25lKSB7XG5cdCAgICAgICAgICBwcmV2aW91c0RhdGUgPSBjb252ZXJ0VGltZXpvbmVUb0xvY2FsKHByZXZpb3VzRGF0ZSwgdGltZXpvbmUsIHRydWUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gJGZpbHRlcignZGF0ZScpKHZhbHVlLCBmb3JtYXQsIHRpbWV6b25lKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBwcmV2aW91c0RhdGUgPSBudWxsO1xuXHQgICAgICAgIHJldHVybiAnJztcblx0ICAgICAgfVxuXHQgICAgfSk7XG5cdFxuXHQgICAgaWYgKGlzRGVmaW5lZChhdHRyLm1pbikgfHwgYXR0ci5uZ01pbikge1xuXHQgICAgICB2YXIgbWluVmFsO1xuXHQgICAgICBjdHJsLiR2YWxpZGF0b3JzLm1pbiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgcmV0dXJuICFpc1ZhbGlkRGF0ZSh2YWx1ZSkgfHwgaXNVbmRlZmluZWQobWluVmFsKSB8fCBwYXJzZURhdGUodmFsdWUpID49IG1pblZhbDtcblx0ICAgICAgfTtcblx0ICAgICAgYXR0ci4kb2JzZXJ2ZSgnbWluJywgZnVuY3Rpb24odmFsKSB7XG5cdCAgICAgICAgbWluVmFsID0gcGFyc2VPYnNlcnZlZERhdGVWYWx1ZSh2YWwpO1xuXHQgICAgICAgIGN0cmwuJHZhbGlkYXRlKCk7XG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmIChpc0RlZmluZWQoYXR0ci5tYXgpIHx8IGF0dHIubmdNYXgpIHtcblx0ICAgICAgdmFyIG1heFZhbDtcblx0ICAgICAgY3RybC4kdmFsaWRhdG9ycy5tYXggPSBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgIHJldHVybiAhaXNWYWxpZERhdGUodmFsdWUpIHx8IGlzVW5kZWZpbmVkKG1heFZhbCkgfHwgcGFyc2VEYXRlKHZhbHVlKSA8PSBtYXhWYWw7XG5cdCAgICAgIH07XG5cdCAgICAgIGF0dHIuJG9ic2VydmUoJ21heCcsIGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgICAgIG1heFZhbCA9IHBhcnNlT2JzZXJ2ZWREYXRlVmFsdWUodmFsKTtcblx0ICAgICAgICBjdHJsLiR2YWxpZGF0ZSgpO1xuXHQgICAgICB9KTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBpc1ZhbGlkRGF0ZSh2YWx1ZSkge1xuXHQgICAgICAvLyBJbnZhbGlkIERhdGU6IGdldFRpbWUoKSByZXR1cm5zIE5hTlxuXHQgICAgICByZXR1cm4gdmFsdWUgJiYgISh2YWx1ZS5nZXRUaW1lICYmIHZhbHVlLmdldFRpbWUoKSAhPT0gdmFsdWUuZ2V0VGltZSgpKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBwYXJzZU9ic2VydmVkRGF0ZVZhbHVlKHZhbCkge1xuXHQgICAgICByZXR1cm4gaXNEZWZpbmVkKHZhbCkgJiYgIWlzRGF0ZSh2YWwpID8gcGFyc2VEYXRlKHZhbCkgfHwgdW5kZWZpbmVkIDogdmFsO1xuXHQgICAgfVxuXHQgIH07XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGJhZElucHV0Q2hlY2tlcihzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCkge1xuXHQgIHZhciBub2RlID0gZWxlbWVudFswXTtcblx0ICB2YXIgbmF0aXZlVmFsaWRhdGlvbiA9IGN0cmwuJCRoYXNOYXRpdmVWYWxpZGF0b3JzID0gaXNPYmplY3Qobm9kZS52YWxpZGl0eSk7XG5cdCAgaWYgKG5hdGl2ZVZhbGlkYXRpb24pIHtcblx0ICAgIGN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICB2YXIgdmFsaWRpdHkgPSBlbGVtZW50LnByb3AoVkFMSURJVFlfU1RBVEVfUFJPUEVSVFkpIHx8IHt9O1xuXHQgICAgICByZXR1cm4gdmFsaWRpdHkuYmFkSW5wdXQgfHwgdmFsaWRpdHkudHlwZU1pc21hdGNoID8gdW5kZWZpbmVkIDogdmFsdWU7XG5cdCAgICB9KTtcblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIG51bWJlcklucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyKSB7XG5cdCAgYmFkSW5wdXRDaGVja2VyKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKTtcblx0ICBiYXNlSW5wdXRUeXBlKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsLCAkc25pZmZlciwgJGJyb3dzZXIpO1xuXHRcblx0ICBjdHJsLiQkcGFyc2VyTmFtZSA9ICdudW1iZXInO1xuXHQgIGN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgaWYgKGN0cmwuJGlzRW1wdHkodmFsdWUpKSAgICAgIHJldHVybiBudWxsO1xuXHQgICAgaWYgKE5VTUJFUl9SRUdFWFAudGVzdCh2YWx1ZSkpIHJldHVybiBwYXJzZUZsb2F0KHZhbHVlKTtcblx0ICAgIHJldHVybiB1bmRlZmluZWQ7XG5cdCAgfSk7XG5cdFxuXHQgIGN0cmwuJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgaWYgKCFjdHJsLiRpc0VtcHR5KHZhbHVlKSkge1xuXHQgICAgICBpZiAoIWlzTnVtYmVyKHZhbHVlKSkge1xuXHQgICAgICAgIHRocm93IG5nTW9kZWxNaW5FcnIoJ251bWZtdCcsICdFeHBlY3RlZCBgezB9YCB0byBiZSBhIG51bWJlcicsIHZhbHVlKTtcblx0ICAgICAgfVxuXHQgICAgICB2YWx1ZSA9IHZhbHVlLnRvU3RyaW5nKCk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gdmFsdWU7XG5cdCAgfSk7XG5cdFxuXHQgIGlmIChpc0RlZmluZWQoYXR0ci5taW4pIHx8IGF0dHIubmdNaW4pIHtcblx0ICAgIHZhciBtaW5WYWw7XG5cdCAgICBjdHJsLiR2YWxpZGF0b3JzLm1pbiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgIHJldHVybiBjdHJsLiRpc0VtcHR5KHZhbHVlKSB8fCBpc1VuZGVmaW5lZChtaW5WYWwpIHx8IHZhbHVlID49IG1pblZhbDtcblx0ICAgIH07XG5cdFxuXHQgICAgYXR0ci4kb2JzZXJ2ZSgnbWluJywgZnVuY3Rpb24odmFsKSB7XG5cdCAgICAgIGlmIChpc0RlZmluZWQodmFsKSAmJiAhaXNOdW1iZXIodmFsKSkge1xuXHQgICAgICAgIHZhbCA9IHBhcnNlRmxvYXQodmFsLCAxMCk7XG5cdCAgICAgIH1cblx0ICAgICAgbWluVmFsID0gaXNOdW1iZXIodmFsKSAmJiAhaXNOYU4odmFsKSA/IHZhbCA6IHVuZGVmaW5lZDtcblx0ICAgICAgLy8gVE9ETyhtYXRza28pOiBpbXBsZW1lbnQgdmFsaWRhdGVMYXRlciB0byByZWR1Y2UgbnVtYmVyIG9mIHZhbGlkYXRpb25zXG5cdCAgICAgIGN0cmwuJHZhbGlkYXRlKCk7XG5cdCAgICB9KTtcblx0ICB9XG5cdFxuXHQgIGlmIChpc0RlZmluZWQoYXR0ci5tYXgpIHx8IGF0dHIubmdNYXgpIHtcblx0ICAgIHZhciBtYXhWYWw7XG5cdCAgICBjdHJsLiR2YWxpZGF0b3JzLm1heCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgIHJldHVybiBjdHJsLiRpc0VtcHR5KHZhbHVlKSB8fCBpc1VuZGVmaW5lZChtYXhWYWwpIHx8IHZhbHVlIDw9IG1heFZhbDtcblx0ICAgIH07XG5cdFxuXHQgICAgYXR0ci4kb2JzZXJ2ZSgnbWF4JywgZnVuY3Rpb24odmFsKSB7XG5cdCAgICAgIGlmIChpc0RlZmluZWQodmFsKSAmJiAhaXNOdW1iZXIodmFsKSkge1xuXHQgICAgICAgIHZhbCA9IHBhcnNlRmxvYXQodmFsLCAxMCk7XG5cdCAgICAgIH1cblx0ICAgICAgbWF4VmFsID0gaXNOdW1iZXIodmFsKSAmJiAhaXNOYU4odmFsKSA/IHZhbCA6IHVuZGVmaW5lZDtcblx0ICAgICAgLy8gVE9ETyhtYXRza28pOiBpbXBsZW1lbnQgdmFsaWRhdGVMYXRlciB0byByZWR1Y2UgbnVtYmVyIG9mIHZhbGlkYXRpb25zXG5cdCAgICAgIGN0cmwuJHZhbGlkYXRlKCk7XG5cdCAgICB9KTtcblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHVybElucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyKSB7XG5cdCAgLy8gTm90ZTogbm8gYmFkSW5wdXRDaGVja2VyIGhlcmUgYnkgcHVycG9zZSBhcyBgdXJsYCBpcyBvbmx5IGEgdmFsaWRhdGlvblxuXHQgIC8vIGluIGJyb3dzZXJzLCBpLmUuIHdlIGNhbiBhbHdheXMgcmVhZCBvdXQgaW5wdXQudmFsdWUgZXZlbiBpZiBpdCBpcyBub3QgdmFsaWQhXG5cdCAgYmFzZUlucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyKTtcblx0ICBzdHJpbmdCYXNlZElucHV0VHlwZShjdHJsKTtcblx0XG5cdCAgY3RybC4kJHBhcnNlck5hbWUgPSAndXJsJztcblx0ICBjdHJsLiR2YWxpZGF0b3JzLnVybCA9IGZ1bmN0aW9uKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSkge1xuXHQgICAgdmFyIHZhbHVlID0gbW9kZWxWYWx1ZSB8fCB2aWV3VmFsdWU7XG5cdCAgICByZXR1cm4gY3RybC4kaXNFbXB0eSh2YWx1ZSkgfHwgVVJMX1JFR0VYUC50ZXN0KHZhbHVlKTtcblx0ICB9O1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBlbWFpbElucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyKSB7XG5cdCAgLy8gTm90ZTogbm8gYmFkSW5wdXRDaGVja2VyIGhlcmUgYnkgcHVycG9zZSBhcyBgdXJsYCBpcyBvbmx5IGEgdmFsaWRhdGlvblxuXHQgIC8vIGluIGJyb3dzZXJzLCBpLmUuIHdlIGNhbiBhbHdheXMgcmVhZCBvdXQgaW5wdXQudmFsdWUgZXZlbiBpZiBpdCBpcyBub3QgdmFsaWQhXG5cdCAgYmFzZUlucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyKTtcblx0ICBzdHJpbmdCYXNlZElucHV0VHlwZShjdHJsKTtcblx0XG5cdCAgY3RybC4kJHBhcnNlck5hbWUgPSAnZW1haWwnO1xuXHQgIGN0cmwuJHZhbGlkYXRvcnMuZW1haWwgPSBmdW5jdGlvbihtb2RlbFZhbHVlLCB2aWV3VmFsdWUpIHtcblx0ICAgIHZhciB2YWx1ZSA9IG1vZGVsVmFsdWUgfHwgdmlld1ZhbHVlO1xuXHQgICAgcmV0dXJuIGN0cmwuJGlzRW1wdHkodmFsdWUpIHx8IEVNQUlMX1JFR0VYUC50ZXN0KHZhbHVlKTtcblx0ICB9O1xuXHR9XG5cdFxuXHRmdW5jdGlvbiByYWRpb0lucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCkge1xuXHQgIC8vIG1ha2UgdGhlIG5hbWUgdW5pcXVlLCBpZiBub3QgZGVmaW5lZFxuXHQgIGlmIChpc1VuZGVmaW5lZChhdHRyLm5hbWUpKSB7XG5cdCAgICBlbGVtZW50LmF0dHIoJ25hbWUnLCBuZXh0VWlkKCkpO1xuXHQgIH1cblx0XG5cdCAgdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXYpIHtcblx0ICAgIGlmIChlbGVtZW50WzBdLmNoZWNrZWQpIHtcblx0ICAgICAgY3RybC4kc2V0Vmlld1ZhbHVlKGF0dHIudmFsdWUsIGV2ICYmIGV2LnR5cGUpO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIGVsZW1lbnQub24oJ2NsaWNrJywgbGlzdGVuZXIpO1xuXHRcblx0ICBjdHJsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHtcblx0ICAgIHZhciB2YWx1ZSA9IGF0dHIudmFsdWU7XG5cdCAgICBlbGVtZW50WzBdLmNoZWNrZWQgPSAodmFsdWUgPT0gY3RybC4kdmlld1ZhbHVlKTtcblx0ICB9O1xuXHRcblx0ICBhdHRyLiRvYnNlcnZlKCd2YWx1ZScsIGN0cmwuJHJlbmRlcik7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHBhcnNlQ29uc3RhbnRFeHByKCRwYXJzZSwgY29udGV4dCwgbmFtZSwgZXhwcmVzc2lvbiwgZmFsbGJhY2spIHtcblx0ICB2YXIgcGFyc2VGbjtcblx0ICBpZiAoaXNEZWZpbmVkKGV4cHJlc3Npb24pKSB7XG5cdCAgICBwYXJzZUZuID0gJHBhcnNlKGV4cHJlc3Npb24pO1xuXHQgICAgaWYgKCFwYXJzZUZuLmNvbnN0YW50KSB7XG5cdCAgICAgIHRocm93IG5nTW9kZWxNaW5FcnIoJ2NvbnN0ZXhwcicsICdFeHBlY3RlZCBjb25zdGFudCBleHByZXNzaW9uIGZvciBgezB9YCwgYnV0IHNhdyAnICtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYHsxfWAuJywgbmFtZSwgZXhwcmVzc2lvbik7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gcGFyc2VGbihjb250ZXh0KTtcblx0ICB9XG5cdCAgcmV0dXJuIGZhbGxiYWNrO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBjaGVja2JveElucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyLCAkZmlsdGVyLCAkcGFyc2UpIHtcblx0ICB2YXIgdHJ1ZVZhbHVlID0gcGFyc2VDb25zdGFudEV4cHIoJHBhcnNlLCBzY29wZSwgJ25nVHJ1ZVZhbHVlJywgYXR0ci5uZ1RydWVWYWx1ZSwgdHJ1ZSk7XG5cdCAgdmFyIGZhbHNlVmFsdWUgPSBwYXJzZUNvbnN0YW50RXhwcigkcGFyc2UsIHNjb3BlLCAnbmdGYWxzZVZhbHVlJywgYXR0ci5uZ0ZhbHNlVmFsdWUsIGZhbHNlKTtcblx0XG5cdCAgdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXYpIHtcblx0ICAgIGN0cmwuJHNldFZpZXdWYWx1ZShlbGVtZW50WzBdLmNoZWNrZWQsIGV2ICYmIGV2LnR5cGUpO1xuXHQgIH07XG5cdFxuXHQgIGVsZW1lbnQub24oJ2NsaWNrJywgbGlzdGVuZXIpO1xuXHRcblx0ICBjdHJsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHtcblx0ICAgIGVsZW1lbnRbMF0uY2hlY2tlZCA9IGN0cmwuJHZpZXdWYWx1ZTtcblx0ICB9O1xuXHRcblx0ICAvLyBPdmVycmlkZSB0aGUgc3RhbmRhcmQgYCRpc0VtcHR5YCBiZWNhdXNlIHRoZSAkdmlld1ZhbHVlIG9mIGFuIGVtcHR5IGNoZWNrYm94IGlzIGFsd2F5cyBzZXQgdG8gYGZhbHNlYFxuXHQgIC8vIFRoaXMgaXMgYmVjYXVzZSBvZiB0aGUgcGFyc2VyIGJlbG93LCB3aGljaCBjb21wYXJlcyB0aGUgYCRtb2RlbFZhbHVlYCB3aXRoIGB0cnVlVmFsdWVgIHRvIGNvbnZlcnRcblx0ICAvLyBpdCB0byBhIGJvb2xlYW4uXG5cdCAgY3RybC4kaXNFbXB0eSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICByZXR1cm4gdmFsdWUgPT09IGZhbHNlO1xuXHQgIH07XG5cdFxuXHQgIGN0cmwuJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgcmV0dXJuIGVxdWFscyh2YWx1ZSwgdHJ1ZVZhbHVlKTtcblx0ICB9KTtcblx0XG5cdCAgY3RybC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICByZXR1cm4gdmFsdWUgPyB0cnVlVmFsdWUgOiBmYWxzZVZhbHVlO1xuXHQgIH0pO1xuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgdGV4dGFyZWFcblx0ICogQHJlc3RyaWN0IEVcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEhUTUwgdGV4dGFyZWEgZWxlbWVudCBjb250cm9sIHdpdGggYW5ndWxhciBkYXRhLWJpbmRpbmcuIFRoZSBkYXRhLWJpbmRpbmcgYW5kIHZhbGlkYXRpb25cblx0ICogcHJvcGVydGllcyBvZiB0aGlzIGVsZW1lbnQgYXJlIGV4YWN0bHkgdGhlIHNhbWUgYXMgdGhvc2Ugb2YgdGhlXG5cdCAqIHtAbGluayBuZy5kaXJlY3RpdmU6aW5wdXQgaW5wdXQgZWxlbWVudH0uXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBuZ01vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cblx0ICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG5cdCAqIEBwYXJhbSB7c3RyaW5nPX0gbmdSZXF1aXJlZCBBZGRzIGByZXF1aXJlZGAgYXR0cmlidXRlIGFuZCBgcmVxdWlyZWRgIHZhbGlkYXRpb24gY29uc3RyYWludCB0b1xuXHQgKiAgICB0aGUgZWxlbWVudCB3aGVuIHRoZSBuZ1JlcXVpcmVkIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIHRydWUuIFVzZSBgbmdSZXF1aXJlZGAgaW5zdGVhZCBvZlxuXHQgKiAgICBgcmVxdWlyZWRgIHdoZW4geW91IHdhbnQgdG8gZGF0YS1iaW5kIHRvIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0ZS5cblx0ICogQHBhcmFtIHtudW1iZXI9fSBuZ01pbmxlbmd0aCBTZXRzIGBtaW5sZW5ndGhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBzaG9ydGVyIHRoYW5cblx0ICogICAgbWlubGVuZ3RoLlxuXHQgKiBAcGFyYW0ge251bWJlcj19IG5nTWF4bGVuZ3RoIFNldHMgYG1heGxlbmd0aGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIGxvbmdlciB0aGFuXG5cdCAqICAgIG1heGxlbmd0aC4gU2V0dGluZyB0aGUgYXR0cmlidXRlIHRvIGEgbmVnYXRpdmUgb3Igbm9uLW51bWVyaWMgdmFsdWUsIGFsbG93cyB2aWV3IHZhbHVlcyBvZiBhbnlcblx0ICogICAgbGVuZ3RoLlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IG5nUGF0dGVybiBTZXRzIGBwYXR0ZXJuYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgbmdNb2RlbCB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmlld1ZhbHVlICR2aWV3VmFsdWV9XG5cdCAqICAgIGRvZXMgbm90IG1hdGNoIGEgUmVnRXhwIGZvdW5kIGJ5IGV2YWx1YXRpbmcgdGhlIEFuZ3VsYXIgZXhwcmVzc2lvbiBnaXZlbiBpbiB0aGUgYXR0cmlidXRlIHZhbHVlLlxuXHQgKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBSZWdFeHAgb2JqZWN0LCB0aGVuIHRoaXMgaXMgdXNlZCBkaXJlY3RseS5cblx0ICogICAgSWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgc3RyaW5nLCB0aGVuIGl0IHdpbGwgYmUgY29udmVydGVkIHRvIGEgUmVnRXhwXG5cdCAqICAgIGFmdGVyIHdyYXBwaW5nIGl0IGluIGBeYCBhbmQgYCRgIGNoYXJhY3RlcnMuIEZvciBpbnN0YW5jZSwgYFwiYWJjXCJgIHdpbGwgYmUgY29udmVydGVkIHRvXG5cdCAqICAgIGBuZXcgUmVnRXhwKCdeYWJjJCcpYC48YnIgLz5cblx0ICogICAgKipOb3RlOioqIEF2b2lkIHVzaW5nIHRoZSBgZ2AgZmxhZyBvbiB0aGUgUmVnRXhwLCBhcyBpdCB3aWxsIGNhdXNlIGVhY2ggc3VjY2Vzc2l2ZSBzZWFyY2ggdG9cblx0ICogICAgc3RhcnQgYXQgdGhlIGluZGV4IG9mIHRoZSBsYXN0IHNlYXJjaCdzIG1hdGNoLCB0aHVzIG5vdCB0YWtpbmcgdGhlIHdob2xlIGlucHV0IHZhbHVlIGludG9cblx0ICogICAgYWNjb3VudC5cblx0ICogQHBhcmFtIHtzdHJpbmc9fSBuZ0NoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyXG5cdCAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG5cdCAqIEBwYXJhbSB7Ym9vbGVhbj19IFtuZ1RyaW09dHJ1ZV0gSWYgc2V0IHRvIGZhbHNlIEFuZ3VsYXIgd2lsbCBub3QgYXV0b21hdGljYWxseSB0cmltIHRoZSBpbnB1dC5cblx0ICovXG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgaW5wdXRcblx0ICogQHJlc3RyaWN0IEVcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEhUTUwgaW5wdXQgZWxlbWVudCBjb250cm9sLiBXaGVuIHVzZWQgdG9nZXRoZXIgd2l0aCB7QGxpbmsgbmdNb2RlbCBgbmdNb2RlbGB9LCBpdCBwcm92aWRlcyBkYXRhLWJpbmRpbmcsXG5cdCAqIGlucHV0IHN0YXRlIGNvbnRyb2wsIGFuZCB2YWxpZGF0aW9uLlxuXHQgKiBJbnB1dCBjb250cm9sIGZvbGxvd3MgSFRNTDUgaW5wdXQgdHlwZXMgYW5kIHBvbHlmaWxscyB0aGUgSFRNTDUgdmFsaWRhdGlvbiBiZWhhdmlvciBmb3Igb2xkZXIgYnJvd3NlcnMuXG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG5cdCAqICoqTm90ZToqKiBOb3QgZXZlcnkgZmVhdHVyZSBvZmZlcmVkIGlzIGF2YWlsYWJsZSBmb3IgYWxsIGlucHV0IHR5cGVzLlxuXHQgKiBTcGVjaWZpY2FsbHksIGRhdGEgYmluZGluZyBhbmQgZXZlbnQgaGFuZGxpbmcgdmlhIGBuZy1tb2RlbGAgaXMgdW5zdXBwb3J0ZWQgZm9yIGBpbnB1dFtmaWxlXWAuXG5cdCAqIDwvZGl2PlxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gbmdNb2RlbCBBc3NpZ25hYmxlIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBkYXRhLWJpbmQgdG8uXG5cdCAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cblx0ICogQHBhcmFtIHtzdHJpbmc9fSByZXF1aXJlZCBTZXRzIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIG5vdCBlbnRlcmVkLlxuXHQgKiBAcGFyYW0ge2Jvb2xlYW49fSBuZ1JlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgaWYgc2V0IHRvIHRydWVcblx0ICogQHBhcmFtIHtudW1iZXI9fSBuZ01pbmxlbmd0aCBTZXRzIGBtaW5sZW5ndGhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBzaG9ydGVyIHRoYW5cblx0ICogICAgbWlubGVuZ3RoLlxuXHQgKiBAcGFyYW0ge251bWJlcj19IG5nTWF4bGVuZ3RoIFNldHMgYG1heGxlbmd0aGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIGxvbmdlciB0aGFuXG5cdCAqICAgIG1heGxlbmd0aC4gU2V0dGluZyB0aGUgYXR0cmlidXRlIHRvIGEgbmVnYXRpdmUgb3Igbm9uLW51bWVyaWMgdmFsdWUsIGFsbG93cyB2aWV3IHZhbHVlcyBvZiBhbnlcblx0ICogICAgbGVuZ3RoLlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IG5nUGF0dGVybiBTZXRzIGBwYXR0ZXJuYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgbmdNb2RlbCB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmlld1ZhbHVlICR2aWV3VmFsdWV9XG5cdCAqICAgIHZhbHVlIGRvZXMgbm90IG1hdGNoIGEgUmVnRXhwIGZvdW5kIGJ5IGV2YWx1YXRpbmcgdGhlIEFuZ3VsYXIgZXhwcmVzc2lvbiBnaXZlbiBpbiB0aGUgYXR0cmlidXRlIHZhbHVlLlxuXHQgKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBSZWdFeHAgb2JqZWN0LCB0aGVuIHRoaXMgaXMgdXNlZCBkaXJlY3RseS5cblx0ICogICAgSWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgc3RyaW5nLCB0aGVuIGl0IHdpbGwgYmUgY29udmVydGVkIHRvIGEgUmVnRXhwXG5cdCAqICAgIGFmdGVyIHdyYXBwaW5nIGl0IGluIGBeYCBhbmQgYCRgIGNoYXJhY3RlcnMuIEZvciBpbnN0YW5jZSwgYFwiYWJjXCJgIHdpbGwgYmUgY29udmVydGVkIHRvXG5cdCAqICAgIGBuZXcgUmVnRXhwKCdeYWJjJCcpYC48YnIgLz5cblx0ICogICAgKipOb3RlOioqIEF2b2lkIHVzaW5nIHRoZSBgZ2AgZmxhZyBvbiB0aGUgUmVnRXhwLCBhcyBpdCB3aWxsIGNhdXNlIGVhY2ggc3VjY2Vzc2l2ZSBzZWFyY2ggdG9cblx0ICogICAgc3RhcnQgYXQgdGhlIGluZGV4IG9mIHRoZSBsYXN0IHNlYXJjaCdzIG1hdGNoLCB0aHVzIG5vdCB0YWtpbmcgdGhlIHdob2xlIGlucHV0IHZhbHVlIGludG9cblx0ICogICAgYWNjb3VudC5cblx0ICogQHBhcmFtIHtzdHJpbmc9fSBuZ0NoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyXG5cdCAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG5cdCAqIEBwYXJhbSB7Ym9vbGVhbj19IFtuZ1RyaW09dHJ1ZV0gSWYgc2V0IHRvIGZhbHNlIEFuZ3VsYXIgd2lsbCBub3QgYXV0b21hdGljYWxseSB0cmltIHRoZSBpbnB1dC5cblx0ICogICAgVGhpcyBwYXJhbWV0ZXIgaXMgaWdub3JlZCBmb3IgaW5wdXRbdHlwZT1wYXNzd29yZF0gY29udHJvbHMsIHdoaWNoIHdpbGwgbmV2ZXIgdHJpbSB0aGVcblx0ICogICAgaW5wdXQuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgICA8ZXhhbXBsZSBuYW1lPVwiaW5wdXQtZGlyZWN0aXZlXCIgbW9kdWxlPVwiaW5wdXRFeGFtcGxlXCI+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICA8c2NyaXB0PlxuXHQgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2lucHV0RXhhbXBsZScsIFtdKVxuXHQgICAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgICAgICRzY29wZS51c2VyID0ge25hbWU6ICdndWVzdCcsIGxhc3Q6ICd2aXNpdG9yJ307XG5cdCAgICAgICAgICAgIH1dKTtcblx0ICAgICAgIDwvc2NyaXB0PlxuXHQgICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiPlxuXHQgICAgICAgICAgIDxsYWJlbD5cblx0ICAgICAgICAgICAgICBVc2VyIG5hbWU6XG5cdCAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmFtZT1cInVzZXJOYW1lXCIgbmctbW9kZWw9XCJ1c2VyLm5hbWVcIiByZXF1aXJlZD5cblx0ICAgICAgICAgICA8L2xhYmVsPlxuXHQgICAgICAgICAgIDxkaXYgcm9sZT1cImFsZXJ0XCI+XG5cdCAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS51c2VyTmFtZS4kZXJyb3IucmVxdWlyZWRcIj5cblx0ICAgICAgICAgICAgICBSZXF1aXJlZCE8L3NwYW4+XG5cdCAgICAgICAgICAgPC9kaXY+XG5cdCAgICAgICAgICAgPGxhYmVsPlxuXHQgICAgICAgICAgICAgIExhc3QgbmFtZTpcblx0ICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwibGFzdE5hbWVcIiBuZy1tb2RlbD1cInVzZXIubGFzdFwiXG5cdCAgICAgICAgICAgICAgbmctbWlubGVuZ3RoPVwiM1wiIG5nLW1heGxlbmd0aD1cIjEwXCI+XG5cdCAgICAgICAgICAgPC9sYWJlbD5cblx0ICAgICAgICAgICA8ZGl2IHJvbGU9XCJhbGVydFwiPlxuXHQgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0ubGFzdE5hbWUuJGVycm9yLm1pbmxlbmd0aFwiPlxuXHQgICAgICAgICAgICAgICBUb28gc2hvcnQhPC9zcGFuPlxuXHQgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0ubGFzdE5hbWUuJGVycm9yLm1heGxlbmd0aFwiPlxuXHQgICAgICAgICAgICAgICBUb28gbG9uZyE8L3NwYW4+XG5cdCAgICAgICAgICAgPC9kaXY+XG5cdCAgICAgICAgIDwvZm9ybT5cblx0ICAgICAgICAgPGhyPlxuXHQgICAgICAgICA8dHQ+dXNlciA9IHt7dXNlcn19PC90dD48YnIvPlxuXHQgICAgICAgICA8dHQ+bXlGb3JtLnVzZXJOYW1lLiR2YWxpZCA9IHt7bXlGb3JtLnVzZXJOYW1lLiR2YWxpZH19PC90dD48YnIvPlxuXHQgICAgICAgICA8dHQ+bXlGb3JtLnVzZXJOYW1lLiRlcnJvciA9IHt7bXlGb3JtLnVzZXJOYW1lLiRlcnJvcn19PC90dD48YnIvPlxuXHQgICAgICAgICA8dHQ+bXlGb3JtLmxhc3ROYW1lLiR2YWxpZCA9IHt7bXlGb3JtLmxhc3ROYW1lLiR2YWxpZH19PC90dD48YnIvPlxuXHQgICAgICAgICA8dHQ+bXlGb3JtLmxhc3ROYW1lLiRlcnJvciA9IHt7bXlGb3JtLmxhc3ROYW1lLiRlcnJvcn19PC90dD48YnIvPlxuXHQgICAgICAgICA8dHQ+bXlGb3JtLiR2YWxpZCA9IHt7bXlGb3JtLiR2YWxpZH19PC90dD48YnIvPlxuXHQgICAgICAgICA8dHQ+bXlGb3JtLiRlcnJvci5yZXF1aXJlZCA9IHt7ISFteUZvcm0uJGVycm9yLnJlcXVpcmVkfX08L3R0Pjxici8+XG5cdCAgICAgICAgIDx0dD5teUZvcm0uJGVycm9yLm1pbmxlbmd0aCA9IHt7ISFteUZvcm0uJGVycm9yLm1pbmxlbmd0aH19PC90dD48YnIvPlxuXHQgICAgICAgICA8dHQ+bXlGb3JtLiRlcnJvci5tYXhsZW5ndGggPSB7eyEhbXlGb3JtLiRlcnJvci5tYXhsZW5ndGh9fTwvdHQ+PGJyLz5cblx0ICAgICAgIDwvZGl2PlxuXHQgICAgICA8L2ZpbGU+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgICB2YXIgdXNlciA9IGVsZW1lbnQoYnkuZXhhY3RCaW5kaW5nKCd1c2VyJykpO1xuXHQgICAgICAgIHZhciB1c2VyTmFtZVZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0udXNlck5hbWUuJHZhbGlkJykpO1xuXHQgICAgICAgIHZhciBsYXN0TmFtZVZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0ubGFzdE5hbWUuJHZhbGlkJykpO1xuXHQgICAgICAgIHZhciBsYXN0TmFtZUVycm9yID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0ubGFzdE5hbWUuJGVycm9yJykpO1xuXHQgICAgICAgIHZhciBmb3JtVmFsaWQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ215Rm9ybS4kdmFsaWQnKSk7XG5cdCAgICAgICAgdmFyIHVzZXJOYW1lSW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCd1c2VyLm5hbWUnKSk7XG5cdCAgICAgICAgdmFyIHVzZXJMYXN0SW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCd1c2VyLmxhc3QnKSk7XG5cdFxuXHQgICAgICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB0byBtb2RlbCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgZXhwZWN0KHVzZXIuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3tcIm5hbWVcIjpcImd1ZXN0XCIsXCJsYXN0XCI6XCJ2aXNpdG9yXCJ9Jyk7XG5cdCAgICAgICAgICBleHBlY3QodXNlck5hbWVWYWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbigndHJ1ZScpO1xuXHQgICAgICAgICAgZXhwZWN0KGZvcm1WYWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbigndHJ1ZScpO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgZW1wdHkgd2hlbiByZXF1aXJlZCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgdXNlck5hbWVJbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICAgdXNlck5hbWVJbnB1dC5zZW5kS2V5cygnJyk7XG5cdFxuXHQgICAgICAgICAgZXhwZWN0KHVzZXIuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3tcImxhc3RcIjpcInZpc2l0b3JcIn0nKTtcblx0ICAgICAgICAgIGV4cGVjdCh1c2VyTmFtZVZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdmYWxzZScpO1xuXHQgICAgICAgICAgZXhwZWN0KGZvcm1WYWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgaXQoJ3Nob3VsZCBiZSB2YWxpZCBpZiBlbXB0eSB3aGVuIG1pbiBsZW5ndGggaXMgc2V0JywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICB1c2VyTGFzdElucHV0LmNsZWFyKCk7XG5cdCAgICAgICAgICB1c2VyTGFzdElucHV0LnNlbmRLZXlzKCcnKTtcblx0XG5cdCAgICAgICAgICBleHBlY3QodXNlci5nZXRUZXh0KCkpLnRvQ29udGFpbigne1wibmFtZVwiOlwiZ3Vlc3RcIixcImxhc3RcIjpcIlwifScpO1xuXHQgICAgICAgICAgZXhwZWN0KGxhc3ROYW1lVmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcblx0ICAgICAgICAgIGV4cGVjdChmb3JtVmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIGxlc3MgdGhhbiByZXF1aXJlZCBtaW4gbGVuZ3RoJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICB1c2VyTGFzdElucHV0LmNsZWFyKCk7XG5cdCAgICAgICAgICB1c2VyTGFzdElucHV0LnNlbmRLZXlzKCd4eCcpO1xuXHRcblx0ICAgICAgICAgIGV4cGVjdCh1c2VyLmdldFRleHQoKSkudG9Db250YWluKCd7XCJuYW1lXCI6XCJndWVzdFwifScpO1xuXHQgICAgICAgICAgZXhwZWN0KGxhc3ROYW1lVmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2ZhbHNlJyk7XG5cdCAgICAgICAgICBleHBlY3QobGFzdE5hbWVFcnJvci5nZXRUZXh0KCkpLnRvQ29udGFpbignbWlubGVuZ3RoJyk7XG5cdCAgICAgICAgICBleHBlY3QoZm9ybVZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdmYWxzZScpO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgbG9uZ2VyIHRoYW4gbWF4IGxlbmd0aCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgdXNlckxhc3RJbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICAgdXNlckxhc3RJbnB1dC5zZW5kS2V5cygnc29tZSByaWRpY3Vsb3VzbHkgbG9uZyBuYW1lJyk7XG5cdFxuXHQgICAgICAgICAgZXhwZWN0KHVzZXIuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3tcIm5hbWVcIjpcImd1ZXN0XCJ9Jyk7XG5cdCAgICAgICAgICBleHBlY3QobGFzdE5hbWVWYWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcblx0ICAgICAgICAgIGV4cGVjdChsYXN0TmFtZUVycm9yLmdldFRleHQoKSkudG9Db250YWluKCdtYXhsZW5ndGgnKTtcblx0ICAgICAgICAgIGV4cGVjdChmb3JtVmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2ZhbHNlJyk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIDwvZmlsZT5cblx0ICAgIDwvZXhhbXBsZT5cblx0ICovXG5cdHZhciBpbnB1dERpcmVjdGl2ZSA9IFsnJGJyb3dzZXInLCAnJHNuaWZmZXInLCAnJGZpbHRlcicsICckcGFyc2UnLFxuXHQgICAgZnVuY3Rpb24oJGJyb3dzZXIsICRzbmlmZmVyLCAkZmlsdGVyLCAkcGFyc2UpIHtcblx0ICByZXR1cm4ge1xuXHQgICAgcmVzdHJpY3Q6ICdFJyxcblx0ICAgIHJlcXVpcmU6IFsnP25nTW9kZWwnXSxcblx0ICAgIGxpbms6IHtcblx0ICAgICAgcHJlOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHMpIHtcblx0ICAgICAgICBpZiAoY3RybHNbMF0pIHtcblx0ICAgICAgICAgIChpbnB1dFR5cGVbbG93ZXJjYXNlKGF0dHIudHlwZSldIHx8IGlucHV0VHlwZS50ZXh0KShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHNbMF0sICRzbmlmZmVyLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRicm93c2VyLCAkZmlsdGVyLCAkcGFyc2UpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH07XG5cdH1dO1xuXHRcblx0XG5cdFxuXHR2YXIgQ09OU1RBTlRfVkFMVUVfUkVHRVhQID0gL14odHJ1ZXxmYWxzZXxcXGQrKSQvO1xuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ1ZhbHVlXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBCaW5kcyB0aGUgZ2l2ZW4gZXhwcmVzc2lvbiB0byB0aGUgdmFsdWUgb2YgYDxvcHRpb24+YCBvciB7QGxpbmsgaW5wdXRbcmFkaW9dIGBpbnB1dFtyYWRpb11gfSxcblx0ICogc28gdGhhdCB3aGVuIHRoZSBlbGVtZW50IGlzIHNlbGVjdGVkLCB0aGUge0BsaW5rIG5nTW9kZWwgYG5nTW9kZWxgfSBvZiB0aGF0IGVsZW1lbnQgaXMgc2V0IHRvXG5cdCAqIHRoZSBib3VuZCB2YWx1ZS5cblx0ICpcblx0ICogYG5nVmFsdWVgIGlzIHVzZWZ1bCB3aGVuIGR5bmFtaWNhbGx5IGdlbmVyYXRpbmcgbGlzdHMgb2YgcmFkaW8gYnV0dG9ucyB1c2luZ1xuXHQgKiB7QGxpbmsgbmdSZXBlYXQgYG5nUmVwZWF0YH0sIGFzIHNob3duIGJlbG93LlxuXHQgKlxuXHQgKiBMaWtld2lzZSwgYG5nVmFsdWVgIGNhbiBiZSB1c2VkIHRvIGdlbmVyYXRlIGA8b3B0aW9uPmAgZWxlbWVudHMgZm9yXG5cdCAqIHRoZSB7QGxpbmsgc2VsZWN0IGBzZWxlY3RgfSBlbGVtZW50LiBJbiB0aGF0IGNhc2UgaG93ZXZlciwgb25seSBzdHJpbmdzIGFyZSBzdXBwb3J0ZWRcblx0ICogZm9yIHRoZSBgdmFsdWUgYGF0dHJpYnV0ZSwgc28gdGhlIHJlc3VsdGluZyBgbmdNb2RlbGAgd2lsbCBhbHdheXMgYmUgYSBzdHJpbmcuXG5cdCAqIFN1cHBvcnQgZm9yIGBzZWxlY3RgIG1vZGVscyB3aXRoIG5vbi1zdHJpbmcgdmFsdWVzIGlzIGF2YWlsYWJsZSB2aWEgYG5nT3B0aW9uc2AuXG5cdCAqXG5cdCAqIEBlbGVtZW50IGlucHV0XG5cdCAqIEBwYXJhbSB7c3RyaW5nPX0gbmdWYWx1ZSBhbmd1bGFyIGV4cHJlc3Npb24sIHdob3NlIHZhbHVlIHdpbGwgYmUgYm91bmQgdG8gdGhlIGB2YWx1ZWAgYXR0cmlidXRlXG5cdCAqICAgb2YgdGhlIGBpbnB1dGAgZWxlbWVudFxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICAgPGV4YW1wbGUgbmFtZT1cIm5nVmFsdWUtZGlyZWN0aXZlXCIgbW9kdWxlPVwidmFsdWVFeGFtcGxlXCI+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICA8c2NyaXB0PlxuXHQgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ3ZhbHVlRXhhbXBsZScsIFtdKVxuXHQgICAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgICAgICRzY29wZS5uYW1lcyA9IFsncGl6emEnLCAndW5pY29ybnMnLCAncm9ib3RzJ107XG5cdCAgICAgICAgICAgICAgJHNjb3BlLm15ID0geyBmYXZvcml0ZTogJ3VuaWNvcm5zJyB9O1xuXHQgICAgICAgICAgICB9XSk7XG5cdCAgICAgICA8L3NjcmlwdD5cblx0ICAgICAgICA8Zm9ybSBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgICAgIDxoMj5XaGljaCBpcyB5b3VyIGZhdm9yaXRlPzwvaDI+XG5cdCAgICAgICAgICAgIDxsYWJlbCBuZy1yZXBlYXQ9XCJuYW1lIGluIG5hbWVzXCIgZm9yPVwie3tuYW1lfX1cIj5cblx0ICAgICAgICAgICAgICB7e25hbWV9fVxuXHQgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwicmFkaW9cIlxuXHQgICAgICAgICAgICAgICAgICAgICBuZy1tb2RlbD1cIm15LmZhdm9yaXRlXCJcblx0ICAgICAgICAgICAgICAgICAgICAgbmctdmFsdWU9XCJuYW1lXCJcblx0ICAgICAgICAgICAgICAgICAgICAgaWQ9XCJ7e25hbWV9fVwiXG5cdCAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJmYXZvcml0ZVwiPlxuXHQgICAgICAgICAgICA8L2xhYmVsPlxuXHQgICAgICAgICAgPGRpdj5Zb3UgY2hvc2Uge3tteS5mYXZvcml0ZX19PC9kaXY+XG5cdCAgICAgICAgPC9mb3JtPlxuXHQgICAgICA8L2ZpbGU+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgICB2YXIgZmF2b3JpdGUgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ215LmZhdm9yaXRlJykpO1xuXHRcblx0ICAgICAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgdG8gbW9kZWwnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIGV4cGVjdChmYXZvcml0ZS5nZXRUZXh0KCkpLnRvQ29udGFpbigndW5pY29ybnMnKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgICBpdCgnc2hvdWxkIGJpbmQgdGhlIHZhbHVlcyB0byB0aGUgaW5wdXRzJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBlbGVtZW50LmFsbChieS5tb2RlbCgnbXkuZmF2b3JpdGUnKSkuZ2V0KDApLmNsaWNrKCk7XG5cdCAgICAgICAgICBleHBlY3QoZmF2b3JpdGUuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3BpenphJyk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIDwvZmlsZT5cblx0ICAgIDwvZXhhbXBsZT5cblx0ICovXG5cdHZhciBuZ1ZhbHVlRGlyZWN0aXZlID0gZnVuY3Rpb24oKSB7XG5cdCAgcmV0dXJuIHtcblx0ICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICBwcmlvcml0eTogMTAwLFxuXHQgICAgY29tcGlsZTogZnVuY3Rpb24odHBsLCB0cGxBdHRyKSB7XG5cdCAgICAgIGlmIChDT05TVEFOVF9WQUxVRV9SRUdFWFAudGVzdCh0cGxBdHRyLm5nVmFsdWUpKSB7XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5nVmFsdWVDb25zdGFudExpbmsoc2NvcGUsIGVsbSwgYXR0cikge1xuXHQgICAgICAgICAgYXR0ci4kc2V0KCd2YWx1ZScsIHNjb3BlLiRldmFsKGF0dHIubmdWYWx1ZSkpO1xuXHQgICAgICAgIH07XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5nVmFsdWVMaW5rKHNjb3BlLCBlbG0sIGF0dHIpIHtcblx0ICAgICAgICAgIHNjb3BlLiR3YXRjaChhdHRyLm5nVmFsdWUsIGZ1bmN0aW9uIHZhbHVlV2F0Y2hBY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICAgICAgYXR0ci4kc2V0KCd2YWx1ZScsIHZhbHVlKTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH07XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9O1xuXHR9O1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdCaW5kXG5cdCAqIEByZXN0cmljdCBBQ1xuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogVGhlIGBuZ0JpbmRgIGF0dHJpYnV0ZSB0ZWxscyBBbmd1bGFyIHRvIHJlcGxhY2UgdGhlIHRleHQgY29udGVudCBvZiB0aGUgc3BlY2lmaWVkIEhUTUwgZWxlbWVudFxuXHQgKiB3aXRoIHRoZSB2YWx1ZSBvZiBhIGdpdmVuIGV4cHJlc3Npb24sIGFuZCB0byB1cGRhdGUgdGhlIHRleHQgY29udGVudCB3aGVuIHRoZSB2YWx1ZSBvZiB0aGF0XG5cdCAqIGV4cHJlc3Npb24gY2hhbmdlcy5cblx0ICpcblx0ICogVHlwaWNhbGx5LCB5b3UgZG9uJ3QgdXNlIGBuZ0JpbmRgIGRpcmVjdGx5LCBidXQgaW5zdGVhZCB5b3UgdXNlIHRoZSBkb3VibGUgY3VybHkgbWFya3VwIGxpa2Vcblx0ICogYHt7IGV4cHJlc3Npb24gfX1gIHdoaWNoIGlzIHNpbWlsYXIgYnV0IGxlc3MgdmVyYm9zZS5cblx0ICpcblx0ICogSXQgaXMgcHJlZmVyYWJsZSB0byB1c2UgYG5nQmluZGAgaW5zdGVhZCBvZiBge3sgZXhwcmVzc2lvbiB9fWAgaWYgYSB0ZW1wbGF0ZSBpcyBtb21lbnRhcmlseVxuXHQgKiBkaXNwbGF5ZWQgYnkgdGhlIGJyb3dzZXIgaW4gaXRzIHJhdyBzdGF0ZSBiZWZvcmUgQW5ndWxhciBjb21waWxlcyBpdC4gU2luY2UgYG5nQmluZGAgaXMgYW5cblx0ICogZWxlbWVudCBhdHRyaWJ1dGUsIGl0IG1ha2VzIHRoZSBiaW5kaW5ncyBpbnZpc2libGUgdG8gdGhlIHVzZXIgd2hpbGUgdGhlIHBhZ2UgaXMgbG9hZGluZy5cblx0ICpcblx0ICogQW4gYWx0ZXJuYXRpdmUgc29sdXRpb24gdG8gdGhpcyBwcm9ibGVtIHdvdWxkIGJlIHVzaW5nIHRoZVxuXHQgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nQ2xvYWsgbmdDbG9ha30gZGlyZWN0aXZlLlxuXHQgKlxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0JpbmQge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqIEVudGVyIGEgbmFtZSBpbiB0aGUgTGl2ZSBQcmV2aWV3IHRleHQgYm94OyB0aGUgZ3JlZXRpbmcgYmVsb3cgdGhlIHRleHQgYm94IGNoYW5nZXMgaW5zdGFudGx5LlxuXHQgICA8ZXhhbXBsZSBtb2R1bGU9XCJiaW5kRXhhbXBsZVwiPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICA8c2NyaXB0PlxuXHQgICAgICAgICBhbmd1bGFyLm1vZHVsZSgnYmluZEV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgICAgJHNjb3BlLm5hbWUgPSAnV2hpcmxlZCc7XG5cdCAgICAgICAgICAgfV0pO1xuXHQgICAgICAgPC9zY3JpcHQ+XG5cdCAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgICAgICAgICA8bGFiZWw+RW50ZXIgbmFtZTogPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJuYW1lXCI+PC9sYWJlbD48YnI+XG5cdCAgICAgICAgIEhlbGxvIDxzcGFuIG5nLWJpbmQ9XCJuYW1lXCI+PC9zcGFuPiFcblx0ICAgICAgIDwvZGl2PlxuXHQgICAgIDwvZmlsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgICBpdCgnc2hvdWxkIGNoZWNrIG5nLWJpbmQnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgdmFyIG5hbWVJbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ25hbWUnKSk7XG5cdFxuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKCduYW1lJykpLmdldFRleHQoKSkudG9CZSgnV2hpcmxlZCcpO1xuXHQgICAgICAgICBuYW1lSW5wdXQuY2xlYXIoKTtcblx0ICAgICAgICAgbmFtZUlucHV0LnNlbmRLZXlzKCd3b3JsZCcpO1xuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKCduYW1lJykpLmdldFRleHQoKSkudG9CZSgnd29ybGQnKTtcblx0ICAgICAgIH0pO1xuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKi9cblx0dmFyIG5nQmluZERpcmVjdGl2ZSA9IFsnJGNvbXBpbGUnLCBmdW5jdGlvbigkY29tcGlsZSkge1xuXHQgIHJldHVybiB7XG5cdCAgICByZXN0cmljdDogJ0FDJyxcblx0ICAgIGNvbXBpbGU6IGZ1bmN0aW9uIG5nQmluZENvbXBpbGUodGVtcGxhdGVFbGVtZW50KSB7XG5cdCAgICAgICRjb21waWxlLiQkYWRkQmluZGluZ0NsYXNzKHRlbXBsYXRlRWxlbWVudCk7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiBuZ0JpbmRMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG5cdCAgICAgICAgJGNvbXBpbGUuJCRhZGRCaW5kaW5nSW5mbyhlbGVtZW50LCBhdHRyLm5nQmluZCk7XG5cdCAgICAgICAgZWxlbWVudCA9IGVsZW1lbnRbMF07XG5cdCAgICAgICAgc2NvcGUuJHdhdGNoKGF0dHIubmdCaW5kLCBmdW5jdGlvbiBuZ0JpbmRXYXRjaEFjdGlvbih2YWx1ZSkge1xuXHQgICAgICAgICAgZWxlbWVudC50ZXh0Q29udGVudCA9IGlzVW5kZWZpbmVkKHZhbHVlKSA/ICcnIDogdmFsdWU7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfTtcblx0fV07XG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdCaW5kVGVtcGxhdGVcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFRoZSBgbmdCaW5kVGVtcGxhdGVgIGRpcmVjdGl2ZSBzcGVjaWZpZXMgdGhhdCB0aGUgZWxlbWVudFxuXHQgKiB0ZXh0IGNvbnRlbnQgc2hvdWxkIGJlIHJlcGxhY2VkIHdpdGggdGhlIGludGVycG9sYXRpb24gb2YgdGhlIHRlbXBsYXRlXG5cdCAqIGluIHRoZSBgbmdCaW5kVGVtcGxhdGVgIGF0dHJpYnV0ZS5cblx0ICogVW5saWtlIGBuZ0JpbmRgLCB0aGUgYG5nQmluZFRlbXBsYXRlYCBjYW4gY29udGFpbiBtdWx0aXBsZSBge3tgIGB9fWBcblx0ICogZXhwcmVzc2lvbnMuIFRoaXMgZGlyZWN0aXZlIGlzIG5lZWRlZCBzaW5jZSBzb21lIEhUTUwgZWxlbWVudHNcblx0ICogKHN1Y2ggYXMgVElUTEUgYW5kIE9QVElPTikgY2Fubm90IGNvbnRhaW4gU1BBTiBlbGVtZW50cy5cblx0ICpcblx0ICogQGVsZW1lbnQgQU5ZXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBuZ0JpbmRUZW1wbGF0ZSB0ZW1wbGF0ZSBvZiBmb3JtXG5cdCAqICAgPHR0Pnt7PC90dD4gPHR0PmV4cHJlc3Npb248L3R0PiA8dHQ+fX08L3R0PiB0byBldmFsLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgKiBUcnkgaXQgaGVyZTogZW50ZXIgdGV4dCBpbiB0ZXh0IGJveCBhbmQgd2F0Y2ggdGhlIGdyZWV0aW5nIGNoYW5nZS5cblx0ICAgPGV4YW1wbGUgbW9kdWxlPVwiYmluZEV4YW1wbGVcIj5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgPHNjcmlwdD5cblx0ICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2JpbmRFeGFtcGxlJywgW10pXG5cdCAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICAgICRzY29wZS5zYWx1dGF0aW9uID0gJ0hlbGxvJztcblx0ICAgICAgICAgICAgICRzY29wZS5uYW1lID0gJ1dvcmxkJztcblx0ICAgICAgICAgICB9XSk7XG5cdCAgICAgICA8L3NjcmlwdD5cblx0ICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAgICAgICAgPGxhYmVsPlNhbHV0YXRpb246IDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwic2FsdXRhdGlvblwiPjwvbGFiZWw+PGJyPlxuXHQgICAgICAgIDxsYWJlbD5OYW1lOiA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cIm5hbWVcIj48L2xhYmVsPjxicj5cblx0ICAgICAgICA8cHJlIG5nLWJpbmQtdGVtcGxhdGU9XCJ7e3NhbHV0YXRpb259fSB7e25hbWV9fSFcIj48L3ByZT5cblx0ICAgICAgIDwvZGl2PlxuXHQgICAgIDwvZmlsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgICBpdCgnc2hvdWxkIGNoZWNrIG5nLWJpbmQnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgdmFyIHNhbHV0YXRpb25FbGVtID0gZWxlbWVudChieS5iaW5kaW5nKCdzYWx1dGF0aW9uJykpO1xuXHQgICAgICAgICB2YXIgc2FsdXRhdGlvbklucHV0ID0gZWxlbWVudChieS5tb2RlbCgnc2FsdXRhdGlvbicpKTtcblx0ICAgICAgICAgdmFyIG5hbWVJbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ25hbWUnKSk7XG5cdFxuXHQgICAgICAgICBleHBlY3Qoc2FsdXRhdGlvbkVsZW0uZ2V0VGV4dCgpKS50b0JlKCdIZWxsbyBXb3JsZCEnKTtcblx0XG5cdCAgICAgICAgIHNhbHV0YXRpb25JbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICBzYWx1dGF0aW9uSW5wdXQuc2VuZEtleXMoJ0dyZWV0aW5ncycpO1xuXHQgICAgICAgICBuYW1lSW5wdXQuY2xlYXIoKTtcblx0ICAgICAgICAgbmFtZUlucHV0LnNlbmRLZXlzKCd1c2VyJyk7XG5cdFxuXHQgICAgICAgICBleHBlY3Qoc2FsdXRhdGlvbkVsZW0uZ2V0VGV4dCgpKS50b0JlKCdHcmVldGluZ3MgdXNlciEnKTtcblx0ICAgICAgIH0pO1xuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKi9cblx0dmFyIG5nQmluZFRlbXBsYXRlRGlyZWN0aXZlID0gWyckaW50ZXJwb2xhdGUnLCAnJGNvbXBpbGUnLCBmdW5jdGlvbigkaW50ZXJwb2xhdGUsICRjb21waWxlKSB7XG5cdCAgcmV0dXJuIHtcblx0ICAgIGNvbXBpbGU6IGZ1bmN0aW9uIG5nQmluZFRlbXBsYXRlQ29tcGlsZSh0ZW1wbGF0ZUVsZW1lbnQpIHtcblx0ICAgICAgJGNvbXBpbGUuJCRhZGRCaW5kaW5nQ2xhc3ModGVtcGxhdGVFbGVtZW50KTtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5nQmluZFRlbXBsYXRlTGluayhzY29wZSwgZWxlbWVudCwgYXR0cikge1xuXHQgICAgICAgIHZhciBpbnRlcnBvbGF0ZUZuID0gJGludGVycG9sYXRlKGVsZW1lbnQuYXR0cihhdHRyLiRhdHRyLm5nQmluZFRlbXBsYXRlKSk7XG5cdCAgICAgICAgJGNvbXBpbGUuJCRhZGRCaW5kaW5nSW5mbyhlbGVtZW50LCBpbnRlcnBvbGF0ZUZuLmV4cHJlc3Npb25zKTtcblx0ICAgICAgICBlbGVtZW50ID0gZWxlbWVudFswXTtcblx0ICAgICAgICBhdHRyLiRvYnNlcnZlKCduZ0JpbmRUZW1wbGF0ZScsIGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgICBlbGVtZW50LnRleHRDb250ZW50ID0gaXNVbmRlZmluZWQodmFsdWUpID8gJycgOiB2YWx1ZTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0ICB9O1xuXHR9XTtcblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ0JpbmRIdG1sXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBFdmFsdWF0ZXMgdGhlIGV4cHJlc3Npb24gYW5kIGluc2VydHMgdGhlIHJlc3VsdGluZyBIVE1MIGludG8gdGhlIGVsZW1lbnQgaW4gYSBzZWN1cmUgd2F5LiBCeSBkZWZhdWx0LFxuXHQgKiB0aGUgcmVzdWx0aW5nIEhUTUwgY29udGVudCB3aWxsIGJlIHNhbml0aXplZCB1c2luZyB0aGUge0BsaW5rIG5nU2FuaXRpemUuJHNhbml0aXplICRzYW5pdGl6ZX0gc2VydmljZS5cblx0ICogVG8gdXRpbGl6ZSB0aGlzIGZ1bmN0aW9uYWxpdHksIGVuc3VyZSB0aGF0IGAkc2FuaXRpemVgIGlzIGF2YWlsYWJsZSwgZm9yIGV4YW1wbGUsIGJ5IGluY2x1ZGluZyB7QGxpbmtcblx0ICogbmdTYW5pdGl6ZX0gaW4geW91ciBtb2R1bGUncyBkZXBlbmRlbmNpZXMgKG5vdCBpbiBjb3JlIEFuZ3VsYXIpLiBJbiBvcmRlciB0byB1c2Uge0BsaW5rIG5nU2FuaXRpemV9XG5cdCAqIGluIHlvdXIgbW9kdWxlJ3MgZGVwZW5kZW5jaWVzLCB5b3UgbmVlZCB0byBpbmNsdWRlIFwiYW5ndWxhci1zYW5pdGl6ZS5qc1wiIGluIHlvdXIgYXBwbGljYXRpb24uXG5cdCAqXG5cdCAqIFlvdSBtYXkgYWxzbyBieXBhc3Mgc2FuaXRpemF0aW9uIGZvciB2YWx1ZXMgeW91IGtub3cgYXJlIHNhZmUuIFRvIGRvIHNvLCBiaW5kIHRvXG5cdCAqIGFuIGV4cGxpY2l0bHkgdHJ1c3RlZCB2YWx1ZSB2aWEge0BsaW5rIG5nLiRzY2UjdHJ1c3RBc0h0bWwgJHNjZS50cnVzdEFzSHRtbH0uICBTZWUgdGhlIGV4YW1wbGVcblx0ICogdW5kZXIge0BsaW5rIG5nLiRzY2Ujc2hvdy1tZS1hbi1leGFtcGxlLXVzaW5nLXNjZS0gU3RyaWN0IENvbnRleHR1YWwgRXNjYXBpbmcgKFNDRSl9LlxuXHQgKlxuXHQgKiBOb3RlOiBJZiBhIGAkc2FuaXRpemVgIHNlcnZpY2UgaXMgdW5hdmFpbGFibGUgYW5kIHRoZSBib3VuZCB2YWx1ZSBpc24ndCBleHBsaWNpdGx5IHRydXN0ZWQsIHlvdVxuXHQgKiB3aWxsIGhhdmUgYW4gZXhjZXB0aW9uIChpbnN0ZWFkIG9mIGFuIGV4cGxvaXQuKVxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0JpbmRIdG1sIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWx1YXRlLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHRcblx0ICAgPGV4YW1wbGUgbW9kdWxlPVwiYmluZEh0bWxFeGFtcGxlXCIgZGVwcz1cImFuZ3VsYXItc2FuaXRpemUuanNcIj5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgICA8cCBuZy1iaW5kLWh0bWw9XCJteUhUTUxcIj48L3A+XG5cdCAgICAgICA8L2Rpdj5cblx0ICAgICA8L2ZpbGU+XG5cdFxuXHQgICAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cblx0ICAgICAgIGFuZ3VsYXIubW9kdWxlKCdiaW5kSHRtbEV4YW1wbGUnLCBbJ25nU2FuaXRpemUnXSlcblx0ICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICAkc2NvcGUubXlIVE1MID1cblx0ICAgICAgICAgICAgICAnSSBhbSBhbiA8Y29kZT5IVE1MPC9jb2RlPnN0cmluZyB3aXRoICcgK1xuXHQgICAgICAgICAgICAgICc8YSBocmVmPVwiI1wiPmxpbmtzITwvYT4gYW5kIG90aGVyIDxlbT5zdHVmZjwvZW0+Jztcblx0ICAgICAgICAgfV0pO1xuXHQgICAgIDwvZmlsZT5cblx0XG5cdCAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1iaW5kLWh0bWwnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygnbXlIVE1MJykpLmdldFRleHQoKSkudG9CZShcblx0ICAgICAgICAgICAgICdJIGFtIGFuIEhUTUxzdHJpbmcgd2l0aCBsaW5rcyEgYW5kIG90aGVyIHN0dWZmJyk7XG5cdCAgICAgICB9KTtcblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICovXG5cdHZhciBuZ0JpbmRIdG1sRGlyZWN0aXZlID0gWyckc2NlJywgJyRwYXJzZScsICckY29tcGlsZScsIGZ1bmN0aW9uKCRzY2UsICRwYXJzZSwgJGNvbXBpbGUpIHtcblx0ICByZXR1cm4ge1xuXHQgICAgcmVzdHJpY3Q6ICdBJyxcblx0ICAgIGNvbXBpbGU6IGZ1bmN0aW9uIG5nQmluZEh0bWxDb21waWxlKHRFbGVtZW50LCB0QXR0cnMpIHtcblx0ICAgICAgdmFyIG5nQmluZEh0bWxHZXR0ZXIgPSAkcGFyc2UodEF0dHJzLm5nQmluZEh0bWwpO1xuXHQgICAgICB2YXIgbmdCaW5kSHRtbFdhdGNoID0gJHBhcnNlKHRBdHRycy5uZ0JpbmRIdG1sLCBmdW5jdGlvbiBnZXRTdHJpbmdWYWx1ZSh2YWx1ZSkge1xuXHQgICAgICAgIHJldHVybiAodmFsdWUgfHwgJycpLnRvU3RyaW5nKCk7XG5cdCAgICAgIH0pO1xuXHQgICAgICAkY29tcGlsZS4kJGFkZEJpbmRpbmdDbGFzcyh0RWxlbWVudCk7XG5cdFxuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gbmdCaW5kSHRtbExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcblx0ICAgICAgICAkY29tcGlsZS4kJGFkZEJpbmRpbmdJbmZvKGVsZW1lbnQsIGF0dHIubmdCaW5kSHRtbCk7XG5cdFxuXHQgICAgICAgIHNjb3BlLiR3YXRjaChuZ0JpbmRIdG1sV2F0Y2gsIGZ1bmN0aW9uIG5nQmluZEh0bWxXYXRjaEFjdGlvbigpIHtcblx0ICAgICAgICAgIC8vIHdlIHJlLWV2YWx1YXRlIHRoZSBleHByIGJlY2F1c2Ugd2Ugd2FudCBhIFRydXN0ZWRWYWx1ZUhvbGRlclR5cGVcblx0ICAgICAgICAgIC8vIGZvciAkc2NlLCBub3QgYSBzdHJpbmdcblx0ICAgICAgICAgIGVsZW1lbnQuaHRtbCgkc2NlLmdldFRydXN0ZWRIdG1sKG5nQmluZEh0bWxHZXR0ZXIoc2NvcGUpKSB8fCAnJyk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfTtcblx0fV07XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ0NoYW5nZVxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogRXZhbHVhdGUgdGhlIGdpdmVuIGV4cHJlc3Npb24gd2hlbiB0aGUgdXNlciBjaGFuZ2VzIHRoZSBpbnB1dC5cblx0ICogVGhlIGV4cHJlc3Npb24gaXMgZXZhbHVhdGVkIGltbWVkaWF0ZWx5LCB1bmxpa2UgdGhlIEphdmFTY3JpcHQgb25jaGFuZ2UgZXZlbnRcblx0ICogd2hpY2ggb25seSB0cmlnZ2VycyBhdCB0aGUgZW5kIG9mIGEgY2hhbmdlICh1c3VhbGx5LCB3aGVuIHRoZSB1c2VyIGxlYXZlcyB0aGVcblx0ICogZm9ybSBlbGVtZW50IG9yIHByZXNzZXMgdGhlIHJldHVybiBrZXkpLlxuXHQgKlxuXHQgKiBUaGUgYG5nQ2hhbmdlYCBleHByZXNzaW9uIGlzIG9ubHkgZXZhbHVhdGVkIHdoZW4gYSBjaGFuZ2UgaW4gdGhlIGlucHV0IHZhbHVlIGNhdXNlc1xuXHQgKiBhIG5ldyB2YWx1ZSB0byBiZSBjb21taXR0ZWQgdG8gdGhlIG1vZGVsLlxuXHQgKlxuXHQgKiBJdCB3aWxsIG5vdCBiZSBldmFsdWF0ZWQ6XG5cdCAqICogaWYgdGhlIHZhbHVlIHJldHVybmVkIGZyb20gdGhlIGAkcGFyc2Vyc2AgdHJhbnNmb3JtYXRpb24gcGlwZWxpbmUgaGFzIG5vdCBjaGFuZ2VkXG5cdCAqICogaWYgdGhlIGlucHV0IGhhcyBjb250aW51ZWQgdG8gYmUgaW52YWxpZCBzaW5jZSB0aGUgbW9kZWwgd2lsbCBzdGF5IGBudWxsYFxuXHQgKiAqIGlmIHRoZSBtb2RlbCBpcyBjaGFuZ2VkIHByb2dyYW1tYXRpY2FsbHkgYW5kIG5vdCBieSBhIGNoYW5nZSB0byB0aGUgaW5wdXQgdmFsdWVcblx0ICpcblx0ICpcblx0ICogTm90ZSwgdGhpcyBkaXJlY3RpdmUgcmVxdWlyZXMgYG5nTW9kZWxgIHRvIGJlIHByZXNlbnQuXG5cdCAqXG5cdCAqIEBlbGVtZW50IGlucHV0XG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdDaGFuZ2Uge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvbiBjaGFuZ2Vcblx0ICogaW4gaW5wdXQgdmFsdWUuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqIDxleGFtcGxlIG5hbWU9XCJuZ0NoYW5nZS1kaXJlY3RpdmVcIiBtb2R1bGU9XCJjaGFuZ2VFeGFtcGxlXCI+XG5cdCAqICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICogICAgIDxzY3JpcHQ+XG5cdCAqICAgICAgIGFuZ3VsYXIubW9kdWxlKCdjaGFuZ2VFeGFtcGxlJywgW10pXG5cdCAqICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICogICAgICAgICAgICRzY29wZS5jb3VudGVyID0gMDtcblx0ICogICAgICAgICAgICRzY29wZS5jaGFuZ2UgPSBmdW5jdGlvbigpIHtcblx0ICogICAgICAgICAgICAgJHNjb3BlLmNvdW50ZXIrKztcblx0ICogICAgICAgICAgIH07XG5cdCAqICAgICAgICAgfV0pO1xuXHQgKiAgICAgPC9zY3JpcHQ+XG5cdCAqICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgKiAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmctbW9kZWw9XCJjb25maXJtZWRcIiBuZy1jaGFuZ2U9XCJjaGFuZ2UoKVwiIGlkPVwibmctY2hhbmdlLWV4YW1wbGUxXCIgLz5cblx0ICogICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiY29uZmlybWVkXCIgaWQ9XCJuZy1jaGFuZ2UtZXhhbXBsZTJcIiAvPlxuXHQgKiAgICAgICA8bGFiZWwgZm9yPVwibmctY2hhbmdlLWV4YW1wbGUyXCI+Q29uZmlybWVkPC9sYWJlbD48YnIgLz5cblx0ICogICAgICAgPHR0PmRlYnVnID0ge3tjb25maXJtZWR9fTwvdHQ+PGJyLz5cblx0ICogICAgICAgPHR0PmNvdW50ZXIgPSB7e2NvdW50ZXJ9fTwvdHQ+PGJyLz5cblx0ICogICAgIDwvZGl2PlxuXHQgKiAgIDwvZmlsZT5cblx0ICogICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAqICAgICB2YXIgY291bnRlciA9IGVsZW1lbnQoYnkuYmluZGluZygnY291bnRlcicpKTtcblx0ICogICAgIHZhciBkZWJ1ZyA9IGVsZW1lbnQoYnkuYmluZGluZygnY29uZmlybWVkJykpO1xuXHQgKlxuXHQgKiAgICAgaXQoJ3Nob3VsZCBldmFsdWF0ZSB0aGUgZXhwcmVzc2lvbiBpZiBjaGFuZ2luZyBmcm9tIHZpZXcnLCBmdW5jdGlvbigpIHtcblx0ICogICAgICAgZXhwZWN0KGNvdW50ZXIuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJzAnKTtcblx0ICpcblx0ICogICAgICAgZWxlbWVudChieS5pZCgnbmctY2hhbmdlLWV4YW1wbGUxJykpLmNsaWNrKCk7XG5cdCAqXG5cdCAqICAgICAgIGV4cGVjdChjb3VudGVyLmdldFRleHQoKSkudG9Db250YWluKCcxJyk7XG5cdCAqICAgICAgIGV4cGVjdChkZWJ1Zy5nZXRUZXh0KCkpLnRvQ29udGFpbigndHJ1ZScpO1xuXHQgKiAgICAgfSk7XG5cdCAqXG5cdCAqICAgICBpdCgnc2hvdWxkIG5vdCBldmFsdWF0ZSB0aGUgZXhwcmVzc2lvbiBpZiBjaGFuZ2luZyBmcm9tIG1vZGVsJywgZnVuY3Rpb24oKSB7XG5cdCAqICAgICAgIGVsZW1lbnQoYnkuaWQoJ25nLWNoYW5nZS1leGFtcGxlMicpKS5jbGljaygpO1xuXHRcblx0ICogICAgICAgZXhwZWN0KGNvdW50ZXIuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJzAnKTtcblx0ICogICAgICAgZXhwZWN0KGRlYnVnLmdldFRleHQoKSkudG9Db250YWluKCd0cnVlJyk7XG5cdCAqICAgICB9KTtcblx0ICogICA8L2ZpbGU+XG5cdCAqIDwvZXhhbXBsZT5cblx0ICovXG5cdHZhciBuZ0NoYW5nZURpcmVjdGl2ZSA9IHZhbHVlRm4oe1xuXHQgIHJlc3RyaWN0OiAnQScsXG5cdCAgcmVxdWlyZTogJ25nTW9kZWwnLFxuXHQgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XG5cdCAgICBjdHJsLiR2aWV3Q2hhbmdlTGlzdGVuZXJzLnB1c2goZnVuY3Rpb24oKSB7XG5cdCAgICAgIHNjb3BlLiRldmFsKGF0dHIubmdDaGFuZ2UpO1xuXHQgICAgfSk7XG5cdCAgfVxuXHR9KTtcblx0XG5cdGZ1bmN0aW9uIGNsYXNzRGlyZWN0aXZlKG5hbWUsIHNlbGVjdG9yKSB7XG5cdCAgbmFtZSA9ICduZ0NsYXNzJyArIG5hbWU7XG5cdCAgcmV0dXJuIFsnJGFuaW1hdGUnLCBmdW5jdGlvbigkYW5pbWF0ZSkge1xuXHQgICAgcmV0dXJuIHtcblx0ICAgICAgcmVzdHJpY3Q6ICdBQycsXG5cdCAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG5cdCAgICAgICAgdmFyIG9sZFZhbDtcblx0XG5cdCAgICAgICAgc2NvcGUuJHdhdGNoKGF0dHJbbmFtZV0sIG5nQ2xhc3NXYXRjaEFjdGlvbiwgdHJ1ZSk7XG5cdFxuXHQgICAgICAgIGF0dHIuJG9ic2VydmUoJ2NsYXNzJywgZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICAgIG5nQ2xhc3NXYXRjaEFjdGlvbihzY29wZS4kZXZhbChhdHRyW25hbWVdKSk7XG5cdCAgICAgICAgfSk7XG5cdFxuXHRcblx0ICAgICAgICBpZiAobmFtZSAhPT0gJ25nQ2xhc3MnKSB7XG5cdCAgICAgICAgICBzY29wZS4kd2F0Y2goJyRpbmRleCcsIGZ1bmN0aW9uKCRpbmRleCwgb2xkJGluZGV4KSB7XG5cdCAgICAgICAgICAgIC8vIGpzaGludCBiaXR3aXNlOiBmYWxzZVxuXHQgICAgICAgICAgICB2YXIgbW9kID0gJGluZGV4ICYgMTtcblx0ICAgICAgICAgICAgaWYgKG1vZCAhPT0gKG9sZCRpbmRleCAmIDEpKSB7XG5cdCAgICAgICAgICAgICAgdmFyIGNsYXNzZXMgPSBhcnJheUNsYXNzZXMoc2NvcGUuJGV2YWwoYXR0cltuYW1lXSkpO1xuXHQgICAgICAgICAgICAgIG1vZCA9PT0gc2VsZWN0b3IgP1xuXHQgICAgICAgICAgICAgICAgYWRkQ2xhc3NlcyhjbGFzc2VzKSA6XG5cdCAgICAgICAgICAgICAgICByZW1vdmVDbGFzc2VzKGNsYXNzZXMpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGZ1bmN0aW9uIGFkZENsYXNzZXMoY2xhc3Nlcykge1xuXHQgICAgICAgICAgdmFyIG5ld0NsYXNzZXMgPSBkaWdlc3RDbGFzc0NvdW50cyhjbGFzc2VzLCAxKTtcblx0ICAgICAgICAgIGF0dHIuJGFkZENsYXNzKG5ld0NsYXNzZXMpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgZnVuY3Rpb24gcmVtb3ZlQ2xhc3NlcyhjbGFzc2VzKSB7XG5cdCAgICAgICAgICB2YXIgbmV3Q2xhc3NlcyA9IGRpZ2VzdENsYXNzQ291bnRzKGNsYXNzZXMsIC0xKTtcblx0ICAgICAgICAgIGF0dHIuJHJlbW92ZUNsYXNzKG5ld0NsYXNzZXMpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgZnVuY3Rpb24gZGlnZXN0Q2xhc3NDb3VudHMoY2xhc3NlcywgY291bnQpIHtcblx0ICAgICAgICAgIC8vIFVzZSBjcmVhdGVNYXAoKSB0byBwcmV2ZW50IGNsYXNzIGFzc3VtcHRpb25zIGludm9sdmluZyBwcm9wZXJ0eVxuXHQgICAgICAgICAgLy8gbmFtZXMgaW4gT2JqZWN0LnByb3RvdHlwZVxuXHQgICAgICAgICAgdmFyIGNsYXNzQ291bnRzID0gZWxlbWVudC5kYXRhKCckY2xhc3NDb3VudHMnKSB8fCBjcmVhdGVNYXAoKTtcblx0ICAgICAgICAgIHZhciBjbGFzc2VzVG9VcGRhdGUgPSBbXTtcblx0ICAgICAgICAgIGZvckVhY2goY2xhc3NlcywgZnVuY3Rpb24oY2xhc3NOYW1lKSB7XG5cdCAgICAgICAgICAgIGlmIChjb3VudCA+IDAgfHwgY2xhc3NDb3VudHNbY2xhc3NOYW1lXSkge1xuXHQgICAgICAgICAgICAgIGNsYXNzQ291bnRzW2NsYXNzTmFtZV0gPSAoY2xhc3NDb3VudHNbY2xhc3NOYW1lXSB8fCAwKSArIGNvdW50O1xuXHQgICAgICAgICAgICAgIGlmIChjbGFzc0NvdW50c1tjbGFzc05hbWVdID09PSArKGNvdW50ID4gMCkpIHtcblx0ICAgICAgICAgICAgICAgIGNsYXNzZXNUb1VwZGF0ZS5wdXNoKGNsYXNzTmFtZSk7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICAgIGVsZW1lbnQuZGF0YSgnJGNsYXNzQ291bnRzJywgY2xhc3NDb3VudHMpO1xuXHQgICAgICAgICAgcmV0dXJuIGNsYXNzZXNUb1VwZGF0ZS5qb2luKCcgJyk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBmdW5jdGlvbiB1cGRhdGVDbGFzc2VzKG9sZENsYXNzZXMsIG5ld0NsYXNzZXMpIHtcblx0ICAgICAgICAgIHZhciB0b0FkZCA9IGFycmF5RGlmZmVyZW5jZShuZXdDbGFzc2VzLCBvbGRDbGFzc2VzKTtcblx0ICAgICAgICAgIHZhciB0b1JlbW92ZSA9IGFycmF5RGlmZmVyZW5jZShvbGRDbGFzc2VzLCBuZXdDbGFzc2VzKTtcblx0ICAgICAgICAgIHRvQWRkID0gZGlnZXN0Q2xhc3NDb3VudHModG9BZGQsIDEpO1xuXHQgICAgICAgICAgdG9SZW1vdmUgPSBkaWdlc3RDbGFzc0NvdW50cyh0b1JlbW92ZSwgLTEpO1xuXHQgICAgICAgICAgaWYgKHRvQWRkICYmIHRvQWRkLmxlbmd0aCkge1xuXHQgICAgICAgICAgICAkYW5pbWF0ZS5hZGRDbGFzcyhlbGVtZW50LCB0b0FkZCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBpZiAodG9SZW1vdmUgJiYgdG9SZW1vdmUubGVuZ3RoKSB7XG5cdCAgICAgICAgICAgICRhbmltYXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIHRvUmVtb3ZlKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGZ1bmN0aW9uIG5nQ2xhc3NXYXRjaEFjdGlvbihuZXdWYWwpIHtcblx0ICAgICAgICAgIGlmIChzZWxlY3RvciA9PT0gdHJ1ZSB8fCBzY29wZS4kaW5kZXggJSAyID09PSBzZWxlY3Rvcikge1xuXHQgICAgICAgICAgICB2YXIgbmV3Q2xhc3NlcyA9IGFycmF5Q2xhc3NlcyhuZXdWYWwgfHwgW10pO1xuXHQgICAgICAgICAgICBpZiAoIW9sZFZhbCkge1xuXHQgICAgICAgICAgICAgIGFkZENsYXNzZXMobmV3Q2xhc3Nlcyk7XG5cdCAgICAgICAgICAgIH0gZWxzZSBpZiAoIWVxdWFscyhuZXdWYWwsb2xkVmFsKSkge1xuXHQgICAgICAgICAgICAgIHZhciBvbGRDbGFzc2VzID0gYXJyYXlDbGFzc2VzKG9sZFZhbCk7XG5cdCAgICAgICAgICAgICAgdXBkYXRlQ2xhc3NlcyhvbGRDbGFzc2VzLCBuZXdDbGFzc2VzKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgb2xkVmFsID0gc2hhbGxvd0NvcHkobmV3VmFsKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gYXJyYXlEaWZmZXJlbmNlKHRva2VuczEsIHRva2VuczIpIHtcblx0ICAgICAgdmFyIHZhbHVlcyA9IFtdO1xuXHRcblx0ICAgICAgb3V0ZXI6XG5cdCAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9rZW5zMS5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIHZhciB0b2tlbiA9IHRva2VuczFbaV07XG5cdCAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0b2tlbnMyLmxlbmd0aDsgaisrKSB7XG5cdCAgICAgICAgICBpZiAodG9rZW4gPT0gdG9rZW5zMltqXSkgY29udGludWUgb3V0ZXI7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHZhbHVlcy5wdXNoKHRva2VuKTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gdmFsdWVzO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGFycmF5Q2xhc3NlcyhjbGFzc1ZhbCkge1xuXHQgICAgICB2YXIgY2xhc3NlcyA9IFtdO1xuXHQgICAgICBpZiAoaXNBcnJheShjbGFzc1ZhbCkpIHtcblx0ICAgICAgICBmb3JFYWNoKGNsYXNzVmFsLCBmdW5jdGlvbih2KSB7XG5cdCAgICAgICAgICBjbGFzc2VzID0gY2xhc3Nlcy5jb25jYXQoYXJyYXlDbGFzc2VzKHYpKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgICByZXR1cm4gY2xhc3Nlcztcblx0ICAgICAgfSBlbHNlIGlmIChpc1N0cmluZyhjbGFzc1ZhbCkpIHtcblx0ICAgICAgICByZXR1cm4gY2xhc3NWYWwuc3BsaXQoJyAnKTtcblx0ICAgICAgfSBlbHNlIGlmIChpc09iamVjdChjbGFzc1ZhbCkpIHtcblx0ICAgICAgICBmb3JFYWNoKGNsYXNzVmFsLCBmdW5jdGlvbih2LCBrKSB7XG5cdCAgICAgICAgICBpZiAodikge1xuXHQgICAgICAgICAgICBjbGFzc2VzID0gY2xhc3Nlcy5jb25jYXQoay5zcGxpdCgnICcpKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0ICAgICAgICByZXR1cm4gY2xhc3Nlcztcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gY2xhc3NWYWw7XG5cdCAgICB9XG5cdCAgfV07XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIG5nQ2xhc3Ncblx0ICogQHJlc3RyaWN0IEFDXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUaGUgYG5nQ2xhc3NgIGRpcmVjdGl2ZSBhbGxvd3MgeW91IHRvIGR5bmFtaWNhbGx5IHNldCBDU1MgY2xhc3NlcyBvbiBhbiBIVE1MIGVsZW1lbnQgYnkgZGF0YWJpbmRpbmdcblx0ICogYW4gZXhwcmVzc2lvbiB0aGF0IHJlcHJlc2VudHMgYWxsIGNsYXNzZXMgdG8gYmUgYWRkZWQuXG5cdCAqXG5cdCAqIFRoZSBkaXJlY3RpdmUgb3BlcmF0ZXMgaW4gdGhyZWUgZGlmZmVyZW50IHdheXMsIGRlcGVuZGluZyBvbiB3aGljaCBvZiB0aHJlZSB0eXBlcyB0aGUgZXhwcmVzc2lvblxuXHQgKiBldmFsdWF0ZXMgdG86XG5cdCAqXG5cdCAqIDEuIElmIHRoZSBleHByZXNzaW9uIGV2YWx1YXRlcyB0byBhIHN0cmluZywgdGhlIHN0cmluZyBzaG91bGQgYmUgb25lIG9yIG1vcmUgc3BhY2UtZGVsaW1pdGVkIGNsYXNzXG5cdCAqIG5hbWVzLlxuXHQgKlxuXHQgKiAyLiBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYW4gb2JqZWN0LCB0aGVuIGZvciBlYWNoIGtleS12YWx1ZSBwYWlyIG9mIHRoZVxuXHQgKiBvYmplY3Qgd2l0aCBhIHRydXRoeSB2YWx1ZSB0aGUgY29ycmVzcG9uZGluZyBrZXkgaXMgdXNlZCBhcyBhIGNsYXNzIG5hbWUuXG5cdCAqXG5cdCAqIDMuIElmIHRoZSBleHByZXNzaW9uIGV2YWx1YXRlcyB0byBhbiBhcnJheSwgZWFjaCBlbGVtZW50IG9mIHRoZSBhcnJheSBzaG91bGQgZWl0aGVyIGJlIGEgc3RyaW5nIGFzIGluXG5cdCAqIHR5cGUgMSBvciBhbiBvYmplY3QgYXMgaW4gdHlwZSAyLiBUaGlzIG1lYW5zIHRoYXQgeW91IGNhbiBtaXggc3RyaW5ncyBhbmQgb2JqZWN0cyB0b2dldGhlciBpbiBhbiBhcnJheVxuXHQgKiB0byBnaXZlIHlvdSBtb3JlIGNvbnRyb2wgb3ZlciB3aGF0IENTUyBjbGFzc2VzIGFwcGVhci4gU2VlIHRoZSBjb2RlIGJlbG93IGZvciBhbiBleGFtcGxlIG9mIHRoaXMuXG5cdCAqXG5cdCAqXG5cdCAqIFRoZSBkaXJlY3RpdmUgd29uJ3QgYWRkIGR1cGxpY2F0ZSBjbGFzc2VzIGlmIGEgcGFydGljdWxhciBjbGFzcyB3YXMgYWxyZWFkeSBzZXQuXG5cdCAqXG5cdCAqIFdoZW4gdGhlIGV4cHJlc3Npb24gY2hhbmdlcywgdGhlIHByZXZpb3VzbHkgYWRkZWQgY2xhc3NlcyBhcmUgcmVtb3ZlZCBhbmQgb25seSB0aGVuIGFyZSB0aGVcblx0ICogbmV3IGNsYXNzZXMgYWRkZWQuXG5cdCAqXG5cdCAqIEBhbmltYXRpb25zXG5cdCAqICoqYWRkKiogLSBoYXBwZW5zIGp1c3QgYmVmb3JlIHRoZSBjbGFzcyBpcyBhcHBsaWVkIHRvIHRoZSBlbGVtZW50c1xuXHQgKlxuXHQgKiAqKnJlbW92ZSoqIC0gaGFwcGVucyBqdXN0IGJlZm9yZSB0aGUgY2xhc3MgaXMgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50XG5cdCAqXG5cdCAqIEBlbGVtZW50IEFOWVxuXHQgKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nQ2xhc3Mge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbC4gVGhlIHJlc3VsdFxuXHQgKiAgIG9mIHRoZSBldmFsdWF0aW9uIGNhbiBiZSBhIHN0cmluZyByZXByZXNlbnRpbmcgc3BhY2UgZGVsaW1pdGVkIGNsYXNzXG5cdCAqICAgbmFtZXMsIGFuIGFycmF5LCBvciBhIG1hcCBvZiBjbGFzcyBuYW1lcyB0byBib29sZWFuIHZhbHVlcy4gSW4gdGhlIGNhc2Ugb2YgYSBtYXAsIHRoZVxuXHQgKiAgIG5hbWVzIG9mIHRoZSBwcm9wZXJ0aWVzIHdob3NlIHZhbHVlcyBhcmUgdHJ1dGh5IHdpbGwgYmUgYWRkZWQgYXMgY3NzIGNsYXNzZXMgdG8gdGhlXG5cdCAqICAgZWxlbWVudC5cblx0ICpcblx0ICogQGV4YW1wbGUgRXhhbXBsZSB0aGF0IGRlbW9uc3RyYXRlcyBiYXNpYyBiaW5kaW5ncyB2aWEgbmdDbGFzcyBkaXJlY3RpdmUuXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICA8cCBuZy1jbGFzcz1cIntzdHJpa2U6IGRlbGV0ZWQsIGJvbGQ6IGltcG9ydGFudCwgJ2hhcy1lcnJvcic6IGVycm9yfVwiPk1hcCBTeW50YXggRXhhbXBsZTwvcD5cblx0ICAgICAgIDxsYWJlbD5cblx0ICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cImRlbGV0ZWRcIj5cblx0ICAgICAgICAgIGRlbGV0ZWQgKGFwcGx5IFwic3RyaWtlXCIgY2xhc3MpXG5cdCAgICAgICA8L2xhYmVsPjxicj5cblx0ICAgICAgIDxsYWJlbD5cblx0ICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cImltcG9ydGFudFwiPlxuXHQgICAgICAgICAgaW1wb3J0YW50IChhcHBseSBcImJvbGRcIiBjbGFzcylcblx0ICAgICAgIDwvbGFiZWw+PGJyPlxuXHQgICAgICAgPGxhYmVsPlxuXHQgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiZXJyb3JcIj5cblx0ICAgICAgICAgIGVycm9yIChhcHBseSBcImhhcy1lcnJvclwiIGNsYXNzKVxuXHQgICAgICAgPC9sYWJlbD5cblx0ICAgICAgIDxocj5cblx0ICAgICAgIDxwIG5nLWNsYXNzPVwic3R5bGVcIj5Vc2luZyBTdHJpbmcgU3ludGF4PC9wPlxuXHQgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJzdHlsZVwiXG5cdCAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJUeXBlOiBib2xkIHN0cmlrZSByZWRcIiBhcmlhLWxhYmVsPVwiVHlwZTogYm9sZCBzdHJpa2UgcmVkXCI+XG5cdCAgICAgICA8aHI+XG5cdCAgICAgICA8cCBuZy1jbGFzcz1cIltzdHlsZTEsIHN0eWxlMiwgc3R5bGUzXVwiPlVzaW5nIEFycmF5IFN5bnRheDwvcD5cblx0ICAgICAgIDxpbnB1dCBuZy1tb2RlbD1cInN0eWxlMVwiXG5cdCAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJUeXBlOiBib2xkLCBzdHJpa2Ugb3IgcmVkXCIgYXJpYS1sYWJlbD1cIlR5cGU6IGJvbGQsIHN0cmlrZSBvciByZWRcIj48YnI+XG5cdCAgICAgICA8aW5wdXQgbmctbW9kZWw9XCJzdHlsZTJcIlxuXHQgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVHlwZTogYm9sZCwgc3RyaWtlIG9yIHJlZFwiIGFyaWEtbGFiZWw9XCJUeXBlOiBib2xkLCBzdHJpa2Ugb3IgcmVkIDJcIj48YnI+XG5cdCAgICAgICA8aW5wdXQgbmctbW9kZWw9XCJzdHlsZTNcIlxuXHQgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVHlwZTogYm9sZCwgc3RyaWtlIG9yIHJlZFwiIGFyaWEtbGFiZWw9XCJUeXBlOiBib2xkLCBzdHJpa2Ugb3IgcmVkIDNcIj48YnI+XG5cdCAgICAgICA8aHI+XG5cdCAgICAgICA8cCBuZy1jbGFzcz1cIltzdHlsZTQsIHtvcmFuZ2U6IHdhcm5pbmd9XVwiPlVzaW5nIEFycmF5IGFuZCBNYXAgU3ludGF4PC9wPlxuXHQgICAgICAgPGlucHV0IG5nLW1vZGVsPVwic3R5bGU0XCIgcGxhY2Vob2xkZXI9XCJUeXBlOiBib2xkLCBzdHJpa2VcIiBhcmlhLWxhYmVsPVwiVHlwZTogYm9sZCwgc3RyaWtlXCI+PGJyPlxuXHQgICAgICAgPGxhYmVsPjxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cIndhcm5pbmdcIj4gd2FybmluZyAoYXBwbHkgXCJvcmFuZ2VcIiBjbGFzcyk8L2xhYmVsPlxuXHQgICAgIDwvZmlsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwic3R5bGUuY3NzXCI+XG5cdCAgICAgICAuc3RyaWtlIHtcblx0ICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IGxpbmUtdGhyb3VnaDtcblx0ICAgICAgIH1cblx0ICAgICAgIC5ib2xkIHtcblx0ICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDtcblx0ICAgICAgIH1cblx0ICAgICAgIC5yZWQge1xuXHQgICAgICAgICAgIGNvbG9yOiByZWQ7XG5cdCAgICAgICB9XG5cdCAgICAgICAuaGFzLWVycm9yIHtcblx0ICAgICAgICAgICBjb2xvcjogcmVkO1xuXHQgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHllbGxvdztcblx0ICAgICAgIH1cblx0ICAgICAgIC5vcmFuZ2Uge1xuXHQgICAgICAgICAgIGNvbG9yOiBvcmFuZ2U7XG5cdCAgICAgICB9XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgIHZhciBwcyA9IGVsZW1lbnQuYWxsKGJ5LmNzcygncCcpKTtcblx0XG5cdCAgICAgICBpdCgnc2hvdWxkIGxldCB5b3UgdG9nZ2xlIHRoZSBjbGFzcycsIGZ1bmN0aW9uKCkge1xuXHRcblx0ICAgICAgICAgZXhwZWN0KHBzLmZpcnN0KCkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS5ub3QudG9NYXRjaCgvYm9sZC8pO1xuXHQgICAgICAgICBleHBlY3QocHMuZmlyc3QoKS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLm5vdC50b01hdGNoKC9oYXMtZXJyb3IvKTtcblx0XG5cdCAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ2ltcG9ydGFudCcpKS5jbGljaygpO1xuXHQgICAgICAgICBleHBlY3QocHMuZmlyc3QoKS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLnRvTWF0Y2goL2JvbGQvKTtcblx0XG5cdCAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ2Vycm9yJykpLmNsaWNrKCk7XG5cdCAgICAgICAgIGV4cGVjdChwcy5maXJzdCgpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSkudG9NYXRjaCgvaGFzLWVycm9yLyk7XG5cdCAgICAgICB9KTtcblx0XG5cdCAgICAgICBpdCgnc2hvdWxkIGxldCB5b3UgdG9nZ2xlIHN0cmluZyBleGFtcGxlJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgIGV4cGVjdChwcy5nZXQoMSkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS50b0JlKCcnKTtcblx0ICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnc3R5bGUnKSkuY2xlYXIoKTtcblx0ICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnc3R5bGUnKSkuc2VuZEtleXMoJ3JlZCcpO1xuXHQgICAgICAgICBleHBlY3QocHMuZ2V0KDEpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSkudG9CZSgncmVkJyk7XG5cdCAgICAgICB9KTtcblx0XG5cdCAgICAgICBpdCgnYXJyYXkgZXhhbXBsZSBzaG91bGQgaGF2ZSAzIGNsYXNzZXMnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgZXhwZWN0KHBzLmdldCgyKS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLnRvQmUoJycpO1xuXHQgICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCdzdHlsZTEnKSkuc2VuZEtleXMoJ2JvbGQnKTtcblx0ICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnc3R5bGUyJykpLnNlbmRLZXlzKCdzdHJpa2UnKTtcblx0ICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnc3R5bGUzJykpLnNlbmRLZXlzKCdyZWQnKTtcblx0ICAgICAgICAgZXhwZWN0KHBzLmdldCgyKS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLnRvQmUoJ2JvbGQgc3RyaWtlIHJlZCcpO1xuXHQgICAgICAgfSk7XG5cdFxuXHQgICAgICAgaXQoJ2FycmF5IHdpdGggbWFwIGV4YW1wbGUgc2hvdWxkIGhhdmUgMiBjbGFzc2VzJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgIGV4cGVjdChwcy5sYXN0KCkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS50b0JlKCcnKTtcblx0ICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnc3R5bGU0JykpLnNlbmRLZXlzKCdib2xkJyk7XG5cdCAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ3dhcm5pbmcnKSkuY2xpY2soKTtcblx0ICAgICAgICAgZXhwZWN0KHBzLmxhc3QoKS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLnRvQmUoJ2JvbGQgb3JhbmdlJyk7XG5cdCAgICAgICB9KTtcblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0XG5cdCAgICMjIEFuaW1hdGlvbnNcblx0XG5cdCAgIFRoZSBleGFtcGxlIGJlbG93IGRlbW9uc3RyYXRlcyBob3cgdG8gcGVyZm9ybSBhbmltYXRpb25zIHVzaW5nIG5nQ2xhc3MuXG5cdFxuXHQgICA8ZXhhbXBsZSBtb2R1bGU9XCJuZ0FuaW1hdGVcIiBkZXBzPVwiYW5ndWxhci1hbmltYXRlLmpzXCIgYW5pbWF0aW9ucz1cInRydWVcIj5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICA8aW5wdXQgaWQ9XCJzZXRidG5cIiB0eXBlPVwiYnV0dG9uXCIgdmFsdWU9XCJzZXRcIiBuZy1jbGljaz1cIm15VmFyPSdteS1jbGFzcydcIj5cblx0ICAgICAgPGlucHV0IGlkPVwiY2xlYXJidG5cIiB0eXBlPVwiYnV0dG9uXCIgdmFsdWU9XCJjbGVhclwiIG5nLWNsaWNrPVwibXlWYXI9JydcIj5cblx0ICAgICAgPGJyPlxuXHQgICAgICA8c3BhbiBjbGFzcz1cImJhc2UtY2xhc3NcIiBuZy1jbGFzcz1cIm15VmFyXCI+U2FtcGxlIFRleHQ8L3NwYW4+XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJzdHlsZS5jc3NcIj5cblx0ICAgICAgIC5iYXNlLWNsYXNzIHtcblx0ICAgICAgICAgdHJhbnNpdGlvbjphbGwgY3ViaWMtYmV6aWVyKDAuMjUwLCAwLjQ2MCwgMC40NTAsIDAuOTQwKSAwLjVzO1xuXHQgICAgICAgfVxuXHRcblx0ICAgICAgIC5iYXNlLWNsYXNzLm15LWNsYXNzIHtcblx0ICAgICAgICAgY29sb3I6IHJlZDtcblx0ICAgICAgICAgZm9udC1zaXplOjNlbTtcblx0ICAgICAgIH1cblx0ICAgICA8L2ZpbGU+XG5cdCAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1jbGFzcycsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5jc3MoJy5iYXNlLWNsYXNzJykpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSkubm90LlxuXHQgICAgICAgICAgIHRvTWF0Y2goL215LWNsYXNzLyk7XG5cdFxuXHQgICAgICAgICBlbGVtZW50KGJ5LmlkKCdzZXRidG4nKSkuY2xpY2soKTtcblx0XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmNzcygnLmJhc2UtY2xhc3MnKSkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS5cblx0ICAgICAgICAgICB0b01hdGNoKC9teS1jbGFzcy8pO1xuXHRcblx0ICAgICAgICAgZWxlbWVudChieS5pZCgnY2xlYXJidG4nKSkuY2xpY2soKTtcblx0XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmNzcygnLmJhc2UtY2xhc3MnKSkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS5ub3QuXG5cdCAgICAgICAgICAgdG9NYXRjaCgvbXktY2xhc3MvKTtcblx0ICAgICAgIH0pO1xuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHRcblx0XG5cdCAgICMjIG5nQ2xhc3MgYW5kIHByZS1leGlzdGluZyBDU1MzIFRyYW5zaXRpb25zL0FuaW1hdGlvbnNcblx0ICAgVGhlIG5nQ2xhc3MgZGlyZWN0aXZlIHN0aWxsIHN1cHBvcnRzIENTUzMgVHJhbnNpdGlvbnMvQW5pbWF0aW9ucyBldmVuIGlmIHRoZXkgZG8gbm90IGZvbGxvdyB0aGUgbmdBbmltYXRlIENTUyBuYW1pbmcgc3RydWN0dXJlLlxuXHQgICBVcG9uIGFuaW1hdGlvbiBuZ0FuaW1hdGUgd2lsbCBhcHBseSBzdXBwbGVtZW50YXJ5IENTUyBjbGFzc2VzIHRvIHRyYWNrIHRoZSBzdGFydCBhbmQgZW5kIG9mIGFuIGFuaW1hdGlvbiwgYnV0IHRoaXMgd2lsbCBub3QgaGluZGVyXG5cdCAgIGFueSBwcmUtZXhpc3RpbmcgQ1NTIHRyYW5zaXRpb25zIGFscmVhZHkgb24gdGhlIGVsZW1lbnQuIFRvIGdldCBhbiBpZGVhIG9mIHdoYXQgaGFwcGVucyBkdXJpbmcgYSBjbGFzcy1iYXNlZCBhbmltYXRpb24sIGJlIHN1cmVcblx0ICAgdG8gdmlldyB0aGUgc3RlcCBieSBzdGVwIGRldGFpbHMgb2Yge0BsaW5rICRhbmltYXRlI2FkZENsYXNzICRhbmltYXRlLmFkZENsYXNzfSBhbmRcblx0ICAge0BsaW5rICRhbmltYXRlI3JlbW92ZUNsYXNzICRhbmltYXRlLnJlbW92ZUNsYXNzfS5cblx0ICovXG5cdHZhciBuZ0NsYXNzRGlyZWN0aXZlID0gY2xhc3NEaXJlY3RpdmUoJycsIHRydWUpO1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdDbGFzc09kZFxuXHQgKiBAcmVzdHJpY3QgQUNcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFRoZSBgbmdDbGFzc09kZGAgYW5kIGBuZ0NsYXNzRXZlbmAgZGlyZWN0aXZlcyB3b3JrIGV4YWN0bHkgYXNcblx0ICoge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0NsYXNzIG5nQ2xhc3N9LCBleGNlcHQgdGhleSB3b3JrIGluXG5cdCAqIGNvbmp1bmN0aW9uIHdpdGggYG5nUmVwZWF0YCBhbmQgdGFrZSBlZmZlY3Qgb25seSBvbiBvZGQgKGV2ZW4pIHJvd3MuXG5cdCAqXG5cdCAqIFRoaXMgZGlyZWN0aXZlIGNhbiBiZSBhcHBsaWVkIG9ubHkgd2l0aGluIHRoZSBzY29wZSBvZiBhblxuXHQgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nUmVwZWF0IG5nUmVwZWF0fS5cblx0ICpcblx0ICogQGVsZW1lbnQgQU5ZXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdDbGFzc09kZCB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsLiBUaGUgcmVzdWx0XG5cdCAqICAgb2YgdGhlIGV2YWx1YXRpb24gY2FuIGJlIGEgc3RyaW5nIHJlcHJlc2VudGluZyBzcGFjZSBkZWxpbWl0ZWQgY2xhc3MgbmFtZXMgb3IgYW4gYXJyYXkuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgPG9sIG5nLWluaXQ9XCJuYW1lcz1bJ0pvaG4nLCAnTWFyeScsICdDYXRlJywgJ1N1eiddXCI+XG5cdCAgICAgICAgICA8bGkgbmctcmVwZWF0PVwibmFtZSBpbiBuYW1lc1wiPlxuXHQgICAgICAgICAgIDxzcGFuIG5nLWNsYXNzLW9kZD1cIidvZGQnXCIgbmctY2xhc3MtZXZlbj1cIidldmVuJ1wiPlxuXHQgICAgICAgICAgICAge3tuYW1lfX1cblx0ICAgICAgICAgICA8L3NwYW4+XG5cdCAgICAgICAgICA8L2xpPlxuXHQgICAgICAgIDwvb2w+XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJzdHlsZS5jc3NcIj5cblx0ICAgICAgIC5vZGQge1xuXHQgICAgICAgICBjb2xvcjogcmVkO1xuXHQgICAgICAgfVxuXHQgICAgICAgLmV2ZW4ge1xuXHQgICAgICAgICBjb2xvcjogYmx1ZTtcblx0ICAgICAgIH1cblx0ICAgICA8L2ZpbGU+XG5cdCAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1jbGFzcy1vZGQgYW5kIG5nLWNsYXNzLWV2ZW4nLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkucmVwZWF0ZXIoJ25hbWUgaW4gbmFtZXMnKS5yb3coMCkuY29sdW1uKCduYW1lJykpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSkuXG5cdCAgICAgICAgICAgdG9NYXRjaCgvb2RkLyk7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LnJlcGVhdGVyKCduYW1lIGluIG5hbWVzJykucm93KDEpLmNvbHVtbignbmFtZScpKS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLlxuXHQgICAgICAgICAgIHRvTWF0Y2goL2V2ZW4vKTtcblx0ICAgICAgIH0pO1xuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKi9cblx0dmFyIG5nQ2xhc3NPZGREaXJlY3RpdmUgPSBjbGFzc0RpcmVjdGl2ZSgnT2RkJywgMCk7XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ0NsYXNzRXZlblxuXHQgKiBAcmVzdHJpY3QgQUNcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFRoZSBgbmdDbGFzc09kZGAgYW5kIGBuZ0NsYXNzRXZlbmAgZGlyZWN0aXZlcyB3b3JrIGV4YWN0bHkgYXNcblx0ICoge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0NsYXNzIG5nQ2xhc3N9LCBleGNlcHQgdGhleSB3b3JrIGluXG5cdCAqIGNvbmp1bmN0aW9uIHdpdGggYG5nUmVwZWF0YCBhbmQgdGFrZSBlZmZlY3Qgb25seSBvbiBvZGQgKGV2ZW4pIHJvd3MuXG5cdCAqXG5cdCAqIFRoaXMgZGlyZWN0aXZlIGNhbiBiZSBhcHBsaWVkIG9ubHkgd2l0aGluIHRoZSBzY29wZSBvZiBhblxuXHQgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nUmVwZWF0IG5nUmVwZWF0fS5cblx0ICpcblx0ICogQGVsZW1lbnQgQU5ZXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdDbGFzc0V2ZW4ge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbC4gVGhlXG5cdCAqICAgcmVzdWx0IG9mIHRoZSBldmFsdWF0aW9uIGNhbiBiZSBhIHN0cmluZyByZXByZXNlbnRpbmcgc3BhY2UgZGVsaW1pdGVkIGNsYXNzIG5hbWVzIG9yIGFuIGFycmF5LlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgIDxvbCBuZy1pbml0PVwibmFtZXM9WydKb2huJywgJ01hcnknLCAnQ2F0ZScsICdTdXonXVwiPlxuXHQgICAgICAgICAgPGxpIG5nLXJlcGVhdD1cIm5hbWUgaW4gbmFtZXNcIj5cblx0ICAgICAgICAgICA8c3BhbiBuZy1jbGFzcy1vZGQ9XCInb2RkJ1wiIG5nLWNsYXNzLWV2ZW49XCInZXZlbidcIj5cblx0ICAgICAgICAgICAgIHt7bmFtZX19ICZuYnNwOyAmbmJzcDsgJm5ic3A7XG5cdCAgICAgICAgICAgPC9zcGFuPlxuXHQgICAgICAgICAgPC9saT5cblx0ICAgICAgICA8L29sPlxuXHQgICAgIDwvZmlsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwic3R5bGUuY3NzXCI+XG5cdCAgICAgICAub2RkIHtcblx0ICAgICAgICAgY29sb3I6IHJlZDtcblx0ICAgICAgIH1cblx0ICAgICAgIC5ldmVuIHtcblx0ICAgICAgICAgY29sb3I6IGJsdWU7XG5cdCAgICAgICB9XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgIGl0KCdzaG91bGQgY2hlY2sgbmctY2xhc3Mtb2RkIGFuZCBuZy1jbGFzcy1ldmVuJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LnJlcGVhdGVyKCduYW1lIGluIG5hbWVzJykucm93KDApLmNvbHVtbignbmFtZScpKS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLlxuXHQgICAgICAgICAgIHRvTWF0Y2goL29kZC8pO1xuXHQgICAgICAgICBleHBlY3QoZWxlbWVudChieS5yZXBlYXRlcignbmFtZSBpbiBuYW1lcycpLnJvdygxKS5jb2x1bW4oJ25hbWUnKSkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS5cblx0ICAgICAgICAgICB0b01hdGNoKC9ldmVuLyk7XG5cdCAgICAgICB9KTtcblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICovXG5cdHZhciBuZ0NsYXNzRXZlbkRpcmVjdGl2ZSA9IGNsYXNzRGlyZWN0aXZlKCdFdmVuJywgMSk7XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ0Nsb2FrXG5cdCAqIEByZXN0cmljdCBBQ1xuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogVGhlIGBuZ0Nsb2FrYCBkaXJlY3RpdmUgaXMgdXNlZCB0byBwcmV2ZW50IHRoZSBBbmd1bGFyIGh0bWwgdGVtcGxhdGUgZnJvbSBiZWluZyBicmllZmx5XG5cdCAqIGRpc3BsYXllZCBieSB0aGUgYnJvd3NlciBpbiBpdHMgcmF3ICh1bmNvbXBpbGVkKSBmb3JtIHdoaWxlIHlvdXIgYXBwbGljYXRpb24gaXMgbG9hZGluZy4gVXNlIHRoaXNcblx0ICogZGlyZWN0aXZlIHRvIGF2b2lkIHRoZSB1bmRlc2lyYWJsZSBmbGlja2VyIGVmZmVjdCBjYXVzZWQgYnkgdGhlIGh0bWwgdGVtcGxhdGUgZGlzcGxheS5cblx0ICpcblx0ICogVGhlIGRpcmVjdGl2ZSBjYW4gYmUgYXBwbGllZCB0byB0aGUgYDxib2R5PmAgZWxlbWVudCwgYnV0IHRoZSBwcmVmZXJyZWQgdXNhZ2UgaXMgdG8gYXBwbHlcblx0ICogbXVsdGlwbGUgYG5nQ2xvYWtgIGRpcmVjdGl2ZXMgdG8gc21hbGwgcG9ydGlvbnMgb2YgdGhlIHBhZ2UgdG8gcGVybWl0IHByb2dyZXNzaXZlIHJlbmRlcmluZ1xuXHQgKiBvZiB0aGUgYnJvd3NlciB2aWV3LlxuXHQgKlxuXHQgKiBgbmdDbG9ha2Agd29ya3MgaW4gY29vcGVyYXRpb24gd2l0aCB0aGUgZm9sbG93aW5nIGNzcyBydWxlIGVtYmVkZGVkIHdpdGhpbiBgYW5ndWxhci5qc2AgYW5kXG5cdCAqIGBhbmd1bGFyLm1pbi5qc2AuXG5cdCAqIEZvciBDU1AgbW9kZSBwbGVhc2UgYWRkIGBhbmd1bGFyLWNzcC5jc3NgIHRvIHlvdXIgaHRtbCBmaWxlIChzZWUge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0NzcCBuZ0NzcH0pLlxuXHQgKlxuXHQgKiBgYGBjc3Ncblx0ICogW25nXFw6Y2xvYWtdLCBbbmctY2xvYWtdLCBbZGF0YS1uZy1jbG9ha10sIFt4LW5nLWNsb2FrXSwgLm5nLWNsb2FrLCAueC1uZy1jbG9hayB7XG5cdCAqICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O1xuXHQgKiB9XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBXaGVuIHRoaXMgY3NzIHJ1bGUgaXMgbG9hZGVkIGJ5IHRoZSBicm93c2VyLCBhbGwgaHRtbCBlbGVtZW50cyAoaW5jbHVkaW5nIHRoZWlyIGNoaWxkcmVuKSB0aGF0XG5cdCAqIGFyZSB0YWdnZWQgd2l0aCB0aGUgYG5nQ2xvYWtgIGRpcmVjdGl2ZSBhcmUgaGlkZGVuLiBXaGVuIEFuZ3VsYXIgZW5jb3VudGVycyB0aGlzIGRpcmVjdGl2ZVxuXHQgKiBkdXJpbmcgdGhlIGNvbXBpbGF0aW9uIG9mIHRoZSB0ZW1wbGF0ZSBpdCBkZWxldGVzIHRoZSBgbmdDbG9ha2AgZWxlbWVudCBhdHRyaWJ1dGUsIG1ha2luZ1xuXHQgKiB0aGUgY29tcGlsZWQgZWxlbWVudCB2aXNpYmxlLlxuXHQgKlxuXHQgKiBGb3IgdGhlIGJlc3QgcmVzdWx0LCB0aGUgYGFuZ3VsYXIuanNgIHNjcmlwdCBtdXN0IGJlIGxvYWRlZCBpbiB0aGUgaGVhZCBzZWN0aW9uIG9mIHRoZSBodG1sXG5cdCAqIGRvY3VtZW50OyBhbHRlcm5hdGl2ZWx5LCB0aGUgY3NzIHJ1bGUgYWJvdmUgbXVzdCBiZSBpbmNsdWRlZCBpbiB0aGUgZXh0ZXJuYWwgc3R5bGVzaGVldCBvZiB0aGVcblx0ICogYXBwbGljYXRpb24uXG5cdCAqXG5cdCAqIEBlbGVtZW50IEFOWVxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgIDxkaXYgaWQ9XCJ0ZW1wbGF0ZTFcIiBuZy1jbG9haz57eyAnaGVsbG8nIH19PC9kaXY+XG5cdCAgICAgICAgPGRpdiBpZD1cInRlbXBsYXRlMlwiIGNsYXNzPVwibmctY2xvYWtcIj57eyAnd29ybGQnIH19PC9kaXY+XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgIGl0KCdzaG91bGQgcmVtb3ZlIHRoZSB0ZW1wbGF0ZSBkaXJlY3RpdmUgYW5kIGNzcyBjbGFzcycsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICBleHBlY3QoJCgnI3RlbXBsYXRlMScpLmdldEF0dHJpYnV0ZSgnbmctY2xvYWsnKSkuXG5cdCAgICAgICAgICAgdG9CZU51bGwoKTtcblx0ICAgICAgICAgZXhwZWN0KCQoJyN0ZW1wbGF0ZTInKS5nZXRBdHRyaWJ1dGUoJ25nLWNsb2FrJykpLlxuXHQgICAgICAgICAgIHRvQmVOdWxsKCk7XG5cdCAgICAgICB9KTtcblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICpcblx0ICovXG5cdHZhciBuZ0Nsb2FrRGlyZWN0aXZlID0gbmdEaXJlY3RpdmUoe1xuXHQgIGNvbXBpbGU6IGZ1bmN0aW9uKGVsZW1lbnQsIGF0dHIpIHtcblx0ICAgIGF0dHIuJHNldCgnbmdDbG9haycsIHVuZGVmaW5lZCk7XG5cdCAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCduZy1jbG9haycpO1xuXHQgIH1cblx0fSk7XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ0NvbnRyb2xsZXJcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFRoZSBgbmdDb250cm9sbGVyYCBkaXJlY3RpdmUgYXR0YWNoZXMgYSBjb250cm9sbGVyIGNsYXNzIHRvIHRoZSB2aWV3LiBUaGlzIGlzIGEga2V5IGFzcGVjdCBvZiBob3cgYW5ndWxhclxuXHQgKiBzdXBwb3J0cyB0aGUgcHJpbmNpcGxlcyBiZWhpbmQgdGhlIE1vZGVsLVZpZXctQ29udHJvbGxlciBkZXNpZ24gcGF0dGVybi5cblx0ICpcblx0ICogTVZDIGNvbXBvbmVudHMgaW4gYW5ndWxhcjpcblx0ICpcblx0ICogKiBNb2RlbCDigJQgTW9kZWxzIGFyZSB0aGUgcHJvcGVydGllcyBvZiBhIHNjb3BlOyBzY29wZXMgYXJlIGF0dGFjaGVkIHRvIHRoZSBET00gd2hlcmUgc2NvcGUgcHJvcGVydGllc1xuXHQgKiAgIGFyZSBhY2Nlc3NlZCB0aHJvdWdoIGJpbmRpbmdzLlxuXHQgKiAqIFZpZXcg4oCUIFRoZSB0ZW1wbGF0ZSAoSFRNTCB3aXRoIGRhdGEgYmluZGluZ3MpIHRoYXQgaXMgcmVuZGVyZWQgaW50byB0aGUgVmlldy5cblx0ICogKiBDb250cm9sbGVyIOKAlCBUaGUgYG5nQ29udHJvbGxlcmAgZGlyZWN0aXZlIHNwZWNpZmllcyBhIENvbnRyb2xsZXIgY2xhc3M7IHRoZSBjbGFzcyBjb250YWlucyBidXNpbmVzc1xuXHQgKiAgIGxvZ2ljIGJlaGluZCB0aGUgYXBwbGljYXRpb24gdG8gZGVjb3JhdGUgdGhlIHNjb3BlIHdpdGggZnVuY3Rpb25zIGFuZCB2YWx1ZXNcblx0ICpcblx0ICogTm90ZSB0aGF0IHlvdSBjYW4gYWxzbyBhdHRhY2ggY29udHJvbGxlcnMgdG8gdGhlIERPTSBieSBkZWNsYXJpbmcgaXQgaW4gYSByb3V0ZSBkZWZpbml0aW9uXG5cdCAqIHZpYSB0aGUge0BsaW5rIG5nUm91dGUuJHJvdXRlICRyb3V0ZX0gc2VydmljZS4gQSBjb21tb24gbWlzdGFrZSBpcyB0byBkZWNsYXJlIHRoZSBjb250cm9sbGVyXG5cdCAqIGFnYWluIHVzaW5nIGBuZy1jb250cm9sbGVyYCBpbiB0aGUgdGVtcGxhdGUgaXRzZWxmLiAgVGhpcyB3aWxsIGNhdXNlIHRoZSBjb250cm9sbGVyIHRvIGJlIGF0dGFjaGVkXG5cdCAqIGFuZCBleGVjdXRlZCB0d2ljZS5cblx0ICpcblx0ICogQGVsZW1lbnQgQU5ZXG5cdCAqIEBzY29wZVxuXHQgKiBAcHJpb3JpdHkgNTAwXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdDb250cm9sbGVyIE5hbWUgb2YgYSBjb25zdHJ1Y3RvciBmdW5jdGlvbiByZWdpc3RlcmVkIHdpdGggdGhlIGN1cnJlbnRcblx0ICoge0BsaW5rIG5nLiRjb250cm9sbGVyUHJvdmlkZXIgJGNvbnRyb2xsZXJQcm92aWRlcn0gb3IgYW4ge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gZXhwcmVzc2lvbn1cblx0ICogdGhhdCBvbiB0aGUgY3VycmVudCBzY29wZSBldmFsdWF0ZXMgdG8gYSBjb25zdHJ1Y3RvciBmdW5jdGlvbi5cblx0ICpcblx0ICogVGhlIGNvbnRyb2xsZXIgaW5zdGFuY2UgY2FuIGJlIHB1Ymxpc2hlZCBpbnRvIGEgc2NvcGUgcHJvcGVydHkgYnkgc3BlY2lmeWluZ1xuXHQgKiBgbmctY29udHJvbGxlcj1cImFzIHByb3BlcnR5TmFtZVwiYC5cblx0ICpcblx0ICogSWYgdGhlIGN1cnJlbnQgYCRjb250cm9sbGVyUHJvdmlkZXJgIGlzIGNvbmZpZ3VyZWQgdG8gdXNlIGdsb2JhbHMgKHZpYVxuXHQgKiB7QGxpbmsgbmcuJGNvbnRyb2xsZXJQcm92aWRlciNhbGxvd0dsb2JhbHMgYCRjb250cm9sbGVyUHJvdmlkZXIuYWxsb3dHbG9iYWxzKClgIH0pLCB0aGlzIG1heVxuXHQgKiBhbHNvIGJlIHRoZSBuYW1lIG9mIGEgZ2xvYmFsbHkgYWNjZXNzaWJsZSBjb25zdHJ1Y3RvciBmdW5jdGlvbiAobm90IHJlY29tbWVuZGVkKS5cblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICogSGVyZSBpcyBhIHNpbXBsZSBmb3JtIGZvciBlZGl0aW5nIHVzZXIgY29udGFjdCBpbmZvcm1hdGlvbi4gQWRkaW5nLCByZW1vdmluZywgY2xlYXJpbmcsIGFuZFxuXHQgKiBncmVldGluZyBhcmUgbWV0aG9kcyBkZWNsYXJlZCBvbiB0aGUgY29udHJvbGxlciAoc2VlIHNvdXJjZSB0YWIpLiBUaGVzZSBtZXRob2RzIGNhblxuXHQgKiBlYXNpbHkgYmUgY2FsbGVkIGZyb20gdGhlIGFuZ3VsYXIgbWFya3VwLiBBbnkgY2hhbmdlcyB0byB0aGUgZGF0YSBhcmUgYXV0b21hdGljYWxseSByZWZsZWN0ZWRcblx0ICogaW4gdGhlIFZpZXcgd2l0aG91dCB0aGUgbmVlZCBmb3IgYSBtYW51YWwgdXBkYXRlLlxuXHQgKlxuXHQgKiBUd28gZGlmZmVyZW50IGRlY2xhcmF0aW9uIHN0eWxlcyBhcmUgaW5jbHVkZWQgYmVsb3c6XG5cdCAqXG5cdCAqICogb25lIGJpbmRzIG1ldGhvZHMgYW5kIHByb3BlcnRpZXMgZGlyZWN0bHkgb250byB0aGUgY29udHJvbGxlciB1c2luZyBgdGhpc2A6XG5cdCAqIGBuZy1jb250cm9sbGVyPVwiU2V0dGluZ3NDb250cm9sbGVyMSBhcyBzZXR0aW5nc1wiYFxuXHQgKiAqIG9uZSBpbmplY3RzIGAkc2NvcGVgIGludG8gdGhlIGNvbnRyb2xsZXI6XG5cdCAqIGBuZy1jb250cm9sbGVyPVwiU2V0dGluZ3NDb250cm9sbGVyMlwiYFxuXHQgKlxuXHQgKiBUaGUgc2Vjb25kIG9wdGlvbiBpcyBtb3JlIGNvbW1vbiBpbiB0aGUgQW5ndWxhciBjb21tdW5pdHksIGFuZCBpcyBnZW5lcmFsbHkgdXNlZCBpbiBib2lsZXJwbGF0ZXNcblx0ICogYW5kIGluIHRoaXMgZ3VpZGUuIEhvd2V2ZXIsIHRoZXJlIGFyZSBhZHZhbnRhZ2VzIHRvIGJpbmRpbmcgcHJvcGVydGllcyBkaXJlY3RseSB0byB0aGUgY29udHJvbGxlclxuXHQgKiBhbmQgYXZvaWRpbmcgc2NvcGUuXG5cdCAqXG5cdCAqICogVXNpbmcgYGNvbnRyb2xsZXIgYXNgIG1ha2VzIGl0IG9idmlvdXMgd2hpY2ggY29udHJvbGxlciB5b3UgYXJlIGFjY2Vzc2luZyBpbiB0aGUgdGVtcGxhdGUgd2hlblxuXHQgKiBtdWx0aXBsZSBjb250cm9sbGVycyBhcHBseSB0byBhbiBlbGVtZW50LlxuXHQgKiAqIElmIHlvdSBhcmUgd3JpdGluZyB5b3VyIGNvbnRyb2xsZXJzIGFzIGNsYXNzZXMgeW91IGhhdmUgZWFzaWVyIGFjY2VzcyB0byB0aGUgcHJvcGVydGllcyBhbmRcblx0ICogbWV0aG9kcywgd2hpY2ggd2lsbCBhcHBlYXIgb24gdGhlIHNjb3BlLCBmcm9tIGluc2lkZSB0aGUgY29udHJvbGxlciBjb2RlLlxuXHQgKiAqIFNpbmNlIHRoZXJlIGlzIGFsd2F5cyBhIGAuYCBpbiB0aGUgYmluZGluZ3MsIHlvdSBkb24ndCBoYXZlIHRvIHdvcnJ5IGFib3V0IHByb3RvdHlwYWxcblx0ICogaW5oZXJpdGFuY2UgbWFza2luZyBwcmltaXRpdmVzLlxuXHQgKlxuXHQgKiBUaGlzIGV4YW1wbGUgZGVtb25zdHJhdGVzIHRoZSBgY29udHJvbGxlciBhc2Agc3ludGF4LlxuXHQgKlxuXHQgKiA8ZXhhbXBsZSBuYW1lPVwibmdDb250cm9sbGVyQXNcIiBtb2R1bGU9XCJjb250cm9sbGVyQXNFeGFtcGxlXCI+XG5cdCAqICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICogICAgPGRpdiBpZD1cImN0cmwtYXMtZXhtcGxcIiBuZy1jb250cm9sbGVyPVwiU2V0dGluZ3NDb250cm9sbGVyMSBhcyBzZXR0aW5nc1wiPlxuXHQgKiAgICAgIDxsYWJlbD5OYW1lOiA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cInNldHRpbmdzLm5hbWVcIi8+PC9sYWJlbD5cblx0ICogICAgICA8YnV0dG9uIG5nLWNsaWNrPVwic2V0dGluZ3MuZ3JlZXQoKVwiPmdyZWV0PC9idXR0b24+PGJyLz5cblx0ICogICAgICBDb250YWN0OlxuXHQgKiAgICAgIDx1bD5cblx0ICogICAgICAgIDxsaSBuZy1yZXBlYXQ9XCJjb250YWN0IGluIHNldHRpbmdzLmNvbnRhY3RzXCI+XG5cdCAqICAgICAgICAgIDxzZWxlY3QgbmctbW9kZWw9XCJjb250YWN0LnR5cGVcIiBhcmlhLWxhYmVsPVwiQ29udGFjdCBtZXRob2RcIiBpZD1cInNlbGVjdF97eyRpbmRleH19XCI+XG5cdCAqICAgICAgICAgICAgIDxvcHRpb24+cGhvbmU8L29wdGlvbj5cblx0ICogICAgICAgICAgICAgPG9wdGlvbj5lbWFpbDwvb3B0aW9uPlxuXHQgKiAgICAgICAgICA8L3NlbGVjdD5cblx0ICogICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJjb250YWN0LnZhbHVlXCIgYXJpYS1sYWJlbGxlZGJ5PVwic2VsZWN0X3t7JGluZGV4fX1cIiAvPlxuXHQgKiAgICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwic2V0dGluZ3MuY2xlYXJDb250YWN0KGNvbnRhY3QpXCI+Y2xlYXI8L2J1dHRvbj5cblx0ICogICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cInNldHRpbmdzLnJlbW92ZUNvbnRhY3QoY29udGFjdClcIiBhcmlhLWxhYmVsPVwiUmVtb3ZlXCI+WDwvYnV0dG9uPlxuXHQgKiAgICAgICAgPC9saT5cblx0ICogICAgICAgIDxsaT48YnV0dG9uIG5nLWNsaWNrPVwic2V0dGluZ3MuYWRkQ29udGFjdCgpXCI+YWRkPC9idXR0b24+PC9saT5cblx0ICogICAgIDwvdWw+XG5cdCAqICAgIDwvZGl2PlxuXHQgKiAgIDwvZmlsZT5cblx0ICogICA8ZmlsZSBuYW1lPVwiYXBwLmpzXCI+XG5cdCAqICAgIGFuZ3VsYXIubW9kdWxlKCdjb250cm9sbGVyQXNFeGFtcGxlJywgW10pXG5cdCAqICAgICAgLmNvbnRyb2xsZXIoJ1NldHRpbmdzQ29udHJvbGxlcjEnLCBTZXR0aW5nc0NvbnRyb2xsZXIxKTtcblx0ICpcblx0ICogICAgZnVuY3Rpb24gU2V0dGluZ3NDb250cm9sbGVyMSgpIHtcblx0ICogICAgICB0aGlzLm5hbWUgPSBcIkpvaG4gU21pdGhcIjtcblx0ICogICAgICB0aGlzLmNvbnRhY3RzID0gW1xuXHQgKiAgICAgICAge3R5cGU6ICdwaG9uZScsIHZhbHVlOiAnNDA4IDU1NSAxMjEyJ30sXG5cdCAqICAgICAgICB7dHlwZTogJ2VtYWlsJywgdmFsdWU6ICdqb2huLnNtaXRoQGV4YW1wbGUub3JnJ30gXTtcblx0ICogICAgfVxuXHQgKlxuXHQgKiAgICBTZXR0aW5nc0NvbnRyb2xsZXIxLnByb3RvdHlwZS5ncmVldCA9IGZ1bmN0aW9uKCkge1xuXHQgKiAgICAgIGFsZXJ0KHRoaXMubmFtZSk7XG5cdCAqICAgIH07XG5cdCAqXG5cdCAqICAgIFNldHRpbmdzQ29udHJvbGxlcjEucHJvdG90eXBlLmFkZENvbnRhY3QgPSBmdW5jdGlvbigpIHtcblx0ICogICAgICB0aGlzLmNvbnRhY3RzLnB1c2goe3R5cGU6ICdlbWFpbCcsIHZhbHVlOiAneW91cm5hbWVAZXhhbXBsZS5vcmcnfSk7XG5cdCAqICAgIH07XG5cdCAqXG5cdCAqICAgIFNldHRpbmdzQ29udHJvbGxlcjEucHJvdG90eXBlLnJlbW92ZUNvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0VG9SZW1vdmUpIHtcblx0ICogICAgIHZhciBpbmRleCA9IHRoaXMuY29udGFjdHMuaW5kZXhPZihjb250YWN0VG9SZW1vdmUpO1xuXHQgKiAgICAgIHRoaXMuY29udGFjdHMuc3BsaWNlKGluZGV4LCAxKTtcblx0ICogICAgfTtcblx0ICpcblx0ICogICAgU2V0dGluZ3NDb250cm9sbGVyMS5wcm90b3R5cGUuY2xlYXJDb250YWN0ID0gZnVuY3Rpb24oY29udGFjdCkge1xuXHQgKiAgICAgIGNvbnRhY3QudHlwZSA9ICdwaG9uZSc7XG5cdCAqICAgICAgY29udGFjdC52YWx1ZSA9ICcnO1xuXHQgKiAgICB9O1xuXHQgKiAgIDwvZmlsZT5cblx0ICogICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAqICAgICBpdCgnc2hvdWxkIGNoZWNrIGNvbnRyb2xsZXIgYXMnLCBmdW5jdGlvbigpIHtcblx0ICogICAgICAgdmFyIGNvbnRhaW5lciA9IGVsZW1lbnQoYnkuaWQoJ2N0cmwtYXMtZXhtcGwnKSk7XG5cdCAqICAgICAgICAgZXhwZWN0KGNvbnRhaW5lci5lbGVtZW50KGJ5Lm1vZGVsKCdzZXR0aW5ncy5uYW1lJykpXG5cdCAqICAgICAgICAgICAuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKS50b0JlKCdKb2huIFNtaXRoJyk7XG5cdCAqXG5cdCAqICAgICAgIHZhciBmaXJzdFJlcGVhdCA9XG5cdCAqICAgICAgICAgICBjb250YWluZXIuZWxlbWVudChieS5yZXBlYXRlcignY29udGFjdCBpbiBzZXR0aW5ncy5jb250YWN0cycpLnJvdygwKSk7XG5cdCAqICAgICAgIHZhciBzZWNvbmRSZXBlYXQgPVxuXHQgKiAgICAgICAgICAgY29udGFpbmVyLmVsZW1lbnQoYnkucmVwZWF0ZXIoJ2NvbnRhY3QgaW4gc2V0dGluZ3MuY29udGFjdHMnKS5yb3coMSkpO1xuXHQgKlxuXHQgKiAgICAgICBleHBlY3QoZmlyc3RSZXBlYXQuZWxlbWVudChieS5tb2RlbCgnY29udGFjdC52YWx1ZScpKS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpXG5cdCAqICAgICAgICAgICAudG9CZSgnNDA4IDU1NSAxMjEyJyk7XG5cdCAqXG5cdCAqICAgICAgIGV4cGVjdChzZWNvbmRSZXBlYXQuZWxlbWVudChieS5tb2RlbCgnY29udGFjdC52YWx1ZScpKS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpXG5cdCAqICAgICAgICAgICAudG9CZSgnam9obi5zbWl0aEBleGFtcGxlLm9yZycpO1xuXHQgKlxuXHQgKiAgICAgICBmaXJzdFJlcGVhdC5lbGVtZW50KGJ5LmJ1dHRvblRleHQoJ2NsZWFyJykpLmNsaWNrKCk7XG5cdCAqXG5cdCAqICAgICAgIGV4cGVjdChmaXJzdFJlcGVhdC5lbGVtZW50KGJ5Lm1vZGVsKCdjb250YWN0LnZhbHVlJykpLmdldEF0dHJpYnV0ZSgndmFsdWUnKSlcblx0ICogICAgICAgICAgIC50b0JlKCcnKTtcblx0ICpcblx0ICogICAgICAgY29udGFpbmVyLmVsZW1lbnQoYnkuYnV0dG9uVGV4dCgnYWRkJykpLmNsaWNrKCk7XG5cdCAqXG5cdCAqICAgICAgIGV4cGVjdChjb250YWluZXIuZWxlbWVudChieS5yZXBlYXRlcignY29udGFjdCBpbiBzZXR0aW5ncy5jb250YWN0cycpLnJvdygyKSlcblx0ICogICAgICAgICAgIC5lbGVtZW50KGJ5Lm1vZGVsKCdjb250YWN0LnZhbHVlJykpXG5cdCAqICAgICAgICAgICAuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKVxuXHQgKiAgICAgICAgICAgLnRvQmUoJ3lvdXJuYW1lQGV4YW1wbGUub3JnJyk7XG5cdCAqICAgICB9KTtcblx0ICogICA8L2ZpbGU+XG5cdCAqIDwvZXhhbXBsZT5cblx0ICpcblx0ICogVGhpcyBleGFtcGxlIGRlbW9uc3RyYXRlcyB0aGUgXCJhdHRhY2ggdG8gYCRzY29wZWBcIiBzdHlsZSBvZiBjb250cm9sbGVyLlxuXHQgKlxuXHQgKiA8ZXhhbXBsZSBuYW1lPVwibmdDb250cm9sbGVyXCIgbW9kdWxlPVwiY29udHJvbGxlckV4YW1wbGVcIj5cblx0ICogIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAqICAgPGRpdiBpZD1cImN0cmwtZXhtcGxcIiBuZy1jb250cm9sbGVyPVwiU2V0dGluZ3NDb250cm9sbGVyMlwiPlxuXHQgKiAgICAgPGxhYmVsPk5hbWU6IDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwibmFtZVwiLz48L2xhYmVsPlxuXHQgKiAgICAgPGJ1dHRvbiBuZy1jbGljaz1cImdyZWV0KClcIj5ncmVldDwvYnV0dG9uPjxici8+XG5cdCAqICAgICBDb250YWN0OlxuXHQgKiAgICAgPHVsPlxuXHQgKiAgICAgICA8bGkgbmctcmVwZWF0PVwiY29udGFjdCBpbiBjb250YWN0c1wiPlxuXHQgKiAgICAgICAgIDxzZWxlY3QgbmctbW9kZWw9XCJjb250YWN0LnR5cGVcIiBpZD1cInNlbGVjdF97eyRpbmRleH19XCI+XG5cdCAqICAgICAgICAgICAgPG9wdGlvbj5waG9uZTwvb3B0aW9uPlxuXHQgKiAgICAgICAgICAgIDxvcHRpb24+ZW1haWw8L29wdGlvbj5cblx0ICogICAgICAgICA8L3NlbGVjdD5cblx0ICogICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cImNvbnRhY3QudmFsdWVcIiBhcmlhLWxhYmVsbGVkYnk9XCJzZWxlY3Rfe3skaW5kZXh9fVwiIC8+XG5cdCAqICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cImNsZWFyQ29udGFjdChjb250YWN0KVwiPmNsZWFyPC9idXR0b24+XG5cdCAqICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cInJlbW92ZUNvbnRhY3QoY29udGFjdClcIj5YPC9idXR0b24+XG5cdCAqICAgICAgIDwvbGk+XG5cdCAqICAgICAgIDxsaT5bIDxidXR0b24gbmctY2xpY2s9XCJhZGRDb250YWN0KClcIj5hZGQ8L2J1dHRvbj4gXTwvbGk+XG5cdCAqICAgIDwvdWw+XG5cdCAqICAgPC9kaXY+XG5cdCAqICA8L2ZpbGU+XG5cdCAqICA8ZmlsZSBuYW1lPVwiYXBwLmpzXCI+XG5cdCAqICAgYW5ndWxhci5tb2R1bGUoJ2NvbnRyb2xsZXJFeGFtcGxlJywgW10pXG5cdCAqICAgICAuY29udHJvbGxlcignU2V0dGluZ3NDb250cm9sbGVyMicsIFsnJHNjb3BlJywgU2V0dGluZ3NDb250cm9sbGVyMl0pO1xuXHQgKlxuXHQgKiAgIGZ1bmN0aW9uIFNldHRpbmdzQ29udHJvbGxlcjIoJHNjb3BlKSB7XG5cdCAqICAgICAkc2NvcGUubmFtZSA9IFwiSm9obiBTbWl0aFwiO1xuXHQgKiAgICAgJHNjb3BlLmNvbnRhY3RzID0gW1xuXHQgKiAgICAgICB7dHlwZToncGhvbmUnLCB2YWx1ZTonNDA4IDU1NSAxMjEyJ30sXG5cdCAqICAgICAgIHt0eXBlOidlbWFpbCcsIHZhbHVlOidqb2huLnNtaXRoQGV4YW1wbGUub3JnJ30gXTtcblx0ICpcblx0ICogICAgICRzY29wZS5ncmVldCA9IGZ1bmN0aW9uKCkge1xuXHQgKiAgICAgICBhbGVydCgkc2NvcGUubmFtZSk7XG5cdCAqICAgICB9O1xuXHQgKlxuXHQgKiAgICAgJHNjb3BlLmFkZENvbnRhY3QgPSBmdW5jdGlvbigpIHtcblx0ICogICAgICAgJHNjb3BlLmNvbnRhY3RzLnB1c2goe3R5cGU6J2VtYWlsJywgdmFsdWU6J3lvdXJuYW1lQGV4YW1wbGUub3JnJ30pO1xuXHQgKiAgICAgfTtcblx0ICpcblx0ICogICAgICRzY29wZS5yZW1vdmVDb250YWN0ID0gZnVuY3Rpb24oY29udGFjdFRvUmVtb3ZlKSB7XG5cdCAqICAgICAgIHZhciBpbmRleCA9ICRzY29wZS5jb250YWN0cy5pbmRleE9mKGNvbnRhY3RUb1JlbW92ZSk7XG5cdCAqICAgICAgICRzY29wZS5jb250YWN0cy5zcGxpY2UoaW5kZXgsIDEpO1xuXHQgKiAgICAgfTtcblx0ICpcblx0ICogICAgICRzY29wZS5jbGVhckNvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0KSB7XG5cdCAqICAgICAgIGNvbnRhY3QudHlwZSA9ICdwaG9uZSc7XG5cdCAqICAgICAgIGNvbnRhY3QudmFsdWUgPSAnJztcblx0ICogICAgIH07XG5cdCAqICAgfVxuXHQgKiAgPC9maWxlPlxuXHQgKiAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgKiAgICBpdCgnc2hvdWxkIGNoZWNrIGNvbnRyb2xsZXInLCBmdW5jdGlvbigpIHtcblx0ICogICAgICB2YXIgY29udGFpbmVyID0gZWxlbWVudChieS5pZCgnY3RybC1leG1wbCcpKTtcblx0ICpcblx0ICogICAgICBleHBlY3QoY29udGFpbmVyLmVsZW1lbnQoYnkubW9kZWwoJ25hbWUnKSlcblx0ICogICAgICAgICAgLmdldEF0dHJpYnV0ZSgndmFsdWUnKSkudG9CZSgnSm9obiBTbWl0aCcpO1xuXHQgKlxuXHQgKiAgICAgIHZhciBmaXJzdFJlcGVhdCA9XG5cdCAqICAgICAgICAgIGNvbnRhaW5lci5lbGVtZW50KGJ5LnJlcGVhdGVyKCdjb250YWN0IGluIGNvbnRhY3RzJykucm93KDApKTtcblx0ICogICAgICB2YXIgc2Vjb25kUmVwZWF0ID1cblx0ICogICAgICAgICAgY29udGFpbmVyLmVsZW1lbnQoYnkucmVwZWF0ZXIoJ2NvbnRhY3QgaW4gY29udGFjdHMnKS5yb3coMSkpO1xuXHQgKlxuXHQgKiAgICAgIGV4cGVjdChmaXJzdFJlcGVhdC5lbGVtZW50KGJ5Lm1vZGVsKCdjb250YWN0LnZhbHVlJykpLmdldEF0dHJpYnV0ZSgndmFsdWUnKSlcblx0ICogICAgICAgICAgLnRvQmUoJzQwOCA1NTUgMTIxMicpO1xuXHQgKiAgICAgIGV4cGVjdChzZWNvbmRSZXBlYXQuZWxlbWVudChieS5tb2RlbCgnY29udGFjdC52YWx1ZScpKS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpXG5cdCAqICAgICAgICAgIC50b0JlKCdqb2huLnNtaXRoQGV4YW1wbGUub3JnJyk7XG5cdCAqXG5cdCAqICAgICAgZmlyc3RSZXBlYXQuZWxlbWVudChieS5idXR0b25UZXh0KCdjbGVhcicpKS5jbGljaygpO1xuXHQgKlxuXHQgKiAgICAgIGV4cGVjdChmaXJzdFJlcGVhdC5lbGVtZW50KGJ5Lm1vZGVsKCdjb250YWN0LnZhbHVlJykpLmdldEF0dHJpYnV0ZSgndmFsdWUnKSlcblx0ICogICAgICAgICAgLnRvQmUoJycpO1xuXHQgKlxuXHQgKiAgICAgIGNvbnRhaW5lci5lbGVtZW50KGJ5LmJ1dHRvblRleHQoJ2FkZCcpKS5jbGljaygpO1xuXHQgKlxuXHQgKiAgICAgIGV4cGVjdChjb250YWluZXIuZWxlbWVudChieS5yZXBlYXRlcignY29udGFjdCBpbiBjb250YWN0cycpLnJvdygyKSlcblx0ICogICAgICAgICAgLmVsZW1lbnQoYnkubW9kZWwoJ2NvbnRhY3QudmFsdWUnKSlcblx0ICogICAgICAgICAgLmdldEF0dHJpYnV0ZSgndmFsdWUnKSlcblx0ICogICAgICAgICAgLnRvQmUoJ3lvdXJuYW1lQGV4YW1wbGUub3JnJyk7XG5cdCAqICAgIH0pO1xuXHQgKiAgPC9maWxlPlxuXHQgKjwvZXhhbXBsZT5cblx0XG5cdCAqL1xuXHR2YXIgbmdDb250cm9sbGVyRGlyZWN0aXZlID0gW2Z1bmN0aW9uKCkge1xuXHQgIHJldHVybiB7XG5cdCAgICByZXN0cmljdDogJ0EnLFxuXHQgICAgc2NvcGU6IHRydWUsXG5cdCAgICBjb250cm9sbGVyOiAnQCcsXG5cdCAgICBwcmlvcml0eTogNTAwXG5cdCAgfTtcblx0fV07XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ0NzcFxuXHQgKlxuXHQgKiBAZWxlbWVudCBodG1sXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKlxuXHQgKiBBbmd1bGFyIGhhcyBzb21lIGZlYXR1cmVzIHRoYXQgY2FuIGJyZWFrIGNlcnRhaW5cblx0ICogW0NTUCAoQ29udGVudCBTZWN1cml0eSBQb2xpY3kpXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9TZWN1cml0eS9DU1ApIHJ1bGVzLlxuXHQgKlxuXHQgKiBJZiB5b3UgaW50ZW5kIHRvIGltcGxlbWVudCB0aGVzZSBydWxlcyB0aGVuIHlvdSBtdXN0IHRlbGwgQW5ndWxhciBub3QgdG8gdXNlIHRoZXNlIGZlYXR1cmVzLlxuXHQgKlxuXHQgKiBUaGlzIGlzIG5lY2Vzc2FyeSB3aGVuIGRldmVsb3BpbmcgdGhpbmdzIGxpa2UgR29vZ2xlIENocm9tZSBFeHRlbnNpb25zIG9yIFVuaXZlcnNhbCBXaW5kb3dzIEFwcHMuXG5cdCAqXG5cdCAqXG5cdCAqIFRoZSBmb2xsb3dpbmcgcnVsZXMgYWZmZWN0IEFuZ3VsYXI6XG5cdCAqXG5cdCAqICogYHVuc2FmZS1ldmFsYDogdGhpcyBydWxlIGZvcmJpZHMgYXBwcyB0byB1c2UgYGV2YWxgIG9yIGBGdW5jdGlvbihzdHJpbmcpYCBnZW5lcmF0ZWQgZnVuY3Rpb25zXG5cdCAqIChhbW9uZyBvdGhlciB0aGluZ3MpLiBBbmd1bGFyIG1ha2VzIHVzZSBvZiB0aGlzIGluIHRoZSB7QGxpbmsgJHBhcnNlfSBzZXJ2aWNlIHRvIHByb3ZpZGUgYSAzMCVcblx0ICogaW5jcmVhc2UgaW4gdGhlIHNwZWVkIG9mIGV2YWx1YXRpbmcgQW5ndWxhciBleHByZXNzaW9ucy5cblx0ICpcblx0ICogKiBgdW5zYWZlLWlubGluZWA6IHRoaXMgcnVsZSBmb3JiaWRzIGFwcHMgZnJvbSBpbmplY3QgY3VzdG9tIHN0eWxlcyBpbnRvIHRoZSBkb2N1bWVudC4gQW5ndWxhclxuXHQgKiBtYWtlcyB1c2Ugb2YgdGhpcyB0byBpbmNsdWRlIHNvbWUgQ1NTIHJ1bGVzIChlLmcuIHtAbGluayBuZ0Nsb2FrfSBhbmQge0BsaW5rIG5nSGlkZX0pLlxuXHQgKiBUbyBtYWtlIHRoZXNlIGRpcmVjdGl2ZXMgd29yayB3aGVuIGEgQ1NQIHJ1bGUgaXMgYmxvY2tpbmcgaW5saW5lIHN0eWxlcywgeW91IG11c3QgbGluayB0byB0aGVcblx0ICogYGFuZ3VsYXItY3NwLmNzc2AgaW4geW91ciBIVE1MIG1hbnVhbGx5LlxuXHQgKlxuXHQgKiBJZiB5b3UgZG8gbm90IHByb3ZpZGUgYG5nQ3NwYCB0aGVuIEFuZ3VsYXIgdHJpZXMgdG8gYXV0b2RldGVjdCBpZiBDU1AgaXMgYmxvY2tpbmcgdW5zYWZlLWV2YWxcblx0ICogYW5kIGF1dG9tYXRpY2FsbHkgZGVhY3RpdmF0ZXMgdGhpcyBmZWF0dXJlIGluIHRoZSB7QGxpbmsgJHBhcnNlfSBzZXJ2aWNlLiBUaGlzIGF1dG9kZXRlY3Rpb24sXG5cdCAqIGhvd2V2ZXIsIHRyaWdnZXJzIGEgQ1NQIGVycm9yIHRvIGJlIGxvZ2dlZCBpbiB0aGUgY29uc29sZTpcblx0ICpcblx0ICogYGBgXG5cdCAqIFJlZnVzZWQgdG8gZXZhbHVhdGUgYSBzdHJpbmcgYXMgSmF2YVNjcmlwdCBiZWNhdXNlICd1bnNhZmUtZXZhbCcgaXMgbm90IGFuIGFsbG93ZWQgc291cmNlIG9mXG5cdCAqIHNjcmlwdCBpbiB0aGUgZm9sbG93aW5nIENvbnRlbnQgU2VjdXJpdHkgUG9saWN5IGRpcmVjdGl2ZTogXCJkZWZhdWx0LXNyYyAnc2VsZidcIi4gTm90ZSB0aGF0XG5cdCAqICdzY3JpcHQtc3JjJyB3YXMgbm90IGV4cGxpY2l0bHkgc2V0LCBzbyAnZGVmYXVsdC1zcmMnIGlzIHVzZWQgYXMgYSBmYWxsYmFjay5cblx0ICogYGBgXG5cdCAqXG5cdCAqIFRoaXMgZXJyb3IgaXMgaGFybWxlc3MgYnV0IGFubm95aW5nLiBUbyBwcmV2ZW50IHRoZSBlcnJvciBmcm9tIHNob3dpbmcgdXAsIHB1dCB0aGUgYG5nQ3NwYFxuXHQgKiBkaXJlY3RpdmUgb24gYW4gZWxlbWVudCBvZiB0aGUgSFRNTCBkb2N1bWVudCB0aGF0IGFwcGVhcnMgYmVmb3JlIHRoZSBgPHNjcmlwdD5gIHRhZyB0aGF0IGxvYWRzXG5cdCAqIHRoZSBgYW5ndWxhci5qc2AgZmlsZS5cblx0ICpcblx0ICogKk5vdGU6IFRoaXMgZGlyZWN0aXZlIGlzIG9ubHkgYXZhaWxhYmxlIGluIHRoZSBgbmctY3NwYCBhbmQgYGRhdGEtbmctY3NwYCBhdHRyaWJ1dGUgZm9ybS4qXG5cdCAqXG5cdCAqIFlvdSBjYW4gc3BlY2lmeSB3aGljaCBvZiB0aGUgQ1NQIHJlbGF0ZWQgQW5ndWxhciBmZWF0dXJlcyBzaG91bGQgYmUgZGVhY3RpdmF0ZWQgYnkgcHJvdmlkaW5nXG5cdCAqIGEgdmFsdWUgZm9yIHRoZSBgbmctY3NwYCBhdHRyaWJ1dGUuIFRoZSBvcHRpb25zIGFyZSBhcyBmb2xsb3dzOlxuXHQgKlxuXHQgKiAqIG5vLWlubGluZS1zdHlsZTogdGhpcyBzdG9wcyBBbmd1bGFyIGZyb20gaW5qZWN0aW5nIENTUyBzdHlsZXMgaW50byB0aGUgRE9NXG5cdCAqXG5cdCAqICogbm8tdW5zYWZlLWV2YWw6IHRoaXMgc3RvcHMgQW5ndWxhciBmcm9tIG9wdGltaXppbmcgJHBhcnNlIHdpdGggdW5zYWZlIGV2YWwgb2Ygc3RyaW5nc1xuXHQgKlxuXHQgKiBZb3UgY2FuIHVzZSB0aGVzZSB2YWx1ZXMgaW4gdGhlIGZvbGxvd2luZyBjb21iaW5hdGlvbnM6XG5cdCAqXG5cdCAqXG5cdCAqICogTm8gZGVjbGFyYXRpb24gbWVhbnMgdGhhdCBBbmd1bGFyIHdpbGwgYXNzdW1lIHRoYXQgeW91IGNhbiBkbyBpbmxpbmUgc3R5bGVzLCBidXQgaXQgd2lsbCBkb1xuXHQgKiBhIHJ1bnRpbWUgY2hlY2sgZm9yIHVuc2FmZS1ldmFsLiBFLmcuIGA8Ym9keT5gLiBUaGlzIGlzIGJhY2t3YXJkbHkgY29tcGF0aWJsZSB3aXRoIHByZXZpb3VzIHZlcnNpb25zXG5cdCAqIG9mIEFuZ3VsYXIuXG5cdCAqXG5cdCAqICogQSBzaW1wbGUgYG5nLWNzcGAgKG9yIGBkYXRhLW5nLWNzcGApIGF0dHJpYnV0ZSB3aWxsIHRlbGwgQW5ndWxhciB0byBkZWFjdGl2YXRlIGJvdGggaW5saW5lXG5cdCAqIHN0eWxlcyBhbmQgdW5zYWZlIGV2YWwuIEUuZy4gYDxib2R5IG5nLWNzcD5gLiBUaGlzIGlzIGJhY2t3YXJkbHkgY29tcGF0aWJsZSB3aXRoIHByZXZpb3VzIHZlcnNpb25zXG5cdCAqIG9mIEFuZ3VsYXIuXG5cdCAqXG5cdCAqICogU3BlY2lmeWluZyBvbmx5IGBuby11bnNhZmUtZXZhbGAgdGVsbHMgQW5ndWxhciB0aGF0IHdlIG11c3Qgbm90IHVzZSBldmFsLCBidXQgdGhhdCB3ZSBjYW4gaW5qZWN0XG5cdCAqIGlubGluZSBzdHlsZXMuIEUuZy4gYDxib2R5IG5nLWNzcD1cIm5vLXVuc2FmZS1ldmFsXCI+YC5cblx0ICpcblx0ICogKiBTcGVjaWZ5aW5nIG9ubHkgYG5vLWlubGluZS1zdHlsZWAgdGVsbHMgQW5ndWxhciB0aGF0IHdlIG11c3Qgbm90IGluamVjdCBzdHlsZXMsIGJ1dCB0aGF0IHdlIGNhblxuXHQgKiBydW4gZXZhbCAtIG5vIGF1dG9tYXRpYyBjaGVjayBmb3IgdW5zYWZlIGV2YWwgd2lsbCBvY2N1ci4gRS5nLiBgPGJvZHkgbmctY3NwPVwibm8taW5saW5lLXN0eWxlXCI+YFxuXHQgKlxuXHQgKiAqIFNwZWNpZnlpbmcgYm90aCBgbm8tdW5zYWZlLWV2YWxgIGFuZCBgbm8taW5saW5lLXN0eWxlYCB0ZWxscyBBbmd1bGFyIHRoYXQgd2UgbXVzdCBub3QgaW5qZWN0XG5cdCAqIHN0eWxlcyBub3IgdXNlIGV2YWwsIHdoaWNoIGlzIHRoZSBzYW1lIGFzIGFuIGVtcHR5OiBuZy1jc3AuXG5cdCAqIEUuZy5gPGJvZHkgbmctY3NwPVwibm8taW5saW5lLXN0eWxlO25vLXVuc2FmZS1ldmFsXCI+YFxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgKiBUaGlzIGV4YW1wbGUgc2hvd3MgaG93IHRvIGFwcGx5IHRoZSBgbmdDc3BgIGRpcmVjdGl2ZSB0byB0aGUgYGh0bWxgIHRhZy5cblx0ICAgYGBgaHRtbFxuXHQgICAgIDwhZG9jdHlwZSBodG1sPlxuXHQgICAgIDxodG1sIG5nLWFwcCBuZy1jc3A+XG5cdCAgICAgLi4uXG5cdCAgICAgLi4uXG5cdCAgICAgPC9odG1sPlxuXHQgICBgYGBcblx0ICAqIEBleGFtcGxlXG5cdCAgICAgIC8vIE5vdGU6IHRoZSBzdWZmaXggYC5jc3BgIGluIHRoZSBleGFtcGxlIG5hbWUgdHJpZ2dlcnNcblx0ICAgICAgLy8gY3NwIG1vZGUgaW4gb3VyIGh0dHAgc2VydmVyIVxuXHQgICAgICA8ZXhhbXBsZSBuYW1lPVwiZXhhbXBsZS5jc3BcIiBtb2R1bGU9XCJjc3BFeGFtcGxlXCIgbmctY3NwPVwidHJ1ZVwiPlxuXHQgICAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJNYWluQ29udHJvbGxlciBhcyBjdHJsXCI+XG5cdCAgICAgICAgICAgIDxkaXY+XG5cdCAgICAgICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cImN0cmwuaW5jKClcIiBpZD1cImluY1wiPkluY3JlbWVudDwvYnV0dG9uPlxuXHQgICAgICAgICAgICAgIDxzcGFuIGlkPVwiY291bnRlclwiPlxuXHQgICAgICAgICAgICAgICAge3tjdHJsLmNvdW50ZXJ9fVxuXHQgICAgICAgICAgICAgIDwvc3Bhbj5cblx0ICAgICAgICAgICAgPC9kaXY+XG5cdFxuXHQgICAgICAgICAgICA8ZGl2PlxuXHQgICAgICAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJjdHJsLmV2aWwoKVwiIGlkPVwiZXZpbFwiPkV2aWw8L2J1dHRvbj5cblx0ICAgICAgICAgICAgICA8c3BhbiBpZD1cImV2aWxFcnJvclwiPlxuXHQgICAgICAgICAgICAgICAge3tjdHJsLmV2aWxFcnJvcn19XG5cdCAgICAgICAgICAgICAgPC9zcGFuPlxuXHQgICAgICAgICAgICA8L2Rpdj5cblx0ICAgICAgICAgIDwvZGl2PlxuXHQgICAgICAgIDwvZmlsZT5cblx0ICAgICAgICA8ZmlsZSBuYW1lPVwic2NyaXB0LmpzXCI+XG5cdCAgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2NzcEV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAgICAgIC5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5jb3VudGVyID0gMDtcblx0ICAgICAgICAgICAgICAgIHRoaXMuaW5jID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgICAgICAgIHRoaXMuY291bnRlcisrO1xuXHQgICAgICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgICAgIHRoaXMuZXZpbCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICAgICAgICAvLyBqc2hpbnQgZXZpbDp0cnVlXG5cdCAgICAgICAgICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgICAgICAgICAgZXZhbCgnMSsyJyk7XG5cdCAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmV2aWxFcnJvciA9IGUubWVzc2FnZTtcblx0ICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICA8L2ZpbGU+XG5cdCAgICAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgICAgdmFyIHV0aWwsIHdlYmRyaXZlcjtcblx0XG5cdCAgICAgICAgICB2YXIgaW5jQnRuID0gZWxlbWVudChieS5pZCgnaW5jJykpO1xuXHQgICAgICAgICAgdmFyIGNvdW50ZXIgPSBlbGVtZW50KGJ5LmlkKCdjb3VudGVyJykpO1xuXHQgICAgICAgICAgdmFyIGV2aWxCdG4gPSBlbGVtZW50KGJ5LmlkKCdldmlsJykpO1xuXHQgICAgICAgICAgdmFyIGV2aWxFcnJvciA9IGVsZW1lbnQoYnkuaWQoJ2V2aWxFcnJvcicpKTtcblx0XG5cdCAgICAgICAgICBmdW5jdGlvbiBnZXRBbmRDbGVhclNldmVyZUVycm9ycygpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGJyb3dzZXIubWFuYWdlKCkubG9ncygpLmdldCgnYnJvd3NlcicpLnRoZW4oZnVuY3Rpb24oYnJvd3NlckxvZykge1xuXHQgICAgICAgICAgICAgIHJldHVybiBicm93c2VyTG9nLmZpbHRlcihmdW5jdGlvbihsb2dFbnRyeSkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIGxvZ0VudHJ5LmxldmVsLnZhbHVlID4gd2ViZHJpdmVyLmxvZ2dpbmcuTGV2ZWwuV0FSTklORy52YWx1ZTtcblx0ICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgZnVuY3Rpb24gY2xlYXJFcnJvcnMoKSB7XG5cdCAgICAgICAgICAgIGdldEFuZENsZWFyU2V2ZXJlRXJyb3JzKCk7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgZnVuY3Rpb24gZXhwZWN0Tm9FcnJvcnMoKSB7XG5cdCAgICAgICAgICAgIGdldEFuZENsZWFyU2V2ZXJlRXJyb3JzKCkudGhlbihmdW5jdGlvbihmaWx0ZXJlZExvZykge1xuXHQgICAgICAgICAgICAgIGV4cGVjdChmaWx0ZXJlZExvZy5sZW5ndGgpLnRvRXF1YWwoMCk7XG5cdCAgICAgICAgICAgICAgaWYgKGZpbHRlcmVkTG9nLmxlbmd0aCkge1xuXHQgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Jyb3dzZXIgY29uc29sZSBlcnJvcnM6ICcgKyB1dGlsLmluc3BlY3QoZmlsdGVyZWRMb2cpKTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIGZ1bmN0aW9uIGV4cGVjdEVycm9yKHJlZ2V4KSB7XG5cdCAgICAgICAgICAgIGdldEFuZENsZWFyU2V2ZXJlRXJyb3JzKCkudGhlbihmdW5jdGlvbihmaWx0ZXJlZExvZykge1xuXHQgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgIGZpbHRlcmVkTG9nLmZvckVhY2goZnVuY3Rpb24obG9nKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAobG9nLm1lc3NhZ2UubWF0Y2gocmVnZXgpKSB7XG5cdCAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICBpZiAoIWZvdW5kKSB7XG5cdCAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2V4cGVjdGVkIGFuIGVycm9yIHRoYXQgbWF0Y2hlcyAnICsgcmVnZXgpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgYmVmb3JlRWFjaChmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKTtcblx0ICAgICAgICAgICAgd2ViZHJpdmVyID0gcmVxdWlyZSgncHJvdHJhY3Rvci9ub2RlX21vZHVsZXMvc2VsZW5pdW0td2ViZHJpdmVyJyk7XG5cdCAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAvLyBGb3Igbm93LCB3ZSBvbmx5IHRlc3Qgb24gQ2hyb21lLFxuXHQgICAgICAgICAgLy8gYXMgU2FmYXJpIGRvZXMgbm90IGxvYWQgdGhlIHBhZ2Ugd2l0aCBQcm90cmFjdG9yJ3MgaW5qZWN0ZWQgc2NyaXB0cyxcblx0ICAgICAgICAgIC8vIGFuZCBGaXJlZm94IHdlYmRyaXZlciBhbHdheXMgZGlzYWJsZXMgY29udGVudCBzZWN1cml0eSBwb2xpY3kgKCM2MzU4KVxuXHQgICAgICAgICAgaWYgKGJyb3dzZXIucGFyYW1zLmJyb3dzZXIgIT09ICdjaHJvbWUnKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICBpdCgnc2hvdWxkIG5vdCByZXBvcnQgZXJyb3JzIHdoZW4gdGhlIHBhZ2UgaXMgbG9hZGVkJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIC8vIGNsZWFyIGVycm9ycyBzbyB3ZSBhcmUgbm90IGRlcGVuZGVudCBvbiBwcmV2aW91cyB0ZXN0c1xuXHQgICAgICAgICAgICBjbGVhckVycm9ycygpO1xuXHQgICAgICAgICAgICAvLyBOZWVkIHRvIHJlbG9hZCB0aGUgcGFnZSBhcyB0aGUgcGFnZSBpcyBhbHJlYWR5IGxvYWRlZCB3aGVuXG5cdCAgICAgICAgICAgIC8vIHdlIGNvbWUgaGVyZVxuXHQgICAgICAgICAgICBicm93c2VyLmRyaXZlci5nZXRDdXJyZW50VXJsKCkudGhlbihmdW5jdGlvbih1cmwpIHtcblx0ICAgICAgICAgICAgICBicm93c2VyLmdldCh1cmwpO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgZXhwZWN0Tm9FcnJvcnMoKTtcblx0ICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgIGl0KCdzaG91bGQgZXZhbHVhdGUgZXhwcmVzc2lvbnMnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgZXhwZWN0KGNvdW50ZXIuZ2V0VGV4dCgpKS50b0VxdWFsKCcwJyk7XG5cdCAgICAgICAgICAgIGluY0J0bi5jbGljaygpO1xuXHQgICAgICAgICAgICBleHBlY3QoY291bnRlci5nZXRUZXh0KCkpLnRvRXF1YWwoJzEnKTtcblx0ICAgICAgICAgICAgZXhwZWN0Tm9FcnJvcnMoKTtcblx0ICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgIGl0KCdzaG91bGQgdGhyb3cgYW5kIHJlcG9ydCBhbiBlcnJvciB3aGVuIHVzaW5nIFwiZXZhbFwiJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGV2aWxCdG4uY2xpY2soKTtcblx0ICAgICAgICAgICAgZXhwZWN0KGV2aWxFcnJvci5nZXRUZXh0KCkpLnRvTWF0Y2goL0NvbnRlbnQgU2VjdXJpdHkgUG9saWN5Lyk7XG5cdCAgICAgICAgICAgIGV4cGVjdEVycm9yKC9Db250ZW50IFNlY3VyaXR5IFBvbGljeS8pO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgPC9maWxlPlxuXHQgICAgICA8L2V4YW1wbGU+XG5cdCAgKi9cblx0XG5cdC8vIG5nQ3NwIGlzIG5vdCBpbXBsZW1lbnRlZCBhcyBhIHByb3BlciBkaXJlY3RpdmUgYW55IG1vcmUsIGJlY2F1c2Ugd2UgbmVlZCBpdCBiZSBwcm9jZXNzZWQgd2hpbGUgd2Vcblx0Ly8gYm9vdHN0cmFwIHRoZSBzeXN0ZW0gKGJlZm9yZSAkcGFyc2UgaXMgaW5zdGFudGlhdGVkKSwgZm9yIHRoaXMgcmVhc29uIHdlIGp1c3QgaGF2ZVxuXHQvLyB0aGUgY3NwKCkgZm4gdGhhdCBsb29rcyBmb3IgdGhlIGBuZy1jc3BgIGF0dHJpYnV0ZSBhbnl3aGVyZSBpbiB0aGUgY3VycmVudCBkb2Ncblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIG5nQ2xpY2tcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFRoZSBuZ0NsaWNrIGRpcmVjdGl2ZSBhbGxvd3MgeW91IHRvIHNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIHdoZW5cblx0ICogYW4gZWxlbWVudCBpcyBjbGlja2VkLlxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICogQHByaW9yaXR5IDBcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0NsaWNrIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWx1YXRlIHVwb25cblx0ICogY2xpY2suICh7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiMtZXZlbnQtIEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGB9KVxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuXHQgICAgICAgIEluY3JlbWVudFxuXHQgICAgICA8L2J1dHRvbj5cblx0ICAgICAgPHNwYW4+XG5cdCAgICAgICAgY291bnQ6IHt7Y291bnR9fVxuXHQgICAgICA8L3NwYW4+XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgIGl0KCdzaG91bGQgY2hlY2sgbmctY2xpY2snLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygnY291bnQnKSkuZ2V0VGV4dCgpKS50b01hdGNoKCcwJyk7XG5cdCAgICAgICAgIGVsZW1lbnQoYnkuY3NzKCdidXR0b24nKSkuY2xpY2soKTtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygnY291bnQnKSkuZ2V0VGV4dCgpKS50b01hdGNoKCcxJyk7XG5cdCAgICAgICB9KTtcblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICovXG5cdC8qXG5cdCAqIEEgY29sbGVjdGlvbiBvZiBkaXJlY3RpdmVzIHRoYXQgYWxsb3dzIGNyZWF0aW9uIG9mIGN1c3RvbSBldmVudCBoYW5kbGVycyB0aGF0IGFyZSBkZWZpbmVkIGFzXG5cdCAqIGFuZ3VsYXIgZXhwcmVzc2lvbnMgYW5kIGFyZSBjb21waWxlZCBhbmQgZXhlY3V0ZWQgd2l0aGluIHRoZSBjdXJyZW50IHNjb3BlLlxuXHQgKi9cblx0dmFyIG5nRXZlbnREaXJlY3RpdmVzID0ge307XG5cdFxuXHQvLyBGb3IgZXZlbnRzIHRoYXQgbWlnaHQgZmlyZSBzeW5jaHJvbm91c2x5IGR1cmluZyBET00gbWFuaXB1bGF0aW9uXG5cdC8vIHdlIG5lZWQgdG8gZXhlY3V0ZSB0aGVpciBldmVudCBoYW5kbGVycyBhc3luY2hyb25vdXNseSB1c2luZyAkZXZhbEFzeW5jLFxuXHQvLyBzbyB0aGF0IHRoZXkgYXJlIG5vdCBleGVjdXRlZCBpbiBhbiBpbmNvbnNpc3RlbnQgc3RhdGUuXG5cdHZhciBmb3JjZUFzeW5jRXZlbnRzID0ge1xuXHQgICdibHVyJzogdHJ1ZSxcblx0ICAnZm9jdXMnOiB0cnVlXG5cdH07XG5cdGZvckVhY2goXG5cdCAgJ2NsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZW1vdmUgbW91c2VlbnRlciBtb3VzZWxlYXZlIGtleWRvd24ga2V5dXAga2V5cHJlc3Mgc3VibWl0IGZvY3VzIGJsdXIgY29weSBjdXQgcGFzdGUnLnNwbGl0KCcgJyksXG5cdCAgZnVuY3Rpb24oZXZlbnROYW1lKSB7XG5cdCAgICB2YXIgZGlyZWN0aXZlTmFtZSA9IGRpcmVjdGl2ZU5vcm1hbGl6ZSgnbmctJyArIGV2ZW50TmFtZSk7XG5cdCAgICBuZ0V2ZW50RGlyZWN0aXZlc1tkaXJlY3RpdmVOYW1lXSA9IFsnJHBhcnNlJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkcGFyc2UsICRyb290U2NvcGUpIHtcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICByZXN0cmljdDogJ0EnLFxuXHQgICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uKCRlbGVtZW50LCBhdHRyKSB7XG5cdCAgICAgICAgICAvLyBXZSBleHBvc2UgdGhlIHBvd2VyZnVsICRldmVudCBvYmplY3Qgb24gdGhlIHNjb3BlIHRoYXQgcHJvdmlkZXMgYWNjZXNzIHRvIHRoZSBXaW5kb3csXG5cdCAgICAgICAgICAvLyBldGMuIHRoYXQgaXNuJ3QgcHJvdGVjdGVkIGJ5IHRoZSBmYXN0IHBhdGhzIGluICRwYXJzZS4gIFdlIGV4cGxpY2l0bHkgcmVxdWVzdCBiZXR0ZXJcblx0ICAgICAgICAgIC8vIGNoZWNrcyBhdCB0aGUgY29zdCBvZiBzcGVlZCBzaW5jZSBldmVudCBoYW5kbGVyIGV4cHJlc3Npb25zIGFyZSBub3QgZXhlY3V0ZWQgYXNcblx0ICAgICAgICAgIC8vIGZyZXF1ZW50bHkgYXMgcmVndWxhciBjaGFuZ2UgZGV0ZWN0aW9uLlxuXHQgICAgICAgICAgdmFyIGZuID0gJHBhcnNlKGF0dHJbZGlyZWN0aXZlTmFtZV0sIC8qIGludGVyY2VwdG9yRm4gKi8gbnVsbCwgLyogZXhwZW5zaXZlQ2hlY2tzICovIHRydWUpO1xuXHQgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5nRXZlbnRIYW5kbGVyKHNjb3BlLCBlbGVtZW50KSB7XG5cdCAgICAgICAgICAgIGVsZW1lbnQub24oZXZlbnROYW1lLCBmdW5jdGlvbihldmVudCkge1xuXHQgICAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICAgICAgZm4oc2NvcGUsIHskZXZlbnQ6ZXZlbnR9KTtcblx0ICAgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICAgIGlmIChmb3JjZUFzeW5jRXZlbnRzW2V2ZW50TmFtZV0gJiYgJHJvb3RTY29wZS4kJHBoYXNlKSB7XG5cdCAgICAgICAgICAgICAgICBzY29wZS4kZXZhbEFzeW5jKGNhbGxiYWNrKTtcblx0ICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGNhbGxiYWNrKTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgICB9XTtcblx0ICB9XG5cdCk7XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ0RibGNsaWNrXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUaGUgYG5nRGJsY2xpY2tgIGRpcmVjdGl2ZSBhbGxvd3MgeW91IHRvIHNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIG9uIGEgZGJsY2xpY2sgZXZlbnQuXG5cdCAqXG5cdCAqIEBlbGVtZW50IEFOWVxuXHQgKiBAcHJpb3JpdHkgMFxuXHQgKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nRGJsY2xpY2sge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvblxuXHQgKiBhIGRibGNsaWNrLiAoVGhlIEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGApXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgIDxidXR0b24gbmctZGJsY2xpY2s9XCJjb3VudCA9IGNvdW50ICsgMVwiIG5nLWluaXQ9XCJjb3VudD0wXCI+XG5cdCAgICAgICAgSW5jcmVtZW50IChvbiBkb3VibGUgY2xpY2spXG5cdCAgICAgIDwvYnV0dG9uPlxuXHQgICAgICBjb3VudDoge3tjb3VudH19XG5cdCAgICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCAqL1xuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIG5nTW91c2Vkb3duXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUaGUgbmdNb3VzZWRvd24gZGlyZWN0aXZlIGFsbG93cyB5b3UgdG8gc3BlY2lmeSBjdXN0b20gYmVoYXZpb3Igb24gbW91c2Vkb3duIGV2ZW50LlxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICogQHByaW9yaXR5IDBcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ01vdXNlZG93biB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG5cdCAqIG1vdXNlZG93bi4gKHtAbGluayBndWlkZS9leHByZXNzaW9uIy1ldmVudC0gRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YH0pXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgIDxidXR0b24gbmctbW91c2Vkb3duPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuXHQgICAgICAgIEluY3JlbWVudCAob24gbW91c2UgZG93bilcblx0ICAgICAgPC9idXR0b24+XG5cdCAgICAgIGNvdW50OiB7e2NvdW50fX1cblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICovXG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdNb3VzZXVwXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBtb3VzZXVwIGV2ZW50LlxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICogQHByaW9yaXR5IDBcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ01vdXNldXAge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvblxuXHQgKiBtb3VzZXVwLiAoe0BsaW5rIGd1aWRlL2V4cHJlc3Npb24jLWV2ZW50LSBFdmVudCBvYmplY3QgaXMgYXZhaWxhYmxlIGFzIGAkZXZlbnRgfSlcblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICAgPGV4YW1wbGU+XG5cdCAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgPGJ1dHRvbiBuZy1tb3VzZXVwPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuXHQgICAgICAgIEluY3JlbWVudCAob24gbW91c2UgdXApXG5cdCAgICAgIDwvYnV0dG9uPlxuXHQgICAgICBjb3VudDoge3tjb3VudH19XG5cdCAgICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCAqL1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdNb3VzZW92ZXJcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIG9uIG1vdXNlb3ZlciBldmVudC5cblx0ICpcblx0ICogQGVsZW1lbnQgQU5ZXG5cdCAqIEBwcmlvcml0eSAwXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdNb3VzZW92ZXIge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvblxuXHQgKiBtb3VzZW92ZXIuICh7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiMtZXZlbnQtIEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGB9KVxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICA8YnV0dG9uIG5nLW1vdXNlb3Zlcj1cImNvdW50ID0gY291bnQgKyAxXCIgbmctaW5pdD1cImNvdW50PTBcIj5cblx0ICAgICAgICBJbmNyZW1lbnQgKHdoZW4gbW91c2UgaXMgb3Zlcilcblx0ICAgICAgPC9idXR0b24+XG5cdCAgICAgIGNvdW50OiB7e2NvdW50fX1cblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICovXG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdNb3VzZWVudGVyXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBtb3VzZWVudGVyIGV2ZW50LlxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICogQHByaW9yaXR5IDBcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ01vdXNlZW50ZXIge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvblxuXHQgKiBtb3VzZWVudGVyLiAoe0BsaW5rIGd1aWRlL2V4cHJlc3Npb24jLWV2ZW50LSBFdmVudCBvYmplY3QgaXMgYXZhaWxhYmxlIGFzIGAkZXZlbnRgfSlcblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICAgPGV4YW1wbGU+XG5cdCAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgPGJ1dHRvbiBuZy1tb3VzZWVudGVyPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuXHQgICAgICAgIEluY3JlbWVudCAod2hlbiBtb3VzZSBlbnRlcnMpXG5cdCAgICAgIDwvYnV0dG9uPlxuXHQgICAgICBjb3VudDoge3tjb3VudH19XG5cdCAgICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCAqL1xuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIG5nTW91c2VsZWF2ZVxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogU3BlY2lmeSBjdXN0b20gYmVoYXZpb3Igb24gbW91c2VsZWF2ZSBldmVudC5cblx0ICpcblx0ICogQGVsZW1lbnQgQU5ZXG5cdCAqIEBwcmlvcml0eSAwXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdNb3VzZWxlYXZlIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWx1YXRlIHVwb25cblx0ICogbW91c2VsZWF2ZS4gKHtAbGluayBndWlkZS9leHByZXNzaW9uIy1ldmVudC0gRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YH0pXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgIDxidXR0b24gbmctbW91c2VsZWF2ZT1cImNvdW50ID0gY291bnQgKyAxXCIgbmctaW5pdD1cImNvdW50PTBcIj5cblx0ICAgICAgICBJbmNyZW1lbnQgKHdoZW4gbW91c2UgbGVhdmVzKVxuXHQgICAgICA8L2J1dHRvbj5cblx0ICAgICAgY291bnQ6IHt7Y291bnR9fVxuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKi9cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ01vdXNlbW92ZVxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogU3BlY2lmeSBjdXN0b20gYmVoYXZpb3Igb24gbW91c2Vtb3ZlIGV2ZW50LlxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICogQHByaW9yaXR5IDBcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ01vdXNlbW92ZSB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG5cdCAqIG1vdXNlbW92ZS4gKHtAbGluayBndWlkZS9leHByZXNzaW9uIy1ldmVudC0gRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YH0pXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgIDxidXR0b24gbmctbW91c2Vtb3ZlPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuXHQgICAgICAgIEluY3JlbWVudCAod2hlbiBtb3VzZSBtb3Zlcylcblx0ICAgICAgPC9idXR0b24+XG5cdCAgICAgIGNvdW50OiB7e2NvdW50fX1cblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICovXG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdLZXlkb3duXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBrZXlkb3duIGV2ZW50LlxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICogQHByaW9yaXR5IDBcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0tleWRvd24ge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvblxuXHQgKiBrZXlkb3duLiAoRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YCBhbmQgY2FuIGJlIGludGVycm9nYXRlZCBmb3Iga2V5Q29kZSwgYWx0S2V5LCBldGMuKVxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICA8aW5wdXQgbmcta2V5ZG93bj1cImNvdW50ID0gY291bnQgKyAxXCIgbmctaW5pdD1cImNvdW50PTBcIj5cblx0ICAgICAga2V5IGRvd24gY291bnQ6IHt7Y291bnR9fVxuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKi9cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ0tleXVwXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBrZXl1cCBldmVudC5cblx0ICpcblx0ICogQGVsZW1lbnQgQU5ZXG5cdCAqIEBwcmlvcml0eSAwXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdLZXl1cCB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG5cdCAqIGtleXVwLiAoRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YCBhbmQgY2FuIGJlIGludGVycm9nYXRlZCBmb3Iga2V5Q29kZSwgYWx0S2V5LCBldGMuKVxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICAgPHA+VHlwaW5nIGluIHRoZSBpbnB1dCBib3ggYmVsb3cgdXBkYXRlcyB0aGUga2V5IGNvdW50PC9wPlxuXHQgICAgICAgPGlucHV0IG5nLWtleXVwPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPiBrZXkgdXAgY291bnQ6IHt7Y291bnR9fVxuXHRcblx0ICAgICAgIDxwPlR5cGluZyBpbiB0aGUgaW5wdXQgYm94IGJlbG93IHVwZGF0ZXMgdGhlIGtleWNvZGU8L3A+XG5cdCAgICAgICA8aW5wdXQgbmcta2V5dXA9XCJldmVudD0kZXZlbnRcIj5cblx0ICAgICAgIDxwPmV2ZW50IGtleUNvZGU6IHt7IGV2ZW50LmtleUNvZGUgfX08L3A+XG5cdCAgICAgICA8cD5ldmVudCBhbHRLZXk6IHt7IGV2ZW50LmFsdEtleSB9fTwvcD5cblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICovXG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdLZXlwcmVzc1xuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogU3BlY2lmeSBjdXN0b20gYmVoYXZpb3Igb24ga2V5cHJlc3MgZXZlbnQuXG5cdCAqXG5cdCAqIEBlbGVtZW50IEFOWVxuXHQgKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nS2V5cHJlc3Mge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvblxuXHQgKiBrZXlwcmVzcy4gKHtAbGluayBndWlkZS9leHByZXNzaW9uIy1ldmVudC0gRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YH1cblx0ICogYW5kIGNhbiBiZSBpbnRlcnJvZ2F0ZWQgZm9yIGtleUNvZGUsIGFsdEtleSwgZXRjLilcblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICAgPGV4YW1wbGU+XG5cdCAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgPGlucHV0IG5nLWtleXByZXNzPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuXHQgICAgICBrZXkgcHJlc3MgY291bnQ6IHt7Y291bnR9fVxuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKi9cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ1N1Ym1pdFxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogRW5hYmxlcyBiaW5kaW5nIGFuZ3VsYXIgZXhwcmVzc2lvbnMgdG8gb25zdWJtaXQgZXZlbnRzLlxuXHQgKlxuXHQgKiBBZGRpdGlvbmFsbHkgaXQgcHJldmVudHMgdGhlIGRlZmF1bHQgYWN0aW9uICh3aGljaCBmb3IgZm9ybSBtZWFucyBzZW5kaW5nIHRoZSByZXF1ZXN0IHRvIHRoZVxuXHQgKiBzZXJ2ZXIgYW5kIHJlbG9hZGluZyB0aGUgY3VycmVudCBwYWdlKSwgYnV0IG9ubHkgaWYgdGhlIGZvcm0gZG9lcyBub3QgY29udGFpbiBgYWN0aW9uYCxcblx0ICogYGRhdGEtYWN0aW9uYCwgb3IgYHgtYWN0aW9uYCBhdHRyaWJ1dGVzLlxuXHQgKlxuXHQgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuXHQgKiAqKldhcm5pbmc6KiogQmUgY2FyZWZ1bCBub3QgdG8gY2F1c2UgXCJkb3VibGUtc3VibWlzc2lvblwiIGJ5IHVzaW5nIGJvdGggdGhlIGBuZ0NsaWNrYCBhbmRcblx0ICogYG5nU3VibWl0YCBoYW5kbGVycyB0b2dldGhlci4gU2VlIHRoZVxuXHQgKiB7QGxpbmsgZm9ybSNzdWJtaXR0aW5nLWEtZm9ybS1hbmQtcHJldmVudGluZy10aGUtZGVmYXVsdC1hY3Rpb24gYGZvcm1gIGRpcmVjdGl2ZSBkb2N1bWVudGF0aW9ufVxuXHQgKiBmb3IgYSBkZXRhaWxlZCBkaXNjdXNzaW9uIG9mIHdoZW4gYG5nU3VibWl0YCBtYXkgYmUgdHJpZ2dlcmVkLlxuXHQgKiA8L2Rpdj5cblx0ICpcblx0ICogQGVsZW1lbnQgZm9ybVxuXHQgKiBAcHJpb3JpdHkgMFxuXHQgKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nU3VibWl0IHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWwuXG5cdCAqICh7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiMtZXZlbnQtIEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGB9KVxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZSBtb2R1bGU9XCJzdWJtaXRFeGFtcGxlXCI+XG5cdCAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgPHNjcmlwdD5cblx0ICAgICAgICBhbmd1bGFyLm1vZHVsZSgnc3VibWl0RXhhbXBsZScsIFtdKVxuXHQgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICAgJHNjb3BlLmxpc3QgPSBbXTtcblx0ICAgICAgICAgICAgJHNjb3BlLnRleHQgPSAnaGVsbG8nO1xuXHQgICAgICAgICAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgICAgaWYgKCRzY29wZS50ZXh0KSB7XG5cdCAgICAgICAgICAgICAgICAkc2NvcGUubGlzdC5wdXNoKHRoaXMudGV4dCk7XG5cdCAgICAgICAgICAgICAgICAkc2NvcGUudGV4dCA9ICcnO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfTtcblx0ICAgICAgICAgIH1dKTtcblx0ICAgICAgPC9zY3JpcHQ+XG5cdCAgICAgIDxmb3JtIG5nLXN1Ym1pdD1cInN1Ym1pdCgpXCIgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAgICAgICAgRW50ZXIgdGV4dCBhbmQgaGl0IGVudGVyOlxuXHQgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwidGV4dFwiIG5hbWU9XCJ0ZXh0XCIgLz5cblx0ICAgICAgICA8aW5wdXQgdHlwZT1cInN1Ym1pdFwiIGlkPVwic3VibWl0XCIgdmFsdWU9XCJTdWJtaXRcIiAvPlxuXHQgICAgICAgIDxwcmU+bGlzdD17e2xpc3R9fTwvcHJlPlxuXHQgICAgICA8L2Zvcm0+XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgIGl0KCdzaG91bGQgY2hlY2sgbmctc3VibWl0JywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ2xpc3QnKSkuZ2V0VGV4dCgpKS50b0JlKCdsaXN0PVtdJyk7XG5cdCAgICAgICAgIGVsZW1lbnQoYnkuY3NzKCcjc3VibWl0JykpLmNsaWNrKCk7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ2xpc3QnKSkuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2hlbGxvJyk7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5Lm1vZGVsKCd0ZXh0JykpLmdldEF0dHJpYnV0ZSgndmFsdWUnKSkudG9CZSgnJyk7XG5cdCAgICAgICB9KTtcblx0ICAgICAgIGl0KCdzaG91bGQgaWdub3JlIGVtcHR5IHN0cmluZ3MnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygnbGlzdCcpKS5nZXRUZXh0KCkpLnRvQmUoJ2xpc3Q9W10nKTtcblx0ICAgICAgICAgZWxlbWVudChieS5jc3MoJyNzdWJtaXQnKSkuY2xpY2soKTtcblx0ICAgICAgICAgZWxlbWVudChieS5jc3MoJyNzdWJtaXQnKSkuY2xpY2soKTtcblx0ICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygnbGlzdCcpKS5nZXRUZXh0KCkpLnRvQ29udGFpbignaGVsbG8nKTtcblx0ICAgICAgICB9KTtcblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICovXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ0ZvY3VzXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBmb2N1cyBldmVudC5cblx0ICpcblx0ICogTm90ZTogQXMgdGhlIGBmb2N1c2AgZXZlbnQgaXMgZXhlY3V0ZWQgc3luY2hyb25vdXNseSB3aGVuIGNhbGxpbmcgYGlucHV0LmZvY3VzKClgXG5cdCAqIEFuZ3VsYXJKUyBleGVjdXRlcyB0aGUgZXhwcmVzc2lvbiB1c2luZyBgc2NvcGUuJGV2YWxBc3luY2AgaWYgdGhlIGV2ZW50IGlzIGZpcmVkXG5cdCAqIGR1cmluZyBhbiBgJGFwcGx5YCB0byBlbnN1cmUgYSBjb25zaXN0ZW50IHN0YXRlLlxuXHQgKlxuXHQgKiBAZWxlbWVudCB3aW5kb3csIGlucHV0LCBzZWxlY3QsIHRleHRhcmVhLCBhXG5cdCAqIEBwcmlvcml0eSAwXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdGb2N1cyB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG5cdCAqIGZvY3VzLiAoe0BsaW5rIGd1aWRlL2V4cHJlc3Npb24jLWV2ZW50LSBFdmVudCBvYmplY3QgaXMgYXZhaWxhYmxlIGFzIGAkZXZlbnRgfSlcblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICogU2VlIHtAbGluayBuZy5kaXJlY3RpdmU6bmdDbGljayBuZ0NsaWNrfVxuXHQgKi9cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIG5nQmx1clxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogU3BlY2lmeSBjdXN0b20gYmVoYXZpb3Igb24gYmx1ciBldmVudC5cblx0ICpcblx0ICogQSBbYmx1ciBldmVudF0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvRXZlbnRzL2JsdXIpIGZpcmVzIHdoZW5cblx0ICogYW4gZWxlbWVudCBoYXMgbG9zdCBmb2N1cy5cblx0ICpcblx0ICogTm90ZTogQXMgdGhlIGBibHVyYCBldmVudCBpcyBleGVjdXRlZCBzeW5jaHJvbm91c2x5IGFsc28gZHVyaW5nIERPTSBtYW5pcHVsYXRpb25zXG5cdCAqIChlLmcuIHJlbW92aW5nIGEgZm9jdXNzZWQgaW5wdXQpLFxuXHQgKiBBbmd1bGFySlMgZXhlY3V0ZXMgdGhlIGV4cHJlc3Npb24gdXNpbmcgYHNjb3BlLiRldmFsQXN5bmNgIGlmIHRoZSBldmVudCBpcyBmaXJlZFxuXHQgKiBkdXJpbmcgYW4gYCRhcHBseWAgdG8gZW5zdXJlIGEgY29uc2lzdGVudCBzdGF0ZS5cblx0ICpcblx0ICogQGVsZW1lbnQgd2luZG93LCBpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSwgYVxuXHQgKiBAcHJpb3JpdHkgMFxuXHQgKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nQmx1ciB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG5cdCAqIGJsdXIuICh7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiMtZXZlbnQtIEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGB9KVxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgKiBTZWUge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0NsaWNrIG5nQ2xpY2t9XG5cdCAqL1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdDb3B5XG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBjb3B5IGV2ZW50LlxuXHQgKlxuXHQgKiBAZWxlbWVudCB3aW5kb3csIGlucHV0LCBzZWxlY3QsIHRleHRhcmVhLCBhXG5cdCAqIEBwcmlvcml0eSAwXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdDb3B5IHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWx1YXRlIHVwb25cblx0ICogY29weS4gKHtAbGluayBndWlkZS9leHByZXNzaW9uIy1ldmVudC0gRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YH0pXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgIDxpbnB1dCBuZy1jb3B5PVwiY29waWVkPXRydWVcIiBuZy1pbml0PVwiY29waWVkPWZhbHNlOyB2YWx1ZT0nY29weSBtZSdcIiBuZy1tb2RlbD1cInZhbHVlXCI+XG5cdCAgICAgIGNvcGllZDoge3tjb3BpZWR9fVxuXHQgICAgIDwvZmlsZT5cblx0ICAgPC9leGFtcGxlPlxuXHQgKi9cblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZGlyZWN0aXZlXG5cdCAqIEBuYW1lIG5nQ3V0XG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBjdXQgZXZlbnQuXG5cdCAqXG5cdCAqIEBlbGVtZW50IHdpbmRvdywgaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEsIGFcblx0ICogQHByaW9yaXR5IDBcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0N1dCB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG5cdCAqIGN1dC4gKHtAbGluayBndWlkZS9leHByZXNzaW9uIy1ldmVudC0gRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YH0pXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgIDxpbnB1dCBuZy1jdXQ9XCJjdXQ9dHJ1ZVwiIG5nLWluaXQ9XCJjdXQ9ZmFsc2U7IHZhbHVlPSdjdXQgbWUnXCIgbmctbW9kZWw9XCJ2YWx1ZVwiPlxuXHQgICAgICBjdXQ6IHt7Y3V0fX1cblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICovXG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ1Bhc3RlXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBwYXN0ZSBldmVudC5cblx0ICpcblx0ICogQGVsZW1lbnQgd2luZG93LCBpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSwgYVxuXHQgKiBAcHJpb3JpdHkgMFxuXHQgKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nUGFzdGUge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvblxuXHQgKiBwYXN0ZS4gKHtAbGluayBndWlkZS9leHByZXNzaW9uIy1ldmVudC0gRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YH0pXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgIDxpbnB1dCBuZy1wYXN0ZT1cInBhc3RlPXRydWVcIiBuZy1pbml0PVwicGFzdGU9ZmFsc2VcIiBwbGFjZWhvbGRlcj0ncGFzdGUgaGVyZSc+XG5cdCAgICAgIHBhc3RlZDoge3twYXN0ZX19XG5cdCAgICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCAqL1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdJZlxuXHQgKiBAcmVzdHJpY3QgQVxuXHQgKiBAbXVsdGlFbGVtZW50XG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUaGUgYG5nSWZgIGRpcmVjdGl2ZSByZW1vdmVzIG9yIHJlY3JlYXRlcyBhIHBvcnRpb24gb2YgdGhlIERPTSB0cmVlIGJhc2VkIG9uIGFuXG5cdCAqIHtleHByZXNzaW9ufS4gSWYgdGhlIGV4cHJlc3Npb24gYXNzaWduZWQgdG8gYG5nSWZgIGV2YWx1YXRlcyB0byBhIGZhbHNlXG5cdCAqIHZhbHVlIHRoZW4gdGhlIGVsZW1lbnQgaXMgcmVtb3ZlZCBmcm9tIHRoZSBET00sIG90aGVyd2lzZSBhIGNsb25lIG9mIHRoZVxuXHQgKiBlbGVtZW50IGlzIHJlaW5zZXJ0ZWQgaW50byB0aGUgRE9NLlxuXHQgKlxuXHQgKiBgbmdJZmAgZGlmZmVycyBmcm9tIGBuZ1Nob3dgIGFuZCBgbmdIaWRlYCBpbiB0aGF0IGBuZ0lmYCBjb21wbGV0ZWx5IHJlbW92ZXMgYW5kIHJlY3JlYXRlcyB0aGVcblx0ICogZWxlbWVudCBpbiB0aGUgRE9NIHJhdGhlciB0aGFuIGNoYW5naW5nIGl0cyB2aXNpYmlsaXR5IHZpYSB0aGUgYGRpc3BsYXlgIGNzcyBwcm9wZXJ0eS4gIEEgY29tbW9uXG5cdCAqIGNhc2Ugd2hlbiB0aGlzIGRpZmZlcmVuY2UgaXMgc2lnbmlmaWNhbnQgaXMgd2hlbiB1c2luZyBjc3Mgc2VsZWN0b3JzIHRoYXQgcmVseSBvbiBhbiBlbGVtZW50J3Ncblx0ICogcG9zaXRpb24gd2l0aGluIHRoZSBET00sIHN1Y2ggYXMgdGhlIGA6Zmlyc3QtY2hpbGRgIG9yIGA6bGFzdC1jaGlsZGAgcHNldWRvLWNsYXNzZXMuXG5cdCAqXG5cdCAqIE5vdGUgdGhhdCB3aGVuIGFuIGVsZW1lbnQgaXMgcmVtb3ZlZCB1c2luZyBgbmdJZmAgaXRzIHNjb3BlIGlzIGRlc3Ryb3llZCBhbmQgYSBuZXcgc2NvcGVcblx0ICogaXMgY3JlYXRlZCB3aGVuIHRoZSBlbGVtZW50IGlzIHJlc3RvcmVkLiAgVGhlIHNjb3BlIGNyZWF0ZWQgd2l0aGluIGBuZ0lmYCBpbmhlcml0cyBmcm9tXG5cdCAqIGl0cyBwYXJlbnQgc2NvcGUgdXNpbmdcblx0ICogW3Byb3RvdHlwYWwgaW5oZXJpdGFuY2VdKGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL2FuZ3VsYXIuanMvd2lraS9VbmRlcnN0YW5kaW5nLVNjb3BlcyNqYXZhc2NyaXB0LXByb3RvdHlwYWwtaW5oZXJpdGFuY2UpLlxuXHQgKiBBbiBpbXBvcnRhbnQgaW1wbGljYXRpb24gb2YgdGhpcyBpcyBpZiBgbmdNb2RlbGAgaXMgdXNlZCB3aXRoaW4gYG5nSWZgIHRvIGJpbmQgdG9cblx0ICogYSBqYXZhc2NyaXB0IHByaW1pdGl2ZSBkZWZpbmVkIGluIHRoZSBwYXJlbnQgc2NvcGUuIEluIHRoaXMgY2FzZSBhbnkgbW9kaWZpY2F0aW9ucyBtYWRlIHRvIHRoZVxuXHQgKiB2YXJpYWJsZSB3aXRoaW4gdGhlIGNoaWxkIHNjb3BlIHdpbGwgb3ZlcnJpZGUgKGhpZGUpIHRoZSB2YWx1ZSBpbiB0aGUgcGFyZW50IHNjb3BlLlxuXHQgKlxuXHQgKiBBbHNvLCBgbmdJZmAgcmVjcmVhdGVzIGVsZW1lbnRzIHVzaW5nIHRoZWlyIGNvbXBpbGVkIHN0YXRlLiBBbiBleGFtcGxlIG9mIHRoaXMgYmVoYXZpb3Jcblx0ICogaXMgaWYgYW4gZWxlbWVudCdzIGNsYXNzIGF0dHJpYnV0ZSBpcyBkaXJlY3RseSBtb2RpZmllZCBhZnRlciBpdCdzIGNvbXBpbGVkLCB1c2luZyBzb21ldGhpbmcgbGlrZVxuXHQgKiBqUXVlcnkncyBgLmFkZENsYXNzKClgIG1ldGhvZCwgYW5kIHRoZSBlbGVtZW50IGlzIGxhdGVyIHJlbW92ZWQuIFdoZW4gYG5nSWZgIHJlY3JlYXRlcyB0aGUgZWxlbWVudFxuXHQgKiB0aGUgYWRkZWQgY2xhc3Mgd2lsbCBiZSBsb3N0IGJlY2F1c2UgdGhlIG9yaWdpbmFsIGNvbXBpbGVkIHN0YXRlIGlzIHVzZWQgdG8gcmVnZW5lcmF0ZSB0aGUgZWxlbWVudC5cblx0ICpcblx0ICogQWRkaXRpb25hbGx5LCB5b3UgY2FuIHByb3ZpZGUgYW5pbWF0aW9ucyB2aWEgdGhlIGBuZ0FuaW1hdGVgIG1vZHVsZSB0byBhbmltYXRlIHRoZSBgZW50ZXJgXG5cdCAqIGFuZCBgbGVhdmVgIGVmZmVjdHMuXG5cdCAqXG5cdCAqIEBhbmltYXRpb25zXG5cdCAqIGVudGVyIC0gaGFwcGVucyBqdXN0IGFmdGVyIHRoZSBgbmdJZmAgY29udGVudHMgY2hhbmdlIGFuZCBhIG5ldyBET00gZWxlbWVudCBpcyBjcmVhdGVkIGFuZCBpbmplY3RlZCBpbnRvIHRoZSBgbmdJZmAgY29udGFpbmVyXG5cdCAqIGxlYXZlIC0gaGFwcGVucyBqdXN0IGJlZm9yZSB0aGUgYG5nSWZgIGNvbnRlbnRzIGFyZSByZW1vdmVkIGZyb20gdGhlIERPTVxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICogQHNjb3BlXG5cdCAqIEBwcmlvcml0eSA2MDBcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0lmIElmIHRoZSB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufSBpcyBmYWxzeSB0aGVuXG5cdCAqICAgICB0aGUgZWxlbWVudCBpcyByZW1vdmVkIGZyb20gdGhlIERPTSB0cmVlLiBJZiBpdCBpcyB0cnV0aHkgYSBjb3B5IG9mIHRoZSBjb21waWxlZFxuXHQgKiAgICAgZWxlbWVudCBpcyBhZGRlZCB0byB0aGUgRE9NIHRyZWUuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgPGV4YW1wbGUgbW9kdWxlPVwibmdBbmltYXRlXCIgZGVwcz1cImFuZ3VsYXItYW5pbWF0ZS5qc1wiIGFuaW1hdGlvbnM9XCJ0cnVlXCI+XG5cdCAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICA8bGFiZWw+Q2xpY2sgbWU6IDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cImNoZWNrZWRcIiBuZy1pbml0PVwiY2hlY2tlZD10cnVlXCIgLz48L2xhYmVsPjxici8+XG5cdCAgICAgIFNob3cgd2hlbiBjaGVja2VkOlxuXHQgICAgICA8c3BhbiBuZy1pZj1cImNoZWNrZWRcIiBjbGFzcz1cImFuaW1hdGUtaWZcIj5cblx0ICAgICAgICBUaGlzIGlzIHJlbW92ZWQgd2hlbiB0aGUgY2hlY2tib3ggaXMgdW5jaGVja2VkLlxuXHQgICAgICA8L3NwYW4+XG5cdCAgICA8L2ZpbGU+XG5cdCAgICA8ZmlsZSBuYW1lPVwiYW5pbWF0aW9ucy5jc3NcIj5cblx0ICAgICAgLmFuaW1hdGUtaWYge1xuXHQgICAgICAgIGJhY2tncm91bmQ6d2hpdGU7XG5cdCAgICAgICAgYm9yZGVyOjFweCBzb2xpZCBibGFjaztcblx0ICAgICAgICBwYWRkaW5nOjEwcHg7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC5hbmltYXRlLWlmLm5nLWVudGVyLCAuYW5pbWF0ZS1pZi5uZy1sZWF2ZSB7XG5cdCAgICAgICAgdHJhbnNpdGlvbjphbGwgY3ViaWMtYmV6aWVyKDAuMjUwLCAwLjQ2MCwgMC40NTAsIDAuOTQwKSAwLjVzO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAuYW5pbWF0ZS1pZi5uZy1lbnRlcixcblx0ICAgICAgLmFuaW1hdGUtaWYubmctbGVhdmUubmctbGVhdmUtYWN0aXZlIHtcblx0ICAgICAgICBvcGFjaXR5OjA7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC5hbmltYXRlLWlmLm5nLWxlYXZlLFxuXHQgICAgICAuYW5pbWF0ZS1pZi5uZy1lbnRlci5uZy1lbnRlci1hY3RpdmUge1xuXHQgICAgICAgIG9wYWNpdHk6MTtcblx0ICAgICAgfVxuXHQgICAgPC9maWxlPlxuXHQgIDwvZXhhbXBsZT5cblx0ICovXG5cdHZhciBuZ0lmRGlyZWN0aXZlID0gWyckYW5pbWF0ZScsIGZ1bmN0aW9uKCRhbmltYXRlKSB7XG5cdCAgcmV0dXJuIHtcblx0ICAgIG11bHRpRWxlbWVudDogdHJ1ZSxcblx0ICAgIHRyYW5zY2x1ZGU6ICdlbGVtZW50Jyxcblx0ICAgIHByaW9yaXR5OiA2MDAsXG5cdCAgICB0ZXJtaW5hbDogdHJ1ZSxcblx0ICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICAkJHRsYjogdHJ1ZSxcblx0ICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRyLCBjdHJsLCAkdHJhbnNjbHVkZSkge1xuXHQgICAgICAgIHZhciBibG9jaywgY2hpbGRTY29wZSwgcHJldmlvdXNFbGVtZW50cztcblx0ICAgICAgICAkc2NvcGUuJHdhdGNoKCRhdHRyLm5nSWYsIGZ1bmN0aW9uIG5nSWZXYXRjaEFjdGlvbih2YWx1ZSkge1xuXHRcblx0ICAgICAgICAgIGlmICh2YWx1ZSkge1xuXHQgICAgICAgICAgICBpZiAoIWNoaWxkU2NvcGUpIHtcblx0ICAgICAgICAgICAgICAkdHJhbnNjbHVkZShmdW5jdGlvbihjbG9uZSwgbmV3U2NvcGUpIHtcblx0ICAgICAgICAgICAgICAgIGNoaWxkU2NvcGUgPSBuZXdTY29wZTtcblx0ICAgICAgICAgICAgICAgIGNsb25lW2Nsb25lLmxlbmd0aCsrXSA9IGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoJyBlbmQgbmdJZjogJyArICRhdHRyLm5nSWYgKyAnICcpO1xuXHQgICAgICAgICAgICAgICAgLy8gTm90ZTogV2Ugb25seSBuZWVkIHRoZSBmaXJzdC9sYXN0IG5vZGUgb2YgdGhlIGNsb25lZCBub2Rlcy5cblx0ICAgICAgICAgICAgICAgIC8vIEhvd2V2ZXIsIHdlIG5lZWQgdG8ga2VlcCB0aGUgcmVmZXJlbmNlIHRvIHRoZSBqcWxpdGUgd3JhcHBlciBhcyBpdCBtaWdodCBiZSBjaGFuZ2VkIGxhdGVyXG5cdCAgICAgICAgICAgICAgICAvLyBieSBhIGRpcmVjdGl2ZSB3aXRoIHRlbXBsYXRlVXJsIHdoZW4gaXRzIHRlbXBsYXRlIGFycml2ZXMuXG5cdCAgICAgICAgICAgICAgICBibG9jayA9IHtcblx0ICAgICAgICAgICAgICAgICAgY2xvbmU6IGNsb25lXG5cdCAgICAgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICAgICAgJGFuaW1hdGUuZW50ZXIoY2xvbmUsICRlbGVtZW50LnBhcmVudCgpLCAkZWxlbWVudCk7XG5cdCAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGlmIChwcmV2aW91c0VsZW1lbnRzKSB7XG5cdCAgICAgICAgICAgICAgcHJldmlvdXNFbGVtZW50cy5yZW1vdmUoKTtcblx0ICAgICAgICAgICAgICBwcmV2aW91c0VsZW1lbnRzID0gbnVsbDtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBpZiAoY2hpbGRTY29wZSkge1xuXHQgICAgICAgICAgICAgIGNoaWxkU2NvcGUuJGRlc3Ryb3koKTtcblx0ICAgICAgICAgICAgICBjaGlsZFNjb3BlID0gbnVsbDtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBpZiAoYmxvY2spIHtcblx0ICAgICAgICAgICAgICBwcmV2aW91c0VsZW1lbnRzID0gZ2V0QmxvY2tOb2RlcyhibG9jay5jbG9uZSk7XG5cdCAgICAgICAgICAgICAgJGFuaW1hdGUubGVhdmUocHJldmlvdXNFbGVtZW50cykudGhlbihmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgICAgIHByZXZpb3VzRWxlbWVudHMgPSBudWxsO1xuXHQgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgIGJsb2NrID0gbnVsbDtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH07XG5cdH1dO1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdJbmNsdWRlXG5cdCAqIEByZXN0cmljdCBFQ0Fcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEZldGNoZXMsIGNvbXBpbGVzIGFuZCBpbmNsdWRlcyBhbiBleHRlcm5hbCBIVE1MIGZyYWdtZW50LlxuXHQgKlxuXHQgKiBCeSBkZWZhdWx0LCB0aGUgdGVtcGxhdGUgVVJMIGlzIHJlc3RyaWN0ZWQgdG8gdGhlIHNhbWUgZG9tYWluIGFuZCBwcm90b2NvbCBhcyB0aGVcblx0ICogYXBwbGljYXRpb24gZG9jdW1lbnQuIFRoaXMgaXMgZG9uZSBieSBjYWxsaW5nIHtAbGluayAkc2NlI2dldFRydXN0ZWRSZXNvdXJjZVVybFxuXHQgKiAkc2NlLmdldFRydXN0ZWRSZXNvdXJjZVVybH0gb24gaXQuIFRvIGxvYWQgdGVtcGxhdGVzIGZyb20gb3RoZXIgZG9tYWlucyBvciBwcm90b2NvbHNcblx0ICogeW91IG1heSBlaXRoZXIge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZVByb3ZpZGVyI3Jlc291cmNlVXJsV2hpdGVsaXN0IHdoaXRlbGlzdCB0aGVtfSBvclxuXHQgKiB7QGxpbmsgJHNjZSN0cnVzdEFzUmVzb3VyY2VVcmwgd3JhcCB0aGVtfSBhcyB0cnVzdGVkIHZhbHVlcy4gUmVmZXIgdG8gQW5ndWxhcidzIHtAbGlua1xuXHQgKiBuZy4kc2NlIFN0cmljdCBDb250ZXh0dWFsIEVzY2FwaW5nfS5cblx0ICpcblx0ICogSW4gYWRkaXRpb24sIHRoZSBicm93c2VyJ3Ncblx0ICogW1NhbWUgT3JpZ2luIFBvbGljeV0oaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9icm93c2Vyc2VjL3dpa2kvUGFydDIjU2FtZS1vcmlnaW5fcG9saWN5X2Zvcl9YTUxIdHRwUmVxdWVzdClcblx0ICogYW5kIFtDcm9zcy1PcmlnaW4gUmVzb3VyY2UgU2hhcmluZyAoQ09SUyldKGh0dHA6Ly93d3cudzMub3JnL1RSL2NvcnMvKVxuXHQgKiBwb2xpY3kgbWF5IGZ1cnRoZXIgcmVzdHJpY3Qgd2hldGhlciB0aGUgdGVtcGxhdGUgaXMgc3VjY2Vzc2Z1bGx5IGxvYWRlZC5cblx0ICogRm9yIGV4YW1wbGUsIGBuZ0luY2x1ZGVgIHdvbid0IHdvcmsgZm9yIGNyb3NzLWRvbWFpbiByZXF1ZXN0cyBvbiBhbGwgYnJvd3NlcnMgYW5kIGZvciBgZmlsZTovL2Bcblx0ICogYWNjZXNzIG9uIHNvbWUgYnJvd3NlcnMuXG5cdCAqXG5cdCAqIEBhbmltYXRpb25zXG5cdCAqIGVudGVyIC0gYW5pbWF0aW9uIGlzIHVzZWQgdG8gYnJpbmcgbmV3IGNvbnRlbnQgaW50byB0aGUgYnJvd3Nlci5cblx0ICogbGVhdmUgLSBhbmltYXRpb24gaXMgdXNlZCB0byBhbmltYXRlIGV4aXN0aW5nIGNvbnRlbnQgYXdheS5cblx0ICpcblx0ICogVGhlIGVudGVyIGFuZCBsZWF2ZSBhbmltYXRpb24gb2NjdXIgY29uY3VycmVudGx5LlxuXHQgKlxuXHQgKiBAc2NvcGVcblx0ICogQHByaW9yaXR5IDQwMFxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gbmdJbmNsdWRlfHNyYyBhbmd1bGFyIGV4cHJlc3Npb24gZXZhbHVhdGluZyB0byBVUkwuIElmIHRoZSBzb3VyY2UgaXMgYSBzdHJpbmcgY29uc3RhbnQsXG5cdCAqICAgICAgICAgICAgICAgICBtYWtlIHN1cmUgeW91IHdyYXAgaXQgaW4gKipzaW5nbGUqKiBxdW90ZXMsIGUuZy4gYHNyYz1cIidteVBhcnRpYWxUZW1wbGF0ZS5odG1sJ1wiYC5cblx0ICogQHBhcmFtIHtzdHJpbmc9fSBvbmxvYWQgRXhwcmVzc2lvbiB0byBldmFsdWF0ZSB3aGVuIGEgbmV3IHBhcnRpYWwgaXMgbG9hZGVkLlxuXHQgKiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG5cdCAqICAgICAgICAgICAgICAgICAgKipOb3RlOioqIFdoZW4gdXNpbmcgb25sb2FkIG9uIFNWRyBlbGVtZW50cyBpbiBJRTExLCB0aGUgYnJvd3NlciB3aWxsIHRyeSB0byBjYWxsXG5cdCAqICAgICAgICAgICAgICAgICAgYSBmdW5jdGlvbiB3aXRoIHRoZSBuYW1lIG9uIHRoZSB3aW5kb3cgZWxlbWVudCwgd2hpY2ggd2lsbCB1c3VhbGx5IHRocm93IGFcblx0ICogICAgICAgICAgICAgICAgICBcImZ1bmN0aW9uIGlzIHVuZGVmaW5lZFwiIGVycm9yLiBUbyBmaXggdGhpcywgeW91IGNhbiBpbnN0ZWFkIHVzZSBgZGF0YS1vbmxvYWRgIG9yIGFcblx0ICogICAgICAgICAgICAgICAgICBkaWZmZXJlbnQgZm9ybSB0aGF0IHtAbGluayBndWlkZS9kaXJlY3RpdmUjbm9ybWFsaXphdGlvbiBtYXRjaGVzfSBgb25sb2FkYC5cblx0ICogICAgICAgICAgICAgICAgICA8L2Rpdj5cblx0ICAgKlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IGF1dG9zY3JvbGwgV2hldGhlciBgbmdJbmNsdWRlYCBzaG91bGQgY2FsbCB7QGxpbmsgbmcuJGFuY2hvclNjcm9sbFxuXHQgKiAgICAgICAgICAgICAgICAgICRhbmNob3JTY3JvbGx9IHRvIHNjcm9sbCB0aGUgdmlld3BvcnQgYWZ0ZXIgdGhlIGNvbnRlbnQgaXMgbG9hZGVkLlxuXHQgKlxuXHQgKiAgICAgICAgICAgICAgICAgIC0gSWYgdGhlIGF0dHJpYnV0ZSBpcyBub3Qgc2V0LCBkaXNhYmxlIHNjcm9sbGluZy5cblx0ICogICAgICAgICAgICAgICAgICAtIElmIHRoZSBhdHRyaWJ1dGUgaXMgc2V0IHdpdGhvdXQgdmFsdWUsIGVuYWJsZSBzY3JvbGxpbmcuXG5cdCAqICAgICAgICAgICAgICAgICAgLSBPdGhlcndpc2UgZW5hYmxlIHNjcm9sbGluZyBvbmx5IGlmIHRoZSBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnV0aHkgdmFsdWUuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgPGV4YW1wbGUgbW9kdWxlPVwiaW5jbHVkZUV4YW1wbGVcIiBkZXBzPVwiYW5ndWxhci1hbmltYXRlLmpzXCIgYW5pbWF0aW9ucz1cInRydWVcIj5cblx0ICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgIDxzZWxlY3QgbmctbW9kZWw9XCJ0ZW1wbGF0ZVwiIG5nLW9wdGlvbnM9XCJ0Lm5hbWUgZm9yIHQgaW4gdGVtcGxhdGVzXCI+XG5cdCAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlwiPihibGFuayk8L29wdGlvbj5cblx0ICAgICAgIDwvc2VsZWN0PlxuXHQgICAgICAgdXJsIG9mIHRoZSB0ZW1wbGF0ZTogPGNvZGU+e3t0ZW1wbGF0ZS51cmx9fTwvY29kZT5cblx0ICAgICAgIDxoci8+XG5cdCAgICAgICA8ZGl2IGNsYXNzPVwic2xpZGUtYW5pbWF0ZS1jb250YWluZXJcIj5cblx0ICAgICAgICAgPGRpdiBjbGFzcz1cInNsaWRlLWFuaW1hdGVcIiBuZy1pbmNsdWRlPVwidGVtcGxhdGUudXJsXCI+PC9kaXY+XG5cdCAgICAgICA8L2Rpdj5cblx0ICAgICA8L2Rpdj5cblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cblx0ICAgICAgYW5ndWxhci5tb2R1bGUoJ2luY2x1ZGVFeGFtcGxlJywgWyduZ0FuaW1hdGUnXSlcblx0ICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgJHNjb3BlLnRlbXBsYXRlcyA9XG5cdCAgICAgICAgICAgIFsgeyBuYW1lOiAndGVtcGxhdGUxLmh0bWwnLCB1cmw6ICd0ZW1wbGF0ZTEuaHRtbCd9LFxuXHQgICAgICAgICAgICAgIHsgbmFtZTogJ3RlbXBsYXRlMi5odG1sJywgdXJsOiAndGVtcGxhdGUyLmh0bWwnfSBdO1xuXHQgICAgICAgICAgJHNjb3BlLnRlbXBsYXRlID0gJHNjb3BlLnRlbXBsYXRlc1swXTtcblx0ICAgICAgICB9XSk7XG5cdCAgICAgPC9maWxlPlxuXHQgICAgPGZpbGUgbmFtZT1cInRlbXBsYXRlMS5odG1sXCI+XG5cdCAgICAgIENvbnRlbnQgb2YgdGVtcGxhdGUxLmh0bWxcblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJ0ZW1wbGF0ZTIuaHRtbFwiPlxuXHQgICAgICBDb250ZW50IG9mIHRlbXBsYXRlMi5odG1sXG5cdCAgICA8L2ZpbGU+XG5cdCAgICA8ZmlsZSBuYW1lPVwiYW5pbWF0aW9ucy5jc3NcIj5cblx0ICAgICAgLnNsaWRlLWFuaW1hdGUtY29udGFpbmVyIHtcblx0ICAgICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcblx0ICAgICAgICBiYWNrZ3JvdW5kOndoaXRlO1xuXHQgICAgICAgIGJvcmRlcjoxcHggc29saWQgYmxhY2s7XG5cdCAgICAgICAgaGVpZ2h0OjQwcHg7XG5cdCAgICAgICAgb3ZlcmZsb3c6aGlkZGVuO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAuc2xpZGUtYW5pbWF0ZSB7XG5cdCAgICAgICAgcGFkZGluZzoxMHB4O1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAuc2xpZGUtYW5pbWF0ZS5uZy1lbnRlciwgLnNsaWRlLWFuaW1hdGUubmctbGVhdmUge1xuXHQgICAgICAgIHRyYW5zaXRpb246YWxsIGN1YmljLWJlemllcigwLjI1MCwgMC40NjAsIDAuNDUwLCAwLjk0MCkgMC41cztcblx0XG5cdCAgICAgICAgcG9zaXRpb246YWJzb2x1dGU7XG5cdCAgICAgICAgdG9wOjA7XG5cdCAgICAgICAgbGVmdDowO1xuXHQgICAgICAgIHJpZ2h0OjA7XG5cdCAgICAgICAgYm90dG9tOjA7XG5cdCAgICAgICAgZGlzcGxheTpibG9jaztcblx0ICAgICAgICBwYWRkaW5nOjEwcHg7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC5zbGlkZS1hbmltYXRlLm5nLWVudGVyIHtcblx0ICAgICAgICB0b3A6LTUwcHg7XG5cdCAgICAgIH1cblx0ICAgICAgLnNsaWRlLWFuaW1hdGUubmctZW50ZXIubmctZW50ZXItYWN0aXZlIHtcblx0ICAgICAgICB0b3A6MDtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLnNsaWRlLWFuaW1hdGUubmctbGVhdmUge1xuXHQgICAgICAgIHRvcDowO1xuXHQgICAgICB9XG5cdCAgICAgIC5zbGlkZS1hbmltYXRlLm5nLWxlYXZlLm5nLWxlYXZlLWFjdGl2ZSB7XG5cdCAgICAgICAgdG9wOjUwcHg7XG5cdCAgICAgIH1cblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgdmFyIHRlbXBsYXRlU2VsZWN0ID0gZWxlbWVudChieS5tb2RlbCgndGVtcGxhdGUnKSk7XG5cdCAgICAgIHZhciBpbmNsdWRlRWxlbSA9IGVsZW1lbnQoYnkuY3NzKCdbbmctaW5jbHVkZV0nKSk7XG5cdFxuXHQgICAgICBpdCgnc2hvdWxkIGxvYWQgdGVtcGxhdGUxLmh0bWwnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBleHBlY3QoaW5jbHVkZUVsZW0uZ2V0VGV4dCgpKS50b01hdGNoKC9Db250ZW50IG9mIHRlbXBsYXRlMS5odG1sLyk7XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgaXQoJ3Nob3VsZCBsb2FkIHRlbXBsYXRlMi5odG1sJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKGJyb3dzZXIucGFyYW1zLmJyb3dzZXIgPT0gJ2ZpcmVmb3gnKSB7XG5cdCAgICAgICAgICAvLyBGaXJlZm94IGNhbid0IGhhbmRsZSB1c2luZyBzZWxlY3RzXG5cdCAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvcHJvdHJhY3Rvci9pc3N1ZXMvNDgwXG5cdCAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRlbXBsYXRlU2VsZWN0LmNsaWNrKCk7XG5cdCAgICAgICAgdGVtcGxhdGVTZWxlY3QuYWxsKGJ5LmNzcygnb3B0aW9uJykpLmdldCgyKS5jbGljaygpO1xuXHQgICAgICAgIGV4cGVjdChpbmNsdWRlRWxlbS5nZXRUZXh0KCkpLnRvTWF0Y2goL0NvbnRlbnQgb2YgdGVtcGxhdGUyLmh0bWwvKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBpdCgnc2hvdWxkIGNoYW5nZSB0byBibGFuaycsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmIChicm93c2VyLnBhcmFtcy5icm93c2VyID09ICdmaXJlZm94Jykge1xuXHQgICAgICAgICAgLy8gRmlyZWZveCBjYW4ndCBoYW5kbGUgdXNpbmcgc2VsZWN0c1xuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB0ZW1wbGF0ZVNlbGVjdC5jbGljaygpO1xuXHQgICAgICAgIHRlbXBsYXRlU2VsZWN0LmFsbChieS5jc3MoJ29wdGlvbicpKS5nZXQoMCkuY2xpY2soKTtcblx0ICAgICAgICBleHBlY3QoaW5jbHVkZUVsZW0uaXNQcmVzZW50KCkpLnRvQmUoZmFsc2UpO1xuXHQgICAgICB9KTtcblx0ICAgIDwvZmlsZT5cblx0ICA8L2V4YW1wbGU+XG5cdCAqL1xuXHRcblx0XG5cdC8qKlxuXHQgKiBAbmdkb2MgZXZlbnRcblx0ICogQG5hbWUgbmdJbmNsdWRlIyRpbmNsdWRlQ29udGVudFJlcXVlc3RlZFxuXHQgKiBAZXZlbnRUeXBlIGVtaXQgb24gdGhlIHNjb3BlIG5nSW5jbHVkZSB3YXMgZGVjbGFyZWQgaW5cblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEVtaXR0ZWQgZXZlcnkgdGltZSB0aGUgbmdJbmNsdWRlIGNvbnRlbnQgaXMgcmVxdWVzdGVkLlxuXHQgKlxuXHQgKiBAcGFyYW0ge09iamVjdH0gYW5ndWxhckV2ZW50IFN5bnRoZXRpYyBldmVudCBvYmplY3QuXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBzcmMgVVJMIG9mIGNvbnRlbnQgdG8gbG9hZC5cblx0ICovXG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBldmVudFxuXHQgKiBAbmFtZSBuZ0luY2x1ZGUjJGluY2x1ZGVDb250ZW50TG9hZGVkXG5cdCAqIEBldmVudFR5cGUgZW1pdCBvbiB0aGUgY3VycmVudCBuZ0luY2x1ZGUgc2NvcGVcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEVtaXR0ZWQgZXZlcnkgdGltZSB0aGUgbmdJbmNsdWRlIGNvbnRlbnQgaXMgcmVsb2FkZWQuXG5cdCAqXG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBhbmd1bGFyRXZlbnQgU3ludGhldGljIGV2ZW50IG9iamVjdC5cblx0ICogQHBhcmFtIHtTdHJpbmd9IHNyYyBVUkwgb2YgY29udGVudCB0byBsb2FkLlxuXHQgKi9cblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGV2ZW50XG5cdCAqIEBuYW1lIG5nSW5jbHVkZSMkaW5jbHVkZUNvbnRlbnRFcnJvclxuXHQgKiBAZXZlbnRUeXBlIGVtaXQgb24gdGhlIHNjb3BlIG5nSW5jbHVkZSB3YXMgZGVjbGFyZWQgaW5cblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIEVtaXR0ZWQgd2hlbiBhIHRlbXBsYXRlIEhUVFAgcmVxdWVzdCB5aWVsZHMgYW4gZXJyb25lb3VzIHJlc3BvbnNlIChzdGF0dXMgPCAyMDAgfHwgc3RhdHVzID4gMjk5KVxuXHQgKlxuXHQgKiBAcGFyYW0ge09iamVjdH0gYW5ndWxhckV2ZW50IFN5bnRoZXRpYyBldmVudCBvYmplY3QuXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBzcmMgVVJMIG9mIGNvbnRlbnQgdG8gbG9hZC5cblx0ICovXG5cdHZhciBuZ0luY2x1ZGVEaXJlY3RpdmUgPSBbJyR0ZW1wbGF0ZVJlcXVlc3QnLCAnJGFuY2hvclNjcm9sbCcsICckYW5pbWF0ZScsXG5cdCAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCR0ZW1wbGF0ZVJlcXVlc3QsICAgJGFuY2hvclNjcm9sbCwgICAkYW5pbWF0ZSkge1xuXHQgIHJldHVybiB7XG5cdCAgICByZXN0cmljdDogJ0VDQScsXG5cdCAgICBwcmlvcml0eTogNDAwLFxuXHQgICAgdGVybWluYWw6IHRydWUsXG5cdCAgICB0cmFuc2NsdWRlOiAnZWxlbWVudCcsXG5cdCAgICBjb250cm9sbGVyOiBhbmd1bGFyLm5vb3AsXG5cdCAgICBjb21waWxlOiBmdW5jdGlvbihlbGVtZW50LCBhdHRyKSB7XG5cdCAgICAgIHZhciBzcmNFeHAgPSBhdHRyLm5nSW5jbHVkZSB8fCBhdHRyLnNyYyxcblx0ICAgICAgICAgIG9ubG9hZEV4cCA9IGF0dHIub25sb2FkIHx8ICcnLFxuXHQgICAgICAgICAgYXV0b1Njcm9sbEV4cCA9IGF0dHIuYXV0b3Njcm9sbDtcblx0XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgJGVsZW1lbnQsICRhdHRyLCBjdHJsLCAkdHJhbnNjbHVkZSkge1xuXHQgICAgICAgIHZhciBjaGFuZ2VDb3VudGVyID0gMCxcblx0ICAgICAgICAgICAgY3VycmVudFNjb3BlLFxuXHQgICAgICAgICAgICBwcmV2aW91c0VsZW1lbnQsXG5cdCAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50O1xuXHRcblx0ICAgICAgICB2YXIgY2xlYW51cExhc3RJbmNsdWRlQ29udGVudCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgaWYgKHByZXZpb3VzRWxlbWVudCkge1xuXHQgICAgICAgICAgICBwcmV2aW91c0VsZW1lbnQucmVtb3ZlKCk7XG5cdCAgICAgICAgICAgIHByZXZpb3VzRWxlbWVudCA9IG51bGw7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBpZiAoY3VycmVudFNjb3BlKSB7XG5cdCAgICAgICAgICAgIGN1cnJlbnRTY29wZS4kZGVzdHJveSgpO1xuXHQgICAgICAgICAgICBjdXJyZW50U2NvcGUgPSBudWxsO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgaWYgKGN1cnJlbnRFbGVtZW50KSB7XG5cdCAgICAgICAgICAgICRhbmltYXRlLmxlYXZlKGN1cnJlbnRFbGVtZW50KS50aGVuKGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICAgIHByZXZpb3VzRWxlbWVudCA9IG51bGw7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICBwcmV2aW91c0VsZW1lbnQgPSBjdXJyZW50RWxlbWVudDtcblx0ICAgICAgICAgICAgY3VycmVudEVsZW1lbnQgPSBudWxsO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH07XG5cdFxuXHQgICAgICAgIHNjb3BlLiR3YXRjaChzcmNFeHAsIGZ1bmN0aW9uIG5nSW5jbHVkZVdhdGNoQWN0aW9uKHNyYykge1xuXHQgICAgICAgICAgdmFyIGFmdGVyQW5pbWF0aW9uID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGlmIChpc0RlZmluZWQoYXV0b1Njcm9sbEV4cCkgJiYgKCFhdXRvU2Nyb2xsRXhwIHx8IHNjb3BlLiRldmFsKGF1dG9TY3JvbGxFeHApKSkge1xuXHQgICAgICAgICAgICAgICRhbmNob3JTY3JvbGwoKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfTtcblx0ICAgICAgICAgIHZhciB0aGlzQ2hhbmdlSWQgPSArK2NoYW5nZUNvdW50ZXI7XG5cdFxuXHQgICAgICAgICAgaWYgKHNyYykge1xuXHQgICAgICAgICAgICAvL3NldCB0aGUgMm5kIHBhcmFtIHRvIHRydWUgdG8gaWdub3JlIHRoZSB0ZW1wbGF0ZSByZXF1ZXN0IGVycm9yIHNvIHRoYXQgdGhlIGlubmVyXG5cdCAgICAgICAgICAgIC8vY29udGVudHMgYW5kIHNjb3BlIGNhbiBiZSBjbGVhbmVkIHVwLlxuXHQgICAgICAgICAgICAkdGVtcGxhdGVSZXF1ZXN0KHNyYywgdHJ1ZSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuXHQgICAgICAgICAgICAgIGlmIChzY29wZS4kJGRlc3Ryb3llZCkgcmV0dXJuO1xuXHRcblx0ICAgICAgICAgICAgICBpZiAodGhpc0NoYW5nZUlkICE9PSBjaGFuZ2VDb3VudGVyKSByZXR1cm47XG5cdCAgICAgICAgICAgICAgdmFyIG5ld1Njb3BlID0gc2NvcGUuJG5ldygpO1xuXHQgICAgICAgICAgICAgIGN0cmwudGVtcGxhdGUgPSByZXNwb25zZTtcblx0XG5cdCAgICAgICAgICAgICAgLy8gTm90ZTogVGhpcyB3aWxsIGFsc28gbGluayBhbGwgY2hpbGRyZW4gb2YgbmctaW5jbHVkZSB0aGF0IHdlcmUgY29udGFpbmVkIGluIHRoZSBvcmlnaW5hbFxuXHQgICAgICAgICAgICAgIC8vIGh0bWwuIElmIHRoYXQgY29udGVudCBjb250YWlucyBjb250cm9sbGVycywgLi4uIHRoZXkgY291bGQgcG9sbHV0ZS9jaGFuZ2UgdGhlIHNjb3BlLlxuXHQgICAgICAgICAgICAgIC8vIEhvd2V2ZXIsIHVzaW5nIG5nLWluY2x1ZGUgb24gYW4gZWxlbWVudCB3aXRoIGFkZGl0aW9uYWwgY29udGVudCBkb2VzIG5vdCBtYWtlIHNlbnNlLi4uXG5cdCAgICAgICAgICAgICAgLy8gTm90ZTogV2UgY2FuJ3QgcmVtb3ZlIHRoZW0gaW4gdGhlIGNsb25lQXR0Y2hGbiBvZiAkdHJhbnNjbHVkZSBhcyB0aGF0XG5cdCAgICAgICAgICAgICAgLy8gZnVuY3Rpb24gaXMgY2FsbGVkIGJlZm9yZSBsaW5raW5nIHRoZSBjb250ZW50LCB3aGljaCB3b3VsZCBhcHBseSBjaGlsZFxuXHQgICAgICAgICAgICAgIC8vIGRpcmVjdGl2ZXMgdG8gbm9uIGV4aXN0aW5nIGVsZW1lbnRzLlxuXHQgICAgICAgICAgICAgIHZhciBjbG9uZSA9ICR0cmFuc2NsdWRlKG5ld1Njb3BlLCBmdW5jdGlvbihjbG9uZSkge1xuXHQgICAgICAgICAgICAgICAgY2xlYW51cExhc3RJbmNsdWRlQ29udGVudCgpO1xuXHQgICAgICAgICAgICAgICAgJGFuaW1hdGUuZW50ZXIoY2xvbmUsIG51bGwsICRlbGVtZW50KS50aGVuKGFmdGVyQW5pbWF0aW9uKTtcblx0ICAgICAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAgICAgY3VycmVudFNjb3BlID0gbmV3U2NvcGU7XG5cdCAgICAgICAgICAgICAgY3VycmVudEVsZW1lbnQgPSBjbG9uZTtcblx0XG5cdCAgICAgICAgICAgICAgY3VycmVudFNjb3BlLiRlbWl0KCckaW5jbHVkZUNvbnRlbnRMb2FkZWQnLCBzcmMpO1xuXHQgICAgICAgICAgICAgIHNjb3BlLiRldmFsKG9ubG9hZEV4cCk7XG5cdCAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICAgIGlmIChzY29wZS4kJGRlc3Ryb3llZCkgcmV0dXJuO1xuXHRcblx0ICAgICAgICAgICAgICBpZiAodGhpc0NoYW5nZUlkID09PSBjaGFuZ2VDb3VudGVyKSB7XG5cdCAgICAgICAgICAgICAgICBjbGVhbnVwTGFzdEluY2x1ZGVDb250ZW50KCk7XG5cdCAgICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnJGluY2x1ZGVDb250ZW50RXJyb3InLCBzcmMpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgIHNjb3BlLiRlbWl0KCckaW5jbHVkZUNvbnRlbnRSZXF1ZXN0ZWQnLCBzcmMpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgY2xlYW51cExhc3RJbmNsdWRlQ29udGVudCgpO1xuXHQgICAgICAgICAgICBjdHJsLnRlbXBsYXRlID0gbnVsbDtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0ICB9O1xuXHR9XTtcblx0XG5cdC8vIFRoaXMgZGlyZWN0aXZlIGlzIGNhbGxlZCBkdXJpbmcgdGhlICR0cmFuc2NsdWRlIGNhbGwgb2YgdGhlIGZpcnN0IGBuZ0luY2x1ZGVgIGRpcmVjdGl2ZS5cblx0Ly8gSXQgd2lsbCByZXBsYWNlIGFuZCBjb21waWxlIHRoZSBjb250ZW50IG9mIHRoZSBlbGVtZW50IHdpdGggdGhlIGxvYWRlZCB0ZW1wbGF0ZS5cblx0Ly8gV2UgbmVlZCB0aGlzIGRpcmVjdGl2ZSBzbyB0aGF0IHRoZSBlbGVtZW50IGNvbnRlbnQgaXMgYWxyZWFkeSBmaWxsZWQgd2hlblxuXHQvLyB0aGUgbGluayBmdW5jdGlvbiBvZiBhbm90aGVyIGRpcmVjdGl2ZSBvbiB0aGUgc2FtZSBlbGVtZW50IGFzIG5nSW5jbHVkZVxuXHQvLyBpcyBjYWxsZWQuXG5cdHZhciBuZ0luY2x1ZGVGaWxsQ29udGVudERpcmVjdGl2ZSA9IFsnJGNvbXBpbGUnLFxuXHQgIGZ1bmN0aW9uKCRjb21waWxlKSB7XG5cdCAgICByZXR1cm4ge1xuXHQgICAgICByZXN0cmljdDogJ0VDQScsXG5cdCAgICAgIHByaW9yaXR5OiAtNDAwLFxuXHQgICAgICByZXF1aXJlOiAnbmdJbmNsdWRlJyxcblx0ICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsICRlbGVtZW50LCAkYXR0ciwgY3RybCkge1xuXHQgICAgICAgIGlmICh0b1N0cmluZy5jYWxsKCRlbGVtZW50WzBdKS5tYXRjaCgvU1ZHLykpIHtcblx0ICAgICAgICAgIC8vIFdlYktpdDogaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTEzNTY5OCAtLS0gU1ZHIGVsZW1lbnRzIGRvIG5vdFxuXHQgICAgICAgICAgLy8gc3VwcG9ydCBpbm5lckhUTUwsIHNvIGRldGVjdCB0aGlzIGhlcmUgYW5kIHRyeSB0byBnZW5lcmF0ZSB0aGUgY29udGVudHNcblx0ICAgICAgICAgIC8vIHNwZWNpYWxseS5cblx0ICAgICAgICAgICRlbGVtZW50LmVtcHR5KCk7XG5cdCAgICAgICAgICAkY29tcGlsZShqcUxpdGVCdWlsZEZyYWdtZW50KGN0cmwudGVtcGxhdGUsIGRvY3VtZW50KS5jaGlsZE5vZGVzKShzY29wZSxcblx0ICAgICAgICAgICAgICBmdW5jdGlvbiBuYW1lc3BhY2VBZGFwdGVkQ2xvbmUoY2xvbmUpIHtcblx0ICAgICAgICAgICAgJGVsZW1lbnQuYXBwZW5kKGNsb25lKTtcblx0ICAgICAgICAgIH0sIHtmdXR1cmVQYXJlbnRFbGVtZW50OiAkZWxlbWVudH0pO1xuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgJGVsZW1lbnQuaHRtbChjdHJsLnRlbXBsYXRlKTtcblx0ICAgICAgICAkY29tcGlsZSgkZWxlbWVudC5jb250ZW50cygpKShzY29wZSk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgfV07XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ0luaXRcblx0ICogQHJlc3RyaWN0IEFDXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUaGUgYG5nSW5pdGAgZGlyZWN0aXZlIGFsbG93cyB5b3UgdG8gZXZhbHVhdGUgYW4gZXhwcmVzc2lvbiBpbiB0aGVcblx0ICogY3VycmVudCBzY29wZS5cblx0ICpcblx0ICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWRhbmdlclwiPlxuXHQgKiBUaGlzIGRpcmVjdGl2ZSBjYW4gYmUgYWJ1c2VkIHRvIGFkZCB1bm5lY2Vzc2FyeSBhbW91bnRzIG9mIGxvZ2ljIGludG8geW91ciB0ZW1wbGF0ZXMuXG5cdCAqIFRoZXJlIGFyZSBvbmx5IGEgZmV3IGFwcHJvcHJpYXRlIHVzZXMgb2YgYG5nSW5pdGAsIHN1Y2ggYXMgZm9yIGFsaWFzaW5nIHNwZWNpYWwgcHJvcGVydGllcyBvZlxuXHQgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nUmVwZWF0IGBuZ1JlcGVhdGB9LCBhcyBzZWVuIGluIHRoZSBkZW1vIGJlbG93OyBhbmQgZm9yIGluamVjdGluZyBkYXRhIHZpYVxuXHQgKiBzZXJ2ZXIgc2lkZSBzY3JpcHRpbmcuIEJlc2lkZXMgdGhlc2UgZmV3IGNhc2VzLCB5b3Ugc2hvdWxkIHVzZSB7QGxpbmsgZ3VpZGUvY29udHJvbGxlciBjb250cm9sbGVyc31cblx0ICogcmF0aGVyIHRoYW4gYG5nSW5pdGAgdG8gaW5pdGlhbGl6ZSB2YWx1ZXMgb24gYSBzY29wZS5cblx0ICogPC9kaXY+XG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG5cdCAqICoqTm90ZSoqOiBJZiB5b3UgaGF2ZSBhc3NpZ25tZW50IGluIGBuZ0luaXRgIGFsb25nIHdpdGggYSB7QGxpbmsgbmcuJGZpbHRlciBgZmlsdGVyYH0sIG1ha2Vcblx0ICogc3VyZSB5b3UgaGF2ZSBwYXJlbnRoZXNlcyB0byBlbnN1cmUgY29ycmVjdCBvcGVyYXRvciBwcmVjZWRlbmNlOlxuXHQgKiA8cHJlIGNsYXNzPVwicHJldHR5cHJpbnRcIj5cblx0ICogYDxkaXYgbmctaW5pdD1cInRlc3QxID0gKCRpbmRleCB8IHRvU3RyaW5nKVwiPjwvZGl2PmBcblx0ICogPC9wcmU+XG5cdCAqIDwvZGl2PlxuXHQgKlxuXHQgKiBAcHJpb3JpdHkgNDUwXG5cdCAqXG5cdCAqIEBlbGVtZW50IEFOWVxuXHQgKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nSW5pdCB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICA8ZXhhbXBsZSBtb2R1bGU9XCJpbml0RXhhbXBsZVwiPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgIDxzY3JpcHQ+XG5cdCAgICAgYW5ndWxhci5tb2R1bGUoJ2luaXRFeGFtcGxlJywgW10pXG5cdCAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAkc2NvcGUubGlzdCA9IFtbJ2EnLCAnYiddLCBbJ2MnLCAnZCddXTtcblx0ICAgICAgIH1dKTtcblx0ICAgPC9zY3JpcHQ+XG5cdCAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAgICAgPGRpdiBuZy1yZXBlYXQ9XCJpbm5lckxpc3QgaW4gbGlzdFwiIG5nLWluaXQ9XCJvdXRlckluZGV4ID0gJGluZGV4XCI+XG5cdCAgICAgICA8ZGl2IG5nLXJlcGVhdD1cInZhbHVlIGluIGlubmVyTGlzdFwiIG5nLWluaXQ9XCJpbm5lckluZGV4ID0gJGluZGV4XCI+XG5cdCAgICAgICAgICA8c3BhbiBjbGFzcz1cImV4YW1wbGUtaW5pdFwiPmxpc3RbIHt7b3V0ZXJJbmRleH19IF1bIHt7aW5uZXJJbmRleH19IF0gPSB7e3ZhbHVlfX07PC9zcGFuPlxuXHQgICAgICAgPC9kaXY+XG5cdCAgICAgPC9kaXY+XG5cdCAgIDwvZGl2PlxuXHQgICAgIDwvZmlsZT5cblx0ICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgICBpdCgnc2hvdWxkIGFsaWFzIGluZGV4IHBvc2l0aW9ucycsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICB2YXIgZWxlbWVudHMgPSBlbGVtZW50LmFsbChieS5jc3MoJy5leGFtcGxlLWluaXQnKSk7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50cy5nZXQoMCkuZ2V0VGV4dCgpKS50b0JlKCdsaXN0WyAwIF1bIDAgXSA9IGE7Jyk7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50cy5nZXQoMSkuZ2V0VGV4dCgpKS50b0JlKCdsaXN0WyAwIF1bIDEgXSA9IGI7Jyk7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50cy5nZXQoMikuZ2V0VGV4dCgpKS50b0JlKCdsaXN0WyAxIF1bIDAgXSA9IGM7Jyk7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50cy5nZXQoMykuZ2V0VGV4dCgpKS50b0JlKCdsaXN0WyAxIF1bIDEgXSA9IGQ7Jyk7XG5cdCAgICAgICB9KTtcblx0ICAgICA8L2ZpbGU+XG5cdCAgIDwvZXhhbXBsZT5cblx0ICovXG5cdHZhciBuZ0luaXREaXJlY3RpdmUgPSBuZ0RpcmVjdGl2ZSh7XG5cdCAgcHJpb3JpdHk6IDQ1MCxcblx0ICBjb21waWxlOiBmdW5jdGlvbigpIHtcblx0ICAgIHJldHVybiB7XG5cdCAgICAgIHByZTogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG5cdCAgICAgICAgc2NvcGUuJGV2YWwoYXR0cnMubmdJbml0KTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICB9XG5cdH0pO1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdMaXN0XG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUZXh0IGlucHV0IHRoYXQgY29udmVydHMgYmV0d2VlbiBhIGRlbGltaXRlZCBzdHJpbmcgYW5kIGFuIGFycmF5IG9mIHN0cmluZ3MuIFRoZSBkZWZhdWx0XG5cdCAqIGRlbGltaXRlciBpcyBhIGNvbW1hIGZvbGxvd2VkIGJ5IGEgc3BhY2UgLSBlcXVpdmFsZW50IHRvIGBuZy1saXN0PVwiLCBcImAuIFlvdSBjYW4gc3BlY2lmeSBhIGN1c3RvbVxuXHQgKiBkZWxpbWl0ZXIgYXMgdGhlIHZhbHVlIG9mIHRoZSBgbmdMaXN0YCBhdHRyaWJ1dGUgLSBmb3IgZXhhbXBsZSwgYG5nLWxpc3Q9XCIgfCBcImAuXG5cdCAqXG5cdCAqIFRoZSBiZWhhdmlvdXIgb2YgdGhlIGRpcmVjdGl2ZSBpcyBhZmZlY3RlZCBieSB0aGUgdXNlIG9mIHRoZSBgbmdUcmltYCBhdHRyaWJ1dGUuXG5cdCAqICogSWYgYG5nVHJpbWAgaXMgc2V0IHRvIGBcImZhbHNlXCJgIHRoZW4gd2hpdGVzcGFjZSBhcm91bmQgYm90aCB0aGUgc2VwYXJhdG9yIGFuZCBlYWNoXG5cdCAqICAgbGlzdCBpdGVtIGlzIHJlc3BlY3RlZC4gVGhpcyBpbXBsaWVzIHRoYXQgdGhlIHVzZXIgb2YgdGhlIGRpcmVjdGl2ZSBpcyByZXNwb25zaWJsZSBmb3Jcblx0ICogICBkZWFsaW5nIHdpdGggd2hpdGVzcGFjZSBidXQgYWxzbyBhbGxvd3MgeW91IHRvIHVzZSB3aGl0ZXNwYWNlIGFzIGEgZGVsaW1pdGVyLCBzdWNoIGFzIGFcblx0ICogICB0YWIgb3IgbmV3bGluZSBjaGFyYWN0ZXIuXG5cdCAqICogT3RoZXJ3aXNlIHdoaXRlc3BhY2UgYXJvdW5kIHRoZSBkZWxpbWl0ZXIgaXMgaWdub3JlZCB3aGVuIHNwbGl0dGluZyAoYWx0aG91Z2ggaXQgaXMgcmVzcGVjdGVkXG5cdCAqICAgd2hlbiBqb2luaW5nIHRoZSBsaXN0IGl0ZW1zIGJhY2sgdG9nZXRoZXIpIGFuZCB3aGl0ZXNwYWNlIGFyb3VuZCBlYWNoIGxpc3QgaXRlbSBpcyBzdHJpcHBlZFxuXHQgKiAgIGJlZm9yZSBpdCBpcyBhZGRlZCB0byB0aGUgbW9kZWwuXG5cdCAqXG5cdCAqICMjIyBFeGFtcGxlIHdpdGggVmFsaWRhdGlvblxuXHQgKlxuXHQgKiA8ZXhhbXBsZSBuYW1lPVwibmdMaXN0LWRpcmVjdGl2ZVwiIG1vZHVsZT1cImxpc3RFeGFtcGxlXCI+XG5cdCAqICAgPGZpbGUgbmFtZT1cImFwcC5qc1wiPlxuXHQgKiAgICAgIGFuZ3VsYXIubW9kdWxlKCdsaXN0RXhhbXBsZScsIFtdKVxuXHQgKiAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICogICAgICAgICAgJHNjb3BlLm5hbWVzID0gWydtb3JwaGV1cycsICduZW8nLCAndHJpbml0eSddO1xuXHQgKiAgICAgICAgfV0pO1xuXHQgKiAgIDwvZmlsZT5cblx0ICogICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgKiAgICA8Zm9ybSBuYW1lPVwibXlGb3JtXCIgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAqICAgICAgPGxhYmVsPkxpc3Q6IDxpbnB1dCBuYW1lPVwibmFtZXNJbnB1dFwiIG5nLW1vZGVsPVwibmFtZXNcIiBuZy1saXN0IHJlcXVpcmVkPjwvbGFiZWw+XG5cdCAqICAgICAgPHNwYW4gcm9sZT1cImFsZXJ0XCI+XG5cdCAqICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS5uYW1lc0lucHV0LiRlcnJvci5yZXF1aXJlZFwiPlxuXHQgKiAgICAgICAgUmVxdWlyZWQhPC9zcGFuPlxuXHQgKiAgICAgIDwvc3Bhbj5cblx0ICogICAgICA8YnI+XG5cdCAqICAgICAgPHR0Pm5hbWVzID0ge3tuYW1lc319PC90dD48YnIvPlxuXHQgKiAgICAgIDx0dD5teUZvcm0ubmFtZXNJbnB1dC4kdmFsaWQgPSB7e215Rm9ybS5uYW1lc0lucHV0LiR2YWxpZH19PC90dD48YnIvPlxuXHQgKiAgICAgIDx0dD5teUZvcm0ubmFtZXNJbnB1dC4kZXJyb3IgPSB7e215Rm9ybS5uYW1lc0lucHV0LiRlcnJvcn19PC90dD48YnIvPlxuXHQgKiAgICAgIDx0dD5teUZvcm0uJHZhbGlkID0ge3tteUZvcm0uJHZhbGlkfX08L3R0Pjxici8+XG5cdCAqICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IucmVxdWlyZWQgPSB7eyEhbXlGb3JtLiRlcnJvci5yZXF1aXJlZH19PC90dD48YnIvPlxuXHQgKiAgICAgPC9mb3JtPlxuXHQgKiAgIDwvZmlsZT5cblx0ICogICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAqICAgICB2YXIgbGlzdElucHV0ID0gZWxlbWVudChieS5tb2RlbCgnbmFtZXMnKSk7XG5cdCAqICAgICB2YXIgbmFtZXMgPSBlbGVtZW50KGJ5LmV4YWN0QmluZGluZygnbmFtZXMnKSk7XG5cdCAqICAgICB2YXIgdmFsaWQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ215Rm9ybS5uYW1lc0lucHV0LiR2YWxpZCcpKTtcblx0ICogICAgIHZhciBlcnJvciA9IGVsZW1lbnQoYnkuY3NzKCdzcGFuLmVycm9yJykpO1xuXHQgKlxuXHQgKiAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG5cdCAqICAgICAgIGV4cGVjdChuYW1lcy5nZXRUZXh0KCkpLnRvQ29udGFpbignW1wibW9ycGhldXNcIixcIm5lb1wiLFwidHJpbml0eVwiXScpO1xuXHQgKiAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcblx0ICogICAgICAgZXhwZWN0KGVycm9yLmdldENzc1ZhbHVlKCdkaXNwbGF5JykpLnRvQmUoJ25vbmUnKTtcblx0ICogICAgIH0pO1xuXHQgKlxuXHQgKiAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIGVtcHR5JywgZnVuY3Rpb24oKSB7XG5cdCAqICAgICAgIGxpc3RJbnB1dC5jbGVhcigpO1xuXHQgKiAgICAgICBsaXN0SW5wdXQuc2VuZEtleXMoJycpO1xuXHQgKlxuXHQgKiAgICAgICBleHBlY3QobmFtZXMuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJycpO1xuXHQgKiAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2ZhbHNlJyk7XG5cdCAqICAgICAgIGV4cGVjdChlcnJvci5nZXRDc3NWYWx1ZSgnZGlzcGxheScpKS5ub3QudG9CZSgnbm9uZScpO1xuXHQgKiAgICAgfSk7XG5cdCAqICAgPC9maWxlPlxuXHQgKiA8L2V4YW1wbGU+XG5cdCAqXG5cdCAqICMjIyBFeGFtcGxlIC0gc3BsaXR0aW5nIG9uIG5ld2xpbmVcblx0ICogPGV4YW1wbGUgbmFtZT1cIm5nTGlzdC1kaXJlY3RpdmUtbmV3bGluZXNcIj5cblx0ICogICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgKiAgICA8dGV4dGFyZWEgbmctbW9kZWw9XCJsaXN0XCIgbmctbGlzdD1cIiYjMTA7XCIgbmctdHJpbT1cImZhbHNlXCI+PC90ZXh0YXJlYT5cblx0ICogICAgPHByZT57eyBsaXN0IHwganNvbiB9fTwvcHJlPlxuXHQgKiAgIDwvZmlsZT5cblx0ICogICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAqICAgICBpdChcInNob3VsZCBzcGxpdCB0aGUgdGV4dCBieSBuZXdsaW5lc1wiLCBmdW5jdGlvbigpIHtcblx0ICogICAgICAgdmFyIGxpc3RJbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ2xpc3QnKSk7XG5cdCAqICAgICAgIHZhciBvdXRwdXQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2xpc3QgfCBqc29uJykpO1xuXHQgKiAgICAgICBsaXN0SW5wdXQuc2VuZEtleXMoJ2FiY1xcbmRlZlxcbmdoaScpO1xuXHQgKiAgICAgICBleHBlY3Qob3V0cHV0LmdldFRleHQoKSkudG9Db250YWluKCdbXFxuICBcImFiY1wiLFxcbiAgXCJkZWZcIixcXG4gIFwiZ2hpXCJcXG5dJyk7XG5cdCAqICAgICB9KTtcblx0ICogICA8L2ZpbGU+XG5cdCAqIDwvZXhhbXBsZT5cblx0ICpcblx0ICogQGVsZW1lbnQgaW5wdXRcblx0ICogQHBhcmFtIHtzdHJpbmc9fSBuZ0xpc3Qgb3B0aW9uYWwgZGVsaW1pdGVyIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gc3BsaXQgdGhlIHZhbHVlLlxuXHQgKi9cblx0dmFyIG5nTGlzdERpcmVjdGl2ZSA9IGZ1bmN0aW9uKCkge1xuXHQgIHJldHVybiB7XG5cdCAgICByZXN0cmljdDogJ0EnLFxuXHQgICAgcHJpb3JpdHk6IDEwMCxcblx0ICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcblx0ICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XG5cdCAgICAgIC8vIFdlIHdhbnQgdG8gY29udHJvbCB3aGl0ZXNwYWNlIHRyaW1taW5nIHNvIHdlIHVzZSB0aGlzIGNvbnZvbHV0ZWQgYXBwcm9hY2hcblx0ICAgICAgLy8gdG8gYWNjZXNzIHRoZSBuZ0xpc3QgYXR0cmlidXRlLCB3aGljaCBkb2Vzbid0IHByZS10cmltIHRoZSBhdHRyaWJ1dGVcblx0ICAgICAgdmFyIG5nTGlzdCA9IGVsZW1lbnQuYXR0cihhdHRyLiRhdHRyLm5nTGlzdCkgfHwgJywgJztcblx0ICAgICAgdmFyIHRyaW1WYWx1ZXMgPSBhdHRyLm5nVHJpbSAhPT0gJ2ZhbHNlJztcblx0ICAgICAgdmFyIHNlcGFyYXRvciA9IHRyaW1WYWx1ZXMgPyB0cmltKG5nTGlzdCkgOiBuZ0xpc3Q7XG5cdFxuXHQgICAgICB2YXIgcGFyc2UgPSBmdW5jdGlvbih2aWV3VmFsdWUpIHtcblx0ICAgICAgICAvLyBJZiB0aGUgdmlld1ZhbHVlIGlzIGludmFsaWQgKHNheSByZXF1aXJlZCBidXQgZW1wdHkpIGl0IHdpbGwgYmUgYHVuZGVmaW5lZGBcblx0ICAgICAgICBpZiAoaXNVbmRlZmluZWQodmlld1ZhbHVlKSkgcmV0dXJuO1xuXHRcblx0ICAgICAgICB2YXIgbGlzdCA9IFtdO1xuXHRcblx0ICAgICAgICBpZiAodmlld1ZhbHVlKSB7XG5cdCAgICAgICAgICBmb3JFYWNoKHZpZXdWYWx1ZS5zcGxpdChzZXBhcmF0b3IpLCBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgICAgICBpZiAodmFsdWUpIGxpc3QucHVzaCh0cmltVmFsdWVzID8gdHJpbSh2YWx1ZSkgOiB2YWx1ZSk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiBsaXN0O1xuXHQgICAgICB9O1xuXHRcblx0ICAgICAgY3RybC4kcGFyc2Vycy5wdXNoKHBhcnNlKTtcblx0ICAgICAgY3RybC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG5cdCAgICAgICAgICByZXR1cm4gdmFsdWUuam9pbihuZ0xpc3QpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICAvLyBPdmVycmlkZSB0aGUgc3RhbmRhcmQgJGlzRW1wdHkgYmVjYXVzZSBhbiBlbXB0eSBhcnJheSBtZWFucyB0aGUgaW5wdXQgaXMgZW1wdHkuXG5cdCAgICAgIGN0cmwuJGlzRW1wdHkgPSBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgIHJldHVybiAhdmFsdWUgfHwgIXZhbHVlLmxlbmd0aDtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0ICB9O1xuXHR9O1xuXHRcblx0LyogZ2xvYmFsIFZBTElEX0NMQVNTOiB0cnVlLFxuXHQgIElOVkFMSURfQ0xBU1M6IHRydWUsXG5cdCAgUFJJU1RJTkVfQ0xBU1M6IHRydWUsXG5cdCAgRElSVFlfQ0xBU1M6IHRydWUsXG5cdCAgVU5UT1VDSEVEX0NMQVNTOiB0cnVlLFxuXHQgIFRPVUNIRURfQ0xBU1M6IHRydWUsXG5cdCovXG5cdFxuXHR2YXIgVkFMSURfQ0xBU1MgPSAnbmctdmFsaWQnLFxuXHQgICAgSU5WQUxJRF9DTEFTUyA9ICduZy1pbnZhbGlkJyxcblx0ICAgIFBSSVNUSU5FX0NMQVNTID0gJ25nLXByaXN0aW5lJyxcblx0ICAgIERJUlRZX0NMQVNTID0gJ25nLWRpcnR5Jyxcblx0ICAgIFVOVE9VQ0hFRF9DTEFTUyA9ICduZy11bnRvdWNoZWQnLFxuXHQgICAgVE9VQ0hFRF9DTEFTUyA9ICduZy10b3VjaGVkJyxcblx0ICAgIFBFTkRJTkdfQ0xBU1MgPSAnbmctcGVuZGluZycsXG5cdCAgICBFTVBUWV9DTEFTUyA9ICduZy1lbXB0eScsXG5cdCAgICBOT1RfRU1QVFlfQ0xBU1MgPSAnbmctbm90LWVtcHR5Jztcblx0XG5cdHZhciBuZ01vZGVsTWluRXJyID0gbWluRXJyKCduZ01vZGVsJyk7XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHR5cGVcblx0ICogQG5hbWUgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlclxuXHQgKlxuXHQgKiBAcHJvcGVydHkgeyp9ICR2aWV3VmFsdWUgVGhlIGFjdHVhbCB2YWx1ZSBmcm9tIHRoZSBjb250cm9sJ3Mgdmlldy4gRm9yIGBpbnB1dGAgZWxlbWVudHMsIHRoaXMgaXMgYVxuXHQgKiBTdHJpbmcuIFNlZSB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkc2V0Vmlld1ZhbHVlfSBmb3IgaW5mb3JtYXRpb24gYWJvdXQgd2hlbiB0aGUgJHZpZXdWYWx1ZVxuXHQgKiBpcyBzZXQuXG5cdCAqIEBwcm9wZXJ0eSB7Kn0gJG1vZGVsVmFsdWUgVGhlIHZhbHVlIGluIHRoZSBtb2RlbCB0aGF0IHRoZSBjb250cm9sIGlzIGJvdW5kIHRvLlxuXHQgKiBAcHJvcGVydHkge0FycmF5LjxGdW5jdGlvbj59ICRwYXJzZXJzIEFycmF5IG9mIGZ1bmN0aW9ucyB0byBleGVjdXRlLCBhcyBhIHBpcGVsaW5lLCB3aGVuZXZlclxuXHQgICAgICAgdGhlIGNvbnRyb2wgcmVhZHMgdmFsdWUgZnJvbSB0aGUgRE9NLiBUaGUgZnVuY3Rpb25zIGFyZSBjYWxsZWQgaW4gYXJyYXkgb3JkZXIsIGVhY2ggcGFzc2luZ1xuXHQgICAgICAgaXRzIHJldHVybiB2YWx1ZSB0aHJvdWdoIHRvIHRoZSBuZXh0LiBUaGUgbGFzdCByZXR1cm4gdmFsdWUgaXMgZm9yd2FyZGVkIHRvIHRoZVxuXHQgICAgICAge0BsaW5rIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHZhbGlkYXRvcnMgYCR2YWxpZGF0b3JzYH0gY29sbGVjdGlvbi5cblx0XG5cdFBhcnNlcnMgYXJlIHVzZWQgdG8gc2FuaXRpemUgLyBjb252ZXJ0IHRoZSB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmlld1ZhbHVlXG5cdGAkdmlld1ZhbHVlYH0uXG5cdFxuXHRSZXR1cm5pbmcgYHVuZGVmaW5lZGAgZnJvbSBhIHBhcnNlciBtZWFucyBhIHBhcnNlIGVycm9yIG9jY3VycmVkLiBJbiB0aGF0IGNhc2UsXG5cdG5vIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2YWxpZGF0b3JzIGAkdmFsaWRhdG9yc2B9IHdpbGwgcnVuIGFuZCB0aGUgYG5nTW9kZWxgXG5cdHdpbGwgYmUgc2V0IHRvIGB1bmRlZmluZWRgIHVubGVzcyB7QGxpbmsgbmdNb2RlbE9wdGlvbnMgYG5nTW9kZWxPcHRpb25zLmFsbG93SW52YWxpZGB9XG5cdGlzIHNldCB0byBgdHJ1ZWAuIFRoZSBwYXJzZSBlcnJvciBpcyBzdG9yZWQgaW4gYG5nTW9kZWwuJGVycm9yLnBhcnNlYC5cblx0XG5cdCAqXG5cdCAqIEBwcm9wZXJ0eSB7QXJyYXkuPEZ1bmN0aW9uPn0gJGZvcm1hdHRlcnMgQXJyYXkgb2YgZnVuY3Rpb25zIHRvIGV4ZWN1dGUsIGFzIGEgcGlwZWxpbmUsIHdoZW5ldmVyXG5cdCAgICAgICB0aGUgbW9kZWwgdmFsdWUgY2hhbmdlcy4gVGhlIGZ1bmN0aW9ucyBhcmUgY2FsbGVkIGluIHJldmVyc2UgYXJyYXkgb3JkZXIsIGVhY2ggcGFzc2luZyB0aGUgdmFsdWUgdGhyb3VnaCB0byB0aGVcblx0ICAgICAgIG5leHQuIFRoZSBsYXN0IHJldHVybiB2YWx1ZSBpcyB1c2VkIGFzIHRoZSBhY3R1YWwgRE9NIHZhbHVlLlxuXHQgICAgICAgVXNlZCB0byBmb3JtYXQgLyBjb252ZXJ0IHZhbHVlcyBmb3IgZGlzcGxheSBpbiB0aGUgY29udHJvbC5cblx0ICogYGBganNcblx0ICogZnVuY3Rpb24gZm9ybWF0dGVyKHZhbHVlKSB7XG5cdCAqICAgaWYgKHZhbHVlKSB7XG5cdCAqICAgICByZXR1cm4gdmFsdWUudG9VcHBlckNhc2UoKTtcblx0ICogICB9XG5cdCAqIH1cblx0ICogbmdNb2RlbC4kZm9ybWF0dGVycy5wdXNoKGZvcm1hdHRlcik7XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBAcHJvcGVydHkge09iamVjdC48c3RyaW5nLCBmdW5jdGlvbj59ICR2YWxpZGF0b3JzIEEgY29sbGVjdGlvbiBvZiB2YWxpZGF0b3JzIHRoYXQgYXJlIGFwcGxpZWRcblx0ICogICAgICB3aGVuZXZlciB0aGUgbW9kZWwgdmFsdWUgY2hhbmdlcy4gVGhlIGtleSB2YWx1ZSB3aXRoaW4gdGhlIG9iamVjdCByZWZlcnMgdG8gdGhlIG5hbWUgb2YgdGhlXG5cdCAqICAgICAgdmFsaWRhdG9yIHdoaWxlIHRoZSBmdW5jdGlvbiByZWZlcnMgdG8gdGhlIHZhbGlkYXRpb24gb3BlcmF0aW9uLiBUaGUgdmFsaWRhdGlvbiBvcGVyYXRpb24gaXNcblx0ICogICAgICBwcm92aWRlZCB3aXRoIHRoZSBtb2RlbCB2YWx1ZSBhcyBhbiBhcmd1bWVudCBhbmQgbXVzdCByZXR1cm4gYSB0cnVlIG9yIGZhbHNlIHZhbHVlIGRlcGVuZGluZ1xuXHQgKiAgICAgIG9uIHRoZSByZXNwb25zZSBvZiB0aGF0IHZhbGlkYXRpb24uXG5cdCAqXG5cdCAqIGBgYGpzXG5cdCAqIG5nTW9kZWwuJHZhbGlkYXRvcnMudmFsaWRDaGFyYWN0ZXJzID0gZnVuY3Rpb24obW9kZWxWYWx1ZSwgdmlld1ZhbHVlKSB7XG5cdCAqICAgdmFyIHZhbHVlID0gbW9kZWxWYWx1ZSB8fCB2aWV3VmFsdWU7XG5cdCAqICAgcmV0dXJuIC9bMC05XSsvLnRlc3QodmFsdWUpICYmXG5cdCAqICAgICAgICAgIC9bYS16XSsvLnRlc3QodmFsdWUpICYmXG5cdCAqICAgICAgICAgIC9bQS1aXSsvLnRlc3QodmFsdWUpICYmXG5cdCAqICAgICAgICAgIC9cXFcrLy50ZXN0KHZhbHVlKTtcblx0ICogfTtcblx0ICogYGBgXG5cdCAqXG5cdCAqIEBwcm9wZXJ0eSB7T2JqZWN0LjxzdHJpbmcsIGZ1bmN0aW9uPn0gJGFzeW5jVmFsaWRhdG9ycyBBIGNvbGxlY3Rpb24gb2YgdmFsaWRhdGlvbnMgdGhhdCBhcmUgZXhwZWN0ZWQgdG9cblx0ICogICAgICBwZXJmb3JtIGFuIGFzeW5jaHJvbm91cyB2YWxpZGF0aW9uIChlLmcuIGEgSFRUUCByZXF1ZXN0KS4gVGhlIHZhbGlkYXRpb24gZnVuY3Rpb24gdGhhdCBpcyBwcm92aWRlZFxuXHQgKiAgICAgIGlzIGV4cGVjdGVkIHRvIHJldHVybiBhIHByb21pc2Ugd2hlbiBpdCBpcyBydW4gZHVyaW5nIHRoZSBtb2RlbCB2YWxpZGF0aW9uIHByb2Nlc3MuIE9uY2UgdGhlIHByb21pc2Vcblx0ICogICAgICBpcyBkZWxpdmVyZWQgdGhlbiB0aGUgdmFsaWRhdGlvbiBzdGF0dXMgd2lsbCBiZSBzZXQgdG8gdHJ1ZSB3aGVuIGZ1bGZpbGxlZCBhbmQgZmFsc2Ugd2hlbiByZWplY3RlZC5cblx0ICogICAgICBXaGVuIHRoZSBhc3luY2hyb25vdXMgdmFsaWRhdG9ycyBhcmUgdHJpZ2dlcmVkLCBlYWNoIG9mIHRoZSB2YWxpZGF0b3JzIHdpbGwgcnVuIGluIHBhcmFsbGVsIGFuZCB0aGUgbW9kZWxcblx0ICogICAgICB2YWx1ZSB3aWxsIG9ubHkgYmUgdXBkYXRlZCBvbmNlIGFsbCB2YWxpZGF0b3JzIGhhdmUgYmVlbiBmdWxmaWxsZWQuIEFzIGxvbmcgYXMgYW4gYXN5bmNocm9ub3VzIHZhbGlkYXRvclxuXHQgKiAgICAgIGlzIHVuZnVsZmlsbGVkLCBpdHMga2V5IHdpbGwgYmUgYWRkZWQgdG8gdGhlIGNvbnRyb2xsZXJzIGAkcGVuZGluZ2AgcHJvcGVydHkuIEFsc28sIGFsbCBhc3luY2hyb25vdXMgdmFsaWRhdG9yc1xuXHQgKiAgICAgIHdpbGwgb25seSBydW4gb25jZSBhbGwgc3luY2hyb25vdXMgdmFsaWRhdG9ycyBoYXZlIHBhc3NlZC5cblx0ICpcblx0ICogUGxlYXNlIG5vdGUgdGhhdCBpZiAkaHR0cCBpcyB1c2VkIHRoZW4gaXQgaXMgaW1wb3J0YW50IHRoYXQgdGhlIHNlcnZlciByZXR1cm5zIGEgc3VjY2VzcyBIVFRQIHJlc3BvbnNlIGNvZGVcblx0ICogaW4gb3JkZXIgdG8gZnVsZmlsbCB0aGUgdmFsaWRhdGlvbiBhbmQgYSBzdGF0dXMgbGV2ZWwgb2YgYDR4eGAgaW4gb3JkZXIgdG8gcmVqZWN0IHRoZSB2YWxpZGF0aW9uLlxuXHQgKlxuXHQgKiBgYGBqc1xuXHQgKiBuZ01vZGVsLiRhc3luY1ZhbGlkYXRvcnMudW5pcXVlVXNlcm5hbWUgPSBmdW5jdGlvbihtb2RlbFZhbHVlLCB2aWV3VmFsdWUpIHtcblx0ICogICB2YXIgdmFsdWUgPSBtb2RlbFZhbHVlIHx8IHZpZXdWYWx1ZTtcblx0ICpcblx0ICogICAvLyBMb29rdXAgdXNlciBieSB1c2VybmFtZVxuXHQgKiAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvJyArIHZhbHVlKS5cblx0ICogICAgICB0aGVuKGZ1bmN0aW9uIHJlc29sdmVkKCkge1xuXHQgKiAgICAgICAgLy91c2VybmFtZSBleGlzdHMsIHRoaXMgbWVhbnMgdmFsaWRhdGlvbiBmYWlsc1xuXHQgKiAgICAgICAgcmV0dXJuICRxLnJlamVjdCgnZXhpc3RzJyk7XG5cdCAqICAgICAgfSwgZnVuY3Rpb24gcmVqZWN0ZWQoKSB7XG5cdCAqICAgICAgICAvL3VzZXJuYW1lIGRvZXMgbm90IGV4aXN0LCB0aGVyZWZvcmUgdGhpcyB2YWxpZGF0aW9uIHBhc3Nlc1xuXHQgKiAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAqICAgICAgfSk7XG5cdCAqIH07XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBAcHJvcGVydHkge0FycmF5LjxGdW5jdGlvbj59ICR2aWV3Q2hhbmdlTGlzdGVuZXJzIEFycmF5IG9mIGZ1bmN0aW9ucyB0byBleGVjdXRlIHdoZW5ldmVyIHRoZVxuXHQgKiAgICAgdmlldyB2YWx1ZSBoYXMgY2hhbmdlZC4gSXQgaXMgY2FsbGVkIHdpdGggbm8gYXJndW1lbnRzLCBhbmQgaXRzIHJldHVybiB2YWx1ZSBpcyBpZ25vcmVkLlxuXHQgKiAgICAgVGhpcyBjYW4gYmUgdXNlZCBpbiBwbGFjZSBvZiBhZGRpdGlvbmFsICR3YXRjaGVzIGFnYWluc3QgdGhlIG1vZGVsIHZhbHVlLlxuXHQgKlxuXHQgKiBAcHJvcGVydHkge09iamVjdH0gJGVycm9yIEFuIG9iamVjdCBoYXNoIHdpdGggYWxsIGZhaWxpbmcgdmFsaWRhdG9yIGlkcyBhcyBrZXlzLlxuXHQgKiBAcHJvcGVydHkge09iamVjdH0gJHBlbmRpbmcgQW4gb2JqZWN0IGhhc2ggd2l0aCBhbGwgcGVuZGluZyB2YWxpZGF0b3IgaWRzIGFzIGtleXMuXG5cdCAqXG5cdCAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gJHVudG91Y2hlZCBUcnVlIGlmIGNvbnRyb2wgaGFzIG5vdCBsb3N0IGZvY3VzIHlldC5cblx0ICogQHByb3BlcnR5IHtib29sZWFufSAkdG91Y2hlZCBUcnVlIGlmIGNvbnRyb2wgaGFzIGxvc3QgZm9jdXMuXG5cdCAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gJHByaXN0aW5lIFRydWUgaWYgdXNlciBoYXMgbm90IGludGVyYWN0ZWQgd2l0aCB0aGUgY29udHJvbCB5ZXQuXG5cdCAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gJGRpcnR5IFRydWUgaWYgdXNlciBoYXMgYWxyZWFkeSBpbnRlcmFjdGVkIHdpdGggdGhlIGNvbnRyb2wuXG5cdCAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gJHZhbGlkIFRydWUgaWYgdGhlcmUgaXMgbm8gZXJyb3IuXG5cdCAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gJGludmFsaWQgVHJ1ZSBpZiBhdCBsZWFzdCBvbmUgZXJyb3Igb24gdGhlIGNvbnRyb2wuXG5cdCAqIEBwcm9wZXJ0eSB7c3RyaW5nfSAkbmFtZSBUaGUgbmFtZSBhdHRyaWJ1dGUgb2YgdGhlIGNvbnRyb2wuXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKlxuXHQgKiBgTmdNb2RlbENvbnRyb2xsZXJgIHByb3ZpZGVzIEFQSSBmb3IgdGhlIHtAbGluayBuZ01vZGVsIGBuZ01vZGVsYH0gZGlyZWN0aXZlLlxuXHQgKiBUaGUgY29udHJvbGxlciBjb250YWlucyBzZXJ2aWNlcyBmb3IgZGF0YS1iaW5kaW5nLCB2YWxpZGF0aW9uLCBDU1MgdXBkYXRlcywgYW5kIHZhbHVlIGZvcm1hdHRpbmdcblx0ICogYW5kIHBhcnNpbmcuIEl0IHB1cnBvc2VmdWxseSBkb2VzIG5vdCBjb250YWluIGFueSBsb2dpYyB3aGljaCBkZWFscyB3aXRoIERPTSByZW5kZXJpbmcgb3Jcblx0ICogbGlzdGVuaW5nIHRvIERPTSBldmVudHMuXG5cdCAqIFN1Y2ggRE9NIHJlbGF0ZWQgbG9naWMgc2hvdWxkIGJlIHByb3ZpZGVkIGJ5IG90aGVyIGRpcmVjdGl2ZXMgd2hpY2ggbWFrZSB1c2Ugb2Zcblx0ICogYE5nTW9kZWxDb250cm9sbGVyYCBmb3IgZGF0YS1iaW5kaW5nIHRvIGNvbnRyb2wgZWxlbWVudHMuXG5cdCAqIEFuZ3VsYXIgcHJvdmlkZXMgdGhpcyBET00gbG9naWMgZm9yIG1vc3Qge0BsaW5rIGlucHV0IGBpbnB1dGB9IGVsZW1lbnRzLlxuXHQgKiBBdCB0aGUgZW5kIG9mIHRoaXMgcGFnZSB5b3UgY2FuIGZpbmQgYSB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciNjdXN0b20tY29udHJvbC1leGFtcGxlXG5cdCAqIGN1c3RvbSBjb250cm9sIGV4YW1wbGV9IHRoYXQgdXNlcyBgbmdNb2RlbENvbnRyb2xsZXJgIHRvIGJpbmQgdG8gYGNvbnRlbnRlZGl0YWJsZWAgZWxlbWVudHMuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqICMjIyBDdXN0b20gQ29udHJvbCBFeGFtcGxlXG5cdCAqIFRoaXMgZXhhbXBsZSBzaG93cyBob3cgdG8gdXNlIGBOZ01vZGVsQ29udHJvbGxlcmAgd2l0aCBhIGN1c3RvbSBjb250cm9sIHRvIGFjaGlldmVcblx0ICogZGF0YS1iaW5kaW5nLiBOb3RpY2UgaG93IGRpZmZlcmVudCBkaXJlY3RpdmVzIChgY29udGVudGVkaXRhYmxlYCwgYG5nLW1vZGVsYCwgYW5kIGByZXF1aXJlZGApXG5cdCAqIGNvbGxhYm9yYXRlIHRvZ2V0aGVyIHRvIGFjaGlldmUgdGhlIGRlc2lyZWQgcmVzdWx0LlxuXHQgKlxuXHQgKiBgY29udGVudGVkaXRhYmxlYCBpcyBhbiBIVE1MNSBhdHRyaWJ1dGUsIHdoaWNoIHRlbGxzIHRoZSBicm93c2VyIHRvIGxldCB0aGUgZWxlbWVudFxuXHQgKiBjb250ZW50cyBiZSBlZGl0ZWQgaW4gcGxhY2UgYnkgdGhlIHVzZXIuXG5cdCAqXG5cdCAqIFdlIGFyZSB1c2luZyB0aGUge0BsaW5rIG5nLnNlcnZpY2U6JHNjZSAkc2NlfSBzZXJ2aWNlIGhlcmUgYW5kIGluY2x1ZGUgdGhlIHtAbGluayBuZ1Nhbml0aXplICRzYW5pdGl6ZX1cblx0ICogbW9kdWxlIHRvIGF1dG9tYXRpY2FsbHkgcmVtb3ZlIFwiYmFkXCIgY29udGVudCBsaWtlIGlubGluZSBldmVudCBsaXN0ZW5lciAoZS5nLiBgPHNwYW4gb25jbGljaz1cIi4uLlwiPmApLlxuXHQgKiBIb3dldmVyLCBhcyB3ZSBhcmUgdXNpbmcgYCRzY2VgIHRoZSBtb2RlbCBjYW4gc3RpbGwgZGVjaWRlIHRvIHByb3ZpZGUgdW5zYWZlIGNvbnRlbnQgaWYgaXQgbWFya3Ncblx0ICogdGhhdCBjb250ZW50IHVzaW5nIHRoZSBgJHNjZWAgc2VydmljZS5cblx0ICpcblx0ICogPGV4YW1wbGUgbmFtZT1cIk5nTW9kZWxDb250cm9sbGVyXCIgbW9kdWxlPVwiY3VzdG9tQ29udHJvbFwiIGRlcHM9XCJhbmd1bGFyLXNhbml0aXplLmpzXCI+XG5cdCAgICA8ZmlsZSBuYW1lPVwic3R5bGUuY3NzXCI+XG5cdCAgICAgIFtjb250ZW50ZWRpdGFibGVdIHtcblx0ICAgICAgICBib3JkZXI6IDFweCBzb2xpZCBibGFjaztcblx0ICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcblx0ICAgICAgICBtaW4taGVpZ2h0OiAyMHB4O1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAubmctaW52YWxpZCB7XG5cdCAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmVkO1xuXHQgICAgICB9XG5cdFxuXHQgICAgPC9maWxlPlxuXHQgICAgPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuXHQgICAgICBhbmd1bGFyLm1vZHVsZSgnY3VzdG9tQ29udHJvbCcsIFsnbmdTYW5pdGl6ZSddKS5cblx0ICAgICAgICBkaXJlY3RpdmUoJ2NvbnRlbnRlZGl0YWJsZScsIFsnJHNjZScsIGZ1bmN0aW9uKCRzY2UpIHtcblx0ICAgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsIC8vIG9ubHkgYWN0aXZhdGUgb24gZWxlbWVudCBhdHRyaWJ1dGVcblx0ICAgICAgICAgICAgcmVxdWlyZTogJz9uZ01vZGVsJywgLy8gZ2V0IGEgaG9sZCBvZiBOZ01vZGVsQ29udHJvbGxlclxuXHQgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcblx0ICAgICAgICAgICAgICBpZiAoIW5nTW9kZWwpIHJldHVybjsgLy8gZG8gbm90aGluZyBpZiBubyBuZy1tb2RlbFxuXHRcblx0ICAgICAgICAgICAgICAvLyBTcGVjaWZ5IGhvdyBVSSBzaG91bGQgYmUgdXBkYXRlZFxuXHQgICAgICAgICAgICAgIG5nTW9kZWwuJHJlbmRlciA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICAgICAgZWxlbWVudC5odG1sKCRzY2UuZ2V0VHJ1c3RlZEh0bWwobmdNb2RlbC4kdmlld1ZhbHVlIHx8ICcnKSk7XG5cdCAgICAgICAgICAgICAgfTtcblx0XG5cdCAgICAgICAgICAgICAgLy8gTGlzdGVuIGZvciBjaGFuZ2UgZXZlbnRzIHRvIGVuYWJsZSBiaW5kaW5nXG5cdCAgICAgICAgICAgICAgZWxlbWVudC5vbignYmx1ciBrZXl1cCBjaGFuZ2UnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgICAgIHNjb3BlLiRldmFsQXN5bmMocmVhZCk7XG5cdCAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgcmVhZCgpOyAvLyBpbml0aWFsaXplXG5cdFxuXHQgICAgICAgICAgICAgIC8vIFdyaXRlIGRhdGEgdG8gdGhlIG1vZGVsXG5cdCAgICAgICAgICAgICAgZnVuY3Rpb24gcmVhZCgpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBodG1sID0gZWxlbWVudC5odG1sKCk7XG5cdCAgICAgICAgICAgICAgICAvLyBXaGVuIHdlIGNsZWFyIHRoZSBjb250ZW50IGVkaXRhYmxlIHRoZSBicm93c2VyIGxlYXZlcyBhIDxicj4gYmVoaW5kXG5cdCAgICAgICAgICAgICAgICAvLyBJZiBzdHJpcC1iciBhdHRyaWJ1dGUgaXMgcHJvdmlkZWQgdGhlbiB3ZSBzdHJpcCB0aGlzIG91dFxuXHQgICAgICAgICAgICAgICAgaWYgKCBhdHRycy5zdHJpcEJyICYmIGh0bWwgPT0gJzxicj4nICkge1xuXHQgICAgICAgICAgICAgICAgICBodG1sID0gJyc7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICBuZ01vZGVsLiRzZXRWaWV3VmFsdWUoaHRtbCk7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9O1xuXHQgICAgICAgIH1dKTtcblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIj5cblx0ICAgICAgIDxkaXYgY29udGVudGVkaXRhYmxlXG5cdCAgICAgICAgICAgIG5hbWU9XCJteVdpZGdldFwiIG5nLW1vZGVsPVwidXNlckNvbnRlbnRcIlxuXHQgICAgICAgICAgICBzdHJpcC1icj1cInRydWVcIlxuXHQgICAgICAgICAgICByZXF1aXJlZD5DaGFuZ2UgbWUhPC9kaXY+XG5cdCAgICAgICAgPHNwYW4gbmctc2hvdz1cIm15Rm9ybS5teVdpZGdldC4kZXJyb3IucmVxdWlyZWRcIj5SZXF1aXJlZCE8L3NwYW4+XG5cdCAgICAgICA8aHI+XG5cdCAgICAgICA8dGV4dGFyZWEgbmctbW9kZWw9XCJ1c2VyQ29udGVudFwiIGFyaWEtbGFiZWw9XCJEeW5hbWljIHRleHRhcmVhXCI+PC90ZXh0YXJlYT5cblx0ICAgICAgPC9mb3JtPlxuXHQgICAgPC9maWxlPlxuXHQgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgaXQoJ3Nob3VsZCBkYXRhLWJpbmQgYW5kIGJlY29tZSBpbnZhbGlkJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgIGlmIChicm93c2VyLnBhcmFtcy5icm93c2VyID09ICdzYWZhcmknIHx8IGJyb3dzZXIucGFyYW1zLmJyb3dzZXIgPT0gJ2ZpcmVmb3gnKSB7XG5cdCAgICAgICAgLy8gU2FmYXJpRHJpdmVyIGNhbid0IGhhbmRsZSBjb250ZW50ZWRpdGFibGVcblx0ICAgICAgICAvLyBhbmQgRmlyZWZveCBkcml2ZXIgY2FuJ3QgY2xlYXIgY29udGVudGVkaXRhYmxlcyB2ZXJ5IHdlbGxcblx0ICAgICAgICByZXR1cm47XG5cdCAgICAgIH1cblx0ICAgICAgdmFyIGNvbnRlbnRFZGl0YWJsZSA9IGVsZW1lbnQoYnkuY3NzKCdbY29udGVudGVkaXRhYmxlXScpKTtcblx0ICAgICAgdmFyIGNvbnRlbnQgPSAnQ2hhbmdlIG1lISc7XG5cdFxuXHQgICAgICBleHBlY3QoY29udGVudEVkaXRhYmxlLmdldFRleHQoKSkudG9FcXVhbChjb250ZW50KTtcblx0XG5cdCAgICAgIGNvbnRlbnRFZGl0YWJsZS5jbGVhcigpO1xuXHQgICAgICBjb250ZW50RWRpdGFibGUuc2VuZEtleXMocHJvdHJhY3Rvci5LZXkuQkFDS19TUEFDRSk7XG5cdCAgICAgIGV4cGVjdChjb250ZW50RWRpdGFibGUuZ2V0VGV4dCgpKS50b0VxdWFsKCcnKTtcblx0ICAgICAgZXhwZWN0KGNvbnRlbnRFZGl0YWJsZS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLnRvTWF0Y2goL25nLWludmFsaWQtcmVxdWlyZWQvKTtcblx0ICAgIH0pO1xuXHQgICAgPC9maWxlPlxuXHQgKiA8L2V4YW1wbGU+XG5cdCAqXG5cdCAqXG5cdCAqL1xuXHR2YXIgTmdNb2RlbENvbnRyb2xsZXIgPSBbJyRzY29wZScsICckZXhjZXB0aW9uSGFuZGxlcicsICckYXR0cnMnLCAnJGVsZW1lbnQnLCAnJHBhcnNlJywgJyRhbmltYXRlJywgJyR0aW1lb3V0JywgJyRyb290U2NvcGUnLCAnJHEnLCAnJGludGVycG9sYXRlJyxcblx0ICAgIGZ1bmN0aW9uKCRzY29wZSwgJGV4Y2VwdGlvbkhhbmRsZXIsICRhdHRyLCAkZWxlbWVudCwgJHBhcnNlLCAkYW5pbWF0ZSwgJHRpbWVvdXQsICRyb290U2NvcGUsICRxLCAkaW50ZXJwb2xhdGUpIHtcblx0ICB0aGlzLiR2aWV3VmFsdWUgPSBOdW1iZXIuTmFOO1xuXHQgIHRoaXMuJG1vZGVsVmFsdWUgPSBOdW1iZXIuTmFOO1xuXHQgIHRoaXMuJCRyYXdNb2RlbFZhbHVlID0gdW5kZWZpbmVkOyAvLyBzdG9yZXMgdGhlIHBhcnNlZCBtb2RlbFZhbHVlIC8gbW9kZWwgc2V0IGZyb20gc2NvcGUgcmVnYXJkbGVzcyBvZiB2YWxpZGl0eS5cblx0ICB0aGlzLiR2YWxpZGF0b3JzID0ge307XG5cdCAgdGhpcy4kYXN5bmNWYWxpZGF0b3JzID0ge307XG5cdCAgdGhpcy4kcGFyc2VycyA9IFtdO1xuXHQgIHRoaXMuJGZvcm1hdHRlcnMgPSBbXTtcblx0ICB0aGlzLiR2aWV3Q2hhbmdlTGlzdGVuZXJzID0gW107XG5cdCAgdGhpcy4kdW50b3VjaGVkID0gdHJ1ZTtcblx0ICB0aGlzLiR0b3VjaGVkID0gZmFsc2U7XG5cdCAgdGhpcy4kcHJpc3RpbmUgPSB0cnVlO1xuXHQgIHRoaXMuJGRpcnR5ID0gZmFsc2U7XG5cdCAgdGhpcy4kdmFsaWQgPSB0cnVlO1xuXHQgIHRoaXMuJGludmFsaWQgPSBmYWxzZTtcblx0ICB0aGlzLiRlcnJvciA9IHt9OyAvLyBrZWVwIGludmFsaWQga2V5cyBoZXJlXG5cdCAgdGhpcy4kJHN1Y2Nlc3MgPSB7fTsgLy8ga2VlcCB2YWxpZCBrZXlzIGhlcmVcblx0ICB0aGlzLiRwZW5kaW5nID0gdW5kZWZpbmVkOyAvLyBrZWVwIHBlbmRpbmcga2V5cyBoZXJlXG5cdCAgdGhpcy4kbmFtZSA9ICRpbnRlcnBvbGF0ZSgkYXR0ci5uYW1lIHx8ICcnLCBmYWxzZSkoJHNjb3BlKTtcblx0ICB0aGlzLiQkcGFyZW50Rm9ybSA9IG51bGxGb3JtQ3RybDtcblx0XG5cdCAgdmFyIHBhcnNlZE5nTW9kZWwgPSAkcGFyc2UoJGF0dHIubmdNb2RlbCksXG5cdCAgICAgIHBhcnNlZE5nTW9kZWxBc3NpZ24gPSBwYXJzZWROZ01vZGVsLmFzc2lnbixcblx0ICAgICAgbmdNb2RlbEdldCA9IHBhcnNlZE5nTW9kZWwsXG5cdCAgICAgIG5nTW9kZWxTZXQgPSBwYXJzZWROZ01vZGVsQXNzaWduLFxuXHQgICAgICBwZW5kaW5nRGVib3VuY2UgPSBudWxsLFxuXHQgICAgICBwYXJzZXJWYWxpZCxcblx0ICAgICAgY3RybCA9IHRoaXM7XG5cdFxuXHQgIHRoaXMuJCRzZXRPcHRpb25zID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHQgICAgY3RybC4kb3B0aW9ucyA9IG9wdGlvbnM7XG5cdCAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmdldHRlclNldHRlcikge1xuXHQgICAgICB2YXIgaW52b2tlTW9kZWxHZXR0ZXIgPSAkcGFyc2UoJGF0dHIubmdNb2RlbCArICcoKScpLFxuXHQgICAgICAgICAgaW52b2tlTW9kZWxTZXR0ZXIgPSAkcGFyc2UoJGF0dHIubmdNb2RlbCArICcoJCQkcCknKTtcblx0XG5cdCAgICAgIG5nTW9kZWxHZXQgPSBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICB2YXIgbW9kZWxWYWx1ZSA9IHBhcnNlZE5nTW9kZWwoJHNjb3BlKTtcblx0ICAgICAgICBpZiAoaXNGdW5jdGlvbihtb2RlbFZhbHVlKSkge1xuXHQgICAgICAgICAgbW9kZWxWYWx1ZSA9IGludm9rZU1vZGVsR2V0dGVyKCRzY29wZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiBtb2RlbFZhbHVlO1xuXHQgICAgICB9O1xuXHQgICAgICBuZ01vZGVsU2V0ID0gZnVuY3Rpb24oJHNjb3BlLCBuZXdWYWx1ZSkge1xuXHQgICAgICAgIGlmIChpc0Z1bmN0aW9uKHBhcnNlZE5nTW9kZWwoJHNjb3BlKSkpIHtcblx0ICAgICAgICAgIGludm9rZU1vZGVsU2V0dGVyKCRzY29wZSwgeyQkJHA6IGN0cmwuJG1vZGVsVmFsdWV9KTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgcGFyc2VkTmdNb2RlbEFzc2lnbigkc2NvcGUsIGN0cmwuJG1vZGVsVmFsdWUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgIH0gZWxzZSBpZiAoIXBhcnNlZE5nTW9kZWwuYXNzaWduKSB7XG5cdCAgICAgIHRocm93IG5nTW9kZWxNaW5FcnIoJ25vbmFzc2lnbicsIFwiRXhwcmVzc2lvbiAnezB9JyBpcyBub24tYXNzaWduYWJsZS4gRWxlbWVudDogezF9XCIsXG5cdCAgICAgICAgICAkYXR0ci5uZ01vZGVsLCBzdGFydGluZ1RhZygkZWxlbWVudCkpO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyRyZW5kZXJcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIENhbGxlZCB3aGVuIHRoZSB2aWV3IG5lZWRzIHRvIGJlIHVwZGF0ZWQuIEl0IGlzIGV4cGVjdGVkIHRoYXQgdGhlIHVzZXIgb2YgdGhlIG5nLW1vZGVsXG5cdCAgICogZGlyZWN0aXZlIHdpbGwgaW1wbGVtZW50IHRoaXMgbWV0aG9kLlxuXHQgICAqXG5cdCAgICogVGhlIGAkcmVuZGVyKClgIG1ldGhvZCBpcyBpbnZva2VkIGluIHRoZSBmb2xsb3dpbmcgc2l0dWF0aW9uczpcblx0ICAgKlxuXHQgICAqICogYCRyb2xsYmFja1ZpZXdWYWx1ZSgpYCBpcyBjYWxsZWQuICBJZiB3ZSBhcmUgcm9sbGluZyBiYWNrIHRoZSB2aWV3IHZhbHVlIHRvIHRoZSBsYXN0XG5cdCAgICogICBjb21taXR0ZWQgdmFsdWUgdGhlbiBgJHJlbmRlcigpYCBpcyBjYWxsZWQgdG8gdXBkYXRlIHRoZSBpbnB1dCBjb250cm9sLlxuXHQgICAqICogVGhlIHZhbHVlIHJlZmVyZW5jZWQgYnkgYG5nLW1vZGVsYCBpcyBjaGFuZ2VkIHByb2dyYW1tYXRpY2FsbHkgYW5kIGJvdGggdGhlIGAkbW9kZWxWYWx1ZWAgYW5kXG5cdCAgICogICB0aGUgYCR2aWV3VmFsdWVgIGFyZSBkaWZmZXJlbnQgZnJvbSBsYXN0IHRpbWUuXG5cdCAgICpcblx0ICAgKiBTaW5jZSBgbmctbW9kZWxgIGRvZXMgbm90IGRvIGEgZGVlcCB3YXRjaCwgYCRyZW5kZXIoKWAgaXMgb25seSBpbnZva2VkIGlmIHRoZSB2YWx1ZXMgb2Zcblx0ICAgKiBgJG1vZGVsVmFsdWVgIGFuZCBgJHZpZXdWYWx1ZWAgYXJlIGFjdHVhbGx5IGRpZmZlcmVudCBmcm9tIHRoZWlyIHByZXZpb3VzIHZhbHVlLiBJZiBgJG1vZGVsVmFsdWVgXG5cdCAgICogb3IgYCR2aWV3VmFsdWVgIGFyZSBvYmplY3RzIChyYXRoZXIgdGhhbiBhIHN0cmluZyBvciBudW1iZXIpIHRoZW4gYCRyZW5kZXIoKWAgd2lsbCBub3QgYmVcblx0ICAgKiBpbnZva2VkIGlmIHlvdSBvbmx5IGNoYW5nZSBhIHByb3BlcnR5IG9uIHRoZSBvYmplY3RzLlxuXHQgICAqL1xuXHQgIHRoaXMuJHJlbmRlciA9IG5vb3A7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyRpc0VtcHR5XG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBUaGlzIGlzIGNhbGxlZCB3aGVuIHdlIG5lZWQgdG8gZGV0ZXJtaW5lIGlmIHRoZSB2YWx1ZSBvZiBhbiBpbnB1dCBpcyBlbXB0eS5cblx0ICAgKlxuXHQgICAqIEZvciBpbnN0YW5jZSwgdGhlIHJlcXVpcmVkIGRpcmVjdGl2ZSBkb2VzIHRoaXMgdG8gd29yayBvdXQgaWYgdGhlIGlucHV0IGhhcyBkYXRhIG9yIG5vdC5cblx0ICAgKlxuXHQgICAqIFRoZSBkZWZhdWx0IGAkaXNFbXB0eWAgZnVuY3Rpb24gY2hlY2tzIHdoZXRoZXIgdGhlIHZhbHVlIGlzIGB1bmRlZmluZWRgLCBgJydgLCBgbnVsbGAgb3IgYE5hTmAuXG5cdCAgICpcblx0ICAgKiBZb3UgY2FuIG92ZXJyaWRlIHRoaXMgZm9yIGlucHV0IGRpcmVjdGl2ZXMgd2hvc2UgY29uY2VwdCBvZiBiZWluZyBlbXB0eSBpcyBkaWZmZXJlbnQgZnJvbSB0aGVcblx0ICAgKiBkZWZhdWx0LiBUaGUgYGNoZWNrYm94SW5wdXRUeXBlYCBkaXJlY3RpdmUgZG9lcyB0aGlzIGJlY2F1c2UgaW4gaXRzIGNhc2UgYSB2YWx1ZSBvZiBgZmFsc2VgXG5cdCAgICogaW1wbGllcyBlbXB0eS5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIG9mIHRoZSBpbnB1dCB0byBjaGVjayBmb3IgZW1wdGluZXNzLlxuXHQgICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGB2YWx1ZWAgaXMgXCJlbXB0eVwiLlxuXHQgICAqL1xuXHQgIHRoaXMuJGlzRW1wdHkgPSBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgcmV0dXJuIGlzVW5kZWZpbmVkKHZhbHVlKSB8fCB2YWx1ZSA9PT0gJycgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgIT09IHZhbHVlO1xuXHQgIH07XG5cdFxuXHQgIHRoaXMuJCR1cGRhdGVFbXB0eUNsYXNzZXMgPSBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgaWYgKGN0cmwuJGlzRW1wdHkodmFsdWUpKSB7XG5cdCAgICAgICRhbmltYXRlLnJlbW92ZUNsYXNzKCRlbGVtZW50LCBOT1RfRU1QVFlfQ0xBU1MpO1xuXHQgICAgICAkYW5pbWF0ZS5hZGRDbGFzcygkZWxlbWVudCwgRU1QVFlfQ0xBU1MpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoJGVsZW1lbnQsIEVNUFRZX0NMQVNTKTtcblx0ICAgICAgJGFuaW1hdGUuYWRkQ2xhc3MoJGVsZW1lbnQsIE5PVF9FTVBUWV9DTEFTUyk7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdFxuXHQgIHZhciBjdXJyZW50VmFsaWRhdGlvblJ1bklkID0gMDtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHNldFZhbGlkaXR5XG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBDaGFuZ2UgdGhlIHZhbGlkaXR5IHN0YXRlLCBhbmQgbm90aWZ5IHRoZSBmb3JtLlxuXHQgICAqXG5cdCAgICogVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCB3aXRoaW4gJHBhcnNlcnMvJGZvcm1hdHRlcnMgb3IgYSBjdXN0b20gdmFsaWRhdGlvbiBpbXBsZW1lbnRhdGlvbi5cblx0ICAgKiBIb3dldmVyLCBpbiBtb3N0IGNhc2VzIGl0IHNob3VsZCBiZSBzdWZmaWNpZW50IHRvIHVzZSB0aGUgYG5nTW9kZWwuJHZhbGlkYXRvcnNgIGFuZFxuXHQgICAqIGBuZ01vZGVsLiRhc3luY1ZhbGlkYXRvcnNgIGNvbGxlY3Rpb25zIHdoaWNoIHdpbGwgY2FsbCBgJHNldFZhbGlkaXR5YCBhdXRvbWF0aWNhbGx5LlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHZhbGlkYXRpb25FcnJvcktleSBOYW1lIG9mIHRoZSB2YWxpZGF0b3IuIFRoZSBgdmFsaWRhdGlvbkVycm9yS2V5YCB3aWxsIGJlIGFzc2lnbmVkXG5cdCAgICogICAgICAgIHRvIGVpdGhlciBgJGVycm9yW3ZhbGlkYXRpb25FcnJvcktleV1gIG9yIGAkcGVuZGluZ1t2YWxpZGF0aW9uRXJyb3JLZXldYFxuXHQgICAqICAgICAgICAoZm9yIHVuZnVsZmlsbGVkIGAkYXN5bmNWYWxpZGF0b3JzYCksIHNvIHRoYXQgaXQgaXMgYXZhaWxhYmxlIGZvciBkYXRhLWJpbmRpbmcuXG5cdCAgICogICAgICAgIFRoZSBgdmFsaWRhdGlvbkVycm9yS2V5YCBzaG91bGQgYmUgaW4gY2FtZWxDYXNlIGFuZCB3aWxsIGdldCBjb252ZXJ0ZWQgaW50byBkYXNoLWNhc2Vcblx0ICAgKiAgICAgICAgZm9yIGNsYXNzIG5hbWUuIEV4YW1wbGU6IGBteUVycm9yYCB3aWxsIHJlc3VsdCBpbiBgbmctdmFsaWQtbXktZXJyb3JgIGFuZCBgbmctaW52YWxpZC1teS1lcnJvcmBcblx0ICAgKiAgICAgICAgY2xhc3MgYW5kIGNhbiBiZSBib3VuZCB0byBhcyAgYHt7c29tZUZvcm0uc29tZUNvbnRyb2wuJGVycm9yLm15RXJyb3J9fWAgLlxuXHQgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNWYWxpZCBXaGV0aGVyIHRoZSBjdXJyZW50IHN0YXRlIGlzIHZhbGlkICh0cnVlKSwgaW52YWxpZCAoZmFsc2UpLCBwZW5kaW5nICh1bmRlZmluZWQpLFxuXHQgICAqICAgICAgICAgICAgICAgICAgICAgICAgICBvciBza2lwcGVkIChudWxsKS4gUGVuZGluZyBpcyB1c2VkIGZvciB1bmZ1bGZpbGxlZCBgJGFzeW5jVmFsaWRhdG9yc2AuXG5cdCAgICogICAgICAgICAgICAgICAgICAgICAgICAgIFNraXBwZWQgaXMgdXNlZCBieSBBbmd1bGFyIHdoZW4gdmFsaWRhdG9ycyBkbyBub3QgcnVuIGJlY2F1c2Ugb2YgcGFyc2UgZXJyb3JzIGFuZFxuXHQgICAqICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIGAkYXN5bmNWYWxpZGF0b3JzYCBkbyBub3QgcnVuIGJlY2F1c2UgYW55IG9mIHRoZSBgJHZhbGlkYXRvcnNgIGZhaWxlZC5cblx0ICAgKi9cblx0ICBhZGRTZXRWYWxpZGl0eU1ldGhvZCh7XG5cdCAgICBjdHJsOiB0aGlzLFxuXHQgICAgJGVsZW1lbnQ6ICRlbGVtZW50LFxuXHQgICAgc2V0OiBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7XG5cdCAgICAgIG9iamVjdFtwcm9wZXJ0eV0gPSB0cnVlO1xuXHQgICAgfSxcblx0ICAgIHVuc2V0OiBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7XG5cdCAgICAgIGRlbGV0ZSBvYmplY3RbcHJvcGVydHldO1xuXHQgICAgfSxcblx0ICAgICRhbmltYXRlOiAkYW5pbWF0ZVxuXHQgIH0pO1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkc2V0UHJpc3RpbmVcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFNldHMgdGhlIGNvbnRyb2wgdG8gaXRzIHByaXN0aW5lIHN0YXRlLlxuXHQgICAqXG5cdCAgICogVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byByZW1vdmUgdGhlIGBuZy1kaXJ0eWAgY2xhc3MgYW5kIHNldCB0aGUgY29udHJvbCB0byBpdHMgcHJpc3RpbmVcblx0ICAgKiBzdGF0ZSAoYG5nLXByaXN0aW5lYCBjbGFzcykuIEEgbW9kZWwgaXMgY29uc2lkZXJlZCB0byBiZSBwcmlzdGluZSB3aGVuIHRoZSBjb250cm9sXG5cdCAgICogaGFzIG5vdCBiZWVuIGNoYW5nZWQgZnJvbSB3aGVuIGZpcnN0IGNvbXBpbGVkLlxuXHQgICAqL1xuXHQgIHRoaXMuJHNldFByaXN0aW5lID0gZnVuY3Rpb24oKSB7XG5cdCAgICBjdHJsLiRkaXJ0eSA9IGZhbHNlO1xuXHQgICAgY3RybC4kcHJpc3RpbmUgPSB0cnVlO1xuXHQgICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoJGVsZW1lbnQsIERJUlRZX0NMQVNTKTtcblx0ICAgICRhbmltYXRlLmFkZENsYXNzKCRlbGVtZW50LCBQUklTVElORV9DTEFTUyk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHNldERpcnR5XG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBTZXRzIHRoZSBjb250cm9sIHRvIGl0cyBkaXJ0eSBzdGF0ZS5cblx0ICAgKlxuXHQgICAqIFRoaXMgbWV0aG9kIGNhbiBiZSBjYWxsZWQgdG8gcmVtb3ZlIHRoZSBgbmctcHJpc3RpbmVgIGNsYXNzIGFuZCBzZXQgdGhlIGNvbnRyb2wgdG8gaXRzIGRpcnR5XG5cdCAgICogc3RhdGUgKGBuZy1kaXJ0eWAgY2xhc3MpLiBBIG1vZGVsIGlzIGNvbnNpZGVyZWQgdG8gYmUgZGlydHkgd2hlbiB0aGUgY29udHJvbCBoYXMgYmVlbiBjaGFuZ2VkXG5cdCAgICogZnJvbSB3aGVuIGZpcnN0IGNvbXBpbGVkLlxuXHQgICAqL1xuXHQgIHRoaXMuJHNldERpcnR5ID0gZnVuY3Rpb24oKSB7XG5cdCAgICBjdHJsLiRkaXJ0eSA9IHRydWU7XG5cdCAgICBjdHJsLiRwcmlzdGluZSA9IGZhbHNlO1xuXHQgICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoJGVsZW1lbnQsIFBSSVNUSU5FX0NMQVNTKTtcblx0ICAgICRhbmltYXRlLmFkZENsYXNzKCRlbGVtZW50LCBESVJUWV9DTEFTUyk7XG5cdCAgICBjdHJsLiQkcGFyZW50Rm9ybS4kc2V0RGlydHkoKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkc2V0VW50b3VjaGVkXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBTZXRzIHRoZSBjb250cm9sIHRvIGl0cyB1bnRvdWNoZWQgc3RhdGUuXG5cdCAgICpcblx0ICAgKiBUaGlzIG1ldGhvZCBjYW4gYmUgY2FsbGVkIHRvIHJlbW92ZSB0aGUgYG5nLXRvdWNoZWRgIGNsYXNzIGFuZCBzZXQgdGhlIGNvbnRyb2wgdG8gaXRzXG5cdCAgICogdW50b3VjaGVkIHN0YXRlIChgbmctdW50b3VjaGVkYCBjbGFzcykuIFVwb24gY29tcGlsYXRpb24sIGEgbW9kZWwgaXMgc2V0IGFzIHVudG91Y2hlZFxuXHQgICAqIGJ5IGRlZmF1bHQsIGhvd2V2ZXIgdGhpcyBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byByZXN0b3JlIHRoYXQgc3RhdGUgaWYgdGhlIG1vZGVsIGhhc1xuXHQgICAqIGFscmVhZHkgYmVlbiB0b3VjaGVkIGJ5IHRoZSB1c2VyLlxuXHQgICAqL1xuXHQgIHRoaXMuJHNldFVudG91Y2hlZCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgY3RybC4kdG91Y2hlZCA9IGZhbHNlO1xuXHQgICAgY3RybC4kdW50b3VjaGVkID0gdHJ1ZTtcblx0ICAgICRhbmltYXRlLnNldENsYXNzKCRlbGVtZW50LCBVTlRPVUNIRURfQ0xBU1MsIFRPVUNIRURfQ0xBU1MpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyRzZXRUb3VjaGVkXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBTZXRzIHRoZSBjb250cm9sIHRvIGl0cyB0b3VjaGVkIHN0YXRlLlxuXHQgICAqXG5cdCAgICogVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byByZW1vdmUgdGhlIGBuZy11bnRvdWNoZWRgIGNsYXNzIGFuZCBzZXQgdGhlIGNvbnRyb2wgdG8gaXRzXG5cdCAgICogdG91Y2hlZCBzdGF0ZSAoYG5nLXRvdWNoZWRgIGNsYXNzKS4gQSBtb2RlbCBpcyBjb25zaWRlcmVkIHRvIGJlIHRvdWNoZWQgd2hlbiB0aGUgdXNlciBoYXNcblx0ICAgKiBmaXJzdCBmb2N1c2VkIHRoZSBjb250cm9sIGVsZW1lbnQgYW5kIHRoZW4gc2hpZnRlZCBmb2N1cyBhd2F5IGZyb20gdGhlIGNvbnRyb2wgKGJsdXIgZXZlbnQpLlxuXHQgICAqL1xuXHQgIHRoaXMuJHNldFRvdWNoZWQgPSBmdW5jdGlvbigpIHtcblx0ICAgIGN0cmwuJHRvdWNoZWQgPSB0cnVlO1xuXHQgICAgY3RybC4kdW50b3VjaGVkID0gZmFsc2U7XG5cdCAgICAkYW5pbWF0ZS5zZXRDbGFzcygkZWxlbWVudCwgVE9VQ0hFRF9DTEFTUywgVU5UT1VDSEVEX0NMQVNTKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBAbmdkb2MgbWV0aG9kXG5cdCAgICogQG5hbWUgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkcm9sbGJhY2tWaWV3VmFsdWVcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIENhbmNlbCBhbiB1cGRhdGUgYW5kIHJlc2V0IHRoZSBpbnB1dCBlbGVtZW50J3MgdmFsdWUgdG8gcHJldmVudCBhbiB1cGRhdGUgdG8gdGhlIGAkbW9kZWxWYWx1ZWAsXG5cdCAgICogd2hpY2ggbWF5IGJlIGNhdXNlZCBieSBhIHBlbmRpbmcgZGVib3VuY2VkIGV2ZW50IG9yIGJlY2F1c2UgdGhlIGlucHV0IGlzIHdhaXRpbmcgZm9yIGEgc29tZVxuXHQgICAqIGZ1dHVyZSBldmVudC5cblx0ICAgKlxuXHQgICAqIElmIHlvdSBoYXZlIGFuIGlucHV0IHRoYXQgdXNlcyBgbmctbW9kZWwtb3B0aW9uc2AgdG8gc2V0IHVwIGRlYm91bmNlZCB1cGRhdGVzIG9yIHVwZGF0ZXMgdGhhdFxuXHQgICAqIGRlcGVuZCBvbiBzcGVjaWFsIGV2ZW50cyBzdWNoIGFzIGJsdXIsIHlvdSBjYW4gaGF2ZSBhIHNpdHVhdGlvbiB3aGVyZSB0aGVyZSBpcyBhIHBlcmlvZCB3aGVuXG5cdCAgICogdGhlIGAkdmlld1ZhbHVlYCBpcyBvdXQgb2Ygc3luYyB3aXRoIHRoZSBuZ01vZGVsJ3MgYCRtb2RlbFZhbHVlYC5cblx0ICAgKlxuXHQgICAqIEluIHRoaXMgY2FzZSwgeW91IGNhbiB1c2UgYCRyb2xsYmFja1ZpZXdWYWx1ZSgpYCB0byBtYW51YWxseSBjYW5jZWwgdGhlIGRlYm91bmNlZCAvIGZ1dHVyZSB1cGRhdGVcblx0ICAgKiBhbmQgcmVzZXQgdGhlIGlucHV0IHRvIHRoZSBsYXN0IGNvbW1pdHRlZCB2aWV3IHZhbHVlLlxuXHQgICAqXG5cdCAgICogSXQgaXMgYWxzbyBwb3NzaWJsZSB0aGF0IHlvdSBydW4gaW50byBkaWZmaWN1bHRpZXMgaWYgeW91IHRyeSB0byB1cGRhdGUgdGhlIG5nTW9kZWwncyBgJG1vZGVsVmFsdWVgXG5cdCAgICogcHJvZ3JhbW1hdGljYWxseSBiZWZvcmUgdGhlc2UgZGVib3VuY2VkL2Z1dHVyZSBldmVudHMgaGF2ZSByZXNvbHZlZC9vY2N1cnJlZCwgYmVjYXVzZSBBbmd1bGFyJ3Ncblx0ICAgKiBkaXJ0eSBjaGVja2luZyBtZWNoYW5pc20gaXMgbm90IGFibGUgdG8gdGVsbCB3aGV0aGVyIHRoZSBtb2RlbCBoYXMgYWN0dWFsbHkgY2hhbmdlZCBvciBub3QuXG5cdCAgICpcblx0ICAgKiBUaGUgYCRyb2xsYmFja1ZpZXdWYWx1ZSgpYCBtZXRob2Qgc2hvdWxkIGJlIGNhbGxlZCBiZWZvcmUgcHJvZ3JhbW1hdGljYWxseSBjaGFuZ2luZyB0aGUgbW9kZWwgb2YgYW5cblx0ICAgKiBpbnB1dCB3aGljaCBtYXkgaGF2ZSBzdWNoIGV2ZW50cyBwZW5kaW5nLiBUaGlzIGlzIGltcG9ydGFudCBpbiBvcmRlciB0byBtYWtlIHN1cmUgdGhhdCB0aGVcblx0ICAgKiBpbnB1dCBmaWVsZCB3aWxsIGJlIHVwZGF0ZWQgd2l0aCB0aGUgbmV3IG1vZGVsIHZhbHVlIGFuZCBhbnkgcGVuZGluZyBvcGVyYXRpb25zIGFyZSBjYW5jZWxsZWQuXG5cdCAgICpcblx0ICAgKiA8ZXhhbXBsZSBuYW1lPVwibmctbW9kZWwtY2FuY2VsLXVwZGF0ZVwiIG1vZHVsZT1cImNhbmNlbC11cGRhdGUtZXhhbXBsZVwiPlxuXHQgICAqICAgPGZpbGUgbmFtZT1cImFwcC5qc1wiPlxuXHQgICAqICAgICBhbmd1bGFyLm1vZHVsZSgnY2FuY2VsLXVwZGF0ZS1leGFtcGxlJywgW10pXG5cdCAgICpcblx0ICAgKiAgICAgLmNvbnRyb2xsZXIoJ0NhbmNlbFVwZGF0ZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAqICAgICAgICRzY29wZS5tb2RlbCA9IHt9O1xuXHQgICAqXG5cdCAgICogICAgICAgJHNjb3BlLnNldEVtcHR5ID0gZnVuY3Rpb24oZSwgdmFsdWUsIHJvbGxiYWNrKSB7XG5cdCAgICogICAgICAgICBpZiAoZS5rZXlDb2RlID09IDI3KSB7XG5cdCAgICogICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0ICAgKiAgICAgICAgICAgaWYgKHJvbGxiYWNrKSB7XG5cdCAgICogICAgICAgICAgICAgJHNjb3BlLm15Rm9ybVt2YWx1ZV0uJHJvbGxiYWNrVmlld1ZhbHVlKCk7XG5cdCAgICogICAgICAgICAgIH1cblx0ICAgKiAgICAgICAgICAgJHNjb3BlLm1vZGVsW3ZhbHVlXSA9ICcnO1xuXHQgICAqICAgICAgICAgfVxuXHQgICAqICAgICAgIH07XG5cdCAgICogICAgIH1dKTtcblx0ICAgKiAgIDwvZmlsZT5cblx0ICAgKiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICogICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkNhbmNlbFVwZGF0ZUNvbnRyb2xsZXJcIj5cblx0ICAgKiAgICAgICAgPHA+Qm90aCBvZiB0aGVzZSBpbnB1dHMgYXJlIG9ubHkgdXBkYXRlZCBpZiB0aGV5IGFyZSBibHVycmVkLiBIaXR0aW5nIGVzY2FwZSBzaG91bGRcblx0ICAgKiAgICAgICAgZW1wdHkgdGhlbS4gRm9sbG93IHRoZXNlIHN0ZXBzIGFuZCBvYnNlcnZlIHRoZSBkaWZmZXJlbmNlOjwvcD5cblx0ICAgKiAgICAgICA8b2w+XG5cdCAgICogICAgICAgICA8bGk+VHlwZSBzb21ldGhpbmcgaW4gdGhlIGlucHV0LiBZb3Ugd2lsbCBzZWUgdGhhdCB0aGUgbW9kZWwgaXMgbm90IHlldCB1cGRhdGVkPC9saT5cblx0ICAgKiAgICAgICAgIDxsaT5QcmVzcyB0aGUgRXNjYXBlIGtleS5cblx0ICAgKiAgICAgICAgICAgPG9sPlxuXHQgICAqICAgICAgICAgICAgIDxsaT4gSW4gdGhlIGZpcnN0IGV4YW1wbGUsIG5vdGhpbmcgaGFwcGVucywgYmVjYXVzZSB0aGUgbW9kZWwgaXMgYWxyZWFkeSAnJywgYW5kIG5vXG5cdCAgICogICAgICAgICAgICAgdXBkYXRlIGlzIGRldGVjdGVkLiBJZiB5b3UgYmx1ciB0aGUgaW5wdXQsIHRoZSBtb2RlbCB3aWxsIGJlIHNldCB0byB0aGUgY3VycmVudCB2aWV3LlxuXHQgICAqICAgICAgICAgICAgIDwvbGk+XG5cdCAgICogICAgICAgICAgICAgPGxpPiBJbiB0aGUgc2Vjb25kIGV4YW1wbGUsIHRoZSBwZW5kaW5nIHVwZGF0ZSBpcyBjYW5jZWxsZWQsIGFuZCB0aGUgaW5wdXQgaXMgc2V0IGJhY2tcblx0ICAgKiAgICAgICAgICAgICB0byB0aGUgbGFzdCBjb21taXR0ZWQgdmlldyB2YWx1ZSAoJycpLiBCbHVycmluZyB0aGUgaW5wdXQgZG9lcyBub3RoaW5nLlxuXHQgICAqICAgICAgICAgICAgIDwvbGk+XG5cdCAgICogICAgICAgICAgIDwvb2w+XG5cdCAgICogICAgICAgICA8L2xpPlxuXHQgICAqICAgICAgIDwvb2w+XG5cdCAgICpcblx0ICAgKiAgICAgICA8Zm9ybSBuYW1lPVwibXlGb3JtXCIgbmctbW9kZWwtb3B0aW9ucz1cInsgdXBkYXRlT246ICdibHVyJyB9XCI+XG5cdCAgICogICAgICAgICA8ZGl2PlxuXHQgICAqICAgICAgICA8cCBpZD1cImlucHV0RGVzY3JpcHRpb24xXCI+V2l0aG91dCAkcm9sbGJhY2tWaWV3VmFsdWUoKTo8L3A+XG5cdCAgICogICAgICAgICA8aW5wdXQgbmFtZT1cInZhbHVlMVwiIGFyaWEtZGVzY3JpYmVkYnk9XCJpbnB1dERlc2NyaXB0aW9uMVwiIG5nLW1vZGVsPVwibW9kZWwudmFsdWUxXCJcblx0ICAgKiAgICAgICAgICAgICAgICBuZy1rZXlkb3duPVwic2V0RW1wdHkoJGV2ZW50LCAndmFsdWUxJylcIj5cblx0ICAgKiAgICAgICAgIHZhbHVlMTogXCJ7eyBtb2RlbC52YWx1ZTEgfX1cIlxuXHQgICAqICAgICAgICAgPC9kaXY+XG5cdCAgICpcblx0ICAgKiAgICAgICAgIDxkaXY+XG5cdCAgICogICAgICAgIDxwIGlkPVwiaW5wdXREZXNjcmlwdGlvbjJcIj5XaXRoICRyb2xsYmFja1ZpZXdWYWx1ZSgpOjwvcD5cblx0ICAgKiAgICAgICAgIDxpbnB1dCBuYW1lPVwidmFsdWUyXCIgYXJpYS1kZXNjcmliZWRieT1cImlucHV0RGVzY3JpcHRpb24yXCIgbmctbW9kZWw9XCJtb2RlbC52YWx1ZTJcIlxuXHQgICAqICAgICAgICAgICAgICAgIG5nLWtleWRvd249XCJzZXRFbXB0eSgkZXZlbnQsICd2YWx1ZTInLCB0cnVlKVwiPlxuXHQgICAqICAgICAgICAgdmFsdWUyOiBcInt7IG1vZGVsLnZhbHVlMiB9fVwiXG5cdCAgICogICAgICAgICA8L2Rpdj5cblx0ICAgKiAgICAgICA8L2Zvcm0+XG5cdCAgICogICAgIDwvZGl2PlxuXHQgICAqICAgPC9maWxlPlxuXHQgICAgICAgPGZpbGUgbmFtZT1cInN0eWxlLmNzc1wiPlxuXHQgICAgICAgICAgZGl2IHtcblx0ICAgICAgICAgICAgZGlzcGxheTogdGFibGUtY2VsbDtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGRpdjpudGgtY2hpbGQoMSkge1xuXHQgICAgICAgICAgICBwYWRkaW5nLXJpZ2h0OiAzMHB4O1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICA8L2ZpbGU+XG5cdCAgICogPC9leGFtcGxlPlxuXHQgICAqL1xuXHQgIHRoaXMuJHJvbGxiYWNrVmlld1ZhbHVlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAkdGltZW91dC5jYW5jZWwocGVuZGluZ0RlYm91bmNlKTtcblx0ICAgIGN0cmwuJHZpZXdWYWx1ZSA9IGN0cmwuJCRsYXN0Q29tbWl0dGVkVmlld1ZhbHVlO1xuXHQgICAgY3RybC4kcmVuZGVyKCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQG5nZG9jIG1ldGhvZFxuXHQgICAqIEBuYW1lIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHZhbGlkYXRlXG5cdCAgICpcblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiBSdW5zIGVhY2ggb2YgdGhlIHJlZ2lzdGVyZWQgdmFsaWRhdG9ycyAoZmlyc3Qgc3luY2hyb25vdXMgdmFsaWRhdG9ycyBhbmQgdGhlblxuXHQgICAqIGFzeW5jaHJvbm91cyB2YWxpZGF0b3JzKS5cblx0ICAgKiBJZiB0aGUgdmFsaWRpdHkgY2hhbmdlcyB0byBpbnZhbGlkLCB0aGUgbW9kZWwgd2lsbCBiZSBzZXQgdG8gYHVuZGVmaW5lZGAsXG5cdCAgICogdW5sZXNzIHtAbGluayBuZ01vZGVsT3B0aW9ucyBgbmdNb2RlbE9wdGlvbnMuYWxsb3dJbnZhbGlkYH0gaXMgYHRydWVgLlxuXHQgICAqIElmIHRoZSB2YWxpZGl0eSBjaGFuZ2VzIHRvIHZhbGlkLCBpdCB3aWxsIHNldCB0aGUgbW9kZWwgdG8gdGhlIGxhc3QgYXZhaWxhYmxlIHZhbGlkXG5cdCAgICogYCRtb2RlbFZhbHVlYCwgaS5lLiBlaXRoZXIgdGhlIGxhc3QgcGFyc2VkIHZhbHVlIG9yIHRoZSBsYXN0IHZhbHVlIHNldCBmcm9tIHRoZSBzY29wZS5cblx0ICAgKi9cblx0ICB0aGlzLiR2YWxpZGF0ZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgLy8gaWdub3JlICR2YWxpZGF0ZSBiZWZvcmUgbW9kZWwgaXMgaW5pdGlhbGl6ZWRcblx0ICAgIGlmIChpc051bWJlcihjdHJsLiRtb2RlbFZhbHVlKSAmJiBpc05hTihjdHJsLiRtb2RlbFZhbHVlKSkge1xuXHQgICAgICByZXR1cm47XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIHZpZXdWYWx1ZSA9IGN0cmwuJCRsYXN0Q29tbWl0dGVkVmlld1ZhbHVlO1xuXHQgICAgLy8gTm90ZTogd2UgdXNlIHRoZSAkJHJhd01vZGVsVmFsdWUgYXMgJG1vZGVsVmFsdWUgbWlnaHQgaGF2ZSBiZWVuXG5cdCAgICAvLyBzZXQgdG8gdW5kZWZpbmVkIGR1cmluZyBhIHZpZXcgLT4gbW9kZWwgdXBkYXRlIHRoYXQgZm91bmQgdmFsaWRhdGlvblxuXHQgICAgLy8gZXJyb3JzLiBXZSBjYW4ndCBwYXJzZSB0aGUgdmlldyBoZXJlLCBzaW5jZSB0aGF0IGNvdWxkIGNoYW5nZVxuXHQgICAgLy8gdGhlIG1vZGVsIGFsdGhvdWdoIG5laXRoZXIgdmlld1ZhbHVlIG5vciB0aGUgbW9kZWwgb24gdGhlIHNjb3BlIGNoYW5nZWRcblx0ICAgIHZhciBtb2RlbFZhbHVlID0gY3RybC4kJHJhd01vZGVsVmFsdWU7XG5cdFxuXHQgICAgdmFyIHByZXZWYWxpZCA9IGN0cmwuJHZhbGlkO1xuXHQgICAgdmFyIHByZXZNb2RlbFZhbHVlID0gY3RybC4kbW9kZWxWYWx1ZTtcblx0XG5cdCAgICB2YXIgYWxsb3dJbnZhbGlkID0gY3RybC4kb3B0aW9ucyAmJiBjdHJsLiRvcHRpb25zLmFsbG93SW52YWxpZDtcblx0XG5cdCAgICBjdHJsLiQkcnVuVmFsaWRhdG9ycyhtb2RlbFZhbHVlLCB2aWV3VmFsdWUsIGZ1bmN0aW9uKGFsbFZhbGlkKSB7XG5cdCAgICAgIC8vIElmIHRoZXJlIHdhcyBubyBjaGFuZ2UgaW4gdmFsaWRpdHksIGRvbid0IHVwZGF0ZSB0aGUgbW9kZWxcblx0ICAgICAgLy8gVGhpcyBwcmV2ZW50cyBjaGFuZ2luZyBhbiBpbnZhbGlkIG1vZGVsVmFsdWUgdG8gdW5kZWZpbmVkXG5cdCAgICAgIGlmICghYWxsb3dJbnZhbGlkICYmIHByZXZWYWxpZCAhPT0gYWxsVmFsaWQpIHtcblx0ICAgICAgICAvLyBOb3RlOiBEb24ndCBjaGVjayBjdHJsLiR2YWxpZCBoZXJlLCBhcyB3ZSBjb3VsZCBoYXZlXG5cdCAgICAgICAgLy8gZXh0ZXJuYWwgdmFsaWRhdG9ycyAoZS5nLiBjYWxjdWxhdGVkIG9uIHRoZSBzZXJ2ZXIpLFxuXHQgICAgICAgIC8vIHRoYXQganVzdCBjYWxsICRzZXRWYWxpZGl0eSBhbmQgbmVlZCB0aGUgbW9kZWwgdmFsdWVcblx0ICAgICAgICAvLyB0byBjYWxjdWxhdGUgdGhlaXIgdmFsaWRpdHkuXG5cdCAgICAgICAgY3RybC4kbW9kZWxWYWx1ZSA9IGFsbFZhbGlkID8gbW9kZWxWYWx1ZSA6IHVuZGVmaW5lZDtcblx0XG5cdCAgICAgICAgaWYgKGN0cmwuJG1vZGVsVmFsdWUgIT09IHByZXZNb2RlbFZhbHVlKSB7XG5cdCAgICAgICAgICBjdHJsLiQkd3JpdGVNb2RlbFRvU2NvcGUoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH0pO1xuXHRcblx0ICB9O1xuXHRcblx0ICB0aGlzLiQkcnVuVmFsaWRhdG9ycyA9IGZ1bmN0aW9uKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSwgZG9uZUNhbGxiYWNrKSB7XG5cdCAgICBjdXJyZW50VmFsaWRhdGlvblJ1bklkKys7XG5cdCAgICB2YXIgbG9jYWxWYWxpZGF0aW9uUnVuSWQgPSBjdXJyZW50VmFsaWRhdGlvblJ1bklkO1xuXHRcblx0ICAgIC8vIGNoZWNrIHBhcnNlciBlcnJvclxuXHQgICAgaWYgKCFwcm9jZXNzUGFyc2VFcnJvcnMoKSkge1xuXHQgICAgICB2YWxpZGF0aW9uRG9uZShmYWxzZSk7XG5cdCAgICAgIHJldHVybjtcblx0ICAgIH1cblx0ICAgIGlmICghcHJvY2Vzc1N5bmNWYWxpZGF0b3JzKCkpIHtcblx0ICAgICAgdmFsaWRhdGlvbkRvbmUoZmFsc2UpO1xuXHQgICAgICByZXR1cm47XG5cdCAgICB9XG5cdCAgICBwcm9jZXNzQXN5bmNWYWxpZGF0b3JzKCk7XG5cdFxuXHQgICAgZnVuY3Rpb24gcHJvY2Vzc1BhcnNlRXJyb3JzKCkge1xuXHQgICAgICB2YXIgZXJyb3JLZXkgPSBjdHJsLiQkcGFyc2VyTmFtZSB8fCAncGFyc2UnO1xuXHQgICAgICBpZiAoaXNVbmRlZmluZWQocGFyc2VyVmFsaWQpKSB7XG5cdCAgICAgICAgc2V0VmFsaWRpdHkoZXJyb3JLZXksIG51bGwpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGlmICghcGFyc2VyVmFsaWQpIHtcblx0ICAgICAgICAgIGZvckVhY2goY3RybC4kdmFsaWRhdG9ycywgZnVuY3Rpb24odiwgbmFtZSkge1xuXHQgICAgICAgICAgICBzZXRWYWxpZGl0eShuYW1lLCBudWxsKTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgZm9yRWFjaChjdHJsLiRhc3luY1ZhbGlkYXRvcnMsIGZ1bmN0aW9uKHYsIG5hbWUpIHtcblx0ICAgICAgICAgICAgc2V0VmFsaWRpdHkobmFtZSwgbnVsbCk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgLy8gU2V0IHRoZSBwYXJzZSBlcnJvciBsYXN0LCB0byBwcmV2ZW50IHVuc2V0dGluZyBpdCwgc2hvdWxkIGEgJHZhbGlkYXRvcnMga2V5ID09IHBhcnNlck5hbWVcblx0ICAgICAgICBzZXRWYWxpZGl0eShlcnJvcktleSwgcGFyc2VyVmFsaWQpO1xuXHQgICAgICAgIHJldHVybiBwYXJzZXJWYWxpZDtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBwcm9jZXNzU3luY1ZhbGlkYXRvcnMoKSB7XG5cdCAgICAgIHZhciBzeW5jVmFsaWRhdG9yc1ZhbGlkID0gdHJ1ZTtcblx0ICAgICAgZm9yRWFjaChjdHJsLiR2YWxpZGF0b3JzLCBmdW5jdGlvbih2YWxpZGF0b3IsIG5hbWUpIHtcblx0ICAgICAgICB2YXIgcmVzdWx0ID0gdmFsaWRhdG9yKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSk7XG5cdCAgICAgICAgc3luY1ZhbGlkYXRvcnNWYWxpZCA9IHN5bmNWYWxpZGF0b3JzVmFsaWQgJiYgcmVzdWx0O1xuXHQgICAgICAgIHNldFZhbGlkaXR5KG5hbWUsIHJlc3VsdCk7XG5cdCAgICAgIH0pO1xuXHQgICAgICBpZiAoIXN5bmNWYWxpZGF0b3JzVmFsaWQpIHtcblx0ICAgICAgICBmb3JFYWNoKGN0cmwuJGFzeW5jVmFsaWRhdG9ycywgZnVuY3Rpb24odiwgbmFtZSkge1xuXHQgICAgICAgICAgc2V0VmFsaWRpdHkobmFtZSwgbnVsbCk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHByb2Nlc3NBc3luY1ZhbGlkYXRvcnMoKSB7XG5cdCAgICAgIHZhciB2YWxpZGF0b3JQcm9taXNlcyA9IFtdO1xuXHQgICAgICB2YXIgYWxsVmFsaWQgPSB0cnVlO1xuXHQgICAgICBmb3JFYWNoKGN0cmwuJGFzeW5jVmFsaWRhdG9ycywgZnVuY3Rpb24odmFsaWRhdG9yLCBuYW1lKSB7XG5cdCAgICAgICAgdmFyIHByb21pc2UgPSB2YWxpZGF0b3IobW9kZWxWYWx1ZSwgdmlld1ZhbHVlKTtcblx0ICAgICAgICBpZiAoIWlzUHJvbWlzZUxpa2UocHJvbWlzZSkpIHtcblx0ICAgICAgICAgIHRocm93IG5nTW9kZWxNaW5FcnIoJ25vcHJvbWlzZScsXG5cdCAgICAgICAgICAgIFwiRXhwZWN0ZWQgYXN5bmNocm9ub3VzIHZhbGlkYXRvciB0byByZXR1cm4gYSBwcm9taXNlIGJ1dCBnb3QgJ3swfScgaW5zdGVhZC5cIiwgcHJvbWlzZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHNldFZhbGlkaXR5KG5hbWUsIHVuZGVmaW5lZCk7XG5cdCAgICAgICAgdmFsaWRhdG9yUHJvbWlzZXMucHVzaChwcm9taXNlLnRoZW4oZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBzZXRWYWxpZGl0eShuYW1lLCB0cnVlKTtcblx0ICAgICAgICB9LCBmdW5jdGlvbihlcnJvcikge1xuXHQgICAgICAgICAgYWxsVmFsaWQgPSBmYWxzZTtcblx0ICAgICAgICAgIHNldFZhbGlkaXR5KG5hbWUsIGZhbHNlKTtcblx0ICAgICAgICB9KSk7XG5cdCAgICAgIH0pO1xuXHQgICAgICBpZiAoIXZhbGlkYXRvclByb21pc2VzLmxlbmd0aCkge1xuXHQgICAgICAgIHZhbGlkYXRpb25Eb25lKHRydWUpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICRxLmFsbCh2YWxpZGF0b3JQcm9taXNlcykudGhlbihmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHZhbGlkYXRpb25Eb25lKGFsbFZhbGlkKTtcblx0ICAgICAgICB9LCBub29wKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHNldFZhbGlkaXR5KG5hbWUsIGlzVmFsaWQpIHtcblx0ICAgICAgaWYgKGxvY2FsVmFsaWRhdGlvblJ1bklkID09PSBjdXJyZW50VmFsaWRhdGlvblJ1bklkKSB7XG5cdCAgICAgICAgY3RybC4kc2V0VmFsaWRpdHkobmFtZSwgaXNWYWxpZCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiB2YWxpZGF0aW9uRG9uZShhbGxWYWxpZCkge1xuXHQgICAgICBpZiAobG9jYWxWYWxpZGF0aW9uUnVuSWQgPT09IGN1cnJlbnRWYWxpZGF0aW9uUnVuSWQpIHtcblx0XG5cdCAgICAgICAgZG9uZUNhbGxiYWNrKGFsbFZhbGlkKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyRjb21taXRWaWV3VmFsdWVcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIENvbW1pdCBhIHBlbmRpbmcgdXBkYXRlIHRvIHRoZSBgJG1vZGVsVmFsdWVgLlxuXHQgICAqXG5cdCAgICogVXBkYXRlcyBtYXkgYmUgcGVuZGluZyBieSBhIGRlYm91bmNlZCBldmVudCBvciBiZWNhdXNlIHRoZSBpbnB1dCBpcyB3YWl0aW5nIGZvciBhIHNvbWUgZnV0dXJlXG5cdCAgICogZXZlbnQgZGVmaW5lZCBpbiBgbmctbW9kZWwtb3B0aW9uc2AuIHRoaXMgbWV0aG9kIGlzIHJhcmVseSBuZWVkZWQgYXMgYE5nTW9kZWxDb250cm9sbGVyYFxuXHQgICAqIHVzdWFsbHkgaGFuZGxlcyBjYWxsaW5nIHRoaXMgaW4gcmVzcG9uc2UgdG8gaW5wdXQgZXZlbnRzLlxuXHQgICAqL1xuXHQgIHRoaXMuJGNvbW1pdFZpZXdWYWx1ZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIHZpZXdWYWx1ZSA9IGN0cmwuJHZpZXdWYWx1ZTtcblx0XG5cdCAgICAkdGltZW91dC5jYW5jZWwocGVuZGluZ0RlYm91bmNlKTtcblx0XG5cdCAgICAvLyBJZiB0aGUgdmlldyB2YWx1ZSBoYXMgbm90IGNoYW5nZWQgdGhlbiB3ZSBzaG91bGQganVzdCBleGl0LCBleGNlcHQgaW4gdGhlIGNhc2Ugd2hlcmUgdGhlcmUgaXNcblx0ICAgIC8vIGEgbmF0aXZlIHZhbGlkYXRvciBvbiB0aGUgZWxlbWVudC4gSW4gdGhpcyBjYXNlIHRoZSB2YWxpZGF0aW9uIHN0YXRlIG1heSBoYXZlIGNoYW5nZWQgZXZlbiB0aG91Z2hcblx0ICAgIC8vIHRoZSB2aWV3VmFsdWUgaGFzIHN0YXllZCBlbXB0eS5cblx0ICAgIGlmIChjdHJsLiQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZSA9PT0gdmlld1ZhbHVlICYmICh2aWV3VmFsdWUgIT09ICcnIHx8ICFjdHJsLiQkaGFzTmF0aXZlVmFsaWRhdG9ycykpIHtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHQgICAgY3RybC4kJHVwZGF0ZUVtcHR5Q2xhc3Nlcyh2aWV3VmFsdWUpO1xuXHQgICAgY3RybC4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUgPSB2aWV3VmFsdWU7XG5cdFxuXHQgICAgLy8gY2hhbmdlIHRvIGRpcnR5XG5cdCAgICBpZiAoY3RybC4kcHJpc3RpbmUpIHtcblx0ICAgICAgdGhpcy4kc2V0RGlydHkoKTtcblx0ICAgIH1cblx0ICAgIHRoaXMuJCRwYXJzZUFuZFZhbGlkYXRlKCk7XG5cdCAgfTtcblx0XG5cdCAgdGhpcy4kJHBhcnNlQW5kVmFsaWRhdGUgPSBmdW5jdGlvbigpIHtcblx0ICAgIHZhciB2aWV3VmFsdWUgPSBjdHJsLiQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZTtcblx0ICAgIHZhciBtb2RlbFZhbHVlID0gdmlld1ZhbHVlO1xuXHQgICAgcGFyc2VyVmFsaWQgPSBpc1VuZGVmaW5lZChtb2RlbFZhbHVlKSA/IHVuZGVmaW5lZCA6IHRydWU7XG5cdFxuXHQgICAgaWYgKHBhcnNlclZhbGlkKSB7XG5cdCAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY3RybC4kcGFyc2Vycy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIG1vZGVsVmFsdWUgPSBjdHJsLiRwYXJzZXJzW2ldKG1vZGVsVmFsdWUpO1xuXHQgICAgICAgIGlmIChpc1VuZGVmaW5lZChtb2RlbFZhbHVlKSkge1xuXHQgICAgICAgICAgcGFyc2VyVmFsaWQgPSBmYWxzZTtcblx0ICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgaWYgKGlzTnVtYmVyKGN0cmwuJG1vZGVsVmFsdWUpICYmIGlzTmFOKGN0cmwuJG1vZGVsVmFsdWUpKSB7XG5cdCAgICAgIC8vIGN0cmwuJG1vZGVsVmFsdWUgaGFzIG5vdCBiZWVuIHRvdWNoZWQgeWV0Li4uXG5cdCAgICAgIGN0cmwuJG1vZGVsVmFsdWUgPSBuZ01vZGVsR2V0KCRzY29wZSk7XG5cdCAgICB9XG5cdCAgICB2YXIgcHJldk1vZGVsVmFsdWUgPSBjdHJsLiRtb2RlbFZhbHVlO1xuXHQgICAgdmFyIGFsbG93SW52YWxpZCA9IGN0cmwuJG9wdGlvbnMgJiYgY3RybC4kb3B0aW9ucy5hbGxvd0ludmFsaWQ7XG5cdCAgICBjdHJsLiQkcmF3TW9kZWxWYWx1ZSA9IG1vZGVsVmFsdWU7XG5cdFxuXHQgICAgaWYgKGFsbG93SW52YWxpZCkge1xuXHQgICAgICBjdHJsLiRtb2RlbFZhbHVlID0gbW9kZWxWYWx1ZTtcblx0ICAgICAgd3JpdGVUb01vZGVsSWZOZWVkZWQoKTtcblx0ICAgIH1cblx0XG5cdCAgICAvLyBQYXNzIHRoZSAkJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUgaGVyZSwgYmVjYXVzZSB0aGUgY2FjaGVkIHZpZXdWYWx1ZSBtaWdodCBiZSBvdXQgb2YgZGF0ZS5cblx0ICAgIC8vIFRoaXMgY2FuIGhhcHBlbiBpZiBlLmcuICRzZXRWaWV3VmFsdWUgaXMgY2FsbGVkIGZyb20gaW5zaWRlIGEgcGFyc2VyXG5cdCAgICBjdHJsLiQkcnVuVmFsaWRhdG9ycyhtb2RlbFZhbHVlLCBjdHJsLiQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZSwgZnVuY3Rpb24oYWxsVmFsaWQpIHtcblx0ICAgICAgaWYgKCFhbGxvd0ludmFsaWQpIHtcblx0ICAgICAgICAvLyBOb3RlOiBEb24ndCBjaGVjayBjdHJsLiR2YWxpZCBoZXJlLCBhcyB3ZSBjb3VsZCBoYXZlXG5cdCAgICAgICAgLy8gZXh0ZXJuYWwgdmFsaWRhdG9ycyAoZS5nLiBjYWxjdWxhdGVkIG9uIHRoZSBzZXJ2ZXIpLFxuXHQgICAgICAgIC8vIHRoYXQganVzdCBjYWxsICRzZXRWYWxpZGl0eSBhbmQgbmVlZCB0aGUgbW9kZWwgdmFsdWVcblx0ICAgICAgICAvLyB0byBjYWxjdWxhdGUgdGhlaXIgdmFsaWRpdHkuXG5cdCAgICAgICAgY3RybC4kbW9kZWxWYWx1ZSA9IGFsbFZhbGlkID8gbW9kZWxWYWx1ZSA6IHVuZGVmaW5lZDtcblx0ICAgICAgICB3cml0ZVRvTW9kZWxJZk5lZWRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9KTtcblx0XG5cdCAgICBmdW5jdGlvbiB3cml0ZVRvTW9kZWxJZk5lZWRlZCgpIHtcblx0ICAgICAgaWYgKGN0cmwuJG1vZGVsVmFsdWUgIT09IHByZXZNb2RlbFZhbHVlKSB7XG5cdCAgICAgICAgY3RybC4kJHdyaXRlTW9kZWxUb1Njb3BlKCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICB0aGlzLiQkd3JpdGVNb2RlbFRvU2NvcGUgPSBmdW5jdGlvbigpIHtcblx0ICAgIG5nTW9kZWxTZXQoJHNjb3BlLCBjdHJsLiRtb2RlbFZhbHVlKTtcblx0ICAgIGZvckVhY2goY3RybC4kdmlld0NoYW5nZUxpc3RlbmVycywgZnVuY3Rpb24obGlzdGVuZXIpIHtcblx0ICAgICAgdHJ5IHtcblx0ICAgICAgICBsaXN0ZW5lcigpO1xuXHQgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG5cdCAgICAgIH1cblx0ICAgIH0pO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEBuZ2RvYyBtZXRob2Rcblx0ICAgKiBAbmFtZSBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyRzZXRWaWV3VmFsdWVcblx0ICAgKlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqIFVwZGF0ZSB0aGUgdmlldyB2YWx1ZS5cblx0ICAgKlxuXHQgICAqIFRoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhIGNvbnRyb2wgd2FudHMgdG8gY2hhbmdlIHRoZSB2aWV3IHZhbHVlOyB0eXBpY2FsbHksXG5cdCAgICogdGhpcyBpcyBkb25lIGZyb20gd2l0aGluIGEgRE9NIGV2ZW50IGhhbmRsZXIuIEZvciBleGFtcGxlLCB0aGUge0BsaW5rIG5nLmRpcmVjdGl2ZTppbnB1dCBpbnB1dH1cblx0ICAgKiBkaXJlY3RpdmUgY2FsbHMgaXQgd2hlbiB0aGUgdmFsdWUgb2YgdGhlIGlucHV0IGNoYW5nZXMgYW5kIHtAbGluayBuZy5kaXJlY3RpdmU6c2VsZWN0IHNlbGVjdH1cblx0ICAgKiBjYWxscyBpdCB3aGVuIGFuIG9wdGlvbiBpcyBzZWxlY3RlZC5cblx0ICAgKlxuXHQgICAqIFdoZW4gYCRzZXRWaWV3VmFsdWVgIGlzIGNhbGxlZCwgdGhlIG5ldyBgdmFsdWVgIHdpbGwgYmUgc3RhZ2VkIGZvciBjb21taXR0aW5nIHRocm91Z2ggdGhlIGAkcGFyc2Vyc2Bcblx0ICAgKiBhbmQgYCR2YWxpZGF0b3JzYCBwaXBlbGluZXMuIElmIHRoZXJlIGFyZSBubyBzcGVjaWFsIHtAbGluayBuZ01vZGVsT3B0aW9uc30gc3BlY2lmaWVkIHRoZW4gdGhlIHN0YWdlZFxuXHQgICAqIHZhbHVlIHNlbnQgZGlyZWN0bHkgZm9yIHByb2Nlc3NpbmcsIGZpbmFsbHkgdG8gYmUgYXBwbGllZCB0byBgJG1vZGVsVmFsdWVgIGFuZCB0aGVuIHRoZVxuXHQgICAqICoqZXhwcmVzc2lvbioqIHNwZWNpZmllZCBpbiB0aGUgYG5nLW1vZGVsYCBhdHRyaWJ1dGUuIExhc3RseSwgYWxsIHRoZSByZWdpc3RlcmVkIGNoYW5nZSBsaXN0ZW5lcnMsXG5cdCAgICogaW4gdGhlIGAkdmlld0NoYW5nZUxpc3RlbmVyc2AgbGlzdCwgYXJlIGNhbGxlZC5cblx0ICAgKlxuXHQgICAqIEluIGNhc2UgdGhlIHtAbGluayBuZy5kaXJlY3RpdmU6bmdNb2RlbE9wdGlvbnMgbmdNb2RlbE9wdGlvbnN9IGRpcmVjdGl2ZSBpcyB1c2VkIHdpdGggYHVwZGF0ZU9uYFxuXHQgICAqIGFuZCB0aGUgYGRlZmF1bHRgIHRyaWdnZXIgaXMgbm90IGxpc3RlZCwgYWxsIHRob3NlIGFjdGlvbnMgd2lsbCByZW1haW4gcGVuZGluZyB1bnRpbCBvbmUgb2YgdGhlXG5cdCAgICogYHVwZGF0ZU9uYCBldmVudHMgaXMgdHJpZ2dlcmVkIG9uIHRoZSBET00gZWxlbWVudC5cblx0ICAgKiBBbGwgdGhlc2UgYWN0aW9ucyB3aWxsIGJlIGRlYm91bmNlZCBpZiB0aGUge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ01vZGVsT3B0aW9ucyBuZ01vZGVsT3B0aW9uc31cblx0ICAgKiBkaXJlY3RpdmUgaXMgdXNlZCB3aXRoIGEgY3VzdG9tIGRlYm91bmNlIGZvciB0aGlzIHBhcnRpY3VsYXIgZXZlbnQuXG5cdCAgICogTm90ZSB0aGF0IGEgYCRkaWdlc3RgIGlzIG9ubHkgdHJpZ2dlcmVkIG9uY2UgdGhlIGB1cGRhdGVPbmAgZXZlbnRzIGFyZSBmaXJlZCwgb3IgaWYgYGRlYm91bmNlYFxuXHQgICAqIGlzIHNwZWNpZmllZCwgb25jZSB0aGUgdGltZXIgcnVucyBvdXQuXG5cdCAgICpcblx0ICAgKiBXaGVuIHVzZWQgd2l0aCBzdGFuZGFyZCBpbnB1dHMsIHRoZSB2aWV3IHZhbHVlIHdpbGwgYWx3YXlzIGJlIGEgc3RyaW5nICh3aGljaCBpcyBpbiBzb21lIGNhc2VzXG5cdCAgICogcGFyc2VkIGludG8gYW5vdGhlciB0eXBlLCBzdWNoIGFzIGEgYERhdGVgIG9iamVjdCBmb3IgYGlucHV0W2RhdGVdYC4pXG5cdCAgICogSG93ZXZlciwgY3VzdG9tIGNvbnRyb2xzIG1pZ2h0IGFsc28gcGFzcyBvYmplY3RzIHRvIHRoaXMgbWV0aG9kLiBJbiB0aGlzIGNhc2UsIHdlIHNob3VsZCBtYWtlXG5cdCAgICogYSBjb3B5IG9mIHRoZSBvYmplY3QgYmVmb3JlIHBhc3NpbmcgaXQgdG8gYCRzZXRWaWV3VmFsdWVgLiBUaGlzIGlzIGJlY2F1c2UgYG5nTW9kZWxgIGRvZXMgbm90XG5cdCAgICogcGVyZm9ybSBhIGRlZXAgd2F0Y2ggb2Ygb2JqZWN0cywgaXQgb25seSBsb29rcyBmb3IgYSBjaGFuZ2Ugb2YgaWRlbnRpdHkuIElmIHlvdSBvbmx5IGNoYW5nZVxuXHQgICAqIHRoZSBwcm9wZXJ0eSBvZiB0aGUgb2JqZWN0IHRoZW4gbmdNb2RlbCB3aWxsIG5vdCByZWFsaXplIHRoYXQgdGhlIG9iamVjdCBoYXMgY2hhbmdlZCBhbmRcblx0ICAgKiB3aWxsIG5vdCBpbnZva2UgdGhlIGAkcGFyc2Vyc2AgYW5kIGAkdmFsaWRhdG9yc2AgcGlwZWxpbmVzLiBGb3IgdGhpcyByZWFzb24sIHlvdSBzaG91bGRcblx0ICAgKiBub3QgY2hhbmdlIHByb3BlcnRpZXMgb2YgdGhlIGNvcHkgb25jZSBpdCBoYXMgYmVlbiBwYXNzZWQgdG8gYCRzZXRWaWV3VmFsdWVgLlxuXHQgICAqIE90aGVyd2lzZSB5b3UgbWF5IGNhdXNlIHRoZSBtb2RlbCB2YWx1ZSBvbiB0aGUgc2NvcGUgdG8gY2hhbmdlIGluY29ycmVjdGx5LlxuXHQgICAqXG5cdCAgICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWluZm9cIj5cblx0ICAgKiBJbiBhbnkgY2FzZSwgdGhlIHZhbHVlIHBhc3NlZCB0byB0aGUgbWV0aG9kIHNob3VsZCBhbHdheXMgcmVmbGVjdCB0aGUgY3VycmVudCB2YWx1ZVxuXHQgICAqIG9mIHRoZSBjb250cm9sLiBGb3IgZXhhbXBsZSwgaWYgeW91IGFyZSBjYWxsaW5nIGAkc2V0Vmlld1ZhbHVlYCBmb3IgYW4gaW5wdXQgZWxlbWVudCxcblx0ICAgKiB5b3Ugc2hvdWxkIHBhc3MgdGhlIGlucHV0IERPTSB2YWx1ZS4gT3RoZXJ3aXNlLCB0aGUgY29udHJvbCBhbmQgdGhlIHNjb3BlIG1vZGVsIGJlY29tZVxuXHQgICAqIG91dCBvZiBzeW5jLiBJdCdzIGFsc28gaW1wb3J0YW50IHRvIG5vdGUgdGhhdCBgJHNldFZpZXdWYWx1ZWAgZG9lcyBub3QgY2FsbCBgJHJlbmRlcmAgb3IgY2hhbmdlXG5cdCAgICogdGhlIGNvbnRyb2wncyBET00gdmFsdWUgaW4gYW55IHdheS4gSWYgd2Ugd2FudCB0byBjaGFuZ2UgdGhlIGNvbnRyb2wncyBET00gdmFsdWVcblx0ICAgKiBwcm9ncmFtbWF0aWNhbGx5LCB3ZSBzaG91bGQgdXBkYXRlIHRoZSBgbmdNb2RlbGAgc2NvcGUgZXhwcmVzc2lvbi4gSXRzIG5ldyB2YWx1ZSB3aWxsIGJlXG5cdCAgICogcGlja2VkIHVwIGJ5IHRoZSBtb2RlbCBjb250cm9sbGVyLCB3aGljaCB3aWxsIHJ1biBpdCB0aHJvdWdoIHRoZSBgJGZvcm1hdHRlcnNgLCBgJHJlbmRlcmAgaXRcblx0ICAgKiB0byB1cGRhdGUgdGhlIERPTSwgYW5kIGZpbmFsbHkgY2FsbCBgJHZhbGlkYXRlYCBvbiBpdC5cblx0ICAgKiA8L2Rpdj5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7Kn0gdmFsdWUgdmFsdWUgZnJvbSB0aGUgdmlldy5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdHJpZ2dlciBFdmVudCB0aGF0IHRyaWdnZXJlZCB0aGUgdXBkYXRlLlxuXHQgICAqL1xuXHQgIHRoaXMuJHNldFZpZXdWYWx1ZSA9IGZ1bmN0aW9uKHZhbHVlLCB0cmlnZ2VyKSB7XG5cdCAgICBjdHJsLiR2aWV3VmFsdWUgPSB2YWx1ZTtcblx0ICAgIGlmICghY3RybC4kb3B0aW9ucyB8fCBjdHJsLiRvcHRpb25zLnVwZGF0ZU9uRGVmYXVsdCkge1xuXHQgICAgICBjdHJsLiQkZGVib3VuY2VWaWV3VmFsdWVDb21taXQodHJpZ2dlcik7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgdGhpcy4kJGRlYm91bmNlVmlld1ZhbHVlQ29tbWl0ID0gZnVuY3Rpb24odHJpZ2dlcikge1xuXHQgICAgdmFyIGRlYm91bmNlRGVsYXkgPSAwLFxuXHQgICAgICAgIG9wdGlvbnMgPSBjdHJsLiRvcHRpb25zLFxuXHQgICAgICAgIGRlYm91bmNlO1xuXHRcblx0ICAgIGlmIChvcHRpb25zICYmIGlzRGVmaW5lZChvcHRpb25zLmRlYm91bmNlKSkge1xuXHQgICAgICBkZWJvdW5jZSA9IG9wdGlvbnMuZGVib3VuY2U7XG5cdCAgICAgIGlmIChpc051bWJlcihkZWJvdW5jZSkpIHtcblx0ICAgICAgICBkZWJvdW5jZURlbGF5ID0gZGVib3VuY2U7XG5cdCAgICAgIH0gZWxzZSBpZiAoaXNOdW1iZXIoZGVib3VuY2VbdHJpZ2dlcl0pKSB7XG5cdCAgICAgICAgZGVib3VuY2VEZWxheSA9IGRlYm91bmNlW3RyaWdnZXJdO1xuXHQgICAgICB9IGVsc2UgaWYgKGlzTnVtYmVyKGRlYm91bmNlWydkZWZhdWx0J10pKSB7XG5cdCAgICAgICAgZGVib3VuY2VEZWxheSA9IGRlYm91bmNlWydkZWZhdWx0J107XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICAkdGltZW91dC5jYW5jZWwocGVuZGluZ0RlYm91bmNlKTtcblx0ICAgIGlmIChkZWJvdW5jZURlbGF5KSB7XG5cdCAgICAgIHBlbmRpbmdEZWJvdW5jZSA9ICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGN0cmwuJGNvbW1pdFZpZXdWYWx1ZSgpO1xuXHQgICAgICB9LCBkZWJvdW5jZURlbGF5KTtcblx0ICAgIH0gZWxzZSBpZiAoJHJvb3RTY29wZS4kJHBoYXNlKSB7XG5cdCAgICAgIGN0cmwuJGNvbW1pdFZpZXdWYWx1ZSgpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcblx0ICAgICAgICBjdHJsLiRjb21taXRWaWV3VmFsdWUoKTtcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLy8gbW9kZWwgLT4gdmFsdWVcblx0ICAvLyBOb3RlOiB3ZSBjYW5ub3QgdXNlIGEgbm9ybWFsIHNjb3BlLiR3YXRjaCBhcyB3ZSB3YW50IHRvIGRldGVjdCB0aGUgZm9sbG93aW5nOlxuXHQgIC8vIDEuIHNjb3BlIHZhbHVlIGlzICdhJ1xuXHQgIC8vIDIuIHVzZXIgZW50ZXJzICdiJ1xuXHQgIC8vIDMuIG5nLWNoYW5nZSBraWNrcyBpbiBhbmQgcmV2ZXJ0cyBzY29wZSB2YWx1ZSB0byAnYSdcblx0ICAvLyAgICAtPiBzY29wZSB2YWx1ZSBkaWQgbm90IGNoYW5nZSBzaW5jZSB0aGUgbGFzdCBkaWdlc3QgYXNcblx0ICAvLyAgICAgICBuZy1jaGFuZ2UgZXhlY3V0ZXMgaW4gYXBwbHkgcGhhc2Vcblx0ICAvLyA0LiB2aWV3IHNob3VsZCBiZSBjaGFuZ2VkIGJhY2sgdG8gJ2EnXG5cdCAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbiBuZ01vZGVsV2F0Y2goKSB7XG5cdCAgICB2YXIgbW9kZWxWYWx1ZSA9IG5nTW9kZWxHZXQoJHNjb3BlKTtcblx0XG5cdCAgICAvLyBpZiBzY29wZSBtb2RlbCB2YWx1ZSBhbmQgbmdNb2RlbCB2YWx1ZSBhcmUgb3V0IG9mIHN5bmNcblx0ICAgIC8vIFRPRE8ocGVyZik6IHdoeSBub3QgbW92ZSB0aGlzIHRvIHRoZSBhY3Rpb24gZm4/XG5cdCAgICBpZiAobW9kZWxWYWx1ZSAhPT0gY3RybC4kbW9kZWxWYWx1ZSAmJlxuXHQgICAgICAgLy8gY2hlY2tzIGZvciBOYU4gaXMgbmVlZGVkIHRvIGFsbG93IHNldHRpbmcgdGhlIG1vZGVsIHRvIE5hTiB3aGVuIHRoZXJlJ3MgYW4gYXN5bmNWYWxpZGF0b3Jcblx0ICAgICAgIChjdHJsLiRtb2RlbFZhbHVlID09PSBjdHJsLiRtb2RlbFZhbHVlIHx8IG1vZGVsVmFsdWUgPT09IG1vZGVsVmFsdWUpXG5cdCAgICApIHtcblx0ICAgICAgY3RybC4kbW9kZWxWYWx1ZSA9IGN0cmwuJCRyYXdNb2RlbFZhbHVlID0gbW9kZWxWYWx1ZTtcblx0ICAgICAgcGFyc2VyVmFsaWQgPSB1bmRlZmluZWQ7XG5cdFxuXHQgICAgICB2YXIgZm9ybWF0dGVycyA9IGN0cmwuJGZvcm1hdHRlcnMsXG5cdCAgICAgICAgICBpZHggPSBmb3JtYXR0ZXJzLmxlbmd0aDtcblx0XG5cdCAgICAgIHZhciB2aWV3VmFsdWUgPSBtb2RlbFZhbHVlO1xuXHQgICAgICB3aGlsZSAoaWR4LS0pIHtcblx0ICAgICAgICB2aWV3VmFsdWUgPSBmb3JtYXR0ZXJzW2lkeF0odmlld1ZhbHVlKTtcblx0ICAgICAgfVxuXHQgICAgICBpZiAoY3RybC4kdmlld1ZhbHVlICE9PSB2aWV3VmFsdWUpIHtcblx0ICAgICAgICBjdHJsLiQkdXBkYXRlRW1wdHlDbGFzc2VzKHZpZXdWYWx1ZSk7XG5cdCAgICAgICAgY3RybC4kdmlld1ZhbHVlID0gY3RybC4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUgPSB2aWV3VmFsdWU7XG5cdCAgICAgICAgY3RybC4kcmVuZGVyKCk7XG5cdFxuXHQgICAgICAgIGN0cmwuJCRydW5WYWxpZGF0b3JzKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSwgbm9vcCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gbW9kZWxWYWx1ZTtcblx0ICB9KTtcblx0fV07XG5cdFxuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdNb2RlbFxuXHQgKlxuXHQgKiBAZWxlbWVudCBpbnB1dFxuXHQgKiBAcHJpb3JpdHkgMVxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogVGhlIGBuZ01vZGVsYCBkaXJlY3RpdmUgYmluZHMgYW4gYGlucHV0YCxgc2VsZWN0YCwgYHRleHRhcmVhYCAob3IgY3VzdG9tIGZvcm0gY29udHJvbCkgdG8gYVxuXHQgKiBwcm9wZXJ0eSBvbiB0aGUgc2NvcGUgdXNpbmcge0BsaW5rIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIgTmdNb2RlbENvbnRyb2xsZXJ9LFxuXHQgKiB3aGljaCBpcyBjcmVhdGVkIGFuZCBleHBvc2VkIGJ5IHRoaXMgZGlyZWN0aXZlLlxuXHQgKlxuXHQgKiBgbmdNb2RlbGAgaXMgcmVzcG9uc2libGUgZm9yOlxuXHQgKlxuXHQgKiAtIEJpbmRpbmcgdGhlIHZpZXcgaW50byB0aGUgbW9kZWwsIHdoaWNoIG90aGVyIGRpcmVjdGl2ZXMgc3VjaCBhcyBgaW5wdXRgLCBgdGV4dGFyZWFgIG9yIGBzZWxlY3RgXG5cdCAqICAgcmVxdWlyZS5cblx0ICogLSBQcm92aWRpbmcgdmFsaWRhdGlvbiBiZWhhdmlvciAoaS5lLiByZXF1aXJlZCwgbnVtYmVyLCBlbWFpbCwgdXJsKS5cblx0ICogLSBLZWVwaW5nIHRoZSBzdGF0ZSBvZiB0aGUgY29udHJvbCAodmFsaWQvaW52YWxpZCwgZGlydHkvcHJpc3RpbmUsIHRvdWNoZWQvdW50b3VjaGVkLCB2YWxpZGF0aW9uIGVycm9ycykuXG5cdCAqIC0gU2V0dGluZyByZWxhdGVkIGNzcyBjbGFzc2VzIG9uIHRoZSBlbGVtZW50IChgbmctdmFsaWRgLCBgbmctaW52YWxpZGAsIGBuZy1kaXJ0eWAsIGBuZy1wcmlzdGluZWAsIGBuZy10b3VjaGVkYCxcblx0ICogICBgbmctdW50b3VjaGVkYCwgYG5nLWVtcHR5YCwgYG5nLW5vdC1lbXB0eWApIGluY2x1ZGluZyBhbmltYXRpb25zLlxuXHQgKiAtIFJlZ2lzdGVyaW5nIHRoZSBjb250cm9sIHdpdGggaXRzIHBhcmVudCB7QGxpbmsgbmcuZGlyZWN0aXZlOmZvcm0gZm9ybX0uXG5cdCAqXG5cdCAqIE5vdGU6IGBuZ01vZGVsYCB3aWxsIHRyeSB0byBiaW5kIHRvIHRoZSBwcm9wZXJ0eSBnaXZlbiBieSBldmFsdWF0aW5nIHRoZSBleHByZXNzaW9uIG9uIHRoZVxuXHQgKiBjdXJyZW50IHNjb3BlLiBJZiB0aGUgcHJvcGVydHkgZG9lc24ndCBhbHJlYWR5IGV4aXN0IG9uIHRoaXMgc2NvcGUsIGl0IHdpbGwgYmUgY3JlYXRlZFxuXHQgKiBpbXBsaWNpdGx5IGFuZCBhZGRlZCB0byB0aGUgc2NvcGUuXG5cdCAqXG5cdCAqIEZvciBiZXN0IHByYWN0aWNlcyBvbiB1c2luZyBgbmdNb2RlbGAsIHNlZTpcblx0ICpcblx0ICogIC0gW1VuZGVyc3RhbmRpbmcgU2NvcGVzXShodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL3dpa2kvVW5kZXJzdGFuZGluZy1TY29wZXMpXG5cdCAqXG5cdCAqIEZvciBiYXNpYyBleGFtcGxlcywgaG93IHRvIHVzZSBgbmdNb2RlbGAsIHNlZTpcblx0ICpcblx0ICogIC0ge0BsaW5rIG5nLmRpcmVjdGl2ZTppbnB1dCBpbnB1dH1cblx0ICogICAgLSB7QGxpbmsgaW5wdXRbdGV4dF0gdGV4dH1cblx0ICogICAgLSB7QGxpbmsgaW5wdXRbY2hlY2tib3hdIGNoZWNrYm94fVxuXHQgKiAgICAtIHtAbGluayBpbnB1dFtyYWRpb10gcmFkaW99XG5cdCAqICAgIC0ge0BsaW5rIGlucHV0W251bWJlcl0gbnVtYmVyfVxuXHQgKiAgICAtIHtAbGluayBpbnB1dFtlbWFpbF0gZW1haWx9XG5cdCAqICAgIC0ge0BsaW5rIGlucHV0W3VybF0gdXJsfVxuXHQgKiAgICAtIHtAbGluayBpbnB1dFtkYXRlXSBkYXRlfVxuXHQgKiAgICAtIHtAbGluayBpbnB1dFtkYXRldGltZS1sb2NhbF0gZGF0ZXRpbWUtbG9jYWx9XG5cdCAqICAgIC0ge0BsaW5rIGlucHV0W3RpbWVdIHRpbWV9XG5cdCAqICAgIC0ge0BsaW5rIGlucHV0W21vbnRoXSBtb250aH1cblx0ICogICAgLSB7QGxpbmsgaW5wdXRbd2Vla10gd2Vla31cblx0ICogIC0ge0BsaW5rIG5nLmRpcmVjdGl2ZTpzZWxlY3Qgc2VsZWN0fVxuXHQgKiAgLSB7QGxpbmsgbmcuZGlyZWN0aXZlOnRleHRhcmVhIHRleHRhcmVhfVxuXHQgKlxuXHQgKiAjIENvbXBsZXggTW9kZWxzIChvYmplY3RzIG9yIGNvbGxlY3Rpb25zKVxuXHQgKlxuXHQgKiBCeSBkZWZhdWx0LCBgbmdNb2RlbGAgd2F0Y2hlcyB0aGUgbW9kZWwgYnkgcmVmZXJlbmNlLCBub3QgdmFsdWUuIFRoaXMgaXMgaW1wb3J0YW50IHRvIGtub3cgd2hlblxuXHQgKiBiaW5kaW5nIGlucHV0cyB0byBtb2RlbHMgdGhhdCBhcmUgb2JqZWN0cyAoZS5nLiBgRGF0ZWApIG9yIGNvbGxlY3Rpb25zIChlLmcuIGFycmF5cykuIElmIG9ubHkgcHJvcGVydGllcyBvZiB0aGVcblx0ICogb2JqZWN0IG9yIGNvbGxlY3Rpb24gY2hhbmdlLCBgbmdNb2RlbGAgd2lsbCBub3QgYmUgbm90aWZpZWQgYW5kIHNvIHRoZSBpbnB1dCB3aWxsIG5vdCBiZSAgcmUtcmVuZGVyZWQuXG5cdCAqXG5cdCAqIFRoZSBtb2RlbCBtdXN0IGJlIGFzc2lnbmVkIGFuIGVudGlyZWx5IG5ldyBvYmplY3Qgb3IgY29sbGVjdGlvbiBiZWZvcmUgYSByZS1yZW5kZXJpbmcgd2lsbCBvY2N1ci5cblx0ICpcblx0ICogU29tZSBkaXJlY3RpdmVzIGhhdmUgb3B0aW9ucyB0aGF0IHdpbGwgY2F1c2UgdGhlbSB0byB1c2UgYSBjdXN0b20gYCR3YXRjaENvbGxlY3Rpb25gIG9uIHRoZSBtb2RlbCBleHByZXNzaW9uXG5cdCAqIC0gZm9yIGV4YW1wbGUsIGBuZ09wdGlvbnNgIHdpbGwgZG8gc28gd2hlbiBhIGB0cmFjayBieWAgY2xhdXNlIGlzIGluY2x1ZGVkIGluIHRoZSBjb21wcmVoZW5zaW9uIGV4cHJlc3Npb24gb3Jcblx0ICogaWYgdGhlIHNlbGVjdCBpcyBnaXZlbiB0aGUgYG11bHRpcGxlYCBhdHRyaWJ1dGUuXG5cdCAqXG5cdCAqIFRoZSBgJHdhdGNoQ29sbGVjdGlvbigpYCBtZXRob2Qgb25seSBkb2VzIGEgc2hhbGxvdyBjb21wYXJpc29uLCBtZWFuaW5nIHRoYXQgY2hhbmdpbmcgcHJvcGVydGllcyBkZWVwZXIgdGhhbiB0aGVcblx0ICogZmlyc3QgbGV2ZWwgb2YgdGhlIG9iamVjdCAob3Igb25seSBjaGFuZ2luZyB0aGUgcHJvcGVydGllcyBvZiBhbiBpdGVtIGluIHRoZSBjb2xsZWN0aW9uIGlmIGl0J3MgYW4gYXJyYXkpIHdpbGwgc3RpbGxcblx0ICogbm90IHRyaWdnZXIgYSByZS1yZW5kZXJpbmcgb2YgdGhlIG1vZGVsLlxuXHQgKlxuXHQgKiAjIENTUyBjbGFzc2VzXG5cdCAqIFRoZSBmb2xsb3dpbmcgQ1NTIGNsYXNzZXMgYXJlIGFkZGVkIGFuZCByZW1vdmVkIG9uIHRoZSBhc3NvY2lhdGVkIGlucHV0L3NlbGVjdC90ZXh0YXJlYSBlbGVtZW50XG5cdCAqIGRlcGVuZGluZyBvbiB0aGUgdmFsaWRpdHkgb2YgdGhlIG1vZGVsLlxuXHQgKlxuXHQgKiAgLSBgbmctdmFsaWRgOiB0aGUgbW9kZWwgaXMgdmFsaWRcblx0ICogIC0gYG5nLWludmFsaWRgOiB0aGUgbW9kZWwgaXMgaW52YWxpZFxuXHQgKiAgLSBgbmctdmFsaWQtW2tleV1gOiBmb3IgZWFjaCB2YWxpZCBrZXkgYWRkZWQgYnkgYCRzZXRWYWxpZGl0eWBcblx0ICogIC0gYG5nLWludmFsaWQtW2tleV1gOiBmb3IgZWFjaCBpbnZhbGlkIGtleSBhZGRlZCBieSBgJHNldFZhbGlkaXR5YFxuXHQgKiAgLSBgbmctcHJpc3RpbmVgOiB0aGUgY29udHJvbCBoYXNuJ3QgYmVlbiBpbnRlcmFjdGVkIHdpdGggeWV0XG5cdCAqICAtIGBuZy1kaXJ0eWA6IHRoZSBjb250cm9sIGhhcyBiZWVuIGludGVyYWN0ZWQgd2l0aFxuXHQgKiAgLSBgbmctdG91Y2hlZGA6IHRoZSBjb250cm9sIGhhcyBiZWVuIGJsdXJyZWRcblx0ICogIC0gYG5nLXVudG91Y2hlZGA6IHRoZSBjb250cm9sIGhhc24ndCBiZWVuIGJsdXJyZWRcblx0ICogIC0gYG5nLXBlbmRpbmdgOiBhbnkgYCRhc3luY1ZhbGlkYXRvcnNgIGFyZSB1bmZ1bGZpbGxlZFxuXHQgKiAgLSBgbmctZW1wdHlgOiB0aGUgdmlldyBkb2VzIG5vdCBjb250YWluIGEgdmFsdWUgb3IgdGhlIHZhbHVlIGlzIGRlZW1lZCBcImVtcHR5XCIsIGFzIGRlZmluZWRcblx0ICogICAgIGJ5IHRoZSB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkaXNFbXB0eX0gbWV0aG9kXG5cdCAqICAtIGBuZy1ub3QtZW1wdHlgOiB0aGUgdmlldyBjb250YWlucyBhIG5vbi1lbXB0eSB2YWx1ZVxuXHQgKlxuXHQgKiBLZWVwIGluIG1pbmQgdGhhdCBuZ0FuaW1hdGUgY2FuIGRldGVjdCBlYWNoIG9mIHRoZXNlIGNsYXNzZXMgd2hlbiBhZGRlZCBhbmQgcmVtb3ZlZC5cblx0ICpcblx0ICogIyMgQW5pbWF0aW9uIEhvb2tzXG5cdCAqXG5cdCAqIEFuaW1hdGlvbnMgd2l0aGluIG1vZGVscyBhcmUgdHJpZ2dlcmVkIHdoZW4gYW55IG9mIHRoZSBhc3NvY2lhdGVkIENTUyBjbGFzc2VzIGFyZSBhZGRlZCBhbmQgcmVtb3ZlZFxuXHQgKiBvbiB0aGUgaW5wdXQgZWxlbWVudCB3aGljaCBpcyBhdHRhY2hlZCB0byB0aGUgbW9kZWwuIFRoZXNlIGNsYXNzZXMgaW5jbHVkZTogYC5uZy1wcmlzdGluZWAsIGAubmctZGlydHlgLFxuXHQgKiBgLm5nLWludmFsaWRgIGFuZCBgLm5nLXZhbGlkYCBhcyB3ZWxsIGFzIGFueSBvdGhlciB2YWxpZGF0aW9ucyB0aGF0IGFyZSBwZXJmb3JtZWQgb24gdGhlIG1vZGVsIGl0c2VsZi5cblx0ICogVGhlIGFuaW1hdGlvbnMgdGhhdCBhcmUgdHJpZ2dlcmVkIHdpdGhpbiBuZ01vZGVsIGFyZSBzaW1pbGFyIHRvIGhvdyB0aGV5IHdvcmsgaW4gbmdDbGFzcyBhbmRcblx0ICogYW5pbWF0aW9ucyBjYW4gYmUgaG9va2VkIGludG8gdXNpbmcgQ1NTIHRyYW5zaXRpb25zLCBrZXlmcmFtZXMgYXMgd2VsbCBhcyBKUyBhbmltYXRpb25zLlxuXHQgKlxuXHQgKiBUaGUgZm9sbG93aW5nIGV4YW1wbGUgc2hvd3MgYSBzaW1wbGUgd2F5IHRvIHV0aWxpemUgQ1NTIHRyYW5zaXRpb25zIHRvIHN0eWxlIGFuIGlucHV0IGVsZW1lbnRcblx0ICogdGhhdCBoYXMgYmVlbiByZW5kZXJlZCBhcyBpbnZhbGlkIGFmdGVyIGl0IGhhcyBiZWVuIHZhbGlkYXRlZDpcblx0ICpcblx0ICogPHByZT5cblx0ICogLy9iZSBzdXJlIHRvIGluY2x1ZGUgbmdBbmltYXRlIGFzIGEgbW9kdWxlIHRvIGhvb2sgaW50byBtb3JlXG5cdCAqIC8vYWR2YW5jZWQgYW5pbWF0aW9uc1xuXHQgKiAubXktaW5wdXQge1xuXHQgKiAgIHRyYW5zaXRpb246MC41cyBsaW5lYXIgYWxsO1xuXHQgKiAgIGJhY2tncm91bmQ6IHdoaXRlO1xuXHQgKiB9XG5cdCAqIC5teS1pbnB1dC5uZy1pbnZhbGlkIHtcblx0ICogICBiYWNrZ3JvdW5kOiByZWQ7XG5cdCAqICAgY29sb3I6d2hpdGU7XG5cdCAqIH1cblx0ICogPC9wcmU+XG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqIDxleGFtcGxlIGRlcHM9XCJhbmd1bGFyLWFuaW1hdGUuanNcIiBhbmltYXRpb25zPVwidHJ1ZVwiIGZpeEJhc2U9XCJ0cnVlXCIgbW9kdWxlPVwiaW5wdXRFeGFtcGxlXCI+XG5cdCAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgIDxzY3JpcHQ+XG5cdCAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2lucHV0RXhhbXBsZScsIFtdKVxuXHQgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICAgJHNjb3BlLnZhbCA9ICcxJztcblx0ICAgICAgICAgIH1dKTtcblx0ICAgICAgIDwvc2NyaXB0PlxuXHQgICAgICAgPHN0eWxlPlxuXHQgICAgICAgICAubXktaW5wdXQge1xuXHQgICAgICAgICAgIHRyYW5zaXRpb246YWxsIGxpbmVhciAwLjVzO1xuXHQgICAgICAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xuXHQgICAgICAgICB9XG5cdCAgICAgICAgIC5teS1pbnB1dC5uZy1pbnZhbGlkIHtcblx0ICAgICAgICAgICBjb2xvcjp3aGl0ZTtcblx0ICAgICAgICAgICBiYWNrZ3JvdW5kOiByZWQ7XG5cdCAgICAgICAgIH1cblx0ICAgICAgIDwvc3R5bGU+XG5cdCAgICAgICA8cCBpZD1cImlucHV0RGVzY3JpcHRpb25cIj5cblx0ICAgICAgICBVcGRhdGUgaW5wdXQgdG8gc2VlIHRyYW5zaXRpb25zIHdoZW4gdmFsaWQvaW52YWxpZC5cblx0ICAgICAgICBJbnRlZ2VyIGlzIGEgdmFsaWQgdmFsdWUuXG5cdCAgICAgICA8L3A+XG5cdCAgICAgICA8Zm9ybSBuYW1lPVwidGVzdEZvcm1cIiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgICAgPGlucHV0IG5nLW1vZGVsPVwidmFsXCIgbmctcGF0dGVybj1cIi9eXFxkKyQvXCIgbmFtZT1cImFuaW1cIiBjbGFzcz1cIm15LWlucHV0XCJcblx0ICAgICAgICAgICAgICAgIGFyaWEtZGVzY3JpYmVkYnk9XCJpbnB1dERlc2NyaXB0aW9uXCIgLz5cblx0ICAgICAgIDwvZm9ybT5cblx0ICAgICA8L2ZpbGU+XG5cdCAqIDwvZXhhbXBsZT5cblx0ICpcblx0ICogIyMgQmluZGluZyB0byBhIGdldHRlci9zZXR0ZXJcblx0ICpcblx0ICogU29tZXRpbWVzIGl0J3MgaGVscGZ1bCB0byBiaW5kIGBuZ01vZGVsYCB0byBhIGdldHRlci9zZXR0ZXIgZnVuY3Rpb24uICBBIGdldHRlci9zZXR0ZXIgaXMgYVxuXHQgKiBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSByZXByZXNlbnRhdGlvbiBvZiB0aGUgbW9kZWwgd2hlbiBjYWxsZWQgd2l0aCB6ZXJvIGFyZ3VtZW50cywgYW5kIHNldHNcblx0ICogdGhlIGludGVybmFsIHN0YXRlIG9mIGEgbW9kZWwgd2hlbiBjYWxsZWQgd2l0aCBhbiBhcmd1bWVudC4gSXQncyBzb21ldGltZXMgdXNlZnVsIHRvIHVzZSB0aGlzXG5cdCAqIGZvciBtb2RlbHMgdGhhdCBoYXZlIGFuIGludGVybmFsIHJlcHJlc2VudGF0aW9uIHRoYXQncyBkaWZmZXJlbnQgZnJvbSB3aGF0IHRoZSBtb2RlbCBleHBvc2VzXG5cdCAqIHRvIHRoZSB2aWV3LlxuXHQgKlxuXHQgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtc3VjY2Vzc1wiPlxuXHQgKiAqKkJlc3QgUHJhY3RpY2U6KiogSXQncyBiZXN0IHRvIGtlZXAgZ2V0dGVycyBmYXN0IGJlY2F1c2UgQW5ndWxhciBpcyBsaWtlbHkgdG8gY2FsbCB0aGVtIG1vcmVcblx0ICogZnJlcXVlbnRseSB0aGFuIG90aGVyIHBhcnRzIG9mIHlvdXIgY29kZS5cblx0ICogPC9kaXY+XG5cdCAqXG5cdCAqIFlvdSB1c2UgdGhpcyBiZWhhdmlvciBieSBhZGRpbmcgYG5nLW1vZGVsLW9wdGlvbnM9XCJ7IGdldHRlclNldHRlcjogdHJ1ZSB9XCJgIHRvIGFuIGVsZW1lbnQgdGhhdFxuXHQgKiBoYXMgYG5nLW1vZGVsYCBhdHRhY2hlZCB0byBpdC4gWW91IGNhbiBhbHNvIGFkZCBgbmctbW9kZWwtb3B0aW9ucz1cInsgZ2V0dGVyU2V0dGVyOiB0cnVlIH1cImAgdG9cblx0ICogYSBgPGZvcm0+YCwgd2hpY2ggd2lsbCBlbmFibGUgdGhpcyBiZWhhdmlvciBmb3IgYWxsIGA8aW5wdXQ+YHMgd2l0aGluIGl0LiBTZWVcblx0ICoge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ01vZGVsT3B0aW9ucyBgbmdNb2RlbE9wdGlvbnNgfSBmb3IgbW9yZS5cblx0ICpcblx0ICogVGhlIGZvbGxvd2luZyBleGFtcGxlIHNob3dzIGhvdyB0byB1c2UgYG5nTW9kZWxgIHdpdGggYSBnZXR0ZXIvc2V0dGVyOlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgKiA8ZXhhbXBsZSBuYW1lPVwibmdNb2RlbC1nZXR0ZXItc2V0dGVyXCIgbW9kdWxlPVwiZ2V0dGVyU2V0dGVyRXhhbXBsZVwiPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgICAgICAgICA8Zm9ybSBuYW1lPVwidXNlckZvcm1cIj5cblx0ICAgICAgICAgICA8bGFiZWw+TmFtZTpcblx0ICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJ1c2VyTmFtZVwiXG5cdCAgICAgICAgICAgICAgICAgICAgbmctbW9kZWw9XCJ1c2VyLm5hbWVcIlxuXHQgICAgICAgICAgICAgICAgICAgIG5nLW1vZGVsLW9wdGlvbnM9XCJ7IGdldHRlclNldHRlcjogdHJ1ZSB9XCIgLz5cblx0ICAgICAgICAgICA8L2xhYmVsPlxuXHQgICAgICAgICA8L2Zvcm0+XG5cdCAgICAgICAgIDxwcmU+dXNlci5uYW1lID0gPHNwYW4gbmctYmluZD1cInVzZXIubmFtZSgpXCI+PC9zcGFuPjwvcHJlPlxuXHQgICAgICAgPC9kaXY+XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJhcHAuanNcIj5cblx0ICAgICAgIGFuZ3VsYXIubW9kdWxlKCdnZXR0ZXJTZXR0ZXJFeGFtcGxlJywgW10pXG5cdCAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAgICAgICAgICAgdmFyIF9uYW1lID0gJ0JyaWFuJztcblx0ICAgICAgICAgICAkc2NvcGUudXNlciA9IHtcblx0ICAgICAgICAgICAgIG5hbWU6IGZ1bmN0aW9uKG5ld05hbWUpIHtcblx0ICAgICAgICAgICAgICAvLyBOb3RlIHRoYXQgbmV3TmFtZSBjYW4gYmUgdW5kZWZpbmVkIGZvciB0d28gcmVhc29uczpcblx0ICAgICAgICAgICAgICAvLyAxLiBCZWNhdXNlIGl0IGlzIGNhbGxlZCBhcyBhIGdldHRlciBhbmQgdGh1cyBjYWxsZWQgd2l0aCBubyBhcmd1bWVudHNcblx0ICAgICAgICAgICAgICAvLyAyLiBCZWNhdXNlIHRoZSBwcm9wZXJ0eSBzaG91bGQgYWN0dWFsbHkgYmUgc2V0IHRvIHVuZGVmaW5lZC4gVGhpcyBoYXBwZW5zIGUuZy4gaWYgdGhlXG5cdCAgICAgICAgICAgICAgLy8gICAgaW5wdXQgaXMgaW52YWxpZFxuXHQgICAgICAgICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKF9uYW1lID0gbmV3TmFtZSkgOiBfbmFtZTtcblx0ICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICB9O1xuXHQgICAgICAgICB9XSk7XG5cdCAgICAgPC9maWxlPlxuXHQgKiA8L2V4YW1wbGU+XG5cdCAqL1xuXHR2YXIgbmdNb2RlbERpcmVjdGl2ZSA9IFsnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRyb290U2NvcGUpIHtcblx0ICByZXR1cm4ge1xuXHQgICAgcmVzdHJpY3Q6ICdBJyxcblx0ICAgIHJlcXVpcmU6IFsnbmdNb2RlbCcsICdeP2Zvcm0nLCAnXj9uZ01vZGVsT3B0aW9ucyddLFxuXHQgICAgY29udHJvbGxlcjogTmdNb2RlbENvbnRyb2xsZXIsXG5cdCAgICAvLyBQcmVsaW5rIG5lZWRzIHRvIHJ1biBiZWZvcmUgYW55IGlucHV0IGRpcmVjdGl2ZVxuXHQgICAgLy8gc28gdGhhdCB3ZSBjYW4gc2V0IHRoZSBOZ01vZGVsT3B0aW9ucyBpbiBOZ01vZGVsQ29udHJvbGxlclxuXHQgICAgLy8gYmVmb3JlIGFueW9uZSBlbHNlIHVzZXMgaXQuXG5cdCAgICBwcmlvcml0eTogMSxcblx0ICAgIGNvbXBpbGU6IGZ1bmN0aW9uIG5nTW9kZWxDb21waWxlKGVsZW1lbnQpIHtcblx0ICAgICAgLy8gU2V0dXAgaW5pdGlhbCBzdGF0ZSBvZiB0aGUgY29udHJvbFxuXHQgICAgICBlbGVtZW50LmFkZENsYXNzKFBSSVNUSU5FX0NMQVNTKS5hZGRDbGFzcyhVTlRPVUNIRURfQ0xBU1MpLmFkZENsYXNzKFZBTElEX0NMQVNTKTtcblx0XG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgcHJlOiBmdW5jdGlvbiBuZ01vZGVsUHJlTGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHMpIHtcblx0ICAgICAgICAgIHZhciBtb2RlbEN0cmwgPSBjdHJsc1swXSxcblx0ICAgICAgICAgICAgICBmb3JtQ3RybCA9IGN0cmxzWzFdIHx8IG1vZGVsQ3RybC4kJHBhcmVudEZvcm07XG5cdFxuXHQgICAgICAgICAgbW9kZWxDdHJsLiQkc2V0T3B0aW9ucyhjdHJsc1syXSAmJiBjdHJsc1syXS4kb3B0aW9ucyk7XG5cdFxuXHQgICAgICAgICAgLy8gbm90aWZ5IG90aGVycywgZXNwZWNpYWxseSBwYXJlbnQgZm9ybXNcblx0ICAgICAgICAgIGZvcm1DdHJsLiRhZGRDb250cm9sKG1vZGVsQ3RybCk7XG5cdFxuXHQgICAgICAgICAgYXR0ci4kb2JzZXJ2ZSgnbmFtZScsIGZ1bmN0aW9uKG5ld1ZhbHVlKSB7XG5cdCAgICAgICAgICAgIGlmIChtb2RlbEN0cmwuJG5hbWUgIT09IG5ld1ZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgbW9kZWxDdHJsLiQkcGFyZW50Rm9ybS4kJHJlbmFtZUNvbnRyb2wobW9kZWxDdHJsLCBuZXdWYWx1ZSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgbW9kZWxDdHJsLiQkcGFyZW50Rm9ybS4kcmVtb3ZlQ29udHJvbChtb2RlbEN0cmwpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBwb3N0OiBmdW5jdGlvbiBuZ01vZGVsUG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmxzKSB7XG5cdCAgICAgICAgICB2YXIgbW9kZWxDdHJsID0gY3RybHNbMF07XG5cdCAgICAgICAgICBpZiAobW9kZWxDdHJsLiRvcHRpb25zICYmIG1vZGVsQ3RybC4kb3B0aW9ucy51cGRhdGVPbikge1xuXHQgICAgICAgICAgICBlbGVtZW50Lm9uKG1vZGVsQ3RybC4kb3B0aW9ucy51cGRhdGVPbiwgZnVuY3Rpb24oZXYpIHtcblx0ICAgICAgICAgICAgICBtb2RlbEN0cmwuJCRkZWJvdW5jZVZpZXdWYWx1ZUNvbW1pdChldiAmJiBldi50eXBlKTtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgZWxlbWVudC5vbignYmx1cicsIGZ1bmN0aW9uKGV2KSB7XG5cdCAgICAgICAgICAgIGlmIChtb2RlbEN0cmwuJHRvdWNoZWQpIHJldHVybjtcblx0XG5cdCAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLiQkcGhhc2UpIHtcblx0ICAgICAgICAgICAgICBzY29wZS4kZXZhbEFzeW5jKG1vZGVsQ3RybC4kc2V0VG91Y2hlZCk7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KG1vZGVsQ3RybC4kc2V0VG91Y2hlZCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgIH1cblx0ICB9O1xuXHR9XTtcblx0XG5cdHZhciBERUZBVUxUX1JFR0VYUCA9IC8oXFxzK3xeKWRlZmF1bHQoXFxzK3wkKS87XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ01vZGVsT3B0aW9uc1xuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogQWxsb3dzIHR1bmluZyBob3cgbW9kZWwgdXBkYXRlcyBhcmUgZG9uZS4gVXNpbmcgYG5nTW9kZWxPcHRpb25zYCB5b3UgY2FuIHNwZWNpZnkgYSBjdXN0b20gbGlzdCBvZlxuXHQgKiBldmVudHMgdGhhdCB3aWxsIHRyaWdnZXIgYSBtb2RlbCB1cGRhdGUgYW5kL29yIGEgZGVib3VuY2luZyBkZWxheSBzbyB0aGF0IHRoZSBhY3R1YWwgdXBkYXRlIG9ubHlcblx0ICogdGFrZXMgcGxhY2Ugd2hlbiBhIHRpbWVyIGV4cGlyZXM7IHRoaXMgdGltZXIgd2lsbCBiZSByZXNldCBhZnRlciBhbm90aGVyIGNoYW5nZSB0YWtlcyBwbGFjZS5cblx0ICpcblx0ICogR2l2ZW4gdGhlIG5hdHVyZSBvZiBgbmdNb2RlbE9wdGlvbnNgLCB0aGUgdmFsdWUgZGlzcGxheWVkIGluc2lkZSBpbnB1dCBmaWVsZHMgaW4gdGhlIHZpZXcgbWlnaHRcblx0ICogYmUgZGlmZmVyZW50IGZyb20gdGhlIHZhbHVlIGluIHRoZSBhY3R1YWwgbW9kZWwuIFRoaXMgbWVhbnMgdGhhdCBpZiB5b3UgdXBkYXRlIHRoZSBtb2RlbCB5b3Vcblx0ICogc2hvdWxkIGFsc28gaW52b2tlIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIGAkcm9sbGJhY2tWaWV3VmFsdWVgfSBvbiB0aGUgcmVsZXZhbnQgaW5wdXQgZmllbGQgaW5cblx0ICogb3JkZXIgdG8gbWFrZSBzdXJlIGl0IGlzIHN5bmNocm9uaXplZCB3aXRoIHRoZSBtb2RlbCBhbmQgdGhhdCBhbnkgZGVib3VuY2VkIGFjdGlvbiBpcyBjYW5jZWxlZC5cblx0ICpcblx0ICogVGhlIGVhc2llc3Qgd2F5IHRvIHJlZmVyZW5jZSB0aGUgY29udHJvbCdzIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIGAkcm9sbGJhY2tWaWV3VmFsdWVgfVxuXHQgKiBtZXRob2QgaXMgYnkgbWFraW5nIHN1cmUgdGhlIGlucHV0IGlzIHBsYWNlZCBpbnNpZGUgYSBmb3JtIHRoYXQgaGFzIGEgYG5hbWVgIGF0dHJpYnV0ZS4gVGhpcyBpc1xuXHQgKiBpbXBvcnRhbnQgYmVjYXVzZSBgZm9ybWAgY29udHJvbGxlcnMgYXJlIHB1Ymxpc2hlZCB0byB0aGUgcmVsYXRlZCBzY29wZSB1bmRlciB0aGUgbmFtZSBpbiB0aGVpclxuXHQgKiBgbmFtZWAgYXR0cmlidXRlLlxuXHQgKlxuXHQgKiBBbnkgcGVuZGluZyBjaGFuZ2VzIHdpbGwgdGFrZSBwbGFjZSBpbW1lZGlhdGVseSB3aGVuIGFuIGVuY2xvc2luZyBmb3JtIGlzIHN1Ym1pdHRlZCB2aWEgdGhlXG5cdCAqIGBzdWJtaXRgIGV2ZW50LiBOb3RlIHRoYXQgYG5nQ2xpY2tgIGV2ZW50cyB3aWxsIG9jY3VyIGJlZm9yZSB0aGUgbW9kZWwgaXMgdXBkYXRlZC4gVXNlIGBuZ1N1Ym1pdGBcblx0ICogdG8gaGF2ZSBhY2Nlc3MgdG8gdGhlIHVwZGF0ZWQgbW9kZWwuXG5cdCAqXG5cdCAqIGBuZ01vZGVsT3B0aW9uc2AgaGFzIGFuIGVmZmVjdCBvbiB0aGUgZWxlbWVudCBpdCdzIGRlY2xhcmVkIG9uIGFuZCBpdHMgZGVzY2VuZGFudHMuXG5cdCAqXG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBuZ01vZGVsT3B0aW9ucyBvcHRpb25zIHRvIGFwcGx5IHRvIHRoZSBjdXJyZW50IG1vZGVsLiBWYWxpZCBrZXlzIGFyZTpcblx0ICogICAtIGB1cGRhdGVPbmA6IHN0cmluZyBzcGVjaWZ5aW5nIHdoaWNoIGV2ZW50IHNob3VsZCB0aGUgaW5wdXQgYmUgYm91bmQgdG8uIFlvdSBjYW4gc2V0IHNldmVyYWxcblx0ICogICAgIGV2ZW50cyB1c2luZyBhbiBzcGFjZSBkZWxpbWl0ZWQgbGlzdC4gVGhlcmUgaXMgYSBzcGVjaWFsIGV2ZW50IGNhbGxlZCBgZGVmYXVsdGAgdGhhdFxuXHQgKiAgICAgbWF0Y2hlcyB0aGUgZGVmYXVsdCBldmVudHMgYmVsb25naW5nIG9mIHRoZSBjb250cm9sLlxuXHQgKiAgIC0gYGRlYm91bmNlYDogaW50ZWdlciB2YWx1ZSB3aGljaCBjb250YWlucyB0aGUgZGVib3VuY2UgbW9kZWwgdXBkYXRlIHZhbHVlIGluIG1pbGxpc2Vjb25kcy4gQVxuXHQgKiAgICAgdmFsdWUgb2YgMCB0cmlnZ2VycyBhbiBpbW1lZGlhdGUgdXBkYXRlLiBJZiBhbiBvYmplY3QgaXMgc3VwcGxpZWQgaW5zdGVhZCwgeW91IGNhbiBzcGVjaWZ5IGFcblx0ICogICAgIGN1c3RvbSB2YWx1ZSBmb3IgZWFjaCBldmVudC4gRm9yIGV4YW1wbGU6XG5cdCAqICAgICBgbmctbW9kZWwtb3B0aW9ucz1cInsgdXBkYXRlT246ICdkZWZhdWx0IGJsdXInLCBkZWJvdW5jZTogeyAnZGVmYXVsdCc6IDUwMCwgJ2JsdXInOiAwIH0gfVwiYFxuXHQgKiAgIC0gYGFsbG93SW52YWxpZGA6IGJvb2xlYW4gdmFsdWUgd2hpY2ggaW5kaWNhdGVzIHRoYXQgdGhlIG1vZGVsIGNhbiBiZSBzZXQgd2l0aCB2YWx1ZXMgdGhhdCBkaWRcblx0ICogICAgIG5vdCB2YWxpZGF0ZSBjb3JyZWN0bHkgaW5zdGVhZCBvZiB0aGUgZGVmYXVsdCBiZWhhdmlvciBvZiBzZXR0aW5nIHRoZSBtb2RlbCB0byB1bmRlZmluZWQuXG5cdCAqICAgLSBgZ2V0dGVyU2V0dGVyYDogYm9vbGVhbiB2YWx1ZSB3aGljaCBkZXRlcm1pbmVzIHdoZXRoZXIgb3Igbm90IHRvIHRyZWF0IGZ1bmN0aW9ucyBib3VuZCB0b1xuXHQgICAgICAgYG5nTW9kZWxgIGFzIGdldHRlcnMvc2V0dGVycy5cblx0ICogICAtIGB0aW1lem9uZWA6IERlZmluZXMgdGhlIHRpbWV6b25lIHRvIGJlIHVzZWQgdG8gcmVhZC93cml0ZSB0aGUgYERhdGVgIGluc3RhbmNlIGluIHRoZSBtb2RlbCBmb3Jcblx0ICogICAgIGA8aW5wdXQgdHlwZT1cImRhdGVcIj5gLCBgPGlucHV0IHR5cGU9XCJ0aW1lXCI+YCwgLi4uIC4gSXQgdW5kZXJzdGFuZHMgVVRDL0dNVCBhbmQgdGhlXG5cdCAqICAgICBjb250aW5lbnRhbCBVUyB0aW1lIHpvbmUgYWJicmV2aWF0aW9ucywgYnV0IGZvciBnZW5lcmFsIHVzZSwgdXNlIGEgdGltZSB6b25lIG9mZnNldCwgZm9yXG5cdCAqICAgICBleGFtcGxlLCBgJyswNDMwJ2AgKDQgaG91cnMsIDMwIG1pbnV0ZXMgZWFzdCBvZiB0aGUgR3JlZW53aWNoIG1lcmlkaWFuKVxuXHQgKiAgICAgSWYgbm90IHNwZWNpZmllZCwgdGhlIHRpbWV6b25lIG9mIHRoZSBicm93c2VyIHdpbGwgYmUgdXNlZC5cblx0ICpcblx0ICogQGV4YW1wbGVcblx0XG5cdCAgVGhlIGZvbGxvd2luZyBleGFtcGxlIHNob3dzIGhvdyB0byBvdmVycmlkZSBpbW1lZGlhdGUgdXBkYXRlcy4gQ2hhbmdlcyBvbiB0aGUgaW5wdXRzIHdpdGhpbiB0aGVcblx0ICBmb3JtIHdpbGwgdXBkYXRlIHRoZSBtb2RlbCBvbmx5IHdoZW4gdGhlIGNvbnRyb2wgbG9zZXMgZm9jdXMgKGJsdXIgZXZlbnQpLiBJZiBgZXNjYXBlYCBrZXkgaXNcblx0ICBwcmVzc2VkIHdoaWxlIHRoZSBpbnB1dCBmaWVsZCBpcyBmb2N1c2VkLCB0aGUgdmFsdWUgaXMgcmVzZXQgdG8gdGhlIHZhbHVlIGluIHRoZSBjdXJyZW50IG1vZGVsLlxuXHRcblx0ICA8ZXhhbXBsZSBuYW1lPVwibmdNb2RlbE9wdGlvbnMtZGlyZWN0aXZlLWJsdXJcIiBtb2R1bGU9XCJvcHRpb25zRXhhbXBsZVwiPlxuXHQgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgICA8Zm9ybSBuYW1lPVwidXNlckZvcm1cIj5cblx0ICAgICAgICAgIDxsYWJlbD5OYW1lOlxuXHQgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwidXNlck5hbWVcIlxuXHQgICAgICAgICAgICAgICAgICAgbmctbW9kZWw9XCJ1c2VyLm5hbWVcIlxuXHQgICAgICAgICAgICAgICAgICAgbmctbW9kZWwtb3B0aW9ucz1cInsgdXBkYXRlT246ICdibHVyJyB9XCJcblx0ICAgICAgICAgICAgICAgICAgIG5nLWtleXVwPVwiY2FuY2VsKCRldmVudClcIiAvPlxuXHQgICAgICAgICAgPC9sYWJlbD48YnIgLz5cblx0ICAgICAgICAgIDxsYWJlbD5PdGhlciBkYXRhOlxuXHQgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cInVzZXIuZGF0YVwiIC8+XG5cdCAgICAgICAgICA8L2xhYmVsPjxiciAvPlxuXHQgICAgICAgIDwvZm9ybT5cblx0ICAgICAgICA8cHJlPnVzZXIubmFtZSA9IDxzcGFuIG5nLWJpbmQ9XCJ1c2VyLm5hbWVcIj48L3NwYW4+PC9wcmU+XG5cdCAgICAgICAgPHByZT51c2VyLmRhdGEgPSA8c3BhbiBuZy1iaW5kPVwidXNlci5kYXRhXCI+PC9zcGFuPjwvcHJlPlxuXHQgICAgICA8L2Rpdj5cblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJhcHAuanNcIj5cblx0ICAgICAgYW5ndWxhci5tb2R1bGUoJ29wdGlvbnNFeGFtcGxlJywgW10pXG5cdCAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICRzY29wZS51c2VyID0geyBuYW1lOiAnSm9obicsIGRhdGE6ICcnIH07XG5cdFxuXHQgICAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKGUpIHtcblx0ICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAyNykge1xuXHQgICAgICAgICAgICAgICRzY29wZS51c2VyRm9ybS51c2VyTmFtZS4kcm9sbGJhY2tWaWV3VmFsdWUoKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9XSk7XG5cdCAgICA8L2ZpbGU+XG5cdCAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgIHZhciBtb2RlbCA9IGVsZW1lbnQoYnkuYmluZGluZygndXNlci5uYW1lJykpO1xuXHQgICAgICB2YXIgaW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCd1c2VyLm5hbWUnKSk7XG5cdCAgICAgIHZhciBvdGhlciA9IGVsZW1lbnQoYnkubW9kZWwoJ3VzZXIuZGF0YScpKTtcblx0XG5cdCAgICAgIGl0KCdzaG91bGQgYWxsb3cgY3VzdG9tIGV2ZW50cycsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlucHV0LnNlbmRLZXlzKCcgRG9lJyk7XG5cdCAgICAgICAgaW5wdXQuY2xpY2soKTtcblx0ICAgICAgICBleHBlY3QobW9kZWwuZ2V0VGV4dCgpKS50b0VxdWFsKCdKb2huJyk7XG5cdCAgICAgICAgb3RoZXIuY2xpY2soKTtcblx0ICAgICAgICBleHBlY3QobW9kZWwuZ2V0VGV4dCgpKS50b0VxdWFsKCdKb2huIERvZScpO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGl0KCdzaG91bGQgJHJvbGxiYWNrVmlld1ZhbHVlIHdoZW4gbW9kZWwgY2hhbmdlcycsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlucHV0LnNlbmRLZXlzKCcgRG9lJyk7XG5cdCAgICAgICAgZXhwZWN0KGlucHV0LmdldEF0dHJpYnV0ZSgndmFsdWUnKSkudG9FcXVhbCgnSm9obiBEb2UnKTtcblx0ICAgICAgICBpbnB1dC5zZW5kS2V5cyhwcm90cmFjdG9yLktleS5FU0NBUEUpO1xuXHQgICAgICAgIGV4cGVjdChpbnB1dC5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpLnRvRXF1YWwoJ0pvaG4nKTtcblx0ICAgICAgICBvdGhlci5jbGljaygpO1xuXHQgICAgICAgIGV4cGVjdChtb2RlbC5nZXRUZXh0KCkpLnRvRXF1YWwoJ0pvaG4nKTtcblx0ICAgICAgfSk7XG5cdCAgICA8L2ZpbGU+XG5cdCAgPC9leGFtcGxlPlxuXHRcblx0ICBUaGlzIG9uZSBzaG93cyBob3cgdG8gZGVib3VuY2UgbW9kZWwgY2hhbmdlcy4gTW9kZWwgd2lsbCBiZSB1cGRhdGVkIG9ubHkgMSBzZWMgYWZ0ZXIgbGFzdCBjaGFuZ2UuXG5cdCAgSWYgdGhlIGBDbGVhcmAgYnV0dG9uIGlzIHByZXNzZWQsIGFueSBkZWJvdW5jZWQgYWN0aW9uIGlzIGNhbmNlbGVkIGFuZCB0aGUgdmFsdWUgYmVjb21lcyBlbXB0eS5cblx0XG5cdCAgPGV4YW1wbGUgbmFtZT1cIm5nTW9kZWxPcHRpb25zLWRpcmVjdGl2ZS1kZWJvdW5jZVwiIG1vZHVsZT1cIm9wdGlvbnNFeGFtcGxlXCI+XG5cdCAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgICAgICAgIDxmb3JtIG5hbWU9XCJ1c2VyRm9ybVwiPlxuXHQgICAgICAgICAgPGxhYmVsPk5hbWU6XG5cdCAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJ1c2VyTmFtZVwiXG5cdCAgICAgICAgICAgICAgICAgICBuZy1tb2RlbD1cInVzZXIubmFtZVwiXG5cdCAgICAgICAgICAgICAgICAgICBuZy1tb2RlbC1vcHRpb25zPVwieyBkZWJvdW5jZTogMTAwMCB9XCIgLz5cblx0ICAgICAgICAgIDwvbGFiZWw+XG5cdCAgICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwidXNlckZvcm0udXNlck5hbWUuJHJvbGxiYWNrVmlld1ZhbHVlKCk7IHVzZXIubmFtZT0nJ1wiPkNsZWFyPC9idXR0b24+XG5cdCAgICAgICAgICA8YnIgLz5cblx0ICAgICAgICA8L2Zvcm0+XG5cdCAgICAgICAgPHByZT51c2VyLm5hbWUgPSA8c3BhbiBuZy1iaW5kPVwidXNlci5uYW1lXCI+PC9zcGFuPjwvcHJlPlxuXHQgICAgICA8L2Rpdj5cblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJhcHAuanNcIj5cblx0ICAgICAgYW5ndWxhci5tb2R1bGUoJ29wdGlvbnNFeGFtcGxlJywgW10pXG5cdCAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICRzY29wZS51c2VyID0geyBuYW1lOiAnSWdvcicgfTtcblx0ICAgICAgICB9XSk7XG5cdCAgICA8L2ZpbGU+XG5cdCAgPC9leGFtcGxlPlxuXHRcblx0ICBUaGlzIG9uZSBzaG93cyBob3cgdG8gYmluZCB0byBnZXR0ZXIvc2V0dGVyczpcblx0XG5cdCAgPGV4YW1wbGUgbmFtZT1cIm5nTW9kZWxPcHRpb25zLWRpcmVjdGl2ZS1nZXR0ZXItc2V0dGVyXCIgbW9kdWxlPVwiZ2V0dGVyU2V0dGVyRXhhbXBsZVwiPlxuXHQgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgICA8Zm9ybSBuYW1lPVwidXNlckZvcm1cIj5cblx0ICAgICAgICAgIDxsYWJlbD5OYW1lOlxuXHQgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwidXNlck5hbWVcIlxuXHQgICAgICAgICAgICAgICAgICAgbmctbW9kZWw9XCJ1c2VyLm5hbWVcIlxuXHQgICAgICAgICAgICAgICAgICAgbmctbW9kZWwtb3B0aW9ucz1cInsgZ2V0dGVyU2V0dGVyOiB0cnVlIH1cIiAvPlxuXHQgICAgICAgICAgPC9sYWJlbD5cblx0ICAgICAgICA8L2Zvcm0+XG5cdCAgICAgICAgPHByZT51c2VyLm5hbWUgPSA8c3BhbiBuZy1iaW5kPVwidXNlci5uYW1lKClcIj48L3NwYW4+PC9wcmU+XG5cdCAgICAgIDwvZGl2PlxuXHQgICAgPC9maWxlPlxuXHQgICAgPGZpbGUgbmFtZT1cImFwcC5qc1wiPlxuXHQgICAgICBhbmd1bGFyLm1vZHVsZSgnZ2V0dGVyU2V0dGVyRXhhbXBsZScsIFtdKVxuXHQgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAgICAgICAgICB2YXIgX25hbWUgPSAnQnJpYW4nO1xuXHQgICAgICAgICAgJHNjb3BlLnVzZXIgPSB7XG5cdCAgICAgICAgICAgIG5hbWU6IGZ1bmN0aW9uKG5ld05hbWUpIHtcblx0ICAgICAgICAgICAgICAvLyBOb3RlIHRoYXQgbmV3TmFtZSBjYW4gYmUgdW5kZWZpbmVkIGZvciB0d28gcmVhc29uczpcblx0ICAgICAgICAgICAgICAvLyAxLiBCZWNhdXNlIGl0IGlzIGNhbGxlZCBhcyBhIGdldHRlciBhbmQgdGh1cyBjYWxsZWQgd2l0aCBubyBhcmd1bWVudHNcblx0ICAgICAgICAgICAgICAvLyAyLiBCZWNhdXNlIHRoZSBwcm9wZXJ0eSBzaG91bGQgYWN0dWFsbHkgYmUgc2V0IHRvIHVuZGVmaW5lZC4gVGhpcyBoYXBwZW5zIGUuZy4gaWYgdGhlXG5cdCAgICAgICAgICAgICAgLy8gICAgaW5wdXQgaXMgaW52YWxpZFxuXHQgICAgICAgICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKF9uYW1lID0gbmV3TmFtZSkgOiBfbmFtZTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9XSk7XG5cdCAgICA8L2ZpbGU+XG5cdCAgPC9leGFtcGxlPlxuXHQgKi9cblx0dmFyIG5nTW9kZWxPcHRpb25zRGlyZWN0aXZlID0gZnVuY3Rpb24oKSB7XG5cdCAgcmV0dXJuIHtcblx0ICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICBjb250cm9sbGVyOiBbJyRzY29wZScsICckYXR0cnMnLCBmdW5jdGlvbigkc2NvcGUsICRhdHRycykge1xuXHQgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cdCAgICAgIHRoaXMuJG9wdGlvbnMgPSBjb3B5KCRzY29wZS4kZXZhbCgkYXR0cnMubmdNb2RlbE9wdGlvbnMpKTtcblx0ICAgICAgLy8gQWxsb3cgYWRkaW5nL292ZXJyaWRpbmcgYm91bmQgZXZlbnRzXG5cdCAgICAgIGlmIChpc0RlZmluZWQodGhpcy4kb3B0aW9ucy51cGRhdGVPbikpIHtcblx0ICAgICAgICB0aGlzLiRvcHRpb25zLnVwZGF0ZU9uRGVmYXVsdCA9IGZhbHNlO1xuXHQgICAgICAgIC8vIGV4dHJhY3QgXCJkZWZhdWx0XCIgcHNldWRvLWV2ZW50IGZyb20gbGlzdCBvZiBldmVudHMgdGhhdCBjYW4gdHJpZ2dlciBhIG1vZGVsIHVwZGF0ZVxuXHQgICAgICAgIHRoaXMuJG9wdGlvbnMudXBkYXRlT24gPSB0cmltKHRoaXMuJG9wdGlvbnMudXBkYXRlT24ucmVwbGFjZShERUZBVUxUX1JFR0VYUCwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICB0aGF0LiRvcHRpb25zLnVwZGF0ZU9uRGVmYXVsdCA9IHRydWU7XG5cdCAgICAgICAgICByZXR1cm4gJyAnO1xuXHQgICAgICAgIH0pKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB0aGlzLiRvcHRpb25zLnVwZGF0ZU9uRGVmYXVsdCA9IHRydWU7XG5cdCAgICAgIH1cblx0ICAgIH1dXG5cdCAgfTtcblx0fTtcblx0XG5cdFxuXHRcblx0Ly8gaGVscGVyIG1ldGhvZHNcblx0ZnVuY3Rpb24gYWRkU2V0VmFsaWRpdHlNZXRob2QoY29udGV4dCkge1xuXHQgIHZhciBjdHJsID0gY29udGV4dC5jdHJsLFxuXHQgICAgICAkZWxlbWVudCA9IGNvbnRleHQuJGVsZW1lbnQsXG5cdCAgICAgIGNsYXNzQ2FjaGUgPSB7fSxcblx0ICAgICAgc2V0ID0gY29udGV4dC5zZXQsXG5cdCAgICAgIHVuc2V0ID0gY29udGV4dC51bnNldCxcblx0ICAgICAgJGFuaW1hdGUgPSBjb250ZXh0LiRhbmltYXRlO1xuXHRcblx0ICBjbGFzc0NhY2hlW0lOVkFMSURfQ0xBU1NdID0gIShjbGFzc0NhY2hlW1ZBTElEX0NMQVNTXSA9ICRlbGVtZW50Lmhhc0NsYXNzKFZBTElEX0NMQVNTKSk7XG5cdFxuXHQgIGN0cmwuJHNldFZhbGlkaXR5ID0gc2V0VmFsaWRpdHk7XG5cdFxuXHQgIGZ1bmN0aW9uIHNldFZhbGlkaXR5KHZhbGlkYXRpb25FcnJvcktleSwgc3RhdGUsIGNvbnRyb2xsZXIpIHtcblx0ICAgIGlmIChpc1VuZGVmaW5lZChzdGF0ZSkpIHtcblx0ICAgICAgY3JlYXRlQW5kU2V0KCckcGVuZGluZycsIHZhbGlkYXRpb25FcnJvcktleSwgY29udHJvbGxlcik7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB1bnNldEFuZENsZWFudXAoJyRwZW5kaW5nJywgdmFsaWRhdGlvbkVycm9yS2V5LCBjb250cm9sbGVyKTtcblx0ICAgIH1cblx0ICAgIGlmICghaXNCb29sZWFuKHN0YXRlKSkge1xuXHQgICAgICB1bnNldChjdHJsLiRlcnJvciwgdmFsaWRhdGlvbkVycm9yS2V5LCBjb250cm9sbGVyKTtcblx0ICAgICAgdW5zZXQoY3RybC4kJHN1Y2Nlc3MsIHZhbGlkYXRpb25FcnJvcktleSwgY29udHJvbGxlcik7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBpZiAoc3RhdGUpIHtcblx0ICAgICAgICB1bnNldChjdHJsLiRlcnJvciwgdmFsaWRhdGlvbkVycm9yS2V5LCBjb250cm9sbGVyKTtcblx0ICAgICAgICBzZXQoY3RybC4kJHN1Y2Nlc3MsIHZhbGlkYXRpb25FcnJvcktleSwgY29udHJvbGxlcik7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgc2V0KGN0cmwuJGVycm9yLCB2YWxpZGF0aW9uRXJyb3JLZXksIGNvbnRyb2xsZXIpO1xuXHQgICAgICAgIHVuc2V0KGN0cmwuJCRzdWNjZXNzLCB2YWxpZGF0aW9uRXJyb3JLZXksIGNvbnRyb2xsZXIpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICBpZiAoY3RybC4kcGVuZGluZykge1xuXHQgICAgICBjYWNoZWRUb2dnbGVDbGFzcyhQRU5ESU5HX0NMQVNTLCB0cnVlKTtcblx0ICAgICAgY3RybC4kdmFsaWQgPSBjdHJsLiRpbnZhbGlkID0gdW5kZWZpbmVkO1xuXHQgICAgICB0b2dnbGVWYWxpZGF0aW9uQ3NzKCcnLCBudWxsKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGNhY2hlZFRvZ2dsZUNsYXNzKFBFTkRJTkdfQ0xBU1MsIGZhbHNlKTtcblx0ICAgICAgY3RybC4kdmFsaWQgPSBpc09iamVjdEVtcHR5KGN0cmwuJGVycm9yKTtcblx0ICAgICAgY3RybC4kaW52YWxpZCA9ICFjdHJsLiR2YWxpZDtcblx0ICAgICAgdG9nZ2xlVmFsaWRhdGlvbkNzcygnJywgY3RybC4kdmFsaWQpO1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIHJlLXJlYWQgdGhlIHN0YXRlIGFzIHRoZSBzZXQvdW5zZXQgbWV0aG9kcyBjb3VsZCBoYXZlXG5cdCAgICAvLyBjb21iaW5lZCBzdGF0ZSBpbiBjdHJsLiRlcnJvclt2YWxpZGF0aW9uRXJyb3JdICh1c2VkIGZvciBmb3JtcyksXG5cdCAgICAvLyB3aGVyZSBzZXR0aW5nL3Vuc2V0dGluZyBvbmx5IGluY3JlbWVudHMvZGVjcmVtZW50cyB0aGUgdmFsdWUsXG5cdCAgICAvLyBhbmQgZG9lcyBub3QgcmVwbGFjZSBpdC5cblx0ICAgIHZhciBjb21iaW5lZFN0YXRlO1xuXHQgICAgaWYgKGN0cmwuJHBlbmRpbmcgJiYgY3RybC4kcGVuZGluZ1t2YWxpZGF0aW9uRXJyb3JLZXldKSB7XG5cdCAgICAgIGNvbWJpbmVkU3RhdGUgPSB1bmRlZmluZWQ7XG5cdCAgICB9IGVsc2UgaWYgKGN0cmwuJGVycm9yW3ZhbGlkYXRpb25FcnJvcktleV0pIHtcblx0ICAgICAgY29tYmluZWRTdGF0ZSA9IGZhbHNlO1xuXHQgICAgfSBlbHNlIGlmIChjdHJsLiQkc3VjY2Vzc1t2YWxpZGF0aW9uRXJyb3JLZXldKSB7XG5cdCAgICAgIGNvbWJpbmVkU3RhdGUgPSB0cnVlO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgY29tYmluZWRTdGF0ZSA9IG51bGw7XG5cdCAgICB9XG5cdFxuXHQgICAgdG9nZ2xlVmFsaWRhdGlvbkNzcyh2YWxpZGF0aW9uRXJyb3JLZXksIGNvbWJpbmVkU3RhdGUpO1xuXHQgICAgY3RybC4kJHBhcmVudEZvcm0uJHNldFZhbGlkaXR5KHZhbGlkYXRpb25FcnJvcktleSwgY29tYmluZWRTdGF0ZSwgY3RybCk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBjcmVhdGVBbmRTZXQobmFtZSwgdmFsdWUsIGNvbnRyb2xsZXIpIHtcblx0ICAgIGlmICghY3RybFtuYW1lXSkge1xuXHQgICAgICBjdHJsW25hbWVdID0ge307XG5cdCAgICB9XG5cdCAgICBzZXQoY3RybFtuYW1lXSwgdmFsdWUsIGNvbnRyb2xsZXIpO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gdW5zZXRBbmRDbGVhbnVwKG5hbWUsIHZhbHVlLCBjb250cm9sbGVyKSB7XG5cdCAgICBpZiAoY3RybFtuYW1lXSkge1xuXHQgICAgICB1bnNldChjdHJsW25hbWVdLCB2YWx1ZSwgY29udHJvbGxlcik7XG5cdCAgICB9XG5cdCAgICBpZiAoaXNPYmplY3RFbXB0eShjdHJsW25hbWVdKSkge1xuXHQgICAgICBjdHJsW25hbWVdID0gdW5kZWZpbmVkO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gY2FjaGVkVG9nZ2xlQ2xhc3MoY2xhc3NOYW1lLCBzd2l0Y2hWYWx1ZSkge1xuXHQgICAgaWYgKHN3aXRjaFZhbHVlICYmICFjbGFzc0NhY2hlW2NsYXNzTmFtZV0pIHtcblx0ICAgICAgJGFuaW1hdGUuYWRkQ2xhc3MoJGVsZW1lbnQsIGNsYXNzTmFtZSk7XG5cdCAgICAgIGNsYXNzQ2FjaGVbY2xhc3NOYW1lXSA9IHRydWU7XG5cdCAgICB9IGVsc2UgaWYgKCFzd2l0Y2hWYWx1ZSAmJiBjbGFzc0NhY2hlW2NsYXNzTmFtZV0pIHtcblx0ICAgICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoJGVsZW1lbnQsIGNsYXNzTmFtZSk7XG5cdCAgICAgIGNsYXNzQ2FjaGVbY2xhc3NOYW1lXSA9IGZhbHNlO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gdG9nZ2xlVmFsaWRhdGlvbkNzcyh2YWxpZGF0aW9uRXJyb3JLZXksIGlzVmFsaWQpIHtcblx0ICAgIHZhbGlkYXRpb25FcnJvcktleSA9IHZhbGlkYXRpb25FcnJvcktleSA/ICctJyArIHNuYWtlX2Nhc2UodmFsaWRhdGlvbkVycm9yS2V5LCAnLScpIDogJyc7XG5cdFxuXHQgICAgY2FjaGVkVG9nZ2xlQ2xhc3MoVkFMSURfQ0xBU1MgKyB2YWxpZGF0aW9uRXJyb3JLZXksIGlzVmFsaWQgPT09IHRydWUpO1xuXHQgICAgY2FjaGVkVG9nZ2xlQ2xhc3MoSU5WQUxJRF9DTEFTUyArIHZhbGlkYXRpb25FcnJvcktleSwgaXNWYWxpZCA9PT0gZmFsc2UpO1xuXHQgIH1cblx0fVxuXHRcblx0ZnVuY3Rpb24gaXNPYmplY3RFbXB0eShvYmopIHtcblx0ICBpZiAob2JqKSB7XG5cdCAgICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuXHQgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KHByb3ApKSB7XG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfVxuXHQgIHJldHVybiB0cnVlO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ05vbkJpbmRhYmxlXG5cdCAqIEByZXN0cmljdCBBQ1xuXHQgKiBAcHJpb3JpdHkgMTAwMFxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogVGhlIGBuZ05vbkJpbmRhYmxlYCBkaXJlY3RpdmUgdGVsbHMgQW5ndWxhciBub3QgdG8gY29tcGlsZSBvciBiaW5kIHRoZSBjb250ZW50cyBvZiB0aGUgY3VycmVudFxuXHQgKiBET00gZWxlbWVudC4gVGhpcyBpcyB1c2VmdWwgaWYgdGhlIGVsZW1lbnQgY29udGFpbnMgd2hhdCBhcHBlYXJzIHRvIGJlIEFuZ3VsYXIgZGlyZWN0aXZlcyBhbmRcblx0ICogYmluZGluZ3MgYnV0IHdoaWNoIHNob3VsZCBiZSBpZ25vcmVkIGJ5IEFuZ3VsYXIuIFRoaXMgY291bGQgYmUgdGhlIGNhc2UgaWYgeW91IGhhdmUgYSBzaXRlIHRoYXRcblx0ICogZGlzcGxheXMgc25pcHBldHMgb2YgY29kZSwgZm9yIGluc3RhbmNlLlxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICogSW4gdGhpcyBleGFtcGxlIHRoZXJlIGFyZSB0d28gbG9jYXRpb25zIHdoZXJlIGEgc2ltcGxlIGludGVycG9sYXRpb24gYmluZGluZyAoYHt7fX1gKSBpcyBwcmVzZW50LFxuXHQgKiBidXQgdGhlIG9uZSB3cmFwcGVkIGluIGBuZ05vbkJpbmRhYmxlYCBpcyBsZWZ0IGFsb25lLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgICAgPGV4YW1wbGU+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgPGRpdj5Ob3JtYWw6IHt7MSArIDJ9fTwvZGl2PlxuXHQgICAgICAgIDxkaXYgbmctbm9uLWJpbmRhYmxlPklnbm9yZWQ6IHt7MSArIDJ9fTwvZGl2PlxuXHQgICAgICA8L2ZpbGU+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgIGl0KCdzaG91bGQgY2hlY2sgbmctbm9uLWJpbmRhYmxlJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJzEgKyAyJykpLmdldFRleHQoKSkudG9Db250YWluKCczJyk7XG5cdCAgICAgICAgIGV4cGVjdChlbGVtZW50LmFsbChieS5jc3MoJ2RpdicpKS5sYXN0KCkuZ2V0VGV4dCgpKS50b01hdGNoKC8xIFxcKyAyLyk7XG5cdCAgICAgICB9KTtcblx0ICAgICAgPC9maWxlPlxuXHQgICAgPC9leGFtcGxlPlxuXHQgKi9cblx0dmFyIG5nTm9uQmluZGFibGVEaXJlY3RpdmUgPSBuZ0RpcmVjdGl2ZSh7IHRlcm1pbmFsOiB0cnVlLCBwcmlvcml0eTogMTAwMCB9KTtcblx0XG5cdC8qIGdsb2JhbCBqcUxpdGVSZW1vdmUgKi9cblx0XG5cdHZhciBuZ09wdGlvbnNNaW5FcnIgPSBtaW5FcnIoJ25nT3B0aW9ucycpO1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdPcHRpb25zXG5cdCAqIEByZXN0cmljdCBBXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKlxuXHQgKiBUaGUgYG5nT3B0aW9uc2AgYXR0cmlidXRlIGNhbiBiZSB1c2VkIHRvIGR5bmFtaWNhbGx5IGdlbmVyYXRlIGEgbGlzdCBvZiBgPG9wdGlvbj5gXG5cdCAqIGVsZW1lbnRzIGZvciB0aGUgYDxzZWxlY3Q+YCBlbGVtZW50IHVzaW5nIHRoZSBhcnJheSBvciBvYmplY3Qgb2J0YWluZWQgYnkgZXZhbHVhdGluZyB0aGVcblx0ICogYG5nT3B0aW9uc2AgY29tcHJlaGVuc2lvbiBleHByZXNzaW9uLlxuXHQgKlxuXHQgKiBJbiBtYW55IGNhc2VzLCBgbmdSZXBlYXRgIGNhbiBiZSB1c2VkIG9uIGA8b3B0aW9uPmAgZWxlbWVudHMgaW5zdGVhZCBvZiBgbmdPcHRpb25zYCB0byBhY2hpZXZlIGFcblx0ICogc2ltaWxhciByZXN1bHQuIEhvd2V2ZXIsIGBuZ09wdGlvbnNgIHByb3ZpZGVzIHNvbWUgYmVuZWZpdHMgc3VjaCBhcyByZWR1Y2luZyBtZW1vcnkgYW5kXG5cdCAqIGluY3JlYXNpbmcgc3BlZWQgYnkgbm90IGNyZWF0aW5nIGEgbmV3IHNjb3BlIGZvciBlYWNoIHJlcGVhdGVkIGluc3RhbmNlLCBhcyB3ZWxsIGFzIHByb3ZpZGluZ1xuXHQgKiBtb3JlIGZsZXhpYmlsaXR5IGluIGhvdyB0aGUgYDxzZWxlY3Q+YCdzIG1vZGVsIGlzIGFzc2lnbmVkIHZpYSB0aGUgYHNlbGVjdGAgKipgYXNgKiogcGFydCBvZiB0aGVcblx0ICogY29tcHJlaGVuc2lvbiBleHByZXNzaW9uLiBgbmdPcHRpb25zYCBzaG91bGQgYmUgdXNlZCB3aGVuIHRoZSBgPHNlbGVjdD5gIG1vZGVsIG5lZWRzIHRvIGJlIGJvdW5kXG5cdCAqICB0byBhIG5vbi1zdHJpbmcgdmFsdWUuIFRoaXMgaXMgYmVjYXVzZSBhbiBvcHRpb24gZWxlbWVudCBjYW4gb25seSBiZSBib3VuZCB0byBzdHJpbmcgdmFsdWVzIGF0XG5cdCAqIHByZXNlbnQuXG5cdCAqXG5cdCAqIFdoZW4gYW4gaXRlbSBpbiB0aGUgYDxzZWxlY3Q+YCBtZW51IGlzIHNlbGVjdGVkLCB0aGUgYXJyYXkgZWxlbWVudCBvciBvYmplY3QgcHJvcGVydHlcblx0ICogcmVwcmVzZW50ZWQgYnkgdGhlIHNlbGVjdGVkIG9wdGlvbiB3aWxsIGJlIGJvdW5kIHRvIHRoZSBtb2RlbCBpZGVudGlmaWVkIGJ5IHRoZSBgbmdNb2RlbGBcblx0ICogZGlyZWN0aXZlLlxuXHQgKlxuXHQgKiBPcHRpb25hbGx5LCBhIHNpbmdsZSBoYXJkLWNvZGVkIGA8b3B0aW9uPmAgZWxlbWVudCwgd2l0aCB0aGUgdmFsdWUgc2V0IHRvIGFuIGVtcHR5IHN0cmluZywgY2FuXG5cdCAqIGJlIG5lc3RlZCBpbnRvIHRoZSBgPHNlbGVjdD5gIGVsZW1lbnQuIFRoaXMgZWxlbWVudCB3aWxsIHRoZW4gcmVwcmVzZW50IHRoZSBgbnVsbGAgb3IgXCJub3Qgc2VsZWN0ZWRcIlxuXHQgKiBvcHRpb24uIFNlZSBleGFtcGxlIGJlbG93IGZvciBkZW1vbnN0cmF0aW9uLlxuXHQgKlxuXHQgKiAjIyBDb21wbGV4IE1vZGVscyAob2JqZWN0cyBvciBjb2xsZWN0aW9ucylcblx0ICpcblx0ICogQnkgZGVmYXVsdCwgYG5nTW9kZWxgIHdhdGNoZXMgdGhlIG1vZGVsIGJ5IHJlZmVyZW5jZSwgbm90IHZhbHVlLiBUaGlzIGlzIGltcG9ydGFudCB0byBrbm93IHdoZW5cblx0ICogYmluZGluZyB0aGUgc2VsZWN0IHRvIGEgbW9kZWwgdGhhdCBpcyBhbiBvYmplY3Qgb3IgYSBjb2xsZWN0aW9uLlxuXHQgKlxuXHQgKiBPbmUgaXNzdWUgb2NjdXJzIGlmIHlvdSB3YW50IHRvIHByZXNlbGVjdCBhbiBvcHRpb24uIEZvciBleGFtcGxlLCBpZiB5b3Ugc2V0XG5cdCAqIHRoZSBtb2RlbCB0byBhbiBvYmplY3QgdGhhdCBpcyBlcXVhbCB0byBhbiBvYmplY3QgaW4geW91ciBjb2xsZWN0aW9uLCBgbmdPcHRpb25zYCB3b24ndCBiZSBhYmxlIHRvIHNldCB0aGUgc2VsZWN0aW9uLFxuXHQgKiBiZWNhdXNlIHRoZSBvYmplY3RzIGFyZSBub3QgaWRlbnRpY2FsLiBTbyBieSBkZWZhdWx0LCB5b3Ugc2hvdWxkIGFsd2F5cyByZWZlcmVuY2UgdGhlIGl0ZW0gaW4geW91ciBjb2xsZWN0aW9uXG5cdCAqIGZvciBwcmVzZWxlY3Rpb25zLCBlLmcuOiBgJHNjb3BlLnNlbGVjdGVkID0gJHNjb3BlLmNvbGxlY3Rpb25bM11gLlxuXHQgKlxuXHQgKiBBbm90aGVyIHNvbHV0aW9uIGlzIHRvIHVzZSBhIGB0cmFjayBieWAgY2xhdXNlLCBiZWNhdXNlIHRoZW4gYG5nT3B0aW9uc2Agd2lsbCB0cmFjayB0aGUgaWRlbnRpdHlcblx0ICogb2YgdGhlIGl0ZW0gbm90IGJ5IHJlZmVyZW5jZSwgYnV0IGJ5IHRoZSByZXN1bHQgb2YgdGhlIGB0cmFjayBieWAgZXhwcmVzc2lvbi4gRm9yIGV4YW1wbGUsIGlmIHlvdXJcblx0ICogY29sbGVjdGlvbiBpdGVtcyBoYXZlIGFuIGlkIHByb3BlcnR5LCB5b3Ugd291bGQgYHRyYWNrIGJ5IGl0ZW0uaWRgLlxuXHQgKlxuXHQgKiBBIGRpZmZlcmVudCBpc3N1ZSB3aXRoIG9iamVjdHMgb3IgY29sbGVjdGlvbnMgaXMgdGhhdCBuZ01vZGVsIHdvbid0IGRldGVjdCBpZiBhbiBvYmplY3QgcHJvcGVydHkgb3Jcblx0ICogYSBjb2xsZWN0aW9uIGl0ZW0gY2hhbmdlcy4gRm9yIHRoYXQgcmVhc29uLCBgbmdPcHRpb25zYCBhZGRpdGlvbmFsbHkgd2F0Y2hlcyB0aGUgbW9kZWwgdXNpbmdcblx0ICogYCR3YXRjaENvbGxlY3Rpb25gLCB3aGVuIHRoZSBleHByZXNzaW9uIGNvbnRhaW5zIGEgYHRyYWNrIGJ5YCBjbGF1c2Ugb3IgdGhlIHRoZSBzZWxlY3QgaGFzIHRoZSBgbXVsdGlwbGVgIGF0dHJpYnV0ZS5cblx0ICogVGhpcyBhbGxvd3MgbmdPcHRpb25zIHRvIHRyaWdnZXIgYSByZS1yZW5kZXJpbmcgb2YgdGhlIG9wdGlvbnMgZXZlbiBpZiB0aGUgYWN0dWFsIG9iamVjdC9jb2xsZWN0aW9uXG5cdCAqIGhhcyBub3QgY2hhbmdlZCBpZGVudGl0eSwgYnV0IG9ubHkgYSBwcm9wZXJ0eSBvbiB0aGUgb2JqZWN0IG9yIGFuIGl0ZW0gaW4gdGhlIGNvbGxlY3Rpb24gY2hhbmdlcy5cblx0ICpcblx0ICogTm90ZSB0aGF0IGAkd2F0Y2hDb2xsZWN0aW9uYCBkb2VzIGEgc2hhbGxvdyBjb21wYXJpc29uIG9mIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBvYmplY3QgKG9yIHRoZSBpdGVtcyBpbiB0aGUgY29sbGVjdGlvblxuXHQgKiBpZiB0aGUgbW9kZWwgaXMgYW4gYXJyYXkpLiBUaGlzIG1lYW5zIHRoYXQgY2hhbmdpbmcgYSBwcm9wZXJ0eSBkZWVwZXIgdGhhbiB0aGUgZmlyc3QgbGV2ZWwgaW5zaWRlIHRoZVxuXHQgKiBvYmplY3QvY29sbGVjdGlvbiB3aWxsIG5vdCB0cmlnZ2VyIGEgcmUtcmVuZGVyaW5nLlxuXHQgKlxuXHQgKiAjIyBgc2VsZWN0YCAqKmBhc2AqKlxuXHQgKlxuXHQgKiBVc2luZyBgc2VsZWN0YCAqKmBhc2AqKiB3aWxsIGJpbmQgdGhlIHJlc3VsdCBvZiB0aGUgYHNlbGVjdGAgZXhwcmVzc2lvbiB0byB0aGUgbW9kZWwsIGJ1dFxuXHQgKiB0aGUgdmFsdWUgb2YgdGhlIGA8c2VsZWN0PmAgYW5kIGA8b3B0aW9uPmAgaHRtbCBlbGVtZW50cyB3aWxsIGJlIGVpdGhlciB0aGUgaW5kZXggKGZvciBhcnJheSBkYXRhIHNvdXJjZXMpXG5cdCAqIG9yIHByb3BlcnR5IG5hbWUgKGZvciBvYmplY3QgZGF0YSBzb3VyY2VzKSBvZiB0aGUgdmFsdWUgd2l0aGluIHRoZSBjb2xsZWN0aW9uLiBJZiBhICoqYHRyYWNrIGJ5YCoqIGV4cHJlc3Npb25cblx0ICogaXMgdXNlZCwgdGhlIHJlc3VsdCBvZiB0aGF0IGV4cHJlc3Npb24gd2lsbCBiZSBzZXQgYXMgdGhlIHZhbHVlIG9mIHRoZSBgb3B0aW9uYCBhbmQgYHNlbGVjdGAgZWxlbWVudHMuXG5cdCAqXG5cdCAqXG5cdCAqICMjIyBgc2VsZWN0YCAqKmBhc2AqKiBhbmQgKipgdHJhY2sgYnlgKipcblx0ICpcblx0ICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cblx0ICogQmUgY2FyZWZ1bCB3aGVuIHVzaW5nIGBzZWxlY3RgICoqYGFzYCoqIGFuZCAqKmB0cmFjayBieWAqKiBpbiB0aGUgc2FtZSBleHByZXNzaW9uLlxuXHQgKiA8L2Rpdj5cblx0ICpcblx0ICogR2l2ZW4gdGhpcyBhcnJheSBvZiBpdGVtcyBvbiB0aGUgJHNjb3BlOlxuXHQgKlxuXHQgKiBgYGBqc1xuXHQgKiAkc2NvcGUuaXRlbXMgPSBbe1xuXHQgKiAgIGlkOiAxLFxuXHQgKiAgIGxhYmVsOiAnYUxhYmVsJyxcblx0ICogICBzdWJJdGVtOiB7IG5hbWU6ICdhU3ViSXRlbScgfVxuXHQgKiB9LCB7XG5cdCAqICAgaWQ6IDIsXG5cdCAqICAgbGFiZWw6ICdiTGFiZWwnLFxuXHQgKiAgIHN1Ykl0ZW06IHsgbmFtZTogJ2JTdWJJdGVtJyB9XG5cdCAqIH1dO1xuXHQgKiBgYGBcblx0ICpcblx0ICogVGhpcyB3aWxsIHdvcms6XG5cdCAqXG5cdCAqIGBgYGh0bWxcblx0ICogPHNlbGVjdCBuZy1vcHRpb25zPVwiaXRlbSBhcyBpdGVtLmxhYmVsIGZvciBpdGVtIGluIGl0ZW1zIHRyYWNrIGJ5IGl0ZW0uaWRcIiBuZy1tb2RlbD1cInNlbGVjdGVkXCI+PC9zZWxlY3Q+XG5cdCAqIGBgYFxuXHQgKiBgYGBqc1xuXHQgKiAkc2NvcGUuc2VsZWN0ZWQgPSAkc2NvcGUuaXRlbXNbMF07XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBidXQgdGhpcyB3aWxsIG5vdCB3b3JrOlxuXHQgKlxuXHQgKiBgYGBodG1sXG5cdCAqIDxzZWxlY3Qgbmctb3B0aW9ucz1cIml0ZW0uc3ViSXRlbSBhcyBpdGVtLmxhYmVsIGZvciBpdGVtIGluIGl0ZW1zIHRyYWNrIGJ5IGl0ZW0uaWRcIiBuZy1tb2RlbD1cInNlbGVjdGVkXCI+PC9zZWxlY3Q+XG5cdCAqIGBgYFxuXHQgKiBgYGBqc1xuXHQgKiAkc2NvcGUuc2VsZWN0ZWQgPSAkc2NvcGUuaXRlbXNbMF0uc3ViSXRlbTtcblx0ICogYGBgXG5cdCAqXG5cdCAqIEluIGJvdGggZXhhbXBsZXMsIHRoZSAqKmB0cmFjayBieWAqKiBleHByZXNzaW9uIGlzIGFwcGxpZWQgc3VjY2Vzc2Z1bGx5IHRvIGVhY2ggYGl0ZW1gIGluIHRoZVxuXHQgKiBgaXRlbXNgIGFycmF5LiBCZWNhdXNlIHRoZSBzZWxlY3RlZCBvcHRpb24gaGFzIGJlZW4gc2V0IHByb2dyYW1tYXRpY2FsbHkgaW4gdGhlIGNvbnRyb2xsZXIsIHRoZVxuXHQgKiAqKmB0cmFjayBieWAqKiBleHByZXNzaW9uIGlzIGFsc28gYXBwbGllZCB0byB0aGUgYG5nTW9kZWxgIHZhbHVlLiBJbiB0aGUgZmlyc3QgZXhhbXBsZSwgdGhlXG5cdCAqIGBuZ01vZGVsYCB2YWx1ZSBpcyBgaXRlbXNbMF1gIGFuZCB0aGUgKipgdHJhY2sgYnlgKiogZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYGl0ZW1zWzBdLmlkYCB3aXRoXG5cdCAqIG5vIGlzc3VlLiBJbiB0aGUgc2Vjb25kIGV4YW1wbGUsIHRoZSBgbmdNb2RlbGAgdmFsdWUgaXMgYGl0ZW1zWzBdLnN1Ykl0ZW1gIGFuZCB0aGUgKipgdHJhY2sgYnlgKipcblx0ICogZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYGl0ZW1zWzBdLnN1Ykl0ZW0uaWRgICh3aGljaCBpcyB1bmRlZmluZWQpLiBBcyBhIHJlc3VsdCwgdGhlIG1vZGVsIHZhbHVlXG5cdCAqIGlzIG5vdCBtYXRjaGVkIGFnYWluc3QgYW55IGA8b3B0aW9uPmAgYW5kIHRoZSBgPHNlbGVjdD5gIGFwcGVhcnMgYXMgaGF2aW5nIG5vIHNlbGVjdGVkIHZhbHVlLlxuXHQgKlxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gbmdNb2RlbCBBc3NpZ25hYmxlIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBkYXRhLWJpbmQgdG8uXG5cdCAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cblx0ICogQHBhcmFtIHtzdHJpbmc9fSByZXF1aXJlZCBUaGUgY29udHJvbCBpcyBjb25zaWRlcmVkIHZhbGlkIG9ubHkgaWYgdmFsdWUgaXMgZW50ZXJlZC5cblx0ICogQHBhcmFtIHtzdHJpbmc9fSBuZ1JlcXVpcmVkIEFkZHMgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgYW5kIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvXG5cdCAqICAgIHRoZSBlbGVtZW50IHdoZW4gdGhlIG5nUmVxdWlyZWQgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gdHJ1ZS4gVXNlIGBuZ1JlcXVpcmVkYCBpbnN0ZWFkIG9mXG5cdCAqICAgIGByZXF1aXJlZGAgd2hlbiB5b3Ugd2FudCB0byBkYXRhLWJpbmQgdG8gdGhlIGByZXF1aXJlZGAgYXR0cmlidXRlLlxuXHQgKiBAcGFyYW0ge2NvbXByZWhlbnNpb25fZXhwcmVzc2lvbj19IG5nT3B0aW9ucyBpbiBvbmUgb2YgdGhlIGZvbGxvd2luZyBmb3Jtczpcblx0ICpcblx0ICogICAqIGZvciBhcnJheSBkYXRhIHNvdXJjZXM6XG5cdCAqICAgICAqIGBsYWJlbGAgKipgZm9yYCoqIGB2YWx1ZWAgKipgaW5gKiogYGFycmF5YFxuXHQgKiAgICAgKiBgc2VsZWN0YCAqKmBhc2AqKiBgbGFiZWxgICoqYGZvcmAqKiBgdmFsdWVgICoqYGluYCoqIGBhcnJheWBcblx0ICogICAgICogYGxhYmVsYCAqKmBncm91cCBieWAqKiBgZ3JvdXBgICoqYGZvcmAqKiBgdmFsdWVgICoqYGluYCoqIGBhcnJheWBcblx0ICogICAgICogYGxhYmVsYCAqKmBkaXNhYmxlIHdoZW5gKiogYGRpc2FibGVgICoqYGZvcmAqKiBgdmFsdWVgICoqYGluYCoqIGBhcnJheWBcblx0ICogICAgICogYGxhYmVsYCAqKmBncm91cCBieWAqKiBgZ3JvdXBgICoqYGZvcmAqKiBgdmFsdWVgICoqYGluYCoqIGBhcnJheWAgKipgdHJhY2sgYnlgKiogYHRyYWNrZXhwcmBcblx0ICogICAgICogYGxhYmVsYCAqKmBkaXNhYmxlIHdoZW5gKiogYGRpc2FibGVgICoqYGZvcmAqKiBgdmFsdWVgICoqYGluYCoqIGBhcnJheWAgKipgdHJhY2sgYnlgKiogYHRyYWNrZXhwcmBcblx0ICogICAgICogYGxhYmVsYCAqKmBmb3JgKiogYHZhbHVlYCAqKmBpbmAqKiBgYXJyYXlgIHwgb3JkZXJCeTpgb3JkZXJleHByYCAqKmB0cmFjayBieWAqKiBgdHJhY2tleHByYFxuXHQgKiAgICAgICAgKGZvciBpbmNsdWRpbmcgYSBmaWx0ZXIgd2l0aCBgdHJhY2sgYnlgKVxuXHQgKiAgICogZm9yIG9iamVjdCBkYXRhIHNvdXJjZXM6XG5cdCAqICAgICAqIGBsYWJlbGAgKipgZm9yIChgKipga2V5YCAqKmAsYCoqIGB2YWx1ZWAqKmApIGluYCoqIGBvYmplY3RgXG5cdCAqICAgICAqIGBzZWxlY3RgICoqYGFzYCoqIGBsYWJlbGAgKipgZm9yIChgKipga2V5YCAqKmAsYCoqIGB2YWx1ZWAqKmApIGluYCoqIGBvYmplY3RgXG5cdCAqICAgICAqIGBsYWJlbGAgKipgZ3JvdXAgYnlgKiogYGdyb3VwYCAqKmBmb3IgKGAqKmBrZXlgKipgLGAqKiBgdmFsdWVgKipgKSBpbmAqKiBgb2JqZWN0YFxuXHQgKiAgICAgKiBgbGFiZWxgICoqYGRpc2FibGUgd2hlbmAqKiBgZGlzYWJsZWAgKipgZm9yIChgKipga2V5YCoqYCxgKiogYHZhbHVlYCoqYCkgaW5gKiogYG9iamVjdGBcblx0ICogICAgICogYHNlbGVjdGAgKipgYXNgKiogYGxhYmVsYCAqKmBncm91cCBieWAqKiBgZ3JvdXBgXG5cdCAqICAgICAgICAgKipgZm9yYCBgKGAqKmBrZXlgKipgLGAqKiBgdmFsdWVgKipgKSBpbmAqKiBgb2JqZWN0YFxuXHQgKiAgICAgKiBgc2VsZWN0YCAqKmBhc2AqKiBgbGFiZWxgICoqYGRpc2FibGUgd2hlbmAqKiBgZGlzYWJsZWBcblx0ICogICAgICAgICAqKmBmb3JgIGAoYCoqYGtleWAqKmAsYCoqIGB2YWx1ZWAqKmApIGluYCoqIGBvYmplY3RgXG5cdCAqXG5cdCAqIFdoZXJlOlxuXHQgKlxuXHQgKiAgICogYGFycmF5YCAvIGBvYmplY3RgOiBhbiBleHByZXNzaW9uIHdoaWNoIGV2YWx1YXRlcyB0byBhbiBhcnJheSAvIG9iamVjdCB0byBpdGVyYXRlIG92ZXIuXG5cdCAqICAgKiBgdmFsdWVgOiBsb2NhbCB2YXJpYWJsZSB3aGljaCB3aWxsIHJlZmVyIHRvIGVhY2ggaXRlbSBpbiB0aGUgYGFycmF5YCBvciBlYWNoIHByb3BlcnR5IHZhbHVlXG5cdCAqICAgICAgb2YgYG9iamVjdGAgZHVyaW5nIGl0ZXJhdGlvbi5cblx0ICogICAqIGBrZXlgOiBsb2NhbCB2YXJpYWJsZSB3aGljaCB3aWxsIHJlZmVyIHRvIGEgcHJvcGVydHkgbmFtZSBpbiBgb2JqZWN0YCBkdXJpbmcgaXRlcmF0aW9uLlxuXHQgKiAgICogYGxhYmVsYDogVGhlIHJlc3VsdCBvZiB0aGlzIGV4cHJlc3Npb24gd2lsbCBiZSB0aGUgbGFiZWwgZm9yIGA8b3B0aW9uPmAgZWxlbWVudC4gVGhlXG5cdCAqICAgICBgZXhwcmVzc2lvbmAgd2lsbCBtb3N0IGxpa2VseSByZWZlciB0byB0aGUgYHZhbHVlYCB2YXJpYWJsZSAoZS5nLiBgdmFsdWUucHJvcGVydHlOYW1lYCkuXG5cdCAqICAgKiBgc2VsZWN0YDogVGhlIHJlc3VsdCBvZiB0aGlzIGV4cHJlc3Npb24gd2lsbCBiZSBib3VuZCB0byB0aGUgbW9kZWwgb2YgdGhlIHBhcmVudCBgPHNlbGVjdD5gXG5cdCAqICAgICAgZWxlbWVudC4gSWYgbm90IHNwZWNpZmllZCwgYHNlbGVjdGAgZXhwcmVzc2lvbiB3aWxsIGRlZmF1bHQgdG8gYHZhbHVlYC5cblx0ICogICAqIGBncm91cGA6IFRoZSByZXN1bHQgb2YgdGhpcyBleHByZXNzaW9uIHdpbGwgYmUgdXNlZCB0byBncm91cCBvcHRpb25zIHVzaW5nIHRoZSBgPG9wdGdyb3VwPmBcblx0ICogICAgICBET00gZWxlbWVudC5cblx0ICogICAqIGBkaXNhYmxlYDogVGhlIHJlc3VsdCBvZiB0aGlzIGV4cHJlc3Npb24gd2lsbCBiZSB1c2VkIHRvIGRpc2FibGUgdGhlIHJlbmRlcmVkIGA8b3B0aW9uPmBcblx0ICogICAgICBlbGVtZW50LiBSZXR1cm4gYHRydWVgIHRvIGRpc2FibGUuXG5cdCAqICAgKiBgdHJhY2tleHByYDogVXNlZCB3aGVuIHdvcmtpbmcgd2l0aCBhbiBhcnJheSBvZiBvYmplY3RzLiBUaGUgcmVzdWx0IG9mIHRoaXMgZXhwcmVzc2lvbiB3aWxsIGJlXG5cdCAqICAgICAgdXNlZCB0byBpZGVudGlmeSB0aGUgb2JqZWN0cyBpbiB0aGUgYXJyYXkuIFRoZSBgdHJhY2tleHByYCB3aWxsIG1vc3QgbGlrZWx5IHJlZmVyIHRvIHRoZVxuXHQgKiAgICAgYHZhbHVlYCB2YXJpYWJsZSAoZS5nLiBgdmFsdWUucHJvcGVydHlOYW1lYCkuIFdpdGggdGhpcyB0aGUgc2VsZWN0aW9uIGlzIHByZXNlcnZlZFxuXHQgKiAgICAgIGV2ZW4gd2hlbiB0aGUgb3B0aW9ucyBhcmUgcmVjcmVhdGVkIChlLmcuIHJlbG9hZGVkIGZyb20gdGhlIHNlcnZlcikuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgICA8ZXhhbXBsZSBtb2R1bGU9XCJzZWxlY3RFeGFtcGxlXCI+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgPHNjcmlwdD5cblx0ICAgICAgICBhbmd1bGFyLm1vZHVsZSgnc2VsZWN0RXhhbXBsZScsIFtdKVxuXHQgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICAgJHNjb3BlLmNvbG9ycyA9IFtcblx0ICAgICAgICAgICAgICB7bmFtZTonYmxhY2snLCBzaGFkZTonZGFyayd9LFxuXHQgICAgICAgICAgICAgIHtuYW1lOid3aGl0ZScsIHNoYWRlOidsaWdodCcsIG5vdEFuT3B0aW9uOiB0cnVlfSxcblx0ICAgICAgICAgICAgICB7bmFtZToncmVkJywgc2hhZGU6J2RhcmsnfSxcblx0ICAgICAgICAgICAgICB7bmFtZTonYmx1ZScsIHNoYWRlOidkYXJrJywgbm90QW5PcHRpb246IHRydWV9LFxuXHQgICAgICAgICAgICAgIHtuYW1lOid5ZWxsb3cnLCBzaGFkZTonbGlnaHQnLCBub3RBbk9wdGlvbjogZmFsc2V9XG5cdCAgICAgICAgICAgIF07XG5cdCAgICAgICAgICAgICRzY29wZS5teUNvbG9yID0gJHNjb3BlLmNvbG9yc1syXTsgLy8gcmVkXG5cdCAgICAgICAgICB9XSk7XG5cdCAgICAgICAgPC9zY3JpcHQ+XG5cdCAgICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgICAgIDx1bD5cblx0ICAgICAgICAgICAgPGxpIG5nLXJlcGVhdD1cImNvbG9yIGluIGNvbG9yc1wiPlxuXHQgICAgICAgICAgICAgIDxsYWJlbD5OYW1lOiA8aW5wdXQgbmctbW9kZWw9XCJjb2xvci5uYW1lXCI+PC9sYWJlbD5cblx0ICAgICAgICAgICAgICA8bGFiZWw+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiY29sb3Iubm90QW5PcHRpb25cIj4gRGlzYWJsZWQ/PC9sYWJlbD5cblx0ICAgICAgICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwiY29sb3JzLnNwbGljZSgkaW5kZXgsIDEpXCIgYXJpYS1sYWJlbD1cIlJlbW92ZVwiPlg8L2J1dHRvbj5cblx0ICAgICAgICAgICAgPC9saT5cblx0ICAgICAgICAgICAgPGxpPlxuXHQgICAgICAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJjb2xvcnMucHVzaCh7fSlcIj5hZGQ8L2J1dHRvbj5cblx0ICAgICAgICAgICAgPC9saT5cblx0ICAgICAgICAgIDwvdWw+XG5cdCAgICAgICAgICA8aHIvPlxuXHQgICAgICAgICAgPGxhYmVsPkNvbG9yIChudWxsIG5vdCBhbGxvd2VkKTpcblx0ICAgICAgICAgICAgPHNlbGVjdCBuZy1tb2RlbD1cIm15Q29sb3JcIiBuZy1vcHRpb25zPVwiY29sb3IubmFtZSBmb3IgY29sb3IgaW4gY29sb3JzXCI+PC9zZWxlY3Q+XG5cdCAgICAgICAgICA8L2xhYmVsPjxici8+XG5cdCAgICAgICAgICA8bGFiZWw+Q29sb3IgKG51bGwgYWxsb3dlZCk6XG5cdCAgICAgICAgICA8c3BhbiAgY2xhc3M9XCJudWxsYWJsZVwiPlxuXHQgICAgICAgICAgICA8c2VsZWN0IG5nLW1vZGVsPVwibXlDb2xvclwiIG5nLW9wdGlvbnM9XCJjb2xvci5uYW1lIGZvciBjb2xvciBpbiBjb2xvcnNcIj5cblx0ICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiXCI+LS0gY2hvb3NlIGNvbG9yIC0tPC9vcHRpb24+XG5cdCAgICAgICAgICAgIDwvc2VsZWN0PlxuXHQgICAgICAgICAgPC9zcGFuPjwvbGFiZWw+PGJyLz5cblx0XG5cdCAgICAgICAgICA8bGFiZWw+Q29sb3IgZ3JvdXBlZCBieSBzaGFkZTpcblx0ICAgICAgICAgICAgPHNlbGVjdCBuZy1tb2RlbD1cIm15Q29sb3JcIiBuZy1vcHRpb25zPVwiY29sb3IubmFtZSBncm91cCBieSBjb2xvci5zaGFkZSBmb3IgY29sb3IgaW4gY29sb3JzXCI+XG5cdCAgICAgICAgICAgIDwvc2VsZWN0PlxuXHQgICAgICAgICAgPC9sYWJlbD48YnIvPlxuXHRcblx0ICAgICAgICAgIDxsYWJlbD5Db2xvciBncm91cGVkIGJ5IHNoYWRlLCB3aXRoIHNvbWUgZGlzYWJsZWQ6XG5cdCAgICAgICAgICAgIDxzZWxlY3QgbmctbW9kZWw9XCJteUNvbG9yXCJcblx0ICAgICAgICAgICAgICAgICAgbmctb3B0aW9ucz1cImNvbG9yLm5hbWUgZ3JvdXAgYnkgY29sb3Iuc2hhZGUgZGlzYWJsZSB3aGVuIGNvbG9yLm5vdEFuT3B0aW9uIGZvciBjb2xvciBpbiBjb2xvcnNcIj5cblx0ICAgICAgICAgICAgPC9zZWxlY3Q+XG5cdCAgICAgICAgICA8L2xhYmVsPjxici8+XG5cdFxuXHRcblx0XG5cdCAgICAgICAgICBTZWxlY3QgPGJ1dHRvbiBuZy1jbGljaz1cIm15Q29sb3IgPSB7IG5hbWU6J25vdCBpbiBsaXN0Jywgc2hhZGU6ICdvdGhlcicgfVwiPmJvZ3VzPC9idXR0b24+LlxuXHQgICAgICAgICAgPGJyLz5cblx0ICAgICAgICAgIDxoci8+XG5cdCAgICAgICAgICBDdXJyZW50bHkgc2VsZWN0ZWQ6IHt7IHtzZWxlY3RlZF9jb2xvcjpteUNvbG9yfSB9fVxuXHQgICAgICAgICAgPGRpdiBzdHlsZT1cImJvcmRlcjpzb2xpZCAxcHggYmxhY2s7IGhlaWdodDoyMHB4XCJcblx0ICAgICAgICAgICAgICAgbmctc3R5bGU9XCJ7J2JhY2tncm91bmQtY29sb3InOm15Q29sb3IubmFtZX1cIj5cblx0ICAgICAgICAgIDwvZGl2PlxuXHQgICAgICAgIDwvZGl2PlxuXHQgICAgICA8L2ZpbGU+XG5cdCAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1vcHRpb25zJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygne3NlbGVjdGVkX2NvbG9yOm15Q29sb3J9JykpLmdldFRleHQoKSkudG9NYXRjaCgncmVkJyk7XG5cdCAgICAgICAgICAgZWxlbWVudC5hbGwoYnkubW9kZWwoJ215Q29sb3InKSkuZmlyc3QoKS5jbGljaygpO1xuXHQgICAgICAgICAgIGVsZW1lbnQuYWxsKGJ5LmNzcygnc2VsZWN0W25nLW1vZGVsPVwibXlDb2xvclwiXSBvcHRpb24nKSkuZmlyc3QoKS5jbGljaygpO1xuXHQgICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ3tzZWxlY3RlZF9jb2xvcjpteUNvbG9yfScpKS5nZXRUZXh0KCkpLnRvTWF0Y2goJ2JsYWNrJyk7XG5cdCAgICAgICAgICAgZWxlbWVudChieS5jc3MoJy5udWxsYWJsZSBzZWxlY3RbbmctbW9kZWw9XCJteUNvbG9yXCJdJykpLmNsaWNrKCk7XG5cdCAgICAgICAgICAgZWxlbWVudC5hbGwoYnkuY3NzKCcubnVsbGFibGUgc2VsZWN0W25nLW1vZGVsPVwibXlDb2xvclwiXSBvcHRpb24nKSkuZmlyc3QoKS5jbGljaygpO1xuXHQgICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ3tzZWxlY3RlZF9jb2xvcjpteUNvbG9yfScpKS5nZXRUZXh0KCkpLnRvTWF0Y2goJ251bGwnKTtcblx0ICAgICAgICAgfSk7XG5cdCAgICAgIDwvZmlsZT5cblx0ICAgIDwvZXhhbXBsZT5cblx0ICovXG5cdFxuXHQvLyBqc2hpbnQgbWF4bGVuOiBmYWxzZVxuXHQvLyAgICAgICAgICAgICAgICAgICAgIC8vMDAwMDExMTExMTExMTEwMDAwMDAwMDAwMDIyMjIyMjIyMjIwMDAwMDAwMDAwMDAwMDAwMDAwMDAzMzMzMzMzMzMzMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQ0NDQ0NDQ0NDQ0MDAwMDAwMDAwMDAwMDU1NTU1NTU1NTU1NTU1NTAwMDAwMDAwMDY2NjY2NjY2NjY2NjY2NjAwMDAwMDA3Nzc3Nzc3Nzc3Nzc3NzcwMDAwMDAwMDAwMDAwMDA4ODg4ODg4ODg4MDAwMDAwMDAwMDAwMDAwMDAwMDk5OTk5OTk5OTlcblx0dmFyIE5HX09QVElPTlNfUkVHRVhQID0gL15cXHMqKFtcXHNcXFNdKz8pKD86XFxzK2FzXFxzKyhbXFxzXFxTXSs/KSk/KD86XFxzK2dyb3VwXFxzK2J5XFxzKyhbXFxzXFxTXSs/KSk/KD86XFxzK2Rpc2FibGVcXHMrd2hlblxccysoW1xcc1xcU10rPykpP1xccytmb3JcXHMrKD86KFtcXCRcXHddW1xcJFxcd10qKXwoPzpcXChcXHMqKFtcXCRcXHddW1xcJFxcd10qKVxccyosXFxzKihbXFwkXFx3XVtcXCRcXHddKilcXHMqXFwpKSlcXHMraW5cXHMrKFtcXHNcXFNdKz8pKD86XFxzK3RyYWNrXFxzK2J5XFxzKyhbXFxzXFxTXSs/KSk/JC87XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIDE6IHZhbHVlIGV4cHJlc3Npb24gKHZhbHVlRm4pXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIDI6IGxhYmVsIGV4cHJlc3Npb24gKGRpc3BsYXlGbilcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gMzogZ3JvdXAgYnkgZXhwcmVzc2lvbiAoZ3JvdXBCeUZuKVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyA0OiBkaXNhYmxlIHdoZW4gZXhwcmVzc2lvbiAoZGlzYWJsZVdoZW5Gbilcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gNTogYXJyYXkgaXRlbSB2YXJpYWJsZSBuYW1lXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIDY6IG9iamVjdCBpdGVtIGtleSB2YXJpYWJsZSBuYW1lXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIDc6IG9iamVjdCBpdGVtIHZhbHVlIHZhcmlhYmxlIG5hbWVcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gODogY29sbGVjdGlvbiBleHByZXNzaW9uXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIDk6IHRyYWNrIGJ5IGV4cHJlc3Npb25cblx0Ly8ganNoaW50IG1heGxlbjogMTAwXG5cdFxuXHRcblx0dmFyIG5nT3B0aW9uc0RpcmVjdGl2ZSA9IFsnJGNvbXBpbGUnLCAnJHBhcnNlJywgZnVuY3Rpb24oJGNvbXBpbGUsICRwYXJzZSkge1xuXHRcblx0ICBmdW5jdGlvbiBwYXJzZU9wdGlvbnNFeHByZXNzaW9uKG9wdGlvbnNFeHAsIHNlbGVjdEVsZW1lbnQsIHNjb3BlKSB7XG5cdFxuXHQgICAgdmFyIG1hdGNoID0gb3B0aW9uc0V4cC5tYXRjaChOR19PUFRJT05TX1JFR0VYUCk7XG5cdCAgICBpZiAoIShtYXRjaCkpIHtcblx0ICAgICAgdGhyb3cgbmdPcHRpb25zTWluRXJyKCdpZXhwJyxcblx0ICAgICAgICBcIkV4cGVjdGVkIGV4cHJlc3Npb24gaW4gZm9ybSBvZiBcIiArXG5cdCAgICAgICAgXCInX3NlbGVjdF8gKGFzIF9sYWJlbF8pPyBmb3IgKF9rZXlfLCk/X3ZhbHVlXyBpbiBfY29sbGVjdGlvbl8nXCIgK1xuXHQgICAgICAgIFwiIGJ1dCBnb3QgJ3swfScuIEVsZW1lbnQ6IHsxfVwiLFxuXHQgICAgICAgIG9wdGlvbnNFeHAsIHN0YXJ0aW5nVGFnKHNlbGVjdEVsZW1lbnQpKTtcblx0ICAgIH1cblx0XG5cdCAgICAvLyBFeHRyYWN0IHRoZSBwYXJ0cyBmcm9tIHRoZSBuZ09wdGlvbnMgZXhwcmVzc2lvblxuXHRcblx0ICAgIC8vIFRoZSB2YXJpYWJsZSBuYW1lIGZvciB0aGUgdmFsdWUgb2YgdGhlIGl0ZW0gaW4gdGhlIGNvbGxlY3Rpb25cblx0ICAgIHZhciB2YWx1ZU5hbWUgPSBtYXRjaFs1XSB8fCBtYXRjaFs3XTtcblx0ICAgIC8vIFRoZSB2YXJpYWJsZSBuYW1lIGZvciB0aGUga2V5IG9mIHRoZSBpdGVtIGluIHRoZSBjb2xsZWN0aW9uXG5cdCAgICB2YXIga2V5TmFtZSA9IG1hdGNoWzZdO1xuXHRcblx0ICAgIC8vIEFuIGV4cHJlc3Npb24gdGhhdCBnZW5lcmF0ZXMgdGhlIHZpZXdWYWx1ZSBmb3IgYW4gb3B0aW9uIGlmIHRoZXJlIGlzIGEgbGFiZWwgZXhwcmVzc2lvblxuXHQgICAgdmFyIHNlbGVjdEFzID0gLyBhcyAvLnRlc3QobWF0Y2hbMF0pICYmIG1hdGNoWzFdO1xuXHQgICAgLy8gQW4gZXhwcmVzc2lvbiB0aGF0IGlzIHVzZWQgdG8gdHJhY2sgdGhlIGlkIG9mIGVhY2ggb2JqZWN0IGluIHRoZSBvcHRpb25zIGNvbGxlY3Rpb25cblx0ICAgIHZhciB0cmFja0J5ID0gbWF0Y2hbOV07XG5cdCAgICAvLyBBbiBleHByZXNzaW9uIHRoYXQgZ2VuZXJhdGVzIHRoZSB2aWV3VmFsdWUgZm9yIGFuIG9wdGlvbiBpZiB0aGVyZSBpcyBubyBsYWJlbCBleHByZXNzaW9uXG5cdCAgICB2YXIgdmFsdWVGbiA9ICRwYXJzZShtYXRjaFsyXSA/IG1hdGNoWzFdIDogdmFsdWVOYW1lKTtcblx0ICAgIHZhciBzZWxlY3RBc0ZuID0gc2VsZWN0QXMgJiYgJHBhcnNlKHNlbGVjdEFzKTtcblx0ICAgIHZhciB2aWV3VmFsdWVGbiA9IHNlbGVjdEFzRm4gfHwgdmFsdWVGbjtcblx0ICAgIHZhciB0cmFja0J5Rm4gPSB0cmFja0J5ICYmICRwYXJzZSh0cmFja0J5KTtcblx0XG5cdCAgICAvLyBHZXQgdGhlIHZhbHVlIGJ5IHdoaWNoIHdlIGFyZSBnb2luZyB0byB0cmFjayB0aGUgb3B0aW9uXG5cdCAgICAvLyBpZiB3ZSBoYXZlIGEgdHJhY2tGbiB0aGVuIHVzZSB0aGF0IChwYXNzaW5nIHNjb3BlIGFuZCBsb2NhbHMpXG5cdCAgICAvLyBvdGhlcndpc2UganVzdCBoYXNoIHRoZSBnaXZlbiB2aWV3VmFsdWVcblx0ICAgIHZhciBnZXRUcmFja0J5VmFsdWVGbiA9IHRyYWNrQnkgP1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbih2YWx1ZSwgbG9jYWxzKSB7IHJldHVybiB0cmFja0J5Rm4oc2NvcGUsIGxvY2Fscyk7IH0gOlxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRIYXNoT2ZWYWx1ZSh2YWx1ZSkgeyByZXR1cm4gaGFzaEtleSh2YWx1ZSk7IH07XG5cdCAgICB2YXIgZ2V0VHJhY2tCeVZhbHVlID0gZnVuY3Rpb24odmFsdWUsIGtleSkge1xuXHQgICAgICByZXR1cm4gZ2V0VHJhY2tCeVZhbHVlRm4odmFsdWUsIGdldExvY2Fscyh2YWx1ZSwga2V5KSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHZhciBkaXNwbGF5Rm4gPSAkcGFyc2UobWF0Y2hbMl0gfHwgbWF0Y2hbMV0pO1xuXHQgICAgdmFyIGdyb3VwQnlGbiA9ICRwYXJzZShtYXRjaFszXSB8fCAnJyk7XG5cdCAgICB2YXIgZGlzYWJsZVdoZW5GbiA9ICRwYXJzZShtYXRjaFs0XSB8fCAnJyk7XG5cdCAgICB2YXIgdmFsdWVzRm4gPSAkcGFyc2UobWF0Y2hbOF0pO1xuXHRcblx0ICAgIHZhciBsb2NhbHMgPSB7fTtcblx0ICAgIHZhciBnZXRMb2NhbHMgPSBrZXlOYW1lID8gZnVuY3Rpb24odmFsdWUsIGtleSkge1xuXHQgICAgICBsb2NhbHNba2V5TmFtZV0gPSBrZXk7XG5cdCAgICAgIGxvY2Fsc1t2YWx1ZU5hbWVdID0gdmFsdWU7XG5cdCAgICAgIHJldHVybiBsb2NhbHM7XG5cdCAgICB9IDogZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgbG9jYWxzW3ZhbHVlTmFtZV0gPSB2YWx1ZTtcblx0ICAgICAgcmV0dXJuIGxvY2Fscztcblx0ICAgIH07XG5cdFxuXHRcblx0ICAgIGZ1bmN0aW9uIE9wdGlvbihzZWxlY3RWYWx1ZSwgdmlld1ZhbHVlLCBsYWJlbCwgZ3JvdXAsIGRpc2FibGVkKSB7XG5cdCAgICAgIHRoaXMuc2VsZWN0VmFsdWUgPSBzZWxlY3RWYWx1ZTtcblx0ICAgICAgdGhpcy52aWV3VmFsdWUgPSB2aWV3VmFsdWU7XG5cdCAgICAgIHRoaXMubGFiZWwgPSBsYWJlbDtcblx0ICAgICAgdGhpcy5ncm91cCA9IGdyb3VwO1xuXHQgICAgICB0aGlzLmRpc2FibGVkID0gZGlzYWJsZWQ7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gZ2V0T3B0aW9uVmFsdWVzS2V5cyhvcHRpb25WYWx1ZXMpIHtcblx0ICAgICAgdmFyIG9wdGlvblZhbHVlc0tleXM7XG5cdFxuXHQgICAgICBpZiAoIWtleU5hbWUgJiYgaXNBcnJheUxpa2Uob3B0aW9uVmFsdWVzKSkge1xuXHQgICAgICAgIG9wdGlvblZhbHVlc0tleXMgPSBvcHRpb25WYWx1ZXM7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgLy8gaWYgb2JqZWN0LCBleHRyYWN0IGtleXMsIGluIGVudW1lcmF0aW9uIG9yZGVyLCB1bnNvcnRlZFxuXHQgICAgICAgIG9wdGlvblZhbHVlc0tleXMgPSBbXTtcblx0ICAgICAgICBmb3IgKHZhciBpdGVtS2V5IGluIG9wdGlvblZhbHVlcykge1xuXHQgICAgICAgICAgaWYgKG9wdGlvblZhbHVlcy5oYXNPd25Qcm9wZXJ0eShpdGVtS2V5KSAmJiBpdGVtS2V5LmNoYXJBdCgwKSAhPT0gJyQnKSB7XG5cdCAgICAgICAgICAgIG9wdGlvblZhbHVlc0tleXMucHVzaChpdGVtS2V5KTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIG9wdGlvblZhbHVlc0tleXM7XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIHtcblx0ICAgICAgdHJhY2tCeTogdHJhY2tCeSxcblx0ICAgICAgZ2V0VHJhY2tCeVZhbHVlOiBnZXRUcmFja0J5VmFsdWUsXG5cdCAgICAgIGdldFdhdGNoYWJsZXM6ICRwYXJzZSh2YWx1ZXNGbiwgZnVuY3Rpb24ob3B0aW9uVmFsdWVzKSB7XG5cdCAgICAgICAgLy8gQ3JlYXRlIGEgY29sbGVjdGlvbiBvZiB0aGluZ3MgdGhhdCB3ZSB3b3VsZCBsaWtlIHRvIHdhdGNoICh3YXRjaGVkQXJyYXkpXG5cdCAgICAgICAgLy8gc28gdGhhdCB0aGV5IGNhbiBhbGwgYmUgd2F0Y2hlZCB1c2luZyBhIHNpbmdsZSAkd2F0Y2hDb2xsZWN0aW9uXG5cdCAgICAgICAgLy8gdGhhdCBvbmx5IHJ1bnMgdGhlIGhhbmRsZXIgb25jZSBpZiBhbnl0aGluZyBjaGFuZ2VzXG5cdCAgICAgICAgdmFyIHdhdGNoZWRBcnJheSA9IFtdO1xuXHQgICAgICAgIG9wdGlvblZhbHVlcyA9IG9wdGlvblZhbHVlcyB8fCBbXTtcblx0XG5cdCAgICAgICAgdmFyIG9wdGlvblZhbHVlc0tleXMgPSBnZXRPcHRpb25WYWx1ZXNLZXlzKG9wdGlvblZhbHVlcyk7XG5cdCAgICAgICAgdmFyIG9wdGlvblZhbHVlc0xlbmd0aCA9IG9wdGlvblZhbHVlc0tleXMubGVuZ3RoO1xuXHQgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBvcHRpb25WYWx1ZXNMZW5ndGg7IGluZGV4KyspIHtcblx0ICAgICAgICAgIHZhciBrZXkgPSAob3B0aW9uVmFsdWVzID09PSBvcHRpb25WYWx1ZXNLZXlzKSA/IGluZGV4IDogb3B0aW9uVmFsdWVzS2V5c1tpbmRleF07XG5cdCAgICAgICAgICB2YXIgdmFsdWUgPSBvcHRpb25WYWx1ZXNba2V5XTtcblx0XG5cdCAgICAgICAgICB2YXIgbG9jYWxzID0gZ2V0TG9jYWxzKG9wdGlvblZhbHVlc1trZXldLCBrZXkpO1xuXHQgICAgICAgICAgdmFyIHNlbGVjdFZhbHVlID0gZ2V0VHJhY2tCeVZhbHVlRm4ob3B0aW9uVmFsdWVzW2tleV0sIGxvY2Fscyk7XG5cdCAgICAgICAgICB3YXRjaGVkQXJyYXkucHVzaChzZWxlY3RWYWx1ZSk7XG5cdFxuXHQgICAgICAgICAgLy8gT25seSBuZWVkIHRvIHdhdGNoIHRoZSBkaXNwbGF5Rm4gaWYgdGhlcmUgaXMgYSBzcGVjaWZpYyBsYWJlbCBleHByZXNzaW9uXG5cdCAgICAgICAgICBpZiAobWF0Y2hbMl0gfHwgbWF0Y2hbMV0pIHtcblx0ICAgICAgICAgICAgdmFyIGxhYmVsID0gZGlzcGxheUZuKHNjb3BlLCBsb2NhbHMpO1xuXHQgICAgICAgICAgICB3YXRjaGVkQXJyYXkucHVzaChsYWJlbCk7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgLy8gT25seSBuZWVkIHRvIHdhdGNoIHRoZSBkaXNhYmxlV2hlbkZuIGlmIHRoZXJlIGlzIGEgc3BlY2lmaWMgZGlzYWJsZSBleHByZXNzaW9uXG5cdCAgICAgICAgICBpZiAobWF0Y2hbNF0pIHtcblx0ICAgICAgICAgICAgdmFyIGRpc2FibGVXaGVuID0gZGlzYWJsZVdoZW5GbihzY29wZSwgbG9jYWxzKTtcblx0ICAgICAgICAgICAgd2F0Y2hlZEFycmF5LnB1c2goZGlzYWJsZVdoZW4pO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gd2F0Y2hlZEFycmF5O1xuXHQgICAgICB9KSxcblx0XG5cdCAgICAgIGdldE9wdGlvbnM6IGZ1bmN0aW9uKCkge1xuXHRcblx0ICAgICAgICB2YXIgb3B0aW9uSXRlbXMgPSBbXTtcblx0ICAgICAgICB2YXIgc2VsZWN0VmFsdWVNYXAgPSB7fTtcblx0XG5cdCAgICAgICAgLy8gVGhlIG9wdGlvbiB2YWx1ZXMgd2VyZSBhbHJlYWR5IGNvbXB1dGVkIGluIHRoZSBgZ2V0V2F0Y2hhYmxlc2AgZm4sXG5cdCAgICAgICAgLy8gd2hpY2ggbXVzdCBoYXZlIGJlZW4gY2FsbGVkIHRvIHRyaWdnZXIgYGdldE9wdGlvbnNgXG5cdCAgICAgICAgdmFyIG9wdGlvblZhbHVlcyA9IHZhbHVlc0ZuKHNjb3BlKSB8fCBbXTtcblx0ICAgICAgICB2YXIgb3B0aW9uVmFsdWVzS2V5cyA9IGdldE9wdGlvblZhbHVlc0tleXMob3B0aW9uVmFsdWVzKTtcblx0ICAgICAgICB2YXIgb3B0aW9uVmFsdWVzTGVuZ3RoID0gb3B0aW9uVmFsdWVzS2V5cy5sZW5ndGg7XG5cdFxuXHQgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBvcHRpb25WYWx1ZXNMZW5ndGg7IGluZGV4KyspIHtcblx0ICAgICAgICAgIHZhciBrZXkgPSAob3B0aW9uVmFsdWVzID09PSBvcHRpb25WYWx1ZXNLZXlzKSA/IGluZGV4IDogb3B0aW9uVmFsdWVzS2V5c1tpbmRleF07XG5cdCAgICAgICAgICB2YXIgdmFsdWUgPSBvcHRpb25WYWx1ZXNba2V5XTtcblx0ICAgICAgICAgIHZhciBsb2NhbHMgPSBnZXRMb2NhbHModmFsdWUsIGtleSk7XG5cdCAgICAgICAgICB2YXIgdmlld1ZhbHVlID0gdmlld1ZhbHVlRm4oc2NvcGUsIGxvY2Fscyk7XG5cdCAgICAgICAgICB2YXIgc2VsZWN0VmFsdWUgPSBnZXRUcmFja0J5VmFsdWVGbih2aWV3VmFsdWUsIGxvY2Fscyk7XG5cdCAgICAgICAgICB2YXIgbGFiZWwgPSBkaXNwbGF5Rm4oc2NvcGUsIGxvY2Fscyk7XG5cdCAgICAgICAgICB2YXIgZ3JvdXAgPSBncm91cEJ5Rm4oc2NvcGUsIGxvY2Fscyk7XG5cdCAgICAgICAgICB2YXIgZGlzYWJsZWQgPSBkaXNhYmxlV2hlbkZuKHNjb3BlLCBsb2NhbHMpO1xuXHQgICAgICAgICAgdmFyIG9wdGlvbkl0ZW0gPSBuZXcgT3B0aW9uKHNlbGVjdFZhbHVlLCB2aWV3VmFsdWUsIGxhYmVsLCBncm91cCwgZGlzYWJsZWQpO1xuXHRcblx0ICAgICAgICAgIG9wdGlvbkl0ZW1zLnB1c2gob3B0aW9uSXRlbSk7XG5cdCAgICAgICAgICBzZWxlY3RWYWx1ZU1hcFtzZWxlY3RWYWx1ZV0gPSBvcHRpb25JdGVtO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgIGl0ZW1zOiBvcHRpb25JdGVtcyxcblx0ICAgICAgICAgIHNlbGVjdFZhbHVlTWFwOiBzZWxlY3RWYWx1ZU1hcCxcblx0ICAgICAgICAgIGdldE9wdGlvbkZyb21WaWV3VmFsdWU6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBzZWxlY3RWYWx1ZU1hcFtnZXRUcmFja0J5VmFsdWUodmFsdWUpXTtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBnZXRWaWV3VmFsdWVGcm9tT3B0aW9uOiBmdW5jdGlvbihvcHRpb24pIHtcblx0ICAgICAgICAgICAgLy8gSWYgdGhlIHZpZXdWYWx1ZSBjb3VsZCBiZSBhbiBvYmplY3QgdGhhdCBtYXkgYmUgbXV0YXRlZCBieSB0aGUgYXBwbGljYXRpb24sXG5cdCAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gbWFrZSBhIGNvcHkgYW5kIG5vdCByZXR1cm4gdGhlIHJlZmVyZW5jZSB0byB0aGUgdmFsdWUgb24gdGhlIG9wdGlvbi5cblx0ICAgICAgICAgICAgcmV0dXJuIHRyYWNrQnkgPyBhbmd1bGFyLmNvcHkob3B0aW9uLnZpZXdWYWx1ZSkgOiBvcHRpb24udmlld1ZhbHVlO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH07XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgfVxuXHRcblx0XG5cdCAgLy8gd2UgY2FuJ3QganVzdCBqcUxpdGUoJzxvcHRpb24+Jykgc2luY2UganFMaXRlIGlzIG5vdCBzbWFydCBlbm91Z2hcblx0ICAvLyB0byBjcmVhdGUgaXQgaW4gPHNlbGVjdD4gYW5kIElFIGJhcmZzIG90aGVyd2lzZS5cblx0ICB2YXIgb3B0aW9uVGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKSxcblx0ICAgICAgb3B0R3JvdXBUZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGdyb3VwJyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gbmdPcHRpb25zUG9zdExpbmsoc2NvcGUsIHNlbGVjdEVsZW1lbnQsIGF0dHIsIGN0cmxzKSB7XG5cdFxuXHQgICAgICB2YXIgc2VsZWN0Q3RybCA9IGN0cmxzWzBdO1xuXHQgICAgICB2YXIgbmdNb2RlbEN0cmwgPSBjdHJsc1sxXTtcblx0ICAgICAgdmFyIG11bHRpcGxlID0gYXR0ci5tdWx0aXBsZTtcblx0XG5cdCAgICAgIC8vIFRoZSBlbXB0eU9wdGlvbiBhbGxvd3MgdGhlIGFwcGxpY2F0aW9uIGRldmVsb3BlciB0byBwcm92aWRlIHRoZWlyIG93biBjdXN0b20gXCJlbXB0eVwiXG5cdCAgICAgIC8vIG9wdGlvbiB3aGVuIHRoZSB2aWV3VmFsdWUgZG9lcyBub3QgbWF0Y2ggYW55IG9mIHRoZSBvcHRpb24gdmFsdWVzLlxuXHQgICAgICB2YXIgZW1wdHlPcHRpb247XG5cdCAgICAgIGZvciAodmFyIGkgPSAwLCBjaGlsZHJlbiA9IHNlbGVjdEVsZW1lbnQuY2hpbGRyZW4oKSwgaWkgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdCAgICAgICAgaWYgKGNoaWxkcmVuW2ldLnZhbHVlID09PSAnJykge1xuXHQgICAgICAgICAgZW1wdHlPcHRpb24gPSBjaGlsZHJlbi5lcShpKTtcblx0ICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHRcblx0ICAgICAgdmFyIHByb3ZpZGVkRW1wdHlPcHRpb24gPSAhIWVtcHR5T3B0aW9uO1xuXHRcblx0ICAgICAgdmFyIHVua25vd25PcHRpb24gPSBqcUxpdGUob3B0aW9uVGVtcGxhdGUuY2xvbmVOb2RlKGZhbHNlKSk7XG5cdCAgICAgIHVua25vd25PcHRpb24udmFsKCc/Jyk7XG5cdFxuXHQgICAgICB2YXIgb3B0aW9ucztcblx0ICAgICAgdmFyIG5nT3B0aW9ucyA9IHBhcnNlT3B0aW9uc0V4cHJlc3Npb24oYXR0ci5uZ09wdGlvbnMsIHNlbGVjdEVsZW1lbnQsIHNjb3BlKTtcblx0XG5cdFxuXHQgICAgICB2YXIgcmVuZGVyRW1wdHlPcHRpb24gPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBpZiAoIXByb3ZpZGVkRW1wdHlPcHRpb24pIHtcblx0ICAgICAgICAgIHNlbGVjdEVsZW1lbnQucHJlcGVuZChlbXB0eU9wdGlvbik7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHNlbGVjdEVsZW1lbnQudmFsKCcnKTtcblx0ICAgICAgICBlbXB0eU9wdGlvbi5wcm9wKCdzZWxlY3RlZCcsIHRydWUpOyAvLyBuZWVkZWQgZm9yIElFXG5cdCAgICAgICAgZW1wdHlPcHRpb24uYXR0cignc2VsZWN0ZWQnLCB0cnVlKTtcblx0ICAgICAgfTtcblx0XG5cdCAgICAgIHZhciByZW1vdmVFbXB0eU9wdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICghcHJvdmlkZWRFbXB0eU9wdGlvbikge1xuXHQgICAgICAgICAgZW1wdHlPcHRpb24ucmVtb3ZlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHRcblx0XG5cdCAgICAgIHZhciByZW5kZXJVbmtub3duT3B0aW9uID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgc2VsZWN0RWxlbWVudC5wcmVwZW5kKHVua25vd25PcHRpb24pO1xuXHQgICAgICAgIHNlbGVjdEVsZW1lbnQudmFsKCc/Jyk7XG5cdCAgICAgICAgdW5rbm93bk9wdGlvbi5wcm9wKCdzZWxlY3RlZCcsIHRydWUpOyAvLyBuZWVkZWQgZm9yIElFXG5cdCAgICAgICAgdW5rbm93bk9wdGlvbi5hdHRyKCdzZWxlY3RlZCcsIHRydWUpO1xuXHQgICAgICB9O1xuXHRcblx0ICAgICAgdmFyIHJlbW92ZVVua25vd25PcHRpb24gPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICB1bmtub3duT3B0aW9uLnJlbW92ZSgpO1xuXHQgICAgICB9O1xuXHRcblx0ICAgICAgLy8gVXBkYXRlIHRoZSBjb250cm9sbGVyIG1ldGhvZHMgZm9yIG11bHRpcGxlIHNlbGVjdGFibGUgb3B0aW9uc1xuXHQgICAgICBpZiAoIW11bHRpcGxlKSB7XG5cdFxuXHQgICAgICAgIHNlbGVjdEN0cmwud3JpdGVWYWx1ZSA9IGZ1bmN0aW9uIHdyaXRlTmdPcHRpb25zVmFsdWUodmFsdWUpIHtcblx0ICAgICAgICAgIHZhciBvcHRpb24gPSBvcHRpb25zLmdldE9wdGlvbkZyb21WaWV3VmFsdWUodmFsdWUpO1xuXHRcblx0ICAgICAgICAgIGlmIChvcHRpb24gJiYgIW9wdGlvbi5kaXNhYmxlZCkge1xuXHQgICAgICAgICAgICBpZiAoc2VsZWN0RWxlbWVudFswXS52YWx1ZSAhPT0gb3B0aW9uLnNlbGVjdFZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgcmVtb3ZlVW5rbm93bk9wdGlvbigpO1xuXHQgICAgICAgICAgICAgIHJlbW92ZUVtcHR5T3B0aW9uKCk7XG5cdFxuXHQgICAgICAgICAgICAgIHNlbGVjdEVsZW1lbnRbMF0udmFsdWUgPSBvcHRpb24uc2VsZWN0VmFsdWU7XG5cdCAgICAgICAgICAgICAgb3B0aW9uLmVsZW1lbnQuc2VsZWN0ZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICAgIG9wdGlvbi5lbGVtZW50LnNldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnLCAnc2VsZWN0ZWQnKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHByb3ZpZGVkRW1wdHlPcHRpb24pIHtcblx0ICAgICAgICAgICAgICByZW1vdmVVbmtub3duT3B0aW9uKCk7XG5cdCAgICAgICAgICAgICAgcmVuZGVyRW1wdHlPcHRpb24oKTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICByZW1vdmVFbXB0eU9wdGlvbigpO1xuXHQgICAgICAgICAgICAgIHJlbmRlclVua25vd25PcHRpb24oKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH07XG5cdFxuXHQgICAgICAgIHNlbGVjdEN0cmwucmVhZFZhbHVlID0gZnVuY3Rpb24gcmVhZE5nT3B0aW9uc1ZhbHVlKCkge1xuXHRcblx0ICAgICAgICAgIHZhciBzZWxlY3RlZE9wdGlvbiA9IG9wdGlvbnMuc2VsZWN0VmFsdWVNYXBbc2VsZWN0RWxlbWVudC52YWwoKV07XG5cdFxuXHQgICAgICAgICAgaWYgKHNlbGVjdGVkT3B0aW9uICYmICFzZWxlY3RlZE9wdGlvbi5kaXNhYmxlZCkge1xuXHQgICAgICAgICAgICByZW1vdmVFbXB0eU9wdGlvbigpO1xuXHQgICAgICAgICAgICByZW1vdmVVbmtub3duT3B0aW9uKCk7XG5cdCAgICAgICAgICAgIHJldHVybiBvcHRpb25zLmdldFZpZXdWYWx1ZUZyb21PcHRpb24oc2VsZWN0ZWRPcHRpb24pO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICAgICAgfTtcblx0XG5cdCAgICAgICAgLy8gSWYgd2UgYXJlIHVzaW5nIGB0cmFjayBieWAgdGhlbiB3ZSBtdXN0IHdhdGNoIHRoZSB0cmFja2VkIHZhbHVlIG9uIHRoZSBtb2RlbFxuXHQgICAgICAgIC8vIHNpbmNlIG5nTW9kZWwgb25seSB3YXRjaGVzIGZvciBvYmplY3QgaWRlbnRpdHkgY2hhbmdlXG5cdCAgICAgICAgaWYgKG5nT3B0aW9ucy50cmFja0J5KSB7XG5cdCAgICAgICAgICBzY29wZS4kd2F0Y2goXG5cdCAgICAgICAgICAgIGZ1bmN0aW9uKCkgeyByZXR1cm4gbmdPcHRpb25zLmdldFRyYWNrQnlWYWx1ZShuZ01vZGVsQ3RybC4kdmlld1ZhbHVlKTsgfSxcblx0ICAgICAgICAgICAgZnVuY3Rpb24oKSB7IG5nTW9kZWxDdHJsLiRyZW5kZXIoKTsgfVxuXHQgICAgICAgICAgKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICB9IGVsc2Uge1xuXHRcblx0ICAgICAgICBuZ01vZGVsQ3RybC4kaXNFbXB0eSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgICByZXR1cm4gIXZhbHVlIHx8IHZhbHVlLmxlbmd0aCA9PT0gMDtcblx0ICAgICAgICB9O1xuXHRcblx0XG5cdCAgICAgICAgc2VsZWN0Q3RybC53cml0ZVZhbHVlID0gZnVuY3Rpb24gd3JpdGVOZ09wdGlvbnNNdWx0aXBsZSh2YWx1ZSkge1xuXHQgICAgICAgICAgb3B0aW9ucy5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKG9wdGlvbikge1xuXHQgICAgICAgICAgICBvcHRpb24uZWxlbWVudC5zZWxlY3RlZCA9IGZhbHNlO1xuXHQgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgaWYgKHZhbHVlKSB7XG5cdCAgICAgICAgICAgIHZhbHVlLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuXHQgICAgICAgICAgICAgIHZhciBvcHRpb24gPSBvcHRpb25zLmdldE9wdGlvbkZyb21WaWV3VmFsdWUoaXRlbSk7XG5cdCAgICAgICAgICAgICAgaWYgKG9wdGlvbiAmJiAhb3B0aW9uLmRpc2FibGVkKSBvcHRpb24uZWxlbWVudC5zZWxlY3RlZCA9IHRydWU7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH07XG5cdFxuXHRcblx0ICAgICAgICBzZWxlY3RDdHJsLnJlYWRWYWx1ZSA9IGZ1bmN0aW9uIHJlYWROZ09wdGlvbnNNdWx0aXBsZSgpIHtcblx0ICAgICAgICAgIHZhciBzZWxlY3RlZFZhbHVlcyA9IHNlbGVjdEVsZW1lbnQudmFsKCkgfHwgW10sXG5cdCAgICAgICAgICAgICAgc2VsZWN0aW9ucyA9IFtdO1xuXHRcblx0ICAgICAgICAgIGZvckVhY2goc2VsZWN0ZWRWYWx1ZXMsIGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgICAgIHZhciBvcHRpb24gPSBvcHRpb25zLnNlbGVjdFZhbHVlTWFwW3ZhbHVlXTtcblx0ICAgICAgICAgICAgaWYgKG9wdGlvbiAmJiAhb3B0aW9uLmRpc2FibGVkKSBzZWxlY3Rpb25zLnB1c2gob3B0aW9ucy5nZXRWaWV3VmFsdWVGcm9tT3B0aW9uKG9wdGlvbikpO1xuXHQgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgcmV0dXJuIHNlbGVjdGlvbnM7XG5cdCAgICAgICAgfTtcblx0XG5cdCAgICAgICAgLy8gSWYgd2UgYXJlIHVzaW5nIGB0cmFjayBieWAgdGhlbiB3ZSBtdXN0IHdhdGNoIHRoZXNlIHRyYWNrZWQgdmFsdWVzIG9uIHRoZSBtb2RlbFxuXHQgICAgICAgIC8vIHNpbmNlIG5nTW9kZWwgb25seSB3YXRjaGVzIGZvciBvYmplY3QgaWRlbnRpdHkgY2hhbmdlXG5cdCAgICAgICAgaWYgKG5nT3B0aW9ucy50cmFja0J5KSB7XG5cdFxuXHQgICAgICAgICAgc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgaWYgKGlzQXJyYXkobmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSkpIHtcblx0ICAgICAgICAgICAgICByZXR1cm4gbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZS5tYXAoZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICAgICAgICAgIHJldHVybiBuZ09wdGlvbnMuZ2V0VHJhY2tCeVZhbHVlKHZhbHVlKTtcblx0ICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcblx0ICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0XG5cdFxuXHQgICAgICBpZiAocHJvdmlkZWRFbXB0eU9wdGlvbikge1xuXHRcblx0ICAgICAgICAvLyB3ZSBuZWVkIHRvIHJlbW92ZSBpdCBiZWZvcmUgY2FsbGluZyBzZWxlY3RFbGVtZW50LmVtcHR5KCkgYmVjYXVzZSBvdGhlcndpc2UgSUUgd2lsbFxuXHQgICAgICAgIC8vIHJlbW92ZSB0aGUgbGFiZWwgZnJvbSB0aGUgZWxlbWVudC4gd3RmP1xuXHQgICAgICAgIGVtcHR5T3B0aW9uLnJlbW92ZSgpO1xuXHRcblx0ICAgICAgICAvLyBjb21waWxlIHRoZSBlbGVtZW50IHNpbmNlIHRoZXJlIG1pZ2h0IGJlIGJpbmRpbmdzIGluIGl0XG5cdCAgICAgICAgJGNvbXBpbGUoZW1wdHlPcHRpb24pKHNjb3BlKTtcblx0XG5cdCAgICAgICAgLy8gcmVtb3ZlIHRoZSBjbGFzcywgd2hpY2ggaXMgYWRkZWQgYXV0b21hdGljYWxseSBiZWNhdXNlIHdlIHJlY29tcGlsZSB0aGUgZWxlbWVudCBhbmQgaXRcblx0ICAgICAgICAvLyBiZWNvbWVzIHRoZSBjb21waWxhdGlvbiByb290XG5cdCAgICAgICAgZW1wdHlPcHRpb24ucmVtb3ZlQ2xhc3MoJ25nLXNjb3BlJyk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgZW1wdHlPcHRpb24gPSBqcUxpdGUob3B0aW9uVGVtcGxhdGUuY2xvbmVOb2RlKGZhbHNlKSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vIFdlIG5lZWQgdG8gZG8gdGhpcyBoZXJlIHRvIGVuc3VyZSB0aGF0IHRoZSBvcHRpb25zIG9iamVjdCBpcyBkZWZpbmVkXG5cdCAgICAgIC8vIHdoZW4gd2UgZmlyc3QgaGl0IGl0IGluIHdyaXRlTmdPcHRpb25zVmFsdWVcblx0ICAgICAgdXBkYXRlT3B0aW9ucygpO1xuXHRcblx0ICAgICAgLy8gV2Ugd2lsbCByZS1yZW5kZXIgdGhlIG9wdGlvbiBlbGVtZW50cyBpZiB0aGUgb3B0aW9uIHZhbHVlcyBvciBsYWJlbHMgY2hhbmdlXG5cdCAgICAgIHNjb3BlLiR3YXRjaENvbGxlY3Rpb24obmdPcHRpb25zLmdldFdhdGNoYWJsZXMsIHVwZGF0ZU9wdGlvbnMpO1xuXHRcblx0ICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cdFxuXHRcblx0ICAgICAgZnVuY3Rpb24gdXBkYXRlT3B0aW9uRWxlbWVudChvcHRpb24sIGVsZW1lbnQpIHtcblx0ICAgICAgICBvcHRpb24uZWxlbWVudCA9IGVsZW1lbnQ7XG5cdCAgICAgICAgZWxlbWVudC5kaXNhYmxlZCA9IG9wdGlvbi5kaXNhYmxlZDtcblx0ICAgICAgICAvLyBOT1RFOiBUaGUgbGFiZWwgbXVzdCBiZSBzZXQgYmVmb3JlIHRoZSB2YWx1ZSwgb3RoZXJ3aXNlIElFMTAvMTEvRURHRSBjcmVhdGUgdW5yZXNwb25zaXZlXG5cdCAgICAgICAgLy8gc2VsZWN0cyBpbiBjZXJ0YWluIGNpcmN1bXN0YW5jZXMgd2hlbiBtdWx0aXBsZSBzZWxlY3RzIGFyZSBuZXh0IHRvIGVhY2ggb3RoZXIgYW5kIGRpc3BsYXlcblx0ICAgICAgICAvLyB0aGUgb3B0aW9uIGxpc3QgaW4gbGlzdGJveCBzdHlsZSwgaS5lLiB0aGUgc2VsZWN0IGlzIFttdWx0aXBsZV0sIG9yIHNwZWNpZmllcyBhIFtzaXplXS5cblx0ICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy9pc3N1ZXMvMTEzMTQgZm9yIG1vcmUgaW5mby5cblx0ICAgICAgICAvLyBUaGlzIGlzIHVuZm9ydHVuYXRlbHkgdW50ZXN0YWJsZSB3aXRoIHVuaXQgLyBlMmUgdGVzdHNcblx0ICAgICAgICBpZiAob3B0aW9uLmxhYmVsICE9PSBlbGVtZW50LmxhYmVsKSB7XG5cdCAgICAgICAgICBlbGVtZW50LmxhYmVsID0gb3B0aW9uLmxhYmVsO1xuXHQgICAgICAgICAgZWxlbWVudC50ZXh0Q29udGVudCA9IG9wdGlvbi5sYWJlbDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKG9wdGlvbi52YWx1ZSAhPT0gZWxlbWVudC52YWx1ZSkgZWxlbWVudC52YWx1ZSA9IG9wdGlvbi5zZWxlY3RWYWx1ZTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgZnVuY3Rpb24gYWRkT3JSZXVzZUVsZW1lbnQocGFyZW50LCBjdXJyZW50LCB0eXBlLCB0ZW1wbGF0ZUVsZW1lbnQpIHtcblx0ICAgICAgICB2YXIgZWxlbWVudDtcblx0ICAgICAgICAvLyBDaGVjayB3aGV0aGVyIHdlIGNhbiByZXVzZSB0aGUgbmV4dCBlbGVtZW50XG5cdCAgICAgICAgaWYgKGN1cnJlbnQgJiYgbG93ZXJjYXNlKGN1cnJlbnQubm9kZU5hbWUpID09PSB0eXBlKSB7XG5cdCAgICAgICAgICAvLyBUaGUgbmV4dCBlbGVtZW50IGlzIHRoZSByaWdodCB0eXBlIHNvIHJldXNlIGl0XG5cdCAgICAgICAgICBlbGVtZW50ID0gY3VycmVudDtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgLy8gVGhlIG5leHQgZWxlbWVudCBpcyBub3QgdGhlIHJpZ2h0IHR5cGUgc28gY3JlYXRlIGEgbmV3IG9uZVxuXHQgICAgICAgICAgZWxlbWVudCA9IHRlbXBsYXRlRWxlbWVudC5jbG9uZU5vZGUoZmFsc2UpO1xuXHQgICAgICAgICAgaWYgKCFjdXJyZW50KSB7XG5cdCAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBubyBtb3JlIGVsZW1lbnRzIHNvIGp1c3QgYXBwZW5kIGl0IHRvIHRoZSBzZWxlY3Rcblx0ICAgICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgLy8gVGhlIG5leHQgZWxlbWVudCBpcyBub3QgYSBncm91cCBzbyBpbnNlcnQgdGhlIG5ldyBvbmVcblx0ICAgICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShlbGVtZW50LCBjdXJyZW50KTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG5cdCAgICAgIH1cblx0XG5cdFxuXHQgICAgICBmdW5jdGlvbiByZW1vdmVFeGNlc3NFbGVtZW50cyhjdXJyZW50KSB7XG5cdCAgICAgICAgdmFyIG5leHQ7XG5cdCAgICAgICAgd2hpbGUgKGN1cnJlbnQpIHtcblx0ICAgICAgICAgIG5leHQgPSBjdXJyZW50Lm5leHRTaWJsaW5nO1xuXHQgICAgICAgICAganFMaXRlUmVtb3ZlKGN1cnJlbnQpO1xuXHQgICAgICAgICAgY3VycmVudCA9IG5leHQ7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdFxuXHRcblx0ICAgICAgZnVuY3Rpb24gc2tpcEVtcHR5QW5kVW5rbm93bk9wdGlvbnMoY3VycmVudCkge1xuXHQgICAgICAgIHZhciBlbXB0eU9wdGlvbl8gPSBlbXB0eU9wdGlvbiAmJiBlbXB0eU9wdGlvblswXTtcblx0ICAgICAgICB2YXIgdW5rbm93bk9wdGlvbl8gPSB1bmtub3duT3B0aW9uICYmIHVua25vd25PcHRpb25bMF07XG5cdFxuXHQgICAgICAgIC8vIFdlIGNhbm5vdCByZWx5IG9uIHRoZSBleHRyYWN0ZWQgZW1wdHkgb3B0aW9uIGJlaW5nIHRoZSBzYW1lIGFzIHRoZSBjb21waWxlZCBlbXB0eSBvcHRpb24sXG5cdCAgICAgICAgLy8gYmVjYXVzZSB0aGUgY29tcGlsZWQgZW1wdHkgb3B0aW9uIG1pZ2h0IGhhdmUgYmVlbiByZXBsYWNlZCBieSBhIGNvbW1lbnQgYmVjYXVzZVxuXHQgICAgICAgIC8vIGl0IGhhZCBhbiBcImVsZW1lbnRcIiB0cmFuc2NsdXNpb24gZGlyZWN0aXZlIG9uIGl0IChzdWNoIGFzIG5nSWYpXG5cdCAgICAgICAgaWYgKGVtcHR5T3B0aW9uXyB8fCB1bmtub3duT3B0aW9uXykge1xuXHQgICAgICAgICAgd2hpbGUgKGN1cnJlbnQgJiZcblx0ICAgICAgICAgICAgICAgIChjdXJyZW50ID09PSBlbXB0eU9wdGlvbl8gfHxcblx0ICAgICAgICAgICAgICAgIGN1cnJlbnQgPT09IHVua25vd25PcHRpb25fIHx8XG5cdCAgICAgICAgICAgICAgICBjdXJyZW50Lm5vZGVUeXBlID09PSBOT0RFX1RZUEVfQ09NTUVOVCB8fFxuXHQgICAgICAgICAgICAgICAgKG5vZGVOYW1lXyhjdXJyZW50KSA9PT0gJ29wdGlvbicgJiYgY3VycmVudC52YWx1ZSA9PT0gJycpKSkge1xuXHQgICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0U2libGluZztcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIGN1cnJlbnQ7XG5cdCAgICAgIH1cblx0XG5cdFxuXHQgICAgICBmdW5jdGlvbiB1cGRhdGVPcHRpb25zKCkge1xuXHRcblx0ICAgICAgICB2YXIgcHJldmlvdXNWYWx1ZSA9IG9wdGlvbnMgJiYgc2VsZWN0Q3RybC5yZWFkVmFsdWUoKTtcblx0XG5cdCAgICAgICAgb3B0aW9ucyA9IG5nT3B0aW9ucy5nZXRPcHRpb25zKCk7XG5cdFxuXHQgICAgICAgIHZhciBncm91cE1hcCA9IHt9O1xuXHQgICAgICAgIHZhciBjdXJyZW50RWxlbWVudCA9IHNlbGVjdEVsZW1lbnRbMF0uZmlyc3RDaGlsZDtcblx0XG5cdCAgICAgICAgLy8gRW5zdXJlIHRoYXQgdGhlIGVtcHR5IG9wdGlvbiBpcyBhbHdheXMgdGhlcmUgaWYgaXQgd2FzIGV4cGxpY2l0bHkgcHJvdmlkZWRcblx0ICAgICAgICBpZiAocHJvdmlkZWRFbXB0eU9wdGlvbikge1xuXHQgICAgICAgICAgc2VsZWN0RWxlbWVudC5wcmVwZW5kKGVtcHR5T3B0aW9uKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGN1cnJlbnRFbGVtZW50ID0gc2tpcEVtcHR5QW5kVW5rbm93bk9wdGlvbnMoY3VycmVudEVsZW1lbnQpO1xuXHRcblx0ICAgICAgICBvcHRpb25zLml0ZW1zLmZvckVhY2goZnVuY3Rpb24gdXBkYXRlT3B0aW9uKG9wdGlvbikge1xuXHQgICAgICAgICAgdmFyIGdyb3VwO1xuXHQgICAgICAgICAgdmFyIGdyb3VwRWxlbWVudDtcblx0ICAgICAgICAgIHZhciBvcHRpb25FbGVtZW50O1xuXHRcblx0ICAgICAgICAgIGlmIChpc0RlZmluZWQob3B0aW9uLmdyb3VwKSkge1xuXHRcblx0ICAgICAgICAgICAgLy8gVGhpcyBvcHRpb24gaXMgdG8gbGl2ZSBpbiBhIGdyb3VwXG5cdCAgICAgICAgICAgIC8vIFNlZSBpZiB3ZSBoYXZlIGFscmVhZHkgY3JlYXRlZCB0aGlzIGdyb3VwXG5cdCAgICAgICAgICAgIGdyb3VwID0gZ3JvdXBNYXBbb3B0aW9uLmdyb3VwXTtcblx0XG5cdCAgICAgICAgICAgIGlmICghZ3JvdXApIHtcblx0XG5cdCAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBub3QgYWxyZWFkeSBjcmVhdGVkIHRoaXMgZ3JvdXBcblx0ICAgICAgICAgICAgICBncm91cEVsZW1lbnQgPSBhZGRPclJldXNlRWxlbWVudChzZWxlY3RFbGVtZW50WzBdLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50LFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvcHRncm91cCcsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0R3JvdXBUZW1wbGF0ZSk7XG5cdCAgICAgICAgICAgICAgLy8gTW92ZSB0byB0aGUgbmV4dCBlbGVtZW50XG5cdCAgICAgICAgICAgICAgY3VycmVudEVsZW1lbnQgPSBncm91cEVsZW1lbnQubmV4dFNpYmxpbmc7XG5cdFxuXHQgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgbGFiZWwgb24gdGhlIGdyb3VwIGVsZW1lbnRcblx0ICAgICAgICAgICAgICBncm91cEVsZW1lbnQubGFiZWwgPSBvcHRpb24uZ3JvdXA7XG5cdFxuXHQgICAgICAgICAgICAgIC8vIFN0b3JlIGl0IGZvciB1c2UgbGF0ZXJcblx0ICAgICAgICAgICAgICBncm91cCA9IGdyb3VwTWFwW29wdGlvbi5ncm91cF0gPSB7XG5cdCAgICAgICAgICAgICAgICBncm91cEVsZW1lbnQ6IGdyb3VwRWxlbWVudCxcblx0ICAgICAgICAgICAgICAgIGN1cnJlbnRPcHRpb25FbGVtZW50OiBncm91cEVsZW1lbnQuZmlyc3RDaGlsZFxuXHQgICAgICAgICAgICAgIH07XG5cdFxuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAvLyBTbyBub3cgd2UgaGF2ZSBhIGdyb3VwIGZvciB0aGlzIG9wdGlvbiB3ZSBhZGQgdGhlIG9wdGlvbiB0byB0aGUgZ3JvdXBcblx0ICAgICAgICAgICAgb3B0aW9uRWxlbWVudCA9IGFkZE9yUmV1c2VFbGVtZW50KGdyb3VwLmdyb3VwRWxlbWVudCxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmN1cnJlbnRPcHRpb25FbGVtZW50LFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29wdGlvbicsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25UZW1wbGF0ZSk7XG5cdCAgICAgICAgICAgIHVwZGF0ZU9wdGlvbkVsZW1lbnQob3B0aW9uLCBvcHRpb25FbGVtZW50KTtcblx0ICAgICAgICAgICAgLy8gTW92ZSB0byB0aGUgbmV4dCBlbGVtZW50XG5cdCAgICAgICAgICAgIGdyb3VwLmN1cnJlbnRPcHRpb25FbGVtZW50ID0gb3B0aW9uRWxlbWVudC5uZXh0U2libGluZztcblx0XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHRcblx0ICAgICAgICAgICAgLy8gVGhpcyBvcHRpb24gaXMgbm90IGluIGEgZ3JvdXBcblx0ICAgICAgICAgICAgb3B0aW9uRWxlbWVudCA9IGFkZE9yUmV1c2VFbGVtZW50KHNlbGVjdEVsZW1lbnRbMF0sXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RWxlbWVudCxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvcHRpb24nLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uVGVtcGxhdGUpO1xuXHQgICAgICAgICAgICB1cGRhdGVPcHRpb25FbGVtZW50KG9wdGlvbiwgb3B0aW9uRWxlbWVudCk7XG5cdCAgICAgICAgICAgIC8vIE1vdmUgdG8gdGhlIG5leHQgZWxlbWVudFxuXHQgICAgICAgICAgICBjdXJyZW50RWxlbWVudCA9IG9wdGlvbkVsZW1lbnQubmV4dFNpYmxpbmc7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdFxuXHRcblx0ICAgICAgICAvLyBOb3cgcmVtb3ZlIGFsbCBleGNlc3Mgb3B0aW9ucyBhbmQgZ3JvdXBcblx0ICAgICAgICBPYmplY3Qua2V5cyhncm91cE1hcCkuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcblx0ICAgICAgICAgIHJlbW92ZUV4Y2Vzc0VsZW1lbnRzKGdyb3VwTWFwW2tleV0uY3VycmVudE9wdGlvbkVsZW1lbnQpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHJlbW92ZUV4Y2Vzc0VsZW1lbnRzKGN1cnJlbnRFbGVtZW50KTtcblx0XG5cdCAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuXHRcblx0ICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIHZhbHVlIGhhcyBjaGFuZ2VkIGR1ZSB0byB0aGUgdXBkYXRlIHRvIHRoZSBvcHRpb25zXG5cdCAgICAgICAgaWYgKCFuZ01vZGVsQ3RybC4kaXNFbXB0eShwcmV2aW91c1ZhbHVlKSkge1xuXHQgICAgICAgICAgdmFyIG5leHRWYWx1ZSA9IHNlbGVjdEN0cmwucmVhZFZhbHVlKCk7XG5cdCAgICAgICAgICB2YXIgaXNOb3RQcmltaXRpdmUgPSBuZ09wdGlvbnMudHJhY2tCeSB8fCBtdWx0aXBsZTtcblx0ICAgICAgICAgIGlmIChpc05vdFByaW1pdGl2ZSA/ICFlcXVhbHMocHJldmlvdXNWYWx1ZSwgbmV4dFZhbHVlKSA6IHByZXZpb3VzVmFsdWUgIT09IG5leHRWYWx1ZSkge1xuXHQgICAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKG5leHRWYWx1ZSk7XG5cdCAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICB9XG5cdCAgfVxuXHRcblx0ICByZXR1cm4ge1xuXHQgICAgcmVzdHJpY3Q6ICdBJyxcblx0ICAgIHRlcm1pbmFsOiB0cnVlLFxuXHQgICAgcmVxdWlyZTogWydzZWxlY3QnLCAnbmdNb2RlbCddLFxuXHQgICAgbGluazoge1xuXHQgICAgICBwcmU6IGZ1bmN0aW9uIG5nT3B0aW9uc1ByZUxpbmsoc2NvcGUsIHNlbGVjdEVsZW1lbnQsIGF0dHIsIGN0cmxzKSB7XG5cdCAgICAgICAgLy8gRGVhY3RpdmF0ZSB0aGUgU2VsZWN0Q29udHJvbGxlci5yZWdpc3RlciBtZXRob2QgdG8gcHJldmVudFxuXHQgICAgICAgIC8vIG9wdGlvbiBkaXJlY3RpdmVzIGZyb20gYWNjaWRlbnRhbGx5IHJlZ2lzdGVyaW5nIHRoZW1zZWx2ZXNcblx0ICAgICAgICAvLyAoYW5kIHVud2FudGVkICRkZXN0cm95IGhhbmRsZXJzIGV0Yy4pXG5cdCAgICAgICAgY3RybHNbMF0ucmVnaXN0ZXJPcHRpb24gPSBub29wO1xuXHQgICAgICB9LFxuXHQgICAgICBwb3N0OiBuZ09wdGlvbnNQb3N0TGlua1xuXHQgICAgfVxuXHQgIH07XG5cdH1dO1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdQbHVyYWxpemVcblx0ICogQHJlc3RyaWN0IEVBXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBgbmdQbHVyYWxpemVgIGlzIGEgZGlyZWN0aXZlIHRoYXQgZGlzcGxheXMgbWVzc2FnZXMgYWNjb3JkaW5nIHRvIGVuLVVTIGxvY2FsaXphdGlvbiBydWxlcy5cblx0ICogVGhlc2UgcnVsZXMgYXJlIGJ1bmRsZWQgd2l0aCBhbmd1bGFyLmpzLCBidXQgY2FuIGJlIG92ZXJyaWRkZW5cblx0ICogKHNlZSB7QGxpbmsgZ3VpZGUvaTE4biBBbmd1bGFyIGkxOG59IGRldiBndWlkZSkuIFlvdSBjb25maWd1cmUgbmdQbHVyYWxpemUgZGlyZWN0aXZlXG5cdCAqIGJ5IHNwZWNpZnlpbmcgdGhlIG1hcHBpbmdzIGJldHdlZW5cblx0ICogW3BsdXJhbCBjYXRlZ29yaWVzXShodHRwOi8vdW5pY29kZS5vcmcvcmVwb3MvY2xkci10bXAvdHJ1bmsvZGlmZi9zdXBwbGVtZW50YWwvbGFuZ3VhZ2VfcGx1cmFsX3J1bGVzLmh0bWwpXG5cdCAqIGFuZCB0aGUgc3RyaW5ncyB0byBiZSBkaXNwbGF5ZWQuXG5cdCAqXG5cdCAqICMgUGx1cmFsIGNhdGVnb3JpZXMgYW5kIGV4cGxpY2l0IG51bWJlciBydWxlc1xuXHQgKiBUaGVyZSBhcmUgdHdvXG5cdCAqIFtwbHVyYWwgY2F0ZWdvcmllc10oaHR0cDovL3VuaWNvZGUub3JnL3JlcG9zL2NsZHItdG1wL3RydW5rL2RpZmYvc3VwcGxlbWVudGFsL2xhbmd1YWdlX3BsdXJhbF9ydWxlcy5odG1sKVxuXHQgKiBpbiBBbmd1bGFyJ3MgZGVmYXVsdCBlbi1VUyBsb2NhbGU6IFwib25lXCIgYW5kIFwib3RoZXJcIi5cblx0ICpcblx0ICogV2hpbGUgYSBwbHVyYWwgY2F0ZWdvcnkgbWF5IG1hdGNoIG1hbnkgbnVtYmVycyAoZm9yIGV4YW1wbGUsIGluIGVuLVVTIGxvY2FsZSwgXCJvdGhlclwiIGNhbiBtYXRjaFxuXHQgKiBhbnkgbnVtYmVyIHRoYXQgaXMgbm90IDEpLCBhbiBleHBsaWNpdCBudW1iZXIgcnVsZSBjYW4gb25seSBtYXRjaCBvbmUgbnVtYmVyLiBGb3IgZXhhbXBsZSwgdGhlXG5cdCAqIGV4cGxpY2l0IG51bWJlciBydWxlIGZvciBcIjNcIiBtYXRjaGVzIHRoZSBudW1iZXIgMy4gVGhlcmUgYXJlIGV4YW1wbGVzIG9mIHBsdXJhbCBjYXRlZ29yaWVzXG5cdCAqIGFuZCBleHBsaWNpdCBudW1iZXIgcnVsZXMgdGhyb3VnaG91dCB0aGUgcmVzdCBvZiB0aGlzIGRvY3VtZW50YXRpb24uXG5cdCAqXG5cdCAqICMgQ29uZmlndXJpbmcgbmdQbHVyYWxpemVcblx0ICogWW91IGNvbmZpZ3VyZSBuZ1BsdXJhbGl6ZSBieSBwcm92aWRpbmcgMiBhdHRyaWJ1dGVzOiBgY291bnRgIGFuZCBgd2hlbmAuXG5cdCAqIFlvdSBjYW4gYWxzbyBwcm92aWRlIGFuIG9wdGlvbmFsIGF0dHJpYnV0ZSwgYG9mZnNldGAuXG5cdCAqXG5cdCAqIFRoZSB2YWx1ZSBvZiB0aGUgYGNvdW50YCBhdHRyaWJ1dGUgY2FuIGJlIGVpdGhlciBhIHN0cmluZyBvciBhbiB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvblxuXHQgKiBBbmd1bGFyIGV4cHJlc3Npb259OyB0aGVzZSBhcmUgZXZhbHVhdGVkIG9uIHRoZSBjdXJyZW50IHNjb3BlIGZvciBpdHMgYm91bmQgdmFsdWUuXG5cdCAqXG5cdCAqIFRoZSBgd2hlbmAgYXR0cmlidXRlIHNwZWNpZmllcyB0aGUgbWFwcGluZ3MgYmV0d2VlbiBwbHVyYWwgY2F0ZWdvcmllcyBhbmQgdGhlIGFjdHVhbFxuXHQgKiBzdHJpbmcgdG8gYmUgZGlzcGxheWVkLiBUaGUgdmFsdWUgb2YgdGhlIGF0dHJpYnV0ZSBzaG91bGQgYmUgYSBKU09OIG9iamVjdC5cblx0ICpcblx0ICogVGhlIGZvbGxvd2luZyBleGFtcGxlIHNob3dzIGhvdyB0byBjb25maWd1cmUgbmdQbHVyYWxpemU6XG5cdCAqXG5cdCAqIGBgYGh0bWxcblx0ICogPG5nLXBsdXJhbGl6ZSBjb3VudD1cInBlcnNvbkNvdW50XCJcblx0ICAgICAgICAgICAgICAgICB3aGVuPVwieycwJzogJ05vYm9keSBpcyB2aWV3aW5nLicsXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICdvbmUnOiAnMSBwZXJzb24gaXMgdmlld2luZy4nLFxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAnb3RoZXInOiAne30gcGVvcGxlIGFyZSB2aWV3aW5nLid9XCI+XG5cdCAqIDwvbmctcGx1cmFsaXplPlxuXHQgKmBgYFxuXHQgKlxuXHQgKiBJbiB0aGUgZXhhbXBsZSwgYFwiMDogTm9ib2R5IGlzIHZpZXdpbmcuXCJgIGlzIGFuIGV4cGxpY2l0IG51bWJlciBydWxlLiBJZiB5b3UgZGlkIG5vdFxuXHQgKiBzcGVjaWZ5IHRoaXMgcnVsZSwgMCB3b3VsZCBiZSBtYXRjaGVkIHRvIHRoZSBcIm90aGVyXCIgY2F0ZWdvcnkgYW5kIFwiMCBwZW9wbGUgYXJlIHZpZXdpbmdcIlxuXHQgKiB3b3VsZCBiZSBzaG93biBpbnN0ZWFkIG9mIFwiTm9ib2R5IGlzIHZpZXdpbmdcIi4gWW91IGNhbiBzcGVjaWZ5IGFuIGV4cGxpY2l0IG51bWJlciBydWxlIGZvclxuXHQgKiBvdGhlciBudW1iZXJzLCBmb3IgZXhhbXBsZSAxMiwgc28gdGhhdCBpbnN0ZWFkIG9mIHNob3dpbmcgXCIxMiBwZW9wbGUgYXJlIHZpZXdpbmdcIiwgeW91IGNhblxuXHQgKiBzaG93IFwiYSBkb3plbiBwZW9wbGUgYXJlIHZpZXdpbmdcIi5cblx0ICpcblx0ICogWW91IGNhbiB1c2UgYSBzZXQgb2YgY2xvc2VkIGJyYWNlcyAoYHt9YCkgYXMgYSBwbGFjZWhvbGRlciBmb3IgdGhlIG51bWJlciB0aGF0IHlvdSB3YW50IHN1YnN0aXR1dGVkXG5cdCAqIGludG8gcGx1cmFsaXplZCBzdHJpbmdzLiBJbiB0aGUgcHJldmlvdXMgZXhhbXBsZSwgQW5ndWxhciB3aWxsIHJlcGxhY2UgYHt9YCB3aXRoXG5cdCAqIDxzcGFuIG5nLW5vbi1iaW5kYWJsZT5ge3twZXJzb25Db3VudH19YDwvc3Bhbj4uIFRoZSBjbG9zZWQgYnJhY2VzIGB7fWAgaXMgYSBwbGFjZWhvbGRlclxuXHQgKiBmb3IgPHNwYW4gbmctbm9uLWJpbmRhYmxlPnt7bnVtYmVyRXhwcmVzc2lvbn19PC9zcGFuPi5cblx0ICpcblx0ICogSWYgbm8gcnVsZSBpcyBkZWZpbmVkIGZvciBhIGNhdGVnb3J5LCB0aGVuIGFuIGVtcHR5IHN0cmluZyBpcyBkaXNwbGF5ZWQgYW5kIGEgd2FybmluZyBpcyBnZW5lcmF0ZWQuXG5cdCAqIE5vdGUgdGhhdCBzb21lIGxvY2FsZXMgZGVmaW5lIG1vcmUgY2F0ZWdvcmllcyB0aGFuIGBvbmVgIGFuZCBgb3RoZXJgLiBGb3IgZXhhbXBsZSwgZnItZnIgZGVmaW5lcyBgZmV3YCBhbmQgYG1hbnlgLlxuXHQgKlxuXHQgKiAjIENvbmZpZ3VyaW5nIG5nUGx1cmFsaXplIHdpdGggb2Zmc2V0XG5cdCAqIFRoZSBgb2Zmc2V0YCBhdHRyaWJ1dGUgYWxsb3dzIGZ1cnRoZXIgY3VzdG9taXphdGlvbiBvZiBwbHVyYWxpemVkIHRleHQsIHdoaWNoIGNhbiByZXN1bHQgaW5cblx0ICogYSBiZXR0ZXIgdXNlciBleHBlcmllbmNlLiBGb3IgZXhhbXBsZSwgaW5zdGVhZCBvZiB0aGUgbWVzc2FnZSBcIjQgcGVvcGxlIGFyZSB2aWV3aW5nIHRoaXMgZG9jdW1lbnRcIixcblx0ICogeW91IG1pZ2h0IGRpc3BsYXkgXCJKb2huLCBLYXRlIGFuZCAyIG90aGVycyBhcmUgdmlld2luZyB0aGlzIGRvY3VtZW50XCIuXG5cdCAqIFRoZSBvZmZzZXQgYXR0cmlidXRlIGFsbG93cyB5b3UgdG8gb2Zmc2V0IGEgbnVtYmVyIGJ5IGFueSBkZXNpcmVkIHZhbHVlLlxuXHQgKiBMZXQncyB0YWtlIGEgbG9vayBhdCBhbiBleGFtcGxlOlxuXHQgKlxuXHQgKiBgYGBodG1sXG5cdCAqIDxuZy1wbHVyYWxpemUgY291bnQ9XCJwZXJzb25Db3VudFwiIG9mZnNldD0yXG5cdCAqICAgICAgICAgICAgICAgd2hlbj1cInsnMCc6ICdOb2JvZHkgaXMgdmlld2luZy4nLFxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAnMSc6ICd7e3BlcnNvbjF9fSBpcyB2aWV3aW5nLicsXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICcyJzogJ3t7cGVyc29uMX19IGFuZCB7e3BlcnNvbjJ9fSBhcmUgdmlld2luZy4nLFxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAnb25lJzogJ3t7cGVyc29uMX19LCB7e3BlcnNvbjJ9fSBhbmQgb25lIG90aGVyIHBlcnNvbiBhcmUgdmlld2luZy4nLFxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAnb3RoZXInOiAne3twZXJzb24xfX0sIHt7cGVyc29uMn19IGFuZCB7fSBvdGhlciBwZW9wbGUgYXJlIHZpZXdpbmcuJ31cIj5cblx0ICogPC9uZy1wbHVyYWxpemU+XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBOb3RpY2UgdGhhdCB3ZSBhcmUgc3RpbGwgdXNpbmcgdHdvIHBsdXJhbCBjYXRlZ29yaWVzKG9uZSwgb3RoZXIpLCBidXQgd2UgYWRkZWRcblx0ICogdGhyZWUgZXhwbGljaXQgbnVtYmVyIHJ1bGVzIDAsIDEgYW5kIDIuXG5cdCAqIFdoZW4gb25lIHBlcnNvbiwgcGVyaGFwcyBKb2huLCB2aWV3cyB0aGUgZG9jdW1lbnQsIFwiSm9obiBpcyB2aWV3aW5nXCIgd2lsbCBiZSBzaG93bi5cblx0ICogV2hlbiB0aHJlZSBwZW9wbGUgdmlldyB0aGUgZG9jdW1lbnQsIG5vIGV4cGxpY2l0IG51bWJlciBydWxlIGlzIGZvdW5kLCBzb1xuXHQgKiBhbiBvZmZzZXQgb2YgMiBpcyB0YWtlbiBvZmYgMywgYW5kIEFuZ3VsYXIgdXNlcyAxIHRvIGRlY2lkZSB0aGUgcGx1cmFsIGNhdGVnb3J5LlxuXHQgKiBJbiB0aGlzIGNhc2UsIHBsdXJhbCBjYXRlZ29yeSAnb25lJyBpcyBtYXRjaGVkIGFuZCBcIkpvaG4sIE1hcnkgYW5kIG9uZSBvdGhlciBwZXJzb24gYXJlIHZpZXdpbmdcIlxuXHQgKiBpcyBzaG93bi5cblx0ICpcblx0ICogTm90ZSB0aGF0IHdoZW4geW91IHNwZWNpZnkgb2Zmc2V0cywgeW91IG11c3QgcHJvdmlkZSBleHBsaWNpdCBudW1iZXIgcnVsZXMgZm9yXG5cdCAqIG51bWJlcnMgZnJvbSAwIHVwIHRvIGFuZCBpbmNsdWRpbmcgdGhlIG9mZnNldC4gSWYgeW91IHVzZSBhbiBvZmZzZXQgb2YgMywgZm9yIGV4YW1wbGUsXG5cdCAqIHlvdSBtdXN0IHByb3ZpZGUgZXhwbGljaXQgbnVtYmVyIHJ1bGVzIGZvciAwLCAxLCAyIGFuZCAzLiBZb3UgbXVzdCBhbHNvIHByb3ZpZGUgcGx1cmFsIHN0cmluZ3MgZm9yXG5cdCAqIHBsdXJhbCBjYXRlZ29yaWVzIFwib25lXCIgYW5kIFwib3RoZXJcIi5cblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd8ZXhwcmVzc2lvbn0gY291bnQgVGhlIHZhcmlhYmxlIHRvIGJlIGJvdW5kIHRvLlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gd2hlbiBUaGUgbWFwcGluZyBiZXR3ZWVuIHBsdXJhbCBjYXRlZ29yeSB0byBpdHMgY29ycmVzcG9uZGluZyBzdHJpbmdzLlxuXHQgKiBAcGFyYW0ge251bWJlcj19IG9mZnNldCBPZmZzZXQgdG8gZGVkdWN0IGZyb20gdGhlIHRvdGFsIG51bWJlci5cblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICAgIDxleGFtcGxlIG1vZHVsZT1cInBsdXJhbGl6ZUV4YW1wbGVcIj5cblx0ICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgICA8c2NyaXB0PlxuXHQgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ3BsdXJhbGl6ZUV4YW1wbGUnLCBbXSlcblx0ICAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAgICAgICAkc2NvcGUucGVyc29uMSA9ICdJZ29yJztcblx0ICAgICAgICAgICAgICAkc2NvcGUucGVyc29uMiA9ICdNaXNrbyc7XG5cdCAgICAgICAgICAgICAgJHNjb3BlLnBlcnNvbkNvdW50ID0gMTtcblx0ICAgICAgICAgICAgfV0pO1xuXHQgICAgICAgIDwvc2NyaXB0PlxuXHQgICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAgICAgICAgICA8bGFiZWw+UGVyc29uIDE6PGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJwZXJzb24xXCIgdmFsdWU9XCJJZ29yXCIgLz48L2xhYmVsPjxici8+XG5cdCAgICAgICAgICA8bGFiZWw+UGVyc29uIDI6PGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJwZXJzb24yXCIgdmFsdWU9XCJNaXNrb1wiIC8+PC9sYWJlbD48YnIvPlxuXHQgICAgICAgICAgPGxhYmVsPk51bWJlciBvZiBQZW9wbGU6PGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJwZXJzb25Db3VudFwiIHZhbHVlPVwiMVwiIC8+PC9sYWJlbD48YnIvPlxuXHRcblx0ICAgICAgICAgIDwhLS0tIEV4YW1wbGUgd2l0aCBzaW1wbGUgcGx1cmFsaXphdGlvbiBydWxlcyBmb3IgZW4gbG9jYWxlIC0tLT5cblx0ICAgICAgICAgIFdpdGhvdXQgT2Zmc2V0OlxuXHQgICAgICAgICAgPG5nLXBsdXJhbGl6ZSBjb3VudD1cInBlcnNvbkNvdW50XCJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgd2hlbj1cInsnMCc6ICdOb2JvZHkgaXMgdmlld2luZy4nLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29uZSc6ICcxIHBlcnNvbiBpcyB2aWV3aW5nLicsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3RoZXInOiAne30gcGVvcGxlIGFyZSB2aWV3aW5nLid9XCI+XG5cdCAgICAgICAgICA8L25nLXBsdXJhbGl6ZT48YnI+XG5cdFxuXHQgICAgICAgICAgPCEtLS0gRXhhbXBsZSB3aXRoIG9mZnNldCAtLS0+XG5cdCAgICAgICAgICBXaXRoIE9mZnNldCgyKTpcblx0ICAgICAgICAgIDxuZy1wbHVyYWxpemUgY291bnQ9XCJwZXJzb25Db3VudFwiIG9mZnNldD0yXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHdoZW49XCJ7JzAnOiAnTm9ib2R5IGlzIHZpZXdpbmcuJyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcxJzogJ3t7cGVyc29uMX19IGlzIHZpZXdpbmcuJyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcyJzogJ3t7cGVyc29uMX19IGFuZCB7e3BlcnNvbjJ9fSBhcmUgdmlld2luZy4nLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29uZSc6ICd7e3BlcnNvbjF9fSwge3twZXJzb24yfX0gYW5kIG9uZSBvdGhlciBwZXJzb24gYXJlIHZpZXdpbmcuJyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvdGhlcic6ICd7e3BlcnNvbjF9fSwge3twZXJzb24yfX0gYW5kIHt9IG90aGVyIHBlb3BsZSBhcmUgdmlld2luZy4nfVwiPlxuXHQgICAgICAgICAgPC9uZy1wbHVyYWxpemU+XG5cdCAgICAgICAgPC9kaXY+XG5cdCAgICAgIDwvZmlsZT5cblx0ICAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgIGl0KCdzaG91bGQgc2hvdyBjb3JyZWN0IHBsdXJhbGl6ZWQgc3RyaW5nJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICB2YXIgd2l0aG91dE9mZnNldCA9IGVsZW1lbnQuYWxsKGJ5LmNzcygnbmctcGx1cmFsaXplJykpLmdldCgwKTtcblx0ICAgICAgICAgIHZhciB3aXRoT2Zmc2V0ID0gZWxlbWVudC5hbGwoYnkuY3NzKCduZy1wbHVyYWxpemUnKSkuZ2V0KDEpO1xuXHQgICAgICAgICAgdmFyIGNvdW50SW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdwZXJzb25Db3VudCcpKTtcblx0XG5cdCAgICAgICAgICBleHBlY3Qod2l0aG91dE9mZnNldC5nZXRUZXh0KCkpLnRvRXF1YWwoJzEgcGVyc29uIGlzIHZpZXdpbmcuJyk7XG5cdCAgICAgICAgICBleHBlY3Qod2l0aE9mZnNldC5nZXRUZXh0KCkpLnRvRXF1YWwoJ0lnb3IgaXMgdmlld2luZy4nKTtcblx0XG5cdCAgICAgICAgICBjb3VudElucHV0LmNsZWFyKCk7XG5cdCAgICAgICAgICBjb3VudElucHV0LnNlbmRLZXlzKCcwJyk7XG5cdFxuXHQgICAgICAgICAgZXhwZWN0KHdpdGhvdXRPZmZzZXQuZ2V0VGV4dCgpKS50b0VxdWFsKCdOb2JvZHkgaXMgdmlld2luZy4nKTtcblx0ICAgICAgICAgIGV4cGVjdCh3aXRoT2Zmc2V0LmdldFRleHQoKSkudG9FcXVhbCgnTm9ib2R5IGlzIHZpZXdpbmcuJyk7XG5cdFxuXHQgICAgICAgICAgY291bnRJbnB1dC5jbGVhcigpO1xuXHQgICAgICAgICAgY291bnRJbnB1dC5zZW5kS2V5cygnMicpO1xuXHRcblx0ICAgICAgICAgIGV4cGVjdCh3aXRob3V0T2Zmc2V0LmdldFRleHQoKSkudG9FcXVhbCgnMiBwZW9wbGUgYXJlIHZpZXdpbmcuJyk7XG5cdCAgICAgICAgICBleHBlY3Qod2l0aE9mZnNldC5nZXRUZXh0KCkpLnRvRXF1YWwoJ0lnb3IgYW5kIE1pc2tvIGFyZSB2aWV3aW5nLicpO1xuXHRcblx0ICAgICAgICAgIGNvdW50SW5wdXQuY2xlYXIoKTtcblx0ICAgICAgICAgIGNvdW50SW5wdXQuc2VuZEtleXMoJzMnKTtcblx0XG5cdCAgICAgICAgICBleHBlY3Qod2l0aG91dE9mZnNldC5nZXRUZXh0KCkpLnRvRXF1YWwoJzMgcGVvcGxlIGFyZSB2aWV3aW5nLicpO1xuXHQgICAgICAgICAgZXhwZWN0KHdpdGhPZmZzZXQuZ2V0VGV4dCgpKS50b0VxdWFsKCdJZ29yLCBNaXNrbyBhbmQgb25lIG90aGVyIHBlcnNvbiBhcmUgdmlld2luZy4nKTtcblx0XG5cdCAgICAgICAgICBjb3VudElucHV0LmNsZWFyKCk7XG5cdCAgICAgICAgICBjb3VudElucHV0LnNlbmRLZXlzKCc0Jyk7XG5cdFxuXHQgICAgICAgICAgZXhwZWN0KHdpdGhvdXRPZmZzZXQuZ2V0VGV4dCgpKS50b0VxdWFsKCc0IHBlb3BsZSBhcmUgdmlld2luZy4nKTtcblx0ICAgICAgICAgIGV4cGVjdCh3aXRoT2Zmc2V0LmdldFRleHQoKSkudG9FcXVhbCgnSWdvciwgTWlza28gYW5kIDIgb3RoZXIgcGVvcGxlIGFyZSB2aWV3aW5nLicpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIGl0KCdzaG91bGQgc2hvdyBkYXRhLWJvdW5kIG5hbWVzJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICB2YXIgd2l0aE9mZnNldCA9IGVsZW1lbnQuYWxsKGJ5LmNzcygnbmctcGx1cmFsaXplJykpLmdldCgxKTtcblx0ICAgICAgICAgIHZhciBwZXJzb25Db3VudCA9IGVsZW1lbnQoYnkubW9kZWwoJ3BlcnNvbkNvdW50JykpO1xuXHQgICAgICAgICAgdmFyIHBlcnNvbjEgPSBlbGVtZW50KGJ5Lm1vZGVsKCdwZXJzb24xJykpO1xuXHQgICAgICAgICAgdmFyIHBlcnNvbjIgPSBlbGVtZW50KGJ5Lm1vZGVsKCdwZXJzb24yJykpO1xuXHQgICAgICAgICAgcGVyc29uQ291bnQuY2xlYXIoKTtcblx0ICAgICAgICAgIHBlcnNvbkNvdW50LnNlbmRLZXlzKCc0Jyk7XG5cdCAgICAgICAgICBwZXJzb24xLmNsZWFyKCk7XG5cdCAgICAgICAgICBwZXJzb24xLnNlbmRLZXlzKCdEaScpO1xuXHQgICAgICAgICAgcGVyc29uMi5jbGVhcigpO1xuXHQgICAgICAgICAgcGVyc29uMi5zZW5kS2V5cygnVm9qdGEnKTtcblx0ICAgICAgICAgIGV4cGVjdCh3aXRoT2Zmc2V0LmdldFRleHQoKSkudG9FcXVhbCgnRGksIFZvanRhIGFuZCAyIG90aGVyIHBlb3BsZSBhcmUgdmlld2luZy4nKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgPC9maWxlPlxuXHQgICAgPC9leGFtcGxlPlxuXHQgKi9cblx0dmFyIG5nUGx1cmFsaXplRGlyZWN0aXZlID0gWyckbG9jYWxlJywgJyRpbnRlcnBvbGF0ZScsICckbG9nJywgZnVuY3Rpb24oJGxvY2FsZSwgJGludGVycG9sYXRlLCAkbG9nKSB7XG5cdCAgdmFyIEJSQUNFID0gL3t9L2csXG5cdCAgICAgIElTX1dIRU4gPSAvXndoZW4oTWludXMpPyguKykkLztcblx0XG5cdCAgcmV0dXJuIHtcblx0ICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG5cdCAgICAgIHZhciBudW1iZXJFeHAgPSBhdHRyLmNvdW50LFxuXHQgICAgICAgICAgd2hlbkV4cCA9IGF0dHIuJGF0dHIud2hlbiAmJiBlbGVtZW50LmF0dHIoYXR0ci4kYXR0ci53aGVuKSwgLy8gd2UgaGF2ZSB7e319IGluIGF0dHJzXG5cdCAgICAgICAgICBvZmZzZXQgPSBhdHRyLm9mZnNldCB8fCAwLFxuXHQgICAgICAgICAgd2hlbnMgPSBzY29wZS4kZXZhbCh3aGVuRXhwKSB8fCB7fSxcblx0ICAgICAgICAgIHdoZW5zRXhwRm5zID0ge30sXG5cdCAgICAgICAgICBzdGFydFN5bWJvbCA9ICRpbnRlcnBvbGF0ZS5zdGFydFN5bWJvbCgpLFxuXHQgICAgICAgICAgZW5kU3ltYm9sID0gJGludGVycG9sYXRlLmVuZFN5bWJvbCgpLFxuXHQgICAgICAgICAgYnJhY2VSZXBsYWNlbWVudCA9IHN0YXJ0U3ltYm9sICsgbnVtYmVyRXhwICsgJy0nICsgb2Zmc2V0ICsgZW5kU3ltYm9sLFxuXHQgICAgICAgICAgd2F0Y2hSZW1vdmVyID0gYW5ndWxhci5ub29wLFxuXHQgICAgICAgICAgbGFzdENvdW50O1xuXHRcblx0ICAgICAgZm9yRWFjaChhdHRyLCBmdW5jdGlvbihleHByZXNzaW9uLCBhdHRyaWJ1dGVOYW1lKSB7XG5cdCAgICAgICAgdmFyIHRtcE1hdGNoID0gSVNfV0hFTi5leGVjKGF0dHJpYnV0ZU5hbWUpO1xuXHQgICAgICAgIGlmICh0bXBNYXRjaCkge1xuXHQgICAgICAgICAgdmFyIHdoZW5LZXkgPSAodG1wTWF0Y2hbMV0gPyAnLScgOiAnJykgKyBsb3dlcmNhc2UodG1wTWF0Y2hbMl0pO1xuXHQgICAgICAgICAgd2hlbnNbd2hlbktleV0gPSBlbGVtZW50LmF0dHIoYXR0ci4kYXR0clthdHRyaWJ1dGVOYW1lXSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0ICAgICAgZm9yRWFjaCh3aGVucywgZnVuY3Rpb24oZXhwcmVzc2lvbiwga2V5KSB7XG5cdCAgICAgICAgd2hlbnNFeHBGbnNba2V5XSA9ICRpbnRlcnBvbGF0ZShleHByZXNzaW9uLnJlcGxhY2UoQlJBQ0UsIGJyYWNlUmVwbGFjZW1lbnQpKTtcblx0XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgc2NvcGUuJHdhdGNoKG51bWJlckV4cCwgZnVuY3Rpb24gbmdQbHVyYWxpemVXYXRjaEFjdGlvbihuZXdWYWwpIHtcblx0ICAgICAgICB2YXIgY291bnQgPSBwYXJzZUZsb2F0KG5ld1ZhbCk7XG5cdCAgICAgICAgdmFyIGNvdW50SXNOYU4gPSBpc05hTihjb3VudCk7XG5cdFxuXHQgICAgICAgIGlmICghY291bnRJc05hTiAmJiAhKGNvdW50IGluIHdoZW5zKSkge1xuXHQgICAgICAgICAgLy8gSWYgYW4gZXhwbGljaXQgbnVtYmVyIHJ1bGUgc3VjaCBhcyAxLCAyLCAzLi4uIGlzIGRlZmluZWQsIGp1c3QgdXNlIGl0LlxuXHQgICAgICAgICAgLy8gT3RoZXJ3aXNlLCBjaGVjayBpdCBhZ2FpbnN0IHBsdXJhbGl6YXRpb24gcnVsZXMgaW4gJGxvY2FsZSBzZXJ2aWNlLlxuXHQgICAgICAgICAgY291bnQgPSAkbG9jYWxlLnBsdXJhbENhdChjb3VudCAtIG9mZnNldCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvLyBJZiBib3RoIGBjb3VudGAgYW5kIGBsYXN0Q291bnRgIGFyZSBOYU4sIHdlIGRvbid0IG5lZWQgdG8gcmUtcmVnaXN0ZXIgYSB3YXRjaC5cblx0ICAgICAgICAvLyBJbiBKUyBgTmFOICE9PSBOYU5gLCBzbyB3ZSBoYXZlIHRvIGV4cGxpY2l0bHkgY2hlY2suXG5cdCAgICAgICAgaWYgKChjb3VudCAhPT0gbGFzdENvdW50KSAmJiAhKGNvdW50SXNOYU4gJiYgaXNOdW1iZXIobGFzdENvdW50KSAmJiBpc05hTihsYXN0Q291bnQpKSkge1xuXHQgICAgICAgICAgd2F0Y2hSZW1vdmVyKCk7XG5cdCAgICAgICAgICB2YXIgd2hlbkV4cEZuID0gd2hlbnNFeHBGbnNbY291bnRdO1xuXHQgICAgICAgICAgaWYgKGlzVW5kZWZpbmVkKHdoZW5FeHBGbikpIHtcblx0ICAgICAgICAgICAgaWYgKG5ld1ZhbCAhPSBudWxsKSB7XG5cdCAgICAgICAgICAgICAgJGxvZy5kZWJ1ZyhcIm5nUGx1cmFsaXplOiBubyBydWxlIGRlZmluZWQgZm9yICdcIiArIGNvdW50ICsgXCInIGluIFwiICsgd2hlbkV4cCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgd2F0Y2hSZW1vdmVyID0gbm9vcDtcblx0ICAgICAgICAgICAgdXBkYXRlRWxlbWVudFRleHQoKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHdhdGNoUmVtb3ZlciA9IHNjb3BlLiR3YXRjaCh3aGVuRXhwRm4sIHVwZGF0ZUVsZW1lbnRUZXh0KTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGxhc3RDb3VudCA9IGNvdW50O1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBmdW5jdGlvbiB1cGRhdGVFbGVtZW50VGV4dChuZXdUZXh0KSB7XG5cdCAgICAgICAgZWxlbWVudC50ZXh0KG5ld1RleHQgfHwgJycpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfTtcblx0fV07XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ1JlcGVhdFxuXHQgKiBAbXVsdGlFbGVtZW50XG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUaGUgYG5nUmVwZWF0YCBkaXJlY3RpdmUgaW5zdGFudGlhdGVzIGEgdGVtcGxhdGUgb25jZSBwZXIgaXRlbSBmcm9tIGEgY29sbGVjdGlvbi4gRWFjaCB0ZW1wbGF0ZVxuXHQgKiBpbnN0YW5jZSBnZXRzIGl0cyBvd24gc2NvcGUsIHdoZXJlIHRoZSBnaXZlbiBsb29wIHZhcmlhYmxlIGlzIHNldCB0byB0aGUgY3VycmVudCBjb2xsZWN0aW9uIGl0ZW0sXG5cdCAqIGFuZCBgJGluZGV4YCBpcyBzZXQgdG8gdGhlIGl0ZW0gaW5kZXggb3Iga2V5LlxuXHQgKlxuXHQgKiBTcGVjaWFsIHByb3BlcnRpZXMgYXJlIGV4cG9zZWQgb24gdGhlIGxvY2FsIHNjb3BlIG9mIGVhY2ggdGVtcGxhdGUgaW5zdGFuY2UsIGluY2x1ZGluZzpcblx0ICpcblx0ICogfCBWYXJpYWJsZSAgfCBUeXBlICAgICAgICAgICAgfCBEZXRhaWxzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuXHQgKiB8LS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG5cdCAqIHwgYCRpbmRleGAgIHwge0B0eXBlIG51bWJlcn0gIHwgaXRlcmF0b3Igb2Zmc2V0IG9mIHRoZSByZXBlYXRlZCBlbGVtZW50ICgwLi5sZW5ndGgtMSkgICAgICAgICAgICAgICAgICAgICAgIHxcblx0ICogfCBgJGZpcnN0YCAgfCB7QHR5cGUgYm9vbGVhbn0gfCB0cnVlIGlmIHRoZSByZXBlYXRlZCBlbGVtZW50IGlzIGZpcnN0IGluIHRoZSBpdGVyYXRvci4gICAgICAgICAgICAgICAgICAgICAgfFxuXHQgKiB8IGAkbWlkZGxlYCB8IHtAdHlwZSBib29sZWFufSB8IHRydWUgaWYgdGhlIHJlcGVhdGVkIGVsZW1lbnQgaXMgYmV0d2VlbiB0aGUgZmlyc3QgYW5kIGxhc3QgaW4gdGhlIGl0ZXJhdG9yLiB8XG5cdCAqIHwgYCRsYXN0YCAgIHwge0B0eXBlIGJvb2xlYW59IHwgdHJ1ZSBpZiB0aGUgcmVwZWF0ZWQgZWxlbWVudCBpcyBsYXN0IGluIHRoZSBpdGVyYXRvci4gICAgICAgICAgICAgICAgICAgICAgIHxcblx0ICogfCBgJGV2ZW5gICAgfCB7QHR5cGUgYm9vbGVhbn0gfCB0cnVlIGlmIHRoZSBpdGVyYXRvciBwb3NpdGlvbiBgJGluZGV4YCBpcyBldmVuIChvdGhlcndpc2UgZmFsc2UpLiAgICAgICAgICAgfFxuXHQgKiB8IGAkb2RkYCAgICB8IHtAdHlwZSBib29sZWFufSB8IHRydWUgaWYgdGhlIGl0ZXJhdG9yIHBvc2l0aW9uIGAkaW5kZXhgIGlzIG9kZCAob3RoZXJ3aXNlIGZhbHNlKS4gICAgICAgICAgICB8XG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1pbmZvXCI+XG5cdCAqICAgQ3JlYXRpbmcgYWxpYXNlcyBmb3IgdGhlc2UgcHJvcGVydGllcyBpcyBwb3NzaWJsZSB3aXRoIHtAbGluayBuZy5kaXJlY3RpdmU6bmdJbml0IGBuZ0luaXRgfS5cblx0ICogICBUaGlzIG1heSBiZSB1c2VmdWwgd2hlbiwgZm9yIGluc3RhbmNlLCBuZXN0aW5nIG5nUmVwZWF0cy5cblx0ICogPC9kaXY+XG5cdCAqXG5cdCAqXG5cdCAqICMgSXRlcmF0aW5nIG92ZXIgb2JqZWN0IHByb3BlcnRpZXNcblx0ICpcblx0ICogSXQgaXMgcG9zc2libGUgdG8gZ2V0IGBuZ1JlcGVhdGAgdG8gaXRlcmF0ZSBvdmVyIHRoZSBwcm9wZXJ0aWVzIG9mIGFuIG9iamVjdCB1c2luZyB0aGUgZm9sbG93aW5nXG5cdCAqIHN5bnRheDpcblx0ICpcblx0ICogYGBganNcblx0ICogPGRpdiBuZy1yZXBlYXQ9XCIoa2V5LCB2YWx1ZSkgaW4gbXlPYmpcIj4gLi4uIDwvZGl2PlxuXHQgKiBgYGBcblx0ICpcblx0ICogWW91IG5lZWQgdG8gYmUgYXdhcmUgdGhhdCB0aGUgSmF2YVNjcmlwdCBzcGVjaWZpY2F0aW9uIGRvZXMgbm90IGRlZmluZSB0aGUgb3JkZXIgb2Yga2V5c1xuXHQgKiByZXR1cm5lZCBmb3IgYW4gb2JqZWN0LiAoVG8gbWl0aWdhdGUgdGhpcyBpbiBBbmd1bGFyIDEuMyB0aGUgYG5nUmVwZWF0YCBkaXJlY3RpdmVcblx0ICogdXNlZCB0byBzb3J0IHRoZSBrZXlzIGFscGhhYmV0aWNhbGx5Lilcblx0ICpcblx0ICogVmVyc2lvbiAxLjQgcmVtb3ZlZCB0aGUgYWxwaGFiZXRpYyBzb3J0aW5nLiBXZSBub3cgcmVseSBvbiB0aGUgb3JkZXIgcmV0dXJuZWQgYnkgdGhlIGJyb3dzZXJcblx0ICogd2hlbiBydW5uaW5nIGBmb3Iga2V5IGluIG15T2JqYC4gSXQgc2VlbXMgdGhhdCBicm93c2VycyBnZW5lcmFsbHkgZm9sbG93IHRoZSBzdHJhdGVneSBvZiBwcm92aWRpbmdcblx0ICoga2V5cyBpbiB0aGUgb3JkZXIgaW4gd2hpY2ggdGhleSB3ZXJlIGRlZmluZWQsIGFsdGhvdWdoIHRoZXJlIGFyZSBleGNlcHRpb25zIHdoZW4ga2V5cyBhcmUgZGVsZXRlZFxuXHQgKiBhbmQgcmVpbnN0YXRlZC4gU2VlIHRoZSBbTUROIHBhZ2Ugb24gYGRlbGV0ZWAgZm9yIG1vcmUgaW5mb10oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvT3BlcmF0b3JzL2RlbGV0ZSNDcm9zcy1icm93c2VyX25vdGVzKS5cblx0ICpcblx0ICogSWYgdGhpcyBpcyBub3QgZGVzaXJlZCwgdGhlIHJlY29tbWVuZGVkIHdvcmthcm91bmQgaXMgdG8gY29udmVydCB5b3VyIG9iamVjdCBpbnRvIGFuIGFycmF5XG5cdCAqIHRoYXQgaXMgc29ydGVkIGludG8gdGhlIG9yZGVyIHRoYXQgeW91IHByZWZlciBiZWZvcmUgcHJvdmlkaW5nIGl0IHRvIGBuZ1JlcGVhdGAuICBZb3UgY291bGRcblx0ICogZG8gdGhpcyB3aXRoIGEgZmlsdGVyIHN1Y2ggYXMgW3RvQXJyYXlGaWx0ZXJdKGh0dHA6Ly9uZ21vZHVsZXMub3JnL21vZHVsZXMvYW5ndWxhci10b0FycmF5RmlsdGVyKVxuXHQgKiBvciBpbXBsZW1lbnQgYSBgJHdhdGNoYCBvbiB0aGUgb2JqZWN0IHlvdXJzZWxmLlxuXHQgKlxuXHQgKlxuXHQgKiAjIFRyYWNraW5nIGFuZCBEdXBsaWNhdGVzXG5cdCAqXG5cdCAqIGBuZ1JlcGVhdGAgdXNlcyB7QGxpbmsgJHJvb3RTY29wZS5TY29wZSMkd2F0Y2hDb2xsZWN0aW9uICR3YXRjaENvbGxlY3Rpb259IHRvIGRldGVjdCBjaGFuZ2VzIGluXG5cdCAqIHRoZSBjb2xsZWN0aW9uLiBXaGVuIGEgY2hhbmdlIGhhcHBlbnMsIG5nUmVwZWF0IHRoZW4gbWFrZXMgdGhlIGNvcnJlc3BvbmRpbmcgY2hhbmdlcyB0byB0aGUgRE9NOlxuXHQgKlxuXHQgKiAqIFdoZW4gYW4gaXRlbSBpcyBhZGRlZCwgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIHRlbXBsYXRlIGlzIGFkZGVkIHRvIHRoZSBET00uXG5cdCAqICogV2hlbiBhbiBpdGVtIGlzIHJlbW92ZWQsIGl0cyB0ZW1wbGF0ZSBpbnN0YW5jZSBpcyByZW1vdmVkIGZyb20gdGhlIERPTS5cblx0ICogKiBXaGVuIGl0ZW1zIGFyZSByZW9yZGVyZWQsIHRoZWlyIHJlc3BlY3RpdmUgdGVtcGxhdGVzIGFyZSByZW9yZGVyZWQgaW4gdGhlIERPTS5cblx0ICpcblx0ICogVG8gbWluaW1pemUgY3JlYXRpb24gb2YgRE9NIGVsZW1lbnRzLCBgbmdSZXBlYXRgIHVzZXMgYSBmdW5jdGlvblxuXHQgKiB0byBcImtlZXAgdHJhY2tcIiBvZiBhbGwgaXRlbXMgaW4gdGhlIGNvbGxlY3Rpb24gYW5kIHRoZWlyIGNvcnJlc3BvbmRpbmcgRE9NIGVsZW1lbnRzLlxuXHQgKiBGb3IgZXhhbXBsZSwgaWYgYW4gaXRlbSBpcyBhZGRlZCB0byB0aGUgY29sbGVjdGlvbiwgbmdSZXBlYXQgd2lsbCBrbm93IHRoYXQgYWxsIG90aGVyIGl0ZW1zXG5cdCAqIGFscmVhZHkgaGF2ZSBET00gZWxlbWVudHMsIGFuZCB3aWxsIG5vdCByZS1yZW5kZXIgdGhlbS5cblx0ICpcblx0ICogVGhlIGRlZmF1bHQgdHJhY2tpbmcgZnVuY3Rpb24gKHdoaWNoIHRyYWNrcyBpdGVtcyBieSB0aGVpciBpZGVudGl0eSkgZG9lcyBub3QgYWxsb3dcblx0ICogZHVwbGljYXRlIGl0ZW1zIGluIGFycmF5cy4gVGhpcyBpcyBiZWNhdXNlIHdoZW4gdGhlcmUgYXJlIGR1cGxpY2F0ZXMsIGl0IGlzIG5vdCBwb3NzaWJsZVxuXHQgKiB0byBtYWludGFpbiBhIG9uZS10by1vbmUgbWFwcGluZyBiZXR3ZWVuIGNvbGxlY3Rpb24gaXRlbXMgYW5kIERPTSBlbGVtZW50cy5cblx0ICpcblx0ICogSWYgeW91IGRvIG5lZWQgdG8gcmVwZWF0IGR1cGxpY2F0ZSBpdGVtcywgeW91IGNhbiBzdWJzdGl0dXRlIHRoZSBkZWZhdWx0IHRyYWNraW5nIGJlaGF2aW9yXG5cdCAqIHdpdGggeW91ciBvd24gdXNpbmcgdGhlIGB0cmFjayBieWAgZXhwcmVzc2lvbi5cblx0ICpcblx0ICogRm9yIGV4YW1wbGUsIHlvdSBtYXkgdHJhY2sgaXRlbXMgYnkgdGhlIGluZGV4IG9mIGVhY2ggaXRlbSBpbiB0aGUgY29sbGVjdGlvbiwgdXNpbmcgdGhlXG5cdCAqIHNwZWNpYWwgc2NvcGUgcHJvcGVydHkgYCRpbmRleGA6XG5cdCAqIGBgYGh0bWxcblx0ICogICAgPGRpdiBuZy1yZXBlYXQ9XCJuIGluIFs0MiwgNDIsIDQzLCA0M10gdHJhY2sgYnkgJGluZGV4XCI+XG5cdCAqICAgICAge3tufX1cblx0ICogICAgPC9kaXY+XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBZb3UgbWF5IGFsc28gdXNlIGFyYml0cmFyeSBleHByZXNzaW9ucyBpbiBgdHJhY2sgYnlgLCBpbmNsdWRpbmcgcmVmZXJlbmNlcyB0byBjdXN0b20gZnVuY3Rpb25zXG5cdCAqIG9uIHRoZSBzY29wZTpcblx0ICogYGBgaHRtbFxuXHQgKiAgICA8ZGl2IG5nLXJlcGVhdD1cIm4gaW4gWzQyLCA0MiwgNDMsIDQzXSB0cmFjayBieSBteVRyYWNraW5nRnVuY3Rpb24obilcIj5cblx0ICogICAgICB7e259fVxuXHQgKiAgICA8L2Rpdj5cblx0ICogYGBgXG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1zdWNjZXNzXCI+XG5cdCAqIElmIHlvdSBhcmUgd29ya2luZyB3aXRoIG9iamVjdHMgdGhhdCBoYXZlIGFuIGlkZW50aWZpZXIgcHJvcGVydHksIHlvdSBzaG91bGQgdHJhY2tcblx0ICogYnkgdGhlIGlkZW50aWZpZXIgaW5zdGVhZCBvZiB0aGUgd2hvbGUgb2JqZWN0LiBTaG91bGQgeW91IHJlbG9hZCB5b3VyIGRhdGEgbGF0ZXIsIGBuZ1JlcGVhdGBcblx0ICogd2lsbCBub3QgaGF2ZSB0byByZWJ1aWxkIHRoZSBET00gZWxlbWVudHMgZm9yIGl0ZW1zIGl0IGhhcyBhbHJlYWR5IHJlbmRlcmVkLCBldmVuIGlmIHRoZVxuXHQgKiBKYXZhU2NyaXB0IG9iamVjdHMgaW4gdGhlIGNvbGxlY3Rpb24gaGF2ZSBiZWVuIHN1YnN0aXR1dGVkIGZvciBuZXcgb25lcy4gRm9yIGxhcmdlIGNvbGxlY3Rpb25zLFxuXHQgKiB0aGlzIHNpZ25pZmljYW50bHkgaW1wcm92ZXMgcmVuZGVyaW5nIHBlcmZvcm1hbmNlLiBJZiB5b3UgZG9uJ3QgaGF2ZSBhIHVuaXF1ZSBpZGVudGlmaWVyLFxuXHQgKiBgdHJhY2sgYnkgJGluZGV4YCBjYW4gYWxzbyBwcm92aWRlIGEgcGVyZm9ybWFuY2UgYm9vc3QuXG5cdCAqIDwvZGl2PlxuXHQgKiBgYGBodG1sXG5cdCAqICAgIDxkaXYgbmctcmVwZWF0PVwibW9kZWwgaW4gY29sbGVjdGlvbiB0cmFjayBieSBtb2RlbC5pZFwiPlxuXHQgKiAgICAgIHt7bW9kZWwubmFtZX19XG5cdCAqICAgIDwvZGl2PlxuXHQgKiBgYGBcblx0ICpcblx0ICogV2hlbiBubyBgdHJhY2sgYnlgIGV4cHJlc3Npb24gaXMgcHJvdmlkZWQsIGl0IGlzIGVxdWl2YWxlbnQgdG8gdHJhY2tpbmcgYnkgdGhlIGJ1aWx0LWluXG5cdCAqIGAkaWRgIGZ1bmN0aW9uLCB3aGljaCB0cmFja3MgaXRlbXMgYnkgdGhlaXIgaWRlbnRpdHk6XG5cdCAqIGBgYGh0bWxcblx0ICogICAgPGRpdiBuZy1yZXBlYXQ9XCJvYmogaW4gY29sbGVjdGlvbiB0cmFjayBieSAkaWQob2JqKVwiPlxuXHQgKiAgICAgIHt7b2JqLnByb3B9fVxuXHQgKiAgICA8L2Rpdj5cblx0ICogYGBgXG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG5cdCAqICoqTm90ZToqKiBgdHJhY2sgYnlgIG11c3QgYWx3YXlzIGJlIHRoZSBsYXN0IGV4cHJlc3Npb246XG5cdCAqIDwvZGl2PlxuXHQgKiBgYGBcblx0ICogPGRpdiBuZy1yZXBlYXQ9XCJtb2RlbCBpbiBjb2xsZWN0aW9uIHwgb3JkZXJCeTogJ2lkJyBhcyBmaWx0ZXJlZF9yZXN1bHQgdHJhY2sgYnkgbW9kZWwuaWRcIj5cblx0ICogICAgIHt7bW9kZWwubmFtZX19XG5cdCAqIDwvZGl2PlxuXHQgKiBgYGBcblx0ICpcblx0ICogIyBTcGVjaWFsIHJlcGVhdCBzdGFydCBhbmQgZW5kIHBvaW50c1xuXHQgKiBUbyByZXBlYXQgYSBzZXJpZXMgb2YgZWxlbWVudHMgaW5zdGVhZCBvZiBqdXN0IG9uZSBwYXJlbnQgZWxlbWVudCwgbmdSZXBlYXQgKGFzIHdlbGwgYXMgb3RoZXIgbmcgZGlyZWN0aXZlcykgc3VwcG9ydHMgZXh0ZW5kaW5nXG5cdCAqIHRoZSByYW5nZSBvZiB0aGUgcmVwZWF0ZXIgYnkgZGVmaW5pbmcgZXhwbGljaXQgc3RhcnQgYW5kIGVuZCBwb2ludHMgYnkgdXNpbmcgKipuZy1yZXBlYXQtc3RhcnQqKiBhbmQgKipuZy1yZXBlYXQtZW5kKiogcmVzcGVjdGl2ZWx5LlxuXHQgKiBUaGUgKipuZy1yZXBlYXQtc3RhcnQqKiBkaXJlY3RpdmUgd29ya3MgdGhlIHNhbWUgYXMgKipuZy1yZXBlYXQqKiwgYnV0IHdpbGwgcmVwZWF0IGFsbCB0aGUgSFRNTCBjb2RlIChpbmNsdWRpbmcgdGhlIHRhZyBpdCdzIGRlZmluZWQgb24pXG5cdCAqIHVwIHRvIGFuZCBpbmNsdWRpbmcgdGhlIGVuZGluZyBIVE1MIHRhZyB3aGVyZSAqKm5nLXJlcGVhdC1lbmQqKiBpcyBwbGFjZWQuXG5cdCAqXG5cdCAqIFRoZSBleGFtcGxlIGJlbG93IG1ha2VzIHVzZSBvZiB0aGlzIGZlYXR1cmU6XG5cdCAqIGBgYGh0bWxcblx0ICogICA8aGVhZGVyIG5nLXJlcGVhdC1zdGFydD1cIml0ZW0gaW4gaXRlbXNcIj5cblx0ICogICAgIEhlYWRlciB7eyBpdGVtIH19XG5cdCAqICAgPC9oZWFkZXI+XG5cdCAqICAgPGRpdiBjbGFzcz1cImJvZHlcIj5cblx0ICogICAgIEJvZHkge3sgaXRlbSB9fVxuXHQgKiAgIDwvZGl2PlxuXHQgKiAgIDxmb290ZXIgbmctcmVwZWF0LWVuZD5cblx0ICogICAgIEZvb3RlciB7eyBpdGVtIH19XG5cdCAqICAgPC9mb290ZXI+XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBBbmQgd2l0aCBhbiBpbnB1dCBvZiB7QHR5cGUgWydBJywnQiddfSBmb3IgdGhlIGl0ZW1zIHZhcmlhYmxlIGluIHRoZSBleGFtcGxlIGFib3ZlLCB0aGUgb3V0cHV0IHdpbGwgZXZhbHVhdGUgdG86XG5cdCAqIGBgYGh0bWxcblx0ICogICA8aGVhZGVyPlxuXHQgKiAgICAgSGVhZGVyIEFcblx0ICogICA8L2hlYWRlcj5cblx0ICogICA8ZGl2IGNsYXNzPVwiYm9keVwiPlxuXHQgKiAgICAgQm9keSBBXG5cdCAqICAgPC9kaXY+XG5cdCAqICAgPGZvb3Rlcj5cblx0ICogICAgIEZvb3RlciBBXG5cdCAqICAgPC9mb290ZXI+XG5cdCAqICAgPGhlYWRlcj5cblx0ICogICAgIEhlYWRlciBCXG5cdCAqICAgPC9oZWFkZXI+XG5cdCAqICAgPGRpdiBjbGFzcz1cImJvZHlcIj5cblx0ICogICAgIEJvZHkgQlxuXHQgKiAgIDwvZGl2PlxuXHQgKiAgIDxmb290ZXI+XG5cdCAqICAgICBGb290ZXIgQlxuXHQgKiAgIDwvZm9vdGVyPlxuXHQgKiBgYGBcblx0ICpcblx0ICogVGhlIGN1c3RvbSBzdGFydCBhbmQgZW5kIHBvaW50cyBmb3IgbmdSZXBlYXQgYWxzbyBzdXBwb3J0IGFsbCBvdGhlciBIVE1MIGRpcmVjdGl2ZSBzeW50YXggZmxhdm9ycyBwcm92aWRlZCBpbiBBbmd1bGFySlMgKHN1Y2hcblx0ICogYXMgKipkYXRhLW5nLXJlcGVhdC1zdGFydCoqLCAqKngtbmctcmVwZWF0LXN0YXJ0KiogYW5kICoqbmc6cmVwZWF0LXN0YXJ0KiopLlxuXHQgKlxuXHQgKiBAYW5pbWF0aW9uc1xuXHQgKiAqKi5lbnRlcioqIC0gd2hlbiBhIG5ldyBpdGVtIGlzIGFkZGVkIHRvIHRoZSBsaXN0IG9yIHdoZW4gYW4gaXRlbSBpcyByZXZlYWxlZCBhZnRlciBhIGZpbHRlclxuXHQgKlxuXHQgKiAqKi5sZWF2ZSoqIC0gd2hlbiBhbiBpdGVtIGlzIHJlbW92ZWQgZnJvbSB0aGUgbGlzdCBvciB3aGVuIGFuIGl0ZW0gaXMgZmlsdGVyZWQgb3V0XG5cdCAqXG5cdCAqICoqLm1vdmUqKiAtIHdoZW4gYW4gYWRqYWNlbnQgaXRlbSBpcyBmaWx0ZXJlZCBvdXQgY2F1c2luZyBhIHJlb3JkZXIgb3Igd2hlbiB0aGUgaXRlbSBjb250ZW50cyBhcmUgcmVvcmRlcmVkXG5cdCAqXG5cdCAqIFNlZSB0aGUgZXhhbXBsZSBiZWxvdyBmb3IgZGVmaW5pbmcgQ1NTIGFuaW1hdGlvbnMgd2l0aCBuZ1JlcGVhdC5cblx0ICpcblx0ICogQGVsZW1lbnQgQU5ZXG5cdCAqIEBzY29wZVxuXHQgKiBAcHJpb3JpdHkgMTAwMFxuXHQgKiBAcGFyYW0ge3JlcGVhdF9leHByZXNzaW9ufSBuZ1JlcGVhdCBUaGUgZXhwcmVzc2lvbiBpbmRpY2F0aW5nIGhvdyB0byBlbnVtZXJhdGUgYSBjb2xsZWN0aW9uLiBUaGVzZVxuXHQgKiAgIGZvcm1hdHMgYXJlIGN1cnJlbnRseSBzdXBwb3J0ZWQ6XG5cdCAqXG5cdCAqICAgKiBgdmFyaWFibGUgaW4gZXhwcmVzc2lvbmAg4oCTIHdoZXJlIHZhcmlhYmxlIGlzIHRoZSB1c2VyIGRlZmluZWQgbG9vcCB2YXJpYWJsZSBhbmQgYGV4cHJlc3Npb25gXG5cdCAqICAgICBpcyBhIHNjb3BlIGV4cHJlc3Npb24gZ2l2aW5nIHRoZSBjb2xsZWN0aW9uIHRvIGVudW1lcmF0ZS5cblx0ICpcblx0ICogICAgIEZvciBleGFtcGxlOiBgYWxidW0gaW4gYXJ0aXN0LmFsYnVtc2AuXG5cdCAqXG5cdCAqICAgKiBgKGtleSwgdmFsdWUpIGluIGV4cHJlc3Npb25gIOKAkyB3aGVyZSBga2V5YCBhbmQgYHZhbHVlYCBjYW4gYmUgYW55IHVzZXIgZGVmaW5lZCBpZGVudGlmaWVycyxcblx0ICogICAgIGFuZCBgZXhwcmVzc2lvbmAgaXMgdGhlIHNjb3BlIGV4cHJlc3Npb24gZ2l2aW5nIHRoZSBjb2xsZWN0aW9uIHRvIGVudW1lcmF0ZS5cblx0ICpcblx0ICogICAgIEZvciBleGFtcGxlOiBgKG5hbWUsIGFnZSkgaW4geydhZGFtJzoxMCwgJ2FtYWxpZSc6MTJ9YC5cblx0ICpcblx0ICogICAqIGB2YXJpYWJsZSBpbiBleHByZXNzaW9uIHRyYWNrIGJ5IHRyYWNraW5nX2V4cHJlc3Npb25gIOKAkyBZb3UgY2FuIGFsc28gcHJvdmlkZSBhbiBvcHRpb25hbCB0cmFja2luZyBleHByZXNzaW9uXG5cdCAqICAgICB3aGljaCBjYW4gYmUgdXNlZCB0byBhc3NvY2lhdGUgdGhlIG9iamVjdHMgaW4gdGhlIGNvbGxlY3Rpb24gd2l0aCB0aGUgRE9NIGVsZW1lbnRzLiBJZiBubyB0cmFja2luZyBleHByZXNzaW9uXG5cdCAqICAgICBpcyBzcGVjaWZpZWQsIG5nLXJlcGVhdCBhc3NvY2lhdGVzIGVsZW1lbnRzIGJ5IGlkZW50aXR5LiBJdCBpcyBhbiBlcnJvciB0byBoYXZlXG5cdCAqICAgICBtb3JlIHRoYW4gb25lIHRyYWNraW5nIGV4cHJlc3Npb24gdmFsdWUgcmVzb2x2ZSB0byB0aGUgc2FtZSBrZXkuIChUaGlzIHdvdWxkIG1lYW4gdGhhdCB0d28gZGlzdGluY3Qgb2JqZWN0cyBhcmVcblx0ICogICAgIG1hcHBlZCB0byB0aGUgc2FtZSBET00gZWxlbWVudCwgd2hpY2ggaXMgbm90IHBvc3NpYmxlLilcblx0ICpcblx0ICogICAgIE5vdGUgdGhhdCB0aGUgdHJhY2tpbmcgZXhwcmVzc2lvbiBtdXN0IGNvbWUgbGFzdCwgYWZ0ZXIgYW55IGZpbHRlcnMsIGFuZCB0aGUgYWxpYXMgZXhwcmVzc2lvbi5cblx0ICpcblx0ICogICAgIEZvciBleGFtcGxlOiBgaXRlbSBpbiBpdGVtc2AgaXMgZXF1aXZhbGVudCB0byBgaXRlbSBpbiBpdGVtcyB0cmFjayBieSAkaWQoaXRlbSlgLiBUaGlzIGltcGxpZXMgdGhhdCB0aGUgRE9NIGVsZW1lbnRzXG5cdCAqICAgICB3aWxsIGJlIGFzc29jaWF0ZWQgYnkgaXRlbSBpZGVudGl0eSBpbiB0aGUgYXJyYXkuXG5cdCAqXG5cdCAqICAgICBGb3IgZXhhbXBsZTogYGl0ZW0gaW4gaXRlbXMgdHJhY2sgYnkgJGlkKGl0ZW0pYC4gQSBidWlsdCBpbiBgJGlkKClgIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGFzc2lnbiBhIHVuaXF1ZVxuXHQgKiAgICAgYCQkaGFzaEtleWAgcHJvcGVydHkgdG8gZWFjaCBpdGVtIGluIHRoZSBhcnJheS4gVGhpcyBwcm9wZXJ0eSBpcyB0aGVuIHVzZWQgYXMgYSBrZXkgdG8gYXNzb2NpYXRlZCBET00gZWxlbWVudHNcblx0ICogICAgIHdpdGggdGhlIGNvcnJlc3BvbmRpbmcgaXRlbSBpbiB0aGUgYXJyYXkgYnkgaWRlbnRpdHkuIE1vdmluZyB0aGUgc2FtZSBvYmplY3QgaW4gYXJyYXkgd291bGQgbW92ZSB0aGUgRE9NXG5cdCAqICAgICBlbGVtZW50IGluIHRoZSBzYW1lIHdheSBpbiB0aGUgRE9NLlxuXHQgKlxuXHQgKiAgICAgRm9yIGV4YW1wbGU6IGBpdGVtIGluIGl0ZW1zIHRyYWNrIGJ5IGl0ZW0uaWRgIGlzIGEgdHlwaWNhbCBwYXR0ZXJuIHdoZW4gdGhlIGl0ZW1zIGNvbWUgZnJvbSB0aGUgZGF0YWJhc2UuIEluIHRoaXNcblx0ICogICAgIGNhc2UgdGhlIG9iamVjdCBpZGVudGl0eSBkb2VzIG5vdCBtYXR0ZXIuIFR3byBvYmplY3RzIGFyZSBjb25zaWRlcmVkIGVxdWl2YWxlbnQgYXMgbG9uZyBhcyB0aGVpciBgaWRgXG5cdCAqICAgICBwcm9wZXJ0eSBpcyBzYW1lLlxuXHQgKlxuXHQgKiAgICAgRm9yIGV4YW1wbGU6IGBpdGVtIGluIGl0ZW1zIHwgZmlsdGVyOnNlYXJjaFRleHQgdHJhY2sgYnkgaXRlbS5pZGAgaXMgYSBwYXR0ZXJuIHRoYXQgbWlnaHQgYmUgdXNlZCB0byBhcHBseSBhIGZpbHRlclxuXHQgKiAgICAgdG8gaXRlbXMgaW4gY29uanVuY3Rpb24gd2l0aCBhIHRyYWNraW5nIGV4cHJlc3Npb24uXG5cdCAqXG5cdCAqICAgKiBgdmFyaWFibGUgaW4gZXhwcmVzc2lvbiBhcyBhbGlhc19leHByZXNzaW9uYCDigJMgWW91IGNhbiBhbHNvIHByb3ZpZGUgYW4gb3B0aW9uYWwgYWxpYXMgZXhwcmVzc2lvbiB3aGljaCB3aWxsIHRoZW4gc3RvcmUgdGhlXG5cdCAqICAgICBpbnRlcm1lZGlhdGUgcmVzdWx0cyBvZiB0aGUgcmVwZWF0ZXIgYWZ0ZXIgdGhlIGZpbHRlcnMgaGF2ZSBiZWVuIGFwcGxpZWQuIFR5cGljYWxseSB0aGlzIGlzIHVzZWQgdG8gcmVuZGVyIGEgc3BlY2lhbCBtZXNzYWdlXG5cdCAqICAgICB3aGVuIGEgZmlsdGVyIGlzIGFjdGl2ZSBvbiB0aGUgcmVwZWF0ZXIsIGJ1dCB0aGUgZmlsdGVyZWQgcmVzdWx0IHNldCBpcyBlbXB0eS5cblx0ICpcblx0ICogICAgIEZvciBleGFtcGxlOiBgaXRlbSBpbiBpdGVtcyB8IGZpbHRlcjp4IGFzIHJlc3VsdHNgIHdpbGwgc3RvcmUgdGhlIGZyYWdtZW50IG9mIHRoZSByZXBlYXRlZCBpdGVtcyBhcyBgcmVzdWx0c2AsIGJ1dCBvbmx5IGFmdGVyXG5cdCAqICAgICB0aGUgaXRlbXMgaGF2ZSBiZWVuIHByb2Nlc3NlZCB0aHJvdWdoIHRoZSBmaWx0ZXIuXG5cdCAqXG5cdCAqICAgICBQbGVhc2Ugbm90ZSB0aGF0IGBhcyBbdmFyaWFibGUgbmFtZV0gaXMgbm90IGFuIG9wZXJhdG9yIGJ1dCByYXRoZXIgYSBwYXJ0IG9mIG5nUmVwZWF0IG1pY3JvLXN5bnRheCBzbyBpdCBjYW4gYmUgdXNlZCBvbmx5IGF0IHRoZSBlbmRcblx0ICogICAgIChhbmQgbm90IGFzIG9wZXJhdG9yLCBpbnNpZGUgYW4gZXhwcmVzc2lvbikuXG5cdCAqXG5cdCAqICAgICBGb3IgZXhhbXBsZTogYGl0ZW0gaW4gaXRlbXMgfCBmaWx0ZXIgOiB4IHwgb3JkZXJCeSA6IG9yZGVyIHwgbGltaXRUbyA6IGxpbWl0IGFzIHJlc3VsdHNgIC5cblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICogVGhpcyBleGFtcGxlIHVzZXMgYG5nUmVwZWF0YCB0byBkaXNwbGF5IGEgbGlzdCBvZiBwZW9wbGUuIEEgZmlsdGVyIGlzIHVzZWQgdG8gcmVzdHJpY3QgdGhlIGRpc3BsYXllZFxuXHQgKiByZXN1bHRzIGJ5IG5hbWUuIE5ldyAoZW50ZXJpbmcpIGFuZCByZW1vdmVkIChsZWF2aW5nKSBpdGVtcyBhcmUgYW5pbWF0ZWQuXG5cdCAgPGV4YW1wbGUgbW9kdWxlPVwibmdSZXBlYXRcIiBuYW1lPVwibmdSZXBlYXRcIiBkZXBzPVwiYW5ndWxhci1hbmltYXRlLmpzXCIgYW5pbWF0aW9ucz1cInRydWVcIj5cblx0ICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cInJlcGVhdENvbnRyb2xsZXJcIj5cblx0ICAgICAgICBJIGhhdmUge3tmcmllbmRzLmxlbmd0aH19IGZyaWVuZHMuIFRoZXkgYXJlOlxuXHQgICAgICAgIDxpbnB1dCB0eXBlPVwic2VhcmNoXCIgbmctbW9kZWw9XCJxXCIgcGxhY2Vob2xkZXI9XCJmaWx0ZXIgZnJpZW5kcy4uLlwiIGFyaWEtbGFiZWw9XCJmaWx0ZXIgZnJpZW5kc1wiIC8+XG5cdCAgICAgICAgPHVsIGNsYXNzPVwiZXhhbXBsZS1hbmltYXRlLWNvbnRhaW5lclwiPlxuXHQgICAgICAgICAgPGxpIGNsYXNzPVwiYW5pbWF0ZS1yZXBlYXRcIiBuZy1yZXBlYXQ9XCJmcmllbmQgaW4gZnJpZW5kcyB8IGZpbHRlcjpxIGFzIHJlc3VsdHNcIj5cblx0ICAgICAgICAgICAgW3t7JGluZGV4ICsgMX19XSB7e2ZyaWVuZC5uYW1lfX0gd2hvIGlzIHt7ZnJpZW5kLmFnZX19IHllYXJzIG9sZC5cblx0ICAgICAgICAgIDwvbGk+XG5cdCAgICAgICAgICA8bGkgY2xhc3M9XCJhbmltYXRlLXJlcGVhdFwiIG5nLWlmPVwicmVzdWx0cy5sZW5ndGggPT0gMFwiPlxuXHQgICAgICAgICAgICA8c3Ryb25nPk5vIHJlc3VsdHMgZm91bmQuLi48L3N0cm9uZz5cblx0ICAgICAgICAgIDwvbGk+XG5cdCAgICAgICAgPC91bD5cblx0ICAgICAgPC9kaXY+XG5cdCAgICA8L2ZpbGU+XG5cdCAgICA8ZmlsZSBuYW1lPVwic2NyaXB0LmpzXCI+XG5cdCAgICAgIGFuZ3VsYXIubW9kdWxlKCduZ1JlcGVhdCcsIFsnbmdBbmltYXRlJ10pLmNvbnRyb2xsZXIoJ3JlcGVhdENvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICAgICAgICAkc2NvcGUuZnJpZW5kcyA9IFtcblx0ICAgICAgICAgIHtuYW1lOidKb2huJywgYWdlOjI1LCBnZW5kZXI6J2JveSd9LFxuXHQgICAgICAgICAge25hbWU6J0plc3NpZScsIGFnZTozMCwgZ2VuZGVyOidnaXJsJ30sXG5cdCAgICAgICAgICB7bmFtZTonSm9oYW5uYScsIGFnZToyOCwgZ2VuZGVyOidnaXJsJ30sXG5cdCAgICAgICAgICB7bmFtZTonSm95JywgYWdlOjE1LCBnZW5kZXI6J2dpcmwnfSxcblx0ICAgICAgICAgIHtuYW1lOidNYXJ5JywgYWdlOjI4LCBnZW5kZXI6J2dpcmwnfSxcblx0ICAgICAgICAgIHtuYW1lOidQZXRlcicsIGFnZTo5NSwgZ2VuZGVyOidib3knfSxcblx0ICAgICAgICAgIHtuYW1lOidTZWJhc3RpYW4nLCBhZ2U6NTAsIGdlbmRlcjonYm95J30sXG5cdCAgICAgICAgICB7bmFtZTonRXJpa2EnLCBhZ2U6MjcsIGdlbmRlcjonZ2lybCd9LFxuXHQgICAgICAgICAge25hbWU6J1BhdHJpY2snLCBhZ2U6NDAsIGdlbmRlcjonYm95J30sXG5cdCAgICAgICAgICB7bmFtZTonU2FtYW50aGEnLCBhZ2U6NjAsIGdlbmRlcjonZ2lybCd9XG5cdCAgICAgICAgXTtcblx0ICAgICAgfSk7XG5cdCAgICA8L2ZpbGU+XG5cdCAgICA8ZmlsZSBuYW1lPVwiYW5pbWF0aW9ucy5jc3NcIj5cblx0ICAgICAgLmV4YW1wbGUtYW5pbWF0ZS1jb250YWluZXIge1xuXHQgICAgICAgIGJhY2tncm91bmQ6d2hpdGU7XG5cdCAgICAgICAgYm9yZGVyOjFweCBzb2xpZCBibGFjaztcblx0ICAgICAgICBsaXN0LXN0eWxlOm5vbmU7XG5cdCAgICAgICAgbWFyZ2luOjA7XG5cdCAgICAgICAgcGFkZGluZzowIDEwcHg7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC5hbmltYXRlLXJlcGVhdCB7XG5cdCAgICAgICAgbGluZS1oZWlnaHQ6MzBweDtcblx0ICAgICAgICBsaXN0LXN0eWxlOm5vbmU7XG5cdCAgICAgICAgYm94LXNpemluZzpib3JkZXItYm94O1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAuYW5pbWF0ZS1yZXBlYXQubmctbW92ZSxcblx0ICAgICAgLmFuaW1hdGUtcmVwZWF0Lm5nLWVudGVyLFxuXHQgICAgICAuYW5pbWF0ZS1yZXBlYXQubmctbGVhdmUge1xuXHQgICAgICAgIHRyYW5zaXRpb246YWxsIGxpbmVhciAwLjVzO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAuYW5pbWF0ZS1yZXBlYXQubmctbGVhdmUubmctbGVhdmUtYWN0aXZlLFxuXHQgICAgICAuYW5pbWF0ZS1yZXBlYXQubmctbW92ZSxcblx0ICAgICAgLmFuaW1hdGUtcmVwZWF0Lm5nLWVudGVyIHtcblx0ICAgICAgICBvcGFjaXR5OjA7XG5cdCAgICAgICAgbWF4LWhlaWdodDowO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAuYW5pbWF0ZS1yZXBlYXQubmctbGVhdmUsXG5cdCAgICAgIC5hbmltYXRlLXJlcGVhdC5uZy1tb3ZlLm5nLW1vdmUtYWN0aXZlLFxuXHQgICAgICAuYW5pbWF0ZS1yZXBlYXQubmctZW50ZXIubmctZW50ZXItYWN0aXZlIHtcblx0ICAgICAgICBvcGFjaXR5OjE7XG5cdCAgICAgICAgbWF4LWhlaWdodDozMHB4O1xuXHQgICAgICB9XG5cdCAgICA8L2ZpbGU+XG5cdCAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgIHZhciBmcmllbmRzID0gZWxlbWVudC5hbGwoYnkucmVwZWF0ZXIoJ2ZyaWVuZCBpbiBmcmllbmRzJykpO1xuXHRcblx0ICAgICAgaXQoJ3Nob3VsZCByZW5kZXIgaW5pdGlhbCBkYXRhIHNldCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGV4cGVjdChmcmllbmRzLmNvdW50KCkpLnRvQmUoMTApO1xuXHQgICAgICAgIGV4cGVjdChmcmllbmRzLmdldCgwKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ1sxXSBKb2huIHdobyBpcyAyNSB5ZWFycyBvbGQuJyk7XG5cdCAgICAgICAgZXhwZWN0KGZyaWVuZHMuZ2V0KDEpLmdldFRleHQoKSkudG9FcXVhbCgnWzJdIEplc3NpZSB3aG8gaXMgMzAgeWVhcnMgb2xkLicpO1xuXHQgICAgICAgIGV4cGVjdChmcmllbmRzLmxhc3QoKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ1sxMF0gU2FtYW50aGEgd2hvIGlzIDYwIHllYXJzIG9sZC4nKTtcblx0ICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKCdmcmllbmRzLmxlbmd0aCcpKS5nZXRUZXh0KCkpXG5cdCAgICAgICAgICAgIC50b01hdGNoKFwiSSBoYXZlIDEwIGZyaWVuZHMuIFRoZXkgYXJlOlwiKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICAgaXQoJ3Nob3VsZCB1cGRhdGUgcmVwZWF0ZXIgd2hlbiBmaWx0ZXIgcHJlZGljYXRlIGNoYW5nZXMnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgZXhwZWN0KGZyaWVuZHMuY291bnQoKSkudG9CZSgxMCk7XG5cdFxuXHQgICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCdxJykpLnNlbmRLZXlzKCdtYScpO1xuXHRcblx0ICAgICAgICAgZXhwZWN0KGZyaWVuZHMuY291bnQoKSkudG9CZSgyKTtcblx0ICAgICAgICAgZXhwZWN0KGZyaWVuZHMuZ2V0KDApLmdldFRleHQoKSkudG9FcXVhbCgnWzFdIE1hcnkgd2hvIGlzIDI4IHllYXJzIG9sZC4nKTtcblx0ICAgICAgICAgZXhwZWN0KGZyaWVuZHMubGFzdCgpLmdldFRleHQoKSkudG9FcXVhbCgnWzJdIFNhbWFudGhhIHdobyBpcyA2MCB5ZWFycyBvbGQuJyk7XG5cdCAgICAgICB9KTtcblx0ICAgICAgPC9maWxlPlxuXHQgICAgPC9leGFtcGxlPlxuXHQgKi9cblx0dmFyIG5nUmVwZWF0RGlyZWN0aXZlID0gWyckcGFyc2UnLCAnJGFuaW1hdGUnLCBmdW5jdGlvbigkcGFyc2UsICRhbmltYXRlKSB7XG5cdCAgdmFyIE5HX1JFTU9WRUQgPSAnJCROR19SRU1PVkVEJztcblx0ICB2YXIgbmdSZXBlYXRNaW5FcnIgPSBtaW5FcnIoJ25nUmVwZWF0Jyk7XG5cdFxuXHQgIHZhciB1cGRhdGVTY29wZSA9IGZ1bmN0aW9uKHNjb3BlLCBpbmRleCwgdmFsdWVJZGVudGlmaWVyLCB2YWx1ZSwga2V5SWRlbnRpZmllciwga2V5LCBhcnJheUxlbmd0aCkge1xuXHQgICAgLy8gVE9ETyhwZXJmKTogZ2VuZXJhdGUgc2V0dGVycyB0byBzaGF2ZSBvZmYgfjQwbXMgb3IgMS0xLjUlXG5cdCAgICBzY29wZVt2YWx1ZUlkZW50aWZpZXJdID0gdmFsdWU7XG5cdCAgICBpZiAoa2V5SWRlbnRpZmllcikgc2NvcGVba2V5SWRlbnRpZmllcl0gPSBrZXk7XG5cdCAgICBzY29wZS4kaW5kZXggPSBpbmRleDtcblx0ICAgIHNjb3BlLiRmaXJzdCA9IChpbmRleCA9PT0gMCk7XG5cdCAgICBzY29wZS4kbGFzdCA9IChpbmRleCA9PT0gKGFycmF5TGVuZ3RoIC0gMSkpO1xuXHQgICAgc2NvcGUuJG1pZGRsZSA9ICEoc2NvcGUuJGZpcnN0IHx8IHNjb3BlLiRsYXN0KTtcblx0ICAgIC8vIGpzaGludCBiaXR3aXNlOiBmYWxzZVxuXHQgICAgc2NvcGUuJG9kZCA9ICEoc2NvcGUuJGV2ZW4gPSAoaW5kZXgmMSkgPT09IDApO1xuXHQgICAgLy8ganNoaW50IGJpdHdpc2U6IHRydWVcblx0ICB9O1xuXHRcblx0ICB2YXIgZ2V0QmxvY2tTdGFydCA9IGZ1bmN0aW9uKGJsb2NrKSB7XG5cdCAgICByZXR1cm4gYmxvY2suY2xvbmVbMF07XG5cdCAgfTtcblx0XG5cdCAgdmFyIGdldEJsb2NrRW5kID0gZnVuY3Rpb24oYmxvY2spIHtcblx0ICAgIHJldHVybiBibG9jay5jbG9uZVtibG9jay5jbG9uZS5sZW5ndGggLSAxXTtcblx0ICB9O1xuXHRcblx0XG5cdCAgcmV0dXJuIHtcblx0ICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICBtdWx0aUVsZW1lbnQ6IHRydWUsXG5cdCAgICB0cmFuc2NsdWRlOiAnZWxlbWVudCcsXG5cdCAgICBwcmlvcml0eTogMTAwMCxcblx0ICAgIHRlcm1pbmFsOiB0cnVlLFxuXHQgICAgJCR0bGI6IHRydWUsXG5cdCAgICBjb21waWxlOiBmdW5jdGlvbiBuZ1JlcGVhdENvbXBpbGUoJGVsZW1lbnQsICRhdHRyKSB7XG5cdCAgICAgIHZhciBleHByZXNzaW9uID0gJGF0dHIubmdSZXBlYXQ7XG5cdCAgICAgIHZhciBuZ1JlcGVhdEVuZENvbW1lbnQgPSBkb2N1bWVudC5jcmVhdGVDb21tZW50KCcgZW5kIG5nUmVwZWF0OiAnICsgZXhwcmVzc2lvbiArICcgJyk7XG5cdFxuXHQgICAgICB2YXIgbWF0Y2ggPSBleHByZXNzaW9uLm1hdGNoKC9eXFxzKihbXFxzXFxTXSs/KVxccytpblxccysoW1xcc1xcU10rPykoPzpcXHMrYXNcXHMrKFtcXHNcXFNdKz8pKT8oPzpcXHMrdHJhY2tcXHMrYnlcXHMrKFtcXHNcXFNdKz8pKT9cXHMqJC8pO1xuXHRcblx0ICAgICAgaWYgKCFtYXRjaCkge1xuXHQgICAgICAgIHRocm93IG5nUmVwZWF0TWluRXJyKCdpZXhwJywgXCJFeHBlY3RlZCBleHByZXNzaW9uIGluIGZvcm0gb2YgJ19pdGVtXyBpbiBfY29sbGVjdGlvbl9bIHRyYWNrIGJ5IF9pZF9dJyBidXQgZ290ICd7MH0nLlwiLFxuXHQgICAgICAgICAgICBleHByZXNzaW9uKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgdmFyIGxocyA9IG1hdGNoWzFdO1xuXHQgICAgICB2YXIgcmhzID0gbWF0Y2hbMl07XG5cdCAgICAgIHZhciBhbGlhc0FzID0gbWF0Y2hbM107XG5cdCAgICAgIHZhciB0cmFja0J5RXhwID0gbWF0Y2hbNF07XG5cdFxuXHQgICAgICBtYXRjaCA9IGxocy5tYXRjaCgvXig/OihcXHMqW1xcJFxcd10rKXxcXChcXHMqKFtcXCRcXHddKylcXHMqLFxccyooW1xcJFxcd10rKVxccypcXCkpJC8pO1xuXHRcblx0ICAgICAgaWYgKCFtYXRjaCkge1xuXHQgICAgICAgIHRocm93IG5nUmVwZWF0TWluRXJyKCdpaWRleHAnLCBcIidfaXRlbV8nIGluICdfaXRlbV8gaW4gX2NvbGxlY3Rpb25fJyBzaG91bGQgYmUgYW4gaWRlbnRpZmllciBvciAnKF9rZXlfLCBfdmFsdWVfKScgZXhwcmVzc2lvbiwgYnV0IGdvdCAnezB9Jy5cIixcblx0ICAgICAgICAgICAgbGhzKTtcblx0ICAgICAgfVxuXHQgICAgICB2YXIgdmFsdWVJZGVudGlmaWVyID0gbWF0Y2hbM10gfHwgbWF0Y2hbMV07XG5cdCAgICAgIHZhciBrZXlJZGVudGlmaWVyID0gbWF0Y2hbMl07XG5cdFxuXHQgICAgICBpZiAoYWxpYXNBcyAmJiAoIS9eWyRhLXpBLVpfXVskYS16QS1aMC05X10qJC8udGVzdChhbGlhc0FzKSB8fFxuXHQgICAgICAgICAgL14obnVsbHx1bmRlZmluZWR8dGhpc3xcXCRpbmRleHxcXCRmaXJzdHxcXCRtaWRkbGV8XFwkbGFzdHxcXCRldmVufFxcJG9kZHxcXCRwYXJlbnR8XFwkcm9vdHxcXCRpZCkkLy50ZXN0KGFsaWFzQXMpKSkge1xuXHQgICAgICAgIHRocm93IG5nUmVwZWF0TWluRXJyKCdiYWRpZGVudCcsIFwiYWxpYXMgJ3swfScgaXMgaW52YWxpZCAtLS0gbXVzdCBiZSBhIHZhbGlkIEpTIGlkZW50aWZpZXIgd2hpY2ggaXMgbm90IGEgcmVzZXJ2ZWQgbmFtZS5cIixcblx0ICAgICAgICAgIGFsaWFzQXMpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICB2YXIgdHJhY2tCeUV4cEdldHRlciwgdHJhY2tCeUlkRXhwRm4sIHRyYWNrQnlJZEFycmF5Rm4sIHRyYWNrQnlJZE9iakZuO1xuXHQgICAgICB2YXIgaGFzaEZuTG9jYWxzID0geyRpZDogaGFzaEtleX07XG5cdFxuXHQgICAgICBpZiAodHJhY2tCeUV4cCkge1xuXHQgICAgICAgIHRyYWNrQnlFeHBHZXR0ZXIgPSAkcGFyc2UodHJhY2tCeUV4cCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdHJhY2tCeUlkQXJyYXlGbiA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcblx0ICAgICAgICAgIHJldHVybiBoYXNoS2V5KHZhbHVlKTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHRyYWNrQnlJZE9iakZuID0gZnVuY3Rpb24oa2V5KSB7XG5cdCAgICAgICAgICByZXR1cm4ga2V5O1xuXHQgICAgICAgIH07XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiBuZ1JlcGVhdExpbmsoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHIsIGN0cmwsICR0cmFuc2NsdWRlKSB7XG5cdFxuXHQgICAgICAgIGlmICh0cmFja0J5RXhwR2V0dGVyKSB7XG5cdCAgICAgICAgICB0cmFja0J5SWRFeHBGbiA9IGZ1bmN0aW9uKGtleSwgdmFsdWUsIGluZGV4KSB7XG5cdCAgICAgICAgICAgIC8vIGFzc2lnbiBrZXksIHZhbHVlLCBhbmQgJGluZGV4IHRvIHRoZSBsb2NhbHMgc28gdGhhdCB0aGV5IGNhbiBiZSB1c2VkIGluIGhhc2ggZnVuY3Rpb25zXG5cdCAgICAgICAgICAgIGlmIChrZXlJZGVudGlmaWVyKSBoYXNoRm5Mb2NhbHNba2V5SWRlbnRpZmllcl0gPSBrZXk7XG5cdCAgICAgICAgICAgIGhhc2hGbkxvY2Fsc1t2YWx1ZUlkZW50aWZpZXJdID0gdmFsdWU7XG5cdCAgICAgICAgICAgIGhhc2hGbkxvY2Fscy4kaW5kZXggPSBpbmRleDtcblx0ICAgICAgICAgICAgcmV0dXJuIHRyYWNrQnlFeHBHZXR0ZXIoJHNjb3BlLCBoYXNoRm5Mb2NhbHMpO1xuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8vIFN0b3JlIGEgbGlzdCBvZiBlbGVtZW50cyBmcm9tIHByZXZpb3VzIHJ1bi4gVGhpcyBpcyBhIGhhc2ggd2hlcmUga2V5IGlzIHRoZSBpdGVtIGZyb20gdGhlXG5cdCAgICAgICAgLy8gaXRlcmF0b3IsIGFuZCB0aGUgdmFsdWUgaXMgb2JqZWN0cyB3aXRoIGZvbGxvd2luZyBwcm9wZXJ0aWVzLlxuXHQgICAgICAgIC8vICAgLSBzY29wZTogYm91bmQgc2NvcGVcblx0ICAgICAgICAvLyAgIC0gZWxlbWVudDogcHJldmlvdXMgZWxlbWVudC5cblx0ICAgICAgICAvLyAgIC0gaW5kZXg6IHBvc2l0aW9uXG5cdCAgICAgICAgLy9cblx0ICAgICAgICAvLyBXZSBhcmUgdXNpbmcgbm8tcHJvdG8gb2JqZWN0IHNvIHRoYXQgd2UgZG9uJ3QgbmVlZCB0byBndWFyZCBhZ2FpbnN0IGluaGVyaXRlZCBwcm9wcyB2aWFcblx0ICAgICAgICAvLyBoYXNPd25Qcm9wZXJ0eS5cblx0ICAgICAgICB2YXIgbGFzdEJsb2NrTWFwID0gY3JlYXRlTWFwKCk7XG5cdFxuXHQgICAgICAgIC8vd2F0Y2ggcHJvcHNcblx0ICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihyaHMsIGZ1bmN0aW9uIG5nUmVwZWF0QWN0aW9uKGNvbGxlY3Rpb24pIHtcblx0ICAgICAgICAgIHZhciBpbmRleCwgbGVuZ3RoLFxuXHQgICAgICAgICAgICAgIHByZXZpb3VzTm9kZSA9ICRlbGVtZW50WzBdLCAgICAgLy8gbm9kZSB0aGF0IGNsb25lZCBub2RlcyBzaG91bGQgYmUgaW5zZXJ0ZWQgYWZ0ZXJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemVkIHRvIHRoZSBjb21tZW50IG5vZGUgYW5jaG9yXG5cdCAgICAgICAgICAgICAgbmV4dE5vZGUsXG5cdCAgICAgICAgICAgICAgLy8gU2FtZSBhcyBsYXN0QmxvY2tNYXAgYnV0IGl0IGhhcyB0aGUgY3VycmVudCBzdGF0ZS4gSXQgd2lsbCBiZWNvbWUgdGhlXG5cdCAgICAgICAgICAgICAgLy8gbGFzdEJsb2NrTWFwIG9uIHRoZSBuZXh0IGl0ZXJhdGlvbi5cblx0ICAgICAgICAgICAgICBuZXh0QmxvY2tNYXAgPSBjcmVhdGVNYXAoKSxcblx0ICAgICAgICAgICAgICBjb2xsZWN0aW9uTGVuZ3RoLFxuXHQgICAgICAgICAgICAgIGtleSwgdmFsdWUsIC8vIGtleS92YWx1ZSBvZiBpdGVyYXRpb25cblx0ICAgICAgICAgICAgICB0cmFja0J5SWQsXG5cdCAgICAgICAgICAgICAgdHJhY2tCeUlkRm4sXG5cdCAgICAgICAgICAgICAgY29sbGVjdGlvbktleXMsXG5cdCAgICAgICAgICAgICAgYmxvY2ssICAgICAgIC8vIGxhc3Qgb2JqZWN0IGluZm9ybWF0aW9uIHtzY29wZSwgZWxlbWVudCwgaWR9XG5cdCAgICAgICAgICAgICAgbmV4dEJsb2NrT3JkZXIsXG5cdCAgICAgICAgICAgICAgZWxlbWVudHNUb1JlbW92ZTtcblx0XG5cdCAgICAgICAgICBpZiAoYWxpYXNBcykge1xuXHQgICAgICAgICAgICAkc2NvcGVbYWxpYXNBc10gPSBjb2xsZWN0aW9uO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIGlmIChpc0FycmF5TGlrZShjb2xsZWN0aW9uKSkge1xuXHQgICAgICAgICAgICBjb2xsZWN0aW9uS2V5cyA9IGNvbGxlY3Rpb247XG5cdCAgICAgICAgICAgIHRyYWNrQnlJZEZuID0gdHJhY2tCeUlkRXhwRm4gfHwgdHJhY2tCeUlkQXJyYXlGbjtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHRyYWNrQnlJZEZuID0gdHJhY2tCeUlkRXhwRm4gfHwgdHJhY2tCeUlkT2JqRm47XG5cdCAgICAgICAgICAgIC8vIGlmIG9iamVjdCwgZXh0cmFjdCBrZXlzLCBpbiBlbnVtZXJhdGlvbiBvcmRlciwgdW5zb3J0ZWRcblx0ICAgICAgICAgICAgY29sbGVjdGlvbktleXMgPSBbXTtcblx0ICAgICAgICAgICAgZm9yICh2YXIgaXRlbUtleSBpbiBjb2xsZWN0aW9uKSB7XG5cdCAgICAgICAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoY29sbGVjdGlvbiwgaXRlbUtleSkgJiYgaXRlbUtleS5jaGFyQXQoMCkgIT09ICckJykge1xuXHQgICAgICAgICAgICAgICAgY29sbGVjdGlvbktleXMucHVzaChpdGVtS2V5KTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICBjb2xsZWN0aW9uTGVuZ3RoID0gY29sbGVjdGlvbktleXMubGVuZ3RoO1xuXHQgICAgICAgICAgbmV4dEJsb2NrT3JkZXIgPSBuZXcgQXJyYXkoY29sbGVjdGlvbkxlbmd0aCk7XG5cdFxuXHQgICAgICAgICAgLy8gbG9jYXRlIGV4aXN0aW5nIGl0ZW1zXG5cdCAgICAgICAgICBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBjb2xsZWN0aW9uTGVuZ3RoOyBpbmRleCsrKSB7XG5cdCAgICAgICAgICAgIGtleSA9IChjb2xsZWN0aW9uID09PSBjb2xsZWN0aW9uS2V5cykgPyBpbmRleCA6IGNvbGxlY3Rpb25LZXlzW2luZGV4XTtcblx0ICAgICAgICAgICAgdmFsdWUgPSBjb2xsZWN0aW9uW2tleV07XG5cdCAgICAgICAgICAgIHRyYWNrQnlJZCA9IHRyYWNrQnlJZEZuKGtleSwgdmFsdWUsIGluZGV4KTtcblx0ICAgICAgICAgICAgaWYgKGxhc3RCbG9ja01hcFt0cmFja0J5SWRdKSB7XG5cdCAgICAgICAgICAgICAgLy8gZm91bmQgcHJldmlvdXNseSBzZWVuIGJsb2NrXG5cdCAgICAgICAgICAgICAgYmxvY2sgPSBsYXN0QmxvY2tNYXBbdHJhY2tCeUlkXTtcblx0ICAgICAgICAgICAgICBkZWxldGUgbGFzdEJsb2NrTWFwW3RyYWNrQnlJZF07XG5cdCAgICAgICAgICAgICAgbmV4dEJsb2NrTWFwW3RyYWNrQnlJZF0gPSBibG9jaztcblx0ICAgICAgICAgICAgICBuZXh0QmxvY2tPcmRlcltpbmRleF0gPSBibG9jaztcblx0ICAgICAgICAgICAgfSBlbHNlIGlmIChuZXh0QmxvY2tNYXBbdHJhY2tCeUlkXSkge1xuXHQgICAgICAgICAgICAgIC8vIGlmIGNvbGxpc2lvbiBkZXRlY3RlZC4gcmVzdG9yZSBsYXN0QmxvY2tNYXAgYW5kIHRocm93IGFuIGVycm9yXG5cdCAgICAgICAgICAgICAgZm9yRWFjaChuZXh0QmxvY2tPcmRlciwgZnVuY3Rpb24oYmxvY2spIHtcblx0ICAgICAgICAgICAgICAgIGlmIChibG9jayAmJiBibG9jay5zY29wZSkgbGFzdEJsb2NrTWFwW2Jsb2NrLmlkXSA9IGJsb2NrO1xuXHQgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgIHRocm93IG5nUmVwZWF0TWluRXJyKCdkdXBlcycsXG5cdCAgICAgICAgICAgICAgICAgIFwiRHVwbGljYXRlcyBpbiBhIHJlcGVhdGVyIGFyZSBub3QgYWxsb3dlZC4gVXNlICd0cmFjayBieScgZXhwcmVzc2lvbiB0byBzcGVjaWZ5IHVuaXF1ZSBrZXlzLiBSZXBlYXRlcjogezB9LCBEdXBsaWNhdGUga2V5OiB7MX0sIER1cGxpY2F0ZSB2YWx1ZTogezJ9XCIsXG5cdCAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb24sIHRyYWNrQnlJZCwgdmFsdWUpO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIC8vIG5ldyBuZXZlciBiZWZvcmUgc2VlbiBibG9ja1xuXHQgICAgICAgICAgICAgIG5leHRCbG9ja09yZGVyW2luZGV4XSA9IHtpZDogdHJhY2tCeUlkLCBzY29wZTogdW5kZWZpbmVkLCBjbG9uZTogdW5kZWZpbmVkfTtcblx0ICAgICAgICAgICAgICBuZXh0QmxvY2tNYXBbdHJhY2tCeUlkXSA9IHRydWU7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAvLyByZW1vdmUgbGVmdG92ZXIgaXRlbXNcblx0ICAgICAgICAgIGZvciAodmFyIGJsb2NrS2V5IGluIGxhc3RCbG9ja01hcCkge1xuXHQgICAgICAgICAgICBibG9jayA9IGxhc3RCbG9ja01hcFtibG9ja0tleV07XG5cdCAgICAgICAgICAgIGVsZW1lbnRzVG9SZW1vdmUgPSBnZXRCbG9ja05vZGVzKGJsb2NrLmNsb25lKTtcblx0ICAgICAgICAgICAgJGFuaW1hdGUubGVhdmUoZWxlbWVudHNUb1JlbW92ZSk7XG5cdCAgICAgICAgICAgIGlmIChlbGVtZW50c1RvUmVtb3ZlWzBdLnBhcmVudE5vZGUpIHtcblx0ICAgICAgICAgICAgICAvLyBpZiB0aGUgZWxlbWVudCB3YXMgbm90IHJlbW92ZWQgeWV0IGJlY2F1c2Ugb2YgcGVuZGluZyBhbmltYXRpb24sIG1hcmsgaXQgYXMgZGVsZXRlZFxuXHQgICAgICAgICAgICAgIC8vIHNvIHRoYXQgd2UgY2FuIGlnbm9yZSBpdCBsYXRlclxuXHQgICAgICAgICAgICAgIGZvciAoaW5kZXggPSAwLCBsZW5ndGggPSBlbGVtZW50c1RvUmVtb3ZlLmxlbmd0aDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcblx0ICAgICAgICAgICAgICAgIGVsZW1lbnRzVG9SZW1vdmVbaW5kZXhdW05HX1JFTU9WRURdID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgYmxvY2suc2NvcGUuJGRlc3Ryb3koKTtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAvLyB3ZSBhcmUgbm90IHVzaW5nIGZvckVhY2ggZm9yIHBlcmYgcmVhc29ucyAodHJ5aW5nIHRvIGF2b2lkICNjYWxsKVxuXHQgICAgICAgICAgZm9yIChpbmRleCA9IDA7IGluZGV4IDwgY29sbGVjdGlvbkxlbmd0aDsgaW5kZXgrKykge1xuXHQgICAgICAgICAgICBrZXkgPSAoY29sbGVjdGlvbiA9PT0gY29sbGVjdGlvbktleXMpID8gaW5kZXggOiBjb2xsZWN0aW9uS2V5c1tpbmRleF07XG5cdCAgICAgICAgICAgIHZhbHVlID0gY29sbGVjdGlvbltrZXldO1xuXHQgICAgICAgICAgICBibG9jayA9IG5leHRCbG9ja09yZGVyW2luZGV4XTtcblx0XG5cdCAgICAgICAgICAgIGlmIChibG9jay5zY29wZSkge1xuXHQgICAgICAgICAgICAgIC8vIGlmIHdlIGhhdmUgYWxyZWFkeSBzZWVuIHRoaXMgb2JqZWN0LCB0aGVuIHdlIG5lZWQgdG8gcmV1c2UgdGhlXG5cdCAgICAgICAgICAgICAgLy8gYXNzb2NpYXRlZCBzY29wZS9lbGVtZW50XG5cdFxuXHQgICAgICAgICAgICAgIG5leHROb2RlID0gcHJldmlvdXNOb2RlO1xuXHRcblx0ICAgICAgICAgICAgICAvLyBza2lwIG5vZGVzIHRoYXQgYXJlIGFscmVhZHkgcGVuZGluZyByZW1vdmFsIHZpYSBsZWF2ZSBhbmltYXRpb25cblx0ICAgICAgICAgICAgICBkbyB7XG5cdCAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IG5leHROb2RlLm5leHRTaWJsaW5nO1xuXHQgICAgICAgICAgICAgIH0gd2hpbGUgKG5leHROb2RlICYmIG5leHROb2RlW05HX1JFTU9WRURdKTtcblx0XG5cdCAgICAgICAgICAgICAgaWYgKGdldEJsb2NrU3RhcnQoYmxvY2spICE9IG5leHROb2RlKSB7XG5cdCAgICAgICAgICAgICAgICAvLyBleGlzdGluZyBpdGVtIHdoaWNoIGdvdCBtb3ZlZFxuXHQgICAgICAgICAgICAgICAgJGFuaW1hdGUubW92ZShnZXRCbG9ja05vZGVzKGJsb2NrLmNsb25lKSwgbnVsbCwganFMaXRlKHByZXZpb3VzTm9kZSkpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICBwcmV2aW91c05vZGUgPSBnZXRCbG9ja0VuZChibG9jayk7XG5cdCAgICAgICAgICAgICAgdXBkYXRlU2NvcGUoYmxvY2suc2NvcGUsIGluZGV4LCB2YWx1ZUlkZW50aWZpZXIsIHZhbHVlLCBrZXlJZGVudGlmaWVyLCBrZXksIGNvbGxlY3Rpb25MZW5ndGgpO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIC8vIG5ldyBpdGVtIHdoaWNoIHdlIGRvbid0IGtub3cgYWJvdXRcblx0ICAgICAgICAgICAgICAkdHJhbnNjbHVkZShmdW5jdGlvbiBuZ1JlcGVhdFRyYW5zY2x1ZGUoY2xvbmUsIHNjb3BlKSB7XG5cdCAgICAgICAgICAgICAgICBibG9jay5zY29wZSA9IHNjb3BlO1xuXHQgICAgICAgICAgICAgICAgLy8gaHR0cDovL2pzcGVyZi5jb20vY2xvbmUtdnMtY3JlYXRlY29tbWVudFxuXHQgICAgICAgICAgICAgICAgdmFyIGVuZE5vZGUgPSBuZ1JlcGVhdEVuZENvbW1lbnQuY2xvbmVOb2RlKGZhbHNlKTtcblx0ICAgICAgICAgICAgICAgIGNsb25lW2Nsb25lLmxlbmd0aCsrXSA9IGVuZE5vZGU7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gVE9ETyhwZXJmKTogc3VwcG9ydCBuYWtlZCBwcmV2aW91c05vZGUgaW4gYGVudGVyYCB0byBhdm9pZCBjcmVhdGlvbiBvZiBqcUxpdGUgd3JhcHBlcj9cblx0ICAgICAgICAgICAgICAgICRhbmltYXRlLmVudGVyKGNsb25lLCBudWxsLCBqcUxpdGUocHJldmlvdXNOb2RlKSk7XG5cdCAgICAgICAgICAgICAgICBwcmV2aW91c05vZGUgPSBlbmROb2RlO1xuXHQgICAgICAgICAgICAgICAgLy8gTm90ZTogV2Ugb25seSBuZWVkIHRoZSBmaXJzdC9sYXN0IG5vZGUgb2YgdGhlIGNsb25lZCBub2Rlcy5cblx0ICAgICAgICAgICAgICAgIC8vIEhvd2V2ZXIsIHdlIG5lZWQgdG8ga2VlcCB0aGUgcmVmZXJlbmNlIHRvIHRoZSBqcWxpdGUgd3JhcHBlciBhcyBpdCBtaWdodCBiZSBjaGFuZ2VkIGxhdGVyXG5cdCAgICAgICAgICAgICAgICAvLyBieSBhIGRpcmVjdGl2ZSB3aXRoIHRlbXBsYXRlVXJsIHdoZW4gaXRzIHRlbXBsYXRlIGFycml2ZXMuXG5cdCAgICAgICAgICAgICAgICBibG9jay5jbG9uZSA9IGNsb25lO1xuXHQgICAgICAgICAgICAgICAgbmV4dEJsb2NrTWFwW2Jsb2NrLmlkXSA9IGJsb2NrO1xuXHQgICAgICAgICAgICAgICAgdXBkYXRlU2NvcGUoYmxvY2suc2NvcGUsIGluZGV4LCB2YWx1ZUlkZW50aWZpZXIsIHZhbHVlLCBrZXlJZGVudGlmaWVyLCBrZXksIGNvbGxlY3Rpb25MZW5ndGgpO1xuXHQgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBsYXN0QmxvY2tNYXAgPSBuZXh0QmxvY2tNYXA7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfTtcblx0fV07XG5cdFxuXHR2YXIgTkdfSElERV9DTEFTUyA9ICduZy1oaWRlJztcblx0dmFyIE5HX0hJREVfSU5fUFJPR1JFU1NfQ0xBU1MgPSAnbmctaGlkZS1hbmltYXRlJztcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdTaG93XG5cdCAqIEBtdWx0aUVsZW1lbnRcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIFRoZSBgbmdTaG93YCBkaXJlY3RpdmUgc2hvd3Mgb3IgaGlkZXMgdGhlIGdpdmVuIEhUTUwgZWxlbWVudCBiYXNlZCBvbiB0aGUgZXhwcmVzc2lvblxuXHQgKiBwcm92aWRlZCB0byB0aGUgYG5nU2hvd2AgYXR0cmlidXRlLiBUaGUgZWxlbWVudCBpcyBzaG93biBvciBoaWRkZW4gYnkgcmVtb3Zpbmcgb3IgYWRkaW5nXG5cdCAqIHRoZSBgLm5nLWhpZGVgIENTUyBjbGFzcyBvbnRvIHRoZSBlbGVtZW50LiBUaGUgYC5uZy1oaWRlYCBDU1MgY2xhc3MgaXMgcHJlZGVmaW5lZFxuXHQgKiBpbiBBbmd1bGFySlMgYW5kIHNldHMgdGhlIGRpc3BsYXkgc3R5bGUgdG8gbm9uZSAodXNpbmcgYW4gIWltcG9ydGFudCBmbGFnKS5cblx0ICogRm9yIENTUCBtb2RlIHBsZWFzZSBhZGQgYGFuZ3VsYXItY3NwLmNzc2AgdG8geW91ciBodG1sIGZpbGUgKHNlZSB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nQ3NwIG5nQ3NwfSkuXG5cdCAqXG5cdCAqIGBgYGh0bWxcblx0ICogPCEtLSB3aGVuICRzY29wZS5teVZhbHVlIGlzIHRydXRoeSAoZWxlbWVudCBpcyB2aXNpYmxlKSAtLT5cblx0ICogPGRpdiBuZy1zaG93PVwibXlWYWx1ZVwiPjwvZGl2PlxuXHQgKlxuXHQgKiA8IS0tIHdoZW4gJHNjb3BlLm15VmFsdWUgaXMgZmFsc3kgKGVsZW1lbnQgaXMgaGlkZGVuKSAtLT5cblx0ICogPGRpdiBuZy1zaG93PVwibXlWYWx1ZVwiIGNsYXNzPVwibmctaGlkZVwiPjwvZGl2PlxuXHQgKiBgYGBcblx0ICpcblx0ICogV2hlbiB0aGUgYG5nU2hvd2AgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBmYWxzeSB2YWx1ZSB0aGVuIHRoZSBgLm5nLWhpZGVgIENTUyBjbGFzcyBpcyBhZGRlZCB0byB0aGUgY2xhc3Ncblx0ICogYXR0cmlidXRlIG9uIHRoZSBlbGVtZW50IGNhdXNpbmcgaXQgdG8gYmVjb21lIGhpZGRlbi4gV2hlbiB0cnV0aHksIHRoZSBgLm5nLWhpZGVgIENTUyBjbGFzcyBpcyByZW1vdmVkXG5cdCAqIGZyb20gdGhlIGVsZW1lbnQgY2F1c2luZyB0aGUgZWxlbWVudCBub3QgdG8gYXBwZWFyIGhpZGRlbi5cblx0ICpcblx0ICogIyMgV2h5IGlzICFpbXBvcnRhbnQgdXNlZD9cblx0ICpcblx0ICogWW91IG1heSBiZSB3b25kZXJpbmcgd2h5ICFpbXBvcnRhbnQgaXMgdXNlZCBmb3IgdGhlIGAubmctaGlkZWAgQ1NTIGNsYXNzLiBUaGlzIGlzIGJlY2F1c2UgdGhlIGAubmctaGlkZWAgc2VsZWN0b3Jcblx0ICogY2FuIGJlIGVhc2lseSBvdmVycmlkZGVuIGJ5IGhlYXZpZXIgc2VsZWN0b3JzLiBGb3IgZXhhbXBsZSwgc29tZXRoaW5nIGFzIHNpbXBsZVxuXHQgKiBhcyBjaGFuZ2luZyB0aGUgZGlzcGxheSBzdHlsZSBvbiBhIEhUTUwgbGlzdCBpdGVtIHdvdWxkIG1ha2UgaGlkZGVuIGVsZW1lbnRzIGFwcGVhciB2aXNpYmxlLlxuXHQgKiBUaGlzIGFsc28gYmVjb21lcyBhIGJpZ2dlciBpc3N1ZSB3aGVuIGRlYWxpbmcgd2l0aCBDU1MgZnJhbWV3b3Jrcy5cblx0ICpcblx0ICogQnkgdXNpbmcgIWltcG9ydGFudCwgdGhlIHNob3cgYW5kIGhpZGUgYmVoYXZpb3Igd2lsbCB3b3JrIGFzIGV4cGVjdGVkIGRlc3BpdGUgYW55IGNsYXNoIGJldHdlZW4gQ1NTIHNlbGVjdG9yXG5cdCAqIHNwZWNpZmljaXR5ICh3aGVuICFpbXBvcnRhbnQgaXNuJ3QgdXNlZCB3aXRoIGFueSBjb25mbGljdGluZyBzdHlsZXMpLiBJZiBhIGRldmVsb3BlciBjaG9vc2VzIHRvIG92ZXJyaWRlIHRoZVxuXHQgKiBzdHlsaW5nIHRvIGNoYW5nZSBob3cgdG8gaGlkZSBhbiBlbGVtZW50IHRoZW4gaXQgaXMganVzdCBhIG1hdHRlciBvZiB1c2luZyAhaW1wb3J0YW50IGluIHRoZWlyIG93biBDU1MgY29kZS5cblx0ICpcblx0ICogIyMjIE92ZXJyaWRpbmcgYC5uZy1oaWRlYFxuXHQgKlxuXHQgKiBCeSBkZWZhdWx0LCB0aGUgYC5uZy1oaWRlYCBjbGFzcyB3aWxsIHN0eWxlIHRoZSBlbGVtZW50IHdpdGggYGRpc3BsYXk6IG5vbmUhaW1wb3J0YW50YC4gSWYgeW91IHdpc2ggdG8gY2hhbmdlXG5cdCAqIHRoZSBoaWRlIGJlaGF2aW9yIHdpdGggbmdTaG93L25nSGlkZSB0aGVuIHRoaXMgY2FuIGJlIGFjaGlldmVkIGJ5IHJlc3RhdGluZyB0aGUgc3R5bGVzIGZvciB0aGUgYC5uZy1oaWRlYFxuXHQgKiBjbGFzcyBDU1MuIE5vdGUgdGhhdCB0aGUgc2VsZWN0b3IgdGhhdCBuZWVkcyB0byBiZSB1c2VkIGlzIGFjdHVhbGx5IGAubmctaGlkZTpub3QoLm5nLWhpZGUtYW5pbWF0ZSlgIHRvIGNvcGVcblx0ICogd2l0aCBleHRyYSBhbmltYXRpb24gY2xhc3NlcyB0aGF0IGNhbiBiZSBhZGRlZC5cblx0ICpcblx0ICogYGBgY3NzXG5cdCAqIC5uZy1oaWRlOm5vdCgubmctaGlkZS1hbmltYXRlKSB7XG5cdCAqICAgLyYjNDI7IHRoaXMgaXMganVzdCBhbm90aGVyIGZvcm0gb2YgaGlkaW5nIGFuIGVsZW1lbnQgJiM0MjsvXG5cdCAqICAgZGlzcGxheTogYmxvY2shaW1wb3J0YW50O1xuXHQgKiAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0ICogICB0b3A6IC05OTk5cHg7XG5cdCAqICAgbGVmdDogLTk5OTlweDtcblx0ICogfVxuXHQgKiBgYGBcblx0ICpcblx0ICogQnkgZGVmYXVsdCB5b3UgZG9uJ3QgbmVlZCB0byBvdmVycmlkZSBpbiBDU1MgYW55dGhpbmcgYW5kIHRoZSBhbmltYXRpb25zIHdpbGwgd29yayBhcm91bmQgdGhlIGRpc3BsYXkgc3R5bGUuXG5cdCAqXG5cdCAqICMjIEEgbm90ZSBhYm91dCBhbmltYXRpb25zIHdpdGggYG5nU2hvd2Bcblx0ICpcblx0ICogQW5pbWF0aW9ucyBpbiBuZ1Nob3cvbmdIaWRlIHdvcmsgd2l0aCB0aGUgc2hvdyBhbmQgaGlkZSBldmVudHMgdGhhdCBhcmUgdHJpZ2dlcmVkIHdoZW4gdGhlIGRpcmVjdGl2ZSBleHByZXNzaW9uXG5cdCAqIGlzIHRydWUgYW5kIGZhbHNlLiBUaGlzIHN5c3RlbSB3b3JrcyBsaWtlIHRoZSBhbmltYXRpb24gc3lzdGVtIHByZXNlbnQgd2l0aCBuZ0NsYXNzIGV4Y2VwdCB0aGF0XG5cdCAqIHlvdSBtdXN0IGFsc28gaW5jbHVkZSB0aGUgIWltcG9ydGFudCBmbGFnIHRvIG92ZXJyaWRlIHRoZSBkaXNwbGF5IHByb3BlcnR5XG5cdCAqIHNvIHRoYXQgeW91IGNhbiBwZXJmb3JtIGFuIGFuaW1hdGlvbiB3aGVuIHRoZSBlbGVtZW50IGlzIGhpZGRlbiBkdXJpbmcgdGhlIHRpbWUgb2YgdGhlIGFuaW1hdGlvbi5cblx0ICpcblx0ICogYGBgY3NzXG5cdCAqIC8vXG5cdCAqIC8vYSB3b3JraW5nIGV4YW1wbGUgY2FuIGJlIGZvdW5kIGF0IHRoZSBib3R0b20gb2YgdGhpcyBwYWdlXG5cdCAqIC8vXG5cdCAqIC5teS1lbGVtZW50Lm5nLWhpZGUtYWRkLCAubXktZWxlbWVudC5uZy1oaWRlLXJlbW92ZSB7XG5cdCAqICAgLyYjNDI7IHRoaXMgaXMgcmVxdWlyZWQgYXMgb2YgMS4zeCB0byBwcm9wZXJseVxuXHQgKiAgICAgIGFwcGx5IGFsbCBzdHlsaW5nIGluIGEgc2hvdy9oaWRlIGFuaW1hdGlvbiAmIzQyOy9cblx0ICogICB0cmFuc2l0aW9uOiAwcyBsaW5lYXIgYWxsO1xuXHQgKiB9XG5cdCAqXG5cdCAqIC5teS1lbGVtZW50Lm5nLWhpZGUtYWRkLWFjdGl2ZSxcblx0ICogLm15LWVsZW1lbnQubmctaGlkZS1yZW1vdmUtYWN0aXZlIHtcblx0ICogICAvJiM0MjsgdGhlIHRyYW5zaXRpb24gaXMgZGVmaW5lZCBpbiB0aGUgYWN0aXZlIGNsYXNzICYjNDI7L1xuXHQgKiAgIHRyYW5zaXRpb246IDFzIGxpbmVhciBhbGw7XG5cdCAqIH1cblx0ICpcblx0ICogLm15LWVsZW1lbnQubmctaGlkZS1hZGQgeyAuLi4gfVxuXHQgKiAubXktZWxlbWVudC5uZy1oaWRlLWFkZC5uZy1oaWRlLWFkZC1hY3RpdmUgeyAuLi4gfVxuXHQgKiAubXktZWxlbWVudC5uZy1oaWRlLXJlbW92ZSB7IC4uLiB9XG5cdCAqIC5teS1lbGVtZW50Lm5nLWhpZGUtcmVtb3ZlLm5nLWhpZGUtcmVtb3ZlLWFjdGl2ZSB7IC4uLiB9XG5cdCAqIGBgYFxuXHQgKlxuXHQgKiBLZWVwIGluIG1pbmQgdGhhdCwgYXMgb2YgQW5ndWxhckpTIHZlcnNpb24gMS4zLjAtYmV0YS4xMSwgdGhlcmUgaXMgbm8gbmVlZCB0byBjaGFuZ2UgdGhlIGRpc3BsYXlcblx0ICogcHJvcGVydHkgdG8gYmxvY2sgZHVyaW5nIGFuaW1hdGlvbiBzdGF0ZXMtLW5nQW5pbWF0ZSB3aWxsIGhhbmRsZSB0aGUgc3R5bGUgdG9nZ2xpbmcgYXV0b21hdGljYWxseSBmb3IgeW91LlxuXHQgKlxuXHQgKiBAYW5pbWF0aW9uc1xuXHQgKiBhZGRDbGFzczogYC5uZy1oaWRlYCAtIGhhcHBlbnMgYWZ0ZXIgdGhlIGBuZ1Nob3dgIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgdHJ1dGh5IHZhbHVlIGFuZCB0aGUganVzdCBiZWZvcmUgY29udGVudHMgYXJlIHNldCB0byB2aXNpYmxlXG5cdCAqIHJlbW92ZUNsYXNzOiBgLm5nLWhpZGVgIC0gaGFwcGVucyBhZnRlciB0aGUgYG5nU2hvd2AgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBub24gdHJ1dGh5IHZhbHVlIGFuZCBqdXN0IGJlZm9yZSB0aGUgY29udGVudHMgYXJlIHNldCB0byBoaWRkZW5cblx0ICpcblx0ICogQGVsZW1lbnQgQU5ZXG5cdCAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdTaG93IElmIHRoZSB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufSBpcyB0cnV0aHlcblx0ICogICAgIHRoZW4gdGhlIGVsZW1lbnQgaXMgc2hvd24gb3IgaGlkZGVuIHJlc3BlY3RpdmVseS5cblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICA8ZXhhbXBsZSBtb2R1bGU9XCJuZ0FuaW1hdGVcIiBkZXBzPVwiYW5ndWxhci1hbmltYXRlLmpzXCIgYW5pbWF0aW9ucz1cInRydWVcIj5cblx0ICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgIENsaWNrIG1lOiA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmctbW9kZWw9XCJjaGVja2VkXCIgYXJpYS1sYWJlbD1cIlRvZ2dsZSBuZ0hpZGVcIj48YnIvPlxuXHQgICAgICA8ZGl2PlxuXHQgICAgICAgIFNob3c6XG5cdCAgICAgICAgPGRpdiBjbGFzcz1cImNoZWNrLWVsZW1lbnQgYW5pbWF0ZS1zaG93XCIgbmctc2hvdz1cImNoZWNrZWRcIj5cblx0ICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi10aHVtYnMtdXBcIj48L3NwYW4+IEkgc2hvdyB1cCB3aGVuIHlvdXIgY2hlY2tib3ggaXMgY2hlY2tlZC5cblx0ICAgICAgICA8L2Rpdj5cblx0ICAgICAgPC9kaXY+XG5cdCAgICAgIDxkaXY+XG5cdCAgICAgICAgSGlkZTpcblx0ICAgICAgICA8ZGl2IGNsYXNzPVwiY2hlY2stZWxlbWVudCBhbmltYXRlLXNob3dcIiBuZy1oaWRlPVwiY2hlY2tlZFwiPlxuXHQgICAgICAgICAgPHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXRodW1icy1kb3duXCI+PC9zcGFuPiBJIGhpZGUgd2hlbiB5b3VyIGNoZWNrYm94IGlzIGNoZWNrZWQuXG5cdCAgICAgICAgPC9kaXY+XG5cdCAgICAgIDwvZGl2PlxuXHQgICAgPC9maWxlPlxuXHQgICAgPGZpbGUgbmFtZT1cImdseXBoaWNvbnMuY3NzXCI+XG5cdCAgICAgIEBpbXBvcnQgdXJsKC4uLy4uL2NvbXBvbmVudHMvYm9vdHN0cmFwLTMuMS4xL2Nzcy9ib290c3RyYXAuY3NzKTtcblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJhbmltYXRpb25zLmNzc1wiPlxuXHQgICAgICAuYW5pbWF0ZS1zaG93IHtcblx0ICAgICAgICBsaW5lLWhlaWdodDogMjBweDtcblx0ICAgICAgICBvcGFjaXR5OiAxO1xuXHQgICAgICAgIHBhZGRpbmc6IDEwcHg7XG5cdCAgICAgICAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XG5cdCAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC5hbmltYXRlLXNob3cubmctaGlkZS1hZGQsIC5hbmltYXRlLXNob3cubmctaGlkZS1yZW1vdmUge1xuXHQgICAgICAgIHRyYW5zaXRpb246IGFsbCBsaW5lYXIgMC41cztcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLmFuaW1hdGUtc2hvdy5uZy1oaWRlIHtcblx0ICAgICAgICBsaW5lLWhlaWdodDogMDtcblx0ICAgICAgICBvcGFjaXR5OiAwO1xuXHQgICAgICAgIHBhZGRpbmc6IDAgMTBweDtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLmNoZWNrLWVsZW1lbnQge1xuXHQgICAgICAgIHBhZGRpbmc6IDEwcHg7XG5cdCAgICAgICAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XG5cdCAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7XG5cdCAgICAgIH1cblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgdmFyIHRodW1ic1VwID0gZWxlbWVudChieS5jc3MoJ3NwYW4uZ2x5cGhpY29uLXRodW1icy11cCcpKTtcblx0ICAgICAgdmFyIHRodW1ic0Rvd24gPSBlbGVtZW50KGJ5LmNzcygnc3Bhbi5nbHlwaGljb24tdGh1bWJzLWRvd24nKSk7XG5cdFxuXHQgICAgICBpdCgnc2hvdWxkIGNoZWNrIG5nLXNob3cgLyBuZy1oaWRlJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgZXhwZWN0KHRodW1ic1VwLmlzRGlzcGxheWVkKCkpLnRvQmVGYWxzeSgpO1xuXHQgICAgICAgIGV4cGVjdCh0aHVtYnNEb3duLmlzRGlzcGxheWVkKCkpLnRvQmVUcnV0aHkoKTtcblx0XG5cdCAgICAgICAgZWxlbWVudChieS5tb2RlbCgnY2hlY2tlZCcpKS5jbGljaygpO1xuXHRcblx0ICAgICAgICBleHBlY3QodGh1bWJzVXAuaXNEaXNwbGF5ZWQoKSkudG9CZVRydXRoeSgpO1xuXHQgICAgICAgIGV4cGVjdCh0aHVtYnNEb3duLmlzRGlzcGxheWVkKCkpLnRvQmVGYWxzeSgpO1xuXHQgICAgICB9KTtcblx0ICAgIDwvZmlsZT5cblx0ICA8L2V4YW1wbGU+XG5cdCAqL1xuXHR2YXIgbmdTaG93RGlyZWN0aXZlID0gWyckYW5pbWF0ZScsIGZ1bmN0aW9uKCRhbmltYXRlKSB7XG5cdCAgcmV0dXJuIHtcblx0ICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICBtdWx0aUVsZW1lbnQ6IHRydWUsXG5cdCAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cikge1xuXHQgICAgICBzY29wZS4kd2F0Y2goYXR0ci5uZ1Nob3csIGZ1bmN0aW9uIG5nU2hvd1dhdGNoQWN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgLy8gd2UncmUgYWRkaW5nIGEgdGVtcG9yYXJ5LCBhbmltYXRpb24tc3BlY2lmaWMgY2xhc3MgZm9yIG5nLWhpZGUgc2luY2UgdGhpcyB3YXlcblx0ICAgICAgICAvLyB3ZSBjYW4gY29udHJvbCB3aGVuIHRoZSBlbGVtZW50IGlzIGFjdHVhbGx5IGRpc3BsYXllZCBvbiBzY3JlZW4gd2l0aG91dCBoYXZpbmdcblx0ICAgICAgICAvLyB0byBoYXZlIGEgZ2xvYmFsL2dyZWVkeSBDU1Mgc2VsZWN0b3IgdGhhdCBicmVha3Mgd2hlbiBvdGhlciBhbmltYXRpb25zIGFyZSBydW4uXG5cdCAgICAgICAgLy8gUmVhZDogaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy9pc3N1ZXMvOTEwMyNpc3N1ZWNvbW1lbnQtNTgzMzU4NDVcblx0ICAgICAgICAkYW5pbWF0ZVt2YWx1ZSA/ICdyZW1vdmVDbGFzcycgOiAnYWRkQ2xhc3MnXShlbGVtZW50LCBOR19ISURFX0NMQVNTLCB7XG5cdCAgICAgICAgICB0ZW1wQ2xhc3NlczogTkdfSElERV9JTl9QUk9HUkVTU19DTEFTU1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9O1xuXHR9XTtcblx0XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ0hpZGVcblx0ICogQG11bHRpRWxlbWVudFxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogVGhlIGBuZ0hpZGVgIGRpcmVjdGl2ZSBzaG93cyBvciBoaWRlcyB0aGUgZ2l2ZW4gSFRNTCBlbGVtZW50IGJhc2VkIG9uIHRoZSBleHByZXNzaW9uXG5cdCAqIHByb3ZpZGVkIHRvIHRoZSBgbmdIaWRlYCBhdHRyaWJ1dGUuIFRoZSBlbGVtZW50IGlzIHNob3duIG9yIGhpZGRlbiBieSByZW1vdmluZyBvciBhZGRpbmdcblx0ICogdGhlIGBuZy1oaWRlYCBDU1MgY2xhc3Mgb250byB0aGUgZWxlbWVudC4gVGhlIGAubmctaGlkZWAgQ1NTIGNsYXNzIGlzIHByZWRlZmluZWRcblx0ICogaW4gQW5ndWxhckpTIGFuZCBzZXRzIHRoZSBkaXNwbGF5IHN0eWxlIHRvIG5vbmUgKHVzaW5nIGFuICFpbXBvcnRhbnQgZmxhZykuXG5cdCAqIEZvciBDU1AgbW9kZSBwbGVhc2UgYWRkIGBhbmd1bGFyLWNzcC5jc3NgIHRvIHlvdXIgaHRtbCBmaWxlIChzZWUge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0NzcCBuZ0NzcH0pLlxuXHQgKlxuXHQgKiBgYGBodG1sXG5cdCAqIDwhLS0gd2hlbiAkc2NvcGUubXlWYWx1ZSBpcyB0cnV0aHkgKGVsZW1lbnQgaXMgaGlkZGVuKSAtLT5cblx0ICogPGRpdiBuZy1oaWRlPVwibXlWYWx1ZVwiIGNsYXNzPVwibmctaGlkZVwiPjwvZGl2PlxuXHQgKlxuXHQgKiA8IS0tIHdoZW4gJHNjb3BlLm15VmFsdWUgaXMgZmFsc3kgKGVsZW1lbnQgaXMgdmlzaWJsZSkgLS0+XG5cdCAqIDxkaXYgbmctaGlkZT1cIm15VmFsdWVcIj48L2Rpdj5cblx0ICogYGBgXG5cdCAqXG5cdCAqIFdoZW4gdGhlIGBuZ0hpZGVgIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgdHJ1dGh5IHZhbHVlIHRoZW4gdGhlIGAubmctaGlkZWAgQ1NTIGNsYXNzIGlzIGFkZGVkIHRvIHRoZSBjbGFzc1xuXHQgKiBhdHRyaWJ1dGUgb24gdGhlIGVsZW1lbnQgY2F1c2luZyBpdCB0byBiZWNvbWUgaGlkZGVuLiBXaGVuIGZhbHN5LCB0aGUgYC5uZy1oaWRlYCBDU1MgY2xhc3MgaXMgcmVtb3ZlZFxuXHQgKiBmcm9tIHRoZSBlbGVtZW50IGNhdXNpbmcgdGhlIGVsZW1lbnQgbm90IHRvIGFwcGVhciBoaWRkZW4uXG5cdCAqXG5cdCAqICMjIFdoeSBpcyAhaW1wb3J0YW50IHVzZWQ/XG5cdCAqXG5cdCAqIFlvdSBtYXkgYmUgd29uZGVyaW5nIHdoeSAhaW1wb3J0YW50IGlzIHVzZWQgZm9yIHRoZSBgLm5nLWhpZGVgIENTUyBjbGFzcy4gVGhpcyBpcyBiZWNhdXNlIHRoZSBgLm5nLWhpZGVgIHNlbGVjdG9yXG5cdCAqIGNhbiBiZSBlYXNpbHkgb3ZlcnJpZGRlbiBieSBoZWF2aWVyIHNlbGVjdG9ycy4gRm9yIGV4YW1wbGUsIHNvbWV0aGluZyBhcyBzaW1wbGVcblx0ICogYXMgY2hhbmdpbmcgdGhlIGRpc3BsYXkgc3R5bGUgb24gYSBIVE1MIGxpc3QgaXRlbSB3b3VsZCBtYWtlIGhpZGRlbiBlbGVtZW50cyBhcHBlYXIgdmlzaWJsZS5cblx0ICogVGhpcyBhbHNvIGJlY29tZXMgYSBiaWdnZXIgaXNzdWUgd2hlbiBkZWFsaW5nIHdpdGggQ1NTIGZyYW1ld29ya3MuXG5cdCAqXG5cdCAqIEJ5IHVzaW5nICFpbXBvcnRhbnQsIHRoZSBzaG93IGFuZCBoaWRlIGJlaGF2aW9yIHdpbGwgd29yayBhcyBleHBlY3RlZCBkZXNwaXRlIGFueSBjbGFzaCBiZXR3ZWVuIENTUyBzZWxlY3RvclxuXHQgKiBzcGVjaWZpY2l0eSAod2hlbiAhaW1wb3J0YW50IGlzbid0IHVzZWQgd2l0aCBhbnkgY29uZmxpY3Rpbmcgc3R5bGVzKS4gSWYgYSBkZXZlbG9wZXIgY2hvb3NlcyB0byBvdmVycmlkZSB0aGVcblx0ICogc3R5bGluZyB0byBjaGFuZ2UgaG93IHRvIGhpZGUgYW4gZWxlbWVudCB0aGVuIGl0IGlzIGp1c3QgYSBtYXR0ZXIgb2YgdXNpbmcgIWltcG9ydGFudCBpbiB0aGVpciBvd24gQ1NTIGNvZGUuXG5cdCAqXG5cdCAqICMjIyBPdmVycmlkaW5nIGAubmctaGlkZWBcblx0ICpcblx0ICogQnkgZGVmYXVsdCwgdGhlIGAubmctaGlkZWAgY2xhc3Mgd2lsbCBzdHlsZSB0aGUgZWxlbWVudCB3aXRoIGBkaXNwbGF5OiBub25lIWltcG9ydGFudGAuIElmIHlvdSB3aXNoIHRvIGNoYW5nZVxuXHQgKiB0aGUgaGlkZSBiZWhhdmlvciB3aXRoIG5nU2hvdy9uZ0hpZGUgdGhlbiB0aGlzIGNhbiBiZSBhY2hpZXZlZCBieSByZXN0YXRpbmcgdGhlIHN0eWxlcyBmb3IgdGhlIGAubmctaGlkZWBcblx0ICogY2xhc3MgaW4gQ1NTOlxuXHQgKlxuXHQgKiBgYGBjc3Ncblx0ICogLm5nLWhpZGUge1xuXHQgKiAgIC8mIzQyOyB0aGlzIGlzIGp1c3QgYW5vdGhlciBmb3JtIG9mIGhpZGluZyBhbiBlbGVtZW50ICYjNDI7L1xuXHQgKiAgIGRpc3BsYXk6IGJsb2NrIWltcG9ydGFudDtcblx0ICogICBwb3NpdGlvbjogYWJzb2x1dGU7XG5cdCAqICAgdG9wOiAtOTk5OXB4O1xuXHQgKiAgIGxlZnQ6IC05OTk5cHg7XG5cdCAqIH1cblx0ICogYGBgXG5cdCAqXG5cdCAqIEJ5IGRlZmF1bHQgeW91IGRvbid0IG5lZWQgdG8gb3ZlcnJpZGUgaW4gQ1NTIGFueXRoaW5nIGFuZCB0aGUgYW5pbWF0aW9ucyB3aWxsIHdvcmsgYXJvdW5kIHRoZSBkaXNwbGF5IHN0eWxlLlxuXHQgKlxuXHQgKiAjIyBBIG5vdGUgYWJvdXQgYW5pbWF0aW9ucyB3aXRoIGBuZ0hpZGVgXG5cdCAqXG5cdCAqIEFuaW1hdGlvbnMgaW4gbmdTaG93L25nSGlkZSB3b3JrIHdpdGggdGhlIHNob3cgYW5kIGhpZGUgZXZlbnRzIHRoYXQgYXJlIHRyaWdnZXJlZCB3aGVuIHRoZSBkaXJlY3RpdmUgZXhwcmVzc2lvblxuXHQgKiBpcyB0cnVlIGFuZCBmYWxzZS4gVGhpcyBzeXN0ZW0gd29ya3MgbGlrZSB0aGUgYW5pbWF0aW9uIHN5c3RlbSBwcmVzZW50IHdpdGggbmdDbGFzcywgZXhjZXB0IHRoYXQgdGhlIGAubmctaGlkZWBcblx0ICogQ1NTIGNsYXNzIGlzIGFkZGVkIGFuZCByZW1vdmVkIGZvciB5b3UgaW5zdGVhZCBvZiB5b3VyIG93biBDU1MgY2xhc3MuXG5cdCAqXG5cdCAqIGBgYGNzc1xuXHQgKiAvL1xuXHQgKiAvL2Egd29ya2luZyBleGFtcGxlIGNhbiBiZSBmb3VuZCBhdCB0aGUgYm90dG9tIG9mIHRoaXMgcGFnZVxuXHQgKiAvL1xuXHQgKiAubXktZWxlbWVudC5uZy1oaWRlLWFkZCwgLm15LWVsZW1lbnQubmctaGlkZS1yZW1vdmUge1xuXHQgKiAgIHRyYW5zaXRpb246IDAuNXMgbGluZWFyIGFsbDtcblx0ICogfVxuXHQgKlxuXHQgKiAubXktZWxlbWVudC5uZy1oaWRlLWFkZCB7IC4uLiB9XG5cdCAqIC5teS1lbGVtZW50Lm5nLWhpZGUtYWRkLm5nLWhpZGUtYWRkLWFjdGl2ZSB7IC4uLiB9XG5cdCAqIC5teS1lbGVtZW50Lm5nLWhpZGUtcmVtb3ZlIHsgLi4uIH1cblx0ICogLm15LWVsZW1lbnQubmctaGlkZS1yZW1vdmUubmctaGlkZS1yZW1vdmUtYWN0aXZlIHsgLi4uIH1cblx0ICogYGBgXG5cdCAqXG5cdCAqIEtlZXAgaW4gbWluZCB0aGF0LCBhcyBvZiBBbmd1bGFySlMgdmVyc2lvbiAxLjMuMC1iZXRhLjExLCB0aGVyZSBpcyBubyBuZWVkIHRvIGNoYW5nZSB0aGUgZGlzcGxheVxuXHQgKiBwcm9wZXJ0eSB0byBibG9jayBkdXJpbmcgYW5pbWF0aW9uIHN0YXRlcy0tbmdBbmltYXRlIHdpbGwgaGFuZGxlIHRoZSBzdHlsZSB0b2dnbGluZyBhdXRvbWF0aWNhbGx5IGZvciB5b3UuXG5cdCAqXG5cdCAqIEBhbmltYXRpb25zXG5cdCAqIHJlbW92ZUNsYXNzOiBgLm5nLWhpZGVgIC0gaGFwcGVucyBhZnRlciB0aGUgYG5nSGlkZWAgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSB0cnV0aHkgdmFsdWUgYW5kIGp1c3QgYmVmb3JlIHRoZSBjb250ZW50cyBhcmUgc2V0IHRvIGhpZGRlblxuXHQgKiBhZGRDbGFzczogYC5uZy1oaWRlYCAtIGhhcHBlbnMgYWZ0ZXIgdGhlIGBuZ0hpZGVgIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgbm9uIHRydXRoeSB2YWx1ZSBhbmQganVzdCBiZWZvcmUgdGhlIGNvbnRlbnRzIGFyZSBzZXQgdG8gdmlzaWJsZVxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0hpZGUgSWYgdGhlIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259IGlzIHRydXRoeSB0aGVuXG5cdCAqICAgICB0aGUgZWxlbWVudCBpcyBzaG93biBvciBoaWRkZW4gcmVzcGVjdGl2ZWx5LlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgIDxleGFtcGxlIG1vZHVsZT1cIm5nQW5pbWF0ZVwiIGRlcHM9XCJhbmd1bGFyLWFuaW1hdGUuanNcIiBhbmltYXRpb25zPVwidHJ1ZVwiPlxuXHQgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgQ2xpY2sgbWU6IDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cImNoZWNrZWRcIiBhcmlhLWxhYmVsPVwiVG9nZ2xlIG5nU2hvd1wiPjxici8+XG5cdCAgICAgIDxkaXY+XG5cdCAgICAgICAgU2hvdzpcblx0ICAgICAgICA8ZGl2IGNsYXNzPVwiY2hlY2stZWxlbWVudCBhbmltYXRlLWhpZGVcIiBuZy1zaG93PVwiY2hlY2tlZFwiPlxuXHQgICAgICAgICAgPHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXRodW1icy11cFwiPjwvc3Bhbj4gSSBzaG93IHVwIHdoZW4geW91ciBjaGVja2JveCBpcyBjaGVja2VkLlxuXHQgICAgICAgIDwvZGl2PlxuXHQgICAgICA8L2Rpdj5cblx0ICAgICAgPGRpdj5cblx0ICAgICAgICBIaWRlOlxuXHQgICAgICAgIDxkaXYgY2xhc3M9XCJjaGVjay1lbGVtZW50IGFuaW1hdGUtaGlkZVwiIG5nLWhpZGU9XCJjaGVja2VkXCI+XG5cdCAgICAgICAgICA8c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tdGh1bWJzLWRvd25cIj48L3NwYW4+IEkgaGlkZSB3aGVuIHlvdXIgY2hlY2tib3ggaXMgY2hlY2tlZC5cblx0ICAgICAgICA8L2Rpdj5cblx0ICAgICAgPC9kaXY+XG5cdCAgICA8L2ZpbGU+XG5cdCAgICA8ZmlsZSBuYW1lPVwiZ2x5cGhpY29ucy5jc3NcIj5cblx0ICAgICAgQGltcG9ydCB1cmwoLi4vLi4vY29tcG9uZW50cy9ib290c3RyYXAtMy4xLjEvY3NzL2Jvb3RzdHJhcC5jc3MpO1xuXHQgICAgPC9maWxlPlxuXHQgICAgPGZpbGUgbmFtZT1cImFuaW1hdGlvbnMuY3NzXCI+XG5cdCAgICAgIC5hbmltYXRlLWhpZGUge1xuXHQgICAgICAgIHRyYW5zaXRpb246IGFsbCBsaW5lYXIgMC41cztcblx0ICAgICAgICBsaW5lLWhlaWdodDogMjBweDtcblx0ICAgICAgICBvcGFjaXR5OiAxO1xuXHQgICAgICAgIHBhZGRpbmc6IDEwcHg7XG5cdCAgICAgICAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XG5cdCAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC5hbmltYXRlLWhpZGUubmctaGlkZSB7XG5cdCAgICAgICAgbGluZS1oZWlnaHQ6IDA7XG5cdCAgICAgICAgb3BhY2l0eTogMDtcblx0ICAgICAgICBwYWRkaW5nOiAwIDEwcHg7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC5jaGVjay1lbGVtZW50IHtcblx0ICAgICAgICBwYWRkaW5nOiAxMHB4O1xuXHQgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xuXHQgICAgICAgIGJhY2tncm91bmQ6IHdoaXRlO1xuXHQgICAgICB9XG5cdCAgICA8L2ZpbGU+XG5cdCAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgIHZhciB0aHVtYnNVcCA9IGVsZW1lbnQoYnkuY3NzKCdzcGFuLmdseXBoaWNvbi10aHVtYnMtdXAnKSk7XG5cdCAgICAgIHZhciB0aHVtYnNEb3duID0gZWxlbWVudChieS5jc3MoJ3NwYW4uZ2x5cGhpY29uLXRodW1icy1kb3duJykpO1xuXHRcblx0ICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1zaG93IC8gbmctaGlkZScsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGV4cGVjdCh0aHVtYnNVcC5pc0Rpc3BsYXllZCgpKS50b0JlRmFsc3koKTtcblx0ICAgICAgICBleHBlY3QodGh1bWJzRG93bi5pc0Rpc3BsYXllZCgpKS50b0JlVHJ1dGh5KCk7XG5cdFxuXHQgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ2NoZWNrZWQnKSkuY2xpY2soKTtcblx0XG5cdCAgICAgICAgZXhwZWN0KHRodW1ic1VwLmlzRGlzcGxheWVkKCkpLnRvQmVUcnV0aHkoKTtcblx0ICAgICAgICBleHBlY3QodGh1bWJzRG93bi5pc0Rpc3BsYXllZCgpKS50b0JlRmFsc3koKTtcblx0ICAgICAgfSk7XG5cdCAgICA8L2ZpbGU+XG5cdCAgPC9leGFtcGxlPlxuXHQgKi9cblx0dmFyIG5nSGlkZURpcmVjdGl2ZSA9IFsnJGFuaW1hdGUnLCBmdW5jdGlvbigkYW5pbWF0ZSkge1xuXHQgIHJldHVybiB7XG5cdCAgICByZXN0cmljdDogJ0EnLFxuXHQgICAgbXVsdGlFbGVtZW50OiB0cnVlLFxuXHQgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcblx0ICAgICAgc2NvcGUuJHdhdGNoKGF0dHIubmdIaWRlLCBmdW5jdGlvbiBuZ0hpZGVXYXRjaEFjdGlvbih2YWx1ZSkge1xuXHQgICAgICAgIC8vIFRoZSBjb21tZW50IGluc2lkZSBvZiB0aGUgbmdTaG93RGlyZWN0aXZlIGV4cGxhaW5zIHdoeSB3ZSBhZGQgYW5kXG5cdCAgICAgICAgLy8gcmVtb3ZlIGEgdGVtcG9yYXJ5IGNsYXNzIGZvciB0aGUgc2hvdy9oaWRlIGFuaW1hdGlvblxuXHQgICAgICAgICRhbmltYXRlW3ZhbHVlID8gJ2FkZENsYXNzJyA6ICdyZW1vdmVDbGFzcyddKGVsZW1lbnQsTkdfSElERV9DTEFTUywge1xuXHQgICAgICAgICAgdGVtcENsYXNzZXM6IE5HX0hJREVfSU5fUFJPR1JFU1NfQ0xBU1Ncblx0ICAgICAgICB9KTtcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfTtcblx0fV07XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ1N0eWxlXG5cdCAqIEByZXN0cmljdCBBQ1xuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICogVGhlIGBuZ1N0eWxlYCBkaXJlY3RpdmUgYWxsb3dzIHlvdSB0byBzZXQgQ1NTIHN0eWxlIG9uIGFuIEhUTUwgZWxlbWVudCBjb25kaXRpb25hbGx5LlxuXHQgKlxuXHQgKiBAZWxlbWVudCBBTllcblx0ICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ1N0eWxlXG5cdCAqXG5cdCAqIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHdoaWNoIGV2YWxzIHRvIGFuXG5cdCAqIG9iamVjdCB3aG9zZSBrZXlzIGFyZSBDU1Mgc3R5bGUgbmFtZXMgYW5kIHZhbHVlcyBhcmUgY29ycmVzcG9uZGluZyB2YWx1ZXMgZm9yIHRob3NlIENTU1xuXHQgKiBrZXlzLlxuXHQgKlxuXHQgKiBTaW5jZSBzb21lIENTUyBzdHlsZSBuYW1lcyBhcmUgbm90IHZhbGlkIGtleXMgZm9yIGFuIG9iamVjdCwgdGhleSBtdXN0IGJlIHF1b3RlZC5cblx0ICogU2VlIHRoZSAnYmFja2dyb3VuZC1jb2xvcicgc3R5bGUgaW4gdGhlIGV4YW1wbGUgYmVsb3cuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgIDxleGFtcGxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAgICAgICAgPGlucHV0IHR5cGU9XCJidXR0b25cIiB2YWx1ZT1cInNldCBjb2xvclwiIG5nLWNsaWNrPVwibXlTdHlsZT17Y29sb3I6J3JlZCd9XCI+XG5cdCAgICAgICAgPGlucHV0IHR5cGU9XCJidXR0b25cIiB2YWx1ZT1cInNldCBiYWNrZ3JvdW5kXCIgbmctY2xpY2s9XCJteVN0eWxlPXsnYmFja2dyb3VuZC1jb2xvcic6J2JsdWUnfVwiPlxuXHQgICAgICAgIDxpbnB1dCB0eXBlPVwiYnV0dG9uXCIgdmFsdWU9XCJjbGVhclwiIG5nLWNsaWNrPVwibXlTdHlsZT17fVwiPlxuXHQgICAgICAgIDxici8+XG5cdCAgICAgICAgPHNwYW4gbmctc3R5bGU9XCJteVN0eWxlXCI+U2FtcGxlIFRleHQ8L3NwYW4+XG5cdCAgICAgICAgPHByZT5teVN0eWxlPXt7bXlTdHlsZX19PC9wcmU+XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJzdHlsZS5jc3NcIj5cblx0ICAgICAgIHNwYW4ge1xuXHQgICAgICAgICBjb2xvcjogYmxhY2s7XG5cdCAgICAgICB9XG5cdCAgICAgPC9maWxlPlxuXHQgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgIHZhciBjb2xvclNwYW4gPSBlbGVtZW50KGJ5LmNzcygnc3BhbicpKTtcblx0XG5cdCAgICAgICBpdCgnc2hvdWxkIGNoZWNrIG5nLXN0eWxlJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgIGV4cGVjdChjb2xvclNwYW4uZ2V0Q3NzVmFsdWUoJ2NvbG9yJykpLnRvQmUoJ3JnYmEoMCwgMCwgMCwgMSknKTtcblx0ICAgICAgICAgZWxlbWVudChieS5jc3MoJ2lucHV0W3ZhbHVlPVxcJ3NldCBjb2xvclxcJ10nKSkuY2xpY2soKTtcblx0ICAgICAgICAgZXhwZWN0KGNvbG9yU3Bhbi5nZXRDc3NWYWx1ZSgnY29sb3InKSkudG9CZSgncmdiYSgyNTUsIDAsIDAsIDEpJyk7XG5cdCAgICAgICAgIGVsZW1lbnQoYnkuY3NzKCdpbnB1dFt2YWx1ZT1jbGVhcl0nKSkuY2xpY2soKTtcblx0ICAgICAgICAgZXhwZWN0KGNvbG9yU3Bhbi5nZXRDc3NWYWx1ZSgnY29sb3InKSkudG9CZSgncmdiYSgwLCAwLCAwLCAxKScpO1xuXHQgICAgICAgfSk7XG5cdCAgICAgPC9maWxlPlxuXHQgICA8L2V4YW1wbGU+XG5cdCAqL1xuXHR2YXIgbmdTdHlsZURpcmVjdGl2ZSA9IG5nRGlyZWN0aXZlKGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG5cdCAgc2NvcGUuJHdhdGNoKGF0dHIubmdTdHlsZSwgZnVuY3Rpb24gbmdTdHlsZVdhdGNoQWN0aW9uKG5ld1N0eWxlcywgb2xkU3R5bGVzKSB7XG5cdCAgICBpZiAob2xkU3R5bGVzICYmIChuZXdTdHlsZXMgIT09IG9sZFN0eWxlcykpIHtcblx0ICAgICAgZm9yRWFjaChvbGRTdHlsZXMsIGZ1bmN0aW9uKHZhbCwgc3R5bGUpIHsgZWxlbWVudC5jc3Moc3R5bGUsICcnKTt9KTtcblx0ICAgIH1cblx0ICAgIGlmIChuZXdTdHlsZXMpIGVsZW1lbnQuY3NzKG5ld1N0eWxlcyk7XG5cdCAgfSwgdHJ1ZSk7XG5cdH0pO1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdTd2l0Y2hcblx0ICogQHJlc3RyaWN0IEVBXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUaGUgYG5nU3dpdGNoYCBkaXJlY3RpdmUgaXMgdXNlZCB0byBjb25kaXRpb25hbGx5IHN3YXAgRE9NIHN0cnVjdHVyZSBvbiB5b3VyIHRlbXBsYXRlIGJhc2VkIG9uIGEgc2NvcGUgZXhwcmVzc2lvbi5cblx0ICogRWxlbWVudHMgd2l0aGluIGBuZ1N3aXRjaGAgYnV0IHdpdGhvdXQgYG5nU3dpdGNoV2hlbmAgb3IgYG5nU3dpdGNoRGVmYXVsdGAgZGlyZWN0aXZlcyB3aWxsIGJlIHByZXNlcnZlZCBhdCB0aGUgbG9jYXRpb25cblx0ICogYXMgc3BlY2lmaWVkIGluIHRoZSB0ZW1wbGF0ZS5cblx0ICpcblx0ICogVGhlIGRpcmVjdGl2ZSBpdHNlbGYgd29ya3Mgc2ltaWxhciB0byBuZ0luY2x1ZGUsIGhvd2V2ZXIsIGluc3RlYWQgb2YgZG93bmxvYWRpbmcgdGVtcGxhdGUgY29kZSAob3IgbG9hZGluZyBpdFxuXHQgKiBmcm9tIHRoZSB0ZW1wbGF0ZSBjYWNoZSksIGBuZ1N3aXRjaGAgc2ltcGx5IGNob29zZXMgb25lIG9mIHRoZSBuZXN0ZWQgZWxlbWVudHMgYW5kIG1ha2VzIGl0IHZpc2libGUgYmFzZWQgb24gd2hpY2ggZWxlbWVudFxuXHQgKiBtYXRjaGVzIHRoZSB2YWx1ZSBvYnRhaW5lZCBmcm9tIHRoZSBldmFsdWF0ZWQgZXhwcmVzc2lvbi4gSW4gb3RoZXIgd29yZHMsIHlvdSBkZWZpbmUgYSBjb250YWluZXIgZWxlbWVudFxuXHQgKiAod2hlcmUgeW91IHBsYWNlIHRoZSBkaXJlY3RpdmUpLCBwbGFjZSBhbiBleHByZXNzaW9uIG9uIHRoZSAqKmBvbj1cIi4uLlwiYCBhdHRyaWJ1dGUqKlxuXHQgKiAob3IgdGhlICoqYG5nLXN3aXRjaD1cIi4uLlwiYCBhdHRyaWJ1dGUqKiksIGRlZmluZSBhbnkgaW5uZXIgZWxlbWVudHMgaW5zaWRlIG9mIHRoZSBkaXJlY3RpdmUgYW5kIHBsYWNlXG5cdCAqIGEgd2hlbiBhdHRyaWJ1dGUgcGVyIGVsZW1lbnQuIFRoZSB3aGVuIGF0dHJpYnV0ZSBpcyB1c2VkIHRvIGluZm9ybSBuZ1N3aXRjaCB3aGljaCBlbGVtZW50IHRvIGRpc3BsYXkgd2hlbiB0aGUgb25cblx0ICogZXhwcmVzc2lvbiBpcyBldmFsdWF0ZWQuIElmIGEgbWF0Y2hpbmcgZXhwcmVzc2lvbiBpcyBub3QgZm91bmQgdmlhIGEgd2hlbiBhdHRyaWJ1dGUgdGhlbiBhbiBlbGVtZW50IHdpdGggdGhlIGRlZmF1bHRcblx0ICogYXR0cmlidXRlIGlzIGRpc3BsYXllZC5cblx0ICpcblx0ICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWluZm9cIj5cblx0ICogQmUgYXdhcmUgdGhhdCB0aGUgYXR0cmlidXRlIHZhbHVlcyB0byBtYXRjaCBhZ2FpbnN0IGNhbm5vdCBiZSBleHByZXNzaW9ucy4gVGhleSBhcmUgaW50ZXJwcmV0ZWRcblx0ICogYXMgbGl0ZXJhbCBzdHJpbmcgdmFsdWVzIHRvIG1hdGNoIGFnYWluc3QuXG5cdCAqIEZvciBleGFtcGxlLCAqKmBuZy1zd2l0Y2gtd2hlbj1cInNvbWVWYWxcImAqKiB3aWxsIG1hdGNoIGFnYWluc3QgdGhlIHN0cmluZyBgXCJzb21lVmFsXCJgIG5vdCBhZ2FpbnN0IHRoZVxuXHQgKiB2YWx1ZSBvZiB0aGUgZXhwcmVzc2lvbiBgJHNjb3BlLnNvbWVWYWxgLlxuXHQgKiA8L2Rpdj5cblx0XG5cdCAqIEBhbmltYXRpb25zXG5cdCAqIGVudGVyIC0gaGFwcGVucyBhZnRlciB0aGUgbmdTd2l0Y2ggY29udGVudHMgY2hhbmdlIGFuZCB0aGUgbWF0Y2hlZCBjaGlsZCBlbGVtZW50IGlzIHBsYWNlZCBpbnNpZGUgdGhlIGNvbnRhaW5lclxuXHQgKiBsZWF2ZSAtIGhhcHBlbnMganVzdCBhZnRlciB0aGUgbmdTd2l0Y2ggY29udGVudHMgY2hhbmdlIGFuZCBqdXN0IGJlZm9yZSB0aGUgZm9ybWVyIGNvbnRlbnRzIGFyZSByZW1vdmVkIGZyb20gdGhlIERPTVxuXHQgKlxuXHQgKiBAdXNhZ2Vcblx0ICpcblx0ICogYGBgXG5cdCAqIDxBTlkgbmctc3dpdGNoPVwiZXhwcmVzc2lvblwiPlxuXHQgKiAgIDxBTlkgbmctc3dpdGNoLXdoZW49XCJtYXRjaFZhbHVlMVwiPi4uLjwvQU5ZPlxuXHQgKiAgIDxBTlkgbmctc3dpdGNoLXdoZW49XCJtYXRjaFZhbHVlMlwiPi4uLjwvQU5ZPlxuXHQgKiAgIDxBTlkgbmctc3dpdGNoLWRlZmF1bHQ+Li4uPC9BTlk+XG5cdCAqIDwvQU5ZPlxuXHQgKiBgYGBcblx0ICpcblx0ICpcblx0ICogQHNjb3BlXG5cdCAqIEBwcmlvcml0eSAxMjAwXG5cdCAqIEBwYXJhbSB7Kn0gbmdTd2l0Y2h8b24gZXhwcmVzc2lvbiB0byBtYXRjaCBhZ2FpbnN0IDxjb2RlPm5nLXN3aXRjaC13aGVuPC9jb2RlPi5cblx0ICogT24gY2hpbGQgZWxlbWVudHMgYWRkOlxuXHQgKlxuXHQgKiAqIGBuZ1N3aXRjaFdoZW5gOiB0aGUgY2FzZSBzdGF0ZW1lbnQgdG8gbWF0Y2ggYWdhaW5zdC4gSWYgbWF0Y2ggdGhlbiB0aGlzXG5cdCAqICAgY2FzZSB3aWxsIGJlIGRpc3BsYXllZC4gSWYgdGhlIHNhbWUgbWF0Y2ggYXBwZWFycyBtdWx0aXBsZSB0aW1lcywgYWxsIHRoZVxuXHQgKiAgIGVsZW1lbnRzIHdpbGwgYmUgZGlzcGxheWVkLlxuXHQgKiAqIGBuZ1N3aXRjaERlZmF1bHRgOiB0aGUgZGVmYXVsdCBjYXNlIHdoZW4gbm8gb3RoZXIgY2FzZSBtYXRjaC4gSWYgdGhlcmVcblx0ICogICBhcmUgbXVsdGlwbGUgZGVmYXVsdCBjYXNlcywgYWxsIG9mIHRoZW0gd2lsbCBiZSBkaXNwbGF5ZWQgd2hlbiBubyBvdGhlclxuXHQgKiAgIGNhc2UgbWF0Y2guXG5cdCAqXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgPGV4YW1wbGUgbW9kdWxlPVwic3dpdGNoRXhhbXBsZVwiIGRlcHM9XCJhbmd1bGFyLWFuaW1hdGUuanNcIiBhbmltYXRpb25zPVwidHJ1ZVwiPlxuXHQgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICAgICAgICA8c2VsZWN0IG5nLW1vZGVsPVwic2VsZWN0aW9uXCIgbmctb3B0aW9ucz1cIml0ZW0gZm9yIGl0ZW0gaW4gaXRlbXNcIj5cblx0ICAgICAgICA8L3NlbGVjdD5cblx0ICAgICAgICA8Y29kZT5zZWxlY3Rpb249e3tzZWxlY3Rpb259fTwvY29kZT5cblx0ICAgICAgICA8aHIvPlxuXHQgICAgICAgIDxkaXYgY2xhc3M9XCJhbmltYXRlLXN3aXRjaC1jb250YWluZXJcIlxuXHQgICAgICAgICAgbmctc3dpdGNoIG9uPVwic2VsZWN0aW9uXCI+XG5cdCAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbmltYXRlLXN3aXRjaFwiIG5nLXN3aXRjaC13aGVuPVwic2V0dGluZ3NcIj5TZXR0aW5ncyBEaXY8L2Rpdj5cblx0ICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFuaW1hdGUtc3dpdGNoXCIgbmctc3dpdGNoLXdoZW49XCJob21lXCI+SG9tZSBTcGFuPC9kaXY+XG5cdCAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbmltYXRlLXN3aXRjaFwiIG5nLXN3aXRjaC1kZWZhdWx0PmRlZmF1bHQ8L2Rpdj5cblx0ICAgICAgICA8L2Rpdj5cblx0ICAgICAgPC9kaXY+XG5cdCAgICA8L2ZpbGU+XG5cdCAgICA8ZmlsZSBuYW1lPVwic2NyaXB0LmpzXCI+XG5cdCAgICAgIGFuZ3VsYXIubW9kdWxlKCdzd2l0Y2hFeGFtcGxlJywgWyduZ0FuaW1hdGUnXSlcblx0ICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgICAgICAgICAgJHNjb3BlLml0ZW1zID0gWydzZXR0aW5ncycsICdob21lJywgJ290aGVyJ107XG5cdCAgICAgICAgICAkc2NvcGUuc2VsZWN0aW9uID0gJHNjb3BlLml0ZW1zWzBdO1xuXHQgICAgICAgIH1dKTtcblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJhbmltYXRpb25zLmNzc1wiPlxuXHQgICAgICAuYW5pbWF0ZS1zd2l0Y2gtY29udGFpbmVyIHtcblx0ICAgICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcblx0ICAgICAgICBiYWNrZ3JvdW5kOndoaXRlO1xuXHQgICAgICAgIGJvcmRlcjoxcHggc29saWQgYmxhY2s7XG5cdCAgICAgICAgaGVpZ2h0OjQwcHg7XG5cdCAgICAgICAgb3ZlcmZsb3c6aGlkZGVuO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAuYW5pbWF0ZS1zd2l0Y2gge1xuXHQgICAgICAgIHBhZGRpbmc6MTBweDtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLmFuaW1hdGUtc3dpdGNoLm5nLWFuaW1hdGUge1xuXHQgICAgICAgIHRyYW5zaXRpb246YWxsIGN1YmljLWJlemllcigwLjI1MCwgMC40NjAsIDAuNDUwLCAwLjk0MCkgMC41cztcblx0XG5cdCAgICAgICAgcG9zaXRpb246YWJzb2x1dGU7XG5cdCAgICAgICAgdG9wOjA7XG5cdCAgICAgICAgbGVmdDowO1xuXHQgICAgICAgIHJpZ2h0OjA7XG5cdCAgICAgICAgYm90dG9tOjA7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC5hbmltYXRlLXN3aXRjaC5uZy1sZWF2ZS5uZy1sZWF2ZS1hY3RpdmUsXG5cdCAgICAgIC5hbmltYXRlLXN3aXRjaC5uZy1lbnRlciB7XG5cdCAgICAgICAgdG9wOi01MHB4O1xuXHQgICAgICB9XG5cdCAgICAgIC5hbmltYXRlLXN3aXRjaC5uZy1sZWF2ZSxcblx0ICAgICAgLmFuaW1hdGUtc3dpdGNoLm5nLWVudGVyLm5nLWVudGVyLWFjdGl2ZSB7XG5cdCAgICAgICAgdG9wOjA7XG5cdCAgICAgIH1cblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgdmFyIHN3aXRjaEVsZW0gPSBlbGVtZW50KGJ5LmNzcygnW25nLXN3aXRjaF0nKSk7XG5cdCAgICAgIHZhciBzZWxlY3QgPSBlbGVtZW50KGJ5Lm1vZGVsKCdzZWxlY3Rpb24nKSk7XG5cdFxuXHQgICAgICBpdCgnc2hvdWxkIHN0YXJ0IGluIHNldHRpbmdzJywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgZXhwZWN0KHN3aXRjaEVsZW0uZ2V0VGV4dCgpKS50b01hdGNoKC9TZXR0aW5ncyBEaXYvKTtcblx0ICAgICAgfSk7XG5cdCAgICAgIGl0KCdzaG91bGQgY2hhbmdlIHRvIGhvbWUnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBzZWxlY3QuYWxsKGJ5LmNzcygnb3B0aW9uJykpLmdldCgxKS5jbGljaygpO1xuXHQgICAgICAgIGV4cGVjdChzd2l0Y2hFbGVtLmdldFRleHQoKSkudG9NYXRjaCgvSG9tZSBTcGFuLyk7XG5cdCAgICAgIH0pO1xuXHQgICAgICBpdCgnc2hvdWxkIHNlbGVjdCBkZWZhdWx0JywgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgc2VsZWN0LmFsbChieS5jc3MoJ29wdGlvbicpKS5nZXQoMikuY2xpY2soKTtcblx0ICAgICAgICBleHBlY3Qoc3dpdGNoRWxlbS5nZXRUZXh0KCkpLnRvTWF0Y2goL2RlZmF1bHQvKTtcblx0ICAgICAgfSk7XG5cdCAgICA8L2ZpbGU+XG5cdCAgPC9leGFtcGxlPlxuXHQgKi9cblx0dmFyIG5nU3dpdGNoRGlyZWN0aXZlID0gWyckYW5pbWF0ZScsIGZ1bmN0aW9uKCRhbmltYXRlKSB7XG5cdCAgcmV0dXJuIHtcblx0ICAgIHJlcXVpcmU6ICduZ1N3aXRjaCcsXG5cdFxuXHQgICAgLy8gYXNrcyBmb3IgJHNjb3BlIHRvIGZvb2wgdGhlIEJDIGNvbnRyb2xsZXIgbW9kdWxlXG5cdCAgICBjb250cm9sbGVyOiBbJyRzY29wZScsIGZ1bmN0aW9uIG5nU3dpdGNoQ29udHJvbGxlcigpIHtcblx0ICAgICB0aGlzLmNhc2VzID0ge307XG5cdCAgICB9XSxcblx0ICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBuZ1N3aXRjaENvbnRyb2xsZXIpIHtcblx0ICAgICAgdmFyIHdhdGNoRXhwciA9IGF0dHIubmdTd2l0Y2ggfHwgYXR0ci5vbixcblx0ICAgICAgICAgIHNlbGVjdGVkVHJhbnNjbHVkZXMgPSBbXSxcblx0ICAgICAgICAgIHNlbGVjdGVkRWxlbWVudHMgPSBbXSxcblx0ICAgICAgICAgIHByZXZpb3VzTGVhdmVBbmltYXRpb25zID0gW10sXG5cdCAgICAgICAgICBzZWxlY3RlZFNjb3BlcyA9IFtdO1xuXHRcblx0ICAgICAgdmFyIHNwbGljZUZhY3RvcnkgPSBmdW5jdGlvbihhcnJheSwgaW5kZXgpIHtcblx0ICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHsgYXJyYXkuc3BsaWNlKGluZGV4LCAxKTsgfTtcblx0ICAgICAgfTtcblx0XG5cdCAgICAgIHNjb3BlLiR3YXRjaCh3YXRjaEV4cHIsIGZ1bmN0aW9uIG5nU3dpdGNoV2F0Y2hBY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICB2YXIgaSwgaWk7XG5cdCAgICAgICAgZm9yIChpID0gMCwgaWkgPSBwcmV2aW91c0xlYXZlQW5pbWF0aW9ucy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG5cdCAgICAgICAgICAkYW5pbWF0ZS5jYW5jZWwocHJldmlvdXNMZWF2ZUFuaW1hdGlvbnNbaV0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBwcmV2aW91c0xlYXZlQW5pbWF0aW9ucy5sZW5ndGggPSAwO1xuXHRcblx0ICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHNlbGVjdGVkU2NvcGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcblx0ICAgICAgICAgIHZhciBzZWxlY3RlZCA9IGdldEJsb2NrTm9kZXMoc2VsZWN0ZWRFbGVtZW50c1tpXS5jbG9uZSk7XG5cdCAgICAgICAgICBzZWxlY3RlZFNjb3Blc1tpXS4kZGVzdHJveSgpO1xuXHQgICAgICAgICAgdmFyIHByb21pc2UgPSBwcmV2aW91c0xlYXZlQW5pbWF0aW9uc1tpXSA9ICRhbmltYXRlLmxlYXZlKHNlbGVjdGVkKTtcblx0ICAgICAgICAgIHByb21pc2UudGhlbihzcGxpY2VGYWN0b3J5KHByZXZpb3VzTGVhdmVBbmltYXRpb25zLCBpKSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBzZWxlY3RlZEVsZW1lbnRzLmxlbmd0aCA9IDA7XG5cdCAgICAgICAgc2VsZWN0ZWRTY29wZXMubGVuZ3RoID0gMDtcblx0XG5cdCAgICAgICAgaWYgKChzZWxlY3RlZFRyYW5zY2x1ZGVzID0gbmdTd2l0Y2hDb250cm9sbGVyLmNhc2VzWychJyArIHZhbHVlXSB8fCBuZ1N3aXRjaENvbnRyb2xsZXIuY2FzZXNbJz8nXSkpIHtcblx0ICAgICAgICAgIGZvckVhY2goc2VsZWN0ZWRUcmFuc2NsdWRlcywgZnVuY3Rpb24oc2VsZWN0ZWRUcmFuc2NsdWRlKSB7XG5cdCAgICAgICAgICAgIHNlbGVjdGVkVHJhbnNjbHVkZS50cmFuc2NsdWRlKGZ1bmN0aW9uKGNhc2VFbGVtZW50LCBzZWxlY3RlZFNjb3BlKSB7XG5cdCAgICAgICAgICAgICAgc2VsZWN0ZWRTY29wZXMucHVzaChzZWxlY3RlZFNjb3BlKTtcblx0ICAgICAgICAgICAgICB2YXIgYW5jaG9yID0gc2VsZWN0ZWRUcmFuc2NsdWRlLmVsZW1lbnQ7XG5cdCAgICAgICAgICAgICAgY2FzZUVsZW1lbnRbY2FzZUVsZW1lbnQubGVuZ3RoKytdID0gZG9jdW1lbnQuY3JlYXRlQ29tbWVudCgnIGVuZCBuZ1N3aXRjaFdoZW46ICcpO1xuXHQgICAgICAgICAgICAgIHZhciBibG9jayA9IHsgY2xvbmU6IGNhc2VFbGVtZW50IH07XG5cdFxuXHQgICAgICAgICAgICAgIHNlbGVjdGVkRWxlbWVudHMucHVzaChibG9jayk7XG5cdCAgICAgICAgICAgICAgJGFuaW1hdGUuZW50ZXIoY2FzZUVsZW1lbnQsIGFuY2hvci5wYXJlbnQoKSwgYW5jaG9yKTtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH07XG5cdH1dO1xuXHRcblx0dmFyIG5nU3dpdGNoV2hlbkRpcmVjdGl2ZSA9IG5nRGlyZWN0aXZlKHtcblx0ICB0cmFuc2NsdWRlOiAnZWxlbWVudCcsXG5cdCAgcHJpb3JpdHk6IDEyMDAsXG5cdCAgcmVxdWlyZTogJ15uZ1N3aXRjaCcsXG5cdCAgbXVsdGlFbGVtZW50OiB0cnVlLFxuXHQgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY3RybCwgJHRyYW5zY2x1ZGUpIHtcblx0ICAgIGN0cmwuY2FzZXNbJyEnICsgYXR0cnMubmdTd2l0Y2hXaGVuXSA9IChjdHJsLmNhc2VzWychJyArIGF0dHJzLm5nU3dpdGNoV2hlbl0gfHwgW10pO1xuXHQgICAgY3RybC5jYXNlc1snIScgKyBhdHRycy5uZ1N3aXRjaFdoZW5dLnB1c2goeyB0cmFuc2NsdWRlOiAkdHJhbnNjbHVkZSwgZWxlbWVudDogZWxlbWVudCB9KTtcblx0ICB9XG5cdH0pO1xuXHRcblx0dmFyIG5nU3dpdGNoRGVmYXVsdERpcmVjdGl2ZSA9IG5nRGlyZWN0aXZlKHtcblx0ICB0cmFuc2NsdWRlOiAnZWxlbWVudCcsXG5cdCAgcHJpb3JpdHk6IDEyMDAsXG5cdCAgcmVxdWlyZTogJ15uZ1N3aXRjaCcsXG5cdCAgbXVsdGlFbGVtZW50OiB0cnVlLFxuXHQgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsLCAkdHJhbnNjbHVkZSkge1xuXHQgICAgY3RybC5jYXNlc1snPyddID0gKGN0cmwuY2FzZXNbJz8nXSB8fCBbXSk7XG5cdCAgICBjdHJsLmNhc2VzWyc/J10ucHVzaCh7IHRyYW5zY2x1ZGU6ICR0cmFuc2NsdWRlLCBlbGVtZW50OiBlbGVtZW50IH0pO1xuXHQgICB9XG5cdH0pO1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdUcmFuc2NsdWRlXG5cdCAqIEByZXN0cmljdCBFQUNcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIERpcmVjdGl2ZSB0aGF0IG1hcmtzIHRoZSBpbnNlcnRpb24gcG9pbnQgZm9yIHRoZSB0cmFuc2NsdWRlZCBET00gb2YgdGhlIG5lYXJlc3QgcGFyZW50IGRpcmVjdGl2ZSB0aGF0IHVzZXMgdHJhbnNjbHVzaW9uLlxuXHQgKlxuXHQgKiBZb3UgY2FuIHNwZWNpZnkgdGhhdCB5b3Ugd2FudCB0byBpbnNlcnQgYSBuYW1lZCB0cmFuc2NsdXNpb24gc2xvdCwgaW5zdGVhZCBvZiB0aGUgZGVmYXVsdCBzbG90LCBieSBwcm92aWRpbmcgdGhlIHNsb3QgbmFtZVxuXHQgKiBhcyB0aGUgdmFsdWUgb2YgdGhlIGBuZy10cmFuc2NsdWRlYCBvciBgbmctdHJhbnNjbHVkZS1zbG90YCBhdHRyaWJ1dGUuXG5cdCAqXG5cdCAqIElmIHRoZSB0cmFuc2NsdWRlZCBjb250ZW50IGlzIG5vdCBlbXB0eSAoaS5lLiBjb250YWlucyBvbmUgb3IgbW9yZSBET00gbm9kZXMsIGluY2x1ZGluZyB3aGl0ZXNwYWNlIHRleHQgbm9kZXMpLCBhbnkgZXhpc3Rpbmdcblx0ICogY29udGVudCBvZiB0aGlzIGVsZW1lbnQgd2lsbCBiZSByZW1vdmVkIGJlZm9yZSB0aGUgdHJhbnNjbHVkZWQgY29udGVudCBpcyBpbnNlcnRlZC5cblx0ICogSWYgdGhlIHRyYW5zY2x1ZGVkIGNvbnRlbnQgaXMgZW1wdHksIHRoZSBleGlzdGluZyBjb250ZW50IGlzIGxlZnQgaW50YWN0LiBUaGlzIGxldHMgeW91IHByb3ZpZGUgZmFsbGJhY2sgY29udGVudCBpbiB0aGUgY2FzZVxuXHQgKiB0aGF0IG5vIHRyYW5zY2x1ZGVkIGNvbnRlbnQgaXMgcHJvdmlkZWQuXG5cdCAqXG5cdCAqIEBlbGVtZW50IEFOWVxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gbmdUcmFuc2NsdWRlfG5nVHJhbnNjbHVkZVNsb3QgdGhlIG5hbWUgb2YgdGhlIHNsb3QgdG8gaW5zZXJ0IGF0IHRoaXMgcG9pbnQuIElmIHRoaXMgaXMgbm90IHByb3ZpZGVkLCBpcyBlbXB0eVxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3IgaXRzIHZhbHVlIGlzIHRoZSBzYW1lIGFzIHRoZSBuYW1lIG9mIHRoZSBhdHRyaWJ1dGUgdGhlbiB0aGUgZGVmYXVsdCBzbG90IGlzIHVzZWQuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqICMjIyBCYXNpYyB0cmFuc2NsdXNpb25cblx0ICogVGhpcyBleGFtcGxlIGRlbW9uc3RyYXRlcyBiYXNpYyB0cmFuc2NsdXNpb24gb2YgY29udGVudCBpbnRvIGEgY29tcG9uZW50IGRpcmVjdGl2ZS5cblx0ICogPGV4YW1wbGUgbmFtZT1cInNpbXBsZVRyYW5zY2x1ZGVFeGFtcGxlXCIgbW9kdWxlPVwidHJhbnNjbHVkZUV4YW1wbGVcIj5cblx0ICogICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgKiAgICAgPHNjcmlwdD5cblx0ICogICAgICAgYW5ndWxhci5tb2R1bGUoJ3RyYW5zY2x1ZGVFeGFtcGxlJywgW10pXG5cdCAqICAgICAgICAuZGlyZWN0aXZlKCdwYW5lJywgZnVuY3Rpb24oKXtcblx0ICogICAgICAgICAgIHJldHVybiB7XG5cdCAqICAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG5cdCAqICAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG5cdCAqICAgICAgICAgICAgIHNjb3BlOiB7IHRpdGxlOidAJyB9LFxuXHQgKiAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgc3R5bGU9XCJib3JkZXI6IDFweCBzb2xpZCBibGFjaztcIj4nICtcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiBncmF5XCI+e3t0aXRsZX19PC9kaXY+JyArXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICAgICc8bmctdHJhbnNjbHVkZT48L25nLXRyYW5zY2x1ZGU+JyArXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+J1xuXHQgKiAgICAgICAgICAgfTtcblx0ICogICAgICAgfSlcblx0ICogICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICogICAgICAgICAkc2NvcGUudGl0bGUgPSAnTG9yZW0gSXBzdW0nO1xuXHQgKiAgICAgICAgICRzY29wZS50ZXh0ID0gJ05lcXVlIHBvcnJvIHF1aXNxdWFtIGVzdCBxdWkgZG9sb3JlbSBpcHN1bSBxdWlhIGRvbG9yLi4uJztcblx0ICogICAgICAgfV0pO1xuXHQgKiAgICAgPC9zY3JpcHQ+XG5cdCAqICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgKiAgICAgICA8aW5wdXQgbmctbW9kZWw9XCJ0aXRsZVwiIGFyaWEtbGFiZWw9XCJ0aXRsZVwiPiA8YnIvPlxuXHQgKiAgICAgICA8dGV4dGFyZWEgbmctbW9kZWw9XCJ0ZXh0XCIgYXJpYS1sYWJlbD1cInRleHRcIj48L3RleHRhcmVhPiA8YnIvPlxuXHQgKiAgICAgICA8cGFuZSB0aXRsZT1cInt7dGl0bGV9fVwiPnt7dGV4dH19PC9wYW5lPlxuXHQgKiAgICAgPC9kaXY+XG5cdCAqICAgPC9maWxlPlxuXHQgKiAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICogICAgICBpdCgnc2hvdWxkIGhhdmUgdHJhbnNjbHVkZWQnLCBmdW5jdGlvbigpIHtcblx0ICogICAgICAgIHZhciB0aXRsZUVsZW1lbnQgPSBlbGVtZW50KGJ5Lm1vZGVsKCd0aXRsZScpKTtcblx0ICogICAgICAgIHRpdGxlRWxlbWVudC5jbGVhcigpO1xuXHQgKiAgICAgICAgdGl0bGVFbGVtZW50LnNlbmRLZXlzKCdUSVRMRScpO1xuXHQgKiAgICAgICAgdmFyIHRleHRFbGVtZW50ID0gZWxlbWVudChieS5tb2RlbCgndGV4dCcpKTtcblx0ICogICAgICAgIHRleHRFbGVtZW50LmNsZWFyKCk7XG5cdCAqICAgICAgICB0ZXh0RWxlbWVudC5zZW5kS2V5cygnVEVYVCcpO1xuXHQgKiAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygndGl0bGUnKSkuZ2V0VGV4dCgpKS50b0VxdWFsKCdUSVRMRScpO1xuXHQgKiAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygndGV4dCcpKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ1RFWFQnKTtcblx0ICogICAgICB9KTtcblx0ICogICA8L2ZpbGU+XG5cdCAqIDwvZXhhbXBsZT5cblx0ICpcblx0ICogQGV4YW1wbGVcblx0ICogIyMjIFRyYW5zY2x1ZGUgZmFsbGJhY2sgY29udGVudFxuXHQgKiBUaGlzIGV4YW1wbGUgc2hvd3MgaG93IHRvIHVzZSBgTmdUcmFuc2NsdWRlYCB3aXRoIGZhbGxiYWNrIGNvbnRlbnQsIHRoYXRcblx0ICogaXMgZGlzcGxheWVkIGlmIG5vIHRyYW5zY2x1ZGVkIGNvbnRlbnQgaXMgcHJvdmlkZWQuXG5cdCAqXG5cdCAqIDxleGFtcGxlIG1vZHVsZT1cInRyYW5zY2x1ZGVGYWxsYmFja0NvbnRlbnRFeGFtcGxlXCI+XG5cdCAqIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAqIDxzY3JpcHQ+XG5cdCAqIGFuZ3VsYXIubW9kdWxlKCd0cmFuc2NsdWRlRmFsbGJhY2tDb250ZW50RXhhbXBsZScsIFtdKVxuXHQgKiAuZGlyZWN0aXZlKCdteUJ1dHRvbicsIGZ1bmN0aW9uKCl7XG5cdCAqICAgICAgICAgICAgIHJldHVybiB7XG5cdCAqICAgICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcblx0ICogICAgICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuXHQgKiAgICAgICAgICAgICAgIHNjb3BlOiB0cnVlLFxuXHQgKiAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPGJ1dHRvbiBzdHlsZT1cImN1cnNvcjogcG9pbnRlcjtcIj4nICtcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAnPG5nLXRyYW5zY2x1ZGU+JyArXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGIgc3R5bGU9XCJjb2xvcjogcmVkO1wiPkJ1dHRvbjE8L2I+JyArXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvbmctdHJhbnNjbHVkZT4nICtcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgJzwvYnV0dG9uPidcblx0ICogICAgICAgICAgICAgfTtcblx0ICogICAgICAgICB9KTtcblx0ICogPC9zY3JpcHQ+XG5cdCAqIDwhLS0gZmFsbGJhY2sgYnV0dG9uIGNvbnRlbnQgLS0+XG5cdCAqIDxteS1idXR0b24gaWQ9XCJmYWxsYmFja1wiPjwvbXktYnV0dG9uPlxuXHQgKiA8IS0tIG1vZGlmaWVkIGJ1dHRvbiBjb250ZW50IC0tPlxuXHQgKiA8bXktYnV0dG9uIGlkPVwibW9kaWZpZWRcIj5cblx0ICogICA8aSBzdHlsZT1cImNvbG9yOiBncmVlbjtcIj5CdXR0b24yPC9pPlxuXHQgKiA8L215LWJ1dHRvbj5cblx0ICogPC9maWxlPlxuXHQgKiA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAqIGl0KCdzaG91bGQgaGF2ZSBkaWZmZXJlbnQgdHJhbnNjbHVkZSBlbGVtZW50IGNvbnRlbnQnLCBmdW5jdGlvbigpIHtcblx0ICogICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2ZhbGxiYWNrJykpLmdldFRleHQoKSkudG9CZSgnQnV0dG9uMScpO1xuXHQgKiAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnbW9kaWZpZWQnKSkuZ2V0VGV4dCgpKS50b0JlKCdCdXR0b24yJyk7XG5cdCAqICAgICAgICB9KTtcblx0ICogPC9maWxlPlxuXHQgKiA8L2V4YW1wbGU+XG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqICMjIyBNdWx0aS1zbG90IHRyYW5zY2x1c2lvblxuXHQgKiBUaGlzIGV4YW1wbGUgZGVtb25zdHJhdGVzIHVzaW5nIG11bHRpLXNsb3QgdHJhbnNjbHVzaW9uIGluIGEgY29tcG9uZW50IGRpcmVjdGl2ZS5cblx0ICogPGV4YW1wbGUgbmFtZT1cIm11bHRpU2xvdFRyYW5zY2x1ZGVFeGFtcGxlXCIgbW9kdWxlPVwibXVsdGlTbG90VHJhbnNjbHVkZUV4YW1wbGVcIj5cblx0ICogICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgKiAgICA8c3R5bGU+XG5cdCAqICAgICAgLnRpdGxlLCAuZm9vdGVyIHtcblx0ICogICAgICAgIGJhY2tncm91bmQtY29sb3I6IGdyYXlcblx0ICogICAgICB9XG5cdCAqICAgIDwvc3R5bGU+XG5cdCAqICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAqICAgICAgPGlucHV0IG5nLW1vZGVsPVwidGl0bGVcIiBhcmlhLWxhYmVsPVwidGl0bGVcIj4gPGJyLz5cblx0ICogICAgICA8dGV4dGFyZWEgbmctbW9kZWw9XCJ0ZXh0XCIgYXJpYS1sYWJlbD1cInRleHRcIj48L3RleHRhcmVhPiA8YnIvPlxuXHQgKiAgICAgIDxwYW5lPlxuXHQgKiAgICAgICAgPHBhbmUtdGl0bGU+PGEgbmctaHJlZj1cInt7bGlua319XCI+e3t0aXRsZX19PC9hPjwvcGFuZS10aXRsZT5cblx0ICogICAgICAgIDxwYW5lLWJvZHk+PHA+e3t0ZXh0fX08L3A+PC9wYW5lLWJvZHk+XG5cdCAqICAgICAgPC9wYW5lPlxuXHQgKiAgICA8L2Rpdj5cblx0ICogICA8L2ZpbGU+XG5cdCAqICAgPGZpbGUgbmFtZT1cImFwcC5qc1wiPlxuXHQgKiAgICBhbmd1bGFyLm1vZHVsZSgnbXVsdGlTbG90VHJhbnNjbHVkZUV4YW1wbGUnLCBbXSlcblx0ICogICAgIC5kaXJlY3RpdmUoJ3BhbmUnLCBmdW5jdGlvbigpe1xuXHQgKiAgICAgICAgcmV0dXJuIHtcblx0ICogICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcblx0ICogICAgICAgICAgdHJhbnNjbHVkZToge1xuXHQgKiAgICAgICAgICAgICd0aXRsZSc6ICc/cGFuZVRpdGxlJyxcblx0ICogICAgICAgICAgICAnYm9keSc6ICdwYW5lQm9keScsXG5cdCAqICAgICAgICAgICAgJ2Zvb3Rlcic6ICc/cGFuZUZvb3Rlcidcblx0ICogICAgICAgICAgfSxcblx0ICogICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHN0eWxlPVwiYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XCI+JyArXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidGl0bGVcIiBuZy10cmFuc2NsdWRlPVwidGl0bGVcIj5GYWxsYmFjayBUaXRsZTwvZGl2PicgK1xuXHQgKiAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBuZy10cmFuc2NsdWRlPVwiYm9keVwiPjwvZGl2PicgK1xuXHQgKiAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZvb3RlclwiIG5nLXRyYW5zY2x1ZGU9XCJmb290ZXJcIj5GYWxsYmFjayBGb290ZXI8L2Rpdj4nICtcblx0ICogICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nXG5cdCAqICAgICAgICB9O1xuXHQgKiAgICB9KVxuXHQgKiAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgKiAgICAgICRzY29wZS50aXRsZSA9ICdMb3JlbSBJcHN1bSc7XG5cdCAqICAgICAgJHNjb3BlLmxpbmsgPSBcImh0dHBzOi8vZ29vZ2xlLmNvbVwiO1xuXHQgKiAgICAgICRzY29wZS50ZXh0ID0gJ05lcXVlIHBvcnJvIHF1aXNxdWFtIGVzdCBxdWkgZG9sb3JlbSBpcHN1bSBxdWlhIGRvbG9yLi4uJztcblx0ICogICAgfV0pO1xuXHQgKiAgIDwvZmlsZT5cblx0ICogICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAqICAgICAgaXQoJ3Nob3VsZCBoYXZlIHRyYW5zY2x1ZGVkIHRoZSB0aXRsZSBhbmQgdGhlIGJvZHknLCBmdW5jdGlvbigpIHtcblx0ICogICAgICAgIHZhciB0aXRsZUVsZW1lbnQgPSBlbGVtZW50KGJ5Lm1vZGVsKCd0aXRsZScpKTtcblx0ICogICAgICAgIHRpdGxlRWxlbWVudC5jbGVhcigpO1xuXHQgKiAgICAgICAgdGl0bGVFbGVtZW50LnNlbmRLZXlzKCdUSVRMRScpO1xuXHQgKiAgICAgICAgdmFyIHRleHRFbGVtZW50ID0gZWxlbWVudChieS5tb2RlbCgndGV4dCcpKTtcblx0ICogICAgICAgIHRleHRFbGVtZW50LmNsZWFyKCk7XG5cdCAqICAgICAgICB0ZXh0RWxlbWVudC5zZW5kS2V5cygnVEVYVCcpO1xuXHQgKiAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuY3NzKCcudGl0bGUnKSkuZ2V0VGV4dCgpKS50b0VxdWFsKCdUSVRMRScpO1xuXHQgKiAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygndGV4dCcpKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ1RFWFQnKTtcblx0ICogICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmNzcygnLmZvb3RlcicpKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ0ZhbGxiYWNrIEZvb3RlcicpO1xuXHQgKiAgICAgIH0pO1xuXHQgKiAgIDwvZmlsZT5cblx0ICogPC9leGFtcGxlPlxuXHQgKi9cblx0dmFyIG5nVHJhbnNjbHVkZU1pbkVyciA9IG1pbkVycignbmdUcmFuc2NsdWRlJyk7XG5cdHZhciBuZ1RyYW5zY2x1ZGVEaXJlY3RpdmUgPSBuZ0RpcmVjdGl2ZSh7XG5cdCAgcmVzdHJpY3Q6ICdFQUMnLFxuXHQgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY29udHJvbGxlciwgJHRyYW5zY2x1ZGUpIHtcblx0XG5cdCAgICBpZiAoJGF0dHJzLm5nVHJhbnNjbHVkZSA9PT0gJGF0dHJzLiRhdHRyLm5nVHJhbnNjbHVkZSkge1xuXHQgICAgICAvLyBJZiB0aGUgYXR0cmlidXRlIGlzIG9mIHRoZSBmb3JtOiBgbmctdHJhbnNjbHVkZT1cIm5nLXRyYW5zY2x1ZGVcImBcblx0ICAgICAgLy8gdGhlbiB0cmVhdCBpdCBsaWtlIHRoZSBkZWZhdWx0XG5cdCAgICAgICRhdHRycy5uZ1RyYW5zY2x1ZGUgPSAnJztcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBuZ1RyYW5zY2x1ZGVDbG9uZUF0dGFjaEZuKGNsb25lKSB7XG5cdCAgICAgIGlmIChjbG9uZS5sZW5ndGgpIHtcblx0ICAgICAgICAkZWxlbWVudC5lbXB0eSgpO1xuXHQgICAgICAgICRlbGVtZW50LmFwcGVuZChjbG9uZSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBpZiAoISR0cmFuc2NsdWRlKSB7XG5cdCAgICAgIHRocm93IG5nVHJhbnNjbHVkZU1pbkVycignb3JwaGFuJyxcblx0ICAgICAgICdJbGxlZ2FsIHVzZSBvZiBuZ1RyYW5zY2x1ZGUgZGlyZWN0aXZlIGluIHRoZSB0ZW1wbGF0ZSEgJyArXG5cdCAgICAgICAnTm8gcGFyZW50IGRpcmVjdGl2ZSB0aGF0IHJlcXVpcmVzIGEgdHJhbnNjbHVzaW9uIGZvdW5kLiAnICtcblx0ICAgICAgICdFbGVtZW50OiB7MH0nLFxuXHQgICAgICAgc3RhcnRpbmdUYWcoJGVsZW1lbnQpKTtcblx0ICAgIH1cblx0XG5cdCAgICAvLyBJZiB0aGVyZSBpcyBubyBzbG90IG5hbWUgZGVmaW5lZCBvciB0aGUgc2xvdCBuYW1lIGlzIG5vdCBvcHRpb25hbFxuXHQgICAgLy8gdGhlbiB0cmFuc2NsdWRlIHRoZSBzbG90XG5cdCAgICB2YXIgc2xvdE5hbWUgPSAkYXR0cnMubmdUcmFuc2NsdWRlIHx8ICRhdHRycy5uZ1RyYW5zY2x1ZGVTbG90O1xuXHQgICAgJHRyYW5zY2x1ZGUobmdUcmFuc2NsdWRlQ2xvbmVBdHRhY2hGbiwgbnVsbCwgc2xvdE5hbWUpO1xuXHQgIH1cblx0fSk7XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBzY3JpcHRcblx0ICogQHJlc3RyaWN0IEVcblx0ICpcblx0ICogQGRlc2NyaXB0aW9uXG5cdCAqIExvYWQgdGhlIGNvbnRlbnQgb2YgYSBgPHNjcmlwdD5gIGVsZW1lbnQgaW50byB7QGxpbmsgbmcuJHRlbXBsYXRlQ2FjaGUgYCR0ZW1wbGF0ZUNhY2hlYH0sIHNvIHRoYXQgdGhlXG5cdCAqIHRlbXBsYXRlIGNhbiBiZSB1c2VkIGJ5IHtAbGluayBuZy5kaXJlY3RpdmU6bmdJbmNsdWRlIGBuZ0luY2x1ZGVgfSxcblx0ICoge0BsaW5rIG5nUm91dGUuZGlyZWN0aXZlOm5nVmlldyBgbmdWaWV3YH0sIG9yIHtAbGluayBndWlkZS9kaXJlY3RpdmUgZGlyZWN0aXZlc30uIFRoZSB0eXBlIG9mIHRoZVxuXHQgKiBgPHNjcmlwdD5gIGVsZW1lbnQgbXVzdCBiZSBzcGVjaWZpZWQgYXMgYHRleHQvbmctdGVtcGxhdGVgLCBhbmQgYSBjYWNoZSBuYW1lIGZvciB0aGUgdGVtcGxhdGUgbXVzdCBiZVxuXHQgKiBhc3NpZ25lZCB0aHJvdWdoIHRoZSBlbGVtZW50J3MgYGlkYCwgd2hpY2ggY2FuIHRoZW4gYmUgdXNlZCBhcyBhIGRpcmVjdGl2ZSdzIGB0ZW1wbGF0ZVVybGAuXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIE11c3QgYmUgc2V0IHRvIGAndGV4dC9uZy10ZW1wbGF0ZSdgLlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgQ2FjaGUgbmFtZSBvZiB0aGUgdGVtcGxhdGUuXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAgPGV4YW1wbGU+XG5cdCAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgICAgICA8c2NyaXB0IHR5cGU9XCJ0ZXh0L25nLXRlbXBsYXRlXCIgaWQ9XCIvdHBsLmh0bWxcIj5cblx0ICAgICAgICBDb250ZW50IG9mIHRoZSB0ZW1wbGF0ZS5cblx0ICAgICAgPC9zY3JpcHQ+XG5cdFxuXHQgICAgICA8YSBuZy1jbGljaz1cImN1cnJlbnRUcGw9Jy90cGwuaHRtbCdcIiBpZD1cInRwbC1saW5rXCI+TG9hZCBpbmxpbmVkIHRlbXBsYXRlPC9hPlxuXHQgICAgICA8ZGl2IGlkPVwidHBsLWNvbnRlbnRcIiBuZy1pbmNsdWRlIHNyYz1cImN1cnJlbnRUcGxcIj48L2Rpdj5cblx0ICAgIDwvZmlsZT5cblx0ICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgaXQoJ3Nob3VsZCBsb2FkIHRlbXBsYXRlIGRlZmluZWQgaW5zaWRlIHNjcmlwdCB0YWcnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBlbGVtZW50KGJ5LmNzcygnI3RwbC1saW5rJykpLmNsaWNrKCk7XG5cdCAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuY3NzKCcjdHBsLWNvbnRlbnQnKSkuZ2V0VGV4dCgpKS50b01hdGNoKC9Db250ZW50IG9mIHRoZSB0ZW1wbGF0ZS8pO1xuXHQgICAgICB9KTtcblx0ICAgIDwvZmlsZT5cblx0ICA8L2V4YW1wbGU+XG5cdCAqL1xuXHR2YXIgc2NyaXB0RGlyZWN0aXZlID0gWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uKCR0ZW1wbGF0ZUNhY2hlKSB7XG5cdCAgcmV0dXJuIHtcblx0ICAgIHJlc3RyaWN0OiAnRScsXG5cdCAgICB0ZXJtaW5hbDogdHJ1ZSxcblx0ICAgIGNvbXBpbGU6IGZ1bmN0aW9uKGVsZW1lbnQsIGF0dHIpIHtcblx0ICAgICAgaWYgKGF0dHIudHlwZSA9PSAndGV4dC9uZy10ZW1wbGF0ZScpIHtcblx0ICAgICAgICB2YXIgdGVtcGxhdGVVcmwgPSBhdHRyLmlkLFxuXHQgICAgICAgICAgICB0ZXh0ID0gZWxlbWVudFswXS50ZXh0O1xuXHRcblx0ICAgICAgICAkdGVtcGxhdGVDYWNoZS5wdXQodGVtcGxhdGVVcmwsIHRleHQpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfTtcblx0fV07XG5cdFxuXHR2YXIgbm9vcE5nTW9kZWxDb250cm9sbGVyID0geyAkc2V0Vmlld1ZhbHVlOiBub29wLCAkcmVuZGVyOiBub29wIH07XG5cdFxuXHRmdW5jdGlvbiBjaHJvbWVIYWNrKG9wdGlvbkVsZW1lbnQpIHtcblx0ICAvLyBXb3JrYXJvdW5kIGZvciBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MzgxNDU5XG5cdCAgLy8gQWRkaW5nIGFuIDxvcHRpb24gc2VsZWN0ZWQ9XCJzZWxlY3RlZFwiPiBlbGVtZW50IHRvIGEgPHNlbGVjdCByZXF1aXJlZD1cInJlcXVpcmVkXCI+IHNob3VsZFxuXHQgIC8vIGF1dG9tYXRpY2FsbHkgc2VsZWN0IHRoZSBuZXcgZWxlbWVudFxuXHQgIGlmIChvcHRpb25FbGVtZW50WzBdLmhhc0F0dHJpYnV0ZSgnc2VsZWN0ZWQnKSkge1xuXHQgICAgb3B0aW9uRWxlbWVudFswXS5zZWxlY3RlZCA9IHRydWU7XG5cdCAgfVxuXHR9XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIHR5cGVcblx0ICogQG5hbWUgIHNlbGVjdC5TZWxlY3RDb250cm9sbGVyXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBUaGUgY29udHJvbGxlciBmb3IgdGhlIGA8c2VsZWN0PmAgZGlyZWN0aXZlLiBUaGlzIHByb3ZpZGVzIHN1cHBvcnQgZm9yIHJlYWRpbmdcblx0ICogYW5kIHdyaXRpbmcgdGhlIHNlbGVjdGVkIHZhbHVlKHMpIG9mIHRoZSBjb250cm9sIGFuZCBhbHNvIGNvb3JkaW5hdGVzIGR5bmFtaWNhbGx5XG5cdCAqIGFkZGVkIGA8b3B0aW9uPmAgZWxlbWVudHMsIHBlcmhhcHMgYnkgYW4gYG5nUmVwZWF0YCBkaXJlY3RpdmUuXG5cdCAqL1xuXHR2YXIgU2VsZWN0Q29udHJvbGxlciA9XG5cdCAgICAgICAgWyckZWxlbWVudCcsICckc2NvcGUnLCAnJGF0dHJzJywgZnVuY3Rpb24oJGVsZW1lbnQsICRzY29wZSwgJGF0dHJzKSB7XG5cdFxuXHQgIHZhciBzZWxmID0gdGhpcyxcblx0ICAgICAgb3B0aW9uc01hcCA9IG5ldyBIYXNoTWFwKCk7XG5cdFxuXHQgIC8vIElmIHRoZSBuZ01vZGVsIGRvZXNuJ3QgZ2V0IHByb3ZpZGVkIHRoZW4gcHJvdmlkZSBhIGR1bW15IG5vb3AgdmVyc2lvbiB0byBwcmV2ZW50IGVycm9yc1xuXHQgIHNlbGYubmdNb2RlbEN0cmwgPSBub29wTmdNb2RlbENvbnRyb2xsZXI7XG5cdFxuXHQgIC8vIFRoZSBcInVua25vd25cIiBvcHRpb24gaXMgb25lIHRoYXQgaXMgcHJlcGVuZGVkIHRvIHRoZSBsaXN0IGlmIHRoZSB2aWV3VmFsdWVcblx0ICAvLyBkb2VzIG5vdCBtYXRjaCBhbnkgb2YgdGhlIG9wdGlvbnMuIFdoZW4gaXQgaXMgcmVuZGVyZWQgdGhlIHZhbHVlIG9mIHRoZSB1bmtub3duXG5cdCAgLy8gb3B0aW9uIGlzICc/IFhYWCA/JyB3aGVyZSBYWFggaXMgdGhlIGhhc2hLZXkgb2YgdGhlIHZhbHVlIHRoYXQgaXMgbm90IGtub3duLlxuXHQgIC8vXG5cdCAgLy8gV2UgY2FuJ3QganVzdCBqcUxpdGUoJzxvcHRpb24+Jykgc2luY2UganFMaXRlIGlzIG5vdCBzbWFydCBlbm91Z2hcblx0ICAvLyB0byBjcmVhdGUgaXQgaW4gPHNlbGVjdD4gYW5kIElFIGJhcmZzIG90aGVyd2lzZS5cblx0ICBzZWxmLnVua25vd25PcHRpb24gPSBqcUxpdGUoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJykpO1xuXHQgIHNlbGYucmVuZGVyVW5rbm93bk9wdGlvbiA9IGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgdmFyIHVua25vd25WYWwgPSAnPyAnICsgaGFzaEtleSh2YWwpICsgJyA/Jztcblx0ICAgIHNlbGYudW5rbm93bk9wdGlvbi52YWwodW5rbm93blZhbCk7XG5cdCAgICAkZWxlbWVudC5wcmVwZW5kKHNlbGYudW5rbm93bk9wdGlvbik7XG5cdCAgICAkZWxlbWVudC52YWwodW5rbm93blZhbCk7XG5cdCAgfTtcblx0XG5cdCAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcblx0ICAgIC8vIGRpc2FibGUgdW5rbm93biBvcHRpb24gc28gdGhhdCB3ZSBkb24ndCBkbyB3b3JrIHdoZW4gdGhlIHdob2xlIHNlbGVjdCBpcyBiZWluZyBkZXN0cm95ZWRcblx0ICAgIHNlbGYucmVuZGVyVW5rbm93bk9wdGlvbiA9IG5vb3A7XG5cdCAgfSk7XG5cdFxuXHQgIHNlbGYucmVtb3ZlVW5rbm93bk9wdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHQgICAgaWYgKHNlbGYudW5rbm93bk9wdGlvbi5wYXJlbnQoKSkgc2VsZi51bmtub3duT3B0aW9uLnJlbW92ZSgpO1xuXHQgIH07XG5cdFxuXHRcblx0ICAvLyBSZWFkIHRoZSB2YWx1ZSBvZiB0aGUgc2VsZWN0IGNvbnRyb2wsIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIGNoYW5nZXMgZGVwZW5kaW5nXG5cdCAgLy8gdXBvbiB3aGV0aGVyIHRoZSBzZWxlY3QgY2FuIGhhdmUgbXVsdGlwbGUgdmFsdWVzIGFuZCB3aGV0aGVyIG5nT3B0aW9ucyBpcyBhdCB3b3JrLlxuXHQgIHNlbGYucmVhZFZhbHVlID0gZnVuY3Rpb24gcmVhZFNpbmdsZVZhbHVlKCkge1xuXHQgICAgc2VsZi5yZW1vdmVVbmtub3duT3B0aW9uKCk7XG5cdCAgICByZXR1cm4gJGVsZW1lbnQudmFsKCk7XG5cdCAgfTtcblx0XG5cdFxuXHQgIC8vIFdyaXRlIHRoZSB2YWx1ZSB0byB0aGUgc2VsZWN0IGNvbnRyb2wsIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIGNoYW5nZXMgZGVwZW5kaW5nXG5cdCAgLy8gdXBvbiB3aGV0aGVyIHRoZSBzZWxlY3QgY2FuIGhhdmUgbXVsdGlwbGUgdmFsdWVzIGFuZCB3aGV0aGVyIG5nT3B0aW9ucyBpcyBhdCB3b3JrLlxuXHQgIHNlbGYud3JpdGVWYWx1ZSA9IGZ1bmN0aW9uIHdyaXRlU2luZ2xlVmFsdWUodmFsdWUpIHtcblx0ICAgIGlmIChzZWxmLmhhc09wdGlvbih2YWx1ZSkpIHtcblx0ICAgICAgc2VsZi5yZW1vdmVVbmtub3duT3B0aW9uKCk7XG5cdCAgICAgICRlbGVtZW50LnZhbCh2YWx1ZSk7XG5cdCAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHNlbGYuZW1wdHlPcHRpb24ucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTsgLy8gdG8gbWFrZSBJRTkgaGFwcHlcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGlmICh2YWx1ZSA9PSBudWxsICYmIHNlbGYuZW1wdHlPcHRpb24pIHtcblx0ICAgICAgICBzZWxmLnJlbW92ZVVua25vd25PcHRpb24oKTtcblx0ICAgICAgICAkZWxlbWVudC52YWwoJycpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHNlbGYucmVuZGVyVW5rbm93bk9wdGlvbih2YWx1ZSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9O1xuXHRcblx0XG5cdCAgLy8gVGVsbCB0aGUgc2VsZWN0IGNvbnRyb2wgdGhhdCBhbiBvcHRpb24sIHdpdGggdGhlIGdpdmVuIHZhbHVlLCBoYXMgYmVlbiBhZGRlZFxuXHQgIHNlbGYuYWRkT3B0aW9uID0gZnVuY3Rpb24odmFsdWUsIGVsZW1lbnQpIHtcblx0ICAgIC8vIFNraXAgY29tbWVudCBub2RlcywgYXMgdGhleSBvbmx5IHBvbGx1dGUgdGhlIGBvcHRpb25zTWFwYFxuXHQgICAgaWYgKGVsZW1lbnRbMF0ubm9kZVR5cGUgPT09IE5PREVfVFlQRV9DT01NRU5UKSByZXR1cm47XG5cdFxuXHQgICAgYXNzZXJ0Tm90SGFzT3duUHJvcGVydHkodmFsdWUsICdcIm9wdGlvbiB2YWx1ZVwiJyk7XG5cdCAgICBpZiAodmFsdWUgPT09ICcnKSB7XG5cdCAgICAgIHNlbGYuZW1wdHlPcHRpb24gPSBlbGVtZW50O1xuXHQgICAgfVxuXHQgICAgdmFyIGNvdW50ID0gb3B0aW9uc01hcC5nZXQodmFsdWUpIHx8IDA7XG5cdCAgICBvcHRpb25zTWFwLnB1dCh2YWx1ZSwgY291bnQgKyAxKTtcblx0ICAgIHNlbGYubmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuXHQgICAgY2hyb21lSGFjayhlbGVtZW50KTtcblx0ICB9O1xuXHRcblx0ICAvLyBUZWxsIHRoZSBzZWxlY3QgY29udHJvbCB0aGF0IGFuIG9wdGlvbiwgd2l0aCB0aGUgZ2l2ZW4gdmFsdWUsIGhhcyBiZWVuIHJlbW92ZWRcblx0ICBzZWxmLnJlbW92ZU9wdGlvbiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICB2YXIgY291bnQgPSBvcHRpb25zTWFwLmdldCh2YWx1ZSk7XG5cdCAgICBpZiAoY291bnQpIHtcblx0ICAgICAgaWYgKGNvdW50ID09PSAxKSB7XG5cdCAgICAgICAgb3B0aW9uc01hcC5yZW1vdmUodmFsdWUpO1xuXHQgICAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHtcblx0ICAgICAgICAgIHNlbGYuZW1wdHlPcHRpb24gPSB1bmRlZmluZWQ7XG5cdCAgICAgICAgfVxuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIG9wdGlvbnNNYXAucHV0KHZhbHVlLCBjb3VudCAtIDEpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLy8gQ2hlY2sgd2hldGhlciB0aGUgc2VsZWN0IGNvbnRyb2wgaGFzIGFuIG9wdGlvbiBtYXRjaGluZyB0aGUgZ2l2ZW4gdmFsdWVcblx0ICBzZWxmLmhhc09wdGlvbiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICByZXR1cm4gISFvcHRpb25zTWFwLmdldCh2YWx1ZSk7XG5cdCAgfTtcblx0XG5cdFxuXHQgIHNlbGYucmVnaXN0ZXJPcHRpb24gPSBmdW5jdGlvbihvcHRpb25TY29wZSwgb3B0aW9uRWxlbWVudCwgb3B0aW9uQXR0cnMsIGludGVycG9sYXRlVmFsdWVGbiwgaW50ZXJwb2xhdGVUZXh0Rm4pIHtcblx0XG5cdCAgICBpZiAoaW50ZXJwb2xhdGVWYWx1ZUZuKSB7XG5cdCAgICAgIC8vIFRoZSB2YWx1ZSBhdHRyaWJ1dGUgaXMgaW50ZXJwb2xhdGVkXG5cdCAgICAgIHZhciBvbGRWYWw7XG5cdCAgICAgIG9wdGlvbkF0dHJzLiRvYnNlcnZlKCd2YWx1ZScsIGZ1bmN0aW9uIHZhbHVlQXR0cmlidXRlT2JzZXJ2ZUFjdGlvbihuZXdWYWwpIHtcblx0ICAgICAgICBpZiAoaXNEZWZpbmVkKG9sZFZhbCkpIHtcblx0ICAgICAgICAgIHNlbGYucmVtb3ZlT3B0aW9uKG9sZFZhbCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIG9sZFZhbCA9IG5ld1ZhbDtcblx0ICAgICAgICBzZWxmLmFkZE9wdGlvbihuZXdWYWwsIG9wdGlvbkVsZW1lbnQpO1xuXHQgICAgICB9KTtcblx0ICAgIH0gZWxzZSBpZiAoaW50ZXJwb2xhdGVUZXh0Rm4pIHtcblx0ICAgICAgLy8gVGhlIHRleHQgY29udGVudCBpcyBpbnRlcnBvbGF0ZWRcblx0ICAgICAgb3B0aW9uU2NvcGUuJHdhdGNoKGludGVycG9sYXRlVGV4dEZuLCBmdW5jdGlvbiBpbnRlcnBvbGF0ZVdhdGNoQWN0aW9uKG5ld1ZhbCwgb2xkVmFsKSB7XG5cdCAgICAgICAgb3B0aW9uQXR0cnMuJHNldCgndmFsdWUnLCBuZXdWYWwpO1xuXHQgICAgICAgIGlmIChvbGRWYWwgIT09IG5ld1ZhbCkge1xuXHQgICAgICAgICAgc2VsZi5yZW1vdmVPcHRpb24ob2xkVmFsKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgc2VsZi5hZGRPcHRpb24obmV3VmFsLCBvcHRpb25FbGVtZW50KTtcblx0ICAgICAgfSk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICAvLyBUaGUgdmFsdWUgYXR0cmlidXRlIGlzIHN0YXRpY1xuXHQgICAgICBzZWxmLmFkZE9wdGlvbihvcHRpb25BdHRycy52YWx1ZSwgb3B0aW9uRWxlbWVudCk7XG5cdCAgICB9XG5cdFxuXHQgICAgb3B0aW9uRWxlbWVudC5vbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcblx0ICAgICAgc2VsZi5yZW1vdmVPcHRpb24ob3B0aW9uQXR0cnMudmFsdWUpO1xuXHQgICAgICBzZWxmLm5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcblx0ICAgIH0pO1xuXHQgIH07XG5cdH1dO1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgc2VsZWN0XG5cdCAqIEByZXN0cmljdCBFXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKiBIVE1MIGBTRUxFQ1RgIGVsZW1lbnQgd2l0aCBhbmd1bGFyIGRhdGEtYmluZGluZy5cblx0ICpcblx0ICogVGhlIGBzZWxlY3RgIGRpcmVjdGl2ZSBpcyB1c2VkIHRvZ2V0aGVyIHdpdGgge0BsaW5rIG5nTW9kZWwgYG5nTW9kZWxgfSB0byBwcm92aWRlIGRhdGEtYmluZGluZ1xuXHQgKiBiZXR3ZWVuIHRoZSBzY29wZSBhbmQgdGhlIGA8c2VsZWN0PmAgY29udHJvbCAoaW5jbHVkaW5nIHNldHRpbmcgZGVmYXVsdCB2YWx1ZXMpLlxuXHQgKiBJdCBhbHNvIGhhbmRsZXMgZHluYW1pYyBgPG9wdGlvbj5gIGVsZW1lbnRzLCB3aGljaCBjYW4gYmUgYWRkZWQgdXNpbmcgdGhlIHtAbGluayBuZ1JlcGVhdCBgbmdSZXBlYXR9YCBvclxuXHQgKiB7QGxpbmsgbmdPcHRpb25zIGBuZ09wdGlvbnNgfSBkaXJlY3RpdmVzLlxuXHQgKlxuXHQgKiBXaGVuIGFuIGl0ZW0gaW4gdGhlIGA8c2VsZWN0PmAgbWVudSBpcyBzZWxlY3RlZCwgdGhlIHZhbHVlIG9mIHRoZSBzZWxlY3RlZCBvcHRpb24gd2lsbCBiZSBib3VuZFxuXHQgKiB0byB0aGUgbW9kZWwgaWRlbnRpZmllZCBieSB0aGUgYG5nTW9kZWxgIGRpcmVjdGl2ZS4gV2l0aCBzdGF0aWMgb3IgcmVwZWF0ZWQgb3B0aW9ucywgdGhpcyBpc1xuXHQgKiB0aGUgY29udGVudCBvZiB0aGUgYHZhbHVlYCBhdHRyaWJ1dGUgb3IgdGhlIHRleHRDb250ZW50IG9mIHRoZSBgPG9wdGlvbj5gLCBpZiB0aGUgdmFsdWUgYXR0cmlidXRlIGlzIG1pc3NpbmcuXG5cdCAqIElmIHlvdSB3YW50IGR5bmFtaWMgdmFsdWUgYXR0cmlidXRlcywgeW91IGNhbiB1c2UgaW50ZXJwb2xhdGlvbiBpbnNpZGUgdGhlIHZhbHVlIGF0dHJpYnV0ZS5cblx0ICpcblx0ICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cblx0ICogTm90ZSB0aGF0IHRoZSB2YWx1ZSBvZiBhIGBzZWxlY3RgIGRpcmVjdGl2ZSB1c2VkIHdpdGhvdXQgYG5nT3B0aW9uc2AgaXMgYWx3YXlzIGEgc3RyaW5nLlxuXHQgKiBXaGVuIHRoZSBtb2RlbCBuZWVkcyB0byBiZSBib3VuZCB0byBhIG5vbi1zdHJpbmcgdmFsdWUsIHlvdSBtdXN0IGVpdGhlciBleHBsaWNpdGx5IGNvbnZlcnQgaXRcblx0ICogdXNpbmcgYSBkaXJlY3RpdmUgKHNlZSBleGFtcGxlIGJlbG93KSBvciB1c2UgYG5nT3B0aW9uc2AgdG8gc3BlY2lmeSB0aGUgc2V0IG9mIG9wdGlvbnMuXG5cdCAqIFRoaXMgaXMgYmVjYXVzZSBhbiBvcHRpb24gZWxlbWVudCBjYW4gb25seSBiZSBib3VuZCB0byBzdHJpbmcgdmFsdWVzIGF0IHByZXNlbnQuXG5cdCAqIDwvZGl2PlxuXHQgKlxuXHQgKiBJZiB0aGUgdmlld1ZhbHVlIG9mIGBuZ01vZGVsYCBkb2VzIG5vdCBtYXRjaCBhbnkgb2YgdGhlIG9wdGlvbnMsIHRoZW4gdGhlIGNvbnRyb2xcblx0ICogd2lsbCBhdXRvbWF0aWNhbGx5IGFkZCBhbiBcInVua25vd25cIiBvcHRpb24sIHdoaWNoIGl0IHRoZW4gcmVtb3ZlcyB3aGVuIHRoZSBtaXNtYXRjaCBpcyByZXNvbHZlZC5cblx0ICpcblx0ICogT3B0aW9uYWxseSwgYSBzaW5nbGUgaGFyZC1jb2RlZCBgPG9wdGlvbj5gIGVsZW1lbnQsIHdpdGggdGhlIHZhbHVlIHNldCB0byBhbiBlbXB0eSBzdHJpbmcsIGNhblxuXHQgKiBiZSBuZXN0ZWQgaW50byB0aGUgYDxzZWxlY3Q+YCBlbGVtZW50LiBUaGlzIGVsZW1lbnQgd2lsbCB0aGVuIHJlcHJlc2VudCB0aGUgYG51bGxgIG9yIFwibm90IHNlbGVjdGVkXCJcblx0ICogb3B0aW9uLiBTZWUgZXhhbXBsZSBiZWxvdyBmb3IgZGVtb25zdHJhdGlvbi5cblx0ICpcblx0ICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWluZm9cIj5cblx0ICogSW4gbWFueSBjYXNlcywgYG5nUmVwZWF0YCBjYW4gYmUgdXNlZCBvbiBgPG9wdGlvbj5gIGVsZW1lbnRzIGluc3RlYWQgb2Yge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ09wdGlvbnNcblx0ICogbmdPcHRpb25zfSB0byBhY2hpZXZlIGEgc2ltaWxhciByZXN1bHQuIEhvd2V2ZXIsIGBuZ09wdGlvbnNgIHByb3ZpZGVzIHNvbWUgYmVuZWZpdHMsIHN1Y2ggYXNcblx0ICogbW9yZSBmbGV4aWJpbGl0eSBpbiBob3cgdGhlIGA8c2VsZWN0PmAncyBtb2RlbCBpcyBhc3NpZ25lZCB2aWEgdGhlIGBzZWxlY3RgICoqYGFzYCoqIHBhcnQgb2YgdGhlXG5cdCAqIGNvbXByZWhlbnNpb24gZXhwcmVzc2lvbiwgYW5kIGFkZGl0aW9uYWxseSBpbiByZWR1Y2luZyBtZW1vcnkgYW5kIGluY3JlYXNpbmcgc3BlZWQgYnkgbm90IGNyZWF0aW5nXG5cdCAqIGEgbmV3IHNjb3BlIGZvciBlYWNoIHJlcGVhdGVkIGluc3RhbmNlLlxuXHQgKiA8L2Rpdj5cblx0ICpcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG5cdCAqIEBwYXJhbSB7c3RyaW5nPX0gbXVsdGlwbGUgQWxsb3dzIG11bHRpcGxlIG9wdGlvbnMgdG8gYmUgc2VsZWN0ZWQuIFRoZSBzZWxlY3RlZCB2YWx1ZXMgd2lsbCBiZVxuXHQgKiAgICAgYm91bmQgdG8gdGhlIG1vZGVsIGFzIGFuIGFycmF5LlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG5cdCAqIEBwYXJhbSB7c3RyaW5nPX0gbmdSZXF1aXJlZCBBZGRzIHJlcXVpcmVkIGF0dHJpYnV0ZSBhbmQgcmVxdWlyZWQgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvXG5cdCAqIHRoZSBlbGVtZW50IHdoZW4gdGhlIG5nUmVxdWlyZWQgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gdHJ1ZS4gVXNlIG5nUmVxdWlyZWQgaW5zdGVhZCBvZiByZXF1aXJlZFxuXHQgKiB3aGVuIHlvdSB3YW50IHRvIGRhdGEtYmluZCB0byB0aGUgcmVxdWlyZWQgYXR0cmlidXRlLlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIHNlbGVjdGVkIG9wdGlvbihzKSBjaGFuZ2VzIGR1ZSB0byB1c2VyXG5cdCAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIHNlbGVjdCBlbGVtZW50LlxuXHQgKiBAcGFyYW0ge3N0cmluZz19IG5nT3B0aW9ucyBzZXRzIHRoZSBvcHRpb25zIHRoYXQgdGhlIHNlbGVjdCBpcyBwb3B1bGF0ZWQgd2l0aCBhbmQgZGVmaW5lcyB3aGF0IGlzXG5cdCAqIHNldCBvbiB0aGUgbW9kZWwgb24gc2VsZWN0aW9uLiBTZWUge0BsaW5rIG5nT3B0aW9ucyBgbmdPcHRpb25zYH0uXG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqICMjIyBTaW1wbGUgYHNlbGVjdGAgZWxlbWVudHMgd2l0aCBzdGF0aWMgb3B0aW9uc1xuXHQgKlxuXHQgKiA8ZXhhbXBsZSBuYW1lPVwic3RhdGljLXNlbGVjdFwiIG1vZHVsZT1cInN0YXRpY1NlbGVjdFwiPlxuXHQgKiA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgKiA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgKiAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIj5cblx0ICogICAgIDxsYWJlbCBmb3I9XCJzaW5nbGVTZWxlY3RcIj4gU2luZ2xlIHNlbGVjdDogPC9sYWJlbD48YnI+XG5cdCAqICAgICA8c2VsZWN0IG5hbWU9XCJzaW5nbGVTZWxlY3RcIiBuZy1tb2RlbD1cImRhdGEuc2luZ2xlU2VsZWN0XCI+XG5cdCAqICAgICAgIDxvcHRpb24gdmFsdWU9XCJvcHRpb24tMVwiPk9wdGlvbiAxPC9vcHRpb24+XG5cdCAqICAgICAgIDxvcHRpb24gdmFsdWU9XCJvcHRpb24tMlwiPk9wdGlvbiAyPC9vcHRpb24+XG5cdCAqICAgICA8L3NlbGVjdD48YnI+XG5cdCAqXG5cdCAqICAgICA8bGFiZWwgZm9yPVwic2luZ2xlU2VsZWN0XCI+IFNpbmdsZSBzZWxlY3Qgd2l0aCBcIm5vdCBzZWxlY3RlZFwiIG9wdGlvbiBhbmQgZHluYW1pYyBvcHRpb24gdmFsdWVzOiA8L2xhYmVsPjxicj5cblx0ICogICAgIDxzZWxlY3QgbmFtZT1cInNpbmdsZVNlbGVjdFwiIGlkPVwic2luZ2xlU2VsZWN0XCIgbmctbW9kZWw9XCJkYXRhLnNpbmdsZVNlbGVjdFwiPlxuXHQgKiAgICAgICA8b3B0aW9uIHZhbHVlPVwiXCI+LS0tUGxlYXNlIHNlbGVjdC0tLTwvb3B0aW9uPiA8IS0tIG5vdCBzZWxlY3RlZCAvIGJsYW5rIG9wdGlvbiAtLT5cblx0ICogICAgICAgPG9wdGlvbiB2YWx1ZT1cInt7ZGF0YS5vcHRpb24xfX1cIj5PcHRpb24gMTwvb3B0aW9uPiA8IS0tIGludGVycG9sYXRpb24gLS0+XG5cdCAqICAgICAgIDxvcHRpb24gdmFsdWU9XCJvcHRpb24tMlwiPk9wdGlvbiAyPC9vcHRpb24+XG5cdCAqICAgICA8L3NlbGVjdD48YnI+XG5cdCAqICAgICA8YnV0dG9uIG5nLWNsaWNrPVwiZm9yY2VVbmtub3duT3B0aW9uKClcIj5Gb3JjZSB1bmtub3duIG9wdGlvbjwvYnV0dG9uPjxicj5cblx0ICogICAgIDx0dD5zaW5nbGVTZWxlY3QgPSB7e2RhdGEuc2luZ2xlU2VsZWN0fX08L3R0PlxuXHQgKlxuXHQgKiAgICAgPGhyPlxuXHQgKiAgICAgPGxhYmVsIGZvcj1cIm11bHRpcGxlU2VsZWN0XCI+IE11bHRpcGxlIHNlbGVjdDogPC9sYWJlbD48YnI+XG5cdCAqICAgICA8c2VsZWN0IG5hbWU9XCJtdWx0aXBsZVNlbGVjdFwiIGlkPVwibXVsdGlwbGVTZWxlY3RcIiBuZy1tb2RlbD1cImRhdGEubXVsdGlwbGVTZWxlY3RcIiBtdWx0aXBsZT5cblx0ICogICAgICAgPG9wdGlvbiB2YWx1ZT1cIm9wdGlvbi0xXCI+T3B0aW9uIDE8L29wdGlvbj5cblx0ICogICAgICAgPG9wdGlvbiB2YWx1ZT1cIm9wdGlvbi0yXCI+T3B0aW9uIDI8L29wdGlvbj5cblx0ICogICAgICAgPG9wdGlvbiB2YWx1ZT1cIm9wdGlvbi0zXCI+T3B0aW9uIDM8L29wdGlvbj5cblx0ICogICAgIDwvc2VsZWN0Pjxicj5cblx0ICogICAgIDx0dD5tdWx0aXBsZVNlbGVjdCA9IHt7ZGF0YS5tdWx0aXBsZVNlbGVjdH19PC90dD48YnIvPlxuXHQgKiAgIDwvZm9ybT5cblx0ICogPC9kaXY+XG5cdCAqIDwvZmlsZT5cblx0ICogPGZpbGUgbmFtZT1cImFwcC5qc1wiPlxuXHQgKiAgYW5ndWxhci5tb2R1bGUoJ3N0YXRpY1NlbGVjdCcsIFtdKVxuXHQgKiAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgKiAgICAgICRzY29wZS5kYXRhID0ge1xuXHQgKiAgICAgICBzaW5nbGVTZWxlY3Q6IG51bGwsXG5cdCAqICAgICAgIG11bHRpcGxlU2VsZWN0OiBbXSxcblx0ICogICAgICAgb3B0aW9uMTogJ29wdGlvbi0xJyxcblx0ICogICAgICB9O1xuXHQgKlxuXHQgKiAgICAgICRzY29wZS5mb3JjZVVua25vd25PcHRpb24gPSBmdW5jdGlvbigpIHtcblx0ICogICAgICAgICRzY29wZS5kYXRhLnNpbmdsZVNlbGVjdCA9ICdub25zZW5zZSc7XG5cdCAqICAgICAgfTtcblx0ICogICB9XSk7XG5cdCAqIDwvZmlsZT5cblx0ICo8L2V4YW1wbGU+XG5cdCAqXG5cdCAqICMjIyBVc2luZyBgbmdSZXBlYXRgIHRvIGdlbmVyYXRlIGBzZWxlY3RgIG9wdGlvbnNcblx0ICogPGV4YW1wbGUgbmFtZT1cIm5ncmVwZWF0LXNlbGVjdFwiIG1vZHVsZT1cIm5ncmVwZWF0U2VsZWN0XCI+XG5cdCAqIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAqIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAqICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiPlxuXHQgKiAgICAgPGxhYmVsIGZvcj1cInJlcGVhdFNlbGVjdFwiPiBSZXBlYXQgc2VsZWN0OiA8L2xhYmVsPlxuXHQgKiAgICAgPHNlbGVjdCBuYW1lPVwicmVwZWF0U2VsZWN0XCIgaWQ9XCJyZXBlYXRTZWxlY3RcIiBuZy1tb2RlbD1cImRhdGEucmVwZWF0U2VsZWN0XCI+XG5cdCAqICAgICAgIDxvcHRpb24gbmctcmVwZWF0PVwib3B0aW9uIGluIGRhdGEuYXZhaWxhYmxlT3B0aW9uc1wiIHZhbHVlPVwie3tvcHRpb24uaWR9fVwiPnt7b3B0aW9uLm5hbWV9fTwvb3B0aW9uPlxuXHQgKiAgICAgPC9zZWxlY3Q+XG5cdCAqICAgPC9mb3JtPlxuXHQgKiAgIDxocj5cblx0ICogICA8dHQ+cmVwZWF0U2VsZWN0ID0ge3tkYXRhLnJlcGVhdFNlbGVjdH19PC90dD48YnIvPlxuXHQgKiA8L2Rpdj5cblx0ICogPC9maWxlPlxuXHQgKiA8ZmlsZSBuYW1lPVwiYXBwLmpzXCI+XG5cdCAqICBhbmd1bGFyLm1vZHVsZSgnbmdyZXBlYXRTZWxlY3QnLCBbXSlcblx0ICogICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICogICAgICAkc2NvcGUuZGF0YSA9IHtcblx0ICogICAgICAgcmVwZWF0U2VsZWN0OiBudWxsLFxuXHQgKiAgICAgICBhdmFpbGFibGVPcHRpb25zOiBbXG5cdCAqICAgICAgICAge2lkOiAnMScsIG5hbWU6ICdPcHRpb24gQSd9LFxuXHQgKiAgICAgICAgIHtpZDogJzInLCBuYW1lOiAnT3B0aW9uIEInfSxcblx0ICogICAgICAgICB7aWQ6ICczJywgbmFtZTogJ09wdGlvbiBDJ31cblx0ICogICAgICAgXSxcblx0ICogICAgICB9O1xuXHQgKiAgIH1dKTtcblx0ICogPC9maWxlPlxuXHQgKjwvZXhhbXBsZT5cblx0ICpcblx0ICpcblx0ICogIyMjIFVzaW5nIGBzZWxlY3RgIHdpdGggYG5nT3B0aW9uc2AgYW5kIHNldHRpbmcgYSBkZWZhdWx0IHZhbHVlXG5cdCAqIFNlZSB0aGUge0BsaW5rIG5nT3B0aW9ucyBuZ09wdGlvbnMgZG9jdW1lbnRhdGlvbn0gZm9yIG1vcmUgYG5nT3B0aW9uc2AgdXNhZ2UgZXhhbXBsZXMuXG5cdCAqXG5cdCAqIDxleGFtcGxlIG5hbWU9XCJzZWxlY3Qtd2l0aC1kZWZhdWx0LXZhbHVlc1wiIG1vZHVsZT1cImRlZmF1bHRWYWx1ZVNlbGVjdFwiPlxuXHQgKiA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgKiA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuXHQgKiAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIj5cblx0ICogICAgIDxsYWJlbCBmb3I9XCJteVNlbGVjdFwiPk1ha2UgYSBjaG9pY2U6PC9sYWJlbD5cblx0ICogICAgIDxzZWxlY3QgbmFtZT1cIm15U2VsZWN0XCIgaWQ9XCJteVNlbGVjdFwiXG5cdCAqICAgICAgIG5nLW9wdGlvbnM9XCJvcHRpb24ubmFtZSBmb3Igb3B0aW9uIGluIGRhdGEuYXZhaWxhYmxlT3B0aW9ucyB0cmFjayBieSBvcHRpb24uaWRcIlxuXHQgKiAgICAgICBuZy1tb2RlbD1cImRhdGEuc2VsZWN0ZWRPcHRpb25cIj48L3NlbGVjdD5cblx0ICogICA8L2Zvcm0+XG5cdCAqICAgPGhyPlxuXHQgKiAgIDx0dD5vcHRpb24gPSB7e2RhdGEuc2VsZWN0ZWRPcHRpb259fTwvdHQ+PGJyLz5cblx0ICogPC9kaXY+XG5cdCAqIDwvZmlsZT5cblx0ICogPGZpbGUgbmFtZT1cImFwcC5qc1wiPlxuXHQgKiAgYW5ndWxhci5tb2R1bGUoJ2RlZmF1bHRWYWx1ZVNlbGVjdCcsIFtdKVxuXHQgKiAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuXHQgKiAgICAgICRzY29wZS5kYXRhID0ge1xuXHQgKiAgICAgICBhdmFpbGFibGVPcHRpb25zOiBbXG5cdCAqICAgICAgICAge2lkOiAnMScsIG5hbWU6ICdPcHRpb24gQSd9LFxuXHQgKiAgICAgICAgIHtpZDogJzInLCBuYW1lOiAnT3B0aW9uIEInfSxcblx0ICogICAgICAgICB7aWQ6ICczJywgbmFtZTogJ09wdGlvbiBDJ31cblx0ICogICAgICAgXSxcblx0ICogICAgICAgc2VsZWN0ZWRPcHRpb246IHtpZDogJzMnLCBuYW1lOiAnT3B0aW9uIEMnfSAvL1RoaXMgc2V0cyB0aGUgZGVmYXVsdCB2YWx1ZSBvZiB0aGUgc2VsZWN0IGluIHRoZSB1aVxuXHQgKiAgICAgICB9O1xuXHQgKiAgIH1dKTtcblx0ICogPC9maWxlPlxuXHQgKjwvZXhhbXBsZT5cblx0ICpcblx0ICpcblx0ICogIyMjIEJpbmRpbmcgYHNlbGVjdGAgdG8gYSBub24tc3RyaW5nIHZhbHVlIHZpYSBgbmdNb2RlbGAgcGFyc2luZyAvIGZvcm1hdHRpbmdcblx0ICpcblx0ICogPGV4YW1wbGUgbmFtZT1cInNlbGVjdC13aXRoLW5vbi1zdHJpbmctb3B0aW9uc1wiIG1vZHVsZT1cIm5vblN0cmluZ1NlbGVjdFwiPlxuXHQgKiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG5cdCAqICAgICA8c2VsZWN0IG5nLW1vZGVsPVwibW9kZWwuaWRcIiBjb252ZXJ0LXRvLW51bWJlcj5cblx0ICogICAgICAgPG9wdGlvbiB2YWx1ZT1cIjBcIj5aZXJvPC9vcHRpb24+XG5cdCAqICAgICAgIDxvcHRpb24gdmFsdWU9XCIxXCI+T25lPC9vcHRpb24+XG5cdCAqICAgICAgIDxvcHRpb24gdmFsdWU9XCIyXCI+VHdvPC9vcHRpb24+XG5cdCAqICAgICA8L3NlbGVjdD5cblx0ICogICAgIHt7IG1vZGVsIH19XG5cdCAqICAgPC9maWxlPlxuXHQgKiAgIDxmaWxlIG5hbWU9XCJhcHAuanNcIj5cblx0ICogICAgIGFuZ3VsYXIubW9kdWxlKCdub25TdHJpbmdTZWxlY3QnLCBbXSlcblx0ICogICAgICAgLnJ1bihmdW5jdGlvbigkcm9vdFNjb3BlKSB7XG5cdCAqICAgICAgICAgJHJvb3RTY29wZS5tb2RlbCA9IHsgaWQ6IDIgfTtcblx0ICogICAgICAgfSlcblx0ICogICAgICAgLmRpcmVjdGl2ZSgnY29udmVydFRvTnVtYmVyJywgZnVuY3Rpb24oKSB7XG5cdCAqICAgICAgICAgcmV0dXJuIHtcblx0ICogICAgICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcblx0ICogICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbCkge1xuXHQgKiAgICAgICAgICAgICBuZ01vZGVsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24odmFsKSB7XG5cdCAqICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHZhbCwgMTApO1xuXHQgKiAgICAgICAgICAgICB9KTtcblx0ICogICAgICAgICAgICAgbmdNb2RlbC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKHZhbCkge1xuXHQgKiAgICAgICAgICAgICAgIHJldHVybiAnJyArIHZhbDtcblx0ICogICAgICAgICAgICAgfSk7XG5cdCAqICAgICAgICAgICB9XG5cdCAqICAgICAgICAgfTtcblx0ICogICAgICAgfSk7XG5cdCAqICAgPC9maWxlPlxuXHQgKiAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICogICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB0byBtb2RlbCcsIGZ1bmN0aW9uKCkge1xuXHQgKiAgICAgICB2YXIgc2VsZWN0ID0gZWxlbWVudChieS5jc3MoJ3NlbGVjdCcpKTtcblx0ICogICAgICAgZXhwZWN0KGVsZW1lbnQoYnkubW9kZWwoJ21vZGVsLmlkJykpLiQoJ29wdGlvbjpjaGVja2VkJykuZ2V0VGV4dCgpKS50b0VxdWFsKCdUd28nKTtcblx0ICogICAgIH0pO1xuXHQgKiAgIDwvZmlsZT5cblx0ICogPC9leGFtcGxlPlxuXHQgKlxuXHQgKi9cblx0dmFyIHNlbGVjdERpcmVjdGl2ZSA9IGZ1bmN0aW9uKCkge1xuXHRcblx0ICByZXR1cm4ge1xuXHQgICAgcmVzdHJpY3Q6ICdFJyxcblx0ICAgIHJlcXVpcmU6IFsnc2VsZWN0JywgJz9uZ01vZGVsJ10sXG5cdCAgICBjb250cm9sbGVyOiBTZWxlY3RDb250cm9sbGVyLFxuXHQgICAgcHJpb3JpdHk6IDEsXG5cdCAgICBsaW5rOiB7XG5cdCAgICAgIHByZTogc2VsZWN0UHJlTGluayxcblx0ICAgICAgcG9zdDogc2VsZWN0UG9zdExpbmtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBzZWxlY3RQcmVMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJscykge1xuXHRcblx0ICAgICAgLy8gaWYgbmdNb2RlbCBpcyBub3QgZGVmaW5lZCwgd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZ1xuXHQgICAgICB2YXIgbmdNb2RlbEN0cmwgPSBjdHJsc1sxXTtcblx0ICAgICAgaWYgKCFuZ01vZGVsQ3RybCkgcmV0dXJuO1xuXHRcblx0ICAgICAgdmFyIHNlbGVjdEN0cmwgPSBjdHJsc1swXTtcblx0XG5cdCAgICAgIHNlbGVjdEN0cmwubmdNb2RlbEN0cmwgPSBuZ01vZGVsQ3RybDtcblx0XG5cdCAgICAgIC8vIFdoZW4gdGhlIHNlbGVjdGVkIGl0ZW0ocykgY2hhbmdlcyB3ZSBkZWxlZ2F0ZSBnZXR0aW5nIHRoZSB2YWx1ZSBvZiB0aGUgc2VsZWN0IGNvbnRyb2xcblx0ICAgICAgLy8gdG8gdGhlIGByZWFkVmFsdWVgIG1ldGhvZCwgd2hpY2ggY2FuIGJlIGNoYW5nZWQgaWYgdGhlIHNlbGVjdCBjYW4gaGF2ZSBtdWx0aXBsZVxuXHQgICAgICAvLyBzZWxlY3RlZCB2YWx1ZXMgb3IgaWYgdGhlIG9wdGlvbnMgYXJlIGJlaW5nIGdlbmVyYXRlZCBieSBgbmdPcHRpb25zYFxuXHQgICAgICBlbGVtZW50Lm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKHNlbGVjdEN0cmwucmVhZFZhbHVlKCkpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIC8vIElmIHRoZSBzZWxlY3QgYWxsb3dzIG11bHRpcGxlIHZhbHVlcyB0aGVuIHdlIG5lZWQgdG8gbW9kaWZ5IGhvdyB3ZSByZWFkIGFuZCB3cml0ZVxuXHQgICAgICAvLyB2YWx1ZXMgZnJvbSBhbmQgdG8gdGhlIGNvbnRyb2w7IGFsc28gd2hhdCBpdCBtZWFucyBmb3IgdGhlIHZhbHVlIHRvIGJlIGVtcHR5IGFuZFxuXHQgICAgICAvLyB3ZSBoYXZlIHRvIGFkZCBhbiBleHRyYSB3YXRjaCBzaW5jZSBuZ01vZGVsIGRvZXNuJ3Qgd29yayB3ZWxsIHdpdGggYXJyYXlzIC0gaXRcblx0ICAgICAgLy8gZG9lc24ndCB0cmlnZ2VyIHJlbmRlcmluZyBpZiBvbmx5IGFuIGl0ZW0gaW4gdGhlIGFycmF5IGNoYW5nZXMuXG5cdCAgICAgIGlmIChhdHRyLm11bHRpcGxlKSB7XG5cdFxuXHQgICAgICAgIC8vIFJlYWQgdmFsdWUgbm93IG5lZWRzIHRvIGNoZWNrIGVhY2ggb3B0aW9uIHRvIHNlZSBpZiBpdCBpcyBzZWxlY3RlZFxuXHQgICAgICAgIHNlbGVjdEN0cmwucmVhZFZhbHVlID0gZnVuY3Rpb24gcmVhZE11bHRpcGxlVmFsdWUoKSB7XG5cdCAgICAgICAgICB2YXIgYXJyYXkgPSBbXTtcblx0ICAgICAgICAgIGZvckVhY2goZWxlbWVudC5maW5kKCdvcHRpb24nKSwgZnVuY3Rpb24ob3B0aW9uKSB7XG5cdCAgICAgICAgICAgIGlmIChvcHRpb24uc2VsZWN0ZWQpIHtcblx0ICAgICAgICAgICAgICBhcnJheS5wdXNoKG9wdGlvbi52YWx1ZSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgcmV0dXJuIGFycmF5O1xuXHQgICAgICAgIH07XG5cdFxuXHQgICAgICAgIC8vIFdyaXRlIHZhbHVlIG5vdyBuZWVkcyB0byBzZXQgdGhlIHNlbGVjdGVkIHByb3BlcnR5IG9mIGVhY2ggbWF0Y2hpbmcgb3B0aW9uXG5cdCAgICAgICAgc2VsZWN0Q3RybC53cml0ZVZhbHVlID0gZnVuY3Rpb24gd3JpdGVNdWx0aXBsZVZhbHVlKHZhbHVlKSB7XG5cdCAgICAgICAgICB2YXIgaXRlbXMgPSBuZXcgSGFzaE1hcCh2YWx1ZSk7XG5cdCAgICAgICAgICBmb3JFYWNoKGVsZW1lbnQuZmluZCgnb3B0aW9uJyksIGZ1bmN0aW9uKG9wdGlvbikge1xuXHQgICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBpc0RlZmluZWQoaXRlbXMuZ2V0KG9wdGlvbi52YWx1ZSkpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfTtcblx0XG5cdCAgICAgICAgLy8gd2UgaGF2ZSB0byBkbyBpdCBvbiBlYWNoIHdhdGNoIHNpbmNlIG5nTW9kZWwgd2F0Y2hlcyByZWZlcmVuY2UsIGJ1dFxuXHQgICAgICAgIC8vIHdlIG5lZWQgdG8gd29yayBvZiBhbiBhcnJheSwgc28gd2UgbmVlZCB0byBzZWUgaWYgYW55dGhpbmcgd2FzIGluc2VydGVkL3JlbW92ZWRcblx0ICAgICAgICB2YXIgbGFzdFZpZXcsIGxhc3RWaWV3UmVmID0gTmFOO1xuXHQgICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiBzZWxlY3RNdWx0aXBsZVdhdGNoKCkge1xuXHQgICAgICAgICAgaWYgKGxhc3RWaWV3UmVmID09PSBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlICYmICFlcXVhbHMobGFzdFZpZXcsIG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUpKSB7XG5cdCAgICAgICAgICAgIGxhc3RWaWV3ID0gc2hhbGxvd0NvcHkobmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSk7XG5cdCAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGxhc3RWaWV3UmVmID0gbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZTtcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgLy8gSWYgd2UgYXJlIGEgbXVsdGlwbGUgc2VsZWN0IHRoZW4gdmFsdWUgaXMgbm93IGEgY29sbGVjdGlvblxuXHQgICAgICAgIC8vIHNvIHRoZSBtZWFuaW5nIG9mICRpc0VtcHR5IGNoYW5nZXNcblx0ICAgICAgICBuZ01vZGVsQ3RybC4kaXNFbXB0eSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgICByZXR1cm4gIXZhbHVlIHx8IHZhbHVlLmxlbmd0aCA9PT0gMDtcblx0ICAgICAgICB9O1xuXHRcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHNlbGVjdFBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY3RybHMpIHtcblx0ICAgICAgLy8gaWYgbmdNb2RlbCBpcyBub3QgZGVmaW5lZCwgd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZ1xuXHQgICAgICB2YXIgbmdNb2RlbEN0cmwgPSBjdHJsc1sxXTtcblx0ICAgICAgaWYgKCFuZ01vZGVsQ3RybCkgcmV0dXJuO1xuXHRcblx0ICAgICAgdmFyIHNlbGVjdEN0cmwgPSBjdHJsc1swXTtcblx0XG5cdCAgICAgIC8vIFdlIGRlbGVnYXRlIHJlbmRlcmluZyB0byB0aGUgYHdyaXRlVmFsdWVgIG1ldGhvZCwgd2hpY2ggY2FuIGJlIGNoYW5nZWRcblx0ICAgICAgLy8gaWYgdGhlIHNlbGVjdCBjYW4gaGF2ZSBtdWx0aXBsZSBzZWxlY3RlZCB2YWx1ZXMgb3IgaWYgdGhlIG9wdGlvbnMgYXJlIGJlaW5nXG5cdCAgICAgIC8vIGdlbmVyYXRlZCBieSBgbmdPcHRpb25zYC5cblx0ICAgICAgLy8gVGhpcyBtdXN0IGJlIGRvbmUgaW4gdGhlIHBvc3RMaW5rIGZuIHRvIHByZXZlbnQgJHJlbmRlciB0byBiZSBjYWxsZWQgYmVmb3JlXG5cdCAgICAgIC8vIGFsbCBub2RlcyBoYXZlIGJlZW4gbGlua2VkIGNvcnJlY3RseS5cblx0ICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlciA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHNlbGVjdEN0cmwud3JpdGVWYWx1ZShuZ01vZGVsQ3RybC4kdmlld1ZhbHVlKTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0fTtcblx0XG5cdFxuXHQvLyBUaGUgb3B0aW9uIGRpcmVjdGl2ZSBpcyBwdXJlbHkgZGVzaWduZWQgdG8gY29tbXVuaWNhdGUgdGhlIGV4aXN0ZW5jZSAob3IgbGFjayBvZilcblx0Ly8gb2YgZHluYW1pY2FsbHkgY3JlYXRlZCAoYW5kIGRlc3Ryb3llZCkgb3B0aW9uIGVsZW1lbnRzIHRvIHRoZWlyIGNvbnRhaW5pbmcgc2VsZWN0XG5cdC8vIGRpcmVjdGl2ZSB2aWEgaXRzIGNvbnRyb2xsZXIuXG5cdHZhciBvcHRpb25EaXJlY3RpdmUgPSBbJyRpbnRlcnBvbGF0ZScsIGZ1bmN0aW9uKCRpbnRlcnBvbGF0ZSkge1xuXHQgIHJldHVybiB7XG5cdCAgICByZXN0cmljdDogJ0UnLFxuXHQgICAgcHJpb3JpdHk6IDEwMCxcblx0ICAgIGNvbXBpbGU6IGZ1bmN0aW9uKGVsZW1lbnQsIGF0dHIpIHtcblx0ICAgICAgaWYgKGlzRGVmaW5lZChhdHRyLnZhbHVlKSkge1xuXHQgICAgICAgIC8vIElmIHRoZSB2YWx1ZSBhdHRyaWJ1dGUgaXMgZGVmaW5lZCwgY2hlY2sgaWYgaXQgY29udGFpbnMgYW4gaW50ZXJwb2xhdGlvblxuXHQgICAgICAgIHZhciBpbnRlcnBvbGF0ZVZhbHVlRm4gPSAkaW50ZXJwb2xhdGUoYXR0ci52YWx1ZSwgdHJ1ZSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgLy8gSWYgdGhlIHZhbHVlIGF0dHJpYnV0ZSBpcyBub3QgZGVmaW5lZCB0aGVuIHdlIGZhbGwgYmFjayB0byB0aGVcblx0ICAgICAgICAvLyB0ZXh0IGNvbnRlbnQgb2YgdGhlIG9wdGlvbiBlbGVtZW50LCB3aGljaCBtYXkgYmUgaW50ZXJwb2xhdGVkXG5cdCAgICAgICAgdmFyIGludGVycG9sYXRlVGV4dEZuID0gJGludGVycG9sYXRlKGVsZW1lbnQudGV4dCgpLCB0cnVlKTtcblx0ICAgICAgICBpZiAoIWludGVycG9sYXRlVGV4dEZuKSB7XG5cdCAgICAgICAgICBhdHRyLiRzZXQoJ3ZhbHVlJywgZWxlbWVudC50ZXh0KCkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG5cdCAgICAgICAgLy8gVGhpcyBpcyBhbiBvcHRpbWl6YXRpb24gb3ZlciB1c2luZyBeXiBzaW5jZSB3ZSBkb24ndCB3YW50IHRvIGhhdmUgdG8gc2VhcmNoXG5cdCAgICAgICAgLy8gYWxsIHRoZSB3YXkgdG8gdGhlIHJvb3Qgb2YgdGhlIERPTSBmb3IgZXZlcnkgc2luZ2xlIG9wdGlvbiBlbGVtZW50XG5cdCAgICAgICAgdmFyIHNlbGVjdEN0cmxOYW1lID0gJyRzZWxlY3RDb250cm9sbGVyJyxcblx0ICAgICAgICAgICAgcGFyZW50ID0gZWxlbWVudC5wYXJlbnQoKSxcblx0ICAgICAgICAgICAgc2VsZWN0Q3RybCA9IHBhcmVudC5kYXRhKHNlbGVjdEN0cmxOYW1lKSB8fFxuXHQgICAgICAgICAgICAgIHBhcmVudC5wYXJlbnQoKS5kYXRhKHNlbGVjdEN0cmxOYW1lKTsgLy8gaW4gY2FzZSB3ZSBhcmUgaW4gb3B0Z3JvdXBcblx0XG5cdCAgICAgICAgaWYgKHNlbGVjdEN0cmwpIHtcblx0ICAgICAgICAgIHNlbGVjdEN0cmwucmVnaXN0ZXJPcHRpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGludGVycG9sYXRlVmFsdWVGbiwgaW50ZXJwb2xhdGVUZXh0Rm4pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgIH1cblx0ICB9O1xuXHR9XTtcblx0XG5cdHZhciBzdHlsZURpcmVjdGl2ZSA9IHZhbHVlRm4oe1xuXHQgIHJlc3RyaWN0OiAnRScsXG5cdCAgdGVybWluYWw6IGZhbHNlXG5cdH0pO1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdSZXF1aXJlZFxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogbmdSZXF1aXJlZCBhZGRzIHRoZSByZXF1aXJlZCB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmFsaWRhdG9ycyBgdmFsaWRhdG9yYH0gdG8ge0BsaW5rIG5nTW9kZWwgYG5nTW9kZWxgfS5cblx0ICogSXQgaXMgbW9zdCBvZnRlbiB1c2VkIGZvciB7QGxpbmsgaW5wdXQgYGlucHV0YH0gYW5kIHtAbGluayBzZWxlY3QgYHNlbGVjdGB9IGNvbnRyb2xzLCBidXQgY2FuIGFsc28gYmVcblx0ICogYXBwbGllZCB0byBjdXN0b20gY29udHJvbHMuXG5cdCAqXG5cdCAqIFRoZSBkaXJlY3RpdmUgc2V0cyB0aGUgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgb24gdGhlIGVsZW1lbnQgaWYgdGhlIEFuZ3VsYXIgZXhwcmVzc2lvbiBpbnNpZGVcblx0ICogYG5nUmVxdWlyZWRgIGV2YWx1YXRlcyB0byB0cnVlLiBBIHNwZWNpYWwgZGlyZWN0aXZlIGZvciBzZXR0aW5nIGByZXF1aXJlZGAgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugd2Vcblx0ICogY2Fubm90IHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSBgcmVxdWlyZWRgLiBTZWUgdGhlIHtAbGluayBndWlkZS9pbnRlcnBvbGF0aW9uIGludGVycG9sYXRpb24gZ3VpZGV9XG5cdCAqIGZvciBtb3JlIGluZm8uXG5cdCAqXG5cdCAqIFRoZSB2YWxpZGF0b3Igd2lsbCBzZXQgdGhlIGByZXF1aXJlZGAgZXJyb3Iga2V5IHRvIHRydWUgaWYgdGhlIGByZXF1aXJlZGAgYXR0cmlidXRlIGlzIHNldCBhbmRcblx0ICogY2FsbGluZyB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkaXNFbXB0eSBgTmdNb2RlbENvbnRyb2xsZXIuJGlzRW1wdHlgfSB3aXRoIHRoZVxuXHQgKiB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmlld1ZhbHVlIGBuZ01vZGVsLiR2aWV3VmFsdWVgfSByZXR1cm5zIGB0cnVlYC4gRm9yIGV4YW1wbGUsIHRoZVxuXHQgKiBgJGlzRW1wdHkoKWAgaW1wbGVtZW50YXRpb24gZm9yIGBpbnB1dFt0ZXh0XWAgY2hlY2tzIHRoZSBsZW5ndGggb2YgdGhlIGAkdmlld1ZhbHVlYC4gV2hlbiBkZXZlbG9waW5nXG5cdCAqIGN1c3RvbSBjb250cm9scywgYCRpc0VtcHR5KClgIGNhbiBiZSBvdmVyd3JpdHRlbiB0byBhY2NvdW50IGZvciBhICR2aWV3VmFsdWUgdGhhdCBpcyBub3Qgc3RyaW5nLWJhc2VkLlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgKiA8ZXhhbXBsZSBuYW1lPVwibmdSZXF1aXJlZERpcmVjdGl2ZVwiIG1vZHVsZT1cIm5nUmVxdWlyZWRFeGFtcGxlXCI+XG5cdCAqICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICogICAgIDxzY3JpcHQ+XG5cdCAqICAgICAgIGFuZ3VsYXIubW9kdWxlKCduZ1JlcXVpcmVkRXhhbXBsZScsIFtdKVxuXHQgKiAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAqICAgICAgICAgICAkc2NvcGUucmVxdWlyZWQgPSB0cnVlO1xuXHQgKiAgICAgICAgIH1dKTtcblx0ICogICAgIDwvc2NyaXB0PlxuXHQgKiAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICogICAgICAgPGZvcm0gbmFtZT1cImZvcm1cIj5cblx0ICogICAgICAgICA8bGFiZWwgZm9yPVwicmVxdWlyZWRcIj5Ub2dnbGUgcmVxdWlyZWQ6IDwvbGFiZWw+XG5cdCAqICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwicmVxdWlyZWRcIiBpZD1cInJlcXVpcmVkXCIgLz5cblx0ICogICAgICAgICA8YnI+XG5cdCAqICAgICAgICAgPGxhYmVsIGZvcj1cImlucHV0XCI+VGhpcyBpbnB1dCBtdXN0IGJlIGZpbGxlZCBpZiBgcmVxdWlyZWRgIGlzIHRydWU6IDwvbGFiZWw+XG5cdCAqICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJtb2RlbFwiIGlkPVwiaW5wdXRcIiBuYW1lPVwiaW5wdXRcIiBuZy1yZXF1aXJlZD1cInJlcXVpcmVkXCIgLz48YnI+XG5cdCAqICAgICAgICAgPGhyPlxuXHQgKiAgICAgICAgIHJlcXVpcmVkIGVycm9yIHNldD8gPSA8Y29kZT57e2Zvcm0uaW5wdXQuJGVycm9yLnJlcXVpcmVkfX08L2NvZGU+PGJyPlxuXHQgKiAgICAgICAgIG1vZGVsID0gPGNvZGU+e3ttb2RlbH19PC9jb2RlPlxuXHQgKiAgICAgICA8L2Zvcm0+XG5cdCAqICAgICA8L2Rpdj5cblx0ICogICA8L2ZpbGU+XG5cdCAqICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuXHQgICAgICAgdmFyIHJlcXVpcmVkID0gZWxlbWVudChieS5iaW5kaW5nKCdmb3JtLmlucHV0LiRlcnJvci5yZXF1aXJlZCcpKTtcblx0ICAgICAgIHZhciBtb2RlbCA9IGVsZW1lbnQoYnkuYmluZGluZygnbW9kZWwnKSk7XG5cdCAgICAgICB2YXIgaW5wdXQgPSBlbGVtZW50KGJ5LmlkKCdpbnB1dCcpKTtcblx0XG5cdCAgICAgICBpdCgnc2hvdWxkIHNldCB0aGUgcmVxdWlyZWQgZXJyb3InLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgZXhwZWN0KHJlcXVpcmVkLmdldFRleHQoKSkudG9Db250YWluKCd0cnVlJyk7XG5cdFxuXHQgICAgICAgICBpbnB1dC5zZW5kS2V5cygnMTIzJyk7XG5cdCAgICAgICAgIGV4cGVjdChyZXF1aXJlZC5nZXRUZXh0KCkpLm5vdC50b0NvbnRhaW4oJ3RydWUnKTtcblx0ICAgICAgICAgZXhwZWN0KG1vZGVsLmdldFRleHQoKSkudG9Db250YWluKCcxMjMnKTtcblx0ICAgICAgIH0pO1xuXHQgKiAgIDwvZmlsZT5cblx0ICogPC9leGFtcGxlPlxuXHQgKi9cblx0dmFyIHJlcXVpcmVkRGlyZWN0aXZlID0gZnVuY3Rpb24oKSB7XG5cdCAgcmV0dXJuIHtcblx0ICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxuXHQgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsbSwgYXR0ciwgY3RybCkge1xuXHQgICAgICBpZiAoIWN0cmwpIHJldHVybjtcblx0ICAgICAgYXR0ci5yZXF1aXJlZCA9IHRydWU7IC8vIGZvcmNlIHRydXRoeSBpbiBjYXNlIHdlIGFyZSBvbiBub24gaW5wdXQgZWxlbWVudFxuXHRcblx0ICAgICAgY3RybC4kdmFsaWRhdG9ycy5yZXF1aXJlZCA9IGZ1bmN0aW9uKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSkge1xuXHQgICAgICAgIHJldHVybiAhYXR0ci5yZXF1aXJlZCB8fCAhY3RybC4kaXNFbXB0eSh2aWV3VmFsdWUpO1xuXHQgICAgICB9O1xuXHRcblx0ICAgICAgYXR0ci4kb2JzZXJ2ZSgncmVxdWlyZWQnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBjdHJsLiR2YWxpZGF0ZSgpO1xuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9O1xuXHR9O1xuXHRcblx0LyoqXG5cdCAqIEBuZ2RvYyBkaXJlY3RpdmVcblx0ICogQG5hbWUgbmdQYXR0ZXJuXG5cdCAqXG5cdCAqIEBkZXNjcmlwdGlvblxuXHQgKlxuXHQgKiBuZ1BhdHRlcm4gYWRkcyB0aGUgcGF0dGVybiB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmFsaWRhdG9ycyBgdmFsaWRhdG9yYH0gdG8ge0BsaW5rIG5nTW9kZWwgYG5nTW9kZWxgfS5cblx0ICogSXQgaXMgbW9zdCBvZnRlbiB1c2VkIGZvciB0ZXh0LWJhc2VkIHtAbGluayBpbnB1dCBgaW5wdXRgfSBjb250cm9scywgYnV0IGNhbiBhbHNvIGJlIGFwcGxpZWQgdG8gY3VzdG9tIHRleHQtYmFzZWQgY29udHJvbHMuXG5cdCAqXG5cdCAqIFRoZSB2YWxpZGF0b3Igc2V0cyB0aGUgYHBhdHRlcm5gIGVycm9yIGtleSBpZiB0aGUge0BsaW5rIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHZpZXdWYWx1ZSBgbmdNb2RlbC4kdmlld1ZhbHVlYH1cblx0ICogZG9lcyBub3QgbWF0Y2ggYSBSZWdFeHAgd2hpY2ggaXMgb2J0YWluZWQgYnkgZXZhbHVhdGluZyB0aGUgQW5ndWxhciBleHByZXNzaW9uIGdpdmVuIGluIHRoZVxuXHQgKiBgbmdQYXR0ZXJuYCBhdHRyaWJ1dGUgdmFsdWU6XG5cdCAqICogSWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgUmVnRXhwIG9iamVjdCwgdGhlbiB0aGlzIGlzIHVzZWQgZGlyZWN0bHkuXG5cdCAqICogSWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgc3RyaW5nLCB0aGVuIGl0IHdpbGwgYmUgY29udmVydGVkIHRvIGEgUmVnRXhwIGFmdGVyIHdyYXBwaW5nIGl0XG5cdCAqIGluIGBeYCBhbmQgYCRgIGNoYXJhY3RlcnMuIEZvciBpbnN0YW5jZSwgYFwiYWJjXCJgIHdpbGwgYmUgY29udmVydGVkIHRvIGBuZXcgUmVnRXhwKCdeYWJjJCcpYC5cblx0ICpcblx0ICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWluZm9cIj5cblx0ICogKipOb3RlOioqIEF2b2lkIHVzaW5nIHRoZSBgZ2AgZmxhZyBvbiB0aGUgUmVnRXhwLCBhcyBpdCB3aWxsIGNhdXNlIGVhY2ggc3VjY2Vzc2l2ZSBzZWFyY2ggdG9cblx0ICogc3RhcnQgYXQgdGhlIGluZGV4IG9mIHRoZSBsYXN0IHNlYXJjaCdzIG1hdGNoLCB0aHVzIG5vdCB0YWtpbmcgdGhlIHdob2xlIGlucHV0IHZhbHVlIGludG9cblx0ICogYWNjb3VudC5cblx0ICogPC9kaXY+XG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1pbmZvXCI+XG5cdCAqICoqTm90ZToqKiBUaGlzIGRpcmVjdGl2ZSBpcyBhbHNvIGFkZGVkIHdoZW4gdGhlIHBsYWluIGBwYXR0ZXJuYCBhdHRyaWJ1dGUgaXMgdXNlZCwgd2l0aCB0d29cblx0ICogZGlmZmVyZW5jZXM6XG5cdCAqIDxvbD5cblx0ICogICA8bGk+XG5cdCAqICAgICBgbmdQYXR0ZXJuYCBkb2VzIG5vdCBzZXQgdGhlIGBwYXR0ZXJuYCBhdHRyaWJ1dGUgYW5kIHRoZXJlZm9yZSBIVE1MNSBjb25zdHJhaW50IHZhbGlkYXRpb24gaXNcblx0ICogICAgIG5vdCBhdmFpbGFibGUuXG5cdCAqICAgPC9saT5cblx0ICogICA8bGk+XG5cdCAqICAgICBUaGUgYG5nUGF0dGVybmAgYXR0cmlidXRlIG11c3QgYmUgYW4gZXhwcmVzc2lvbiwgd2hpbGUgdGhlIGBwYXR0ZXJuYCB2YWx1ZSBtdXN0IGJlXG5cdCAqICAgICBpbnRlcnBvbGF0ZWQuXG5cdCAqICAgPC9saT5cblx0ICogPC9vbD5cblx0ICogPC9kaXY+XG5cdCAqXG5cdCAqIEBleGFtcGxlXG5cdCAqIDxleGFtcGxlIG5hbWU9XCJuZ1BhdHRlcm5EaXJlY3RpdmVcIiBtb2R1bGU9XCJuZ1BhdHRlcm5FeGFtcGxlXCI+XG5cdCAqICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cblx0ICogICAgIDxzY3JpcHQ+XG5cdCAqICAgICAgIGFuZ3VsYXIubW9kdWxlKCduZ1BhdHRlcm5FeGFtcGxlJywgW10pXG5cdCAqICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcblx0ICogICAgICAgICAgICRzY29wZS5yZWdleCA9ICdcXFxcZCsnO1xuXHQgKiAgICAgICAgIH1dKTtcblx0ICogICAgIDwvc2NyaXB0PlxuXHQgKiAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cblx0ICogICAgICAgPGZvcm0gbmFtZT1cImZvcm1cIj5cblx0ICogICAgICAgICA8bGFiZWwgZm9yPVwicmVnZXhcIj5TZXQgYSBwYXR0ZXJuIChyZWdleCBzdHJpbmcpOiA8L2xhYmVsPlxuXHQgKiAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwicmVnZXhcIiBpZD1cInJlZ2V4XCIgLz5cblx0ICogICAgICAgICA8YnI+XG5cdCAqICAgICAgICAgPGxhYmVsIGZvcj1cImlucHV0XCI+VGhpcyBpbnB1dCBpcyByZXN0cmljdGVkIGJ5IHRoZSBjdXJyZW50IHBhdHRlcm46IDwvbGFiZWw+XG5cdCAqICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJtb2RlbFwiIGlkPVwiaW5wdXRcIiBuYW1lPVwiaW5wdXRcIiBuZy1wYXR0ZXJuPVwicmVnZXhcIiAvPjxicj5cblx0ICogICAgICAgICA8aHI+XG5cdCAqICAgICAgICAgaW5wdXQgdmFsaWQ/ID0gPGNvZGU+e3tmb3JtLmlucHV0LiR2YWxpZH19PC9jb2RlPjxicj5cblx0ICogICAgICAgICBtb2RlbCA9IDxjb2RlPnt7bW9kZWx9fTwvY29kZT5cblx0ICogICAgICAgPC9mb3JtPlxuXHQgKiAgICAgPC9kaXY+XG5cdCAqICAgPC9maWxlPlxuXHQgKiAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cblx0ICAgICAgIHZhciBtb2RlbCA9IGVsZW1lbnQoYnkuYmluZGluZygnbW9kZWwnKSk7XG5cdCAgICAgICB2YXIgaW5wdXQgPSBlbGVtZW50KGJ5LmlkKCdpbnB1dCcpKTtcblx0XG5cdCAgICAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHRoZSBpbnB1dCB3aXRoIHRoZSBkZWZhdWx0IHBhdHRlcm4nLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgaW5wdXQuc2VuZEtleXMoJ2FhYScpO1xuXHQgICAgICAgICBleHBlY3QobW9kZWwuZ2V0VGV4dCgpKS5ub3QudG9Db250YWluKCdhYWEnKTtcblx0XG5cdCAgICAgICAgIGlucHV0LmNsZWFyKCkudGhlbihmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygnMTIzJyk7XG5cdCAgICAgICAgICAgZXhwZWN0KG1vZGVsLmdldFRleHQoKSkudG9Db250YWluKCcxMjMnKTtcblx0ICAgICAgICAgfSk7XG5cdCAgICAgICB9KTtcblx0ICogICA8L2ZpbGU+XG5cdCAqIDwvZXhhbXBsZT5cblx0ICovXG5cdHZhciBwYXR0ZXJuRGlyZWN0aXZlID0gZnVuY3Rpb24oKSB7XG5cdCAgcmV0dXJuIHtcblx0ICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxuXHQgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsbSwgYXR0ciwgY3RybCkge1xuXHQgICAgICBpZiAoIWN0cmwpIHJldHVybjtcblx0XG5cdCAgICAgIHZhciByZWdleHAsIHBhdHRlcm5FeHAgPSBhdHRyLm5nUGF0dGVybiB8fCBhdHRyLnBhdHRlcm47XG5cdCAgICAgIGF0dHIuJG9ic2VydmUoJ3BhdHRlcm4nLCBmdW5jdGlvbihyZWdleCkge1xuXHQgICAgICAgIGlmIChpc1N0cmluZyhyZWdleCkgJiYgcmVnZXgubGVuZ3RoID4gMCkge1xuXHQgICAgICAgICAgcmVnZXggPSBuZXcgUmVnRXhwKCdeJyArIHJlZ2V4ICsgJyQnKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmIChyZWdleCAmJiAhcmVnZXgudGVzdCkge1xuXHQgICAgICAgICAgdGhyb3cgbWluRXJyKCduZ1BhdHRlcm4nKSgnbm9yZWdleHAnLFxuXHQgICAgICAgICAgICAnRXhwZWN0ZWQgezB9IHRvIGJlIGEgUmVnRXhwIGJ1dCB3YXMgezF9LiBFbGVtZW50OiB7Mn0nLCBwYXR0ZXJuRXhwLFxuXHQgICAgICAgICAgICByZWdleCwgc3RhcnRpbmdUYWcoZWxtKSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZWdleHAgPSByZWdleCB8fCB1bmRlZmluZWQ7XG5cdCAgICAgICAgY3RybC4kdmFsaWRhdGUoKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBjdHJsLiR2YWxpZGF0b3JzLnBhdHRlcm4gPSBmdW5jdGlvbihtb2RlbFZhbHVlLCB2aWV3VmFsdWUpIHtcblx0ICAgICAgICAvLyBIVE1MNSBwYXR0ZXJuIGNvbnN0cmFpbnQgdmFsaWRhdGVzIHRoZSBpbnB1dCB2YWx1ZSwgc28gd2UgdmFsaWRhdGUgdGhlIHZpZXdWYWx1ZVxuXHQgICAgICAgIHJldHVybiBjdHJsLiRpc0VtcHR5KHZpZXdWYWx1ZSkgfHwgaXNVbmRlZmluZWQocmVnZXhwKSB8fCByZWdleHAudGVzdCh2aWV3VmFsdWUpO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHQgIH07XG5cdH07XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ01heGxlbmd0aFxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogbmdNYXhsZW5ndGggYWRkcyB0aGUgbWF4bGVuZ3RoIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2YWxpZGF0b3JzIGB2YWxpZGF0b3JgfSB0byB7QGxpbmsgbmdNb2RlbCBgbmdNb2RlbGB9LlxuXHQgKiBJdCBpcyBtb3N0IG9mdGVuIHVzZWQgZm9yIHRleHQtYmFzZWQge0BsaW5rIGlucHV0IGBpbnB1dGB9IGNvbnRyb2xzLCBidXQgY2FuIGFsc28gYmUgYXBwbGllZCB0byBjdXN0b20gdGV4dC1iYXNlZCBjb250cm9scy5cblx0ICpcblx0ICogVGhlIHZhbGlkYXRvciBzZXRzIHRoZSBgbWF4bGVuZ3RoYCBlcnJvciBrZXkgaWYgdGhlIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2aWV3VmFsdWUgYG5nTW9kZWwuJHZpZXdWYWx1ZWB9XG5cdCAqIGlzIGxvbmdlciB0aGFuIHRoZSBpbnRlZ2VyIG9idGFpbmVkIGJ5IGV2YWx1YXRpbmcgdGhlIEFuZ3VsYXIgZXhwcmVzc2lvbiBnaXZlbiBpbiB0aGVcblx0ICogYG5nTWF4bGVuZ3RoYCBhdHRyaWJ1dGUgdmFsdWUuXG5cdCAqXG5cdCAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1pbmZvXCI+XG5cdCAqICoqTm90ZToqKiBUaGlzIGRpcmVjdGl2ZSBpcyBhbHNvIGFkZGVkIHdoZW4gdGhlIHBsYWluIGBtYXhsZW5ndGhgIGF0dHJpYnV0ZSBpcyB1c2VkLCB3aXRoIHR3b1xuXHQgKiBkaWZmZXJlbmNlczpcblx0ICogPG9sPlxuXHQgKiAgIDxsaT5cblx0ICogICAgIGBuZ01heGxlbmd0aGAgZG9lcyBub3Qgc2V0IHRoZSBgbWF4bGVuZ3RoYCBhdHRyaWJ1dGUgYW5kIHRoZXJlZm9yZSBIVE1MNSBjb25zdHJhaW50XG5cdCAqICAgICB2YWxpZGF0aW9uIGlzIG5vdCBhdmFpbGFibGUuXG5cdCAqICAgPC9saT5cblx0ICogICA8bGk+XG5cdCAqICAgICBUaGUgYG5nTWF4bGVuZ3RoYCBhdHRyaWJ1dGUgbXVzdCBiZSBhbiBleHByZXNzaW9uLCB3aGlsZSB0aGUgYG1heGxlbmd0aGAgdmFsdWUgbXVzdCBiZVxuXHQgKiAgICAgaW50ZXJwb2xhdGVkLlxuXHQgKiAgIDwvbGk+XG5cdCAqIDwvb2w+XG5cdCAqIDwvZGl2PlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgKiA8ZXhhbXBsZSBuYW1lPVwibmdNYXhsZW5ndGhEaXJlY3RpdmVcIiBtb2R1bGU9XCJuZ01heGxlbmd0aEV4YW1wbGVcIj5cblx0ICogICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgKiAgICAgPHNjcmlwdD5cblx0ICogICAgICAgYW5ndWxhci5tb2R1bGUoJ25nTWF4bGVuZ3RoRXhhbXBsZScsIFtdKVxuXHQgKiAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAqICAgICAgICAgICAkc2NvcGUubWF4bGVuZ3RoID0gNTtcblx0ICogICAgICAgICB9XSk7XG5cdCAqICAgICA8L3NjcmlwdD5cblx0ICogICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAqICAgICAgIDxmb3JtIG5hbWU9XCJmb3JtXCI+XG5cdCAqICAgICAgICAgPGxhYmVsIGZvcj1cIm1heGxlbmd0aFwiPlNldCBhIG1heGxlbmd0aDogPC9sYWJlbD5cblx0ICogICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIG5nLW1vZGVsPVwibWF4bGVuZ3RoXCIgaWQ9XCJtYXhsZW5ndGhcIiAvPlxuXHQgKiAgICAgICAgIDxicj5cblx0ICogICAgICAgICA8bGFiZWwgZm9yPVwiaW5wdXRcIj5UaGlzIGlucHV0IGlzIHJlc3RyaWN0ZWQgYnkgdGhlIGN1cnJlbnQgbWF4bGVuZ3RoOiA8L2xhYmVsPlxuXHQgKiAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwibW9kZWxcIiBpZD1cImlucHV0XCIgbmFtZT1cImlucHV0XCIgbmctbWF4bGVuZ3RoPVwibWF4bGVuZ3RoXCIgLz48YnI+XG5cdCAqICAgICAgICAgPGhyPlxuXHQgKiAgICAgICAgIGlucHV0IHZhbGlkPyA9IDxjb2RlPnt7Zm9ybS5pbnB1dC4kdmFsaWR9fTwvY29kZT48YnI+XG5cdCAqICAgICAgICAgbW9kZWwgPSA8Y29kZT57e21vZGVsfX08L2NvZGU+XG5cdCAqICAgICAgIDwvZm9ybT5cblx0ICogICAgIDwvZGl2PlxuXHQgKiAgIDwvZmlsZT5cblx0ICogICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgICB2YXIgbW9kZWwgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ21vZGVsJykpO1xuXHQgICAgICAgdmFyIGlucHV0ID0gZWxlbWVudChieS5pZCgnaW5wdXQnKSk7XG5cdFxuXHQgICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB0aGUgaW5wdXQgd2l0aCB0aGUgZGVmYXVsdCBtYXhsZW5ndGgnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgaW5wdXQuc2VuZEtleXMoJ2FiY2RlZicpO1xuXHQgICAgICAgICBleHBlY3QobW9kZWwuZ2V0VGV4dCgpKS5ub3QudG9Db250YWluKCdhYmNkZWYnKTtcblx0XG5cdCAgICAgICAgIGlucHV0LmNsZWFyKCkudGhlbihmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygnYWJjZGUnKTtcblx0ICAgICAgICAgICBleHBlY3QobW9kZWwuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2FiY2RlJyk7XG5cdCAgICAgICAgIH0pO1xuXHQgICAgICAgfSk7XG5cdCAqICAgPC9maWxlPlxuXHQgKiA8L2V4YW1wbGU+XG5cdCAqL1xuXHR2YXIgbWF4bGVuZ3RoRGlyZWN0aXZlID0gZnVuY3Rpb24oKSB7XG5cdCAgcmV0dXJuIHtcblx0ICAgIHJlc3RyaWN0OiAnQScsXG5cdCAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxuXHQgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsbSwgYXR0ciwgY3RybCkge1xuXHQgICAgICBpZiAoIWN0cmwpIHJldHVybjtcblx0XG5cdCAgICAgIHZhciBtYXhsZW5ndGggPSAtMTtcblx0ICAgICAgYXR0ci4kb2JzZXJ2ZSgnbWF4bGVuZ3RoJywgZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICB2YXIgaW50VmFsID0gdG9JbnQodmFsdWUpO1xuXHQgICAgICAgIG1heGxlbmd0aCA9IGlzTmFOKGludFZhbCkgPyAtMSA6IGludFZhbDtcblx0ICAgICAgICBjdHJsLiR2YWxpZGF0ZSgpO1xuXHQgICAgICB9KTtcblx0ICAgICAgY3RybC4kdmFsaWRhdG9ycy5tYXhsZW5ndGggPSBmdW5jdGlvbihtb2RlbFZhbHVlLCB2aWV3VmFsdWUpIHtcblx0ICAgICAgICByZXR1cm4gKG1heGxlbmd0aCA8IDApIHx8IGN0cmwuJGlzRW1wdHkodmlld1ZhbHVlKSB8fCAodmlld1ZhbHVlLmxlbmd0aCA8PSBtYXhsZW5ndGgpO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHQgIH07XG5cdH07XG5cdFxuXHQvKipcblx0ICogQG5nZG9jIGRpcmVjdGl2ZVxuXHQgKiBAbmFtZSBuZ01pbmxlbmd0aFxuXHQgKlxuXHQgKiBAZGVzY3JpcHRpb25cblx0ICpcblx0ICogbmdNaW5sZW5ndGggYWRkcyB0aGUgbWlubGVuZ3RoIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2YWxpZGF0b3JzIGB2YWxpZGF0b3JgfSB0byB7QGxpbmsgbmdNb2RlbCBgbmdNb2RlbGB9LlxuXHQgKiBJdCBpcyBtb3N0IG9mdGVuIHVzZWQgZm9yIHRleHQtYmFzZWQge0BsaW5rIGlucHV0IGBpbnB1dGB9IGNvbnRyb2xzLCBidXQgY2FuIGFsc28gYmUgYXBwbGllZCB0byBjdXN0b20gdGV4dC1iYXNlZCBjb250cm9scy5cblx0ICpcblx0ICogVGhlIHZhbGlkYXRvciBzZXRzIHRoZSBgbWlubGVuZ3RoYCBlcnJvciBrZXkgaWYgdGhlIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2aWV3VmFsdWUgYG5nTW9kZWwuJHZpZXdWYWx1ZWB9XG5cdCAqIGlzIHNob3J0ZXIgdGhhbiB0aGUgaW50ZWdlciBvYnRhaW5lZCBieSBldmFsdWF0aW5nIHRoZSBBbmd1bGFyIGV4cHJlc3Npb24gZ2l2ZW4gaW4gdGhlXG5cdCAqIGBuZ01pbmxlbmd0aGAgYXR0cmlidXRlIHZhbHVlLlxuXHQgKlxuXHQgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtaW5mb1wiPlxuXHQgKiAqKk5vdGU6KiogVGhpcyBkaXJlY3RpdmUgaXMgYWxzbyBhZGRlZCB3aGVuIHRoZSBwbGFpbiBgbWlubGVuZ3RoYCBhdHRyaWJ1dGUgaXMgdXNlZCwgd2l0aCB0d29cblx0ICogZGlmZmVyZW5jZXM6XG5cdCAqIDxvbD5cblx0ICogICA8bGk+XG5cdCAqICAgICBgbmdNaW5sZW5ndGhgIGRvZXMgbm90IHNldCB0aGUgYG1pbmxlbmd0aGAgYXR0cmlidXRlIGFuZCB0aGVyZWZvcmUgSFRNTDUgY29uc3RyYWludFxuXHQgKiAgICAgdmFsaWRhdGlvbiBpcyBub3QgYXZhaWxhYmxlLlxuXHQgKiAgIDwvbGk+XG5cdCAqICAgPGxpPlxuXHQgKiAgICAgVGhlIGBuZ01pbmxlbmd0aGAgdmFsdWUgbXVzdCBiZSBhbiBleHByZXNzaW9uLCB3aGlsZSB0aGUgYG1pbmxlbmd0aGAgdmFsdWUgbXVzdCBiZVxuXHQgKiAgICAgaW50ZXJwb2xhdGVkLlxuXHQgKiAgIDwvbGk+XG5cdCAqIDwvb2w+XG5cdCAqIDwvZGl2PlxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgKiA8ZXhhbXBsZSBuYW1lPVwibmdNaW5sZW5ndGhEaXJlY3RpdmVcIiBtb2R1bGU9XCJuZ01pbmxlbmd0aEV4YW1wbGVcIj5cblx0ICogICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuXHQgKiAgICAgPHNjcmlwdD5cblx0ICogICAgICAgYW5ndWxhci5tb2R1bGUoJ25nTWlubGVuZ3RoRXhhbXBsZScsIFtdKVxuXHQgKiAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cdCAqICAgICAgICAgICAkc2NvcGUubWlubGVuZ3RoID0gMztcblx0ICogICAgICAgICB9XSk7XG5cdCAqICAgICA8L3NjcmlwdD5cblx0ICogICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG5cdCAqICAgICAgIDxmb3JtIG5hbWU9XCJmb3JtXCI+XG5cdCAqICAgICAgICAgPGxhYmVsIGZvcj1cIm1pbmxlbmd0aFwiPlNldCBhIG1pbmxlbmd0aDogPC9sYWJlbD5cblx0ICogICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIG5nLW1vZGVsPVwibWlubGVuZ3RoXCIgaWQ9XCJtaW5sZW5ndGhcIiAvPlxuXHQgKiAgICAgICAgIDxicj5cblx0ICogICAgICAgICA8bGFiZWwgZm9yPVwiaW5wdXRcIj5UaGlzIGlucHV0IGlzIHJlc3RyaWN0ZWQgYnkgdGhlIGN1cnJlbnQgbWlubGVuZ3RoOiA8L2xhYmVsPlxuXHQgKiAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwibW9kZWxcIiBpZD1cImlucHV0XCIgbmFtZT1cImlucHV0XCIgbmctbWlubGVuZ3RoPVwibWlubGVuZ3RoXCIgLz48YnI+XG5cdCAqICAgICAgICAgPGhyPlxuXHQgKiAgICAgICAgIGlucHV0IHZhbGlkPyA9IDxjb2RlPnt7Zm9ybS5pbnB1dC4kdmFsaWR9fTwvY29kZT48YnI+XG5cdCAqICAgICAgICAgbW9kZWwgPSA8Y29kZT57e21vZGVsfX08L2NvZGU+XG5cdCAqICAgICAgIDwvZm9ybT5cblx0ICogICAgIDwvZGl2PlxuXHQgKiAgIDwvZmlsZT5cblx0ICogICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG5cdCAgICAgICB2YXIgbW9kZWwgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ21vZGVsJykpO1xuXHQgICAgICAgdmFyIGlucHV0ID0gZWxlbWVudChieS5pZCgnaW5wdXQnKSk7XG5cdFxuXHQgICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB0aGUgaW5wdXQgd2l0aCB0aGUgZGVmYXVsdCBtaW5sZW5ndGgnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgaW5wdXQuc2VuZEtleXMoJ2FiJyk7XG5cdCAgICAgICAgIGV4cGVjdChtb2RlbC5nZXRUZXh0KCkpLm5vdC50b0NvbnRhaW4oJ2FiJyk7XG5cdFxuXHQgICAgICAgICBpbnB1dC5zZW5kS2V5cygnYWJjJyk7XG5cdCAgICAgICAgIGV4cGVjdChtb2RlbC5nZXRUZXh0KCkpLnRvQ29udGFpbignYWJjJyk7XG5cdCAgICAgICB9KTtcblx0ICogICA8L2ZpbGU+XG5cdCAqIDwvZXhhbXBsZT5cblx0ICovXG5cdHZhciBtaW5sZW5ndGhEaXJlY3RpdmUgPSBmdW5jdGlvbigpIHtcblx0ICByZXR1cm4ge1xuXHQgICAgcmVzdHJpY3Q6ICdBJyxcblx0ICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXG5cdCAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxtLCBhdHRyLCBjdHJsKSB7XG5cdCAgICAgIGlmICghY3RybCkgcmV0dXJuO1xuXHRcblx0ICAgICAgdmFyIG1pbmxlbmd0aCA9IDA7XG5cdCAgICAgIGF0dHIuJG9ic2VydmUoJ21pbmxlbmd0aCcsIGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgbWlubGVuZ3RoID0gdG9JbnQodmFsdWUpIHx8IDA7XG5cdCAgICAgICAgY3RybC4kdmFsaWRhdGUoKTtcblx0ICAgICAgfSk7XG5cdCAgICAgIGN0cmwuJHZhbGlkYXRvcnMubWlubGVuZ3RoID0gZnVuY3Rpb24obW9kZWxWYWx1ZSwgdmlld1ZhbHVlKSB7XG5cdCAgICAgICAgcmV0dXJuIGN0cmwuJGlzRW1wdHkodmlld1ZhbHVlKSB8fCB2aWV3VmFsdWUubGVuZ3RoID49IG1pbmxlbmd0aDtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0ICB9O1xuXHR9O1xuXHRcblx0aWYgKHdpbmRvdy5hbmd1bGFyLmJvb3RzdHJhcCkge1xuXHQgIC8vQW5ndWxhckpTIGlzIGFscmVhZHkgbG9hZGVkLCBzbyB3ZSBjYW4gcmV0dXJuIGhlcmUuLi5cblx0ICBjb25zb2xlLmxvZygnV0FSTklORzogVHJpZWQgdG8gbG9hZCBhbmd1bGFyIG1vcmUgdGhhbiBvbmNlLicpO1xuXHQgIHJldHVybjtcblx0fVxuXHRcblx0Ly90cnkgdG8gYmluZCB0byBqcXVlcnkgbm93IHNvIHRoYXQgb25lIGNhbiB3cml0ZSBqcUxpdGUoZG9jdW1lbnQpLnJlYWR5KClcblx0Ly9idXQgd2Ugd2lsbCByZWJpbmQgb24gYm9vdHN0cmFwIGFnYWluLlxuXHRiaW5kSlF1ZXJ5KCk7XG5cdFxuXHRwdWJsaXNoRXh0ZXJuYWxBUEkoYW5ndWxhcik7XG5cdFxuXHRhbmd1bGFyLm1vZHVsZShcIm5nTG9jYWxlXCIsIFtdLCBbXCIkcHJvdmlkZVwiLCBmdW5jdGlvbigkcHJvdmlkZSkge1xuXHR2YXIgUExVUkFMX0NBVEVHT1JZID0ge1pFUk86IFwiemVyb1wiLCBPTkU6IFwib25lXCIsIFRXTzogXCJ0d29cIiwgRkVXOiBcImZld1wiLCBNQU5ZOiBcIm1hbnlcIiwgT1RIRVI6IFwib3RoZXJcIn07XG5cdGZ1bmN0aW9uIGdldERlY2ltYWxzKG4pIHtcblx0ICBuID0gbiArICcnO1xuXHQgIHZhciBpID0gbi5pbmRleE9mKCcuJyk7XG5cdCAgcmV0dXJuIChpID09IC0xKSA/IDAgOiBuLmxlbmd0aCAtIGkgLSAxO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBnZXRWRihuLCBvcHRfcHJlY2lzaW9uKSB7XG5cdCAgdmFyIHYgPSBvcHRfcHJlY2lzaW9uO1xuXHRcblx0ICBpZiAodW5kZWZpbmVkID09PSB2KSB7XG5cdCAgICB2ID0gTWF0aC5taW4oZ2V0RGVjaW1hbHMobiksIDMpO1xuXHQgIH1cblx0XG5cdCAgdmFyIGJhc2UgPSBNYXRoLnBvdygxMCwgdik7XG5cdCAgdmFyIGYgPSAoKG4gKiBiYXNlKSB8IDApICUgYmFzZTtcblx0ICByZXR1cm4ge3Y6IHYsIGY6IGZ9O1xuXHR9XG5cdFxuXHQkcHJvdmlkZS52YWx1ZShcIiRsb2NhbGVcIiwge1xuXHQgIFwiREFURVRJTUVfRk9STUFUU1wiOiB7XG5cdCAgICBcIkFNUE1TXCI6IFtcblx0ICAgICAgXCJBTVwiLFxuXHQgICAgICBcIlBNXCJcblx0ICAgIF0sXG5cdCAgICBcIkRBWVwiOiBbXG5cdCAgICAgIFwiU3VuZGF5XCIsXG5cdCAgICAgIFwiTW9uZGF5XCIsXG5cdCAgICAgIFwiVHVlc2RheVwiLFxuXHQgICAgICBcIldlZG5lc2RheVwiLFxuXHQgICAgICBcIlRodXJzZGF5XCIsXG5cdCAgICAgIFwiRnJpZGF5XCIsXG5cdCAgICAgIFwiU2F0dXJkYXlcIlxuXHQgICAgXSxcblx0ICAgIFwiRVJBTkFNRVNcIjogW1xuXHQgICAgICBcIkJlZm9yZSBDaHJpc3RcIixcblx0ICAgICAgXCJBbm5vIERvbWluaVwiXG5cdCAgICBdLFxuXHQgICAgXCJFUkFTXCI6IFtcblx0ICAgICAgXCJCQ1wiLFxuXHQgICAgICBcIkFEXCJcblx0ICAgIF0sXG5cdCAgICBcIkZJUlNUREFZT0ZXRUVLXCI6IDYsXG5cdCAgICBcIk1PTlRIXCI6IFtcblx0ICAgICAgXCJKYW51YXJ5XCIsXG5cdCAgICAgIFwiRmVicnVhcnlcIixcblx0ICAgICAgXCJNYXJjaFwiLFxuXHQgICAgICBcIkFwcmlsXCIsXG5cdCAgICAgIFwiTWF5XCIsXG5cdCAgICAgIFwiSnVuZVwiLFxuXHQgICAgICBcIkp1bHlcIixcblx0ICAgICAgXCJBdWd1c3RcIixcblx0ICAgICAgXCJTZXB0ZW1iZXJcIixcblx0ICAgICAgXCJPY3RvYmVyXCIsXG5cdCAgICAgIFwiTm92ZW1iZXJcIixcblx0ICAgICAgXCJEZWNlbWJlclwiXG5cdCAgICBdLFxuXHQgICAgXCJTSE9SVERBWVwiOiBbXG5cdCAgICAgIFwiU3VuXCIsXG5cdCAgICAgIFwiTW9uXCIsXG5cdCAgICAgIFwiVHVlXCIsXG5cdCAgICAgIFwiV2VkXCIsXG5cdCAgICAgIFwiVGh1XCIsXG5cdCAgICAgIFwiRnJpXCIsXG5cdCAgICAgIFwiU2F0XCJcblx0ICAgIF0sXG5cdCAgICBcIlNIT1JUTU9OVEhcIjogW1xuXHQgICAgICBcIkphblwiLFxuXHQgICAgICBcIkZlYlwiLFxuXHQgICAgICBcIk1hclwiLFxuXHQgICAgICBcIkFwclwiLFxuXHQgICAgICBcIk1heVwiLFxuXHQgICAgICBcIkp1blwiLFxuXHQgICAgICBcIkp1bFwiLFxuXHQgICAgICBcIkF1Z1wiLFxuXHQgICAgICBcIlNlcFwiLFxuXHQgICAgICBcIk9jdFwiLFxuXHQgICAgICBcIk5vdlwiLFxuXHQgICAgICBcIkRlY1wiXG5cdCAgICBdLFxuXHQgICAgXCJTVEFOREFMT05FTU9OVEhcIjogW1xuXHQgICAgICBcIkphbnVhcnlcIixcblx0ICAgICAgXCJGZWJydWFyeVwiLFxuXHQgICAgICBcIk1hcmNoXCIsXG5cdCAgICAgIFwiQXByaWxcIixcblx0ICAgICAgXCJNYXlcIixcblx0ICAgICAgXCJKdW5lXCIsXG5cdCAgICAgIFwiSnVseVwiLFxuXHQgICAgICBcIkF1Z3VzdFwiLFxuXHQgICAgICBcIlNlcHRlbWJlclwiLFxuXHQgICAgICBcIk9jdG9iZXJcIixcblx0ICAgICAgXCJOb3ZlbWJlclwiLFxuXHQgICAgICBcIkRlY2VtYmVyXCJcblx0ICAgIF0sXG5cdCAgICBcIldFRUtFTkRSQU5HRVwiOiBbXG5cdCAgICAgIDUsXG5cdCAgICAgIDZcblx0ICAgIF0sXG5cdCAgICBcImZ1bGxEYXRlXCI6IFwiRUVFRSwgTU1NTSBkLCB5XCIsXG5cdCAgICBcImxvbmdEYXRlXCI6IFwiTU1NTSBkLCB5XCIsXG5cdCAgICBcIm1lZGl1bVwiOiBcIk1NTSBkLCB5IGg6bW06c3MgYVwiLFxuXHQgICAgXCJtZWRpdW1EYXRlXCI6IFwiTU1NIGQsIHlcIixcblx0ICAgIFwibWVkaXVtVGltZVwiOiBcImg6bW06c3MgYVwiLFxuXHQgICAgXCJzaG9ydFwiOiBcIk0vZC95eSBoOm1tIGFcIixcblx0ICAgIFwic2hvcnREYXRlXCI6IFwiTS9kL3l5XCIsXG5cdCAgICBcInNob3J0VGltZVwiOiBcImg6bW0gYVwiXG5cdCAgfSxcblx0ICBcIk5VTUJFUl9GT1JNQVRTXCI6IHtcblx0ICAgIFwiQ1VSUkVOQ1lfU1lNXCI6IFwiJFwiLFxuXHQgICAgXCJERUNJTUFMX1NFUFwiOiBcIi5cIixcblx0ICAgIFwiR1JPVVBfU0VQXCI6IFwiLFwiLFxuXHQgICAgXCJQQVRURVJOU1wiOiBbXG5cdCAgICAgIHtcblx0ICAgICAgICBcImdTaXplXCI6IDMsXG5cdCAgICAgICAgXCJsZ1NpemVcIjogMyxcblx0ICAgICAgICBcIm1heEZyYWNcIjogMyxcblx0ICAgICAgICBcIm1pbkZyYWNcIjogMCxcblx0ICAgICAgICBcIm1pbkludFwiOiAxLFxuXHQgICAgICAgIFwibmVnUHJlXCI6IFwiLVwiLFxuXHQgICAgICAgIFwibmVnU3VmXCI6IFwiXCIsXG5cdCAgICAgICAgXCJwb3NQcmVcIjogXCJcIixcblx0ICAgICAgICBcInBvc1N1ZlwiOiBcIlwiXG5cdCAgICAgIH0sXG5cdCAgICAgIHtcblx0ICAgICAgICBcImdTaXplXCI6IDMsXG5cdCAgICAgICAgXCJsZ1NpemVcIjogMyxcblx0ICAgICAgICBcIm1heEZyYWNcIjogMixcblx0ICAgICAgICBcIm1pbkZyYWNcIjogMixcblx0ICAgICAgICBcIm1pbkludFwiOiAxLFxuXHQgICAgICAgIFwibmVnUHJlXCI6IFwiLVxcdTAwYTRcIixcblx0ICAgICAgICBcIm5lZ1N1ZlwiOiBcIlwiLFxuXHQgICAgICAgIFwicG9zUHJlXCI6IFwiXFx1MDBhNFwiLFxuXHQgICAgICAgIFwicG9zU3VmXCI6IFwiXCJcblx0ICAgICAgfVxuXHQgICAgXVxuXHQgIH0sXG5cdCAgXCJpZFwiOiBcImVuLXVzXCIsXG5cdCAgXCJsb2NhbGVJRFwiOiBcImVuX1VTXCIsXG5cdCAgXCJwbHVyYWxDYXRcIjogZnVuY3Rpb24obiwgb3B0X3ByZWNpc2lvbikgeyAgdmFyIGkgPSBuIHwgMDsgIHZhciB2ZiA9IGdldFZGKG4sIG9wdF9wcmVjaXNpb24pOyAgaWYgKGkgPT0gMSAmJiB2Zi52ID09IDApIHsgICAgcmV0dXJuIFBMVVJBTF9DQVRFR09SWS5PTkU7ICB9ICByZXR1cm4gUExVUkFMX0NBVEVHT1JZLk9USEVSO31cblx0fSk7XG5cdH1dKTtcblx0XG5cdCAganFMaXRlKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblx0ICAgIGFuZ3VsYXJJbml0KGRvY3VtZW50LCBib290c3RyYXApO1xuXHQgIH0pO1xuXHRcblx0fSkod2luZG93LCBkb2N1bWVudCk7XG5cdFxuXHQhd2luZG93LmFuZ3VsYXIuJCRjc3AoKS5ub0lubGluZVN0eWxlICYmIHdpbmRvdy5hbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuaGVhZCkucHJlcGVuZCgnPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPkBjaGFyc2V0IFwiVVRGLThcIjtbbmdcXFxcOmNsb2FrXSxbbmctY2xvYWtdLFtkYXRhLW5nLWNsb2FrXSxbeC1uZy1jbG9ha10sLm5nLWNsb2FrLC54LW5nLWNsb2FrLC5uZy1oaWRlOm5vdCgubmctaGlkZS1hbmltYXRlKXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudDt9bmdcXFxcOmZvcm17ZGlzcGxheTpibG9jazt9Lm5nLWFuaW1hdGUtc2hpbXt2aXNpYmlsaXR5OmhpZGRlbjt9Lm5nLWFuY2hvcntwb3NpdGlvbjphYnNvbHV0ZTt9PC9zdHlsZT4nKTtcblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdG1vZHVsZS5leHBvcnRzID0gYW5ndWxhcjtcblxuXG4vKioqLyB9LFxuLyogMyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0ZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KSgpO1xuXHQvLyBpbXBvcnRzXG5cdFxuXHRcblx0Ly8gbW9kdWxlXG5cdGV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcImJvZHl7cGFkZGluZzoyNXB4fWgxe21hcmdpbjoxNXB4IDB9cHJle2ZvbnQtZmFtaWx5Om1vbm9zcGFjZTtmb250LXNpemU6MTRweH1cIiwgXCJcIl0pO1xuXHRcblx0Ly8gZXhwb3J0c1xuXG5cbi8qKiovIH0sXG4vKiA0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvKlxyXG5cdFx0TUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuXHRcdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcclxuXHQqL1xyXG5cdC8vIGNzcyBiYXNlIGNvZGUsIGluamVjdGVkIGJ5IHRoZSBjc3MtbG9hZGVyXHJcblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBsaXN0ID0gW107XHJcblx0XHJcblx0XHQvLyByZXR1cm4gdGhlIGxpc3Qgb2YgbW9kdWxlcyBhcyBjc3Mgc3RyaW5nXHJcblx0XHRsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XHJcblx0XHRcdHZhciByZXN1bHQgPSBbXTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHR2YXIgaXRlbSA9IHRoaXNbaV07XHJcblx0XHRcdFx0aWYoaXRlbVsyXSkge1xyXG5cdFx0XHRcdFx0cmVzdWx0LnB1c2goXCJAbWVkaWEgXCIgKyBpdGVtWzJdICsgXCJ7XCIgKyBpdGVtWzFdICsgXCJ9XCIpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRyZXN1bHQucHVzaChpdGVtWzFdKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHJlc3VsdC5qb2luKFwiXCIpO1xyXG5cdFx0fTtcclxuXHRcclxuXHRcdC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0XHJcblx0XHRsaXN0LmkgPSBmdW5jdGlvbihtb2R1bGVzLCBtZWRpYVF1ZXJ5KSB7XHJcblx0XHRcdGlmKHR5cGVvZiBtb2R1bGVzID09PSBcInN0cmluZ1wiKVxyXG5cdFx0XHRcdG1vZHVsZXMgPSBbW251bGwsIG1vZHVsZXMsIFwiXCJdXTtcclxuXHRcdFx0dmFyIGFscmVhZHlJbXBvcnRlZE1vZHVsZXMgPSB7fTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHR2YXIgaWQgPSB0aGlzW2ldWzBdO1xyXG5cdFx0XHRcdGlmKHR5cGVvZiBpZCA9PT0gXCJudW1iZXJcIilcclxuXHRcdFx0XHRcdGFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaWRdID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IoaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dmFyIGl0ZW0gPSBtb2R1bGVzW2ldO1xyXG5cdFx0XHRcdC8vIHNraXAgYWxyZWFkeSBpbXBvcnRlZCBtb2R1bGVcclxuXHRcdFx0XHQvLyB0aGlzIGltcGxlbWVudGF0aW9uIGlzIG5vdCAxMDAlIHBlcmZlY3QgZm9yIHdlaXJkIG1lZGlhIHF1ZXJ5IGNvbWJpbmF0aW9uc1xyXG5cdFx0XHRcdC8vICB3aGVuIGEgbW9kdWxlIGlzIGltcG9ydGVkIG11bHRpcGxlIHRpbWVzIHdpdGggZGlmZmVyZW50IG1lZGlhIHF1ZXJpZXMuXHJcblx0XHRcdFx0Ly8gIEkgaG9wZSB0aGlzIHdpbGwgbmV2ZXIgb2NjdXIgKEhleSB0aGlzIHdheSB3ZSBoYXZlIHNtYWxsZXIgYnVuZGxlcylcclxuXHRcdFx0XHRpZih0eXBlb2YgaXRlbVswXSAhPT0gXCJudW1iZXJcIiB8fCAhYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpdGVtWzBdXSkge1xyXG5cdFx0XHRcdFx0aWYobWVkaWFRdWVyeSAmJiAhaXRlbVsyXSkge1xyXG5cdFx0XHRcdFx0XHRpdGVtWzJdID0gbWVkaWFRdWVyeTtcclxuXHRcdFx0XHRcdH0gZWxzZSBpZihtZWRpYVF1ZXJ5KSB7XHJcblx0XHRcdFx0XHRcdGl0ZW1bMl0gPSBcIihcIiArIGl0ZW1bMl0gKyBcIikgYW5kIChcIiArIG1lZGlhUXVlcnkgKyBcIilcIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGxpc3QucHVzaChpdGVtKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gbGlzdDtcclxuXHR9O1xyXG5cblxuLyoqKi8gfSxcbi8qIDUgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdG1vZHVsZS5leHBvcnRzID0ge1xuXHRcdFwidmVyc2lvblwiOiBcIjAuMS4wXCJcblx0fTtcblxuLyoqKi8gfSxcbi8qIDYgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdChmdW5jdGlvbihyb290KSB7XG5cdFxuXHQgICd1c2Ugc3RyaWN0Jztcblx0XG5cdCAgdmFyIFNUT1BQRUQgID0gMDtcblx0ICB2YXIgU1RPUFBJTkcgPSAxO1xuXHQgIHZhciBSVU5OSU5HICA9IDI7XG5cdFxuXHQgIGZ1bmN0aW9uIGVuZHNXaXRoKHN0ciwgc3VmZml4KSB7XG5cdCAgICByZXR1cm4gc3RyLmluZGV4T2Yoc3VmZml4LCBzdHIubGVuZ3RoIC0gc3VmZml4Lmxlbmd0aCkgIT09IC0xO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gbm9vcCgpIHt9XG5cdFxuXHQgIGZ1bmN0aW9uIE1hbGFya2V5KGVsZW0sIG9wdHMpIHtcblx0XG5cdCAgICAvLyBhbGxvdyBgTWFsYXJrZXlgIHRvIGJlIGNhbGxlZCB3aXRob3V0IHRoZSBgbmV3YCBrZXl3b3JkXG5cdCAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAgICBpZiAoIShzZWxmIGluc3RhbmNlb2YgTWFsYXJrZXkpKSB7XG5cdCAgICAgIHJldHVybiBuZXcgTWFsYXJrZXkoZWxlbSwgb3B0cyk7XG5cdCAgICB9XG5cdFxuXHQgICAgLy8gZGVmYXVsdCBgb3B0c2Bcblx0ICAgIG9wdHMgPSBvcHRzIHx8IHt9O1xuXHQgICAgdmFyIGxvb3AgPSBvcHRzLmxvb3A7XG5cdCAgICB2YXIgdHlwZVNwZWVkID0gb3B0cy5zcGVlZCB8fCBvcHRzLnR5cGVTcGVlZCB8fCA1MDtcblx0ICAgIHZhciBkZWxldGVTcGVlZCA9IG9wdHMuc3BlZWQgfHwgb3B0cy5kZWxldGVTcGVlZCB8fCA1MDtcblx0ICAgIHZhciBwYXVzZURlbGF5ID0gb3B0cy5kZWxheSB8fCBvcHRzLnBhdXNlRGVsYXkgfHwgMjAwMDtcblx0ICAgIHZhciBwb3N0Zml4ID0gb3B0cy5wb3N0Zml4IHx8ICcnO1xuXHQgICAgdmFyIGdldHRlciA9IG9wdHMuZ2V0dGVyIHx8IGZ1bmN0aW9uKGVsZW0pIHtcblx0ICAgICAgcmV0dXJuIGVsZW0uaW5uZXJIVE1MO1xuXHQgICAgfTtcblx0ICAgIHZhciBzZXR0ZXIgPSBvcHRzLnNldHRlciB8fCBmdW5jdGlvbihlbGVtLCB2YWwpIHtcblx0ICAgICAgZWxlbS5pbm5lckhUTUwgPSB2YWw7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8vIHRoZSBmdW5jdGlvbiBxdWV1ZVxuXHQgICAgdmFyIGZuUXVldWUgPSBbXTtcblx0ICAgIHZhciBhcmdzUXVldWUgPSBbXTtcblx0ICAgIHZhciBpID0gLTE7XG5cdCAgICB2YXIgc3RhdGUgPSBTVE9QUEVEO1xuXHQgICAgdmFyIHBhdXNlQ2IgPSBub29wO1xuXHQgICAgZnVuY3Rpb24gZW5xdWV1ZShmbiwgYXJncykge1xuXHQgICAgICBmblF1ZXVlLnB1c2goZm4pO1xuXHQgICAgICBhcmdzUXVldWUucHVzaChhcmdzKTtcblx0ICAgICAgaWYgKHN0YXRlICE9IFJVTk5JTkcpIHtcblx0ICAgICAgICBzdGF0ZSA9IFJVTk5JTkc7XG5cdCAgICAgICAgLy8gd2FpdCBmb3IgdGhlIHJlbWFpbmluZyBmdW5jdGlvbnMgdG8gYmUgZW5xdWV1ZWRcblx0ICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgbmV4dCgpO1xuXHQgICAgICAgIH0sIDApO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBzZWxmO1xuXHQgICAgfVxuXHQgICAgZnVuY3Rpb24gbmV4dCgpIHtcblx0ICAgICAgaWYgKHN0YXRlICE9IFJVTk5JTkcpIHtcblx0ICAgICAgICBzdGF0ZSA9IFNUT1BQRUQ7XG5cdCAgICAgICAgcGF1c2VDYihlbGVtKTtcblx0ICAgICAgICBwYXVzZUNiID0gbm9vcDtcblx0ICAgICAgICByZXR1cm47XG5cdCAgICAgIH1cblx0ICAgICAgaWYgKCsraSA9PSBmblF1ZXVlLmxlbmd0aCkge1xuXHQgICAgICAgIGlmICghbG9vcCkge1xuXHQgICAgICAgICAgaSA9IGZuUXVldWUubGVuZ3RoIC0gMTsgLy8gc2V0IGBpYCB0byB0aGUgbGFzdCBlbGVtZW50IG9mIGBmblF1ZXVlYFxuXHQgICAgICAgICAgc3RhdGUgPSBTVE9QUEVEO1xuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpID0gMDtcblx0ICAgICAgfVxuXHQgICAgICBmblF1ZXVlW2ldLmFwcGx5KG51bGwsIFtdLmNvbmNhdChuZXh0LCBhcmdzUXVldWVbaV0pKTtcblx0ICAgIH1cblx0XG5cdCAgICAvLyBpbnRlcm5hbCBmdW5jdGlvbnMgdGhhdCBhcmUgYGVucXVldWVkYCB2aWEgdGhlIHJlc3BlY3RpdmUgcHVibGljIG1ldGhvZHNcblx0ICAgIGZ1bmN0aW9uIF90eXBlKGNiLCBzdHIsIHNwZWVkKSB7XG5cdCAgICAgIHZhciBsZW4gPSBzdHIubGVuZ3RoO1xuXHQgICAgICBpZiAoIWxlbikge1xuXHQgICAgICAgIHJldHVybiBjYigpO1xuXHQgICAgICB9XG5cdCAgICAgIChmdW5jdGlvbiB0KGkpIHtcblx0ICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgc2V0dGVyKGVsZW0sIGdldHRlcihlbGVtKSArIHN0cltpXSk7XG5cdCAgICAgICAgICBpICs9IDE7XG5cdCAgICAgICAgICBpZiAoaSA8IGxlbikge1xuXHQgICAgICAgICAgICB0KGkpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgY2IoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9LCBzcGVlZCk7XG5cdCAgICAgIH0pKDApO1xuXHQgICAgfVxuXHQgICAgZnVuY3Rpb24gX2RlbGV0ZShjYiwgeCwgc3BlZWQpIHtcblx0ICAgICAgdmFyIGN1cnIgPSBnZXR0ZXIoZWxlbSk7XG5cdCAgICAgIHZhciBjb3VudCA9IGN1cnIubGVuZ3RoOyAvLyBkZWZhdWx0IHRvIGRlbGV0aW5nIGVudGlyZSBjb250ZW50cyBvZiBgZWxlbWBcblx0ICAgICAgaWYgKHggIT0gbnVsbCkge1xuXHQgICAgICAgIGlmICh0eXBlb2YgeCA9PSAnc3RyaW5nJykge1xuXHQgICAgICAgICAgLy8gZGVsZXRlIHRoZSBzdHJpbmcgYHhgIGlmIGFuZCBvbmx5IGlmIGBlbGVtYCBlbmRzIHdpdGggYHhgXG5cdCAgICAgICAgICBpZiAoZW5kc1dpdGgoY3VyciwgeCArIHBvc3RmaXgpKSB7XG5cdCAgICAgICAgICAgIGNvdW50ID0geC5sZW5ndGggKyBwb3N0Zml4Lmxlbmd0aDtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGNvdW50ID0gMDtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgLy8gZGVsZXRlIHRoZSBsYXN0IGB4YCBjaGFyYWN0ZXJzIGZyb20gYGVsZW1gXG5cdCAgICAgICAgICBpZiAoeCA+IC0xKSB7XG5cdCAgICAgICAgICAgIGNvdW50ID0gTWF0aC5taW4oeCwgY291bnQpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICBpZiAoIWNvdW50KSB7XG5cdCAgICAgICAgcmV0dXJuIGNiKCk7XG5cdCAgICAgIH1cblx0ICAgICAgKGZ1bmN0aW9uIGQoY291bnQpIHtcblx0ICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgdmFyIGN1cnIgPSBnZXR0ZXIoZWxlbSk7XG5cdCAgICAgICAgICBpZiAoY291bnQpIHtcblx0ICAgICAgICAgICAgLy8gZHJvcCBsYXN0IGNoYXJcblx0ICAgICAgICAgICAgc2V0dGVyKGVsZW0sIGN1cnIuc3Vic3RyaW5nKDAsIGN1cnIubGVuZ3RoLTEpKTtcblx0ICAgICAgICAgICAgZChjb3VudCAtIDEpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgY2IoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9LCBzcGVlZCk7XG5cdCAgICAgIH0pKGNvdW50KTtcblx0ICAgIH1cblx0ICAgIGZ1bmN0aW9uIF9jbGVhcihjYikge1xuXHQgICAgICBzZXR0ZXIoZWxlbSwgJycpO1xuXHQgICAgICBjYigpO1xuXHQgICAgfVxuXHQgICAgZnVuY3Rpb24gX2NhbGwoY2IsIGZuKSB7XG5cdCAgICAgIGZuLmNhbGwoY2IsIGVsZW0pO1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIGV4cG9zZSB0aGUgcHVibGljIG1ldGhvZHNcblx0ICAgIHNlbGYudHlwZSA9IGZ1bmN0aW9uKHN0ciwgc3BlZWQpIHtcblx0ICAgICAgcmV0dXJuIGVucXVldWUoX3R5cGUsIFtzdHIgKyBwb3N0Zml4LCBzcGVlZCB8fCB0eXBlU3BlZWRdKTtcblx0ICAgIH07XG5cdCAgICBzZWxmLmRlbGV0ZSA9IGZ1bmN0aW9uKHgsIHNwZWVkKSB7XG5cdCAgICAgIHJldHVybiBlbnF1ZXVlKF9kZWxldGUsIFt4LCBzcGVlZCB8fCBkZWxldGVTcGVlZF0pO1xuXHQgICAgfTtcblx0ICAgIHNlbGYuY2xlYXIgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIGVucXVldWUoX2NsZWFyKTtcblx0ICAgIH07XG5cdCAgICBzZWxmLnBhdXNlID0gZnVuY3Rpb24oZGVsYXkpIHtcblx0ICAgICAgcmV0dXJuIGVucXVldWUoc2V0VGltZW91dCwgW2RlbGF5IHx8IHBhdXNlRGVsYXldKTtcblx0ICAgIH07XG5cdCAgICBzZWxmLmNhbGwgPSBmdW5jdGlvbihmbikge1xuXHQgICAgICByZXR1cm4gZW5xdWV1ZShfY2FsbCwgW2ZuXSk7XG5cdCAgICB9O1xuXHQgICAgc2VsZi50cmlnZ2VyUGF1c2UgPSBmdW5jdGlvbihjYikge1xuXHQgICAgICBzdGF0ZSA9IFNUT1BQSU5HO1xuXHQgICAgICBwYXVzZUNiID0gY2IgfHwgbm9vcDtcblx0ICAgICAgcmV0dXJuIHNlbGY7XG5cdCAgICB9O1xuXHQgICAgc2VsZi50cmlnZ2VyUmVzdW1lID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGlmIChzdGF0ZSAhPSBSVU5OSU5HKSB7IC8vIGllLiBgU1RPUFBFRGAgb3IgYFNUT1BQSU5HYFxuXHQgICAgICAgIHZhciBwcmV2U3RhdGUgPSBzdGF0ZTtcblx0ICAgICAgICBzdGF0ZSA9IFJVTk5JTkc7XG5cdCAgICAgICAgaWYgKHByZXZTdGF0ZSA9PSBTVE9QUEVEKSB7XG5cdCAgICAgICAgICBuZXh0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBzZWxmO1xuXHQgICAgfTtcblx0ICAgIHNlbGYuaXNSdW5uaW5nID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHJldHVybiBzdGF0ZSAhPSBTVE9QUEVEOyAvLyBpZS4gYFJVTk5JTkdgIG9yIGBTVE9QUElOR2Bcblx0ICAgIH07XG5cdFxuXHQgIH1cblx0XG5cdCAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi9cblx0ICBpZiAodHJ1ZSkge1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBNYWxhcmtleTtcblx0ICB9IGVsc2Uge1xuXHQgICAgcm9vdC5tYWxhcmtleSA9IE1hbGFya2V5O1xuXHQgIH1cblx0XG5cdH0pKHRoaXMpO1xuXG5cbi8qKiovIH0sXG4vKiA3ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvKlxyXG5cdFx0TUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuXHRcdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcclxuXHQqL1xyXG5cdHZhciBzdHlsZXNJbkRvbSA9IHt9LFxyXG5cdFx0bWVtb2l6ZSA9IGZ1bmN0aW9uKGZuKSB7XHJcblx0XHRcdHZhciBtZW1vO1xyXG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdGlmICh0eXBlb2YgbWVtbyA9PT0gXCJ1bmRlZmluZWRcIikgbWVtbyA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0XHRcdFx0cmV0dXJuIG1lbW87XHJcblx0XHRcdH07XHJcblx0XHR9LFxyXG5cdFx0aXNPbGRJRSA9IG1lbW9pemUoZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiAvbXNpZSBbNi05XVxcYi8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKTtcclxuXHRcdH0pLFxyXG5cdFx0Z2V0SGVhZEVsZW1lbnQgPSBtZW1vaXplKGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0cmV0dXJuIGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdO1xyXG5cdFx0fSksXHJcblx0XHRzaW5nbGV0b25FbGVtZW50ID0gbnVsbCxcclxuXHRcdHNpbmdsZXRvbkNvdW50ZXIgPSAwLFxyXG5cdFx0c3R5bGVFbGVtZW50c0luc2VydGVkQXRUb3AgPSBbXTtcclxuXHRcclxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGxpc3QsIG9wdGlvbnMpIHtcclxuXHRcdGlmKGZhbHNlKSB7XHJcblx0XHRcdGlmKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHN0eWxlLWxvYWRlciBjYW5ub3QgYmUgdXNlZCBpbiBhIG5vbi1icm93c2VyIGVudmlyb25tZW50XCIpO1xyXG5cdFx0fVxyXG5cdFxyXG5cdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcblx0XHQvLyBGb3JjZSBzaW5nbGUtdGFnIHNvbHV0aW9uIG9uIElFNi05LCB3aGljaCBoYXMgYSBoYXJkIGxpbWl0IG9uIHRoZSAjIG9mIDxzdHlsZT5cclxuXHRcdC8vIHRhZ3MgaXQgd2lsbCBhbGxvdyBvbiBhIHBhZ2VcclxuXHRcdGlmICh0eXBlb2Ygb3B0aW9ucy5zaW5nbGV0b24gPT09IFwidW5kZWZpbmVkXCIpIG9wdGlvbnMuc2luZ2xldG9uID0gaXNPbGRJRSgpO1xyXG5cdFxyXG5cdFx0Ly8gQnkgZGVmYXVsdCwgYWRkIDxzdHlsZT4gdGFncyB0byB0aGUgYm90dG9tIG9mIDxoZWFkPi5cclxuXHRcdGlmICh0eXBlb2Ygb3B0aW9ucy5pbnNlcnRBdCA9PT0gXCJ1bmRlZmluZWRcIikgb3B0aW9ucy5pbnNlcnRBdCA9IFwiYm90dG9tXCI7XHJcblx0XHJcblx0XHR2YXIgc3R5bGVzID0gbGlzdFRvU3R5bGVzKGxpc3QpO1xyXG5cdFx0YWRkU3R5bGVzVG9Eb20oc3R5bGVzLCBvcHRpb25zKTtcclxuXHRcclxuXHRcdHJldHVybiBmdW5jdGlvbiB1cGRhdGUobmV3TGlzdCkge1xyXG5cdFx0XHR2YXIgbWF5UmVtb3ZlID0gW107XHJcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHR2YXIgaXRlbSA9IHN0eWxlc1tpXTtcclxuXHRcdFx0XHR2YXIgZG9tU3R5bGUgPSBzdHlsZXNJbkRvbVtpdGVtLmlkXTtcclxuXHRcdFx0XHRkb21TdHlsZS5yZWZzLS07XHJcblx0XHRcdFx0bWF5UmVtb3ZlLnB1c2goZG9tU3R5bGUpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKG5ld0xpc3QpIHtcclxuXHRcdFx0XHR2YXIgbmV3U3R5bGVzID0gbGlzdFRvU3R5bGVzKG5ld0xpc3QpO1xyXG5cdFx0XHRcdGFkZFN0eWxlc1RvRG9tKG5ld1N0eWxlcywgb3B0aW9ucyk7XHJcblx0XHRcdH1cclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IG1heVJlbW92ZS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdHZhciBkb21TdHlsZSA9IG1heVJlbW92ZVtpXTtcclxuXHRcdFx0XHRpZihkb21TdHlsZS5yZWZzID09PSAwKSB7XHJcblx0XHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspXHJcblx0XHRcdFx0XHRcdGRvbVN0eWxlLnBhcnRzW2pdKCk7XHJcblx0XHRcdFx0XHRkZWxldGUgc3R5bGVzSW5Eb21bZG9tU3R5bGUuaWRdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9XHJcblx0XHJcblx0ZnVuY3Rpb24gYWRkU3R5bGVzVG9Eb20oc3R5bGVzLCBvcHRpb25zKSB7XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc3R5bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhciBpdGVtID0gc3R5bGVzW2ldO1xyXG5cdFx0XHR2YXIgZG9tU3R5bGUgPSBzdHlsZXNJbkRvbVtpdGVtLmlkXTtcclxuXHRcdFx0aWYoZG9tU3R5bGUpIHtcclxuXHRcdFx0XHRkb21TdHlsZS5yZWZzKys7XHJcblx0XHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGRvbVN0eWxlLnBhcnRzLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0XHRkb21TdHlsZS5wYXJ0c1tqXShpdGVtLnBhcnRzW2pdKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Zm9yKDsgaiA8IGl0ZW0ucGFydHMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRcdGRvbVN0eWxlLnBhcnRzLnB1c2goYWRkU3R5bGUoaXRlbS5wYXJ0c1tqXSwgb3B0aW9ucykpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR2YXIgcGFydHMgPSBbXTtcclxuXHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0cGFydHMucHVzaChhZGRTdHlsZShpdGVtLnBhcnRzW2pdLCBvcHRpb25zKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHN0eWxlc0luRG9tW2l0ZW0uaWRdID0ge2lkOiBpdGVtLmlkLCByZWZzOiAxLCBwYXJ0czogcGFydHN9O1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGZ1bmN0aW9uIGxpc3RUb1N0eWxlcyhsaXN0KSB7XHJcblx0XHR2YXIgc3R5bGVzID0gW107XHJcblx0XHR2YXIgbmV3U3R5bGVzID0ge307XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgaXRlbSA9IGxpc3RbaV07XHJcblx0XHRcdHZhciBpZCA9IGl0ZW1bMF07XHJcblx0XHRcdHZhciBjc3MgPSBpdGVtWzFdO1xyXG5cdFx0XHR2YXIgbWVkaWEgPSBpdGVtWzJdO1xyXG5cdFx0XHR2YXIgc291cmNlTWFwID0gaXRlbVszXTtcclxuXHRcdFx0dmFyIHBhcnQgPSB7Y3NzOiBjc3MsIG1lZGlhOiBtZWRpYSwgc291cmNlTWFwOiBzb3VyY2VNYXB9O1xyXG5cdFx0XHRpZighbmV3U3R5bGVzW2lkXSlcclxuXHRcdFx0XHRzdHlsZXMucHVzaChuZXdTdHlsZXNbaWRdID0ge2lkOiBpZCwgcGFydHM6IFtwYXJ0XX0pO1xyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0bmV3U3R5bGVzW2lkXS5wYXJ0cy5wdXNoKHBhcnQpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHN0eWxlcztcclxuXHR9XHJcblx0XHJcblx0ZnVuY3Rpb24gaW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMsIHN0eWxlRWxlbWVudCkge1xyXG5cdFx0dmFyIGhlYWQgPSBnZXRIZWFkRWxlbWVudCgpO1xyXG5cdFx0dmFyIGxhc3RTdHlsZUVsZW1lbnRJbnNlcnRlZEF0VG9wID0gc3R5bGVFbGVtZW50c0luc2VydGVkQXRUb3Bbc3R5bGVFbGVtZW50c0luc2VydGVkQXRUb3AubGVuZ3RoIC0gMV07XHJcblx0XHRpZiAob3B0aW9ucy5pbnNlcnRBdCA9PT0gXCJ0b3BcIikge1xyXG5cdFx0XHRpZighbGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3ApIHtcclxuXHRcdFx0XHRoZWFkLmluc2VydEJlZm9yZShzdHlsZUVsZW1lbnQsIGhlYWQuZmlyc3RDaGlsZCk7XHJcblx0XHRcdH0gZWxzZSBpZihsYXN0U3R5bGVFbGVtZW50SW5zZXJ0ZWRBdFRvcC5uZXh0U2libGluZykge1xyXG5cdFx0XHRcdGhlYWQuaW5zZXJ0QmVmb3JlKHN0eWxlRWxlbWVudCwgbGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AubmV4dFNpYmxpbmcpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGhlYWQuYXBwZW5kQ2hpbGQoc3R5bGVFbGVtZW50KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRzdHlsZUVsZW1lbnRzSW5zZXJ0ZWRBdFRvcC5wdXNoKHN0eWxlRWxlbWVudCk7XHJcblx0XHR9IGVsc2UgaWYgKG9wdGlvbnMuaW5zZXJ0QXQgPT09IFwiYm90dG9tXCIpIHtcclxuXHRcdFx0aGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZSBmb3IgcGFyYW1ldGVyICdpbnNlcnRBdCcuIE11c3QgYmUgJ3RvcCcgb3IgJ2JvdHRvbScuXCIpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiByZW1vdmVTdHlsZUVsZW1lbnQoc3R5bGVFbGVtZW50KSB7XHJcblx0XHRzdHlsZUVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG5cdFx0dmFyIGlkeCA9IHN0eWxlRWxlbWVudHNJbnNlcnRlZEF0VG9wLmluZGV4T2Yoc3R5bGVFbGVtZW50KTtcclxuXHRcdGlmKGlkeCA+PSAwKSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudHNJbnNlcnRlZEF0VG9wLnNwbGljZShpZHgsIDEpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBjcmVhdGVTdHlsZUVsZW1lbnQob3B0aW9ucykge1xyXG5cdFx0dmFyIHN0eWxlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcclxuXHRcdHN0eWxlRWxlbWVudC50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xyXG5cdFx0aW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMsIHN0eWxlRWxlbWVudCk7XHJcblx0XHRyZXR1cm4gc3R5bGVFbGVtZW50O1xyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBjcmVhdGVMaW5rRWxlbWVudChvcHRpb25zKSB7XHJcblx0XHR2YXIgbGlua0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlua1wiKTtcclxuXHRcdGxpbmtFbGVtZW50LnJlbCA9IFwic3R5bGVzaGVldFwiO1xyXG5cdFx0aW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMsIGxpbmtFbGVtZW50KTtcclxuXHRcdHJldHVybiBsaW5rRWxlbWVudDtcclxuXHR9XHJcblx0XHJcblx0ZnVuY3Rpb24gYWRkU3R5bGUob2JqLCBvcHRpb25zKSB7XHJcblx0XHR2YXIgc3R5bGVFbGVtZW50LCB1cGRhdGUsIHJlbW92ZTtcclxuXHRcclxuXHRcdGlmIChvcHRpb25zLnNpbmdsZXRvbikge1xyXG5cdFx0XHR2YXIgc3R5bGVJbmRleCA9IHNpbmdsZXRvbkNvdW50ZXIrKztcclxuXHRcdFx0c3R5bGVFbGVtZW50ID0gc2luZ2xldG9uRWxlbWVudCB8fCAoc2luZ2xldG9uRWxlbWVudCA9IGNyZWF0ZVN0eWxlRWxlbWVudChvcHRpb25zKSk7XHJcblx0XHRcdHVwZGF0ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQsIHN0eWxlSW5kZXgsIGZhbHNlKTtcclxuXHRcdFx0cmVtb3ZlID0gYXBwbHlUb1NpbmdsZXRvblRhZy5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCwgc3R5bGVJbmRleCwgdHJ1ZSk7XHJcblx0XHR9IGVsc2UgaWYob2JqLnNvdXJjZU1hcCAmJlxyXG5cdFx0XHR0eXBlb2YgVVJMID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdFx0dHlwZW9mIFVSTC5jcmVhdGVPYmplY3RVUkwgPT09IFwiZnVuY3Rpb25cIiAmJlxyXG5cdFx0XHR0eXBlb2YgVVJMLnJldm9rZU9iamVjdFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHRcdHR5cGVvZiBCbG9iID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdFx0dHlwZW9mIGJ0b2EgPT09IFwiZnVuY3Rpb25cIikge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQgPSBjcmVhdGVMaW5rRWxlbWVudChvcHRpb25zKTtcclxuXHRcdFx0dXBkYXRlID0gdXBkYXRlTGluay5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCk7XHJcblx0XHRcdHJlbW92ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHJlbW92ZVN0eWxlRWxlbWVudChzdHlsZUVsZW1lbnQpO1xyXG5cdFx0XHRcdGlmKHN0eWxlRWxlbWVudC5ocmVmKVxyXG5cdFx0XHRcdFx0VVJMLnJldm9rZU9iamVjdFVSTChzdHlsZUVsZW1lbnQuaHJlZik7XHJcblx0XHRcdH07XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQgPSBjcmVhdGVTdHlsZUVsZW1lbnQob3B0aW9ucyk7XHJcblx0XHRcdHVwZGF0ZSA9IGFwcGx5VG9UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQpO1xyXG5cdFx0XHRyZW1vdmUgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRyZW1vdmVTdHlsZUVsZW1lbnQoc3R5bGVFbGVtZW50KTtcclxuXHRcdFx0fTtcclxuXHRcdH1cclxuXHRcclxuXHRcdHVwZGF0ZShvYmopO1xyXG5cdFxyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZVN0eWxlKG5ld09iaikge1xyXG5cdFx0XHRpZihuZXdPYmopIHtcclxuXHRcdFx0XHRpZihuZXdPYmouY3NzID09PSBvYmouY3NzICYmIG5ld09iai5tZWRpYSA9PT0gb2JqLm1lZGlhICYmIG5ld09iai5zb3VyY2VNYXAgPT09IG9iai5zb3VyY2VNYXApXHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0dXBkYXRlKG9iaiA9IG5ld09iaik7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cmVtb3ZlKCk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0fVxyXG5cdFxyXG5cdHZhciByZXBsYWNlVGV4dCA9IChmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgdGV4dFN0b3JlID0gW107XHJcblx0XHJcblx0XHRyZXR1cm4gZnVuY3Rpb24gKGluZGV4LCByZXBsYWNlbWVudCkge1xyXG5cdFx0XHR0ZXh0U3RvcmVbaW5kZXhdID0gcmVwbGFjZW1lbnQ7XHJcblx0XHRcdHJldHVybiB0ZXh0U3RvcmUuZmlsdGVyKEJvb2xlYW4pLmpvaW4oJ1xcbicpO1xyXG5cdFx0fTtcclxuXHR9KSgpO1xyXG5cdFxyXG5cdGZ1bmN0aW9uIGFwcGx5VG9TaW5nbGV0b25UYWcoc3R5bGVFbGVtZW50LCBpbmRleCwgcmVtb3ZlLCBvYmopIHtcclxuXHRcdHZhciBjc3MgPSByZW1vdmUgPyBcIlwiIDogb2JqLmNzcztcclxuXHRcclxuXHRcdGlmIChzdHlsZUVsZW1lbnQuc3R5bGVTaGVldCkge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQuc3R5bGVTaGVldC5jc3NUZXh0ID0gcmVwbGFjZVRleHQoaW5kZXgsIGNzcyk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR2YXIgY3NzTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcyk7XHJcblx0XHRcdHZhciBjaGlsZE5vZGVzID0gc3R5bGVFbGVtZW50LmNoaWxkTm9kZXM7XHJcblx0XHRcdGlmIChjaGlsZE5vZGVzW2luZGV4XSkgc3R5bGVFbGVtZW50LnJlbW92ZUNoaWxkKGNoaWxkTm9kZXNbaW5kZXhdKTtcclxuXHRcdFx0aWYgKGNoaWxkTm9kZXMubGVuZ3RoKSB7XHJcblx0XHRcdFx0c3R5bGVFbGVtZW50Lmluc2VydEJlZm9yZShjc3NOb2RlLCBjaGlsZE5vZGVzW2luZGV4XSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0c3R5bGVFbGVtZW50LmFwcGVuZENoaWxkKGNzc05vZGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGZ1bmN0aW9uIGFwcGx5VG9UYWcoc3R5bGVFbGVtZW50LCBvYmopIHtcclxuXHRcdHZhciBjc3MgPSBvYmouY3NzO1xyXG5cdFx0dmFyIG1lZGlhID0gb2JqLm1lZGlhO1xyXG5cdFx0dmFyIHNvdXJjZU1hcCA9IG9iai5zb3VyY2VNYXA7XHJcblx0XHJcblx0XHRpZihtZWRpYSkge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWVkaWFcIiwgbWVkaWEpXHJcblx0XHR9XHJcblx0XHJcblx0XHRpZihzdHlsZUVsZW1lbnQuc3R5bGVTaGVldCkge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQuc3R5bGVTaGVldC5jc3NUZXh0ID0gY3NzO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0d2hpbGUoc3R5bGVFbGVtZW50LmZpcnN0Q2hpbGQpIHtcclxuXHRcdFx0XHRzdHlsZUVsZW1lbnQucmVtb3ZlQ2hpbGQoc3R5bGVFbGVtZW50LmZpcnN0Q2hpbGQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHN0eWxlRWxlbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpKTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0ZnVuY3Rpb24gdXBkYXRlTGluayhsaW5rRWxlbWVudCwgb2JqKSB7XHJcblx0XHR2YXIgY3NzID0gb2JqLmNzcztcclxuXHRcdHZhciBtZWRpYSA9IG9iai5tZWRpYTtcclxuXHRcdHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xyXG5cdFxyXG5cdFx0aWYoc291cmNlTWFwKSB7XHJcblx0XHRcdC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzI2NjAzODc1XHJcblx0XHRcdGNzcyArPSBcIlxcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsXCIgKyBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShzb3VyY2VNYXApKSkpICsgXCIgKi9cIjtcclxuXHRcdH1cclxuXHRcclxuXHRcdHZhciBibG9iID0gbmV3IEJsb2IoW2Nzc10sIHsgdHlwZTogXCJ0ZXh0L2Nzc1wiIH0pO1xyXG5cdFxyXG5cdFx0dmFyIG9sZFNyYyA9IGxpbmtFbGVtZW50LmhyZWY7XHJcblx0XHJcblx0XHRsaW5rRWxlbWVudC5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcclxuXHRcclxuXHRcdGlmKG9sZFNyYylcclxuXHRcdFx0VVJMLnJldm9rZU9iamVjdFVSTChvbGRTcmMpO1xyXG5cdH1cclxuXG5cbi8qKiovIH0sXG4vKiA4ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvLyBzdHlsZS1sb2FkZXI6IEFkZHMgc29tZSBjc3MgdG8gdGhlIERPTSBieSBhZGRpbmcgYSA8c3R5bGU+IHRhZ1xuXHRcblx0Ly8gbG9hZCB0aGUgc3R5bGVzXG5cdHZhciBjb250ZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblx0aWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG5cdC8vIGFkZCB0aGUgc3R5bGVzIHRvIHRoZSBET01cblx0dmFyIHVwZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNykoY29udGVudCwge30pO1xuXHRpZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2Fscztcblx0Ly8gSG90IE1vZHVsZSBSZXBsYWNlbWVudFxuXHRpZihmYWxzZSkge1xuXHRcdC8vIFdoZW4gdGhlIHN0eWxlcyBjaGFuZ2UsIHVwZGF0ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdFx0aWYoIWNvbnRlbnQubG9jYWxzKSB7XG5cdFx0XHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuL2luZGV4LmNzc1wiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4vaW5kZXguY3NzXCIpO1xuXHRcdFx0XHRpZih0eXBlb2YgbmV3Q29udGVudCA9PT0gJ3N0cmluZycpIG5ld0NvbnRlbnQgPSBbW21vZHVsZS5pZCwgbmV3Q29udGVudCwgJyddXTtcblx0XHRcdFx0dXBkYXRlKG5ld0NvbnRlbnQpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdC8vIFdoZW4gdGhlIG1vZHVsZSBpcyBkaXNwb3NlZCwgcmVtb3ZlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0XHRtb2R1bGUuaG90LmRpc3Bvc2UoZnVuY3Rpb24oKSB7IHVwZGF0ZSgpOyB9KTtcblx0fVxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiBidW5kbGUuanNcbiAqKi8iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svYm9vdHN0cmFwIDdlNGJiNmE2OTQ1MWFiOWRmYjdjXG4gKiovIiwiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgc3R5bGVzICBmcm9tICdpbmRleC5jc3MnO1xuaW1wb3J0IGNvbmZpZyAgZnJvbSAnaW5kZXguanNvbic7XG5pbXBvcnQgbWFsYXJrZXkgZnJvbSAnbWFsYXJrZXknO1xuXG5jbGFzcyBBcHBDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gIFx0dGhpcy52ZXJzaW9uID0gY29uZmlnLnZlcnNpb247XG4gICAgdGhpcy50eXBpc3RDb25maWcgPSB7XG4gICAgICB3b3JkczogWydIZWxsbywgdHlwaXN0IGF0IHdvcmsgYW5kLi4uJywgJ0hhdmUgYSBuaWNlIGRheSEnXSxcbiAgICAgIGlkOiAnbWFsYXJrZXknLFxuICAgICAgdHlwZVNwZWVkOiA1MCxcbiAgICAgIGRlbGV0ZVNwZWVkOiA1MCxcbiAgICAgIHBhdXNlRGVsYXk6IDUwMCxcbiAgICAgIGxvb3A6IHRydWUsXG4gICAgICBwb3N0Zml4OiAnJ1xuICAgIH07XG4gIH1cbn1cblxuY2xhc3MgVHlwaXN0Q29udHJvbGxlciB7XG5cdGNvbnN0cnVjdG9yKCkge1xuICAgIGxldCBlbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLmNvbmZpZy5pZCk7XG4gICAgbGV0IG9wdHMgPSB7XG4gICAgICB0eXBlU3BlZWQ6IHRoaXMuY29uZmlnLnR5cGVTcGVlZCxcbiAgICAgIGRlbGV0ZVNwZWVkOiB0aGlzLmNvbmZpZy5kZWxldGVTcGVlZCxcbiAgICAgIHBhdXNlRGVsYXk6IHRoaXMuY29uZmlnLnBhdXNlRGVsYXksXG4gICAgICBsb29wOiB0aGlzLmNvbmZpZy5sb29wLFxuICAgICAgcG9zdGZpeDogdGhpcy5jb25maWcucG9zdGZpeFxuICAgIH07XG5cbiAgICBsZXQgYWN0ID0gbWFsYXJrZXkoZWxlbSwgb3B0cyk7XG4gICAgdGhpcy5jb25maWcud29yZHMuZm9yRWFjaCh3ID0+IHtcbiAgICBcdGFjdC50eXBlKHcpLnBhdXNlKCkuZGVsZXRlKCk7XG4gICAgfSk7XG4gIH1cbn1cblxuYW5ndWxhci5tb2R1bGUoJ3R5cGlzdCcsIFtdKVxuICAuY29udHJvbGxlcignQXBwQ29udHJvbGxlcicsIEFwcENvbnRyb2xsZXIpXG4gIC5jb250cm9sbGVyKCdUeXBpc3RDb250cm9sbGVyJywgVHlwaXN0Q29udHJvbGxlcilcbiAgLmNvbXBvbmVudCgndHlwaXN0Jywge1xuXHRcdHJlc3RyaWN0OiAnRScsXG5cdCAgYmluZGluZ3M6IHtcblx0ICBcdGNvbmZpZzogJz0nXG5cdCAgfSxcblx0ICB0ZW1wbGF0ZTogJzxkaXYgbmctYXR0ci1pZD1cInt7Y29uZmlnLmlkfX1cIj48L2Rpdj4nLFxuXHQgIGNvbnRyb2xsZXIgOiAnVHlwaXN0Q29udHJvbGxlcicsXG5cdCAgY29udHJvbGxlckFzOiAndGMnXG4gIH0pO1xuXG5hbmd1bGFyLmJvb3RzdHJhcChkb2N1bWVudCwgWyd0eXBpc3QnXSk7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL2luZGV4LmpzXG4gKiovIiwiLyoqXG4gKiBAbGljZW5zZSBBbmd1bGFySlMgdjEuNS4wXG4gKiAoYykgMjAxMC0yMDE2IEdvb2dsZSwgSW5jLiBodHRwOi8vYW5ndWxhcmpzLm9yZ1xuICogTGljZW5zZTogTUlUXG4gKi9cbihmdW5jdGlvbih3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQpIHsndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogVGhpcyBvYmplY3QgcHJvdmlkZXMgYSB1dGlsaXR5IGZvciBwcm9kdWNpbmcgcmljaCBFcnJvciBtZXNzYWdlcyB3aXRoaW5cbiAqIEFuZ3VsYXIuIEl0IGNhbiBiZSBjYWxsZWQgYXMgZm9sbG93czpcbiAqXG4gKiB2YXIgZXhhbXBsZU1pbkVyciA9IG1pbkVycignZXhhbXBsZScpO1xuICogdGhyb3cgZXhhbXBsZU1pbkVycignb25lJywgJ1RoaXMgezB9IGlzIHsxfScsIGZvbywgYmFyKTtcbiAqXG4gKiBUaGUgYWJvdmUgY3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBtaW5FcnIgaW4gdGhlIGV4YW1wbGUgbmFtZXNwYWNlLiBUaGVcbiAqIHJlc3VsdGluZyBlcnJvciB3aWxsIGhhdmUgYSBuYW1lc3BhY2VkIGVycm9yIGNvZGUgb2YgZXhhbXBsZS5vbmUuICBUaGVcbiAqIHJlc3VsdGluZyBlcnJvciB3aWxsIHJlcGxhY2UgezB9IHdpdGggdGhlIHZhbHVlIG9mIGZvbywgYW5kIHsxfSB3aXRoIHRoZVxuICogdmFsdWUgb2YgYmFyLiBUaGUgb2JqZWN0IGlzIG5vdCByZXN0cmljdGVkIGluIHRoZSBudW1iZXIgb2YgYXJndW1lbnRzIGl0IGNhblxuICogdGFrZS5cbiAqXG4gKiBJZiBmZXdlciBhcmd1bWVudHMgYXJlIHNwZWNpZmllZCB0aGFuIG5lY2Vzc2FyeSBmb3IgaW50ZXJwb2xhdGlvbiwgdGhlIGV4dHJhXG4gKiBpbnRlcnBvbGF0aW9uIG1hcmtlcnMgd2lsbCBiZSBwcmVzZXJ2ZWQgaW4gdGhlIGZpbmFsIHN0cmluZy5cbiAqXG4gKiBTaW5jZSBkYXRhIHdpbGwgYmUgcGFyc2VkIHN0YXRpY2FsbHkgZHVyaW5nIGEgYnVpbGQgc3RlcCwgc29tZSByZXN0cmljdGlvbnNcbiAqIGFyZSBhcHBsaWVkIHdpdGggcmVzcGVjdCB0byBob3cgbWluRXJyIGluc3RhbmNlcyBhcmUgY3JlYXRlZCBhbmQgY2FsbGVkLlxuICogSW5zdGFuY2VzIHNob3VsZCBoYXZlIG5hbWVzIG9mIHRoZSBmb3JtIG5hbWVzcGFjZU1pbkVyciBmb3IgYSBtaW5FcnIgY3JlYXRlZFxuICogdXNpbmcgbWluRXJyKCduYW1lc3BhY2UnKSAuIEVycm9yIGNvZGVzLCBuYW1lc3BhY2VzIGFuZCB0ZW1wbGF0ZSBzdHJpbmdzXG4gKiBzaG91bGQgYWxsIGJlIHN0YXRpYyBzdHJpbmdzLCBub3QgdmFyaWFibGVzIG9yIGdlbmVyYWwgZXhwcmVzc2lvbnMuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG1vZHVsZSBUaGUgbmFtZXNwYWNlIHRvIHVzZSBmb3IgdGhlIG5ldyBtaW5FcnIgaW5zdGFuY2UuXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBFcnJvckNvbnN0cnVjdG9yIEN1c3RvbSBlcnJvciBjb25zdHJ1Y3RvciB0byBiZSBpbnN0YW50aWF0ZWQgd2hlbiByZXR1cm5pbmdcbiAqICAgZXJyb3IgZnJvbSByZXR1cm5lZCBmdW5jdGlvbiwgZm9yIGNhc2VzIHdoZW4gYSBwYXJ0aWN1bGFyIHR5cGUgb2YgZXJyb3IgaXMgdXNlZnVsLlxuICogQHJldHVybnMge2Z1bmN0aW9uKGNvZGU6c3RyaW5nLCB0ZW1wbGF0ZTpzdHJpbmcsIC4uLnRlbXBsYXRlQXJncyk6IEVycm9yfSBtaW5FcnIgaW5zdGFuY2VcbiAqL1xuXG5mdW5jdGlvbiBtaW5FcnIobW9kdWxlLCBFcnJvckNvbnN0cnVjdG9yKSB7XG4gIEVycm9yQ29uc3RydWN0b3IgPSBFcnJvckNvbnN0cnVjdG9yIHx8IEVycm9yO1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIFNLSVBfSU5ERVhFUyA9IDI7XG5cbiAgICB2YXIgdGVtcGxhdGVBcmdzID0gYXJndW1lbnRzLFxuICAgICAgY29kZSA9IHRlbXBsYXRlQXJnc1swXSxcbiAgICAgIG1lc3NhZ2UgPSAnWycgKyAobW9kdWxlID8gbW9kdWxlICsgJzonIDogJycpICsgY29kZSArICddICcsXG4gICAgICB0ZW1wbGF0ZSA9IHRlbXBsYXRlQXJnc1sxXSxcbiAgICAgIHBhcmFtUHJlZml4LCBpO1xuXG4gICAgbWVzc2FnZSArPSB0ZW1wbGF0ZS5yZXBsYWNlKC9cXHtcXGQrXFx9L2csIGZ1bmN0aW9uKG1hdGNoKSB7XG4gICAgICB2YXIgaW5kZXggPSArbWF0Y2guc2xpY2UoMSwgLTEpLFxuICAgICAgICBzaGlmdGVkSW5kZXggPSBpbmRleCArIFNLSVBfSU5ERVhFUztcblxuICAgICAgaWYgKHNoaWZ0ZWRJbmRleCA8IHRlbXBsYXRlQXJncy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHRvRGVidWdTdHJpbmcodGVtcGxhdGVBcmdzW3NoaWZ0ZWRJbmRleF0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbWF0Y2g7XG4gICAgfSk7XG5cbiAgICBtZXNzYWdlICs9ICdcXG5odHRwOi8vZXJyb3JzLmFuZ3VsYXJqcy5vcmcvMS41LjAvJyArXG4gICAgICAobW9kdWxlID8gbW9kdWxlICsgJy8nIDogJycpICsgY29kZTtcblxuICAgIGZvciAoaSA9IFNLSVBfSU5ERVhFUywgcGFyYW1QcmVmaXggPSAnPyc7IGkgPCB0ZW1wbGF0ZUFyZ3MubGVuZ3RoOyBpKyssIHBhcmFtUHJlZml4ID0gJyYnKSB7XG4gICAgICBtZXNzYWdlICs9IHBhcmFtUHJlZml4ICsgJ3AnICsgKGkgLSBTS0lQX0lOREVYRVMpICsgJz0nICtcbiAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHRvRGVidWdTdHJpbmcodGVtcGxhdGVBcmdzW2ldKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBFcnJvckNvbnN0cnVjdG9yKG1lc3NhZ2UpO1xuICB9O1xufVxuXG4vKiBXZSBuZWVkIHRvIHRlbGwganNoaW50IHdoYXQgdmFyaWFibGVzIGFyZSBiZWluZyBleHBvcnRlZCAqL1xuLyogZ2xvYmFsIGFuZ3VsYXI6IHRydWUsXG4gIG1zaWU6IHRydWUsXG4gIGpxTGl0ZTogdHJ1ZSxcbiAgalF1ZXJ5OiB0cnVlLFxuICBzbGljZTogdHJ1ZSxcbiAgc3BsaWNlOiB0cnVlLFxuICBwdXNoOiB0cnVlLFxuICB0b1N0cmluZzogdHJ1ZSxcbiAgbmdNaW5FcnI6IHRydWUsXG4gIGFuZ3VsYXJNb2R1bGU6IHRydWUsXG4gIHVpZDogdHJ1ZSxcbiAgUkVHRVhfU1RSSU5HX1JFR0VYUDogdHJ1ZSxcbiAgVkFMSURJVFlfU1RBVEVfUFJPUEVSVFk6IHRydWUsXG5cbiAgbG93ZXJjYXNlOiB0cnVlLFxuICB1cHBlcmNhc2U6IHRydWUsXG4gIG1hbnVhbExvd2VyY2FzZTogdHJ1ZSxcbiAgbWFudWFsVXBwZXJjYXNlOiB0cnVlLFxuICBub2RlTmFtZV86IHRydWUsXG4gIGlzQXJyYXlMaWtlOiB0cnVlLFxuICBmb3JFYWNoOiB0cnVlLFxuICBmb3JFYWNoU29ydGVkOiB0cnVlLFxuICByZXZlcnNlUGFyYW1zOiB0cnVlLFxuICBuZXh0VWlkOiB0cnVlLFxuICBzZXRIYXNoS2V5OiB0cnVlLFxuICBleHRlbmQ6IHRydWUsXG4gIHRvSW50OiB0cnVlLFxuICBpbmhlcml0OiB0cnVlLFxuICBtZXJnZTogdHJ1ZSxcbiAgbm9vcDogdHJ1ZSxcbiAgaWRlbnRpdHk6IHRydWUsXG4gIHZhbHVlRm46IHRydWUsXG4gIGlzVW5kZWZpbmVkOiB0cnVlLFxuICBpc0RlZmluZWQ6IHRydWUsXG4gIGlzT2JqZWN0OiB0cnVlLFxuICBpc0JsYW5rT2JqZWN0OiB0cnVlLFxuICBpc1N0cmluZzogdHJ1ZSxcbiAgaXNOdW1iZXI6IHRydWUsXG4gIGlzRGF0ZTogdHJ1ZSxcbiAgaXNBcnJheTogdHJ1ZSxcbiAgaXNGdW5jdGlvbjogdHJ1ZSxcbiAgaXNSZWdFeHA6IHRydWUsXG4gIGlzV2luZG93OiB0cnVlLFxuICBpc1Njb3BlOiB0cnVlLFxuICBpc0ZpbGU6IHRydWUsXG4gIGlzRm9ybURhdGE6IHRydWUsXG4gIGlzQmxvYjogdHJ1ZSxcbiAgaXNCb29sZWFuOiB0cnVlLFxuICBpc1Byb21pc2VMaWtlOiB0cnVlLFxuICB0cmltOiB0cnVlLFxuICBlc2NhcGVGb3JSZWdleHA6IHRydWUsXG4gIGlzRWxlbWVudDogdHJ1ZSxcbiAgbWFrZU1hcDogdHJ1ZSxcbiAgaW5jbHVkZXM6IHRydWUsXG4gIGFycmF5UmVtb3ZlOiB0cnVlLFxuICBjb3B5OiB0cnVlLFxuICBzaGFsbG93Q29weTogdHJ1ZSxcbiAgZXF1YWxzOiB0cnVlLFxuICBjc3A6IHRydWUsXG4gIGpxOiB0cnVlLFxuICBjb25jYXQ6IHRydWUsXG4gIHNsaWNlQXJnczogdHJ1ZSxcbiAgYmluZDogdHJ1ZSxcbiAgdG9Kc29uUmVwbGFjZXI6IHRydWUsXG4gIHRvSnNvbjogdHJ1ZSxcbiAgZnJvbUpzb246IHRydWUsXG4gIGNvbnZlcnRUaW1lem9uZVRvTG9jYWw6IHRydWUsXG4gIHRpbWV6b25lVG9PZmZzZXQ6IHRydWUsXG4gIHN0YXJ0aW5nVGFnOiB0cnVlLFxuICB0cnlEZWNvZGVVUklDb21wb25lbnQ6IHRydWUsXG4gIHBhcnNlS2V5VmFsdWU6IHRydWUsXG4gIHRvS2V5VmFsdWU6IHRydWUsXG4gIGVuY29kZVVyaVNlZ21lbnQ6IHRydWUsXG4gIGVuY29kZVVyaVF1ZXJ5OiB0cnVlLFxuICBhbmd1bGFySW5pdDogdHJ1ZSxcbiAgYm9vdHN0cmFwOiB0cnVlLFxuICBnZXRUZXN0YWJpbGl0eTogdHJ1ZSxcbiAgc25ha2VfY2FzZTogdHJ1ZSxcbiAgYmluZEpRdWVyeTogdHJ1ZSxcbiAgYXNzZXJ0QXJnOiB0cnVlLFxuICBhc3NlcnRBcmdGbjogdHJ1ZSxcbiAgYXNzZXJ0Tm90SGFzT3duUHJvcGVydHk6IHRydWUsXG4gIGdldHRlcjogdHJ1ZSxcbiAgZ2V0QmxvY2tOb2RlczogdHJ1ZSxcbiAgaGFzT3duUHJvcGVydHk6IHRydWUsXG4gIGNyZWF0ZU1hcDogdHJ1ZSxcblxuICBOT0RFX1RZUEVfRUxFTUVOVDogdHJ1ZSxcbiAgTk9ERV9UWVBFX0FUVFJJQlVURTogdHJ1ZSxcbiAgTk9ERV9UWVBFX1RFWFQ6IHRydWUsXG4gIE5PREVfVFlQRV9DT01NRU5UOiB0cnVlLFxuICBOT0RFX1RZUEVfRE9DVU1FTlQ6IHRydWUsXG4gIE5PREVfVFlQRV9ET0NVTUVOVF9GUkFHTUVOVDogdHJ1ZSxcbiovXG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vKipcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG5nXG4gKiBAbW9kdWxlIG5nXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiAjIG5nIChjb3JlIG1vZHVsZSlcbiAqIFRoZSBuZyBtb2R1bGUgaXMgbG9hZGVkIGJ5IGRlZmF1bHQgd2hlbiBhbiBBbmd1bGFySlMgYXBwbGljYXRpb24gaXMgc3RhcnRlZC4gVGhlIG1vZHVsZSBpdHNlbGZcbiAqIGNvbnRhaW5zIHRoZSBlc3NlbnRpYWwgY29tcG9uZW50cyBmb3IgYW4gQW5ndWxhckpTIGFwcGxpY2F0aW9uIHRvIGZ1bmN0aW9uLiBUaGUgdGFibGUgYmVsb3dcbiAqIGxpc3RzIGEgaGlnaCBsZXZlbCBicmVha2Rvd24gb2YgZWFjaCBvZiB0aGUgc2VydmljZXMvZmFjdG9yaWVzLCBmaWx0ZXJzLCBkaXJlY3RpdmVzIGFuZCB0ZXN0aW5nXG4gKiBjb21wb25lbnRzIGF2YWlsYWJsZSB3aXRoaW4gdGhpcyBjb3JlIG1vZHVsZS5cbiAqXG4gKiA8ZGl2IGRvYy1tb2R1bGUtY29tcG9uZW50cz1cIm5nXCI+PC9kaXY+XG4gKi9cblxudmFyIFJFR0VYX1NUUklOR19SRUdFWFAgPSAvXlxcLyguKylcXC8oW2Etel0qKSQvO1xuXG4vLyBUaGUgbmFtZSBvZiBhIGZvcm0gY29udHJvbCdzIFZhbGlkaXR5U3RhdGUgcHJvcGVydHkuXG4vLyBUaGlzIGlzIHVzZWQgc28gdGhhdCBpdCdzIHBvc3NpYmxlIGZvciBpbnRlcm5hbCB0ZXN0cyB0byBjcmVhdGUgbW9jayBWYWxpZGl0eVN0YXRlcy5cbnZhciBWQUxJRElUWV9TVEFURV9QUk9QRVJUWSA9ICd2YWxpZGl0eSc7XG5cbnZhciBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cbnZhciBsb3dlcmNhc2UgPSBmdW5jdGlvbihzdHJpbmcpIHtyZXR1cm4gaXNTdHJpbmcoc3RyaW5nKSA/IHN0cmluZy50b0xvd2VyQ2FzZSgpIDogc3RyaW5nO307XG52YXIgdXBwZXJjYXNlID0gZnVuY3Rpb24oc3RyaW5nKSB7cmV0dXJuIGlzU3RyaW5nKHN0cmluZykgPyBzdHJpbmcudG9VcHBlckNhc2UoKSA6IHN0cmluZzt9O1xuXG5cbnZhciBtYW51YWxMb3dlcmNhc2UgPSBmdW5jdGlvbihzKSB7XG4gIC8qIGpzaGludCBiaXR3aXNlOiBmYWxzZSAqL1xuICByZXR1cm4gaXNTdHJpbmcocylcbiAgICAgID8gcy5yZXBsYWNlKC9bQS1aXS9nLCBmdW5jdGlvbihjaCkge3JldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoLmNoYXJDb2RlQXQoMCkgfCAzMik7fSlcbiAgICAgIDogcztcbn07XG52YXIgbWFudWFsVXBwZXJjYXNlID0gZnVuY3Rpb24ocykge1xuICAvKiBqc2hpbnQgYml0d2lzZTogZmFsc2UgKi9cbiAgcmV0dXJuIGlzU3RyaW5nKHMpXG4gICAgICA/IHMucmVwbGFjZSgvW2Etel0vZywgZnVuY3Rpb24oY2gpIHtyZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShjaC5jaGFyQ29kZUF0KDApICYgfjMyKTt9KVxuICAgICAgOiBzO1xufTtcblxuXG4vLyBTdHJpbmcjdG9Mb3dlckNhc2UgYW5kIFN0cmluZyN0b1VwcGVyQ2FzZSBkb24ndCBwcm9kdWNlIGNvcnJlY3QgcmVzdWx0cyBpbiBicm93c2VycyB3aXRoIFR1cmtpc2hcbi8vIGxvY2FsZSwgZm9yIHRoaXMgcmVhc29uIHdlIG5lZWQgdG8gZGV0ZWN0IHRoaXMgY2FzZSBhbmQgcmVkZWZpbmUgbG93ZXJjYXNlL3VwcGVyY2FzZSBtZXRob2RzXG4vLyB3aXRoIGNvcnJlY3QgYnV0IHNsb3dlciBhbHRlcm5hdGl2ZXMuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL2lzc3Vlcy8xMTM4N1xuaWYgKCdpJyAhPT0gJ0knLnRvTG93ZXJDYXNlKCkpIHtcbiAgbG93ZXJjYXNlID0gbWFudWFsTG93ZXJjYXNlO1xuICB1cHBlcmNhc2UgPSBtYW51YWxVcHBlcmNhc2U7XG59XG5cblxudmFyXG4gICAgbXNpZSwgICAgICAgICAgICAgLy8gaG9sZHMgbWFqb3IgdmVyc2lvbiBudW1iZXIgZm9yIElFLCBvciBOYU4gaWYgVUEgaXMgbm90IElFLlxuICAgIGpxTGl0ZSwgICAgICAgICAgIC8vIGRlbGF5IGJpbmRpbmcgc2luY2UgalF1ZXJ5IGNvdWxkIGJlIGxvYWRlZCBhZnRlciB1cy5cbiAgICBqUXVlcnksICAgICAgICAgICAvLyBkZWxheSBiaW5kaW5nXG4gICAgc2xpY2UgICAgICAgICAgICAgPSBbXS5zbGljZSxcbiAgICBzcGxpY2UgICAgICAgICAgICA9IFtdLnNwbGljZSxcbiAgICBwdXNoICAgICAgICAgICAgICA9IFtdLnB1c2gsXG4gICAgdG9TdHJpbmcgICAgICAgICAgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLFxuICAgIGdldFByb3RvdHlwZU9mICAgID0gT2JqZWN0LmdldFByb3RvdHlwZU9mLFxuICAgIG5nTWluRXJyICAgICAgICAgID0gbWluRXJyKCduZycpLFxuXG4gICAgLyoqIEBuYW1lIGFuZ3VsYXIgKi9cbiAgICBhbmd1bGFyICAgICAgICAgICA9IHdpbmRvdy5hbmd1bGFyIHx8ICh3aW5kb3cuYW5ndWxhciA9IHt9KSxcbiAgICBhbmd1bGFyTW9kdWxlLFxuICAgIHVpZCAgICAgICAgICAgICAgID0gMDtcblxuLyoqXG4gKiBkb2N1bWVudE1vZGUgaXMgYW4gSUUtb25seSBwcm9wZXJ0eVxuICogaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2llL2NjMTk2OTg4KHY9dnMuODUpLmFzcHhcbiAqL1xubXNpZSA9IGRvY3VtZW50LmRvY3VtZW50TW9kZTtcblxuXG4vKipcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IG9ialxuICogQHJldHVybiB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIGlmIGBvYmpgIGlzIGFuIGFycmF5IG9yIGFycmF5LWxpa2Ugb2JqZWN0IChOb2RlTGlzdCwgQXJndW1lbnRzLFxuICogICAgICAgICAgICAgICAgICAgU3RyaW5nIC4uLilcbiAqL1xuZnVuY3Rpb24gaXNBcnJheUxpa2Uob2JqKSB7XG5cbiAgLy8gYG51bGxgLCBgdW5kZWZpbmVkYCBhbmQgYHdpbmRvd2AgYXJlIG5vdCBhcnJheS1saWtlXG4gIGlmIChvYmogPT0gbnVsbCB8fCBpc1dpbmRvdyhvYmopKSByZXR1cm4gZmFsc2U7XG5cbiAgLy8gYXJyYXlzLCBzdHJpbmdzIGFuZCBqUXVlcnkvanFMaXRlIG9iamVjdHMgYXJlIGFycmF5IGxpa2VcbiAgLy8gKiBqcUxpdGUgaXMgZWl0aGVyIHRoZSBqUXVlcnkgb3IganFMaXRlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uXG4gIC8vICogd2UgaGF2ZSB0byBjaGVjayB0aGUgZXhpc3RlbmNlIG9mIGpxTGl0ZSBmaXJzdCBhcyB0aGlzIG1ldGhvZCBpcyBjYWxsZWRcbiAgLy8gICB2aWEgdGhlIGZvckVhY2ggbWV0aG9kIHdoZW4gY29uc3RydWN0aW5nIHRoZSBqcUxpdGUgb2JqZWN0IGluIHRoZSBmaXJzdCBwbGFjZVxuICBpZiAoaXNBcnJheShvYmopIHx8IGlzU3RyaW5nKG9iaikgfHwgKGpxTGl0ZSAmJiBvYmogaW5zdGFuY2VvZiBqcUxpdGUpKSByZXR1cm4gdHJ1ZTtcblxuICAvLyBTdXBwb3J0OiBpT1MgOC4yIChub3QgcmVwcm9kdWNpYmxlIGluIHNpbXVsYXRvcilcbiAgLy8gXCJsZW5ndGhcIiBpbiBvYmogdXNlZCB0byBwcmV2ZW50IEpJVCBlcnJvciAoZ2gtMTE1MDgpXG4gIHZhciBsZW5ndGggPSBcImxlbmd0aFwiIGluIE9iamVjdChvYmopICYmIG9iai5sZW5ndGg7XG5cbiAgLy8gTm9kZUxpc3Qgb2JqZWN0cyAod2l0aCBgaXRlbWAgbWV0aG9kKSBhbmRcbiAgLy8gb3RoZXIgb2JqZWN0cyB3aXRoIHN1aXRhYmxlIGxlbmd0aCBjaGFyYWN0ZXJpc3RpY3MgYXJlIGFycmF5LWxpa2VcbiAgcmV0dXJuIGlzTnVtYmVyKGxlbmd0aCkgJiZcbiAgICAobGVuZ3RoID49IDAgJiYgKChsZW5ndGggLSAxKSBpbiBvYmogfHwgb2JqIGluc3RhbmNlb2YgQXJyYXkpIHx8IHR5cGVvZiBvYmouaXRlbSA9PSAnZnVuY3Rpb24nKTtcblxufVxuXG4vKipcbiAqIEBuZ2RvYyBmdW5jdGlvblxuICogQG5hbWUgYW5ndWxhci5mb3JFYWNoXG4gKiBAbW9kdWxlIG5nXG4gKiBAa2luZCBmdW5jdGlvblxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogSW52b2tlcyB0aGUgYGl0ZXJhdG9yYCBmdW5jdGlvbiBvbmNlIGZvciBlYWNoIGl0ZW0gaW4gYG9iamAgY29sbGVjdGlvbiwgd2hpY2ggY2FuIGJlIGVpdGhlciBhblxuICogb2JqZWN0IG9yIGFuIGFycmF5LiBUaGUgYGl0ZXJhdG9yYCBmdW5jdGlvbiBpcyBpbnZva2VkIHdpdGggYGl0ZXJhdG9yKHZhbHVlLCBrZXksIG9iailgLCB3aGVyZSBgdmFsdWVgXG4gKiBpcyB0aGUgdmFsdWUgb2YgYW4gb2JqZWN0IHByb3BlcnR5IG9yIGFuIGFycmF5IGVsZW1lbnQsIGBrZXlgIGlzIHRoZSBvYmplY3QgcHJvcGVydHkga2V5IG9yXG4gKiBhcnJheSBlbGVtZW50IGluZGV4IGFuZCBvYmogaXMgdGhlIGBvYmpgIGl0c2VsZi4gU3BlY2lmeWluZyBhIGBjb250ZXh0YCBmb3IgdGhlIGZ1bmN0aW9uIGlzIG9wdGlvbmFsLlxuICpcbiAqIEl0IGlzIHdvcnRoIG5vdGluZyB0aGF0IGAuZm9yRWFjaGAgZG9lcyBub3QgaXRlcmF0ZSBvdmVyIGluaGVyaXRlZCBwcm9wZXJ0aWVzIGJlY2F1c2UgaXQgZmlsdGVyc1xuICogdXNpbmcgdGhlIGBoYXNPd25Qcm9wZXJ0eWAgbWV0aG9kLlxuICpcbiAqIFVubGlrZSBFUzI2MidzXG4gKiBbQXJyYXkucHJvdG90eXBlLmZvckVhY2hdKGh0dHA6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xNS40LjQuMTgpLFxuICogUHJvdmlkaW5nICd1bmRlZmluZWQnIG9yICdudWxsJyB2YWx1ZXMgZm9yIGBvYmpgIHdpbGwgbm90IHRocm93IGEgVHlwZUVycm9yLCBidXQgcmF0aGVyIGp1c3RcbiAqIHJldHVybiB0aGUgdmFsdWUgcHJvdmlkZWQuXG4gKlxuICAgYGBganNcbiAgICAgdmFyIHZhbHVlcyA9IHtuYW1lOiAnbWlza28nLCBnZW5kZXI6ICdtYWxlJ307XG4gICAgIHZhciBsb2cgPSBbXTtcbiAgICAgYW5ndWxhci5mb3JFYWNoKHZhbHVlcywgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgIHRoaXMucHVzaChrZXkgKyAnOiAnICsgdmFsdWUpO1xuICAgICB9LCBsb2cpO1xuICAgICBleHBlY3QobG9nKS50b0VxdWFsKFsnbmFtZTogbWlza28nLCAnZ2VuZGVyOiBtYWxlJ10pO1xuICAgYGBgXG4gKlxuICogQHBhcmFtIHtPYmplY3R8QXJyYXl9IG9iaiBPYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlcmF0b3IgSXRlcmF0b3IgZnVuY3Rpb24uXG4gKiBAcGFyYW0ge09iamVjdD19IGNvbnRleHQgT2JqZWN0IHRvIGJlY29tZSBjb250ZXh0IChgdGhpc2ApIGZvciB0aGUgaXRlcmF0b3IgZnVuY3Rpb24uXG4gKiBAcmV0dXJucyB7T2JqZWN0fEFycmF5fSBSZWZlcmVuY2UgdG8gYG9iamAuXG4gKi9cblxuZnVuY3Rpb24gZm9yRWFjaChvYmosIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG4gIHZhciBrZXksIGxlbmd0aDtcbiAgaWYgKG9iaikge1xuICAgIGlmIChpc0Z1bmN0aW9uKG9iaikpIHtcbiAgICAgIGZvciAoa2V5IGluIG9iaikge1xuICAgICAgICAvLyBOZWVkIHRvIGNoZWNrIGlmIGhhc093blByb3BlcnR5IGV4aXN0cyxcbiAgICAgICAgLy8gYXMgb24gSUU4IHRoZSByZXN1bHQgb2YgcXVlcnlTZWxlY3RvckFsbCBpcyBhbiBvYmplY3Qgd2l0aG91dCBhIGhhc093blByb3BlcnR5IGZ1bmN0aW9uXG4gICAgICAgIGlmIChrZXkgIT0gJ3Byb3RvdHlwZScgJiYga2V5ICE9ICdsZW5ndGgnICYmIGtleSAhPSAnbmFtZScgJiYgKCFvYmouaGFzT3duUHJvcGVydHkgfHwgb2JqLmhhc093blByb3BlcnR5KGtleSkpKSB7XG4gICAgICAgICAgaXRlcmF0b3IuY2FsbChjb250ZXh0LCBvYmpba2V5XSwga2V5LCBvYmopO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChpc0FycmF5KG9iaikgfHwgaXNBcnJheUxpa2Uob2JqKSkge1xuICAgICAgdmFyIGlzUHJpbWl0aXZlID0gdHlwZW9mIG9iaiAhPT0gJ29iamVjdCc7XG4gICAgICBmb3IgKGtleSA9IDAsIGxlbmd0aCA9IG9iai5sZW5ndGg7IGtleSA8IGxlbmd0aDsga2V5KyspIHtcbiAgICAgICAgaWYgKGlzUHJpbWl0aXZlIHx8IGtleSBpbiBvYmopIHtcbiAgICAgICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtrZXldLCBrZXksIG9iaik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKG9iai5mb3JFYWNoICYmIG9iai5mb3JFYWNoICE9PSBmb3JFYWNoKSB7XG4gICAgICAgIG9iai5mb3JFYWNoKGl0ZXJhdG9yLCBjb250ZXh0LCBvYmopO1xuICAgIH0gZWxzZSBpZiAoaXNCbGFua09iamVjdChvYmopKSB7XG4gICAgICAvLyBjcmVhdGVNYXAoKSBmYXN0IHBhdGggLS0tIFNhZmUgdG8gYXZvaWQgaGFzT3duUHJvcGVydHkgY2hlY2sgYmVjYXVzZSBwcm90b3R5cGUgY2hhaW4gaXMgZW1wdHlcbiAgICAgIGZvciAoa2V5IGluIG9iaikge1xuICAgICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtrZXldLCBrZXksIG9iaik7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2Ygb2JqLmhhc093blByb3BlcnR5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAvLyBTbG93IHBhdGggZm9yIG9iamVjdHMgaW5oZXJpdGluZyBPYmplY3QucHJvdG90eXBlLCBoYXNPd25Qcm9wZXJ0eSBjaGVjayBuZWVkZWRcbiAgICAgIGZvciAoa2V5IGluIG9iaikge1xuICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtrZXldLCBrZXksIG9iaik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU2xvdyBwYXRoIGZvciBvYmplY3RzIHdoaWNoIGRvIG5vdCBoYXZlIGEgbWV0aG9kIGBoYXNPd25Qcm9wZXJ0eWBcbiAgICAgIGZvciAoa2V5IGluIG9iaikge1xuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcbiAgICAgICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtrZXldLCBrZXksIG9iaik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cblxuZnVuY3Rpb24gZm9yRWFjaFNvcnRlZChvYmosIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqKS5zb3J0KCk7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgIGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgb2JqW2tleXNbaV1dLCBrZXlzW2ldKTtcbiAgfVxuICByZXR1cm4ga2V5cztcbn1cblxuXG4vKipcbiAqIHdoZW4gdXNpbmcgZm9yRWFjaCB0aGUgcGFyYW1zIGFyZSB2YWx1ZSwga2V5LCBidXQgaXQgaXMgb2Z0ZW4gdXNlZnVsIHRvIGhhdmUga2V5LCB2YWx1ZS5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nLCAqKX0gaXRlcmF0b3JGblxuICogQHJldHVybnMge2Z1bmN0aW9uKCosIHN0cmluZyl9XG4gKi9cbmZ1bmN0aW9uIHJldmVyc2VQYXJhbXMoaXRlcmF0b3JGbikge1xuICByZXR1cm4gZnVuY3Rpb24odmFsdWUsIGtleSkge2l0ZXJhdG9yRm4oa2V5LCB2YWx1ZSk7fTtcbn1cblxuLyoqXG4gKiBBIGNvbnNpc3RlbnQgd2F5IG9mIGNyZWF0aW5nIHVuaXF1ZSBJRHMgaW4gYW5ndWxhci5cbiAqXG4gKiBVc2luZyBzaW1wbGUgbnVtYmVycyBhbGxvd3MgdXMgdG8gZ2VuZXJhdGUgMjguNiBtaWxsaW9uIHVuaXF1ZSBpZHMgcGVyIHNlY29uZCBmb3IgMTAgeWVhcnMgYmVmb3JlXG4gKiB3ZSBoaXQgbnVtYmVyIHByZWNpc2lvbiBpc3N1ZXMgaW4gSmF2YVNjcmlwdC5cbiAqXG4gKiBNYXRoLnBvdygyLDUzKSAvIDYwIC8gNjAgLyAyNCAvIDM2NSAvIDEwID0gMjguNk1cbiAqXG4gKiBAcmV0dXJucyB7bnVtYmVyfSBhbiB1bmlxdWUgYWxwaGEtbnVtZXJpYyBzdHJpbmdcbiAqL1xuZnVuY3Rpb24gbmV4dFVpZCgpIHtcbiAgcmV0dXJuICsrdWlkO1xufVxuXG5cbi8qKlxuICogU2V0IG9yIGNsZWFyIHRoZSBoYXNoa2V5IGZvciBhbiBvYmplY3QuXG4gKiBAcGFyYW0gb2JqIG9iamVjdFxuICogQHBhcmFtIGggdGhlIGhhc2hrZXkgKCF0cnV0aHkgdG8gZGVsZXRlIHRoZSBoYXNoa2V5KVxuICovXG5mdW5jdGlvbiBzZXRIYXNoS2V5KG9iaiwgaCkge1xuICBpZiAoaCkge1xuICAgIG9iai4kJGhhc2hLZXkgPSBoO1xuICB9IGVsc2Uge1xuICAgIGRlbGV0ZSBvYmouJCRoYXNoS2V5O1xuICB9XG59XG5cblxuZnVuY3Rpb24gYmFzZUV4dGVuZChkc3QsIG9ianMsIGRlZXApIHtcbiAgdmFyIGggPSBkc3QuJCRoYXNoS2V5O1xuXG4gIGZvciAodmFyIGkgPSAwLCBpaSA9IG9ianMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgIHZhciBvYmogPSBvYmpzW2ldO1xuICAgIGlmICghaXNPYmplY3Qob2JqKSAmJiAhaXNGdW5jdGlvbihvYmopKSBjb250aW51ZTtcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iaik7XG4gICAgZm9yICh2YXIgaiA9IDAsIGpqID0ga2V5cy5sZW5ndGg7IGogPCBqajsgaisrKSB7XG4gICAgICB2YXIga2V5ID0ga2V5c1tqXTtcbiAgICAgIHZhciBzcmMgPSBvYmpba2V5XTtcblxuICAgICAgaWYgKGRlZXAgJiYgaXNPYmplY3Qoc3JjKSkge1xuICAgICAgICBpZiAoaXNEYXRlKHNyYykpIHtcbiAgICAgICAgICBkc3Rba2V5XSA9IG5ldyBEYXRlKHNyYy52YWx1ZU9mKCkpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzUmVnRXhwKHNyYykpIHtcbiAgICAgICAgICBkc3Rba2V5XSA9IG5ldyBSZWdFeHAoc3JjKTtcbiAgICAgICAgfSBlbHNlIGlmIChzcmMubm9kZU5hbWUpIHtcbiAgICAgICAgICBkc3Rba2V5XSA9IHNyYy5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNFbGVtZW50KHNyYykpIHtcbiAgICAgICAgICBkc3Rba2V5XSA9IHNyYy5jbG9uZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICghaXNPYmplY3QoZHN0W2tleV0pKSBkc3Rba2V5XSA9IGlzQXJyYXkoc3JjKSA/IFtdIDoge307XG4gICAgICAgICAgYmFzZUV4dGVuZChkc3Rba2V5XSwgW3NyY10sIHRydWUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkc3Rba2V5XSA9IHNyYztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzZXRIYXNoS2V5KGRzdCwgaCk7XG4gIHJldHVybiBkc3Q7XG59XG5cbi8qKlxuICogQG5nZG9jIGZ1bmN0aW9uXG4gKiBAbmFtZSBhbmd1bGFyLmV4dGVuZFxuICogQG1vZHVsZSBuZ1xuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIEV4dGVuZHMgdGhlIGRlc3RpbmF0aW9uIG9iamVjdCBgZHN0YCBieSBjb3B5aW5nIG93biBlbnVtZXJhYmxlIHByb3BlcnRpZXMgZnJvbSB0aGUgYHNyY2Agb2JqZWN0KHMpXG4gKiB0byBgZHN0YC4gWW91IGNhbiBzcGVjaWZ5IG11bHRpcGxlIGBzcmNgIG9iamVjdHMuIElmIHlvdSB3YW50IHRvIHByZXNlcnZlIG9yaWdpbmFsIG9iamVjdHMsIHlvdSBjYW4gZG8gc29cbiAqIGJ5IHBhc3NpbmcgYW4gZW1wdHkgb2JqZWN0IGFzIHRoZSB0YXJnZXQ6IGB2YXIgb2JqZWN0ID0gYW5ndWxhci5leHRlbmQoe30sIG9iamVjdDEsIG9iamVjdDIpYC5cbiAqXG4gKiAqKk5vdGU6KiogS2VlcCBpbiBtaW5kIHRoYXQgYGFuZ3VsYXIuZXh0ZW5kYCBkb2VzIG5vdCBzdXBwb3J0IHJlY3Vyc2l2ZSBtZXJnZSAoZGVlcCBjb3B5KS4gVXNlXG4gKiB7QGxpbmsgYW5ndWxhci5tZXJnZX0gZm9yIHRoaXMuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGRzdCBEZXN0aW5hdGlvbiBvYmplY3QuXG4gKiBAcGFyYW0gey4uLk9iamVjdH0gc3JjIFNvdXJjZSBvYmplY3QocykuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZWZlcmVuY2UgdG8gYGRzdGAuXG4gKi9cbmZ1bmN0aW9uIGV4dGVuZChkc3QpIHtcbiAgcmV0dXJuIGJhc2VFeHRlbmQoZHN0LCBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSksIGZhbHNlKTtcbn1cblxuXG4vKipcbiogQG5nZG9jIGZ1bmN0aW9uXG4qIEBuYW1lIGFuZ3VsYXIubWVyZ2VcbiogQG1vZHVsZSBuZ1xuKiBAa2luZCBmdW5jdGlvblxuKlxuKiBAZGVzY3JpcHRpb25cbiogRGVlcGx5IGV4dGVuZHMgdGhlIGRlc3RpbmF0aW9uIG9iamVjdCBgZHN0YCBieSBjb3B5aW5nIG93biBlbnVtZXJhYmxlIHByb3BlcnRpZXMgZnJvbSB0aGUgYHNyY2Agb2JqZWN0KHMpXG4qIHRvIGBkc3RgLiBZb3UgY2FuIHNwZWNpZnkgbXVsdGlwbGUgYHNyY2Agb2JqZWN0cy4gSWYgeW91IHdhbnQgdG8gcHJlc2VydmUgb3JpZ2luYWwgb2JqZWN0cywgeW91IGNhbiBkbyBzb1xuKiBieSBwYXNzaW5nIGFuIGVtcHR5IG9iamVjdCBhcyB0aGUgdGFyZ2V0OiBgdmFyIG9iamVjdCA9IGFuZ3VsYXIubWVyZ2Uoe30sIG9iamVjdDEsIG9iamVjdDIpYC5cbipcbiogVW5saWtlIHtAbGluayBhbmd1bGFyLmV4dGVuZCBleHRlbmQoKX0sIGBtZXJnZSgpYCByZWN1cnNpdmVseSBkZXNjZW5kcyBpbnRvIG9iamVjdCBwcm9wZXJ0aWVzIG9mIHNvdXJjZVxuKiBvYmplY3RzLCBwZXJmb3JtaW5nIGEgZGVlcCBjb3B5LlxuKlxuKiBAcGFyYW0ge09iamVjdH0gZHN0IERlc3RpbmF0aW9uIG9iamVjdC5cbiogQHBhcmFtIHsuLi5PYmplY3R9IHNyYyBTb3VyY2Ugb2JqZWN0KHMpLlxuKiBAcmV0dXJucyB7T2JqZWN0fSBSZWZlcmVuY2UgdG8gYGRzdGAuXG4qL1xuZnVuY3Rpb24gbWVyZ2UoZHN0KSB7XG4gIHJldHVybiBiYXNlRXh0ZW5kKGRzdCwgc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpLCB0cnVlKTtcbn1cblxuXG5cbmZ1bmN0aW9uIHRvSW50KHN0cikge1xuICByZXR1cm4gcGFyc2VJbnQoc3RyLCAxMCk7XG59XG5cblxuZnVuY3Rpb24gaW5oZXJpdChwYXJlbnQsIGV4dHJhKSB7XG4gIHJldHVybiBleHRlbmQoT2JqZWN0LmNyZWF0ZShwYXJlbnQpLCBleHRyYSk7XG59XG5cbi8qKlxuICogQG5nZG9jIGZ1bmN0aW9uXG4gKiBAbmFtZSBhbmd1bGFyLm5vb3BcbiAqIEBtb2R1bGUgbmdcbiAqIEBraW5kIGZ1bmN0aW9uXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBBIGZ1bmN0aW9uIHRoYXQgcGVyZm9ybXMgbm8gb3BlcmF0aW9ucy4gVGhpcyBmdW5jdGlvbiBjYW4gYmUgdXNlZnVsIHdoZW4gd3JpdGluZyBjb2RlIGluIHRoZVxuICogZnVuY3Rpb25hbCBzdHlsZS5cbiAgIGBgYGpzXG4gICAgIGZ1bmN0aW9uIGZvbyhjYWxsYmFjaykge1xuICAgICAgIHZhciByZXN1bHQgPSBjYWxjdWxhdGVSZXN1bHQoKTtcbiAgICAgICAoY2FsbGJhY2sgfHwgYW5ndWxhci5ub29wKShyZXN1bHQpO1xuICAgICB9XG4gICBgYGBcbiAqL1xuZnVuY3Rpb24gbm9vcCgpIHt9XG5ub29wLiRpbmplY3QgPSBbXTtcblxuXG4vKipcbiAqIEBuZ2RvYyBmdW5jdGlvblxuICogQG5hbWUgYW5ndWxhci5pZGVudGl0eVxuICogQG1vZHVsZSBuZ1xuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGl0cyBmaXJzdCBhcmd1bWVudC4gVGhpcyBmdW5jdGlvbiBpcyB1c2VmdWwgd2hlbiB3cml0aW5nIGNvZGUgaW4gdGhlXG4gKiBmdW5jdGlvbmFsIHN0eWxlLlxuICpcbiAgIGBgYGpzXG4gICAgIGZ1bmN0aW9uIHRyYW5zZm9ybWVyKHRyYW5zZm9ybWF0aW9uRm4sIHZhbHVlKSB7XG4gICAgICAgcmV0dXJuICh0cmFuc2Zvcm1hdGlvbkZuIHx8IGFuZ3VsYXIuaWRlbnRpdHkpKHZhbHVlKTtcbiAgICAgfTtcbiAgIGBgYFxuICAqIEBwYXJhbSB7Kn0gdmFsdWUgdG8gYmUgcmV0dXJuZWQuXG4gICogQHJldHVybnMgeyp9IHRoZSB2YWx1ZSBwYXNzZWQgaW4uXG4gKi9cbmZ1bmN0aW9uIGlkZW50aXR5KCQpIHtyZXR1cm4gJDt9XG5pZGVudGl0eS4kaW5qZWN0ID0gW107XG5cblxuZnVuY3Rpb24gdmFsdWVGbih2YWx1ZSkge3JldHVybiBmdW5jdGlvbigpIHtyZXR1cm4gdmFsdWU7fTt9XG5cbmZ1bmN0aW9uIGhhc0N1c3RvbVRvU3RyaW5nKG9iaikge1xuICByZXR1cm4gaXNGdW5jdGlvbihvYmoudG9TdHJpbmcpICYmIG9iai50b1N0cmluZyAhPT0gdG9TdHJpbmc7XG59XG5cblxuLyoqXG4gKiBAbmdkb2MgZnVuY3Rpb25cbiAqIEBuYW1lIGFuZ3VsYXIuaXNVbmRlZmluZWRcbiAqIEBtb2R1bGUgbmdcbiAqIEBraW5kIGZ1bmN0aW9uXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBEZXRlcm1pbmVzIGlmIGEgcmVmZXJlbmNlIGlzIHVuZGVmaW5lZC5cbiAqXG4gKiBAcGFyYW0geyp9IHZhbHVlIFJlZmVyZW5jZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGB2YWx1ZWAgaXMgdW5kZWZpbmVkLlxuICovXG5mdW5jdGlvbiBpc1VuZGVmaW5lZCh2YWx1ZSkge3JldHVybiB0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnO31cblxuXG4vKipcbiAqIEBuZ2RvYyBmdW5jdGlvblxuICogQG5hbWUgYW5ndWxhci5pc0RlZmluZWRcbiAqIEBtb2R1bGUgbmdcbiAqIEBraW5kIGZ1bmN0aW9uXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBEZXRlcm1pbmVzIGlmIGEgcmVmZXJlbmNlIGlzIGRlZmluZWQuXG4gKlxuICogQHBhcmFtIHsqfSB2YWx1ZSBSZWZlcmVuY2UgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGlzIGRlZmluZWQuXG4gKi9cbmZ1bmN0aW9uIGlzRGVmaW5lZCh2YWx1ZSkge3JldHVybiB0eXBlb2YgdmFsdWUgIT09ICd1bmRlZmluZWQnO31cblxuXG4vKipcbiAqIEBuZ2RvYyBmdW5jdGlvblxuICogQG5hbWUgYW5ndWxhci5pc09iamVjdFxuICogQG1vZHVsZSBuZ1xuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIERldGVybWluZXMgaWYgYSByZWZlcmVuY2UgaXMgYW4gYE9iamVjdGAuIFVubGlrZSBgdHlwZW9mYCBpbiBKYXZhU2NyaXB0LCBgbnVsbGBzIGFyZSBub3RcbiAqIGNvbnNpZGVyZWQgdG8gYmUgb2JqZWN0cy4gTm90ZSB0aGF0IEphdmFTY3JpcHQgYXJyYXlzIGFyZSBvYmplY3RzLlxuICpcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgUmVmZXJlbmNlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgYHZhbHVlYCBpcyBhbiBgT2JqZWN0YCBidXQgbm90IGBudWxsYC5cbiAqL1xuZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgLy8gaHR0cDovL2pzcGVyZi5jb20vaXNvYmplY3Q0XG4gIHJldHVybiB2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnO1xufVxuXG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYW4gb2JqZWN0IHdpdGggYSBudWxsIHByb3RvdHlwZVxuICpcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGB2YWx1ZWAgaXMgYW4gYE9iamVjdGAgd2l0aCBhIG51bGwgcHJvdG90eXBlXG4gKi9cbmZ1bmN0aW9uIGlzQmxhbmtPYmplY3QodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgIWdldFByb3RvdHlwZU9mKHZhbHVlKTtcbn1cblxuXG4vKipcbiAqIEBuZ2RvYyBmdW5jdGlvblxuICogQG5hbWUgYW5ndWxhci5pc1N0cmluZ1xuICogQG1vZHVsZSBuZ1xuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIERldGVybWluZXMgaWYgYSByZWZlcmVuY2UgaXMgYSBgU3RyaW5nYC5cbiAqXG4gKiBAcGFyYW0geyp9IHZhbHVlIFJlZmVyZW5jZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGB2YWx1ZWAgaXMgYSBgU3RyaW5nYC5cbiAqL1xuZnVuY3Rpb24gaXNTdHJpbmcodmFsdWUpIHtyZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJzt9XG5cblxuLyoqXG4gKiBAbmdkb2MgZnVuY3Rpb25cbiAqIEBuYW1lIGFuZ3VsYXIuaXNOdW1iZXJcbiAqIEBtb2R1bGUgbmdcbiAqIEBraW5kIGZ1bmN0aW9uXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBEZXRlcm1pbmVzIGlmIGEgcmVmZXJlbmNlIGlzIGEgYE51bWJlcmAuXG4gKlxuICogVGhpcyBpbmNsdWRlcyB0aGUgXCJzcGVjaWFsXCIgbnVtYmVycyBgTmFOYCwgYCtJbmZpbml0eWAgYW5kIGAtSW5maW5pdHlgLlxuICpcbiAqIElmIHlvdSB3aXNoIHRvIGV4Y2x1ZGUgdGhlc2UgdGhlbiB5b3UgY2FuIHVzZSB0aGUgbmF0aXZlXG4gKiBbYGlzRmluaXRlJ10oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvaXNGaW5pdGUpXG4gKiBtZXRob2QuXG4gKlxuICogQHBhcmFtIHsqfSB2YWx1ZSBSZWZlcmVuY2UgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGlzIGEgYE51bWJlcmAuXG4gKi9cbmZ1bmN0aW9uIGlzTnVtYmVyKHZhbHVlKSB7cmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcic7fVxuXG5cbi8qKlxuICogQG5nZG9jIGZ1bmN0aW9uXG4gKiBAbmFtZSBhbmd1bGFyLmlzRGF0ZVxuICogQG1vZHVsZSBuZ1xuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIERldGVybWluZXMgaWYgYSB2YWx1ZSBpcyBhIGRhdGUuXG4gKlxuICogQHBhcmFtIHsqfSB2YWx1ZSBSZWZlcmVuY2UgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGlzIGEgYERhdGVgLlxuICovXG5mdW5jdGlvbiBpc0RhdGUodmFsdWUpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsdWUpID09PSAnW29iamVjdCBEYXRlXSc7XG59XG5cblxuLyoqXG4gKiBAbmdkb2MgZnVuY3Rpb25cbiAqIEBuYW1lIGFuZ3VsYXIuaXNBcnJheVxuICogQG1vZHVsZSBuZ1xuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIERldGVybWluZXMgaWYgYSByZWZlcmVuY2UgaXMgYW4gYEFycmF5YC5cbiAqXG4gKiBAcGFyYW0geyp9IHZhbHVlIFJlZmVyZW5jZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGB2YWx1ZWAgaXMgYW4gYEFycmF5YC5cbiAqL1xudmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5O1xuXG4vKipcbiAqIEBuZ2RvYyBmdW5jdGlvblxuICogQG5hbWUgYW5ndWxhci5pc0Z1bmN0aW9uXG4gKiBAbW9kdWxlIG5nXG4gKiBAa2luZCBmdW5jdGlvblxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogRGV0ZXJtaW5lcyBpZiBhIHJlZmVyZW5jZSBpcyBhIGBGdW5jdGlvbmAuXG4gKlxuICogQHBhcmFtIHsqfSB2YWx1ZSBSZWZlcmVuY2UgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGlzIGEgYEZ1bmN0aW9uYC5cbiAqL1xuZnVuY3Rpb24gaXNGdW5jdGlvbih2YWx1ZSkge3JldHVybiB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbic7fVxuXG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiBhIHZhbHVlIGlzIGEgcmVndWxhciBleHByZXNzaW9uIG9iamVjdC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHsqfSB2YWx1ZSBSZWZlcmVuY2UgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGlzIGEgYFJlZ0V4cGAuXG4gKi9cbmZ1bmN0aW9uIGlzUmVnRXhwKHZhbHVlKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gJ1tvYmplY3QgUmVnRXhwXSc7XG59XG5cblxuLyoqXG4gKiBDaGVja3MgaWYgYG9iamAgaXMgYSB3aW5kb3cgb2JqZWN0LlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IG9iaiBPYmplY3QgdG8gY2hlY2tcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGBvYmpgIGlzIGEgd2luZG93IG9iai5cbiAqL1xuZnVuY3Rpb24gaXNXaW5kb3cob2JqKSB7XG4gIHJldHVybiBvYmogJiYgb2JqLndpbmRvdyA9PT0gb2JqO1xufVxuXG5cbmZ1bmN0aW9uIGlzU2NvcGUob2JqKSB7XG4gIHJldHVybiBvYmogJiYgb2JqLiRldmFsQXN5bmMgJiYgb2JqLiR3YXRjaDtcbn1cblxuXG5mdW5jdGlvbiBpc0ZpbGUob2JqKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEZpbGVdJztcbn1cblxuXG5mdW5jdGlvbiBpc0Zvcm1EYXRhKG9iaikge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09PSAnW29iamVjdCBGb3JtRGF0YV0nO1xufVxuXG5cbmZ1bmN0aW9uIGlzQmxvYihvYmopIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgQmxvYl0nO1xufVxuXG5cbmZ1bmN0aW9uIGlzQm9vbGVhbih2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbic7XG59XG5cblxuZnVuY3Rpb24gaXNQcm9taXNlTGlrZShvYmopIHtcbiAgcmV0dXJuIG9iaiAmJiBpc0Z1bmN0aW9uKG9iai50aGVuKTtcbn1cblxuXG52YXIgVFlQRURfQVJSQVlfUkVHRVhQID0gL15cXFtvYmplY3QgKD86VWludDh8VWludDhDbGFtcGVkfFVpbnQxNnxVaW50MzJ8SW50OHxJbnQxNnxJbnQzMnxGbG9hdDMyfEZsb2F0NjQpQXJyYXlcXF0kLztcbmZ1bmN0aW9uIGlzVHlwZWRBcnJheSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgJiYgaXNOdW1iZXIodmFsdWUubGVuZ3RoKSAmJiBUWVBFRF9BUlJBWV9SRUdFWFAudGVzdCh0b1N0cmluZy5jYWxsKHZhbHVlKSk7XG59XG5cbmZ1bmN0aW9uIGlzQXJyYXlCdWZmZXIob2JqKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5QnVmZmVyXSc7XG59XG5cblxudmFyIHRyaW0gPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gaXNTdHJpbmcodmFsdWUpID8gdmFsdWUudHJpbSgpIDogdmFsdWU7XG59O1xuXG4vLyBDb3BpZWQgZnJvbTpcbi8vIGh0dHA6Ly9kb2NzLmNsb3N1cmUtbGlicmFyeS5nb29nbGVjb2RlLmNvbS9naXQvbG9jYWxfY2xvc3VyZV9nb29nX3N0cmluZ19zdHJpbmcuanMuc291cmNlLmh0bWwjbGluZTEwMjFcbi8vIFByZXJlcTogcyBpcyBhIHN0cmluZy5cbnZhciBlc2NhcGVGb3JSZWdleHAgPSBmdW5jdGlvbihzKSB7XG4gIHJldHVybiBzLnJlcGxhY2UoLyhbLSgpXFxbXFxde30rPyouJFxcXnwsOiM8IVxcXFxdKS9nLCAnXFxcXCQxJykuXG4gICAgICAgICAgIHJlcGxhY2UoL1xceDA4L2csICdcXFxceDA4Jyk7XG59O1xuXG5cbi8qKlxuICogQG5nZG9jIGZ1bmN0aW9uXG4gKiBAbmFtZSBhbmd1bGFyLmlzRWxlbWVudFxuICogQG1vZHVsZSBuZ1xuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIERldGVybWluZXMgaWYgYSByZWZlcmVuY2UgaXMgYSBET00gZWxlbWVudCAob3Igd3JhcHBlZCBqUXVlcnkgZWxlbWVudCkuXG4gKlxuICogQHBhcmFtIHsqfSB2YWx1ZSBSZWZlcmVuY2UgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGlzIGEgRE9NIGVsZW1lbnQgKG9yIHdyYXBwZWQgalF1ZXJ5IGVsZW1lbnQpLlxuICovXG5mdW5jdGlvbiBpc0VsZW1lbnQobm9kZSkge1xuICByZXR1cm4gISEobm9kZSAmJlxuICAgIChub2RlLm5vZGVOYW1lICAvLyB3ZSBhcmUgYSBkaXJlY3QgZWxlbWVudFxuICAgIHx8IChub2RlLnByb3AgJiYgbm9kZS5hdHRyICYmIG5vZGUuZmluZCkpKTsgIC8vIHdlIGhhdmUgYW4gb24gYW5kIGZpbmQgbWV0aG9kIHBhcnQgb2YgalF1ZXJ5IEFQSVxufVxuXG4vKipcbiAqIEBwYXJhbSBzdHIgJ2tleTEsa2V5MiwuLi4nXG4gKiBAcmV0dXJucyB7b2JqZWN0fSBpbiB0aGUgZm9ybSBvZiB7a2V5MTp0cnVlLCBrZXkyOnRydWUsIC4uLn1cbiAqL1xuZnVuY3Rpb24gbWFrZU1hcChzdHIpIHtcbiAgdmFyIG9iaiA9IHt9LCBpdGVtcyA9IHN0ci5zcGxpdCgnLCcpLCBpO1xuICBmb3IgKGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICBvYmpbaXRlbXNbaV1dID0gdHJ1ZTtcbiAgfVxuICByZXR1cm4gb2JqO1xufVxuXG5cbmZ1bmN0aW9uIG5vZGVOYW1lXyhlbGVtZW50KSB7XG4gIHJldHVybiBsb3dlcmNhc2UoZWxlbWVudC5ub2RlTmFtZSB8fCAoZWxlbWVudFswXSAmJiBlbGVtZW50WzBdLm5vZGVOYW1lKSk7XG59XG5cbmZ1bmN0aW9uIGluY2x1ZGVzKGFycmF5LCBvYmopIHtcbiAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoYXJyYXksIG9iaikgIT0gLTE7XG59XG5cbmZ1bmN0aW9uIGFycmF5UmVtb3ZlKGFycmF5LCB2YWx1ZSkge1xuICB2YXIgaW5kZXggPSBhcnJheS5pbmRleE9mKHZhbHVlKTtcbiAgaWYgKGluZGV4ID49IDApIHtcbiAgICBhcnJheS5zcGxpY2UoaW5kZXgsIDEpO1xuICB9XG4gIHJldHVybiBpbmRleDtcbn1cblxuLyoqXG4gKiBAbmdkb2MgZnVuY3Rpb25cbiAqIEBuYW1lIGFuZ3VsYXIuY29weVxuICogQG1vZHVsZSBuZ1xuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIENyZWF0ZXMgYSBkZWVwIGNvcHkgb2YgYHNvdXJjZWAsIHdoaWNoIHNob3VsZCBiZSBhbiBvYmplY3Qgb3IgYW4gYXJyYXkuXG4gKlxuICogKiBJZiBubyBkZXN0aW5hdGlvbiBpcyBzdXBwbGllZCwgYSBjb3B5IG9mIHRoZSBvYmplY3Qgb3IgYXJyYXkgaXMgY3JlYXRlZC5cbiAqICogSWYgYSBkZXN0aW5hdGlvbiBpcyBwcm92aWRlZCwgYWxsIG9mIGl0cyBlbGVtZW50cyAoZm9yIGFycmF5cykgb3IgcHJvcGVydGllcyAoZm9yIG9iamVjdHMpXG4gKiAgIGFyZSBkZWxldGVkIGFuZCB0aGVuIGFsbCBlbGVtZW50cy9wcm9wZXJ0aWVzIGZyb20gdGhlIHNvdXJjZSBhcmUgY29waWVkIHRvIGl0LlxuICogKiBJZiBgc291cmNlYCBpcyBub3QgYW4gb2JqZWN0IG9yIGFycmF5IChpbmMuIGBudWxsYCBhbmQgYHVuZGVmaW5lZGApLCBgc291cmNlYCBpcyByZXR1cm5lZC5cbiAqICogSWYgYHNvdXJjZWAgaXMgaWRlbnRpY2FsIHRvICdkZXN0aW5hdGlvbicgYW4gZXhjZXB0aW9uIHdpbGwgYmUgdGhyb3duLlxuICpcbiAqIEBwYXJhbSB7Kn0gc291cmNlIFRoZSBzb3VyY2UgdGhhdCB3aWxsIGJlIHVzZWQgdG8gbWFrZSBhIGNvcHkuXG4gKiAgICAgICAgICAgICAgICAgICBDYW4gYmUgYW55IHR5cGUsIGluY2x1ZGluZyBwcmltaXRpdmVzLCBgbnVsbGAsIGFuZCBgdW5kZWZpbmVkYC5cbiAqIEBwYXJhbSB7KE9iamVjdHxBcnJheSk9fSBkZXN0aW5hdGlvbiBEZXN0aW5hdGlvbiBpbnRvIHdoaWNoIHRoZSBzb3VyY2UgaXMgY29waWVkLiBJZlxuICogICAgIHByb3ZpZGVkLCBtdXN0IGJlIG9mIHRoZSBzYW1lIHR5cGUgYXMgYHNvdXJjZWAuXG4gKiBAcmV0dXJucyB7Kn0gVGhlIGNvcHkgb3IgdXBkYXRlZCBgZGVzdGluYXRpb25gLCBpZiBgZGVzdGluYXRpb25gIHdhcyBzcGVjaWZpZWQuXG4gKlxuICogQGV4YW1wbGVcbiA8ZXhhbXBsZSBtb2R1bGU9XCJjb3B5RXhhbXBsZVwiPlxuIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiA8Zm9ybSBub3ZhbGlkYXRlIGNsYXNzPVwic2ltcGxlLWZvcm1cIj5cbiBOYW1lOiA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cInVzZXIubmFtZVwiIC8+PGJyIC8+XG4gRS1tYWlsOiA8aW5wdXQgdHlwZT1cImVtYWlsXCIgbmctbW9kZWw9XCJ1c2VyLmVtYWlsXCIgLz48YnIgLz5cbiBHZW5kZXI6IDxpbnB1dCB0eXBlPVwicmFkaW9cIiBuZy1tb2RlbD1cInVzZXIuZ2VuZGVyXCIgdmFsdWU9XCJtYWxlXCIgLz5tYWxlXG4gPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5nLW1vZGVsPVwidXNlci5nZW5kZXJcIiB2YWx1ZT1cImZlbWFsZVwiIC8+ZmVtYWxlPGJyIC8+XG4gPGJ1dHRvbiBuZy1jbGljaz1cInJlc2V0KClcIj5SRVNFVDwvYnV0dG9uPlxuIDxidXR0b24gbmctY2xpY2s9XCJ1cGRhdGUodXNlcilcIj5TQVZFPC9idXR0b24+XG4gPC9mb3JtPlxuIDxwcmU+Zm9ybSA9IHt7dXNlciB8IGpzb259fTwvcHJlPlxuIDxwcmU+bWFzdGVyID0ge3ttYXN0ZXIgfCBqc29ufX08L3ByZT5cbiA8L2Rpdj5cblxuIDxzY3JpcHQ+XG4gIGFuZ3VsYXIubW9kdWxlKCdjb3B5RXhhbXBsZScsIFtdKVxuICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAkc2NvcGUubWFzdGVyPSB7fTtcblxuICAgICAgJHNjb3BlLnVwZGF0ZSA9IGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgLy8gRXhhbXBsZSB3aXRoIDEgYXJndW1lbnRcbiAgICAgICAgJHNjb3BlLm1hc3Rlcj0gYW5ndWxhci5jb3B5KHVzZXIpO1xuICAgICAgfTtcblxuICAgICAgJHNjb3BlLnJlc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIEV4YW1wbGUgd2l0aCAyIGFyZ3VtZW50c1xuICAgICAgICBhbmd1bGFyLmNvcHkoJHNjb3BlLm1hc3RlciwgJHNjb3BlLnVzZXIpO1xuICAgICAgfTtcblxuICAgICAgJHNjb3BlLnJlc2V0KCk7XG4gICAgfV0pO1xuIDwvc2NyaXB0PlxuIDwvZmlsZT5cbiA8L2V4YW1wbGU+XG4gKi9cbmZ1bmN0aW9uIGNvcHkoc291cmNlLCBkZXN0aW5hdGlvbikge1xuICB2YXIgc3RhY2tTb3VyY2UgPSBbXTtcbiAgdmFyIHN0YWNrRGVzdCA9IFtdO1xuXG4gIGlmIChkZXN0aW5hdGlvbikge1xuICAgIGlmIChpc1R5cGVkQXJyYXkoZGVzdGluYXRpb24pIHx8IGlzQXJyYXlCdWZmZXIoZGVzdGluYXRpb24pKSB7XG4gICAgICB0aHJvdyBuZ01pbkVycignY3B0YScsIFwiQ2FuJ3QgY29weSEgVHlwZWRBcnJheSBkZXN0aW5hdGlvbiBjYW5ub3QgYmUgbXV0YXRlZC5cIik7XG4gICAgfVxuICAgIGlmIChzb3VyY2UgPT09IGRlc3RpbmF0aW9uKSB7XG4gICAgICB0aHJvdyBuZ01pbkVycignY3BpJywgXCJDYW4ndCBjb3B5ISBTb3VyY2UgYW5kIGRlc3RpbmF0aW9uIGFyZSBpZGVudGljYWwuXCIpO1xuICAgIH1cblxuICAgIC8vIEVtcHR5IHRoZSBkZXN0aW5hdGlvbiBvYmplY3RcbiAgICBpZiAoaXNBcnJheShkZXN0aW5hdGlvbikpIHtcbiAgICAgIGRlc3RpbmF0aW9uLmxlbmd0aCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvckVhY2goZGVzdGluYXRpb24sIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgaWYgKGtleSAhPT0gJyQkaGFzaEtleScpIHtcbiAgICAgICAgICBkZWxldGUgZGVzdGluYXRpb25ba2V5XTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgc3RhY2tTb3VyY2UucHVzaChzb3VyY2UpO1xuICAgIHN0YWNrRGVzdC5wdXNoKGRlc3RpbmF0aW9uKTtcbiAgICByZXR1cm4gY29weVJlY3Vyc2Uoc291cmNlLCBkZXN0aW5hdGlvbik7XG4gIH1cblxuICByZXR1cm4gY29weUVsZW1lbnQoc291cmNlKTtcblxuICBmdW5jdGlvbiBjb3B5UmVjdXJzZShzb3VyY2UsIGRlc3RpbmF0aW9uKSB7XG4gICAgdmFyIGggPSBkZXN0aW5hdGlvbi4kJGhhc2hLZXk7XG4gICAgdmFyIHJlc3VsdCwga2V5O1xuICAgIGlmIChpc0FycmF5KHNvdXJjZSkpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHNvdXJjZS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgIGRlc3RpbmF0aW9uLnB1c2goY29weUVsZW1lbnQoc291cmNlW2ldKSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChpc0JsYW5rT2JqZWN0KHNvdXJjZSkpIHtcbiAgICAgIC8vIGNyZWF0ZU1hcCgpIGZhc3QgcGF0aCAtLS0gU2FmZSB0byBhdm9pZCBoYXNPd25Qcm9wZXJ0eSBjaGVjayBiZWNhdXNlIHByb3RvdHlwZSBjaGFpbiBpcyBlbXB0eVxuICAgICAgZm9yIChrZXkgaW4gc291cmNlKSB7XG4gICAgICAgIGRlc3RpbmF0aW9uW2tleV0gPSBjb3B5RWxlbWVudChzb3VyY2Vba2V5XSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChzb3VyY2UgJiYgdHlwZW9mIHNvdXJjZS5oYXNPd25Qcm9wZXJ0eSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLy8gU2xvdyBwYXRoLCB3aGljaCBtdXN0IHJlbHkgb24gaGFzT3duUHJvcGVydHlcbiAgICAgIGZvciAoa2V5IGluIHNvdXJjZSkge1xuICAgICAgICBpZiAoc291cmNlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICBkZXN0aW5hdGlvbltrZXldID0gY29weUVsZW1lbnQoc291cmNlW2tleV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFNsb3dlc3QgcGF0aCAtLS0gaGFzT3duUHJvcGVydHkgY2FuJ3QgYmUgY2FsbGVkIGFzIGEgbWV0aG9kXG4gICAgICBmb3IgKGtleSBpbiBzb3VyY2UpIHtcbiAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7XG4gICAgICAgICAgZGVzdGluYXRpb25ba2V5XSA9IGNvcHlFbGVtZW50KHNvdXJjZVtrZXldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBzZXRIYXNoS2V5KGRlc3RpbmF0aW9uLCBoKTtcbiAgICByZXR1cm4gZGVzdGluYXRpb247XG4gIH1cblxuICBmdW5jdGlvbiBjb3B5RWxlbWVudChzb3VyY2UpIHtcbiAgICAvLyBTaW1wbGUgdmFsdWVzXG4gICAgaWYgKCFpc09iamVjdChzb3VyY2UpKSB7XG4gICAgICByZXR1cm4gc291cmNlO1xuICAgIH1cblxuICAgIC8vIEFscmVhZHkgY29waWVkIHZhbHVlc1xuICAgIHZhciBpbmRleCA9IHN0YWNrU291cmNlLmluZGV4T2Yoc291cmNlKTtcbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICByZXR1cm4gc3RhY2tEZXN0W2luZGV4XTtcbiAgICB9XG5cbiAgICBpZiAoaXNXaW5kb3coc291cmNlKSB8fCBpc1Njb3BlKHNvdXJjZSkpIHtcbiAgICAgIHRocm93IG5nTWluRXJyKCdjcHdzJyxcbiAgICAgICAgXCJDYW4ndCBjb3B5ISBNYWtpbmcgY29waWVzIG9mIFdpbmRvdyBvciBTY29wZSBpbnN0YW5jZXMgaXMgbm90IHN1cHBvcnRlZC5cIik7XG4gICAgfVxuXG4gICAgdmFyIG5lZWRzUmVjdXJzZSA9IGZhbHNlO1xuICAgIHZhciBkZXN0aW5hdGlvbiA9IGNvcHlUeXBlKHNvdXJjZSk7XG5cbiAgICBpZiAoZGVzdGluYXRpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgZGVzdGluYXRpb24gPSBpc0FycmF5KHNvdXJjZSkgPyBbXSA6IE9iamVjdC5jcmVhdGUoZ2V0UHJvdG90eXBlT2Yoc291cmNlKSk7XG4gICAgICBuZWVkc1JlY3Vyc2UgPSB0cnVlO1xuICAgIH1cblxuICAgIHN0YWNrU291cmNlLnB1c2goc291cmNlKTtcbiAgICBzdGFja0Rlc3QucHVzaChkZXN0aW5hdGlvbik7XG5cbiAgICByZXR1cm4gbmVlZHNSZWN1cnNlXG4gICAgICA/IGNvcHlSZWN1cnNlKHNvdXJjZSwgZGVzdGluYXRpb24pXG4gICAgICA6IGRlc3RpbmF0aW9uO1xuICB9XG5cbiAgZnVuY3Rpb24gY29weVR5cGUoc291cmNlKSB7XG4gICAgc3dpdGNoICh0b1N0cmluZy5jYWxsKHNvdXJjZSkpIHtcbiAgICAgIGNhc2UgJ1tvYmplY3QgSW50OEFycmF5XSc6XG4gICAgICBjYXNlICdbb2JqZWN0IEludDE2QXJyYXldJzpcbiAgICAgIGNhc2UgJ1tvYmplY3QgSW50MzJBcnJheV0nOlxuICAgICAgY2FzZSAnW29iamVjdCBGbG9hdDMyQXJyYXldJzpcbiAgICAgIGNhc2UgJ1tvYmplY3QgRmxvYXQ2NEFycmF5XSc6XG4gICAgICBjYXNlICdbb2JqZWN0IFVpbnQ4QXJyYXldJzpcbiAgICAgIGNhc2UgJ1tvYmplY3QgVWludDhDbGFtcGVkQXJyYXldJzpcbiAgICAgIGNhc2UgJ1tvYmplY3QgVWludDE2QXJyYXldJzpcbiAgICAgIGNhc2UgJ1tvYmplY3QgVWludDMyQXJyYXldJzpcbiAgICAgICAgcmV0dXJuIG5ldyBzb3VyY2UuY29uc3RydWN0b3IoY29weUVsZW1lbnQoc291cmNlLmJ1ZmZlcikpO1xuXG4gICAgICBjYXNlICdbb2JqZWN0IEFycmF5QnVmZmVyXSc6XG4gICAgICAgIC8vU3VwcG9ydDogSUUxMFxuICAgICAgICBpZiAoIXNvdXJjZS5zbGljZSkge1xuICAgICAgICAgIHZhciBjb3BpZWQgPSBuZXcgQXJyYXlCdWZmZXIoc291cmNlLmJ5dGVMZW5ndGgpO1xuICAgICAgICAgIG5ldyBVaW50OEFycmF5KGNvcGllZCkuc2V0KG5ldyBVaW50OEFycmF5KHNvdXJjZSkpO1xuICAgICAgICAgIHJldHVybiBjb3BpZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZS5zbGljZSgwKTtcblxuICAgICAgY2FzZSAnW29iamVjdCBCb29sZWFuXSc6XG4gICAgICBjYXNlICdbb2JqZWN0IE51bWJlcl0nOlxuICAgICAgY2FzZSAnW29iamVjdCBTdHJpbmddJzpcbiAgICAgIGNhc2UgJ1tvYmplY3QgRGF0ZV0nOlxuICAgICAgICByZXR1cm4gbmV3IHNvdXJjZS5jb25zdHJ1Y3Rvcihzb3VyY2UudmFsdWVPZigpKTtcblxuICAgICAgY2FzZSAnW29iamVjdCBSZWdFeHBdJzpcbiAgICAgICAgdmFyIHJlID0gbmV3IFJlZ0V4cChzb3VyY2Uuc291cmNlLCBzb3VyY2UudG9TdHJpbmcoKS5tYXRjaCgvW15cXC9dKiQvKVswXSk7XG4gICAgICAgIHJlLmxhc3RJbmRleCA9IHNvdXJjZS5sYXN0SW5kZXg7XG4gICAgICAgIHJldHVybiByZTtcbiAgICB9XG5cbiAgICBpZiAoaXNGdW5jdGlvbihzb3VyY2UuY2xvbmVOb2RlKSkge1xuICAgICAgcmV0dXJuIHNvdXJjZS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIHNoYWxsb3cgY29weSBvZiBhbiBvYmplY3QsIGFuIGFycmF5IG9yIGEgcHJpbWl0aXZlLlxuICpcbiAqIEFzc3VtZXMgdGhhdCB0aGVyZSBhcmUgbm8gcHJvdG8gcHJvcGVydGllcyBmb3Igb2JqZWN0cy5cbiAqL1xuZnVuY3Rpb24gc2hhbGxvd0NvcHkoc3JjLCBkc3QpIHtcbiAgaWYgKGlzQXJyYXkoc3JjKSkge1xuICAgIGRzdCA9IGRzdCB8fCBbXTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHNyYy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICBkc3RbaV0gPSBzcmNbaV07XG4gICAgfVxuICB9IGVsc2UgaWYgKGlzT2JqZWN0KHNyYykpIHtcbiAgICBkc3QgPSBkc3QgfHwge307XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gc3JjKSB7XG4gICAgICBpZiAoIShrZXkuY2hhckF0KDApID09PSAnJCcgJiYga2V5LmNoYXJBdCgxKSA9PT0gJyQnKSkge1xuICAgICAgICBkc3Rba2V5XSA9IHNyY1trZXldO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBkc3QgfHwgc3JjO1xufVxuXG5cbi8qKlxuICogQG5nZG9jIGZ1bmN0aW9uXG4gKiBAbmFtZSBhbmd1bGFyLmVxdWFsc1xuICogQG1vZHVsZSBuZ1xuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIERldGVybWluZXMgaWYgdHdvIG9iamVjdHMgb3IgdHdvIHZhbHVlcyBhcmUgZXF1aXZhbGVudC4gU3VwcG9ydHMgdmFsdWUgdHlwZXMsIHJlZ3VsYXJcbiAqIGV4cHJlc3Npb25zLCBhcnJheXMgYW5kIG9iamVjdHMuXG4gKlxuICogVHdvIG9iamVjdHMgb3IgdmFsdWVzIGFyZSBjb25zaWRlcmVkIGVxdWl2YWxlbnQgaWYgYXQgbGVhc3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcgaXMgdHJ1ZTpcbiAqXG4gKiAqIEJvdGggb2JqZWN0cyBvciB2YWx1ZXMgcGFzcyBgPT09YCBjb21wYXJpc29uLlxuICogKiBCb3RoIG9iamVjdHMgb3IgdmFsdWVzIGFyZSBvZiB0aGUgc2FtZSB0eXBlIGFuZCBhbGwgb2YgdGhlaXIgcHJvcGVydGllcyBhcmUgZXF1YWwgYnlcbiAqICAgY29tcGFyaW5nIHRoZW0gd2l0aCBgYW5ndWxhci5lcXVhbHNgLlxuICogKiBCb3RoIHZhbHVlcyBhcmUgTmFOLiAoSW4gSmF2YVNjcmlwdCwgTmFOID09IE5hTiA9PiBmYWxzZS4gQnV0IHdlIGNvbnNpZGVyIHR3byBOYU4gYXMgZXF1YWwpXG4gKiAqIEJvdGggdmFsdWVzIHJlcHJlc2VudCB0aGUgc2FtZSByZWd1bGFyIGV4cHJlc3Npb24gKEluIEphdmFTY3JpcHQsXG4gKiAgIC9hYmMvID09IC9hYmMvID0+IGZhbHNlLiBCdXQgd2UgY29uc2lkZXIgdHdvIHJlZ3VsYXIgZXhwcmVzc2lvbnMgYXMgZXF1YWwgd2hlbiB0aGVpciB0ZXh0dWFsXG4gKiAgIHJlcHJlc2VudGF0aW9uIG1hdGNoZXMpLlxuICpcbiAqIER1cmluZyBhIHByb3BlcnR5IGNvbXBhcmlzb24sIHByb3BlcnRpZXMgb2YgYGZ1bmN0aW9uYCB0eXBlIGFuZCBwcm9wZXJ0aWVzIHdpdGggbmFtZXNcbiAqIHRoYXQgYmVnaW4gd2l0aCBgJGAgYXJlIGlnbm9yZWQuXG4gKlxuICogU2NvcGUgYW5kIERPTVdpbmRvdyBvYmplY3RzIGFyZSBiZWluZyBjb21wYXJlZCBvbmx5IGJ5IGlkZW50aWZ5IChgPT09YCkuXG4gKlxuICogQHBhcmFtIHsqfSBvMSBPYmplY3Qgb3IgdmFsdWUgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSB7Kn0gbzIgT2JqZWN0IG9yIHZhbHVlIHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBhcmd1bWVudHMgYXJlIGVxdWFsLlxuICovXG5mdW5jdGlvbiBlcXVhbHMobzEsIG8yKSB7XG4gIGlmIChvMSA9PT0gbzIpIHJldHVybiB0cnVlO1xuICBpZiAobzEgPT09IG51bGwgfHwgbzIgPT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgaWYgKG8xICE9PSBvMSAmJiBvMiAhPT0gbzIpIHJldHVybiB0cnVlOyAvLyBOYU4gPT09IE5hTlxuICB2YXIgdDEgPSB0eXBlb2YgbzEsIHQyID0gdHlwZW9mIG8yLCBsZW5ndGgsIGtleSwga2V5U2V0O1xuICBpZiAodDEgPT0gdDIgJiYgdDEgPT0gJ29iamVjdCcpIHtcbiAgICBpZiAoaXNBcnJheShvMSkpIHtcbiAgICAgIGlmICghaXNBcnJheShvMikpIHJldHVybiBmYWxzZTtcbiAgICAgIGlmICgobGVuZ3RoID0gbzEubGVuZ3RoKSA9PSBvMi5sZW5ndGgpIHtcbiAgICAgICAgZm9yIChrZXkgPSAwOyBrZXkgPCBsZW5ndGg7IGtleSsrKSB7XG4gICAgICAgICAgaWYgKCFlcXVhbHMobzFba2V5XSwgbzJba2V5XSkpIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGlzRGF0ZShvMSkpIHtcbiAgICAgIGlmICghaXNEYXRlKG8yKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgcmV0dXJuIGVxdWFscyhvMS5nZXRUaW1lKCksIG8yLmdldFRpbWUoKSk7XG4gICAgfSBlbHNlIGlmIChpc1JlZ0V4cChvMSkpIHtcbiAgICAgIGlmICghaXNSZWdFeHAobzIpKSByZXR1cm4gZmFsc2U7XG4gICAgICByZXR1cm4gbzEudG9TdHJpbmcoKSA9PSBvMi50b1N0cmluZygpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoaXNTY29wZShvMSkgfHwgaXNTY29wZShvMikgfHwgaXNXaW5kb3cobzEpIHx8IGlzV2luZG93KG8yKSB8fFxuICAgICAgICBpc0FycmF5KG8yKSB8fCBpc0RhdGUobzIpIHx8IGlzUmVnRXhwKG8yKSkgcmV0dXJuIGZhbHNlO1xuICAgICAga2V5U2V0ID0gY3JlYXRlTWFwKCk7XG4gICAgICBmb3IgKGtleSBpbiBvMSkge1xuICAgICAgICBpZiAoa2V5LmNoYXJBdCgwKSA9PT0gJyQnIHx8IGlzRnVuY3Rpb24obzFba2V5XSkpIGNvbnRpbnVlO1xuICAgICAgICBpZiAoIWVxdWFscyhvMVtrZXldLCBvMltrZXldKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBrZXlTZXRba2V5XSA9IHRydWU7XG4gICAgICB9XG4gICAgICBmb3IgKGtleSBpbiBvMikge1xuICAgICAgICBpZiAoIShrZXkgaW4ga2V5U2V0KSAmJlxuICAgICAgICAgICAga2V5LmNoYXJBdCgwKSAhPT0gJyQnICYmXG4gICAgICAgICAgICBpc0RlZmluZWQobzJba2V5XSkgJiZcbiAgICAgICAgICAgICFpc0Z1bmN0aW9uKG8yW2tleV0pKSByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG52YXIgY3NwID0gZnVuY3Rpb24oKSB7XG4gIGlmICghaXNEZWZpbmVkKGNzcC5ydWxlcykpIHtcblxuXG4gICAgdmFyIG5nQ3NwRWxlbWVudCA9IChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbbmctY3NwXScpIHx8XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW5nLWNzcF0nKSk7XG5cbiAgICBpZiAobmdDc3BFbGVtZW50KSB7XG4gICAgICB2YXIgbmdDc3BBdHRyaWJ1dGUgPSBuZ0NzcEVsZW1lbnQuZ2V0QXR0cmlidXRlKCduZy1jc3AnKSB8fFxuICAgICAgICAgICAgICAgICAgICBuZ0NzcEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLW5nLWNzcCcpO1xuICAgICAgY3NwLnJ1bGVzID0ge1xuICAgICAgICBub1Vuc2FmZUV2YWw6ICFuZ0NzcEF0dHJpYnV0ZSB8fCAobmdDc3BBdHRyaWJ1dGUuaW5kZXhPZignbm8tdW5zYWZlLWV2YWwnKSAhPT0gLTEpLFxuICAgICAgICBub0lubGluZVN0eWxlOiAhbmdDc3BBdHRyaWJ1dGUgfHwgKG5nQ3NwQXR0cmlidXRlLmluZGV4T2YoJ25vLWlubGluZS1zdHlsZScpICE9PSAtMSlcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIGNzcC5ydWxlcyA9IHtcbiAgICAgICAgbm9VbnNhZmVFdmFsOiBub1Vuc2FmZUV2YWwoKSxcbiAgICAgICAgbm9JbmxpbmVTdHlsZTogZmFsc2VcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGNzcC5ydWxlcztcblxuICBmdW5jdGlvbiBub1Vuc2FmZUV2YWwoKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8qIGpzaGludCAtVzAzMSwgLVcwNTQgKi9cbiAgICAgIG5ldyBGdW5jdGlvbignJyk7XG4gICAgICAvKiBqc2hpbnQgK1cwMzEsICtXMDU0ICovXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBtb2R1bGUgbmdcbiAqIEBuYW1lIG5nSnFcbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmdKcSB0aGUgbmFtZSBvZiB0aGUgbGlicmFyeSBhdmFpbGFibGUgdW5kZXIgYHdpbmRvd2BcbiAqIHRvIGJlIHVzZWQgZm9yIGFuZ3VsYXIuZWxlbWVudFxuICogQGRlc2NyaXB0aW9uXG4gKiBVc2UgdGhpcyBkaXJlY3RpdmUgdG8gZm9yY2UgdGhlIGFuZ3VsYXIuZWxlbWVudCBsaWJyYXJ5LiAgVGhpcyBzaG91bGQgYmVcbiAqIHVzZWQgdG8gZm9yY2UgZWl0aGVyIGpxTGl0ZSBieSBsZWF2aW5nIG5nLWpxIGJsYW5rIG9yIHNldHRpbmcgdGhlIG5hbWUgb2ZcbiAqIHRoZSBqcXVlcnkgdmFyaWFibGUgdW5kZXIgd2luZG93IChlZy4galF1ZXJ5KS5cbiAqXG4gKiBTaW5jZSBhbmd1bGFyIGxvb2tzIGZvciB0aGlzIGRpcmVjdGl2ZSB3aGVuIGl0IGlzIGxvYWRlZCAoZG9lc24ndCB3YWl0IGZvciB0aGVcbiAqIERPTUNvbnRlbnRMb2FkZWQgZXZlbnQpLCBpdCBtdXN0IGJlIHBsYWNlZCBvbiBhbiBlbGVtZW50IHRoYXQgY29tZXMgYmVmb3JlIHRoZSBzY3JpcHRcbiAqIHdoaWNoIGxvYWRzIGFuZ3VsYXIuIEFsc28sIG9ubHkgdGhlIGZpcnN0IGluc3RhbmNlIG9mIGBuZy1qcWAgd2lsbCBiZSB1c2VkIGFuZCBhbGxcbiAqIG90aGVycyBpZ25vcmVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBUaGlzIGV4YW1wbGUgc2hvd3MgaG93IHRvIGZvcmNlIGpxTGl0ZSB1c2luZyB0aGUgYG5nSnFgIGRpcmVjdGl2ZSB0byB0aGUgYGh0bWxgIHRhZy5cbiBgYGBodG1sXG4gPCFkb2N0eXBlIGh0bWw+XG4gPGh0bWwgbmctYXBwIG5nLWpxPlxuIC4uLlxuIC4uLlxuIDwvaHRtbD5cbiBgYGBcbiAqIEBleGFtcGxlXG4gKiBUaGlzIGV4YW1wbGUgc2hvd3MgaG93IHRvIHVzZSBhIGpRdWVyeSBiYXNlZCBsaWJyYXJ5IG9mIGEgZGlmZmVyZW50IG5hbWUuXG4gKiBUaGUgbGlicmFyeSBuYW1lIG11c3QgYmUgYXZhaWxhYmxlIGF0IHRoZSB0b3AgbW9zdCAnd2luZG93Jy5cbiBgYGBodG1sXG4gPCFkb2N0eXBlIGh0bWw+XG4gPGh0bWwgbmctYXBwIG5nLWpxPVwialF1ZXJ5TGliXCI+XG4gLi4uXG4gLi4uXG4gPC9odG1sPlxuIGBgYFxuICovXG52YXIganEgPSBmdW5jdGlvbigpIHtcbiAgaWYgKGlzRGVmaW5lZChqcS5uYW1lXykpIHJldHVybiBqcS5uYW1lXztcbiAgdmFyIGVsO1xuICB2YXIgaSwgaWkgPSBuZ0F0dHJQcmVmaXhlcy5sZW5ndGgsIHByZWZpeCwgbmFtZTtcbiAgZm9yIChpID0gMDsgaSA8IGlpOyArK2kpIHtcbiAgICBwcmVmaXggPSBuZ0F0dHJQcmVmaXhlc1tpXTtcbiAgICBpZiAoZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbJyArIHByZWZpeC5yZXBsYWNlKCc6JywgJ1xcXFw6JykgKyAnanFdJykpIHtcbiAgICAgIG5hbWUgPSBlbC5nZXRBdHRyaWJ1dGUocHJlZml4ICsgJ2pxJyk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gKGpxLm5hbWVfID0gbmFtZSk7XG59O1xuXG5mdW5jdGlvbiBjb25jYXQoYXJyYXkxLCBhcnJheTIsIGluZGV4KSB7XG4gIHJldHVybiBhcnJheTEuY29uY2F0KHNsaWNlLmNhbGwoYXJyYXkyLCBpbmRleCkpO1xufVxuXG5mdW5jdGlvbiBzbGljZUFyZ3MoYXJncywgc3RhcnRJbmRleCkge1xuICByZXR1cm4gc2xpY2UuY2FsbChhcmdzLCBzdGFydEluZGV4IHx8IDApO1xufVxuXG5cbi8qIGpzaGludCAtVzEwMSAqL1xuLyoqXG4gKiBAbmdkb2MgZnVuY3Rpb25cbiAqIEBuYW1lIGFuZ3VsYXIuYmluZFxuICogQG1vZHVsZSBuZ1xuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFJldHVybnMgYSBmdW5jdGlvbiB3aGljaCBjYWxscyBmdW5jdGlvbiBgZm5gIGJvdW5kIHRvIGBzZWxmYCAoYHNlbGZgIGJlY29tZXMgdGhlIGB0aGlzYCBmb3JcbiAqIGBmbmApLiBZb3UgY2FuIHN1cHBseSBvcHRpb25hbCBgYXJnc2AgdGhhdCBhcmUgcHJlYm91bmQgdG8gdGhlIGZ1bmN0aW9uLiBUaGlzIGZlYXR1cmUgaXMgYWxzb1xuICoga25vd24gYXMgW3BhcnRpYWwgYXBwbGljYXRpb25dKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUGFydGlhbF9hcHBsaWNhdGlvbiksIGFzXG4gKiBkaXN0aW5ndWlzaGVkIGZyb20gW2Z1bmN0aW9uIGN1cnJ5aW5nXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0N1cnJ5aW5nI0NvbnRyYXN0X3dpdGhfcGFydGlhbF9mdW5jdGlvbl9hcHBsaWNhdGlvbikuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHNlbGYgQ29udGV4dCB3aGljaCBgZm5gIHNob3VsZCBiZSBldmFsdWF0ZWQgaW4uXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGZuIEZ1bmN0aW9uIHRvIGJlIGJvdW5kLlxuICogQHBhcmFtIHsuLi4qfSBhcmdzIE9wdGlvbmFsIGFyZ3VtZW50cyB0byBiZSBwcmVib3VuZCB0byB0aGUgYGZuYCBmdW5jdGlvbiBjYWxsLlxuICogQHJldHVybnMge2Z1bmN0aW9uKCl9IEZ1bmN0aW9uIHRoYXQgd3JhcHMgdGhlIGBmbmAgd2l0aCBhbGwgdGhlIHNwZWNpZmllZCBiaW5kaW5ncy5cbiAqL1xuLyoganNoaW50ICtXMTAxICovXG5mdW5jdGlvbiBiaW5kKHNlbGYsIGZuKSB7XG4gIHZhciBjdXJyeUFyZ3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IHNsaWNlQXJncyhhcmd1bWVudHMsIDIpIDogW107XG4gIGlmIChpc0Z1bmN0aW9uKGZuKSAmJiAhKGZuIGluc3RhbmNlb2YgUmVnRXhwKSkge1xuICAgIHJldHVybiBjdXJyeUFyZ3MubGVuZ3RoXG4gICAgICA/IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoXG4gICAgICAgICAgICA/IGZuLmFwcGx5KHNlbGYsIGNvbmNhdChjdXJyeUFyZ3MsIGFyZ3VtZW50cywgMCkpXG4gICAgICAgICAgICA6IGZuLmFwcGx5KHNlbGYsIGN1cnJ5QXJncyk7XG4gICAgICAgIH1cbiAgICAgIDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGhcbiAgICAgICAgICAgID8gZm4uYXBwbHkoc2VsZiwgYXJndW1lbnRzKVxuICAgICAgICAgICAgOiBmbi5jYWxsKHNlbGYpO1xuICAgICAgICB9O1xuICB9IGVsc2Uge1xuICAgIC8vIGluIElFLCBuYXRpdmUgbWV0aG9kcyBhcmUgbm90IGZ1bmN0aW9ucyBzbyB0aGV5IGNhbm5vdCBiZSBib3VuZCAobm90ZTogdGhleSBkb24ndCBuZWVkIHRvIGJlKVxuICAgIHJldHVybiBmbjtcbiAgfVxufVxuXG5cbmZ1bmN0aW9uIHRvSnNvblJlcGxhY2VyKGtleSwgdmFsdWUpIHtcbiAgdmFyIHZhbCA9IHZhbHVlO1xuXG4gIGlmICh0eXBlb2Yga2V5ID09PSAnc3RyaW5nJyAmJiBrZXkuY2hhckF0KDApID09PSAnJCcgJiYga2V5LmNoYXJBdCgxKSA9PT0gJyQnKSB7XG4gICAgdmFsID0gdW5kZWZpbmVkO1xuICB9IGVsc2UgaWYgKGlzV2luZG93KHZhbHVlKSkge1xuICAgIHZhbCA9ICckV0lORE9XJztcbiAgfSBlbHNlIGlmICh2YWx1ZSAmJiAgZG9jdW1lbnQgPT09IHZhbHVlKSB7XG4gICAgdmFsID0gJyRET0NVTUVOVCc7XG4gIH0gZWxzZSBpZiAoaXNTY29wZSh2YWx1ZSkpIHtcbiAgICB2YWwgPSAnJFNDT1BFJztcbiAgfVxuXG4gIHJldHVybiB2YWw7XG59XG5cblxuLyoqXG4gKiBAbmdkb2MgZnVuY3Rpb25cbiAqIEBuYW1lIGFuZ3VsYXIudG9Kc29uXG4gKiBAbW9kdWxlIG5nXG4gKiBAa2luZCBmdW5jdGlvblxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogU2VyaWFsaXplcyBpbnB1dCBpbnRvIGEgSlNPTi1mb3JtYXR0ZWQgc3RyaW5nLiBQcm9wZXJ0aWVzIHdpdGggbGVhZGluZyAkJCBjaGFyYWN0ZXJzIHdpbGwgYmVcbiAqIHN0cmlwcGVkIHNpbmNlIGFuZ3VsYXIgdXNlcyB0aGlzIG5vdGF0aW9uIGludGVybmFsbHkuXG4gKlxuICogQHBhcmFtIHtPYmplY3R8QXJyYXl8RGF0ZXxzdHJpbmd8bnVtYmVyfSBvYmogSW5wdXQgdG8gYmUgc2VyaWFsaXplZCBpbnRvIEpTT04uXG4gKiBAcGFyYW0ge2Jvb2xlYW58bnVtYmVyfSBbcHJldHR5PTJdIElmIHNldCB0byB0cnVlLCB0aGUgSlNPTiBvdXRwdXQgd2lsbCBjb250YWluIG5ld2xpbmVzIGFuZCB3aGl0ZXNwYWNlLlxuICogICAgSWYgc2V0IHRvIGFuIGludGVnZXIsIHRoZSBKU09OIG91dHB1dCB3aWxsIGNvbnRhaW4gdGhhdCBtYW55IHNwYWNlcyBwZXIgaW5kZW50YXRpb24uXG4gKiBAcmV0dXJucyB7c3RyaW5nfHVuZGVmaW5lZH0gSlNPTi1pZmllZCBzdHJpbmcgcmVwcmVzZW50aW5nIGBvYmpgLlxuICovXG5mdW5jdGlvbiB0b0pzb24ob2JqLCBwcmV0dHkpIHtcbiAgaWYgKGlzVW5kZWZpbmVkKG9iaikpIHJldHVybiB1bmRlZmluZWQ7XG4gIGlmICghaXNOdW1iZXIocHJldHR5KSkge1xuICAgIHByZXR0eSA9IHByZXR0eSA/IDIgOiBudWxsO1xuICB9XG4gIHJldHVybiBKU09OLnN0cmluZ2lmeShvYmosIHRvSnNvblJlcGxhY2VyLCBwcmV0dHkpO1xufVxuXG5cbi8qKlxuICogQG5nZG9jIGZ1bmN0aW9uXG4gKiBAbmFtZSBhbmd1bGFyLmZyb21Kc29uXG4gKiBAbW9kdWxlIG5nXG4gKiBAa2luZCBmdW5jdGlvblxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogRGVzZXJpYWxpemVzIGEgSlNPTiBzdHJpbmcuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGpzb24gSlNPTiBzdHJpbmcgdG8gZGVzZXJpYWxpemUuXG4gKiBAcmV0dXJucyB7T2JqZWN0fEFycmF5fHN0cmluZ3xudW1iZXJ9IERlc2VyaWFsaXplZCBKU09OIHN0cmluZy5cbiAqL1xuZnVuY3Rpb24gZnJvbUpzb24oanNvbikge1xuICByZXR1cm4gaXNTdHJpbmcoanNvbilcbiAgICAgID8gSlNPTi5wYXJzZShqc29uKVxuICAgICAgOiBqc29uO1xufVxuXG5cbnZhciBBTExfQ09MT05TID0gLzovZztcbmZ1bmN0aW9uIHRpbWV6b25lVG9PZmZzZXQodGltZXpvbmUsIGZhbGxiYWNrKSB7XG4gIC8vIElFL0VkZ2UgZG8gbm90IFwidW5kZXJzdGFuZFwiIGNvbG9uIChgOmApIGluIHRpbWV6b25lXG4gIHRpbWV6b25lID0gdGltZXpvbmUucmVwbGFjZShBTExfQ09MT05TLCAnJyk7XG4gIHZhciByZXF1ZXN0ZWRUaW1lem9uZU9mZnNldCA9IERhdGUucGFyc2UoJ0phbiAwMSwgMTk3MCAwMDowMDowMCAnICsgdGltZXpvbmUpIC8gNjAwMDA7XG4gIHJldHVybiBpc05hTihyZXF1ZXN0ZWRUaW1lem9uZU9mZnNldCkgPyBmYWxsYmFjayA6IHJlcXVlc3RlZFRpbWV6b25lT2Zmc2V0O1xufVxuXG5cbmZ1bmN0aW9uIGFkZERhdGVNaW51dGVzKGRhdGUsIG1pbnV0ZXMpIHtcbiAgZGF0ZSA9IG5ldyBEYXRlKGRhdGUuZ2V0VGltZSgpKTtcbiAgZGF0ZS5zZXRNaW51dGVzKGRhdGUuZ2V0TWludXRlcygpICsgbWludXRlcyk7XG4gIHJldHVybiBkYXRlO1xufVxuXG5cbmZ1bmN0aW9uIGNvbnZlcnRUaW1lem9uZVRvTG9jYWwoZGF0ZSwgdGltZXpvbmUsIHJldmVyc2UpIHtcbiAgcmV2ZXJzZSA9IHJldmVyc2UgPyAtMSA6IDE7XG4gIHZhciBkYXRlVGltZXpvbmVPZmZzZXQgPSBkYXRlLmdldFRpbWV6b25lT2Zmc2V0KCk7XG4gIHZhciB0aW1lem9uZU9mZnNldCA9IHRpbWV6b25lVG9PZmZzZXQodGltZXpvbmUsIGRhdGVUaW1lem9uZU9mZnNldCk7XG4gIHJldHVybiBhZGREYXRlTWludXRlcyhkYXRlLCByZXZlcnNlICogKHRpbWV6b25lT2Zmc2V0IC0gZGF0ZVRpbWV6b25lT2Zmc2V0KSk7XG59XG5cblxuLyoqXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGVsZW1lbnQuXG4gKi9cbmZ1bmN0aW9uIHN0YXJ0aW5nVGFnKGVsZW1lbnQpIHtcbiAgZWxlbWVudCA9IGpxTGl0ZShlbGVtZW50KS5jbG9uZSgpO1xuICB0cnkge1xuICAgIC8vIHR1cm5zIG91dCBJRSBkb2VzIG5vdCBsZXQgeW91IHNldCAuaHRtbCgpIG9uIGVsZW1lbnRzIHdoaWNoXG4gICAgLy8gYXJlIG5vdCBhbGxvd2VkIHRvIGhhdmUgY2hpbGRyZW4uIFNvIHdlIGp1c3QgaWdub3JlIGl0LlxuICAgIGVsZW1lbnQuZW1wdHkoKTtcbiAgfSBjYXRjaCAoZSkge31cbiAgdmFyIGVsZW1IdG1sID0ganFMaXRlKCc8ZGl2PicpLmFwcGVuZChlbGVtZW50KS5odG1sKCk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGVsZW1lbnRbMF0ubm9kZVR5cGUgPT09IE5PREVfVFlQRV9URVhUID8gbG93ZXJjYXNlKGVsZW1IdG1sKSA6XG4gICAgICAgIGVsZW1IdG1sLlxuICAgICAgICAgIG1hdGNoKC9eKDxbXj5dKz4pLylbMV0uXG4gICAgICAgICAgcmVwbGFjZSgvXjwoW1xcd1xcLV0rKS8sIGZ1bmN0aW9uKG1hdGNoLCBub2RlTmFtZSkge3JldHVybiAnPCcgKyBsb3dlcmNhc2Uobm9kZU5hbWUpO30pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGxvd2VyY2FzZShlbGVtSHRtbCk7XG4gIH1cblxufVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuLyoqXG4gKiBUcmllcyB0byBkZWNvZGUgdGhlIFVSSSBjb21wb25lbnQgd2l0aG91dCB0aHJvd2luZyBhbiBleGNlcHRpb24uXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSBzdHIgdmFsdWUgcG90ZW50aWFsIFVSSSBjb21wb25lbnQgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBgdmFsdWVgIGNhbiBiZSBkZWNvZGVkXG4gKiB3aXRoIHRoZSBkZWNvZGVVUklDb21wb25lbnQgZnVuY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIHRyeURlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkge1xuICB0cnkge1xuICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gSWdub3JlIGFueSBpbnZhbGlkIHVyaSBjb21wb25lbnRcbiAgfVxufVxuXG5cbi8qKlxuICogUGFyc2VzIGFuIGVzY2FwZWQgdXJsIHF1ZXJ5IHN0cmluZyBpbnRvIGtleS12YWx1ZSBwYWlycy5cbiAqIEByZXR1cm5zIHtPYmplY3QuPHN0cmluZyxib29sZWFufEFycmF5Pn1cbiAqL1xuZnVuY3Rpb24gcGFyc2VLZXlWYWx1ZSgvKipzdHJpbmcqL2tleVZhbHVlKSB7XG4gIHZhciBvYmogPSB7fTtcbiAgZm9yRWFjaCgoa2V5VmFsdWUgfHwgXCJcIikuc3BsaXQoJyYnKSwgZnVuY3Rpb24oa2V5VmFsdWUpIHtcbiAgICB2YXIgc3BsaXRQb2ludCwga2V5LCB2YWw7XG4gICAgaWYgKGtleVZhbHVlKSB7XG4gICAgICBrZXkgPSBrZXlWYWx1ZSA9IGtleVZhbHVlLnJlcGxhY2UoL1xcKy9nLCclMjAnKTtcbiAgICAgIHNwbGl0UG9pbnQgPSBrZXlWYWx1ZS5pbmRleE9mKCc9Jyk7XG4gICAgICBpZiAoc3BsaXRQb2ludCAhPT0gLTEpIHtcbiAgICAgICAga2V5ID0ga2V5VmFsdWUuc3Vic3RyaW5nKDAsIHNwbGl0UG9pbnQpO1xuICAgICAgICB2YWwgPSBrZXlWYWx1ZS5zdWJzdHJpbmcoc3BsaXRQb2ludCArIDEpO1xuICAgICAgfVxuICAgICAga2V5ID0gdHJ5RGVjb2RlVVJJQ29tcG9uZW50KGtleSk7XG4gICAgICBpZiAoaXNEZWZpbmVkKGtleSkpIHtcbiAgICAgICAgdmFsID0gaXNEZWZpbmVkKHZhbCkgPyB0cnlEZWNvZGVVUklDb21wb25lbnQodmFsKSA6IHRydWU7XG4gICAgICAgIGlmICghaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcbiAgICAgICAgICBvYmpba2V5XSA9IHZhbDtcbiAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5KG9ialtrZXldKSkge1xuICAgICAgICAgIG9ialtrZXldLnB1c2godmFsKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvYmpba2V5XSA9IFtvYmpba2V5XSx2YWxdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIG9iajtcbn1cblxuZnVuY3Rpb24gdG9LZXlWYWx1ZShvYmopIHtcbiAgdmFyIHBhcnRzID0gW107XG4gIGZvckVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICBmb3JFYWNoKHZhbHVlLCBmdW5jdGlvbihhcnJheVZhbHVlKSB7XG4gICAgICAgIHBhcnRzLnB1c2goZW5jb2RlVXJpUXVlcnkoa2V5LCB0cnVlKSArXG4gICAgICAgICAgICAgICAgICAgKGFycmF5VmFsdWUgPT09IHRydWUgPyAnJyA6ICc9JyArIGVuY29kZVVyaVF1ZXJ5KGFycmF5VmFsdWUsIHRydWUpKSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgIHBhcnRzLnB1c2goZW5jb2RlVXJpUXVlcnkoa2V5LCB0cnVlKSArXG4gICAgICAgICAgICAgICAodmFsdWUgPT09IHRydWUgPyAnJyA6ICc9JyArIGVuY29kZVVyaVF1ZXJ5KHZhbHVlLCB0cnVlKSkpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBwYXJ0cy5sZW5ndGggPyBwYXJ0cy5qb2luKCcmJykgOiAnJztcbn1cblxuXG4vKipcbiAqIFdlIG5lZWQgb3VyIGN1c3RvbSBtZXRob2QgYmVjYXVzZSBlbmNvZGVVUklDb21wb25lbnQgaXMgdG9vIGFnZ3Jlc3NpdmUgYW5kIGRvZXNuJ3QgZm9sbG93XG4gKiBodHRwOi8vd3d3LmlldGYub3JnL3JmYy9yZmMzOTg2LnR4dCB3aXRoIHJlZ2FyZHMgdG8gdGhlIGNoYXJhY3RlciBzZXQgKHBjaGFyKSBhbGxvd2VkIGluIHBhdGhcbiAqIHNlZ21lbnRzOlxuICogICAgc2VnbWVudCAgICAgICA9ICpwY2hhclxuICogICAgcGNoYXIgICAgICAgICA9IHVucmVzZXJ2ZWQgLyBwY3QtZW5jb2RlZCAvIHN1Yi1kZWxpbXMgLyBcIjpcIiAvIFwiQFwiXG4gKiAgICBwY3QtZW5jb2RlZCAgID0gXCIlXCIgSEVYRElHIEhFWERJR1xuICogICAgdW5yZXNlcnZlZCAgICA9IEFMUEhBIC8gRElHSVQgLyBcIi1cIiAvIFwiLlwiIC8gXCJfXCIgLyBcIn5cIlxuICogICAgc3ViLWRlbGltcyAgICA9IFwiIVwiIC8gXCIkXCIgLyBcIiZcIiAvIFwiJ1wiIC8gXCIoXCIgLyBcIilcIlxuICogICAgICAgICAgICAgICAgICAgICAvIFwiKlwiIC8gXCIrXCIgLyBcIixcIiAvIFwiO1wiIC8gXCI9XCJcbiAqL1xuZnVuY3Rpb24gZW5jb2RlVXJpU2VnbWVudCh2YWwpIHtcbiAgcmV0dXJuIGVuY29kZVVyaVF1ZXJ5KHZhbCwgdHJ1ZSkuXG4gICAgICAgICAgICAgcmVwbGFjZSgvJTI2L2dpLCAnJicpLlxuICAgICAgICAgICAgIHJlcGxhY2UoLyUzRC9naSwgJz0nKS5cbiAgICAgICAgICAgICByZXBsYWNlKC8lMkIvZ2ksICcrJyk7XG59XG5cblxuLyoqXG4gKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZW5jb2RpbmcgKmtleSogb3IgKnZhbHVlKiBwYXJ0cyBvZiBxdWVyeSBjb21wb25lbnQuIFdlIG5lZWQgYSBjdXN0b21cbiAqIG1ldGhvZCBiZWNhdXNlIGVuY29kZVVSSUNvbXBvbmVudCBpcyB0b28gYWdncmVzc2l2ZSBhbmQgZW5jb2RlcyBzdHVmZiB0aGF0IGRvZXNuJ3QgaGF2ZSB0byBiZVxuICogZW5jb2RlZCBwZXIgaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzk4NjpcbiAqICAgIHF1ZXJ5ICAgICAgID0gKiggcGNoYXIgLyBcIi9cIiAvIFwiP1wiIClcbiAqICAgIHBjaGFyICAgICAgICAgPSB1bnJlc2VydmVkIC8gcGN0LWVuY29kZWQgLyBzdWItZGVsaW1zIC8gXCI6XCIgLyBcIkBcIlxuICogICAgdW5yZXNlcnZlZCAgICA9IEFMUEhBIC8gRElHSVQgLyBcIi1cIiAvIFwiLlwiIC8gXCJfXCIgLyBcIn5cIlxuICogICAgcGN0LWVuY29kZWQgICA9IFwiJVwiIEhFWERJRyBIRVhESUdcbiAqICAgIHN1Yi1kZWxpbXMgICAgPSBcIiFcIiAvIFwiJFwiIC8gXCImXCIgLyBcIidcIiAvIFwiKFwiIC8gXCIpXCJcbiAqICAgICAgICAgICAgICAgICAgICAgLyBcIipcIiAvIFwiK1wiIC8gXCIsXCIgLyBcIjtcIiAvIFwiPVwiXG4gKi9cbmZ1bmN0aW9uIGVuY29kZVVyaVF1ZXJ5KHZhbCwgcGN0RW5jb2RlU3BhY2VzKSB7XG4gIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQodmFsKS5cbiAgICAgICAgICAgICByZXBsYWNlKC8lNDAvZ2ksICdAJykuXG4gICAgICAgICAgICAgcmVwbGFjZSgvJTNBL2dpLCAnOicpLlxuICAgICAgICAgICAgIHJlcGxhY2UoLyUyNC9nLCAnJCcpLlxuICAgICAgICAgICAgIHJlcGxhY2UoLyUyQy9naSwgJywnKS5cbiAgICAgICAgICAgICByZXBsYWNlKC8lM0IvZ2ksICc7JykuXG4gICAgICAgICAgICAgcmVwbGFjZSgvJTIwL2csIChwY3RFbmNvZGVTcGFjZXMgPyAnJTIwJyA6ICcrJykpO1xufVxuXG52YXIgbmdBdHRyUHJlZml4ZXMgPSBbJ25nLScsICdkYXRhLW5nLScsICduZzonLCAneC1uZy0nXTtcblxuZnVuY3Rpb24gZ2V0TmdBdHRyaWJ1dGUoZWxlbWVudCwgbmdBdHRyKSB7XG4gIHZhciBhdHRyLCBpLCBpaSA9IG5nQXR0clByZWZpeGVzLmxlbmd0aDtcbiAgZm9yIChpID0gMDsgaSA8IGlpOyArK2kpIHtcbiAgICBhdHRyID0gbmdBdHRyUHJlZml4ZXNbaV0gKyBuZ0F0dHI7XG4gICAgaWYgKGlzU3RyaW5nKGF0dHIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShhdHRyKSkpIHtcbiAgICAgIHJldHVybiBhdHRyO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ0FwcFxuICogQG1vZHVsZSBuZ1xuICpcbiAqIEBlbGVtZW50IEFOWVxuICogQHBhcmFtIHthbmd1bGFyLk1vZHVsZX0gbmdBcHAgYW4gb3B0aW9uYWwgYXBwbGljYXRpb25cbiAqICAge0BsaW5rIGFuZ3VsYXIubW9kdWxlIG1vZHVsZX0gbmFtZSB0byBsb2FkLlxuICogQHBhcmFtIHtib29sZWFuPX0gbmdTdHJpY3REaSBpZiB0aGlzIGF0dHJpYnV0ZSBpcyBwcmVzZW50IG9uIHRoZSBhcHAgZWxlbWVudCwgdGhlIGluamVjdG9yIHdpbGwgYmVcbiAqICAgY3JlYXRlZCBpbiBcInN0cmljdC1kaVwiIG1vZGUuIFRoaXMgbWVhbnMgdGhhdCB0aGUgYXBwbGljYXRpb24gd2lsbCBmYWlsIHRvIGludm9rZSBmdW5jdGlvbnMgd2hpY2hcbiAqICAgZG8gbm90IHVzZSBleHBsaWNpdCBmdW5jdGlvbiBhbm5vdGF0aW9uIChhbmQgYXJlIHRodXMgdW5zdWl0YWJsZSBmb3IgbWluaWZpY2F0aW9uKSwgYXMgZGVzY3JpYmVkXG4gKiAgIGluIHtAbGluayBndWlkZS9kaSB0aGUgRGVwZW5kZW5jeSBJbmplY3Rpb24gZ3VpZGV9LCBhbmQgdXNlZnVsIGRlYnVnZ2luZyBpbmZvIHdpbGwgYXNzaXN0IGluXG4gKiAgIHRyYWNraW5nIGRvd24gdGhlIHJvb3Qgb2YgdGhlc2UgYnVncy5cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBVc2UgdGhpcyBkaXJlY3RpdmUgdG8gKiphdXRvLWJvb3RzdHJhcCoqIGFuIEFuZ3VsYXJKUyBhcHBsaWNhdGlvbi4gVGhlIGBuZ0FwcGAgZGlyZWN0aXZlXG4gKiBkZXNpZ25hdGVzIHRoZSAqKnJvb3QgZWxlbWVudCoqIG9mIHRoZSBhcHBsaWNhdGlvbiBhbmQgaXMgdHlwaWNhbGx5IHBsYWNlZCBuZWFyIHRoZSByb290IGVsZW1lbnRcbiAqIG9mIHRoZSBwYWdlIC0gZS5nLiBvbiB0aGUgYDxib2R5PmAgb3IgYDxodG1sPmAgdGFncy5cbiAqXG4gKiBPbmx5IG9uZSBBbmd1bGFySlMgYXBwbGljYXRpb24gY2FuIGJlIGF1dG8tYm9vdHN0cmFwcGVkIHBlciBIVE1MIGRvY3VtZW50LiBUaGUgZmlyc3QgYG5nQXBwYFxuICogZm91bmQgaW4gdGhlIGRvY3VtZW50IHdpbGwgYmUgdXNlZCB0byBkZWZpbmUgdGhlIHJvb3QgZWxlbWVudCB0byBhdXRvLWJvb3RzdHJhcCBhcyBhblxuICogYXBwbGljYXRpb24uIFRvIHJ1biBtdWx0aXBsZSBhcHBsaWNhdGlvbnMgaW4gYW4gSFRNTCBkb2N1bWVudCB5b3UgbXVzdCBtYW51YWxseSBib290c3RyYXAgdGhlbSB1c2luZ1xuICoge0BsaW5rIGFuZ3VsYXIuYm9vdHN0cmFwfSBpbnN0ZWFkLiBBbmd1bGFySlMgYXBwbGljYXRpb25zIGNhbm5vdCBiZSBuZXN0ZWQgd2l0aGluIGVhY2ggb3RoZXIuXG4gKlxuICogWW91IGNhbiBzcGVjaWZ5IGFuICoqQW5ndWxhckpTIG1vZHVsZSoqIHRvIGJlIHVzZWQgYXMgdGhlIHJvb3QgbW9kdWxlIGZvciB0aGUgYXBwbGljYXRpb24uICBUaGlzXG4gKiBtb2R1bGUgd2lsbCBiZSBsb2FkZWQgaW50byB0aGUge0BsaW5rIGF1dG8uJGluamVjdG9yfSB3aGVuIHRoZSBhcHBsaWNhdGlvbiBpcyBib290c3RyYXBwZWQuIEl0XG4gKiBzaG91bGQgY29udGFpbiB0aGUgYXBwbGljYXRpb24gY29kZSBuZWVkZWQgb3IgaGF2ZSBkZXBlbmRlbmNpZXMgb24gb3RoZXIgbW9kdWxlcyB0aGF0IHdpbGxcbiAqIGNvbnRhaW4gdGhlIGNvZGUuIFNlZSB7QGxpbmsgYW5ndWxhci5tb2R1bGV9IGZvciBtb3JlIGluZm9ybWF0aW9uLlxuICpcbiAqIEluIHRoZSBleGFtcGxlIGJlbG93IGlmIHRoZSBgbmdBcHBgIGRpcmVjdGl2ZSB3ZXJlIG5vdCBwbGFjZWQgb24gdGhlIGBodG1sYCBlbGVtZW50IHRoZW4gdGhlXG4gKiBkb2N1bWVudCB3b3VsZCBub3QgYmUgY29tcGlsZWQsIHRoZSBgQXBwQ29udHJvbGxlcmAgd291bGQgbm90IGJlIGluc3RhbnRpYXRlZCBhbmQgdGhlIGB7eyBhK2IgfX1gXG4gKiB3b3VsZCBub3QgYmUgcmVzb2x2ZWQgdG8gYDNgLlxuICpcbiAqIGBuZ0FwcGAgaXMgdGhlIGVhc2llc3QsIGFuZCBtb3N0IGNvbW1vbiB3YXkgdG8gYm9vdHN0cmFwIGFuIGFwcGxpY2F0aW9uLlxuICpcbiA8ZXhhbXBsZSBtb2R1bGU9XCJuZ0FwcERlbW9cIj5cbiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJuZ0FwcERlbW9Db250cm9sbGVyXCI+XG4gICAgIEkgY2FuIGFkZDoge3thfX0gKyB7e2J9fSA9ICB7eyBhK2IgfX1cbiAgIDwvZGl2PlxuICAgPC9maWxlPlxuICAgPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuICAgYW5ndWxhci5tb2R1bGUoJ25nQXBwRGVtbycsIFtdKS5jb250cm9sbGVyKCduZ0FwcERlbW9Db250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICRzY29wZS5hID0gMTtcbiAgICAgJHNjb3BlLmIgPSAyO1xuICAgfSk7XG4gICA8L2ZpbGU+XG4gPC9leGFtcGxlPlxuICpcbiAqIFVzaW5nIGBuZ1N0cmljdERpYCwgeW91IHdvdWxkIHNlZSBzb21ldGhpbmcgbGlrZSB0aGlzOlxuICpcbiA8ZXhhbXBsZSBuZy1hcHAtaW5jbHVkZWQ9XCJ0cnVlXCI+XG4gICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgPGRpdiBuZy1hcHA9XCJuZ0FwcFN0cmljdERlbW9cIiBuZy1zdHJpY3QtZGk+XG4gICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiR29vZENvbnRyb2xsZXIxXCI+XG4gICAgICAgICAgIEkgY2FuIGFkZDoge3thfX0gKyB7e2J9fSA9ICB7eyBhK2IgfX1cblxuICAgICAgICAgICA8cD5UaGlzIHJlbmRlcnMgYmVjYXVzZSB0aGUgY29udHJvbGxlciBkb2VzIG5vdCBmYWlsIHRvXG4gICAgICAgICAgICAgIGluc3RhbnRpYXRlLCBieSB1c2luZyBleHBsaWNpdCBhbm5vdGF0aW9uIHN0eWxlIChzZWVcbiAgICAgICAgICAgICAgc2NyaXB0LmpzIGZvciBkZXRhaWxzKVxuICAgICAgICAgICA8L3A+XG4gICAgICAgPC9kaXY+XG5cbiAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJHb29kQ29udHJvbGxlcjJcIj5cbiAgICAgICAgICAgTmFtZTogPGlucHV0IG5nLW1vZGVsPVwibmFtZVwiPjxiciAvPlxuICAgICAgICAgICBIZWxsbywge3tuYW1lfX0hXG5cbiAgICAgICAgICAgPHA+VGhpcyByZW5kZXJzIGJlY2F1c2UgdGhlIGNvbnRyb2xsZXIgZG9lcyBub3QgZmFpbCB0b1xuICAgICAgICAgICAgICBpbnN0YW50aWF0ZSwgYnkgdXNpbmcgZXhwbGljaXQgYW5ub3RhdGlvbiBzdHlsZVxuICAgICAgICAgICAgICAoc2VlIHNjcmlwdC5qcyBmb3IgZGV0YWlscylcbiAgICAgICAgICAgPC9wPlxuICAgICAgIDwvZGl2PlxuXG4gICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiQmFkQ29udHJvbGxlclwiPlxuICAgICAgICAgICBJIGNhbiBhZGQ6IHt7YX19ICsge3tifX0gPSAge3sgYStiIH19XG5cbiAgICAgICAgICAgPHA+VGhlIGNvbnRyb2xsZXIgY291bGQgbm90IGJlIGluc3RhbnRpYXRlZCwgZHVlIHRvIHJlbHlpbmdcbiAgICAgICAgICAgICAgb24gYXV0b21hdGljIGZ1bmN0aW9uIGFubm90YXRpb25zICh3aGljaCBhcmUgZGlzYWJsZWQgaW5cbiAgICAgICAgICAgICAgc3RyaWN0IG1vZGUpLiBBcyBzdWNoLCB0aGUgY29udGVudCBvZiB0aGlzIHNlY3Rpb24gaXMgbm90XG4gICAgICAgICAgICAgIGludGVycG9sYXRlZCwgYW5kIHRoZXJlIHNob3VsZCBiZSBhbiBlcnJvciBpbiB5b3VyIHdlYiBjb25zb2xlLlxuICAgICAgICAgICA8L3A+XG4gICAgICAgPC9kaXY+XG4gICA8L2Rpdj5cbiAgIDwvZmlsZT5cbiAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cbiAgIGFuZ3VsYXIubW9kdWxlKCduZ0FwcFN0cmljdERlbW8nLCBbXSlcbiAgICAgLy8gQmFkQ29udHJvbGxlciB3aWxsIGZhaWwgdG8gaW5zdGFudGlhdGUsIGR1ZSB0byByZWx5aW5nIG9uIGF1dG9tYXRpYyBmdW5jdGlvbiBhbm5vdGF0aW9uLFxuICAgICAvLyByYXRoZXIgdGhhbiBhbiBleHBsaWNpdCBhbm5vdGF0aW9uXG4gICAgIC5jb250cm9sbGVyKCdCYWRDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgJHNjb3BlLmEgPSAxO1xuICAgICAgICRzY29wZS5iID0gMjtcbiAgICAgfSlcbiAgICAgLy8gVW5saWtlIEJhZENvbnRyb2xsZXIsIEdvb2RDb250cm9sbGVyMSBhbmQgR29vZENvbnRyb2xsZXIyIHdpbGwgbm90IGZhaWwgdG8gYmUgaW5zdGFudGlhdGVkLFxuICAgICAvLyBkdWUgdG8gdXNpbmcgZXhwbGljaXQgYW5ub3RhdGlvbnMgdXNpbmcgdGhlIGFycmF5IHN0eWxlIGFuZCAkaW5qZWN0IHByb3BlcnR5LCByZXNwZWN0aXZlbHkuXG4gICAgIC5jb250cm9sbGVyKCdHb29kQ29udHJvbGxlcjEnLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICRzY29wZS5hID0gMTtcbiAgICAgICAkc2NvcGUuYiA9IDI7XG4gICAgIH1dKVxuICAgICAuY29udHJvbGxlcignR29vZENvbnRyb2xsZXIyJywgR29vZENvbnRyb2xsZXIyKTtcbiAgICAgZnVuY3Rpb24gR29vZENvbnRyb2xsZXIyKCRzY29wZSkge1xuICAgICAgICRzY29wZS5uYW1lID0gXCJXb3JsZFwiO1xuICAgICB9XG4gICAgIEdvb2RDb250cm9sbGVyMi4kaW5qZWN0ID0gWyckc2NvcGUnXTtcbiAgIDwvZmlsZT5cbiAgIDxmaWxlIG5hbWU9XCJzdHlsZS5jc3NcIj5cbiAgIGRpdltuZy1jb250cm9sbGVyXSB7XG4gICAgICAgbWFyZ2luLWJvdHRvbTogMWVtO1xuICAgICAgIC13ZWJraXQtYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICBib3JkZXI6IDFweCBzb2xpZDtcbiAgICAgICBwYWRkaW5nOiAuNWVtO1xuICAgfVxuICAgZGl2W25nLWNvbnRyb2xsZXJePUdvb2RdIHtcbiAgICAgICBib3JkZXItY29sb3I6ICNkNmU5YzY7XG4gICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2RmZjBkODtcbiAgICAgICBjb2xvcjogIzNjNzYzZDtcbiAgIH1cbiAgIGRpdltuZy1jb250cm9sbGVyXj1CYWRdIHtcbiAgICAgICBib3JkZXItY29sb3I6ICNlYmNjZDE7XG4gICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2YyZGVkZTtcbiAgICAgICBjb2xvcjogI2E5NDQ0MjtcbiAgICAgICBtYXJnaW4tYm90dG9tOiAwO1xuICAgfVxuICAgPC9maWxlPlxuIDwvZXhhbXBsZT5cbiAqL1xuZnVuY3Rpb24gYW5ndWxhckluaXQoZWxlbWVudCwgYm9vdHN0cmFwKSB7XG4gIHZhciBhcHBFbGVtZW50LFxuICAgICAgbW9kdWxlLFxuICAgICAgY29uZmlnID0ge307XG5cbiAgLy8gVGhlIGVsZW1lbnQgYGVsZW1lbnRgIGhhcyBwcmlvcml0eSBvdmVyIGFueSBvdGhlciBlbGVtZW50XG4gIGZvckVhY2gobmdBdHRyUHJlZml4ZXMsIGZ1bmN0aW9uKHByZWZpeCkge1xuICAgIHZhciBuYW1lID0gcHJlZml4ICsgJ2FwcCc7XG5cbiAgICBpZiAoIWFwcEVsZW1lbnQgJiYgZWxlbWVudC5oYXNBdHRyaWJ1dGUgJiYgZWxlbWVudC5oYXNBdHRyaWJ1dGUobmFtZSkpIHtcbiAgICAgIGFwcEVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgbW9kdWxlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUobmFtZSk7XG4gICAgfVxuICB9KTtcbiAgZm9yRWFjaChuZ0F0dHJQcmVmaXhlcywgZnVuY3Rpb24ocHJlZml4KSB7XG4gICAgdmFyIG5hbWUgPSBwcmVmaXggKyAnYXBwJztcbiAgICB2YXIgY2FuZGlkYXRlO1xuXG4gICAgaWYgKCFhcHBFbGVtZW50ICYmIChjYW5kaWRhdGUgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ1snICsgbmFtZS5yZXBsYWNlKCc6JywgJ1xcXFw6JykgKyAnXScpKSkge1xuICAgICAgYXBwRWxlbWVudCA9IGNhbmRpZGF0ZTtcbiAgICAgIG1vZHVsZSA9IGNhbmRpZGF0ZS5nZXRBdHRyaWJ1dGUobmFtZSk7XG4gICAgfVxuICB9KTtcbiAgaWYgKGFwcEVsZW1lbnQpIHtcbiAgICBjb25maWcuc3RyaWN0RGkgPSBnZXROZ0F0dHJpYnV0ZShhcHBFbGVtZW50LCBcInN0cmljdC1kaVwiKSAhPT0gbnVsbDtcbiAgICBib290c3RyYXAoYXBwRWxlbWVudCwgbW9kdWxlID8gW21vZHVsZV0gOiBbXSwgY29uZmlnKTtcbiAgfVxufVxuXG4vKipcbiAqIEBuZ2RvYyBmdW5jdGlvblxuICogQG5hbWUgYW5ndWxhci5ib290c3RyYXBcbiAqIEBtb2R1bGUgbmdcbiAqIEBkZXNjcmlwdGlvblxuICogVXNlIHRoaXMgZnVuY3Rpb24gdG8gbWFudWFsbHkgc3RhcnQgdXAgYW5ndWxhciBhcHBsaWNhdGlvbi5cbiAqXG4gKiBTZWU6IHtAbGluayBndWlkZS9ib290c3RyYXAgQm9vdHN0cmFwfVxuICpcbiAqIE5vdGUgdGhhdCBQcm90cmFjdG9yIGJhc2VkIGVuZC10by1lbmQgdGVzdHMgY2Fubm90IHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGJvb3RzdHJhcCBtYW51YWxseS5cbiAqIFRoZXkgbXVzdCB1c2Uge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0FwcCBuZ0FwcH0uXG4gKlxuICogQW5ndWxhciB3aWxsIGRldGVjdCBpZiBpdCBoYXMgYmVlbiBsb2FkZWQgaW50byB0aGUgYnJvd3NlciBtb3JlIHRoYW4gb25jZSBhbmQgb25seSBhbGxvdyB0aGVcbiAqIGZpcnN0IGxvYWRlZCBzY3JpcHQgdG8gYmUgYm9vdHN0cmFwcGVkIGFuZCB3aWxsIHJlcG9ydCBhIHdhcm5pbmcgdG8gdGhlIGJyb3dzZXIgY29uc29sZSBmb3JcbiAqIGVhY2ggb2YgdGhlIHN1YnNlcXVlbnQgc2NyaXB0cy4gVGhpcyBwcmV2ZW50cyBzdHJhbmdlIHJlc3VsdHMgaW4gYXBwbGljYXRpb25zLCB3aGVyZSBvdGhlcndpc2VcbiAqIG11bHRpcGxlIGluc3RhbmNlcyBvZiBBbmd1bGFyIHRyeSB0byB3b3JrIG9uIHRoZSBET00uXG4gKlxuICogYGBgaHRtbFxuICogPCFkb2N0eXBlIGh0bWw+XG4gKiA8aHRtbD5cbiAqIDxib2R5PlxuICogPGRpdiBuZy1jb250cm9sbGVyPVwiV2VsY29tZUNvbnRyb2xsZXJcIj5cbiAqICAge3tncmVldGluZ319XG4gKiA8L2Rpdj5cbiAqXG4gKiA8c2NyaXB0IHNyYz1cImFuZ3VsYXIuanNcIj48L3NjcmlwdD5cbiAqIDxzY3JpcHQ+XG4gKiAgIHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZGVtbycsIFtdKVxuICogICAuY29udHJvbGxlcignV2VsY29tZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAqICAgICAgICRzY29wZS5ncmVldGluZyA9ICdXZWxjb21lISc7XG4gKiAgIH0pO1xuICogICBhbmd1bGFyLmJvb3RzdHJhcChkb2N1bWVudCwgWydkZW1vJ10pO1xuICogPC9zY3JpcHQ+XG4gKiA8L2JvZHk+XG4gKiA8L2h0bWw+XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgRE9NIGVsZW1lbnQgd2hpY2ggaXMgdGhlIHJvb3Qgb2YgYW5ndWxhciBhcHBsaWNhdGlvbi5cbiAqIEBwYXJhbSB7QXJyYXk8U3RyaW5nfEZ1bmN0aW9ufEFycmF5Pj19IG1vZHVsZXMgYW4gYXJyYXkgb2YgbW9kdWxlcyB0byBsb2FkIGludG8gdGhlIGFwcGxpY2F0aW9uLlxuICogICAgIEVhY2ggaXRlbSBpbiB0aGUgYXJyYXkgc2hvdWxkIGJlIHRoZSBuYW1lIG9mIGEgcHJlZGVmaW5lZCBtb2R1bGUgb3IgYSAoREkgYW5ub3RhdGVkKVxuICogICAgIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBpbnZva2VkIGJ5IHRoZSBpbmplY3RvciBhcyBhIGBjb25maWdgIGJsb2NrLlxuICogICAgIFNlZToge0BsaW5rIGFuZ3VsYXIubW9kdWxlIG1vZHVsZXN9XG4gKiBAcGFyYW0ge09iamVjdD19IGNvbmZpZyBhbiBvYmplY3QgZm9yIGRlZmluaW5nIGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdGhlIGFwcGxpY2F0aW9uLiBUaGVcbiAqICAgICBmb2xsb3dpbmcga2V5cyBhcmUgc3VwcG9ydGVkOlxuICpcbiAqICogYHN0cmljdERpYCAtIGRpc2FibGUgYXV0b21hdGljIGZ1bmN0aW9uIGFubm90YXRpb24gZm9yIHRoZSBhcHBsaWNhdGlvbi4gVGhpcyBpcyBtZWFudCB0b1xuICogICBhc3Npc3QgaW4gZmluZGluZyBidWdzIHdoaWNoIGJyZWFrIG1pbmlmaWVkIGNvZGUuIERlZmF1bHRzIHRvIGBmYWxzZWAuXG4gKlxuICogQHJldHVybnMge2F1dG8uJGluamVjdG9yfSBSZXR1cm5zIHRoZSBuZXdseSBjcmVhdGVkIGluamVjdG9yIGZvciB0aGlzIGFwcC5cbiAqL1xuZnVuY3Rpb24gYm9vdHN0cmFwKGVsZW1lbnQsIG1vZHVsZXMsIGNvbmZpZykge1xuICBpZiAoIWlzT2JqZWN0KGNvbmZpZykpIGNvbmZpZyA9IHt9O1xuICB2YXIgZGVmYXVsdENvbmZpZyA9IHtcbiAgICBzdHJpY3REaTogZmFsc2VcbiAgfTtcbiAgY29uZmlnID0gZXh0ZW5kKGRlZmF1bHRDb25maWcsIGNvbmZpZyk7XG4gIHZhciBkb0Jvb3RzdHJhcCA9IGZ1bmN0aW9uKCkge1xuICAgIGVsZW1lbnQgPSBqcUxpdGUoZWxlbWVudCk7XG5cbiAgICBpZiAoZWxlbWVudC5pbmplY3RvcigpKSB7XG4gICAgICB2YXIgdGFnID0gKGVsZW1lbnRbMF0gPT09IGRvY3VtZW50KSA/ICdkb2N1bWVudCcgOiBzdGFydGluZ1RhZyhlbGVtZW50KTtcbiAgICAgIC8vRW5jb2RlIGFuZ2xlIGJyYWNrZXRzIHRvIHByZXZlbnQgaW5wdXQgZnJvbSBiZWluZyBzYW5pdGl6ZWQgdG8gZW1wdHkgc3RyaW5nICM4NjgzXG4gICAgICB0aHJvdyBuZ01pbkVycihcbiAgICAgICAgICAnYnRzdHJwZCcsXG4gICAgICAgICAgXCJBcHAgQWxyZWFkeSBCb290c3RyYXBwZWQgd2l0aCB0aGlzIEVsZW1lbnQgJ3swfSdcIixcbiAgICAgICAgICB0YWcucmVwbGFjZSgvPC8sJyZsdDsnKS5yZXBsYWNlKC8+LywnJmd0OycpKTtcbiAgICB9XG5cbiAgICBtb2R1bGVzID0gbW9kdWxlcyB8fCBbXTtcbiAgICBtb2R1bGVzLnVuc2hpZnQoWyckcHJvdmlkZScsIGZ1bmN0aW9uKCRwcm92aWRlKSB7XG4gICAgICAkcHJvdmlkZS52YWx1ZSgnJHJvb3RFbGVtZW50JywgZWxlbWVudCk7XG4gICAgfV0pO1xuXG4gICAgaWYgKGNvbmZpZy5kZWJ1Z0luZm9FbmFibGVkKSB7XG4gICAgICAvLyBQdXNoaW5nIHNvIHRoYXQgdGhpcyBvdmVycmlkZXMgYGRlYnVnSW5mb0VuYWJsZWRgIHNldHRpbmcgZGVmaW5lZCBpbiB1c2VyJ3MgYG1vZHVsZXNgLlxuICAgICAgbW9kdWxlcy5wdXNoKFsnJGNvbXBpbGVQcm92aWRlcicsIGZ1bmN0aW9uKCRjb21waWxlUHJvdmlkZXIpIHtcbiAgICAgICAgJGNvbXBpbGVQcm92aWRlci5kZWJ1Z0luZm9FbmFibGVkKHRydWUpO1xuICAgICAgfV0pO1xuICAgIH1cblxuICAgIG1vZHVsZXMudW5zaGlmdCgnbmcnKTtcbiAgICB2YXIgaW5qZWN0b3IgPSBjcmVhdGVJbmplY3Rvcihtb2R1bGVzLCBjb25maWcuc3RyaWN0RGkpO1xuICAgIGluamVjdG9yLmludm9rZShbJyRyb290U2NvcGUnLCAnJHJvb3RFbGVtZW50JywgJyRjb21waWxlJywgJyRpbmplY3RvcicsXG4gICAgICAgZnVuY3Rpb24gYm9vdHN0cmFwQXBwbHkoc2NvcGUsIGVsZW1lbnQsIGNvbXBpbGUsIGluamVjdG9yKSB7XG4gICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICAgICBlbGVtZW50LmRhdGEoJyRpbmplY3RvcicsIGluamVjdG9yKTtcbiAgICAgICAgICBjb21waWxlKGVsZW1lbnQpKHNjb3BlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XVxuICAgICk7XG4gICAgcmV0dXJuIGluamVjdG9yO1xuICB9O1xuXG4gIHZhciBOR19FTkFCTEVfREVCVUdfSU5GTyA9IC9eTkdfRU5BQkxFX0RFQlVHX0lORk8hLztcbiAgdmFyIE5HX0RFRkVSX0JPT1RTVFJBUCA9IC9eTkdfREVGRVJfQk9PVFNUUkFQIS87XG5cbiAgaWYgKHdpbmRvdyAmJiBOR19FTkFCTEVfREVCVUdfSU5GTy50ZXN0KHdpbmRvdy5uYW1lKSkge1xuICAgIGNvbmZpZy5kZWJ1Z0luZm9FbmFibGVkID0gdHJ1ZTtcbiAgICB3aW5kb3cubmFtZSA9IHdpbmRvdy5uYW1lLnJlcGxhY2UoTkdfRU5BQkxFX0RFQlVHX0lORk8sICcnKTtcbiAgfVxuXG4gIGlmICh3aW5kb3cgJiYgIU5HX0RFRkVSX0JPT1RTVFJBUC50ZXN0KHdpbmRvdy5uYW1lKSkge1xuICAgIHJldHVybiBkb0Jvb3RzdHJhcCgpO1xuICB9XG5cbiAgd2luZG93Lm5hbWUgPSB3aW5kb3cubmFtZS5yZXBsYWNlKE5HX0RFRkVSX0JPT1RTVFJBUCwgJycpO1xuICBhbmd1bGFyLnJlc3VtZUJvb3RzdHJhcCA9IGZ1bmN0aW9uKGV4dHJhTW9kdWxlcykge1xuICAgIGZvckVhY2goZXh0cmFNb2R1bGVzLCBmdW5jdGlvbihtb2R1bGUpIHtcbiAgICAgIG1vZHVsZXMucHVzaChtb2R1bGUpO1xuICAgIH0pO1xuICAgIHJldHVybiBkb0Jvb3RzdHJhcCgpO1xuICB9O1xuXG4gIGlmIChpc0Z1bmN0aW9uKGFuZ3VsYXIucmVzdW1lRGVmZXJyZWRCb290c3RyYXApKSB7XG4gICAgYW5ndWxhci5yZXN1bWVEZWZlcnJlZEJvb3RzdHJhcCgpO1xuICB9XG59XG5cbi8qKlxuICogQG5nZG9jIGZ1bmN0aW9uXG4gKiBAbmFtZSBhbmd1bGFyLnJlbG9hZFdpdGhEZWJ1Z0luZm9cbiAqIEBtb2R1bGUgbmdcbiAqIEBkZXNjcmlwdGlvblxuICogVXNlIHRoaXMgZnVuY3Rpb24gdG8gcmVsb2FkIHRoZSBjdXJyZW50IGFwcGxpY2F0aW9uIHdpdGggZGVidWcgaW5mb3JtYXRpb24gdHVybmVkIG9uLlxuICogVGhpcyB0YWtlcyBwcmVjZWRlbmNlIG92ZXIgYSBjYWxsIHRvIGAkY29tcGlsZVByb3ZpZGVyLmRlYnVnSW5mb0VuYWJsZWQoZmFsc2UpYC5cbiAqXG4gKiBTZWUge0BsaW5rIG5nLiRjb21waWxlUHJvdmlkZXIjZGVidWdJbmZvRW5hYmxlZH0gZm9yIG1vcmUuXG4gKi9cbmZ1bmN0aW9uIHJlbG9hZFdpdGhEZWJ1Z0luZm8oKSB7XG4gIHdpbmRvdy5uYW1lID0gJ05HX0VOQUJMRV9ERUJVR19JTkZPIScgKyB3aW5kb3cubmFtZTtcbiAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xufVxuXG4vKipcbiAqIEBuYW1lIGFuZ3VsYXIuZ2V0VGVzdGFiaWxpdHlcbiAqIEBtb2R1bGUgbmdcbiAqIEBkZXNjcmlwdGlvblxuICogR2V0IHRoZSB0ZXN0YWJpbGl0eSBzZXJ2aWNlIGZvciB0aGUgaW5zdGFuY2Ugb2YgQW5ndWxhciBvbiB0aGUgZ2l2ZW5cbiAqIGVsZW1lbnQuXG4gKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgRE9NIGVsZW1lbnQgd2hpY2ggaXMgdGhlIHJvb3Qgb2YgYW5ndWxhciBhcHBsaWNhdGlvbi5cbiAqL1xuZnVuY3Rpb24gZ2V0VGVzdGFiaWxpdHkocm9vdEVsZW1lbnQpIHtcbiAgdmFyIGluamVjdG9yID0gYW5ndWxhci5lbGVtZW50KHJvb3RFbGVtZW50KS5pbmplY3RvcigpO1xuICBpZiAoIWluamVjdG9yKSB7XG4gICAgdGhyb3cgbmdNaW5FcnIoJ3Rlc3QnLFxuICAgICAgJ25vIGluamVjdG9yIGZvdW5kIGZvciBlbGVtZW50IGFyZ3VtZW50IHRvIGdldFRlc3RhYmlsaXR5Jyk7XG4gIH1cbiAgcmV0dXJuIGluamVjdG9yLmdldCgnJCR0ZXN0YWJpbGl0eScpO1xufVxuXG52YXIgU05BS0VfQ0FTRV9SRUdFWFAgPSAvW0EtWl0vZztcbmZ1bmN0aW9uIHNuYWtlX2Nhc2UobmFtZSwgc2VwYXJhdG9yKSB7XG4gIHNlcGFyYXRvciA9IHNlcGFyYXRvciB8fCAnXyc7XG4gIHJldHVybiBuYW1lLnJlcGxhY2UoU05BS0VfQ0FTRV9SRUdFWFAsIGZ1bmN0aW9uKGxldHRlciwgcG9zKSB7XG4gICAgcmV0dXJuIChwb3MgPyBzZXBhcmF0b3IgOiAnJykgKyBsZXR0ZXIudG9Mb3dlckNhc2UoKTtcbiAgfSk7XG59XG5cbnZhciBiaW5kSlF1ZXJ5RmlyZWQgPSBmYWxzZTtcbmZ1bmN0aW9uIGJpbmRKUXVlcnkoKSB7XG4gIHZhciBvcmlnaW5hbENsZWFuRGF0YTtcblxuICBpZiAoYmluZEpRdWVyeUZpcmVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gYmluZCB0byBqUXVlcnkgaWYgcHJlc2VudDtcbiAgdmFyIGpxTmFtZSA9IGpxKCk7XG4gIGpRdWVyeSA9IGlzVW5kZWZpbmVkKGpxTmFtZSkgPyB3aW5kb3cualF1ZXJ5IDogICAvLyB1c2UgalF1ZXJ5IChpZiBwcmVzZW50KVxuICAgICAgICAgICAhanFOYW1lICAgICAgICAgICAgID8gdW5kZWZpbmVkICAgICA6ICAgLy8gdXNlIGpxTGl0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93W2pxTmFtZV07ICAgLy8gdXNlIGpRdWVyeSBzcGVjaWZpZWQgYnkgYG5nSnFgXG5cbiAgLy8gVXNlIGpRdWVyeSBpZiBpdCBleGlzdHMgd2l0aCBwcm9wZXIgZnVuY3Rpb25hbGl0eSwgb3RoZXJ3aXNlIGRlZmF1bHQgdG8gdXMuXG4gIC8vIEFuZ3VsYXIgMS4yKyByZXF1aXJlcyBqUXVlcnkgMS43KyBmb3Igb24oKS9vZmYoKSBzdXBwb3J0LlxuICAvLyBBbmd1bGFyIDEuMysgdGVjaG5pY2FsbHkgcmVxdWlyZXMgYXQgbGVhc3QgalF1ZXJ5IDIuMSsgYnV0IGl0IG1heSB3b3JrIHdpdGggb2xkZXJcbiAgLy8gdmVyc2lvbnMuIEl0IHdpbGwgbm90IHdvcmsgZm9yIHN1cmUgd2l0aCBqUXVlcnkgPDEuNywgdGhvdWdoLlxuICBpZiAoalF1ZXJ5ICYmIGpRdWVyeS5mbi5vbikge1xuICAgIGpxTGl0ZSA9IGpRdWVyeTtcbiAgICBleHRlbmQoalF1ZXJ5LmZuLCB7XG4gICAgICBzY29wZTogSlFMaXRlUHJvdG90eXBlLnNjb3BlLFxuICAgICAgaXNvbGF0ZVNjb3BlOiBKUUxpdGVQcm90b3R5cGUuaXNvbGF0ZVNjb3BlLFxuICAgICAgY29udHJvbGxlcjogSlFMaXRlUHJvdG90eXBlLmNvbnRyb2xsZXIsXG4gICAgICBpbmplY3RvcjogSlFMaXRlUHJvdG90eXBlLmluamVjdG9yLFxuICAgICAgaW5oZXJpdGVkRGF0YTogSlFMaXRlUHJvdG90eXBlLmluaGVyaXRlZERhdGFcbiAgICB9KTtcblxuICAgIC8vIEFsbCBub2RlcyByZW1vdmVkIGZyb20gdGhlIERPTSB2aWEgdmFyaW91cyBqUXVlcnkgQVBJcyBsaWtlIC5yZW1vdmUoKVxuICAgIC8vIGFyZSBwYXNzZWQgdGhyb3VnaCBqUXVlcnkuY2xlYW5EYXRhLiBNb25rZXktcGF0Y2ggdGhpcyBtZXRob2QgdG8gZmlyZVxuICAgIC8vIHRoZSAkZGVzdHJveSBldmVudCBvbiBhbGwgcmVtb3ZlZCBub2Rlcy5cbiAgICBvcmlnaW5hbENsZWFuRGF0YSA9IGpRdWVyeS5jbGVhbkRhdGE7XG4gICAgalF1ZXJ5LmNsZWFuRGF0YSA9IGZ1bmN0aW9uKGVsZW1zKSB7XG4gICAgICB2YXIgZXZlbnRzO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGVsZW07IChlbGVtID0gZWxlbXNbaV0pICE9IG51bGw7IGkrKykge1xuICAgICAgICBldmVudHMgPSBqUXVlcnkuX2RhdGEoZWxlbSwgXCJldmVudHNcIik7XG4gICAgICAgIGlmIChldmVudHMgJiYgZXZlbnRzLiRkZXN0cm95KSB7XG4gICAgICAgICAgalF1ZXJ5KGVsZW0pLnRyaWdnZXJIYW5kbGVyKCckZGVzdHJveScpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBvcmlnaW5hbENsZWFuRGF0YShlbGVtcyk7XG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBqcUxpdGUgPSBKUUxpdGU7XG4gIH1cblxuICBhbmd1bGFyLmVsZW1lbnQgPSBqcUxpdGU7XG5cbiAgLy8gUHJldmVudCBkb3VibGUtcHJveHlpbmcuXG4gIGJpbmRKUXVlcnlGaXJlZCA9IHRydWU7XG59XG5cbi8qKlxuICogdGhyb3cgZXJyb3IgaWYgdGhlIGFyZ3VtZW50IGlzIGZhbHN5LlxuICovXG5mdW5jdGlvbiBhc3NlcnRBcmcoYXJnLCBuYW1lLCByZWFzb24pIHtcbiAgaWYgKCFhcmcpIHtcbiAgICB0aHJvdyBuZ01pbkVycignYXJlcScsIFwiQXJndW1lbnQgJ3swfScgaXMgezF9XCIsIChuYW1lIHx8ICc/JyksIChyZWFzb24gfHwgXCJyZXF1aXJlZFwiKSk7XG4gIH1cbiAgcmV0dXJuIGFyZztcbn1cblxuZnVuY3Rpb24gYXNzZXJ0QXJnRm4oYXJnLCBuYW1lLCBhY2NlcHRBcnJheUFubm90YXRpb24pIHtcbiAgaWYgKGFjY2VwdEFycmF5QW5ub3RhdGlvbiAmJiBpc0FycmF5KGFyZykpIHtcbiAgICAgIGFyZyA9IGFyZ1thcmcubGVuZ3RoIC0gMV07XG4gIH1cblxuICBhc3NlcnRBcmcoaXNGdW5jdGlvbihhcmcpLCBuYW1lLCAnbm90IGEgZnVuY3Rpb24sIGdvdCAnICtcbiAgICAgIChhcmcgJiYgdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgPyBhcmcuY29uc3RydWN0b3IubmFtZSB8fCAnT2JqZWN0JyA6IHR5cGVvZiBhcmcpKTtcbiAgcmV0dXJuIGFyZztcbn1cblxuLyoqXG4gKiB0aHJvdyBlcnJvciBpZiB0aGUgbmFtZSBnaXZlbiBpcyBoYXNPd25Qcm9wZXJ0eVxuICogQHBhcmFtICB7U3RyaW5nfSBuYW1lICAgIHRoZSBuYW1lIHRvIHRlc3RcbiAqIEBwYXJhbSAge1N0cmluZ30gY29udGV4dCB0aGUgY29udGV4dCBpbiB3aGljaCB0aGUgbmFtZSBpcyB1c2VkLCBzdWNoIGFzIG1vZHVsZSBvciBkaXJlY3RpdmVcbiAqL1xuZnVuY3Rpb24gYXNzZXJ0Tm90SGFzT3duUHJvcGVydHkobmFtZSwgY29udGV4dCkge1xuICBpZiAobmFtZSA9PT0gJ2hhc093blByb3BlcnR5Jykge1xuICAgIHRocm93IG5nTWluRXJyKCdiYWRuYW1lJywgXCJoYXNPd25Qcm9wZXJ0eSBpcyBub3QgYSB2YWxpZCB7MH0gbmFtZVwiLCBjb250ZXh0KTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHVybiB0aGUgdmFsdWUgYWNjZXNzaWJsZSBmcm9tIHRoZSBvYmplY3QgYnkgcGF0aC4gQW55IHVuZGVmaW5lZCB0cmF2ZXJzYWxzIGFyZSBpZ25vcmVkXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqIHN0YXJ0aW5nIG9iamVjdFxuICogQHBhcmFtIHtTdHJpbmd9IHBhdGggcGF0aCB0byB0cmF2ZXJzZVxuICogQHBhcmFtIHtib29sZWFufSBbYmluZEZuVG9TY29wZT10cnVlXVxuICogQHJldHVybnMge09iamVjdH0gdmFsdWUgYXMgYWNjZXNzaWJsZSBieSBwYXRoXG4gKi9cbi8vVE9ETyhtaXNrbyk6IHRoaXMgZnVuY3Rpb24gbmVlZHMgdG8gYmUgcmVtb3ZlZFxuZnVuY3Rpb24gZ2V0dGVyKG9iaiwgcGF0aCwgYmluZEZuVG9TY29wZSkge1xuICBpZiAoIXBhdGgpIHJldHVybiBvYmo7XG4gIHZhciBrZXlzID0gcGF0aC5zcGxpdCgnLicpO1xuICB2YXIga2V5O1xuICB2YXIgbGFzdEluc3RhbmNlID0gb2JqO1xuICB2YXIgbGVuID0ga2V5cy5sZW5ndGg7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgIGtleSA9IGtleXNbaV07XG4gICAgaWYgKG9iaikge1xuICAgICAgb2JqID0gKGxhc3RJbnN0YW5jZSA9IG9iailba2V5XTtcbiAgICB9XG4gIH1cbiAgaWYgKCFiaW5kRm5Ub1Njb3BlICYmIGlzRnVuY3Rpb24ob2JqKSkge1xuICAgIHJldHVybiBiaW5kKGxhc3RJbnN0YW5jZSwgb2JqKTtcbiAgfVxuICByZXR1cm4gb2JqO1xufVxuXG4vKipcbiAqIFJldHVybiB0aGUgRE9NIHNpYmxpbmdzIGJldHdlZW4gdGhlIGZpcnN0IGFuZCBsYXN0IG5vZGUgaW4gdGhlIGdpdmVuIGFycmF5LlxuICogQHBhcmFtIHtBcnJheX0gYXJyYXkgbGlrZSBvYmplY3RcbiAqIEByZXR1cm5zIHtBcnJheX0gdGhlIGlucHV0dGVkIG9iamVjdCBvciBhIGpxTGl0ZSBjb2xsZWN0aW9uIGNvbnRhaW5pbmcgdGhlIG5vZGVzXG4gKi9cbmZ1bmN0aW9uIGdldEJsb2NrTm9kZXMobm9kZXMpIHtcbiAgLy8gVE9ETyhwZXJmKTogdXBkYXRlIGBub2Rlc2AgaW5zdGVhZCBvZiBjcmVhdGluZyBhIG5ldyBvYmplY3Q/XG4gIHZhciBub2RlID0gbm9kZXNbMF07XG4gIHZhciBlbmROb2RlID0gbm9kZXNbbm9kZXMubGVuZ3RoIC0gMV07XG4gIHZhciBibG9ja05vZGVzO1xuXG4gIGZvciAodmFyIGkgPSAxOyBub2RlICE9PSBlbmROb2RlICYmIChub2RlID0gbm9kZS5uZXh0U2libGluZyk7IGkrKykge1xuICAgIGlmIChibG9ja05vZGVzIHx8IG5vZGVzW2ldICE9PSBub2RlKSB7XG4gICAgICBpZiAoIWJsb2NrTm9kZXMpIHtcbiAgICAgICAgYmxvY2tOb2RlcyA9IGpxTGl0ZShzbGljZS5jYWxsKG5vZGVzLCAwLCBpKSk7XG4gICAgICB9XG4gICAgICBibG9ja05vZGVzLnB1c2gobm9kZSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGJsb2NrTm9kZXMgfHwgbm9kZXM7XG59XG5cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IG9iamVjdCB3aXRob3V0IGEgcHJvdG90eXBlLiBUaGlzIG9iamVjdCBpcyB1c2VmdWwgZm9yIGxvb2t1cCB3aXRob3V0IGhhdmluZyB0b1xuICogZ3VhcmQgYWdhaW5zdCBwcm90b3R5cGljYWxseSBpbmhlcml0ZWQgcHJvcGVydGllcyB2aWEgaGFzT3duUHJvcGVydHkuXG4gKlxuICogUmVsYXRlZCBtaWNyby1iZW5jaG1hcmtzOlxuICogLSBodHRwOi8vanNwZXJmLmNvbS9vYmplY3QtY3JlYXRlMlxuICogLSBodHRwOi8vanNwZXJmLmNvbS9wcm90by1tYXAtbG9va3VwLzJcbiAqIC0gaHR0cDovL2pzcGVyZi5jb20vZm9yLWluLXZzLW9iamVjdC1rZXlzMlxuICpcbiAqIEByZXR1cm5zIHtPYmplY3R9XG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZU1hcCgpIHtcbiAgcmV0dXJuIE9iamVjdC5jcmVhdGUobnVsbCk7XG59XG5cbnZhciBOT0RFX1RZUEVfRUxFTUVOVCA9IDE7XG52YXIgTk9ERV9UWVBFX0FUVFJJQlVURSA9IDI7XG52YXIgTk9ERV9UWVBFX1RFWFQgPSAzO1xudmFyIE5PREVfVFlQRV9DT01NRU5UID0gODtcbnZhciBOT0RFX1RZUEVfRE9DVU1FTlQgPSA5O1xudmFyIE5PREVfVFlQRV9ET0NVTUVOVF9GUkFHTUVOVCA9IDExO1xuXG4vKipcbiAqIEBuZ2RvYyB0eXBlXG4gKiBAbmFtZSBhbmd1bGFyLk1vZHVsZVxuICogQG1vZHVsZSBuZ1xuICogQGRlc2NyaXB0aW9uXG4gKlxuICogSW50ZXJmYWNlIGZvciBjb25maWd1cmluZyBhbmd1bGFyIHtAbGluayBhbmd1bGFyLm1vZHVsZSBtb2R1bGVzfS5cbiAqL1xuXG5mdW5jdGlvbiBzZXR1cE1vZHVsZUxvYWRlcih3aW5kb3cpIHtcblxuICB2YXIgJGluamVjdG9yTWluRXJyID0gbWluRXJyKCckaW5qZWN0b3InKTtcbiAgdmFyIG5nTWluRXJyID0gbWluRXJyKCduZycpO1xuXG4gIGZ1bmN0aW9uIGVuc3VyZShvYmosIG5hbWUsIGZhY3RvcnkpIHtcbiAgICByZXR1cm4gb2JqW25hbWVdIHx8IChvYmpbbmFtZV0gPSBmYWN0b3J5KCkpO1xuICB9XG5cbiAgdmFyIGFuZ3VsYXIgPSBlbnN1cmUod2luZG93LCAnYW5ndWxhcicsIE9iamVjdCk7XG5cbiAgLy8gV2UgbmVlZCB0byBleHBvc2UgYGFuZ3VsYXIuJCRtaW5FcnJgIHRvIG1vZHVsZXMgc3VjaCBhcyBgbmdSZXNvdXJjZWAgdGhhdCByZWZlcmVuY2UgaXQgZHVyaW5nIGJvb3RzdHJhcFxuICBhbmd1bGFyLiQkbWluRXJyID0gYW5ndWxhci4kJG1pbkVyciB8fCBtaW5FcnI7XG5cbiAgcmV0dXJuIGVuc3VyZShhbmd1bGFyLCAnbW9kdWxlJywgZnVuY3Rpb24oKSB7XG4gICAgLyoqIEB0eXBlIHtPYmplY3QuPHN0cmluZywgYW5ndWxhci5Nb2R1bGU+fSAqL1xuICAgIHZhciBtb2R1bGVzID0ge307XG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgZnVuY3Rpb25cbiAgICAgKiBAbmFtZSBhbmd1bGFyLm1vZHVsZVxuICAgICAqIEBtb2R1bGUgbmdcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKlxuICAgICAqIFRoZSBgYW5ndWxhci5tb2R1bGVgIGlzIGEgZ2xvYmFsIHBsYWNlIGZvciBjcmVhdGluZywgcmVnaXN0ZXJpbmcgYW5kIHJldHJpZXZpbmcgQW5ndWxhclxuICAgICAqIG1vZHVsZXMuXG4gICAgICogQWxsIG1vZHVsZXMgKGFuZ3VsYXIgY29yZSBvciAzcmQgcGFydHkpIHRoYXQgc2hvdWxkIGJlIGF2YWlsYWJsZSB0byBhbiBhcHBsaWNhdGlvbiBtdXN0IGJlXG4gICAgICogcmVnaXN0ZXJlZCB1c2luZyB0aGlzIG1lY2hhbmlzbS5cbiAgICAgKlxuICAgICAqIFBhc3Npbmcgb25lIGFyZ3VtZW50IHJldHJpZXZlcyBhbiBleGlzdGluZyB7QGxpbmsgYW5ndWxhci5Nb2R1bGV9LFxuICAgICAqIHdoZXJlYXMgcGFzc2luZyBtb3JlIHRoYW4gb25lIGFyZ3VtZW50IGNyZWF0ZXMgYSBuZXcge0BsaW5rIGFuZ3VsYXIuTW9kdWxlfVxuICAgICAqXG4gICAgICpcbiAgICAgKiAjIE1vZHVsZVxuICAgICAqXG4gICAgICogQSBtb2R1bGUgaXMgYSBjb2xsZWN0aW9uIG9mIHNlcnZpY2VzLCBkaXJlY3RpdmVzLCBjb250cm9sbGVycywgZmlsdGVycywgYW5kIGNvbmZpZ3VyYXRpb24gaW5mb3JtYXRpb24uXG4gICAgICogYGFuZ3VsYXIubW9kdWxlYCBpcyB1c2VkIHRvIGNvbmZpZ3VyZSB0aGUge0BsaW5rIGF1dG8uJGluamVjdG9yICRpbmplY3Rvcn0uXG4gICAgICpcbiAgICAgKiBgYGBqc1xuICAgICAqIC8vIENyZWF0ZSBhIG5ldyBtb2R1bGVcbiAgICAgKiB2YXIgbXlNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbXlNb2R1bGUnLCBbXSk7XG4gICAgICpcbiAgICAgKiAvLyByZWdpc3RlciBhIG5ldyBzZXJ2aWNlXG4gICAgICogbXlNb2R1bGUudmFsdWUoJ2FwcE5hbWUnLCAnTXlDb29sQXBwJyk7XG4gICAgICpcbiAgICAgKiAvLyBjb25maWd1cmUgZXhpc3Rpbmcgc2VydmljZXMgaW5zaWRlIGluaXRpYWxpemF0aW9uIGJsb2Nrcy5cbiAgICAgKiBteU1vZHVsZS5jb25maWcoWyckbG9jYXRpb25Qcm92aWRlcicsIGZ1bmN0aW9uKCRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgICogICAvLyBDb25maWd1cmUgZXhpc3RpbmcgcHJvdmlkZXJzXG4gICAgICogICAkbG9jYXRpb25Qcm92aWRlci5oYXNoUHJlZml4KCchJyk7XG4gICAgICogfV0pO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogVGhlbiB5b3UgY2FuIGNyZWF0ZSBhbiBpbmplY3RvciBhbmQgbG9hZCB5b3VyIG1vZHVsZXMgbGlrZSB0aGlzOlxuICAgICAqXG4gICAgICogYGBganNcbiAgICAgKiB2YXIgaW5qZWN0b3IgPSBhbmd1bGFyLmluamVjdG9yKFsnbmcnLCAnbXlNb2R1bGUnXSlcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIEhvd2V2ZXIgaXQncyBtb3JlIGxpa2VseSB0aGF0IHlvdSdsbCBqdXN0IHVzZVxuICAgICAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdBcHAgbmdBcHB9IG9yXG4gICAgICoge0BsaW5rIGFuZ3VsYXIuYm9vdHN0cmFwfSB0byBzaW1wbGlmeSB0aGlzIHByb2Nlc3MgZm9yIHlvdS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IXN0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgbW9kdWxlIHRvIGNyZWF0ZSBvciByZXRyaWV2ZS5cbiAgICAgKiBAcGFyYW0geyFBcnJheS48c3RyaW5nPj19IHJlcXVpcmVzIElmIHNwZWNpZmllZCB0aGVuIG5ldyBtb2R1bGUgaXMgYmVpbmcgY3JlYXRlZC4gSWZcbiAgICAgKiAgICAgICAgdW5zcGVjaWZpZWQgdGhlbiB0aGUgbW9kdWxlIGlzIGJlaW5nIHJldHJpZXZlZCBmb3IgZnVydGhlciBjb25maWd1cmF0aW9uLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb249fSBjb25maWdGbiBPcHRpb25hbCBjb25maWd1cmF0aW9uIGZ1bmN0aW9uIGZvciB0aGUgbW9kdWxlLiBTYW1lIGFzXG4gICAgICogICAgICAgIHtAbGluayBhbmd1bGFyLk1vZHVsZSNjb25maWcgTW9kdWxlI2NvbmZpZygpfS5cbiAgICAgKiBAcmV0dXJucyB7YW5ndWxhci5Nb2R1bGV9IG5ldyBtb2R1bGUgd2l0aCB0aGUge0BsaW5rIGFuZ3VsYXIuTW9kdWxlfSBhcGkuXG4gICAgICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uIG1vZHVsZShuYW1lLCByZXF1aXJlcywgY29uZmlnRm4pIHtcbiAgICAgIHZhciBhc3NlcnROb3RIYXNPd25Qcm9wZXJ0eSA9IGZ1bmN0aW9uKG5hbWUsIGNvbnRleHQpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09ICdoYXNPd25Qcm9wZXJ0eScpIHtcbiAgICAgICAgICB0aHJvdyBuZ01pbkVycignYmFkbmFtZScsICdoYXNPd25Qcm9wZXJ0eSBpcyBub3QgYSB2YWxpZCB7MH0gbmFtZScsIGNvbnRleHQpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBhc3NlcnROb3RIYXNPd25Qcm9wZXJ0eShuYW1lLCAnbW9kdWxlJyk7XG4gICAgICBpZiAocmVxdWlyZXMgJiYgbW9kdWxlcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgICBtb2R1bGVzW25hbWVdID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBlbnN1cmUobW9kdWxlcywgbmFtZSwgZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghcmVxdWlyZXMpIHtcbiAgICAgICAgICB0aHJvdyAkaW5qZWN0b3JNaW5FcnIoJ25vbW9kJywgXCJNb2R1bGUgJ3swfScgaXMgbm90IGF2YWlsYWJsZSEgWW91IGVpdGhlciBtaXNzcGVsbGVkIFwiICtcbiAgICAgICAgICAgICBcInRoZSBtb2R1bGUgbmFtZSBvciBmb3Jnb3QgdG8gbG9hZCBpdC4gSWYgcmVnaXN0ZXJpbmcgYSBtb2R1bGUgZW5zdXJlIHRoYXQgeW91IFwiICtcbiAgICAgICAgICAgICBcInNwZWNpZnkgdGhlIGRlcGVuZGVuY2llcyBhcyB0aGUgc2Vjb25kIGFyZ3VtZW50LlwiLCBuYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBAdHlwZSB7IUFycmF5LjxBcnJheS48Kj4+fSAqL1xuICAgICAgICB2YXIgaW52b2tlUXVldWUgPSBbXTtcblxuICAgICAgICAvKiogQHR5cGUgeyFBcnJheS48RnVuY3Rpb24+fSAqL1xuICAgICAgICB2YXIgY29uZmlnQmxvY2tzID0gW107XG5cbiAgICAgICAgLyoqIEB0eXBlIHshQXJyYXkuPEZ1bmN0aW9uPn0gKi9cbiAgICAgICAgdmFyIHJ1bkJsb2NrcyA9IFtdO1xuXG4gICAgICAgIHZhciBjb25maWcgPSBpbnZva2VMYXRlcignJGluamVjdG9yJywgJ2ludm9rZScsICdwdXNoJywgY29uZmlnQmxvY2tzKTtcblxuICAgICAgICAvKiogQHR5cGUge2FuZ3VsYXIuTW9kdWxlfSAqL1xuICAgICAgICB2YXIgbW9kdWxlSW5zdGFuY2UgPSB7XG4gICAgICAgICAgLy8gUHJpdmF0ZSBzdGF0ZVxuICAgICAgICAgIF9pbnZva2VRdWV1ZTogaW52b2tlUXVldWUsXG4gICAgICAgICAgX2NvbmZpZ0Jsb2NrczogY29uZmlnQmxvY2tzLFxuICAgICAgICAgIF9ydW5CbG9ja3M6IHJ1bkJsb2NrcyxcblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEBuZ2RvYyBwcm9wZXJ0eVxuICAgICAgICAgICAqIEBuYW1lIGFuZ3VsYXIuTW9kdWxlI3JlcXVpcmVzXG4gICAgICAgICAgICogQG1vZHVsZSBuZ1xuICAgICAgICAgICAqXG4gICAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAgICogSG9sZHMgdGhlIGxpc3Qgb2YgbW9kdWxlcyB3aGljaCB0aGUgaW5qZWN0b3Igd2lsbCBsb2FkIGJlZm9yZSB0aGUgY3VycmVudCBtb2R1bGUgaXNcbiAgICAgICAgICAgKiBsb2FkZWQuXG4gICAgICAgICAgICovXG4gICAgICAgICAgcmVxdWlyZXM6IHJlcXVpcmVzLFxuXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogQG5nZG9jIHByb3BlcnR5XG4gICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjbmFtZVxuICAgICAgICAgICAqIEBtb2R1bGUgbmdcbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgICAqIE5hbWUgb2YgdGhlIG1vZHVsZS5cbiAgICAgICAgICAgKi9cbiAgICAgICAgICBuYW1lOiBuYW1lLFxuXG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjcHJvdmlkZXJcbiAgICAgICAgICAgKiBAbW9kdWxlIG5nXG4gICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgc2VydmljZSBuYW1lXG4gICAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJvdmlkZXJUeXBlIENvbnN0cnVjdGlvbiBmdW5jdGlvbiBmb3IgY3JlYXRpbmcgbmV3IGluc3RhbmNlIG9mIHRoZVxuICAgICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlLlxuICAgICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgICAqIFNlZSB7QGxpbmsgYXV0by4kcHJvdmlkZSNwcm92aWRlciAkcHJvdmlkZS5wcm92aWRlcigpfS5cbiAgICAgICAgICAgKi9cbiAgICAgICAgICBwcm92aWRlcjogaW52b2tlTGF0ZXJBbmRTZXRNb2R1bGVOYW1lKCckcHJvdmlkZScsICdwcm92aWRlcicpLFxuXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgICAqIEBuYW1lIGFuZ3VsYXIuTW9kdWxlI2ZhY3RvcnlcbiAgICAgICAgICAgKiBAbW9kdWxlIG5nXG4gICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgc2VydmljZSBuYW1lXG4gICAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJvdmlkZXJGdW5jdGlvbiBGdW5jdGlvbiBmb3IgY3JlYXRpbmcgbmV3IGluc3RhbmNlIG9mIHRoZSBzZXJ2aWNlLlxuICAgICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgICAqIFNlZSB7QGxpbmsgYXV0by4kcHJvdmlkZSNmYWN0b3J5ICRwcm92aWRlLmZhY3RvcnkoKX0uXG4gICAgICAgICAgICovXG4gICAgICAgICAgZmFjdG9yeTogaW52b2tlTGF0ZXJBbmRTZXRNb2R1bGVOYW1lKCckcHJvdmlkZScsICdmYWN0b3J5JyksXG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjc2VydmljZVxuICAgICAgICAgICAqIEBtb2R1bGUgbmdcbiAgICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBzZXJ2aWNlIG5hbWVcbiAgICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjb25zdHJ1Y3RvciBBIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBpbnN0YW50aWF0ZWQuXG4gICAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAgICogU2VlIHtAbGluayBhdXRvLiRwcm92aWRlI3NlcnZpY2UgJHByb3ZpZGUuc2VydmljZSgpfS5cbiAgICAgICAgICAgKi9cbiAgICAgICAgICBzZXJ2aWNlOiBpbnZva2VMYXRlckFuZFNldE1vZHVsZU5hbWUoJyRwcm92aWRlJywgJ3NlcnZpY2UnKSxcblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICAgKiBAbmFtZSBhbmd1bGFyLk1vZHVsZSN2YWx1ZVxuICAgICAgICAgICAqIEBtb2R1bGUgbmdcbiAgICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBzZXJ2aWNlIG5hbWVcbiAgICAgICAgICAgKiBAcGFyYW0geyp9IG9iamVjdCBTZXJ2aWNlIGluc3RhbmNlIG9iamVjdC5cbiAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICAgKiBTZWUge0BsaW5rIGF1dG8uJHByb3ZpZGUjdmFsdWUgJHByb3ZpZGUudmFsdWUoKX0uXG4gICAgICAgICAgICovXG4gICAgICAgICAgdmFsdWU6IGludm9rZUxhdGVyKCckcHJvdmlkZScsICd2YWx1ZScpLFxuXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgICAqIEBuYW1lIGFuZ3VsYXIuTW9kdWxlI2NvbnN0YW50XG4gICAgICAgICAgICogQG1vZHVsZSBuZ1xuICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIGNvbnN0YW50IG5hbWVcbiAgICAgICAgICAgKiBAcGFyYW0geyp9IG9iamVjdCBDb25zdGFudCB2YWx1ZS5cbiAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICAgKiBCZWNhdXNlIHRoZSBjb25zdGFudHMgYXJlIGZpeGVkLCB0aGV5IGdldCBhcHBsaWVkIGJlZm9yZSBvdGhlciBwcm92aWRlIG1ldGhvZHMuXG4gICAgICAgICAgICogU2VlIHtAbGluayBhdXRvLiRwcm92aWRlI2NvbnN0YW50ICRwcm92aWRlLmNvbnN0YW50KCl9LlxuICAgICAgICAgICAqL1xuICAgICAgICAgIGNvbnN0YW50OiBpbnZva2VMYXRlcignJHByb3ZpZGUnLCAnY29uc3RhbnQnLCAndW5zaGlmdCcpLFxuXG4gICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICAgKiBAbmFtZSBhbmd1bGFyLk1vZHVsZSNkZWNvcmF0b3JcbiAgICAgICAgICAgKiBAbW9kdWxlIG5nXG4gICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IFRoZSBuYW1lIG9mIHRoZSBzZXJ2aWNlIHRvIGRlY29yYXRlLlxuICAgICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFRoaXMgZnVuY3Rpb24gd2lsbCBiZSBpbnZva2VkIHdoZW4gdGhlIHNlcnZpY2UgbmVlZHMgdG8gYmVcbiAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlZCBhbmQgc2hvdWxkIHJldHVybiB0aGUgZGVjb3JhdGVkIHNlcnZpY2UgaW5zdGFuY2UuXG4gICAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAgICogU2VlIHtAbGluayBhdXRvLiRwcm92aWRlI2RlY29yYXRvciAkcHJvdmlkZS5kZWNvcmF0b3IoKX0uXG4gICAgICAgICAgICovXG4gICAgICAgICAgZGVjb3JhdG9yOiBpbnZva2VMYXRlckFuZFNldE1vZHVsZU5hbWUoJyRwcm92aWRlJywgJ2RlY29yYXRvcicpLFxuXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgICAqIEBuYW1lIGFuZ3VsYXIuTW9kdWxlI2FuaW1hdGlvblxuICAgICAgICAgICAqIEBtb2R1bGUgbmdcbiAgICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBhbmltYXRpb24gbmFtZVxuICAgICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFuaW1hdGlvbkZhY3RvcnkgRmFjdG9yeSBmdW5jdGlvbiBmb3IgY3JlYXRpbmcgbmV3IGluc3RhbmNlIG9mIGFuXG4gICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24uXG4gICAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiAqKk5PVEUqKjogYW5pbWF0aW9ucyB0YWtlIGVmZmVjdCBvbmx5IGlmIHRoZSAqKm5nQW5pbWF0ZSoqIG1vZHVsZSBpcyBsb2FkZWQuXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIERlZmluZXMgYW4gYW5pbWF0aW9uIGhvb2sgdGhhdCBjYW4gYmUgbGF0ZXIgdXNlZCB3aXRoXG4gICAgICAgICAgICoge0BsaW5rICRhbmltYXRlICRhbmltYXRlfSBzZXJ2aWNlIGFuZCBkaXJlY3RpdmVzIHRoYXQgdXNlIHRoaXMgc2VydmljZS5cbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIGBgYGpzXG4gICAgICAgICAgICogbW9kdWxlLmFuaW1hdGlvbignLmFuaW1hdGlvbi1uYW1lJywgZnVuY3Rpb24oJGluamVjdDEsICRpbmplY3QyKSB7XG4gICAgICAgICAgICogICByZXR1cm4ge1xuICAgICAgICAgICAqICAgICBldmVudE5hbWUgOiBmdW5jdGlvbihlbGVtZW50LCBkb25lKSB7XG4gICAgICAgICAgICogICAgICAgLy9jb2RlIHRvIHJ1biB0aGUgYW5pbWF0aW9uXG4gICAgICAgICAgICogICAgICAgLy9vbmNlIGNvbXBsZXRlLCB0aGVuIHJ1biBkb25lKClcbiAgICAgICAgICAgKiAgICAgICByZXR1cm4gZnVuY3Rpb24gY2FuY2VsbGF0aW9uRnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICAgICAqICAgICAgICAgLy9jb2RlIHRvIGNhbmNlbCB0aGUgYW5pbWF0aW9uXG4gICAgICAgICAgICogICAgICAgfVxuICAgICAgICAgICAqICAgICB9XG4gICAgICAgICAgICogICB9XG4gICAgICAgICAgICogfSlcbiAgICAgICAgICAgKiBgYGBcbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIFNlZSB7QGxpbmsgbmcuJGFuaW1hdGVQcm92aWRlciNyZWdpc3RlciAkYW5pbWF0ZVByb3ZpZGVyLnJlZ2lzdGVyKCl9IGFuZFxuICAgICAgICAgICAqIHtAbGluayBuZ0FuaW1hdGUgbmdBbmltYXRlIG1vZHVsZX0gZm9yIG1vcmUgaW5mb3JtYXRpb24uXG4gICAgICAgICAgICovXG4gICAgICAgICAgYW5pbWF0aW9uOiBpbnZva2VMYXRlckFuZFNldE1vZHVsZU5hbWUoJyRhbmltYXRlUHJvdmlkZXInLCAncmVnaXN0ZXInKSxcblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICAgKiBAbmFtZSBhbmd1bGFyLk1vZHVsZSNmaWx0ZXJcbiAgICAgICAgICAgKiBAbW9kdWxlIG5nXG4gICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgRmlsdGVyIG5hbWUgLSB0aGlzIG11c3QgYmUgYSB2YWxpZCBhbmd1bGFyIGV4cHJlc3Npb24gaWRlbnRpZmllclxuICAgICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZpbHRlckZhY3RvcnkgRmFjdG9yeSBmdW5jdGlvbiBmb3IgY3JlYXRpbmcgbmV3IGluc3RhbmNlIG9mIGZpbHRlci5cbiAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICAgKiBTZWUge0BsaW5rIG5nLiRmaWx0ZXJQcm92aWRlciNyZWdpc3RlciAkZmlsdGVyUHJvdmlkZXIucmVnaXN0ZXIoKX0uXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuICAgICAgICAgICAqICoqTm90ZToqKiBGaWx0ZXIgbmFtZXMgbXVzdCBiZSB2YWxpZCBhbmd1bGFyIHtAbGluayBleHByZXNzaW9ufSBpZGVudGlmaWVycywgc3VjaCBhcyBgdXBwZXJjYXNlYCBvciBgb3JkZXJCeWAuXG4gICAgICAgICAgICogTmFtZXMgd2l0aCBzcGVjaWFsIGNoYXJhY3RlcnMsIHN1Y2ggYXMgaHlwaGVucyBhbmQgZG90cywgYXJlIG5vdCBhbGxvd2VkLiBJZiB5b3Ugd2lzaCB0byBuYW1lc3BhY2VcbiAgICAgICAgICAgKiB5b3VyIGZpbHRlcnMsIHRoZW4geW91IGNhbiB1c2UgY2FwaXRhbGl6YXRpb24gKGBteWFwcFN1YnNlY3Rpb25GaWx0ZXJ4YCkgb3IgdW5kZXJzY29yZXNcbiAgICAgICAgICAgKiAoYG15YXBwX3N1YnNlY3Rpb25fZmlsdGVyeGApLlxuICAgICAgICAgICAqIDwvZGl2PlxuICAgICAgICAgICAqL1xuICAgICAgICAgIGZpbHRlcjogaW52b2tlTGF0ZXJBbmRTZXRNb2R1bGVOYW1lKCckZmlsdGVyUHJvdmlkZXInLCAncmVnaXN0ZXInKSxcblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICAgKiBAbmFtZSBhbmd1bGFyLk1vZHVsZSNjb250cm9sbGVyXG4gICAgICAgICAgICogQG1vZHVsZSBuZ1xuICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfE9iamVjdH0gbmFtZSBDb250cm9sbGVyIG5hbWUsIG9yIGFuIG9iamVjdCBtYXAgb2YgY29udHJvbGxlcnMgd2hlcmUgdGhlXG4gICAgICAgICAgICogICAga2V5cyBhcmUgdGhlIG5hbWVzIGFuZCB0aGUgdmFsdWVzIGFyZSB0aGUgY29uc3RydWN0b3JzLlxuICAgICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNvbnN0cnVjdG9yIENvbnRyb2xsZXIgY29uc3RydWN0b3IgZnVuY3Rpb24uXG4gICAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAgICogU2VlIHtAbGluayBuZy4kY29udHJvbGxlclByb3ZpZGVyI3JlZ2lzdGVyICRjb250cm9sbGVyUHJvdmlkZXIucmVnaXN0ZXIoKX0uXG4gICAgICAgICAgICovXG4gICAgICAgICAgY29udHJvbGxlcjogaW52b2tlTGF0ZXJBbmRTZXRNb2R1bGVOYW1lKCckY29udHJvbGxlclByb3ZpZGVyJywgJ3JlZ2lzdGVyJyksXG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjZGlyZWN0aXZlXG4gICAgICAgICAgICogQG1vZHVsZSBuZ1xuICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfE9iamVjdH0gbmFtZSBEaXJlY3RpdmUgbmFtZSwgb3IgYW4gb2JqZWN0IG1hcCBvZiBkaXJlY3RpdmVzIHdoZXJlIHRoZVxuICAgICAgICAgICAqICAgIGtleXMgYXJlIHRoZSBuYW1lcyBhbmQgdGhlIHZhbHVlcyBhcmUgdGhlIGZhY3Rvcmllcy5cbiAgICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBkaXJlY3RpdmVGYWN0b3J5IEZhY3RvcnkgZnVuY3Rpb24gZm9yIGNyZWF0aW5nIG5ldyBpbnN0YW5jZSBvZlxuICAgICAgICAgICAqIGRpcmVjdGl2ZXMuXG4gICAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAgICogU2VlIHtAbGluayBuZy4kY29tcGlsZVByb3ZpZGVyI2RpcmVjdGl2ZSAkY29tcGlsZVByb3ZpZGVyLmRpcmVjdGl2ZSgpfS5cbiAgICAgICAgICAgKi9cbiAgICAgICAgICBkaXJlY3RpdmU6IGludm9rZUxhdGVyQW5kU2V0TW9kdWxlTmFtZSgnJGNvbXBpbGVQcm92aWRlcicsICdkaXJlY3RpdmUnKSxcblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICAgKiBAbmFtZSBhbmd1bGFyLk1vZHVsZSNjb21wb25lbnRcbiAgICAgICAgICAgKiBAbW9kdWxlIG5nXG4gICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgTmFtZSBvZiB0aGUgY29tcG9uZW50IGluIGNhbWVsLWNhc2UgKGkuZS4gbXlDb21wIHdoaWNoIHdpbGwgbWF0Y2ggYXMgbXktY29tcClcbiAgICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBDb21wb25lbnQgZGVmaW5pdGlvbiBvYmplY3QgKGEgc2ltcGxpZmllZFxuICAgICAgICAgICAqICAgIHtAbGluayBuZy4kY29tcGlsZSNkaXJlY3RpdmUtZGVmaW5pdGlvbi1vYmplY3QgZGlyZWN0aXZlIGRlZmluaXRpb24gb2JqZWN0fSlcbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgICAqIFNlZSB7QGxpbmsgbmcuJGNvbXBpbGVQcm92aWRlciNjb21wb25lbnQgJGNvbXBpbGVQcm92aWRlci5jb21wb25lbnQoKX0uXG4gICAgICAgICAgICovXG4gICAgICAgICAgY29tcG9uZW50OiBpbnZva2VMYXRlckFuZFNldE1vZHVsZU5hbWUoJyRjb21waWxlUHJvdmlkZXInLCAnY29tcG9uZW50JyksXG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAgICogQG5hbWUgYW5ndWxhci5Nb2R1bGUjY29uZmlnXG4gICAgICAgICAgICogQG1vZHVsZSBuZ1xuICAgICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNvbmZpZ0ZuIEV4ZWN1dGUgdGhpcyBmdW5jdGlvbiBvbiBtb2R1bGUgbG9hZC4gVXNlZnVsIGZvciBzZXJ2aWNlXG4gICAgICAgICAgICogICAgY29uZmlndXJhdGlvbi5cbiAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICAgKiBVc2UgdGhpcyBtZXRob2QgdG8gcmVnaXN0ZXIgd29yayB3aGljaCBuZWVkcyB0byBiZSBwZXJmb3JtZWQgb24gbW9kdWxlIGxvYWRpbmcuXG4gICAgICAgICAgICogRm9yIG1vcmUgYWJvdXQgaG93IHRvIGNvbmZpZ3VyZSBzZXJ2aWNlcywgc2VlXG4gICAgICAgICAgICoge0BsaW5rIHByb3ZpZGVycyNwcm92aWRlci1yZWNpcGUgUHJvdmlkZXIgUmVjaXBlfS5cbiAgICAgICAgICAgKi9cbiAgICAgICAgICBjb25maWc6IGNvbmZpZyxcblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICAgKiBAbmFtZSBhbmd1bGFyLk1vZHVsZSNydW5cbiAgICAgICAgICAgKiBAbW9kdWxlIG5nXG4gICAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaW5pdGlhbGl6YXRpb25GbiBFeGVjdXRlIHRoaXMgZnVuY3Rpb24gYWZ0ZXIgaW5qZWN0b3IgY3JlYXRpb24uXG4gICAgICAgICAgICogICAgVXNlZnVsIGZvciBhcHBsaWNhdGlvbiBpbml0aWFsaXphdGlvbi5cbiAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICAgKiBVc2UgdGhpcyBtZXRob2QgdG8gcmVnaXN0ZXIgd29yayB3aGljaCBzaG91bGQgYmUgcGVyZm9ybWVkIHdoZW4gdGhlIGluamVjdG9yIGlzIGRvbmVcbiAgICAgICAgICAgKiBsb2FkaW5nIGFsbCBtb2R1bGVzLlxuICAgICAgICAgICAqL1xuICAgICAgICAgIHJ1bjogZnVuY3Rpb24oYmxvY2spIHtcbiAgICAgICAgICAgIHJ1bkJsb2Nrcy5wdXNoKGJsb2NrKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoY29uZmlnRm4pIHtcbiAgICAgICAgICBjb25maWcoY29uZmlnRm4pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1vZHVsZUluc3RhbmNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvdmlkZXJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG1ldGhvZFxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZz19IGluc2VydE1ldGhvZFxuICAgICAgICAgKiBAcmV0dXJucyB7YW5ndWxhci5Nb2R1bGV9XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBpbnZva2VMYXRlcihwcm92aWRlciwgbWV0aG9kLCBpbnNlcnRNZXRob2QsIHF1ZXVlKSB7XG4gICAgICAgICAgaWYgKCFxdWV1ZSkgcXVldWUgPSBpbnZva2VRdWV1ZTtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBxdWV1ZVtpbnNlcnRNZXRob2QgfHwgJ3B1c2gnXShbcHJvdmlkZXIsIG1ldGhvZCwgYXJndW1lbnRzXSk7XG4gICAgICAgICAgICByZXR1cm4gbW9kdWxlSW5zdGFuY2U7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvdmlkZXJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG1ldGhvZFxuICAgICAgICAgKiBAcmV0dXJucyB7YW5ndWxhci5Nb2R1bGV9XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBpbnZva2VMYXRlckFuZFNldE1vZHVsZU5hbWUocHJvdmlkZXIsIG1ldGhvZCkge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbihyZWNpcGVOYW1lLCBmYWN0b3J5RnVuY3Rpb24pIHtcbiAgICAgICAgICAgIGlmIChmYWN0b3J5RnVuY3Rpb24gJiYgaXNGdW5jdGlvbihmYWN0b3J5RnVuY3Rpb24pKSBmYWN0b3J5RnVuY3Rpb24uJCRtb2R1bGVOYW1lID0gbmFtZTtcbiAgICAgICAgICAgIGludm9rZVF1ZXVlLnB1c2goW3Byb3ZpZGVyLCBtZXRob2QsIGFyZ3VtZW50c10pO1xuICAgICAgICAgICAgcmV0dXJuIG1vZHVsZUluc3RhbmNlO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG59XG5cbi8qIGdsb2JhbDogdG9EZWJ1Z1N0cmluZzogdHJ1ZSAqL1xuXG5mdW5jdGlvbiBzZXJpYWxpemVPYmplY3Qob2JqKSB7XG4gIHZhciBzZWVuID0gW107XG5cbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iaiwgZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICB2YWwgPSB0b0pzb25SZXBsYWNlcihrZXksIHZhbCk7XG4gICAgaWYgKGlzT2JqZWN0KHZhbCkpIHtcblxuICAgICAgaWYgKHNlZW4uaW5kZXhPZih2YWwpID49IDApIHJldHVybiAnLi4uJztcblxuICAgICAgc2Vlbi5wdXNoKHZhbCk7XG4gICAgfVxuICAgIHJldHVybiB2YWw7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB0b0RlYnVnU3RyaW5nKG9iaikge1xuICBpZiAodHlwZW9mIG9iaiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBvYmoudG9TdHJpbmcoKS5yZXBsYWNlKC8gXFx7W1xcc1xcU10qJC8sICcnKTtcbiAgfSBlbHNlIGlmIChpc1VuZGVmaW5lZChvYmopKSB7XG4gICAgcmV0dXJuICd1bmRlZmluZWQnO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogIT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZU9iamVjdChvYmopO1xuICB9XG4gIHJldHVybiBvYmo7XG59XG5cbi8qIGdsb2JhbCBhbmd1bGFyTW9kdWxlOiB0cnVlLFxuICB2ZXJzaW9uOiB0cnVlLFxuXG4gICRDb21waWxlUHJvdmlkZXIsXG5cbiAgaHRtbEFuY2hvckRpcmVjdGl2ZSxcbiAgaW5wdXREaXJlY3RpdmUsXG4gIGlucHV0RGlyZWN0aXZlLFxuICBmb3JtRGlyZWN0aXZlLFxuICBzY3JpcHREaXJlY3RpdmUsXG4gIHNlbGVjdERpcmVjdGl2ZSxcbiAgc3R5bGVEaXJlY3RpdmUsXG4gIG9wdGlvbkRpcmVjdGl2ZSxcbiAgbmdCaW5kRGlyZWN0aXZlLFxuICBuZ0JpbmRIdG1sRGlyZWN0aXZlLFxuICBuZ0JpbmRUZW1wbGF0ZURpcmVjdGl2ZSxcbiAgbmdDbGFzc0RpcmVjdGl2ZSxcbiAgbmdDbGFzc0V2ZW5EaXJlY3RpdmUsXG4gIG5nQ2xhc3NPZGREaXJlY3RpdmUsXG4gIG5nQ2xvYWtEaXJlY3RpdmUsXG4gIG5nQ29udHJvbGxlckRpcmVjdGl2ZSxcbiAgbmdGb3JtRGlyZWN0aXZlLFxuICBuZ0hpZGVEaXJlY3RpdmUsXG4gIG5nSWZEaXJlY3RpdmUsXG4gIG5nSW5jbHVkZURpcmVjdGl2ZSxcbiAgbmdJbmNsdWRlRmlsbENvbnRlbnREaXJlY3RpdmUsXG4gIG5nSW5pdERpcmVjdGl2ZSxcbiAgbmdOb25CaW5kYWJsZURpcmVjdGl2ZSxcbiAgbmdQbHVyYWxpemVEaXJlY3RpdmUsXG4gIG5nUmVwZWF0RGlyZWN0aXZlLFxuICBuZ1Nob3dEaXJlY3RpdmUsXG4gIG5nU3R5bGVEaXJlY3RpdmUsXG4gIG5nU3dpdGNoRGlyZWN0aXZlLFxuICBuZ1N3aXRjaFdoZW5EaXJlY3RpdmUsXG4gIG5nU3dpdGNoRGVmYXVsdERpcmVjdGl2ZSxcbiAgbmdPcHRpb25zRGlyZWN0aXZlLFxuICBuZ1RyYW5zY2x1ZGVEaXJlY3RpdmUsXG4gIG5nTW9kZWxEaXJlY3RpdmUsXG4gIG5nTGlzdERpcmVjdGl2ZSxcbiAgbmdDaGFuZ2VEaXJlY3RpdmUsXG4gIHBhdHRlcm5EaXJlY3RpdmUsXG4gIHBhdHRlcm5EaXJlY3RpdmUsXG4gIHJlcXVpcmVkRGlyZWN0aXZlLFxuICByZXF1aXJlZERpcmVjdGl2ZSxcbiAgbWlubGVuZ3RoRGlyZWN0aXZlLFxuICBtaW5sZW5ndGhEaXJlY3RpdmUsXG4gIG1heGxlbmd0aERpcmVjdGl2ZSxcbiAgbWF4bGVuZ3RoRGlyZWN0aXZlLFxuICBuZ1ZhbHVlRGlyZWN0aXZlLFxuICBuZ01vZGVsT3B0aW9uc0RpcmVjdGl2ZSxcbiAgbmdBdHRyaWJ1dGVBbGlhc0RpcmVjdGl2ZXMsXG4gIG5nRXZlbnREaXJlY3RpdmVzLFxuXG4gICRBbmNob3JTY3JvbGxQcm92aWRlcixcbiAgJEFuaW1hdGVQcm92aWRlcixcbiAgJENvcmVBbmltYXRlQ3NzUHJvdmlkZXIsXG4gICQkQ29yZUFuaW1hdGVKc1Byb3ZpZGVyLFxuICAkJENvcmVBbmltYXRlUXVldWVQcm92aWRlcixcbiAgJCRBbmltYXRlUnVubmVyRmFjdG9yeVByb3ZpZGVyLFxuICAkJEFuaW1hdGVBc3luY1J1bkZhY3RvcnlQcm92aWRlcixcbiAgJEJyb3dzZXJQcm92aWRlcixcbiAgJENhY2hlRmFjdG9yeVByb3ZpZGVyLFxuICAkQ29udHJvbGxlclByb3ZpZGVyLFxuICAkRGF0ZVByb3ZpZGVyLFxuICAkRG9jdW1lbnRQcm92aWRlcixcbiAgJEV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcixcbiAgJEZpbHRlclByb3ZpZGVyLFxuICAkJEZvcmNlUmVmbG93UHJvdmlkZXIsXG4gICRJbnRlcnBvbGF0ZVByb3ZpZGVyLFxuICAkSW50ZXJ2YWxQcm92aWRlcixcbiAgJCRIYXNoTWFwUHJvdmlkZXIsXG4gICRIdHRwUHJvdmlkZXIsXG4gICRIdHRwUGFyYW1TZXJpYWxpemVyUHJvdmlkZXIsXG4gICRIdHRwUGFyYW1TZXJpYWxpemVySlFMaWtlUHJvdmlkZXIsXG4gICRIdHRwQmFja2VuZFByb3ZpZGVyLFxuICAkeGhyRmFjdG9yeVByb3ZpZGVyLFxuICAkTG9jYXRpb25Qcm92aWRlcixcbiAgJExvZ1Byb3ZpZGVyLFxuICAkUGFyc2VQcm92aWRlcixcbiAgJFJvb3RTY29wZVByb3ZpZGVyLFxuICAkUVByb3ZpZGVyLFxuICAkJFFQcm92aWRlcixcbiAgJCRTYW5pdGl6ZVVyaVByb3ZpZGVyLFxuICAkU2NlUHJvdmlkZXIsXG4gICRTY2VEZWxlZ2F0ZVByb3ZpZGVyLFxuICAkU25pZmZlclByb3ZpZGVyLFxuICAkVGVtcGxhdGVDYWNoZVByb3ZpZGVyLFxuICAkVGVtcGxhdGVSZXF1ZXN0UHJvdmlkZXIsXG4gICQkVGVzdGFiaWxpdHlQcm92aWRlcixcbiAgJFRpbWVvdXRQcm92aWRlcixcbiAgJCRSQUZQcm92aWRlcixcbiAgJFdpbmRvd1Byb3ZpZGVyLFxuICAkJGpxTGl0ZVByb3ZpZGVyLFxuICAkJENvb2tpZVJlYWRlclByb3ZpZGVyXG4qL1xuXG5cbi8qKlxuICogQG5nZG9jIG9iamVjdFxuICogQG5hbWUgYW5ndWxhci52ZXJzaW9uXG4gKiBAbW9kdWxlIG5nXG4gKiBAZGVzY3JpcHRpb25cbiAqIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIGluZm9ybWF0aW9uIGFib3V0IHRoZSBjdXJyZW50IEFuZ3VsYXJKUyB2ZXJzaW9uLlxuICpcbiAqIFRoaXMgb2JqZWN0IGhhcyB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gKlxuICogLSBgZnVsbGAg4oCTIGB7c3RyaW5nfWAg4oCTIEZ1bGwgdmVyc2lvbiBzdHJpbmcsIHN1Y2ggYXMgXCIwLjkuMThcIi5cbiAqIC0gYG1ham9yYCDigJMgYHtudW1iZXJ9YCDigJMgTWFqb3IgdmVyc2lvbiBudW1iZXIsIHN1Y2ggYXMgXCIwXCIuXG4gKiAtIGBtaW5vcmAg4oCTIGB7bnVtYmVyfWAg4oCTIE1pbm9yIHZlcnNpb24gbnVtYmVyLCBzdWNoIGFzIFwiOVwiLlxuICogLSBgZG90YCDigJMgYHtudW1iZXJ9YCDigJMgRG90IHZlcnNpb24gbnVtYmVyLCBzdWNoIGFzIFwiMThcIi5cbiAqIC0gYGNvZGVOYW1lYCDigJMgYHtzdHJpbmd9YCDigJMgQ29kZSBuYW1lIG9mIHRoZSByZWxlYXNlLCBzdWNoIGFzIFwiamlnZ2xpbmctYXJtZmF0XCIuXG4gKi9cbnZhciB2ZXJzaW9uID0ge1xuICBmdWxsOiAnMS41LjAnLCAgICAvLyBhbGwgb2YgdGhlc2UgcGxhY2Vob2xkZXIgc3RyaW5ncyB3aWxsIGJlIHJlcGxhY2VkIGJ5IGdydW50J3NcbiAgbWFqb3I6IDEsICAgIC8vIHBhY2thZ2UgdGFza1xuICBtaW5vcjogNSxcbiAgZG90OiAwLFxuICBjb2RlTmFtZTogJ2Vubm9ibGVtZW50LWZhY2lsaXRhdGlvbidcbn07XG5cblxuZnVuY3Rpb24gcHVibGlzaEV4dGVybmFsQVBJKGFuZ3VsYXIpIHtcbiAgZXh0ZW5kKGFuZ3VsYXIsIHtcbiAgICAnYm9vdHN0cmFwJzogYm9vdHN0cmFwLFxuICAgICdjb3B5JzogY29weSxcbiAgICAnZXh0ZW5kJzogZXh0ZW5kLFxuICAgICdtZXJnZSc6IG1lcmdlLFxuICAgICdlcXVhbHMnOiBlcXVhbHMsXG4gICAgJ2VsZW1lbnQnOiBqcUxpdGUsXG4gICAgJ2ZvckVhY2gnOiBmb3JFYWNoLFxuICAgICdpbmplY3Rvcic6IGNyZWF0ZUluamVjdG9yLFxuICAgICdub29wJzogbm9vcCxcbiAgICAnYmluZCc6IGJpbmQsXG4gICAgJ3RvSnNvbic6IHRvSnNvbixcbiAgICAnZnJvbUpzb24nOiBmcm9tSnNvbixcbiAgICAnaWRlbnRpdHknOiBpZGVudGl0eSxcbiAgICAnaXNVbmRlZmluZWQnOiBpc1VuZGVmaW5lZCxcbiAgICAnaXNEZWZpbmVkJzogaXNEZWZpbmVkLFxuICAgICdpc1N0cmluZyc6IGlzU3RyaW5nLFxuICAgICdpc0Z1bmN0aW9uJzogaXNGdW5jdGlvbixcbiAgICAnaXNPYmplY3QnOiBpc09iamVjdCxcbiAgICAnaXNOdW1iZXInOiBpc051bWJlcixcbiAgICAnaXNFbGVtZW50JzogaXNFbGVtZW50LFxuICAgICdpc0FycmF5JzogaXNBcnJheSxcbiAgICAndmVyc2lvbic6IHZlcnNpb24sXG4gICAgJ2lzRGF0ZSc6IGlzRGF0ZSxcbiAgICAnbG93ZXJjYXNlJzogbG93ZXJjYXNlLFxuICAgICd1cHBlcmNhc2UnOiB1cHBlcmNhc2UsXG4gICAgJ2NhbGxiYWNrcyc6IHtjb3VudGVyOiAwfSxcbiAgICAnZ2V0VGVzdGFiaWxpdHknOiBnZXRUZXN0YWJpbGl0eSxcbiAgICAnJCRtaW5FcnInOiBtaW5FcnIsXG4gICAgJyQkY3NwJzogY3NwLFxuICAgICdyZWxvYWRXaXRoRGVidWdJbmZvJzogcmVsb2FkV2l0aERlYnVnSW5mb1xuICB9KTtcblxuICBhbmd1bGFyTW9kdWxlID0gc2V0dXBNb2R1bGVMb2FkZXIod2luZG93KTtcblxuICBhbmd1bGFyTW9kdWxlKCduZycsIFsnbmdMb2NhbGUnXSwgWyckcHJvdmlkZScsXG4gICAgZnVuY3Rpb24gbmdNb2R1bGUoJHByb3ZpZGUpIHtcbiAgICAgIC8vICQkc2FuaXRpemVVcmlQcm92aWRlciBuZWVkcyB0byBiZSBiZWZvcmUgJGNvbXBpbGVQcm92aWRlciBhcyBpdCBpcyB1c2VkIGJ5IGl0LlxuICAgICAgJHByb3ZpZGUucHJvdmlkZXIoe1xuICAgICAgICAkJHNhbml0aXplVXJpOiAkJFNhbml0aXplVXJpUHJvdmlkZXJcbiAgICAgIH0pO1xuICAgICAgJHByb3ZpZGUucHJvdmlkZXIoJyRjb21waWxlJywgJENvbXBpbGVQcm92aWRlcikuXG4gICAgICAgIGRpcmVjdGl2ZSh7XG4gICAgICAgICAgICBhOiBodG1sQW5jaG9yRGlyZWN0aXZlLFxuICAgICAgICAgICAgaW5wdXQ6IGlucHV0RGlyZWN0aXZlLFxuICAgICAgICAgICAgdGV4dGFyZWE6IGlucHV0RGlyZWN0aXZlLFxuICAgICAgICAgICAgZm9ybTogZm9ybURpcmVjdGl2ZSxcbiAgICAgICAgICAgIHNjcmlwdDogc2NyaXB0RGlyZWN0aXZlLFxuICAgICAgICAgICAgc2VsZWN0OiBzZWxlY3REaXJlY3RpdmUsXG4gICAgICAgICAgICBzdHlsZTogc3R5bGVEaXJlY3RpdmUsXG4gICAgICAgICAgICBvcHRpb246IG9wdGlvbkRpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nQmluZDogbmdCaW5kRGlyZWN0aXZlLFxuICAgICAgICAgICAgbmdCaW5kSHRtbDogbmdCaW5kSHRtbERpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nQmluZFRlbXBsYXRlOiBuZ0JpbmRUZW1wbGF0ZURpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nQ2xhc3M6IG5nQ2xhc3NEaXJlY3RpdmUsXG4gICAgICAgICAgICBuZ0NsYXNzRXZlbjogbmdDbGFzc0V2ZW5EaXJlY3RpdmUsXG4gICAgICAgICAgICBuZ0NsYXNzT2RkOiBuZ0NsYXNzT2RkRGlyZWN0aXZlLFxuICAgICAgICAgICAgbmdDbG9hazogbmdDbG9ha0RpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nQ29udHJvbGxlcjogbmdDb250cm9sbGVyRGlyZWN0aXZlLFxuICAgICAgICAgICAgbmdGb3JtOiBuZ0Zvcm1EaXJlY3RpdmUsXG4gICAgICAgICAgICBuZ0hpZGU6IG5nSGlkZURpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nSWY6IG5nSWZEaXJlY3RpdmUsXG4gICAgICAgICAgICBuZ0luY2x1ZGU6IG5nSW5jbHVkZURpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nSW5pdDogbmdJbml0RGlyZWN0aXZlLFxuICAgICAgICAgICAgbmdOb25CaW5kYWJsZTogbmdOb25CaW5kYWJsZURpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nUGx1cmFsaXplOiBuZ1BsdXJhbGl6ZURpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nUmVwZWF0OiBuZ1JlcGVhdERpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nU2hvdzogbmdTaG93RGlyZWN0aXZlLFxuICAgICAgICAgICAgbmdTdHlsZTogbmdTdHlsZURpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nU3dpdGNoOiBuZ1N3aXRjaERpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nU3dpdGNoV2hlbjogbmdTd2l0Y2hXaGVuRGlyZWN0aXZlLFxuICAgICAgICAgICAgbmdTd2l0Y2hEZWZhdWx0OiBuZ1N3aXRjaERlZmF1bHREaXJlY3RpdmUsXG4gICAgICAgICAgICBuZ09wdGlvbnM6IG5nT3B0aW9uc0RpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nVHJhbnNjbHVkZTogbmdUcmFuc2NsdWRlRGlyZWN0aXZlLFxuICAgICAgICAgICAgbmdNb2RlbDogbmdNb2RlbERpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nTGlzdDogbmdMaXN0RGlyZWN0aXZlLFxuICAgICAgICAgICAgbmdDaGFuZ2U6IG5nQ2hhbmdlRGlyZWN0aXZlLFxuICAgICAgICAgICAgcGF0dGVybjogcGF0dGVybkRpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nUGF0dGVybjogcGF0dGVybkRpcmVjdGl2ZSxcbiAgICAgICAgICAgIHJlcXVpcmVkOiByZXF1aXJlZERpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nUmVxdWlyZWQ6IHJlcXVpcmVkRGlyZWN0aXZlLFxuICAgICAgICAgICAgbWlubGVuZ3RoOiBtaW5sZW5ndGhEaXJlY3RpdmUsXG4gICAgICAgICAgICBuZ01pbmxlbmd0aDogbWlubGVuZ3RoRGlyZWN0aXZlLFxuICAgICAgICAgICAgbWF4bGVuZ3RoOiBtYXhsZW5ndGhEaXJlY3RpdmUsXG4gICAgICAgICAgICBuZ01heGxlbmd0aDogbWF4bGVuZ3RoRGlyZWN0aXZlLFxuICAgICAgICAgICAgbmdWYWx1ZTogbmdWYWx1ZURpcmVjdGl2ZSxcbiAgICAgICAgICAgIG5nTW9kZWxPcHRpb25zOiBuZ01vZGVsT3B0aW9uc0RpcmVjdGl2ZVxuICAgICAgICB9KS5cbiAgICAgICAgZGlyZWN0aXZlKHtcbiAgICAgICAgICBuZ0luY2x1ZGU6IG5nSW5jbHVkZUZpbGxDb250ZW50RGlyZWN0aXZlXG4gICAgICAgIH0pLlxuICAgICAgICBkaXJlY3RpdmUobmdBdHRyaWJ1dGVBbGlhc0RpcmVjdGl2ZXMpLlxuICAgICAgICBkaXJlY3RpdmUobmdFdmVudERpcmVjdGl2ZXMpO1xuICAgICAgJHByb3ZpZGUucHJvdmlkZXIoe1xuICAgICAgICAkYW5jaG9yU2Nyb2xsOiAkQW5jaG9yU2Nyb2xsUHJvdmlkZXIsXG4gICAgICAgICRhbmltYXRlOiAkQW5pbWF0ZVByb3ZpZGVyLFxuICAgICAgICAkYW5pbWF0ZUNzczogJENvcmVBbmltYXRlQ3NzUHJvdmlkZXIsXG4gICAgICAgICQkYW5pbWF0ZUpzOiAkJENvcmVBbmltYXRlSnNQcm92aWRlcixcbiAgICAgICAgJCRhbmltYXRlUXVldWU6ICQkQ29yZUFuaW1hdGVRdWV1ZVByb3ZpZGVyLFxuICAgICAgICAkJEFuaW1hdGVSdW5uZXI6ICQkQW5pbWF0ZVJ1bm5lckZhY3RvcnlQcm92aWRlcixcbiAgICAgICAgJCRhbmltYXRlQXN5bmNSdW46ICQkQW5pbWF0ZUFzeW5jUnVuRmFjdG9yeVByb3ZpZGVyLFxuICAgICAgICAkYnJvd3NlcjogJEJyb3dzZXJQcm92aWRlcixcbiAgICAgICAgJGNhY2hlRmFjdG9yeTogJENhY2hlRmFjdG9yeVByb3ZpZGVyLFxuICAgICAgICAkY29udHJvbGxlcjogJENvbnRyb2xsZXJQcm92aWRlcixcbiAgICAgICAgJGRvY3VtZW50OiAkRG9jdW1lbnRQcm92aWRlcixcbiAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXI6ICRFeGNlcHRpb25IYW5kbGVyUHJvdmlkZXIsXG4gICAgICAgICRmaWx0ZXI6ICRGaWx0ZXJQcm92aWRlcixcbiAgICAgICAgJCRmb3JjZVJlZmxvdzogJCRGb3JjZVJlZmxvd1Byb3ZpZGVyLFxuICAgICAgICAkaW50ZXJwb2xhdGU6ICRJbnRlcnBvbGF0ZVByb3ZpZGVyLFxuICAgICAgICAkaW50ZXJ2YWw6ICRJbnRlcnZhbFByb3ZpZGVyLFxuICAgICAgICAkaHR0cDogJEh0dHBQcm92aWRlcixcbiAgICAgICAgJGh0dHBQYXJhbVNlcmlhbGl6ZXI6ICRIdHRwUGFyYW1TZXJpYWxpemVyUHJvdmlkZXIsXG4gICAgICAgICRodHRwUGFyYW1TZXJpYWxpemVySlFMaWtlOiAkSHR0cFBhcmFtU2VyaWFsaXplckpRTGlrZVByb3ZpZGVyLFxuICAgICAgICAkaHR0cEJhY2tlbmQ6ICRIdHRwQmFja2VuZFByb3ZpZGVyLFxuICAgICAgICAkeGhyRmFjdG9yeTogJHhockZhY3RvcnlQcm92aWRlcixcbiAgICAgICAgJGxvY2F0aW9uOiAkTG9jYXRpb25Qcm92aWRlcixcbiAgICAgICAgJGxvZzogJExvZ1Byb3ZpZGVyLFxuICAgICAgICAkcGFyc2U6ICRQYXJzZVByb3ZpZGVyLFxuICAgICAgICAkcm9vdFNjb3BlOiAkUm9vdFNjb3BlUHJvdmlkZXIsXG4gICAgICAgICRxOiAkUVByb3ZpZGVyLFxuICAgICAgICAkJHE6ICQkUVByb3ZpZGVyLFxuICAgICAgICAkc2NlOiAkU2NlUHJvdmlkZXIsXG4gICAgICAgICRzY2VEZWxlZ2F0ZTogJFNjZURlbGVnYXRlUHJvdmlkZXIsXG4gICAgICAgICRzbmlmZmVyOiAkU25pZmZlclByb3ZpZGVyLFxuICAgICAgICAkdGVtcGxhdGVDYWNoZTogJFRlbXBsYXRlQ2FjaGVQcm92aWRlcixcbiAgICAgICAgJHRlbXBsYXRlUmVxdWVzdDogJFRlbXBsYXRlUmVxdWVzdFByb3ZpZGVyLFxuICAgICAgICAkJHRlc3RhYmlsaXR5OiAkJFRlc3RhYmlsaXR5UHJvdmlkZXIsXG4gICAgICAgICR0aW1lb3V0OiAkVGltZW91dFByb3ZpZGVyLFxuICAgICAgICAkd2luZG93OiAkV2luZG93UHJvdmlkZXIsXG4gICAgICAgICQkckFGOiAkJFJBRlByb3ZpZGVyLFxuICAgICAgICAkJGpxTGl0ZTogJCRqcUxpdGVQcm92aWRlcixcbiAgICAgICAgJCRIYXNoTWFwOiAkJEhhc2hNYXBQcm92aWRlcixcbiAgICAgICAgJCRjb29raWVSZWFkZXI6ICQkQ29va2llUmVhZGVyUHJvdmlkZXJcbiAgICAgIH0pO1xuICAgIH1cbiAgXSk7XG59XG5cbi8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICpcbiAqICAgICBBbnkgY29tbWl0cyB0byB0aGlzIGZpbGUgc2hvdWxkIGJlIHJldmlld2VkIHdpdGggc2VjdXJpdHkgaW4gbWluZC4gICpcbiAqICAgQ2hhbmdlcyB0byB0aGlzIGZpbGUgY2FuIHBvdGVudGlhbGx5IGNyZWF0ZSBzZWN1cml0eSB2dWxuZXJhYmlsaXRpZXMuICpcbiAqICAgICAgICAgIEFuIGFwcHJvdmFsIGZyb20gMiBDb3JlIG1lbWJlcnMgd2l0aCBoaXN0b3J5IG9mIG1vZGlmeWluZyAgICAgICpcbiAqICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMgZmlsZSBpcyByZXF1aXJlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAqICBEb2VzIHRoZSBjaGFuZ2Ugc29tZWhvdyBhbGxvdyBmb3IgYXJiaXRyYXJ5IGphdmFzY3JpcHQgdG8gYmUgZXhlY3V0ZWQ/ICpcbiAqICAgIE9yIGFsbG93cyBmb3Igc29tZW9uZSB0byBjaGFuZ2UgdGhlIHByb3RvdHlwZSBvZiBidWlsdC1pbiBvYmplY3RzPyAgICpcbiAqICAgICBPciBnaXZlcyB1bmRlc2lyZWQgYWNjZXNzIHRvIHZhcmlhYmxlcyBsaWtlcyBkb2N1bWVudCBvciB3aW5kb3c/ICAgICpcbiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovXG5cbi8qIGdsb2JhbCBKUUxpdGVQcm90b3R5cGU6IHRydWUsXG4gIGFkZEV2ZW50TGlzdGVuZXJGbjogdHJ1ZSxcbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lckZuOiB0cnVlLFxuICBCT09MRUFOX0FUVFI6IHRydWUsXG4gIEFMSUFTRURfQVRUUjogdHJ1ZSxcbiovXG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vSlFMaXRlXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbi8qKlxuICogQG5nZG9jIGZ1bmN0aW9uXG4gKiBAbmFtZSBhbmd1bGFyLmVsZW1lbnRcbiAqIEBtb2R1bGUgbmdcbiAqIEBraW5kIGZ1bmN0aW9uXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBXcmFwcyBhIHJhdyBET00gZWxlbWVudCBvciBIVE1MIHN0cmluZyBhcyBhIFtqUXVlcnldKGh0dHA6Ly9qcXVlcnkuY29tKSBlbGVtZW50LlxuICpcbiAqIElmIGpRdWVyeSBpcyBhdmFpbGFibGUsIGBhbmd1bGFyLmVsZW1lbnRgIGlzIGFuIGFsaWFzIGZvciB0aGVcbiAqIFtqUXVlcnldKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9qUXVlcnkvKSBmdW5jdGlvbi4gSWYgalF1ZXJ5IGlzIG5vdCBhdmFpbGFibGUsIGBhbmd1bGFyLmVsZW1lbnRgXG4gKiBkZWxlZ2F0ZXMgdG8gQW5ndWxhcidzIGJ1aWx0LWluIHN1YnNldCBvZiBqUXVlcnksIGNhbGxlZCBcImpRdWVyeSBsaXRlXCIgb3IgKipqcUxpdGUqKi5cbiAqXG4gKiBqcUxpdGUgaXMgYSB0aW55LCBBUEktY29tcGF0aWJsZSBzdWJzZXQgb2YgalF1ZXJ5IHRoYXQgYWxsb3dzXG4gKiBBbmd1bGFyIHRvIG1hbmlwdWxhdGUgdGhlIERPTSBpbiBhIGNyb3NzLWJyb3dzZXIgY29tcGF0aWJsZSB3YXkuIGpxTGl0ZSBpbXBsZW1lbnRzIG9ubHkgdGhlIG1vc3RcbiAqIGNvbW1vbmx5IG5lZWRlZCBmdW5jdGlvbmFsaXR5IHdpdGggdGhlIGdvYWwgb2YgaGF2aW5nIGEgdmVyeSBzbWFsbCBmb290cHJpbnQuXG4gKlxuICogVG8gdXNlIGBqUXVlcnlgLCBzaW1wbHkgZW5zdXJlIGl0IGlzIGxvYWRlZCBiZWZvcmUgdGhlIGBhbmd1bGFyLmpzYCBmaWxlLiBZb3UgY2FuIGFsc28gdXNlIHRoZVxuICoge0BsaW5rIG5nSnEgYG5nSnFgfSBkaXJlY3RpdmUgdG8gc3BlY2lmeSB0aGF0IGpxbGl0ZSBzaG91bGQgYmUgdXNlZCBvdmVyIGpRdWVyeSwgb3IgdG8gdXNlIGFcbiAqIHNwZWNpZmljIHZlcnNpb24gb2YgalF1ZXJ5IGlmIG11bHRpcGxlIHZlcnNpb25zIGV4aXN0IG9uIHRoZSBwYWdlLlxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1pbmZvXCI+KipOb3RlOioqIEFsbCBlbGVtZW50IHJlZmVyZW5jZXMgaW4gQW5ndWxhciBhcmUgYWx3YXlzIHdyYXBwZWQgd2l0aCBqUXVlcnkgb3JcbiAqIGpxTGl0ZSAoc3VjaCBhcyB0aGUgZWxlbWVudCBhcmd1bWVudCBpbiBhIGRpcmVjdGl2ZSdzIGNvbXBpbGUgLyBsaW5rIGZ1bmN0aW9uKS4gVGhleSBhcmUgbmV2ZXIgcmF3IERPTSByZWZlcmVuY2VzLjwvZGl2PlxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+KipOb3RlOioqIEtlZXAgaW4gbWluZCB0aGF0IHRoaXMgZnVuY3Rpb24gd2lsbCBub3QgZmluZCBlbGVtZW50c1xuICogYnkgdGFnIG5hbWUgLyBDU1Mgc2VsZWN0b3IuIEZvciBsb29rdXBzIGJ5IHRhZyBuYW1lLCB0cnkgaW5zdGVhZCBgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5maW5kKC4uLilgXG4gKiBvciBgJGRvY3VtZW50LmZpbmQoKWAsIG9yIHVzZSB0aGUgc3RhbmRhcmQgRE9NIEFQSXMsIGUuZy4gYGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoKWAuPC9kaXY+XG4gKlxuICogIyMgQW5ndWxhcidzIGpxTGl0ZVxuICoganFMaXRlIHByb3ZpZGVzIG9ubHkgdGhlIGZvbGxvd2luZyBqUXVlcnkgbWV0aG9kczpcbiAqXG4gKiAtIFtgYWRkQ2xhc3MoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9hZGRDbGFzcy8pXG4gKiAtIFtgYWZ0ZXIoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9hZnRlci8pXG4gKiAtIFtgYXBwZW5kKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vYXBwZW5kLylcbiAqIC0gW2BhdHRyKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vYXR0ci8pIC0gRG9lcyBub3Qgc3VwcG9ydCBmdW5jdGlvbnMgYXMgcGFyYW1ldGVyc1xuICogLSBbYGJpbmQoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9iaW5kLykgLSBEb2VzIG5vdCBzdXBwb3J0IG5hbWVzcGFjZXMsIHNlbGVjdG9ycyBvciBldmVudERhdGFcbiAqIC0gW2BjaGlsZHJlbigpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL2NoaWxkcmVuLykgLSBEb2VzIG5vdCBzdXBwb3J0IHNlbGVjdG9yc1xuICogLSBbYGNsb25lKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vY2xvbmUvKVxuICogLSBbYGNvbnRlbnRzKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vY29udGVudHMvKVxuICogLSBbYGNzcygpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL2Nzcy8pIC0gT25seSByZXRyaWV2ZXMgaW5saW5lLXN0eWxlcywgZG9lcyBub3QgY2FsbCBgZ2V0Q29tcHV0ZWRTdHlsZSgpYC5cbiAqICAgQXMgYSBzZXR0ZXIsIGRvZXMgbm90IGNvbnZlcnQgbnVtYmVycyB0byBzdHJpbmdzIG9yIGFwcGVuZCAncHgnLCBhbmQgYWxzbyBkb2VzIG5vdCBoYXZlIGF1dG9tYXRpYyBwcm9wZXJ0eSBwcmVmaXhpbmcuXG4gKiAtIFtgZGF0YSgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL2RhdGEvKVxuICogLSBbYGRldGFjaCgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL2RldGFjaC8pXG4gKiAtIFtgZW1wdHkoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9lbXB0eS8pXG4gKiAtIFtgZXEoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9lcS8pXG4gKiAtIFtgZmluZCgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL2ZpbmQvKSAtIExpbWl0ZWQgdG8gbG9va3VwcyBieSB0YWcgbmFtZVxuICogLSBbYGhhc0NsYXNzKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vaGFzQ2xhc3MvKVxuICogLSBbYGh0bWwoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9odG1sLylcbiAqIC0gW2BuZXh0KClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vbmV4dC8pIC0gRG9lcyBub3Qgc3VwcG9ydCBzZWxlY3RvcnNcbiAqIC0gW2BvbigpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL29uLykgLSBEb2VzIG5vdCBzdXBwb3J0IG5hbWVzcGFjZXMsIHNlbGVjdG9ycyBvciBldmVudERhdGFcbiAqIC0gW2BvZmYoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9vZmYvKSAtIERvZXMgbm90IHN1cHBvcnQgbmFtZXNwYWNlcywgc2VsZWN0b3JzIG9yIGV2ZW50IG9iamVjdCBhcyBwYXJhbWV0ZXJcbiAqIC0gW2BvbmUoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9vbmUvKSAtIERvZXMgbm90IHN1cHBvcnQgbmFtZXNwYWNlcyBvciBzZWxlY3RvcnNcbiAqIC0gW2BwYXJlbnQoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9wYXJlbnQvKSAtIERvZXMgbm90IHN1cHBvcnQgc2VsZWN0b3JzXG4gKiAtIFtgcHJlcGVuZCgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL3ByZXBlbmQvKVxuICogLSBbYHByb3AoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9wcm9wLylcbiAqIC0gW2ByZWFkeSgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL3JlYWR5LylcbiAqIC0gW2ByZW1vdmUoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9yZW1vdmUvKVxuICogLSBbYHJlbW92ZUF0dHIoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9yZW1vdmVBdHRyLylcbiAqIC0gW2ByZW1vdmVDbGFzcygpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL3JlbW92ZUNsYXNzLylcbiAqIC0gW2ByZW1vdmVEYXRhKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vcmVtb3ZlRGF0YS8pXG4gKiAtIFtgcmVwbGFjZVdpdGgoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9yZXBsYWNlV2l0aC8pXG4gKiAtIFtgdGV4dCgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL3RleHQvKVxuICogLSBbYHRvZ2dsZUNsYXNzKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vdG9nZ2xlQ2xhc3MvKVxuICogLSBbYHRyaWdnZXJIYW5kbGVyKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vdHJpZ2dlckhhbmRsZXIvKSAtIFBhc3NlcyBhIGR1bW15IGV2ZW50IG9iamVjdCB0byBoYW5kbGVycy5cbiAqIC0gW2B1bmJpbmQoKWBdKGh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS91bmJpbmQvKSAtIERvZXMgbm90IHN1cHBvcnQgbmFtZXNwYWNlcyBvciBldmVudCBvYmplY3QgYXMgcGFyYW1ldGVyXG4gKiAtIFtgdmFsKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vdmFsLylcbiAqIC0gW2B3cmFwKClgXShodHRwOi8vYXBpLmpxdWVyeS5jb20vd3JhcC8pXG4gKlxuICogIyMgalF1ZXJ5L2pxTGl0ZSBFeHRyYXNcbiAqIEFuZ3VsYXIgYWxzbyBwcm92aWRlcyB0aGUgZm9sbG93aW5nIGFkZGl0aW9uYWwgbWV0aG9kcyBhbmQgZXZlbnRzIHRvIGJvdGggalF1ZXJ5IGFuZCBqcUxpdGU6XG4gKlxuICogIyMjIEV2ZW50c1xuICogLSBgJGRlc3Ryb3lgIC0gQW5ndWxhckpTIGludGVyY2VwdHMgYWxsIGpxTGl0ZS9qUXVlcnkncyBET00gZGVzdHJ1Y3Rpb24gYXBpcyBhbmQgZmlyZXMgdGhpcyBldmVudFxuICogICAgb24gYWxsIERPTSBub2RlcyBiZWluZyByZW1vdmVkLiAgVGhpcyBjYW4gYmUgdXNlZCB0byBjbGVhbiB1cCBhbnkgM3JkIHBhcnR5IGJpbmRpbmdzIHRvIHRoZSBET01cbiAqICAgIGVsZW1lbnQgYmVmb3JlIGl0IGlzIHJlbW92ZWQuXG4gKlxuICogIyMjIE1ldGhvZHNcbiAqIC0gYGNvbnRyb2xsZXIobmFtZSlgIC0gcmV0cmlldmVzIHRoZSBjb250cm9sbGVyIG9mIHRoZSBjdXJyZW50IGVsZW1lbnQgb3IgaXRzIHBhcmVudC4gQnkgZGVmYXVsdFxuICogICByZXRyaWV2ZXMgY29udHJvbGxlciBhc3NvY2lhdGVkIHdpdGggdGhlIGBuZ0NvbnRyb2xsZXJgIGRpcmVjdGl2ZS4gSWYgYG5hbWVgIGlzIHByb3ZpZGVkIGFzXG4gKiAgIGNhbWVsQ2FzZSBkaXJlY3RpdmUgbmFtZSwgdGhlbiB0aGUgY29udHJvbGxlciBmb3IgdGhpcyBkaXJlY3RpdmUgd2lsbCBiZSByZXRyaWV2ZWQgKGUuZy5cbiAqICAgYCduZ01vZGVsJ2ApLlxuICogLSBgaW5qZWN0b3IoKWAgLSByZXRyaWV2ZXMgdGhlIGluamVjdG9yIG9mIHRoZSBjdXJyZW50IGVsZW1lbnQgb3IgaXRzIHBhcmVudC5cbiAqIC0gYHNjb3BlKClgIC0gcmV0cmlldmVzIHRoZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSBzY29wZX0gb2YgdGhlIGN1cnJlbnRcbiAqICAgZWxlbWVudCBvciBpdHMgcGFyZW50LiBSZXF1aXJlcyB7QGxpbmsgZ3VpZGUvcHJvZHVjdGlvbiNkaXNhYmxpbmctZGVidWctZGF0YSBEZWJ1ZyBEYXRhfSB0b1xuICogICBiZSBlbmFibGVkLlxuICogLSBgaXNvbGF0ZVNjb3BlKClgIC0gcmV0cmlldmVzIGFuIGlzb2xhdGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUgc2NvcGV9IGlmIG9uZSBpcyBhdHRhY2hlZCBkaXJlY3RseSB0byB0aGVcbiAqICAgY3VycmVudCBlbGVtZW50LiBUaGlzIGdldHRlciBzaG91bGQgYmUgdXNlZCBvbmx5IG9uIGVsZW1lbnRzIHRoYXQgY29udGFpbiBhIGRpcmVjdGl2ZSB3aGljaCBzdGFydHMgYSBuZXcgaXNvbGF0ZVxuICogICBzY29wZS4gQ2FsbGluZyBgc2NvcGUoKWAgb24gdGhpcyBlbGVtZW50IGFsd2F5cyByZXR1cm5zIHRoZSBvcmlnaW5hbCBub24taXNvbGF0ZSBzY29wZS5cbiAqICAgUmVxdWlyZXMge0BsaW5rIGd1aWRlL3Byb2R1Y3Rpb24jZGlzYWJsaW5nLWRlYnVnLWRhdGEgRGVidWcgRGF0YX0gdG8gYmUgZW5hYmxlZC5cbiAqIC0gYGluaGVyaXRlZERhdGEoKWAgLSBzYW1lIGFzIGBkYXRhKClgLCBidXQgd2Fsa3MgdXAgdGhlIERPTSB1bnRpbCBhIHZhbHVlIGlzIGZvdW5kIG9yIHRoZSB0b3BcbiAqICAgcGFyZW50IGVsZW1lbnQgaXMgcmVhY2hlZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ3xET01FbGVtZW50fSBlbGVtZW50IEhUTUwgc3RyaW5nIG9yIERPTUVsZW1lbnQgdG8gYmUgd3JhcHBlZCBpbnRvIGpRdWVyeS5cbiAqIEByZXR1cm5zIHtPYmplY3R9IGpRdWVyeSBvYmplY3QuXG4gKi9cblxuSlFMaXRlLmV4cGFuZG8gPSAnbmczMzknO1xuXG52YXIganFDYWNoZSA9IEpRTGl0ZS5jYWNoZSA9IHt9LFxuICAgIGpxSWQgPSAxLFxuICAgIGFkZEV2ZW50TGlzdGVuZXJGbiA9IGZ1bmN0aW9uKGVsZW1lbnQsIHR5cGUsIGZuKSB7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgZm4sIGZhbHNlKTtcbiAgICB9LFxuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXJGbiA9IGZ1bmN0aW9uKGVsZW1lbnQsIHR5cGUsIGZuKSB7XG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgZm4sIGZhbHNlKTtcbiAgICB9O1xuXG4vKlxuICogISEhIFRoaXMgaXMgYW4gdW5kb2N1bWVudGVkIFwicHJpdmF0ZVwiIGZ1bmN0aW9uICEhIVxuICovXG5KUUxpdGUuX2RhdGEgPSBmdW5jdGlvbihub2RlKSB7XG4gIC8valF1ZXJ5IGFsd2F5cyByZXR1cm5zIGFuIG9iamVjdCBvbiBjYWNoZSBtaXNzXG4gIHJldHVybiB0aGlzLmNhY2hlW25vZGVbdGhpcy5leHBhbmRvXV0gfHwge307XG59O1xuXG5mdW5jdGlvbiBqcU5leHRJZCgpIHsgcmV0dXJuICsranFJZDsgfVxuXG5cbnZhciBTUEVDSUFMX0NIQVJTX1JFR0VYUCA9IC8oW1xcOlxcLVxcX10rKC4pKS9nO1xudmFyIE1PWl9IQUNLX1JFR0VYUCA9IC9ebW96KFtBLVpdKS87XG52YXIgTU9VU0VfRVZFTlRfTUFQPSB7IG1vdXNlbGVhdmU6IFwibW91c2VvdXRcIiwgbW91c2VlbnRlcjogXCJtb3VzZW92ZXJcIn07XG52YXIganFMaXRlTWluRXJyID0gbWluRXJyKCdqcUxpdGUnKTtcblxuLyoqXG4gKiBDb252ZXJ0cyBzbmFrZV9jYXNlIHRvIGNhbWVsQ2FzZS5cbiAqIEFsc28gdGhlcmUgaXMgc3BlY2lhbCBjYXNlIGZvciBNb3ogcHJlZml4IHN0YXJ0aW5nIHdpdGggdXBwZXIgY2FzZSBsZXR0ZXIuXG4gKiBAcGFyYW0gbmFtZSBOYW1lIHRvIG5vcm1hbGl6ZVxuICovXG5mdW5jdGlvbiBjYW1lbENhc2UobmFtZSkge1xuICByZXR1cm4gbmFtZS5cbiAgICByZXBsYWNlKFNQRUNJQUxfQ0hBUlNfUkVHRVhQLCBmdW5jdGlvbihfLCBzZXBhcmF0b3IsIGxldHRlciwgb2Zmc2V0KSB7XG4gICAgICByZXR1cm4gb2Zmc2V0ID8gbGV0dGVyLnRvVXBwZXJDYXNlKCkgOiBsZXR0ZXI7XG4gICAgfSkuXG4gICAgcmVwbGFjZShNT1pfSEFDS19SRUdFWFAsICdNb3okMScpO1xufVxuXG52YXIgU0lOR0xFX1RBR19SRUdFWFAgPSAvXjwoW1xcdy1dKylcXHMqXFwvPz4oPzo8XFwvXFwxPnwpJC87XG52YXIgSFRNTF9SRUdFWFAgPSAvPHwmIz9cXHcrOy87XG52YXIgVEFHX05BTUVfUkVHRVhQID0gLzwoW1xcdzotXSspLztcbnZhciBYSFRNTF9UQUdfUkVHRVhQID0gLzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW1xcdzotXSspW14+XSopXFwvPi9naTtcblxudmFyIHdyYXBNYXAgPSB7XG4gICdvcHRpb24nOiBbMSwgJzxzZWxlY3QgbXVsdGlwbGU9XCJtdWx0aXBsZVwiPicsICc8L3NlbGVjdD4nXSxcblxuICAndGhlYWQnOiBbMSwgJzx0YWJsZT4nLCAnPC90YWJsZT4nXSxcbiAgJ2NvbCc6IFsyLCAnPHRhYmxlPjxjb2xncm91cD4nLCAnPC9jb2xncm91cD48L3RhYmxlPiddLFxuICAndHInOiBbMiwgJzx0YWJsZT48dGJvZHk+JywgJzwvdGJvZHk+PC90YWJsZT4nXSxcbiAgJ3RkJzogWzMsICc8dGFibGU+PHRib2R5Pjx0cj4nLCAnPC90cj48L3Rib2R5PjwvdGFibGU+J10sXG4gICdfZGVmYXVsdCc6IFswLCBcIlwiLCBcIlwiXVxufTtcblxud3JhcE1hcC5vcHRncm91cCA9IHdyYXBNYXAub3B0aW9uO1xud3JhcE1hcC50Ym9keSA9IHdyYXBNYXAudGZvb3QgPSB3cmFwTWFwLmNvbGdyb3VwID0gd3JhcE1hcC5jYXB0aW9uID0gd3JhcE1hcC50aGVhZDtcbndyYXBNYXAudGggPSB3cmFwTWFwLnRkO1xuXG5cbmZ1bmN0aW9uIGpxTGl0ZUlzVGV4dE5vZGUoaHRtbCkge1xuICByZXR1cm4gIUhUTUxfUkVHRVhQLnRlc3QoaHRtbCk7XG59XG5cbmZ1bmN0aW9uIGpxTGl0ZUFjY2VwdHNEYXRhKG5vZGUpIHtcbiAgLy8gVGhlIHdpbmRvdyBvYmplY3QgY2FuIGFjY2VwdCBkYXRhIGJ1dCBoYXMgbm8gbm9kZVR5cGVcbiAgLy8gT3RoZXJ3aXNlIHdlIGFyZSBvbmx5IGludGVyZXN0ZWQgaW4gZWxlbWVudHMgKDEpIGFuZCBkb2N1bWVudHMgKDkpXG4gIHZhciBub2RlVHlwZSA9IG5vZGUubm9kZVR5cGU7XG4gIHJldHVybiBub2RlVHlwZSA9PT0gTk9ERV9UWVBFX0VMRU1FTlQgfHwgIW5vZGVUeXBlIHx8IG5vZGVUeXBlID09PSBOT0RFX1RZUEVfRE9DVU1FTlQ7XG59XG5cbmZ1bmN0aW9uIGpxTGl0ZUhhc0RhdGEobm9kZSkge1xuICBmb3IgKHZhciBrZXkgaW4ganFDYWNoZVtub2RlLm5nMzM5XSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24ganFMaXRlQ2xlYW5EYXRhKG5vZGVzKSB7XG4gIGZvciAodmFyIGkgPSAwLCBpaSA9IG5vZGVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICBqcUxpdGVSZW1vdmVEYXRhKG5vZGVzW2ldKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBqcUxpdGVCdWlsZEZyYWdtZW50KGh0bWwsIGNvbnRleHQpIHtcbiAgdmFyIHRtcCwgdGFnLCB3cmFwLFxuICAgICAgZnJhZ21lbnQgPSBjb250ZXh0LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxcbiAgICAgIG5vZGVzID0gW10sIGk7XG5cbiAgaWYgKGpxTGl0ZUlzVGV4dE5vZGUoaHRtbCkpIHtcbiAgICAvLyBDb252ZXJ0IG5vbi1odG1sIGludG8gYSB0ZXh0IG5vZGVcbiAgICBub2Rlcy5wdXNoKGNvbnRleHQuY3JlYXRlVGV4dE5vZGUoaHRtbCkpO1xuICB9IGVsc2Uge1xuICAgIC8vIENvbnZlcnQgaHRtbCBpbnRvIERPTSBub2Rlc1xuICAgIHRtcCA9IHRtcCB8fCBmcmFnbWVudC5hcHBlbmRDaGlsZChjb250ZXh0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpO1xuICAgIHRhZyA9IChUQUdfTkFNRV9SRUdFWFAuZXhlYyhodG1sKSB8fCBbXCJcIiwgXCJcIl0pWzFdLnRvTG93ZXJDYXNlKCk7XG4gICAgd3JhcCA9IHdyYXBNYXBbdGFnXSB8fCB3cmFwTWFwLl9kZWZhdWx0O1xuICAgIHRtcC5pbm5lckhUTUwgPSB3cmFwWzFdICsgaHRtbC5yZXBsYWNlKFhIVE1MX1RBR19SRUdFWFAsIFwiPCQxPjwvJDI+XCIpICsgd3JhcFsyXTtcblxuICAgIC8vIERlc2NlbmQgdGhyb3VnaCB3cmFwcGVycyB0byB0aGUgcmlnaHQgY29udGVudFxuICAgIGkgPSB3cmFwWzBdO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIHRtcCA9IHRtcC5sYXN0Q2hpbGQ7XG4gICAgfVxuXG4gICAgbm9kZXMgPSBjb25jYXQobm9kZXMsIHRtcC5jaGlsZE5vZGVzKTtcblxuICAgIHRtcCA9IGZyYWdtZW50LmZpcnN0Q2hpbGQ7XG4gICAgdG1wLnRleHRDb250ZW50ID0gXCJcIjtcbiAgfVxuXG4gIC8vIFJlbW92ZSB3cmFwcGVyIGZyb20gZnJhZ21lbnRcbiAgZnJhZ21lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICBmcmFnbWVudC5pbm5lckhUTUwgPSBcIlwiOyAvLyBDbGVhciBpbm5lciBIVE1MXG4gIGZvckVhY2gobm9kZXMsIGZ1bmN0aW9uKG5vZGUpIHtcbiAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChub2RlKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGZyYWdtZW50O1xufVxuXG5mdW5jdGlvbiBqcUxpdGVQYXJzZUhUTUwoaHRtbCwgY29udGV4dCkge1xuICBjb250ZXh0ID0gY29udGV4dCB8fCBkb2N1bWVudDtcbiAgdmFyIHBhcnNlZDtcblxuICBpZiAoKHBhcnNlZCA9IFNJTkdMRV9UQUdfUkVHRVhQLmV4ZWMoaHRtbCkpKSB7XG4gICAgcmV0dXJuIFtjb250ZXh0LmNyZWF0ZUVsZW1lbnQocGFyc2VkWzFdKV07XG4gIH1cblxuICBpZiAoKHBhcnNlZCA9IGpxTGl0ZUJ1aWxkRnJhZ21lbnQoaHRtbCwgY29udGV4dCkpKSB7XG4gICAgcmV0dXJuIHBhcnNlZC5jaGlsZE5vZGVzO1xuICB9XG5cbiAgcmV0dXJuIFtdO1xufVxuXG5mdW5jdGlvbiBqcUxpdGVXcmFwTm9kZShub2RlLCB3cmFwcGVyKSB7XG4gIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudE5vZGU7XG5cbiAgaWYgKHBhcmVudCkge1xuICAgIHBhcmVudC5yZXBsYWNlQ2hpbGQod3JhcHBlciwgbm9kZSk7XG4gIH1cblxuICB3cmFwcGVyLmFwcGVuZENoaWxkKG5vZGUpO1xufVxuXG5cbi8vIElFOS0xMSBoYXMgbm8gbWV0aG9kIFwiY29udGFpbnNcIiBpbiBTVkcgZWxlbWVudCBhbmQgaW4gTm9kZS5wcm90b3R5cGUuIEJ1ZyAjMTAyNTkuXG52YXIganFMaXRlQ29udGFpbnMgPSBOb2RlLnByb3RvdHlwZS5jb250YWlucyB8fCBmdW5jdGlvbihhcmcpIHtcbiAgLy8ganNoaW50IGJpdHdpc2U6IGZhbHNlXG4gIHJldHVybiAhISh0aGlzLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGFyZykgJiAxNik7XG4gIC8vIGpzaGludCBiaXR3aXNlOiB0cnVlXG59O1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbmZ1bmN0aW9uIEpRTGl0ZShlbGVtZW50KSB7XG4gIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSlFMaXRlKSB7XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH1cblxuICB2YXIgYXJnSXNTdHJpbmc7XG5cbiAgaWYgKGlzU3RyaW5nKGVsZW1lbnQpKSB7XG4gICAgZWxlbWVudCA9IHRyaW0oZWxlbWVudCk7XG4gICAgYXJnSXNTdHJpbmcgPSB0cnVlO1xuICB9XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBKUUxpdGUpKSB7XG4gICAgaWYgKGFyZ0lzU3RyaW5nICYmIGVsZW1lbnQuY2hhckF0KDApICE9ICc8Jykge1xuICAgICAgdGhyb3cganFMaXRlTWluRXJyKCdub3NlbCcsICdMb29raW5nIHVwIGVsZW1lbnRzIHZpYSBzZWxlY3RvcnMgaXMgbm90IHN1cHBvcnRlZCBieSBqcUxpdGUhIFNlZTogaHR0cDovL2RvY3MuYW5ndWxhcmpzLm9yZy9hcGkvYW5ndWxhci5lbGVtZW50Jyk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgSlFMaXRlKGVsZW1lbnQpO1xuICB9XG5cbiAgaWYgKGFyZ0lzU3RyaW5nKSB7XG4gICAganFMaXRlQWRkTm9kZXModGhpcywganFMaXRlUGFyc2VIVE1MKGVsZW1lbnQpKTtcbiAgfSBlbHNlIHtcbiAgICBqcUxpdGVBZGROb2Rlcyh0aGlzLCBlbGVtZW50KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBqcUxpdGVDbG9uZShlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LmNsb25lTm9kZSh0cnVlKTtcbn1cblxuZnVuY3Rpb24ganFMaXRlRGVhbG9jKGVsZW1lbnQsIG9ubHlEZXNjZW5kYW50cykge1xuICBpZiAoIW9ubHlEZXNjZW5kYW50cykganFMaXRlUmVtb3ZlRGF0YShlbGVtZW50KTtcblxuICBpZiAoZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKSB7XG4gICAgdmFyIGRlc2NlbmRhbnRzID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcqJyk7XG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSBkZXNjZW5kYW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIGpxTGl0ZVJlbW92ZURhdGEoZGVzY2VuZGFudHNbaV0pO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBqcUxpdGVPZmYoZWxlbWVudCwgdHlwZSwgZm4sIHVuc3VwcG9ydGVkKSB7XG4gIGlmIChpc0RlZmluZWQodW5zdXBwb3J0ZWQpKSB0aHJvdyBqcUxpdGVNaW5FcnIoJ29mZmFyZ3MnLCAnanFMaXRlI29mZigpIGRvZXMgbm90IHN1cHBvcnQgdGhlIGBzZWxlY3RvcmAgYXJndW1lbnQnKTtcblxuICB2YXIgZXhwYW5kb1N0b3JlID0ganFMaXRlRXhwYW5kb1N0b3JlKGVsZW1lbnQpO1xuICB2YXIgZXZlbnRzID0gZXhwYW5kb1N0b3JlICYmIGV4cGFuZG9TdG9yZS5ldmVudHM7XG4gIHZhciBoYW5kbGUgPSBleHBhbmRvU3RvcmUgJiYgZXhwYW5kb1N0b3JlLmhhbmRsZTtcblxuICBpZiAoIWhhbmRsZSkgcmV0dXJuOyAvL25vIGxpc3RlbmVycyByZWdpc3RlcmVkXG5cbiAgaWYgKCF0eXBlKSB7XG4gICAgZm9yICh0eXBlIGluIGV2ZW50cykge1xuICAgICAgaWYgKHR5cGUgIT09ICckZGVzdHJveScpIHtcbiAgICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lckZuKGVsZW1lbnQsIHR5cGUsIGhhbmRsZSk7XG4gICAgICB9XG4gICAgICBkZWxldGUgZXZlbnRzW3R5cGVdO1xuICAgIH1cbiAgfSBlbHNlIHtcblxuICAgIHZhciByZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24odHlwZSkge1xuICAgICAgdmFyIGxpc3RlbmVyRm5zID0gZXZlbnRzW3R5cGVdO1xuICAgICAgaWYgKGlzRGVmaW5lZChmbikpIHtcbiAgICAgICAgYXJyYXlSZW1vdmUobGlzdGVuZXJGbnMgfHwgW10sIGZuKTtcbiAgICAgIH1cbiAgICAgIGlmICghKGlzRGVmaW5lZChmbikgJiYgbGlzdGVuZXJGbnMgJiYgbGlzdGVuZXJGbnMubGVuZ3RoID4gMCkpIHtcbiAgICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lckZuKGVsZW1lbnQsIHR5cGUsIGhhbmRsZSk7XG4gICAgICAgIGRlbGV0ZSBldmVudHNbdHlwZV07XG4gICAgICB9XG4gICAgfTtcblxuICAgIGZvckVhY2godHlwZS5zcGxpdCgnICcpLCBmdW5jdGlvbih0eXBlKSB7XG4gICAgICByZW1vdmVIYW5kbGVyKHR5cGUpO1xuICAgICAgaWYgKE1PVVNFX0VWRU5UX01BUFt0eXBlXSkge1xuICAgICAgICByZW1vdmVIYW5kbGVyKE1PVVNFX0VWRU5UX01BUFt0eXBlXSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24ganFMaXRlUmVtb3ZlRGF0YShlbGVtZW50LCBuYW1lKSB7XG4gIHZhciBleHBhbmRvSWQgPSBlbGVtZW50Lm5nMzM5O1xuICB2YXIgZXhwYW5kb1N0b3JlID0gZXhwYW5kb0lkICYmIGpxQ2FjaGVbZXhwYW5kb0lkXTtcblxuICBpZiAoZXhwYW5kb1N0b3JlKSB7XG4gICAgaWYgKG5hbWUpIHtcbiAgICAgIGRlbGV0ZSBleHBhbmRvU3RvcmUuZGF0YVtuYW1lXTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoZXhwYW5kb1N0b3JlLmhhbmRsZSkge1xuICAgICAgaWYgKGV4cGFuZG9TdG9yZS5ldmVudHMuJGRlc3Ryb3kpIHtcbiAgICAgICAgZXhwYW5kb1N0b3JlLmhhbmRsZSh7fSwgJyRkZXN0cm95Jyk7XG4gICAgICB9XG4gICAgICBqcUxpdGVPZmYoZWxlbWVudCk7XG4gICAgfVxuICAgIGRlbGV0ZSBqcUNhY2hlW2V4cGFuZG9JZF07XG4gICAgZWxlbWVudC5uZzMzOSA9IHVuZGVmaW5lZDsgLy8gZG9uJ3QgZGVsZXRlIERPTSBleHBhbmRvcy4gSUUgYW5kIENocm9tZSBkb24ndCBsaWtlIGl0XG4gIH1cbn1cblxuXG5mdW5jdGlvbiBqcUxpdGVFeHBhbmRvU3RvcmUoZWxlbWVudCwgY3JlYXRlSWZOZWNlc3NhcnkpIHtcbiAgdmFyIGV4cGFuZG9JZCA9IGVsZW1lbnQubmczMzksXG4gICAgICBleHBhbmRvU3RvcmUgPSBleHBhbmRvSWQgJiYganFDYWNoZVtleHBhbmRvSWRdO1xuXG4gIGlmIChjcmVhdGVJZk5lY2Vzc2FyeSAmJiAhZXhwYW5kb1N0b3JlKSB7XG4gICAgZWxlbWVudC5uZzMzOSA9IGV4cGFuZG9JZCA9IGpxTmV4dElkKCk7XG4gICAgZXhwYW5kb1N0b3JlID0ganFDYWNoZVtleHBhbmRvSWRdID0ge2V2ZW50czoge30sIGRhdGE6IHt9LCBoYW5kbGU6IHVuZGVmaW5lZH07XG4gIH1cblxuICByZXR1cm4gZXhwYW5kb1N0b3JlO1xufVxuXG5cbmZ1bmN0aW9uIGpxTGl0ZURhdGEoZWxlbWVudCwga2V5LCB2YWx1ZSkge1xuICBpZiAoanFMaXRlQWNjZXB0c0RhdGEoZWxlbWVudCkpIHtcblxuICAgIHZhciBpc1NpbXBsZVNldHRlciA9IGlzRGVmaW5lZCh2YWx1ZSk7XG4gICAgdmFyIGlzU2ltcGxlR2V0dGVyID0gIWlzU2ltcGxlU2V0dGVyICYmIGtleSAmJiAhaXNPYmplY3Qoa2V5KTtcbiAgICB2YXIgbWFzc0dldHRlciA9ICFrZXk7XG4gICAgdmFyIGV4cGFuZG9TdG9yZSA9IGpxTGl0ZUV4cGFuZG9TdG9yZShlbGVtZW50LCAhaXNTaW1wbGVHZXR0ZXIpO1xuICAgIHZhciBkYXRhID0gZXhwYW5kb1N0b3JlICYmIGV4cGFuZG9TdG9yZS5kYXRhO1xuXG4gICAgaWYgKGlzU2ltcGxlU2V0dGVyKSB7IC8vIGRhdGEoJ2tleScsIHZhbHVlKVxuICAgICAgZGF0YVtrZXldID0gdmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChtYXNzR2V0dGVyKSB7ICAvLyBkYXRhKClcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoaXNTaW1wbGVHZXR0ZXIpIHsgLy8gZGF0YSgna2V5JylcbiAgICAgICAgICAvLyBkb24ndCBmb3JjZSBjcmVhdGlvbiBvZiBleHBhbmRvU3RvcmUgaWYgaXQgZG9lc24ndCBleGlzdCB5ZXRcbiAgICAgICAgICByZXR1cm4gZGF0YSAmJiBkYXRhW2tleV07XG4gICAgICAgIH0gZWxzZSB7IC8vIG1hc3Mtc2V0dGVyOiBkYXRhKHtrZXkxOiB2YWwxLCBrZXkyOiB2YWwyfSlcbiAgICAgICAgICBleHRlbmQoZGF0YSwga2V5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBqcUxpdGVIYXNDbGFzcyhlbGVtZW50LCBzZWxlY3Rvcikge1xuICBpZiAoIWVsZW1lbnQuZ2V0QXR0cmlidXRlKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiAoKFwiIFwiICsgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdjbGFzcycpIHx8ICcnKSArIFwiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIikuXG4gICAgICBpbmRleE9mKFwiIFwiICsgc2VsZWN0b3IgKyBcIiBcIikgPiAtMSk7XG59XG5cbmZ1bmN0aW9uIGpxTGl0ZVJlbW92ZUNsYXNzKGVsZW1lbnQsIGNzc0NsYXNzZXMpIHtcbiAgaWYgKGNzc0NsYXNzZXMgJiYgZWxlbWVudC5zZXRBdHRyaWJ1dGUpIHtcbiAgICBmb3JFYWNoKGNzc0NsYXNzZXMuc3BsaXQoJyAnKSwgZnVuY3Rpb24oY3NzQ2xhc3MpIHtcbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdjbGFzcycsIHRyaW0oXG4gICAgICAgICAgKFwiIFwiICsgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdjbGFzcycpIHx8ICcnKSArIFwiIFwiKVxuICAgICAgICAgIC5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIilcbiAgICAgICAgICAucmVwbGFjZShcIiBcIiArIHRyaW0oY3NzQ2xhc3MpICsgXCIgXCIsIFwiIFwiKSlcbiAgICAgICk7XG4gICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24ganFMaXRlQWRkQ2xhc3MoZWxlbWVudCwgY3NzQ2xhc3Nlcykge1xuICBpZiAoY3NzQ2xhc3NlcyAmJiBlbGVtZW50LnNldEF0dHJpYnV0ZSkge1xuICAgIHZhciBleGlzdGluZ0NsYXNzZXMgPSAoJyAnICsgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdjbGFzcycpIHx8ICcnKSArICcgJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvW1xcblxcdF0vZywgXCIgXCIpO1xuXG4gICAgZm9yRWFjaChjc3NDbGFzc2VzLnNwbGl0KCcgJyksIGZ1bmN0aW9uKGNzc0NsYXNzKSB7XG4gICAgICBjc3NDbGFzcyA9IHRyaW0oY3NzQ2xhc3MpO1xuICAgICAgaWYgKGV4aXN0aW5nQ2xhc3Nlcy5pbmRleE9mKCcgJyArIGNzc0NsYXNzICsgJyAnKSA9PT0gLTEpIHtcbiAgICAgICAgZXhpc3RpbmdDbGFzc2VzICs9IGNzc0NsYXNzICsgJyAnO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgdHJpbShleGlzdGluZ0NsYXNzZXMpKTtcbiAgfVxufVxuXG5cbmZ1bmN0aW9uIGpxTGl0ZUFkZE5vZGVzKHJvb3QsIGVsZW1lbnRzKSB7XG4gIC8vIFRISVMgQ09ERSBJUyBWRVJZIEhPVC4gRG9uJ3QgbWFrZSBjaGFuZ2VzIHdpdGhvdXQgYmVuY2htYXJraW5nLlxuXG4gIGlmIChlbGVtZW50cykge1xuXG4gICAgLy8gaWYgYSBOb2RlICh0aGUgbW9zdCBjb21tb24gY2FzZSlcbiAgICBpZiAoZWxlbWVudHMubm9kZVR5cGUpIHtcbiAgICAgIHJvb3Rbcm9vdC5sZW5ndGgrK10gPSBlbGVtZW50cztcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGxlbmd0aCA9IGVsZW1lbnRzLmxlbmd0aDtcblxuICAgICAgLy8gaWYgYW4gQXJyYXkgb3IgTm9kZUxpc3QgYW5kIG5vdCBhIFdpbmRvd1xuICAgICAgaWYgKHR5cGVvZiBsZW5ndGggPT09ICdudW1iZXInICYmIGVsZW1lbnRzLndpbmRvdyAhPT0gZWxlbWVudHMpIHtcbiAgICAgICAgaWYgKGxlbmd0aCkge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJvb3Rbcm9vdC5sZW5ndGgrK10gPSBlbGVtZW50c1tpXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJvb3Rbcm9vdC5sZW5ndGgrK10gPSBlbGVtZW50cztcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuXG5mdW5jdGlvbiBqcUxpdGVDb250cm9sbGVyKGVsZW1lbnQsIG5hbWUpIHtcbiAgcmV0dXJuIGpxTGl0ZUluaGVyaXRlZERhdGEoZWxlbWVudCwgJyQnICsgKG5hbWUgfHwgJ25nQ29udHJvbGxlcicpICsgJ0NvbnRyb2xsZXInKTtcbn1cblxuZnVuY3Rpb24ganFMaXRlSW5oZXJpdGVkRGF0YShlbGVtZW50LCBuYW1lLCB2YWx1ZSkge1xuICAvLyBpZiBlbGVtZW50IGlzIHRoZSBkb2N1bWVudCBvYmplY3Qgd29yayB3aXRoIHRoZSBodG1sIGVsZW1lbnQgaW5zdGVhZFxuICAvLyB0aGlzIG1ha2VzICQoZG9jdW1lbnQpLnNjb3BlKCkgcG9zc2libGVcbiAgaWYgKGVsZW1lbnQubm9kZVR5cGUgPT0gTk9ERV9UWVBFX0RPQ1VNRU5UKSB7XG4gICAgZWxlbWVudCA9IGVsZW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICB9XG4gIHZhciBuYW1lcyA9IGlzQXJyYXkobmFtZSkgPyBuYW1lIDogW25hbWVdO1xuXG4gIHdoaWxlIChlbGVtZW50KSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGlpID0gbmFtZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgaWYgKGlzRGVmaW5lZCh2YWx1ZSA9IGpxTGl0ZS5kYXRhKGVsZW1lbnQsIG5hbWVzW2ldKSkpIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICAvLyBJZiBkZWFsaW5nIHdpdGggYSBkb2N1bWVudCBmcmFnbWVudCBub2RlIHdpdGggYSBob3N0IGVsZW1lbnQsIGFuZCBubyBwYXJlbnQsIHVzZSB0aGUgaG9zdFxuICAgIC8vIGVsZW1lbnQgYXMgdGhlIHBhcmVudC4gVGhpcyBlbmFibGVzIGRpcmVjdGl2ZXMgd2l0aGluIGEgU2hhZG93IERPTSBvciBwb2x5ZmlsbGVkIFNoYWRvdyBET01cbiAgICAvLyB0byBsb29rdXAgcGFyZW50IGNvbnRyb2xsZXJzLlxuICAgIGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGUgfHwgKGVsZW1lbnQubm9kZVR5cGUgPT09IE5PREVfVFlQRV9ET0NVTUVOVF9GUkFHTUVOVCAmJiBlbGVtZW50Lmhvc3QpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGpxTGl0ZUVtcHR5KGVsZW1lbnQpIHtcbiAganFMaXRlRGVhbG9jKGVsZW1lbnQsIHRydWUpO1xuICB3aGlsZSAoZWxlbWVudC5maXJzdENoaWxkKSB7XG4gICAgZWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50LmZpcnN0Q2hpbGQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGpxTGl0ZVJlbW92ZShlbGVtZW50LCBrZWVwRGF0YSkge1xuICBpZiAoIWtlZXBEYXRhKSBqcUxpdGVEZWFsb2MoZWxlbWVudCk7XG4gIHZhciBwYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gIGlmIChwYXJlbnQpIHBhcmVudC5yZW1vdmVDaGlsZChlbGVtZW50KTtcbn1cblxuXG5mdW5jdGlvbiBqcUxpdGVEb2N1bWVudExvYWRlZChhY3Rpb24sIHdpbikge1xuICB3aW4gPSB3aW4gfHwgd2luZG93O1xuICBpZiAod2luLmRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHtcbiAgICAvLyBGb3JjZSB0aGUgYWN0aW9uIHRvIGJlIHJ1biBhc3luYyBmb3IgY29uc2lzdGVudCBiZWhhdmlvclxuICAgIC8vIGZyb20gdGhlIGFjdGlvbidzIHBvaW50IG9mIHZpZXdcbiAgICAvLyBpLmUuIGl0IHdpbGwgZGVmaW5pdGVseSBub3QgYmUgaW4gYSAkYXBwbHlcbiAgICB3aW4uc2V0VGltZW91dChhY3Rpb24pO1xuICB9IGVsc2Uge1xuICAgIC8vIE5vIG5lZWQgdG8gdW5iaW5kIHRoaXMgaGFuZGxlciBhcyBsb2FkIGlzIG9ubHkgZXZlciBjYWxsZWQgb25jZVxuICAgIGpxTGl0ZSh3aW4pLm9uKCdsb2FkJywgYWN0aW9uKTtcbiAgfVxufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIEZ1bmN0aW9ucyB3aGljaCBhcmUgZGVjbGFyZWQgZGlyZWN0bHkuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbnZhciBKUUxpdGVQcm90b3R5cGUgPSBKUUxpdGUucHJvdG90eXBlID0ge1xuICByZWFkeTogZnVuY3Rpb24oZm4pIHtcbiAgICB2YXIgZmlyZWQgPSBmYWxzZTtcblxuICAgIGZ1bmN0aW9uIHRyaWdnZXIoKSB7XG4gICAgICBpZiAoZmlyZWQpIHJldHVybjtcbiAgICAgIGZpcmVkID0gdHJ1ZTtcbiAgICAgIGZuKCk7XG4gICAgfVxuXG4gICAgLy8gY2hlY2sgaWYgZG9jdW1lbnQgaXMgYWxyZWFkeSBsb2FkZWRcbiAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2NvbXBsZXRlJykge1xuICAgICAgc2V0VGltZW91dCh0cmlnZ2VyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vbignRE9NQ29udGVudExvYWRlZCcsIHRyaWdnZXIpOyAvLyB3b3JrcyBmb3IgbW9kZXJuIGJyb3dzZXJzIGFuZCBJRTlcbiAgICAgIC8vIHdlIGNhbiBub3QgdXNlIGpxTGl0ZSBzaW5jZSB3ZSBhcmUgbm90IGRvbmUgbG9hZGluZyBhbmQgalF1ZXJ5IGNvdWxkIGJlIGxvYWRlZCBsYXRlci5cbiAgICAgIC8vIGpzaGludCAtVzA2NFxuICAgICAgSlFMaXRlKHdpbmRvdykub24oJ2xvYWQnLCB0cmlnZ2VyKTsgLy8gZmFsbGJhY2sgdG8gd2luZG93Lm9ubG9hZCBmb3Igb3RoZXJzXG4gICAgICAvLyBqc2hpbnQgK1cwNjRcbiAgICB9XG4gIH0sXG4gIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdmFsdWUgPSBbXTtcbiAgICBmb3JFYWNoKHRoaXMsIGZ1bmN0aW9uKGUpIHsgdmFsdWUucHVzaCgnJyArIGUpO30pO1xuICAgIHJldHVybiAnWycgKyB2YWx1ZS5qb2luKCcsICcpICsgJ10nO1xuICB9LFxuXG4gIGVxOiBmdW5jdGlvbihpbmRleCkge1xuICAgICAgcmV0dXJuIChpbmRleCA+PSAwKSA/IGpxTGl0ZSh0aGlzW2luZGV4XSkgOiBqcUxpdGUodGhpc1t0aGlzLmxlbmd0aCArIGluZGV4XSk7XG4gIH0sXG5cbiAgbGVuZ3RoOiAwLFxuICBwdXNoOiBwdXNoLFxuICBzb3J0OiBbXS5zb3J0LFxuICBzcGxpY2U6IFtdLnNwbGljZVxufTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBGdW5jdGlvbnMgaXRlcmF0aW5nIGdldHRlci9zZXR0ZXJzLlxuLy8gdGhlc2UgZnVuY3Rpb25zIHJldHVybiBzZWxmIG9uIHNldHRlciBhbmRcbi8vIHZhbHVlIG9uIGdldC5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xudmFyIEJPT0xFQU5fQVRUUiA9IHt9O1xuZm9yRWFjaCgnbXVsdGlwbGUsc2VsZWN0ZWQsY2hlY2tlZCxkaXNhYmxlZCxyZWFkT25seSxyZXF1aXJlZCxvcGVuJy5zcGxpdCgnLCcpLCBmdW5jdGlvbih2YWx1ZSkge1xuICBCT09MRUFOX0FUVFJbbG93ZXJjYXNlKHZhbHVlKV0gPSB2YWx1ZTtcbn0pO1xudmFyIEJPT0xFQU5fRUxFTUVOVFMgPSB7fTtcbmZvckVhY2goJ2lucHV0LHNlbGVjdCxvcHRpb24sdGV4dGFyZWEsYnV0dG9uLGZvcm0sZGV0YWlscycuc3BsaXQoJywnKSwgZnVuY3Rpb24odmFsdWUpIHtcbiAgQk9PTEVBTl9FTEVNRU5UU1t2YWx1ZV0gPSB0cnVlO1xufSk7XG52YXIgQUxJQVNFRF9BVFRSID0ge1xuICAnbmdNaW5sZW5ndGgnOiAnbWlubGVuZ3RoJyxcbiAgJ25nTWF4bGVuZ3RoJzogJ21heGxlbmd0aCcsXG4gICduZ01pbic6ICdtaW4nLFxuICAnbmdNYXgnOiAnbWF4JyxcbiAgJ25nUGF0dGVybic6ICdwYXR0ZXJuJ1xufTtcblxuZnVuY3Rpb24gZ2V0Qm9vbGVhbkF0dHJOYW1lKGVsZW1lbnQsIG5hbWUpIHtcbiAgLy8gY2hlY2sgZG9tIGxhc3Qgc2luY2Ugd2Ugd2lsbCBtb3N0IGxpa2VseSBmYWlsIG9uIG5hbWVcbiAgdmFyIGJvb2xlYW5BdHRyID0gQk9PTEVBTl9BVFRSW25hbWUudG9Mb3dlckNhc2UoKV07XG5cbiAgLy8gYm9vbGVhbkF0dHIgaXMgaGVyZSB0d2ljZSB0byBtaW5pbWl6ZSBET00gYWNjZXNzXG4gIHJldHVybiBib29sZWFuQXR0ciAmJiBCT09MRUFOX0VMRU1FTlRTW25vZGVOYW1lXyhlbGVtZW50KV0gJiYgYm9vbGVhbkF0dHI7XG59XG5cbmZ1bmN0aW9uIGdldEFsaWFzZWRBdHRyTmFtZShuYW1lKSB7XG4gIHJldHVybiBBTElBU0VEX0FUVFJbbmFtZV07XG59XG5cbmZvckVhY2goe1xuICBkYXRhOiBqcUxpdGVEYXRhLFxuICByZW1vdmVEYXRhOiBqcUxpdGVSZW1vdmVEYXRhLFxuICBoYXNEYXRhOiBqcUxpdGVIYXNEYXRhLFxuICBjbGVhbkRhdGE6IGpxTGl0ZUNsZWFuRGF0YVxufSwgZnVuY3Rpb24oZm4sIG5hbWUpIHtcbiAgSlFMaXRlW25hbWVdID0gZm47XG59KTtcblxuZm9yRWFjaCh7XG4gIGRhdGE6IGpxTGl0ZURhdGEsXG4gIGluaGVyaXRlZERhdGE6IGpxTGl0ZUluaGVyaXRlZERhdGEsXG5cbiAgc2NvcGU6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAvLyBDYW4ndCB1c2UganFMaXRlRGF0YSBoZXJlIGRpcmVjdGx5IHNvIHdlIHN0YXkgY29tcGF0aWJsZSB3aXRoIGpRdWVyeSFcbiAgICByZXR1cm4ganFMaXRlLmRhdGEoZWxlbWVudCwgJyRzY29wZScpIHx8IGpxTGl0ZUluaGVyaXRlZERhdGEoZWxlbWVudC5wYXJlbnROb2RlIHx8IGVsZW1lbnQsIFsnJGlzb2xhdGVTY29wZScsICckc2NvcGUnXSk7XG4gIH0sXG5cbiAgaXNvbGF0ZVNjb3BlOiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgLy8gQ2FuJ3QgdXNlIGpxTGl0ZURhdGEgaGVyZSBkaXJlY3RseSBzbyB3ZSBzdGF5IGNvbXBhdGlibGUgd2l0aCBqUXVlcnkhXG4gICAgcmV0dXJuIGpxTGl0ZS5kYXRhKGVsZW1lbnQsICckaXNvbGF0ZVNjb3BlJykgfHwganFMaXRlLmRhdGEoZWxlbWVudCwgJyRpc29sYXRlU2NvcGVOb1RlbXBsYXRlJyk7XG4gIH0sXG5cbiAgY29udHJvbGxlcjoganFMaXRlQ29udHJvbGxlcixcblxuICBpbmplY3RvcjogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHJldHVybiBqcUxpdGVJbmhlcml0ZWREYXRhKGVsZW1lbnQsICckaW5qZWN0b3InKTtcbiAgfSxcblxuICByZW1vdmVBdHRyOiBmdW5jdGlvbihlbGVtZW50LCBuYW1lKSB7XG4gICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XG4gIH0sXG5cbiAgaGFzQ2xhc3M6IGpxTGl0ZUhhc0NsYXNzLFxuXG4gIGNzczogZnVuY3Rpb24oZWxlbWVudCwgbmFtZSwgdmFsdWUpIHtcbiAgICBuYW1lID0gY2FtZWxDYXNlKG5hbWUpO1xuXG4gICAgaWYgKGlzRGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgIGVsZW1lbnQuc3R5bGVbbmFtZV0gPSB2YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGVsZW1lbnQuc3R5bGVbbmFtZV07XG4gICAgfVxuICB9LFxuXG4gIGF0dHI6IGZ1bmN0aW9uKGVsZW1lbnQsIG5hbWUsIHZhbHVlKSB7XG4gICAgdmFyIG5vZGVUeXBlID0gZWxlbWVudC5ub2RlVHlwZTtcbiAgICBpZiAobm9kZVR5cGUgPT09IE5PREVfVFlQRV9URVhUIHx8IG5vZGVUeXBlID09PSBOT0RFX1RZUEVfQVRUUklCVVRFIHx8IG5vZGVUeXBlID09PSBOT0RFX1RZUEVfQ09NTUVOVCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgbG93ZXJjYXNlZE5hbWUgPSBsb3dlcmNhc2UobmFtZSk7XG4gICAgaWYgKEJPT0xFQU5fQVRUUltsb3dlcmNhc2VkTmFtZV0pIHtcbiAgICAgIGlmIChpc0RlZmluZWQodmFsdWUpKSB7XG4gICAgICAgIGlmICghIXZhbHVlKSB7XG4gICAgICAgICAgZWxlbWVudFtuYW1lXSA9IHRydWU7XG4gICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUobmFtZSwgbG93ZXJjYXNlZE5hbWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsZW1lbnRbbmFtZV0gPSBmYWxzZTtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShsb3dlcmNhc2VkTmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAoZWxlbWVudFtuYW1lXSB8fFxuICAgICAgICAgICAgICAgICAoZWxlbWVudC5hdHRyaWJ1dGVzLmdldE5hbWVkSXRlbShuYW1lKSB8fCBub29wKS5zcGVjaWZpZWQpXG4gICAgICAgICAgICAgICA/IGxvd2VyY2FzZWROYW1lXG4gICAgICAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGlzRGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKSB7XG4gICAgICAvLyB0aGUgZXh0cmEgYXJndW1lbnQgXCIyXCIgaXMgdG8gZ2V0IHRoZSByaWdodCB0aGluZyBmb3IgYS5ocmVmIGluIElFLCBzZWUgalF1ZXJ5IGNvZGVcbiAgICAgIC8vIHNvbWUgZWxlbWVudHMgKGUuZy4gRG9jdW1lbnQpIGRvbid0IGhhdmUgZ2V0IGF0dHJpYnV0ZSwgc28gcmV0dXJuIHVuZGVmaW5lZFxuICAgICAgdmFyIHJldCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKG5hbWUsIDIpO1xuICAgICAgLy8gbm9ybWFsaXplIG5vbi1leGlzdGluZyBhdHRyaWJ1dGVzIHRvIHVuZGVmaW5lZCAoYXMgalF1ZXJ5KVxuICAgICAgcmV0dXJuIHJldCA9PT0gbnVsbCA/IHVuZGVmaW5lZCA6IHJldDtcbiAgICB9XG4gIH0sXG5cbiAgcHJvcDogZnVuY3Rpb24oZWxlbWVudCwgbmFtZSwgdmFsdWUpIHtcbiAgICBpZiAoaXNEZWZpbmVkKHZhbHVlKSkge1xuICAgICAgZWxlbWVudFtuYW1lXSA9IHZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZWxlbWVudFtuYW1lXTtcbiAgICB9XG4gIH0sXG5cbiAgdGV4dDogKGZ1bmN0aW9uKCkge1xuICAgIGdldFRleHQuJGR2ID0gJyc7XG4gICAgcmV0dXJuIGdldFRleHQ7XG5cbiAgICBmdW5jdGlvbiBnZXRUZXh0KGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgICBpZiAoaXNVbmRlZmluZWQodmFsdWUpKSB7XG4gICAgICAgIHZhciBub2RlVHlwZSA9IGVsZW1lbnQubm9kZVR5cGU7XG4gICAgICAgIHJldHVybiAobm9kZVR5cGUgPT09IE5PREVfVFlQRV9FTEVNRU5UIHx8IG5vZGVUeXBlID09PSBOT0RFX1RZUEVfVEVYVCkgPyBlbGVtZW50LnRleHRDb250ZW50IDogJyc7XG4gICAgICB9XG4gICAgICBlbGVtZW50LnRleHRDb250ZW50ID0gdmFsdWU7XG4gICAgfVxuICB9KSgpLFxuXG4gIHZhbDogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWUpIHtcbiAgICBpZiAoaXNVbmRlZmluZWQodmFsdWUpKSB7XG4gICAgICBpZiAoZWxlbWVudC5tdWx0aXBsZSAmJiBub2RlTmFtZV8oZWxlbWVudCkgPT09ICdzZWxlY3QnKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgZm9yRWFjaChlbGVtZW50Lm9wdGlvbnMsIGZ1bmN0aW9uKG9wdGlvbikge1xuICAgICAgICAgIGlmIChvcHRpb24uc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKG9wdGlvbi52YWx1ZSB8fCBvcHRpb24udGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPT09IDAgPyBudWxsIDogcmVzdWx0O1xuICAgICAgfVxuICAgICAgcmV0dXJuIGVsZW1lbnQudmFsdWU7XG4gICAgfVxuICAgIGVsZW1lbnQudmFsdWUgPSB2YWx1ZTtcbiAgfSxcblxuICBodG1sOiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZSkge1xuICAgIGlmIChpc1VuZGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiBlbGVtZW50LmlubmVySFRNTDtcbiAgICB9XG4gICAganFMaXRlRGVhbG9jKGVsZW1lbnQsIHRydWUpO1xuICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gdmFsdWU7XG4gIH0sXG5cbiAgZW1wdHk6IGpxTGl0ZUVtcHR5XG59LCBmdW5jdGlvbihmbiwgbmFtZSkge1xuICAvKipcbiAgICogUHJvcGVydGllczogd3JpdGVzIHJldHVybiBzZWxlY3Rpb24sIHJlYWRzIHJldHVybiBmaXJzdCB2YWx1ZVxuICAgKi9cbiAgSlFMaXRlLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKGFyZzEsIGFyZzIpIHtcbiAgICB2YXIgaSwga2V5O1xuICAgIHZhciBub2RlQ291bnQgPSB0aGlzLmxlbmd0aDtcblxuICAgIC8vIGpxTGl0ZUhhc0NsYXNzIGhhcyBvbmx5IHR3byBhcmd1bWVudHMsIGJ1dCBpcyBhIGdldHRlci1vbmx5IGZuLCBzbyB3ZSBuZWVkIHRvIHNwZWNpYWwtY2FzZSBpdFxuICAgIC8vIGluIGEgd2F5IHRoYXQgc3Vydml2ZXMgbWluaWZpY2F0aW9uLlxuICAgIC8vIGpxTGl0ZUVtcHR5IHRha2VzIG5vIGFyZ3VtZW50cyBidXQgaXMgYSBzZXR0ZXIuXG4gICAgaWYgKGZuICE9PSBqcUxpdGVFbXB0eSAmJlxuICAgICAgICAoaXNVbmRlZmluZWQoKGZuLmxlbmd0aCA9PSAyICYmIChmbiAhPT0ganFMaXRlSGFzQ2xhc3MgJiYgZm4gIT09IGpxTGl0ZUNvbnRyb2xsZXIpKSA/IGFyZzEgOiBhcmcyKSkpIHtcbiAgICAgIGlmIChpc09iamVjdChhcmcxKSkge1xuXG4gICAgICAgIC8vIHdlIGFyZSBhIHdyaXRlLCBidXQgdGhlIG9iamVjdCBwcm9wZXJ0aWVzIGFyZSB0aGUga2V5L3ZhbHVlc1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbm9kZUNvdW50OyBpKyspIHtcbiAgICAgICAgICBpZiAoZm4gPT09IGpxTGl0ZURhdGEpIHtcbiAgICAgICAgICAgIC8vIGRhdGEoKSB0YWtlcyB0aGUgd2hvbGUgb2JqZWN0IGluIGpRdWVyeVxuICAgICAgICAgICAgZm4odGhpc1tpXSwgYXJnMSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoa2V5IGluIGFyZzEpIHtcbiAgICAgICAgICAgICAgZm4odGhpc1tpXSwga2V5LCBhcmcxW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyByZXR1cm4gc2VsZiBmb3IgY2hhaW5pbmdcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyB3ZSBhcmUgYSByZWFkLCBzbyByZWFkIHRoZSBmaXJzdCBjaGlsZC5cbiAgICAgICAgLy8gVE9ETzogZG8gd2Ugc3RpbGwgbmVlZCB0aGlzP1xuICAgICAgICB2YXIgdmFsdWUgPSBmbi4kZHY7XG4gICAgICAgIC8vIE9ubHkgaWYgd2UgaGF2ZSAkZHYgZG8gd2UgaXRlcmF0ZSBvdmVyIGFsbCwgb3RoZXJ3aXNlIGl0IGlzIGp1c3QgdGhlIGZpcnN0IGVsZW1lbnQuXG4gICAgICAgIHZhciBqaiA9IChpc1VuZGVmaW5lZCh2YWx1ZSkpID8gTWF0aC5taW4obm9kZUNvdW50LCAxKSA6IG5vZGVDb3VudDtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBqajsgaisrKSB7XG4gICAgICAgICAgdmFyIG5vZGVWYWx1ZSA9IGZuKHRoaXNbal0sIGFyZzEsIGFyZzIpO1xuICAgICAgICAgIHZhbHVlID0gdmFsdWUgPyB2YWx1ZSArIG5vZGVWYWx1ZSA6IG5vZGVWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIHdlIGFyZSBhIHdyaXRlLCBzbyBhcHBseSB0byBhbGwgY2hpbGRyZW5cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBub2RlQ291bnQ7IGkrKykge1xuICAgICAgICBmbih0aGlzW2ldLCBhcmcxLCBhcmcyKTtcbiAgICAgIH1cbiAgICAgIC8vIHJldHVybiBzZWxmIGZvciBjaGFpbmluZ1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9O1xufSk7XG5cbmZ1bmN0aW9uIGNyZWF0ZUV2ZW50SGFuZGxlcihlbGVtZW50LCBldmVudHMpIHtcbiAgdmFyIGV2ZW50SGFuZGxlciA9IGZ1bmN0aW9uKGV2ZW50LCB0eXBlKSB7XG4gICAgLy8galF1ZXJ5IHNwZWNpZmljIGFwaVxuICAgIGV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQ7XG4gICAgfTtcblxuICAgIHZhciBldmVudEZucyA9IGV2ZW50c1t0eXBlIHx8IGV2ZW50LnR5cGVdO1xuICAgIHZhciBldmVudEZuc0xlbmd0aCA9IGV2ZW50Rm5zID8gZXZlbnRGbnMubGVuZ3RoIDogMDtcblxuICAgIGlmICghZXZlbnRGbnNMZW5ndGgpIHJldHVybjtcblxuICAgIGlmIChpc1VuZGVmaW5lZChldmVudC5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQpKSB7XG4gICAgICB2YXIgb3JpZ2luYWxTdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24gPSBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb247XG4gICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgZXZlbnQuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gdHJ1ZTtcblxuICAgICAgICBpZiAoZXZlbnQuc3RvcFByb3BhZ2F0aW9uKSB7XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3JpZ2luYWxTdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24pIHtcbiAgICAgICAgICBvcmlnaW5hbFN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbi5jYWxsKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBldmVudC5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGV2ZW50LmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9PT0gdHJ1ZTtcbiAgICB9O1xuXG4gICAgLy8gU29tZSBldmVudHMgaGF2ZSBzcGVjaWFsIGhhbmRsZXJzIHRoYXQgd3JhcCB0aGUgcmVhbCBoYW5kbGVyXG4gICAgdmFyIGhhbmRsZXJXcmFwcGVyID0gZXZlbnRGbnMuc3BlY2lhbEhhbmRsZXJXcmFwcGVyIHx8IGRlZmF1bHRIYW5kbGVyV3JhcHBlcjtcblxuICAgIC8vIENvcHkgZXZlbnQgaGFuZGxlcnMgaW4gY2FzZSBldmVudCBoYW5kbGVycyBhcnJheSBpcyBtb2RpZmllZCBkdXJpbmcgZXhlY3V0aW9uLlxuICAgIGlmICgoZXZlbnRGbnNMZW5ndGggPiAxKSkge1xuICAgICAgZXZlbnRGbnMgPSBzaGFsbG93Q29weShldmVudEZucyk7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudEZuc0xlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIWV2ZW50LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpIHtcbiAgICAgICAgaGFuZGxlcldyYXBwZXIoZWxlbWVudCwgZXZlbnQsIGV2ZW50Rm5zW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy8gVE9ETzogdGhpcyBpcyBhIGhhY2sgZm9yIGFuZ3VsYXJNb2Nrcy9jbGVhckRhdGFDYWNoZSB0aGF0IG1ha2VzIGl0IHBvc3NpYmxlIHRvIGRlcmVnaXN0ZXIgYWxsXG4gIC8vICAgICAgIGV2ZW50cyBvbiBgZWxlbWVudGBcbiAgZXZlbnRIYW5kbGVyLmVsZW0gPSBlbGVtZW50O1xuICByZXR1cm4gZXZlbnRIYW5kbGVyO1xufVxuXG5mdW5jdGlvbiBkZWZhdWx0SGFuZGxlcldyYXBwZXIoZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIpIHtcbiAgaGFuZGxlci5jYWxsKGVsZW1lbnQsIGV2ZW50KTtcbn1cblxuZnVuY3Rpb24gc3BlY2lhbE1vdXNlSGFuZGxlcldyYXBwZXIodGFyZ2V0LCBldmVudCwgaGFuZGxlcikge1xuICAvLyBSZWZlciB0byBqUXVlcnkncyBpbXBsZW1lbnRhdGlvbiBvZiBtb3VzZWVudGVyICYgbW91c2VsZWF2ZVxuICAvLyBSZWFkIGFib3V0IG1vdXNlZW50ZXIgYW5kIG1vdXNlbGVhdmU6XG4gIC8vIGh0dHA6Ly93d3cucXVpcmtzbW9kZS5vcmcvanMvZXZlbnRzX21vdXNlLmh0bWwjbGluazhcbiAgdmFyIHJlbGF0ZWQgPSBldmVudC5yZWxhdGVkVGFyZ2V0O1xuICAvLyBGb3IgbW91c2VudGVyL2xlYXZlIGNhbGwgdGhlIGhhbmRsZXIgaWYgcmVsYXRlZCBpcyBvdXRzaWRlIHRoZSB0YXJnZXQuXG4gIC8vIE5COiBObyByZWxhdGVkVGFyZ2V0IGlmIHRoZSBtb3VzZSBsZWZ0L2VudGVyZWQgdGhlIGJyb3dzZXIgd2luZG93XG4gIGlmICghcmVsYXRlZCB8fCAocmVsYXRlZCAhPT0gdGFyZ2V0ICYmICFqcUxpdGVDb250YWlucy5jYWxsKHRhcmdldCwgcmVsYXRlZCkpKSB7XG4gICAgaGFuZGxlci5jYWxsKHRhcmdldCwgZXZlbnQpO1xuICB9XG59XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gRnVuY3Rpb25zIGl0ZXJhdGluZyB0cmF2ZXJzYWwuXG4vLyBUaGVzZSBmdW5jdGlvbnMgY2hhaW4gcmVzdWx0cyBpbnRvIGEgc2luZ2xlXG4vLyBzZWxlY3Rvci5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuZm9yRWFjaCh7XG4gIHJlbW92ZURhdGE6IGpxTGl0ZVJlbW92ZURhdGEsXG5cbiAgb246IGZ1bmN0aW9uIGpxTGl0ZU9uKGVsZW1lbnQsIHR5cGUsIGZuLCB1bnN1cHBvcnRlZCkge1xuICAgIGlmIChpc0RlZmluZWQodW5zdXBwb3J0ZWQpKSB0aHJvdyBqcUxpdGVNaW5FcnIoJ29uYXJncycsICdqcUxpdGUjb24oKSBkb2VzIG5vdCBzdXBwb3J0IHRoZSBgc2VsZWN0b3JgIG9yIGBldmVudERhdGFgIHBhcmFtZXRlcnMnKTtcblxuICAgIC8vIERvIG5vdCBhZGQgZXZlbnQgaGFuZGxlcnMgdG8gbm9uLWVsZW1lbnRzIGJlY2F1c2UgdGhleSB3aWxsIG5vdCBiZSBjbGVhbmVkIHVwLlxuICAgIGlmICghanFMaXRlQWNjZXB0c0RhdGEoZWxlbWVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgZXhwYW5kb1N0b3JlID0ganFMaXRlRXhwYW5kb1N0b3JlKGVsZW1lbnQsIHRydWUpO1xuICAgIHZhciBldmVudHMgPSBleHBhbmRvU3RvcmUuZXZlbnRzO1xuICAgIHZhciBoYW5kbGUgPSBleHBhbmRvU3RvcmUuaGFuZGxlO1xuXG4gICAgaWYgKCFoYW5kbGUpIHtcbiAgICAgIGhhbmRsZSA9IGV4cGFuZG9TdG9yZS5oYW5kbGUgPSBjcmVhdGVFdmVudEhhbmRsZXIoZWxlbWVudCwgZXZlbnRzKTtcbiAgICB9XG5cbiAgICAvLyBodHRwOi8vanNwZXJmLmNvbS9zdHJpbmctaW5kZXhvZi12cy1zcGxpdFxuICAgIHZhciB0eXBlcyA9IHR5cGUuaW5kZXhPZignICcpID49IDAgPyB0eXBlLnNwbGl0KCcgJykgOiBbdHlwZV07XG4gICAgdmFyIGkgPSB0eXBlcy5sZW5ndGg7XG5cbiAgICB2YXIgYWRkSGFuZGxlciA9IGZ1bmN0aW9uKHR5cGUsIHNwZWNpYWxIYW5kbGVyV3JhcHBlciwgbm9FdmVudExpc3RlbmVyKSB7XG4gICAgICB2YXIgZXZlbnRGbnMgPSBldmVudHNbdHlwZV07XG5cbiAgICAgIGlmICghZXZlbnRGbnMpIHtcbiAgICAgICAgZXZlbnRGbnMgPSBldmVudHNbdHlwZV0gPSBbXTtcbiAgICAgICAgZXZlbnRGbnMuc3BlY2lhbEhhbmRsZXJXcmFwcGVyID0gc3BlY2lhbEhhbmRsZXJXcmFwcGVyO1xuICAgICAgICBpZiAodHlwZSAhPT0gJyRkZXN0cm95JyAmJiAhbm9FdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lckZuKGVsZW1lbnQsIHR5cGUsIGhhbmRsZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZXZlbnRGbnMucHVzaChmbik7XG4gICAgfTtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIHR5cGUgPSB0eXBlc1tpXTtcbiAgICAgIGlmIChNT1VTRV9FVkVOVF9NQVBbdHlwZV0pIHtcbiAgICAgICAgYWRkSGFuZGxlcihNT1VTRV9FVkVOVF9NQVBbdHlwZV0sIHNwZWNpYWxNb3VzZUhhbmRsZXJXcmFwcGVyKTtcbiAgICAgICAgYWRkSGFuZGxlcih0eXBlLCB1bmRlZmluZWQsIHRydWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWRkSGFuZGxlcih0eXBlKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgb2ZmOiBqcUxpdGVPZmYsXG5cbiAgb25lOiBmdW5jdGlvbihlbGVtZW50LCB0eXBlLCBmbikge1xuICAgIGVsZW1lbnQgPSBqcUxpdGUoZWxlbWVudCk7XG5cbiAgICAvL2FkZCB0aGUgbGlzdGVuZXIgdHdpY2Ugc28gdGhhdCB3aGVuIGl0IGlzIGNhbGxlZFxuICAgIC8veW91IGNhbiByZW1vdmUgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uIGFuZCBzdGlsbCBiZVxuICAgIC8vYWJsZSB0byBjYWxsIGVsZW1lbnQub2ZmKGV2LCBmbikgbm9ybWFsbHlcbiAgICBlbGVtZW50Lm9uKHR5cGUsIGZ1bmN0aW9uIG9uRm4oKSB7XG4gICAgICBlbGVtZW50Lm9mZih0eXBlLCBmbik7XG4gICAgICBlbGVtZW50Lm9mZih0eXBlLCBvbkZuKTtcbiAgICB9KTtcbiAgICBlbGVtZW50Lm9uKHR5cGUsIGZuKTtcbiAgfSxcblxuICByZXBsYWNlV2l0aDogZnVuY3Rpb24oZWxlbWVudCwgcmVwbGFjZU5vZGUpIHtcbiAgICB2YXIgaW5kZXgsIHBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcbiAgICBqcUxpdGVEZWFsb2MoZWxlbWVudCk7XG4gICAgZm9yRWFjaChuZXcgSlFMaXRlKHJlcGxhY2VOb2RlKSwgZnVuY3Rpb24obm9kZSkge1xuICAgICAgaWYgKGluZGV4KSB7XG4gICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUobm9kZSwgaW5kZXgubmV4dFNpYmxpbmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFyZW50LnJlcGxhY2VDaGlsZChub2RlLCBlbGVtZW50KTtcbiAgICAgIH1cbiAgICAgIGluZGV4ID0gbm9kZTtcbiAgICB9KTtcbiAgfSxcblxuICBjaGlsZHJlbjogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHZhciBjaGlsZHJlbiA9IFtdO1xuICAgIGZvckVhY2goZWxlbWVudC5jaGlsZE5vZGVzLCBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICBpZiAoZWxlbWVudC5ub2RlVHlwZSA9PT0gTk9ERV9UWVBFX0VMRU1FTlQpIHtcbiAgICAgICAgY2hpbGRyZW4ucHVzaChlbGVtZW50KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gY2hpbGRyZW47XG4gIH0sXG5cbiAgY29udGVudHM6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gZWxlbWVudC5jb250ZW50RG9jdW1lbnQgfHwgZWxlbWVudC5jaGlsZE5vZGVzIHx8IFtdO1xuICB9LFxuXG4gIGFwcGVuZDogZnVuY3Rpb24oZWxlbWVudCwgbm9kZSkge1xuICAgIHZhciBub2RlVHlwZSA9IGVsZW1lbnQubm9kZVR5cGU7XG4gICAgaWYgKG5vZGVUeXBlICE9PSBOT0RFX1RZUEVfRUxFTUVOVCAmJiBub2RlVHlwZSAhPT0gTk9ERV9UWVBFX0RPQ1VNRU5UX0ZSQUdNRU5UKSByZXR1cm47XG5cbiAgICBub2RlID0gbmV3IEpRTGl0ZShub2RlKTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IG5vZGUubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgdmFyIGNoaWxkID0gbm9kZVtpXTtcbiAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuICAgIH1cbiAgfSxcblxuICBwcmVwZW5kOiBmdW5jdGlvbihlbGVtZW50LCBub2RlKSB7XG4gICAgaWYgKGVsZW1lbnQubm9kZVR5cGUgPT09IE5PREVfVFlQRV9FTEVNRU5UKSB7XG4gICAgICB2YXIgaW5kZXggPSBlbGVtZW50LmZpcnN0Q2hpbGQ7XG4gICAgICBmb3JFYWNoKG5ldyBKUUxpdGUobm9kZSksIGZ1bmN0aW9uKGNoaWxkKSB7XG4gICAgICAgIGVsZW1lbnQuaW5zZXJ0QmVmb3JlKGNoaWxkLCBpbmRleCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgd3JhcDogZnVuY3Rpb24oZWxlbWVudCwgd3JhcE5vZGUpIHtcbiAgICBqcUxpdGVXcmFwTm9kZShlbGVtZW50LCBqcUxpdGUod3JhcE5vZGUpLmVxKDApLmNsb25lKClbMF0pO1xuICB9LFxuXG4gIHJlbW92ZToganFMaXRlUmVtb3ZlLFxuXG4gIGRldGFjaDogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGpxTGl0ZVJlbW92ZShlbGVtZW50LCB0cnVlKTtcbiAgfSxcblxuICBhZnRlcjogZnVuY3Rpb24oZWxlbWVudCwgbmV3RWxlbWVudCkge1xuICAgIHZhciBpbmRleCA9IGVsZW1lbnQsIHBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcbiAgICBuZXdFbGVtZW50ID0gbmV3IEpRTGl0ZShuZXdFbGVtZW50KTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IG5ld0VsZW1lbnQubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgdmFyIG5vZGUgPSBuZXdFbGVtZW50W2ldO1xuICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShub2RlLCBpbmRleC5uZXh0U2libGluZyk7XG4gICAgICBpbmRleCA9IG5vZGU7XG4gICAgfVxuICB9LFxuXG4gIGFkZENsYXNzOiBqcUxpdGVBZGRDbGFzcyxcbiAgcmVtb3ZlQ2xhc3M6IGpxTGl0ZVJlbW92ZUNsYXNzLFxuXG4gIHRvZ2dsZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBzZWxlY3RvciwgY29uZGl0aW9uKSB7XG4gICAgaWYgKHNlbGVjdG9yKSB7XG4gICAgICBmb3JFYWNoKHNlbGVjdG9yLnNwbGl0KCcgJyksIGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xuICAgICAgICB2YXIgY2xhc3NDb25kaXRpb24gPSBjb25kaXRpb247XG4gICAgICAgIGlmIChpc1VuZGVmaW5lZChjbGFzc0NvbmRpdGlvbikpIHtcbiAgICAgICAgICBjbGFzc0NvbmRpdGlvbiA9ICFqcUxpdGVIYXNDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpO1xuICAgICAgICB9XG4gICAgICAgIChjbGFzc0NvbmRpdGlvbiA/IGpxTGl0ZUFkZENsYXNzIDoganFMaXRlUmVtb3ZlQ2xhc3MpKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgcGFyZW50OiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgdmFyIHBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcbiAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5ub2RlVHlwZSAhPT0gTk9ERV9UWVBFX0RPQ1VNRU5UX0ZSQUdNRU5UID8gcGFyZW50IDogbnVsbDtcbiAgfSxcblxuICBuZXh0OiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nO1xuICB9LFxuXG4gIGZpbmQ6IGZ1bmN0aW9uKGVsZW1lbnQsIHNlbGVjdG9yKSB7XG4gICAgaWYgKGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUpIHtcbiAgICAgIHJldHVybiBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKHNlbGVjdG9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfSxcblxuICBjbG9uZToganFMaXRlQ2xvbmUsXG5cbiAgdHJpZ2dlckhhbmRsZXI6IGZ1bmN0aW9uKGVsZW1lbnQsIGV2ZW50LCBleHRyYVBhcmFtZXRlcnMpIHtcblxuICAgIHZhciBkdW1teUV2ZW50LCBldmVudEZuc0NvcHksIGhhbmRsZXJBcmdzO1xuICAgIHZhciBldmVudE5hbWUgPSBldmVudC50eXBlIHx8IGV2ZW50O1xuICAgIHZhciBleHBhbmRvU3RvcmUgPSBqcUxpdGVFeHBhbmRvU3RvcmUoZWxlbWVudCk7XG4gICAgdmFyIGV2ZW50cyA9IGV4cGFuZG9TdG9yZSAmJiBleHBhbmRvU3RvcmUuZXZlbnRzO1xuICAgIHZhciBldmVudEZucyA9IGV2ZW50cyAmJiBldmVudHNbZXZlbnROYW1lXTtcblxuICAgIGlmIChldmVudEZucykge1xuICAgICAgLy8gQ3JlYXRlIGEgZHVtbXkgZXZlbnQgdG8gcGFzcyB0byB0aGUgaGFuZGxlcnNcbiAgICAgIGR1bW15RXZlbnQgPSB7XG4gICAgICAgIHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbigpIHsgdGhpcy5kZWZhdWx0UHJldmVudGVkID0gdHJ1ZTsgfSxcbiAgICAgICAgaXNEZWZhdWx0UHJldmVudGVkOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuZGVmYXVsdFByZXZlbnRlZCA9PT0gdHJ1ZTsgfSxcbiAgICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOiBmdW5jdGlvbigpIHsgdGhpcy5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSB0cnVlOyB9LFxuICAgICAgICBpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9PT0gdHJ1ZTsgfSxcbiAgICAgICAgc3RvcFByb3BhZ2F0aW9uOiBub29wLFxuICAgICAgICB0eXBlOiBldmVudE5hbWUsXG4gICAgICAgIHRhcmdldDogZWxlbWVudFxuICAgICAgfTtcblxuICAgICAgLy8gSWYgYSBjdXN0b20gZXZlbnQgd2FzIHByb3ZpZGVkIHRoZW4gZXh0ZW5kIG91ciBkdW1teSBldmVudCB3aXRoIGl0XG4gICAgICBpZiAoZXZlbnQudHlwZSkge1xuICAgICAgICBkdW1teUV2ZW50ID0gZXh0ZW5kKGR1bW15RXZlbnQsIGV2ZW50KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ29weSBldmVudCBoYW5kbGVycyBpbiBjYXNlIGV2ZW50IGhhbmRsZXJzIGFycmF5IGlzIG1vZGlmaWVkIGR1cmluZyBleGVjdXRpb24uXG4gICAgICBldmVudEZuc0NvcHkgPSBzaGFsbG93Q29weShldmVudEZucyk7XG4gICAgICBoYW5kbGVyQXJncyA9IGV4dHJhUGFyYW1ldGVycyA/IFtkdW1teUV2ZW50XS5jb25jYXQoZXh0cmFQYXJhbWV0ZXJzKSA6IFtkdW1teUV2ZW50XTtcblxuICAgICAgZm9yRWFjaChldmVudEZuc0NvcHksIGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgIGlmICghZHVtbXlFdmVudC5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpKSB7XG4gICAgICAgICAgZm4uYXBwbHkoZWxlbWVudCwgaGFuZGxlckFyZ3MpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0sIGZ1bmN0aW9uKGZuLCBuYW1lKSB7XG4gIC8qKlxuICAgKiBjaGFpbmluZyBmdW5jdGlvbnNcbiAgICovXG4gIEpRTGl0ZS5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbihhcmcxLCBhcmcyLCBhcmczKSB7XG4gICAgdmFyIHZhbHVlO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICBpZiAoaXNVbmRlZmluZWQodmFsdWUpKSB7XG4gICAgICAgIHZhbHVlID0gZm4odGhpc1tpXSwgYXJnMSwgYXJnMiwgYXJnMyk7XG4gICAgICAgIGlmIChpc0RlZmluZWQodmFsdWUpKSB7XG4gICAgICAgICAgLy8gYW55IGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYSB2YWx1ZSBuZWVkcyB0byBiZSB3cmFwcGVkXG4gICAgICAgICAgdmFsdWUgPSBqcUxpdGUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBqcUxpdGVBZGROb2Rlcyh2YWx1ZSwgZm4odGhpc1tpXSwgYXJnMSwgYXJnMiwgYXJnMykpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaXNEZWZpbmVkKHZhbHVlKSA/IHZhbHVlIDogdGhpcztcbiAgfTtcblxuICAvLyBiaW5kIGxlZ2FjeSBiaW5kL3VuYmluZCB0byBvbi9vZmZcbiAgSlFMaXRlLnByb3RvdHlwZS5iaW5kID0gSlFMaXRlLnByb3RvdHlwZS5vbjtcbiAgSlFMaXRlLnByb3RvdHlwZS51bmJpbmQgPSBKUUxpdGUucHJvdG90eXBlLm9mZjtcbn0pO1xuXG5cbi8vIFByb3ZpZGVyIGZvciBwcml2YXRlICQkanFMaXRlIHNlcnZpY2VcbmZ1bmN0aW9uICQkanFMaXRlUHJvdmlkZXIoKSB7XG4gIHRoaXMuJGdldCA9IGZ1bmN0aW9uICQkanFMaXRlKCkge1xuICAgIHJldHVybiBleHRlbmQoSlFMaXRlLCB7XG4gICAgICBoYXNDbGFzczogZnVuY3Rpb24obm9kZSwgY2xhc3Nlcykge1xuICAgICAgICBpZiAobm9kZS5hdHRyKSBub2RlID0gbm9kZVswXTtcbiAgICAgICAgcmV0dXJuIGpxTGl0ZUhhc0NsYXNzKG5vZGUsIGNsYXNzZXMpO1xuICAgICAgfSxcbiAgICAgIGFkZENsYXNzOiBmdW5jdGlvbihub2RlLCBjbGFzc2VzKSB7XG4gICAgICAgIGlmIChub2RlLmF0dHIpIG5vZGUgPSBub2RlWzBdO1xuICAgICAgICByZXR1cm4ganFMaXRlQWRkQ2xhc3Mobm9kZSwgY2xhc3Nlcyk7XG4gICAgICB9LFxuICAgICAgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKG5vZGUsIGNsYXNzZXMpIHtcbiAgICAgICAgaWYgKG5vZGUuYXR0cikgbm9kZSA9IG5vZGVbMF07XG4gICAgICAgIHJldHVybiBqcUxpdGVSZW1vdmVDbGFzcyhub2RlLCBjbGFzc2VzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbn1cblxuLyoqXG4gKiBDb21wdXRlcyBhIGhhc2ggb2YgYW4gJ29iaicuXG4gKiBIYXNoIG9mIGE6XG4gKiAgc3RyaW5nIGlzIHN0cmluZ1xuICogIG51bWJlciBpcyBudW1iZXIgYXMgc3RyaW5nXG4gKiAgb2JqZWN0IGlzIGVpdGhlciByZXN1bHQgb2YgY2FsbGluZyAkJGhhc2hLZXkgZnVuY3Rpb24gb24gdGhlIG9iamVjdCBvciB1bmlxdWVseSBnZW5lcmF0ZWQgaWQsXG4gKiAgICAgICAgIHRoYXQgaXMgYWxzbyBhc3NpZ25lZCB0byB0aGUgJCRoYXNoS2V5IHByb3BlcnR5IG9mIHRoZSBvYmplY3QuXG4gKlxuICogQHBhcmFtIG9ialxuICogQHJldHVybnMge3N0cmluZ30gaGFzaCBzdHJpbmcgc3VjaCB0aGF0IHRoZSBzYW1lIGlucHV0IHdpbGwgaGF2ZSB0aGUgc2FtZSBoYXNoIHN0cmluZy5cbiAqICAgICAgICAgVGhlIHJlc3VsdGluZyBzdHJpbmcga2V5IGlzIGluICd0eXBlOmhhc2hLZXknIGZvcm1hdC5cbiAqL1xuZnVuY3Rpb24gaGFzaEtleShvYmosIG5leHRVaWRGbikge1xuICB2YXIga2V5ID0gb2JqICYmIG9iai4kJGhhc2hLZXk7XG5cbiAgaWYgKGtleSkge1xuICAgIGlmICh0eXBlb2Yga2V5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBrZXkgPSBvYmouJCRoYXNoS2V5KCk7XG4gICAgfVxuICAgIHJldHVybiBrZXk7XG4gIH1cblxuICB2YXIgb2JqVHlwZSA9IHR5cGVvZiBvYmo7XG4gIGlmIChvYmpUeXBlID09ICdmdW5jdGlvbicgfHwgKG9ialR5cGUgPT0gJ29iamVjdCcgJiYgb2JqICE9PSBudWxsKSkge1xuICAgIGtleSA9IG9iai4kJGhhc2hLZXkgPSBvYmpUeXBlICsgJzonICsgKG5leHRVaWRGbiB8fCBuZXh0VWlkKSgpO1xuICB9IGVsc2Uge1xuICAgIGtleSA9IG9ialR5cGUgKyAnOicgKyBvYmo7XG4gIH1cblxuICByZXR1cm4ga2V5O1xufVxuXG4vKipcbiAqIEhhc2hNYXAgd2hpY2ggY2FuIHVzZSBvYmplY3RzIGFzIGtleXNcbiAqL1xuZnVuY3Rpb24gSGFzaE1hcChhcnJheSwgaXNvbGF0ZWRVaWQpIHtcbiAgaWYgKGlzb2xhdGVkVWlkKSB7XG4gICAgdmFyIHVpZCA9IDA7XG4gICAgdGhpcy5uZXh0VWlkID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gKyt1aWQ7XG4gICAgfTtcbiAgfVxuICBmb3JFYWNoKGFycmF5LCB0aGlzLnB1dCwgdGhpcyk7XG59XG5IYXNoTWFwLnByb3RvdHlwZSA9IHtcbiAgLyoqXG4gICAqIFN0b3JlIGtleSB2YWx1ZSBwYWlyXG4gICAqIEBwYXJhbSBrZXkga2V5IHRvIHN0b3JlIGNhbiBiZSBhbnkgdHlwZVxuICAgKiBAcGFyYW0gdmFsdWUgdmFsdWUgdG8gc3RvcmUgY2FuIGJlIGFueSB0eXBlXG4gICAqL1xuICBwdXQ6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICB0aGlzW2hhc2hLZXkoa2V5LCB0aGlzLm5leHRVaWQpXSA9IHZhbHVlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBAcGFyYW0ga2V5XG4gICAqIEByZXR1cm5zIHtPYmplY3R9IHRoZSB2YWx1ZSBmb3IgdGhlIGtleVxuICAgKi9cbiAgZ2V0OiBmdW5jdGlvbihrZXkpIHtcbiAgICByZXR1cm4gdGhpc1toYXNoS2V5KGtleSwgdGhpcy5uZXh0VWlkKV07XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUga2V5L3ZhbHVlIHBhaXJcbiAgICogQHBhcmFtIGtleVxuICAgKi9cbiAgcmVtb3ZlOiBmdW5jdGlvbihrZXkpIHtcbiAgICB2YXIgdmFsdWUgPSB0aGlzW2tleSA9IGhhc2hLZXkoa2V5LCB0aGlzLm5leHRVaWQpXTtcbiAgICBkZWxldGUgdGhpc1trZXldO1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxufTtcblxudmFyICQkSGFzaE1hcFByb3ZpZGVyID0gW2Z1bmN0aW9uKCkge1xuICB0aGlzLiRnZXQgPSBbZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIEhhc2hNYXA7XG4gIH1dO1xufV07XG5cbi8qKlxuICogQG5nZG9jIGZ1bmN0aW9uXG4gKiBAbW9kdWxlIG5nXG4gKiBAbmFtZSBhbmd1bGFyLmluamVjdG9yXG4gKiBAa2luZCBmdW5jdGlvblxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQ3JlYXRlcyBhbiBpbmplY3RvciBvYmplY3QgdGhhdCBjYW4gYmUgdXNlZCBmb3IgcmV0cmlldmluZyBzZXJ2aWNlcyBhcyB3ZWxsIGFzIGZvclxuICogZGVwZW5kZW5jeSBpbmplY3Rpb24gKHNlZSB7QGxpbmsgZ3VpZGUvZGkgZGVwZW5kZW5jeSBpbmplY3Rpb259KS5cbiAqXG4gKiBAcGFyYW0ge0FycmF5LjxzdHJpbmd8RnVuY3Rpb24+fSBtb2R1bGVzIEEgbGlzdCBvZiBtb2R1bGUgZnVuY3Rpb25zIG9yIHRoZWlyIGFsaWFzZXMuIFNlZVxuICogICAgIHtAbGluayBhbmd1bGFyLm1vZHVsZX0uIFRoZSBgbmdgIG1vZHVsZSBtdXN0IGJlIGV4cGxpY2l0bHkgYWRkZWQuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBbc3RyaWN0RGk9ZmFsc2VdIFdoZXRoZXIgdGhlIGluamVjdG9yIHNob3VsZCBiZSBpbiBzdHJpY3QgbW9kZSwgd2hpY2hcbiAqICAgICBkaXNhbGxvd3MgYXJndW1lbnQgbmFtZSBhbm5vdGF0aW9uIGluZmVyZW5jZS5cbiAqIEByZXR1cm5zIHtpbmplY3Rvcn0gSW5qZWN0b3Igb2JqZWN0LiBTZWUge0BsaW5rIGF1dG8uJGluamVjdG9yICRpbmplY3Rvcn0uXG4gKlxuICogQGV4YW1wbGVcbiAqIFR5cGljYWwgdXNhZ2VcbiAqIGBgYGpzXG4gKiAgIC8vIGNyZWF0ZSBhbiBpbmplY3RvclxuICogICB2YXIgJGluamVjdG9yID0gYW5ndWxhci5pbmplY3RvcihbJ25nJ10pO1xuICpcbiAqICAgLy8gdXNlIHRoZSBpbmplY3RvciB0byBraWNrIG9mZiB5b3VyIGFwcGxpY2F0aW9uXG4gKiAgIC8vIHVzZSB0aGUgdHlwZSBpbmZlcmVuY2UgdG8gYXV0byBpbmplY3QgYXJndW1lbnRzLCBvciB1c2UgaW1wbGljaXQgaW5qZWN0aW9uXG4gKiAgICRpbmplY3Rvci5pbnZva2UoZnVuY3Rpb24oJHJvb3RTY29wZSwgJGNvbXBpbGUsICRkb2N1bWVudCkge1xuICogICAgICRjb21waWxlKCRkb2N1bWVudCkoJHJvb3RTY29wZSk7XG4gKiAgICAgJHJvb3RTY29wZS4kZGlnZXN0KCk7XG4gKiAgIH0pO1xuICogYGBgXG4gKlxuICogU29tZXRpbWVzIHlvdSB3YW50IHRvIGdldCBhY2Nlc3MgdG8gdGhlIGluamVjdG9yIG9mIGEgY3VycmVudGx5IHJ1bm5pbmcgQW5ndWxhciBhcHBcbiAqIGZyb20gb3V0c2lkZSBBbmd1bGFyLiBQZXJoYXBzLCB5b3Ugd2FudCB0byBpbmplY3QgYW5kIGNvbXBpbGUgc29tZSBtYXJrdXAgYWZ0ZXIgdGhlXG4gKiBhcHBsaWNhdGlvbiBoYXMgYmVlbiBib290c3RyYXBwZWQuIFlvdSBjYW4gZG8gdGhpcyB1c2luZyB0aGUgZXh0cmEgYGluamVjdG9yKClgIGFkZGVkXG4gKiB0byBKUXVlcnkvanFMaXRlIGVsZW1lbnRzLiBTZWUge0BsaW5rIGFuZ3VsYXIuZWxlbWVudH0uXG4gKlxuICogKlRoaXMgaXMgZmFpcmx5IHJhcmUgYnV0IGNvdWxkIGJlIHRoZSBjYXNlIGlmIGEgdGhpcmQgcGFydHkgbGlicmFyeSBpcyBpbmplY3RpbmcgdGhlXG4gKiBtYXJrdXAuKlxuICpcbiAqIEluIHRoZSBmb2xsb3dpbmcgZXhhbXBsZSBhIG5ldyBibG9jayBvZiBIVE1MIGNvbnRhaW5pbmcgYSBgbmctY29udHJvbGxlcmBcbiAqIGRpcmVjdGl2ZSBpcyBhZGRlZCB0byB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudCBib2R5IGJ5IEpRdWVyeS4gV2UgdGhlbiBjb21waWxlIGFuZCBsaW5rXG4gKiBpdCBpbnRvIHRoZSBjdXJyZW50IEFuZ3VsYXJKUyBzY29wZS5cbiAqXG4gKiBgYGBqc1xuICogdmFyICRkaXYgPSAkKCc8ZGl2IG5nLWNvbnRyb2xsZXI9XCJNeUN0cmxcIj57e2NvbnRlbnQubGFiZWx9fTwvZGl2PicpO1xuICogJChkb2N1bWVudC5ib2R5KS5hcHBlbmQoJGRpdik7XG4gKlxuICogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5pbmplY3RvcigpLmludm9rZShmdW5jdGlvbigkY29tcGlsZSkge1xuICogICB2YXIgc2NvcGUgPSBhbmd1bGFyLmVsZW1lbnQoJGRpdikuc2NvcGUoKTtcbiAqICAgJGNvbXBpbGUoJGRpdikoc2NvcGUpO1xuICogfSk7XG4gKiBgYGBcbiAqL1xuXG5cbi8qKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgYXV0b1xuICogQGRlc2NyaXB0aW9uXG4gKlxuICogSW1wbGljaXQgbW9kdWxlIHdoaWNoIGdldHMgYXV0b21hdGljYWxseSBhZGRlZCB0byBlYWNoIHtAbGluayBhdXRvLiRpbmplY3RvciAkaW5qZWN0b3J9LlxuICovXG5cbnZhciBBUlJPV19BUkcgPSAvXihbXlxcKF0rPyk9Pi87XG52YXIgRk5fQVJHUyA9IC9eW15cXChdKlxcKFxccyooW15cXCldKilcXCkvbTtcbnZhciBGTl9BUkdfU1BMSVQgPSAvLC87XG52YXIgRk5fQVJHID0gL15cXHMqKF8/KShcXFMrPylcXDFcXHMqJC87XG52YXIgU1RSSVBfQ09NTUVOVFMgPSAvKChcXC9cXC8uKiQpfChcXC9cXCpbXFxzXFxTXSo/XFwqXFwvKSkvbWc7XG52YXIgJGluamVjdG9yTWluRXJyID0gbWluRXJyKCckaW5qZWN0b3InKTtcblxuZnVuY3Rpb24gZXh0cmFjdEFyZ3MoZm4pIHtcbiAgdmFyIGZuVGV4dCA9IGZuLnRvU3RyaW5nKCkucmVwbGFjZShTVFJJUF9DT01NRU5UUywgJycpLFxuICAgICAgYXJncyA9IGZuVGV4dC5tYXRjaChBUlJPV19BUkcpIHx8IGZuVGV4dC5tYXRjaChGTl9BUkdTKTtcbiAgcmV0dXJuIGFyZ3M7XG59XG5cbmZ1bmN0aW9uIGFub25Gbihmbikge1xuICAvLyBGb3IgYW5vbnltb3VzIGZ1bmN0aW9ucywgc2hvd2luZyBhdCB0aGUgdmVyeSBsZWFzdCB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlIGNhbiBoZWxwIGluXG4gIC8vIGRlYnVnZ2luZy5cbiAgdmFyIGFyZ3MgPSBleHRyYWN0QXJncyhmbik7XG4gIGlmIChhcmdzKSB7XG4gICAgcmV0dXJuICdmdW5jdGlvbignICsgKGFyZ3NbMV0gfHwgJycpLnJlcGxhY2UoL1tcXHNcXHJcXG5dKy8sICcgJykgKyAnKSc7XG4gIH1cbiAgcmV0dXJuICdmbic7XG59XG5cbmZ1bmN0aW9uIGFubm90YXRlKGZuLCBzdHJpY3REaSwgbmFtZSkge1xuICB2YXIgJGluamVjdCxcbiAgICAgIGFyZ0RlY2wsXG4gICAgICBsYXN0O1xuXG4gIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICBpZiAoISgkaW5qZWN0ID0gZm4uJGluamVjdCkpIHtcbiAgICAgICRpbmplY3QgPSBbXTtcbiAgICAgIGlmIChmbi5sZW5ndGgpIHtcbiAgICAgICAgaWYgKHN0cmljdERpKSB7XG4gICAgICAgICAgaWYgKCFpc1N0cmluZyhuYW1lKSB8fCAhbmFtZSkge1xuICAgICAgICAgICAgbmFtZSA9IGZuLm5hbWUgfHwgYW5vbkZuKGZuKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhyb3cgJGluamVjdG9yTWluRXJyKCdzdHJpY3RkaScsXG4gICAgICAgICAgICAnezB9IGlzIG5vdCB1c2luZyBleHBsaWNpdCBhbm5vdGF0aW9uIGFuZCBjYW5ub3QgYmUgaW52b2tlZCBpbiBzdHJpY3QgbW9kZScsIG5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGFyZ0RlY2wgPSBleHRyYWN0QXJncyhmbik7XG4gICAgICAgIGZvckVhY2goYXJnRGVjbFsxXS5zcGxpdChGTl9BUkdfU1BMSVQpLCBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgICBhcmcucmVwbGFjZShGTl9BUkcsIGZ1bmN0aW9uKGFsbCwgdW5kZXJzY29yZSwgbmFtZSkge1xuICAgICAgICAgICAgJGluamVjdC5wdXNoKG5hbWUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGZuLiRpbmplY3QgPSAkaW5qZWN0O1xuICAgIH1cbiAgfSBlbHNlIGlmIChpc0FycmF5KGZuKSkge1xuICAgIGxhc3QgPSBmbi5sZW5ndGggLSAxO1xuICAgIGFzc2VydEFyZ0ZuKGZuW2xhc3RdLCAnZm4nKTtcbiAgICAkaW5qZWN0ID0gZm4uc2xpY2UoMCwgbGFzdCk7XG4gIH0gZWxzZSB7XG4gICAgYXNzZXJ0QXJnRm4oZm4sICdmbicsIHRydWUpO1xuICB9XG4gIHJldHVybiAkaW5qZWN0O1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuLyoqXG4gKiBAbmdkb2Mgc2VydmljZVxuICogQG5hbWUgJGluamVjdG9yXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogYCRpbmplY3RvcmAgaXMgdXNlZCB0byByZXRyaWV2ZSBvYmplY3QgaW5zdGFuY2VzIGFzIGRlZmluZWQgYnlcbiAqIHtAbGluayBhdXRvLiRwcm92aWRlIHByb3ZpZGVyfSwgaW5zdGFudGlhdGUgdHlwZXMsIGludm9rZSBtZXRob2RzLFxuICogYW5kIGxvYWQgbW9kdWxlcy5cbiAqXG4gKiBUaGUgZm9sbG93aW5nIGFsd2F5cyBob2xkcyB0cnVlOlxuICpcbiAqIGBgYGpzXG4gKiAgIHZhciAkaW5qZWN0b3IgPSBhbmd1bGFyLmluamVjdG9yKCk7XG4gKiAgIGV4cGVjdCgkaW5qZWN0b3IuZ2V0KCckaW5qZWN0b3InKSkudG9CZSgkaW5qZWN0b3IpO1xuICogICBleHBlY3QoJGluamVjdG9yLmludm9rZShmdW5jdGlvbigkaW5qZWN0b3IpIHtcbiAqICAgICByZXR1cm4gJGluamVjdG9yO1xuICogICB9KSkudG9CZSgkaW5qZWN0b3IpO1xuICogYGBgXG4gKlxuICogIyBJbmplY3Rpb24gRnVuY3Rpb24gQW5ub3RhdGlvblxuICpcbiAqIEphdmFTY3JpcHQgZG9lcyBub3QgaGF2ZSBhbm5vdGF0aW9ucywgYW5kIGFubm90YXRpb25zIGFyZSBuZWVkZWQgZm9yIGRlcGVuZGVuY3kgaW5qZWN0aW9uLiBUaGVcbiAqIGZvbGxvd2luZyBhcmUgYWxsIHZhbGlkIHdheXMgb2YgYW5ub3RhdGluZyBmdW5jdGlvbiB3aXRoIGluamVjdGlvbiBhcmd1bWVudHMgYW5kIGFyZSBlcXVpdmFsZW50LlxuICpcbiAqIGBgYGpzXG4gKiAgIC8vIGluZmVycmVkIChvbmx5IHdvcmtzIGlmIGNvZGUgbm90IG1pbmlmaWVkL29iZnVzY2F0ZWQpXG4gKiAgICRpbmplY3Rvci5pbnZva2UoZnVuY3Rpb24oc2VydmljZUEpe30pO1xuICpcbiAqICAgLy8gYW5ub3RhdGVkXG4gKiAgIGZ1bmN0aW9uIGV4cGxpY2l0KHNlcnZpY2VBKSB7fTtcbiAqICAgZXhwbGljaXQuJGluamVjdCA9IFsnc2VydmljZUEnXTtcbiAqICAgJGluamVjdG9yLmludm9rZShleHBsaWNpdCk7XG4gKlxuICogICAvLyBpbmxpbmVcbiAqICAgJGluamVjdG9yLmludm9rZShbJ3NlcnZpY2VBJywgZnVuY3Rpb24oc2VydmljZUEpe31dKTtcbiAqIGBgYFxuICpcbiAqICMjIEluZmVyZW5jZVxuICpcbiAqIEluIEphdmFTY3JpcHQgY2FsbGluZyBgdG9TdHJpbmcoKWAgb24gYSBmdW5jdGlvbiByZXR1cm5zIHRoZSBmdW5jdGlvbiBkZWZpbml0aW9uLiBUaGUgZGVmaW5pdGlvblxuICogY2FuIHRoZW4gYmUgcGFyc2VkIGFuZCB0aGUgZnVuY3Rpb24gYXJndW1lbnRzIGNhbiBiZSBleHRyYWN0ZWQuIFRoaXMgbWV0aG9kIG9mIGRpc2NvdmVyaW5nXG4gKiBhbm5vdGF0aW9ucyBpcyBkaXNhbGxvd2VkIHdoZW4gdGhlIGluamVjdG9yIGlzIGluIHN0cmljdCBtb2RlLlxuICogKk5PVEU6KiBUaGlzIGRvZXMgbm90IHdvcmsgd2l0aCBtaW5pZmljYXRpb24sIGFuZCBvYmZ1c2NhdGlvbiB0b29scyBzaW5jZSB0aGVzZSB0b29scyBjaGFuZ2UgdGhlXG4gKiBhcmd1bWVudCBuYW1lcy5cbiAqXG4gKiAjIyBgJGluamVjdGAgQW5ub3RhdGlvblxuICogQnkgYWRkaW5nIGFuIGAkaW5qZWN0YCBwcm9wZXJ0eSBvbnRvIGEgZnVuY3Rpb24gdGhlIGluamVjdGlvbiBwYXJhbWV0ZXJzIGNhbiBiZSBzcGVjaWZpZWQuXG4gKlxuICogIyMgSW5saW5lXG4gKiBBcyBhbiBhcnJheSBvZiBpbmplY3Rpb24gbmFtZXMsIHdoZXJlIHRoZSBsYXN0IGl0ZW0gaW4gdGhlIGFycmF5IGlzIHRoZSBmdW5jdGlvbiB0byBjYWxsLlxuICovXG5cbi8qKlxuICogQG5nZG9jIG1ldGhvZFxuICogQG5hbWUgJGluamVjdG9yI2dldFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogUmV0dXJuIGFuIGluc3RhbmNlIG9mIHRoZSBzZXJ2aWNlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBpbnN0YW5jZSB0byByZXRyaWV2ZS5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gY2FsbGVyIEFuIG9wdGlvbmFsIHN0cmluZyB0byBwcm92aWRlIHRoZSBvcmlnaW4gb2YgdGhlIGZ1bmN0aW9uIGNhbGwgZm9yIGVycm9yIG1lc3NhZ2VzLlxuICogQHJldHVybiB7Kn0gVGhlIGluc3RhbmNlLlxuICovXG5cbi8qKlxuICogQG5nZG9jIG1ldGhvZFxuICogQG5hbWUgJGluamVjdG9yI2ludm9rZVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogSW52b2tlIHRoZSBtZXRob2QgYW5kIHN1cHBseSB0aGUgbWV0aG9kIGFyZ3VtZW50cyBmcm9tIHRoZSBgJGluamVjdG9yYC5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufEFycmF5LjxzdHJpbmd8RnVuY3Rpb24+fSBmbiBUaGUgaW5qZWN0YWJsZSBmdW5jdGlvbiB0byBpbnZva2UuIEZ1bmN0aW9uIHBhcmFtZXRlcnMgYXJlXG4gKiAgIGluamVjdGVkIGFjY29yZGluZyB0byB0aGUge0BsaW5rIGd1aWRlL2RpICRpbmplY3QgQW5ub3RhdGlvbn0gcnVsZXMuXG4gKiBAcGFyYW0ge09iamVjdD19IHNlbGYgVGhlIGB0aGlzYCBmb3IgdGhlIGludm9rZWQgbWV0aG9kLlxuICogQHBhcmFtIHtPYmplY3Q9fSBsb2NhbHMgT3B0aW9uYWwgb2JqZWN0LiBJZiBwcmVzZXQgdGhlbiBhbnkgYXJndW1lbnQgbmFtZXMgYXJlIHJlYWQgZnJvbSB0aGlzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgZmlyc3QsIGJlZm9yZSB0aGUgYCRpbmplY3RvcmAgaXMgY29uc3VsdGVkLlxuICogQHJldHVybnMgeyp9IHRoZSB2YWx1ZSByZXR1cm5lZCBieSB0aGUgaW52b2tlZCBgZm5gIGZ1bmN0aW9uLlxuICovXG5cbi8qKlxuICogQG5nZG9jIG1ldGhvZFxuICogQG5hbWUgJGluamVjdG9yI2hhc1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQWxsb3dzIHRoZSB1c2VyIHRvIHF1ZXJ5IGlmIHRoZSBwYXJ0aWN1bGFyIHNlcnZpY2UgZXhpc3RzLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIE5hbWUgb2YgdGhlIHNlcnZpY2UgdG8gcXVlcnkuXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gYHRydWVgIGlmIGluamVjdG9yIGhhcyBnaXZlbiBzZXJ2aWNlLlxuICovXG5cbi8qKlxuICogQG5nZG9jIG1ldGhvZFxuICogQG5hbWUgJGluamVjdG9yI2luc3RhbnRpYXRlXG4gKiBAZGVzY3JpcHRpb25cbiAqIENyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiBKUyB0eXBlLiBUaGUgbWV0aG9kIHRha2VzIGEgY29uc3RydWN0b3IgZnVuY3Rpb24sIGludm9rZXMgdGhlIG5ld1xuICogb3BlcmF0b3IsIGFuZCBzdXBwbGllcyBhbGwgb2YgdGhlIGFyZ3VtZW50cyB0byB0aGUgY29uc3RydWN0b3IgZnVuY3Rpb24gYXMgc3BlY2lmaWVkIGJ5IHRoZVxuICogY29uc3RydWN0b3IgYW5ub3RhdGlvbi5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBUeXBlIEFubm90YXRlZCBjb25zdHJ1Y3RvciBmdW5jdGlvbi5cbiAqIEBwYXJhbSB7T2JqZWN0PX0gbG9jYWxzIE9wdGlvbmFsIG9iamVjdC4gSWYgcHJlc2V0IHRoZW4gYW55IGFyZ3VtZW50IG5hbWVzIGFyZSByZWFkIGZyb20gdGhpc1xuICogb2JqZWN0IGZpcnN0LCBiZWZvcmUgdGhlIGAkaW5qZWN0b3JgIGlzIGNvbnN1bHRlZC5cbiAqIEByZXR1cm5zIHtPYmplY3R9IG5ldyBpbnN0YW5jZSBvZiBgVHlwZWAuXG4gKi9cblxuLyoqXG4gKiBAbmdkb2MgbWV0aG9kXG4gKiBAbmFtZSAkaW5qZWN0b3IjYW5ub3RhdGVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFJldHVybnMgYW4gYXJyYXkgb2Ygc2VydmljZSBuYW1lcyB3aGljaCB0aGUgZnVuY3Rpb24gaXMgcmVxdWVzdGluZyBmb3IgaW5qZWN0aW9uLiBUaGlzIEFQSSBpc1xuICogdXNlZCBieSB0aGUgaW5qZWN0b3IgdG8gZGV0ZXJtaW5lIHdoaWNoIHNlcnZpY2VzIG5lZWQgdG8gYmUgaW5qZWN0ZWQgaW50byB0aGUgZnVuY3Rpb24gd2hlbiB0aGVcbiAqIGZ1bmN0aW9uIGlzIGludm9rZWQuIFRoZXJlIGFyZSB0aHJlZSB3YXlzIGluIHdoaWNoIHRoZSBmdW5jdGlvbiBjYW4gYmUgYW5ub3RhdGVkIHdpdGggdGhlIG5lZWRlZFxuICogZGVwZW5kZW5jaWVzLlxuICpcbiAqICMgQXJndW1lbnQgbmFtZXNcbiAqXG4gKiBUaGUgc2ltcGxlc3QgZm9ybSBpcyB0byBleHRyYWN0IHRoZSBkZXBlbmRlbmNpZXMgZnJvbSB0aGUgYXJndW1lbnRzIG9mIHRoZSBmdW5jdGlvbi4gVGhpcyBpcyBkb25lXG4gKiBieSBjb252ZXJ0aW5nIHRoZSBmdW5jdGlvbiBpbnRvIGEgc3RyaW5nIHVzaW5nIGB0b1N0cmluZygpYCBtZXRob2QgYW5kIGV4dHJhY3RpbmcgdGhlIGFyZ3VtZW50XG4gKiBuYW1lcy5cbiAqIGBgYGpzXG4gKiAgIC8vIEdpdmVuXG4gKiAgIGZ1bmN0aW9uIE15Q29udHJvbGxlcigkc2NvcGUsICRyb3V0ZSkge1xuICogICAgIC8vIC4uLlxuICogICB9XG4gKlxuICogICAvLyBUaGVuXG4gKiAgIGV4cGVjdChpbmplY3Rvci5hbm5vdGF0ZShNeUNvbnRyb2xsZXIpKS50b0VxdWFsKFsnJHNjb3BlJywgJyRyb3V0ZSddKTtcbiAqIGBgYFxuICpcbiAqIFlvdSBjYW4gZGlzYWxsb3cgdGhpcyBtZXRob2QgYnkgdXNpbmcgc3RyaWN0IGluamVjdGlvbiBtb2RlLlxuICpcbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgd2l0aCBjb2RlIG1pbmlmaWNhdGlvbiAvIG9iZnVzY2F0aW9uLiBGb3IgdGhpcyByZWFzb24gdGhlIGZvbGxvd2luZ1xuICogYW5ub3RhdGlvbiBzdHJhdGVnaWVzIGFyZSBzdXBwb3J0ZWQuXG4gKlxuICogIyBUaGUgYCRpbmplY3RgIHByb3BlcnR5XG4gKlxuICogSWYgYSBmdW5jdGlvbiBoYXMgYW4gYCRpbmplY3RgIHByb3BlcnR5IGFuZCBpdHMgdmFsdWUgaXMgYW4gYXJyYXkgb2Ygc3RyaW5ncywgdGhlbiB0aGUgc3RyaW5nc1xuICogcmVwcmVzZW50IG5hbWVzIG9mIHNlcnZpY2VzIHRvIGJlIGluamVjdGVkIGludG8gdGhlIGZ1bmN0aW9uLlxuICogYGBganNcbiAqICAgLy8gR2l2ZW5cbiAqICAgdmFyIE15Q29udHJvbGxlciA9IGZ1bmN0aW9uKG9iZnVzY2F0ZWRTY29wZSwgb2JmdXNjYXRlZFJvdXRlKSB7XG4gKiAgICAgLy8gLi4uXG4gKiAgIH1cbiAqICAgLy8gRGVmaW5lIGZ1bmN0aW9uIGRlcGVuZGVuY2llc1xuICogICBNeUNvbnRyb2xsZXJbJyRpbmplY3QnXSA9IFsnJHNjb3BlJywgJyRyb3V0ZSddO1xuICpcbiAqICAgLy8gVGhlblxuICogICBleHBlY3QoaW5qZWN0b3IuYW5ub3RhdGUoTXlDb250cm9sbGVyKSkudG9FcXVhbChbJyRzY29wZScsICckcm91dGUnXSk7XG4gKiBgYGBcbiAqXG4gKiAjIFRoZSBhcnJheSBub3RhdGlvblxuICpcbiAqIEl0IGlzIG9mdGVuIGRlc2lyYWJsZSB0byBpbmxpbmUgSW5qZWN0ZWQgZnVuY3Rpb25zIGFuZCB0aGF0J3Mgd2hlbiBzZXR0aW5nIHRoZSBgJGluamVjdGAgcHJvcGVydHlcbiAqIGlzIHZlcnkgaW5jb252ZW5pZW50LiBJbiB0aGVzZSBzaXR1YXRpb25zIHVzaW5nIHRoZSBhcnJheSBub3RhdGlvbiB0byBzcGVjaWZ5IHRoZSBkZXBlbmRlbmNpZXMgaW5cbiAqIGEgd2F5IHRoYXQgc3Vydml2ZXMgbWluaWZpY2F0aW9uIGlzIGEgYmV0dGVyIGNob2ljZTpcbiAqXG4gKiBgYGBqc1xuICogICAvLyBXZSB3aXNoIHRvIHdyaXRlIHRoaXMgKG5vdCBtaW5pZmljYXRpb24gLyBvYmZ1c2NhdGlvbiBzYWZlKVxuICogICBpbmplY3Rvci5pbnZva2UoZnVuY3Rpb24oJGNvbXBpbGUsICRyb290U2NvcGUpIHtcbiAqICAgICAvLyAuLi5cbiAqICAgfSk7XG4gKlxuICogICAvLyBXZSBhcmUgZm9yY2VkIHRvIHdyaXRlIGJyZWFrIGlubGluaW5nXG4gKiAgIHZhciB0bXBGbiA9IGZ1bmN0aW9uKG9iZnVzY2F0ZWRDb21waWxlLCBvYmZ1c2NhdGVkUm9vdFNjb3BlKSB7XG4gKiAgICAgLy8gLi4uXG4gKiAgIH07XG4gKiAgIHRtcEZuLiRpbmplY3QgPSBbJyRjb21waWxlJywgJyRyb290U2NvcGUnXTtcbiAqICAgaW5qZWN0b3IuaW52b2tlKHRtcEZuKTtcbiAqXG4gKiAgIC8vIFRvIGJldHRlciBzdXBwb3J0IGlubGluZSBmdW5jdGlvbiB0aGUgaW5saW5lIGFubm90YXRpb24gaXMgc3VwcG9ydGVkXG4gKiAgIGluamVjdG9yLmludm9rZShbJyRjb21waWxlJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbihvYmZDb21waWxlLCBvYmZSb290U2NvcGUpIHtcbiAqICAgICAvLyAuLi5cbiAqICAgfV0pO1xuICpcbiAqICAgLy8gVGhlcmVmb3JlXG4gKiAgIGV4cGVjdChpbmplY3Rvci5hbm5vdGF0ZShcbiAqICAgICAgWyckY29tcGlsZScsICckcm9vdFNjb3BlJywgZnVuY3Rpb24ob2JmdXNfJGNvbXBpbGUsIG9iZnVzXyRyb290U2NvcGUpIHt9XSlcbiAqICAgICkudG9FcXVhbChbJyRjb21waWxlJywgJyRyb290U2NvcGUnXSk7XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufEFycmF5LjxzdHJpbmd8RnVuY3Rpb24+fSBmbiBGdW5jdGlvbiBmb3Igd2hpY2ggZGVwZW5kZW50IHNlcnZpY2UgbmFtZXMgbmVlZCB0b1xuICogYmUgcmV0cmlldmVkIGFzIGRlc2NyaWJlZCBhYm92ZS5cbiAqXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBbc3RyaWN0RGk9ZmFsc2VdIERpc2FsbG93IGFyZ3VtZW50IG5hbWUgYW5ub3RhdGlvbiBpbmZlcmVuY2UuXG4gKlxuICogQHJldHVybnMge0FycmF5LjxzdHJpbmc+fSBUaGUgbmFtZXMgb2YgdGhlIHNlcnZpY2VzIHdoaWNoIHRoZSBmdW5jdGlvbiByZXF1aXJlcy5cbiAqL1xuXG5cblxuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkcHJvdmlkZVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIFRoZSB7QGxpbmsgYXV0by4kcHJvdmlkZSAkcHJvdmlkZX0gc2VydmljZSBoYXMgYSBudW1iZXIgb2YgbWV0aG9kcyBmb3IgcmVnaXN0ZXJpbmcgY29tcG9uZW50c1xuICogd2l0aCB0aGUge0BsaW5rIGF1dG8uJGluamVjdG9yICRpbmplY3Rvcn0uIE1hbnkgb2YgdGhlc2UgZnVuY3Rpb25zIGFyZSBhbHNvIGV4cG9zZWQgb25cbiAqIHtAbGluayBhbmd1bGFyLk1vZHVsZX0uXG4gKlxuICogQW4gQW5ndWxhciAqKnNlcnZpY2UqKiBpcyBhIHNpbmdsZXRvbiBvYmplY3QgY3JlYXRlZCBieSBhICoqc2VydmljZSBmYWN0b3J5KiouICBUaGVzZSAqKnNlcnZpY2VcbiAqIGZhY3RvcmllcyoqIGFyZSBmdW5jdGlvbnMgd2hpY2gsIGluIHR1cm4sIGFyZSBjcmVhdGVkIGJ5IGEgKipzZXJ2aWNlIHByb3ZpZGVyKiouXG4gKiBUaGUgKipzZXJ2aWNlIHByb3ZpZGVycyoqIGFyZSBjb25zdHJ1Y3RvciBmdW5jdGlvbnMuIFdoZW4gaW5zdGFudGlhdGVkIHRoZXkgbXVzdCBjb250YWluIGFcbiAqIHByb3BlcnR5IGNhbGxlZCBgJGdldGAsIHdoaWNoIGhvbGRzIHRoZSAqKnNlcnZpY2UgZmFjdG9yeSoqIGZ1bmN0aW9uLlxuICpcbiAqIFdoZW4geW91IHJlcXVlc3QgYSBzZXJ2aWNlLCB0aGUge0BsaW5rIGF1dG8uJGluamVjdG9yICRpbmplY3Rvcn0gaXMgcmVzcG9uc2libGUgZm9yIGZpbmRpbmcgdGhlXG4gKiBjb3JyZWN0ICoqc2VydmljZSBwcm92aWRlcioqLCBpbnN0YW50aWF0aW5nIGl0IGFuZCB0aGVuIGNhbGxpbmcgaXRzIGAkZ2V0YCAqKnNlcnZpY2UgZmFjdG9yeSoqXG4gKiBmdW5jdGlvbiB0byBnZXQgdGhlIGluc3RhbmNlIG9mIHRoZSAqKnNlcnZpY2UqKi5cbiAqXG4gKiBPZnRlbiBzZXJ2aWNlcyBoYXZlIG5vIGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBhbmQgdGhlcmUgaXMgbm8gbmVlZCB0byBhZGQgbWV0aG9kcyB0byB0aGUgc2VydmljZVxuICogcHJvdmlkZXIuICBUaGUgcHJvdmlkZXIgd2lsbCBiZSBubyBtb3JlIHRoYW4gYSBjb25zdHJ1Y3RvciBmdW5jdGlvbiB3aXRoIGEgYCRnZXRgIHByb3BlcnR5LiBGb3JcbiAqIHRoZXNlIGNhc2VzIHRoZSB7QGxpbmsgYXV0by4kcHJvdmlkZSAkcHJvdmlkZX0gc2VydmljZSBoYXMgYWRkaXRpb25hbCBoZWxwZXIgbWV0aG9kcyB0byByZWdpc3RlclxuICogc2VydmljZXMgd2l0aG91dCBzcGVjaWZ5aW5nIGEgcHJvdmlkZXIuXG4gKlxuICogKiB7QGxpbmsgYXV0by4kcHJvdmlkZSNwcm92aWRlciBwcm92aWRlcihwcm92aWRlcil9IC0gcmVnaXN0ZXJzIGEgKipzZXJ2aWNlIHByb3ZpZGVyKiogd2l0aCB0aGVcbiAqICAgICB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfVxuICogKiB7QGxpbmsgYXV0by4kcHJvdmlkZSNjb25zdGFudCBjb25zdGFudChvYmopfSAtIHJlZ2lzdGVycyBhIHZhbHVlL29iamVjdCB0aGF0IGNhbiBiZSBhY2Nlc3NlZCBieVxuICogICAgIHByb3ZpZGVycyBhbmQgc2VydmljZXMuXG4gKiAqIHtAbGluayBhdXRvLiRwcm92aWRlI3ZhbHVlIHZhbHVlKG9iail9IC0gcmVnaXN0ZXJzIGEgdmFsdWUvb2JqZWN0IHRoYXQgY2FuIG9ubHkgYmUgYWNjZXNzZWQgYnlcbiAqICAgICBzZXJ2aWNlcywgbm90IHByb3ZpZGVycy5cbiAqICoge0BsaW5rIGF1dG8uJHByb3ZpZGUjZmFjdG9yeSBmYWN0b3J5KGZuKX0gLSByZWdpc3RlcnMgYSBzZXJ2aWNlICoqZmFjdG9yeSBmdW5jdGlvbioqLCBgZm5gLFxuICogICAgIHRoYXQgd2lsbCBiZSB3cmFwcGVkIGluIGEgKipzZXJ2aWNlIHByb3ZpZGVyKiogb2JqZWN0LCB3aG9zZSBgJGdldGAgcHJvcGVydHkgd2lsbCBjb250YWluIHRoZVxuICogICAgIGdpdmVuIGZhY3RvcnkgZnVuY3Rpb24uXG4gKiAqIHtAbGluayBhdXRvLiRwcm92aWRlI3NlcnZpY2Ugc2VydmljZShjbGFzcyl9IC0gcmVnaXN0ZXJzIGEgKipjb25zdHJ1Y3RvciBmdW5jdGlvbioqLCBgY2xhc3NgXG4gKiAgICAgdGhhdCB3aWxsIGJlIHdyYXBwZWQgaW4gYSAqKnNlcnZpY2UgcHJvdmlkZXIqKiBvYmplY3QsIHdob3NlIGAkZ2V0YCBwcm9wZXJ0eSB3aWxsIGluc3RhbnRpYXRlXG4gKiAgICAgIGEgbmV3IG9iamVjdCB1c2luZyB0aGUgZ2l2ZW4gY29uc3RydWN0b3IgZnVuY3Rpb24uXG4gKlxuICogU2VlIHRoZSBpbmRpdmlkdWFsIG1ldGhvZHMgZm9yIG1vcmUgaW5mb3JtYXRpb24gYW5kIGV4YW1wbGVzLlxuICovXG5cbi8qKlxuICogQG5nZG9jIG1ldGhvZFxuICogQG5hbWUgJHByb3ZpZGUjcHJvdmlkZXJcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIFJlZ2lzdGVyIGEgKipwcm92aWRlciBmdW5jdGlvbioqIHdpdGggdGhlIHtAbGluayBhdXRvLiRpbmplY3RvciAkaW5qZWN0b3J9LiBQcm92aWRlciBmdW5jdGlvbnNcbiAqIGFyZSBjb25zdHJ1Y3RvciBmdW5jdGlvbnMsIHdob3NlIGluc3RhbmNlcyBhcmUgcmVzcG9uc2libGUgZm9yIFwicHJvdmlkaW5nXCIgYSBmYWN0b3J5IGZvciBhXG4gKiBzZXJ2aWNlLlxuICpcbiAqIFNlcnZpY2UgcHJvdmlkZXIgbmFtZXMgc3RhcnQgd2l0aCB0aGUgbmFtZSBvZiB0aGUgc2VydmljZSB0aGV5IHByb3ZpZGUgZm9sbG93ZWQgYnkgYFByb3ZpZGVyYC5cbiAqIEZvciBleGFtcGxlLCB0aGUge0BsaW5rIG5nLiRsb2cgJGxvZ30gc2VydmljZSBoYXMgYSBwcm92aWRlciBjYWxsZWRcbiAqIHtAbGluayBuZy4kbG9nUHJvdmlkZXIgJGxvZ1Byb3ZpZGVyfS5cbiAqXG4gKiBTZXJ2aWNlIHByb3ZpZGVyIG9iamVjdHMgY2FuIGhhdmUgYWRkaXRpb25hbCBtZXRob2RzIHdoaWNoIGFsbG93IGNvbmZpZ3VyYXRpb24gb2YgdGhlIHByb3ZpZGVyXG4gKiBhbmQgaXRzIHNlcnZpY2UuIEltcG9ydGFudGx5LCB5b3UgY2FuIGNvbmZpZ3VyZSB3aGF0IGtpbmQgb2Ygc2VydmljZSBpcyBjcmVhdGVkIGJ5IHRoZSBgJGdldGBcbiAqIG1ldGhvZCwgb3IgaG93IHRoYXQgc2VydmljZSB3aWxsIGFjdC4gRm9yIGV4YW1wbGUsIHRoZSB7QGxpbmsgbmcuJGxvZ1Byb3ZpZGVyICRsb2dQcm92aWRlcn0gaGFzIGFcbiAqIG1ldGhvZCB7QGxpbmsgbmcuJGxvZ1Byb3ZpZGVyI2RlYnVnRW5hYmxlZCBkZWJ1Z0VuYWJsZWR9XG4gKiB3aGljaCBsZXRzIHlvdSBzcGVjaWZ5IHdoZXRoZXIgdGhlIHtAbGluayBuZy4kbG9nICRsb2d9IHNlcnZpY2Ugd2lsbCBsb2cgZGVidWcgbWVzc2FnZXMgdG8gdGhlXG4gKiBjb25zb2xlIG9yIG5vdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgaW5zdGFuY2UuIE5PVEU6IHRoZSBwcm92aWRlciB3aWxsIGJlIGF2YWlsYWJsZSB1bmRlciBgbmFtZSArXG4gICAgICAgICAgICAgICAgICAgICAgICAnUHJvdmlkZXInYCBrZXkuXG4gKiBAcGFyYW0geyhPYmplY3R8ZnVuY3Rpb24oKSl9IHByb3ZpZGVyIElmIHRoZSBwcm92aWRlciBpczpcbiAqXG4gKiAgIC0gYE9iamVjdGA6IHRoZW4gaXQgc2hvdWxkIGhhdmUgYSBgJGdldGAgbWV0aG9kLiBUaGUgYCRnZXRgIG1ldGhvZCB3aWxsIGJlIGludm9rZWQgdXNpbmdcbiAqICAgICB7QGxpbmsgYXV0by4kaW5qZWN0b3IjaW52b2tlICRpbmplY3Rvci5pbnZva2UoKX0gd2hlbiBhbiBpbnN0YW5jZSBuZWVkcyB0byBiZSBjcmVhdGVkLlxuICogICAtIGBDb25zdHJ1Y3RvcmA6IGEgbmV3IGluc3RhbmNlIG9mIHRoZSBwcm92aWRlciB3aWxsIGJlIGNyZWF0ZWQgdXNpbmdcbiAqICAgICB7QGxpbmsgYXV0by4kaW5qZWN0b3IjaW5zdGFudGlhdGUgJGluamVjdG9yLmluc3RhbnRpYXRlKCl9LCB0aGVuIHRyZWF0ZWQgYXMgYG9iamVjdGAuXG4gKlxuICogQHJldHVybnMge09iamVjdH0gcmVnaXN0ZXJlZCBwcm92aWRlciBpbnN0YW5jZVxuXG4gKiBAZXhhbXBsZVxuICpcbiAqIFRoZSBmb2xsb3dpbmcgZXhhbXBsZSBzaG93cyBob3cgdG8gY3JlYXRlIGEgc2ltcGxlIGV2ZW50IHRyYWNraW5nIHNlcnZpY2UgYW5kIHJlZ2lzdGVyIGl0IHVzaW5nXG4gKiB7QGxpbmsgYXV0by4kcHJvdmlkZSNwcm92aWRlciAkcHJvdmlkZS5wcm92aWRlcigpfS5cbiAqXG4gKiBgYGBqc1xuICogIC8vIERlZmluZSB0aGUgZXZlbnRUcmFja2VyIHByb3ZpZGVyXG4gKiAgZnVuY3Rpb24gRXZlbnRUcmFja2VyUHJvdmlkZXIoKSB7XG4gKiAgICB2YXIgdHJhY2tpbmdVcmwgPSAnL3RyYWNrJztcbiAqXG4gKiAgICAvLyBBIHByb3ZpZGVyIG1ldGhvZCBmb3IgY29uZmlndXJpbmcgd2hlcmUgdGhlIHRyYWNrZWQgZXZlbnRzIHNob3VsZCBiZWVuIHNhdmVkXG4gKiAgICB0aGlzLnNldFRyYWNraW5nVXJsID0gZnVuY3Rpb24odXJsKSB7XG4gKiAgICAgIHRyYWNraW5nVXJsID0gdXJsO1xuICogICAgfTtcbiAqXG4gKiAgICAvLyBUaGUgc2VydmljZSBmYWN0b3J5IGZ1bmN0aW9uXG4gKiAgICB0aGlzLiRnZXQgPSBbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApIHtcbiAqICAgICAgdmFyIHRyYWNrZWRFdmVudHMgPSB7fTtcbiAqICAgICAgcmV0dXJuIHtcbiAqICAgICAgICAvLyBDYWxsIHRoaXMgdG8gdHJhY2sgYW4gZXZlbnRcbiAqICAgICAgICBldmVudDogZnVuY3Rpb24oZXZlbnQpIHtcbiAqICAgICAgICAgIHZhciBjb3VudCA9IHRyYWNrZWRFdmVudHNbZXZlbnRdIHx8IDA7XG4gKiAgICAgICAgICBjb3VudCArPSAxO1xuICogICAgICAgICAgdHJhY2tlZEV2ZW50c1tldmVudF0gPSBjb3VudDtcbiAqICAgICAgICAgIHJldHVybiBjb3VudDtcbiAqICAgICAgICB9LFxuICogICAgICAgIC8vIENhbGwgdGhpcyB0byBzYXZlIHRoZSB0cmFja2VkIGV2ZW50cyB0byB0aGUgdHJhY2tpbmdVcmxcbiAqICAgICAgICBzYXZlOiBmdW5jdGlvbigpIHtcbiAqICAgICAgICAgICRodHRwLnBvc3QodHJhY2tpbmdVcmwsIHRyYWNrZWRFdmVudHMpO1xuICogICAgICAgIH1cbiAqICAgICAgfTtcbiAqICAgIH1dO1xuICogIH1cbiAqXG4gKiAgZGVzY3JpYmUoJ2V2ZW50VHJhY2tlcicsIGZ1bmN0aW9uKCkge1xuICogICAgdmFyIHBvc3RTcHk7XG4gKlxuICogICAgYmVmb3JlRWFjaChtb2R1bGUoZnVuY3Rpb24oJHByb3ZpZGUpIHtcbiAqICAgICAgLy8gUmVnaXN0ZXIgdGhlIGV2ZW50VHJhY2tlciBwcm92aWRlclxuICogICAgICAkcHJvdmlkZS5wcm92aWRlcignZXZlbnRUcmFja2VyJywgRXZlbnRUcmFja2VyUHJvdmlkZXIpO1xuICogICAgfSkpO1xuICpcbiAqICAgIGJlZm9yZUVhY2gobW9kdWxlKGZ1bmN0aW9uKGV2ZW50VHJhY2tlclByb3ZpZGVyKSB7XG4gKiAgICAgIC8vIENvbmZpZ3VyZSBldmVudFRyYWNrZXIgcHJvdmlkZXJcbiAqICAgICAgZXZlbnRUcmFja2VyUHJvdmlkZXIuc2V0VHJhY2tpbmdVcmwoJy9jdXN0b20tdHJhY2snKTtcbiAqICAgIH0pKTtcbiAqXG4gKiAgICBpdCgndHJhY2tzIGV2ZW50cycsIGluamVjdChmdW5jdGlvbihldmVudFRyYWNrZXIpIHtcbiAqICAgICAgZXhwZWN0KGV2ZW50VHJhY2tlci5ldmVudCgnbG9naW4nKSkudG9FcXVhbCgxKTtcbiAqICAgICAgZXhwZWN0KGV2ZW50VHJhY2tlci5ldmVudCgnbG9naW4nKSkudG9FcXVhbCgyKTtcbiAqICAgIH0pKTtcbiAqXG4gKiAgICBpdCgnc2F2ZXMgdG8gdGhlIHRyYWNraW5nIHVybCcsIGluamVjdChmdW5jdGlvbihldmVudFRyYWNrZXIsICRodHRwKSB7XG4gKiAgICAgIHBvc3RTcHkgPSBzcHlPbigkaHR0cCwgJ3Bvc3QnKTtcbiAqICAgICAgZXZlbnRUcmFja2VyLmV2ZW50KCdsb2dpbicpO1xuICogICAgICBldmVudFRyYWNrZXIuc2F2ZSgpO1xuICogICAgICBleHBlY3QocG9zdFNweSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICogICAgICBleHBlY3QocG9zdFNweS5tb3N0UmVjZW50Q2FsbC5hcmdzWzBdKS5ub3QudG9FcXVhbCgnL3RyYWNrJyk7XG4gKiAgICAgIGV4cGVjdChwb3N0U3B5Lm1vc3RSZWNlbnRDYWxsLmFyZ3NbMF0pLnRvRXF1YWwoJy9jdXN0b20tdHJhY2snKTtcbiAqICAgICAgZXhwZWN0KHBvc3RTcHkubW9zdFJlY2VudENhbGwuYXJnc1sxXSkudG9FcXVhbCh7ICdsb2dpbic6IDEgfSk7XG4gKiAgICB9KSk7XG4gKiAgfSk7XG4gKiBgYGBcbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBtZXRob2RcbiAqIEBuYW1lICRwcm92aWRlI2ZhY3RvcnlcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIFJlZ2lzdGVyIGEgKipzZXJ2aWNlIGZhY3RvcnkqKiwgd2hpY2ggd2lsbCBiZSBjYWxsZWQgdG8gcmV0dXJuIHRoZSBzZXJ2aWNlIGluc3RhbmNlLlxuICogVGhpcyBpcyBzaG9ydCBmb3IgcmVnaXN0ZXJpbmcgYSBzZXJ2aWNlIHdoZXJlIGl0cyBwcm92aWRlciBjb25zaXN0cyBvZiBvbmx5IGEgYCRnZXRgIHByb3BlcnR5LFxuICogd2hpY2ggaXMgdGhlIGdpdmVuIHNlcnZpY2UgZmFjdG9yeSBmdW5jdGlvbi5cbiAqIFlvdSBzaG91bGQgdXNlIHtAbGluayBhdXRvLiRwcm92aWRlI2ZhY3RvcnkgJHByb3ZpZGUuZmFjdG9yeShnZXRGbil9IGlmIHlvdSBkbyBub3QgbmVlZCB0b1xuICogY29uZmlndXJlIHlvdXIgc2VydmljZSBpbiBhIHByb3ZpZGVyLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7RnVuY3Rpb258QXJyYXkuPHN0cmluZ3xGdW5jdGlvbj59ICRnZXRGbiBUaGUgaW5qZWN0YWJsZSAkZ2V0Rm4gZm9yIHRoZSBpbnN0YW5jZSBjcmVhdGlvbi5cbiAqICAgICAgICAgICAgICAgICAgICAgIEludGVybmFsbHkgdGhpcyBpcyBhIHNob3J0IGhhbmQgZm9yIGAkcHJvdmlkZS5wcm92aWRlcihuYW1lLCB7JGdldDogJGdldEZufSlgLlxuICogQHJldHVybnMge09iamVjdH0gcmVnaXN0ZXJlZCBwcm92aWRlciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlXG4gKiBIZXJlIGlzIGFuIGV4YW1wbGUgb2YgcmVnaXN0ZXJpbmcgYSBzZXJ2aWNlXG4gKiBgYGBqc1xuICogICAkcHJvdmlkZS5mYWN0b3J5KCdwaW5nJywgWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKSB7XG4gKiAgICAgcmV0dXJuIGZ1bmN0aW9uIHBpbmcoKSB7XG4gKiAgICAgICByZXR1cm4gJGh0dHAuc2VuZCgnL3BpbmcnKTtcbiAqICAgICB9O1xuICogICB9XSk7XG4gKiBgYGBcbiAqIFlvdSB3b3VsZCB0aGVuIGluamVjdCBhbmQgdXNlIHRoaXMgc2VydmljZSBsaWtlIHRoaXM6XG4gKiBgYGBqc1xuICogICBzb21lTW9kdWxlLmNvbnRyb2xsZXIoJ0N0cmwnLCBbJ3BpbmcnLCBmdW5jdGlvbihwaW5nKSB7XG4gKiAgICAgcGluZygpO1xuICogICB9XSk7XG4gKiBgYGBcbiAqL1xuXG5cbi8qKlxuICogQG5nZG9jIG1ldGhvZFxuICogQG5hbWUgJHByb3ZpZGUjc2VydmljZVxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogUmVnaXN0ZXIgYSAqKnNlcnZpY2UgY29uc3RydWN0b3IqKiwgd2hpY2ggd2lsbCBiZSBpbnZva2VkIHdpdGggYG5ld2AgdG8gY3JlYXRlIHRoZSBzZXJ2aWNlXG4gKiBpbnN0YW5jZS5cbiAqIFRoaXMgaXMgc2hvcnQgZm9yIHJlZ2lzdGVyaW5nIGEgc2VydmljZSB3aGVyZSBpdHMgcHJvdmlkZXIncyBgJGdldGAgcHJvcGVydHkgaXMgYSBmYWN0b3J5XG4gKiBmdW5jdGlvbiB0aGF0IHJldHVybnMgYW4gaW5zdGFuY2UgaW5zdGFudGlhdGVkIGJ5IHRoZSBpbmplY3RvciBmcm9tIHRoZSBzZXJ2aWNlIGNvbnN0cnVjdG9yXG4gKiBmdW5jdGlvbi5cbiAqXG4gKiBJbnRlcm5hbGx5IGl0IGxvb2tzIGEgYml0IGxpa2UgdGhpczpcbiAqXG4gKiBgYGBcbiAqIHtcbiAqICAgJGdldDogZnVuY3Rpb24oKSB7XG4gKiAgICAgcmV0dXJuICRpbmplY3Rvci5pbnN0YW50aWF0ZShjb25zdHJ1Y3Rvcik7XG4gKiAgIH1cbiAqIH1cbiAqIGBgYFxuICpcbiAqXG4gKiBZb3Ugc2hvdWxkIHVzZSB7QGxpbmsgYXV0by4kcHJvdmlkZSNzZXJ2aWNlICRwcm92aWRlLnNlcnZpY2UoY2xhc3MpfSBpZiB5b3UgZGVmaW5lIHlvdXIgc2VydmljZVxuICogYXMgYSB0eXBlL2NsYXNzLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7RnVuY3Rpb258QXJyYXkuPHN0cmluZ3xGdW5jdGlvbj59IGNvbnN0cnVjdG9yIEFuIGluamVjdGFibGUgY2xhc3MgKGNvbnN0cnVjdG9yIGZ1bmN0aW9uKVxuICogICAgIHRoYXQgd2lsbCBiZSBpbnN0YW50aWF0ZWQuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSByZWdpc3RlcmVkIHByb3ZpZGVyIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGVcbiAqIEhlcmUgaXMgYW4gZXhhbXBsZSBvZiByZWdpc3RlcmluZyBhIHNlcnZpY2UgdXNpbmdcbiAqIHtAbGluayBhdXRvLiRwcm92aWRlI3NlcnZpY2UgJHByb3ZpZGUuc2VydmljZShjbGFzcyl9LlxuICogYGBganNcbiAqICAgdmFyIFBpbmcgPSBmdW5jdGlvbigkaHR0cCkge1xuICogICAgIHRoaXMuJGh0dHAgPSAkaHR0cDtcbiAqICAgfTtcbiAqXG4gKiAgIFBpbmcuJGluamVjdCA9IFsnJGh0dHAnXTtcbiAqXG4gKiAgIFBpbmcucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbigpIHtcbiAqICAgICByZXR1cm4gdGhpcy4kaHR0cC5nZXQoJy9waW5nJyk7XG4gKiAgIH07XG4gKiAgICRwcm92aWRlLnNlcnZpY2UoJ3BpbmcnLCBQaW5nKTtcbiAqIGBgYFxuICogWW91IHdvdWxkIHRoZW4gaW5qZWN0IGFuZCB1c2UgdGhpcyBzZXJ2aWNlIGxpa2UgdGhpczpcbiAqIGBgYGpzXG4gKiAgIHNvbWVNb2R1bGUuY29udHJvbGxlcignQ3RybCcsIFsncGluZycsIGZ1bmN0aW9uKHBpbmcpIHtcbiAqICAgICBwaW5nLnNlbmQoKTtcbiAqICAgfV0pO1xuICogYGBgXG4gKi9cblxuXG4vKipcbiAqIEBuZ2RvYyBtZXRob2RcbiAqIEBuYW1lICRwcm92aWRlI3ZhbHVlXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBSZWdpc3RlciBhICoqdmFsdWUgc2VydmljZSoqIHdpdGggdGhlIHtAbGluayBhdXRvLiRpbmplY3RvciAkaW5qZWN0b3J9LCBzdWNoIGFzIGEgc3RyaW5nLCBhXG4gKiBudW1iZXIsIGFuIGFycmF5LCBhbiBvYmplY3Qgb3IgYSBmdW5jdGlvbi4gIFRoaXMgaXMgc2hvcnQgZm9yIHJlZ2lzdGVyaW5nIGEgc2VydmljZSB3aGVyZSBpdHNcbiAqIHByb3ZpZGVyJ3MgYCRnZXRgIHByb3BlcnR5IGlzIGEgZmFjdG9yeSBmdW5jdGlvbiB0aGF0IHRha2VzIG5vIGFyZ3VtZW50cyBhbmQgcmV0dXJucyB0aGUgKip2YWx1ZVxuICogc2VydmljZSoqLlxuICpcbiAqIFZhbHVlIHNlcnZpY2VzIGFyZSBzaW1pbGFyIHRvIGNvbnN0YW50IHNlcnZpY2VzLCBleGNlcHQgdGhhdCB0aGV5IGNhbm5vdCBiZSBpbmplY3RlZCBpbnRvIGFcbiAqIG1vZHVsZSBjb25maWd1cmF0aW9uIGZ1bmN0aW9uIChzZWUge0BsaW5rIGFuZ3VsYXIuTW9kdWxlI2NvbmZpZ30pIGJ1dCB0aGV5IGNhbiBiZSBvdmVycmlkZGVuIGJ5XG4gKiBhbiBBbmd1bGFyXG4gKiB7QGxpbmsgYXV0by4kcHJvdmlkZSNkZWNvcmF0b3IgZGVjb3JhdG9yfS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgaW5zdGFuY2UuXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZS5cbiAqIEByZXR1cm5zIHtPYmplY3R9IHJlZ2lzdGVyZWQgcHJvdmlkZXIgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZVxuICogSGVyZSBhcmUgc29tZSBleGFtcGxlcyBvZiBjcmVhdGluZyB2YWx1ZSBzZXJ2aWNlcy5cbiAqIGBgYGpzXG4gKiAgICRwcm92aWRlLnZhbHVlKCdBRE1JTl9VU0VSJywgJ2FkbWluJyk7XG4gKlxuICogICAkcHJvdmlkZS52YWx1ZSgnUm9sZUxvb2t1cCcsIHsgYWRtaW46IDAsIHdyaXRlcjogMSwgcmVhZGVyOiAyIH0pO1xuICpcbiAqICAgJHByb3ZpZGUudmFsdWUoJ2hhbGZPZicsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gKiAgICAgcmV0dXJuIHZhbHVlIC8gMjtcbiAqICAgfSk7XG4gKiBgYGBcbiAqL1xuXG5cbi8qKlxuICogQG5nZG9jIG1ldGhvZFxuICogQG5hbWUgJHByb3ZpZGUjY29uc3RhbnRcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIFJlZ2lzdGVyIGEgKipjb25zdGFudCBzZXJ2aWNlKiosIHN1Y2ggYXMgYSBzdHJpbmcsIGEgbnVtYmVyLCBhbiBhcnJheSwgYW4gb2JqZWN0IG9yIGEgZnVuY3Rpb24sXG4gKiB3aXRoIHRoZSB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfS4gVW5saWtlIHtAbGluayBhdXRvLiRwcm92aWRlI3ZhbHVlIHZhbHVlfSBpdCBjYW4gYmVcbiAqIGluamVjdGVkIGludG8gYSBtb2R1bGUgY29uZmlndXJhdGlvbiBmdW5jdGlvbiAoc2VlIHtAbGluayBhbmd1bGFyLk1vZHVsZSNjb25maWd9KSBhbmQgaXQgY2Fubm90XG4gKiBiZSBvdmVycmlkZGVuIGJ5IGFuIEFuZ3VsYXIge0BsaW5rIGF1dG8uJHByb3ZpZGUjZGVjb3JhdG9yIGRlY29yYXRvcn0uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGNvbnN0YW50LlxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgY29uc3RhbnQgdmFsdWUuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSByZWdpc3RlcmVkIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGVcbiAqIEhlcmUgYSBzb21lIGV4YW1wbGVzIG9mIGNyZWF0aW5nIGNvbnN0YW50czpcbiAqIGBgYGpzXG4gKiAgICRwcm92aWRlLmNvbnN0YW50KCdTSEFSRF9IRUlHSFQnLCAzMDYpO1xuICpcbiAqICAgJHByb3ZpZGUuY29uc3RhbnQoJ01ZX0NPTE9VUlMnLCBbJ3JlZCcsICdibHVlJywgJ2dyZXknXSk7XG4gKlxuICogICAkcHJvdmlkZS5jb25zdGFudCgnZG91YmxlJywgZnVuY3Rpb24odmFsdWUpIHtcbiAqICAgICByZXR1cm4gdmFsdWUgKiAyO1xuICogICB9KTtcbiAqIGBgYFxuICovXG5cblxuLyoqXG4gKiBAbmdkb2MgbWV0aG9kXG4gKiBAbmFtZSAkcHJvdmlkZSNkZWNvcmF0b3JcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIFJlZ2lzdGVyIGEgKipzZXJ2aWNlIGRlY29yYXRvcioqIHdpdGggdGhlIHtAbGluayBhdXRvLiRpbmplY3RvciAkaW5qZWN0b3J9LiBBIHNlcnZpY2UgZGVjb3JhdG9yXG4gKiBpbnRlcmNlcHRzIHRoZSBjcmVhdGlvbiBvZiBhIHNlcnZpY2UsIGFsbG93aW5nIGl0IHRvIG92ZXJyaWRlIG9yIG1vZGlmeSB0aGUgYmVoYXZpb3Igb2YgdGhlXG4gKiBzZXJ2aWNlLiBUaGUgb2JqZWN0IHJldHVybmVkIGJ5IHRoZSBkZWNvcmF0b3IgbWF5IGJlIHRoZSBvcmlnaW5hbCBzZXJ2aWNlLCBvciBhIG5ldyBzZXJ2aWNlXG4gKiBvYmplY3Qgd2hpY2ggcmVwbGFjZXMgb3Igd3JhcHMgYW5kIGRlbGVnYXRlcyB0byB0aGUgb3JpZ2luYWwgc2VydmljZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgc2VydmljZSB0byBkZWNvcmF0ZS5cbiAqIEBwYXJhbSB7RnVuY3Rpb258QXJyYXkuPHN0cmluZ3xGdW5jdGlvbj59IGRlY29yYXRvciBUaGlzIGZ1bmN0aW9uIHdpbGwgYmUgaW52b2tlZCB3aGVuIHRoZSBzZXJ2aWNlIG5lZWRzIHRvIGJlXG4gKiAgICBpbnN0YW50aWF0ZWQgYW5kIHNob3VsZCByZXR1cm4gdGhlIGRlY29yYXRlZCBzZXJ2aWNlIGluc3RhbmNlLiBUaGUgZnVuY3Rpb24gaXMgY2FsbGVkIHVzaW5nXG4gKiAgICB0aGUge0BsaW5rIGF1dG8uJGluamVjdG9yI2ludm9rZSBpbmplY3Rvci5pbnZva2V9IG1ldGhvZCBhbmQgaXMgdGhlcmVmb3JlIGZ1bGx5IGluamVjdGFibGUuXG4gKiAgICBMb2NhbCBpbmplY3Rpb24gYXJndW1lbnRzOlxuICpcbiAqICAgICogYCRkZWxlZ2F0ZWAgLSBUaGUgb3JpZ2luYWwgc2VydmljZSBpbnN0YW5jZSwgd2hpY2ggY2FuIGJlIG1vbmtleSBwYXRjaGVkLCBjb25maWd1cmVkLFxuICogICAgICBkZWNvcmF0ZWQgb3IgZGVsZWdhdGVkIHRvLlxuICpcbiAqIEBleGFtcGxlXG4gKiBIZXJlIHdlIGRlY29yYXRlIHRoZSB7QGxpbmsgbmcuJGxvZyAkbG9nfSBzZXJ2aWNlIHRvIGNvbnZlcnQgd2FybmluZ3MgdG8gZXJyb3JzIGJ5IGludGVyY2VwdGluZ1xuICogY2FsbHMgdG8ge0BsaW5rIG5nLiRsb2cjZXJyb3IgJGxvZy53YXJuKCl9LlxuICogYGBganNcbiAqICAgJHByb3ZpZGUuZGVjb3JhdG9yKCckbG9nJywgWyckZGVsZWdhdGUnLCBmdW5jdGlvbigkZGVsZWdhdGUpIHtcbiAqICAgICAkZGVsZWdhdGUud2FybiA9ICRkZWxlZ2F0ZS5lcnJvcjtcbiAqICAgICByZXR1cm4gJGRlbGVnYXRlO1xuICogICB9XSk7XG4gKiBgYGBcbiAqL1xuXG5cbmZ1bmN0aW9uIGNyZWF0ZUluamVjdG9yKG1vZHVsZXNUb0xvYWQsIHN0cmljdERpKSB7XG4gIHN0cmljdERpID0gKHN0cmljdERpID09PSB0cnVlKTtcbiAgdmFyIElOU1RBTlRJQVRJTkcgPSB7fSxcbiAgICAgIHByb3ZpZGVyU3VmZml4ID0gJ1Byb3ZpZGVyJyxcbiAgICAgIHBhdGggPSBbXSxcbiAgICAgIGxvYWRlZE1vZHVsZXMgPSBuZXcgSGFzaE1hcChbXSwgdHJ1ZSksXG4gICAgICBwcm92aWRlckNhY2hlID0ge1xuICAgICAgICAkcHJvdmlkZToge1xuICAgICAgICAgICAgcHJvdmlkZXI6IHN1cHBvcnRPYmplY3QocHJvdmlkZXIpLFxuICAgICAgICAgICAgZmFjdG9yeTogc3VwcG9ydE9iamVjdChmYWN0b3J5KSxcbiAgICAgICAgICAgIHNlcnZpY2U6IHN1cHBvcnRPYmplY3Qoc2VydmljZSksXG4gICAgICAgICAgICB2YWx1ZTogc3VwcG9ydE9iamVjdCh2YWx1ZSksXG4gICAgICAgICAgICBjb25zdGFudDogc3VwcG9ydE9iamVjdChjb25zdGFudCksXG4gICAgICAgICAgICBkZWNvcmF0b3I6IGRlY29yYXRvclxuICAgICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBwcm92aWRlckluamVjdG9yID0gKHByb3ZpZGVyQ2FjaGUuJGluamVjdG9yID1cbiAgICAgICAgICBjcmVhdGVJbnRlcm5hbEluamVjdG9yKHByb3ZpZGVyQ2FjaGUsIGZ1bmN0aW9uKHNlcnZpY2VOYW1lLCBjYWxsZXIpIHtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzU3RyaW5nKGNhbGxlcikpIHtcbiAgICAgICAgICAgICAgcGF0aC5wdXNoKGNhbGxlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyAkaW5qZWN0b3JNaW5FcnIoJ3VucHInLCBcIlVua25vd24gcHJvdmlkZXI6IHswfVwiLCBwYXRoLmpvaW4oJyA8LSAnKSk7XG4gICAgICAgICAgfSkpLFxuICAgICAgaW5zdGFuY2VDYWNoZSA9IHt9LFxuICAgICAgcHJvdG9JbnN0YW5jZUluamVjdG9yID1cbiAgICAgICAgICBjcmVhdGVJbnRlcm5hbEluamVjdG9yKGluc3RhbmNlQ2FjaGUsIGZ1bmN0aW9uKHNlcnZpY2VOYW1lLCBjYWxsZXIpIHtcbiAgICAgICAgICAgIHZhciBwcm92aWRlciA9IHByb3ZpZGVySW5qZWN0b3IuZ2V0KHNlcnZpY2VOYW1lICsgcHJvdmlkZXJTdWZmaXgsIGNhbGxlcik7XG4gICAgICAgICAgICByZXR1cm4gaW5zdGFuY2VJbmplY3Rvci5pbnZva2UoXG4gICAgICAgICAgICAgICAgcHJvdmlkZXIuJGdldCwgcHJvdmlkZXIsIHVuZGVmaW5lZCwgc2VydmljZU5hbWUpO1xuICAgICAgICAgIH0pLFxuICAgICAgaW5zdGFuY2VJbmplY3RvciA9IHByb3RvSW5zdGFuY2VJbmplY3RvcjtcblxuICBwcm92aWRlckNhY2hlWyckaW5qZWN0b3InICsgcHJvdmlkZXJTdWZmaXhdID0geyAkZ2V0OiB2YWx1ZUZuKHByb3RvSW5zdGFuY2VJbmplY3RvcikgfTtcbiAgdmFyIHJ1bkJsb2NrcyA9IGxvYWRNb2R1bGVzKG1vZHVsZXNUb0xvYWQpO1xuICBpbnN0YW5jZUluamVjdG9yID0gcHJvdG9JbnN0YW5jZUluamVjdG9yLmdldCgnJGluamVjdG9yJyk7XG4gIGluc3RhbmNlSW5qZWN0b3Iuc3RyaWN0RGkgPSBzdHJpY3REaTtcbiAgZm9yRWFjaChydW5CbG9ja3MsIGZ1bmN0aW9uKGZuKSB7IGlmIChmbikgaW5zdGFuY2VJbmplY3Rvci5pbnZva2UoZm4pOyB9KTtcblxuICByZXR1cm4gaW5zdGFuY2VJbmplY3RvcjtcblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgLy8gJHByb3ZpZGVyXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIGZ1bmN0aW9uIHN1cHBvcnRPYmplY3QoZGVsZWdhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgICAgaWYgKGlzT2JqZWN0KGtleSkpIHtcbiAgICAgICAgZm9yRWFjaChrZXksIHJldmVyc2VQYXJhbXMoZGVsZWdhdGUpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZShrZXksIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvdmlkZXIobmFtZSwgcHJvdmlkZXJfKSB7XG4gICAgYXNzZXJ0Tm90SGFzT3duUHJvcGVydHkobmFtZSwgJ3NlcnZpY2UnKTtcbiAgICBpZiAoaXNGdW5jdGlvbihwcm92aWRlcl8pIHx8IGlzQXJyYXkocHJvdmlkZXJfKSkge1xuICAgICAgcHJvdmlkZXJfID0gcHJvdmlkZXJJbmplY3Rvci5pbnN0YW50aWF0ZShwcm92aWRlcl8pO1xuICAgIH1cbiAgICBpZiAoIXByb3ZpZGVyXy4kZ2V0KSB7XG4gICAgICB0aHJvdyAkaW5qZWN0b3JNaW5FcnIoJ3BnZXQnLCBcIlByb3ZpZGVyICd7MH0nIG11c3QgZGVmaW5lICRnZXQgZmFjdG9yeSBtZXRob2QuXCIsIG5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gcHJvdmlkZXJDYWNoZVtuYW1lICsgcHJvdmlkZXJTdWZmaXhdID0gcHJvdmlkZXJfO1xuICB9XG5cbiAgZnVuY3Rpb24gZW5mb3JjZVJldHVyblZhbHVlKG5hbWUsIGZhY3RvcnkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gZW5mb3JjZWRSZXR1cm5WYWx1ZSgpIHtcbiAgICAgIHZhciByZXN1bHQgPSBpbnN0YW5jZUluamVjdG9yLmludm9rZShmYWN0b3J5LCB0aGlzKTtcbiAgICAgIGlmIChpc1VuZGVmaW5lZChyZXN1bHQpKSB7XG4gICAgICAgIHRocm93ICRpbmplY3Rvck1pbkVycigndW5kZWYnLCBcIlByb3ZpZGVyICd7MH0nIG11c3QgcmV0dXJuIGEgdmFsdWUgZnJvbSAkZ2V0IGZhY3RvcnkgbWV0aG9kLlwiLCBuYW1lKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGZhY3RvcnkobmFtZSwgZmFjdG9yeUZuLCBlbmZvcmNlKSB7XG4gICAgcmV0dXJuIHByb3ZpZGVyKG5hbWUsIHtcbiAgICAgICRnZXQ6IGVuZm9yY2UgIT09IGZhbHNlID8gZW5mb3JjZVJldHVyblZhbHVlKG5hbWUsIGZhY3RvcnlGbikgOiBmYWN0b3J5Rm5cbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNlcnZpY2UobmFtZSwgY29uc3RydWN0b3IpIHtcbiAgICByZXR1cm4gZmFjdG9yeShuYW1lLCBbJyRpbmplY3RvcicsIGZ1bmN0aW9uKCRpbmplY3Rvcikge1xuICAgICAgcmV0dXJuICRpbmplY3Rvci5pbnN0YW50aWF0ZShjb25zdHJ1Y3Rvcik7XG4gICAgfV0pO1xuICB9XG5cbiAgZnVuY3Rpb24gdmFsdWUobmFtZSwgdmFsKSB7IHJldHVybiBmYWN0b3J5KG5hbWUsIHZhbHVlRm4odmFsKSwgZmFsc2UpOyB9XG5cbiAgZnVuY3Rpb24gY29uc3RhbnQobmFtZSwgdmFsdWUpIHtcbiAgICBhc3NlcnROb3RIYXNPd25Qcm9wZXJ0eShuYW1lLCAnY29uc3RhbnQnKTtcbiAgICBwcm92aWRlckNhY2hlW25hbWVdID0gdmFsdWU7XG4gICAgaW5zdGFuY2VDYWNoZVtuYW1lXSA9IHZhbHVlO1xuICB9XG5cbiAgZnVuY3Rpb24gZGVjb3JhdG9yKHNlcnZpY2VOYW1lLCBkZWNvckZuKSB7XG4gICAgdmFyIG9yaWdQcm92aWRlciA9IHByb3ZpZGVySW5qZWN0b3IuZ2V0KHNlcnZpY2VOYW1lICsgcHJvdmlkZXJTdWZmaXgpLFxuICAgICAgICBvcmlnJGdldCA9IG9yaWdQcm92aWRlci4kZ2V0O1xuXG4gICAgb3JpZ1Byb3ZpZGVyLiRnZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBvcmlnSW5zdGFuY2UgPSBpbnN0YW5jZUluamVjdG9yLmludm9rZShvcmlnJGdldCwgb3JpZ1Byb3ZpZGVyKTtcbiAgICAgIHJldHVybiBpbnN0YW5jZUluamVjdG9yLmludm9rZShkZWNvckZuLCBudWxsLCB7JGRlbGVnYXRlOiBvcmlnSW5zdGFuY2V9KTtcbiAgICB9O1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gIC8vIE1vZHVsZSBMb2FkaW5nXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICBmdW5jdGlvbiBsb2FkTW9kdWxlcyhtb2R1bGVzVG9Mb2FkKSB7XG4gICAgYXNzZXJ0QXJnKGlzVW5kZWZpbmVkKG1vZHVsZXNUb0xvYWQpIHx8IGlzQXJyYXkobW9kdWxlc1RvTG9hZCksICdtb2R1bGVzVG9Mb2FkJywgJ25vdCBhbiBhcnJheScpO1xuICAgIHZhciBydW5CbG9ja3MgPSBbXSwgbW9kdWxlRm47XG4gICAgZm9yRWFjaChtb2R1bGVzVG9Mb2FkLCBmdW5jdGlvbihtb2R1bGUpIHtcbiAgICAgIGlmIChsb2FkZWRNb2R1bGVzLmdldChtb2R1bGUpKSByZXR1cm47XG4gICAgICBsb2FkZWRNb2R1bGVzLnB1dChtb2R1bGUsIHRydWUpO1xuXG4gICAgICBmdW5jdGlvbiBydW5JbnZva2VRdWV1ZShxdWV1ZSkge1xuICAgICAgICB2YXIgaSwgaWk7XG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gcXVldWUubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgIHZhciBpbnZva2VBcmdzID0gcXVldWVbaV0sXG4gICAgICAgICAgICAgIHByb3ZpZGVyID0gcHJvdmlkZXJJbmplY3Rvci5nZXQoaW52b2tlQXJnc1swXSk7XG5cbiAgICAgICAgICBwcm92aWRlcltpbnZva2VBcmdzWzFdXS5hcHBseShwcm92aWRlciwgaW52b2tlQXJnc1syXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKGlzU3RyaW5nKG1vZHVsZSkpIHtcbiAgICAgICAgICBtb2R1bGVGbiA9IGFuZ3VsYXJNb2R1bGUobW9kdWxlKTtcbiAgICAgICAgICBydW5CbG9ja3MgPSBydW5CbG9ja3MuY29uY2F0KGxvYWRNb2R1bGVzKG1vZHVsZUZuLnJlcXVpcmVzKSkuY29uY2F0KG1vZHVsZUZuLl9ydW5CbG9ja3MpO1xuICAgICAgICAgIHJ1bkludm9rZVF1ZXVlKG1vZHVsZUZuLl9pbnZva2VRdWV1ZSk7XG4gICAgICAgICAgcnVuSW52b2tlUXVldWUobW9kdWxlRm4uX2NvbmZpZ0Jsb2Nrcyk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNGdW5jdGlvbihtb2R1bGUpKSB7XG4gICAgICAgICAgICBydW5CbG9ja3MucHVzaChwcm92aWRlckluamVjdG9yLmludm9rZShtb2R1bGUpKTtcbiAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5KG1vZHVsZSkpIHtcbiAgICAgICAgICAgIHJ1bkJsb2Nrcy5wdXNoKHByb3ZpZGVySW5qZWN0b3IuaW52b2tlKG1vZHVsZSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFzc2VydEFyZ0ZuKG1vZHVsZSwgJ21vZHVsZScpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmIChpc0FycmF5KG1vZHVsZSkpIHtcbiAgICAgICAgICBtb2R1bGUgPSBtb2R1bGVbbW9kdWxlLmxlbmd0aCAtIDFdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlLm1lc3NhZ2UgJiYgZS5zdGFjayAmJiBlLnN0YWNrLmluZGV4T2YoZS5tZXNzYWdlKSA9PSAtMSkge1xuICAgICAgICAgIC8vIFNhZmFyaSAmIEZGJ3Mgc3RhY2sgdHJhY2VzIGRvbid0IGNvbnRhaW4gZXJyb3IubWVzc2FnZSBjb250ZW50XG4gICAgICAgICAgLy8gdW5saWtlIHRob3NlIG9mIENocm9tZSBhbmQgSUVcbiAgICAgICAgICAvLyBTbyBpZiBzdGFjayBkb2Vzbid0IGNvbnRhaW4gbWVzc2FnZSwgd2UgY3JlYXRlIGEgbmV3IHN0cmluZyB0aGF0IGNvbnRhaW5zIGJvdGguXG4gICAgICAgICAgLy8gU2luY2UgZXJyb3Iuc3RhY2sgaXMgcmVhZC1vbmx5IGluIFNhZmFyaSwgSSdtIG92ZXJyaWRpbmcgZSBhbmQgbm90IGUuc3RhY2sgaGVyZS5cbiAgICAgICAgICAvKiBqc2hpbnQgLVcwMjIgKi9cbiAgICAgICAgICBlID0gZS5tZXNzYWdlICsgJ1xcbicgKyBlLnN0YWNrO1xuICAgICAgICB9XG4gICAgICAgIHRocm93ICRpbmplY3Rvck1pbkVycignbW9kdWxlcnInLCBcIkZhaWxlZCB0byBpbnN0YW50aWF0ZSBtb2R1bGUgezB9IGR1ZSB0bzpcXG57MX1cIixcbiAgICAgICAgICAgICAgICAgIG1vZHVsZSwgZS5zdGFjayB8fCBlLm1lc3NhZ2UgfHwgZSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJ1bkJsb2NrcztcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLyBpbnRlcm5hbCBJbmplY3RvclxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICBmdW5jdGlvbiBjcmVhdGVJbnRlcm5hbEluamVjdG9yKGNhY2hlLCBmYWN0b3J5KSB7XG5cbiAgICBmdW5jdGlvbiBnZXRTZXJ2aWNlKHNlcnZpY2VOYW1lLCBjYWxsZXIpIHtcbiAgICAgIGlmIChjYWNoZS5oYXNPd25Qcm9wZXJ0eShzZXJ2aWNlTmFtZSkpIHtcbiAgICAgICAgaWYgKGNhY2hlW3NlcnZpY2VOYW1lXSA9PT0gSU5TVEFOVElBVElORykge1xuICAgICAgICAgIHRocm93ICRpbmplY3Rvck1pbkVycignY2RlcCcsICdDaXJjdWxhciBkZXBlbmRlbmN5IGZvdW5kOiB7MH0nLFxuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlTmFtZSArICcgPC0gJyArIHBhdGguam9pbignIDwtICcpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FjaGVbc2VydmljZU5hbWVdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBwYXRoLnVuc2hpZnQoc2VydmljZU5hbWUpO1xuICAgICAgICAgIGNhY2hlW3NlcnZpY2VOYW1lXSA9IElOU1RBTlRJQVRJTkc7XG4gICAgICAgICAgcmV0dXJuIGNhY2hlW3NlcnZpY2VOYW1lXSA9IGZhY3Rvcnkoc2VydmljZU5hbWUsIGNhbGxlcik7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGlmIChjYWNoZVtzZXJ2aWNlTmFtZV0gPT09IElOU1RBTlRJQVRJTkcpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBjYWNoZVtzZXJ2aWNlTmFtZV07XG4gICAgICAgICAgfVxuICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICBwYXRoLnNoaWZ0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGluamVjdGlvbkFyZ3MoZm4sIGxvY2Fscywgc2VydmljZU5hbWUpIHtcbiAgICAgIHZhciBhcmdzID0gW10sXG4gICAgICAgICAgJGluamVjdCA9IGNyZWF0ZUluamVjdG9yLiQkYW5ub3RhdGUoZm4sIHN0cmljdERpLCBzZXJ2aWNlTmFtZSk7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSAkaW5qZWN0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBrZXkgPSAkaW5qZWN0W2ldO1xuICAgICAgICBpZiAodHlwZW9mIGtleSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICB0aHJvdyAkaW5qZWN0b3JNaW5FcnIoJ2l0a24nLFxuICAgICAgICAgICAgICAgICAgJ0luY29ycmVjdCBpbmplY3Rpb24gdG9rZW4hIEV4cGVjdGVkIHNlcnZpY2UgbmFtZSBhcyBzdHJpbmcsIGdvdCB7MH0nLCBrZXkpO1xuICAgICAgICB9XG4gICAgICAgIGFyZ3MucHVzaChsb2NhbHMgJiYgbG9jYWxzLmhhc093blByb3BlcnR5KGtleSkgPyBsb2NhbHNba2V5XSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRTZXJ2aWNlKGtleSwgc2VydmljZU5hbWUpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhcmdzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzQ2xhc3MoZnVuYykge1xuICAgICAgLy8gSUUgOS0xMSBkbyBub3Qgc3VwcG9ydCBjbGFzc2VzIGFuZCBJRTkgbGVha3Mgd2l0aCB0aGUgY29kZSBiZWxvdy5cbiAgICAgIGlmIChtc2llIDw9IDExKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIC8vIFdvcmthcm91bmQgZm9yIE1TIEVkZ2UuXG4gICAgICAvLyBDaGVjayBodHRwczovL2Nvbm5lY3QubWljcm9zb2Z0LmNvbS9JRS9GZWVkYmFjay9EZXRhaWxzLzIyMTE2NTNcbiAgICAgIHJldHVybiB0eXBlb2YgZnVuYyA9PT0gJ2Z1bmN0aW9uJ1xuICAgICAgICAmJiAvXig/OmNsYXNzXFxzfGNvbnN0cnVjdG9yXFwoKS8udGVzdChGdW5jdGlvbi5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChmdW5jKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW52b2tlKGZuLCBzZWxmLCBsb2NhbHMsIHNlcnZpY2VOYW1lKSB7XG4gICAgICBpZiAodHlwZW9mIGxvY2FscyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgc2VydmljZU5hbWUgPSBsb2NhbHM7XG4gICAgICAgIGxvY2FscyA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIHZhciBhcmdzID0gaW5qZWN0aW9uQXJncyhmbiwgbG9jYWxzLCBzZXJ2aWNlTmFtZSk7XG4gICAgICBpZiAoaXNBcnJheShmbikpIHtcbiAgICAgICAgZm4gPSBmbltmbi5sZW5ndGggLSAxXTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFpc0NsYXNzKGZuKSkge1xuICAgICAgICAvLyBodHRwOi8vanNwZXJmLmNvbS9hbmd1bGFyanMtaW52b2tlLWFwcGx5LXZzLXN3aXRjaFxuICAgICAgICAvLyAjNTM4OFxuICAgICAgICByZXR1cm4gZm4uYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcmdzLnVuc2hpZnQobnVsbCk7XG4gICAgICAgIHJldHVybiBuZXcgKEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmFwcGx5KGZuLCBhcmdzKSkoKTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGluc3RhbnRpYXRlKFR5cGUsIGxvY2Fscywgc2VydmljZU5hbWUpIHtcbiAgICAgIC8vIENoZWNrIGlmIFR5cGUgaXMgYW5ub3RhdGVkIGFuZCB1c2UganVzdCB0aGUgZ2l2ZW4gZnVuY3Rpb24gYXQgbi0xIGFzIHBhcmFtZXRlclxuICAgICAgLy8gZS5nLiBzb21lTW9kdWxlLmZhY3RvcnkoJ2dyZWV0ZXInLCBbJyR3aW5kb3cnLCBmdW5jdGlvbihyZW5hbWVkJHdpbmRvdykge31dKTtcbiAgICAgIHZhciBjdG9yID0gKGlzQXJyYXkoVHlwZSkgPyBUeXBlW1R5cGUubGVuZ3RoIC0gMV0gOiBUeXBlKTtcbiAgICAgIHZhciBhcmdzID0gaW5qZWN0aW9uQXJncyhUeXBlLCBsb2NhbHMsIHNlcnZpY2VOYW1lKTtcbiAgICAgIC8vIEVtcHR5IG9iamVjdCBhdCBwb3NpdGlvbiAwIGlzIGlnbm9yZWQgZm9yIGludm9jYXRpb24gd2l0aCBgbmV3YCwgYnV0IHJlcXVpcmVkLlxuICAgICAgYXJncy51bnNoaWZ0KG51bGwpO1xuICAgICAgcmV0dXJuIG5ldyAoRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQuYXBwbHkoY3RvciwgYXJncykpKCk7XG4gICAgfVxuXG5cbiAgICByZXR1cm4ge1xuICAgICAgaW52b2tlOiBpbnZva2UsXG4gICAgICBpbnN0YW50aWF0ZTogaW5zdGFudGlhdGUsXG4gICAgICBnZXQ6IGdldFNlcnZpY2UsXG4gICAgICBhbm5vdGF0ZTogY3JlYXRlSW5qZWN0b3IuJCRhbm5vdGF0ZSxcbiAgICAgIGhhczogZnVuY3Rpb24obmFtZSkge1xuICAgICAgICByZXR1cm4gcHJvdmlkZXJDYWNoZS5oYXNPd25Qcm9wZXJ0eShuYW1lICsgcHJvdmlkZXJTdWZmaXgpIHx8IGNhY2hlLmhhc093blByb3BlcnR5KG5hbWUpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbn1cblxuY3JlYXRlSW5qZWN0b3IuJCRhbm5vdGF0ZSA9IGFubm90YXRlO1xuXG4vKipcbiAqIEBuZ2RvYyBwcm92aWRlclxuICogQG5hbWUgJGFuY2hvclNjcm9sbFByb3ZpZGVyXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBVc2UgYCRhbmNob3JTY3JvbGxQcm92aWRlcmAgdG8gZGlzYWJsZSBhdXRvbWF0aWMgc2Nyb2xsaW5nIHdoZW5ldmVyXG4gKiB7QGxpbmsgbmcuJGxvY2F0aW9uI2hhc2ggJGxvY2F0aW9uLmhhc2goKX0gY2hhbmdlcy5cbiAqL1xuZnVuY3Rpb24gJEFuY2hvclNjcm9sbFByb3ZpZGVyKCkge1xuXG4gIHZhciBhdXRvU2Nyb2xsaW5nRW5hYmxlZCA9IHRydWU7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGFuY2hvclNjcm9sbFByb3ZpZGVyI2Rpc2FibGVBdXRvU2Nyb2xsaW5nXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBCeSBkZWZhdWx0LCB7QGxpbmsgbmcuJGFuY2hvclNjcm9sbCAkYW5jaG9yU2Nyb2xsKCl9IHdpbGwgYXV0b21hdGljYWxseSBkZXRlY3QgY2hhbmdlcyB0b1xuICAgKiB7QGxpbmsgbmcuJGxvY2F0aW9uI2hhc2ggJGxvY2F0aW9uLmhhc2goKX0gYW5kIHNjcm9sbCB0byB0aGUgZWxlbWVudCBtYXRjaGluZyB0aGUgbmV3IGhhc2guPGJyIC8+XG4gICAqIFVzZSB0aGlzIG1ldGhvZCB0byBkaXNhYmxlIGF1dG9tYXRpYyBzY3JvbGxpbmcuXG4gICAqXG4gICAqIElmIGF1dG9tYXRpYyBzY3JvbGxpbmcgaXMgZGlzYWJsZWQsIG9uZSBtdXN0IGV4cGxpY2l0bHkgY2FsbFxuICAgKiB7QGxpbmsgbmcuJGFuY2hvclNjcm9sbCAkYW5jaG9yU2Nyb2xsKCl9IGluIG9yZGVyIHRvIHNjcm9sbCB0byB0aGUgZWxlbWVudCByZWxhdGVkIHRvIHRoZVxuICAgKiBjdXJyZW50IGhhc2guXG4gICAqL1xuICB0aGlzLmRpc2FibGVBdXRvU2Nyb2xsaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgYXV0b1Njcm9sbGluZ0VuYWJsZWQgPSBmYWxzZTtcbiAgfTtcblxuICAvKipcbiAgICogQG5nZG9jIHNlcnZpY2VcbiAgICogQG5hbWUgJGFuY2hvclNjcm9sbFxuICAgKiBAa2luZCBmdW5jdGlvblxuICAgKiBAcmVxdWlyZXMgJHdpbmRvd1xuICAgKiBAcmVxdWlyZXMgJGxvY2F0aW9uXG4gICAqIEByZXF1aXJlcyAkcm9vdFNjb3BlXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBXaGVuIGNhbGxlZCwgaXQgc2Nyb2xscyB0byB0aGUgZWxlbWVudCByZWxhdGVkIHRvIHRoZSBzcGVjaWZpZWQgYGhhc2hgIG9yIChpZiBvbWl0dGVkKSB0byB0aGVcbiAgICogY3VycmVudCB2YWx1ZSBvZiB7QGxpbmsgbmcuJGxvY2F0aW9uI2hhc2ggJGxvY2F0aW9uLmhhc2goKX0sIGFjY29yZGluZyB0byB0aGUgcnVsZXMgc3BlY2lmaWVkXG4gICAqIGluIHRoZVxuICAgKiBbSFRNTDUgc3BlY10oaHR0cDovL3d3dy53My5vcmcvaHRtbC93Zy9kcmFmdHMvaHRtbC9tYXN0ZXIvYnJvd3NlcnMuaHRtbCN0aGUtaW5kaWNhdGVkLXBhcnQtb2YtdGhlLWRvY3VtZW50KS5cbiAgICpcbiAgICogSXQgYWxzbyB3YXRjaGVzIHRoZSB7QGxpbmsgbmcuJGxvY2F0aW9uI2hhc2ggJGxvY2F0aW9uLmhhc2goKX0gYW5kIGF1dG9tYXRpY2FsbHkgc2Nyb2xscyB0b1xuICAgKiBtYXRjaCBhbnkgYW5jaG9yIHdoZW5ldmVyIGl0IGNoYW5nZXMuIFRoaXMgY2FuIGJlIGRpc2FibGVkIGJ5IGNhbGxpbmdcbiAgICoge0BsaW5rIG5nLiRhbmNob3JTY3JvbGxQcm92aWRlciNkaXNhYmxlQXV0b1Njcm9sbGluZyAkYW5jaG9yU2Nyb2xsUHJvdmlkZXIuZGlzYWJsZUF1dG9TY3JvbGxpbmcoKX0uXG4gICAqXG4gICAqIEFkZGl0aW9uYWxseSwgeW91IGNhbiB1c2UgaXRzIHtAbGluayBuZy4kYW5jaG9yU2Nyb2xsI3lPZmZzZXQgeU9mZnNldH0gcHJvcGVydHkgdG8gc3BlY2lmeSBhXG4gICAqIHZlcnRpY2FsIHNjcm9sbC1vZmZzZXQgKGVpdGhlciBmaXhlZCBvciBkeW5hbWljKS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBoYXNoIFRoZSBoYXNoIHNwZWNpZnlpbmcgdGhlIGVsZW1lbnQgdG8gc2Nyb2xsIHRvLiBJZiBvbWl0dGVkLCB0aGUgdmFsdWUgb2ZcbiAgICogICAgICAgICAgICAgICAgICAgICAgIHtAbGluayBuZy4kbG9jYXRpb24jaGFzaCAkbG9jYXRpb24uaGFzaCgpfSB3aWxsIGJlIHVzZWQuXG4gICAqXG4gICAqIEBwcm9wZXJ0eSB7KG51bWJlcnxmdW5jdGlvbnxqcUxpdGUpfSB5T2Zmc2V0XG4gICAqIElmIHNldCwgc3BlY2lmaWVzIGEgdmVydGljYWwgc2Nyb2xsLW9mZnNldC4gVGhpcyBpcyBvZnRlbiB1c2VmdWwgd2hlbiB0aGVyZSBhcmUgZml4ZWRcbiAgICogcG9zaXRpb25lZCBlbGVtZW50cyBhdCB0aGUgdG9wIG9mIHRoZSBwYWdlLCBzdWNoIGFzIG5hdmJhcnMsIGhlYWRlcnMgZXRjLlxuICAgKlxuICAgKiBgeU9mZnNldGAgY2FuIGJlIHNwZWNpZmllZCBpbiB2YXJpb3VzIHdheXM6XG4gICAqIC0gKipudW1iZXIqKjogQSBmaXhlZCBudW1iZXIgb2YgcGl4ZWxzIHRvIGJlIHVzZWQgYXMgb2Zmc2V0LjxiciAvPjxiciAvPlxuICAgKiAtICoqZnVuY3Rpb24qKjogQSBnZXR0ZXIgZnVuY3Rpb24gY2FsbGVkIGV2ZXJ5dGltZSBgJGFuY2hvclNjcm9sbCgpYCBpcyBleGVjdXRlZC4gTXVzdCByZXR1cm5cbiAgICogICBhIG51bWJlciByZXByZXNlbnRpbmcgdGhlIG9mZnNldCAoaW4gcGl4ZWxzKS48YnIgLz48YnIgLz5cbiAgICogLSAqKmpxTGl0ZSoqOiBBIGpxTGl0ZS9qUXVlcnkgZWxlbWVudCB0byBiZSB1c2VkIGZvciBzcGVjaWZ5aW5nIHRoZSBvZmZzZXQuIFRoZSBkaXN0YW5jZSBmcm9tXG4gICAqICAgdGhlIHRvcCBvZiB0aGUgcGFnZSB0byB0aGUgZWxlbWVudCdzIGJvdHRvbSB3aWxsIGJlIHVzZWQgYXMgb2Zmc2V0LjxiciAvPlxuICAgKiAgICoqTm90ZSoqOiBUaGUgZWxlbWVudCB3aWxsIGJlIHRha2VuIGludG8gYWNjb3VudCBvbmx5IGFzIGxvbmcgYXMgaXRzIGBwb3NpdGlvbmAgaXMgc2V0IHRvXG4gICAqICAgYGZpeGVkYC4gVGhpcyBvcHRpb24gaXMgdXNlZnVsLCB3aGVuIGRlYWxpbmcgd2l0aCByZXNwb25zaXZlIG5hdmJhcnMvaGVhZGVycyB0aGF0IGFkanVzdFxuICAgKiAgIHRoZWlyIGhlaWdodCBhbmQvb3IgcG9zaXRpb25pbmcgYWNjb3JkaW5nIHRvIHRoZSB2aWV3cG9ydCdzIHNpemUuXG4gICAqXG4gICAqIDxiciAvPlxuICAgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuICAgKiBJbiBvcmRlciBmb3IgYHlPZmZzZXRgIHRvIHdvcmsgcHJvcGVybHksIHNjcm9sbGluZyBzaG91bGQgdGFrZSBwbGFjZSBvbiB0aGUgZG9jdW1lbnQncyByb290IGFuZFxuICAgKiBub3Qgc29tZSBjaGlsZCBlbGVtZW50LlxuICAgKiA8L2Rpdj5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICAgPGV4YW1wbGUgbW9kdWxlPVwiYW5jaG9yU2Nyb2xsRXhhbXBsZVwiPlxuICAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgICA8ZGl2IGlkPVwic2Nyb2xsQXJlYVwiIG5nLWNvbnRyb2xsZXI9XCJTY3JvbGxDb250cm9sbGVyXCI+XG4gICAgICAgICAgIDxhIG5nLWNsaWNrPVwiZ290b0JvdHRvbSgpXCI+R28gdG8gYm90dG9tPC9hPlxuICAgICAgICAgICA8YSBpZD1cImJvdHRvbVwiPjwvYT4gWW91J3JlIGF0IHRoZSBib3R0b20hXG4gICAgICAgICA8L2Rpdj5cbiAgICAgICA8L2ZpbGU+XG4gICAgICAgPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2FuY2hvclNjcm9sbEV4YW1wbGUnLCBbXSlcbiAgICAgICAgICAgLmNvbnRyb2xsZXIoJ1Njcm9sbENvbnRyb2xsZXInLCBbJyRzY29wZScsICckbG9jYXRpb24nLCAnJGFuY2hvclNjcm9sbCcsXG4gICAgICAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkYW5jaG9yU2Nyb2xsKSB7XG4gICAgICAgICAgICAgICAkc2NvcGUuZ290b0JvdHRvbSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIGxvY2F0aW9uLmhhc2ggdG8gdGhlIGlkIG9mXG4gICAgICAgICAgICAgICAgIC8vIHRoZSBlbGVtZW50IHlvdSB3aXNoIHRvIHNjcm9sbCB0by5cbiAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLmhhc2goJ2JvdHRvbScpO1xuXG4gICAgICAgICAgICAgICAgIC8vIGNhbGwgJGFuY2hvclNjcm9sbCgpXG4gICAgICAgICAgICAgICAgICRhbmNob3JTY3JvbGwoKTtcbiAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgfV0pO1xuICAgICAgIDwvZmlsZT5cbiAgICAgICA8ZmlsZSBuYW1lPVwic3R5bGUuY3NzXCI+XG4gICAgICAgICAjc2Nyb2xsQXJlYSB7XG4gICAgICAgICAgIGhlaWdodDogMjgwcHg7XG4gICAgICAgICAgIG92ZXJmbG93OiBhdXRvO1xuICAgICAgICAgfVxuXG4gICAgICAgICAjYm90dG9tIHtcbiAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgICAgIG1hcmdpbi10b3A6IDIwMDBweDtcbiAgICAgICAgIH1cbiAgICAgICA8L2ZpbGU+XG4gICAgIDwvZXhhbXBsZT5cbiAgICpcbiAgICogPGhyIC8+XG4gICAqIFRoZSBleGFtcGxlIGJlbG93IGlsbHVzdHJhdGVzIHRoZSB1c2Ugb2YgYSB2ZXJ0aWNhbCBzY3JvbGwtb2Zmc2V0IChzcGVjaWZpZWQgYXMgYSBmaXhlZCB2YWx1ZSkuXG4gICAqIFNlZSB7QGxpbmsgbmcuJGFuY2hvclNjcm9sbCN5T2Zmc2V0ICRhbmNob3JTY3JvbGwueU9mZnNldH0gZm9yIG1vcmUgZGV0YWlscy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICAgPGV4YW1wbGUgbW9kdWxlPVwiYW5jaG9yU2Nyb2xsT2Zmc2V0RXhhbXBsZVwiPlxuICAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgICA8ZGl2IGNsYXNzPVwiZml4ZWQtaGVhZGVyXCIgbmctY29udHJvbGxlcj1cImhlYWRlckN0cmxcIj5cbiAgICAgICAgICAgPGEgaHJlZj1cIlwiIG5nLWNsaWNrPVwiZ290b0FuY2hvcih4KVwiIG5nLXJlcGVhdD1cInggaW4gWzEsMiwzLDQsNV1cIj5cbiAgICAgICAgICAgICBHbyB0byBhbmNob3Ige3t4fX1cbiAgICAgICAgICAgPC9hPlxuICAgICAgICAgPC9kaXY+XG4gICAgICAgICA8ZGl2IGlkPVwiYW5jaG9ye3t4fX1cIiBjbGFzcz1cImFuY2hvclwiIG5nLXJlcGVhdD1cInggaW4gWzEsMiwzLDQsNV1cIj5cbiAgICAgICAgICAgQW5jaG9yIHt7eH19IG9mIDVcbiAgICAgICAgIDwvZGl2PlxuICAgICAgIDwvZmlsZT5cbiAgICAgICA8ZmlsZSBuYW1lPVwic2NyaXB0LmpzXCI+XG4gICAgICAgICBhbmd1bGFyLm1vZHVsZSgnYW5jaG9yU2Nyb2xsT2Zmc2V0RXhhbXBsZScsIFtdKVxuICAgICAgICAgICAucnVuKFsnJGFuY2hvclNjcm9sbCcsIGZ1bmN0aW9uKCRhbmNob3JTY3JvbGwpIHtcbiAgICAgICAgICAgICAkYW5jaG9yU2Nyb2xsLnlPZmZzZXQgPSA1MDsgICAvLyBhbHdheXMgc2Nyb2xsIGJ5IDUwIGV4dHJhIHBpeGVsc1xuICAgICAgICAgICB9XSlcbiAgICAgICAgICAgLmNvbnRyb2xsZXIoJ2hlYWRlckN0cmwnLCBbJyRhbmNob3JTY3JvbGwnLCAnJGxvY2F0aW9uJywgJyRzY29wZScsXG4gICAgICAgICAgICAgZnVuY3Rpb24gKCRhbmNob3JTY3JvbGwsICRsb2NhdGlvbiwgJHNjb3BlKSB7XG4gICAgICAgICAgICAgICAkc2NvcGUuZ290b0FuY2hvciA9IGZ1bmN0aW9uKHgpIHtcbiAgICAgICAgICAgICAgICAgdmFyIG5ld0hhc2ggPSAnYW5jaG9yJyArIHg7XG4gICAgICAgICAgICAgICAgIGlmICgkbG9jYXRpb24uaGFzaCgpICE9PSBuZXdIYXNoKSB7XG4gICAgICAgICAgICAgICAgICAgLy8gc2V0IHRoZSAkbG9jYXRpb24uaGFzaCB0byBgbmV3SGFzaGAgYW5kXG4gICAgICAgICAgICAgICAgICAgLy8gJGFuY2hvclNjcm9sbCB3aWxsIGF1dG9tYXRpY2FsbHkgc2Nyb2xsIHRvIGl0XG4gICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLmhhc2goJ2FuY2hvcicgKyB4KTtcbiAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAvLyBjYWxsICRhbmNob3JTY3JvbGwoKSBleHBsaWNpdGx5LFxuICAgICAgICAgICAgICAgICAgIC8vIHNpbmNlICRsb2NhdGlvbi5oYXNoIGhhc24ndCBjaGFuZ2VkXG4gICAgICAgICAgICAgICAgICAgJGFuY2hvclNjcm9sbCgpO1xuICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgXSk7XG4gICAgICAgPC9maWxlPlxuICAgICAgIDxmaWxlIG5hbWU9XCJzdHlsZS5jc3NcIj5cbiAgICAgICAgIGJvZHkge1xuICAgICAgICAgICBwYWRkaW5nLXRvcDogNTBweDtcbiAgICAgICAgIH1cblxuICAgICAgICAgLmFuY2hvciB7XG4gICAgICAgICAgIGJvcmRlcjogMnB4IGRhc2hlZCBEYXJrT3JjaGlkO1xuICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDEwcHggMjAwcHggMTBweDtcbiAgICAgICAgIH1cblxuICAgICAgICAgLmZpeGVkLWhlYWRlciB7XG4gICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC4yKTtcbiAgICAgICAgICAgaGVpZ2h0OiA1MHB4O1xuICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgICAgICAgIHRvcDogMDsgbGVmdDogMDsgcmlnaHQ6IDA7XG4gICAgICAgICB9XG5cbiAgICAgICAgIC5maXhlZC1oZWFkZXIgPiBhIHtcbiAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgICAgICBtYXJnaW46IDVweCAxNXB4O1xuICAgICAgICAgfVxuICAgICAgIDwvZmlsZT5cbiAgICAgPC9leGFtcGxlPlxuICAgKi9cbiAgdGhpcy4kZ2V0ID0gWyckd2luZG93JywgJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHdpbmRvdywgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKSB7XG4gICAgdmFyIGRvY3VtZW50ID0gJHdpbmRvdy5kb2N1bWVudDtcblxuICAgIC8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgZmlyc3QgYW5jaG9yIGZyb20gYSBOb2RlTGlzdFxuICAgIC8vICh1c2luZyBgQXJyYXkjc29tZSgpYCBpbnN0ZWFkIG9mIGBhbmd1bGFyI2ZvckVhY2goKWAgc2luY2UgaXQncyBtb3JlIHBlcmZvcm1hbnRcbiAgICAvLyAgYW5kIHdvcmtpbmcgaW4gYWxsIHN1cHBvcnRlZCBicm93c2Vycy4pXG4gICAgZnVuY3Rpb24gZ2V0Rmlyc3RBbmNob3IobGlzdCkge1xuICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgICBBcnJheS5wcm90b3R5cGUuc29tZS5jYWxsKGxpc3QsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKG5vZGVOYW1lXyhlbGVtZW50KSA9PT0gJ2EnKSB7XG4gICAgICAgICAgcmVzdWx0ID0gZWxlbWVudDtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFlPZmZzZXQoKSB7XG5cbiAgICAgIHZhciBvZmZzZXQgPSBzY3JvbGwueU9mZnNldDtcblxuICAgICAgaWYgKGlzRnVuY3Rpb24ob2Zmc2V0KSkge1xuICAgICAgICBvZmZzZXQgPSBvZmZzZXQoKTtcbiAgICAgIH0gZWxzZSBpZiAoaXNFbGVtZW50KG9mZnNldCkpIHtcbiAgICAgICAgdmFyIGVsZW0gPSBvZmZzZXRbMF07XG4gICAgICAgIHZhciBzdHlsZSA9ICR3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtKTtcbiAgICAgICAgaWYgKHN0eWxlLnBvc2l0aW9uICE9PSAnZml4ZWQnKSB7XG4gICAgICAgICAgb2Zmc2V0ID0gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvZmZzZXQgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICghaXNOdW1iZXIob2Zmc2V0KSkge1xuICAgICAgICBvZmZzZXQgPSAwO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gb2Zmc2V0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjcm9sbFRvKGVsZW0pIHtcbiAgICAgIGlmIChlbGVtKSB7XG4gICAgICAgIGVsZW0uc2Nyb2xsSW50b1ZpZXcoKTtcblxuICAgICAgICB2YXIgb2Zmc2V0ID0gZ2V0WU9mZnNldCgpO1xuXG4gICAgICAgIGlmIChvZmZzZXQpIHtcbiAgICAgICAgICAvLyBgb2Zmc2V0YCBpcyB0aGUgbnVtYmVyIG9mIHBpeGVscyB3ZSBzaG91bGQgc2Nyb2xsIFVQIGluIG9yZGVyIHRvIGFsaWduIGBlbGVtYCBwcm9wZXJseS5cbiAgICAgICAgICAvLyBUaGlzIGlzIHRydWUgT05MWSBpZiB0aGUgY2FsbCB0byBgZWxlbS5zY3JvbGxJbnRvVmlldygpYCBpbml0aWFsbHkgYWxpZ25zIGBlbGVtYCBhdCB0aGVcbiAgICAgICAgICAvLyB0b3Agb2YgdGhlIHZpZXdwb3J0LlxuICAgICAgICAgIC8vXG4gICAgICAgICAgLy8gSUYgdGhlIG51bWJlciBvZiBwaXhlbHMgZnJvbSB0aGUgdG9wIG9mIGBlbGVtYCB0byB0aGUgZW5kIG9mIHRoZSBwYWdlJ3MgY29udGVudCBpcyBsZXNzXG4gICAgICAgICAgLy8gdGhhbiB0aGUgaGVpZ2h0IG9mIHRoZSB2aWV3cG9ydCwgdGhlbiBgZWxlbS5zY3JvbGxJbnRvVmlldygpYCB3aWxsIGFsaWduIHRoZSBgZWxlbWAgc29tZVxuICAgICAgICAgIC8vIHdheSBkb3duIHRoZSBwYWdlLlxuICAgICAgICAgIC8vXG4gICAgICAgICAgLy8gVGhpcyBpcyBvZnRlbiB0aGUgY2FzZSBmb3IgZWxlbWVudHMgbmVhciB0aGUgYm90dG9tIG9mIHRoZSBwYWdlLlxuICAgICAgICAgIC8vXG4gICAgICAgICAgLy8gSW4gc3VjaCBjYXNlcyB3ZSBkbyBub3QgbmVlZCB0byBzY3JvbGwgdGhlIHdob2xlIGBvZmZzZXRgIHVwLCBqdXN0IHRoZSBkaWZmZXJlbmNlIGJldHdlZW5cbiAgICAgICAgICAvLyB0aGUgdG9wIG9mIHRoZSBlbGVtZW50IGFuZCB0aGUgb2Zmc2V0LCB3aGljaCBpcyBlbm91Z2ggdG8gYWxpZ24gdGhlIHRvcCBvZiBgZWxlbWAgYXQgdGhlXG4gICAgICAgICAgLy8gZGVzaXJlZCBwb3NpdGlvbi5cbiAgICAgICAgICB2YXIgZWxlbVRvcCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuICAgICAgICAgICR3aW5kb3cuc2Nyb2xsQnkoMCwgZWxlbVRvcCAtIG9mZnNldCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICR3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2Nyb2xsKGhhc2gpIHtcbiAgICAgIGhhc2ggPSBpc1N0cmluZyhoYXNoKSA/IGhhc2ggOiAkbG9jYXRpb24uaGFzaCgpO1xuICAgICAgdmFyIGVsbTtcblxuICAgICAgLy8gZW1wdHkgaGFzaCwgc2Nyb2xsIHRvIHRoZSB0b3Agb2YgdGhlIHBhZ2VcbiAgICAgIGlmICghaGFzaCkgc2Nyb2xsVG8obnVsbCk7XG5cbiAgICAgIC8vIGVsZW1lbnQgd2l0aCBnaXZlbiBpZFxuICAgICAgZWxzZSBpZiAoKGVsbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhhc2gpKSkgc2Nyb2xsVG8oZWxtKTtcblxuICAgICAgLy8gZmlyc3QgYW5jaG9yIHdpdGggZ2l2ZW4gbmFtZSA6LURcbiAgICAgIGVsc2UgaWYgKChlbG0gPSBnZXRGaXJzdEFuY2hvcihkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZShoYXNoKSkpKSBzY3JvbGxUbyhlbG0pO1xuXG4gICAgICAvLyBubyBlbGVtZW50IGFuZCBoYXNoID09ICd0b3AnLCBzY3JvbGwgdG8gdGhlIHRvcCBvZiB0aGUgcGFnZVxuICAgICAgZWxzZSBpZiAoaGFzaCA9PT0gJ3RvcCcpIHNjcm9sbFRvKG51bGwpO1xuICAgIH1cblxuICAgIC8vIGRvZXMgbm90IHNjcm9sbCB3aGVuIHVzZXIgY2xpY2tzIG9uIGFuY2hvciBsaW5rIHRoYXQgaXMgY3VycmVudGx5IG9uXG4gICAgLy8gKG5vIHVybCBjaGFuZ2UsIG5vICRsb2NhdGlvbi5oYXNoKCkgY2hhbmdlKSwgYnJvd3NlciBuYXRpdmUgZG9lcyBzY3JvbGxcbiAgICBpZiAoYXV0b1Njcm9sbGluZ0VuYWJsZWQpIHtcbiAgICAgICRyb290U2NvcGUuJHdhdGNoKGZ1bmN0aW9uIGF1dG9TY3JvbGxXYXRjaCgpIHtyZXR1cm4gJGxvY2F0aW9uLmhhc2goKTt9LFxuICAgICAgICBmdW5jdGlvbiBhdXRvU2Nyb2xsV2F0Y2hBY3Rpb24obmV3VmFsLCBvbGRWYWwpIHtcbiAgICAgICAgICAvLyBza2lwIHRoZSBpbml0aWFsIHNjcm9sbCBpZiAkbG9jYXRpb24uaGFzaCBpcyBlbXB0eVxuICAgICAgICAgIGlmIChuZXdWYWwgPT09IG9sZFZhbCAmJiBuZXdWYWwgPT09ICcnKSByZXR1cm47XG5cbiAgICAgICAgICBqcUxpdGVEb2N1bWVudExvYWRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUuJGV2YWxBc3luYyhzY3JvbGwpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gc2Nyb2xsO1xuICB9XTtcbn1cblxudmFyICRhbmltYXRlTWluRXJyID0gbWluRXJyKCckYW5pbWF0ZScpO1xudmFyIEVMRU1FTlRfTk9ERSA9IDE7XG52YXIgTkdfQU5JTUFURV9DTEFTU05BTUUgPSAnbmctYW5pbWF0ZSc7XG5cbmZ1bmN0aW9uIG1lcmdlQ2xhc3NlcyhhLGIpIHtcbiAgaWYgKCFhICYmICFiKSByZXR1cm4gJyc7XG4gIGlmICghYSkgcmV0dXJuIGI7XG4gIGlmICghYikgcmV0dXJuIGE7XG4gIGlmIChpc0FycmF5KGEpKSBhID0gYS5qb2luKCcgJyk7XG4gIGlmIChpc0FycmF5KGIpKSBiID0gYi5qb2luKCcgJyk7XG4gIHJldHVybiBhICsgJyAnICsgYjtcbn1cblxuZnVuY3Rpb24gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50Lmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGVsbSA9IGVsZW1lbnRbaV07XG4gICAgaWYgKGVsbS5ub2RlVHlwZSA9PT0gRUxFTUVOVF9OT0RFKSB7XG4gICAgICByZXR1cm4gZWxtO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBzcGxpdENsYXNzZXMoY2xhc3Nlcykge1xuICBpZiAoaXNTdHJpbmcoY2xhc3NlcykpIHtcbiAgICBjbGFzc2VzID0gY2xhc3Nlcy5zcGxpdCgnICcpO1xuICB9XG5cbiAgLy8gVXNlIGNyZWF0ZU1hcCgpIHRvIHByZXZlbnQgY2xhc3MgYXNzdW1wdGlvbnMgaW52b2x2aW5nIHByb3BlcnR5IG5hbWVzIGluXG4gIC8vIE9iamVjdC5wcm90b3R5cGVcbiAgdmFyIG9iaiA9IGNyZWF0ZU1hcCgpO1xuICBmb3JFYWNoKGNsYXNzZXMsIGZ1bmN0aW9uKGtsYXNzKSB7XG4gICAgLy8gc29tZXRpbWVzIHRoZSBzcGxpdCBsZWF2ZXMgZW1wdHkgc3RyaW5nIHZhbHVlc1xuICAgIC8vIGluY2FzZSBleHRyYSBzcGFjZXMgd2VyZSBhcHBsaWVkIHRvIHRoZSBvcHRpb25zXG4gICAgaWYgKGtsYXNzLmxlbmd0aCkge1xuICAgICAgb2JqW2tsYXNzXSA9IHRydWU7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIG9iajtcbn1cblxuLy8gaWYgYW55IG90aGVyIHR5cGUgb2Ygb3B0aW9ucyB2YWx1ZSBiZXNpZGVzIGFuIE9iamVjdCB2YWx1ZSBpc1xuLy8gcGFzc2VkIGludG8gdGhlICRhbmltYXRlLm1ldGhvZCgpIGFuaW1hdGlvbiB0aGVuIHRoaXMgaGVscGVyIGNvZGVcbi8vIHdpbGwgYmUgcnVuIHdoaWNoIHdpbGwgaWdub3JlIGl0LiBXaGlsZSB0aGlzIHBhdGNoIGlzIG5vdCB0aGVcbi8vIGdyZWF0ZXN0IHNvbHV0aW9uIHRvIHRoaXMsIGEgbG90IG9mIGV4aXN0aW5nIHBsdWdpbnMgZGVwZW5kIG9uXG4vLyAkYW5pbWF0ZSB0byBlaXRoZXIgY2FsbCB0aGUgY2FsbGJhY2sgKDwgMS4yKSBvciByZXR1cm4gYSBwcm9taXNlXG4vLyB0aGF0IGNhbiBiZSBjaGFuZ2VkLiBUaGlzIGhlbHBlciBmdW5jdGlvbiBlbnN1cmVzIHRoYXQgdGhlIG9wdGlvbnNcbi8vIGFyZSB3aXBlZCBjbGVhbiBpbmNhc2UgYSBjYWxsYmFjayBmdW5jdGlvbiBpcyBwcm92aWRlZC5cbmZ1bmN0aW9uIHByZXBhcmVBbmltYXRlT3B0aW9ucyhvcHRpb25zKSB7XG4gIHJldHVybiBpc09iamVjdChvcHRpb25zKVxuICAgICAgPyBvcHRpb25zXG4gICAgICA6IHt9O1xufVxuXG52YXIgJCRDb3JlQW5pbWF0ZUpzUHJvdmlkZXIgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24oKSB7fTtcbn07XG5cbi8vIHRoaXMgaXMgcHJlZml4ZWQgd2l0aCBDb3JlIHNpbmNlIGl0IGNvbmZsaWN0cyB3aXRoXG4vLyB0aGUgYW5pbWF0ZVF1ZXVlUHJvdmlkZXIgZGVmaW5lZCBpbiBuZ0FuaW1hdGUvYW5pbWF0ZVF1ZXVlLmpzXG52YXIgJCRDb3JlQW5pbWF0ZVF1ZXVlUHJvdmlkZXIgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHBvc3REaWdlc3RRdWV1ZSA9IG5ldyBIYXNoTWFwKCk7XG4gIHZhciBwb3N0RGlnZXN0RWxlbWVudHMgPSBbXTtcblxuICB0aGlzLiRnZXQgPSBbJyQkQW5pbWF0ZVJ1bm5lcicsICckcm9vdFNjb3BlJyxcbiAgICAgICBmdW5jdGlvbigkJEFuaW1hdGVSdW5uZXIsICAgJHJvb3RTY29wZSkge1xuICAgIHJldHVybiB7XG4gICAgICBlbmFibGVkOiBub29wLFxuICAgICAgb246IG5vb3AsXG4gICAgICBvZmY6IG5vb3AsXG4gICAgICBwaW46IG5vb3AsXG5cbiAgICAgIHB1c2g6IGZ1bmN0aW9uKGVsZW1lbnQsIGV2ZW50LCBvcHRpb25zLCBkb21PcGVyYXRpb24pIHtcbiAgICAgICAgZG9tT3BlcmF0aW9uICAgICAgICAmJiBkb21PcGVyYXRpb24oKTtcblxuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgb3B0aW9ucy5mcm9tICAgICAgICAmJiBlbGVtZW50LmNzcyhvcHRpb25zLmZyb20pO1xuICAgICAgICBvcHRpb25zLnRvICAgICAgICAgICYmIGVsZW1lbnQuY3NzKG9wdGlvbnMudG8pO1xuXG4gICAgICAgIGlmIChvcHRpb25zLmFkZENsYXNzIHx8IG9wdGlvbnMucmVtb3ZlQ2xhc3MpIHtcbiAgICAgICAgICBhZGRSZW1vdmVDbGFzc2VzUG9zdERpZ2VzdChlbGVtZW50LCBvcHRpb25zLmFkZENsYXNzLCBvcHRpb25zLnJlbW92ZUNsYXNzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBydW5uZXIgPSBuZXcgJCRBbmltYXRlUnVubmVyKCk7IC8vIGpzaGludCBpZ25vcmU6bGluZVxuXG4gICAgICAgIC8vIHNpbmNlIHRoZXJlIGFyZSBubyBhbmltYXRpb25zIHRvIHJ1biB0aGUgcnVubmVyIG5lZWRzIHRvIGJlXG4gICAgICAgIC8vIG5vdGlmaWVkIHRoYXQgdGhlIGFuaW1hdGlvbiBjYWxsIGlzIGNvbXBsZXRlLlxuICAgICAgICBydW5uZXIuY29tcGxldGUoKTtcbiAgICAgICAgcmV0dXJuIHJ1bm5lcjtcbiAgICAgIH1cbiAgICB9O1xuXG5cbiAgICBmdW5jdGlvbiB1cGRhdGVEYXRhKGRhdGEsIGNsYXNzZXMsIHZhbHVlKSB7XG4gICAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xuICAgICAgaWYgKGNsYXNzZXMpIHtcbiAgICAgICAgY2xhc3NlcyA9IGlzU3RyaW5nKGNsYXNzZXMpID8gY2xhc3Nlcy5zcGxpdCgnICcpIDpcbiAgICAgICAgICAgICAgICAgIGlzQXJyYXkoY2xhc3NlcykgPyBjbGFzc2VzIDogW107XG4gICAgICAgIGZvckVhY2goY2xhc3NlcywgZnVuY3Rpb24oY2xhc3NOYW1lKSB7XG4gICAgICAgICAgaWYgKGNsYXNzTmFtZSkge1xuICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICBkYXRhW2NsYXNzTmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNoYW5nZWQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGFuZGxlQ1NTQ2xhc3NDaGFuZ2VzKCkge1xuICAgICAgZm9yRWFjaChwb3N0RGlnZXN0RWxlbWVudHMsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgdmFyIGRhdGEgPSBwb3N0RGlnZXN0UXVldWUuZ2V0KGVsZW1lbnQpO1xuICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgIHZhciBleGlzdGluZyA9IHNwbGl0Q2xhc3NlcyhlbGVtZW50LmF0dHIoJ2NsYXNzJykpO1xuICAgICAgICAgIHZhciB0b0FkZCA9ICcnO1xuICAgICAgICAgIHZhciB0b1JlbW92ZSA9ICcnO1xuICAgICAgICAgIGZvckVhY2goZGF0YSwgZnVuY3Rpb24oc3RhdHVzLCBjbGFzc05hbWUpIHtcbiAgICAgICAgICAgIHZhciBoYXNDbGFzcyA9ICEhZXhpc3RpbmdbY2xhc3NOYW1lXTtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IGhhc0NsYXNzKSB7XG4gICAgICAgICAgICAgIGlmIChzdGF0dXMpIHtcbiAgICAgICAgICAgICAgICB0b0FkZCArPSAodG9BZGQubGVuZ3RoID8gJyAnIDogJycpICsgY2xhc3NOYW1lO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRvUmVtb3ZlICs9ICh0b1JlbW92ZS5sZW5ndGggPyAnICcgOiAnJykgKyBjbGFzc05hbWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGZvckVhY2goZWxlbWVudCwgZnVuY3Rpb24oZWxtKSB7XG4gICAgICAgICAgICB0b0FkZCAgICAmJiBqcUxpdGVBZGRDbGFzcyhlbG0sIHRvQWRkKTtcbiAgICAgICAgICAgIHRvUmVtb3ZlICYmIGpxTGl0ZVJlbW92ZUNsYXNzKGVsbSwgdG9SZW1vdmUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHBvc3REaWdlc3RRdWV1ZS5yZW1vdmUoZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcG9zdERpZ2VzdEVsZW1lbnRzLmxlbmd0aCA9IDA7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBhZGRSZW1vdmVDbGFzc2VzUG9zdERpZ2VzdChlbGVtZW50LCBhZGQsIHJlbW92ZSkge1xuICAgICAgdmFyIGRhdGEgPSBwb3N0RGlnZXN0UXVldWUuZ2V0KGVsZW1lbnQpIHx8IHt9O1xuXG4gICAgICB2YXIgY2xhc3Nlc0FkZGVkID0gdXBkYXRlRGF0YShkYXRhLCBhZGQsIHRydWUpO1xuICAgICAgdmFyIGNsYXNzZXNSZW1vdmVkID0gdXBkYXRlRGF0YShkYXRhLCByZW1vdmUsIGZhbHNlKTtcblxuICAgICAgaWYgKGNsYXNzZXNBZGRlZCB8fCBjbGFzc2VzUmVtb3ZlZCkge1xuXG4gICAgICAgIHBvc3REaWdlc3RRdWV1ZS5wdXQoZWxlbWVudCwgZGF0YSk7XG4gICAgICAgIHBvc3REaWdlc3RFbGVtZW50cy5wdXNoKGVsZW1lbnQpO1xuXG4gICAgICAgIGlmIChwb3N0RGlnZXN0RWxlbWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgJHJvb3RTY29wZS4kJHBvc3REaWdlc3QoaGFuZGxlQ1NTQ2xhc3NDaGFuZ2VzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfV07XG59O1xuXG4vKipcbiAqIEBuZ2RvYyBwcm92aWRlclxuICogQG5hbWUgJGFuaW1hdGVQcm92aWRlclxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogRGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBvZiAkYW5pbWF0ZSB0aGF0IGRvZXNuJ3QgcGVyZm9ybSBhbnkgYW5pbWF0aW9ucywgaW5zdGVhZCBqdXN0XG4gKiBzeW5jaHJvbm91c2x5IHBlcmZvcm1zIERPTSB1cGRhdGVzIGFuZCByZXNvbHZlcyB0aGUgcmV0dXJuZWQgcnVubmVyIHByb21pc2UuXG4gKlxuICogSW4gb3JkZXIgdG8gZW5hYmxlIGFuaW1hdGlvbnMgdGhlIGBuZ0FuaW1hdGVgIG1vZHVsZSBoYXMgdG8gYmUgbG9hZGVkLlxuICpcbiAqIFRvIHNlZSB0aGUgZnVuY3Rpb25hbCBpbXBsZW1lbnRhdGlvbiBjaGVjayBvdXQgYHNyYy9uZ0FuaW1hdGUvYW5pbWF0ZS5qc2AuXG4gKi9cbnZhciAkQW5pbWF0ZVByb3ZpZGVyID0gWyckcHJvdmlkZScsIGZ1bmN0aW9uKCRwcm92aWRlKSB7XG4gIHZhciBwcm92aWRlciA9IHRoaXM7XG5cbiAgdGhpcy4kJHJlZ2lzdGVyZWRBbmltYXRpb25zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblxuICAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGFuaW1hdGVQcm92aWRlciNyZWdpc3RlclxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogUmVnaXN0ZXJzIGEgbmV3IGluamVjdGFibGUgYW5pbWF0aW9uIGZhY3RvcnkgZnVuY3Rpb24uIFRoZSBmYWN0b3J5IGZ1bmN0aW9uIHByb2R1Y2VzIHRoZVxuICAgKiBhbmltYXRpb24gb2JqZWN0IHdoaWNoIGNvbnRhaW5zIGNhbGxiYWNrIGZ1bmN0aW9ucyBmb3IgZWFjaCBldmVudCB0aGF0IGlzIGV4cGVjdGVkIHRvIGJlXG4gICAqIGFuaW1hdGVkLlxuICAgKlxuICAgKiAgICogYGV2ZW50Rm5gOiBgZnVuY3Rpb24oZWxlbWVudCwgLi4uICwgZG9uZUZ1bmN0aW9uLCBvcHRpb25zKWBcbiAgICogICBUaGUgZWxlbWVudCB0byBhbmltYXRlLCB0aGUgYGRvbmVGdW5jdGlvbmAgYW5kIHRoZSBvcHRpb25zIGZlZCBpbnRvIHRoZSBhbmltYXRpb24uIERlcGVuZGluZ1xuICAgKiAgIG9uIHRoZSB0eXBlIG9mIGFuaW1hdGlvbiBhZGRpdGlvbmFsIGFyZ3VtZW50cyB3aWxsIGJlIGluamVjdGVkIGludG8gdGhlIGFuaW1hdGlvbiBmdW5jdGlvbi4gVGhlXG4gICAqICAgbGlzdCBiZWxvdyBleHBsYWlucyB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlcyBmb3IgdGhlIGRpZmZlcmVudCBhbmltYXRpb24gbWV0aG9kczpcbiAgICpcbiAgICogICAtIHNldENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBhZGRlZENsYXNzZXMsIHJlbW92ZWRDbGFzc2VzLCBkb25lRnVuY3Rpb24sIG9wdGlvbnMpXG4gICAqICAgLSBhZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgYWRkZWRDbGFzc2VzLCBkb25lRnVuY3Rpb24sIG9wdGlvbnMpXG4gICAqICAgLSByZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgcmVtb3ZlZENsYXNzZXMsIGRvbmVGdW5jdGlvbiwgb3B0aW9ucylcbiAgICogICAtIGVudGVyLCBsZWF2ZSwgbW92ZTogZnVuY3Rpb24oZWxlbWVudCwgZG9uZUZ1bmN0aW9uLCBvcHRpb25zKVxuICAgKiAgIC0gYW5pbWF0ZTogZnVuY3Rpb24oZWxlbWVudCwgZnJvbVN0eWxlcywgdG9TdHlsZXMsIGRvbmVGdW5jdGlvbiwgb3B0aW9ucylcbiAgICpcbiAgICogICBNYWtlIHN1cmUgdG8gdHJpZ2dlciB0aGUgYGRvbmVGdW5jdGlvbmAgb25jZSB0aGUgYW5pbWF0aW9uIGlzIGZ1bGx5IGNvbXBsZXRlLlxuICAgKlxuICAgKiBgYGBqc1xuICAgKiAgIHJldHVybiB7XG4gICAqICAgICAvL2VudGVyLCBsZWF2ZSwgbW92ZSBzaWduYXR1cmVcbiAgICogICAgIGV2ZW50Rm4gOiBmdW5jdGlvbihlbGVtZW50LCBkb25lLCBvcHRpb25zKSB7XG4gICAqICAgICAgIC8vY29kZSB0byBydW4gdGhlIGFuaW1hdGlvblxuICAgKiAgICAgICAvL29uY2UgY29tcGxldGUsIHRoZW4gcnVuIGRvbmUoKVxuICAgKiAgICAgICByZXR1cm4gZnVuY3Rpb24gZW5kRnVuY3Rpb24od2FzQ2FuY2VsbGVkKSB7XG4gICAqICAgICAgICAgLy9jb2RlIHRvIGNhbmNlbCB0aGUgYW5pbWF0aW9uXG4gICAqICAgICAgIH1cbiAgICogICAgIH1cbiAgICogICB9XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgYW5pbWF0aW9uICh0aGlzIGlzIHdoYXQgdGhlIGNsYXNzLWJhc2VkIENTUyB2YWx1ZSB3aWxsIGJlIGNvbXBhcmVkIHRvKS5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZmFjdG9yeSBUaGUgZmFjdG9yeSBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgZXhlY3V0ZWQgdG8gcmV0dXJuIHRoZSBhbmltYXRpb25cbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QuXG4gICAqL1xuICB0aGlzLnJlZ2lzdGVyID0gZnVuY3Rpb24obmFtZSwgZmFjdG9yeSkge1xuICAgIGlmIChuYW1lICYmIG5hbWUuY2hhckF0KDApICE9PSAnLicpIHtcbiAgICAgIHRocm93ICRhbmltYXRlTWluRXJyKCdub3Rjc2VsJywgXCJFeHBlY3RpbmcgY2xhc3Mgc2VsZWN0b3Igc3RhcnRpbmcgd2l0aCAnLicgZ290ICd7MH0nLlwiLCBuYW1lKTtcbiAgICB9XG5cbiAgICB2YXIga2V5ID0gbmFtZSArICctYW5pbWF0aW9uJztcbiAgICBwcm92aWRlci4kJHJlZ2lzdGVyZWRBbmltYXRpb25zW25hbWUuc3Vic3RyKDEpXSA9IGtleTtcbiAgICAkcHJvdmlkZS5mYWN0b3J5KGtleSwgZmFjdG9yeSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGFuaW1hdGVQcm92aWRlciNjbGFzc05hbWVGaWx0ZXJcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFNldHMgYW5kL29yIHJldHVybnMgdGhlIENTUyBjbGFzcyByZWd1bGFyIGV4cHJlc3Npb24gdGhhdCBpcyBjaGVja2VkIHdoZW4gcGVyZm9ybWluZ1xuICAgKiBhbiBhbmltYXRpb24uIFVwb24gYm9vdHN0cmFwIHRoZSBjbGFzc05hbWVGaWx0ZXIgdmFsdWUgaXMgbm90IHNldCBhdCBhbGwgYW5kIHdpbGxcbiAgICogdGhlcmVmb3JlIGVuYWJsZSAkYW5pbWF0ZSB0byBhdHRlbXB0IHRvIHBlcmZvcm0gYW4gYW5pbWF0aW9uIG9uIGFueSBlbGVtZW50IHRoYXQgaXMgdHJpZ2dlcmVkLlxuICAgKiBXaGVuIHNldHRpbmcgdGhlIGBjbGFzc05hbWVGaWx0ZXJgIHZhbHVlLCBhbmltYXRpb25zIHdpbGwgb25seSBiZSBwZXJmb3JtZWQgb24gZWxlbWVudHNcbiAgICogdGhhdCBzdWNjZXNzZnVsbHkgbWF0Y2ggdGhlIGZpbHRlciBleHByZXNzaW9uLiBUaGlzIGluIHR1cm4gY2FuIGJvb3N0IHBlcmZvcm1hbmNlXG4gICAqIGZvciBsb3ctcG93ZXJlZCBkZXZpY2VzIGFzIHdlbGwgYXMgYXBwbGljYXRpb25zIGNvbnRhaW5pbmcgYSBsb3Qgb2Ygc3RydWN0dXJhbCBvcGVyYXRpb25zLlxuICAgKiBAcGFyYW0ge1JlZ0V4cD19IGV4cHJlc3Npb24gVGhlIGNsYXNzTmFtZSBleHByZXNzaW9uIHdoaWNoIHdpbGwgYmUgY2hlY2tlZCBhZ2FpbnN0IGFsbCBhbmltYXRpb25zXG4gICAqIEByZXR1cm4ge1JlZ0V4cH0gVGhlIGN1cnJlbnQgQ1NTIGNsYXNzTmFtZSBleHByZXNzaW9uIHZhbHVlLiBJZiBudWxsIHRoZW4gdGhlcmUgaXMgbm8gZXhwcmVzc2lvbiB2YWx1ZVxuICAgKi9cbiAgdGhpcy5jbGFzc05hbWVGaWx0ZXIgPSBmdW5jdGlvbihleHByZXNzaW9uKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgIHRoaXMuJCRjbGFzc05hbWVGaWx0ZXIgPSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIFJlZ0V4cCkgPyBleHByZXNzaW9uIDogbnVsbDtcbiAgICAgIGlmICh0aGlzLiQkY2xhc3NOYW1lRmlsdGVyKSB7XG4gICAgICAgIHZhciByZXNlcnZlZFJlZ2V4ID0gbmV3IFJlZ0V4cChcIihcXFxccyt8XFxcXC8pXCIgKyBOR19BTklNQVRFX0NMQVNTTkFNRSArIFwiKFxcXFxzK3xcXFxcLylcIik7XG4gICAgICAgIGlmIChyZXNlcnZlZFJlZ2V4LnRlc3QodGhpcy4kJGNsYXNzTmFtZUZpbHRlci50b1N0cmluZygpKSkge1xuICAgICAgICAgIHRocm93ICRhbmltYXRlTWluRXJyKCdub25nY2xzJywnJGFuaW1hdGVQcm92aWRlci5jbGFzc05hbWVGaWx0ZXIocmVnZXgpIHByb2hpYml0cyBhY2NlcHRpbmcgYSByZWdleCB2YWx1ZSB3aGljaCBtYXRjaGVzL2NvbnRhaW5zIHRoZSBcInswfVwiIENTUyBjbGFzcy4nLCBOR19BTklNQVRFX0NMQVNTTkFNRSk7XG5cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy4kJGNsYXNzTmFtZUZpbHRlcjtcbiAgfTtcblxuICB0aGlzLiRnZXQgPSBbJyQkYW5pbWF0ZVF1ZXVlJywgZnVuY3Rpb24oJCRhbmltYXRlUXVldWUpIHtcbiAgICBmdW5jdGlvbiBkb21JbnNlcnQoZWxlbWVudCwgcGFyZW50RWxlbWVudCwgYWZ0ZXJFbGVtZW50KSB7XG4gICAgICAvLyBpZiBmb3Igc29tZSByZWFzb24gdGhlIHByZXZpb3VzIGVsZW1lbnQgd2FzIHJlbW92ZWRcbiAgICAgIC8vIGZyb20gdGhlIGRvbSBzb21ldGltZSBiZWZvcmUgdGhpcyBjb2RlIHJ1bnMgdGhlbiBsZXQnc1xuICAgICAgLy8ganVzdCBzdGljayB0byB1c2luZyB0aGUgcGFyZW50IGVsZW1lbnQgYXMgdGhlIGFuY2hvclxuICAgICAgaWYgKGFmdGVyRWxlbWVudCkge1xuICAgICAgICB2YXIgYWZ0ZXJOb2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGFmdGVyRWxlbWVudCk7XG4gICAgICAgIGlmIChhZnRlck5vZGUgJiYgIWFmdGVyTm9kZS5wYXJlbnROb2RlICYmICFhZnRlck5vZGUucHJldmlvdXNFbGVtZW50U2libGluZykge1xuICAgICAgICAgIGFmdGVyRWxlbWVudCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGFmdGVyRWxlbWVudCA/IGFmdGVyRWxlbWVudC5hZnRlcihlbGVtZW50KSA6IHBhcmVudEVsZW1lbnQucHJlcGVuZChlbGVtZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2Mgc2VydmljZVxuICAgICAqIEBuYW1lICRhbmltYXRlXG4gICAgICogQGRlc2NyaXB0aW9uIFRoZSAkYW5pbWF0ZSBzZXJ2aWNlIGV4cG9zZXMgYSBzZXJpZXMgb2YgRE9NIHV0aWxpdHkgbWV0aG9kcyB0aGF0IHByb3ZpZGUgc3VwcG9ydFxuICAgICAqIGZvciBhbmltYXRpb24gaG9va3MuIFRoZSBkZWZhdWx0IGJlaGF2aW9yIGlzIHRoZSBhcHBsaWNhdGlvbiBvZiBET00gb3BlcmF0aW9ucywgaG93ZXZlcixcbiAgICAgKiB3aGVuIGFuIGFuaW1hdGlvbiBpcyBkZXRlY3RlZCAoYW5kIGFuaW1hdGlvbnMgYXJlIGVuYWJsZWQpLCAkYW5pbWF0ZSB3aWxsIGRvIHRoZSBoZWF2eSBsaWZ0aW5nXG4gICAgICogdG8gZW5zdXJlIHRoYXQgYW5pbWF0aW9uIHJ1bnMgd2l0aCB0aGUgdHJpZ2dlcmVkIERPTSBvcGVyYXRpb24uXG4gICAgICpcbiAgICAgKiBCeSBkZWZhdWx0ICRhbmltYXRlIGRvZXNuJ3QgdHJpZ2dlciBhbnkgYW5pbWF0aW9ucy4gVGhpcyBpcyBiZWNhdXNlIHRoZSBgbmdBbmltYXRlYCBtb2R1bGUgaXNuJ3RcbiAgICAgKiBpbmNsdWRlZCBhbmQgb25seSB3aGVuIGl0IGlzIGFjdGl2ZSB0aGVuIHRoZSBhbmltYXRpb24gaG9va3MgdGhhdCBgJGFuaW1hdGVgIHRyaWdnZXJzIHdpbGwgYmVcbiAgICAgKiBmdW5jdGlvbmFsLiBPbmNlIGFjdGl2ZSB0aGVuIGFsbCBzdHJ1Y3R1cmFsIGBuZy1gIGRpcmVjdGl2ZXMgd2lsbCB0cmlnZ2VyIGFuaW1hdGlvbnMgYXMgdGhleSBwZXJmb3JtXG4gICAgICogdGhlaXIgRE9NLXJlbGF0ZWQgb3BlcmF0aW9ucyAoZW50ZXIsIGxlYXZlIGFuZCBtb3ZlKS4gT3RoZXIgZGlyZWN0aXZlcyBzdWNoIGFzIGBuZ0NsYXNzYCxcbiAgICAgKiBgbmdTaG93YCwgYG5nSGlkZWAgYW5kIGBuZ01lc3NhZ2VzYCBhbHNvIHByb3ZpZGUgc3VwcG9ydCBmb3IgYW5pbWF0aW9ucy5cbiAgICAgKlxuICAgICAqIEl0IGlzIHJlY29tbWVuZGVkIHRoYXQgdGhlYCRhbmltYXRlYCBzZXJ2aWNlIGlzIGFsd2F5cyB1c2VkIHdoZW4gZXhlY3V0aW5nIERPTS1yZWxhdGVkIHByb2NlZHVyZXMgd2l0aGluIGRpcmVjdGl2ZXMuXG4gICAgICpcbiAgICAgKiBUbyBsZWFybiBtb3JlIGFib3V0IGVuYWJsaW5nIGFuaW1hdGlvbiBzdXBwb3J0LCBjbGljayBoZXJlIHRvIHZpc2l0IHRoZVxuICAgICAqIHtAbGluayBuZ0FuaW1hdGUgbmdBbmltYXRlIG1vZHVsZSBwYWdlfS5cbiAgICAgKi9cbiAgICByZXR1cm4ge1xuICAgICAgLy8gd2UgZG9uJ3QgY2FsbCBpdCBkaXJlY3RseSBzaW5jZSBub24tZXhpc3RhbnQgYXJndW1lbnRzIG1heVxuICAgICAgLy8gYmUgaW50ZXJwcmV0ZWQgYXMgbnVsbCB3aXRoaW4gdGhlIHN1YiBlbmFibGVkIGZ1bmN0aW9uXG5cbiAgICAgIC8qKlxuICAgICAgICpcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRhbmltYXRlI29uXG4gICAgICAgKiBAa2luZCBmdW5jdGlvblxuICAgICAgICogQGRlc2NyaXB0aW9uIFNldHMgdXAgYW4gZXZlbnQgbGlzdGVuZXIgdG8gZmlyZSB3aGVuZXZlciB0aGUgYW5pbWF0aW9uIGV2ZW50IChlbnRlciwgbGVhdmUsIG1vdmUsIGV0Yy4uLilcbiAgICAgICAqICAgIGhhcyBmaXJlZCBvbiB0aGUgZ2l2ZW4gZWxlbWVudCBvciBhbW9uZyBhbnkgb2YgaXRzIGNoaWxkcmVuLiBPbmNlIHRoZSBsaXN0ZW5lciBpcyBmaXJlZCwgdGhlIHByb3ZpZGVkIGNhbGxiYWNrXG4gICAgICAgKiAgICBpcyBmaXJlZCB3aXRoIHRoZSBmb2xsb3dpbmcgcGFyYW1zOlxuICAgICAgICpcbiAgICAgICAqIGBgYGpzXG4gICAgICAgKiAkYW5pbWF0ZS5vbignZW50ZXInLCBjb250YWluZXIsXG4gICAgICAgKiAgICBmdW5jdGlvbiBjYWxsYmFjayhlbGVtZW50LCBwaGFzZSkge1xuICAgICAgICogICAgICAvLyBjb29sIHdlIGRldGVjdGVkIGFuIGVudGVyIGFuaW1hdGlvbiB3aXRoaW4gdGhlIGNvbnRhaW5lclxuICAgICAgICogICAgfVxuICAgICAgICogKTtcbiAgICAgICAqIGBgYFxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudCB0aGUgYW5pbWF0aW9uIGV2ZW50IHRoYXQgd2lsbCBiZSBjYXB0dXJlZCAoZS5nLiBlbnRlciwgbGVhdmUsIG1vdmUsIGFkZENsYXNzLCByZW1vdmVDbGFzcywgZXRjLi4uKVxuICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBjb250YWluZXIgdGhlIGNvbnRhaW5lciBlbGVtZW50IHRoYXQgd2lsbCBjYXB0dXJlIGVhY2ggb2YgdGhlIGFuaW1hdGlvbiBldmVudHMgdGhhdCBhcmUgZmlyZWQgb24gaXRzZWxmXG4gICAgICAgKiAgICAgYXMgd2VsbCBhcyBhbW9uZyBpdHMgY2hpbGRyZW5cbiAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIHRoZSBjYWxsYmFjayBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgZmlyZWQgd2hlbiB0aGUgbGlzdGVuZXIgaXMgdHJpZ2dlcmVkXG4gICAgICAgKlxuICAgICAgICogVGhlIGFyZ3VtZW50cyBwcmVzZW50IGluIHRoZSBjYWxsYmFjayBmdW5jdGlvbiBhcmU6XG4gICAgICAgKiAqIGBlbGVtZW50YCAtIFRoZSBjYXB0dXJlZCBET00gZWxlbWVudCB0aGF0IHRoZSBhbmltYXRpb24gd2FzIGZpcmVkIG9uLlxuICAgICAgICogKiBgcGhhc2VgIC0gVGhlIHBoYXNlIG9mIHRoZSBhbmltYXRpb24uIFRoZSB0d28gcG9zc2libGUgcGhhc2VzIGFyZSAqKnN0YXJ0KiogKHdoZW4gdGhlIGFuaW1hdGlvbiBzdGFydHMpIGFuZCAqKmNsb3NlKiogKHdoZW4gaXQgZW5kcykuXG4gICAgICAgKi9cbiAgICAgIG9uOiAkJGFuaW1hdGVRdWV1ZS5vbixcblxuICAgICAgLyoqXG4gICAgICAgKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJGFuaW1hdGUjb2ZmXG4gICAgICAgKiBAa2luZCBmdW5jdGlvblxuICAgICAgICogQGRlc2NyaXB0aW9uIERlcmVnaXN0ZXJzIGFuIGV2ZW50IGxpc3RlbmVyIGJhc2VkIG9uIHRoZSBldmVudCB3aGljaCBoYXMgYmVlbiBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIGVsZW1lbnQuIFRoaXMgbWV0aG9kXG4gICAgICAgKiBjYW4gYmUgdXNlZCBpbiB0aHJlZSBkaWZmZXJlbnQgd2F5cyBkZXBlbmRpbmcgb24gdGhlIGFyZ3VtZW50czpcbiAgICAgICAqXG4gICAgICAgKiBgYGBqc1xuICAgICAgICogLy8gcmVtb3ZlIGFsbCB0aGUgYW5pbWF0aW9uIGV2ZW50IGxpc3RlbmVycyBsaXN0ZW5pbmcgZm9yIGBlbnRlcmBcbiAgICAgICAqICRhbmltYXRlLm9mZignZW50ZXInKTtcbiAgICAgICAqXG4gICAgICAgKiAvLyByZW1vdmUgYWxsIHRoZSBhbmltYXRpb24gZXZlbnQgbGlzdGVuZXJzIGxpc3RlbmluZyBmb3IgYGVudGVyYCBvbiB0aGUgZ2l2ZW4gZWxlbWVudCBhbmQgaXRzIGNoaWxkcmVuXG4gICAgICAgKiAkYW5pbWF0ZS5vZmYoJ2VudGVyJywgY29udGFpbmVyKTtcbiAgICAgICAqXG4gICAgICAgKiAvLyByZW1vdmUgdGhlIGV2ZW50IGxpc3RlbmVyIGZ1bmN0aW9uIHByb3ZpZGVkIGJ5IGBjYWxsYmFja2AgdGhhdCBpcyBzZXRcbiAgICAgICAqIC8vIHRvIGxpc3RlbiBmb3IgYGVudGVyYCBvbiB0aGUgZ2l2ZW4gYGNvbnRhaW5lcmAgYXMgd2VsbCBhcyBpdHMgY2hpbGRyZW5cbiAgICAgICAqICRhbmltYXRlLm9mZignZW50ZXInLCBjb250YWluZXIsIGNhbGxiYWNrKTtcbiAgICAgICAqIGBgYFxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudCB0aGUgYW5pbWF0aW9uIGV2ZW50IChlLmcuIGVudGVyLCBsZWF2ZSwgbW92ZSwgYWRkQ2xhc3MsIHJlbW92ZUNsYXNzLCBldGMuLi4pXG4gICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnQ9fSBjb250YWluZXIgdGhlIGNvbnRhaW5lciBlbGVtZW50IHRoZSBldmVudCBsaXN0ZW5lciB3YXMgcGxhY2VkIG9uXG4gICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY2FsbGJhY2sgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgd2FzIHJlZ2lzdGVyZWQgYXMgdGhlIGxpc3RlbmVyXG4gICAgICAgKi9cbiAgICAgIG9mZjogJCRhbmltYXRlUXVldWUub2ZmLFxuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRhbmltYXRlI3BpblxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqIEBkZXNjcmlwdGlvbiBBc3NvY2lhdGVzIHRoZSBwcm92aWRlZCBlbGVtZW50IHdpdGggYSBob3N0IHBhcmVudCBlbGVtZW50IHRvIGFsbG93IHRoZSBlbGVtZW50IHRvIGJlIGFuaW1hdGVkIGV2ZW4gaWYgaXQgZXhpc3RzXG4gICAgICAgKiAgICBvdXRzaWRlIG9mIHRoZSBET00gc3RydWN0dXJlIG9mIHRoZSBBbmd1bGFyIGFwcGxpY2F0aW9uLiBCeSBkb2luZyBzbywgYW55IGFuaW1hdGlvbiB0cmlnZ2VyZWQgdmlhIGAkYW5pbWF0ZWAgY2FuIGJlIGlzc3VlZCBvbiB0aGVcbiAgICAgICAqICAgIGVsZW1lbnQgZGVzcGl0ZSBiZWluZyBvdXRzaWRlIHRoZSByZWFsbSBvZiB0aGUgYXBwbGljYXRpb24gb3Igd2l0aGluIGFub3RoZXIgYXBwbGljYXRpb24uIFNheSBmb3IgZXhhbXBsZSBpZiB0aGUgYXBwbGljYXRpb25cbiAgICAgICAqICAgIHdhcyBib290c3RyYXBwZWQgb24gYW4gZWxlbWVudCB0aGF0IGlzIHNvbWV3aGVyZSBpbnNpZGUgb2YgdGhlIGA8Ym9keT5gIHRhZywgYnV0IHdlIHdhbnRlZCB0byBhbGxvdyBmb3IgYW4gZWxlbWVudCB0byBiZSBzaXR1YXRlZFxuICAgICAgICogICAgYXMgYSBkaXJlY3QgY2hpbGQgb2YgYGRvY3VtZW50LmJvZHlgLCB0aGVuIHRoaXMgY2FuIGJlIGFjaGlldmVkIGJ5IHBpbm5pbmcgdGhlIGVsZW1lbnQgdmlhIGAkYW5pbWF0ZS5waW4oZWxlbWVudClgLiBLZWVwIGluIG1pbmRcbiAgICAgICAqICAgIHRoYXQgY2FsbGluZyBgJGFuaW1hdGUucGluKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQpYCB3aWxsIG5vdCBhY3R1YWxseSBpbnNlcnQgaW50byB0aGUgRE9NIGFueXdoZXJlOyBpdCB3aWxsIGp1c3QgY3JlYXRlIHRoZSBhc3NvY2lhdGlvbi5cbiAgICAgICAqXG4gICAgICAgKiAgICBOb3RlIHRoYXQgdGhpcyBmZWF0dXJlIGlzIG9ubHkgYWN0aXZlIHdoZW4gdGhlIGBuZ0FuaW1hdGVgIG1vZHVsZSBpcyB1c2VkLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZXh0ZXJuYWwgZWxlbWVudCB0aGF0IHdpbGwgYmUgcGlubmVkXG4gICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IHBhcmVudEVsZW1lbnQgdGhlIGhvc3QgcGFyZW50IGVsZW1lbnQgdGhhdCB3aWxsIGJlIGFzc29jaWF0ZWQgd2l0aCB0aGUgZXh0ZXJuYWwgZWxlbWVudFxuICAgICAgICovXG4gICAgICBwaW46ICQkYW5pbWF0ZVF1ZXVlLnBpbixcblxuICAgICAgLyoqXG4gICAgICAgKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJGFuaW1hdGUjZW5hYmxlZFxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqIEBkZXNjcmlwdGlvbiBVc2VkIHRvIGdldCBhbmQgc2V0IHdoZXRoZXIgYW5pbWF0aW9ucyBhcmUgZW5hYmxlZCBvciBub3Qgb24gdGhlIGVudGlyZSBhcHBsaWNhdGlvbiBvciBvbiBhbiBlbGVtZW50IGFuZCBpdHMgY2hpbGRyZW4uIFRoaXNcbiAgICAgICAqIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgaW4gZm91ciB3YXlzOlxuICAgICAgICpcbiAgICAgICAqIGBgYGpzXG4gICAgICAgKiAvLyByZXR1cm5zIHRydWUgb3IgZmFsc2VcbiAgICAgICAqICRhbmltYXRlLmVuYWJsZWQoKTtcbiAgICAgICAqXG4gICAgICAgKiAvLyBjaGFuZ2VzIHRoZSBlbmFibGVkIHN0YXRlIGZvciBhbGwgYW5pbWF0aW9uc1xuICAgICAgICogJGFuaW1hdGUuZW5hYmxlZChmYWxzZSk7XG4gICAgICAgKiAkYW5pbWF0ZS5lbmFibGVkKHRydWUpO1xuICAgICAgICpcbiAgICAgICAqIC8vIHJldHVybnMgdHJ1ZSBvciBmYWxzZSBpZiBhbmltYXRpb25zIGFyZSBlbmFibGVkIGZvciBhbiBlbGVtZW50XG4gICAgICAgKiAkYW5pbWF0ZS5lbmFibGVkKGVsZW1lbnQpO1xuICAgICAgICpcbiAgICAgICAqIC8vIGNoYW5nZXMgdGhlIGVuYWJsZWQgc3RhdGUgZm9yIGFuIGVsZW1lbnQgYW5kIGl0cyBjaGlsZHJlblxuICAgICAgICogJGFuaW1hdGUuZW5hYmxlZChlbGVtZW50LCB0cnVlKTtcbiAgICAgICAqICRhbmltYXRlLmVuYWJsZWQoZWxlbWVudCwgZmFsc2UpO1xuICAgICAgICogYGBgXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtET01FbGVtZW50PX0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgY29uc2lkZXJlZCBmb3IgY2hlY2tpbmcvc2V0dGluZyB0aGUgZW5hYmxlZCBzdGF0ZVxuICAgICAgICogQHBhcmFtIHtib29sZWFuPX0gZW5hYmxlZCB3aGV0aGVyIG9yIG5vdCB0aGUgYW5pbWF0aW9ucyB3aWxsIGJlIGVuYWJsZWQgZm9yIHRoZSBlbGVtZW50XG4gICAgICAgKlxuICAgICAgICogQHJldHVybiB7Ym9vbGVhbn0gd2hldGhlciBvciBub3QgYW5pbWF0aW9ucyBhcmUgZW5hYmxlZFxuICAgICAgICovXG4gICAgICBlbmFibGVkOiAkJGFuaW1hdGVRdWV1ZS5lbmFibGVkLFxuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRhbmltYXRlI2NhbmNlbFxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqIEBkZXNjcmlwdGlvbiBDYW5jZWxzIHRoZSBwcm92aWRlZCBhbmltYXRpb24uXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtQcm9taXNlfSBhbmltYXRpb25Qcm9taXNlIFRoZSBhbmltYXRpb24gcHJvbWlzZSB0aGF0IGlzIHJldHVybmVkIHdoZW4gYW4gYW5pbWF0aW9uIGlzIHN0YXJ0ZWQuXG4gICAgICAgKi9cbiAgICAgIGNhbmNlbDogZnVuY3Rpb24ocnVubmVyKSB7XG4gICAgICAgIHJ1bm5lci5lbmQgJiYgcnVubmVyLmVuZCgpO1xuICAgICAgfSxcblxuICAgICAgLyoqXG4gICAgICAgKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJGFuaW1hdGUjZW50ZXJcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKiBAZGVzY3JpcHRpb24gSW5zZXJ0cyB0aGUgZWxlbWVudCBpbnRvIHRoZSBET00gZWl0aGVyIGFmdGVyIHRoZSBgYWZ0ZXJgIGVsZW1lbnQgKGlmIHByb3ZpZGVkKSBvclxuICAgICAgICogICBhcyB0aGUgZmlyc3QgY2hpbGQgd2l0aGluIHRoZSBgcGFyZW50YCBlbGVtZW50IGFuZCB0aGVuIHRyaWdnZXJzIGFuIGFuaW1hdGlvbi5cbiAgICAgICAqICAgQSBwcm9taXNlIGlzIHJldHVybmVkIHRoYXQgd2lsbCBiZSByZXNvbHZlZCBkdXJpbmcgdGhlIG5leHQgZGlnZXN0IG9uY2UgdGhlIGFuaW1hdGlvblxuICAgICAgICogICBoYXMgY29tcGxldGVkLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB3aGljaCB3aWxsIGJlIGluc2VydGVkIGludG8gdGhlIERPTVxuICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBwYXJlbnQgdGhlIHBhcmVudCBlbGVtZW50IHdoaWNoIHdpbGwgYXBwZW5kIHRoZSBlbGVtZW50IGFzXG4gICAgICAgKiAgIGEgY2hpbGQgKHNvIGxvbmcgYXMgdGhlIGFmdGVyIGVsZW1lbnQgaXMgbm90IHByZXNlbnQpXG4gICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnQ9fSBhZnRlciB0aGUgc2libGluZyBlbGVtZW50IGFmdGVyIHdoaWNoIHRoZSBlbGVtZW50IHdpbGwgYmUgYXBwZW5kZWRcbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIG9wdGlvbnMvc3R5bGVzIHRoYXQgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50XG4gICAgICAgKlxuICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXG4gICAgICAgKi9cbiAgICAgIGVudGVyOiBmdW5jdGlvbihlbGVtZW50LCBwYXJlbnQsIGFmdGVyLCBvcHRpb25zKSB7XG4gICAgICAgIHBhcmVudCA9IHBhcmVudCAmJiBqcUxpdGUocGFyZW50KTtcbiAgICAgICAgYWZ0ZXIgPSBhZnRlciAmJiBqcUxpdGUoYWZ0ZXIpO1xuICAgICAgICBwYXJlbnQgPSBwYXJlbnQgfHwgYWZ0ZXIucGFyZW50KCk7XG4gICAgICAgIGRvbUluc2VydChlbGVtZW50LCBwYXJlbnQsIGFmdGVyKTtcbiAgICAgICAgcmV0dXJuICQkYW5pbWF0ZVF1ZXVlLnB1c2goZWxlbWVudCwgJ2VudGVyJywgcHJlcGFyZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpKTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICpcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRhbmltYXRlI21vdmVcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKiBAZGVzY3JpcHRpb24gSW5zZXJ0cyAobW92ZXMpIHRoZSBlbGVtZW50IGludG8gaXRzIG5ldyBwb3NpdGlvbiBpbiB0aGUgRE9NIGVpdGhlciBhZnRlclxuICAgICAgICogICB0aGUgYGFmdGVyYCBlbGVtZW50IChpZiBwcm92aWRlZCkgb3IgYXMgdGhlIGZpcnN0IGNoaWxkIHdpdGhpbiB0aGUgYHBhcmVudGAgZWxlbWVudFxuICAgICAgICogICBhbmQgdGhlbiB0cmlnZ2VycyBhbiBhbmltYXRpb24uIEEgcHJvbWlzZSBpcyByZXR1cm5lZCB0aGF0IHdpbGwgYmUgcmVzb2x2ZWRcbiAgICAgICAqICAgZHVyaW5nIHRoZSBuZXh0IGRpZ2VzdCBvbmNlIHRoZSBhbmltYXRpb24gaGFzIGNvbXBsZXRlZC5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgd2hpY2ggd2lsbCBiZSBtb3ZlZCBpbnRvIHRoZSBuZXcgRE9NIHBvc2l0aW9uXG4gICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IHBhcmVudCB0aGUgcGFyZW50IGVsZW1lbnQgd2hpY2ggd2lsbCBhcHBlbmQgdGhlIGVsZW1lbnQgYXNcbiAgICAgICAqICAgYSBjaGlsZCAoc28gbG9uZyBhcyB0aGUgYWZ0ZXIgZWxlbWVudCBpcyBub3QgcHJlc2VudClcbiAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudD19IGFmdGVyIHRoZSBzaWJsaW5nIGVsZW1lbnQgYWZ0ZXIgd2hpY2ggdGhlIGVsZW1lbnQgd2lsbCBiZSBhcHBlbmRlZFxuICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygb3B0aW9ucy9zdHlsZXMgdGhhdCB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnRcbiAgICAgICAqXG4gICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSB0aGUgYW5pbWF0aW9uIGNhbGxiYWNrIHByb21pc2VcbiAgICAgICAqL1xuICAgICAgbW92ZTogZnVuY3Rpb24oZWxlbWVudCwgcGFyZW50LCBhZnRlciwgb3B0aW9ucykge1xuICAgICAgICBwYXJlbnQgPSBwYXJlbnQgJiYganFMaXRlKHBhcmVudCk7XG4gICAgICAgIGFmdGVyID0gYWZ0ZXIgJiYganFMaXRlKGFmdGVyKTtcbiAgICAgICAgcGFyZW50ID0gcGFyZW50IHx8IGFmdGVyLnBhcmVudCgpO1xuICAgICAgICBkb21JbnNlcnQoZWxlbWVudCwgcGFyZW50LCBhZnRlcik7XG4gICAgICAgIHJldHVybiAkJGFuaW1hdGVRdWV1ZS5wdXNoKGVsZW1lbnQsICdtb3ZlJywgcHJlcGFyZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpKTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJGFuaW1hdGUjbGVhdmVcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKiBAZGVzY3JpcHRpb24gVHJpZ2dlcnMgYW4gYW5pbWF0aW9uIGFuZCB0aGVuIHJlbW92ZXMgdGhlIGVsZW1lbnQgZnJvbSB0aGUgRE9NLlxuICAgICAgICogV2hlbiB0aGUgZnVuY3Rpb24gaXMgY2FsbGVkIGEgcHJvbWlzZSBpcyByZXR1cm5lZCB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgZHVyaW5nIHRoZSBuZXh0XG4gICAgICAgKiBkaWdlc3Qgb25jZSB0aGUgYW5pbWF0aW9uIGhhcyBjb21wbGV0ZWQuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHdoaWNoIHdpbGwgYmUgcmVtb3ZlZCBmcm9tIHRoZSBET01cbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIG9wdGlvbnMvc3R5bGVzIHRoYXQgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50XG4gICAgICAgKlxuICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXG4gICAgICAgKi9cbiAgICAgIGxlYXZlOiBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiAkJGFuaW1hdGVRdWV1ZS5wdXNoKGVsZW1lbnQsICdsZWF2ZScsIHByZXBhcmVBbmltYXRlT3B0aW9ucyhvcHRpb25zKSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRhbmltYXRlI2FkZENsYXNzXG4gICAgICAgKiBAa2luZCBmdW5jdGlvblxuICAgICAgICpcbiAgICAgICAqIEBkZXNjcmlwdGlvbiBUcmlnZ2VycyBhbiBhZGRDbGFzcyBhbmltYXRpb24gc3Vycm91bmRpbmcgdGhlIGFkZGl0aW9uIG9mIHRoZSBwcm92aWRlZCBDU1MgY2xhc3MoZXMpLiBVcG9uXG4gICAgICAgKiAgIGV4ZWN1dGlvbiwgdGhlIGFkZENsYXNzIG9wZXJhdGlvbiB3aWxsIG9ubHkgYmUgaGFuZGxlZCBhZnRlciB0aGUgbmV4dCBkaWdlc3QgYW5kIGl0IHdpbGwgbm90IHRyaWdnZXIgYW5cbiAgICAgICAqICAgYW5pbWF0aW9uIGlmIGVsZW1lbnQgYWxyZWFkeSBjb250YWlucyB0aGUgQ1NTIGNsYXNzIG9yIGlmIHRoZSBjbGFzcyBpcyByZW1vdmVkIGF0IGEgbGF0ZXIgc3RlcC5cbiAgICAgICAqICAgTm90ZSB0aGF0IGNsYXNzLWJhc2VkIGFuaW1hdGlvbnMgYXJlIHRyZWF0ZWQgZGlmZmVyZW50bHkgY29tcGFyZWQgdG8gc3RydWN0dXJhbCBhbmltYXRpb25zXG4gICAgICAgKiAgIChsaWtlIGVudGVyLCBtb3ZlIGFuZCBsZWF2ZSkgc2luY2UgdGhlIENTUyBjbGFzc2VzIG1heSBiZSBhZGRlZC9yZW1vdmVkIGF0IGRpZmZlcmVudCBwb2ludHNcbiAgICAgICAqICAgZGVwZW5kaW5nIGlmIENTUyBvciBKYXZhU2NyaXB0IGFuaW1hdGlvbnMgYXJlIHVzZWQuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHdoaWNoIHRoZSBDU1MgY2xhc3NlcyB3aWxsIGJlIGFwcGxpZWQgdG9cbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjbGFzc05hbWUgdGhlIENTUyBjbGFzcyhlcykgdGhhdCB3aWxsIGJlIGFkZGVkIChtdWx0aXBsZSBjbGFzc2VzIGFyZSBzZXBhcmF0ZWQgdmlhIHNwYWNlcylcbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIG9wdGlvbnMvc3R5bGVzIHRoYXQgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50XG4gICAgICAgKlxuICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXG4gICAgICAgKi9cbiAgICAgIGFkZENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIG9wdGlvbnMpIHtcbiAgICAgICAgb3B0aW9ucyA9IHByZXBhcmVBbmltYXRlT3B0aW9ucyhvcHRpb25zKTtcbiAgICAgICAgb3B0aW9ucy5hZGRDbGFzcyA9IG1lcmdlQ2xhc3NlcyhvcHRpb25zLmFkZGNsYXNzLCBjbGFzc05hbWUpO1xuICAgICAgICByZXR1cm4gJCRhbmltYXRlUXVldWUucHVzaChlbGVtZW50LCAnYWRkQ2xhc3MnLCBvcHRpb25zKTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJGFuaW1hdGUjcmVtb3ZlQ2xhc3NcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uIFRyaWdnZXJzIGEgcmVtb3ZlQ2xhc3MgYW5pbWF0aW9uIHN1cnJvdW5kaW5nIHRoZSByZW1vdmFsIG9mIHRoZSBwcm92aWRlZCBDU1MgY2xhc3MoZXMpLiBVcG9uXG4gICAgICAgKiAgIGV4ZWN1dGlvbiwgdGhlIHJlbW92ZUNsYXNzIG9wZXJhdGlvbiB3aWxsIG9ubHkgYmUgaGFuZGxlZCBhZnRlciB0aGUgbmV4dCBkaWdlc3QgYW5kIGl0IHdpbGwgbm90IHRyaWdnZXIgYW5cbiAgICAgICAqICAgYW5pbWF0aW9uIGlmIGVsZW1lbnQgZG9lcyBub3QgY29udGFpbiB0aGUgQ1NTIGNsYXNzIG9yIGlmIHRoZSBjbGFzcyBpcyBhZGRlZCBhdCBhIGxhdGVyIHN0ZXAuXG4gICAgICAgKiAgIE5vdGUgdGhhdCBjbGFzcy1iYXNlZCBhbmltYXRpb25zIGFyZSB0cmVhdGVkIGRpZmZlcmVudGx5IGNvbXBhcmVkIHRvIHN0cnVjdHVyYWwgYW5pbWF0aW9uc1xuICAgICAgICogICAobGlrZSBlbnRlciwgbW92ZSBhbmQgbGVhdmUpIHNpbmNlIHRoZSBDU1MgY2xhc3NlcyBtYXkgYmUgYWRkZWQvcmVtb3ZlZCBhdCBkaWZmZXJlbnQgcG9pbnRzXG4gICAgICAgKiAgIGRlcGVuZGluZyBpZiBDU1Mgb3IgSmF2YVNjcmlwdCBhbmltYXRpb25zIGFyZSB1c2VkLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB3aGljaCB0aGUgQ1NTIGNsYXNzZXMgd2lsbCBiZSBhcHBsaWVkIHRvXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NOYW1lIHRoZSBDU1MgY2xhc3MoZXMpIHRoYXQgd2lsbCBiZSByZW1vdmVkIChtdWx0aXBsZSBjbGFzc2VzIGFyZSBzZXBhcmF0ZWQgdmlhIHNwYWNlcylcbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIG9wdGlvbnMvc3R5bGVzIHRoYXQgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50XG4gICAgICAgKlxuICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXG4gICAgICAgKi9cbiAgICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIG9wdGlvbnMpIHtcbiAgICAgICAgb3B0aW9ucyA9IHByZXBhcmVBbmltYXRlT3B0aW9ucyhvcHRpb25zKTtcbiAgICAgICAgb3B0aW9ucy5yZW1vdmVDbGFzcyA9IG1lcmdlQ2xhc3NlcyhvcHRpb25zLnJlbW92ZUNsYXNzLCBjbGFzc05hbWUpO1xuICAgICAgICByZXR1cm4gJCRhbmltYXRlUXVldWUucHVzaChlbGVtZW50LCAncmVtb3ZlQ2xhc3MnLCBvcHRpb25zKTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJGFuaW1hdGUjc2V0Q2xhc3NcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uIFBlcmZvcm1zIGJvdGggdGhlIGFkZGl0aW9uIGFuZCByZW1vdmFsIG9mIGEgQ1NTIGNsYXNzZXMgb24gYW4gZWxlbWVudCBhbmQgKGR1cmluZyB0aGUgcHJvY2VzcylcbiAgICAgICAqICAgIHRyaWdnZXJzIGFuIGFuaW1hdGlvbiBzdXJyb3VuZGluZyB0aGUgY2xhc3MgYWRkaXRpb24vcmVtb3ZhbC4gTXVjaCBsaWtlIGAkYW5pbWF0ZS5hZGRDbGFzc2AgYW5kXG4gICAgICAgKiAgICBgJGFuaW1hdGUucmVtb3ZlQ2xhc3NgLCBgc2V0Q2xhc3NgIHdpbGwgb25seSBldmFsdWF0ZSB0aGUgY2xhc3NlcyBiZWluZyBhZGRlZC9yZW1vdmVkIG9uY2UgYSBkaWdlc3QgaGFzXG4gICAgICAgKiAgICBwYXNzZWQuIE5vdGUgdGhhdCBjbGFzcy1iYXNlZCBhbmltYXRpb25zIGFyZSB0cmVhdGVkIGRpZmZlcmVudGx5IGNvbXBhcmVkIHRvIHN0cnVjdHVyYWwgYW5pbWF0aW9uc1xuICAgICAgICogICAgKGxpa2UgZW50ZXIsIG1vdmUgYW5kIGxlYXZlKSBzaW5jZSB0aGUgQ1NTIGNsYXNzZXMgbWF5IGJlIGFkZGVkL3JlbW92ZWQgYXQgZGlmZmVyZW50IHBvaW50c1xuICAgICAgICogICAgZGVwZW5kaW5nIGlmIENTUyBvciBKYXZhU2NyaXB0IGFuaW1hdGlvbnMgYXJlIHVzZWQuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHdoaWNoIHRoZSBDU1MgY2xhc3NlcyB3aWxsIGJlIGFwcGxpZWQgdG9cbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhZGQgdGhlIENTUyBjbGFzcyhlcykgdGhhdCB3aWxsIGJlIGFkZGVkIChtdWx0aXBsZSBjbGFzc2VzIGFyZSBzZXBhcmF0ZWQgdmlhIHNwYWNlcylcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZW1vdmUgdGhlIENTUyBjbGFzcyhlcykgdGhhdCB3aWxsIGJlIHJlbW92ZWQgKG11bHRpcGxlIGNsYXNzZXMgYXJlIHNlcGFyYXRlZCB2aWEgc3BhY2VzKVxuICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygb3B0aW9ucy9zdHlsZXMgdGhhdCB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnRcbiAgICAgICAqXG4gICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSB0aGUgYW5pbWF0aW9uIGNhbGxiYWNrIHByb21pc2VcbiAgICAgICAqL1xuICAgICAgc2V0Q2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGFkZCwgcmVtb3ZlLCBvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMgPSBwcmVwYXJlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucyk7XG4gICAgICAgIG9wdGlvbnMuYWRkQ2xhc3MgPSBtZXJnZUNsYXNzZXMob3B0aW9ucy5hZGRDbGFzcywgYWRkKTtcbiAgICAgICAgb3B0aW9ucy5yZW1vdmVDbGFzcyA9IG1lcmdlQ2xhc3NlcyhvcHRpb25zLnJlbW92ZUNsYXNzLCByZW1vdmUpO1xuICAgICAgICByZXR1cm4gJCRhbmltYXRlUXVldWUucHVzaChlbGVtZW50LCAnc2V0Q2xhc3MnLCBvcHRpb25zKTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJGFuaW1hdGUjYW5pbWF0ZVxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb24gUGVyZm9ybXMgYW4gaW5saW5lIGFuaW1hdGlvbiBvbiB0aGUgZWxlbWVudCB3aGljaCBhcHBsaWVzIHRoZSBwcm92aWRlZCB0byBhbmQgZnJvbSBDU1Mgc3R5bGVzIHRvIHRoZSBlbGVtZW50LlxuICAgICAgICogSWYgYW55IGRldGVjdGVkIENTUyB0cmFuc2l0aW9uLCBrZXlmcmFtZSBvciBKYXZhU2NyaXB0IG1hdGNoZXMgdGhlIHByb3ZpZGVkIGNsYXNzTmFtZSB2YWx1ZSwgdGhlbiB0aGUgYW5pbWF0aW9uIHdpbGwgdGFrZVxuICAgICAgICogb24gdGhlIHByb3ZpZGVkIHN0eWxlcy4gRm9yIGV4YW1wbGUsIGlmIGEgdHJhbnNpdGlvbiBhbmltYXRpb24gaXMgc2V0IGZvciB0aGUgZ2l2ZW4gY2xhc3NOYW1lbSwgdGhlbiB0aGUgcHJvdmlkZWQgYGZyb21gIGFuZFxuICAgICAgICogYHRvYCBzdHlsZXMgd2lsbCBiZSBhcHBsaWVkIGFsb25nc2lkZSB0aGUgZ2l2ZW4gdHJhbnNpdGlvbi4gSWYgdGhlIENTUyBzdHlsZSBwcm92aWRlZCBpbiBgZnJvbWAgZG9lcyBub3QgaGF2ZSBhIGNvcnJlc3BvbmRpbmdcbiAgICAgICAqIHN0eWxlIGluIGB0b2AsIHRoZSBzdHlsZSBpbiBgZnJvbWAgaXMgYXBwbGllZCBpbW1lZGlhdGVseSwgYW5kIG5vIGFuaW1hdGlvbiBpcyBydW4uXG4gICAgICAgKiBJZiBhIEphdmFTY3JpcHQgYW5pbWF0aW9uIGlzIGRldGVjdGVkIHRoZW4gdGhlIHByb3ZpZGVkIHN0eWxlcyB3aWxsIGJlIGdpdmVuIGluIGFzIGZ1bmN0aW9uIHBhcmFtZXRlcnMgaW50byB0aGUgYGFuaW1hdGVgXG4gICAgICAgKiBtZXRob2QgKG9yIGFzIHBhcnQgb2YgdGhlIGBvcHRpb25zYCBwYXJhbWV0ZXIpOlxuICAgICAgICpcbiAgICAgICAqIGBgYGpzXG4gICAgICAgKiBuZ01vZHVsZS5hbmltYXRpb24oJy5teS1pbmxpbmUtYW5pbWF0aW9uJywgZnVuY3Rpb24oKSB7XG4gICAgICAgKiAgIHJldHVybiB7XG4gICAgICAgKiAgICAgYW5pbWF0ZSA6IGZ1bmN0aW9uKGVsZW1lbnQsIGZyb20sIHRvLCBkb25lLCBvcHRpb25zKSB7XG4gICAgICAgKiAgICAgICAvL2FuaW1hdGlvblxuICAgICAgICogICAgICAgZG9uZSgpO1xuICAgICAgICogICAgIH1cbiAgICAgICAqICAgfVxuICAgICAgICogfSk7XG4gICAgICAgKiBgYGBcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgd2hpY2ggdGhlIENTUyBzdHlsZXMgd2lsbCBiZSBhcHBsaWVkIHRvXG4gICAgICAgKiBAcGFyYW0ge29iamVjdH0gZnJvbSB0aGUgZnJvbSAoc3RhcnRpbmcpIENTUyBzdHlsZXMgdGhhdCB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnQgYW5kIGFjcm9zcyB0aGUgYW5pbWF0aW9uLlxuICAgICAgICogQHBhcmFtIHtvYmplY3R9IHRvIHRoZSB0byAoZGVzdGluYXRpb24pIENTUyBzdHlsZXMgdGhhdCB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnQgYW5kIGFjcm9zcyB0aGUgYW5pbWF0aW9uLlxuICAgICAgICogQHBhcmFtIHtzdHJpbmc9fSBjbGFzc05hbWUgYW4gb3B0aW9uYWwgQ1NTIGNsYXNzIHRoYXQgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50IGZvciB0aGUgZHVyYXRpb24gb2YgdGhlIGFuaW1hdGlvbi4gSWZcbiAgICAgICAqICAgIHRoaXMgdmFsdWUgaXMgbGVmdCBhcyBlbXB0eSB0aGVuIGEgQ1NTIGNsYXNzIG9mIGBuZy1pbmxpbmUtYW5pbWF0ZWAgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBlbGVtZW50LlxuICAgICAgICogICAgKE5vdGUgdGhhdCBpZiBubyBhbmltYXRpb24gaXMgZGV0ZWN0ZWQgdGhlbiB0aGlzIHZhbHVlIHdpbGwgbm90IGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnQuKVxuICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygb3B0aW9ucy9zdHlsZXMgdGhhdCB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnRcbiAgICAgICAqXG4gICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSB0aGUgYW5pbWF0aW9uIGNhbGxiYWNrIHByb21pc2VcbiAgICAgICAqL1xuICAgICAgYW5pbWF0ZTogZnVuY3Rpb24oZWxlbWVudCwgZnJvbSwgdG8sIGNsYXNzTmFtZSwgb3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gcHJlcGFyZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpO1xuICAgICAgICBvcHRpb25zLmZyb20gPSBvcHRpb25zLmZyb20gPyBleHRlbmQob3B0aW9ucy5mcm9tLCBmcm9tKSA6IGZyb207XG4gICAgICAgIG9wdGlvbnMudG8gICA9IG9wdGlvbnMudG8gICA/IGV4dGVuZChvcHRpb25zLnRvLCB0bykgICAgIDogdG87XG5cbiAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lIHx8ICduZy1pbmxpbmUtYW5pbWF0ZSc7XG4gICAgICAgIG9wdGlvbnMudGVtcENsYXNzZXMgPSBtZXJnZUNsYXNzZXMob3B0aW9ucy50ZW1wQ2xhc3NlcywgY2xhc3NOYW1lKTtcbiAgICAgICAgcmV0dXJuICQkYW5pbWF0ZVF1ZXVlLnB1c2goZWxlbWVudCwgJ2FuaW1hdGUnLCBvcHRpb25zKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XTtcbn1dO1xuXG52YXIgJCRBbmltYXRlQXN5bmNSdW5GYWN0b3J5UHJvdmlkZXIgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy4kZ2V0ID0gWyckJHJBRicsIGZ1bmN0aW9uKCQkckFGKSB7XG4gICAgdmFyIHdhaXRRdWV1ZSA9IFtdO1xuXG4gICAgZnVuY3Rpb24gd2FpdEZvclRpY2soZm4pIHtcbiAgICAgIHdhaXRRdWV1ZS5wdXNoKGZuKTtcbiAgICAgIGlmICh3YWl0UXVldWUubGVuZ3RoID4gMSkgcmV0dXJuO1xuICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd2FpdFF1ZXVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgd2FpdFF1ZXVlW2ldKCk7XG4gICAgICAgIH1cbiAgICAgICAgd2FpdFF1ZXVlID0gW107XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcGFzc2VkID0gZmFsc2U7XG4gICAgICB3YWl0Rm9yVGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgcGFzc2VkID0gdHJ1ZTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICAgIHBhc3NlZCA/IGNhbGxiYWNrKCkgOiB3YWl0Rm9yVGljayhjYWxsYmFjayk7XG4gICAgICB9O1xuICAgIH07XG4gIH1dO1xufTtcblxudmFyICQkQW5pbWF0ZVJ1bm5lckZhY3RvcnlQcm92aWRlciA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLiRnZXQgPSBbJyRxJywgJyRzbmlmZmVyJywgJyQkYW5pbWF0ZUFzeW5jUnVuJywgJyRkb2N1bWVudCcsICckdGltZW91dCcsXG4gICAgICAgZnVuY3Rpb24oJHEsICAgJHNuaWZmZXIsICAgJCRhbmltYXRlQXN5bmNSdW4sICAgJGRvY3VtZW50LCAgICR0aW1lb3V0KSB7XG5cbiAgICB2YXIgSU5JVElBTF9TVEFURSA9IDA7XG4gICAgdmFyIERPTkVfUEVORElOR19TVEFURSA9IDE7XG4gICAgdmFyIERPTkVfQ09NUExFVEVfU1RBVEUgPSAyO1xuXG4gICAgQW5pbWF0ZVJ1bm5lci5jaGFpbiA9IGZ1bmN0aW9uKGNoYWluLCBjYWxsYmFjaykge1xuICAgICAgdmFyIGluZGV4ID0gMDtcblxuICAgICAgbmV4dCgpO1xuICAgICAgZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgaWYgKGluZGV4ID09PSBjaGFpbi5sZW5ndGgpIHtcbiAgICAgICAgICBjYWxsYmFjayh0cnVlKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjaGFpbltpbmRleF0oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2UgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhmYWxzZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgbmV4dCgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgQW5pbWF0ZVJ1bm5lci5hbGwgPSBmdW5jdGlvbihydW5uZXJzLCBjYWxsYmFjaykge1xuICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgIHZhciBzdGF0dXMgPSB0cnVlO1xuICAgICAgZm9yRWFjaChydW5uZXJzLCBmdW5jdGlvbihydW5uZXIpIHtcbiAgICAgICAgcnVubmVyLmRvbmUob25Qcm9ncmVzcyk7XG4gICAgICB9KTtcblxuICAgICAgZnVuY3Rpb24gb25Qcm9ncmVzcyhyZXNwb25zZSkge1xuICAgICAgICBzdGF0dXMgPSBzdGF0dXMgJiYgcmVzcG9uc2U7XG4gICAgICAgIGlmICgrK2NvdW50ID09PSBydW5uZXJzLmxlbmd0aCkge1xuICAgICAgICAgIGNhbGxiYWNrKHN0YXR1cyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gQW5pbWF0ZVJ1bm5lcihob3N0KSB7XG4gICAgICB0aGlzLnNldEhvc3QoaG9zdCk7XG5cbiAgICAgIHZhciByYWZUaWNrID0gJCRhbmltYXRlQXN5bmNSdW4oKTtcbiAgICAgIHZhciB0aW1lb3V0VGljayA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICR0aW1lb3V0KGZuLCAwLCBmYWxzZSk7XG4gICAgICB9O1xuXG4gICAgICB0aGlzLl9kb25lQ2FsbGJhY2tzID0gW107XG4gICAgICB0aGlzLl90aWNrID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgdmFyIGRvYyA9ICRkb2N1bWVudFswXTtcblxuICAgICAgICAvLyB0aGUgZG9jdW1lbnQgbWF5IG5vdCBiZSByZWFkeSBvciBhdHRhY2hlZFxuICAgICAgICAvLyB0byB0aGUgbW9kdWxlIGZvciBzb21lIGludGVybmFsIHRlc3RzXG4gICAgICAgIGlmIChkb2MgJiYgZG9jLmhpZGRlbikge1xuICAgICAgICAgIHRpbWVvdXRUaWNrKGZuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByYWZUaWNrKGZuKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHRoaXMuX3N0YXRlID0gMDtcbiAgICB9XG5cbiAgICBBbmltYXRlUnVubmVyLnByb3RvdHlwZSA9IHtcbiAgICAgIHNldEhvc3Q6IGZ1bmN0aW9uKGhvc3QpIHtcbiAgICAgICAgdGhpcy5ob3N0ID0gaG9zdCB8fCB7fTtcbiAgICAgIH0sXG5cbiAgICAgIGRvbmU6IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gRE9ORV9DT01QTEVURV9TVEFURSkge1xuICAgICAgICAgIGZuKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fZG9uZUNhbGxiYWNrcy5wdXNoKGZuKTtcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgcHJvZ3Jlc3M6IG5vb3AsXG5cbiAgICAgIGdldFByb21pc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMucHJvbWlzZSkge1xuICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICB0aGlzLnByb21pc2UgPSAkcShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHNlbGYuZG9uZShmdW5jdGlvbihzdGF0dXMpIHtcbiAgICAgICAgICAgICAgc3RhdHVzID09PSBmYWxzZSA/IHJlamVjdCgpIDogcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZTtcbiAgICAgIH0sXG5cbiAgICAgIHRoZW46IGZ1bmN0aW9uKHJlc29sdmVIYW5kbGVyLCByZWplY3RIYW5kbGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb21pc2UoKS50aGVuKHJlc29sdmVIYW5kbGVyLCByZWplY3RIYW5kbGVyKTtcbiAgICAgIH0sXG5cbiAgICAgICdjYXRjaCc6IGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvbWlzZSgpWydjYXRjaCddKGhhbmRsZXIpO1xuICAgICAgfSxcblxuICAgICAgJ2ZpbmFsbHknOiBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb21pc2UoKVsnZmluYWxseSddKGhhbmRsZXIpO1xuICAgICAgfSxcblxuICAgICAgcGF1c2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5ob3N0LnBhdXNlKSB7XG4gICAgICAgICAgdGhpcy5ob3N0LnBhdXNlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIHJlc3VtZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLmhvc3QucmVzdW1lKSB7XG4gICAgICAgICAgdGhpcy5ob3N0LnJlc3VtZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICBlbmQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5ob3N0LmVuZCkge1xuICAgICAgICAgIHRoaXMuaG9zdC5lbmQoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yZXNvbHZlKHRydWUpO1xuICAgICAgfSxcblxuICAgICAgY2FuY2VsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuaG9zdC5jYW5jZWwpIHtcbiAgICAgICAgICB0aGlzLmhvc3QuY2FuY2VsKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcmVzb2x2ZShmYWxzZSk7XG4gICAgICB9LFxuXG4gICAgICBjb21wbGV0ZTogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBpZiAoc2VsZi5fc3RhdGUgPT09IElOSVRJQUxfU1RBVEUpIHtcbiAgICAgICAgICBzZWxmLl9zdGF0ZSA9IERPTkVfUEVORElOR19TVEFURTtcbiAgICAgICAgICBzZWxmLl90aWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5fcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIF9yZXNvbHZlOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBpZiAodGhpcy5fc3RhdGUgIT09IERPTkVfQ09NUExFVEVfU1RBVEUpIHtcbiAgICAgICAgICBmb3JFYWNoKHRoaXMuX2RvbmVDYWxsYmFja3MsIGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgICBmbihyZXNwb25zZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy5fZG9uZUNhbGxiYWNrcy5sZW5ndGggPSAwO1xuICAgICAgICAgIHRoaXMuX3N0YXRlID0gRE9ORV9DT01QTEVURV9TVEFURTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gQW5pbWF0ZVJ1bm5lcjtcbiAgfV07XG59O1xuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkYW5pbWF0ZUNzc1xuICogQGtpbmQgb2JqZWN0XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGlzIGlzIHRoZSBjb3JlIHZlcnNpb24gb2YgYCRhbmltYXRlQ3NzYC4gQnkgZGVmYXVsdCwgb25seSB3aGVuIHRoZSBgbmdBbmltYXRlYCBpcyBpbmNsdWRlZCxcbiAqIHRoZW4gdGhlIGAkYW5pbWF0ZUNzc2Agc2VydmljZSB3aWxsIGFjdHVhbGx5IHBlcmZvcm0gYW5pbWF0aW9ucy5cbiAqXG4gKiBDbGljayBoZXJlIHtAbGluayBuZ0FuaW1hdGUuJGFuaW1hdGVDc3MgdG8gcmVhZCB0aGUgZG9jdW1lbnRhdGlvbiBmb3IgJGFuaW1hdGVDc3N9LlxuICovXG52YXIgJENvcmVBbmltYXRlQ3NzUHJvdmlkZXIgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy4kZ2V0ID0gWyckJHJBRicsICckcScsICckJEFuaW1hdGVSdW5uZXInLCBmdW5jdGlvbigkJHJBRiwgJHEsICQkQW5pbWF0ZVJ1bm5lcikge1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uKGVsZW1lbnQsIGluaXRpYWxPcHRpb25zKSB7XG4gICAgICAvLyBhbGwgb2YgdGhlIGFuaW1hdGlvbiBmdW5jdGlvbnMgc2hvdWxkIGNyZWF0ZVxuICAgICAgLy8gYSBjb3B5IG9mIHRoZSBvcHRpb25zIGRhdGEsIGhvd2V2ZXIsIGlmIGFcbiAgICAgIC8vIHBhcmVudCBzZXJ2aWNlIGhhcyBhbHJlYWR5IGNyZWF0ZWQgYSBjb3B5IHRoZW5cbiAgICAgIC8vIHdlIHNob3VsZCBzdGljayB0byB1c2luZyB0aGF0XG4gICAgICB2YXIgb3B0aW9ucyA9IGluaXRpYWxPcHRpb25zIHx8IHt9O1xuICAgICAgaWYgKCFvcHRpb25zLiQkcHJlcGFyZWQpIHtcbiAgICAgICAgb3B0aW9ucyA9IGNvcHkob3B0aW9ucyk7XG4gICAgICB9XG5cbiAgICAgIC8vIHRoZXJlIGlzIG5vIHBvaW50IGluIGFwcGx5aW5nIHRoZSBzdHlsZXMgc2luY2VcbiAgICAgIC8vIHRoZXJlIGlzIG5vIGFuaW1hdGlvbiB0aGF0IGdvZXMgb24gYXQgYWxsIGluXG4gICAgICAvLyB0aGlzIHZlcnNpb24gb2YgJGFuaW1hdGVDc3MuXG4gICAgICBpZiAob3B0aW9ucy5jbGVhbnVwU3R5bGVzKSB7XG4gICAgICAgIG9wdGlvbnMuZnJvbSA9IG9wdGlvbnMudG8gPSBudWxsO1xuICAgICAgfVxuXG4gICAgICBpZiAob3B0aW9ucy5mcm9tKSB7XG4gICAgICAgIGVsZW1lbnQuY3NzKG9wdGlvbnMuZnJvbSk7XG4gICAgICAgIG9wdGlvbnMuZnJvbSA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIC8qIGpzaGludCBuZXdjYXA6IGZhbHNlICovXG4gICAgICB2YXIgY2xvc2VkLCBydW5uZXIgPSBuZXcgJCRBbmltYXRlUnVubmVyKCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGFydDogcnVuLFxuICAgICAgICBlbmQ6IHJ1blxuICAgICAgfTtcblxuICAgICAgZnVuY3Rpb24gcnVuKCkge1xuICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcbiAgICAgICAgICBhcHBseUFuaW1hdGlvbkNvbnRlbnRzKCk7XG4gICAgICAgICAgaWYgKCFjbG9zZWQpIHtcbiAgICAgICAgICAgIHJ1bm5lci5jb21wbGV0ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjbG9zZWQgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJ1bm5lcjtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYXBwbHlBbmltYXRpb25Db250ZW50cygpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuYWRkQ2xhc3MpIHtcbiAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKG9wdGlvbnMuYWRkQ2xhc3MpO1xuICAgICAgICAgIG9wdGlvbnMuYWRkQ2xhc3MgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLnJlbW92ZUNsYXNzKSB7XG4gICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhvcHRpb25zLnJlbW92ZUNsYXNzKTtcbiAgICAgICAgICBvcHRpb25zLnJlbW92ZUNsYXNzID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucy50bykge1xuICAgICAgICAgIGVsZW1lbnQuY3NzKG9wdGlvbnMudG8pO1xuICAgICAgICAgIG9wdGlvbnMudG8gPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfV07XG59O1xuXG4vKiBnbG9iYWwgc3RyaXBIYXNoOiB0cnVlICovXG5cbi8qKlxuICogISBUaGlzIGlzIGEgcHJpdmF0ZSB1bmRvY3VtZW50ZWQgc2VydmljZSAhXG4gKlxuICogQG5hbWUgJGJyb3dzZXJcbiAqIEByZXF1aXJlcyAkbG9nXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoaXMgb2JqZWN0IGhhcyB0d28gZ29hbHM6XG4gKlxuICogLSBoaWRlIGFsbCB0aGUgZ2xvYmFsIHN0YXRlIGluIHRoZSBicm93c2VyIGNhdXNlZCBieSB0aGUgd2luZG93IG9iamVjdFxuICogLSBhYnN0cmFjdCBhd2F5IGFsbCB0aGUgYnJvd3NlciBzcGVjaWZpYyBmZWF0dXJlcyBhbmQgaW5jb25zaXN0ZW5jaWVzXG4gKlxuICogRm9yIHRlc3RzIHdlIHByb3ZpZGUge0BsaW5rIG5nTW9jay4kYnJvd3NlciBtb2NrIGltcGxlbWVudGF0aW9ufSBvZiB0aGUgYCRicm93c2VyYFxuICogc2VydmljZSwgd2hpY2ggY2FuIGJlIHVzZWQgZm9yIGNvbnZlbmllbnQgdGVzdGluZyBvZiB0aGUgYXBwbGljYXRpb24gd2l0aG91dCB0aGUgaW50ZXJhY3Rpb24gd2l0aFxuICogdGhlIHJlYWwgYnJvd3NlciBhcGlzLlxuICovXG4vKipcbiAqIEBwYXJhbSB7b2JqZWN0fSB3aW5kb3cgVGhlIGdsb2JhbCB3aW5kb3cgb2JqZWN0LlxuICogQHBhcmFtIHtvYmplY3R9IGRvY3VtZW50IGpRdWVyeSB3cmFwcGVkIGRvY3VtZW50LlxuICogQHBhcmFtIHtvYmplY3R9ICRsb2cgd2luZG93LmNvbnNvbGUgb3IgYW4gb2JqZWN0IHdpdGggdGhlIHNhbWUgaW50ZXJmYWNlLlxuICogQHBhcmFtIHtvYmplY3R9ICRzbmlmZmVyICRzbmlmZmVyIHNlcnZpY2VcbiAqL1xuZnVuY3Rpb24gQnJvd3Nlcih3aW5kb3csIGRvY3VtZW50LCAkbG9nLCAkc25pZmZlcikge1xuICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICByYXdEb2N1bWVudCA9IGRvY3VtZW50WzBdLFxuICAgICAgbG9jYXRpb24gPSB3aW5kb3cubG9jYXRpb24sXG4gICAgICBoaXN0b3J5ID0gd2luZG93Lmhpc3RvcnksXG4gICAgICBzZXRUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQsXG4gICAgICBjbGVhclRpbWVvdXQgPSB3aW5kb3cuY2xlYXJUaW1lb3V0LFxuICAgICAgcGVuZGluZ0RlZmVySWRzID0ge307XG5cbiAgc2VsZi5pc01vY2sgPSBmYWxzZTtcblxuICB2YXIgb3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQgPSAwO1xuICB2YXIgb3V0c3RhbmRpbmdSZXF1ZXN0Q2FsbGJhY2tzID0gW107XG5cbiAgLy8gVE9ETyh2b2p0YSk6IHJlbW92ZSB0aGlzIHRlbXBvcmFyeSBhcGlcbiAgc2VsZi4kJGNvbXBsZXRlT3V0c3RhbmRpbmdSZXF1ZXN0ID0gY29tcGxldGVPdXRzdGFuZGluZ1JlcXVlc3Q7XG4gIHNlbGYuJCRpbmNPdXRzdGFuZGluZ1JlcXVlc3RDb3VudCA9IGZ1bmN0aW9uKCkgeyBvdXRzdGFuZGluZ1JlcXVlc3RDb3VudCsrOyB9O1xuXG4gIC8qKlxuICAgKiBFeGVjdXRlcyB0aGUgYGZuYCBmdW5jdGlvbihzdXBwb3J0cyBjdXJyeWluZykgYW5kIGRlY3JlbWVudHMgdGhlIGBvdXRzdGFuZGluZ1JlcXVlc3RDYWxsYmFja3NgXG4gICAqIGNvdW50ZXIuIElmIHRoZSBjb3VudGVyIHJlYWNoZXMgMCwgYWxsIHRoZSBgb3V0c3RhbmRpbmdSZXF1ZXN0Q2FsbGJhY2tzYCBhcmUgZXhlY3V0ZWQuXG4gICAqL1xuICBmdW5jdGlvbiBjb21wbGV0ZU91dHN0YW5kaW5nUmVxdWVzdChmbikge1xuICAgIHRyeSB7XG4gICAgICBmbi5hcHBseShudWxsLCBzbGljZUFyZ3MoYXJndW1lbnRzLCAxKSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIG91dHN0YW5kaW5nUmVxdWVzdENvdW50LS07XG4gICAgICBpZiAob3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQgPT09IDApIHtcbiAgICAgICAgd2hpbGUgKG91dHN0YW5kaW5nUmVxdWVzdENhbGxiYWNrcy5sZW5ndGgpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgb3V0c3RhbmRpbmdSZXF1ZXN0Q2FsbGJhY2tzLnBvcCgpKCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgJGxvZy5lcnJvcihlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBnZXRIYXNoKHVybCkge1xuICAgIHZhciBpbmRleCA9IHVybC5pbmRleE9mKCcjJyk7XG4gICAgcmV0dXJuIGluZGV4ID09PSAtMSA/ICcnIDogdXJsLnN1YnN0cihpbmRleCk7XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICogTm90ZTogdGhpcyBtZXRob2QgaXMgdXNlZCBvbmx5IGJ5IHNjZW5hcmlvIHJ1bm5lclxuICAgKiBUT0RPKHZvanRhKTogcHJlZml4IHRoaXMgbWV0aG9kIHdpdGggJCQgP1xuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGNhbGxiYWNrIEZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbiBubyBvdXRzdGFuZGluZyByZXF1ZXN0XG4gICAqL1xuICBzZWxmLm5vdGlmeVdoZW5Ob091dHN0YW5kaW5nUmVxdWVzdHMgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgIGlmIChvdXRzdGFuZGluZ1JlcXVlc3RDb3VudCA9PT0gMCkge1xuICAgICAgY2FsbGJhY2soKTtcbiAgICB9IGVsc2Uge1xuICAgICAgb3V0c3RhbmRpbmdSZXF1ZXN0Q2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuICAgIH1cbiAgfTtcblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLyBVUkwgQVBJXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgdmFyIGNhY2hlZFN0YXRlLCBsYXN0SGlzdG9yeVN0YXRlLFxuICAgICAgbGFzdEJyb3dzZXJVcmwgPSBsb2NhdGlvbi5ocmVmLFxuICAgICAgYmFzZUVsZW1lbnQgPSBkb2N1bWVudC5maW5kKCdiYXNlJyksXG4gICAgICBwZW5kaW5nTG9jYXRpb24gPSBudWxsO1xuXG4gIGNhY2hlU3RhdGUoKTtcbiAgbGFzdEhpc3RvcnlTdGF0ZSA9IGNhY2hlZFN0YXRlO1xuXG4gIC8qKlxuICAgKiBAbmFtZSAkYnJvd3NlciN1cmxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIEdFVFRFUjpcbiAgICogV2l0aG91dCBhbnkgYXJndW1lbnQsIHRoaXMgbWV0aG9kIGp1c3QgcmV0dXJucyBjdXJyZW50IHZhbHVlIG9mIGxvY2F0aW9uLmhyZWYuXG4gICAqXG4gICAqIFNFVFRFUjpcbiAgICogV2l0aCBhdCBsZWFzdCBvbmUgYXJndW1lbnQsIHRoaXMgbWV0aG9kIHNldHMgdXJsIHRvIG5ldyB2YWx1ZS5cbiAgICogSWYgaHRtbDUgaGlzdG9yeSBhcGkgc3VwcG9ydGVkLCBwdXNoU3RhdGUvcmVwbGFjZVN0YXRlIGlzIHVzZWQsIG90aGVyd2lzZVxuICAgKiBsb2NhdGlvbi5ocmVmL2xvY2F0aW9uLnJlcGxhY2UgaXMgdXNlZC5cbiAgICogUmV0dXJucyBpdHMgb3duIGluc3RhbmNlIHRvIGFsbG93IGNoYWluaW5nXG4gICAqXG4gICAqIE5PVEU6IHRoaXMgYXBpIGlzIGludGVuZGVkIGZvciB1c2Ugb25seSBieSB0aGUgJGxvY2F0aW9uIHNlcnZpY2UuIFBsZWFzZSB1c2UgdGhlXG4gICAqIHtAbGluayBuZy4kbG9jYXRpb24gJGxvY2F0aW9uIHNlcnZpY2V9IHRvIGNoYW5nZSB1cmwuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgTmV3IHVybCAod2hlbiB1c2VkIGFzIHNldHRlcilcbiAgICogQHBhcmFtIHtib29sZWFuPX0gcmVwbGFjZSBTaG91bGQgbmV3IHVybCByZXBsYWNlIGN1cnJlbnQgaGlzdG9yeSByZWNvcmQ/XG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gc3RhdGUgb2JqZWN0IHRvIHVzZSB3aXRoIHB1c2hTdGF0ZS9yZXBsYWNlU3RhdGVcbiAgICovXG4gIHNlbGYudXJsID0gZnVuY3Rpb24odXJsLCByZXBsYWNlLCBzdGF0ZSkge1xuICAgIC8vIEluIG1vZGVybiBicm93c2VycyBgaGlzdG9yeS5zdGF0ZWAgaXMgYG51bGxgIGJ5IGRlZmF1bHQ7IHRyZWF0aW5nIGl0IHNlcGFyYXRlbHlcbiAgICAvLyBmcm9tIGB1bmRlZmluZWRgIHdvdWxkIGNhdXNlIGAkYnJvd3Nlci51cmwoJy9mb28nKWAgdG8gY2hhbmdlIGBoaXN0b3J5LnN0YXRlYFxuICAgIC8vIHRvIHVuZGVmaW5lZCB2aWEgYHB1c2hTdGF0ZWAuIEluc3RlYWQsIGxldCdzIGNoYW5nZSBgdW5kZWZpbmVkYCB0byBgbnVsbGAgaGVyZS5cbiAgICBpZiAoaXNVbmRlZmluZWQoc3RhdGUpKSB7XG4gICAgICBzdGF0ZSA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8gQW5kcm9pZCBCcm93c2VyIEJGQ2FjaGUgY2F1c2VzIGxvY2F0aW9uLCBoaXN0b3J5IHJlZmVyZW5jZSB0byBiZWNvbWUgc3RhbGUuXG4gICAgaWYgKGxvY2F0aW9uICE9PSB3aW5kb3cubG9jYXRpb24pIGxvY2F0aW9uID0gd2luZG93LmxvY2F0aW9uO1xuICAgIGlmIChoaXN0b3J5ICE9PSB3aW5kb3cuaGlzdG9yeSkgaGlzdG9yeSA9IHdpbmRvdy5oaXN0b3J5O1xuXG4gICAgLy8gc2V0dGVyXG4gICAgaWYgKHVybCkge1xuICAgICAgdmFyIHNhbWVTdGF0ZSA9IGxhc3RIaXN0b3J5U3RhdGUgPT09IHN0YXRlO1xuXG4gICAgICAvLyBEb24ndCBjaGFuZ2UgYW55dGhpbmcgaWYgcHJldmlvdXMgYW5kIGN1cnJlbnQgVVJMcyBhbmQgc3RhdGVzIG1hdGNoLiBUaGlzIGFsc28gcHJldmVudHNcbiAgICAgIC8vIElFPDEwIGZyb20gZ2V0dGluZyBpbnRvIHJlZGlyZWN0IGxvb3Agd2hlbiBpbiBMb2NhdGlvbkhhc2hiYW5nSW5IdG1sNVVybCBtb2RlLlxuICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL2FuZ3VsYXIuanMvY29tbWl0L2ZmYjI3MDFcbiAgICAgIGlmIChsYXN0QnJvd3NlclVybCA9PT0gdXJsICYmICghJHNuaWZmZXIuaGlzdG9yeSB8fCBzYW1lU3RhdGUpKSB7XG4gICAgICAgIHJldHVybiBzZWxmO1xuICAgICAgfVxuICAgICAgdmFyIHNhbWVCYXNlID0gbGFzdEJyb3dzZXJVcmwgJiYgc3RyaXBIYXNoKGxhc3RCcm93c2VyVXJsKSA9PT0gc3RyaXBIYXNoKHVybCk7XG4gICAgICBsYXN0QnJvd3NlclVybCA9IHVybDtcbiAgICAgIGxhc3RIaXN0b3J5U3RhdGUgPSBzdGF0ZTtcbiAgICAgIC8vIERvbid0IHVzZSBoaXN0b3J5IEFQSSBpZiBvbmx5IHRoZSBoYXNoIGNoYW5nZWRcbiAgICAgIC8vIGR1ZSB0byBhIGJ1ZyBpbiBJRTEwL0lFMTEgd2hpY2ggbGVhZHNcbiAgICAgIC8vIHRvIG5vdCBmaXJpbmcgYSBgaGFzaGNoYW5nZWAgbm9yIGBwb3BzdGF0ZWAgZXZlbnRcbiAgICAgIC8vIGluIHNvbWUgY2FzZXMgKHNlZSAjOTE0MykuXG4gICAgICBpZiAoJHNuaWZmZXIuaGlzdG9yeSAmJiAoIXNhbWVCYXNlIHx8ICFzYW1lU3RhdGUpKSB7XG4gICAgICAgIGhpc3RvcnlbcmVwbGFjZSA/ICdyZXBsYWNlU3RhdGUnIDogJ3B1c2hTdGF0ZSddKHN0YXRlLCAnJywgdXJsKTtcbiAgICAgICAgY2FjaGVTdGF0ZSgpO1xuICAgICAgICAvLyBEbyB0aGUgYXNzaWdubWVudCBhZ2FpbiBzbyB0aGF0IHRob3NlIHR3byB2YXJpYWJsZXMgYXJlIHJlZmVyZW50aWFsbHkgaWRlbnRpY2FsLlxuICAgICAgICBsYXN0SGlzdG9yeVN0YXRlID0gY2FjaGVkU3RhdGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIXNhbWVCYXNlIHx8IHBlbmRpbmdMb2NhdGlvbikge1xuICAgICAgICAgIHBlbmRpbmdMb2NhdGlvbiA9IHVybDtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVwbGFjZSkge1xuICAgICAgICAgIGxvY2F0aW9uLnJlcGxhY2UodXJsKTtcbiAgICAgICAgfSBlbHNlIGlmICghc2FtZUJhc2UpIHtcbiAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gdXJsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvY2F0aW9uLmhhc2ggPSBnZXRIYXNoKHVybCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxvY2F0aW9uLmhyZWYgIT09IHVybCkge1xuICAgICAgICAgIHBlbmRpbmdMb2NhdGlvbiA9IHVybDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHNlbGY7XG4gICAgLy8gZ2V0dGVyXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIC0gcGVuZGluZ0xvY2F0aW9uIGlzIG5lZWRlZCBhcyBicm93c2VycyBkb24ndCBhbGxvdyB0byByZWFkIG91dFxuICAgICAgLy8gICB0aGUgbmV3IGxvY2F0aW9uLmhyZWYgaWYgYSByZWxvYWQgaGFwcGVuZWQgb3IgaWYgdGhlcmUgaXMgYSBidWcgbGlrZSBpbiBpT1MgOSAoc2VlXG4gICAgICAvLyAgIGh0dHBzOi8vb3BlbnJhZGFyLmFwcHNwb3QuY29tLzIyMTg2MTA5KS5cbiAgICAgIC8vIC0gdGhlIHJlcGxhY2VtZW50IGlzIGEgd29ya2Fyb3VuZCBmb3IgaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NDA3MTcyXG4gICAgICByZXR1cm4gcGVuZGluZ0xvY2F0aW9uIHx8IGxvY2F0aW9uLmhyZWYucmVwbGFjZSgvJTI3L2csXCInXCIpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQG5hbWUgJGJyb3dzZXIjc3RhdGVcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFRoaXMgbWV0aG9kIGlzIGEgZ2V0dGVyLlxuICAgKlxuICAgKiBSZXR1cm4gaGlzdG9yeS5zdGF0ZSBvciBudWxsIGlmIGhpc3Rvcnkuc3RhdGUgaXMgdW5kZWZpbmVkLlxuICAgKlxuICAgKiBAcmV0dXJucyB7b2JqZWN0fSBzdGF0ZVxuICAgKi9cbiAgc2VsZi5zdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjYWNoZWRTdGF0ZTtcbiAgfTtcblxuICB2YXIgdXJsQ2hhbmdlTGlzdGVuZXJzID0gW10sXG4gICAgICB1cmxDaGFuZ2VJbml0ID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gY2FjaGVTdGF0ZUFuZEZpcmVVcmxDaGFuZ2UoKSB7XG4gICAgcGVuZGluZ0xvY2F0aW9uID0gbnVsbDtcbiAgICBjYWNoZVN0YXRlKCk7XG4gICAgZmlyZVVybENoYW5nZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0Q3VycmVudFN0YXRlKCkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gaGlzdG9yeS5zdGF0ZTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyBNU0lFIGNhbiByZXBvcnRlZGx5IHRocm93IHdoZW4gdGhlcmUgaXMgbm8gc3RhdGUgKFVOQ09ORklSTUVEKS5cbiAgICB9XG4gIH1cblxuICAvLyBUaGlzIHZhcmlhYmxlIHNob3VsZCBiZSB1c2VkICpvbmx5KiBpbnNpZGUgdGhlIGNhY2hlU3RhdGUgZnVuY3Rpb24uXG4gIHZhciBsYXN0Q2FjaGVkU3RhdGUgPSBudWxsO1xuICBmdW5jdGlvbiBjYWNoZVN0YXRlKCkge1xuICAgIC8vIFRoaXMgc2hvdWxkIGJlIHRoZSBvbmx5IHBsYWNlIGluICRicm93c2VyIHdoZXJlIGBoaXN0b3J5LnN0YXRlYCBpcyByZWFkLlxuICAgIGNhY2hlZFN0YXRlID0gZ2V0Q3VycmVudFN0YXRlKCk7XG4gICAgY2FjaGVkU3RhdGUgPSBpc1VuZGVmaW5lZChjYWNoZWRTdGF0ZSkgPyBudWxsIDogY2FjaGVkU3RhdGU7XG5cbiAgICAvLyBQcmV2ZW50IGNhbGxiYWNrcyBmbyBmaXJlIHR3aWNlIGlmIGJvdGggaGFzaGNoYW5nZSAmIHBvcHN0YXRlIHdlcmUgZmlyZWQuXG4gICAgaWYgKGVxdWFscyhjYWNoZWRTdGF0ZSwgbGFzdENhY2hlZFN0YXRlKSkge1xuICAgICAgY2FjaGVkU3RhdGUgPSBsYXN0Q2FjaGVkU3RhdGU7XG4gICAgfVxuICAgIGxhc3RDYWNoZWRTdGF0ZSA9IGNhY2hlZFN0YXRlO1xuICB9XG5cbiAgZnVuY3Rpb24gZmlyZVVybENoYW5nZSgpIHtcbiAgICBpZiAobGFzdEJyb3dzZXJVcmwgPT09IHNlbGYudXJsKCkgJiYgbGFzdEhpc3RvcnlTdGF0ZSA9PT0gY2FjaGVkU3RhdGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsYXN0QnJvd3NlclVybCA9IHNlbGYudXJsKCk7XG4gICAgbGFzdEhpc3RvcnlTdGF0ZSA9IGNhY2hlZFN0YXRlO1xuICAgIGZvckVhY2godXJsQ2hhbmdlTGlzdGVuZXJzLCBmdW5jdGlvbihsaXN0ZW5lcikge1xuICAgICAgbGlzdGVuZXIoc2VsZi51cmwoKSwgY2FjaGVkU3RhdGUpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBuYW1lICRicm93c2VyI29uVXJsQ2hhbmdlXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBSZWdpc3RlciBjYWxsYmFjayBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkLCB3aGVuIHVybCBjaGFuZ2VzLlxuICAgKlxuICAgKiBJdCdzIG9ubHkgY2FsbGVkIHdoZW4gdGhlIHVybCBpcyBjaGFuZ2VkIGZyb20gb3V0c2lkZSBvZiBhbmd1bGFyOlxuICAgKiAtIHVzZXIgdHlwZXMgZGlmZmVyZW50IHVybCBpbnRvIGFkZHJlc3MgYmFyXG4gICAqIC0gdXNlciBjbGlja3Mgb24gaGlzdG9yeSAoZm9yd2FyZC9iYWNrKSBidXR0b25cbiAgICogLSB1c2VyIGNsaWNrcyBvbiBhIGxpbmtcbiAgICpcbiAgICogSXQncyBub3QgY2FsbGVkIHdoZW4gdXJsIGlzIGNoYW5nZWQgYnkgJGJyb3dzZXIudXJsKCkgbWV0aG9kXG4gICAqXG4gICAqIFRoZSBsaXN0ZW5lciBnZXRzIGNhbGxlZCB3aXRoIG5ldyB1cmwgYXMgcGFyYW1ldGVyLlxuICAgKlxuICAgKiBOT1RFOiB0aGlzIGFwaSBpcyBpbnRlbmRlZCBmb3IgdXNlIG9ubHkgYnkgdGhlICRsb2NhdGlvbiBzZXJ2aWNlLiBQbGVhc2UgdXNlIHRoZVxuICAgKiB7QGxpbmsgbmcuJGxvY2F0aW9uICRsb2NhdGlvbiBzZXJ2aWNlfSB0byBtb25pdG9yIHVybCBjaGFuZ2VzIGluIGFuZ3VsYXIgYXBwcy5cbiAgICpcbiAgICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcpfSBsaXN0ZW5lciBMaXN0ZW5lciBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2hlbiB1cmwgY2hhbmdlcy5cbiAgICogQHJldHVybiB7ZnVuY3Rpb24oc3RyaW5nKX0gUmV0dXJucyB0aGUgcmVnaXN0ZXJlZCBsaXN0ZW5lciBmbiAtIGhhbmR5IGlmIHRoZSBmbiBpcyBhbm9ueW1vdXMuXG4gICAqL1xuICBzZWxmLm9uVXJsQ2hhbmdlID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAvLyBUT0RPKHZvanRhKTogcmVmYWN0b3IgdG8gdXNlIG5vZGUncyBzeW50YXggZm9yIGV2ZW50c1xuICAgIGlmICghdXJsQ2hhbmdlSW5pdCkge1xuICAgICAgLy8gV2UgbGlzdGVuIG9uIGJvdGggKGhhc2hjaGFuZ2UvcG9wc3RhdGUpIHdoZW4gYXZhaWxhYmxlLCBhcyBzb21lIGJyb3dzZXJzIChlLmcuIE9wZXJhKVxuICAgICAgLy8gZG9uJ3QgZmlyZSBwb3BzdGF0ZSB3aGVuIHVzZXIgY2hhbmdlIHRoZSBhZGRyZXNzIGJhciBhbmQgZG9uJ3QgZmlyZSBoYXNoY2hhbmdlIHdoZW4gdXJsXG4gICAgICAvLyBjaGFuZ2VkIGJ5IHB1c2gvcmVwbGFjZVN0YXRlXG5cbiAgICAgIC8vIGh0bWw1IGhpc3RvcnkgYXBpIC0gcG9wc3RhdGUgZXZlbnRcbiAgICAgIGlmICgkc25pZmZlci5oaXN0b3J5KSBqcUxpdGUod2luZG93KS5vbigncG9wc3RhdGUnLCBjYWNoZVN0YXRlQW5kRmlyZVVybENoYW5nZSk7XG4gICAgICAvLyBoYXNoY2hhbmdlIGV2ZW50XG4gICAgICBqcUxpdGUod2luZG93KS5vbignaGFzaGNoYW5nZScsIGNhY2hlU3RhdGVBbmRGaXJlVXJsQ2hhbmdlKTtcblxuICAgICAgdXJsQ2hhbmdlSW5pdCA9IHRydWU7XG4gICAgfVxuXG4gICAgdXJsQ2hhbmdlTGlzdGVuZXJzLnB1c2goY2FsbGJhY2spO1xuICAgIHJldHVybiBjYWxsYmFjaztcbiAgfTtcblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICogUmVtb3ZlIHBvcHN0YXRlIGFuZCBoYXNoY2hhbmdlIGhhbmRsZXIgZnJvbSB3aW5kb3cuXG4gICAqXG4gICAqIE5PVEU6IHRoaXMgYXBpIGlzIGludGVuZGVkIGZvciB1c2Ugb25seSBieSAkcm9vdFNjb3BlLlxuICAgKi9cbiAgc2VsZi4kJGFwcGxpY2F0aW9uRGVzdHJveWVkID0gZnVuY3Rpb24oKSB7XG4gICAganFMaXRlKHdpbmRvdykub2ZmKCdoYXNoY2hhbmdlIHBvcHN0YXRlJywgY2FjaGVTdGF0ZUFuZEZpcmVVcmxDaGFuZ2UpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDaGVja3Mgd2hldGhlciB0aGUgdXJsIGhhcyBjaGFuZ2VkIG91dHNpZGUgb2YgQW5ndWxhci5cbiAgICogTmVlZHMgdG8gYmUgZXhwb3J0ZWQgdG8gYmUgYWJsZSB0byBjaGVjayBmb3IgY2hhbmdlcyB0aGF0IGhhdmUgYmVlbiBkb25lIGluIHN5bmMsXG4gICAqIGFzIGhhc2hjaGFuZ2UvcG9wc3RhdGUgZXZlbnRzIGZpcmUgaW4gYXN5bmMuXG4gICAqL1xuICBzZWxmLiQkY2hlY2tVcmxDaGFuZ2UgPSBmaXJlVXJsQ2hhbmdlO1xuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gIC8vIE1pc2MgQVBJXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIEBuYW1lICRicm93c2VyI2Jhc2VIcmVmXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBSZXR1cm5zIGN1cnJlbnQgPGJhc2UgaHJlZj5cbiAgICogKGFsd2F5cyByZWxhdGl2ZSAtIHdpdGhvdXQgZG9tYWluKVxuICAgKlxuICAgKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgY3VycmVudCBiYXNlIGhyZWZcbiAgICovXG4gIHNlbGYuYmFzZUhyZWYgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaHJlZiA9IGJhc2VFbGVtZW50LmF0dHIoJ2hyZWYnKTtcbiAgICByZXR1cm4gaHJlZiA/IGhyZWYucmVwbGFjZSgvXihodHRwcz9cXDopP1xcL1xcL1teXFwvXSovLCAnJykgOiAnJztcbiAgfTtcblxuICAvKipcbiAgICogQG5hbWUgJGJyb3dzZXIjZGVmZXJcbiAgICogQHBhcmFtIHtmdW5jdGlvbigpfSBmbiBBIGZ1bmN0aW9uLCB3aG8ncyBleGVjdXRpb24gc2hvdWxkIGJlIGRlZmVycmVkLlxuICAgKiBAcGFyYW0ge251bWJlcj19IFtkZWxheT0wXSBvZiBtaWxsaXNlY29uZHMgdG8gZGVmZXIgdGhlIGZ1bmN0aW9uIGV4ZWN1dGlvbi5cbiAgICogQHJldHVybnMgeyp9IERlZmVySWQgdGhhdCBjYW4gYmUgdXNlZCB0byBjYW5jZWwgdGhlIHRhc2sgdmlhIGAkYnJvd3Nlci5kZWZlci5jYW5jZWwoKWAuXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBFeGVjdXRlcyBhIGZuIGFzeW5jaHJvbm91c2x5IHZpYSBgc2V0VGltZW91dChmbiwgZGVsYXkpYC5cbiAgICpcbiAgICogVW5saWtlIHdoZW4gY2FsbGluZyBgc2V0VGltZW91dGAgZGlyZWN0bHksIGluIHRlc3QgdGhpcyBmdW5jdGlvbiBpcyBtb2NrZWQgYW5kIGluc3RlYWQgb2YgdXNpbmdcbiAgICogYHNldFRpbWVvdXRgIGluIHRlc3RzLCB0aGUgZm5zIGFyZSBxdWV1ZWQgaW4gYW4gYXJyYXksIHdoaWNoIGNhbiBiZSBwcm9ncmFtbWF0aWNhbGx5IGZsdXNoZWRcbiAgICogdmlhIGAkYnJvd3Nlci5kZWZlci5mbHVzaCgpYC5cbiAgICpcbiAgICovXG4gIHNlbGYuZGVmZXIgPSBmdW5jdGlvbihmbiwgZGVsYXkpIHtcbiAgICB2YXIgdGltZW91dElkO1xuICAgIG91dHN0YW5kaW5nUmVxdWVzdENvdW50Kys7XG4gICAgdGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIGRlbGV0ZSBwZW5kaW5nRGVmZXJJZHNbdGltZW91dElkXTtcbiAgICAgIGNvbXBsZXRlT3V0c3RhbmRpbmdSZXF1ZXN0KGZuKTtcbiAgICB9LCBkZWxheSB8fCAwKTtcbiAgICBwZW5kaW5nRGVmZXJJZHNbdGltZW91dElkXSA9IHRydWU7XG4gICAgcmV0dXJuIHRpbWVvdXRJZDtcbiAgfTtcblxuXG4gIC8qKlxuICAgKiBAbmFtZSAkYnJvd3NlciNkZWZlci5jYW5jZWxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIENhbmNlbHMgYSBkZWZlcnJlZCB0YXNrIGlkZW50aWZpZWQgd2l0aCBgZGVmZXJJZGAuXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gZGVmZXJJZCBUb2tlbiByZXR1cm5lZCBieSB0aGUgYCRicm93c2VyLmRlZmVyYCBmdW5jdGlvbi5cbiAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSB0YXNrIGhhc24ndCBleGVjdXRlZCB5ZXQgYW5kIHdhcyBzdWNjZXNzZnVsbHlcbiAgICogICAgICAgICAgICAgICAgICAgIGNhbmNlbGVkLlxuICAgKi9cbiAgc2VsZi5kZWZlci5jYW5jZWwgPSBmdW5jdGlvbihkZWZlcklkKSB7XG4gICAgaWYgKHBlbmRpbmdEZWZlcklkc1tkZWZlcklkXSkge1xuICAgICAgZGVsZXRlIHBlbmRpbmdEZWZlcklkc1tkZWZlcklkXTtcbiAgICAgIGNsZWFyVGltZW91dChkZWZlcklkKTtcbiAgICAgIGNvbXBsZXRlT3V0c3RhbmRpbmdSZXF1ZXN0KG5vb3ApO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxufVxuXG5mdW5jdGlvbiAkQnJvd3NlclByb3ZpZGVyKCkge1xuICB0aGlzLiRnZXQgPSBbJyR3aW5kb3cnLCAnJGxvZycsICckc25pZmZlcicsICckZG9jdW1lbnQnLFxuICAgICAgZnVuY3Rpb24oJHdpbmRvdywgJGxvZywgJHNuaWZmZXIsICRkb2N1bWVudCkge1xuICAgICAgICByZXR1cm4gbmV3IEJyb3dzZXIoJHdpbmRvdywgJGRvY3VtZW50LCAkbG9nLCAkc25pZmZlcik7XG4gICAgICB9XTtcbn1cblxuLyoqXG4gKiBAbmdkb2Mgc2VydmljZVxuICogQG5hbWUgJGNhY2hlRmFjdG9yeVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogRmFjdG9yeSB0aGF0IGNvbnN0cnVjdHMge0BsaW5rICRjYWNoZUZhY3RvcnkuQ2FjaGUgQ2FjaGV9IG9iamVjdHMgYW5kIGdpdmVzIGFjY2VzcyB0b1xuICogdGhlbS5cbiAqXG4gKiBgYGBqc1xuICpcbiAqICB2YXIgY2FjaGUgPSAkY2FjaGVGYWN0b3J5KCdjYWNoZUlkJyk7XG4gKiAgZXhwZWN0KCRjYWNoZUZhY3RvcnkuZ2V0KCdjYWNoZUlkJykpLnRvQmUoY2FjaGUpO1xuICogIGV4cGVjdCgkY2FjaGVGYWN0b3J5LmdldCgnbm9TdWNoQ2FjaGVJZCcpKS5ub3QudG9CZURlZmluZWQoKTtcbiAqXG4gKiAgY2FjaGUucHV0KFwia2V5XCIsIFwidmFsdWVcIik7XG4gKiAgY2FjaGUucHV0KFwiYW5vdGhlciBrZXlcIiwgXCJhbm90aGVyIHZhbHVlXCIpO1xuICpcbiAqICAvLyBXZSd2ZSBzcGVjaWZpZWQgbm8gb3B0aW9ucyBvbiBjcmVhdGlvblxuICogIGV4cGVjdChjYWNoZS5pbmZvKCkpLnRvRXF1YWwoe2lkOiAnY2FjaGVJZCcsIHNpemU6IDJ9KTtcbiAqXG4gKiBgYGBcbiAqXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGNhY2hlSWQgTmFtZSBvciBpZCBvZiB0aGUgbmV3bHkgY3JlYXRlZCBjYWNoZS5cbiAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBPcHRpb25zIG9iamVjdCB0aGF0IHNwZWNpZmllcyB0aGUgY2FjaGUgYmVoYXZpb3IuIFByb3BlcnRpZXM6XG4gKlxuICogICAtIGB7bnVtYmVyPX1gIGBjYXBhY2l0eWAg4oCUIHR1cm5zIHRoZSBjYWNoZSBpbnRvIExSVSBjYWNoZS5cbiAqXG4gKiBAcmV0dXJucyB7b2JqZWN0fSBOZXdseSBjcmVhdGVkIGNhY2hlIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgc2V0IG9mIG1ldGhvZHM6XG4gKlxuICogLSBge29iamVjdH1gIGBpbmZvKClgIOKAlCBSZXR1cm5zIGlkLCBzaXplLCBhbmQgb3B0aW9ucyBvZiBjYWNoZS5cbiAqIC0gYHt7Kn19YCBgcHV0KHtzdHJpbmd9IGtleSwgeyp9IHZhbHVlKWAg4oCUIFB1dHMgYSBuZXcga2V5LXZhbHVlIHBhaXIgaW50byB0aGUgY2FjaGUgYW5kIHJldHVybnNcbiAqICAgaXQuXG4gKiAtIGB7eyp9fWAgYGdldCh7c3RyaW5nfSBrZXkpYCDigJQgUmV0dXJucyBjYWNoZWQgdmFsdWUgZm9yIGBrZXlgIG9yIHVuZGVmaW5lZCBmb3IgY2FjaGUgbWlzcy5cbiAqIC0gYHt2b2lkfWAgYHJlbW92ZSh7c3RyaW5nfSBrZXkpYCDigJQgUmVtb3ZlcyBhIGtleS12YWx1ZSBwYWlyIGZyb20gdGhlIGNhY2hlLlxuICogLSBge3ZvaWR9YCBgcmVtb3ZlQWxsKClgIOKAlCBSZW1vdmVzIGFsbCBjYWNoZWQgdmFsdWVzLlxuICogLSBge3ZvaWR9YCBgZGVzdHJveSgpYCDigJQgUmVtb3ZlcyByZWZlcmVuY2VzIHRvIHRoaXMgY2FjaGUgZnJvbSAkY2FjaGVGYWN0b3J5LlxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZSBtb2R1bGU9XCJjYWNoZUV4YW1wbGVBcHBcIj5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJDYWNoZUNvbnRyb2xsZXJcIj5cbiAgICAgICAgIDxpbnB1dCBuZy1tb2RlbD1cIm5ld0NhY2hlS2V5XCIgcGxhY2Vob2xkZXI9XCJLZXlcIj5cbiAgICAgICAgIDxpbnB1dCBuZy1tb2RlbD1cIm5ld0NhY2hlVmFsdWVcIiBwbGFjZWhvbGRlcj1cIlZhbHVlXCI+XG4gICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwicHV0KG5ld0NhY2hlS2V5LCBuZXdDYWNoZVZhbHVlKVwiPkNhY2hlPC9idXR0b24+XG5cbiAgICAgICAgIDxwIG5nLWlmPVwia2V5cy5sZW5ndGhcIj5DYWNoZWQgVmFsdWVzPC9wPlxuICAgICAgICAgPGRpdiBuZy1yZXBlYXQ9XCJrZXkgaW4ga2V5c1wiPlxuICAgICAgICAgICA8c3BhbiBuZy1iaW5kPVwia2V5XCI+PC9zcGFuPlxuICAgICAgICAgICA8c3Bhbj46IDwvc3Bhbj5cbiAgICAgICAgICAgPGIgbmctYmluZD1cImNhY2hlLmdldChrZXkpXCI+PC9iPlxuICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgIDxwPkNhY2hlIEluZm88L3A+XG4gICAgICAgICA8ZGl2IG5nLXJlcGVhdD1cIihrZXksIHZhbHVlKSBpbiBjYWNoZS5pbmZvKClcIj5cbiAgICAgICAgICAgPHNwYW4gbmctYmluZD1cImtleVwiPjwvc3Bhbj5cbiAgICAgICAgICAgPHNwYW4+OiA8L3NwYW4+XG4gICAgICAgICAgIDxiIG5nLWJpbmQ9XCJ2YWx1ZVwiPjwvYj5cbiAgICAgICAgIDwvZGl2PlxuICAgICAgIDwvZGl2PlxuICAgICA8L2ZpbGU+XG4gICAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cbiAgICAgICBhbmd1bGFyLm1vZHVsZSgnY2FjaGVFeGFtcGxlQXBwJywgW10pLlxuICAgICAgICAgY29udHJvbGxlcignQ2FjaGVDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGNhY2hlRmFjdG9yeScsIGZ1bmN0aW9uKCRzY29wZSwgJGNhY2hlRmFjdG9yeSkge1xuICAgICAgICAgICAkc2NvcGUua2V5cyA9IFtdO1xuICAgICAgICAgICAkc2NvcGUuY2FjaGUgPSAkY2FjaGVGYWN0b3J5KCdjYWNoZUlkJyk7XG4gICAgICAgICAgICRzY29wZS5wdXQgPSBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoJHNjb3BlLmNhY2hlLmdldChrZXkpKSkge1xuICAgICAgICAgICAgICAgJHNjb3BlLmtleXMucHVzaChrZXkpO1xuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAkc2NvcGUuY2FjaGUucHV0KGtleSwgYW5ndWxhci5pc1VuZGVmaW5lZCh2YWx1ZSkgPyBudWxsIDogdmFsdWUpO1xuICAgICAgICAgICB9O1xuICAgICAgICAgfV0pO1xuICAgICA8L2ZpbGU+XG4gICAgIDxmaWxlIG5hbWU9XCJzdHlsZS5jc3NcIj5cbiAgICAgICBwIHtcbiAgICAgICAgIG1hcmdpbjogMTBweCAwIDNweDtcbiAgICAgICB9XG4gICAgIDwvZmlsZT5cbiAgIDwvZXhhbXBsZT5cbiAqL1xuZnVuY3Rpb24gJENhY2hlRmFjdG9yeVByb3ZpZGVyKCkge1xuXG4gIHRoaXMuJGdldCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBjYWNoZXMgPSB7fTtcblxuICAgIGZ1bmN0aW9uIGNhY2hlRmFjdG9yeShjYWNoZUlkLCBvcHRpb25zKSB7XG4gICAgICBpZiAoY2FjaGVJZCBpbiBjYWNoZXMpIHtcbiAgICAgICAgdGhyb3cgbWluRXJyKCckY2FjaGVGYWN0b3J5JykoJ2lpZCcsIFwiQ2FjaGVJZCAnezB9JyBpcyBhbHJlYWR5IHRha2VuIVwiLCBjYWNoZUlkKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHNpemUgPSAwLFxuICAgICAgICAgIHN0YXRzID0gZXh0ZW5kKHt9LCBvcHRpb25zLCB7aWQ6IGNhY2hlSWR9KSxcbiAgICAgICAgICBkYXRhID0gY3JlYXRlTWFwKCksXG4gICAgICAgICAgY2FwYWNpdHkgPSAob3B0aW9ucyAmJiBvcHRpb25zLmNhcGFjaXR5KSB8fCBOdW1iZXIuTUFYX1ZBTFVFLFxuICAgICAgICAgIGxydUhhc2ggPSBjcmVhdGVNYXAoKSxcbiAgICAgICAgICBmcmVzaEVuZCA9IG51bGwsXG4gICAgICAgICAgc3RhbGVFbmQgPSBudWxsO1xuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyB0eXBlXG4gICAgICAgKiBAbmFtZSAkY2FjaGVGYWN0b3J5LkNhY2hlXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBBIGNhY2hlIG9iamVjdCB1c2VkIHRvIHN0b3JlIGFuZCByZXRyaWV2ZSBkYXRhLCBwcmltYXJpbHkgdXNlZCBieVxuICAgICAgICoge0BsaW5rICRodHRwICRodHRwfSBhbmQgdGhlIHtAbGluayBuZy5kaXJlY3RpdmU6c2NyaXB0IHNjcmlwdH0gZGlyZWN0aXZlIHRvIGNhY2hlXG4gICAgICAgKiB0ZW1wbGF0ZXMgYW5kIG90aGVyIGRhdGEuXG4gICAgICAgKlxuICAgICAgICogYGBganNcbiAgICAgICAqICBhbmd1bGFyLm1vZHVsZSgnc3VwZXJDYWNoZScpXG4gICAgICAgKiAgICAuZmFjdG9yeSgnc3VwZXJDYWNoZScsIFsnJGNhY2hlRmFjdG9yeScsIGZ1bmN0aW9uKCRjYWNoZUZhY3RvcnkpIHtcbiAgICAgICAqICAgICAgcmV0dXJuICRjYWNoZUZhY3RvcnkoJ3N1cGVyLWNhY2hlJyk7XG4gICAgICAgKiAgICB9XSk7XG4gICAgICAgKiBgYGBcbiAgICAgICAqXG4gICAgICAgKiBFeGFtcGxlIHRlc3Q6XG4gICAgICAgKlxuICAgICAgICogYGBganNcbiAgICAgICAqICBpdCgnc2hvdWxkIGJlaGF2ZSBsaWtlIGEgY2FjaGUnLCBpbmplY3QoZnVuY3Rpb24oc3VwZXJDYWNoZSkge1xuICAgICAgICogICAgc3VwZXJDYWNoZS5wdXQoJ2tleScsICd2YWx1ZScpO1xuICAgICAgICogICAgc3VwZXJDYWNoZS5wdXQoJ2Fub3RoZXIga2V5JywgJ2Fub3RoZXIgdmFsdWUnKTtcbiAgICAgICAqXG4gICAgICAgKiAgICBleHBlY3Qoc3VwZXJDYWNoZS5pbmZvKCkpLnRvRXF1YWwoe1xuICAgICAgICogICAgICBpZDogJ3N1cGVyLWNhY2hlJyxcbiAgICAgICAqICAgICAgc2l6ZTogMlxuICAgICAgICogICAgfSk7XG4gICAgICAgKlxuICAgICAgICogICAgc3VwZXJDYWNoZS5yZW1vdmUoJ2Fub3RoZXIga2V5Jyk7XG4gICAgICAgKiAgICBleHBlY3Qoc3VwZXJDYWNoZS5nZXQoJ2Fub3RoZXIga2V5JykpLnRvQmVVbmRlZmluZWQoKTtcbiAgICAgICAqXG4gICAgICAgKiAgICBzdXBlckNhY2hlLnJlbW92ZUFsbCgpO1xuICAgICAgICogICAgZXhwZWN0KHN1cGVyQ2FjaGUuaW5mbygpKS50b0VxdWFsKHtcbiAgICAgICAqICAgICAgaWQ6ICdzdXBlci1jYWNoZScsXG4gICAgICAgKiAgICAgIHNpemU6IDBcbiAgICAgICAqICAgIH0pO1xuICAgICAgICogIH0pKTtcbiAgICAgICAqIGBgYFxuICAgICAgICovXG4gICAgICByZXR1cm4gY2FjaGVzW2NhY2hlSWRdID0ge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAqIEBuYW1lICRjYWNoZUZhY3RvcnkuQ2FjaGUjcHV0XG4gICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBJbnNlcnRzIGEgbmFtZWQgZW50cnkgaW50byB0aGUge0BsaW5rICRjYWNoZUZhY3RvcnkuQ2FjaGUgQ2FjaGV9IG9iamVjdCB0byBiZVxuICAgICAgICAgKiByZXRyaWV2ZWQgbGF0ZXIsIGFuZCBpbmNyZW1lbnRpbmcgdGhlIHNpemUgb2YgdGhlIGNhY2hlIGlmIHRoZSBrZXkgd2FzIG5vdCBhbHJlYWR5XG4gICAgICAgICAqIHByZXNlbnQgaW4gdGhlIGNhY2hlLiBJZiBiZWhhdmluZyBsaWtlIGFuIExSVSBjYWNoZSwgaXQgd2lsbCBhbHNvIHJlbW92ZSBzdGFsZVxuICAgICAgICAgKiBlbnRyaWVzIGZyb20gdGhlIHNldC5cbiAgICAgICAgICpcbiAgICAgICAgICogSXQgd2lsbCBub3QgaW5zZXJ0IHVuZGVmaW5lZCB2YWx1ZXMgaW50byB0aGUgY2FjaGUuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgdGhlIGtleSB1bmRlciB3aGljaCB0aGUgY2FjaGVkIGRhdGEgaXMgc3RvcmVkLlxuICAgICAgICAgKiBAcGFyYW0geyp9IHZhbHVlIHRoZSB2YWx1ZSB0byBzdG9yZSBhbG9uZ3NpZGUgdGhlIGtleS4gSWYgaXQgaXMgdW5kZWZpbmVkLCB0aGUga2V5XG4gICAgICAgICAqICAgIHdpbGwgbm90IGJlIHN0b3JlZC5cbiAgICAgICAgICogQHJldHVybnMgeyp9IHRoZSB2YWx1ZSBzdG9yZWQuXG4gICAgICAgICAqL1xuICAgICAgICBwdXQ6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICBpZiAoaXNVbmRlZmluZWQodmFsdWUpKSByZXR1cm47XG4gICAgICAgICAgaWYgKGNhcGFjaXR5IDwgTnVtYmVyLk1BWF9WQUxVRSkge1xuICAgICAgICAgICAgdmFyIGxydUVudHJ5ID0gbHJ1SGFzaFtrZXldIHx8IChscnVIYXNoW2tleV0gPSB7a2V5OiBrZXl9KTtcblxuICAgICAgICAgICAgcmVmcmVzaChscnVFbnRyeSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCEoa2V5IGluIGRhdGEpKSBzaXplKys7XG4gICAgICAgICAgZGF0YVtrZXldID0gdmFsdWU7XG5cbiAgICAgICAgICBpZiAoc2l6ZSA+IGNhcGFjaXR5KSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZShzdGFsZUVuZC5rZXkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgKiBAbmFtZSAkY2FjaGVGYWN0b3J5LkNhY2hlI2dldFxuICAgICAgICAgKiBAa2luZCBmdW5jdGlvblxuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICogUmV0cmlldmVzIG5hbWVkIGRhdGEgc3RvcmVkIGluIHRoZSB7QGxpbmsgJGNhY2hlRmFjdG9yeS5DYWNoZSBDYWNoZX0gb2JqZWN0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IHRoZSBrZXkgb2YgdGhlIGRhdGEgdG8gYmUgcmV0cmlldmVkXG4gICAgICAgICAqIEByZXR1cm5zIHsqfSB0aGUgdmFsdWUgc3RvcmVkLlxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICBpZiAoY2FwYWNpdHkgPCBOdW1iZXIuTUFYX1ZBTFVFKSB7XG4gICAgICAgICAgICB2YXIgbHJ1RW50cnkgPSBscnVIYXNoW2tleV07XG5cbiAgICAgICAgICAgIGlmICghbHJ1RW50cnkpIHJldHVybjtcblxuICAgICAgICAgICAgcmVmcmVzaChscnVFbnRyeSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIGRhdGFba2V5XTtcbiAgICAgICAgfSxcblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAqIEBuYW1lICRjYWNoZUZhY3RvcnkuQ2FjaGUjcmVtb3ZlXG4gICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBSZW1vdmVzIGFuIGVudHJ5IGZyb20gdGhlIHtAbGluayAkY2FjaGVGYWN0b3J5LkNhY2hlIENhY2hlfSBvYmplY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgdGhlIGtleSBvZiB0aGUgZW50cnkgdG8gYmUgcmVtb3ZlZFxuICAgICAgICAgKi9cbiAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICBpZiAoY2FwYWNpdHkgPCBOdW1iZXIuTUFYX1ZBTFVFKSB7XG4gICAgICAgICAgICB2YXIgbHJ1RW50cnkgPSBscnVIYXNoW2tleV07XG5cbiAgICAgICAgICAgIGlmICghbHJ1RW50cnkpIHJldHVybjtcblxuICAgICAgICAgICAgaWYgKGxydUVudHJ5ID09IGZyZXNoRW5kKSBmcmVzaEVuZCA9IGxydUVudHJ5LnA7XG4gICAgICAgICAgICBpZiAobHJ1RW50cnkgPT0gc3RhbGVFbmQpIHN0YWxlRW5kID0gbHJ1RW50cnkubjtcbiAgICAgICAgICAgIGxpbmsobHJ1RW50cnkubixscnVFbnRyeS5wKTtcblxuICAgICAgICAgICAgZGVsZXRlIGxydUhhc2hba2V5XTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIShrZXkgaW4gZGF0YSkpIHJldHVybjtcblxuICAgICAgICAgIGRlbGV0ZSBkYXRhW2tleV07XG4gICAgICAgICAgc2l6ZS0tO1xuICAgICAgICB9LFxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICogQG5hbWUgJGNhY2hlRmFjdG9yeS5DYWNoZSNyZW1vdmVBbGxcbiAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAqIENsZWFycyB0aGUgY2FjaGUgb2JqZWN0IG9mIGFueSBlbnRyaWVzLlxuICAgICAgICAgKi9cbiAgICAgICAgcmVtb3ZlQWxsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBkYXRhID0gY3JlYXRlTWFwKCk7XG4gICAgICAgICAgc2l6ZSA9IDA7XG4gICAgICAgICAgbHJ1SGFzaCA9IGNyZWF0ZU1hcCgpO1xuICAgICAgICAgIGZyZXNoRW5kID0gc3RhbGVFbmQgPSBudWxsO1xuICAgICAgICB9LFxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICogQG5hbWUgJGNhY2hlRmFjdG9yeS5DYWNoZSNkZXN0cm95XG4gICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBEZXN0cm95cyB0aGUge0BsaW5rICRjYWNoZUZhY3RvcnkuQ2FjaGUgQ2FjaGV9IG9iamVjdCBlbnRpcmVseSxcbiAgICAgICAgICogcmVtb3ZpbmcgaXQgZnJvbSB0aGUge0BsaW5rICRjYWNoZUZhY3RvcnkgJGNhY2hlRmFjdG9yeX0gc2V0LlxuICAgICAgICAgKi9cbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZGF0YSA9IG51bGw7XG4gICAgICAgICAgc3RhdHMgPSBudWxsO1xuICAgICAgICAgIGxydUhhc2ggPSBudWxsO1xuICAgICAgICAgIGRlbGV0ZSBjYWNoZXNbY2FjaGVJZF07XG4gICAgICAgIH0sXG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgKiBAbmFtZSAkY2FjaGVGYWN0b3J5LkNhY2hlI2luZm9cbiAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAqIFJldHJpZXZlIGluZm9ybWF0aW9uIHJlZ2FyZGluZyBhIHBhcnRpY3VsYXIge0BsaW5rICRjYWNoZUZhY3RvcnkuQ2FjaGUgQ2FjaGV9LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSBhbiBvYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gICAgICAgICAqICAgPHVsPlxuICAgICAgICAgKiAgICAgPGxpPioqaWQqKjogdGhlIGlkIG9mIHRoZSBjYWNoZSBpbnN0YW5jZTwvbGk+XG4gICAgICAgICAqICAgICA8bGk+KipzaXplKio6IHRoZSBudW1iZXIgb2YgZW50cmllcyBrZXB0IGluIHRoZSBjYWNoZSBpbnN0YW5jZTwvbGk+XG4gICAgICAgICAqICAgICA8bGk+KiouLi4qKjogYW55IGFkZGl0aW9uYWwgcHJvcGVydGllcyBmcm9tIHRoZSBvcHRpb25zIG9iamVjdCB3aGVuIGNyZWF0aW5nIHRoZVxuICAgICAgICAgKiAgICAgICBjYWNoZS48L2xpPlxuICAgICAgICAgKiAgIDwvdWw+XG4gICAgICAgICAqL1xuICAgICAgICBpbmZvOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZXh0ZW5kKHt9LCBzdGF0cywge3NpemU6IHNpemV9KTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuXG4gICAgICAvKipcbiAgICAgICAqIG1ha2VzIHRoZSBgZW50cnlgIHRoZSBmcmVzaEVuZCBvZiB0aGUgTFJVIGxpbmtlZCBsaXN0XG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIHJlZnJlc2goZW50cnkpIHtcbiAgICAgICAgaWYgKGVudHJ5ICE9IGZyZXNoRW5kKSB7XG4gICAgICAgICAgaWYgKCFzdGFsZUVuZCkge1xuICAgICAgICAgICAgc3RhbGVFbmQgPSBlbnRyeTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHN0YWxlRW5kID09IGVudHJ5KSB7XG4gICAgICAgICAgICBzdGFsZUVuZCA9IGVudHJ5Lm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbGluayhlbnRyeS5uLCBlbnRyeS5wKTtcbiAgICAgICAgICBsaW5rKGVudHJ5LCBmcmVzaEVuZCk7XG4gICAgICAgICAgZnJlc2hFbmQgPSBlbnRyeTtcbiAgICAgICAgICBmcmVzaEVuZC5uID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuXG5cbiAgICAgIC8qKlxuICAgICAgICogYmlkaXJlY3Rpb25hbGx5IGxpbmtzIHR3byBlbnRyaWVzIG9mIHRoZSBMUlUgbGlua2VkIGxpc3RcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gbGluayhuZXh0RW50cnksIHByZXZFbnRyeSkge1xuICAgICAgICBpZiAobmV4dEVudHJ5ICE9IHByZXZFbnRyeSkge1xuICAgICAgICAgIGlmIChuZXh0RW50cnkpIG5leHRFbnRyeS5wID0gcHJldkVudHJ5OyAvL3Agc3RhbmRzIGZvciBwcmV2aW91cywgJ3ByZXYnIGRpZG4ndCBtaW5pZnlcbiAgICAgICAgICBpZiAocHJldkVudHJ5KSBwcmV2RW50cnkubiA9IG5leHRFbnRyeTsgLy9uIHN0YW5kcyBmb3IgbmV4dCwgJ25leHQnIGRpZG4ndCBtaW5pZnlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRjYWNoZUZhY3RvcnkjaW5mb1xuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogR2V0IGluZm9ybWF0aW9uIGFib3V0IGFsbCB0aGUgY2FjaGVzIHRoYXQgaGF2ZSBiZWVuIGNyZWF0ZWRcbiAgICpcbiAgICogQHJldHVybnMge09iamVjdH0gLSBrZXktdmFsdWUgbWFwIG9mIGBjYWNoZUlkYCB0byB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYGNhY2hlI2luZm9gXG4gICAqL1xuICAgIGNhY2hlRmFjdG9yeS5pbmZvID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgaW5mbyA9IHt9O1xuICAgICAgZm9yRWFjaChjYWNoZXMsIGZ1bmN0aW9uKGNhY2hlLCBjYWNoZUlkKSB7XG4gICAgICAgIGluZm9bY2FjaGVJZF0gPSBjYWNoZS5pbmZvKCk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBpbmZvO1xuICAgIH07XG5cblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkY2FjaGVGYWN0b3J5I2dldFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogR2V0IGFjY2VzcyB0byBhIGNhY2hlIG9iamVjdCBieSB0aGUgYGNhY2hlSWRgIHVzZWQgd2hlbiBpdCB3YXMgY3JlYXRlZC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGNhY2hlSWQgTmFtZSBvciBpZCBvZiBhIGNhY2hlIHRvIGFjY2Vzcy5cbiAgICogQHJldHVybnMge29iamVjdH0gQ2FjaGUgb2JqZWN0IGlkZW50aWZpZWQgYnkgdGhlIGNhY2hlSWQgb3IgdW5kZWZpbmVkIGlmIG5vIHN1Y2ggY2FjaGUuXG4gICAqL1xuICAgIGNhY2hlRmFjdG9yeS5nZXQgPSBmdW5jdGlvbihjYWNoZUlkKSB7XG4gICAgICByZXR1cm4gY2FjaGVzW2NhY2hlSWRdO1xuICAgIH07XG5cblxuICAgIHJldHVybiBjYWNoZUZhY3Rvcnk7XG4gIH07XG59XG5cbi8qKlxuICogQG5nZG9jIHNlcnZpY2VcbiAqIEBuYW1lICR0ZW1wbGF0ZUNhY2hlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGUgZmlyc3QgdGltZSBhIHRlbXBsYXRlIGlzIHVzZWQsIGl0IGlzIGxvYWRlZCBpbiB0aGUgdGVtcGxhdGUgY2FjaGUgZm9yIHF1aWNrIHJldHJpZXZhbC4gWW91XG4gKiBjYW4gbG9hZCB0ZW1wbGF0ZXMgZGlyZWN0bHkgaW50byB0aGUgY2FjaGUgaW4gYSBgc2NyaXB0YCB0YWcsIG9yIGJ5IGNvbnN1bWluZyB0aGVcbiAqIGAkdGVtcGxhdGVDYWNoZWAgc2VydmljZSBkaXJlY3RseS5cbiAqXG4gKiBBZGRpbmcgdmlhIHRoZSBgc2NyaXB0YCB0YWc6XG4gKlxuICogYGBgaHRtbFxuICogICA8c2NyaXB0IHR5cGU9XCJ0ZXh0L25nLXRlbXBsYXRlXCIgaWQ9XCJ0ZW1wbGF0ZUlkLmh0bWxcIj5cbiAqICAgICA8cD5UaGlzIGlzIHRoZSBjb250ZW50IG9mIHRoZSB0ZW1wbGF0ZTwvcD5cbiAqICAgPC9zY3JpcHQ+XG4gKiBgYGBcbiAqXG4gKiAqKk5vdGU6KiogdGhlIGBzY3JpcHRgIHRhZyBjb250YWluaW5nIHRoZSB0ZW1wbGF0ZSBkb2VzIG5vdCBuZWVkIHRvIGJlIGluY2x1ZGVkIGluIHRoZSBgaGVhZGAgb2ZcbiAqIHRoZSBkb2N1bWVudCwgYnV0IGl0IG11c3QgYmUgYSBkZXNjZW5kZW50IG9mIHRoZSB7QGxpbmsgbmcuJHJvb3RFbGVtZW50ICRyb290RWxlbWVudH0gKElFLFxuICogZWxlbWVudCB3aXRoIG5nLWFwcCBhdHRyaWJ1dGUpLCBvdGhlcndpc2UgdGhlIHRlbXBsYXRlIHdpbGwgYmUgaWdub3JlZC5cbiAqXG4gKiBBZGRpbmcgdmlhIHRoZSBgJHRlbXBsYXRlQ2FjaGVgIHNlcnZpY2U6XG4gKlxuICogYGBganNcbiAqIHZhciBteUFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcsIFtdKTtcbiAqIG15QXBwLnJ1bihmdW5jdGlvbigkdGVtcGxhdGVDYWNoZSkge1xuICogICAkdGVtcGxhdGVDYWNoZS5wdXQoJ3RlbXBsYXRlSWQuaHRtbCcsICdUaGlzIGlzIHRoZSBjb250ZW50IG9mIHRoZSB0ZW1wbGF0ZScpO1xuICogfSk7XG4gKiBgYGBcbiAqXG4gKiBUbyByZXRyaWV2ZSB0aGUgdGVtcGxhdGUgbGF0ZXIsIHNpbXBseSB1c2UgaXQgaW4geW91ciBIVE1MOlxuICogYGBgaHRtbFxuICogPGRpdiBuZy1pbmNsdWRlPVwiICd0ZW1wbGF0ZUlkLmh0bWwnIFwiPjwvZGl2PlxuICogYGBgXG4gKlxuICogb3IgZ2V0IGl0IHZpYSBKYXZhc2NyaXB0OlxuICogYGBganNcbiAqICR0ZW1wbGF0ZUNhY2hlLmdldCgndGVtcGxhdGVJZC5odG1sJylcbiAqIGBgYFxuICpcbiAqIFNlZSB7QGxpbmsgbmcuJGNhY2hlRmFjdG9yeSAkY2FjaGVGYWN0b3J5fS5cbiAqXG4gKi9cbmZ1bmN0aW9uICRUZW1wbGF0ZUNhY2hlUHJvdmlkZXIoKSB7XG4gIHRoaXMuJGdldCA9IFsnJGNhY2hlRmFjdG9yeScsIGZ1bmN0aW9uKCRjYWNoZUZhY3RvcnkpIHtcbiAgICByZXR1cm4gJGNhY2hlRmFjdG9yeSgndGVtcGxhdGVzJyk7XG4gIH1dO1xufVxuXG4vKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqXG4gKiAgICAgQW55IGNvbW1pdHMgdG8gdGhpcyBmaWxlIHNob3VsZCBiZSByZXZpZXdlZCB3aXRoIHNlY3VyaXR5IGluIG1pbmQuICAqXG4gKiAgIENoYW5nZXMgdG8gdGhpcyBmaWxlIGNhbiBwb3RlbnRpYWxseSBjcmVhdGUgc2VjdXJpdHkgdnVsbmVyYWJpbGl0aWVzLiAqXG4gKiAgICAgICAgICBBbiBhcHByb3ZhbCBmcm9tIDIgQ29yZSBtZW1iZXJzIHdpdGggaGlzdG9yeSBvZiBtb2RpZnlpbmcgICAgICAqXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzIGZpbGUgaXMgcmVxdWlyZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gKiAgRG9lcyB0aGUgY2hhbmdlIHNvbWVob3cgYWxsb3cgZm9yIGFyYml0cmFyeSBqYXZhc2NyaXB0IHRvIGJlIGV4ZWN1dGVkPyAqXG4gKiAgICBPciBhbGxvd3MgZm9yIHNvbWVvbmUgdG8gY2hhbmdlIHRoZSBwcm90b3R5cGUgb2YgYnVpbHQtaW4gb2JqZWN0cz8gICAqXG4gKiAgICAgT3IgZ2l2ZXMgdW5kZXNpcmVkIGFjY2VzcyB0byB2YXJpYWJsZXMgbGlrZXMgZG9jdW1lbnQgb3Igd2luZG93PyAgICAqXG4gKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqL1xuXG4vKiAhIFZBUklBQkxFL0ZVTkNUSU9OIE5BTUlORyBDT05WRU5USU9OUyBUSEFUIEFQUExZIFRPIFRISVMgRklMRSFcbiAqXG4gKiBET00tcmVsYXRlZCB2YXJpYWJsZXM6XG4gKlxuICogLSBcIm5vZGVcIiAtIERPTSBOb2RlXG4gKiAtIFwiZWxlbWVudFwiIC0gRE9NIEVsZW1lbnQgb3IgTm9kZVxuICogLSBcIiRub2RlXCIgb3IgXCIkZWxlbWVudFwiIC0ganFMaXRlLXdyYXBwZWQgbm9kZSBvciBlbGVtZW50XG4gKlxuICpcbiAqIENvbXBpbGVyIHJlbGF0ZWQgc3R1ZmY6XG4gKlxuICogLSBcImxpbmtGblwiIC0gbGlua2luZyBmbiBvZiBhIHNpbmdsZSBkaXJlY3RpdmVcbiAqIC0gXCJub2RlTGlua0ZuXCIgLSBmdW5jdGlvbiB0aGF0IGFnZ3JlZ2F0ZXMgYWxsIGxpbmtpbmcgZm5zIGZvciBhIHBhcnRpY3VsYXIgbm9kZVxuICogLSBcImNoaWxkTGlua0ZuXCIgLSAgZnVuY3Rpb24gdGhhdCBhZ2dyZWdhdGVzIGFsbCBsaW5raW5nIGZucyBmb3IgY2hpbGQgbm9kZXMgb2YgYSBwYXJ0aWN1bGFyIG5vZGVcbiAqIC0gXCJjb21wb3NpdGVMaW5rRm5cIiAtIGZ1bmN0aW9uIHRoYXQgYWdncmVnYXRlcyBhbGwgbGlua2luZyBmbnMgZm9yIGEgY29tcGlsYXRpb24gcm9vdCAobm9kZUxpc3QpXG4gKi9cblxuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkY29tcGlsZVxuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIENvbXBpbGVzIGFuIEhUTUwgc3RyaW5nIG9yIERPTSBpbnRvIGEgdGVtcGxhdGUgYW5kIHByb2R1Y2VzIGEgdGVtcGxhdGUgZnVuY3Rpb24sIHdoaWNoXG4gKiBjYW4gdGhlbiBiZSB1c2VkIHRvIGxpbmsge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUgYHNjb3BlYH0gYW5kIHRoZSB0ZW1wbGF0ZSB0b2dldGhlci5cbiAqXG4gKiBUaGUgY29tcGlsYXRpb24gaXMgYSBwcm9jZXNzIG9mIHdhbGtpbmcgdGhlIERPTSB0cmVlIGFuZCBtYXRjaGluZyBET00gZWxlbWVudHMgdG9cbiAqIHtAbGluayBuZy4kY29tcGlsZVByb3ZpZGVyI2RpcmVjdGl2ZSBkaXJlY3RpdmVzfS5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuICogKipOb3RlOioqIFRoaXMgZG9jdW1lbnQgaXMgYW4gaW4tZGVwdGggcmVmZXJlbmNlIG9mIGFsbCBkaXJlY3RpdmUgb3B0aW9ucy5cbiAqIEZvciBhIGdlbnRsZSBpbnRyb2R1Y3Rpb24gdG8gZGlyZWN0aXZlcyB3aXRoIGV4YW1wbGVzIG9mIGNvbW1vbiB1c2UgY2FzZXMsXG4gKiBzZWUgdGhlIHtAbGluayBndWlkZS9kaXJlY3RpdmUgZGlyZWN0aXZlIGd1aWRlfS5cbiAqIDwvZGl2PlxuICpcbiAqICMjIENvbXByZWhlbnNpdmUgRGlyZWN0aXZlIEFQSVxuICpcbiAqIFRoZXJlIGFyZSBtYW55IGRpZmZlcmVudCBvcHRpb25zIGZvciBhIGRpcmVjdGl2ZS5cbiAqXG4gKiBUaGUgZGlmZmVyZW5jZSByZXNpZGVzIGluIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGZhY3RvcnkgZnVuY3Rpb24uXG4gKiBZb3UgY2FuIGVpdGhlciByZXR1cm4gYSBcIkRpcmVjdGl2ZSBEZWZpbml0aW9uIE9iamVjdFwiIChzZWUgYmVsb3cpIHRoYXQgZGVmaW5lcyB0aGUgZGlyZWN0aXZlIHByb3BlcnRpZXMsXG4gKiBvciBqdXN0IHRoZSBgcG9zdExpbmtgIGZ1bmN0aW9uIChhbGwgb3RoZXIgcHJvcGVydGllcyB3aWxsIGhhdmUgdGhlIGRlZmF1bHQgdmFsdWVzKS5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtc3VjY2Vzc1wiPlxuICogKipCZXN0IFByYWN0aWNlOioqIEl0J3MgcmVjb21tZW5kZWQgdG8gdXNlIHRoZSBcImRpcmVjdGl2ZSBkZWZpbml0aW9uIG9iamVjdFwiIGZvcm0uXG4gKiA8L2Rpdj5cbiAqXG4gKiBIZXJlJ3MgYW4gZXhhbXBsZSBkaXJlY3RpdmUgZGVjbGFyZWQgd2l0aCBhIERpcmVjdGl2ZSBEZWZpbml0aW9uIE9iamVjdDpcbiAqXG4gKiBgYGBqc1xuICogICB2YXIgbXlNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSguLi4pO1xuICpcbiAqICAgbXlNb2R1bGUuZGlyZWN0aXZlKCdkaXJlY3RpdmVOYW1lJywgZnVuY3Rpb24gZmFjdG9yeShpbmplY3RhYmxlcykge1xuICogICAgIHZhciBkaXJlY3RpdmVEZWZpbml0aW9uT2JqZWN0ID0ge1xuICogICAgICAgcHJpb3JpdHk6IDAsXG4gKiAgICAgICB0ZW1wbGF0ZTogJzxkaXY+PC9kaXY+JywgLy8gb3IgLy8gZnVuY3Rpb24odEVsZW1lbnQsIHRBdHRycykgeyAuLi4gfSxcbiAqICAgICAgIC8vIG9yXG4gKiAgICAgICAvLyB0ZW1wbGF0ZVVybDogJ2RpcmVjdGl2ZS5odG1sJywgLy8gb3IgLy8gZnVuY3Rpb24odEVsZW1lbnQsIHRBdHRycykgeyAuLi4gfSxcbiAqICAgICAgIHRyYW5zY2x1ZGU6IGZhbHNlLFxuICogICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAqICAgICAgIHRlbXBsYXRlTmFtZXNwYWNlOiAnaHRtbCcsXG4gKiAgICAgICBzY29wZTogZmFsc2UsXG4gKiAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICR0cmFuc2NsdWRlLCBvdGhlckluamVjdGFibGVzKSB7IC4uLiB9LFxuICogICAgICAgY29udHJvbGxlckFzOiAnc3RyaW5nSWRlbnRpZmllcicsXG4gKiAgICAgICBiaW5kVG9Db250cm9sbGVyOiBmYWxzZSxcbiAqICAgICAgIHJlcXVpcmU6ICdzaWJsaW5nRGlyZWN0aXZlTmFtZScsIC8vIG9yIC8vIFsnXnBhcmVudERpcmVjdGl2ZU5hbWUnLCAnP29wdGlvbmFsRGlyZWN0aXZlTmFtZScsICc/Xm9wdGlvbmFsUGFyZW50J10sXG4gKiAgICAgICBjb21waWxlOiBmdW5jdGlvbiBjb21waWxlKHRFbGVtZW50LCB0QXR0cnMsIHRyYW5zY2x1ZGUpIHtcbiAqICAgICAgICAgcmV0dXJuIHtcbiAqICAgICAgICAgICBwcmU6IGZ1bmN0aW9uIHByZUxpbmsoc2NvcGUsIGlFbGVtZW50LCBpQXR0cnMsIGNvbnRyb2xsZXIpIHsgLi4uIH0sXG4gKiAgICAgICAgICAgcG9zdDogZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGlFbGVtZW50LCBpQXR0cnMsIGNvbnRyb2xsZXIpIHsgLi4uIH1cbiAqICAgICAgICAgfVxuICogICAgICAgICAvLyBvclxuICogICAgICAgICAvLyByZXR1cm4gZnVuY3Rpb24gcG9zdExpbmsoIC4uLiApIHsgLi4uIH1cbiAqICAgICAgIH0sXG4gKiAgICAgICAvLyBvclxuICogICAgICAgLy8gbGluazoge1xuICogICAgICAgLy8gIHByZTogZnVuY3Rpb24gcHJlTGluayhzY29wZSwgaUVsZW1lbnQsIGlBdHRycywgY29udHJvbGxlcikgeyAuLi4gfSxcbiAqICAgICAgIC8vICBwb3N0OiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgaUVsZW1lbnQsIGlBdHRycywgY29udHJvbGxlcikgeyAuLi4gfVxuICogICAgICAgLy8gfVxuICogICAgICAgLy8gb3JcbiAqICAgICAgIC8vIGxpbms6IGZ1bmN0aW9uIHBvc3RMaW5rKCAuLi4gKSB7IC4uLiB9XG4gKiAgICAgfTtcbiAqICAgICByZXR1cm4gZGlyZWN0aXZlRGVmaW5pdGlvbk9iamVjdDtcbiAqICAgfSk7XG4gKiBgYGBcbiAqXG4gKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuICogKipOb3RlOioqIEFueSB1bnNwZWNpZmllZCBvcHRpb25zIHdpbGwgdXNlIHRoZSBkZWZhdWx0IHZhbHVlLiBZb3UgY2FuIHNlZSB0aGUgZGVmYXVsdCB2YWx1ZXMgYmVsb3cuXG4gKiA8L2Rpdj5cbiAqXG4gKiBUaGVyZWZvcmUgdGhlIGFib3ZlIGNhbiBiZSBzaW1wbGlmaWVkIGFzOlxuICpcbiAqIGBgYGpzXG4gKiAgIHZhciBteU1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKC4uLik7XG4gKlxuICogICBteU1vZHVsZS5kaXJlY3RpdmUoJ2RpcmVjdGl2ZU5hbWUnLCBmdW5jdGlvbiBmYWN0b3J5KGluamVjdGFibGVzKSB7XG4gKiAgICAgdmFyIGRpcmVjdGl2ZURlZmluaXRpb25PYmplY3QgPSB7XG4gKiAgICAgICBsaW5rOiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgaUVsZW1lbnQsIGlBdHRycykgeyAuLi4gfVxuICogICAgIH07XG4gKiAgICAgcmV0dXJuIGRpcmVjdGl2ZURlZmluaXRpb25PYmplY3Q7XG4gKiAgICAgLy8gb3JcbiAqICAgICAvLyByZXR1cm4gZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGlFbGVtZW50LCBpQXR0cnMpIHsgLi4uIH1cbiAqICAgfSk7XG4gKiBgYGBcbiAqXG4gKlxuICpcbiAqICMjIyBEaXJlY3RpdmUgRGVmaW5pdGlvbiBPYmplY3RcbiAqXG4gKiBUaGUgZGlyZWN0aXZlIGRlZmluaXRpb24gb2JqZWN0IHByb3ZpZGVzIGluc3RydWN0aW9ucyB0byB0aGUge0BsaW5rIG5nLiRjb21waWxlXG4gKiBjb21waWxlcn0uIFRoZSBhdHRyaWJ1dGVzIGFyZTpcbiAqXG4gKiAjIyMjIGBtdWx0aUVsZW1lbnRgXG4gKiBXaGVuIHRoaXMgcHJvcGVydHkgaXMgc2V0IHRvIHRydWUsIHRoZSBIVE1MIGNvbXBpbGVyIHdpbGwgY29sbGVjdCBET00gbm9kZXMgYmV0d2VlblxuICogbm9kZXMgd2l0aCB0aGUgYXR0cmlidXRlcyBgZGlyZWN0aXZlLW5hbWUtc3RhcnRgIGFuZCBgZGlyZWN0aXZlLW5hbWUtZW5kYCwgYW5kIGdyb3VwIHRoZW1cbiAqIHRvZ2V0aGVyIGFzIHRoZSBkaXJlY3RpdmUgZWxlbWVudHMuIEl0IGlzIHJlY29tbWVuZGVkIHRoYXQgdGhpcyBmZWF0dXJlIGJlIHVzZWQgb24gZGlyZWN0aXZlc1xuICogd2hpY2ggYXJlIG5vdCBzdHJpY3RseSBiZWhhdmlvcmFsIChzdWNoIGFzIHtAbGluayBuZ0NsaWNrfSksIGFuZCB3aGljaFxuICogZG8gbm90IG1hbmlwdWxhdGUgb3IgcmVwbGFjZSBjaGlsZCBub2RlcyAoc3VjaCBhcyB7QGxpbmsgbmdJbmNsdWRlfSkuXG4gKlxuICogIyMjIyBgcHJpb3JpdHlgXG4gKiBXaGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBkaXJlY3RpdmVzIGRlZmluZWQgb24gYSBzaW5nbGUgRE9NIGVsZW1lbnQsIHNvbWV0aW1lcyBpdFxuICogaXMgbmVjZXNzYXJ5IHRvIHNwZWNpZnkgdGhlIG9yZGVyIGluIHdoaWNoIHRoZSBkaXJlY3RpdmVzIGFyZSBhcHBsaWVkLiBUaGUgYHByaW9yaXR5YCBpcyB1c2VkXG4gKiB0byBzb3J0IHRoZSBkaXJlY3RpdmVzIGJlZm9yZSB0aGVpciBgY29tcGlsZWAgZnVuY3Rpb25zIGdldCBjYWxsZWQuIFByaW9yaXR5IGlzIGRlZmluZWQgYXMgYVxuICogbnVtYmVyLiBEaXJlY3RpdmVzIHdpdGggZ3JlYXRlciBudW1lcmljYWwgYHByaW9yaXR5YCBhcmUgY29tcGlsZWQgZmlyc3QuIFByZS1saW5rIGZ1bmN0aW9uc1xuICogYXJlIGFsc28gcnVuIGluIHByaW9yaXR5IG9yZGVyLCBidXQgcG9zdC1saW5rIGZ1bmN0aW9ucyBhcmUgcnVuIGluIHJldmVyc2Ugb3JkZXIuIFRoZSBvcmRlclxuICogb2YgZGlyZWN0aXZlcyB3aXRoIHRoZSBzYW1lIHByaW9yaXR5IGlzIHVuZGVmaW5lZC4gVGhlIGRlZmF1bHQgcHJpb3JpdHkgaXMgYDBgLlxuICpcbiAqICMjIyMgYHRlcm1pbmFsYFxuICogSWYgc2V0IHRvIHRydWUgdGhlbiB0aGUgY3VycmVudCBgcHJpb3JpdHlgIHdpbGwgYmUgdGhlIGxhc3Qgc2V0IG9mIGRpcmVjdGl2ZXNcbiAqIHdoaWNoIHdpbGwgZXhlY3V0ZSAoYW55IGRpcmVjdGl2ZXMgYXQgdGhlIGN1cnJlbnQgcHJpb3JpdHkgd2lsbCBzdGlsbCBleGVjdXRlXG4gKiBhcyB0aGUgb3JkZXIgb2YgZXhlY3V0aW9uIG9uIHNhbWUgYHByaW9yaXR5YCBpcyB1bmRlZmluZWQpLiBOb3RlIHRoYXQgZXhwcmVzc2lvbnNcbiAqIGFuZCBvdGhlciBkaXJlY3RpdmVzIHVzZWQgaW4gdGhlIGRpcmVjdGl2ZSdzIHRlbXBsYXRlIHdpbGwgYWxzbyBiZSBleGNsdWRlZCBmcm9tIGV4ZWN1dGlvbi5cbiAqXG4gKiAjIyMjIGBzY29wZWBcbiAqIFRoZSBzY29wZSBwcm9wZXJ0eSBjYW4gYmUgYHRydWVgLCBhbiBvYmplY3Qgb3IgYSBmYWxzeSB2YWx1ZTpcbiAqXG4gKiAqICoqZmFsc3k6KiogTm8gc2NvcGUgd2lsbCBiZSBjcmVhdGVkIGZvciB0aGUgZGlyZWN0aXZlLiBUaGUgZGlyZWN0aXZlIHdpbGwgdXNlIGl0cyBwYXJlbnQncyBzY29wZS5cbiAqXG4gKiAqICoqYHRydWVgOioqIEEgbmV3IGNoaWxkIHNjb3BlIHRoYXQgcHJvdG90eXBpY2FsbHkgaW5oZXJpdHMgZnJvbSBpdHMgcGFyZW50IHdpbGwgYmUgY3JlYXRlZCBmb3JcbiAqIHRoZSBkaXJlY3RpdmUncyBlbGVtZW50LiBJZiBtdWx0aXBsZSBkaXJlY3RpdmVzIG9uIHRoZSBzYW1lIGVsZW1lbnQgcmVxdWVzdCBhIG5ldyBzY29wZSxcbiAqIG9ubHkgb25lIG5ldyBzY29wZSBpcyBjcmVhdGVkLiBUaGUgbmV3IHNjb3BlIHJ1bGUgZG9lcyBub3QgYXBwbHkgZm9yIHRoZSByb290IG9mIHRoZSB0ZW1wbGF0ZVxuICogc2luY2UgdGhlIHJvb3Qgb2YgdGhlIHRlbXBsYXRlIGFsd2F5cyBnZXRzIGEgbmV3IHNjb3BlLlxuICpcbiAqICogKipgey4uLn1gIChhbiBvYmplY3QgaGFzaCk6KiogQSBuZXcgXCJpc29sYXRlXCIgc2NvcGUgaXMgY3JlYXRlZCBmb3IgdGhlIGRpcmVjdGl2ZSdzIGVsZW1lbnQuIFRoZVxuICogJ2lzb2xhdGUnIHNjb3BlIGRpZmZlcnMgZnJvbSBub3JtYWwgc2NvcGUgaW4gdGhhdCBpdCBkb2VzIG5vdCBwcm90b3R5cGljYWxseSBpbmhlcml0IGZyb20gaXRzIHBhcmVudFxuICogc2NvcGUuIFRoaXMgaXMgdXNlZnVsIHdoZW4gY3JlYXRpbmcgcmV1c2FibGUgY29tcG9uZW50cywgd2hpY2ggc2hvdWxkIG5vdCBhY2NpZGVudGFsbHkgcmVhZCBvciBtb2RpZnlcbiAqIGRhdGEgaW4gdGhlIHBhcmVudCBzY29wZS5cbiAqXG4gKiBUaGUgJ2lzb2xhdGUnIHNjb3BlIG9iamVjdCBoYXNoIGRlZmluZXMgYSBzZXQgb2YgbG9jYWwgc2NvcGUgcHJvcGVydGllcyBkZXJpdmVkIGZyb20gYXR0cmlidXRlcyBvbiB0aGVcbiAqIGRpcmVjdGl2ZSdzIGVsZW1lbnQuIFRoZXNlIGxvY2FsIHByb3BlcnRpZXMgYXJlIHVzZWZ1bCBmb3IgYWxpYXNpbmcgdmFsdWVzIGZvciB0ZW1wbGF0ZXMuIFRoZSBrZXlzIGluXG4gKiB0aGUgb2JqZWN0IGhhc2ggbWFwIHRvIHRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSBvbiB0aGUgaXNvbGF0ZSBzY29wZTsgdGhlIHZhbHVlcyBkZWZpbmUgaG93IHRoZSBwcm9wZXJ0eVxuICogaXMgYm91bmQgdG8gdGhlIHBhcmVudCBzY29wZSwgdmlhIG1hdGNoaW5nIGF0dHJpYnV0ZXMgb24gdGhlIGRpcmVjdGl2ZSdzIGVsZW1lbnQ6XG4gKlxuICogKiBgQGAgb3IgYEBhdHRyYCAtIGJpbmQgYSBsb2NhbCBzY29wZSBwcm9wZXJ0eSB0byB0aGUgdmFsdWUgb2YgRE9NIGF0dHJpYnV0ZS4gVGhlIHJlc3VsdCBpc1xuICogICBhbHdheXMgYSBzdHJpbmcgc2luY2UgRE9NIGF0dHJpYnV0ZXMgYXJlIHN0cmluZ3MuIElmIG5vIGBhdHRyYCBuYW1lIGlzIHNwZWNpZmllZCB0aGVuIHRoZVxuICogICBhdHRyaWJ1dGUgbmFtZSBpcyBhc3N1bWVkIHRvIGJlIHRoZSBzYW1lIGFzIHRoZSBsb2NhbCBuYW1lLiBHaXZlbiBgPG15LWNvbXBvbmVudFxuICogICBteS1hdHRyPVwiaGVsbG8ge3tuYW1lfX1cIj5gIGFuZCB0aGUgaXNvbGF0ZSBzY29wZSBkZWZpbml0aW9uIGBzY29wZTogeyBsb2NhbE5hbWU6J0BteUF0dHInIH1gLFxuICogICB0aGUgZGlyZWN0aXZlJ3Mgc2NvcGUgcHJvcGVydHkgYGxvY2FsTmFtZWAgd2lsbCByZWZsZWN0IHRoZSBpbnRlcnBvbGF0ZWQgdmFsdWUgb2YgYGhlbGxvXG4gKiAgIHt7bmFtZX19YC4gQXMgdGhlIGBuYW1lYCBhdHRyaWJ1dGUgY2hhbmdlcyBzbyB3aWxsIHRoZSBgbG9jYWxOYW1lYCBwcm9wZXJ0eSBvbiB0aGUgZGlyZWN0aXZlJ3NcbiAqICAgc2NvcGUuIFRoZSBgbmFtZWAgaXMgcmVhZCBmcm9tIHRoZSBwYXJlbnQgc2NvcGUgKG5vdCB0aGUgZGlyZWN0aXZlJ3Mgc2NvcGUpLlxuICpcbiAqICogYD1gIG9yIGA9YXR0cmAgLSBzZXQgdXAgYSBiaWRpcmVjdGlvbmFsIGJpbmRpbmcgYmV0d2VlbiBhIGxvY2FsIHNjb3BlIHByb3BlcnR5IGFuZCBhbiBleHByZXNzaW9uXG4gKiAgIHBhc3NlZCB2aWEgdGhlIGF0dHJpYnV0ZSBgYXR0cmAuIFRoZSBleHByZXNzaW9uIGlzIGV2YWx1YXRlZCBpbiB0aGUgY29udGV4dCBvZiB0aGUgcGFyZW50IHNjb3BlLlxuICogICBJZiBubyBgYXR0cmAgbmFtZSBpcyBzcGVjaWZpZWQgdGhlbiB0aGUgYXR0cmlidXRlIG5hbWUgaXMgYXNzdW1lZCB0byBiZSB0aGUgc2FtZSBhcyB0aGUgbG9jYWxcbiAqICAgbmFtZS4gR2l2ZW4gYDxteS1jb21wb25lbnQgbXktYXR0cj1cInBhcmVudE1vZGVsXCI+YCBhbmQgdGhlIGlzb2xhdGUgc2NvcGUgZGVmaW5pdGlvbiBgc2NvcGU6IHtcbiAqICAgbG9jYWxNb2RlbDogJz1teUF0dHInIH1gLCB0aGUgcHJvcGVydHkgYGxvY2FsTW9kZWxgIG9uIHRoZSBkaXJlY3RpdmUncyBzY29wZSB3aWxsIHJlZmxlY3QgdGhlXG4gKiAgIHZhbHVlIG9mIGBwYXJlbnRNb2RlbGAgb24gdGhlIHBhcmVudCBzY29wZS4gQ2hhbmdlcyB0byBgcGFyZW50TW9kZWxgIHdpbGwgYmUgcmVmbGVjdGVkIGluXG4gKiAgIGBsb2NhbE1vZGVsYCBhbmQgdmljZSB2ZXJzYS4gT3B0aW9uYWwgYXR0cmlidXRlcyBzaG91bGQgYmUgbWFya2VkIGFzIHN1Y2ggd2l0aCBhIHF1ZXN0aW9uIG1hcms6XG4gKiAgIGA9P2Agb3IgYD0/YXR0cmAuIElmIHRoZSBiaW5kaW5nIGV4cHJlc3Npb24gaXMgbm9uLWFzc2lnbmFibGUsIG9yIGlmIHRoZSBhdHRyaWJ1dGUgaXNuJ3RcbiAqICAgb3B0aW9uYWwgYW5kIGRvZXNuJ3QgZXhpc3QsIGFuIGV4Y2VwdGlvbiAoe0BsaW5rIGVycm9yLyRjb21waWxlL25vbmFzc2lnbiBgJGNvbXBpbGU6bm9uYXNzaWduYH0pXG4gKiAgIHdpbGwgYmUgdGhyb3duIHVwb24gZGlzY292ZXJpbmcgY2hhbmdlcyB0byB0aGUgbG9jYWwgdmFsdWUsIHNpbmNlIGl0IHdpbGwgYmUgaW1wb3NzaWJsZSB0byBzeW5jXG4gKiAgIHRoZW0gYmFjayB0byB0aGUgcGFyZW50IHNjb3BlLiBCeSBkZWZhdWx0LCB0aGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJHdhdGNoIGAkd2F0Y2hgfVxuICogICBtZXRob2QgaXMgdXNlZCBmb3IgdHJhY2tpbmcgY2hhbmdlcywgYW5kIHRoZSBlcXVhbGl0eSBjaGVjayBpcyBiYXNlZCBvbiBvYmplY3QgaWRlbnRpdHkuXG4gKiAgIEhvd2V2ZXIsIGlmIGFuIG9iamVjdCBsaXRlcmFsIG9yIGFuIGFycmF5IGxpdGVyYWwgaXMgcGFzc2VkIGFzIHRoZSBiaW5kaW5nIGV4cHJlc3Npb24sIHRoZVxuICogICBlcXVhbGl0eSBjaGVjayBpcyBkb25lIGJ5IHZhbHVlICh1c2luZyB0aGUge0BsaW5rIGFuZ3VsYXIuZXF1YWxzfSBmdW5jdGlvbikuIEl0J3MgYWxzbyBwb3NzaWJsZVxuICogICB0byB3YXRjaCB0aGUgZXZhbHVhdGVkIHZhbHVlIHNoYWxsb3dseSB3aXRoIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyR3YXRjaENvbGxlY3Rpb25cbiAqICAgYCR3YXRjaENvbGxlY3Rpb25gfTogdXNlIGA9KmAgb3IgYD0qYXR0cmAgKGA9Kj9gIG9yIGA9Kj9hdHRyYCBpZiB0aGUgYXR0cmlidXRlIGlzIG9wdGlvbmFsKS5cbiAqXG4gICogKiBgPGAgb3IgYDxhdHRyYCAtIHNldCB1cCBhIG9uZS13YXkgKG9uZS1kaXJlY3Rpb25hbCkgYmluZGluZyBiZXR3ZWVuIGEgbG9jYWwgc2NvcGUgcHJvcGVydHkgYW5kIGFuXG4gKiAgIGV4cHJlc3Npb24gcGFzc2VkIHZpYSB0aGUgYXR0cmlidXRlIGBhdHRyYC4gVGhlIGV4cHJlc3Npb24gaXMgZXZhbHVhdGVkIGluIHRoZSBjb250ZXh0IG9mIHRoZVxuICogICBwYXJlbnQgc2NvcGUuIElmIG5vIGBhdHRyYCBuYW1lIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBhdHRyaWJ1dGUgbmFtZSBpcyBhc3N1bWVkIHRvIGJlIHRoZSBzYW1lIGFzIHRoZVxuICogICBsb2NhbCBuYW1lLiBZb3UgY2FuIGFsc28gbWFrZSB0aGUgYmluZGluZyBvcHRpb25hbCBieSBhZGRpbmcgYD9gOiBgPD9gIG9yIGA8P2F0dHJgLlxuICpcbiAqICAgRm9yIGV4YW1wbGUsIGdpdmVuIGA8bXktY29tcG9uZW50IG15LWF0dHI9XCJwYXJlbnRNb2RlbFwiPmAgYW5kIGRpcmVjdGl2ZSBkZWZpbml0aW9uIG9mXG4gKiAgIGBzY29wZTogeyBsb2NhbE1vZGVsOic8bXlBdHRyJyB9YCwgdGhlbiB0aGUgaXNvbGF0ZWQgc2NvcGUgcHJvcGVydHkgYGxvY2FsTW9kZWxgIHdpbGwgcmVmbGVjdCB0aGVcbiAqICAgdmFsdWUgb2YgYHBhcmVudE1vZGVsYCBvbiB0aGUgcGFyZW50IHNjb3BlLiBBbnkgY2hhbmdlcyB0byBgcGFyZW50TW9kZWxgIHdpbGwgYmUgcmVmbGVjdGVkXG4gKiAgIGluIGBsb2NhbE1vZGVsYCwgYnV0IGNoYW5nZXMgaW4gYGxvY2FsTW9kZWxgIHdpbGwgbm90IHJlZmxlY3QgaW4gYHBhcmVudE1vZGVsYC4gVGhlcmUgYXJlIGhvd2V2ZXJcbiAqICAgdHdvIGNhdmVhdHM6XG4gKiAgICAgMS4gb25lLXdheSBiaW5kaW5nIGRvZXMgbm90IGNvcHkgdGhlIHZhbHVlIGZyb20gdGhlIHBhcmVudCB0byB0aGUgaXNvbGF0ZSBzY29wZSwgaXQgc2ltcGx5XG4gKiAgICAgc2V0cyB0aGUgc2FtZSB2YWx1ZS4gVGhhdCBtZWFucyBpZiB5b3VyIGJvdW5kIHZhbHVlIGlzIGFuIG9iamVjdCwgY2hhbmdlcyB0byBpdHMgcHJvcGVydGllc1xuICogICAgIGluIHRoZSBpc29sYXRlZCBzY29wZSB3aWxsIGJlIHJlZmxlY3RlZCBpbiB0aGUgcGFyZW50IHNjb3BlIChiZWNhdXNlIGJvdGggcmVmZXJlbmNlIHRoZSBzYW1lIG9iamVjdCkuXG4gKiAgICAgMi4gb25lLXdheSBiaW5kaW5nIHdhdGNoZXMgY2hhbmdlcyB0byB0aGUgKippZGVudGl0eSoqIG9mIHRoZSBwYXJlbnQgdmFsdWUuIFRoYXQgbWVhbnMgdGhlXG4gKiAgICAge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJHdhdGNoIGAkd2F0Y2hgfSBvbiB0aGUgcGFyZW50IHZhbHVlIG9ubHkgZmlyZXMgaWYgdGhlIHJlZmVyZW5jZVxuICogICAgIHRvIHRoZSB2YWx1ZSBoYXMgY2hhbmdlZC4gSW4gbW9zdCBjYXNlcywgdGhpcyBzaG91bGQgbm90IGJlIG9mIGNvbmNlcm4sIGJ1dCBjYW4gYmUgaW1wb3J0YW50XG4gKiAgICAgdG8ga25vdyBpZiB5b3Ugb25lLXdheSBiaW5kIHRvIGFuIG9iamVjdCwgYW5kIHRoZW4gcmVwbGFjZSB0aGF0IG9iamVjdCBpbiB0aGUgaXNvbGF0ZWQgc2NvcGUuXG4gKiAgICAgSWYgeW91IG5vdyBjaGFuZ2UgYSBwcm9wZXJ0eSBvZiB0aGUgb2JqZWN0IGluIHlvdXIgcGFyZW50IHNjb3BlLCB0aGUgY2hhbmdlIHdpbGwgbm90IGJlXG4gKiAgICAgcHJvcGFnYXRlZCB0byB0aGUgaXNvbGF0ZWQgc2NvcGUsIGJlY2F1c2UgdGhlIGlkZW50aXR5IG9mIHRoZSBvYmplY3Qgb24gdGhlIHBhcmVudCBzY29wZVxuICogICAgIGhhcyBub3QgY2hhbmdlZC4gSW5zdGVhZCB5b3UgbXVzdCBhc3NpZ24gYSBuZXcgb2JqZWN0LlxuICpcbiAqICAgT25lLXdheSBiaW5kaW5nIGlzIHVzZWZ1bCBpZiB5b3UgZG8gbm90IHBsYW4gdG8gcHJvcGFnYXRlIGNoYW5nZXMgdG8geW91ciBpc29sYXRlZCBzY29wZSBiaW5kaW5nc1xuICogICBiYWNrIHRvIHRoZSBwYXJlbnQuIEhvd2V2ZXIsIGl0IGRvZXMgbm90IG1ha2UgdGhpcyBjb21wbGV0ZWx5IGltcG9zc2libGUuXG4gKlxuICogKiBgJmAgb3IgYCZhdHRyYCAtIHByb3ZpZGVzIGEgd2F5IHRvIGV4ZWN1dGUgYW4gZXhwcmVzc2lvbiBpbiB0aGUgY29udGV4dCBvZiB0aGUgcGFyZW50IHNjb3BlLiBJZlxuICogICBubyBgYXR0cmAgbmFtZSBpcyBzcGVjaWZpZWQgdGhlbiB0aGUgYXR0cmlidXRlIG5hbWUgaXMgYXNzdW1lZCB0byBiZSB0aGUgc2FtZSBhcyB0aGUgbG9jYWwgbmFtZS5cbiAqICAgR2l2ZW4gYDxteS1jb21wb25lbnQgbXktYXR0cj1cImNvdW50ID0gY291bnQgKyB2YWx1ZVwiPmAgYW5kIHRoZSBpc29sYXRlIHNjb3BlIGRlZmluaXRpb24gYHNjb3BlOiB7XG4gKiAgIGxvY2FsRm46JyZteUF0dHInIH1gLCB0aGUgaXNvbGF0ZSBzY29wZSBwcm9wZXJ0eSBgbG9jYWxGbmAgd2lsbCBwb2ludCB0byBhIGZ1bmN0aW9uIHdyYXBwZXIgZm9yXG4gKiAgIHRoZSBgY291bnQgPSBjb3VudCArIHZhbHVlYCBleHByZXNzaW9uLiBPZnRlbiBpdCdzIGRlc2lyYWJsZSB0byBwYXNzIGRhdGEgZnJvbSB0aGUgaXNvbGF0ZWQgc2NvcGVcbiAqICAgdmlhIGFuIGV4cHJlc3Npb24gdG8gdGhlIHBhcmVudCBzY29wZS4gVGhpcyBjYW4gYmUgZG9uZSBieSBwYXNzaW5nIGEgbWFwIG9mIGxvY2FsIHZhcmlhYmxlIG5hbWVzXG4gKiAgIGFuZCB2YWx1ZXMgaW50byB0aGUgZXhwcmVzc2lvbiB3cmFwcGVyIGZuLiBGb3IgZXhhbXBsZSwgaWYgdGhlIGV4cHJlc3Npb24gaXMgYGluY3JlbWVudChhbW91bnQpYFxuICogICB0aGVuIHdlIGNhbiBzcGVjaWZ5IHRoZSBhbW91bnQgdmFsdWUgYnkgY2FsbGluZyB0aGUgYGxvY2FsRm5gIGFzIGBsb2NhbEZuKHthbW91bnQ6IDIyfSlgLlxuICpcbiAqIEluIGdlbmVyYWwgaXQncyBwb3NzaWJsZSB0byBhcHBseSBtb3JlIHRoYW4gb25lIGRpcmVjdGl2ZSB0byBvbmUgZWxlbWVudCwgYnV0IHRoZXJlIG1pZ2h0IGJlIGxpbWl0YXRpb25zXG4gKiBkZXBlbmRpbmcgb24gdGhlIHR5cGUgb2Ygc2NvcGUgcmVxdWlyZWQgYnkgdGhlIGRpcmVjdGl2ZXMuIFRoZSBmb2xsb3dpbmcgcG9pbnRzIHdpbGwgaGVscCBleHBsYWluIHRoZXNlIGxpbWl0YXRpb25zLlxuICogRm9yIHNpbXBsaWNpdHkgb25seSB0d28gZGlyZWN0aXZlcyBhcmUgdGFrZW4gaW50byBhY2NvdW50LCBidXQgaXQgaXMgYWxzbyBhcHBsaWNhYmxlIGZvciBzZXZlcmFsIGRpcmVjdGl2ZXM6XG4gKlxuICogKiAqKm5vIHNjb3BlKiogKyAqKm5vIHNjb3BlKiogPT4gVHdvIGRpcmVjdGl2ZXMgd2hpY2ggZG9uJ3QgcmVxdWlyZSB0aGVpciBvd24gc2NvcGUgd2lsbCB1c2UgdGhlaXIgcGFyZW50J3Mgc2NvcGVcbiAqICogKipjaGlsZCBzY29wZSoqICsgKipubyBzY29wZSoqID0+ICBCb3RoIGRpcmVjdGl2ZXMgd2lsbCBzaGFyZSBvbmUgc2luZ2xlIGNoaWxkIHNjb3BlXG4gKiAqICoqY2hpbGQgc2NvcGUqKiArICoqY2hpbGQgc2NvcGUqKiA9PiAgQm90aCBkaXJlY3RpdmVzIHdpbGwgc2hhcmUgb25lIHNpbmdsZSBjaGlsZCBzY29wZVxuICogKiAqKmlzb2xhdGVkIHNjb3BlKiogKyAqKm5vIHNjb3BlKiogPT4gIFRoZSBpc29sYXRlZCBkaXJlY3RpdmUgd2lsbCB1c2UgaXQncyBvd24gY3JlYXRlZCBpc29sYXRlZCBzY29wZS4gVGhlIG90aGVyIGRpcmVjdGl2ZSB3aWxsIHVzZVxuICogaXRzIHBhcmVudCdzIHNjb3BlXG4gKiAqICoqaXNvbGF0ZWQgc2NvcGUqKiArICoqY2hpbGQgc2NvcGUqKiA9PiAgKipXb24ndCB3b3JrISoqIE9ubHkgb25lIHNjb3BlIGNhbiBiZSByZWxhdGVkIHRvIG9uZSBlbGVtZW50LiBUaGVyZWZvcmUgdGhlc2UgZGlyZWN0aXZlcyBjYW5ub3RcbiAqIGJlIGFwcGxpZWQgdG8gdGhlIHNhbWUgZWxlbWVudC5cbiAqICogKippc29sYXRlZCBzY29wZSoqICsgKippc29sYXRlZCBzY29wZSoqICA9PiAgKipXb24ndCB3b3JrISoqIE9ubHkgb25lIHNjb3BlIGNhbiBiZSByZWxhdGVkIHRvIG9uZSBlbGVtZW50LiBUaGVyZWZvcmUgdGhlc2UgZGlyZWN0aXZlc1xuICogY2Fubm90IGJlIGFwcGxpZWQgdG8gdGhlIHNhbWUgZWxlbWVudC5cbiAqXG4gKlxuICogIyMjIyBgYmluZFRvQ29udHJvbGxlcmBcbiAqIFRoaXMgcHJvcGVydHkgaXMgdXNlZCB0byBiaW5kIHNjb3BlIHByb3BlcnRpZXMgZGlyZWN0bHkgdG8gdGhlIGNvbnRyb2xsZXIuIEl0IGNhbiBiZSBlaXRoZXJcbiAqIGB0cnVlYCBvciBhbiBvYmplY3QgaGFzaCB3aXRoIHRoZSBzYW1lIGZvcm1hdCBhcyB0aGUgYHNjb3BlYCBwcm9wZXJ0eS4gQWRkaXRpb25hbGx5LCBhIGNvbnRyb2xsZXJcbiAqIGFsaWFzIG11c3QgYmUgc2V0LCBlaXRoZXIgYnkgdXNpbmcgYGNvbnRyb2xsZXJBczogJ215QWxpYXMnYCBvciBieSBzcGVjaWZ5aW5nIHRoZSBhbGlhcyBpbiB0aGUgY29udHJvbGxlclxuICogZGVmaW5pdGlvbjogYGNvbnRyb2xsZXI6ICdteUN0cmwgYXMgbXlBbGlhcydgLlxuICpcbiAqIFdoZW4gYW4gaXNvbGF0ZSBzY29wZSBpcyB1c2VkIGZvciBhIGRpcmVjdGl2ZSAoc2VlIGFib3ZlKSwgYGJpbmRUb0NvbnRyb2xsZXI6IHRydWVgIHdpbGxcbiAqIGFsbG93IGEgY29tcG9uZW50IHRvIGhhdmUgaXRzIHByb3BlcnRpZXMgYm91bmQgdG8gdGhlIGNvbnRyb2xsZXIsIHJhdGhlciB0aGFuIHRvIHNjb3BlLlxuICpcbiAqIEFmdGVyIHRoZSBjb250cm9sbGVyIGlzIGluc3RhbnRpYXRlZCwgdGhlIGluaXRpYWwgdmFsdWVzIG9mIHRoZSBpc29sYXRlIHNjb3BlIGJpbmRpbmdzIHdpbGwgYmUgYm91bmQgdG8gdGhlIGNvbnRyb2xsZXJcbiAqIHByb3BlcnRpZXMuIFlvdSBjYW4gYWNjZXNzIHRoZXNlIGJpbmRpbmdzIG9uY2UgdGhleSBoYXZlIGJlZW4gaW5pdGlhbGl6ZWQgYnkgcHJvdmlkaW5nIGEgY29udHJvbGxlciBtZXRob2QgY2FsbGVkXG4gKiBgJG9uSW5pdGAsIHdoaWNoIGlzIGNhbGxlZCBhZnRlciBhbGwgdGhlIGNvbnRyb2xsZXJzIG9uIGFuIGVsZW1lbnQgaGF2ZSBiZWVuIGNvbnN0cnVjdGVkIGFuZCBoYWQgdGhlaXIgYmluZGluZ3NcbiAqIGluaXRpYWxpemVkLlxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG4gKiAqKkRlcHJlY2F0aW9uIHdhcm5pbmc6KiogYWx0aG91Z2ggYmluZGluZ3MgZm9yIG5vbi1FUzYgY2xhc3MgY29udHJvbGxlcnMgYXJlIGN1cnJlbnRseVxuICogYm91bmQgdG8gYHRoaXNgIGJlZm9yZSB0aGUgY29udHJvbGxlciBjb25zdHJ1Y3RvciBpcyBjYWxsZWQsIHRoaXMgdXNlIGlzIG5vdyBkZXByZWNhdGVkLiBQbGVhc2UgcGxhY2UgaW5pdGlhbGl6YXRpb25cbiAqIGNvZGUgdGhhdCByZWxpZXMgdXBvbiBiaW5kaW5ncyBpbnNpZGUgYSBgJG9uSW5pdGAgbWV0aG9kIG9uIHRoZSBjb250cm9sbGVyLCBpbnN0ZWFkLlxuICogPC9kaXY+XG4gKlxuICogSXQgaXMgYWxzbyBwb3NzaWJsZSB0byBzZXQgYGJpbmRUb0NvbnRyb2xsZXJgIHRvIGFuIG9iamVjdCBoYXNoIHdpdGggdGhlIHNhbWUgZm9ybWF0IGFzIHRoZSBgc2NvcGVgIHByb3BlcnR5LlxuICogVGhpcyB3aWxsIHNldCB1cCB0aGUgc2NvcGUgYmluZGluZ3MgdG8gdGhlIGNvbnRyb2xsZXIgZGlyZWN0bHkuIE5vdGUgdGhhdCBgc2NvcGVgIGNhbiBzdGlsbCBiZSB1c2VkXG4gKiB0byBkZWZpbmUgd2hpY2gga2luZCBvZiBzY29wZSBpcyBjcmVhdGVkLiBCeSBkZWZhdWx0LCBubyBzY29wZSBpcyBjcmVhdGVkLiBVc2UgYHNjb3BlOiB7fWAgdG8gY3JlYXRlIGFuIGlzb2xhdGVcbiAqIHNjb3BlICh1c2VmdWwgZm9yIGNvbXBvbmVudCBkaXJlY3RpdmVzKS5cbiAqXG4gKiBJZiBib3RoIGBiaW5kVG9Db250cm9sbGVyYCBhbmQgYHNjb3BlYCBhcmUgZGVmaW5lZCBhbmQgaGF2ZSBvYmplY3QgaGFzaGVzLCBgYmluZFRvQ29udHJvbGxlcmAgb3ZlcnJpZGVzIGBzY29wZWAuXG4gKlxuICpcbiAqICMjIyMgYGNvbnRyb2xsZXJgXG4gKiBDb250cm9sbGVyIGNvbnN0cnVjdG9yIGZ1bmN0aW9uLiBUaGUgY29udHJvbGxlciBpcyBpbnN0YW50aWF0ZWQgYmVmb3JlIHRoZVxuICogcHJlLWxpbmtpbmcgcGhhc2UgYW5kIGNhbiBiZSBhY2Nlc3NlZCBieSBvdGhlciBkaXJlY3RpdmVzIChzZWVcbiAqIGByZXF1aXJlYCBhdHRyaWJ1dGUpLiBUaGlzIGFsbG93cyB0aGUgZGlyZWN0aXZlcyB0byBjb21tdW5pY2F0ZSB3aXRoIGVhY2ggb3RoZXIgYW5kIGF1Z21lbnRcbiAqIGVhY2ggb3RoZXIncyBiZWhhdmlvci4gVGhlIGNvbnRyb2xsZXIgaXMgaW5qZWN0YWJsZSAoYW5kIHN1cHBvcnRzIGJyYWNrZXQgbm90YXRpb24pIHdpdGggdGhlIGZvbGxvd2luZyBsb2NhbHM6XG4gKlxuICogKiBgJHNjb3BlYCAtIEN1cnJlbnQgc2NvcGUgYXNzb2NpYXRlZCB3aXRoIHRoZSBlbGVtZW50XG4gKiAqIGAkZWxlbWVudGAgLSBDdXJyZW50IGVsZW1lbnRcbiAqICogYCRhdHRyc2AgLSBDdXJyZW50IGF0dHJpYnV0ZXMgb2JqZWN0IGZvciB0aGUgZWxlbWVudFxuICogKiBgJHRyYW5zY2x1ZGVgIC0gQSB0cmFuc2NsdWRlIGxpbmtpbmcgZnVuY3Rpb24gcHJlLWJvdW5kIHRvIHRoZSBjb3JyZWN0IHRyYW5zY2x1c2lvbiBzY29wZTpcbiAqICAgYGZ1bmN0aW9uKFtzY29wZV0sIGNsb25lTGlua2luZ0ZuLCBmdXR1cmVQYXJlbnRFbGVtZW50LCBzbG90TmFtZSlgOlxuICogICAgKiBgc2NvcGVgOiAob3B0aW9uYWwpIG92ZXJyaWRlIHRoZSBzY29wZS5cbiAqICAgICogYGNsb25lTGlua2luZ0ZuYDogKG9wdGlvbmFsKSBhcmd1bWVudCB0byBjcmVhdGUgY2xvbmVzIG9mIHRoZSBvcmlnaW5hbCB0cmFuc2NsdWRlZCBjb250ZW50LlxuICogICAgKiBgZnV0dXJlUGFyZW50RWxlbWVudGAgKG9wdGlvbmFsKTpcbiAqICAgICAgICAqIGRlZmluZXMgdGhlIHBhcmVudCB0byB3aGljaCB0aGUgYGNsb25lTGlua2luZ0ZuYCB3aWxsIGFkZCB0aGUgY2xvbmVkIGVsZW1lbnRzLlxuICogICAgICAgICogZGVmYXVsdDogYCRlbGVtZW50LnBhcmVudCgpYCByZXNwLiBgJGVsZW1lbnRgIGZvciBgdHJhbnNjbHVkZTonZWxlbWVudCdgIHJlc3AuIGB0cmFuc2NsdWRlOnRydWVgLlxuICogICAgICAgICogb25seSBuZWVkZWQgZm9yIHRyYW5zY2x1ZGVzIHRoYXQgYXJlIGFsbG93ZWQgdG8gY29udGFpbiBub24gaHRtbCBlbGVtZW50cyAoZS5nLiBTVkcgZWxlbWVudHMpXG4gKiAgICAgICAgICBhbmQgd2hlbiB0aGUgYGNsb25lTGlua2luRm5gIGlzIHBhc3NlZCxcbiAqICAgICAgICAgIGFzIHRob3NlIGVsZW1lbnRzIG5lZWQgdG8gY3JlYXRlZCBhbmQgY2xvbmVkIGluIGEgc3BlY2lhbCB3YXkgd2hlbiB0aGV5IGFyZSBkZWZpbmVkIG91dHNpZGUgdGhlaXJcbiAqICAgICAgICAgIHVzdWFsIGNvbnRhaW5lcnMgKGUuZy4gbGlrZSBgPHN2Zz5gKS5cbiAqICAgICAgICAqIFNlZSBhbHNvIHRoZSBgZGlyZWN0aXZlLnRlbXBsYXRlTmFtZXNwYWNlYCBwcm9wZXJ0eS5cbiAqICAgICogYHNsb3ROYW1lYDogKG9wdGlvbmFsKSB0aGUgbmFtZSBvZiB0aGUgc2xvdCB0byB0cmFuc2NsdWRlLiBJZiBmYWxzeSAoZS5nLiBgbnVsbGAsIGB1bmRlZmluZWRgIG9yIGAnJ2ApXG4gKiAgICAgIHRoZW4gdGhlIGRlZmF1bHQgdHJhbnNsdXNpb24gaXMgcHJvdmlkZWQuXG4gKiAgICBUaGUgYCR0cmFuc2NsdWRlYCBmdW5jdGlvbiBhbHNvIGhhcyBhIG1ldGhvZCBvbiBpdCwgYCR0cmFuc2NsdWRlLmlzU2xvdEZpbGxlZChzbG90TmFtZSlgLCB3aGljaCByZXR1cm5zXG4gKiAgICBgdHJ1ZWAgaWYgdGhlIHNwZWNpZmllZCBzbG90IGNvbnRhaW5zIGNvbnRlbnQgKGkuZS4gb25lIG9yIG1vcmUgRE9NIG5vZGVzKS5cbiAqXG4gKiBUaGUgY29udHJvbGxlciBjYW4gcHJvdmlkZSB0aGUgZm9sbG93aW5nIG1ldGhvZHMgdGhhdCBhY3QgYXMgbGlmZS1jeWNsZSBob29rczpcbiAqICogYCRvbkluaXRgIC0gQ2FsbGVkIG9uIGVhY2ggY29udHJvbGxlciBhZnRlciBhbGwgdGhlIGNvbnRyb2xsZXJzIG9uIGFuIGVsZW1lbnQgaGF2ZSBiZWVuIGNvbnN0cnVjdGVkIGFuZFxuICogICBoYWQgdGhlaXIgYmluZGluZ3MgaW5pdGlhbGl6ZWQgKGFuZCBiZWZvcmUgdGhlIHByZSAmYW1wOyBwb3N0IGxpbmtpbmcgZnVuY3Rpb25zIGZvciB0aGUgZGlyZWN0aXZlcyBvblxuICogICB0aGlzIGVsZW1lbnQpLiBUaGlzIGlzIGEgZ29vZCBwbGFjZSB0byBwdXQgaW5pdGlhbGl6YXRpb24gY29kZSBmb3IgeW91ciBjb250cm9sbGVyLlxuICpcbiAqICMjIyMgYHJlcXVpcmVgXG4gKiBSZXF1aXJlIGFub3RoZXIgZGlyZWN0aXZlIGFuZCBpbmplY3QgaXRzIGNvbnRyb2xsZXIgYXMgdGhlIGZvdXJ0aCBhcmd1bWVudCB0byB0aGUgbGlua2luZyBmdW5jdGlvbi4gVGhlXG4gKiBgcmVxdWlyZWAgcHJvcGVydHkgY2FuIGJlIGEgc3RyaW5nLCBhbiBhcnJheSBvciBhbiBvYmplY3Q6XG4gKiAqIGEgKipzdHJpbmcqKiBjb250YWluaW5nIHRoZSBuYW1lIG9mIHRoZSBkaXJlY3RpdmUgdG8gcGFzcyB0byB0aGUgbGlua2luZyBmdW5jdGlvblxuICogKiBhbiAqKmFycmF5KiogY29udGFpbmluZyB0aGUgbmFtZXMgb2YgZGlyZWN0aXZlcyB0byBwYXNzIHRvIHRoZSBsaW5raW5nIGZ1bmN0aW9uLiBUaGUgYXJndW1lbnQgcGFzc2VkIHRvIHRoZVxuICogbGlua2luZyBmdW5jdGlvbiB3aWxsIGJlIGFuIGFycmF5IG9mIGNvbnRyb2xsZXJzIGluIHRoZSBzYW1lIG9yZGVyIGFzIHRoZSBuYW1lcyBpbiB0aGUgYHJlcXVpcmVgIHByb3BlcnR5XG4gKiAqIGFuICoqb2JqZWN0Kiogd2hvc2UgcHJvcGVydHkgdmFsdWVzIGFyZSB0aGUgbmFtZXMgb2YgdGhlIGRpcmVjdGl2ZXMgdG8gcGFzcyB0byB0aGUgbGlua2luZyBmdW5jdGlvbi4gVGhlIGFyZ3VtZW50XG4gKiBwYXNzZWQgdG8gdGhlIGxpbmtpbmcgZnVuY3Rpb24gd2lsbCBhbHNvIGJlIGFuIG9iamVjdCB3aXRoIG1hdGNoaW5nIGtleXMsIHdob3NlIHZhbHVlcyB3aWxsIGhvbGQgdGhlIGNvcnJlc3BvbmRpbmdcbiAqIGNvbnRyb2xsZXJzLlxuICpcbiAqIElmIHRoZSBgcmVxdWlyZWAgcHJvcGVydHkgaXMgYW4gb2JqZWN0IGFuZCBgYmluZFRvQ29udHJvbGxlcmAgaXMgdHJ1dGh5LCB0aGVuIHRoZSByZXF1aXJlZCBjb250cm9sbGVycyBhcmVcbiAqIGJvdW5kIHRvIHRoZSBjb250cm9sbGVyIHVzaW5nIHRoZSBrZXlzIG9mIHRoZSBgcmVxdWlyZWAgcHJvcGVydHkuIFRoaXMgYmluZGluZyBvY2N1cnMgYWZ0ZXIgYWxsIHRoZSBjb250cm9sbGVyc1xuICogaGF2ZSBiZWVuIGNvbnN0cnVjdGVkIGJ1dCBiZWZvcmUgYCRvbkluaXRgIGlzIGNhbGxlZC5cbiAqIFNlZSB0aGUge0BsaW5rICRjb21waWxlUHJvdmlkZXIjY29tcG9uZW50fSBoZWxwZXIgZm9yIGFuIGV4YW1wbGUgb2YgaG93IHRoaXMgY2FuIGJlIHVzZWQuXG4gKlxuICogSWYgbm8gc3VjaCByZXF1aXJlZCBkaXJlY3RpdmUocykgY2FuIGJlIGZvdW5kLCBvciBpZiB0aGUgZGlyZWN0aXZlIGRvZXMgbm90IGhhdmUgYSBjb250cm9sbGVyLCB0aGVuIGFuIGVycm9yIGlzXG4gKiByYWlzZWQgKHVubGVzcyBubyBsaW5rIGZ1bmN0aW9uIGlzIHNwZWNpZmllZCBhbmQgdGhlIHJlcXVpcmVkIGNvbnRyb2xsZXJzIGFyZSBub3QgYmVpbmcgYm91bmQgdG8gdGhlIGRpcmVjdGl2ZVxuICogY29udHJvbGxlciwgaW4gd2hpY2ggY2FzZSBlcnJvciBjaGVja2luZyBpcyBza2lwcGVkKS4gVGhlIG5hbWUgY2FuIGJlIHByZWZpeGVkIHdpdGg6XG4gKlxuICogKiAobm8gcHJlZml4KSAtIExvY2F0ZSB0aGUgcmVxdWlyZWQgY29udHJvbGxlciBvbiB0aGUgY3VycmVudCBlbGVtZW50LiBUaHJvdyBhbiBlcnJvciBpZiBub3QgZm91bmQuXG4gKiAqIGA/YCAtIEF0dGVtcHQgdG8gbG9jYXRlIHRoZSByZXF1aXJlZCBjb250cm9sbGVyIG9yIHBhc3MgYG51bGxgIHRvIHRoZSBgbGlua2AgZm4gaWYgbm90IGZvdW5kLlxuICogKiBgXmAgLSBMb2NhdGUgdGhlIHJlcXVpcmVkIGNvbnRyb2xsZXIgYnkgc2VhcmNoaW5nIHRoZSBlbGVtZW50IGFuZCBpdHMgcGFyZW50cy4gVGhyb3cgYW4gZXJyb3IgaWYgbm90IGZvdW5kLlxuICogKiBgXl5gIC0gTG9jYXRlIHRoZSByZXF1aXJlZCBjb250cm9sbGVyIGJ5IHNlYXJjaGluZyB0aGUgZWxlbWVudCdzIHBhcmVudHMuIFRocm93IGFuIGVycm9yIGlmIG5vdCBmb3VuZC5cbiAqICogYD9eYCAtIEF0dGVtcHQgdG8gbG9jYXRlIHRoZSByZXF1aXJlZCBjb250cm9sbGVyIGJ5IHNlYXJjaGluZyB0aGUgZWxlbWVudCBhbmQgaXRzIHBhcmVudHMgb3IgcGFzc1xuICogICBgbnVsbGAgdG8gdGhlIGBsaW5rYCBmbiBpZiBub3QgZm91bmQuXG4gKiAqIGA/Xl5gIC0gQXR0ZW1wdCB0byBsb2NhdGUgdGhlIHJlcXVpcmVkIGNvbnRyb2xsZXIgYnkgc2VhcmNoaW5nIHRoZSBlbGVtZW50J3MgcGFyZW50cywgb3IgcGFzc1xuICogICBgbnVsbGAgdG8gdGhlIGBsaW5rYCBmbiBpZiBub3QgZm91bmQuXG4gKlxuICpcbiAqICMjIyMgYGNvbnRyb2xsZXJBc2BcbiAqIElkZW50aWZpZXIgbmFtZSBmb3IgYSByZWZlcmVuY2UgdG8gdGhlIGNvbnRyb2xsZXIgaW4gdGhlIGRpcmVjdGl2ZSdzIHNjb3BlLlxuICogVGhpcyBhbGxvd3MgdGhlIGNvbnRyb2xsZXIgdG8gYmUgcmVmZXJlbmNlZCBmcm9tIHRoZSBkaXJlY3RpdmUgdGVtcGxhdGUuIFRoaXMgaXMgZXNwZWNpYWxseVxuICogdXNlZnVsIHdoZW4gYSBkaXJlY3RpdmUgaXMgdXNlZCBhcyBjb21wb25lbnQsIGkuZS4gd2l0aCBhbiBgaXNvbGF0ZWAgc2NvcGUuIEl0J3MgYWxzbyBwb3NzaWJsZVxuICogdG8gdXNlIGl0IGluIGEgZGlyZWN0aXZlIHdpdGhvdXQgYW4gYGlzb2xhdGVgIC8gYG5ld2Agc2NvcGUsIGJ1dCB5b3UgbmVlZCB0byBiZSBhd2FyZSB0aGF0IHRoZVxuICogYGNvbnRyb2xsZXJBc2AgcmVmZXJlbmNlIG1pZ2h0IG92ZXJ3cml0ZSBhIHByb3BlcnR5IHRoYXQgYWxyZWFkeSBleGlzdHMgb24gdGhlIHBhcmVudCBzY29wZS5cbiAqXG4gKlxuICogIyMjIyBgcmVzdHJpY3RgXG4gKiBTdHJpbmcgb2Ygc3Vic2V0IG9mIGBFQUNNYCB3aGljaCByZXN0cmljdHMgdGhlIGRpcmVjdGl2ZSB0byBhIHNwZWNpZmljIGRpcmVjdGl2ZVxuICogZGVjbGFyYXRpb24gc3R5bGUuIElmIG9taXR0ZWQsIHRoZSBkZWZhdWx0cyAoZWxlbWVudHMgYW5kIGF0dHJpYnV0ZXMpIGFyZSB1c2VkLlxuICpcbiAqICogYEVgIC0gRWxlbWVudCBuYW1lIChkZWZhdWx0KTogYDxteS1kaXJlY3RpdmU+PC9teS1kaXJlY3RpdmU+YFxuICogKiBgQWAgLSBBdHRyaWJ1dGUgKGRlZmF1bHQpOiBgPGRpdiBteS1kaXJlY3RpdmU9XCJleHBcIj48L2Rpdj5gXG4gKiAqIGBDYCAtIENsYXNzOiBgPGRpdiBjbGFzcz1cIm15LWRpcmVjdGl2ZTogZXhwO1wiPjwvZGl2PmBcbiAqICogYE1gIC0gQ29tbWVudDogYDwhLS0gZGlyZWN0aXZlOiBteS1kaXJlY3RpdmUgZXhwIC0tPmBcbiAqXG4gKlxuICogIyMjIyBgdGVtcGxhdGVOYW1lc3BhY2VgXG4gKiBTdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBkb2N1bWVudCB0eXBlIHVzZWQgYnkgdGhlIG1hcmt1cCBpbiB0aGUgdGVtcGxhdGUuXG4gKiBBbmd1bGFySlMgbmVlZHMgdGhpcyBpbmZvcm1hdGlvbiBhcyB0aG9zZSBlbGVtZW50cyBuZWVkIHRvIGJlIGNyZWF0ZWQgYW5kIGNsb25lZFxuICogaW4gYSBzcGVjaWFsIHdheSB3aGVuIHRoZXkgYXJlIGRlZmluZWQgb3V0c2lkZSB0aGVpciB1c3VhbCBjb250YWluZXJzIGxpa2UgYDxzdmc+YCBhbmQgYDxtYXRoPmAuXG4gKlxuICogKiBgaHRtbGAgLSBBbGwgcm9vdCBub2RlcyBpbiB0aGUgdGVtcGxhdGUgYXJlIEhUTUwuIFJvb3Qgbm9kZXMgbWF5IGFsc28gYmVcbiAqICAgdG9wLWxldmVsIGVsZW1lbnRzIHN1Y2ggYXMgYDxzdmc+YCBvciBgPG1hdGg+YC5cbiAqICogYHN2Z2AgLSBUaGUgcm9vdCBub2RlcyBpbiB0aGUgdGVtcGxhdGUgYXJlIFNWRyBlbGVtZW50cyAoZXhjbHVkaW5nIGA8bWF0aD5gKS5cbiAqICogYG1hdGhgIC0gVGhlIHJvb3Qgbm9kZXMgaW4gdGhlIHRlbXBsYXRlIGFyZSBNYXRoTUwgZWxlbWVudHMgKGV4Y2x1ZGluZyBgPHN2Zz5gKS5cbiAqXG4gKiBJZiBubyBgdGVtcGxhdGVOYW1lc3BhY2VgIGlzIHNwZWNpZmllZCwgdGhlbiB0aGUgbmFtZXNwYWNlIGlzIGNvbnNpZGVyZWQgdG8gYmUgYGh0bWxgLlxuICpcbiAqICMjIyMgYHRlbXBsYXRlYFxuICogSFRNTCBtYXJrdXAgdGhhdCBtYXk6XG4gKiAqIFJlcGxhY2UgdGhlIGNvbnRlbnRzIG9mIHRoZSBkaXJlY3RpdmUncyBlbGVtZW50IChkZWZhdWx0KS5cbiAqICogUmVwbGFjZSB0aGUgZGlyZWN0aXZlJ3MgZWxlbWVudCBpdHNlbGYgKGlmIGByZXBsYWNlYCBpcyB0cnVlIC0gREVQUkVDQVRFRCkuXG4gKiAqIFdyYXAgdGhlIGNvbnRlbnRzIG9mIHRoZSBkaXJlY3RpdmUncyBlbGVtZW50IChpZiBgdHJhbnNjbHVkZWAgaXMgdHJ1ZSkuXG4gKlxuICogVmFsdWUgbWF5IGJlOlxuICpcbiAqICogQSBzdHJpbmcuIEZvciBleGFtcGxlIGA8ZGl2IHJlZC1vbi1ob3Zlcj57e2RlbGV0ZV9zdHJ9fTwvZGl2PmAuXG4gKiAqIEEgZnVuY3Rpb24gd2hpY2ggdGFrZXMgdHdvIGFyZ3VtZW50cyBgdEVsZW1lbnRgIGFuZCBgdEF0dHJzYCAoZGVzY3JpYmVkIGluIHRoZSBgY29tcGlsZWBcbiAqICAgZnVuY3Rpb24gYXBpIGJlbG93KSBhbmQgcmV0dXJucyBhIHN0cmluZyB2YWx1ZS5cbiAqXG4gKlxuICogIyMjIyBgdGVtcGxhdGVVcmxgXG4gKiBUaGlzIGlzIHNpbWlsYXIgdG8gYHRlbXBsYXRlYCBidXQgdGhlIHRlbXBsYXRlIGlzIGxvYWRlZCBmcm9tIHRoZSBzcGVjaWZpZWQgVVJMLCBhc3luY2hyb25vdXNseS5cbiAqXG4gKiBCZWNhdXNlIHRlbXBsYXRlIGxvYWRpbmcgaXMgYXN5bmNocm9ub3VzIHRoZSBjb21waWxlciB3aWxsIHN1c3BlbmQgY29tcGlsYXRpb24gb2YgZGlyZWN0aXZlcyBvbiB0aGF0IGVsZW1lbnRcbiAqIGZvciBsYXRlciB3aGVuIHRoZSB0ZW1wbGF0ZSBoYXMgYmVlbiByZXNvbHZlZC4gIEluIHRoZSBtZWFudGltZSBpdCB3aWxsIGNvbnRpbnVlIHRvIGNvbXBpbGUgYW5kIGxpbmtcbiAqIHNpYmxpbmcgYW5kIHBhcmVudCBlbGVtZW50cyBhcyB0aG91Z2ggdGhpcyBlbGVtZW50IGhhZCBub3QgY29udGFpbmVkIGFueSBkaXJlY3RpdmVzLlxuICpcbiAqIFRoZSBjb21waWxlciBkb2VzIG5vdCBzdXNwZW5kIHRoZSBlbnRpcmUgY29tcGlsYXRpb24gdG8gd2FpdCBmb3IgdGVtcGxhdGVzIHRvIGJlIGxvYWRlZCBiZWNhdXNlIHRoaXNcbiAqIHdvdWxkIHJlc3VsdCBpbiB0aGUgd2hvbGUgYXBwIFwic3RhbGxpbmdcIiB1bnRpbCBhbGwgdGVtcGxhdGVzIGFyZSBsb2FkZWQgYXN5bmNocm9ub3VzbHkgLSBldmVuIGluIHRoZVxuICogY2FzZSB3aGVuIG9ubHkgb25lIGRlZXBseSBuZXN0ZWQgZGlyZWN0aXZlIGhhcyBgdGVtcGxhdGVVcmxgLlxuICpcbiAqIFRlbXBsYXRlIGxvYWRpbmcgaXMgYXN5bmNocm9ub3VzIGV2ZW4gaWYgdGhlIHRlbXBsYXRlIGhhcyBiZWVuIHByZWxvYWRlZCBpbnRvIHRoZSB7QGxpbmsgJHRlbXBsYXRlQ2FjaGV9XG4gKlxuICogWW91IGNhbiBzcGVjaWZ5IGB0ZW1wbGF0ZVVybGAgYXMgYSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBVUkwgb3IgYXMgYSBmdW5jdGlvbiB3aGljaCB0YWtlcyB0d29cbiAqIGFyZ3VtZW50cyBgdEVsZW1lbnRgIGFuZCBgdEF0dHJzYCAoZGVzY3JpYmVkIGluIHRoZSBgY29tcGlsZWAgZnVuY3Rpb24gYXBpIGJlbG93KSBhbmQgcmV0dXJuc1xuICogYSBzdHJpbmcgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSB1cmwuICBJbiBlaXRoZXIgY2FzZSwgdGhlIHRlbXBsYXRlIFVSTCBpcyBwYXNzZWQgdGhyb3VnaCB7QGxpbmtcbiAqICRzY2UjZ2V0VHJ1c3RlZFJlc291cmNlVXJsICRzY2UuZ2V0VHJ1c3RlZFJlc291cmNlVXJsfS5cbiAqXG4gKlxuICogIyMjIyBgcmVwbGFjZWAgKFsqREVQUkVDQVRFRCohXSwgd2lsbCBiZSByZW1vdmVkIGluIG5leHQgbWFqb3IgcmVsZWFzZSAtIGkuZS4gdjIuMClcbiAqIHNwZWNpZnkgd2hhdCB0aGUgdGVtcGxhdGUgc2hvdWxkIHJlcGxhY2UuIERlZmF1bHRzIHRvIGBmYWxzZWAuXG4gKlxuICogKiBgdHJ1ZWAgLSB0aGUgdGVtcGxhdGUgd2lsbCByZXBsYWNlIHRoZSBkaXJlY3RpdmUncyBlbGVtZW50LlxuICogKiBgZmFsc2VgIC0gdGhlIHRlbXBsYXRlIHdpbGwgcmVwbGFjZSB0aGUgY29udGVudHMgb2YgdGhlIGRpcmVjdGl2ZSdzIGVsZW1lbnQuXG4gKlxuICogVGhlIHJlcGxhY2VtZW50IHByb2Nlc3MgbWlncmF0ZXMgYWxsIG9mIHRoZSBhdHRyaWJ1dGVzIC8gY2xhc3NlcyBmcm9tIHRoZSBvbGQgZWxlbWVudCB0byB0aGUgbmV3XG4gKiBvbmUuIFNlZSB0aGUge0BsaW5rIGd1aWRlL2RpcmVjdGl2ZSN0ZW1wbGF0ZS1leHBhbmRpbmctZGlyZWN0aXZlXG4gKiBEaXJlY3RpdmVzIEd1aWRlfSBmb3IgYW4gZXhhbXBsZS5cbiAqXG4gKiBUaGVyZSBhcmUgdmVyeSBmZXcgc2NlbmFyaW9zIHdoZXJlIGVsZW1lbnQgcmVwbGFjZW1lbnQgaXMgcmVxdWlyZWQgZm9yIHRoZSBhcHBsaWNhdGlvbiBmdW5jdGlvbixcbiAqIHRoZSBtYWluIG9uZSBiZWluZyByZXVzYWJsZSBjdXN0b20gY29tcG9uZW50cyB0aGF0IGFyZSB1c2VkIHdpdGhpbiBTVkcgY29udGV4dHNcbiAqIChiZWNhdXNlIFNWRyBkb2Vzbid0IHdvcmsgd2l0aCBjdXN0b20gZWxlbWVudHMgaW4gdGhlIERPTSB0cmVlKS5cbiAqXG4gKiAjIyMjIGB0cmFuc2NsdWRlYFxuICogRXh0cmFjdCB0aGUgY29udGVudHMgb2YgdGhlIGVsZW1lbnQgd2hlcmUgdGhlIGRpcmVjdGl2ZSBhcHBlYXJzIGFuZCBtYWtlIGl0IGF2YWlsYWJsZSB0byB0aGUgZGlyZWN0aXZlLlxuICogVGhlIGNvbnRlbnRzIGFyZSBjb21waWxlZCBhbmQgcHJvdmlkZWQgdG8gdGhlIGRpcmVjdGl2ZSBhcyBhICoqdHJhbnNjbHVzaW9uIGZ1bmN0aW9uKiouIFNlZSB0aGVcbiAqIHtAbGluayAkY29tcGlsZSN0cmFuc2NsdXNpb24gVHJhbnNjbHVzaW9ufSBzZWN0aW9uIGJlbG93LlxuICpcbiAqXG4gKiAjIyMjIGBjb21waWxlYFxuICpcbiAqIGBgYGpzXG4gKiAgIGZ1bmN0aW9uIGNvbXBpbGUodEVsZW1lbnQsIHRBdHRycywgdHJhbnNjbHVkZSkgeyAuLi4gfVxuICogYGBgXG4gKlxuICogVGhlIGNvbXBpbGUgZnVuY3Rpb24gZGVhbHMgd2l0aCB0cmFuc2Zvcm1pbmcgdGhlIHRlbXBsYXRlIERPTS4gU2luY2UgbW9zdCBkaXJlY3RpdmVzIGRvIG5vdCBkb1xuICogdGVtcGxhdGUgdHJhbnNmb3JtYXRpb24sIGl0IGlzIG5vdCB1c2VkIG9mdGVuLiBUaGUgY29tcGlsZSBmdW5jdGlvbiB0YWtlcyB0aGUgZm9sbG93aW5nIGFyZ3VtZW50czpcbiAqXG4gKiAgICogYHRFbGVtZW50YCAtIHRlbXBsYXRlIGVsZW1lbnQgLSBUaGUgZWxlbWVudCB3aGVyZSB0aGUgZGlyZWN0aXZlIGhhcyBiZWVuIGRlY2xhcmVkLiBJdCBpc1xuICogICAgIHNhZmUgdG8gZG8gdGVtcGxhdGUgdHJhbnNmb3JtYXRpb24gb24gdGhlIGVsZW1lbnQgYW5kIGNoaWxkIGVsZW1lbnRzIG9ubHkuXG4gKlxuICogICAqIGB0QXR0cnNgIC0gdGVtcGxhdGUgYXR0cmlidXRlcyAtIE5vcm1hbGl6ZWQgbGlzdCBvZiBhdHRyaWJ1dGVzIGRlY2xhcmVkIG9uIHRoaXMgZWxlbWVudCBzaGFyZWRcbiAqICAgICBiZXR3ZWVuIGFsbCBkaXJlY3RpdmUgY29tcGlsZSBmdW5jdGlvbnMuXG4gKlxuICogICAqIGB0cmFuc2NsdWRlYCAtICBbKkRFUFJFQ0FURUQqIV0gQSB0cmFuc2NsdWRlIGxpbmtpbmcgZnVuY3Rpb246IGBmdW5jdGlvbihzY29wZSwgY2xvbmVMaW5raW5nRm4pYFxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG4gKiAqKk5vdGU6KiogVGhlIHRlbXBsYXRlIGluc3RhbmNlIGFuZCB0aGUgbGluayBpbnN0YW5jZSBtYXkgYmUgZGlmZmVyZW50IG9iamVjdHMgaWYgdGhlIHRlbXBsYXRlIGhhc1xuICogYmVlbiBjbG9uZWQuIEZvciB0aGlzIHJlYXNvbiBpdCBpcyAqKm5vdCoqIHNhZmUgdG8gZG8gYW55dGhpbmcgb3RoZXIgdGhhbiBET00gdHJhbnNmb3JtYXRpb25zIHRoYXRcbiAqIGFwcGx5IHRvIGFsbCBjbG9uZWQgRE9NIG5vZGVzIHdpdGhpbiB0aGUgY29tcGlsZSBmdW5jdGlvbi4gU3BlY2lmaWNhbGx5LCBET00gbGlzdGVuZXIgcmVnaXN0cmF0aW9uXG4gKiBzaG91bGQgYmUgZG9uZSBpbiBhIGxpbmtpbmcgZnVuY3Rpb24gcmF0aGVyIHRoYW4gaW4gYSBjb21waWxlIGZ1bmN0aW9uLlxuICogPC9kaXY+XG5cbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG4gKiAqKk5vdGU6KiogVGhlIGNvbXBpbGUgZnVuY3Rpb24gY2Fubm90IGhhbmRsZSBkaXJlY3RpdmVzIHRoYXQgcmVjdXJzaXZlbHkgdXNlIHRoZW1zZWx2ZXMgaW4gdGhlaXJcbiAqIG93biB0ZW1wbGF0ZXMgb3IgY29tcGlsZSBmdW5jdGlvbnMuIENvbXBpbGluZyB0aGVzZSBkaXJlY3RpdmVzIHJlc3VsdHMgaW4gYW4gaW5maW5pdGUgbG9vcCBhbmRcbiAqIHN0YWNrIG92ZXJmbG93IGVycm9ycy5cbiAqXG4gKiBUaGlzIGNhbiBiZSBhdm9pZGVkIGJ5IG1hbnVhbGx5IHVzaW5nICRjb21waWxlIGluIHRoZSBwb3N0TGluayBmdW5jdGlvbiB0byBpbXBlcmF0aXZlbHkgY29tcGlsZVxuICogYSBkaXJlY3RpdmUncyB0ZW1wbGF0ZSBpbnN0ZWFkIG9mIHJlbHlpbmcgb24gYXV0b21hdGljIHRlbXBsYXRlIGNvbXBpbGF0aW9uIHZpYSBgdGVtcGxhdGVgIG9yXG4gKiBgdGVtcGxhdGVVcmxgIGRlY2xhcmF0aW9uIG9yIG1hbnVhbCBjb21waWxhdGlvbiBpbnNpZGUgdGhlIGNvbXBpbGUgZnVuY3Rpb24uXG4gKiA8L2Rpdj5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtZGFuZ2VyXCI+XG4gKiAqKk5vdGU6KiogVGhlIGB0cmFuc2NsdWRlYCBmdW5jdGlvbiB0aGF0IGlzIHBhc3NlZCB0byB0aGUgY29tcGlsZSBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLCBhcyBpdFxuICogICBlLmcuIGRvZXMgbm90IGtub3cgYWJvdXQgdGhlIHJpZ2h0IG91dGVyIHNjb3BlLiBQbGVhc2UgdXNlIHRoZSB0cmFuc2NsdWRlIGZ1bmN0aW9uIHRoYXQgaXMgcGFzc2VkXG4gKiAgIHRvIHRoZSBsaW5rIGZ1bmN0aW9uIGluc3RlYWQuXG4gKiA8L2Rpdj5cblxuICogQSBjb21waWxlIGZ1bmN0aW9uIGNhbiBoYXZlIGEgcmV0dXJuIHZhbHVlIHdoaWNoIGNhbiBiZSBlaXRoZXIgYSBmdW5jdGlvbiBvciBhbiBvYmplY3QuXG4gKlxuICogKiByZXR1cm5pbmcgYSAocG9zdC1saW5rKSBmdW5jdGlvbiAtIGlzIGVxdWl2YWxlbnQgdG8gcmVnaXN0ZXJpbmcgdGhlIGxpbmtpbmcgZnVuY3Rpb24gdmlhIHRoZVxuICogICBgbGlua2AgcHJvcGVydHkgb2YgdGhlIGNvbmZpZyBvYmplY3Qgd2hlbiB0aGUgY29tcGlsZSBmdW5jdGlvbiBpcyBlbXB0eS5cbiAqXG4gKiAqIHJldHVybmluZyBhbiBvYmplY3Qgd2l0aCBmdW5jdGlvbihzKSByZWdpc3RlcmVkIHZpYSBgcHJlYCBhbmQgYHBvc3RgIHByb3BlcnRpZXMgLSBhbGxvd3MgeW91IHRvXG4gKiAgIGNvbnRyb2wgd2hlbiBhIGxpbmtpbmcgZnVuY3Rpb24gc2hvdWxkIGJlIGNhbGxlZCBkdXJpbmcgdGhlIGxpbmtpbmcgcGhhc2UuIFNlZSBpbmZvIGFib3V0XG4gKiAgIHByZS1saW5raW5nIGFuZCBwb3N0LWxpbmtpbmcgZnVuY3Rpb25zIGJlbG93LlxuICpcbiAqXG4gKiAjIyMjIGBsaW5rYFxuICogVGhpcyBwcm9wZXJ0eSBpcyB1c2VkIG9ubHkgaWYgdGhlIGBjb21waWxlYCBwcm9wZXJ0eSBpcyBub3QgZGVmaW5lZC5cbiAqXG4gKiBgYGBqc1xuICogICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBpRWxlbWVudCwgaUF0dHJzLCBjb250cm9sbGVyLCB0cmFuc2NsdWRlRm4pIHsgLi4uIH1cbiAqIGBgYFxuICpcbiAqIFRoZSBsaW5rIGZ1bmN0aW9uIGlzIHJlc3BvbnNpYmxlIGZvciByZWdpc3RlcmluZyBET00gbGlzdGVuZXJzIGFzIHdlbGwgYXMgdXBkYXRpbmcgdGhlIERPTS4gSXQgaXNcbiAqIGV4ZWN1dGVkIGFmdGVyIHRoZSB0ZW1wbGF0ZSBoYXMgYmVlbiBjbG9uZWQuIFRoaXMgaXMgd2hlcmUgbW9zdCBvZiB0aGUgZGlyZWN0aXZlIGxvZ2ljIHdpbGwgYmVcbiAqIHB1dC5cbiAqXG4gKiAgICogYHNjb3BlYCAtIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIFNjb3BlfSAtIFRoZSBzY29wZSB0byBiZSB1c2VkIGJ5IHRoZVxuICogICAgIGRpcmVjdGl2ZSBmb3IgcmVnaXN0ZXJpbmcge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJHdhdGNoIHdhdGNoZXN9LlxuICpcbiAqICAgKiBgaUVsZW1lbnRgIC0gaW5zdGFuY2UgZWxlbWVudCAtIFRoZSBlbGVtZW50IHdoZXJlIHRoZSBkaXJlY3RpdmUgaXMgdG8gYmUgdXNlZC4gSXQgaXMgc2FmZSB0b1xuICogICAgIG1hbmlwdWxhdGUgdGhlIGNoaWxkcmVuIG9mIHRoZSBlbGVtZW50IG9ubHkgaW4gYHBvc3RMaW5rYCBmdW5jdGlvbiBzaW5jZSB0aGUgY2hpbGRyZW4gaGF2ZVxuICogICAgIGFscmVhZHkgYmVlbiBsaW5rZWQuXG4gKlxuICogICAqIGBpQXR0cnNgIC0gaW5zdGFuY2UgYXR0cmlidXRlcyAtIE5vcm1hbGl6ZWQgbGlzdCBvZiBhdHRyaWJ1dGVzIGRlY2xhcmVkIG9uIHRoaXMgZWxlbWVudCBzaGFyZWRcbiAqICAgICBiZXR3ZWVuIGFsbCBkaXJlY3RpdmUgbGlua2luZyBmdW5jdGlvbnMuXG4gKlxuICogICAqIGBjb250cm9sbGVyYCAtIHRoZSBkaXJlY3RpdmUncyByZXF1aXJlZCBjb250cm9sbGVyIGluc3RhbmNlKHMpIC0gSW5zdGFuY2VzIGFyZSBzaGFyZWRcbiAqICAgICBhbW9uZyBhbGwgZGlyZWN0aXZlcywgd2hpY2ggYWxsb3dzIHRoZSBkaXJlY3RpdmVzIHRvIHVzZSB0aGUgY29udHJvbGxlcnMgYXMgYSBjb21tdW5pY2F0aW9uXG4gKiAgICAgY2hhbm5lbC4gVGhlIGV4YWN0IHZhbHVlIGRlcGVuZHMgb24gdGhlIGRpcmVjdGl2ZSdzIGByZXF1aXJlYCBwcm9wZXJ0eTpcbiAqICAgICAgICogbm8gY29udHJvbGxlcihzKSByZXF1aXJlZDogdGhlIGRpcmVjdGl2ZSdzIG93biBjb250cm9sbGVyLCBvciBgdW5kZWZpbmVkYCBpZiBpdCBkb2Vzbid0IGhhdmUgb25lXG4gKiAgICAgICAqIGBzdHJpbmdgOiB0aGUgY29udHJvbGxlciBpbnN0YW5jZVxuICogICAgICAgKiBgYXJyYXlgOiBhcnJheSBvZiBjb250cm9sbGVyIGluc3RhbmNlc1xuICpcbiAqICAgICBJZiBhIHJlcXVpcmVkIGNvbnRyb2xsZXIgY2Fubm90IGJlIGZvdW5kLCBhbmQgaXQgaXMgb3B0aW9uYWwsIHRoZSBpbnN0YW5jZSBpcyBgbnVsbGAsXG4gKiAgICAgb3RoZXJ3aXNlIHRoZSB7QGxpbmsgZXJyb3I6JGNvbXBpbGU6Y3RyZXEgTWlzc2luZyBSZXF1aXJlZCBDb250cm9sbGVyfSBlcnJvciBpcyB0aHJvd24uXG4gKlxuICogICAgIE5vdGUgdGhhdCB5b3UgY2FuIGFsc28gcmVxdWlyZSB0aGUgZGlyZWN0aXZlJ3Mgb3duIGNvbnRyb2xsZXIgLSBpdCB3aWxsIGJlIG1hZGUgYXZhaWxhYmxlIGxpa2VcbiAqICAgICBhbnkgb3RoZXIgY29udHJvbGxlci5cbiAqXG4gKiAgICogYHRyYW5zY2x1ZGVGbmAgLSBBIHRyYW5zY2x1ZGUgbGlua2luZyBmdW5jdGlvbiBwcmUtYm91bmQgdG8gdGhlIGNvcnJlY3QgdHJhbnNjbHVzaW9uIHNjb3BlLlxuICogICAgIFRoaXMgaXMgdGhlIHNhbWUgYXMgdGhlIGAkdHJhbnNjbHVkZWBcbiAqICAgICBwYXJhbWV0ZXIgb2YgZGlyZWN0aXZlIGNvbnRyb2xsZXJzLCBzZWUgdGhlcmUgZm9yIGRldGFpbHMuXG4gKiAgICAgYGZ1bmN0aW9uKFtzY29wZV0sIGNsb25lTGlua2luZ0ZuLCBmdXR1cmVQYXJlbnRFbGVtZW50KWAuXG4gKlxuICogIyMjIyBQcmUtbGlua2luZyBmdW5jdGlvblxuICpcbiAqIEV4ZWN1dGVkIGJlZm9yZSB0aGUgY2hpbGQgZWxlbWVudHMgYXJlIGxpbmtlZC4gTm90IHNhZmUgdG8gZG8gRE9NIHRyYW5zZm9ybWF0aW9uIHNpbmNlIHRoZVxuICogY29tcGlsZXIgbGlua2luZyBmdW5jdGlvbiB3aWxsIGZhaWwgdG8gbG9jYXRlIHRoZSBjb3JyZWN0IGVsZW1lbnRzIGZvciBsaW5raW5nLlxuICpcbiAqICMjIyMgUG9zdC1saW5raW5nIGZ1bmN0aW9uXG4gKlxuICogRXhlY3V0ZWQgYWZ0ZXIgdGhlIGNoaWxkIGVsZW1lbnRzIGFyZSBsaW5rZWQuXG4gKlxuICogTm90ZSB0aGF0IGNoaWxkIGVsZW1lbnRzIHRoYXQgY29udGFpbiBgdGVtcGxhdGVVcmxgIGRpcmVjdGl2ZXMgd2lsbCBub3QgaGF2ZSBiZWVuIGNvbXBpbGVkXG4gKiBhbmQgbGlua2VkIHNpbmNlIHRoZXkgYXJlIHdhaXRpbmcgZm9yIHRoZWlyIHRlbXBsYXRlIHRvIGxvYWQgYXN5bmNocm9ub3VzbHkgYW5kIHRoZWlyIG93blxuICogY29tcGlsYXRpb24gYW5kIGxpbmtpbmcgaGFzIGJlZW4gc3VzcGVuZGVkIHVudGlsIHRoYXQgb2NjdXJzLlxuICpcbiAqIEl0IGlzIHNhZmUgdG8gZG8gRE9NIHRyYW5zZm9ybWF0aW9uIGluIHRoZSBwb3N0LWxpbmtpbmcgZnVuY3Rpb24gb24gZWxlbWVudHMgdGhhdCBhcmUgbm90IHdhaXRpbmdcbiAqIGZvciB0aGVpciBhc3luYyB0ZW1wbGF0ZXMgdG8gYmUgcmVzb2x2ZWQuXG4gKlxuICpcbiAqICMjIyBUcmFuc2NsdXNpb25cbiAqXG4gKiBUcmFuc2NsdXNpb24gaXMgdGhlIHByb2Nlc3Mgb2YgZXh0cmFjdGluZyBhIGNvbGxlY3Rpb24gb2YgRE9NIGVsZW1lbnRzIGZyb20gb25lIHBhcnQgb2YgdGhlIERPTSBhbmRcbiAqIGNvcHlpbmcgdGhlbSB0byBhbm90aGVyIHBhcnQgb2YgdGhlIERPTSwgd2hpbGUgbWFpbnRhaW5pbmcgdGhlaXIgY29ubmVjdGlvbiB0byB0aGUgb3JpZ2luYWwgQW5ndWxhckpTXG4gKiBzY29wZSBmcm9tIHdoZXJlIHRoZXkgd2VyZSB0YWtlbi5cbiAqXG4gKiBUcmFuc2NsdXNpb24gaXMgdXNlZCAob2Z0ZW4gd2l0aCB7QGxpbmsgbmdUcmFuc2NsdWRlfSkgdG8gaW5zZXJ0IHRoZVxuICogb3JpZ2luYWwgY29udGVudHMgb2YgYSBkaXJlY3RpdmUncyBlbGVtZW50IGludG8gYSBzcGVjaWZpZWQgcGxhY2UgaW4gdGhlIHRlbXBsYXRlIG9mIHRoZSBkaXJlY3RpdmUuXG4gKiBUaGUgYmVuZWZpdCBvZiB0cmFuc2NsdXNpb24sIG92ZXIgc2ltcGx5IG1vdmluZyB0aGUgRE9NIGVsZW1lbnRzIG1hbnVhbGx5LCBpcyB0aGF0IHRoZSB0cmFuc2NsdWRlZFxuICogY29udGVudCBoYXMgYWNjZXNzIHRvIHRoZSBwcm9wZXJ0aWVzIG9uIHRoZSBzY29wZSBmcm9tIHdoaWNoIGl0IHdhcyB0YWtlbiwgZXZlbiBpZiB0aGUgZGlyZWN0aXZlXG4gKiBoYXMgaXNvbGF0ZWQgc2NvcGUuXG4gKiBTZWUgdGhlIHtAbGluayBndWlkZS9kaXJlY3RpdmUjY3JlYXRpbmctYS1kaXJlY3RpdmUtdGhhdC13cmFwcy1vdGhlci1lbGVtZW50cyBEaXJlY3RpdmVzIEd1aWRlfS5cbiAqXG4gKiBUaGlzIG1ha2VzIGl0IHBvc3NpYmxlIGZvciB0aGUgd2lkZ2V0IHRvIGhhdmUgcHJpdmF0ZSBzdGF0ZSBmb3IgaXRzIHRlbXBsYXRlLCB3aGlsZSB0aGUgdHJhbnNjbHVkZWRcbiAqIGNvbnRlbnQgaGFzIGFjY2VzcyB0byBpdHMgb3JpZ2luYXRpbmcgc2NvcGUuXG4gKlxuICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cbiAqICoqTm90ZToqKiBXaGVuIHRlc3RpbmcgYW4gZWxlbWVudCB0cmFuc2NsdWRlIGRpcmVjdGl2ZSB5b3UgbXVzdCBub3QgcGxhY2UgdGhlIGRpcmVjdGl2ZSBhdCB0aGUgcm9vdCBvZiB0aGVcbiAqIERPTSBmcmFnbWVudCB0aGF0IGlzIGJlaW5nIGNvbXBpbGVkLiBTZWUge0BsaW5rIGd1aWRlL3VuaXQtdGVzdGluZyN0ZXN0aW5nLXRyYW5zY2x1c2lvbi1kaXJlY3RpdmVzXG4gKiBUZXN0aW5nIFRyYW5zY2x1c2lvbiBEaXJlY3RpdmVzfS5cbiAqIDwvZGl2PlxuICpcbiAqIFRoZXJlIGFyZSB0aHJlZSBraW5kcyBvZiB0cmFuc2NsdXNpb24gZGVwZW5kaW5nIHVwb24gd2hldGhlciB5b3Ugd2FudCB0byB0cmFuc2NsdWRlIGp1c3QgdGhlIGNvbnRlbnRzIG9mIHRoZVxuICogZGlyZWN0aXZlJ3MgZWxlbWVudCwgdGhlIGVudGlyZSBlbGVtZW50IG9yIG11bHRpcGxlIHBhcnRzIG9mIHRoZSBlbGVtZW50IGNvbnRlbnRzOlxuICpcbiAqICogYHRydWVgIC0gdHJhbnNjbHVkZSB0aGUgY29udGVudCAoaS5lLiB0aGUgY2hpbGQgbm9kZXMpIG9mIHRoZSBkaXJlY3RpdmUncyBlbGVtZW50LlxuICogKiBgJ2VsZW1lbnQnYCAtIHRyYW5zY2x1ZGUgdGhlIHdob2xlIG9mIHRoZSBkaXJlY3RpdmUncyBlbGVtZW50IGluY2x1ZGluZyBhbnkgZGlyZWN0aXZlcyBvbiB0aGlzXG4gKiAgIGVsZW1lbnQgdGhhdCBkZWZpbmVkIGF0IGEgbG93ZXIgcHJpb3JpdHkgdGhhbiB0aGlzIGRpcmVjdGl2ZS4gV2hlbiB1c2VkLCB0aGUgYHRlbXBsYXRlYFxuICogICBwcm9wZXJ0eSBpcyBpZ25vcmVkLlxuICogKiAqKmB7Li4ufWAgKGFuIG9iamVjdCBoYXNoKToqKiAtIG1hcCBlbGVtZW50cyBvZiB0aGUgY29udGVudCBvbnRvIHRyYW5zY2x1c2lvbiBcInNsb3RzXCIgaW4gdGhlIHRlbXBsYXRlLlxuICpcbiAqICoqTXVsdC1zbG90IHRyYW5zY2x1c2lvbioqIGlzIGRlY2xhcmVkIGJ5IHByb3ZpZGluZyBhbiBvYmplY3QgZm9yIHRoZSBgdHJhbnNjbHVkZWAgcHJvcGVydHkuXG4gKlxuICogVGhpcyBvYmplY3QgaXMgYSBtYXAgd2hlcmUgdGhlIGtleXMgYXJlIHRoZSBuYW1lIG9mIHRoZSBzbG90IHRvIGZpbGwgYW5kIHRoZSB2YWx1ZSBpcyBhbiBlbGVtZW50IHNlbGVjdG9yXG4gKiB1c2VkIHRvIG1hdGNoIHRoZSBIVE1MIHRvIHRoZSBzbG90LiBUaGUgZWxlbWVudCBzZWxlY3RvciBzaG91bGQgYmUgaW4gbm9ybWFsaXplZCBmb3JtIChlLmcuIGBteUVsZW1lbnRgKVxuICogYW5kIHdpbGwgbWF0Y2ggdGhlIHN0YW5kYXJkIGVsZW1lbnQgdmFyaWFudHMgKGUuZy4gYG15LWVsZW1lbnRgLCBgbXk6ZWxlbWVudGAsIGBkYXRhLW15LWVsZW1lbnRgLCBldGMpLlxuICpcbiAqIEZvciBmdXJ0aGVyIGluZm9ybWF0aW9uIGNoZWNrIG91dCB0aGUgZ3VpZGUgb24ge0BsaW5rIGd1aWRlL2RpcmVjdGl2ZSNtYXRjaGluZy1kaXJlY3RpdmVzIE1hdGNoaW5nIERpcmVjdGl2ZXN9XG4gKlxuICogSWYgdGhlIGVsZW1lbnQgc2VsZWN0b3IgaXMgcHJlZml4ZWQgd2l0aCBhIGA/YCB0aGVuIHRoYXQgc2xvdCBpcyBvcHRpb25hbC5cbiAqXG4gKiBGb3IgZXhhbXBsZSwgdGhlIHRyYW5zY2x1ZGUgb2JqZWN0IGB7IHNsb3RBOiAnP215Q3VzdG9tRWxlbWVudCcgfWAgbWFwcyBgPG15LWN1c3RvbS1lbGVtZW50PmAgZWxlbWVudHMgdG9cbiAqIHRoZSBgc2xvdEFgIHNsb3QsIHdoaWNoIGNhbiBiZSBhY2Nlc3NlZCB2aWEgdGhlIGAkdHJhbnNjbHVkZWAgZnVuY3Rpb24gb3IgdmlhIHRoZSB7QGxpbmsgbmdUcmFuc2NsdWRlfSBkaXJlY3RpdmUuXG4gKlxuICogU2xvdHMgdGhhdCBhcmUgbm90IG1hcmtlZCBhcyBvcHRpb25hbCAoYD9gKSB3aWxsIHRyaWdnZXIgYSBjb21waWxlIHRpbWUgZXJyb3IgaWYgdGhlcmUgYXJlIG5vIG1hdGNoaW5nIGVsZW1lbnRzXG4gKiBpbiB0aGUgdHJhbnNjbHVkZSBjb250ZW50LiBJZiB5b3Ugd2lzaCB0byBrbm93IGlmIGFuIG9wdGlvbmFsIHNsb3Qgd2FzIGZpbGxlZCB3aXRoIGNvbnRlbnQsIHRoZW4geW91IGNhbiBjYWxsXG4gKiBgJHRyYW5zY2x1ZGUuaXNTbG90RmlsbGVkKHNsb3ROYW1lKWAgb24gdGhlIHRyYW5zY2x1ZGUgZnVuY3Rpb24gcGFzc2VkIHRvIHRoZSBkaXJlY3RpdmUncyBsaW5rIGZ1bmN0aW9uIGFuZFxuICogaW5qZWN0YWJsZSBpbnRvIHRoZSBkaXJlY3RpdmUncyBjb250cm9sbGVyLlxuICpcbiAqXG4gKiAjIyMjIFRyYW5zY2x1c2lvbiBGdW5jdGlvbnNcbiAqXG4gKiBXaGVuIGEgZGlyZWN0aXZlIHJlcXVlc3RzIHRyYW5zY2x1c2lvbiwgdGhlIGNvbXBpbGVyIGV4dHJhY3RzIGl0cyBjb250ZW50cyBhbmQgcHJvdmlkZXMgYSAqKnRyYW5zY2x1c2lvblxuICogZnVuY3Rpb24qKiB0byB0aGUgZGlyZWN0aXZlJ3MgYGxpbmtgIGZ1bmN0aW9uIGFuZCBgY29udHJvbGxlcmAuIFRoaXMgdHJhbnNjbHVzaW9uIGZ1bmN0aW9uIGlzIGEgc3BlY2lhbFxuICogKipsaW5raW5nIGZ1bmN0aW9uKiogdGhhdCB3aWxsIHJldHVybiB0aGUgY29tcGlsZWQgY29udGVudHMgbGlua2VkIHRvIGEgbmV3IHRyYW5zY2x1c2lvbiBzY29wZS5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtaW5mb1wiPlxuICogSWYgeW91IGFyZSBqdXN0IHVzaW5nIHtAbGluayBuZ1RyYW5zY2x1ZGV9IHRoZW4geW91IGRvbid0IG5lZWQgdG8gd29ycnkgYWJvdXQgdGhpcyBmdW5jdGlvbiwgc2luY2VcbiAqIG5nVHJhbnNjbHVkZSB3aWxsIGRlYWwgd2l0aCBpdCBmb3IgdXMuXG4gKiA8L2Rpdj5cbiAqXG4gKiBJZiB5b3Ugd2FudCB0byBtYW51YWxseSBjb250cm9sIHRoZSBpbnNlcnRpb24gYW5kIHJlbW92YWwgb2YgdGhlIHRyYW5zY2x1ZGVkIGNvbnRlbnQgaW4geW91ciBkaXJlY3RpdmVcbiAqIHRoZW4geW91IG11c3QgdXNlIHRoaXMgdHJhbnNjbHVkZSBmdW5jdGlvbi4gV2hlbiB5b3UgY2FsbCBhIHRyYW5zY2x1ZGUgZnVuY3Rpb24gaXQgcmV0dXJucyBhIGEganFMaXRlL0pRdWVyeVxuICogb2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIGNvbXBpbGVkIERPTSwgd2hpY2ggaXMgbGlua2VkIHRvIHRoZSBjb3JyZWN0IHRyYW5zY2x1c2lvbiBzY29wZS5cbiAqXG4gKiBXaGVuIHlvdSBjYWxsIGEgdHJhbnNjbHVzaW9uIGZ1bmN0aW9uIHlvdSBjYW4gcGFzcyBpbiBhICoqY2xvbmUgYXR0YWNoIGZ1bmN0aW9uKiouIFRoaXMgZnVuY3Rpb24gYWNjZXB0c1xuICogdHdvIHBhcmFtZXRlcnMsIGBmdW5jdGlvbihjbG9uZSwgc2NvcGUpIHsgLi4uIH1gLCB3aGVyZSB0aGUgYGNsb25lYCBpcyBhIGZyZXNoIGNvbXBpbGVkIGNvcHkgb2YgeW91ciB0cmFuc2NsdWRlZFxuICogY29udGVudCBhbmQgdGhlIGBzY29wZWAgaXMgdGhlIG5ld2x5IGNyZWF0ZWQgdHJhbnNjbHVzaW9uIHNjb3BlLCB0byB3aGljaCB0aGUgY2xvbmUgaXMgYm91bmQuXG4gKlxuICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWluZm9cIj5cbiAqICoqQmVzdCBQcmFjdGljZSoqOiBBbHdheXMgcHJvdmlkZSBhIGBjbG9uZUZuYCAoY2xvbmUgYXR0YWNoIGZ1bmN0aW9uKSB3aGVuIHlvdSBjYWxsIGEgdHJhbnNjbHVkZSBmdW5jdGlvblxuICogc2luY2UgeW91IHRoZW4gZ2V0IGEgZnJlc2ggY2xvbmUgb2YgdGhlIG9yaWdpbmFsIERPTSBhbmQgYWxzbyBoYXZlIGFjY2VzcyB0byB0aGUgbmV3IHRyYW5zY2x1c2lvbiBzY29wZS5cbiAqIDwvZGl2PlxuICpcbiAqIEl0IGlzIG5vcm1hbCBwcmFjdGljZSB0byBhdHRhY2ggeW91ciB0cmFuc2NsdWRlZCBjb250ZW50IChgY2xvbmVgKSB0byB0aGUgRE9NIGluc2lkZSB5b3VyICoqY2xvbmVcbiAqIGF0dGFjaCBmdW5jdGlvbioqOlxuICpcbiAqIGBgYGpzXG4gKiB2YXIgdHJhbnNjbHVkZWRDb250ZW50LCB0cmFuc2NsdXNpb25TY29wZTtcbiAqXG4gKiAkdHJhbnNjbHVkZShmdW5jdGlvbihjbG9uZSwgc2NvcGUpIHtcbiAqICAgZWxlbWVudC5hcHBlbmQoY2xvbmUpO1xuICogICB0cmFuc2NsdWRlZENvbnRlbnQgPSBjbG9uZTtcbiAqICAgdHJhbnNjbHVzaW9uU2NvcGUgPSBzY29wZTtcbiAqIH0pO1xuICogYGBgXG4gKlxuICogTGF0ZXIsIGlmIHlvdSB3YW50IHRvIHJlbW92ZSB0aGUgdHJhbnNjbHVkZWQgY29udGVudCBmcm9tIHlvdXIgRE9NIHRoZW4geW91IHNob3VsZCBhbHNvIGRlc3Ryb3kgdGhlXG4gKiBhc3NvY2lhdGVkIHRyYW5zY2x1c2lvbiBzY29wZTpcbiAqXG4gKiBgYGBqc1xuICogdHJhbnNjbHVkZWRDb250ZW50LnJlbW92ZSgpO1xuICogdHJhbnNjbHVzaW9uU2NvcGUuJGRlc3Ryb3koKTtcbiAqIGBgYFxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1pbmZvXCI+XG4gKiAqKkJlc3QgUHJhY3RpY2UqKjogaWYgeW91IGludGVuZCB0byBhZGQgYW5kIHJlbW92ZSB0cmFuc2NsdWRlZCBjb250ZW50IG1hbnVhbGx5IGluIHlvdXIgZGlyZWN0aXZlXG4gKiAoYnkgY2FsbGluZyB0aGUgdHJhbnNjbHVkZSBmdW5jdGlvbiB0byBnZXQgdGhlIERPTSBhbmQgY2FsbGluZyBgZWxlbWVudC5yZW1vdmUoKWAgdG8gcmVtb3ZlIGl0KSxcbiAqIHRoZW4geW91IGFyZSBhbHNvIHJlc3BvbnNpYmxlIGZvciBjYWxsaW5nIGAkZGVzdHJveWAgb24gdGhlIHRyYW5zY2x1c2lvbiBzY29wZS5cbiAqIDwvZGl2PlxuICpcbiAqIFRoZSBidWlsdC1pbiBET00gbWFuaXB1bGF0aW9uIGRpcmVjdGl2ZXMsIHN1Y2ggYXMge0BsaW5rIG5nSWZ9LCB7QGxpbmsgbmdTd2l0Y2h9IGFuZCB7QGxpbmsgbmdSZXBlYXR9XG4gKiBhdXRvbWF0aWNhbGx5IGRlc3Ryb3kgdGhlaXIgdHJhbnNjbHVkZWQgY2xvbmVzIGFzIG5lY2Vzc2FyeSBzbyB5b3UgZG8gbm90IG5lZWQgdG8gd29ycnkgYWJvdXQgdGhpcyBpZlxuICogeW91IGFyZSBzaW1wbHkgdXNpbmcge0BsaW5rIG5nVHJhbnNjbHVkZX0gdG8gaW5qZWN0IHRoZSB0cmFuc2NsdXNpb24gaW50byB5b3VyIGRpcmVjdGl2ZS5cbiAqXG4gKlxuICogIyMjIyBUcmFuc2NsdXNpb24gU2NvcGVzXG4gKlxuICogV2hlbiB5b3UgY2FsbCBhIHRyYW5zY2x1ZGUgZnVuY3Rpb24gaXQgcmV0dXJucyBhIERPTSBmcmFnbWVudCB0aGF0IGlzIHByZS1ib3VuZCB0byBhICoqdHJhbnNjbHVzaW9uXG4gKiBzY29wZSoqLiBUaGlzIHNjb3BlIGlzIHNwZWNpYWwsIGluIHRoYXQgaXQgaXMgYSBjaGlsZCBvZiB0aGUgZGlyZWN0aXZlJ3Mgc2NvcGUgKGFuZCBzbyBnZXRzIGRlc3Ryb3llZFxuICogd2hlbiB0aGUgZGlyZWN0aXZlJ3Mgc2NvcGUgZ2V0cyBkZXN0cm95ZWQpIGJ1dCBpdCBpbmhlcml0cyB0aGUgcHJvcGVydGllcyBvZiB0aGUgc2NvcGUgZnJvbSB3aGljaCBpdFxuICogd2FzIHRha2VuLlxuICpcbiAqIEZvciBleGFtcGxlIGNvbnNpZGVyIGEgZGlyZWN0aXZlIHRoYXQgdXNlcyB0cmFuc2NsdXNpb24gYW5kIGlzb2xhdGVkIHNjb3BlLiBUaGUgRE9NIGhpZXJhcmNoeSBtaWdodCBsb29rXG4gKiBsaWtlIHRoaXM6XG4gKlxuICogYGBgaHRtbFxuICogPGRpdiBuZy1hcHA+XG4gKiAgIDxkaXYgaXNvbGF0ZT5cbiAqICAgICA8ZGl2IHRyYW5zY2x1c2lvbj5cbiAqICAgICA8L2Rpdj5cbiAqICAgPC9kaXY+XG4gKiA8L2Rpdj5cbiAqIGBgYFxuICpcbiAqIFRoZSBgJHBhcmVudGAgc2NvcGUgaGllcmFyY2h5IHdpbGwgbG9vayBsaWtlIHRoaXM6XG4gKlxuICAgYGBgXG4gICAtICRyb290U2NvcGVcbiAgICAgLSBpc29sYXRlXG4gICAgICAgLSB0cmFuc2NsdXNpb25cbiAgIGBgYFxuICpcbiAqIGJ1dCB0aGUgc2NvcGVzIHdpbGwgaW5oZXJpdCBwcm90b3R5cGljYWxseSBmcm9tIGRpZmZlcmVudCBzY29wZXMgdG8gdGhlaXIgYCRwYXJlbnRgLlxuICpcbiAgIGBgYFxuICAgLSAkcm9vdFNjb3BlXG4gICAgIC0gdHJhbnNjbHVzaW9uXG4gICAtIGlzb2xhdGVcbiAgIGBgYFxuICpcbiAqXG4gKiAjIyMgQXR0cmlidXRlc1xuICpcbiAqIFRoZSB7QGxpbmsgbmcuJGNvbXBpbGUuZGlyZWN0aXZlLkF0dHJpYnV0ZXMgQXR0cmlidXRlc30gb2JqZWN0IC0gcGFzc2VkIGFzIGEgcGFyYW1ldGVyIGluIHRoZVxuICogYGxpbmsoKWAgb3IgYGNvbXBpbGUoKWAgZnVuY3Rpb25zLiBJdCBoYXMgYSB2YXJpZXR5IG9mIHVzZXMuXG4gKlxuICogKiAqQWNjZXNzaW5nIG5vcm1hbGl6ZWQgYXR0cmlidXRlIG5hbWVzOiogRGlyZWN0aXZlcyBsaWtlICduZ0JpbmQnIGNhbiBiZSBleHByZXNzZWQgaW4gbWFueSB3YXlzOlxuICogICAnbmc6YmluZCcsIGBkYXRhLW5nLWJpbmRgLCBvciAneC1uZy1iaW5kJy4gVGhlIGF0dHJpYnV0ZXMgb2JqZWN0IGFsbG93cyBmb3Igbm9ybWFsaXplZCBhY2Nlc3NcbiAqICAgdG8gdGhlIGF0dHJpYnV0ZXMuXG4gKlxuICogKiAqRGlyZWN0aXZlIGludGVyLWNvbW11bmljYXRpb246KiBBbGwgZGlyZWN0aXZlcyBzaGFyZSB0aGUgc2FtZSBpbnN0YW5jZSBvZiB0aGUgYXR0cmlidXRlc1xuICogICBvYmplY3Qgd2hpY2ggYWxsb3dzIHRoZSBkaXJlY3RpdmVzIHRvIHVzZSB0aGUgYXR0cmlidXRlcyBvYmplY3QgYXMgaW50ZXIgZGlyZWN0aXZlXG4gKiAgIGNvbW11bmljYXRpb24uXG4gKlxuICogKiAqU3VwcG9ydHMgaW50ZXJwb2xhdGlvbjoqIEludGVycG9sYXRpb24gYXR0cmlidXRlcyBhcmUgYXNzaWduZWQgdG8gdGhlIGF0dHJpYnV0ZSBvYmplY3RcbiAqICAgYWxsb3dpbmcgb3RoZXIgZGlyZWN0aXZlcyB0byByZWFkIHRoZSBpbnRlcnBvbGF0ZWQgdmFsdWUuXG4gKlxuICogKiAqT2JzZXJ2aW5nIGludGVycG9sYXRlZCBhdHRyaWJ1dGVzOiogVXNlIGAkb2JzZXJ2ZWAgdG8gb2JzZXJ2ZSB0aGUgdmFsdWUgY2hhbmdlcyBvZiBhdHRyaWJ1dGVzXG4gKiAgIHRoYXQgY29udGFpbiBpbnRlcnBvbGF0aW9uIChlLmcuIGBzcmM9XCJ7e2Jhcn19XCJgKS4gTm90IG9ubHkgaXMgdGhpcyB2ZXJ5IGVmZmljaWVudCBidXQgaXQncyBhbHNvXG4gKiAgIHRoZSBvbmx5IHdheSB0byBlYXNpbHkgZ2V0IHRoZSBhY3R1YWwgdmFsdWUgYmVjYXVzZSBkdXJpbmcgdGhlIGxpbmtpbmcgcGhhc2UgdGhlIGludGVycG9sYXRpb25cbiAqICAgaGFzbid0IGJlZW4gZXZhbHVhdGVkIHlldCBhbmQgc28gdGhlIHZhbHVlIGlzIGF0IHRoaXMgdGltZSBzZXQgdG8gYHVuZGVmaW5lZGAuXG4gKlxuICogYGBganNcbiAqIGZ1bmN0aW9uIGxpbmtpbmdGbihzY29wZSwgZWxtLCBhdHRycywgY3RybCkge1xuICogICAvLyBnZXQgdGhlIGF0dHJpYnV0ZSB2YWx1ZVxuICogICBjb25zb2xlLmxvZyhhdHRycy5uZ01vZGVsKTtcbiAqXG4gKiAgIC8vIGNoYW5nZSB0aGUgYXR0cmlidXRlXG4gKiAgIGF0dHJzLiRzZXQoJ25nTW9kZWwnLCAnbmV3IHZhbHVlJyk7XG4gKlxuICogICAvLyBvYnNlcnZlIGNoYW5nZXMgdG8gaW50ZXJwb2xhdGVkIGF0dHJpYnV0ZVxuICogICBhdHRycy4kb2JzZXJ2ZSgnbmdNb2RlbCcsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gKiAgICAgY29uc29sZS5sb2coJ25nTW9kZWwgaGFzIGNoYW5nZWQgdmFsdWUgdG8gJyArIHZhbHVlKTtcbiAqICAgfSk7XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiAjIyBFeGFtcGxlXG4gKlxuICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cbiAqICoqTm90ZSoqOiBUeXBpY2FsbHkgZGlyZWN0aXZlcyBhcmUgcmVnaXN0ZXJlZCB3aXRoIGBtb2R1bGUuZGlyZWN0aXZlYC4gVGhlIGV4YW1wbGUgYmVsb3cgaXNcbiAqIHRvIGlsbHVzdHJhdGUgaG93IGAkY29tcGlsZWAgd29ya3MuXG4gKiA8L2Rpdj5cbiAqXG4gPGV4YW1wbGUgbW9kdWxlPVwiY29tcGlsZUV4YW1wbGVcIj5cbiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgPHNjcmlwdD5cbiAgICAgIGFuZ3VsYXIubW9kdWxlKCdjb21waWxlRXhhbXBsZScsIFtdLCBmdW5jdGlvbigkY29tcGlsZVByb3ZpZGVyKSB7XG4gICAgICAgIC8vIGNvbmZpZ3VyZSBuZXcgJ2NvbXBpbGUnIGRpcmVjdGl2ZSBieSBwYXNzaW5nIGEgZGlyZWN0aXZlXG4gICAgICAgIC8vIGZhY3RvcnkgZnVuY3Rpb24uIFRoZSBmYWN0b3J5IGZ1bmN0aW9uIGluamVjdHMgdGhlICckY29tcGlsZSdcbiAgICAgICAgJGNvbXBpbGVQcm92aWRlci5kaXJlY3RpdmUoJ2NvbXBpbGUnLCBmdW5jdGlvbigkY29tcGlsZSkge1xuICAgICAgICAgIC8vIGRpcmVjdGl2ZSBmYWN0b3J5IGNyZWF0ZXMgYSBsaW5rIGZ1bmN0aW9uXG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgc2NvcGUuJHdhdGNoKFxuICAgICAgICAgICAgICBmdW5jdGlvbihzY29wZSkge1xuICAgICAgICAgICAgICAgICAvLyB3YXRjaCB0aGUgJ2NvbXBpbGUnIGV4cHJlc3Npb24gZm9yIGNoYW5nZXNcbiAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUuJGV2YWwoYXR0cnMuY29tcGlsZSk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgJ2NvbXBpbGUnIGV4cHJlc3Npb24gY2hhbmdlc1xuICAgICAgICAgICAgICAgIC8vIGFzc2lnbiBpdCBpbnRvIHRoZSBjdXJyZW50IERPTVxuICAgICAgICAgICAgICAgIGVsZW1lbnQuaHRtbCh2YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBjb21waWxlIHRoZSBuZXcgRE9NIGFuZCBsaW5rIGl0IHRvIHRoZSBjdXJyZW50XG4gICAgICAgICAgICAgICAgLy8gc2NvcGUuXG4gICAgICAgICAgICAgICAgLy8gTk9URTogd2Ugb25seSBjb21waWxlIC5jaGlsZE5vZGVzIHNvIHRoYXRcbiAgICAgICAgICAgICAgICAvLyB3ZSBkb24ndCBnZXQgaW50byBpbmZpbml0ZSBsb29wIGNvbXBpbGluZyBvdXJzZWx2ZXNcbiAgICAgICAgICAgICAgICAkY29tcGlsZShlbGVtZW50LmNvbnRlbnRzKCkpKHNjb3BlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgICAuY29udHJvbGxlcignR3JlZXRlckNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAkc2NvcGUubmFtZSA9ICdBbmd1bGFyJztcbiAgICAgICAgJHNjb3BlLmh0bWwgPSAnSGVsbG8ge3tuYW1lfX0nO1xuICAgICAgfV0pO1xuICAgIDwvc2NyaXB0PlxuICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkdyZWV0ZXJDb250cm9sbGVyXCI+XG4gICAgICA8aW5wdXQgbmctbW9kZWw9XCJuYW1lXCI+IDxici8+XG4gICAgICA8dGV4dGFyZWEgbmctbW9kZWw9XCJodG1sXCI+PC90ZXh0YXJlYT4gPGJyLz5cbiAgICAgIDxkaXYgY29tcGlsZT1cImh0bWxcIj48L2Rpdj5cbiAgICA8L2Rpdj5cbiAgIDwvZmlsZT5cbiAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgaXQoJ3Nob3VsZCBhdXRvIGNvbXBpbGUnLCBmdW5jdGlvbigpIHtcbiAgICAgICB2YXIgdGV4dGFyZWEgPSAkKCd0ZXh0YXJlYScpO1xuICAgICAgIHZhciBvdXRwdXQgPSAkKCdkaXZbY29tcGlsZV0nKTtcbiAgICAgICAvLyBUaGUgaW5pdGlhbCBzdGF0ZSByZWFkcyAnSGVsbG8gQW5ndWxhcicuXG4gICAgICAgZXhwZWN0KG91dHB1dC5nZXRUZXh0KCkpLnRvQmUoJ0hlbGxvIEFuZ3VsYXInKTtcbiAgICAgICB0ZXh0YXJlYS5jbGVhcigpO1xuICAgICAgIHRleHRhcmVhLnNlbmRLZXlzKCd7e25hbWV9fSEnKTtcbiAgICAgICBleHBlY3Qob3V0cHV0LmdldFRleHQoKSkudG9CZSgnQW5ndWxhciEnKTtcbiAgICAgfSk7XG4gICA8L2ZpbGU+XG4gPC9leGFtcGxlPlxuXG4gKlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfERPTUVsZW1lbnR9IGVsZW1lbnQgRWxlbWVudCBvciBIVE1MIHN0cmluZyB0byBjb21waWxlIGludG8gYSB0ZW1wbGF0ZSBmdW5jdGlvbi5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oYW5ndWxhci5TY29wZSwgY2xvbmVBdHRhY2hGbj0pfSB0cmFuc2NsdWRlIGZ1bmN0aW9uIGF2YWlsYWJsZSB0byBkaXJlY3RpdmVzIC0gREVQUkVDQVRFRC5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtZGFuZ2VyXCI+XG4gKiAqKk5vdGU6KiogUGFzc2luZyBhIGB0cmFuc2NsdWRlYCBmdW5jdGlvbiB0byB0aGUgJGNvbXBpbGUgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZCwgYXMgaXRcbiAqICAgZS5nLiB3aWxsIG5vdCB1c2UgdGhlIHJpZ2h0IG91dGVyIHNjb3BlLiBQbGVhc2UgcGFzcyB0aGUgdHJhbnNjbHVkZSBmdW5jdGlvbiBhcyBhXG4gKiAgIGBwYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbmAgdG8gdGhlIGxpbmsgZnVuY3Rpb24gaW5zdGVhZC5cbiAqIDwvZGl2PlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSBtYXhQcmlvcml0eSBvbmx5IGFwcGx5IGRpcmVjdGl2ZXMgbG93ZXIgdGhhbiBnaXZlbiBwcmlvcml0eSAoT25seSBlZmZlY3RzIHRoZVxuICogICAgICAgICAgICAgICAgIHJvb3QgZWxlbWVudChzKSwgbm90IHRoZWlyIGNoaWxkcmVuKVxuICogQHJldHVybnMge2Z1bmN0aW9uKHNjb3BlLCBjbG9uZUF0dGFjaEZuPSwgb3B0aW9ucz0pfSBhIGxpbmsgZnVuY3Rpb24gd2hpY2ggaXMgdXNlZCB0byBiaW5kIHRlbXBsYXRlXG4gKiAoYSBET00gZWxlbWVudC90cmVlKSB0byBhIHNjb3BlLiBXaGVyZTpcbiAqXG4gKiAgKiBgc2NvcGVgIC0gQSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSBTY29wZX0gdG8gYmluZCB0by5cbiAqICAqIGBjbG9uZUF0dGFjaEZuYCAtIElmIGBjbG9uZUF0dGFjaEZuYCBpcyBwcm92aWRlZCwgdGhlbiB0aGUgbGluayBmdW5jdGlvbiB3aWxsIGNsb25lIHRoZVxuICogIGB0ZW1wbGF0ZWAgYW5kIGNhbGwgdGhlIGBjbG9uZUF0dGFjaEZuYCBmdW5jdGlvbiBhbGxvd2luZyB0aGUgY2FsbGVyIHRvIGF0dGFjaCB0aGVcbiAqICBjbG9uZWQgZWxlbWVudHMgdG8gdGhlIERPTSBkb2N1bWVudCBhdCB0aGUgYXBwcm9wcmlhdGUgcGxhY2UuIFRoZSBgY2xvbmVBdHRhY2hGbmAgaXNcbiAqICBjYWxsZWQgYXM6IDxici8+IGBjbG9uZUF0dGFjaEZuKGNsb25lZEVsZW1lbnQsIHNjb3BlKWAgd2hlcmU6XG4gKlxuICogICAgICAqIGBjbG9uZWRFbGVtZW50YCAtIGlzIGEgY2xvbmUgb2YgdGhlIG9yaWdpbmFsIGBlbGVtZW50YCBwYXNzZWQgaW50byB0aGUgY29tcGlsZXIuXG4gKiAgICAgICogYHNjb3BlYCAtIGlzIHRoZSBjdXJyZW50IHNjb3BlIHdpdGggd2hpY2ggdGhlIGxpbmtpbmcgZnVuY3Rpb24gaXMgd29ya2luZyB3aXRoLlxuICpcbiAqICAqIGBvcHRpb25zYCAtIEFuIG9wdGlvbmFsIG9iamVjdCBoYXNoIHdpdGggbGlua2luZyBvcHRpb25zLiBJZiBgb3B0aW9uc2AgaXMgcHJvdmlkZWQsIHRoZW4gdGhlIGZvbGxvd2luZ1xuICogIGtleXMgbWF5IGJlIHVzZWQgdG8gY29udHJvbCBsaW5raW5nIGJlaGF2aW9yOlxuICpcbiAqICAgICAgKiBgcGFyZW50Qm91bmRUcmFuc2NsdWRlRm5gIC0gdGhlIHRyYW5zY2x1ZGUgZnVuY3Rpb24gbWFkZSBhdmFpbGFibGUgdG9cbiAqICAgICAgICBkaXJlY3RpdmVzOyBpZiBnaXZlbiwgaXQgd2lsbCBiZSBwYXNzZWQgdGhyb3VnaCB0byB0aGUgbGluayBmdW5jdGlvbnMgb2ZcbiAqICAgICAgICBkaXJlY3RpdmVzIGZvdW5kIGluIGBlbGVtZW50YCBkdXJpbmcgY29tcGlsYXRpb24uXG4gKiAgICAgICogYHRyYW5zY2x1ZGVDb250cm9sbGVyc2AgLSBhbiBvYmplY3QgaGFzaCB3aXRoIGtleXMgdGhhdCBtYXAgY29udHJvbGxlciBuYW1lc1xuICogICAgICAgIHRvIGEgaGFzaCB3aXRoIHRoZSBrZXkgYGluc3RhbmNlYCwgd2hpY2ggbWFwcyB0byB0aGUgY29udHJvbGxlciBpbnN0YW5jZTtcbiAqICAgICAgICBpZiBnaXZlbiwgaXQgd2lsbCBtYWtlIHRoZSBjb250cm9sbGVycyBhdmFpbGFibGUgdG8gZGlyZWN0aXZlcyBvbiB0aGUgY29tcGlsZU5vZGU6XG4gKiAgICAgICAgYGBgXG4gKiAgICAgICAge1xuICogICAgICAgICAgcGFyZW50OiB7XG4gKiAgICAgICAgICAgIGluc3RhbmNlOiBwYXJlbnRDb250cm9sbGVySW5zdGFuY2VcbiAqICAgICAgICAgIH1cbiAqICAgICAgICB9XG4gKiAgICAgICAgYGBgXG4gKiAgICAgICogYGZ1dHVyZVBhcmVudEVsZW1lbnRgIC0gZGVmaW5lcyB0aGUgcGFyZW50IHRvIHdoaWNoIHRoZSBgY2xvbmVBdHRhY2hGbmAgd2lsbCBhZGRcbiAqICAgICAgICB0aGUgY2xvbmVkIGVsZW1lbnRzOyBvbmx5IG5lZWRlZCBmb3IgdHJhbnNjbHVkZXMgdGhhdCBhcmUgYWxsb3dlZCB0byBjb250YWluIG5vbiBodG1sXG4gKiAgICAgICAgZWxlbWVudHMgKGUuZy4gU1ZHIGVsZW1lbnRzKS4gU2VlIGFsc28gdGhlIGRpcmVjdGl2ZS5jb250cm9sbGVyIHByb3BlcnR5LlxuICpcbiAqIENhbGxpbmcgdGhlIGxpbmtpbmcgZnVuY3Rpb24gcmV0dXJucyB0aGUgZWxlbWVudCBvZiB0aGUgdGVtcGxhdGUuIEl0IGlzIGVpdGhlciB0aGUgb3JpZ2luYWxcbiAqIGVsZW1lbnQgcGFzc2VkIGluLCBvciB0aGUgY2xvbmUgb2YgdGhlIGVsZW1lbnQgaWYgdGhlIGBjbG9uZUF0dGFjaEZuYCBpcyBwcm92aWRlZC5cbiAqXG4gKiBBZnRlciBsaW5raW5nIHRoZSB2aWV3IGlzIG5vdCB1cGRhdGVkIHVudGlsIGFmdGVyIGEgY2FsbCB0byAkZGlnZXN0IHdoaWNoIHR5cGljYWxseSBpcyBkb25lIGJ5XG4gKiBBbmd1bGFyIGF1dG9tYXRpY2FsbHkuXG4gKlxuICogSWYgeW91IG5lZWQgYWNjZXNzIHRvIHRoZSBib3VuZCB2aWV3LCB0aGVyZSBhcmUgdHdvIHdheXMgdG8gZG8gaXQ6XG4gKlxuICogLSBJZiB5b3UgYXJlIG5vdCBhc2tpbmcgdGhlIGxpbmtpbmcgZnVuY3Rpb24gdG8gY2xvbmUgdGhlIHRlbXBsYXRlLCBjcmVhdGUgdGhlIERPTSBlbGVtZW50KHMpXG4gKiAgIGJlZm9yZSB5b3Ugc2VuZCB0aGVtIHRvIHRoZSBjb21waWxlciBhbmQga2VlcCB0aGlzIHJlZmVyZW5jZSBhcm91bmQuXG4gKiAgIGBgYGpzXG4gKiAgICAgdmFyIGVsZW1lbnQgPSAkY29tcGlsZSgnPHA+e3t0b3RhbH19PC9wPicpKHNjb3BlKTtcbiAqICAgYGBgXG4gKlxuICogLSBpZiBvbiB0aGUgb3RoZXIgaGFuZCwgeW91IG5lZWQgdGhlIGVsZW1lbnQgdG8gYmUgY2xvbmVkLCB0aGUgdmlldyByZWZlcmVuY2UgZnJvbSB0aGUgb3JpZ2luYWxcbiAqICAgZXhhbXBsZSB3b3VsZCBub3QgcG9pbnQgdG8gdGhlIGNsb25lLCBidXQgcmF0aGVyIHRvIHRoZSBvcmlnaW5hbCB0ZW1wbGF0ZSB0aGF0IHdhcyBjbG9uZWQuIEluXG4gKiAgIHRoaXMgY2FzZSwgeW91IGNhbiBhY2Nlc3MgdGhlIGNsb25lIHZpYSB0aGUgY2xvbmVBdHRhY2hGbjpcbiAqICAgYGBganNcbiAqICAgICB2YXIgdGVtcGxhdGVFbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KCc8cD57e3RvdGFsfX08L3A+JyksXG4gKiAgICAgICAgIHNjb3BlID0gLi4uLjtcbiAqXG4gKiAgICAgdmFyIGNsb25lZEVsZW1lbnQgPSAkY29tcGlsZSh0ZW1wbGF0ZUVsZW1lbnQpKHNjb3BlLCBmdW5jdGlvbihjbG9uZWRFbGVtZW50LCBzY29wZSkge1xuICogICAgICAgLy9hdHRhY2ggdGhlIGNsb25lIHRvIERPTSBkb2N1bWVudCBhdCB0aGUgcmlnaHQgcGxhY2VcbiAqICAgICB9KTtcbiAqXG4gKiAgICAgLy9ub3cgd2UgaGF2ZSByZWZlcmVuY2UgdG8gdGhlIGNsb25lZCBET00gdmlhIGBjbG9uZWRFbGVtZW50YFxuICogICBgYGBcbiAqXG4gKlxuICogRm9yIGluZm9ybWF0aW9uIG9uIGhvdyB0aGUgY29tcGlsZXIgd29ya3MsIHNlZSB0aGVcbiAqIHtAbGluayBndWlkZS9jb21waWxlciBBbmd1bGFyIEhUTUwgQ29tcGlsZXJ9IHNlY3Rpb24gb2YgdGhlIERldmVsb3BlciBHdWlkZS5cbiAqL1xuXG52YXIgJGNvbXBpbGVNaW5FcnIgPSBtaW5FcnIoJyRjb21waWxlJyk7XG5cbi8qKlxuICogQG5nZG9jIHByb3ZpZGVyXG4gKiBAbmFtZSAkY29tcGlsZVByb3ZpZGVyXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKi9cbiRDb21waWxlUHJvdmlkZXIuJGluamVjdCA9IFsnJHByb3ZpZGUnLCAnJCRzYW5pdGl6ZVVyaVByb3ZpZGVyJ107XG5mdW5jdGlvbiAkQ29tcGlsZVByb3ZpZGVyKCRwcm92aWRlLCAkJHNhbml0aXplVXJpUHJvdmlkZXIpIHtcbiAgdmFyIGhhc0RpcmVjdGl2ZXMgPSB7fSxcbiAgICAgIFN1ZmZpeCA9ICdEaXJlY3RpdmUnLFxuICAgICAgQ09NTUVOVF9ESVJFQ1RJVkVfUkVHRVhQID0gL15cXHMqZGlyZWN0aXZlXFw6XFxzKihbXFx3XFwtXSspXFxzKyguKikkLyxcbiAgICAgIENMQVNTX0RJUkVDVElWRV9SRUdFWFAgPSAvKChbXFx3XFwtXSspKD86XFw6KFteO10rKSk/Oz8pLyxcbiAgICAgIEFMTF9PUl9OT1RISU5HX0FUVFJTID0gbWFrZU1hcCgnbmdTcmMsbmdTcmNzZXQsc3JjLHNyY3NldCcpLFxuICAgICAgUkVRVUlSRV9QUkVGSVhfUkVHRVhQID0gL14oPzooXFxeXFxePyk/KFxcPyk/KFxcXlxcXj8pPyk/LztcblxuICAvLyBSZWY6IGh0dHA6Ly9kZXZlbG9wZXJzLndoYXR3Zy5vcmcvd2ViYXBwYXBpcy5odG1sI2V2ZW50LWhhbmRsZXItaWRsLWF0dHJpYnV0ZXNcbiAgLy8gVGhlIGFzc3VtcHRpb24gaXMgdGhhdCBmdXR1cmUgRE9NIGV2ZW50IGF0dHJpYnV0ZSBuYW1lcyB3aWxsIGJlZ2luIHdpdGhcbiAgLy8gJ29uJyBhbmQgYmUgY29tcG9zZWQgb2Ygb25seSBFbmdsaXNoIGxldHRlcnMuXG4gIHZhciBFVkVOVF9IQU5ETEVSX0FUVFJfUkVHRVhQID0gL14ob25bYS16XSt8Zm9ybWFjdGlvbikkLztcblxuICBmdW5jdGlvbiBwYXJzZUlzb2xhdGVCaW5kaW5ncyhzY29wZSwgZGlyZWN0aXZlTmFtZSwgaXNDb250cm9sbGVyKSB7XG4gICAgdmFyIExPQ0FMX1JFR0VYUCA9IC9eXFxzKihbQCY8XXw9KFxcKj8pKShcXD8/KVxccyooXFx3KilcXHMqJC87XG5cbiAgICB2YXIgYmluZGluZ3MgPSB7fTtcblxuICAgIGZvckVhY2goc2NvcGUsIGZ1bmN0aW9uKGRlZmluaXRpb24sIHNjb3BlTmFtZSkge1xuICAgICAgdmFyIG1hdGNoID0gZGVmaW5pdGlvbi5tYXRjaChMT0NBTF9SRUdFWFApO1xuXG4gICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgIHRocm93ICRjb21waWxlTWluRXJyKCdpc2NwJyxcbiAgICAgICAgICAgIFwiSW52YWxpZCB7M30gZm9yIGRpcmVjdGl2ZSAnezB9Jy5cIiArXG4gICAgICAgICAgICBcIiBEZWZpbml0aW9uOiB7Li4uIHsxfTogJ3syfScgLi4ufVwiLFxuICAgICAgICAgICAgZGlyZWN0aXZlTmFtZSwgc2NvcGVOYW1lLCBkZWZpbml0aW9uLFxuICAgICAgICAgICAgKGlzQ29udHJvbGxlciA/IFwiY29udHJvbGxlciBiaW5kaW5ncyBkZWZpbml0aW9uXCIgOlxuICAgICAgICAgICAgXCJpc29sYXRlIHNjb3BlIGRlZmluaXRpb25cIikpO1xuICAgICAgfVxuXG4gICAgICBiaW5kaW5nc1tzY29wZU5hbWVdID0ge1xuICAgICAgICBtb2RlOiBtYXRjaFsxXVswXSxcbiAgICAgICAgY29sbGVjdGlvbjogbWF0Y2hbMl0gPT09ICcqJyxcbiAgICAgICAgb3B0aW9uYWw6IG1hdGNoWzNdID09PSAnPycsXG4gICAgICAgIGF0dHJOYW1lOiBtYXRjaFs0XSB8fCBzY29wZU5hbWVcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICByZXR1cm4gYmluZGluZ3M7XG4gIH1cblxuICBmdW5jdGlvbiBwYXJzZURpcmVjdGl2ZUJpbmRpbmdzKGRpcmVjdGl2ZSwgZGlyZWN0aXZlTmFtZSkge1xuICAgIHZhciBiaW5kaW5ncyA9IHtcbiAgICAgIGlzb2xhdGVTY29wZTogbnVsbCxcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IG51bGxcbiAgICB9O1xuICAgIGlmIChpc09iamVjdChkaXJlY3RpdmUuc2NvcGUpKSB7XG4gICAgICBpZiAoZGlyZWN0aXZlLmJpbmRUb0NvbnRyb2xsZXIgPT09IHRydWUpIHtcbiAgICAgICAgYmluZGluZ3MuYmluZFRvQ29udHJvbGxlciA9IHBhcnNlSXNvbGF0ZUJpbmRpbmdzKGRpcmVjdGl2ZS5zY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdGl2ZU5hbWUsIHRydWUpO1xuICAgICAgICBiaW5kaW5ncy5pc29sYXRlU2NvcGUgPSB7fTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJpbmRpbmdzLmlzb2xhdGVTY29wZSA9IHBhcnNlSXNvbGF0ZUJpbmRpbmdzKGRpcmVjdGl2ZS5zY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aXZlTmFtZSwgZmFsc2UpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoaXNPYmplY3QoZGlyZWN0aXZlLmJpbmRUb0NvbnRyb2xsZXIpKSB7XG4gICAgICBiaW5kaW5ncy5iaW5kVG9Db250cm9sbGVyID1cbiAgICAgICAgICBwYXJzZUlzb2xhdGVCaW5kaW5ncyhkaXJlY3RpdmUuYmluZFRvQ29udHJvbGxlciwgZGlyZWN0aXZlTmFtZSwgdHJ1ZSk7XG4gICAgfVxuICAgIGlmIChpc09iamVjdChiaW5kaW5ncy5iaW5kVG9Db250cm9sbGVyKSkge1xuICAgICAgdmFyIGNvbnRyb2xsZXIgPSBkaXJlY3RpdmUuY29udHJvbGxlcjtcbiAgICAgIHZhciBjb250cm9sbGVyQXMgPSBkaXJlY3RpdmUuY29udHJvbGxlckFzO1xuICAgICAgaWYgKCFjb250cm9sbGVyKSB7XG4gICAgICAgIC8vIFRoZXJlIGlzIG5vIGNvbnRyb2xsZXIsIHRoZXJlIG1heSBvciBtYXkgbm90IGJlIGEgY29udHJvbGxlckFzIHByb3BlcnR5XG4gICAgICAgIHRocm93ICRjb21waWxlTWluRXJyKCdub2N0cmwnLFxuICAgICAgICAgICAgICBcIkNhbm5vdCBiaW5kIHRvIGNvbnRyb2xsZXIgd2l0aG91dCBkaXJlY3RpdmUgJ3swfSdzIGNvbnRyb2xsZXIuXCIsXG4gICAgICAgICAgICAgIGRpcmVjdGl2ZU5hbWUpO1xuICAgICAgfSBlbHNlIGlmICghaWRlbnRpZmllckZvckNvbnRyb2xsZXIoY29udHJvbGxlciwgY29udHJvbGxlckFzKSkge1xuICAgICAgICAvLyBUaGVyZSBpcyBhIGNvbnRyb2xsZXIsIGJ1dCBubyBpZGVudGlmaWVyIG9yIGNvbnRyb2xsZXJBcyBwcm9wZXJ0eVxuICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycignbm9pZGVudCcsXG4gICAgICAgICAgICAgIFwiQ2Fubm90IGJpbmQgdG8gY29udHJvbGxlciB3aXRob3V0IGlkZW50aWZpZXIgZm9yIGRpcmVjdGl2ZSAnezB9Jy5cIixcbiAgICAgICAgICAgICAgZGlyZWN0aXZlTmFtZSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBiaW5kaW5ncztcbiAgfVxuXG4gIGZ1bmN0aW9uIGFzc2VydFZhbGlkRGlyZWN0aXZlTmFtZShuYW1lKSB7XG4gICAgdmFyIGxldHRlciA9IG5hbWUuY2hhckF0KDApO1xuICAgIGlmICghbGV0dGVyIHx8IGxldHRlciAhPT0gbG93ZXJjYXNlKGxldHRlcikpIHtcbiAgICAgIHRocm93ICRjb21waWxlTWluRXJyKCdiYWRkaXInLCBcIkRpcmVjdGl2ZSBuYW1lICd7MH0nIGlzIGludmFsaWQuIFRoZSBmaXJzdCBjaGFyYWN0ZXIgbXVzdCBiZSBhIGxvd2VyY2FzZSBsZXR0ZXJcIiwgbmFtZSk7XG4gICAgfVxuICAgIGlmIChuYW1lICE9PSBuYW1lLnRyaW0oKSkge1xuICAgICAgdGhyb3cgJGNvbXBpbGVNaW5FcnIoJ2JhZGRpcicsXG4gICAgICAgICAgICBcIkRpcmVjdGl2ZSBuYW1lICd7MH0nIGlzIGludmFsaWQuIFRoZSBuYW1lIHNob3VsZCBub3QgY29udGFpbiBsZWFkaW5nIG9yIHRyYWlsaW5nIHdoaXRlc3BhY2VzXCIsXG4gICAgICAgICAgICBuYW1lKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkY29tcGlsZVByb3ZpZGVyI2RpcmVjdGl2ZVxuICAgKiBAa2luZCBmdW5jdGlvblxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogUmVnaXN0ZXIgYSBuZXcgZGlyZWN0aXZlIHdpdGggdGhlIGNvbXBpbGVyLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ3xPYmplY3R9IG5hbWUgTmFtZSBvZiB0aGUgZGlyZWN0aXZlIGluIGNhbWVsLWNhc2UgKGkuZS4gPGNvZGU+bmdCaW5kPC9jb2RlPiB3aGljaFxuICAgKiAgICB3aWxsIG1hdGNoIGFzIDxjb2RlPm5nLWJpbmQ8L2NvZGU+KSwgb3IgYW4gb2JqZWN0IG1hcCBvZiBkaXJlY3RpdmVzIHdoZXJlIHRoZSBrZXlzIGFyZSB0aGVcbiAgICogICAgbmFtZXMgYW5kIHRoZSB2YWx1ZXMgYXJlIHRoZSBmYWN0b3JpZXMuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb258QXJyYXl9IGRpcmVjdGl2ZUZhY3RvcnkgQW4gaW5qZWN0YWJsZSBkaXJlY3RpdmUgZmFjdG9yeSBmdW5jdGlvbi4gU2VlIHRoZVxuICAgKiAgICB7QGxpbmsgZ3VpZGUvZGlyZWN0aXZlIGRpcmVjdGl2ZSBndWlkZX0gYW5kIHRoZSB7QGxpbmsgJGNvbXBpbGUgY29tcGlsZSBBUEl9IGZvciBtb3JlIGluZm8uXG4gICAqIEByZXR1cm5zIHtuZy4kY29tcGlsZVByb3ZpZGVyfSBTZWxmIGZvciBjaGFpbmluZy5cbiAgICovXG4gICB0aGlzLmRpcmVjdGl2ZSA9IGZ1bmN0aW9uIHJlZ2lzdGVyRGlyZWN0aXZlKG5hbWUsIGRpcmVjdGl2ZUZhY3RvcnkpIHtcbiAgICBhc3NlcnROb3RIYXNPd25Qcm9wZXJ0eShuYW1lLCAnZGlyZWN0aXZlJyk7XG4gICAgaWYgKGlzU3RyaW5nKG5hbWUpKSB7XG4gICAgICBhc3NlcnRWYWxpZERpcmVjdGl2ZU5hbWUobmFtZSk7XG4gICAgICBhc3NlcnRBcmcoZGlyZWN0aXZlRmFjdG9yeSwgJ2RpcmVjdGl2ZUZhY3RvcnknKTtcbiAgICAgIGlmICghaGFzRGlyZWN0aXZlcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgICBoYXNEaXJlY3RpdmVzW25hbWVdID0gW107XG4gICAgICAgICRwcm92aWRlLmZhY3RvcnkobmFtZSArIFN1ZmZpeCwgWyckaW5qZWN0b3InLCAnJGV4Y2VwdGlvbkhhbmRsZXInLFxuICAgICAgICAgIGZ1bmN0aW9uKCRpbmplY3RvciwgJGV4Y2VwdGlvbkhhbmRsZXIpIHtcbiAgICAgICAgICAgIHZhciBkaXJlY3RpdmVzID0gW107XG4gICAgICAgICAgICBmb3JFYWNoKGhhc0RpcmVjdGl2ZXNbbmFtZV0sIGZ1bmN0aW9uKGRpcmVjdGl2ZUZhY3RvcnksIGluZGV4KSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpcmVjdGl2ZSA9ICRpbmplY3Rvci5pbnZva2UoZGlyZWN0aXZlRmFjdG9yeSk7XG4gICAgICAgICAgICAgICAgaWYgKGlzRnVuY3Rpb24oZGlyZWN0aXZlKSkge1xuICAgICAgICAgICAgICAgICAgZGlyZWN0aXZlID0geyBjb21waWxlOiB2YWx1ZUZuKGRpcmVjdGl2ZSkgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFkaXJlY3RpdmUuY29tcGlsZSAmJiBkaXJlY3RpdmUubGluaykge1xuICAgICAgICAgICAgICAgICAgZGlyZWN0aXZlLmNvbXBpbGUgPSB2YWx1ZUZuKGRpcmVjdGl2ZS5saW5rKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGlyZWN0aXZlLnByaW9yaXR5ID0gZGlyZWN0aXZlLnByaW9yaXR5IHx8IDA7XG4gICAgICAgICAgICAgICAgZGlyZWN0aXZlLmluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgZGlyZWN0aXZlLm5hbWUgPSBkaXJlY3RpdmUubmFtZSB8fCBuYW1lO1xuICAgICAgICAgICAgICAgIGRpcmVjdGl2ZS5yZXF1aXJlID0gZGlyZWN0aXZlLnJlcXVpcmUgfHwgKGRpcmVjdGl2ZS5jb250cm9sbGVyICYmIGRpcmVjdGl2ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICBkaXJlY3RpdmUucmVzdHJpY3QgPSBkaXJlY3RpdmUucmVzdHJpY3QgfHwgJ0VBJztcbiAgICAgICAgICAgICAgICB2YXIgYmluZGluZ3MgPSBkaXJlY3RpdmUuJCRiaW5kaW5ncyA9XG4gICAgICAgICAgICAgICAgICAgIHBhcnNlRGlyZWN0aXZlQmluZGluZ3MoZGlyZWN0aXZlLCBkaXJlY3RpdmUubmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKGlzT2JqZWN0KGJpbmRpbmdzLmlzb2xhdGVTY29wZSkpIHtcbiAgICAgICAgICAgICAgICAgIGRpcmVjdGl2ZS4kJGlzb2xhdGVCaW5kaW5ncyA9IGJpbmRpbmdzLmlzb2xhdGVTY29wZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGlyZWN0aXZlLiQkbW9kdWxlTmFtZSA9IGRpcmVjdGl2ZUZhY3RvcnkuJCRtb2R1bGVOYW1lO1xuICAgICAgICAgICAgICAgIGRpcmVjdGl2ZXMucHVzaChkaXJlY3RpdmUpO1xuICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZXM7XG4gICAgICAgICAgfV0pO1xuICAgICAgfVxuICAgICAgaGFzRGlyZWN0aXZlc1tuYW1lXS5wdXNoKGRpcmVjdGl2ZUZhY3RvcnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3JFYWNoKG5hbWUsIHJldmVyc2VQYXJhbXMocmVnaXN0ZXJEaXJlY3RpdmUpKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGNvbXBpbGVQcm92aWRlciNjb21wb25lbnRcbiAgICogQG1vZHVsZSBuZ1xuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBOYW1lIG9mIHRoZSBjb21wb25lbnQgaW4gY2FtZWxDYXNlIChpLmUuIGBteUNvbXBgIHdoaWNoIHdpbGwgbWF0Y2ggYDxteS1jb21wPmApXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIENvbXBvbmVudCBkZWZpbml0aW9uIG9iamVjdCAoYSBzaW1wbGlmaWVkXG4gICAqICAgIHtAbGluayBuZy4kY29tcGlsZSNkaXJlY3RpdmUtZGVmaW5pdGlvbi1vYmplY3QgZGlyZWN0aXZlIGRlZmluaXRpb24gb2JqZWN0fSksXG4gICAqICAgIHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzIChhbGwgb3B0aW9uYWwpOlxuICAgKlxuICAgKiAgICAtIGBjb250cm9sbGVyYCDigJMgYHsoc3RyaW5nfGZ1bmN0aW9uKCk9fWAg4oCTIGNvbnRyb2xsZXIgY29uc3RydWN0b3IgZnVuY3Rpb24gdGhhdCBzaG91bGQgYmVcbiAgICogICAgICBhc3NvY2lhdGVkIHdpdGggbmV3bHkgY3JlYXRlZCBzY29wZSBvciB0aGUgbmFtZSBvZiBhIHtAbGluayBuZy4kY29tcGlsZSMtY29udHJvbGxlci1cbiAgICogICAgICByZWdpc3RlcmVkIGNvbnRyb2xsZXJ9IGlmIHBhc3NlZCBhcyBhIHN0cmluZy4gQW4gZW1wdHkgYG5vb3BgIGZ1bmN0aW9uIGJ5IGRlZmF1bHQuXG4gICAqICAgIC0gYGNvbnRyb2xsZXJBc2Ag4oCTIGB7c3RyaW5nPX1gIOKAkyBpZGVudGlmaWVyIG5hbWUgZm9yIHRvIHJlZmVyZW5jZSB0aGUgY29udHJvbGxlciBpbiB0aGUgY29tcG9uZW50J3Mgc2NvcGUuXG4gICAqICAgICAgSWYgcHJlc2VudCwgdGhlIGNvbnRyb2xsZXIgd2lsbCBiZSBwdWJsaXNoZWQgdG8gc2NvcGUgdW5kZXIgdGhlIGBjb250cm9sbGVyQXNgIG5hbWUuXG4gICAqICAgICAgSWYgbm90IHByZXNlbnQsIHRoaXMgd2lsbCBkZWZhdWx0IHRvIGJlIGAkY3RybGAuXG4gICAqICAgIC0gYHRlbXBsYXRlYCDigJMgYHtzdHJpbmc9fGZ1bmN0aW9uKCk9fWAg4oCTIGh0bWwgdGVtcGxhdGUgYXMgYSBzdHJpbmcgb3IgYSBmdW5jdGlvbiB0aGF0XG4gICAqICAgICAgcmV0dXJucyBhbiBodG1sIHRlbXBsYXRlIGFzIGEgc3RyaW5nIHdoaWNoIHNob3VsZCBiZSB1c2VkIGFzIHRoZSBjb250ZW50cyBvZiB0aGlzIGNvbXBvbmVudC5cbiAgICogICAgICBFbXB0eSBzdHJpbmcgYnkgZGVmYXVsdC5cbiAgICpcbiAgICogICAgICBJZiBgdGVtcGxhdGVgIGlzIGEgZnVuY3Rpb24sIHRoZW4gaXQgaXMge0BsaW5rIGF1dG8uJGluamVjdG9yI2ludm9rZSBpbmplY3RlZH0gd2l0aFxuICAgKiAgICAgIHRoZSBmb2xsb3dpbmcgbG9jYWxzOlxuICAgKlxuICAgKiAgICAgIC0gYCRlbGVtZW50YCAtIEN1cnJlbnQgZWxlbWVudFxuICAgKiAgICAgIC0gYCRhdHRyc2AgLSBDdXJyZW50IGF0dHJpYnV0ZXMgb2JqZWN0IGZvciB0aGUgZWxlbWVudFxuICAgKlxuICAgKiAgICAtIGB0ZW1wbGF0ZVVybGAg4oCTIGB7c3RyaW5nPXxmdW5jdGlvbigpPX1gIOKAkyBwYXRoIG9yIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIHBhdGggdG8gYW4gaHRtbFxuICAgKiAgICAgIHRlbXBsYXRlIHRoYXQgc2hvdWxkIGJlIHVzZWQgIGFzIHRoZSBjb250ZW50cyBvZiB0aGlzIGNvbXBvbmVudC5cbiAgICpcbiAgICogICAgICBJZiBgdGVtcGxhdGVVcmxgIGlzIGEgZnVuY3Rpb24sIHRoZW4gaXQgaXMge0BsaW5rIGF1dG8uJGluamVjdG9yI2ludm9rZSBpbmplY3RlZH0gd2l0aFxuICAgKiAgICAgIHRoZSBmb2xsb3dpbmcgbG9jYWxzOlxuICAgKlxuICAgKiAgICAgIC0gYCRlbGVtZW50YCAtIEN1cnJlbnQgZWxlbWVudFxuICAgKiAgICAgIC0gYCRhdHRyc2AgLSBDdXJyZW50IGF0dHJpYnV0ZXMgb2JqZWN0IGZvciB0aGUgZWxlbWVudFxuICAgKlxuICAgKiAgICAtIGBiaW5kaW5nc2Ag4oCTIGB7b2JqZWN0PX1gIOKAkyBkZWZpbmVzIGJpbmRpbmdzIGJldHdlZW4gRE9NIGF0dHJpYnV0ZXMgYW5kIGNvbXBvbmVudCBwcm9wZXJ0aWVzLlxuICAgKiAgICAgIENvbXBvbmVudCBwcm9wZXJ0aWVzIGFyZSBhbHdheXMgYm91bmQgdG8gdGhlIGNvbXBvbmVudCBjb250cm9sbGVyIGFuZCBub3QgdG8gdGhlIHNjb3BlLlxuICAgKiAgICAgIFNlZSB7QGxpbmsgbmcuJGNvbXBpbGUjLWJpbmR0b2NvbnRyb2xsZXItIGBiaW5kVG9Db250cm9sbGVyYH0uXG4gICAqICAgIC0gYHRyYW5zY2x1ZGVgIOKAkyBge2Jvb2xlYW49fWAg4oCTIHdoZXRoZXIge0BsaW5rICRjb21waWxlI3RyYW5zY2x1c2lvbiBjb250ZW50IHRyYW5zY2x1c2lvbn0gaXMgZW5hYmxlZC5cbiAgICogICAgICBEaXNhYmxlZCBieSBkZWZhdWx0LlxuICAgKiAgICAtIGAkLi4uYCDigJMgYHtmdW5jdGlvbigpPX1gIOKAkyBhZGRpdGlvbmFsIGFubm90YXRpb25zIHRvIHByb3ZpZGUgdG8gdGhlIGRpcmVjdGl2ZSBmYWN0b3J5IGZ1bmN0aW9uLlxuICAgKlxuICAgKiBAcmV0dXJucyB7bmcuJGNvbXBpbGVQcm92aWRlcn0gdGhlIGNvbXBpbGUgcHJvdmlkZXIgaXRzZWxmLCBmb3IgY2hhaW5pbmcgb2YgZnVuY3Rpb24gY2FsbHMuXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBSZWdpc3RlciBhICoqY29tcG9uZW50IGRlZmluaXRpb24qKiB3aXRoIHRoZSBjb21waWxlci4gVGhpcyBpcyBhIHNob3J0aGFuZCBmb3IgcmVnaXN0ZXJpbmcgYSBzcGVjaWFsXG4gICAqIHR5cGUgb2YgZGlyZWN0aXZlLCB3aGljaCByZXByZXNlbnRzIGEgc2VsZi1jb250YWluZWQgVUkgY29tcG9uZW50IGluIHlvdXIgYXBwbGljYXRpb24uIFN1Y2ggY29tcG9uZW50c1xuICAgKiBhcmUgYWx3YXlzIGlzb2xhdGVkIChpLmUuIGBzY29wZToge31gKSBhbmQgYXJlIGFsd2F5cyByZXN0cmljdGVkIHRvIGVsZW1lbnRzIChpLmUuIGByZXN0cmljdDogJ0UnYCkuXG4gICAqXG4gICAqIENvbXBvbmVudCBkZWZpbml0aW9ucyBhcmUgdmVyeSBzaW1wbGUgYW5kIGRvIG5vdCByZXF1aXJlIGFzIG11Y2ggY29uZmlndXJhdGlvbiBhcyBkZWZpbmluZyBnZW5lcmFsXG4gICAqIGRpcmVjdGl2ZXMuIENvbXBvbmVudCBkZWZpbml0aW9ucyB1c3VhbGx5IGNvbnNpc3Qgb25seSBvZiBhIHRlbXBsYXRlIGFuZCBhIGNvbnRyb2xsZXIgYmFja2luZyBpdC5cbiAgICpcbiAgICogSW4gb3JkZXIgdG8gbWFrZSB0aGUgZGVmaW5pdGlvbiBlYXNpZXIsIGNvbXBvbmVudHMgZW5mb3JjZSBiZXN0IHByYWN0aWNlcyBsaWtlIHVzZSBvZiBgY29udHJvbGxlckFzYCxcbiAgICogYGJpbmRUb0NvbnRyb2xsZXJgLiBUaGV5IGFsd2F5cyBoYXZlICoqaXNvbGF0ZSBzY29wZSoqIGFuZCBhcmUgcmVzdHJpY3RlZCB0byBlbGVtZW50cy5cbiAgICpcbiAgICogSGVyZSBhcmUgYSBmZXcgZXhhbXBsZXMgb2YgaG93IHlvdSB3b3VsZCB1c3VhbGx5IGRlZmluZSBjb21wb25lbnRzOlxuICAgKlxuICAgKiBgYGBqc1xuICAgKiAgIHZhciBteU1vZCA9IGFuZ3VsYXIubW9kdWxlKC4uLik7XG4gICAqICAgbXlNb2QuY29tcG9uZW50KCdteUNvbXAnLCB7XG4gICAqICAgICB0ZW1wbGF0ZTogJzxkaXY+TXkgbmFtZSBpcyB7eyRjdHJsLm5hbWV9fTwvZGl2PicsXG4gICAqICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigpIHtcbiAgICogICAgICAgdGhpcy5uYW1lID0gJ3NoYWhhcic7XG4gICAqICAgICB9XG4gICAqICAgfSk7XG4gICAqXG4gICAqICAgbXlNb2QuY29tcG9uZW50KCdteUNvbXAnLCB7XG4gICAqICAgICB0ZW1wbGF0ZTogJzxkaXY+TXkgbmFtZSBpcyB7eyRjdHJsLm5hbWV9fTwvZGl2PicsXG4gICAqICAgICBiaW5kaW5nczoge25hbWU6ICdAJ31cbiAgICogICB9KTtcbiAgICpcbiAgICogICBteU1vZC5jb21wb25lbnQoJ215Q29tcCcsIHtcbiAgICogICAgIHRlbXBsYXRlVXJsOiAndmlld3MvbXktY29tcC5odG1sJyxcbiAgICogICAgIGNvbnRyb2xsZXI6ICdNeUN0cmwgYXMgY3RybCcsXG4gICAqICAgICBiaW5kaW5nczoge25hbWU6ICdAJ31cbiAgICogICB9KTtcbiAgICpcbiAgICogYGBgXG4gICAqIEZvciBtb3JlIGV4YW1wbGVzLCBhbmQgYW4gaW4tZGVwdGggZ3VpZGUsIHNlZSB0aGUge0BsaW5rIGd1aWRlL2NvbXBvbmVudCBjb21wb25lbnQgZ3VpZGV9LlxuICAgKlxuICAgKiA8YnIgLz5cbiAgICogU2VlIGFsc28ge0BsaW5rIG5nLiRjb21waWxlUHJvdmlkZXIjZGlyZWN0aXZlICRjb21waWxlUHJvdmlkZXIuZGlyZWN0aXZlKCl9LlxuICAgKi9cbiAgdGhpcy5jb21wb25lbnQgPSBmdW5jdGlvbiByZWdpc3RlckNvbXBvbmVudChuYW1lLCBvcHRpb25zKSB7XG4gICAgdmFyIGNvbnRyb2xsZXIgPSBvcHRpb25zLmNvbnRyb2xsZXIgfHwgZnVuY3Rpb24oKSB7fTtcblxuICAgIGZ1bmN0aW9uIGZhY3RvcnkoJGluamVjdG9yKSB7XG4gICAgICBmdW5jdGlvbiBtYWtlSW5qZWN0YWJsZShmbikge1xuICAgICAgICBpZiAoaXNGdW5jdGlvbihmbikgfHwgaXNBcnJheShmbikpIHtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odEVsZW1lbnQsIHRBdHRycykge1xuICAgICAgICAgICAgcmV0dXJuICRpbmplY3Rvci5pbnZva2UoZm4sIHRoaXMsIHskZWxlbWVudDogdEVsZW1lbnQsICRhdHRyczogdEF0dHJzfSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gZm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdmFyIHRlbXBsYXRlID0gKCFvcHRpb25zLnRlbXBsYXRlICYmICFvcHRpb25zLnRlbXBsYXRlVXJsID8gJycgOiBvcHRpb25zLnRlbXBsYXRlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRyb2xsZXI6IGNvbnRyb2xsZXIsXG4gICAgICAgIGNvbnRyb2xsZXJBczogaWRlbnRpZmllckZvckNvbnRyb2xsZXIob3B0aW9ucy5jb250cm9sbGVyKSB8fCBvcHRpb25zLmNvbnRyb2xsZXJBcyB8fCAnJGN0cmwnLFxuICAgICAgICB0ZW1wbGF0ZTogbWFrZUluamVjdGFibGUodGVtcGxhdGUpLFxuICAgICAgICB0ZW1wbGF0ZVVybDogbWFrZUluamVjdGFibGUob3B0aW9ucy50ZW1wbGF0ZVVybCksXG4gICAgICAgIHRyYW5zY2x1ZGU6IG9wdGlvbnMudHJhbnNjbHVkZSxcbiAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICBiaW5kVG9Db250cm9sbGVyOiBvcHRpb25zLmJpbmRpbmdzIHx8IHt9LFxuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICByZXF1aXJlOiBvcHRpb25zLnJlcXVpcmVcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gQ29weSBhbnkgYW5ub3RhdGlvbiBwcm9wZXJ0aWVzIChzdGFydGluZyB3aXRoICQpIG92ZXIgdG8gdGhlIGZhY3RvcnkgZnVuY3Rpb25cbiAgICAvLyBUaGVzZSBjb3VsZCBiZSB1c2VkIGJ5IGxpYnJhcmllcyBzdWNoIGFzIHRoZSBuZXcgY29tcG9uZW50IHJvdXRlclxuICAgIGZvckVhY2gob3B0aW9ucywgZnVuY3Rpb24odmFsLCBrZXkpIHtcbiAgICAgIGlmIChrZXkuY2hhckF0KDApID09PSAnJCcpIHtcbiAgICAgICAgZmFjdG9yeVtrZXldID0gdmFsO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZmFjdG9yeS4kaW5qZWN0ID0gWyckaW5qZWN0b3InXTtcblxuICAgIHJldHVybiB0aGlzLmRpcmVjdGl2ZShuYW1lLCBmYWN0b3J5KTtcbiAgfTtcblxuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRjb21waWxlUHJvdmlkZXIjYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3RcbiAgICogQGtpbmQgZnVuY3Rpb25cbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFJldHJpZXZlcyBvciBvdmVycmlkZXMgdGhlIGRlZmF1bHQgcmVndWxhciBleHByZXNzaW9uIHRoYXQgaXMgdXNlZCBmb3Igd2hpdGVsaXN0aW5nIG9mIHNhZmVcbiAgICogdXJscyBkdXJpbmcgYVtocmVmXSBzYW5pdGl6YXRpb24uXG4gICAqXG4gICAqIFRoZSBzYW5pdGl6YXRpb24gaXMgYSBzZWN1cml0eSBtZWFzdXJlIGFpbWVkIGF0IHByZXZlbnRpbmcgWFNTIGF0dGFja3MgdmlhIGh0bWwgbGlua3MuXG4gICAqXG4gICAqIEFueSB1cmwgYWJvdXQgdG8gYmUgYXNzaWduZWQgdG8gYVtocmVmXSB2aWEgZGF0YS1iaW5kaW5nIGlzIGZpcnN0IG5vcm1hbGl6ZWQgYW5kIHR1cm5lZCBpbnRvXG4gICAqIGFuIGFic29sdXRlIHVybC4gQWZ0ZXJ3YXJkcywgdGhlIHVybCBpcyBtYXRjaGVkIGFnYWluc3QgdGhlIGBhSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdGBcbiAgICogcmVndWxhciBleHByZXNzaW9uLiBJZiBhIG1hdGNoIGlzIGZvdW5kLCB0aGUgb3JpZ2luYWwgdXJsIGlzIHdyaXR0ZW4gaW50byB0aGUgZG9tLiBPdGhlcndpc2UsXG4gICAqIHRoZSBhYnNvbHV0ZSB1cmwgaXMgcHJlZml4ZWQgd2l0aCBgJ3Vuc2FmZTonYCBzdHJpbmcgYW5kIG9ubHkgdGhlbiBpcyBpdCB3cml0dGVuIGludG8gdGhlIERPTS5cbiAgICpcbiAgICogQHBhcmFtIHtSZWdFeHA9fSByZWdleHAgTmV3IHJlZ2V4cCB0byB3aGl0ZWxpc3QgdXJscyB3aXRoLlxuICAgKiBAcmV0dXJucyB7UmVnRXhwfG5nLiRjb21waWxlUHJvdmlkZXJ9IEN1cnJlbnQgUmVnRXhwIGlmIGNhbGxlZCB3aXRob3V0IHZhbHVlIG9yIHNlbGYgZm9yXG4gICAqICAgIGNoYWluaW5nIG90aGVyd2lzZS5cbiAgICovXG4gIHRoaXMuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3QgPSBmdW5jdGlvbihyZWdleHApIHtcbiAgICBpZiAoaXNEZWZpbmVkKHJlZ2V4cCkpIHtcbiAgICAgICQkc2FuaXRpemVVcmlQcm92aWRlci5hSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdChyZWdleHApO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAkJHNhbml0aXplVXJpUHJvdmlkZXIuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3QoKTtcbiAgICB9XG4gIH07XG5cblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkY29tcGlsZVByb3ZpZGVyI2ltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdFxuICAgKiBAa2luZCBmdW5jdGlvblxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogUmV0cmlldmVzIG9yIG92ZXJyaWRlcyB0aGUgZGVmYXVsdCByZWd1bGFyIGV4cHJlc3Npb24gdGhhdCBpcyB1c2VkIGZvciB3aGl0ZWxpc3Rpbmcgb2Ygc2FmZVxuICAgKiB1cmxzIGR1cmluZyBpbWdbc3JjXSBzYW5pdGl6YXRpb24uXG4gICAqXG4gICAqIFRoZSBzYW5pdGl6YXRpb24gaXMgYSBzZWN1cml0eSBtZWFzdXJlIGFpbWVkIGF0IHByZXZlbnQgWFNTIGF0dGFja3MgdmlhIGh0bWwgbGlua3MuXG4gICAqXG4gICAqIEFueSB1cmwgYWJvdXQgdG8gYmUgYXNzaWduZWQgdG8gaW1nW3NyY10gdmlhIGRhdGEtYmluZGluZyBpcyBmaXJzdCBub3JtYWxpemVkIGFuZCB0dXJuZWQgaW50b1xuICAgKiBhbiBhYnNvbHV0ZSB1cmwuIEFmdGVyd2FyZHMsIHRoZSB1cmwgaXMgbWF0Y2hlZCBhZ2FpbnN0IHRoZSBgaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0YFxuICAgKiByZWd1bGFyIGV4cHJlc3Npb24uIElmIGEgbWF0Y2ggaXMgZm91bmQsIHRoZSBvcmlnaW5hbCB1cmwgaXMgd3JpdHRlbiBpbnRvIHRoZSBkb20uIE90aGVyd2lzZSxcbiAgICogdGhlIGFic29sdXRlIHVybCBpcyBwcmVmaXhlZCB3aXRoIGAndW5zYWZlOidgIHN0cmluZyBhbmQgb25seSB0aGVuIGlzIGl0IHdyaXR0ZW4gaW50byB0aGUgRE9NLlxuICAgKlxuICAgKiBAcGFyYW0ge1JlZ0V4cD19IHJlZ2V4cCBOZXcgcmVnZXhwIHRvIHdoaXRlbGlzdCB1cmxzIHdpdGguXG4gICAqIEByZXR1cm5zIHtSZWdFeHB8bmcuJGNvbXBpbGVQcm92aWRlcn0gQ3VycmVudCBSZWdFeHAgaWYgY2FsbGVkIHdpdGhvdXQgdmFsdWUgb3Igc2VsZiBmb3JcbiAgICogICAgY2hhaW5pbmcgb3RoZXJ3aXNlLlxuICAgKi9cbiAgdGhpcy5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3QgPSBmdW5jdGlvbihyZWdleHApIHtcbiAgICBpZiAoaXNEZWZpbmVkKHJlZ2V4cCkpIHtcbiAgICAgICQkc2FuaXRpemVVcmlQcm92aWRlci5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3QocmVnZXhwKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJCRzYW5pdGl6ZVVyaVByb3ZpZGVyLmltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdCgpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAgJGNvbXBpbGVQcm92aWRlciNkZWJ1Z0luZm9FbmFibGVkXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IGVuYWJsZWQgdXBkYXRlIHRoZSBkZWJ1Z0luZm9FbmFibGVkIHN0YXRlIGlmIHByb3ZpZGVkLCBvdGhlcndpc2UganVzdCByZXR1cm4gdGhlXG4gICAqIGN1cnJlbnQgZGVidWdJbmZvRW5hYmxlZCBzdGF0ZVxuICAgKiBAcmV0dXJucyB7Kn0gY3VycmVudCB2YWx1ZSBpZiB1c2VkIGFzIGdldHRlciBvciBpdHNlbGYgKGNoYWluaW5nKSBpZiB1c2VkIGFzIHNldHRlclxuICAgKlxuICAgKiBAa2luZCBmdW5jdGlvblxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogQ2FsbCB0aGlzIG1ldGhvZCB0byBlbmFibGUvZGlzYWJsZSB2YXJpb3VzIGRlYnVnIHJ1bnRpbWUgaW5mb3JtYXRpb24gaW4gdGhlIGNvbXBpbGVyIHN1Y2ggYXMgYWRkaW5nXG4gICAqIGJpbmRpbmcgaW5mb3JtYXRpb24gYW5kIGEgcmVmZXJlbmNlIHRvIHRoZSBjdXJyZW50IHNjb3BlIG9uIHRvIERPTSBlbGVtZW50cy5cbiAgICogSWYgZW5hYmxlZCwgdGhlIGNvbXBpbGVyIHdpbGwgYWRkIHRoZSBmb2xsb3dpbmcgdG8gRE9NIGVsZW1lbnRzIHRoYXQgaGF2ZSBiZWVuIGJvdW5kIHRvIHRoZSBzY29wZVxuICAgKiAqIGBuZy1iaW5kaW5nYCBDU1MgY2xhc3NcbiAgICogKiBgJGJpbmRpbmdgIGRhdGEgcHJvcGVydHkgY29udGFpbmluZyBhbiBhcnJheSBvZiB0aGUgYmluZGluZyBleHByZXNzaW9uc1xuICAgKlxuICAgKiBZb3UgbWF5IHdhbnQgdG8gZGlzYWJsZSB0aGlzIGluIHByb2R1Y3Rpb24gZm9yIGEgc2lnbmlmaWNhbnQgcGVyZm9ybWFuY2UgYm9vc3QuIFNlZVxuICAgKiB7QGxpbmsgZ3VpZGUvcHJvZHVjdGlvbiNkaXNhYmxpbmctZGVidWctZGF0YSBEaXNhYmxpbmcgRGVidWcgRGF0YX0gZm9yIG1vcmUuXG4gICAqXG4gICAqIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWUuXG4gICAqL1xuICB2YXIgZGVidWdJbmZvRW5hYmxlZCA9IHRydWU7XG4gIHRoaXMuZGVidWdJbmZvRW5hYmxlZCA9IGZ1bmN0aW9uKGVuYWJsZWQpIHtcbiAgICBpZiAoaXNEZWZpbmVkKGVuYWJsZWQpKSB7XG4gICAgICBkZWJ1Z0luZm9FbmFibGVkID0gZW5hYmxlZDtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gZGVidWdJbmZvRW5hYmxlZDtcbiAgfTtcblxuICB0aGlzLiRnZXQgPSBbXG4gICAgICAgICAgICAnJGluamVjdG9yJywgJyRpbnRlcnBvbGF0ZScsICckZXhjZXB0aW9uSGFuZGxlcicsICckdGVtcGxhdGVSZXF1ZXN0JywgJyRwYXJzZScsXG4gICAgICAgICAgICAnJGNvbnRyb2xsZXInLCAnJHJvb3RTY29wZScsICckc2NlJywgJyRhbmltYXRlJywgJyQkc2FuaXRpemVVcmknLFxuICAgIGZ1bmN0aW9uKCRpbmplY3RvciwgICAkaW50ZXJwb2xhdGUsICAgJGV4Y2VwdGlvbkhhbmRsZXIsICAgJHRlbXBsYXRlUmVxdWVzdCwgICAkcGFyc2UsXG4gICAgICAgICAgICAgJGNvbnRyb2xsZXIsICAgJHJvb3RTY29wZSwgICAkc2NlLCAgICRhbmltYXRlLCAgICQkc2FuaXRpemVVcmkpIHtcblxuICAgIHZhciBTSU1QTEVfQVRUUl9OQU1FID0gL15cXHcvO1xuICAgIHZhciBzcGVjaWFsQXR0ckhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHZhciBBdHRyaWJ1dGVzID0gZnVuY3Rpb24oZWxlbWVudCwgYXR0cmlidXRlc1RvQ29weSkge1xuICAgICAgaWYgKGF0dHJpYnV0ZXNUb0NvcHkpIHtcbiAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzVG9Db3B5KTtcbiAgICAgICAgdmFyIGksIGwsIGtleTtcblxuICAgICAgICBmb3IgKGkgPSAwLCBsID0ga2V5cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICBrZXkgPSBrZXlzW2ldO1xuICAgICAgICAgIHRoaXNba2V5XSA9IGF0dHJpYnV0ZXNUb0NvcHlba2V5XTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy4kYXR0ciA9IHt9O1xuICAgICAgfVxuXG4gICAgICB0aGlzLiQkZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgfTtcblxuICAgIEF0dHJpYnV0ZXMucHJvdG90eXBlID0ge1xuICAgICAgLyoqXG4gICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgKiBAbmFtZSAkY29tcGlsZS5kaXJlY3RpdmUuQXR0cmlidXRlcyMkbm9ybWFsaXplXG4gICAgICAgKiBAa2luZCBmdW5jdGlvblxuICAgICAgICpcbiAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICogQ29udmVydHMgYW4gYXR0cmlidXRlIG5hbWUgKGUuZy4gZGFzaC9jb2xvbi91bmRlcnNjb3JlLWRlbGltaXRlZCBzdHJpbmcsIG9wdGlvbmFsbHkgcHJlZml4ZWQgd2l0aCBgeC1gIG9yXG4gICAgICAgKiBgZGF0YS1gKSB0byBpdHMgbm9ybWFsaXplZCwgY2FtZWxDYXNlIGZvcm0uXG4gICAgICAgKlxuICAgICAgICogQWxzbyB0aGVyZSBpcyBzcGVjaWFsIGNhc2UgZm9yIE1veiBwcmVmaXggc3RhcnRpbmcgd2l0aCB1cHBlciBjYXNlIGxldHRlci5cbiAgICAgICAqXG4gICAgICAgKiBGb3IgZnVydGhlciBpbmZvcm1hdGlvbiBjaGVjayBvdXQgdGhlIGd1aWRlIG9uIHtAbGluayBndWlkZS9kaXJlY3RpdmUjbWF0Y2hpbmctZGlyZWN0aXZlcyBNYXRjaGluZyBEaXJlY3RpdmVzfVxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIE5hbWUgdG8gbm9ybWFsaXplXG4gICAgICAgKi9cbiAgICAgICRub3JtYWxpemU6IGRpcmVjdGl2ZU5vcm1hbGl6ZSxcblxuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRjb21waWxlLmRpcmVjdGl2ZS5BdHRyaWJ1dGVzIyRhZGRDbGFzc1xuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIEFkZHMgdGhlIENTUyBjbGFzcyB2YWx1ZSBzcGVjaWZpZWQgYnkgdGhlIGNsYXNzVmFsIHBhcmFtZXRlciB0byB0aGUgZWxlbWVudC4gSWYgYW5pbWF0aW9uc1xuICAgICAgICogYXJlIGVuYWJsZWQgdGhlbiBhbiBhbmltYXRpb24gd2lsbCBiZSB0cmlnZ2VyZWQgZm9yIHRoZSBjbGFzcyBhZGRpdGlvbi5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NWYWwgVGhlIGNsYXNzTmFtZSB2YWx1ZSB0aGF0IHdpbGwgYmUgYWRkZWQgdG8gdGhlIGVsZW1lbnRcbiAgICAgICAqL1xuICAgICAgJGFkZENsYXNzOiBmdW5jdGlvbihjbGFzc1ZhbCkge1xuICAgICAgICBpZiAoY2xhc3NWYWwgJiYgY2xhc3NWYWwubGVuZ3RoID4gMCkge1xuICAgICAgICAgICRhbmltYXRlLmFkZENsYXNzKHRoaXMuJCRlbGVtZW50LCBjbGFzc1ZhbCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJGNvbXBpbGUuZGlyZWN0aXZlLkF0dHJpYnV0ZXMjJHJlbW92ZUNsYXNzXG4gICAgICAgKiBAa2luZCBmdW5jdGlvblxuICAgICAgICpcbiAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICogUmVtb3ZlcyB0aGUgQ1NTIGNsYXNzIHZhbHVlIHNwZWNpZmllZCBieSB0aGUgY2xhc3NWYWwgcGFyYW1ldGVyIGZyb20gdGhlIGVsZW1lbnQuIElmXG4gICAgICAgKiBhbmltYXRpb25zIGFyZSBlbmFibGVkIHRoZW4gYW4gYW5pbWF0aW9uIHdpbGwgYmUgdHJpZ2dlcmVkIGZvciB0aGUgY2xhc3MgcmVtb3ZhbC5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NWYWwgVGhlIGNsYXNzTmFtZSB2YWx1ZSB0aGF0IHdpbGwgYmUgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50XG4gICAgICAgKi9cbiAgICAgICRyZW1vdmVDbGFzczogZnVuY3Rpb24oY2xhc3NWYWwpIHtcbiAgICAgICAgaWYgKGNsYXNzVmFsICYmIGNsYXNzVmFsLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAkYW5pbWF0ZS5yZW1vdmVDbGFzcyh0aGlzLiQkZWxlbWVudCwgY2xhc3NWYWwpO1xuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRjb21waWxlLmRpcmVjdGl2ZS5BdHRyaWJ1dGVzIyR1cGRhdGVDbGFzc1xuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIEFkZHMgYW5kIHJlbW92ZXMgdGhlIGFwcHJvcHJpYXRlIENTUyBjbGFzcyB2YWx1ZXMgdG8gdGhlIGVsZW1lbnQgYmFzZWQgb24gdGhlIGRpZmZlcmVuY2VcbiAgICAgICAqIGJldHdlZW4gdGhlIG5ldyBhbmQgb2xkIENTUyBjbGFzcyB2YWx1ZXMgKHNwZWNpZmllZCBhcyBuZXdDbGFzc2VzIGFuZCBvbGRDbGFzc2VzKS5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmV3Q2xhc3NlcyBUaGUgY3VycmVudCBDU1MgY2xhc3NOYW1lIHZhbHVlXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30gb2xkQ2xhc3NlcyBUaGUgZm9ybWVyIENTUyBjbGFzc05hbWUgdmFsdWVcbiAgICAgICAqL1xuICAgICAgJHVwZGF0ZUNsYXNzOiBmdW5jdGlvbihuZXdDbGFzc2VzLCBvbGRDbGFzc2VzKSB7XG4gICAgICAgIHZhciB0b0FkZCA9IHRva2VuRGlmZmVyZW5jZShuZXdDbGFzc2VzLCBvbGRDbGFzc2VzKTtcbiAgICAgICAgaWYgKHRvQWRkICYmIHRvQWRkLmxlbmd0aCkge1xuICAgICAgICAgICRhbmltYXRlLmFkZENsYXNzKHRoaXMuJCRlbGVtZW50LCB0b0FkZCk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgdG9SZW1vdmUgPSB0b2tlbkRpZmZlcmVuY2Uob2xkQ2xhc3NlcywgbmV3Q2xhc3Nlcyk7XG4gICAgICAgIGlmICh0b1JlbW92ZSAmJiB0b1JlbW92ZS5sZW5ndGgpIHtcbiAgICAgICAgICAkYW5pbWF0ZS5yZW1vdmVDbGFzcyh0aGlzLiQkZWxlbWVudCwgdG9SZW1vdmUpO1xuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICAvKipcbiAgICAgICAqIFNldCBhIG5vcm1hbGl6ZWQgYXR0cmlidXRlIG9uIHRoZSBlbGVtZW50IGluIGEgd2F5IHN1Y2ggdGhhdCBhbGwgZGlyZWN0aXZlc1xuICAgICAgICogY2FuIHNoYXJlIHRoZSBhdHRyaWJ1dGUuIFRoaXMgZnVuY3Rpb24gcHJvcGVybHkgaGFuZGxlcyBib29sZWFuIGF0dHJpYnV0ZXMuXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IE5vcm1hbGl6ZWQga2V5LiAoaWUgbmdBdHRyaWJ1dGUpXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ3xib29sZWFufSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2V0LiBJZiBgbnVsbGAgYXR0cmlidXRlIHdpbGwgYmUgZGVsZXRlZC5cbiAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IHdyaXRlQXR0ciBJZiBmYWxzZSwgZG9lcyBub3Qgd3JpdGUgdGhlIHZhbHVlIHRvIERPTSBlbGVtZW50IGF0dHJpYnV0ZS5cbiAgICAgICAqICAgICBEZWZhdWx0cyB0byB0cnVlLlxuICAgICAgICogQHBhcmFtIHtzdHJpbmc9fSBhdHRyTmFtZSBPcHRpb25hbCBub25lIG5vcm1hbGl6ZWQgbmFtZS4gRGVmYXVsdHMgdG8ga2V5LlxuICAgICAgICovXG4gICAgICAkc2V0OiBmdW5jdGlvbihrZXksIHZhbHVlLCB3cml0ZUF0dHIsIGF0dHJOYW1lKSB7XG4gICAgICAgIC8vIFRPRE86IGRlY2lkZSB3aGV0aGVyIG9yIG5vdCB0byB0aHJvdyBhbiBlcnJvciBpZiBcImNsYXNzXCJcbiAgICAgICAgLy9pcyBzZXQgdGhyb3VnaCB0aGlzIGZ1bmN0aW9uIHNpbmNlIGl0IG1heSBjYXVzZSAkdXBkYXRlQ2xhc3MgdG9cbiAgICAgICAgLy9iZWNvbWUgdW5zdGFibGUuXG5cbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLiQkZWxlbWVudFswXSxcbiAgICAgICAgICAgIGJvb2xlYW5LZXkgPSBnZXRCb29sZWFuQXR0ck5hbWUobm9kZSwga2V5KSxcbiAgICAgICAgICAgIGFsaWFzZWRLZXkgPSBnZXRBbGlhc2VkQXR0ck5hbWUoa2V5KSxcbiAgICAgICAgICAgIG9ic2VydmVyID0ga2V5LFxuICAgICAgICAgICAgbm9kZU5hbWU7XG5cbiAgICAgICAgaWYgKGJvb2xlYW5LZXkpIHtcbiAgICAgICAgICB0aGlzLiQkZWxlbWVudC5wcm9wKGtleSwgdmFsdWUpO1xuICAgICAgICAgIGF0dHJOYW1lID0gYm9vbGVhbktleTtcbiAgICAgICAgfSBlbHNlIGlmIChhbGlhc2VkS2V5KSB7XG4gICAgICAgICAgdGhpc1thbGlhc2VkS2V5XSA9IHZhbHVlO1xuICAgICAgICAgIG9ic2VydmVyID0gYWxpYXNlZEtleTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXNba2V5XSA9IHZhbHVlO1xuXG4gICAgICAgIC8vIHRyYW5zbGF0ZSBub3JtYWxpemVkIGtleSB0byBhY3R1YWwga2V5XG4gICAgICAgIGlmIChhdHRyTmFtZSkge1xuICAgICAgICAgIHRoaXMuJGF0dHJba2V5XSA9IGF0dHJOYW1lO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGF0dHJOYW1lID0gdGhpcy4kYXR0cltrZXldO1xuICAgICAgICAgIGlmICghYXR0ck5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMuJGF0dHJba2V5XSA9IGF0dHJOYW1lID0gc25ha2VfY2FzZShrZXksICctJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgbm9kZU5hbWUgPSBub2RlTmFtZV8odGhpcy4kJGVsZW1lbnQpO1xuXG4gICAgICAgIGlmICgobm9kZU5hbWUgPT09ICdhJyAmJiAoa2V5ID09PSAnaHJlZicgfHwga2V5ID09PSAneGxpbmtIcmVmJykpIHx8XG4gICAgICAgICAgICAobm9kZU5hbWUgPT09ICdpbWcnICYmIGtleSA9PT0gJ3NyYycpKSB7XG4gICAgICAgICAgLy8gc2FuaXRpemUgYVtocmVmXSBhbmQgaW1nW3NyY10gdmFsdWVzXG4gICAgICAgICAgdGhpc1trZXldID0gdmFsdWUgPSAkJHNhbml0aXplVXJpKHZhbHVlLCBrZXkgPT09ICdzcmMnKTtcbiAgICAgICAgfSBlbHNlIGlmIChub2RlTmFtZSA9PT0gJ2ltZycgJiYga2V5ID09PSAnc3Jjc2V0Jykge1xuICAgICAgICAgIC8vIHNhbml0aXplIGltZ1tzcmNzZXRdIHZhbHVlc1xuICAgICAgICAgIHZhciByZXN1bHQgPSBcIlwiO1xuXG4gICAgICAgICAgLy8gZmlyc3QgY2hlY2sgaWYgdGhlcmUgYXJlIHNwYWNlcyBiZWNhdXNlIGl0J3Mgbm90IHRoZSBzYW1lIHBhdHRlcm5cbiAgICAgICAgICB2YXIgdHJpbW1lZFNyY3NldCA9IHRyaW0odmFsdWUpO1xuICAgICAgICAgIC8vICAgICAgICAgICAgICAgICggICA5OTl4ICAgLHwgICA5OTl3ICAgLHwgICAsfCwgICApXG4gICAgICAgICAgdmFyIHNyY1BhdHRlcm4gPSAvKFxccytcXGQreFxccyosfFxccytcXGQrd1xccyosfFxccyssfCxcXHMrKS87XG4gICAgICAgICAgdmFyIHBhdHRlcm4gPSAvXFxzLy50ZXN0KHRyaW1tZWRTcmNzZXQpID8gc3JjUGF0dGVybiA6IC8oLCkvO1xuXG4gICAgICAgICAgLy8gc3BsaXQgc3Jjc2V0IGludG8gdHVwbGUgb2YgdXJpIGFuZCBkZXNjcmlwdG9yIGV4Y2VwdCBmb3IgdGhlIGxhc3QgaXRlbVxuICAgICAgICAgIHZhciByYXdVcmlzID0gdHJpbW1lZFNyY3NldC5zcGxpdChwYXR0ZXJuKTtcblxuICAgICAgICAgIC8vIGZvciBlYWNoIHR1cGxlc1xuICAgICAgICAgIHZhciBuYnJVcmlzV2l0aDJwYXJ0cyA9IE1hdGguZmxvb3IocmF3VXJpcy5sZW5ndGggLyAyKTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5iclVyaXNXaXRoMnBhcnRzOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpbm5lcklkeCA9IGkgKiAyO1xuICAgICAgICAgICAgLy8gc2FuaXRpemUgdGhlIHVyaVxuICAgICAgICAgICAgcmVzdWx0ICs9ICQkc2FuaXRpemVVcmkodHJpbShyYXdVcmlzW2lubmVySWR4XSksIHRydWUpO1xuICAgICAgICAgICAgLy8gYWRkIHRoZSBkZXNjcmlwdG9yXG4gICAgICAgICAgICByZXN1bHQgKz0gKFwiIFwiICsgdHJpbShyYXdVcmlzW2lubmVySWR4ICsgMV0pKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBzcGxpdCB0aGUgbGFzdCBpdGVtIGludG8gdXJpIGFuZCBkZXNjcmlwdG9yXG4gICAgICAgICAgdmFyIGxhc3RUdXBsZSA9IHRyaW0ocmF3VXJpc1tpICogMl0pLnNwbGl0KC9cXHMvKTtcblxuICAgICAgICAgIC8vIHNhbml0aXplIHRoZSBsYXN0IHVyaVxuICAgICAgICAgIHJlc3VsdCArPSAkJHNhbml0aXplVXJpKHRyaW0obGFzdFR1cGxlWzBdKSwgdHJ1ZSk7XG5cbiAgICAgICAgICAvLyBhbmQgYWRkIHRoZSBsYXN0IGRlc2NyaXB0b3IgaWYgYW55XG4gICAgICAgICAgaWYgKGxhc3RUdXBsZS5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSAoXCIgXCIgKyB0cmltKGxhc3RUdXBsZVsxXSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzW2tleV0gPSB2YWx1ZSA9IHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh3cml0ZUF0dHIgIT09IGZhbHNlKSB7XG4gICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IGlzVW5kZWZpbmVkKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy4kJGVsZW1lbnQucmVtb3ZlQXR0cihhdHRyTmFtZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChTSU1QTEVfQVRUUl9OQU1FLnRlc3QoYXR0ck5hbWUpKSB7XG4gICAgICAgICAgICAgIHRoaXMuJCRlbGVtZW50LmF0dHIoYXR0ck5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHNldFNwZWNpYWxBdHRyKHRoaXMuJCRlbGVtZW50WzBdLCBhdHRyTmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZpcmUgb2JzZXJ2ZXJzXG4gICAgICAgIHZhciAkJG9ic2VydmVycyA9IHRoaXMuJCRvYnNlcnZlcnM7XG4gICAgICAgICQkb2JzZXJ2ZXJzICYmIGZvckVhY2goJCRvYnNlcnZlcnNbb2JzZXJ2ZXJdLCBmdW5jdGlvbihmbikge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmbih2YWx1ZSk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0sXG5cblxuICAgICAgLyoqXG4gICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgKiBAbmFtZSAkY29tcGlsZS5kaXJlY3RpdmUuQXR0cmlidXRlcyMkb2JzZXJ2ZVxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIE9ic2VydmVzIGFuIGludGVycG9sYXRlZCBhdHRyaWJ1dGUuXG4gICAgICAgKlxuICAgICAgICogVGhlIG9ic2VydmVyIGZ1bmN0aW9uIHdpbGwgYmUgaW52b2tlZCBvbmNlIGR1cmluZyB0aGUgbmV4dCBgJGRpZ2VzdGAgZm9sbG93aW5nXG4gICAgICAgKiBjb21waWxhdGlvbi4gVGhlIG9ic2VydmVyIGlzIHRoZW4gaW52b2tlZCB3aGVuZXZlciB0aGUgaW50ZXJwb2xhdGVkIHZhbHVlXG4gICAgICAgKiBjaGFuZ2VzLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgTm9ybWFsaXplZCBrZXkuIChpZSBuZ0F0dHJpYnV0ZSkgLlxuICAgICAgICogQHBhcmFtIHtmdW5jdGlvbihpbnRlcnBvbGF0ZWRWYWx1ZSl9IGZuIEZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbmV2ZXJcbiAgICAgICAgICAgICAgICB0aGUgaW50ZXJwb2xhdGVkIHZhbHVlIG9mIHRoZSBhdHRyaWJ1dGUgY2hhbmdlcy5cbiAgICAgICAqICAgICAgICBTZWUgdGhlIHtAbGluayBndWlkZS9pbnRlcnBvbGF0aW9uI2hvdy10ZXh0LWFuZC1hdHRyaWJ1dGUtYmluZGluZ3Mtd29yayBJbnRlcnBvbGF0aW9uXG4gICAgICAgKiAgICAgICAgZ3VpZGV9IGZvciBtb3JlIGluZm8uXG4gICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb24oKX0gUmV0dXJucyBhIGRlcmVnaXN0cmF0aW9uIGZ1bmN0aW9uIGZvciB0aGlzIG9ic2VydmVyLlxuICAgICAgICovXG4gICAgICAkb2JzZXJ2ZTogZnVuY3Rpb24oa2V5LCBmbikge1xuICAgICAgICB2YXIgYXR0cnMgPSB0aGlzLFxuICAgICAgICAgICAgJCRvYnNlcnZlcnMgPSAoYXR0cnMuJCRvYnNlcnZlcnMgfHwgKGF0dHJzLiQkb2JzZXJ2ZXJzID0gY3JlYXRlTWFwKCkpKSxcbiAgICAgICAgICAgIGxpc3RlbmVycyA9ICgkJG9ic2VydmVyc1trZXldIHx8ICgkJG9ic2VydmVyc1trZXldID0gW10pKTtcblxuICAgICAgICBsaXN0ZW5lcnMucHVzaChmbik7XG4gICAgICAgICRyb290U2NvcGUuJGV2YWxBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoIWxpc3RlbmVycy4kJGludGVyICYmIGF0dHJzLmhhc093blByb3BlcnR5KGtleSkgJiYgIWlzVW5kZWZpbmVkKGF0dHJzW2tleV0pKSB7XG4gICAgICAgICAgICAvLyBubyBvbmUgcmVnaXN0ZXJlZCBhdHRyaWJ1dGUgaW50ZXJwb2xhdGlvbiBmdW5jdGlvbiwgc28gbGV0cyBjYWxsIGl0IG1hbnVhbGx5XG4gICAgICAgICAgICBmbihhdHRyc1trZXldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBhcnJheVJlbW92ZShsaXN0ZW5lcnMsIGZuKTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gc2V0U3BlY2lhbEF0dHIoZWxlbWVudCwgYXR0ck5hbWUsIHZhbHVlKSB7XG4gICAgICAvLyBBdHRyaWJ1dGVzIG5hbWVzIHRoYXQgZG8gbm90IHN0YXJ0IHdpdGggbGV0dGVycyAoc3VjaCBhcyBgKGNsaWNrKWApIGNhbm5vdCBiZSBzZXQgdXNpbmcgYHNldEF0dHJpYnV0ZWBcbiAgICAgIC8vIHNvIHdlIGhhdmUgdG8ganVtcCB0aHJvdWdoIHNvbWUgaG9vcHMgdG8gZ2V0IHN1Y2ggYW4gYXR0cmlidXRlXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL3B1bGwvMTMzMThcbiAgICAgIHNwZWNpYWxBdHRySG9sZGVyLmlubmVySFRNTCA9IFwiPHNwYW4gXCIgKyBhdHRyTmFtZSArIFwiPlwiO1xuICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBzcGVjaWFsQXR0ckhvbGRlci5maXJzdENoaWxkLmF0dHJpYnV0ZXM7XG4gICAgICB2YXIgYXR0cmlidXRlID0gYXR0cmlidXRlc1swXTtcbiAgICAgIC8vIFdlIGhhdmUgdG8gcmVtb3ZlIHRoZSBhdHRyaWJ1dGUgZnJvbSBpdHMgY29udGFpbmVyIGVsZW1lbnQgYmVmb3JlIHdlIGNhbiBhZGQgaXQgdG8gdGhlIGRlc3RpbmF0aW9uIGVsZW1lbnRcbiAgICAgIGF0dHJpYnV0ZXMucmVtb3ZlTmFtZWRJdGVtKGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgIGF0dHJpYnV0ZS52YWx1ZSA9IHZhbHVlO1xuICAgICAgZWxlbWVudC5hdHRyaWJ1dGVzLnNldE5hbWVkSXRlbShhdHRyaWJ1dGUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNhZmVBZGRDbGFzcygkZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgICB0cnkge1xuICAgICAgICAkZWxlbWVudC5hZGRDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBpZ25vcmUsIHNpbmNlIGl0IG1lYW5zIHRoYXQgd2UgYXJlIHRyeWluZyB0byBzZXQgY2xhc3Mgb25cbiAgICAgICAgLy8gU1ZHIGVsZW1lbnQsIHdoZXJlIGNsYXNzIG5hbWUgaXMgcmVhZC1vbmx5LlxuICAgICAgfVxuICAgIH1cblxuXG4gICAgdmFyIHN0YXJ0U3ltYm9sID0gJGludGVycG9sYXRlLnN0YXJ0U3ltYm9sKCksXG4gICAgICAgIGVuZFN5bWJvbCA9ICRpbnRlcnBvbGF0ZS5lbmRTeW1ib2woKSxcbiAgICAgICAgZGVub3JtYWxpemVUZW1wbGF0ZSA9IChzdGFydFN5bWJvbCA9PSAne3snICYmIGVuZFN5bWJvbCAgPT0gJ319JylcbiAgICAgICAgICAgID8gaWRlbnRpdHlcbiAgICAgICAgICAgIDogZnVuY3Rpb24gZGVub3JtYWxpemVUZW1wbGF0ZSh0ZW1wbGF0ZSkge1xuICAgICAgICAgICAgICByZXR1cm4gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7L2csIHN0YXJ0U3ltYm9sKS5yZXBsYWNlKC99fS9nLCBlbmRTeW1ib2wpO1xuICAgICAgICB9LFxuICAgICAgICBOR19BVFRSX0JJTkRJTkcgPSAvXm5nQXR0cltBLVpdLztcbiAgICB2YXIgTVVMVElfRUxFTUVOVF9ESVJfUkUgPSAvXiguKylTdGFydCQvO1xuXG4gICAgY29tcGlsZS4kJGFkZEJpbmRpbmdJbmZvID0gZGVidWdJbmZvRW5hYmxlZCA/IGZ1bmN0aW9uICQkYWRkQmluZGluZ0luZm8oJGVsZW1lbnQsIGJpbmRpbmcpIHtcbiAgICAgIHZhciBiaW5kaW5ncyA9ICRlbGVtZW50LmRhdGEoJyRiaW5kaW5nJykgfHwgW107XG5cbiAgICAgIGlmIChpc0FycmF5KGJpbmRpbmcpKSB7XG4gICAgICAgIGJpbmRpbmdzID0gYmluZGluZ3MuY29uY2F0KGJpbmRpbmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYmluZGluZ3MucHVzaChiaW5kaW5nKTtcbiAgICAgIH1cblxuICAgICAgJGVsZW1lbnQuZGF0YSgnJGJpbmRpbmcnLCBiaW5kaW5ncyk7XG4gICAgfSA6IG5vb3A7XG5cbiAgICBjb21waWxlLiQkYWRkQmluZGluZ0NsYXNzID0gZGVidWdJbmZvRW5hYmxlZCA/IGZ1bmN0aW9uICQkYWRkQmluZGluZ0NsYXNzKCRlbGVtZW50KSB7XG4gICAgICBzYWZlQWRkQ2xhc3MoJGVsZW1lbnQsICduZy1iaW5kaW5nJyk7XG4gICAgfSA6IG5vb3A7XG5cbiAgICBjb21waWxlLiQkYWRkU2NvcGVJbmZvID0gZGVidWdJbmZvRW5hYmxlZCA/IGZ1bmN0aW9uICQkYWRkU2NvcGVJbmZvKCRlbGVtZW50LCBzY29wZSwgaXNvbGF0ZWQsIG5vVGVtcGxhdGUpIHtcbiAgICAgIHZhciBkYXRhTmFtZSA9IGlzb2xhdGVkID8gKG5vVGVtcGxhdGUgPyAnJGlzb2xhdGVTY29wZU5vVGVtcGxhdGUnIDogJyRpc29sYXRlU2NvcGUnKSA6ICckc2NvcGUnO1xuICAgICAgJGVsZW1lbnQuZGF0YShkYXRhTmFtZSwgc2NvcGUpO1xuICAgIH0gOiBub29wO1xuXG4gICAgY29tcGlsZS4kJGFkZFNjb3BlQ2xhc3MgPSBkZWJ1Z0luZm9FbmFibGVkID8gZnVuY3Rpb24gJCRhZGRTY29wZUNsYXNzKCRlbGVtZW50LCBpc29sYXRlZCkge1xuICAgICAgc2FmZUFkZENsYXNzKCRlbGVtZW50LCBpc29sYXRlZCA/ICduZy1pc29sYXRlLXNjb3BlJyA6ICduZy1zY29wZScpO1xuICAgIH0gOiBub29wO1xuXG4gICAgcmV0dXJuIGNvbXBpbGU7XG5cbiAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICBmdW5jdGlvbiBjb21waWxlKCRjb21waWxlTm9kZXMsIHRyYW5zY2x1ZGVGbiwgbWF4UHJpb3JpdHksIGlnbm9yZURpcmVjdGl2ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzQ29tcGlsZUNvbnRleHQpIHtcbiAgICAgIGlmICghKCRjb21waWxlTm9kZXMgaW5zdGFuY2VvZiBqcUxpdGUpKSB7XG4gICAgICAgIC8vIGpxdWVyeSBhbHdheXMgcmV3cmFwcywgd2hlcmVhcyB3ZSBuZWVkIHRvIHByZXNlcnZlIHRoZSBvcmlnaW5hbCBzZWxlY3RvciBzbyB0aGF0IHdlIGNhblxuICAgICAgICAvLyBtb2RpZnkgaXQuXG4gICAgICAgICRjb21waWxlTm9kZXMgPSBqcUxpdGUoJGNvbXBpbGVOb2Rlcyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBOT1RfRU1QVFkgPSAvXFxTKy87XG5cbiAgICAgIC8vIFdlIGNhbiBub3QgY29tcGlsZSB0b3AgbGV2ZWwgdGV4dCBlbGVtZW50cyBzaW5jZSB0ZXh0IG5vZGVzIGNhbiBiZSBtZXJnZWQgYW5kIHdlIHdpbGxcbiAgICAgIC8vIG5vdCBiZSBhYmxlIHRvIGF0dGFjaCBzY29wZSBkYXRhIHRvIHRoZW0sIHNvIHdlIHdpbGwgd3JhcCB0aGVtIGluIDxzcGFuPlxuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9ICRjb21waWxlTm9kZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdmFyIGRvbU5vZGUgPSAkY29tcGlsZU5vZGVzW2ldO1xuXG4gICAgICAgIGlmIChkb21Ob2RlLm5vZGVUeXBlID09PSBOT0RFX1RZUEVfVEVYVCAmJiBkb21Ob2RlLm5vZGVWYWx1ZS5tYXRjaChOT1RfRU1QVFkpIC8qIG5vbi1lbXB0eSAqLykge1xuICAgICAgICAgIGpxTGl0ZVdyYXBOb2RlKGRvbU5vZGUsICRjb21waWxlTm9kZXNbaV0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJykpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBjb21wb3NpdGVMaW5rRm4gPVxuICAgICAgICAgICAgICBjb21waWxlTm9kZXMoJGNvbXBpbGVOb2RlcywgdHJhbnNjbHVkZUZuLCAkY29tcGlsZU5vZGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4UHJpb3JpdHksIGlnbm9yZURpcmVjdGl2ZSwgcHJldmlvdXNDb21waWxlQ29udGV4dCk7XG4gICAgICBjb21waWxlLiQkYWRkU2NvcGVDbGFzcygkY29tcGlsZU5vZGVzKTtcbiAgICAgIHZhciBuYW1lc3BhY2UgPSBudWxsO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHB1YmxpY0xpbmtGbihzY29wZSwgY2xvbmVDb25uZWN0Rm4sIG9wdGlvbnMpIHtcbiAgICAgICAgYXNzZXJ0QXJnKHNjb3BlLCAnc2NvcGUnKTtcblxuICAgICAgICBpZiAocHJldmlvdXNDb21waWxlQ29udGV4dCAmJiBwcmV2aW91c0NvbXBpbGVDb250ZXh0Lm5lZWRzTmV3U2NvcGUpIHtcbiAgICAgICAgICAvLyBBIHBhcmVudCBkaXJlY3RpdmUgZGlkIGEgcmVwbGFjZSBhbmQgYSBkaXJlY3RpdmUgb24gdGhpcyBlbGVtZW50IGFza2VkXG4gICAgICAgICAgLy8gZm9yIHRyYW5zY2x1c2lvbiwgd2hpY2ggY2F1c2VkIHVzIHRvIGxvc2UgYSBsYXllciBvZiBlbGVtZW50IG9uIHdoaWNoXG4gICAgICAgICAgLy8gd2UgY291bGQgaG9sZCB0aGUgbmV3IHRyYW5zY2x1c2lvbiBzY29wZSwgc28gd2Ugd2lsbCBjcmVhdGUgaXQgbWFudWFsbHlcbiAgICAgICAgICAvLyBoZXJlLlxuICAgICAgICAgIHNjb3BlID0gc2NvcGUuJHBhcmVudC4kbmV3KCk7XG4gICAgICAgIH1cblxuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgdmFyIHBhcmVudEJvdW5kVHJhbnNjbHVkZUZuID0gb3B0aW9ucy5wYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbixcbiAgICAgICAgICB0cmFuc2NsdWRlQ29udHJvbGxlcnMgPSBvcHRpb25zLnRyYW5zY2x1ZGVDb250cm9sbGVycyxcbiAgICAgICAgICBmdXR1cmVQYXJlbnRFbGVtZW50ID0gb3B0aW9ucy5mdXR1cmVQYXJlbnRFbGVtZW50O1xuXG4gICAgICAgIC8vIFdoZW4gYHBhcmVudEJvdW5kVHJhbnNjbHVkZUZuYCBpcyBwYXNzZWQsIGl0IGlzIGFcbiAgICAgICAgLy8gYGNvbnRyb2xsZXJzQm91bmRUcmFuc2NsdWRlYCBmdW5jdGlvbiAoaXQgd2FzIHByZXZpb3VzbHkgcGFzc2VkXG4gICAgICAgIC8vIGFzIGB0cmFuc2NsdWRlYCB0byBkaXJlY3RpdmUubGluaykgc28gd2UgbXVzdCB1bndyYXAgaXQgdG8gZ2V0XG4gICAgICAgIC8vIGl0cyBgYm91bmRUcmFuc2NsdWRlRm5gXG4gICAgICAgIGlmIChwYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbiAmJiBwYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbi4kJGJvdW5kVHJhbnNjbHVkZSkge1xuICAgICAgICAgIHBhcmVudEJvdW5kVHJhbnNjbHVkZUZuID0gcGFyZW50Qm91bmRUcmFuc2NsdWRlRm4uJCRib3VuZFRyYW5zY2x1ZGU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIW5hbWVzcGFjZSkge1xuICAgICAgICAgIG5hbWVzcGFjZSA9IGRldGVjdE5hbWVzcGFjZUZvckNoaWxkRWxlbWVudHMoZnV0dXJlUGFyZW50RWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyICRsaW5rTm9kZTtcbiAgICAgICAgaWYgKG5hbWVzcGFjZSAhPT0gJ2h0bWwnKSB7XG4gICAgICAgICAgLy8gV2hlbiB1c2luZyBhIGRpcmVjdGl2ZSB3aXRoIHJlcGxhY2U6dHJ1ZSBhbmQgdGVtcGxhdGVVcmwgdGhlICRjb21waWxlTm9kZXNcbiAgICAgICAgICAvLyAob3IgYSBjaGlsZCBlbGVtZW50IGluc2lkZSBvZiB0aGVtKVxuICAgICAgICAgIC8vIG1pZ2h0IGNoYW5nZSwgc28gd2UgbmVlZCB0byByZWNyZWF0ZSB0aGUgbmFtZXNwYWNlIGFkYXB0ZWQgY29tcGlsZU5vZGVzXG4gICAgICAgICAgLy8gZm9yIGNhbGwgdG8gdGhlIGxpbmsgZnVuY3Rpb24uXG4gICAgICAgICAgLy8gTm90ZTogVGhpcyB3aWxsIGFscmVhZHkgY2xvbmUgdGhlIG5vZGVzLi4uXG4gICAgICAgICAgJGxpbmtOb2RlID0ganFMaXRlKFxuICAgICAgICAgICAgd3JhcFRlbXBsYXRlKG5hbWVzcGFjZSwganFMaXRlKCc8ZGl2PicpLmFwcGVuZCgkY29tcGlsZU5vZGVzKS5odG1sKCkpXG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChjbG9uZUNvbm5lY3RGbikge1xuICAgICAgICAgIC8vIGltcG9ydGFudCEhOiB3ZSBtdXN0IGNhbGwgb3VyIGpxTGl0ZS5jbG9uZSgpIHNpbmNlIHRoZSBqUXVlcnkgb25lIGlzIHRyeWluZyB0byBiZSBzbWFydFxuICAgICAgICAgIC8vIGFuZCBzb21ldGltZXMgY2hhbmdlcyB0aGUgc3RydWN0dXJlIG9mIHRoZSBET00uXG4gICAgICAgICAgJGxpbmtOb2RlID0gSlFMaXRlUHJvdG90eXBlLmNsb25lLmNhbGwoJGNvbXBpbGVOb2Rlcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJGxpbmtOb2RlID0gJGNvbXBpbGVOb2RlcztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0cmFuc2NsdWRlQ29udHJvbGxlcnMpIHtcbiAgICAgICAgICBmb3IgKHZhciBjb250cm9sbGVyTmFtZSBpbiB0cmFuc2NsdWRlQ29udHJvbGxlcnMpIHtcbiAgICAgICAgICAgICRsaW5rTm9kZS5kYXRhKCckJyArIGNvbnRyb2xsZXJOYW1lICsgJ0NvbnRyb2xsZXInLCB0cmFuc2NsdWRlQ29udHJvbGxlcnNbY29udHJvbGxlck5hbWVdLmluc3RhbmNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb21waWxlLiQkYWRkU2NvcGVJbmZvKCRsaW5rTm9kZSwgc2NvcGUpO1xuXG4gICAgICAgIGlmIChjbG9uZUNvbm5lY3RGbikgY2xvbmVDb25uZWN0Rm4oJGxpbmtOb2RlLCBzY29wZSk7XG4gICAgICAgIGlmIChjb21wb3NpdGVMaW5rRm4pIGNvbXBvc2l0ZUxpbmtGbihzY29wZSwgJGxpbmtOb2RlLCAkbGlua05vZGUsIHBhcmVudEJvdW5kVHJhbnNjbHVkZUZuKTtcbiAgICAgICAgcmV0dXJuICRsaW5rTm9kZTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGV0ZWN0TmFtZXNwYWNlRm9yQ2hpbGRFbGVtZW50cyhwYXJlbnRFbGVtZW50KSB7XG4gICAgICAvLyBUT0RPOiBNYWtlIHRoaXMgZGV0ZWN0IE1hdGhNTCBhcyB3ZWxsLi4uXG4gICAgICB2YXIgbm9kZSA9IHBhcmVudEVsZW1lbnQgJiYgcGFyZW50RWxlbWVudFswXTtcbiAgICAgIGlmICghbm9kZSkge1xuICAgICAgICByZXR1cm4gJ2h0bWwnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG5vZGVOYW1lXyhub2RlKSAhPT0gJ2ZvcmVpZ25vYmplY3QnICYmIHRvU3RyaW5nLmNhbGwobm9kZSkubWF0Y2goL1NWRy8pID8gJ3N2ZycgOiAnaHRtbCc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29tcGlsZSBmdW5jdGlvbiBtYXRjaGVzIGVhY2ggbm9kZSBpbiBub2RlTGlzdCBhZ2FpbnN0IHRoZSBkaXJlY3RpdmVzLiBPbmNlIGFsbCBkaXJlY3RpdmVzXG4gICAgICogZm9yIGEgcGFydGljdWxhciBub2RlIGFyZSBjb2xsZWN0ZWQgdGhlaXIgY29tcGlsZSBmdW5jdGlvbnMgYXJlIGV4ZWN1dGVkLiBUaGUgY29tcGlsZVxuICAgICAqIGZ1bmN0aW9ucyByZXR1cm4gdmFsdWVzIC0gdGhlIGxpbmtpbmcgZnVuY3Rpb25zIC0gYXJlIGNvbWJpbmVkIGludG8gYSBjb21wb3NpdGUgbGlua2luZ1xuICAgICAqIGZ1bmN0aW9uLCB3aGljaCBpcyB0aGUgYSBsaW5raW5nIGZ1bmN0aW9uIGZvciB0aGUgbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm9kZUxpc3R9IG5vZGVMaXN0IGFuIGFycmF5IG9mIG5vZGVzIG9yIE5vZGVMaXN0IHRvIGNvbXBpbGVcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGFuZ3VsYXIuU2NvcGUsIGNsb25lQXR0YWNoRm49KX0gdHJhbnNjbHVkZUZuIEEgbGlua2luZyBmdW5jdGlvbiwgd2hlcmUgdGhlXG4gICAgICogICAgICAgIHNjb3BlIGFyZ3VtZW50IGlzIGF1dG8tZ2VuZXJhdGVkIHRvIHRoZSBuZXcgY2hpbGQgb2YgdGhlIHRyYW5zY2x1ZGVkIHBhcmVudCBzY29wZS5cbiAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnQ9fSAkcm9vdEVsZW1lbnQgSWYgdGhlIG5vZGVMaXN0IGlzIHRoZSByb290IG9mIHRoZSBjb21waWxhdGlvbiB0cmVlIHRoZW5cbiAgICAgKiAgICAgICAgdGhlIHJvb3RFbGVtZW50IG11c3QgYmUgc2V0IHRoZSBqcUxpdGUgY29sbGVjdGlvbiBvZiB0aGUgY29tcGlsZSByb290LiBUaGlzIGlzXG4gICAgICogICAgICAgIG5lZWRlZCBzbyB0aGF0IHRoZSBqcUxpdGUgY29sbGVjdGlvbiBpdGVtcyBjYW4gYmUgcmVwbGFjZWQgd2l0aCB3aWRnZXRzLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyPX0gbWF4UHJpb3JpdHkgTWF4IGRpcmVjdGl2ZSBwcmlvcml0eS5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IEEgY29tcG9zaXRlIGxpbmtpbmcgZnVuY3Rpb24gb2YgYWxsIG9mIHRoZSBtYXRjaGVkIGRpcmVjdGl2ZXMgb3IgbnVsbC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21waWxlTm9kZXMobm9kZUxpc3QsIHRyYW5zY2x1ZGVGbiwgJHJvb3RFbGVtZW50LCBtYXhQcmlvcml0eSwgaWdub3JlRGlyZWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzQ29tcGlsZUNvbnRleHQpIHtcbiAgICAgIHZhciBsaW5rRm5zID0gW10sXG4gICAgICAgICAgYXR0cnMsIGRpcmVjdGl2ZXMsIG5vZGVMaW5rRm4sIGNoaWxkTm9kZXMsIGNoaWxkTGlua0ZuLCBsaW5rRm5Gb3VuZCwgbm9kZUxpbmtGbkZvdW5kO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGF0dHJzID0gbmV3IEF0dHJpYnV0ZXMoKTtcblxuICAgICAgICAvLyB3ZSBtdXN0IGFsd2F5cyByZWZlciB0byBub2RlTGlzdFtpXSBzaW5jZSB0aGUgbm9kZXMgY2FuIGJlIHJlcGxhY2VkIHVuZGVybmVhdGggdXMuXG4gICAgICAgIGRpcmVjdGl2ZXMgPSBjb2xsZWN0RGlyZWN0aXZlcyhub2RlTGlzdFtpXSwgW10sIGF0dHJzLCBpID09PSAwID8gbWF4UHJpb3JpdHkgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlRGlyZWN0aXZlKTtcblxuICAgICAgICBub2RlTGlua0ZuID0gKGRpcmVjdGl2ZXMubGVuZ3RoKVxuICAgICAgICAgICAgPyBhcHBseURpcmVjdGl2ZXNUb05vZGUoZGlyZWN0aXZlcywgbm9kZUxpc3RbaV0sIGF0dHJzLCB0cmFuc2NsdWRlRm4sICRyb290RWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCwgW10sIFtdLCBwcmV2aW91c0NvbXBpbGVDb250ZXh0KVxuICAgICAgICAgICAgOiBudWxsO1xuXG4gICAgICAgIGlmIChub2RlTGlua0ZuICYmIG5vZGVMaW5rRm4uc2NvcGUpIHtcbiAgICAgICAgICBjb21waWxlLiQkYWRkU2NvcGVDbGFzcyhhdHRycy4kJGVsZW1lbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hpbGRMaW5rRm4gPSAobm9kZUxpbmtGbiAmJiBub2RlTGlua0ZuLnRlcm1pbmFsIHx8XG4gICAgICAgICAgICAgICAgICAgICAgIShjaGlsZE5vZGVzID0gbm9kZUxpc3RbaV0uY2hpbGROb2RlcykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAhY2hpbGROb2Rlcy5sZW5ndGgpXG4gICAgICAgICAgICA/IG51bGxcbiAgICAgICAgICAgIDogY29tcGlsZU5vZGVzKGNoaWxkTm9kZXMsXG4gICAgICAgICAgICAgICAgIG5vZGVMaW5rRm4gPyAoXG4gICAgICAgICAgICAgICAgICAobm9kZUxpbmtGbi50cmFuc2NsdWRlT25UaGlzRWxlbWVudCB8fCAhbm9kZUxpbmtGbi50ZW1wbGF0ZU9uVGhpc0VsZW1lbnQpXG4gICAgICAgICAgICAgICAgICAgICAmJiBub2RlTGlua0ZuLnRyYW5zY2x1ZGUpIDogdHJhbnNjbHVkZUZuKTtcblxuICAgICAgICBpZiAobm9kZUxpbmtGbiB8fCBjaGlsZExpbmtGbikge1xuICAgICAgICAgIGxpbmtGbnMucHVzaChpLCBub2RlTGlua0ZuLCBjaGlsZExpbmtGbik7XG4gICAgICAgICAgbGlua0ZuRm91bmQgPSB0cnVlO1xuICAgICAgICAgIG5vZGVMaW5rRm5Gb3VuZCA9IG5vZGVMaW5rRm5Gb3VuZCB8fCBub2RlTGlua0ZuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy91c2UgdGhlIHByZXZpb3VzIGNvbnRleHQgb25seSBmb3IgdGhlIGZpcnN0IGVsZW1lbnQgaW4gdGhlIHZpcnR1YWwgZ3JvdXBcbiAgICAgICAgcHJldmlvdXNDb21waWxlQ29udGV4dCA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIC8vIHJldHVybiBhIGxpbmtpbmcgZnVuY3Rpb24gaWYgd2UgaGF2ZSBmb3VuZCBhbnl0aGluZywgbnVsbCBvdGhlcndpc2VcbiAgICAgIHJldHVybiBsaW5rRm5Gb3VuZCA/IGNvbXBvc2l0ZUxpbmtGbiA6IG51bGw7XG5cbiAgICAgIGZ1bmN0aW9uIGNvbXBvc2l0ZUxpbmtGbihzY29wZSwgbm9kZUxpc3QsICRyb290RWxlbWVudCwgcGFyZW50Qm91bmRUcmFuc2NsdWRlRm4pIHtcbiAgICAgICAgdmFyIG5vZGVMaW5rRm4sIGNoaWxkTGlua0ZuLCBub2RlLCBjaGlsZFNjb3BlLCBpLCBpaSwgaWR4LCBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuO1xuICAgICAgICB2YXIgc3RhYmxlTm9kZUxpc3Q7XG5cblxuICAgICAgICBpZiAobm9kZUxpbmtGbkZvdW5kKSB7XG4gICAgICAgICAgLy8gY29weSBub2RlTGlzdCBzbyB0aGF0IGlmIGEgbm9kZUxpbmtGbiByZW1vdmVzIG9yIGFkZHMgYW4gZWxlbWVudCBhdCB0aGlzIERPTSBsZXZlbCBvdXJcbiAgICAgICAgICAvLyBvZmZzZXRzIGRvbid0IGdldCBzY3Jld2VkIHVwXG4gICAgICAgICAgdmFyIG5vZGVMaXN0TGVuZ3RoID0gbm9kZUxpc3QubGVuZ3RoO1xuICAgICAgICAgIHN0YWJsZU5vZGVMaXN0ID0gbmV3IEFycmF5KG5vZGVMaXN0TGVuZ3RoKTtcblxuICAgICAgICAgIC8vIGNyZWF0ZSBhIHNwYXJzZSBhcnJheSBieSBvbmx5IGNvcHlpbmcgdGhlIGVsZW1lbnRzIHdoaWNoIGhhdmUgYSBsaW5rRm5cbiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGlua0Zucy5sZW5ndGg7IGkrPTMpIHtcbiAgICAgICAgICAgIGlkeCA9IGxpbmtGbnNbaV07XG4gICAgICAgICAgICBzdGFibGVOb2RlTGlzdFtpZHhdID0gbm9kZUxpc3RbaWR4XTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc3RhYmxlTm9kZUxpc3QgPSBub2RlTGlzdDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gbGlua0Zucy5sZW5ndGg7IGkgPCBpaTspIHtcbiAgICAgICAgICBub2RlID0gc3RhYmxlTm9kZUxpc3RbbGlua0Zuc1tpKytdXTtcbiAgICAgICAgICBub2RlTGlua0ZuID0gbGlua0Zuc1tpKytdO1xuICAgICAgICAgIGNoaWxkTGlua0ZuID0gbGlua0Zuc1tpKytdO1xuXG4gICAgICAgICAgaWYgKG5vZGVMaW5rRm4pIHtcbiAgICAgICAgICAgIGlmIChub2RlTGlua0ZuLnNjb3BlKSB7XG4gICAgICAgICAgICAgIGNoaWxkU2NvcGUgPSBzY29wZS4kbmV3KCk7XG4gICAgICAgICAgICAgIGNvbXBpbGUuJCRhZGRTY29wZUluZm8oanFMaXRlKG5vZGUpLCBjaGlsZFNjb3BlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNoaWxkU2NvcGUgPSBzY29wZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG5vZGVMaW5rRm4udHJhbnNjbHVkZU9uVGhpc0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgY2hpbGRCb3VuZFRyYW5zY2x1ZGVGbiA9IGNyZWF0ZUJvdW5kVHJhbnNjbHVkZUZuKFxuICAgICAgICAgICAgICAgICAgc2NvcGUsIG5vZGVMaW5rRm4udHJhbnNjbHVkZSwgcGFyZW50Qm91bmRUcmFuc2NsdWRlRm4pO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFub2RlTGlua0ZuLnRlbXBsYXRlT25UaGlzRWxlbWVudCAmJiBwYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbikge1xuICAgICAgICAgICAgICBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuID0gcGFyZW50Qm91bmRUcmFuc2NsdWRlRm47XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXBhcmVudEJvdW5kVHJhbnNjbHVkZUZuICYmIHRyYW5zY2x1ZGVGbikge1xuICAgICAgICAgICAgICBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuID0gY3JlYXRlQm91bmRUcmFuc2NsdWRlRm4oc2NvcGUsIHRyYW5zY2x1ZGVGbik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNoaWxkQm91bmRUcmFuc2NsdWRlRm4gPSBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBub2RlTGlua0ZuKGNoaWxkTGlua0ZuLCBjaGlsZFNjb3BlLCBub2RlLCAkcm9vdEVsZW1lbnQsIGNoaWxkQm91bmRUcmFuc2NsdWRlRm4pO1xuXG4gICAgICAgICAgfSBlbHNlIGlmIChjaGlsZExpbmtGbikge1xuICAgICAgICAgICAgY2hpbGRMaW5rRm4oc2NvcGUsIG5vZGUuY2hpbGROb2RlcywgdW5kZWZpbmVkLCBwYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlQm91bmRUcmFuc2NsdWRlRm4oc2NvcGUsIHRyYW5zY2x1ZGVGbiwgcHJldmlvdXNCb3VuZFRyYW5zY2x1ZGVGbikge1xuXG4gICAgICB2YXIgYm91bmRUcmFuc2NsdWRlRm4gPSBmdW5jdGlvbih0cmFuc2NsdWRlZFNjb3BlLCBjbG9uZUZuLCBjb250cm9sbGVycywgZnV0dXJlUGFyZW50RWxlbWVudCwgY29udGFpbmluZ1Njb3BlKSB7XG5cbiAgICAgICAgaWYgKCF0cmFuc2NsdWRlZFNjb3BlKSB7XG4gICAgICAgICAgdHJhbnNjbHVkZWRTY29wZSA9IHNjb3BlLiRuZXcoZmFsc2UsIGNvbnRhaW5pbmdTY29wZSk7XG4gICAgICAgICAgdHJhbnNjbHVkZWRTY29wZS4kJHRyYW5zY2x1ZGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cmFuc2NsdWRlRm4odHJhbnNjbHVkZWRTY29wZSwgY2xvbmVGbiwge1xuICAgICAgICAgIHBhcmVudEJvdW5kVHJhbnNjbHVkZUZuOiBwcmV2aW91c0JvdW5kVHJhbnNjbHVkZUZuLFxuICAgICAgICAgIHRyYW5zY2x1ZGVDb250cm9sbGVyczogY29udHJvbGxlcnMsXG4gICAgICAgICAgZnV0dXJlUGFyZW50RWxlbWVudDogZnV0dXJlUGFyZW50RWxlbWVudFxuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIC8vIFdlIG5lZWQgIHRvIGF0dGFjaCB0aGUgdHJhbnNjbHVzaW9uIHNsb3RzIG9udG8gdGhlIGBib3VuZFRyYW5zY2x1ZGVGbmBcbiAgICAgIC8vIHNvIHRoYXQgdGhleSBhcmUgYXZhaWxhYmxlIGluc2lkZSB0aGUgYGNvbnRyb2xsZXJzQm91bmRUcmFuc2NsdWRlYCBmdW5jdGlvblxuICAgICAgdmFyIGJvdW5kU2xvdHMgPSBib3VuZFRyYW5zY2x1ZGVGbi4kJHNsb3RzID0gY3JlYXRlTWFwKCk7XG4gICAgICBmb3IgKHZhciBzbG90TmFtZSBpbiB0cmFuc2NsdWRlRm4uJCRzbG90cykge1xuICAgICAgICBpZiAodHJhbnNjbHVkZUZuLiQkc2xvdHNbc2xvdE5hbWVdKSB7XG4gICAgICAgICAgYm91bmRTbG90c1tzbG90TmFtZV0gPSBjcmVhdGVCb3VuZFRyYW5zY2x1ZGVGbihzY29wZSwgdHJhbnNjbHVkZUZuLiQkc2xvdHNbc2xvdE5hbWVdLCBwcmV2aW91c0JvdW5kVHJhbnNjbHVkZUZuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBib3VuZFNsb3RzW3Nsb3ROYW1lXSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGJvdW5kVHJhbnNjbHVkZUZuO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvb2tzIGZvciBkaXJlY3RpdmVzIG9uIHRoZSBnaXZlbiBub2RlIGFuZCBhZGRzIHRoZW0gdG8gdGhlIGRpcmVjdGl2ZSBjb2xsZWN0aW9uIHdoaWNoIGlzXG4gICAgICogc29ydGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGUgTm9kZSB0byBzZWFyY2guXG4gICAgICogQHBhcmFtIGRpcmVjdGl2ZXMgQW4gYXJyYXkgdG8gd2hpY2ggdGhlIGRpcmVjdGl2ZXMgYXJlIGFkZGVkIHRvLiBUaGlzIGFycmF5IGlzIHNvcnRlZCBiZWZvcmVcbiAgICAgKiAgICAgICAgdGhlIGZ1bmN0aW9uIHJldHVybnMuXG4gICAgICogQHBhcmFtIGF0dHJzIFRoZSBzaGFyZWQgYXR0cnMgb2JqZWN0IHdoaWNoIGlzIHVzZWQgdG8gcG9wdWxhdGUgdGhlIG5vcm1hbGl6ZWQgYXR0cmlidXRlcy5cbiAgICAgKiBAcGFyYW0ge251bWJlcj19IG1heFByaW9yaXR5IE1heCBkaXJlY3RpdmUgcHJpb3JpdHkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29sbGVjdERpcmVjdGl2ZXMobm9kZSwgZGlyZWN0aXZlcywgYXR0cnMsIG1heFByaW9yaXR5LCBpZ25vcmVEaXJlY3RpdmUpIHtcbiAgICAgIHZhciBub2RlVHlwZSA9IG5vZGUubm9kZVR5cGUsXG4gICAgICAgICAgYXR0cnNNYXAgPSBhdHRycy4kYXR0cixcbiAgICAgICAgICBtYXRjaCxcbiAgICAgICAgICBjbGFzc05hbWU7XG5cbiAgICAgIHN3aXRjaCAobm9kZVR5cGUpIHtcbiAgICAgICAgY2FzZSBOT0RFX1RZUEVfRUxFTUVOVDogLyogRWxlbWVudCAqL1xuICAgICAgICAgIC8vIHVzZSB0aGUgbm9kZSBuYW1lOiA8ZGlyZWN0aXZlPlxuICAgICAgICAgIGFkZERpcmVjdGl2ZShkaXJlY3RpdmVzLFxuICAgICAgICAgICAgICBkaXJlY3RpdmVOb3JtYWxpemUobm9kZU5hbWVfKG5vZGUpKSwgJ0UnLCBtYXhQcmlvcml0eSwgaWdub3JlRGlyZWN0aXZlKTtcblxuICAgICAgICAgIC8vIGl0ZXJhdGUgb3ZlciB0aGUgYXR0cmlidXRlc1xuICAgICAgICAgIGZvciAodmFyIGF0dHIsIG5hbWUsIG5OYW1lLCBuZ0F0dHJOYW1lLCB2YWx1ZSwgaXNOZ0F0dHIsIG5BdHRycyA9IG5vZGUuYXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAgICBqID0gMCwgamogPSBuQXR0cnMgJiYgbkF0dHJzLmxlbmd0aDsgaiA8IGpqOyBqKyspIHtcbiAgICAgICAgICAgIHZhciBhdHRyU3RhcnROYW1lID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgYXR0ckVuZE5hbWUgPSBmYWxzZTtcblxuICAgICAgICAgICAgYXR0ciA9IG5BdHRyc1tqXTtcbiAgICAgICAgICAgIG5hbWUgPSBhdHRyLm5hbWU7XG4gICAgICAgICAgICB2YWx1ZSA9IHRyaW0oYXR0ci52YWx1ZSk7XG5cbiAgICAgICAgICAgIC8vIHN1cHBvcnQgbmdBdHRyIGF0dHJpYnV0ZSBiaW5kaW5nXG4gICAgICAgICAgICBuZ0F0dHJOYW1lID0gZGlyZWN0aXZlTm9ybWFsaXplKG5hbWUpO1xuICAgICAgICAgICAgaWYgKGlzTmdBdHRyID0gTkdfQVRUUl9CSU5ESU5HLnRlc3QobmdBdHRyTmFtZSkpIHtcbiAgICAgICAgICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZShQUkVGSVhfUkVHRVhQLCAnJylcbiAgICAgICAgICAgICAgICAuc3Vic3RyKDgpLnJlcGxhY2UoL18oLikvZywgZnVuY3Rpb24obWF0Y2gsIGxldHRlcikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGxldHRlci50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbXVsdGlFbGVtZW50TWF0Y2ggPSBuZ0F0dHJOYW1lLm1hdGNoKE1VTFRJX0VMRU1FTlRfRElSX1JFKTtcbiAgICAgICAgICAgIGlmIChtdWx0aUVsZW1lbnRNYXRjaCAmJiBkaXJlY3RpdmVJc011bHRpRWxlbWVudChtdWx0aUVsZW1lbnRNYXRjaFsxXSkpIHtcbiAgICAgICAgICAgICAgYXR0clN0YXJ0TmFtZSA9IG5hbWU7XG4gICAgICAgICAgICAgIGF0dHJFbmROYW1lID0gbmFtZS5zdWJzdHIoMCwgbmFtZS5sZW5ndGggLSA1KSArICdlbmQnO1xuICAgICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHIoMCwgbmFtZS5sZW5ndGggLSA2KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbk5hbWUgPSBkaXJlY3RpdmVOb3JtYWxpemUobmFtZS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgICAgIGF0dHJzTWFwW25OYW1lXSA9IG5hbWU7XG4gICAgICAgICAgICBpZiAoaXNOZ0F0dHIgfHwgIWF0dHJzLmhhc093blByb3BlcnR5KG5OYW1lKSkge1xuICAgICAgICAgICAgICAgIGF0dHJzW25OYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChnZXRCb29sZWFuQXR0ck5hbWUobm9kZSwgbk5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICBhdHRyc1tuTmFtZV0gPSB0cnVlOyAvLyBwcmVzZW5jZSBtZWFucyB0cnVlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWRkQXR0ckludGVycG9sYXRlRGlyZWN0aXZlKG5vZGUsIGRpcmVjdGl2ZXMsIHZhbHVlLCBuTmFtZSwgaXNOZ0F0dHIpO1xuICAgICAgICAgICAgYWRkRGlyZWN0aXZlKGRpcmVjdGl2ZXMsIG5OYW1lLCAnQScsIG1heFByaW9yaXR5LCBpZ25vcmVEaXJlY3RpdmUsIGF0dHJTdGFydE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJFbmROYW1lKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyB1c2UgY2xhc3MgYXMgZGlyZWN0aXZlXG4gICAgICAgICAgY2xhc3NOYW1lID0gbm9kZS5jbGFzc05hbWU7XG4gICAgICAgICAgaWYgKGlzT2JqZWN0KGNsYXNzTmFtZSkpIHtcbiAgICAgICAgICAgICAgLy8gTWF5YmUgU1ZHQW5pbWF0ZWRTdHJpbmdcbiAgICAgICAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lLmFuaW1WYWw7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChpc1N0cmluZyhjbGFzc05hbWUpICYmIGNsYXNzTmFtZSAhPT0gJycpIHtcbiAgICAgICAgICAgIHdoaWxlIChtYXRjaCA9IENMQVNTX0RJUkVDVElWRV9SRUdFWFAuZXhlYyhjbGFzc05hbWUpKSB7XG4gICAgICAgICAgICAgIG5OYW1lID0gZGlyZWN0aXZlTm9ybWFsaXplKG1hdGNoWzJdKTtcbiAgICAgICAgICAgICAgaWYgKGFkZERpcmVjdGl2ZShkaXJlY3RpdmVzLCBuTmFtZSwgJ0MnLCBtYXhQcmlvcml0eSwgaWdub3JlRGlyZWN0aXZlKSkge1xuICAgICAgICAgICAgICAgIGF0dHJzW25OYW1lXSA9IHRyaW0obWF0Y2hbM10pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZS5zdWJzdHIobWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBOT0RFX1RZUEVfVEVYVDogLyogVGV4dCBOb2RlICovXG4gICAgICAgICAgaWYgKG1zaWUgPT09IDExKSB7XG4gICAgICAgICAgICAvLyBXb3JrYXJvdW5kIGZvciAjMTE3ODFcbiAgICAgICAgICAgIHdoaWxlIChub2RlLnBhcmVudE5vZGUgJiYgbm9kZS5uZXh0U2libGluZyAmJiBub2RlLm5leHRTaWJsaW5nLm5vZGVUeXBlID09PSBOT0RFX1RZUEVfVEVYVCkge1xuICAgICAgICAgICAgICBub2RlLm5vZGVWYWx1ZSA9IG5vZGUubm9kZVZhbHVlICsgbm9kZS5uZXh0U2libGluZy5ub2RlVmFsdWU7XG4gICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlLm5leHRTaWJsaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYWRkVGV4dEludGVycG9sYXRlRGlyZWN0aXZlKGRpcmVjdGl2ZXMsIG5vZGUubm9kZVZhbHVlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBOT0RFX1RZUEVfQ09NTUVOVDogLyogQ29tbWVudCAqL1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBtYXRjaCA9IENPTU1FTlRfRElSRUNUSVZFX1JFR0VYUC5leGVjKG5vZGUubm9kZVZhbHVlKTtcbiAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICBuTmFtZSA9IGRpcmVjdGl2ZU5vcm1hbGl6ZShtYXRjaFsxXSk7XG4gICAgICAgICAgICAgIGlmIChhZGREaXJlY3RpdmUoZGlyZWN0aXZlcywgbk5hbWUsICdNJywgbWF4UHJpb3JpdHksIGlnbm9yZURpcmVjdGl2ZSkpIHtcbiAgICAgICAgICAgICAgICBhdHRyc1tuTmFtZV0gPSB0cmltKG1hdGNoWzJdKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIHR1cm5zIG91dCB0aGF0IHVuZGVyIHNvbWUgY2lyY3Vtc3RhbmNlcyBJRTkgdGhyb3dzIGVycm9ycyB3aGVuIG9uZSBhdHRlbXB0cyB0byByZWFkXG4gICAgICAgICAgICAvLyBjb21tZW50J3Mgbm9kZSB2YWx1ZS5cbiAgICAgICAgICAgIC8vIEp1c3QgaWdub3JlIGl0IGFuZCBjb250aW51ZS4gKENhbid0IHNlZW0gdG8gcmVwcm9kdWNlIGluIHRlc3QgY2FzZS4pXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBkaXJlY3RpdmVzLnNvcnQoYnlQcmlvcml0eSk7XG4gICAgICByZXR1cm4gZGlyZWN0aXZlcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhIG5vZGUgd2l0aCBhbiBkaXJlY3RpdmUtc3RhcnQgaXQgY29sbGVjdHMgYWxsIG9mIHRoZSBzaWJsaW5ncyB1bnRpbCBpdCBmaW5kc1xuICAgICAqIGRpcmVjdGl2ZS1lbmQuXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKiBAcGFyYW0gYXR0clN0YXJ0XG4gICAgICogQHBhcmFtIGF0dHJFbmRcbiAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBncm91cFNjYW4obm9kZSwgYXR0clN0YXJ0LCBhdHRyRW5kKSB7XG4gICAgICB2YXIgbm9kZXMgPSBbXTtcbiAgICAgIHZhciBkZXB0aCA9IDA7XG4gICAgICBpZiAoYXR0clN0YXJ0ICYmIG5vZGUuaGFzQXR0cmlidXRlICYmIG5vZGUuaGFzQXR0cmlidXRlKGF0dHJTdGFydCkpIHtcbiAgICAgICAgZG8ge1xuICAgICAgICAgIGlmICghbm9kZSkge1xuICAgICAgICAgICAgdGhyb3cgJGNvbXBpbGVNaW5FcnIoJ3V0ZXJkaXInLFxuICAgICAgICAgICAgICAgICAgICAgIFwiVW50ZXJtaW5hdGVkIGF0dHJpYnV0ZSwgZm91bmQgJ3swfScgYnV0IG5vIG1hdGNoaW5nICd7MX0nIGZvdW5kLlwiLFxuICAgICAgICAgICAgICAgICAgICAgIGF0dHJTdGFydCwgYXR0ckVuZCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IE5PREVfVFlQRV9FTEVNRU5UKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5oYXNBdHRyaWJ1dGUoYXR0clN0YXJ0KSkgZGVwdGgrKztcbiAgICAgICAgICAgIGlmIChub2RlLmhhc0F0dHJpYnV0ZShhdHRyRW5kKSkgZGVwdGgtLTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICBub2RlID0gbm9kZS5uZXh0U2libGluZztcbiAgICAgICAgfSB3aGlsZSAoZGVwdGggPiAwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vZGVzLnB1c2gobm9kZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBqcUxpdGUobm9kZXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdyYXBwZXIgZm9yIGxpbmtpbmcgZnVuY3Rpb24gd2hpY2ggY29udmVydHMgbm9ybWFsIGxpbmtpbmcgZnVuY3Rpb24gaW50byBhIGdyb3VwZWRcbiAgICAgKiBsaW5raW5nIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSBsaW5rRm5cbiAgICAgKiBAcGFyYW0gYXR0clN0YXJ0XG4gICAgICogQHBhcmFtIGF0dHJFbmRcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259XG4gICAgICovXG4gICAgZnVuY3Rpb24gZ3JvdXBFbGVtZW50c0xpbmtGbldyYXBwZXIobGlua0ZuLCBhdHRyU3RhcnQsIGF0dHJFbmQpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIGNvbnRyb2xsZXJzLCB0cmFuc2NsdWRlRm4pIHtcbiAgICAgICAgZWxlbWVudCA9IGdyb3VwU2NhbihlbGVtZW50WzBdLCBhdHRyU3RhcnQsIGF0dHJFbmQpO1xuICAgICAgICByZXR1cm4gbGlua0ZuKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY29udHJvbGxlcnMsIHRyYW5zY2x1ZGVGbik7XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gZ2VuZXJhdG9yIHRoYXQgaXMgdXNlZCB0byBzdXBwb3J0IGJvdGggZWFnZXIgYW5kIGxhenkgY29tcGlsYXRpb25cbiAgICAgKiBsaW5raW5nIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSBlYWdlclxuICAgICAqIEBwYXJhbSAkY29tcGlsZU5vZGVzXG4gICAgICogQHBhcmFtIHRyYW5zY2x1ZGVGblxuICAgICAqIEBwYXJhbSBtYXhQcmlvcml0eVxuICAgICAqIEBwYXJhbSBpZ25vcmVEaXJlY3RpdmVcbiAgICAgKiBAcGFyYW0gcHJldmlvdXNDb21waWxlQ29udGV4dFxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21waWxhdGlvbkdlbmVyYXRvcihlYWdlciwgJGNvbXBpbGVOb2RlcywgdHJhbnNjbHVkZUZuLCBtYXhQcmlvcml0eSwgaWdub3JlRGlyZWN0aXZlLCBwcmV2aW91c0NvbXBpbGVDb250ZXh0KSB7XG4gICAgICAgIGlmIChlYWdlcikge1xuICAgICAgICAgICAgcmV0dXJuIGNvbXBpbGUoJGNvbXBpbGVOb2RlcywgdHJhbnNjbHVkZUZuLCBtYXhQcmlvcml0eSwgaWdub3JlRGlyZWN0aXZlLCBwcmV2aW91c0NvbXBpbGVDb250ZXh0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBjb21waWxlZDtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIWNvbXBpbGVkKSB7XG4gICAgICAgICAgICAgICAgY29tcGlsZWQgPSBjb21waWxlKCRjb21waWxlTm9kZXMsIHRyYW5zY2x1ZGVGbiwgbWF4UHJpb3JpdHksIGlnbm9yZURpcmVjdGl2ZSwgcHJldmlvdXNDb21waWxlQ29udGV4dCk7XG5cbiAgICAgICAgICAgICAgICAvLyBOdWxsIG91dCBhbGwgb2YgdGhlc2UgcmVmZXJlbmNlcyBpbiBvcmRlciB0byBtYWtlIHRoZW0gZWxpZ2libGUgZm9yIGdhcmJhZ2UgY29sbGVjdGlvblxuICAgICAgICAgICAgICAgIC8vIHNpbmNlIHRoaXMgaXMgYSBwb3RlbnRpYWxseSBsb25nIGxpdmVkIGNsb3N1cmVcbiAgICAgICAgICAgICAgICAkY29tcGlsZU5vZGVzID0gdHJhbnNjbHVkZUZuID0gcHJldmlvdXNDb21waWxlQ29udGV4dCA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBjb21waWxlZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9uY2UgdGhlIGRpcmVjdGl2ZXMgaGF2ZSBiZWVuIGNvbGxlY3RlZCwgdGhlaXIgY29tcGlsZSBmdW5jdGlvbnMgYXJlIGV4ZWN1dGVkLiBUaGlzIG1ldGhvZFxuICAgICAqIGlzIHJlc3BvbnNpYmxlIGZvciBpbmxpbmluZyBkaXJlY3RpdmUgdGVtcGxhdGVzIGFzIHdlbGwgYXMgdGVybWluYXRpbmcgdGhlIGFwcGxpY2F0aW9uXG4gICAgICogb2YgdGhlIGRpcmVjdGl2ZXMgaWYgdGhlIHRlcm1pbmFsIGRpcmVjdGl2ZSBoYXMgYmVlbiByZWFjaGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gZGlyZWN0aXZlcyBBcnJheSBvZiBjb2xsZWN0ZWQgZGlyZWN0aXZlcyB0byBleGVjdXRlIHRoZWlyIGNvbXBpbGUgZnVuY3Rpb24uXG4gICAgICogICAgICAgIHRoaXMgbmVlZHMgdG8gYmUgcHJlLXNvcnRlZCBieSBwcmlvcml0eSBvcmRlci5cbiAgICAgKiBAcGFyYW0ge05vZGV9IGNvbXBpbGVOb2RlIFRoZSByYXcgRE9NIG5vZGUgdG8gYXBwbHkgdGhlIGNvbXBpbGUgZnVuY3Rpb25zIHRvXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHRlbXBsYXRlQXR0cnMgVGhlIHNoYXJlZCBhdHRyaWJ1dGUgZnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGFuZ3VsYXIuU2NvcGUsIGNsb25lQXR0YWNoRm49KX0gdHJhbnNjbHVkZUZuIEEgbGlua2luZyBmdW5jdGlvbiwgd2hlcmUgdGhlXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlIGFyZ3VtZW50IGlzIGF1dG8tZ2VuZXJhdGVkIHRvIHRoZSBuZXdcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQgb2YgdGhlIHRyYW5zY2x1ZGVkIHBhcmVudCBzY29wZS5cbiAgICAgKiBAcGFyYW0ge0pRTGl0ZX0ganFDb2xsZWN0aW9uIElmIHdlIGFyZSB3b3JraW5nIG9uIHRoZSByb290IG9mIHRoZSBjb21waWxlIHRyZWUgdGhlbiB0aGlzXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmd1bWVudCBoYXMgdGhlIHJvb3QganFMaXRlIGFycmF5IHNvIHRoYXQgd2UgY2FuIHJlcGxhY2Ugbm9kZXNcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uIGl0LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0PX0gb3JpZ2luYWxSZXBsYWNlRGlyZWN0aXZlIEFuIG9wdGlvbmFsIGRpcmVjdGl2ZSB0aGF0IHdpbGwgYmUgaWdub3JlZCB3aGVuXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGlsaW5nIHRoZSB0cmFuc2NsdXNpb24uXG4gICAgICogQHBhcmFtIHtBcnJheS48RnVuY3Rpb24+fSBwcmVMaW5rRm5zXG4gICAgICogQHBhcmFtIHtBcnJheS48RnVuY3Rpb24+fSBwb3N0TGlua0Zuc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwcmV2aW91c0NvbXBpbGVDb250ZXh0IENvbnRleHQgdXNlZCBmb3IgcHJldmlvdXMgY29tcGlsYXRpb24gb2YgdGhlIGN1cnJlbnRcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBsaW5rRm5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhcHBseURpcmVjdGl2ZXNUb05vZGUoZGlyZWN0aXZlcywgY29tcGlsZU5vZGUsIHRlbXBsYXRlQXR0cnMsIHRyYW5zY2x1ZGVGbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganFDb2xsZWN0aW9uLCBvcmlnaW5hbFJlcGxhY2VEaXJlY3RpdmUsIHByZUxpbmtGbnMsIHBvc3RMaW5rRm5zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c0NvbXBpbGVDb250ZXh0KSB7XG4gICAgICBwcmV2aW91c0NvbXBpbGVDb250ZXh0ID0gcHJldmlvdXNDb21waWxlQ29udGV4dCB8fCB7fTtcblxuICAgICAgdmFyIHRlcm1pbmFsUHJpb3JpdHkgPSAtTnVtYmVyLk1BWF9WQUxVRSxcbiAgICAgICAgICBuZXdTY29wZURpcmVjdGl2ZSA9IHByZXZpb3VzQ29tcGlsZUNvbnRleHQubmV3U2NvcGVEaXJlY3RpdmUsXG4gICAgICAgICAgY29udHJvbGxlckRpcmVjdGl2ZXMgPSBwcmV2aW91c0NvbXBpbGVDb250ZXh0LmNvbnRyb2xsZXJEaXJlY3RpdmVzLFxuICAgICAgICAgIG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZSA9IHByZXZpb3VzQ29tcGlsZUNvbnRleHQubmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlLFxuICAgICAgICAgIHRlbXBsYXRlRGlyZWN0aXZlID0gcHJldmlvdXNDb21waWxlQ29udGV4dC50ZW1wbGF0ZURpcmVjdGl2ZSxcbiAgICAgICAgICBub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlID0gcHJldmlvdXNDb21waWxlQ29udGV4dC5ub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlLFxuICAgICAgICAgIGhhc1RyYW5zY2x1ZGVEaXJlY3RpdmUgPSBmYWxzZSxcbiAgICAgICAgICBoYXNUZW1wbGF0ZSA9IGZhbHNlLFxuICAgICAgICAgIGhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlID0gcHJldmlvdXNDb21waWxlQ29udGV4dC5oYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSxcbiAgICAgICAgICAkY29tcGlsZU5vZGUgPSB0ZW1wbGF0ZUF0dHJzLiQkZWxlbWVudCA9IGpxTGl0ZShjb21waWxlTm9kZSksXG4gICAgICAgICAgZGlyZWN0aXZlLFxuICAgICAgICAgIGRpcmVjdGl2ZU5hbWUsXG4gICAgICAgICAgJHRlbXBsYXRlLFxuICAgICAgICAgIHJlcGxhY2VEaXJlY3RpdmUgPSBvcmlnaW5hbFJlcGxhY2VEaXJlY3RpdmUsXG4gICAgICAgICAgY2hpbGRUcmFuc2NsdWRlRm4gPSB0cmFuc2NsdWRlRm4sXG4gICAgICAgICAgbGlua0ZuLFxuICAgICAgICAgIGRpZFNjYW5Gb3JNdWx0aXBsZVRyYW5zY2x1c2lvbiA9IGZhbHNlLFxuICAgICAgICAgIG1pZ2h0SGF2ZU11bHRpcGxlVHJhbnNjbHVzaW9uRXJyb3IgPSBmYWxzZSxcbiAgICAgICAgICBkaXJlY3RpdmVWYWx1ZTtcblxuICAgICAgLy8gZXhlY3V0ZXMgYWxsIGRpcmVjdGl2ZXMgb24gdGhlIGN1cnJlbnQgZWxlbWVudFxuICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gZGlyZWN0aXZlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgIGRpcmVjdGl2ZSA9IGRpcmVjdGl2ZXNbaV07XG4gICAgICAgIHZhciBhdHRyU3RhcnQgPSBkaXJlY3RpdmUuJCRzdGFydDtcbiAgICAgICAgdmFyIGF0dHJFbmQgPSBkaXJlY3RpdmUuJCRlbmQ7XG5cbiAgICAgICAgLy8gY29sbGVjdCBtdWx0aWJsb2NrIHNlY3Rpb25zXG4gICAgICAgIGlmIChhdHRyU3RhcnQpIHtcbiAgICAgICAgICAkY29tcGlsZU5vZGUgPSBncm91cFNjYW4oY29tcGlsZU5vZGUsIGF0dHJTdGFydCwgYXR0ckVuZCk7XG4gICAgICAgIH1cbiAgICAgICAgJHRlbXBsYXRlID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIGlmICh0ZXJtaW5hbFByaW9yaXR5ID4gZGlyZWN0aXZlLnByaW9yaXR5KSB7XG4gICAgICAgICAgYnJlYWs7IC8vIHByZXZlbnQgZnVydGhlciBwcm9jZXNzaW5nIG9mIGRpcmVjdGl2ZXNcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkaXJlY3RpdmVWYWx1ZSA9IGRpcmVjdGl2ZS5zY29wZSkge1xuXG4gICAgICAgICAgLy8gc2tpcCB0aGUgY2hlY2sgZm9yIGRpcmVjdGl2ZXMgd2l0aCBhc3luYyB0ZW1wbGF0ZXMsIHdlJ2xsIGNoZWNrIHRoZSBkZXJpdmVkIHN5bmNcbiAgICAgICAgICAvLyBkaXJlY3RpdmUgd2hlbiB0aGUgdGVtcGxhdGUgYXJyaXZlc1xuICAgICAgICAgIGlmICghZGlyZWN0aXZlLnRlbXBsYXRlVXJsKSB7XG4gICAgICAgICAgICBpZiAoaXNPYmplY3QoZGlyZWN0aXZlVmFsdWUpKSB7XG4gICAgICAgICAgICAgIC8vIFRoaXMgZGlyZWN0aXZlIGlzIHRyeWluZyB0byBhZGQgYW4gaXNvbGF0ZWQgc2NvcGUuXG4gICAgICAgICAgICAgIC8vIENoZWNrIHRoYXQgdGhlcmUgaXMgbm8gc2NvcGUgb2YgYW55IGtpbmQgYWxyZWFkeVxuICAgICAgICAgICAgICBhc3NlcnROb0R1cGxpY2F0ZSgnbmV3L2lzb2xhdGVkIHNjb3BlJywgbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlIHx8IG5ld1Njb3BlRGlyZWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3RpdmUsICRjb21waWxlTm9kZSk7XG4gICAgICAgICAgICAgIG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZSA9IGRpcmVjdGl2ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIFRoaXMgZGlyZWN0aXZlIGlzIHRyeWluZyB0byBhZGQgYSBjaGlsZCBzY29wZS5cbiAgICAgICAgICAgICAgLy8gQ2hlY2sgdGhhdCB0aGVyZSBpcyBubyBpc29sYXRlZCBzY29wZSBhbHJlYWR5XG4gICAgICAgICAgICAgIGFzc2VydE5vRHVwbGljYXRlKCduZXcvaXNvbGF0ZWQgc2NvcGUnLCBuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUsIGRpcmVjdGl2ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvbXBpbGVOb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBuZXdTY29wZURpcmVjdGl2ZSA9IG5ld1Njb3BlRGlyZWN0aXZlIHx8IGRpcmVjdGl2ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRpcmVjdGl2ZU5hbWUgPSBkaXJlY3RpdmUubmFtZTtcblxuICAgICAgICAvLyBJZiB3ZSBlbmNvdW50ZXIgYSBjb25kaXRpb24gdGhhdCBjYW4gcmVzdWx0IGluIHRyYW5zY2x1c2lvbiBvbiB0aGUgZGlyZWN0aXZlLFxuICAgICAgICAvLyB0aGVuIHNjYW4gYWhlYWQgaW4gdGhlIHJlbWFpbmluZyBkaXJlY3RpdmVzIGZvciBvdGhlcnMgdGhhdCBtYXkgY2F1c2UgYSBtdWx0aXBsZVxuICAgICAgICAvLyB0cmFuc2NsdXNpb24gZXJyb3IgdG8gYmUgdGhyb3duIGR1cmluZyB0aGUgY29tcGlsYXRpb24gcHJvY2Vzcy4gIElmIGEgbWF0Y2hpbmcgZGlyZWN0aXZlXG4gICAgICAgIC8vIGlzIGZvdW5kLCB0aGVuIHdlIGtub3cgdGhhdCB3aGVuIHdlIGVuY291bnRlciBhIHRyYW5zY2x1ZGVkIGRpcmVjdGl2ZSwgd2UgbmVlZCB0byBlYWdlcmx5XG4gICAgICAgIC8vIGNvbXBpbGUgdGhlIGB0cmFuc2NsdWRlYCBmdW5jdGlvbiByYXRoZXIgdGhhbiBkb2luZyBpdCBsYXppbHkgaW4gb3JkZXIgdG8gdGhyb3dcbiAgICAgICAgLy8gZXhjZXB0aW9ucyBhdCB0aGUgY29ycmVjdCB0aW1lXG4gICAgICAgIGlmICghZGlkU2NhbkZvck11bHRpcGxlVHJhbnNjbHVzaW9uICYmICgoZGlyZWN0aXZlLnJlcGxhY2UgJiYgKGRpcmVjdGl2ZS50ZW1wbGF0ZVVybCB8fCBkaXJlY3RpdmUudGVtcGxhdGUpKVxuICAgICAgICAgICAgfHwgKGRpcmVjdGl2ZS50cmFuc2NsdWRlICYmICFkaXJlY3RpdmUuJCR0bGIpKSkge1xuICAgICAgICAgICAgICAgIHZhciBjYW5kaWRhdGVEaXJlY3RpdmU7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBzY2FubmluZ0luZGV4ID0gaSArIDE7IGNhbmRpZGF0ZURpcmVjdGl2ZSA9IGRpcmVjdGl2ZXNbc2Nhbm5pbmdJbmRleCsrXTspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChjYW5kaWRhdGVEaXJlY3RpdmUudHJhbnNjbHVkZSAmJiAhY2FuZGlkYXRlRGlyZWN0aXZlLiQkdGxiKVxuICAgICAgICAgICAgICAgICAgICAgICAgfHwgKGNhbmRpZGF0ZURpcmVjdGl2ZS5yZXBsYWNlICYmIChjYW5kaWRhdGVEaXJlY3RpdmUudGVtcGxhdGVVcmwgfHwgY2FuZGlkYXRlRGlyZWN0aXZlLnRlbXBsYXRlKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pZ2h0SGF2ZU11bHRpcGxlVHJhbnNjbHVzaW9uRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBkaWRTY2FuRm9yTXVsdGlwbGVUcmFuc2NsdXNpb24gPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFkaXJlY3RpdmUudGVtcGxhdGVVcmwgJiYgZGlyZWN0aXZlLmNvbnRyb2xsZXIpIHtcbiAgICAgICAgICBkaXJlY3RpdmVWYWx1ZSA9IGRpcmVjdGl2ZS5jb250cm9sbGVyO1xuICAgICAgICAgIGNvbnRyb2xsZXJEaXJlY3RpdmVzID0gY29udHJvbGxlckRpcmVjdGl2ZXMgfHwgY3JlYXRlTWFwKCk7XG4gICAgICAgICAgYXNzZXJ0Tm9EdXBsaWNhdGUoXCInXCIgKyBkaXJlY3RpdmVOYW1lICsgXCInIGNvbnRyb2xsZXJcIixcbiAgICAgICAgICAgICAgY29udHJvbGxlckRpcmVjdGl2ZXNbZGlyZWN0aXZlTmFtZV0sIGRpcmVjdGl2ZSwgJGNvbXBpbGVOb2RlKTtcbiAgICAgICAgICBjb250cm9sbGVyRGlyZWN0aXZlc1tkaXJlY3RpdmVOYW1lXSA9IGRpcmVjdGl2ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkaXJlY3RpdmVWYWx1ZSA9IGRpcmVjdGl2ZS50cmFuc2NsdWRlKSB7XG4gICAgICAgICAgaGFzVHJhbnNjbHVkZURpcmVjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UgbmdJZiBhbmQgbmdSZXBlYXQgc28gdGhhdCB3ZSBkb24ndCBjb21wbGFpbiBhYm91dCBkdXBsaWNhdGUgdHJhbnNjbHVzaW9uLlxuICAgICAgICAgIC8vIFRoaXMgb3B0aW9uIHNob3VsZCBvbmx5IGJlIHVzZWQgYnkgZGlyZWN0aXZlcyB0aGF0IGtub3cgaG93IHRvIHNhZmVseSBoYW5kbGUgZWxlbWVudCB0cmFuc2NsdXNpb24sXG4gICAgICAgICAgLy8gd2hlcmUgdGhlIHRyYW5zY2x1ZGVkIG5vZGVzIGFyZSBhZGRlZCBvciByZXBsYWNlZCBhZnRlciBsaW5raW5nLlxuICAgICAgICAgIGlmICghZGlyZWN0aXZlLiQkdGxiKSB7XG4gICAgICAgICAgICBhc3NlcnROb0R1cGxpY2F0ZSgndHJhbnNjbHVzaW9uJywgbm9uVGxiVHJhbnNjbHVkZURpcmVjdGl2ZSwgZGlyZWN0aXZlLCAkY29tcGlsZU5vZGUpO1xuICAgICAgICAgICAgbm9uVGxiVHJhbnNjbHVkZURpcmVjdGl2ZSA9IGRpcmVjdGl2ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoZGlyZWN0aXZlVmFsdWUgPT0gJ2VsZW1lbnQnKSB7XG4gICAgICAgICAgICBoYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0ZXJtaW5hbFByaW9yaXR5ID0gZGlyZWN0aXZlLnByaW9yaXR5O1xuICAgICAgICAgICAgJHRlbXBsYXRlID0gJGNvbXBpbGVOb2RlO1xuICAgICAgICAgICAgJGNvbXBpbGVOb2RlID0gdGVtcGxhdGVBdHRycy4kJGVsZW1lbnQgPVxuICAgICAgICAgICAgICAgIGpxTGl0ZShkb2N1bWVudC5jcmVhdGVDb21tZW50KCcgJyArIGRpcmVjdGl2ZU5hbWUgKyAnOiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZUF0dHJzW2RpcmVjdGl2ZU5hbWVdICsgJyAnKSk7XG4gICAgICAgICAgICBjb21waWxlTm9kZSA9ICRjb21waWxlTm9kZVswXTtcbiAgICAgICAgICAgIHJlcGxhY2VXaXRoKGpxQ29sbGVjdGlvbiwgc2xpY2VBcmdzKCR0ZW1wbGF0ZSksIGNvbXBpbGVOb2RlKTtcblxuICAgICAgICAgICAgY2hpbGRUcmFuc2NsdWRlRm4gPSBjb21waWxhdGlvbkdlbmVyYXRvcihtaWdodEhhdmVNdWx0aXBsZVRyYW5zY2x1c2lvbkVycm9yLCAkdGVtcGxhdGUsIHRyYW5zY2x1ZGVGbiwgdGVybWluYWxQcmlvcml0eSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlRGlyZWN0aXZlICYmIHJlcGxhY2VEaXJlY3RpdmUubmFtZSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG9uJ3QgcGFzcyBpbjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIC0gY29udHJvbGxlckRpcmVjdGl2ZXMgLSBvdGhlcndpc2Ugd2UnbGwgY3JlYXRlIGR1cGxpY2F0ZXMgY29udHJvbGxlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIC0gbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlIG9yIHRlbXBsYXRlRGlyZWN0aXZlIC0gY29tYmluaW5nIHRlbXBsYXRlcyB3aXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGVsZW1lbnQgdHJhbnNjbHVzaW9uIGRvZXNuJ3QgbWFrZSBzZW5zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIG9ubHkgbm9uVGxiVHJhbnNjbHVkZURpcmVjdGl2ZSBzbyB0aGF0IHdlIHByZXZlbnQgcHV0dGluZyB0cmFuc2NsdXNpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uIHRoZSBzYW1lIGVsZW1lbnQgbW9yZSB0aGFuIG9uY2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlOiBub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgdmFyIHNsb3RzID0gY3JlYXRlTWFwKCk7XG5cbiAgICAgICAgICAgICR0ZW1wbGF0ZSA9IGpxTGl0ZShqcUxpdGVDbG9uZShjb21waWxlTm9kZSkpLmNvbnRlbnRzKCk7XG5cbiAgICAgICAgICAgIGlmIChpc09iamVjdChkaXJlY3RpdmVWYWx1ZSkpIHtcblxuICAgICAgICAgICAgICAvLyBXZSBoYXZlIHRyYW5zY2x1c2lvbiBzbG90cyxcbiAgICAgICAgICAgICAgLy8gY29sbGVjdCB0aGVtIHVwLCBjb21waWxlIHRoZW0gYW5kIHN0b3JlIHRoZWlyIHRyYW5zY2x1c2lvbiBmdW5jdGlvbnNcbiAgICAgICAgICAgICAgJHRlbXBsYXRlID0gW107XG5cbiAgICAgICAgICAgICAgdmFyIHNsb3RNYXAgPSBjcmVhdGVNYXAoKTtcbiAgICAgICAgICAgICAgdmFyIGZpbGxlZFNsb3RzID0gY3JlYXRlTWFwKCk7XG5cbiAgICAgICAgICAgICAgLy8gUGFyc2UgdGhlIGVsZW1lbnQgc2VsZWN0b3JzXG4gICAgICAgICAgICAgIGZvckVhY2goZGlyZWN0aXZlVmFsdWUsIGZ1bmN0aW9uKGVsZW1lbnRTZWxlY3Rvciwgc2xvdE5hbWUpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBhbiBlbGVtZW50IHNlbGVjdG9yIHN0YXJ0cyB3aXRoIGEgPyB0aGVuIGl0IGlzIG9wdGlvbmFsXG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbmFsID0gKGVsZW1lbnRTZWxlY3Rvci5jaGFyQXQoMCkgPT09ICc/Jyk7XG4gICAgICAgICAgICAgICAgZWxlbWVudFNlbGVjdG9yID0gb3B0aW9uYWwgPyBlbGVtZW50U2VsZWN0b3Iuc3Vic3RyaW5nKDEpIDogZWxlbWVudFNlbGVjdG9yO1xuXG4gICAgICAgICAgICAgICAgc2xvdE1hcFtlbGVtZW50U2VsZWN0b3JdID0gc2xvdE5hbWU7XG5cbiAgICAgICAgICAgICAgICAvLyBXZSBleHBsaWNpdGx5IGFzc2lnbiBgbnVsbGAgc2luY2UgdGhpcyBpbXBsaWVzIHRoYXQgYSBzbG90IHdhcyBkZWZpbmVkIGJ1dCBub3QgZmlsbGVkLlxuICAgICAgICAgICAgICAgIC8vIExhdGVyIHdoZW4gY2FsbGluZyBib3VuZFRyYW5zY2x1c2lvbiBmdW5jdGlvbnMgd2l0aCBhIHNsb3QgbmFtZSB3ZSBvbmx5IGVycm9yIGlmIHRoZVxuICAgICAgICAgICAgICAgIC8vIHNsb3QgaXMgYHVuZGVmaW5lZGBcbiAgICAgICAgICAgICAgICBzbG90c1tzbG90TmFtZV0gPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgLy8gZmlsbGVkU2xvdHMgY29udGFpbnMgYHRydWVgIGZvciBhbGwgc2xvdHMgdGhhdCBhcmUgZWl0aGVyIG9wdGlvbmFsIG9yIGhhdmUgYmVlblxuICAgICAgICAgICAgICAgIC8vIGZpbGxlZC4gVGhpcyBpcyB1c2VkIHRvIGNoZWNrIHRoYXQgd2UgaGF2ZSBub3QgbWlzc2VkIGFueSByZXF1aXJlZCBzbG90c1xuICAgICAgICAgICAgICAgIGZpbGxlZFNsb3RzW3Nsb3ROYW1lXSA9IG9wdGlvbmFsO1xuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAvLyBBZGQgdGhlIG1hdGNoaW5nIGVsZW1lbnRzIGludG8gdGhlaXIgc2xvdFxuICAgICAgICAgICAgICBmb3JFYWNoKCRjb21waWxlTm9kZS5jb250ZW50cygpLCBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNsb3ROYW1lID0gc2xvdE1hcFtkaXJlY3RpdmVOb3JtYWxpemUobm9kZU5hbWVfKG5vZGUpKV07XG4gICAgICAgICAgICAgICAgaWYgKHNsb3ROYW1lKSB7XG4gICAgICAgICAgICAgICAgICBmaWxsZWRTbG90c1tzbG90TmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgc2xvdHNbc2xvdE5hbWVdID0gc2xvdHNbc2xvdE5hbWVdIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgc2xvdHNbc2xvdE5hbWVdLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICR0ZW1wbGF0ZS5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIHJlcXVpcmVkIHNsb3RzIHRoYXQgd2VyZSBub3QgZmlsbGVkXG4gICAgICAgICAgICAgIGZvckVhY2goZmlsbGVkU2xvdHMsIGZ1bmN0aW9uKGZpbGxlZCwgc2xvdE5hbWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWZpbGxlZCkge1xuICAgICAgICAgICAgICAgICAgdGhyb3cgJGNvbXBpbGVNaW5FcnIoJ3JlcXNsb3QnLCAnUmVxdWlyZWQgdHJhbnNjbHVzaW9uIHNsb3QgYHswfWAgd2FzIG5vdCBmaWxsZWQuJywgc2xvdE5hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgc2xvdE5hbWUgaW4gc2xvdHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2xvdHNbc2xvdE5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAvLyBPbmx5IGRlZmluZSBhIHRyYW5zY2x1c2lvbiBmdW5jdGlvbiBpZiB0aGUgc2xvdCB3YXMgZmlsbGVkXG4gICAgICAgICAgICAgICAgICBzbG90c1tzbG90TmFtZV0gPSBjb21waWxhdGlvbkdlbmVyYXRvcihtaWdodEhhdmVNdWx0aXBsZVRyYW5zY2x1c2lvbkVycm9yLCBzbG90c1tzbG90TmFtZV0sIHRyYW5zY2x1ZGVGbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRjb21waWxlTm9kZS5lbXB0eSgpOyAvLyBjbGVhciBjb250ZW50c1xuICAgICAgICAgICAgY2hpbGRUcmFuc2NsdWRlRm4gPSBjb21waWxhdGlvbkdlbmVyYXRvcihtaWdodEhhdmVNdWx0aXBsZVRyYW5zY2x1c2lvbkVycm9yLCAkdGVtcGxhdGUsIHRyYW5zY2x1ZGVGbiwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZCwgeyBuZWVkc05ld1Njb3BlOiBkaXJlY3RpdmUuJCRpc29sYXRlU2NvcGUgfHwgZGlyZWN0aXZlLiQkbmV3U2NvcGV9KTtcbiAgICAgICAgICAgIGNoaWxkVHJhbnNjbHVkZUZuLiQkc2xvdHMgPSBzbG90cztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGlyZWN0aXZlLnRlbXBsYXRlKSB7XG4gICAgICAgICAgaGFzVGVtcGxhdGUgPSB0cnVlO1xuICAgICAgICAgIGFzc2VydE5vRHVwbGljYXRlKCd0ZW1wbGF0ZScsIHRlbXBsYXRlRGlyZWN0aXZlLCBkaXJlY3RpdmUsICRjb21waWxlTm9kZSk7XG4gICAgICAgICAgdGVtcGxhdGVEaXJlY3RpdmUgPSBkaXJlY3RpdmU7XG5cbiAgICAgICAgICBkaXJlY3RpdmVWYWx1ZSA9IChpc0Z1bmN0aW9uKGRpcmVjdGl2ZS50ZW1wbGF0ZSkpXG4gICAgICAgICAgICAgID8gZGlyZWN0aXZlLnRlbXBsYXRlKCRjb21waWxlTm9kZSwgdGVtcGxhdGVBdHRycylcbiAgICAgICAgICAgICAgOiBkaXJlY3RpdmUudGVtcGxhdGU7XG5cbiAgICAgICAgICBkaXJlY3RpdmVWYWx1ZSA9IGRlbm9ybWFsaXplVGVtcGxhdGUoZGlyZWN0aXZlVmFsdWUpO1xuXG4gICAgICAgICAgaWYgKGRpcmVjdGl2ZS5yZXBsYWNlKSB7XG4gICAgICAgICAgICByZXBsYWNlRGlyZWN0aXZlID0gZGlyZWN0aXZlO1xuICAgICAgICAgICAgaWYgKGpxTGl0ZUlzVGV4dE5vZGUoZGlyZWN0aXZlVmFsdWUpKSB7XG4gICAgICAgICAgICAgICR0ZW1wbGF0ZSA9IFtdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgJHRlbXBsYXRlID0gcmVtb3ZlQ29tbWVudHMod3JhcFRlbXBsYXRlKGRpcmVjdGl2ZS50ZW1wbGF0ZU5hbWVzcGFjZSwgdHJpbShkaXJlY3RpdmVWYWx1ZSkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbXBpbGVOb2RlID0gJHRlbXBsYXRlWzBdO1xuXG4gICAgICAgICAgICBpZiAoJHRlbXBsYXRlLmxlbmd0aCAhPSAxIHx8IGNvbXBpbGVOb2RlLm5vZGVUeXBlICE9PSBOT0RFX1RZUEVfRUxFTUVOVCkge1xuICAgICAgICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycigndHBscnQnLFxuICAgICAgICAgICAgICAgICAgXCJUZW1wbGF0ZSBmb3IgZGlyZWN0aXZlICd7MH0nIG11c3QgaGF2ZSBleGFjdGx5IG9uZSByb290IGVsZW1lbnQuIHsxfVwiLFxuICAgICAgICAgICAgICAgICAgZGlyZWN0aXZlTmFtZSwgJycpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXBsYWNlV2l0aChqcUNvbGxlY3Rpb24sICRjb21waWxlTm9kZSwgY29tcGlsZU5vZGUpO1xuXG4gICAgICAgICAgICB2YXIgbmV3VGVtcGxhdGVBdHRycyA9IHskYXR0cjoge319O1xuXG4gICAgICAgICAgICAvLyBjb21iaW5lIGRpcmVjdGl2ZXMgZnJvbSB0aGUgb3JpZ2luYWwgbm9kZSBhbmQgZnJvbSB0aGUgdGVtcGxhdGU6XG4gICAgICAgICAgICAvLyAtIHRha2UgdGhlIGFycmF5IG9mIGRpcmVjdGl2ZXMgZm9yIHRoaXMgZWxlbWVudFxuICAgICAgICAgICAgLy8gLSBzcGxpdCBpdCBpbnRvIHR3byBwYXJ0cywgdGhvc2UgdGhhdCBhbHJlYWR5IGFwcGxpZWQgKHByb2Nlc3NlZCkgYW5kIHRob3NlIHRoYXQgd2VyZW4ndCAodW5wcm9jZXNzZWQpXG4gICAgICAgICAgICAvLyAtIGNvbGxlY3QgZGlyZWN0aXZlcyBmcm9tIHRoZSB0ZW1wbGF0ZSBhbmQgc29ydCB0aGVtIGJ5IHByaW9yaXR5XG4gICAgICAgICAgICAvLyAtIGNvbWJpbmUgZGlyZWN0aXZlcyBhczogcHJvY2Vzc2VkICsgdGVtcGxhdGUgKyB1bnByb2Nlc3NlZFxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlRGlyZWN0aXZlcyA9IGNvbGxlY3REaXJlY3RpdmVzKGNvbXBpbGVOb2RlLCBbXSwgbmV3VGVtcGxhdGVBdHRycyk7XG4gICAgICAgICAgICB2YXIgdW5wcm9jZXNzZWREaXJlY3RpdmVzID0gZGlyZWN0aXZlcy5zcGxpY2UoaSArIDEsIGRpcmVjdGl2ZXMubGVuZ3RoIC0gKGkgKyAxKSk7XG5cbiAgICAgICAgICAgIGlmIChuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUgfHwgbmV3U2NvcGVEaXJlY3RpdmUpIHtcbiAgICAgICAgICAgICAgLy8gVGhlIG9yaWdpbmFsIGRpcmVjdGl2ZSBjYXVzZWQgdGhlIGN1cnJlbnQgZWxlbWVudCB0byBiZSByZXBsYWNlZCBidXQgdGhpcyBlbGVtZW50XG4gICAgICAgICAgICAgIC8vIGFsc28gbmVlZHMgdG8gaGF2ZSBhIG5ldyBzY29wZSwgc28gd2UgbmVlZCB0byB0ZWxsIHRoZSB0ZW1wbGF0ZSBkaXJlY3RpdmVzXG4gICAgICAgICAgICAgIC8vIHRoYXQgdGhleSB3b3VsZCBuZWVkIHRvIGdldCB0aGVpciBzY29wZSBmcm9tIGZ1cnRoZXIgdXAsIGlmIHRoZXkgcmVxdWlyZSB0cmFuc2NsdXNpb25cbiAgICAgICAgICAgICAgbWFya0RpcmVjdGl2ZVNjb3BlKHRlbXBsYXRlRGlyZWN0aXZlcywgbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlLCBuZXdTY29wZURpcmVjdGl2ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkaXJlY3RpdmVzID0gZGlyZWN0aXZlcy5jb25jYXQodGVtcGxhdGVEaXJlY3RpdmVzKS5jb25jYXQodW5wcm9jZXNzZWREaXJlY3RpdmVzKTtcbiAgICAgICAgICAgIG1lcmdlVGVtcGxhdGVBdHRyaWJ1dGVzKHRlbXBsYXRlQXR0cnMsIG5ld1RlbXBsYXRlQXR0cnMpO1xuXG4gICAgICAgICAgICBpaSA9IGRpcmVjdGl2ZXMubGVuZ3RoO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkY29tcGlsZU5vZGUuaHRtbChkaXJlY3RpdmVWYWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRpcmVjdGl2ZS50ZW1wbGF0ZVVybCkge1xuICAgICAgICAgIGhhc1RlbXBsYXRlID0gdHJ1ZTtcbiAgICAgICAgICBhc3NlcnROb0R1cGxpY2F0ZSgndGVtcGxhdGUnLCB0ZW1wbGF0ZURpcmVjdGl2ZSwgZGlyZWN0aXZlLCAkY29tcGlsZU5vZGUpO1xuICAgICAgICAgIHRlbXBsYXRlRGlyZWN0aXZlID0gZGlyZWN0aXZlO1xuXG4gICAgICAgICAgaWYgKGRpcmVjdGl2ZS5yZXBsYWNlKSB7XG4gICAgICAgICAgICByZXBsYWNlRGlyZWN0aXZlID0gZGlyZWN0aXZlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIG5vZGVMaW5rRm4gPSBjb21waWxlVGVtcGxhdGVVcmwoZGlyZWN0aXZlcy5zcGxpY2UoaSwgZGlyZWN0aXZlcy5sZW5ndGggLSBpKSwgJGNvbXBpbGVOb2RlLFxuICAgICAgICAgICAgICB0ZW1wbGF0ZUF0dHJzLCBqcUNvbGxlY3Rpb24sIGhhc1RyYW5zY2x1ZGVEaXJlY3RpdmUgJiYgY2hpbGRUcmFuc2NsdWRlRm4sIHByZUxpbmtGbnMsIHBvc3RMaW5rRm5zLCB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlckRpcmVjdGl2ZXM6IGNvbnRyb2xsZXJEaXJlY3RpdmVzLFxuICAgICAgICAgICAgICAgIG5ld1Njb3BlRGlyZWN0aXZlOiAobmV3U2NvcGVEaXJlY3RpdmUgIT09IGRpcmVjdGl2ZSkgJiYgbmV3U2NvcGVEaXJlY3RpdmUsXG4gICAgICAgICAgICAgICAgbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlOiBuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVEaXJlY3RpdmU6IHRlbXBsYXRlRGlyZWN0aXZlLFxuICAgICAgICAgICAgICAgIG5vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmU6IG5vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmVcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgaWkgPSBkaXJlY3RpdmVzLmxlbmd0aDtcbiAgICAgICAgfSBlbHNlIGlmIChkaXJlY3RpdmUuY29tcGlsZSkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsaW5rRm4gPSBkaXJlY3RpdmUuY29tcGlsZSgkY29tcGlsZU5vZGUsIHRlbXBsYXRlQXR0cnMsIGNoaWxkVHJhbnNjbHVkZUZuKTtcbiAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGxpbmtGbikpIHtcbiAgICAgICAgICAgICAgYWRkTGlua0ZucyhudWxsLCBsaW5rRm4sIGF0dHJTdGFydCwgYXR0ckVuZCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmtGbikge1xuICAgICAgICAgICAgICBhZGRMaW5rRm5zKGxpbmtGbi5wcmUsIGxpbmtGbi5wb3N0LCBhdHRyU3RhcnQsIGF0dHJFbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICRleGNlcHRpb25IYW5kbGVyKGUsIHN0YXJ0aW5nVGFnKCRjb21waWxlTm9kZSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkaXJlY3RpdmUudGVybWluYWwpIHtcbiAgICAgICAgICBub2RlTGlua0ZuLnRlcm1pbmFsID0gdHJ1ZTtcbiAgICAgICAgICB0ZXJtaW5hbFByaW9yaXR5ID0gTWF0aC5tYXgodGVybWluYWxQcmlvcml0eSwgZGlyZWN0aXZlLnByaW9yaXR5KTtcbiAgICAgICAgfVxuXG4gICAgICB9XG5cbiAgICAgIG5vZGVMaW5rRm4uc2NvcGUgPSBuZXdTY29wZURpcmVjdGl2ZSAmJiBuZXdTY29wZURpcmVjdGl2ZS5zY29wZSA9PT0gdHJ1ZTtcbiAgICAgIG5vZGVMaW5rRm4udHJhbnNjbHVkZU9uVGhpc0VsZW1lbnQgPSBoYXNUcmFuc2NsdWRlRGlyZWN0aXZlO1xuICAgICAgbm9kZUxpbmtGbi50ZW1wbGF0ZU9uVGhpc0VsZW1lbnQgPSBoYXNUZW1wbGF0ZTtcbiAgICAgIG5vZGVMaW5rRm4udHJhbnNjbHVkZSA9IGNoaWxkVHJhbnNjbHVkZUZuO1xuXG4gICAgICBwcmV2aW91c0NvbXBpbGVDb250ZXh0Lmhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlID0gaGFzRWxlbWVudFRyYW5zY2x1ZGVEaXJlY3RpdmU7XG5cbiAgICAgIC8vIG1pZ2h0IGJlIG5vcm1hbCBvciBkZWxheWVkIG5vZGVMaW5rRm4gZGVwZW5kaW5nIG9uIGlmIHRlbXBsYXRlVXJsIGlzIHByZXNlbnRcbiAgICAgIHJldHVybiBub2RlTGlua0ZuO1xuXG4gICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICBmdW5jdGlvbiBhZGRMaW5rRm5zKHByZSwgcG9zdCwgYXR0clN0YXJ0LCBhdHRyRW5kKSB7XG4gICAgICAgIGlmIChwcmUpIHtcbiAgICAgICAgICBpZiAoYXR0clN0YXJ0KSBwcmUgPSBncm91cEVsZW1lbnRzTGlua0ZuV3JhcHBlcihwcmUsIGF0dHJTdGFydCwgYXR0ckVuZCk7XG4gICAgICAgICAgcHJlLnJlcXVpcmUgPSBkaXJlY3RpdmUucmVxdWlyZTtcbiAgICAgICAgICBwcmUuZGlyZWN0aXZlTmFtZSA9IGRpcmVjdGl2ZU5hbWU7XG4gICAgICAgICAgaWYgKG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZSA9PT0gZGlyZWN0aXZlIHx8IGRpcmVjdGl2ZS4kJGlzb2xhdGVTY29wZSkge1xuICAgICAgICAgICAgcHJlID0gY2xvbmVBbmRBbm5vdGF0ZUZuKHByZSwge2lzb2xhdGVTY29wZTogdHJ1ZX0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwcmVMaW5rRm5zLnB1c2gocHJlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocG9zdCkge1xuICAgICAgICAgIGlmIChhdHRyU3RhcnQpIHBvc3QgPSBncm91cEVsZW1lbnRzTGlua0ZuV3JhcHBlcihwb3N0LCBhdHRyU3RhcnQsIGF0dHJFbmQpO1xuICAgICAgICAgIHBvc3QucmVxdWlyZSA9IGRpcmVjdGl2ZS5yZXF1aXJlO1xuICAgICAgICAgIHBvc3QuZGlyZWN0aXZlTmFtZSA9IGRpcmVjdGl2ZU5hbWU7XG4gICAgICAgICAgaWYgKG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZSA9PT0gZGlyZWN0aXZlIHx8IGRpcmVjdGl2ZS4kJGlzb2xhdGVTY29wZSkge1xuICAgICAgICAgICAgcG9zdCA9IGNsb25lQW5kQW5ub3RhdGVGbihwb3N0LCB7aXNvbGF0ZVNjb3BlOiB0cnVlfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHBvc3RMaW5rRm5zLnB1c2gocG9zdCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuXG4gICAgICBmdW5jdGlvbiBnZXRDb250cm9sbGVycyhkaXJlY3RpdmVOYW1lLCByZXF1aXJlLCAkZWxlbWVudCwgZWxlbWVudENvbnRyb2xsZXJzKSB7XG4gICAgICAgIHZhciB2YWx1ZTtcblxuICAgICAgICBpZiAoaXNTdHJpbmcocmVxdWlyZSkpIHtcbiAgICAgICAgICB2YXIgbWF0Y2ggPSByZXF1aXJlLm1hdGNoKFJFUVVJUkVfUFJFRklYX1JFR0VYUCk7XG4gICAgICAgICAgdmFyIG5hbWUgPSByZXF1aXJlLnN1YnN0cmluZyhtYXRjaFswXS5sZW5ndGgpO1xuICAgICAgICAgIHZhciBpbmhlcml0VHlwZSA9IG1hdGNoWzFdIHx8IG1hdGNoWzNdO1xuICAgICAgICAgIHZhciBvcHRpb25hbCA9IG1hdGNoWzJdID09PSAnPyc7XG5cbiAgICAgICAgICAvL0lmIG9ubHkgcGFyZW50cyB0aGVuIHN0YXJ0IGF0IHRoZSBwYXJlbnQgZWxlbWVudFxuICAgICAgICAgIGlmIChpbmhlcml0VHlwZSA9PT0gJ15eJykge1xuICAgICAgICAgICAgJGVsZW1lbnQgPSAkZWxlbWVudC5wYXJlbnQoKTtcbiAgICAgICAgICAvL090aGVyd2lzZSBhdHRlbXB0IGdldHRpbmcgdGhlIGNvbnRyb2xsZXIgZnJvbSBlbGVtZW50Q29udHJvbGxlcnMgaW4gY2FzZVxuICAgICAgICAgIC8vdGhlIGVsZW1lbnQgaXMgdHJhbnNjbHVkZWQgKGFuZCBoYXMgbm8gZGF0YSkgYW5kIHRvIGF2b2lkIC5kYXRhIGlmIHBvc3NpYmxlXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlID0gZWxlbWVudENvbnRyb2xsZXJzICYmIGVsZW1lbnRDb250cm9sbGVyc1tuYW1lXTtcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgJiYgdmFsdWUuaW5zdGFuY2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIGRhdGFOYW1lID0gJyQnICsgbmFtZSArICdDb250cm9sbGVyJztcbiAgICAgICAgICAgIHZhbHVlID0gaW5oZXJpdFR5cGUgPyAkZWxlbWVudC5pbmhlcml0ZWREYXRhKGRhdGFOYW1lKSA6ICRlbGVtZW50LmRhdGEoZGF0YU5hbWUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghdmFsdWUgJiYgIW9wdGlvbmFsKSB7XG4gICAgICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycignY3RyZXEnLFxuICAgICAgICAgICAgICAgIFwiQ29udHJvbGxlciAnezB9JywgcmVxdWlyZWQgYnkgZGlyZWN0aXZlICd7MX0nLCBjYW4ndCBiZSBmb3VuZCFcIixcbiAgICAgICAgICAgICAgICBuYW1lLCBkaXJlY3RpdmVOYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoaXNBcnJheShyZXF1aXJlKSkge1xuICAgICAgICAgIHZhbHVlID0gW107XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gcmVxdWlyZS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICB2YWx1ZVtpXSA9IGdldENvbnRyb2xsZXJzKGRpcmVjdGl2ZU5hbWUsIHJlcXVpcmVbaV0sICRlbGVtZW50LCBlbGVtZW50Q29udHJvbGxlcnMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChpc09iamVjdChyZXF1aXJlKSkge1xuICAgICAgICAgIHZhbHVlID0ge307XG4gICAgICAgICAgZm9yRWFjaChyZXF1aXJlLCBmdW5jdGlvbihjb250cm9sbGVyLCBwcm9wZXJ0eSkge1xuICAgICAgICAgICAgdmFsdWVbcHJvcGVydHldID0gZ2V0Q29udHJvbGxlcnMoZGlyZWN0aXZlTmFtZSwgY29udHJvbGxlciwgJGVsZW1lbnQsIGVsZW1lbnRDb250cm9sbGVycyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdmFsdWUgfHwgbnVsbDtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gc2V0dXBDb250cm9sbGVycygkZWxlbWVudCwgYXR0cnMsIHRyYW5zY2x1ZGVGbiwgY29udHJvbGxlckRpcmVjdGl2ZXMsIGlzb2xhdGVTY29wZSwgc2NvcGUpIHtcbiAgICAgICAgdmFyIGVsZW1lbnRDb250cm9sbGVycyA9IGNyZWF0ZU1hcCgpO1xuICAgICAgICBmb3IgKHZhciBjb250cm9sbGVyS2V5IGluIGNvbnRyb2xsZXJEaXJlY3RpdmVzKSB7XG4gICAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IGNvbnRyb2xsZXJEaXJlY3RpdmVzW2NvbnRyb2xsZXJLZXldO1xuICAgICAgICAgIHZhciBsb2NhbHMgPSB7XG4gICAgICAgICAgICAkc2NvcGU6IGRpcmVjdGl2ZSA9PT0gbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlIHx8IGRpcmVjdGl2ZS4kJGlzb2xhdGVTY29wZSA/IGlzb2xhdGVTY29wZSA6IHNjb3BlLFxuICAgICAgICAgICAgJGVsZW1lbnQ6ICRlbGVtZW50LFxuICAgICAgICAgICAgJGF0dHJzOiBhdHRycyxcbiAgICAgICAgICAgICR0cmFuc2NsdWRlOiB0cmFuc2NsdWRlRm5cbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgdmFyIGNvbnRyb2xsZXIgPSBkaXJlY3RpdmUuY29udHJvbGxlcjtcbiAgICAgICAgICBpZiAoY29udHJvbGxlciA9PSAnQCcpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIgPSBhdHRyc1tkaXJlY3RpdmUubmFtZV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIGNvbnRyb2xsZXJJbnN0YW5jZSA9ICRjb250cm9sbGVyKGNvbnRyb2xsZXIsIGxvY2FscywgdHJ1ZSwgZGlyZWN0aXZlLmNvbnRyb2xsZXJBcyk7XG5cbiAgICAgICAgICAvLyBGb3IgZGlyZWN0aXZlcyB3aXRoIGVsZW1lbnQgdHJhbnNjbHVzaW9uIHRoZSBlbGVtZW50IGlzIGEgY29tbWVudCxcbiAgICAgICAgICAvLyBidXQgalF1ZXJ5IC5kYXRhIGRvZXNuJ3Qgc3VwcG9ydCBhdHRhY2hpbmcgZGF0YSB0byBjb21tZW50IG5vZGVzIGFzIGl0J3MgaGFyZCB0b1xuICAgICAgICAgIC8vIGNsZWFuIHVwIChodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC84MzM1KS5cbiAgICAgICAgICAvLyBJbnN0ZWFkLCB3ZSBzYXZlIHRoZSBjb250cm9sbGVycyBmb3IgdGhlIGVsZW1lbnQgaW4gYSBsb2NhbCBoYXNoIGFuZCBhdHRhY2ggdG8gLmRhdGFcbiAgICAgICAgICAvLyBsYXRlciwgb25jZSB3ZSBoYXZlIHRoZSBhY3R1YWwgZWxlbWVudC5cbiAgICAgICAgICBlbGVtZW50Q29udHJvbGxlcnNbZGlyZWN0aXZlLm5hbWVdID0gY29udHJvbGxlckluc3RhbmNlO1xuICAgICAgICAgIGlmICghaGFzRWxlbWVudFRyYW5zY2x1ZGVEaXJlY3RpdmUpIHtcbiAgICAgICAgICAgICRlbGVtZW50LmRhdGEoJyQnICsgZGlyZWN0aXZlLm5hbWUgKyAnQ29udHJvbGxlcicsIGNvbnRyb2xsZXJJbnN0YW5jZS5pbnN0YW5jZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbGVtZW50Q29udHJvbGxlcnM7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG5vZGVMaW5rRm4oY2hpbGRMaW5rRm4sIHNjb3BlLCBsaW5rTm9kZSwgJHJvb3RFbGVtZW50LCBib3VuZFRyYW5zY2x1ZGVGbikge1xuICAgICAgICB2YXIgaSwgaWksIGxpbmtGbiwgaXNvbGF0ZVNjb3BlLCBjb250cm9sbGVyU2NvcGUsIGVsZW1lbnRDb250cm9sbGVycywgdHJhbnNjbHVkZUZuLCAkZWxlbWVudCxcbiAgICAgICAgICAgIGF0dHJzLCByZW1vdmVTY29wZUJpbmRpbmdXYXRjaGVzLCByZW1vdmVDb250cm9sbGVyQmluZGluZ1dhdGNoZXM7XG5cbiAgICAgICAgaWYgKGNvbXBpbGVOb2RlID09PSBsaW5rTm9kZSkge1xuICAgICAgICAgIGF0dHJzID0gdGVtcGxhdGVBdHRycztcbiAgICAgICAgICAkZWxlbWVudCA9IHRlbXBsYXRlQXR0cnMuJCRlbGVtZW50O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRlbGVtZW50ID0ganFMaXRlKGxpbmtOb2RlKTtcbiAgICAgICAgICBhdHRycyA9IG5ldyBBdHRyaWJ1dGVzKCRlbGVtZW50LCB0ZW1wbGF0ZUF0dHJzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnRyb2xsZXJTY29wZSA9IHNjb3BlO1xuICAgICAgICBpZiAobmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlKSB7XG4gICAgICAgICAgaXNvbGF0ZVNjb3BlID0gc2NvcGUuJG5ldyh0cnVlKTtcbiAgICAgICAgfSBlbHNlIGlmIChuZXdTY29wZURpcmVjdGl2ZSkge1xuICAgICAgICAgIGNvbnRyb2xsZXJTY29wZSA9IHNjb3BlLiRwYXJlbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYm91bmRUcmFuc2NsdWRlRm4pIHtcbiAgICAgICAgICAvLyB0cmFjayBgYm91bmRUcmFuc2NsdWRlRm5gIHNvIGl0IGNhbiBiZSB1bndyYXBwZWQgaWYgYHRyYW5zY2x1ZGVGbmBcbiAgICAgICAgICAvLyBpcyBsYXRlciBwYXNzZWQgYXMgYHBhcmVudEJvdW5kVHJhbnNjbHVkZUZuYCB0byBgcHVibGljTGlua0ZuYFxuICAgICAgICAgIHRyYW5zY2x1ZGVGbiA9IGNvbnRyb2xsZXJzQm91bmRUcmFuc2NsdWRlO1xuICAgICAgICAgIHRyYW5zY2x1ZGVGbi4kJGJvdW5kVHJhbnNjbHVkZSA9IGJvdW5kVHJhbnNjbHVkZUZuO1xuICAgICAgICAgIC8vIGV4cG9zZSB0aGUgc2xvdHMgb24gdGhlIGAkdHJhbnNjbHVkZWAgZnVuY3Rpb25cbiAgICAgICAgICB0cmFuc2NsdWRlRm4uaXNTbG90RmlsbGVkID0gZnVuY3Rpb24oc2xvdE5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiAhIWJvdW5kVHJhbnNjbHVkZUZuLiQkc2xvdHNbc2xvdE5hbWVdO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29udHJvbGxlckRpcmVjdGl2ZXMpIHtcbiAgICAgICAgICBlbGVtZW50Q29udHJvbGxlcnMgPSBzZXR1cENvbnRyb2xsZXJzKCRlbGVtZW50LCBhdHRycywgdHJhbnNjbHVkZUZuLCBjb250cm9sbGVyRGlyZWN0aXZlcywgaXNvbGF0ZVNjb3BlLCBzY29wZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlKSB7XG4gICAgICAgICAgLy8gSW5pdGlhbGl6ZSBpc29sYXRlIHNjb3BlIGJpbmRpbmdzIGZvciBuZXcgaXNvbGF0ZSBzY29wZSBkaXJlY3RpdmUuXG4gICAgICAgICAgY29tcGlsZS4kJGFkZFNjb3BlSW5mbygkZWxlbWVudCwgaXNvbGF0ZVNjb3BlLCB0cnVlLCAhKHRlbXBsYXRlRGlyZWN0aXZlICYmICh0ZW1wbGF0ZURpcmVjdGl2ZSA9PT0gbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlIHx8XG4gICAgICAgICAgICAgIHRlbXBsYXRlRGlyZWN0aXZlID09PSBuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUuJCRvcmlnaW5hbERpcmVjdGl2ZSkpKTtcbiAgICAgICAgICBjb21waWxlLiQkYWRkU2NvcGVDbGFzcygkZWxlbWVudCwgdHJ1ZSk7XG4gICAgICAgICAgaXNvbGF0ZVNjb3BlLiQkaXNvbGF0ZUJpbmRpbmdzID1cbiAgICAgICAgICAgICAgbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlLiQkaXNvbGF0ZUJpbmRpbmdzO1xuICAgICAgICAgIHJlbW92ZVNjb3BlQmluZGluZ1dhdGNoZXMgPSBpbml0aWFsaXplRGlyZWN0aXZlQmluZGluZ3Moc2NvcGUsIGF0dHJzLCBpc29sYXRlU2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNvbGF0ZVNjb3BlLiQkaXNvbGF0ZUJpbmRpbmdzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZSk7XG4gICAgICAgICAgaWYgKHJlbW92ZVNjb3BlQmluZGluZ1dhdGNoZXMpIHtcbiAgICAgICAgICAgIGlzb2xhdGVTY29wZS4kb24oJyRkZXN0cm95JywgcmVtb3ZlU2NvcGVCaW5kaW5nV2F0Y2hlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBiaW5kVG9Db250cm9sbGVyIGJpbmRpbmdzXG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gZWxlbWVudENvbnRyb2xsZXJzKSB7XG4gICAgICAgICAgdmFyIGNvbnRyb2xsZXJEaXJlY3RpdmUgPSBjb250cm9sbGVyRGlyZWN0aXZlc1tuYW1lXTtcbiAgICAgICAgICB2YXIgY29udHJvbGxlciA9IGVsZW1lbnRDb250cm9sbGVyc1tuYW1lXTtcbiAgICAgICAgICB2YXIgYmluZGluZ3MgPSBjb250cm9sbGVyRGlyZWN0aXZlLiQkYmluZGluZ3MuYmluZFRvQ29udHJvbGxlcjtcblxuICAgICAgICAgIGlmIChjb250cm9sbGVyLmlkZW50aWZpZXIgJiYgYmluZGluZ3MpIHtcbiAgICAgICAgICAgIHJlbW92ZUNvbnRyb2xsZXJCaW5kaW5nV2F0Y2hlcyA9XG4gICAgICAgICAgICAgIGluaXRpYWxpemVEaXJlY3RpdmVCaW5kaW5ncyhjb250cm9sbGVyU2NvcGUsIGF0dHJzLCBjb250cm9sbGVyLmluc3RhbmNlLCBiaW5kaW5ncywgY29udHJvbGxlckRpcmVjdGl2ZSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIGNvbnRyb2xsZXJSZXN1bHQgPSBjb250cm9sbGVyKCk7XG4gICAgICAgICAgaWYgKGNvbnRyb2xsZXJSZXN1bHQgIT09IGNvbnRyb2xsZXIuaW5zdGFuY2UpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZSBjb250cm9sbGVyIGNvbnN0cnVjdG9yIGhhcyBhIHJldHVybiB2YWx1ZSwgb3ZlcndyaXRlIHRoZSBpbnN0YW5jZVxuICAgICAgICAgICAgLy8gZnJvbSBzZXR1cENvbnRyb2xsZXJzXG4gICAgICAgICAgICBjb250cm9sbGVyLmluc3RhbmNlID0gY29udHJvbGxlclJlc3VsdDtcbiAgICAgICAgICAgICRlbGVtZW50LmRhdGEoJyQnICsgY29udHJvbGxlckRpcmVjdGl2ZS5uYW1lICsgJ0NvbnRyb2xsZXInLCBjb250cm9sbGVyUmVzdWx0KTtcbiAgICAgICAgICAgIHJlbW92ZUNvbnRyb2xsZXJCaW5kaW5nV2F0Y2hlcyAmJiByZW1vdmVDb250cm9sbGVyQmluZGluZ1dhdGNoZXMoKTtcbiAgICAgICAgICAgIHJlbW92ZUNvbnRyb2xsZXJCaW5kaW5nV2F0Y2hlcyA9XG4gICAgICAgICAgICAgIGluaXRpYWxpemVEaXJlY3RpdmVCaW5kaW5ncyhjb250cm9sbGVyU2NvcGUsIGF0dHJzLCBjb250cm9sbGVyLmluc3RhbmNlLCBiaW5kaW5ncywgY29udHJvbGxlckRpcmVjdGl2ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQmluZCB0aGUgcmVxdWlyZWQgY29udHJvbGxlcnMgdG8gdGhlIGNvbnRyb2xsZXIsIGlmIGByZXF1aXJlYCBpcyBhbiBvYmplY3QgYW5kIGBiaW5kVG9Db250cm9sbGVyYCBpcyB0cnV0aHlcbiAgICAgICAgZm9yRWFjaChjb250cm9sbGVyRGlyZWN0aXZlcywgZnVuY3Rpb24oY29udHJvbGxlckRpcmVjdGl2ZSwgbmFtZSkge1xuICAgICAgICAgIHZhciByZXF1aXJlID0gY29udHJvbGxlckRpcmVjdGl2ZS5yZXF1aXJlO1xuICAgICAgICAgIGlmIChjb250cm9sbGVyRGlyZWN0aXZlLmJpbmRUb0NvbnRyb2xsZXIgJiYgIWlzQXJyYXkocmVxdWlyZSkgJiYgaXNPYmplY3QocmVxdWlyZSkpIHtcbiAgICAgICAgICAgIGV4dGVuZChlbGVtZW50Q29udHJvbGxlcnNbbmFtZV0uaW5zdGFuY2UsIGdldENvbnRyb2xsZXJzKG5hbWUsIHJlcXVpcmUsICRlbGVtZW50LCBlbGVtZW50Q29udHJvbGxlcnMpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFRyaWdnZXIgdGhlIGAkb25Jbml0YCBtZXRob2Qgb24gYWxsIGNvbnRyb2xsZXJzIHRoYXQgaGF2ZSBvbmVcbiAgICAgICAgZm9yRWFjaChlbGVtZW50Q29udHJvbGxlcnMsIGZ1bmN0aW9uKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICBpZiAoaXNGdW5jdGlvbihjb250cm9sbGVyLmluc3RhbmNlLiRvbkluaXQpKSB7XG4gICAgICAgICAgICBjb250cm9sbGVyLmluc3RhbmNlLiRvbkluaXQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFBSRUxJTktJTkdcbiAgICAgICAgZm9yIChpID0gMCwgaWkgPSBwcmVMaW5rRm5zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICBsaW5rRm4gPSBwcmVMaW5rRm5zW2ldO1xuICAgICAgICAgIGludm9rZUxpbmtGbihsaW5rRm4sXG4gICAgICAgICAgICAgIGxpbmtGbi5pc29sYXRlU2NvcGUgPyBpc29sYXRlU2NvcGUgOiBzY29wZSxcbiAgICAgICAgICAgICAgJGVsZW1lbnQsXG4gICAgICAgICAgICAgIGF0dHJzLFxuICAgICAgICAgICAgICBsaW5rRm4ucmVxdWlyZSAmJiBnZXRDb250cm9sbGVycyhsaW5rRm4uZGlyZWN0aXZlTmFtZSwgbGlua0ZuLnJlcXVpcmUsICRlbGVtZW50LCBlbGVtZW50Q29udHJvbGxlcnMpLFxuICAgICAgICAgICAgICB0cmFuc2NsdWRlRm5cbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUkVDVVJTSU9OXG4gICAgICAgIC8vIFdlIG9ubHkgcGFzcyB0aGUgaXNvbGF0ZSBzY29wZSwgaWYgdGhlIGlzb2xhdGUgZGlyZWN0aXZlIGhhcyBhIHRlbXBsYXRlLFxuICAgICAgICAvLyBvdGhlcndpc2UgdGhlIGNoaWxkIGVsZW1lbnRzIGRvIG5vdCBiZWxvbmcgdG8gdGhlIGlzb2xhdGUgZGlyZWN0aXZlLlxuICAgICAgICB2YXIgc2NvcGVUb0NoaWxkID0gc2NvcGU7XG4gICAgICAgIGlmIChuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUgJiYgKG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZS50ZW1wbGF0ZSB8fCBuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUudGVtcGxhdGVVcmwgPT09IG51bGwpKSB7XG4gICAgICAgICAgc2NvcGVUb0NoaWxkID0gaXNvbGF0ZVNjb3BlO1xuICAgICAgICB9XG4gICAgICAgIGNoaWxkTGlua0ZuICYmIGNoaWxkTGlua0ZuKHNjb3BlVG9DaGlsZCwgbGlua05vZGUuY2hpbGROb2RlcywgdW5kZWZpbmVkLCBib3VuZFRyYW5zY2x1ZGVGbik7XG5cbiAgICAgICAgLy8gUE9TVExJTktJTkdcbiAgICAgICAgZm9yIChpID0gcG9zdExpbmtGbnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICBsaW5rRm4gPSBwb3N0TGlua0Zuc1tpXTtcbiAgICAgICAgICBpbnZva2VMaW5rRm4obGlua0ZuLFxuICAgICAgICAgICAgICBsaW5rRm4uaXNvbGF0ZVNjb3BlID8gaXNvbGF0ZVNjb3BlIDogc2NvcGUsXG4gICAgICAgICAgICAgICRlbGVtZW50LFxuICAgICAgICAgICAgICBhdHRycyxcbiAgICAgICAgICAgICAgbGlua0ZuLnJlcXVpcmUgJiYgZ2V0Q29udHJvbGxlcnMobGlua0ZuLmRpcmVjdGl2ZU5hbWUsIGxpbmtGbi5yZXF1aXJlLCAkZWxlbWVudCwgZWxlbWVudENvbnRyb2xsZXJzKSxcbiAgICAgICAgICAgICAgdHJhbnNjbHVkZUZuXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRoaXMgaXMgdGhlIGZ1bmN0aW9uIHRoYXQgaXMgaW5qZWN0ZWQgYXMgYCR0cmFuc2NsdWRlYC5cbiAgICAgICAgLy8gTm90ZTogYWxsIGFyZ3VtZW50cyBhcmUgb3B0aW9uYWwhXG4gICAgICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXJzQm91bmRUcmFuc2NsdWRlKHNjb3BlLCBjbG9uZUF0dGFjaEZuLCBmdXR1cmVQYXJlbnRFbGVtZW50LCBzbG90TmFtZSkge1xuICAgICAgICAgIHZhciB0cmFuc2NsdWRlQ29udHJvbGxlcnM7XG4gICAgICAgICAgLy8gTm8gc2NvcGUgcGFzc2VkIGluOlxuICAgICAgICAgIGlmICghaXNTY29wZShzY29wZSkpIHtcbiAgICAgICAgICAgIHNsb3ROYW1lID0gZnV0dXJlUGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgIGZ1dHVyZVBhcmVudEVsZW1lbnQgPSBjbG9uZUF0dGFjaEZuO1xuICAgICAgICAgICAgY2xvbmVBdHRhY2hGbiA9IHNjb3BlO1xuICAgICAgICAgICAgc2NvcGUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlKSB7XG4gICAgICAgICAgICB0cmFuc2NsdWRlQ29udHJvbGxlcnMgPSBlbGVtZW50Q29udHJvbGxlcnM7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghZnV0dXJlUGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgZnV0dXJlUGFyZW50RWxlbWVudCA9IGhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlID8gJGVsZW1lbnQucGFyZW50KCkgOiAkZWxlbWVudDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHNsb3ROYW1lKSB7XG4gICAgICAgICAgICAvLyBzbG90VHJhbnNjbHVkZUZuIGNhbiBiZSBvbmUgb2YgdGhyZWUgdGhpbmdzOlxuICAgICAgICAgICAgLy8gICogYSB0cmFuc2NsdWRlIGZ1bmN0aW9uIC0gYSBmaWxsZWQgc2xvdFxuICAgICAgICAgICAgLy8gICogYG51bGxgIC0gYW4gb3B0aW9uYWwgc2xvdCB0aGF0IHdhcyBub3QgZmlsbGVkXG4gICAgICAgICAgICAvLyAgKiBgdW5kZWZpbmVkYCAtIGEgc2xvdCB0aGF0IHdhcyBub3QgZGVjbGFyZWQgKGkuZS4gaW52YWxpZClcbiAgICAgICAgICAgIHZhciBzbG90VHJhbnNjbHVkZUZuID0gYm91bmRUcmFuc2NsdWRlRm4uJCRzbG90c1tzbG90TmFtZV07XG4gICAgICAgICAgICBpZiAoc2xvdFRyYW5zY2x1ZGVGbikge1xuICAgICAgICAgICAgICByZXR1cm4gc2xvdFRyYW5zY2x1ZGVGbihzY29wZSwgY2xvbmVBdHRhY2hGbiwgdHJhbnNjbHVkZUNvbnRyb2xsZXJzLCBmdXR1cmVQYXJlbnRFbGVtZW50LCBzY29wZVRvQ2hpbGQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc1VuZGVmaW5lZChzbG90VHJhbnNjbHVkZUZuKSkge1xuICAgICAgICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycignbm9zbG90JyxcbiAgICAgICAgICAgICAgICdObyBwYXJlbnQgZGlyZWN0aXZlIHRoYXQgcmVxdWlyZXMgYSB0cmFuc2NsdXNpb24gd2l0aCBzbG90IG5hbWUgXCJ7MH1cIi4gJyArXG4gICAgICAgICAgICAgICAnRWxlbWVudDogezF9JyxcbiAgICAgICAgICAgICAgIHNsb3ROYW1lLCBzdGFydGluZ1RhZygkZWxlbWVudCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gYm91bmRUcmFuc2NsdWRlRm4oc2NvcGUsIGNsb25lQXR0YWNoRm4sIHRyYW5zY2x1ZGVDb250cm9sbGVycywgZnV0dXJlUGFyZW50RWxlbWVudCwgc2NvcGVUb0NoaWxkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBEZXBlbmRpbmcgdXBvbiB0aGUgY29udGV4dCBpbiB3aGljaCBhIGRpcmVjdGl2ZSBmaW5kcyBpdHNlbGYgaXQgbWlnaHQgbmVlZCB0byBoYXZlIGEgbmV3IGlzb2xhdGVkXG4gICAgLy8gb3IgY2hpbGQgc2NvcGUgY3JlYXRlZC4gRm9yIGluc3RhbmNlOlxuICAgIC8vICogaWYgdGhlIGRpcmVjdGl2ZSBoYXMgYmVlbiBwdWxsZWQgaW50byBhIHRlbXBsYXRlIGJlY2F1c2UgYW5vdGhlciBkaXJlY3RpdmUgd2l0aCBhIGhpZ2hlciBwcmlvcml0eVxuICAgIC8vIGFza2VkIGZvciBlbGVtZW50IHRyYW5zY2x1c2lvblxuICAgIC8vICogaWYgdGhlIGRpcmVjdGl2ZSBpdHNlbGYgYXNrcyBmb3IgdHJhbnNjbHVzaW9uIGJ1dCBpdCBpcyBhdCB0aGUgcm9vdCBvZiBhIHRlbXBsYXRlIGFuZCB0aGUgb3JpZ2luYWxcbiAgICAvLyBlbGVtZW50IHdhcyByZXBsYWNlZC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL2FuZ3VsYXIuanMvaXNzdWVzLzEyOTM2XG4gICAgZnVuY3Rpb24gbWFya0RpcmVjdGl2ZVNjb3BlKGRpcmVjdGl2ZXMsIGlzb2xhdGVTY29wZSwgbmV3U2NvcGUpIHtcbiAgICAgIGZvciAodmFyIGogPSAwLCBqaiA9IGRpcmVjdGl2ZXMubGVuZ3RoOyBqIDwgamo7IGorKykge1xuICAgICAgICBkaXJlY3RpdmVzW2pdID0gaW5oZXJpdChkaXJlY3RpdmVzW2pdLCB7JCRpc29sYXRlU2NvcGU6IGlzb2xhdGVTY29wZSwgJCRuZXdTY29wZTogbmV3U2NvcGV9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBsb29rcyB1cCB0aGUgZGlyZWN0aXZlIGFuZCBkZWNvcmF0ZXMgaXQgd2l0aCBleGNlcHRpb24gaGFuZGxpbmcgYW5kIHByb3BlciBwYXJhbWV0ZXJzLiBXZVxuICAgICAqIGNhbGwgdGhpcyB0aGUgYm91bmREaXJlY3RpdmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBuYW1lIG9mIHRoZSBkaXJlY3RpdmUgdG8gbG9vayB1cC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbG9jYXRpb24gVGhlIGRpcmVjdGl2ZSBtdXN0IGJlIGZvdW5kIGluIHNwZWNpZmljIGZvcm1hdC5cbiAgICAgKiAgIFN0cmluZyBjb250YWluaW5nIGFueSBvZiB0aGVzZXMgY2hhcmFjdGVyczpcbiAgICAgKlxuICAgICAqICAgKiBgRWA6IGVsZW1lbnQgbmFtZVxuICAgICAqICAgKiBgQSc6IGF0dHJpYnV0ZVxuICAgICAqICAgKiBgQ2A6IGNsYXNzXG4gICAgICogICAqIGBNYDogY29tbWVudFxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlmIGRpcmVjdGl2ZSB3YXMgYWRkZWQuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWRkRGlyZWN0aXZlKHREaXJlY3RpdmVzLCBuYW1lLCBsb2NhdGlvbiwgbWF4UHJpb3JpdHksIGlnbm9yZURpcmVjdGl2ZSwgc3RhcnRBdHRyTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kQXR0ck5hbWUpIHtcbiAgICAgIGlmIChuYW1lID09PSBpZ25vcmVEaXJlY3RpdmUpIHJldHVybiBudWxsO1xuICAgICAgdmFyIG1hdGNoID0gbnVsbDtcbiAgICAgIGlmIChoYXNEaXJlY3RpdmVzLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICAgIGZvciAodmFyIGRpcmVjdGl2ZSwgZGlyZWN0aXZlcyA9ICRpbmplY3Rvci5nZXQobmFtZSArIFN1ZmZpeCksXG4gICAgICAgICAgICBpID0gMCwgaWkgPSBkaXJlY3RpdmVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgZGlyZWN0aXZlID0gZGlyZWN0aXZlc1tpXTtcbiAgICAgICAgICAgIGlmICgoaXNVbmRlZmluZWQobWF4UHJpb3JpdHkpIHx8IG1heFByaW9yaXR5ID4gZGlyZWN0aXZlLnByaW9yaXR5KSAmJlxuICAgICAgICAgICAgICAgICBkaXJlY3RpdmUucmVzdHJpY3QuaW5kZXhPZihsb2NhdGlvbikgIT0gLTEpIHtcbiAgICAgICAgICAgICAgaWYgKHN0YXJ0QXR0ck5hbWUpIHtcbiAgICAgICAgICAgICAgICBkaXJlY3RpdmUgPSBpbmhlcml0KGRpcmVjdGl2ZSwgeyQkc3RhcnQ6IHN0YXJ0QXR0ck5hbWUsICQkZW5kOiBlbmRBdHRyTmFtZX0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHREaXJlY3RpdmVzLnB1c2goZGlyZWN0aXZlKTtcbiAgICAgICAgICAgICAgbWF0Y2ggPSBkaXJlY3RpdmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZSkgeyAkZXhjZXB0aW9uSGFuZGxlcihlKTsgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbWF0Y2g7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBsb29rcyB1cCB0aGUgZGlyZWN0aXZlIGFuZCByZXR1cm5zIHRydWUgaWYgaXQgaXMgYSBtdWx0aS1lbGVtZW50IGRpcmVjdGl2ZSxcbiAgICAgKiBhbmQgdGhlcmVmb3JlIHJlcXVpcmVzIERPTSBub2RlcyBiZXR3ZWVuIC1zdGFydCBhbmQgLWVuZCBtYXJrZXJzIHRvIGJlIGdyb3VwZWRcbiAgICAgKiB0b2dldGhlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIG5hbWUgb2YgdGhlIGRpcmVjdGl2ZSB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgZGlyZWN0aXZlIHdhcyByZWdpc3RlcmVkIGFzIG11bHRpLWVsZW1lbnQuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZGlyZWN0aXZlSXNNdWx0aUVsZW1lbnQobmFtZSkge1xuICAgICAgaWYgKGhhc0RpcmVjdGl2ZXMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgICAgZm9yICh2YXIgZGlyZWN0aXZlLCBkaXJlY3RpdmVzID0gJGluamVjdG9yLmdldChuYW1lICsgU3VmZml4KSxcbiAgICAgICAgICAgIGkgPSAwLCBpaSA9IGRpcmVjdGl2ZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgIGRpcmVjdGl2ZSA9IGRpcmVjdGl2ZXNbaV07XG4gICAgICAgICAgaWYgKGRpcmVjdGl2ZS5tdWx0aUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdoZW4gdGhlIGVsZW1lbnQgaXMgcmVwbGFjZWQgd2l0aCBIVE1MIHRlbXBsYXRlIHRoZW4gdGhlIG5ldyBhdHRyaWJ1dGVzXG4gICAgICogb24gdGhlIHRlbXBsYXRlIG5lZWQgdG8gYmUgbWVyZ2VkIHdpdGggdGhlIGV4aXN0aW5nIGF0dHJpYnV0ZXMgaW4gdGhlIERPTS5cbiAgICAgKiBUaGUgZGVzaXJlZCBlZmZlY3QgaXMgdG8gaGF2ZSBib3RoIG9mIHRoZSBhdHRyaWJ1dGVzIHByZXNlbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gZHN0IGRlc3RpbmF0aW9uIGF0dHJpYnV0ZXMgKG9yaWdpbmFsIERPTSlcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gc3JjIHNvdXJjZSBhdHRyaWJ1dGVzIChmcm9tIHRoZSBkaXJlY3RpdmUgdGVtcGxhdGUpXG4gICAgICovXG4gICAgZnVuY3Rpb24gbWVyZ2VUZW1wbGF0ZUF0dHJpYnV0ZXMoZHN0LCBzcmMpIHtcbiAgICAgIHZhciBzcmNBdHRyID0gc3JjLiRhdHRyLFxuICAgICAgICAgIGRzdEF0dHIgPSBkc3QuJGF0dHIsXG4gICAgICAgICAgJGVsZW1lbnQgPSBkc3QuJCRlbGVtZW50O1xuXG4gICAgICAvLyByZWFwcGx5IHRoZSBvbGQgYXR0cmlidXRlcyB0byB0aGUgbmV3IGVsZW1lbnRcbiAgICAgIGZvckVhY2goZHN0LCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgIGlmIChrZXkuY2hhckF0KDApICE9ICckJykge1xuICAgICAgICAgIGlmIChzcmNba2V5XSAmJiBzcmNba2V5XSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHZhbHVlICs9IChrZXkgPT09ICdzdHlsZScgPyAnOycgOiAnICcpICsgc3JjW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICAgIGRzdC4kc2V0KGtleSwgdmFsdWUsIHRydWUsIHNyY0F0dHJba2V5XSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBjb3B5IHRoZSBuZXcgYXR0cmlidXRlcyBvbiB0aGUgb2xkIGF0dHJzIG9iamVjdFxuICAgICAgZm9yRWFjaChzcmMsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgaWYgKGtleSA9PSAnY2xhc3MnKSB7XG4gICAgICAgICAgc2FmZUFkZENsYXNzKCRlbGVtZW50LCB2YWx1ZSk7XG4gICAgICAgICAgZHN0WydjbGFzcyddID0gKGRzdFsnY2xhc3MnXSA/IGRzdFsnY2xhc3MnXSArICcgJyA6ICcnKSArIHZhbHVlO1xuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PSAnc3R5bGUnKSB7XG4gICAgICAgICAgJGVsZW1lbnQuYXR0cignc3R5bGUnLCAkZWxlbWVudC5hdHRyKCdzdHlsZScpICsgJzsnICsgdmFsdWUpO1xuICAgICAgICAgIGRzdFsnc3R5bGUnXSA9IChkc3RbJ3N0eWxlJ10gPyBkc3RbJ3N0eWxlJ10gKyAnOycgOiAnJykgKyB2YWx1ZTtcbiAgICAgICAgICAvLyBgZHN0YCB3aWxsIG5ldmVyIGNvbnRhaW4gaGFzT3duUHJvcGVydHkgYXMgRE9NIHBhcnNlciB3b24ndCBsZXQgaXQuXG4gICAgICAgICAgLy8gWW91IHdpbGwgZ2V0IGFuIFwiSW52YWxpZENoYXJhY3RlckVycm9yOiBET00gRXhjZXB0aW9uIDVcIiBlcnJvciBpZiB5b3VcbiAgICAgICAgICAvLyBoYXZlIGFuIGF0dHJpYnV0ZSBsaWtlIFwiaGFzLW93bi1wcm9wZXJ0eVwiIG9yIFwiZGF0YS1oYXMtb3duLXByb3BlcnR5XCIsIGV0Yy5cbiAgICAgICAgfSBlbHNlIGlmIChrZXkuY2hhckF0KDApICE9ICckJyAmJiAhZHN0Lmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICBkc3Rba2V5XSA9IHZhbHVlO1xuICAgICAgICAgIGRzdEF0dHJba2V5XSA9IHNyY0F0dHJba2V5XTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBjb21waWxlVGVtcGxhdGVVcmwoZGlyZWN0aXZlcywgJGNvbXBpbGVOb2RlLCB0QXR0cnMsXG4gICAgICAgICRyb290RWxlbWVudCwgY2hpbGRUcmFuc2NsdWRlRm4sIHByZUxpbmtGbnMsIHBvc3RMaW5rRm5zLCBwcmV2aW91c0NvbXBpbGVDb250ZXh0KSB7XG4gICAgICB2YXIgbGlua1F1ZXVlID0gW10sXG4gICAgICAgICAgYWZ0ZXJUZW1wbGF0ZU5vZGVMaW5rRm4sXG4gICAgICAgICAgYWZ0ZXJUZW1wbGF0ZUNoaWxkTGlua0ZuLFxuICAgICAgICAgIGJlZm9yZVRlbXBsYXRlQ29tcGlsZU5vZGUgPSAkY29tcGlsZU5vZGVbMF0sXG4gICAgICAgICAgb3JpZ0FzeW5jRGlyZWN0aXZlID0gZGlyZWN0aXZlcy5zaGlmdCgpLFxuICAgICAgICAgIGRlcml2ZWRTeW5jRGlyZWN0aXZlID0gaW5oZXJpdChvcmlnQXN5bmNEaXJlY3RpdmUsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBudWxsLCB0cmFuc2NsdWRlOiBudWxsLCByZXBsYWNlOiBudWxsLCAkJG9yaWdpbmFsRGlyZWN0aXZlOiBvcmlnQXN5bmNEaXJlY3RpdmVcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB0ZW1wbGF0ZVVybCA9IChpc0Z1bmN0aW9uKG9yaWdBc3luY0RpcmVjdGl2ZS50ZW1wbGF0ZVVybCkpXG4gICAgICAgICAgICAgID8gb3JpZ0FzeW5jRGlyZWN0aXZlLnRlbXBsYXRlVXJsKCRjb21waWxlTm9kZSwgdEF0dHJzKVxuICAgICAgICAgICAgICA6IG9yaWdBc3luY0RpcmVjdGl2ZS50ZW1wbGF0ZVVybCxcbiAgICAgICAgICB0ZW1wbGF0ZU5hbWVzcGFjZSA9IG9yaWdBc3luY0RpcmVjdGl2ZS50ZW1wbGF0ZU5hbWVzcGFjZTtcblxuICAgICAgJGNvbXBpbGVOb2RlLmVtcHR5KCk7XG5cbiAgICAgICR0ZW1wbGF0ZVJlcXVlc3QodGVtcGxhdGVVcmwpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGNvbnRlbnQpIHtcbiAgICAgICAgICB2YXIgY29tcGlsZU5vZGUsIHRlbXBUZW1wbGF0ZUF0dHJzLCAkdGVtcGxhdGUsIGNoaWxkQm91bmRUcmFuc2NsdWRlRm47XG5cbiAgICAgICAgICBjb250ZW50ID0gZGVub3JtYWxpemVUZW1wbGF0ZShjb250ZW50KTtcblxuICAgICAgICAgIGlmIChvcmlnQXN5bmNEaXJlY3RpdmUucmVwbGFjZSkge1xuICAgICAgICAgICAgaWYgKGpxTGl0ZUlzVGV4dE5vZGUoY29udGVudCkpIHtcbiAgICAgICAgICAgICAgJHRlbXBsYXRlID0gW107XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAkdGVtcGxhdGUgPSByZW1vdmVDb21tZW50cyh3cmFwVGVtcGxhdGUodGVtcGxhdGVOYW1lc3BhY2UsIHRyaW0oY29udGVudCkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbXBpbGVOb2RlID0gJHRlbXBsYXRlWzBdO1xuXG4gICAgICAgICAgICBpZiAoJHRlbXBsYXRlLmxlbmd0aCAhPSAxIHx8IGNvbXBpbGVOb2RlLm5vZGVUeXBlICE9PSBOT0RFX1RZUEVfRUxFTUVOVCkge1xuICAgICAgICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycigndHBscnQnLFxuICAgICAgICAgICAgICAgICAgXCJUZW1wbGF0ZSBmb3IgZGlyZWN0aXZlICd7MH0nIG11c3QgaGF2ZSBleGFjdGx5IG9uZSByb290IGVsZW1lbnQuIHsxfVwiLFxuICAgICAgICAgICAgICAgICAgb3JpZ0FzeW5jRGlyZWN0aXZlLm5hbWUsIHRlbXBsYXRlVXJsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGVtcFRlbXBsYXRlQXR0cnMgPSB7JGF0dHI6IHt9fTtcbiAgICAgICAgICAgIHJlcGxhY2VXaXRoKCRyb290RWxlbWVudCwgJGNvbXBpbGVOb2RlLCBjb21waWxlTm9kZSk7XG4gICAgICAgICAgICB2YXIgdGVtcGxhdGVEaXJlY3RpdmVzID0gY29sbGVjdERpcmVjdGl2ZXMoY29tcGlsZU5vZGUsIFtdLCB0ZW1wVGVtcGxhdGVBdHRycyk7XG5cbiAgICAgICAgICAgIGlmIChpc09iamVjdChvcmlnQXN5bmNEaXJlY3RpdmUuc2NvcGUpKSB7XG4gICAgICAgICAgICAgIC8vIHRoZSBvcmlnaW5hbCBkaXJlY3RpdmUgdGhhdCBjYXVzZWQgdGhlIHRlbXBsYXRlIHRvIGJlIGxvYWRlZCBhc3luYyByZXF1aXJlZFxuICAgICAgICAgICAgICAvLyBhbiBpc29sYXRlIHNjb3BlXG4gICAgICAgICAgICAgIG1hcmtEaXJlY3RpdmVTY29wZSh0ZW1wbGF0ZURpcmVjdGl2ZXMsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGlyZWN0aXZlcyA9IHRlbXBsYXRlRGlyZWN0aXZlcy5jb25jYXQoZGlyZWN0aXZlcyk7XG4gICAgICAgICAgICBtZXJnZVRlbXBsYXRlQXR0cmlidXRlcyh0QXR0cnMsIHRlbXBUZW1wbGF0ZUF0dHJzKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29tcGlsZU5vZGUgPSBiZWZvcmVUZW1wbGF0ZUNvbXBpbGVOb2RlO1xuICAgICAgICAgICAgJGNvbXBpbGVOb2RlLmh0bWwoY29udGVudCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZGlyZWN0aXZlcy51bnNoaWZ0KGRlcml2ZWRTeW5jRGlyZWN0aXZlKTtcblxuICAgICAgICAgIGFmdGVyVGVtcGxhdGVOb2RlTGlua0ZuID0gYXBwbHlEaXJlY3RpdmVzVG9Ob2RlKGRpcmVjdGl2ZXMsIGNvbXBpbGVOb2RlLCB0QXR0cnMsXG4gICAgICAgICAgICAgIGNoaWxkVHJhbnNjbHVkZUZuLCAkY29tcGlsZU5vZGUsIG9yaWdBc3luY0RpcmVjdGl2ZSwgcHJlTGlua0ZucywgcG9zdExpbmtGbnMsXG4gICAgICAgICAgICAgIHByZXZpb3VzQ29tcGlsZUNvbnRleHQpO1xuICAgICAgICAgIGZvckVhY2goJHJvb3RFbGVtZW50LCBmdW5jdGlvbihub2RlLCBpKSB7XG4gICAgICAgICAgICBpZiAobm9kZSA9PSBjb21waWxlTm9kZSkge1xuICAgICAgICAgICAgICAkcm9vdEVsZW1lbnRbaV0gPSAkY29tcGlsZU5vZGVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYWZ0ZXJUZW1wbGF0ZUNoaWxkTGlua0ZuID0gY29tcGlsZU5vZGVzKCRjb21waWxlTm9kZVswXS5jaGlsZE5vZGVzLCBjaGlsZFRyYW5zY2x1ZGVGbik7XG5cbiAgICAgICAgICB3aGlsZSAobGlua1F1ZXVlLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIHNjb3BlID0gbGlua1F1ZXVlLnNoaWZ0KCksXG4gICAgICAgICAgICAgICAgYmVmb3JlVGVtcGxhdGVMaW5rTm9kZSA9IGxpbmtRdWV1ZS5zaGlmdCgpLFxuICAgICAgICAgICAgICAgIGxpbmtSb290RWxlbWVudCA9IGxpbmtRdWV1ZS5zaGlmdCgpLFxuICAgICAgICAgICAgICAgIGJvdW5kVHJhbnNjbHVkZUZuID0gbGlua1F1ZXVlLnNoaWZ0KCksXG4gICAgICAgICAgICAgICAgbGlua05vZGUgPSAkY29tcGlsZU5vZGVbMF07XG5cbiAgICAgICAgICAgIGlmIChzY29wZS4kJGRlc3Ryb3llZCkgY29udGludWU7XG5cbiAgICAgICAgICAgIGlmIChiZWZvcmVUZW1wbGF0ZUxpbmtOb2RlICE9PSBiZWZvcmVUZW1wbGF0ZUNvbXBpbGVOb2RlKSB7XG4gICAgICAgICAgICAgIHZhciBvbGRDbGFzc2VzID0gYmVmb3JlVGVtcGxhdGVMaW5rTm9kZS5jbGFzc05hbWU7XG5cbiAgICAgICAgICAgICAgaWYgKCEocHJldmlvdXNDb21waWxlQ29udGV4dC5oYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSAmJlxuICAgICAgICAgICAgICAgICAgb3JpZ0FzeW5jRGlyZWN0aXZlLnJlcGxhY2UpKSB7XG4gICAgICAgICAgICAgICAgLy8gaXQgd2FzIGNsb25lZCB0aGVyZWZvcmUgd2UgaGF2ZSB0byBjbG9uZSBhcyB3ZWxsLlxuICAgICAgICAgICAgICAgIGxpbmtOb2RlID0ganFMaXRlQ2xvbmUoY29tcGlsZU5vZGUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJlcGxhY2VXaXRoKGxpbmtSb290RWxlbWVudCwganFMaXRlKGJlZm9yZVRlbXBsYXRlTGlua05vZGUpLCBsaW5rTm9kZSk7XG5cbiAgICAgICAgICAgICAgLy8gQ29weSBpbiBDU1MgY2xhc3NlcyBmcm9tIG9yaWdpbmFsIG5vZGVcbiAgICAgICAgICAgICAgc2FmZUFkZENsYXNzKGpxTGl0ZShsaW5rTm9kZSksIG9sZENsYXNzZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFmdGVyVGVtcGxhdGVOb2RlTGlua0ZuLnRyYW5zY2x1ZGVPblRoaXNFbGVtZW50KSB7XG4gICAgICAgICAgICAgIGNoaWxkQm91bmRUcmFuc2NsdWRlRm4gPSBjcmVhdGVCb3VuZFRyYW5zY2x1ZGVGbihzY29wZSwgYWZ0ZXJUZW1wbGF0ZU5vZGVMaW5rRm4udHJhbnNjbHVkZSwgYm91bmRUcmFuc2NsdWRlRm4pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY2hpbGRCb3VuZFRyYW5zY2x1ZGVGbiA9IGJvdW5kVHJhbnNjbHVkZUZuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWZ0ZXJUZW1wbGF0ZU5vZGVMaW5rRm4oYWZ0ZXJUZW1wbGF0ZUNoaWxkTGlua0ZuLCBzY29wZSwgbGlua05vZGUsICRyb290RWxlbWVudCxcbiAgICAgICAgICAgICAgY2hpbGRCb3VuZFRyYW5zY2x1ZGVGbik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxpbmtRdWV1ZSA9IG51bGw7XG4gICAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZnVuY3Rpb24gZGVsYXllZE5vZGVMaW5rRm4oaWdub3JlQ2hpbGRMaW5rRm4sIHNjb3BlLCBub2RlLCByb290RWxlbWVudCwgYm91bmRUcmFuc2NsdWRlRm4pIHtcbiAgICAgICAgdmFyIGNoaWxkQm91bmRUcmFuc2NsdWRlRm4gPSBib3VuZFRyYW5zY2x1ZGVGbjtcbiAgICAgICAgaWYgKHNjb3BlLiQkZGVzdHJveWVkKSByZXR1cm47XG4gICAgICAgIGlmIChsaW5rUXVldWUpIHtcbiAgICAgICAgICBsaW5rUXVldWUucHVzaChzY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgIHJvb3RFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkQm91bmRUcmFuc2NsdWRlRm4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChhZnRlclRlbXBsYXRlTm9kZUxpbmtGbi50cmFuc2NsdWRlT25UaGlzRWxlbWVudCkge1xuICAgICAgICAgICAgY2hpbGRCb3VuZFRyYW5zY2x1ZGVGbiA9IGNyZWF0ZUJvdW5kVHJhbnNjbHVkZUZuKHNjb3BlLCBhZnRlclRlbXBsYXRlTm9kZUxpbmtGbi50cmFuc2NsdWRlLCBib3VuZFRyYW5zY2x1ZGVGbik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFmdGVyVGVtcGxhdGVOb2RlTGlua0ZuKGFmdGVyVGVtcGxhdGVDaGlsZExpbmtGbiwgc2NvcGUsIG5vZGUsIHJvb3RFbGVtZW50LCBjaGlsZEJvdW5kVHJhbnNjbHVkZUZuKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFNvcnRpbmcgZnVuY3Rpb24gZm9yIGJvdW5kIGRpcmVjdGl2ZXMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYnlQcmlvcml0eShhLCBiKSB7XG4gICAgICB2YXIgZGlmZiA9IGIucHJpb3JpdHkgLSBhLnByaW9yaXR5O1xuICAgICAgaWYgKGRpZmYgIT09IDApIHJldHVybiBkaWZmO1xuICAgICAgaWYgKGEubmFtZSAhPT0gYi5uYW1lKSByZXR1cm4gKGEubmFtZSA8IGIubmFtZSkgPyAtMSA6IDE7XG4gICAgICByZXR1cm4gYS5pbmRleCAtIGIuaW5kZXg7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXNzZXJ0Tm9EdXBsaWNhdGUod2hhdCwgcHJldmlvdXNEaXJlY3RpdmUsIGRpcmVjdGl2ZSwgZWxlbWVudCkge1xuXG4gICAgICBmdW5jdGlvbiB3cmFwTW9kdWxlTmFtZUlmRGVmaW5lZChtb2R1bGVOYW1lKSB7XG4gICAgICAgIHJldHVybiBtb2R1bGVOYW1lID9cbiAgICAgICAgICAoJyAobW9kdWxlOiAnICsgbW9kdWxlTmFtZSArICcpJykgOlxuICAgICAgICAgICcnO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJldmlvdXNEaXJlY3RpdmUpIHtcbiAgICAgICAgdGhyb3cgJGNvbXBpbGVNaW5FcnIoJ211bHRpZGlyJywgJ011bHRpcGxlIGRpcmVjdGl2ZXMgW3swfXsxfSwgezJ9ezN9XSBhc2tpbmcgZm9yIHs0fSBvbjogezV9JyxcbiAgICAgICAgICAgIHByZXZpb3VzRGlyZWN0aXZlLm5hbWUsIHdyYXBNb2R1bGVOYW1lSWZEZWZpbmVkKHByZXZpb3VzRGlyZWN0aXZlLiQkbW9kdWxlTmFtZSksXG4gICAgICAgICAgICBkaXJlY3RpdmUubmFtZSwgd3JhcE1vZHVsZU5hbWVJZkRlZmluZWQoZGlyZWN0aXZlLiQkbW9kdWxlTmFtZSksIHdoYXQsIHN0YXJ0aW5nVGFnKGVsZW1lbnQpKTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGFkZFRleHRJbnRlcnBvbGF0ZURpcmVjdGl2ZShkaXJlY3RpdmVzLCB0ZXh0KSB7XG4gICAgICB2YXIgaW50ZXJwb2xhdGVGbiA9ICRpbnRlcnBvbGF0ZSh0ZXh0LCB0cnVlKTtcbiAgICAgIGlmIChpbnRlcnBvbGF0ZUZuKSB7XG4gICAgICAgIGRpcmVjdGl2ZXMucHVzaCh7XG4gICAgICAgICAgcHJpb3JpdHk6IDAsXG4gICAgICAgICAgY29tcGlsZTogZnVuY3Rpb24gdGV4dEludGVycG9sYXRlQ29tcGlsZUZuKHRlbXBsYXRlTm9kZSkge1xuICAgICAgICAgICAgdmFyIHRlbXBsYXRlTm9kZVBhcmVudCA9IHRlbXBsYXRlTm9kZS5wYXJlbnQoKSxcbiAgICAgICAgICAgICAgICBoYXNDb21waWxlUGFyZW50ID0gISF0ZW1wbGF0ZU5vZGVQYXJlbnQubGVuZ3RoO1xuXG4gICAgICAgICAgICAvLyBXaGVuIHRyYW5zY2x1ZGluZyBhIHRlbXBsYXRlIHRoYXQgaGFzIGJpbmRpbmdzIGluIHRoZSByb290XG4gICAgICAgICAgICAvLyB3ZSBkb24ndCBoYXZlIGEgcGFyZW50IGFuZCB0aHVzIG5lZWQgdG8gYWRkIHRoZSBjbGFzcyBkdXJpbmcgbGlua2luZyBmbi5cbiAgICAgICAgICAgIGlmIChoYXNDb21waWxlUGFyZW50KSBjb21waWxlLiQkYWRkQmluZGluZ0NsYXNzKHRlbXBsYXRlTm9kZVBhcmVudCk7XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiB0ZXh0SW50ZXJwb2xhdGVMaW5rRm4oc2NvcGUsIG5vZGUpIHtcbiAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUucGFyZW50KCk7XG4gICAgICAgICAgICAgIGlmICghaGFzQ29tcGlsZVBhcmVudCkgY29tcGlsZS4kJGFkZEJpbmRpbmdDbGFzcyhwYXJlbnQpO1xuICAgICAgICAgICAgICBjb21waWxlLiQkYWRkQmluZGluZ0luZm8ocGFyZW50LCBpbnRlcnBvbGF0ZUZuLmV4cHJlc3Npb25zKTtcbiAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKGludGVycG9sYXRlRm4sIGZ1bmN0aW9uIGludGVycG9sYXRlRm5XYXRjaEFjdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICAgIG5vZGVbMF0ubm9kZVZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gd3JhcFRlbXBsYXRlKHR5cGUsIHRlbXBsYXRlKSB7XG4gICAgICB0eXBlID0gbG93ZXJjYXNlKHR5cGUgfHwgJ2h0bWwnKTtcbiAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSAnc3ZnJzpcbiAgICAgIGNhc2UgJ21hdGgnOlxuICAgICAgICB2YXIgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB3cmFwcGVyLmlubmVySFRNTCA9ICc8JyArIHR5cGUgKyAnPicgKyB0ZW1wbGF0ZSArICc8LycgKyB0eXBlICsgJz4nO1xuICAgICAgICByZXR1cm4gd3JhcHBlci5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXM7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gdGVtcGxhdGU7XG4gICAgICB9XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBnZXRUcnVzdGVkQ29udGV4dChub2RlLCBhdHRyTm9ybWFsaXplZE5hbWUpIHtcbiAgICAgIGlmIChhdHRyTm9ybWFsaXplZE5hbWUgPT0gXCJzcmNkb2NcIikge1xuICAgICAgICByZXR1cm4gJHNjZS5IVE1MO1xuICAgICAgfVxuICAgICAgdmFyIHRhZyA9IG5vZGVOYW1lXyhub2RlKTtcbiAgICAgIC8vIG1hY3Rpb25beGxpbms6aHJlZl0gY2FuIHNvdXJjZSBTVkcuICBJdCdzIG5vdCBsaW1pdGVkIHRvIDxtYWN0aW9uPi5cbiAgICAgIGlmIChhdHRyTm9ybWFsaXplZE5hbWUgPT0gXCJ4bGlua0hyZWZcIiB8fFxuICAgICAgICAgICh0YWcgPT0gXCJmb3JtXCIgJiYgYXR0ck5vcm1hbGl6ZWROYW1lID09IFwiYWN0aW9uXCIpIHx8XG4gICAgICAgICAgKHRhZyAhPSBcImltZ1wiICYmIChhdHRyTm9ybWFsaXplZE5hbWUgPT0gXCJzcmNcIiB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJOb3JtYWxpemVkTmFtZSA9PSBcIm5nU3JjXCIpKSkge1xuICAgICAgICByZXR1cm4gJHNjZS5SRVNPVVJDRV9VUkw7XG4gICAgICB9XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBhZGRBdHRySW50ZXJwb2xhdGVEaXJlY3RpdmUobm9kZSwgZGlyZWN0aXZlcywgdmFsdWUsIG5hbWUsIGFsbE9yTm90aGluZykge1xuICAgICAgdmFyIHRydXN0ZWRDb250ZXh0ID0gZ2V0VHJ1c3RlZENvbnRleHQobm9kZSwgbmFtZSk7XG4gICAgICBhbGxPck5vdGhpbmcgPSBBTExfT1JfTk9USElOR19BVFRSU1tuYW1lXSB8fCBhbGxPck5vdGhpbmc7XG5cbiAgICAgIHZhciBpbnRlcnBvbGF0ZUZuID0gJGludGVycG9sYXRlKHZhbHVlLCB0cnVlLCB0cnVzdGVkQ29udGV4dCwgYWxsT3JOb3RoaW5nKTtcblxuICAgICAgLy8gbm8gaW50ZXJwb2xhdGlvbiBmb3VuZCAtPiBpZ25vcmVcbiAgICAgIGlmICghaW50ZXJwb2xhdGVGbikgcmV0dXJuO1xuXG5cbiAgICAgIGlmIChuYW1lID09PSBcIm11bHRpcGxlXCIgJiYgbm9kZU5hbWVfKG5vZGUpID09PSBcInNlbGVjdFwiKSB7XG4gICAgICAgIHRocm93ICRjb21waWxlTWluRXJyKFwic2VsbXVsdGlcIixcbiAgICAgICAgICAgIFwiQmluZGluZyB0byB0aGUgJ211bHRpcGxlJyBhdHRyaWJ1dGUgaXMgbm90IHN1cHBvcnRlZC4gRWxlbWVudDogezB9XCIsXG4gICAgICAgICAgICBzdGFydGluZ1RhZyhub2RlKSk7XG4gICAgICB9XG5cbiAgICAgIGRpcmVjdGl2ZXMucHVzaCh7XG4gICAgICAgIHByaW9yaXR5OiAxMDAsXG4gICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgcHJlOiBmdW5jdGlvbiBhdHRySW50ZXJwb2xhdGVQcmVMaW5rRm4oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgICAgICAgICAgICB2YXIgJCRvYnNlcnZlcnMgPSAoYXR0ci4kJG9ic2VydmVycyB8fCAoYXR0ci4kJG9ic2VydmVycyA9IGNyZWF0ZU1hcCgpKSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoRVZFTlRfSEFORExFUl9BVFRSX1JFR0VYUC50ZXN0KG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycignbm9kb21ldmVudHMnLFxuICAgICAgICAgICAgICAgICAgICAgIFwiSW50ZXJwb2xhdGlvbnMgZm9yIEhUTUwgRE9NIGV2ZW50IGF0dHJpYnV0ZXMgYXJlIGRpc2FsbG93ZWQuICBQbGVhc2UgdXNlIHRoZSBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwibmctIHZlcnNpb25zIChzdWNoIGFzIG5nLWNsaWNrIGluc3RlYWQgb2Ygb25jbGljaykgaW5zdGVhZC5cIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGF0dHJpYnV0ZSBoYXMgY2hhbmdlZCBzaW5jZSBsYXN0ICRpbnRlcnBvbGF0ZSgpZWRcbiAgICAgICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSBhdHRyW25hbWVdO1xuICAgICAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gaW50ZXJwb2xhdGUgYWdhaW4gc2luY2UgdGhlIGF0dHJpYnV0ZSB2YWx1ZSBoYXMgYmVlbiB1cGRhdGVkXG4gICAgICAgICAgICAgICAgICAvLyAoZS5nLiBieSBhbm90aGVyIGRpcmVjdGl2ZSdzIGNvbXBpbGUgZnVuY3Rpb24pXG4gICAgICAgICAgICAgICAgICAvLyBlbnN1cmUgdW5zZXQvZW1wdHkgdmFsdWVzIG1ha2UgaW50ZXJwb2xhdGVGbiBmYWxzeVxuICAgICAgICAgICAgICAgICAgaW50ZXJwb2xhdGVGbiA9IG5ld1ZhbHVlICYmICRpbnRlcnBvbGF0ZShuZXdWYWx1ZSwgdHJ1ZSwgdHJ1c3RlZENvbnRleHQsIGFsbE9yTm90aGluZyk7XG4gICAgICAgICAgICAgICAgICB2YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGlmIGF0dHJpYnV0ZSB3YXMgdXBkYXRlZCBzbyB0aGF0IHRoZXJlIGlzIG5vIGludGVycG9sYXRpb24gZ29pbmcgb24gd2UgZG9uJ3Qgd2FudCB0b1xuICAgICAgICAgICAgICAgIC8vIHJlZ2lzdGVyIGFueSBvYnNlcnZlcnNcbiAgICAgICAgICAgICAgICBpZiAoIWludGVycG9sYXRlRm4pIHJldHVybjtcblxuICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemUgYXR0ciBvYmplY3Qgc28gdGhhdCBpdCdzIHJlYWR5IGluIGNhc2Ugd2UgbmVlZCB0aGUgdmFsdWUgZm9yIGlzb2xhdGVcbiAgICAgICAgICAgICAgICAvLyBzY29wZSBpbml0aWFsaXphdGlvbiwgb3RoZXJ3aXNlIHRoZSB2YWx1ZSB3b3VsZCBub3QgYmUgYXZhaWxhYmxlIGZyb20gaXNvbGF0ZVxuICAgICAgICAgICAgICAgIC8vIGRpcmVjdGl2ZSdzIGxpbmtpbmcgZm4gZHVyaW5nIGxpbmtpbmcgcGhhc2VcbiAgICAgICAgICAgICAgICBhdHRyW25hbWVdID0gaW50ZXJwb2xhdGVGbihzY29wZSk7XG5cbiAgICAgICAgICAgICAgICAoJCRvYnNlcnZlcnNbbmFtZV0gfHwgKCQkb2JzZXJ2ZXJzW25hbWVdID0gW10pKS4kJGludGVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAoYXR0ci4kJG9ic2VydmVycyAmJiBhdHRyLiQkb2JzZXJ2ZXJzW25hbWVdLiQkc2NvcGUgfHwgc2NvcGUpLlxuICAgICAgICAgICAgICAgICAgJHdhdGNoKGludGVycG9sYXRlRm4sIGZ1bmN0aW9uIGludGVycG9sYXRlRm5XYXRjaEFjdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9zcGVjaWFsIGNhc2UgZm9yIGNsYXNzIGF0dHJpYnV0ZSBhZGRpdGlvbiArIHJlbW92YWxcbiAgICAgICAgICAgICAgICAgICAgLy9zbyB0aGF0IGNsYXNzIGNoYW5nZXMgY2FuIHRhcCBpbnRvIHRoZSBhbmltYXRpb25cbiAgICAgICAgICAgICAgICAgICAgLy9ob29rcyBwcm92aWRlZCBieSB0aGUgJGFuaW1hdGUgc2VydmljZS4gQmUgc3VyZSB0b1xuICAgICAgICAgICAgICAgICAgICAvL3NraXAgYW5pbWF0aW9ucyB3aGVuIHRoZSBmaXJzdCBkaWdlc3Qgb2NjdXJzICh3aGVuXG4gICAgICAgICAgICAgICAgICAgIC8vYm90aCB0aGUgbmV3IGFuZCB0aGUgb2xkIHZhbHVlcyBhcmUgdGhlIHNhbWUpIHNpbmNlXG4gICAgICAgICAgICAgICAgICAgIC8vdGhlIENTUyBjbGFzc2VzIGFyZSB0aGUgbm9uLWludGVycG9sYXRlZCB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdjbGFzcycgJiYgbmV3VmFsdWUgIT0gb2xkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICBhdHRyLiR1cGRhdGVDbGFzcyhuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIGF0dHIuJHNldChuYW1lLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogVGhpcyBpcyBhIHNwZWNpYWwganFMaXRlLnJlcGxhY2VXaXRoLCB3aGljaCBjYW4gcmVwbGFjZSBpdGVtcyB3aGljaFxuICAgICAqIGhhdmUgbm8gcGFyZW50cywgcHJvdmlkZWQgdGhhdCB0aGUgY29udGFpbmluZyBqcUxpdGUgY29sbGVjdGlvbiBpcyBwcm92aWRlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7SnFMaXRlPX0gJHJvb3RFbGVtZW50IFRoZSByb290IG9mIHRoZSBjb21waWxlIHRyZWUuIFVzZWQgc28gdGhhdCB3ZSBjYW4gcmVwbGFjZSBub2Rlc1xuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIHRoZSByb290IG9mIHRoZSB0cmVlLlxuICAgICAqIEBwYXJhbSB7SnFMaXRlfSBlbGVtZW50c1RvUmVtb3ZlIFRoZSBqcUxpdGUgZWxlbWVudCB3aGljaCB3ZSBhcmUgZ29pbmcgdG8gcmVwbGFjZS4gV2Uga2VlcFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBzaGVsbCwgYnV0IHJlcGxhY2UgaXRzIERPTSBub2RlIHJlZmVyZW5jZS5cbiAgICAgKiBAcGFyYW0ge05vZGV9IG5ld05vZGUgVGhlIG5ldyBET00gbm9kZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZXBsYWNlV2l0aCgkcm9vdEVsZW1lbnQsIGVsZW1lbnRzVG9SZW1vdmUsIG5ld05vZGUpIHtcbiAgICAgIHZhciBmaXJzdEVsZW1lbnRUb1JlbW92ZSA9IGVsZW1lbnRzVG9SZW1vdmVbMF0sXG4gICAgICAgICAgcmVtb3ZlQ291bnQgPSBlbGVtZW50c1RvUmVtb3ZlLmxlbmd0aCxcbiAgICAgICAgICBwYXJlbnQgPSBmaXJzdEVsZW1lbnRUb1JlbW92ZS5wYXJlbnROb2RlLFxuICAgICAgICAgIGksIGlpO1xuXG4gICAgICBpZiAoJHJvb3RFbGVtZW50KSB7XG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gJHJvb3RFbGVtZW50Lmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICBpZiAoJHJvb3RFbGVtZW50W2ldID09IGZpcnN0RWxlbWVudFRvUmVtb3ZlKSB7XG4gICAgICAgICAgICAkcm9vdEVsZW1lbnRbaSsrXSA9IG5ld05vZGU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gaSwgajIgPSBqICsgcmVtb3ZlQ291bnQgLSAxLFxuICAgICAgICAgICAgICAgICAgICAgamogPSAkcm9vdEVsZW1lbnQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICBqIDwgamo7IGorKywgajIrKykge1xuICAgICAgICAgICAgICBpZiAoajIgPCBqaikge1xuICAgICAgICAgICAgICAgICRyb290RWxlbWVudFtqXSA9ICRyb290RWxlbWVudFtqMl07XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlICRyb290RWxlbWVudFtqXTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHJvb3RFbGVtZW50Lmxlbmd0aCAtPSByZW1vdmVDb3VudCAtIDE7XG5cbiAgICAgICAgICAgIC8vIElmIHRoZSByZXBsYWNlZCBlbGVtZW50IGlzIGFsc28gdGhlIGpRdWVyeSAuY29udGV4dCB0aGVuIHJlcGxhY2UgaXRcbiAgICAgICAgICAgIC8vIC5jb250ZXh0IGlzIGEgZGVwcmVjYXRlZCBqUXVlcnkgYXBpLCBzbyB3ZSBzaG91bGQgc2V0IGl0IG9ubHkgd2hlbiBqUXVlcnkgc2V0IGl0XG4gICAgICAgICAgICAvLyBodHRwOi8vYXBpLmpxdWVyeS5jb20vY29udGV4dC9cbiAgICAgICAgICAgIGlmICgkcm9vdEVsZW1lbnQuY29udGV4dCA9PT0gZmlyc3RFbGVtZW50VG9SZW1vdmUpIHtcbiAgICAgICAgICAgICAgJHJvb3RFbGVtZW50LmNvbnRleHQgPSBuZXdOb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgcGFyZW50LnJlcGxhY2VDaGlsZChuZXdOb2RlLCBmaXJzdEVsZW1lbnRUb1JlbW92ZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFwcGVuZCBhbGwgdGhlIGBlbGVtZW50c1RvUmVtb3ZlYCB0byBhIGZyYWdtZW50LiBUaGlzIHdpbGwuLi5cbiAgICAgIC8vIC0gcmVtb3ZlIHRoZW0gZnJvbSB0aGUgRE9NXG4gICAgICAvLyAtIGFsbG93IHRoZW0gdG8gc3RpbGwgYmUgdHJhdmVyc2VkIHdpdGggLm5leHRTaWJsaW5nXG4gICAgICAvLyAtIGFsbG93IGEgc2luZ2xlIGZyYWdtZW50LnFTQSB0byBmZXRjaCBhbGwgZWxlbWVudHMgYmVpbmcgcmVtb3ZlZFxuICAgICAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgZm9yIChpID0gMDsgaSA8IHJlbW92ZUNvdW50OyBpKyspIHtcbiAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZWxlbWVudHNUb1JlbW92ZVtpXSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChqcUxpdGUuaGFzRGF0YShmaXJzdEVsZW1lbnRUb1JlbW92ZSkpIHtcbiAgICAgICAgLy8gQ29weSBvdmVyIHVzZXIgZGF0YSAodGhhdCBpbmNsdWRlcyBBbmd1bGFyJ3MgJHNjb3BlIGV0Yy4pLiBEb24ndCBjb3B5IHByaXZhdGVcbiAgICAgICAgLy8gZGF0YSBoZXJlIGJlY2F1c2UgdGhlcmUncyBubyBwdWJsaWMgaW50ZXJmYWNlIGluIGpRdWVyeSB0byBkbyB0aGF0IGFuZCBjb3B5aW5nIG92ZXJcbiAgICAgICAgLy8gZXZlbnQgbGlzdGVuZXJzICh3aGljaCBpcyB0aGUgbWFpbiB1c2Ugb2YgcHJpdmF0ZSBkYXRhKSB3b3VsZG4ndCB3b3JrIGFueXdheS5cbiAgICAgICAganFMaXRlLmRhdGEobmV3Tm9kZSwganFMaXRlLmRhdGEoZmlyc3RFbGVtZW50VG9SZW1vdmUpKTtcblxuICAgICAgICAvLyBSZW1vdmUgJGRlc3Ryb3kgZXZlbnQgbGlzdGVuZXJzIGZyb20gYGZpcnN0RWxlbWVudFRvUmVtb3ZlYFxuICAgICAgICBqcUxpdGUoZmlyc3RFbGVtZW50VG9SZW1vdmUpLm9mZignJGRlc3Ryb3knKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2xlYW51cCBhbnkgZGF0YS9saXN0ZW5lcnMgb24gdGhlIGVsZW1lbnRzIGFuZCBjaGlsZHJlbi5cbiAgICAgIC8vIFRoaXMgaW5jbHVkZXMgaW52b2tpbmcgdGhlICRkZXN0cm95IGV2ZW50IG9uIGFueSBlbGVtZW50cyB3aXRoIGxpc3RlbmVycy5cbiAgICAgIGpxTGl0ZS5jbGVhbkRhdGEoZnJhZ21lbnQucXVlcnlTZWxlY3RvckFsbCgnKicpKTtcblxuICAgICAgLy8gVXBkYXRlIHRoZSBqcUxpdGUgY29sbGVjdGlvbiB0byBvbmx5IGNvbnRhaW4gdGhlIGBuZXdOb2RlYFxuICAgICAgZm9yIChpID0gMTsgaSA8IHJlbW92ZUNvdW50OyBpKyspIHtcbiAgICAgICAgZGVsZXRlIGVsZW1lbnRzVG9SZW1vdmVbaV07XG4gICAgICB9XG4gICAgICBlbGVtZW50c1RvUmVtb3ZlWzBdID0gbmV3Tm9kZTtcbiAgICAgIGVsZW1lbnRzVG9SZW1vdmUubGVuZ3RoID0gMTtcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGNsb25lQW5kQW5ub3RhdGVGbihmbiwgYW5ub3RhdGlvbikge1xuICAgICAgcmV0dXJuIGV4dGVuZChmdW5jdGlvbigpIHsgcmV0dXJuIGZuLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7IH0sIGZuLCBhbm5vdGF0aW9uKTtcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGludm9rZUxpbmtGbihsaW5rRm4sIHNjb3BlLCAkZWxlbWVudCwgYXR0cnMsIGNvbnRyb2xsZXJzLCB0cmFuc2NsdWRlRm4pIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGxpbmtGbihzY29wZSwgJGVsZW1lbnQsIGF0dHJzLCBjb250cm9sbGVycywgdHJhbnNjbHVkZUZuKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSwgc3RhcnRpbmdUYWcoJGVsZW1lbnQpKTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vIFNldCB1cCAkd2F0Y2hlcyBmb3IgaXNvbGF0ZSBzY29wZSBhbmQgY29udHJvbGxlciBiaW5kaW5ncy4gVGhpcyBwcm9jZXNzXG4gICAgLy8gb25seSBvY2N1cnMgZm9yIGlzb2xhdGUgc2NvcGVzIGFuZCBuZXcgc2NvcGVzIHdpdGggY29udHJvbGxlckFzLlxuICAgIGZ1bmN0aW9uIGluaXRpYWxpemVEaXJlY3RpdmVCaW5kaW5ncyhzY29wZSwgYXR0cnMsIGRlc3RpbmF0aW9uLCBiaW5kaW5ncywgZGlyZWN0aXZlKSB7XG4gICAgICB2YXIgcmVtb3ZlV2F0Y2hDb2xsZWN0aW9uID0gW107XG4gICAgICBmb3JFYWNoKGJpbmRpbmdzLCBmdW5jdGlvbihkZWZpbml0aW9uLCBzY29wZU5hbWUpIHtcbiAgICAgICAgdmFyIGF0dHJOYW1lID0gZGVmaW5pdGlvbi5hdHRyTmFtZSxcbiAgICAgICAgb3B0aW9uYWwgPSBkZWZpbml0aW9uLm9wdGlvbmFsLFxuICAgICAgICBtb2RlID0gZGVmaW5pdGlvbi5tb2RlLCAvLyBALCA9LCBvciAmXG4gICAgICAgIGxhc3RWYWx1ZSxcbiAgICAgICAgcGFyZW50R2V0LCBwYXJlbnRTZXQsIGNvbXBhcmUsIHJlbW92ZVdhdGNoO1xuXG4gICAgICAgIHN3aXRjaCAobW9kZSkge1xuXG4gICAgICAgICAgY2FzZSAnQCc6XG4gICAgICAgICAgICBpZiAoIW9wdGlvbmFsICYmICFoYXNPd25Qcm9wZXJ0eS5jYWxsKGF0dHJzLCBhdHRyTmFtZSkpIHtcbiAgICAgICAgICAgICAgZGVzdGluYXRpb25bc2NvcGVOYW1lXSA9IGF0dHJzW2F0dHJOYW1lXSA9IHZvaWQgMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF0dHJzLiRvYnNlcnZlKGF0dHJOYW1lLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICBpZiAoaXNTdHJpbmcodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgZGVzdGluYXRpb25bc2NvcGVOYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGF0dHJzLiQkb2JzZXJ2ZXJzW2F0dHJOYW1lXS4kJHNjb3BlID0gc2NvcGU7XG4gICAgICAgICAgICBsYXN0VmFsdWUgPSBhdHRyc1thdHRyTmFtZV07XG4gICAgICAgICAgICBpZiAoaXNTdHJpbmcobGFzdFZhbHVlKSkge1xuICAgICAgICAgICAgICAvLyBJZiB0aGUgYXR0cmlidXRlIGhhcyBiZWVuIHByb3ZpZGVkIHRoZW4gd2UgdHJpZ2dlciBhbiBpbnRlcnBvbGF0aW9uIHRvIGVuc3VyZVxuICAgICAgICAgICAgICAvLyB0aGUgdmFsdWUgaXMgdGhlcmUgZm9yIHVzZSBpbiB0aGUgbGluayBmblxuICAgICAgICAgICAgICBkZXN0aW5hdGlvbltzY29wZU5hbWVdID0gJGludGVycG9sYXRlKGxhc3RWYWx1ZSkoc2NvcGUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc0Jvb2xlYW4obGFzdFZhbHVlKSkge1xuICAgICAgICAgICAgICAvLyBJZiB0aGUgYXR0cmlidXRlcyBpcyBvbmUgb2YgdGhlIEJPT0xFQU5fQVRUUiB0aGVuIEFuZ3VsYXIgd2lsbCBoYXZlIGNvbnZlcnRlZFxuICAgICAgICAgICAgICAvLyB0aGUgdmFsdWUgdG8gYm9vbGVhbiByYXRoZXIgdGhhbiBhIHN0cmluZywgc28gd2Ugc3BlY2lhbCBjYXNlIHRoaXMgc2l0dWF0aW9uXG4gICAgICAgICAgICAgIGRlc3RpbmF0aW9uW3Njb3BlTmFtZV0gPSBsYXN0VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgJz0nOlxuICAgICAgICAgICAgaWYgKCFoYXNPd25Qcm9wZXJ0eS5jYWxsKGF0dHJzLCBhdHRyTmFtZSkpIHtcbiAgICAgICAgICAgICAgaWYgKG9wdGlvbmFsKSBicmVhaztcbiAgICAgICAgICAgICAgYXR0cnNbYXR0ck5hbWVdID0gdm9pZCAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbmFsICYmICFhdHRyc1thdHRyTmFtZV0pIGJyZWFrO1xuXG4gICAgICAgICAgICBwYXJlbnRHZXQgPSAkcGFyc2UoYXR0cnNbYXR0ck5hbWVdKTtcbiAgICAgICAgICAgIGlmIChwYXJlbnRHZXQubGl0ZXJhbCkge1xuICAgICAgICAgICAgICBjb21wYXJlID0gZXF1YWxzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29tcGFyZSA9IGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIGEgPT09IGIgfHwgKGEgIT09IGEgJiYgYiAhPT0gYik7IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYXJlbnRTZXQgPSBwYXJlbnRHZXQuYXNzaWduIHx8IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAvLyByZXNldCB0aGUgY2hhbmdlLCBvciB3ZSB3aWxsIHRocm93IHRoaXMgZXhjZXB0aW9uIG9uIGV2ZXJ5ICRkaWdlc3RcbiAgICAgICAgICAgICAgbGFzdFZhbHVlID0gZGVzdGluYXRpb25bc2NvcGVOYW1lXSA9IHBhcmVudEdldChzY29wZSk7XG4gICAgICAgICAgICAgIHRocm93ICRjb21waWxlTWluRXJyKCdub25hc3NpZ24nLFxuICAgICAgICAgICAgICAgICAgXCJFeHByZXNzaW9uICd7MH0nIGluIGF0dHJpYnV0ZSAnezF9JyB1c2VkIHdpdGggZGlyZWN0aXZlICd7Mn0nIGlzIG5vbi1hc3NpZ25hYmxlIVwiLFxuICAgICAgICAgICAgICAgICAgYXR0cnNbYXR0ck5hbWVdLCBhdHRyTmFtZSwgZGlyZWN0aXZlLm5hbWUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGxhc3RWYWx1ZSA9IGRlc3RpbmF0aW9uW3Njb3BlTmFtZV0gPSBwYXJlbnRHZXQoc2NvcGUpO1xuICAgICAgICAgICAgdmFyIHBhcmVudFZhbHVlV2F0Y2ggPSBmdW5jdGlvbiBwYXJlbnRWYWx1ZVdhdGNoKHBhcmVudFZhbHVlKSB7XG4gICAgICAgICAgICAgIGlmICghY29tcGFyZShwYXJlbnRWYWx1ZSwgZGVzdGluYXRpb25bc2NvcGVOYW1lXSkpIHtcbiAgICAgICAgICAgICAgICAvLyB3ZSBhcmUgb3V0IG9mIHN5bmMgYW5kIG5lZWQgdG8gY29weVxuICAgICAgICAgICAgICAgIGlmICghY29tcGFyZShwYXJlbnRWYWx1ZSwgbGFzdFZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgLy8gcGFyZW50IGNoYW5nZWQgYW5kIGl0IGhhcyBwcmVjZWRlbmNlXG4gICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbltzY29wZU5hbWVdID0gcGFyZW50VmFsdWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBwYXJlbnQgY2FuIGJlIGFzc2lnbmVkIHRoZW4gZG8gc29cbiAgICAgICAgICAgICAgICAgIHBhcmVudFNldChzY29wZSwgcGFyZW50VmFsdWUgPSBkZXN0aW5hdGlvbltzY29wZU5hbWVdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIGxhc3RWYWx1ZSA9IHBhcmVudFZhbHVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHBhcmVudFZhbHVlV2F0Y2guJHN0YXRlZnVsID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChkZWZpbml0aW9uLmNvbGxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgcmVtb3ZlV2F0Y2ggPSBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGF0dHJzW2F0dHJOYW1lXSwgcGFyZW50VmFsdWVXYXRjaCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZW1vdmVXYXRjaCA9IHNjb3BlLiR3YXRjaCgkcGFyc2UoYXR0cnNbYXR0ck5hbWVdLCBwYXJlbnRWYWx1ZVdhdGNoKSwgbnVsbCwgcGFyZW50R2V0LmxpdGVyYWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVtb3ZlV2F0Y2hDb2xsZWN0aW9uLnB1c2gocmVtb3ZlV2F0Y2gpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlICc8JzpcbiAgICAgICAgICAgIGlmICghaGFzT3duUHJvcGVydHkuY2FsbChhdHRycywgYXR0ck5hbWUpKSB7XG4gICAgICAgICAgICAgIGlmIChvcHRpb25hbCkgYnJlYWs7XG4gICAgICAgICAgICAgIGF0dHJzW2F0dHJOYW1lXSA9IHZvaWQgMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25hbCAmJiAhYXR0cnNbYXR0ck5hbWVdKSBicmVhaztcblxuICAgICAgICAgICAgcGFyZW50R2V0ID0gJHBhcnNlKGF0dHJzW2F0dHJOYW1lXSk7XG5cbiAgICAgICAgICAgIGRlc3RpbmF0aW9uW3Njb3BlTmFtZV0gPSBwYXJlbnRHZXQoc2NvcGUpO1xuXG4gICAgICAgICAgICByZW1vdmVXYXRjaCA9IHNjb3BlLiR3YXRjaChwYXJlbnRHZXQsIGZ1bmN0aW9uIHBhcmVudFZhbHVlV2F0Y2hBY3Rpb24obmV3UGFyZW50VmFsdWUpIHtcbiAgICAgICAgICAgICAgZGVzdGluYXRpb25bc2NvcGVOYW1lXSA9IG5ld1BhcmVudFZhbHVlO1xuICAgICAgICAgICAgfSwgcGFyZW50R2V0LmxpdGVyYWwpO1xuXG4gICAgICAgICAgICByZW1vdmVXYXRjaENvbGxlY3Rpb24ucHVzaChyZW1vdmVXYXRjaCk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgJyYnOlxuICAgICAgICAgICAgLy8gRG9uJ3QgYXNzaWduIE9iamVjdC5wcm90b3R5cGUgbWV0aG9kIHRvIHNjb3BlXG4gICAgICAgICAgICBwYXJlbnRHZXQgPSBhdHRycy5oYXNPd25Qcm9wZXJ0eShhdHRyTmFtZSkgPyAkcGFyc2UoYXR0cnNbYXR0ck5hbWVdKSA6IG5vb3A7XG5cbiAgICAgICAgICAgIC8vIERvbid0IGFzc2lnbiBub29wIHRvIGRlc3RpbmF0aW9uIGlmIGV4cHJlc3Npb24gaXMgbm90IHZhbGlkXG4gICAgICAgICAgICBpZiAocGFyZW50R2V0ID09PSBub29wICYmIG9wdGlvbmFsKSBicmVhaztcblxuICAgICAgICAgICAgZGVzdGluYXRpb25bc2NvcGVOYW1lXSA9IGZ1bmN0aW9uKGxvY2Fscykge1xuICAgICAgICAgICAgICByZXR1cm4gcGFyZW50R2V0KHNjb3BlLCBsb2NhbHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHJlbW92ZVdhdGNoQ29sbGVjdGlvbi5sZW5ndGggJiYgZnVuY3Rpb24gcmVtb3ZlV2F0Y2hlcygpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gcmVtb3ZlV2F0Y2hDb2xsZWN0aW9uLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICByZW1vdmVXYXRjaENvbGxlY3Rpb25baV0oKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1dO1xufVxuXG52YXIgUFJFRklYX1JFR0VYUCA9IC9eKCg/Onh8ZGF0YSlbXFw6XFwtX10pL2k7XG4vKipcbiAqIENvbnZlcnRzIGFsbCBhY2NlcHRlZCBkaXJlY3RpdmVzIGZvcm1hdCBpbnRvIHByb3BlciBkaXJlY3RpdmUgbmFtZS5cbiAqIEBwYXJhbSBuYW1lIE5hbWUgdG8gbm9ybWFsaXplXG4gKi9cbmZ1bmN0aW9uIGRpcmVjdGl2ZU5vcm1hbGl6ZShuYW1lKSB7XG4gIHJldHVybiBjYW1lbENhc2UobmFtZS5yZXBsYWNlKFBSRUZJWF9SRUdFWFAsICcnKSk7XG59XG5cbi8qKlxuICogQG5nZG9jIHR5cGVcbiAqIEBuYW1lICRjb21waWxlLmRpcmVjdGl2ZS5BdHRyaWJ1dGVzXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBBIHNoYXJlZCBvYmplY3QgYmV0d2VlbiBkaXJlY3RpdmUgY29tcGlsZSAvIGxpbmtpbmcgZnVuY3Rpb25zIHdoaWNoIGNvbnRhaW5zIG5vcm1hbGl6ZWQgRE9NXG4gKiBlbGVtZW50IGF0dHJpYnV0ZXMuIFRoZSB2YWx1ZXMgcmVmbGVjdCBjdXJyZW50IGJpbmRpbmcgc3RhdGUgYHt7IH19YC4gVGhlIG5vcm1hbGl6YXRpb24gaXNcbiAqIG5lZWRlZCBzaW5jZSBhbGwgb2YgdGhlc2UgYXJlIHRyZWF0ZWQgYXMgZXF1aXZhbGVudCBpbiBBbmd1bGFyOlxuICpcbiAqIGBgYFxuICogICAgPHNwYW4gbmc6YmluZD1cImFcIiBuZy1iaW5kPVwiYVwiIGRhdGEtbmctYmluZD1cImFcIiB4LW5nLWJpbmQ9XCJhXCI+XG4gKiBgYGBcbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBwcm9wZXJ0eVxuICogQG5hbWUgJGNvbXBpbGUuZGlyZWN0aXZlLkF0dHJpYnV0ZXMjJGF0dHJcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIEEgbWFwIG9mIERPTSBlbGVtZW50IGF0dHJpYnV0ZSBuYW1lcyB0byB0aGUgbm9ybWFsaXplZCBuYW1lLiBUaGlzIGlzXG4gKiBuZWVkZWQgdG8gZG8gcmV2ZXJzZSBsb29rdXAgZnJvbSBub3JtYWxpemVkIG5hbWUgYmFjayB0byBhY3R1YWwgbmFtZS5cbiAqL1xuXG5cbi8qKlxuICogQG5nZG9jIG1ldGhvZFxuICogQG5hbWUgJGNvbXBpbGUuZGlyZWN0aXZlLkF0dHJpYnV0ZXMjJHNldFxuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFNldCBET00gZWxlbWVudCBhdHRyaWJ1dGUgdmFsdWUuXG4gKlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIE5vcm1hbGl6ZWQgZWxlbWVudCBhdHRyaWJ1dGUgbmFtZSBvZiB0aGUgcHJvcGVydHkgdG8gbW9kaWZ5LiBUaGUgbmFtZSBpc1xuICogICAgICAgICAgcmV2ZXJzZS10cmFuc2xhdGVkIHVzaW5nIHRoZSB7QGxpbmsgbmcuJGNvbXBpbGUuZGlyZWN0aXZlLkF0dHJpYnV0ZXMjJGF0dHIgJGF0dHJ9XG4gKiAgICAgICAgICBwcm9wZXJ0eSB0byB0aGUgb3JpZ2luYWwgbmFtZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSBWYWx1ZSB0byBzZXQgdGhlIGF0dHJpYnV0ZSB0by4gVGhlIHZhbHVlIGNhbiBiZSBhbiBpbnRlcnBvbGF0ZWQgc3RyaW5nLlxuICovXG5cblxuXG4vKipcbiAqIENsb3N1cmUgY29tcGlsZXIgdHlwZSBpbmZvcm1hdGlvblxuICovXG5cbmZ1bmN0aW9uIG5vZGVzZXRMaW5raW5nRm4oXG4gIC8qIGFuZ3VsYXIuU2NvcGUgKi8gc2NvcGUsXG4gIC8qIE5vZGVMaXN0ICovIG5vZGVMaXN0LFxuICAvKiBFbGVtZW50ICovIHJvb3RFbGVtZW50LFxuICAvKiBmdW5jdGlvbihGdW5jdGlvbikgKi8gYm91bmRUcmFuc2NsdWRlRm5cbikge31cblxuZnVuY3Rpb24gZGlyZWN0aXZlTGlua2luZ0ZuKFxuICAvKiBub2Rlc2V0TGlua2luZ0ZuICovIG5vZGVzZXRMaW5raW5nRm4sXG4gIC8qIGFuZ3VsYXIuU2NvcGUgKi8gc2NvcGUsXG4gIC8qIE5vZGUgKi8gbm9kZSxcbiAgLyogRWxlbWVudCAqLyByb290RWxlbWVudCxcbiAgLyogZnVuY3Rpb24oRnVuY3Rpb24pICovIGJvdW5kVHJhbnNjbHVkZUZuXG4pIHt9XG5cbmZ1bmN0aW9uIHRva2VuRGlmZmVyZW5jZShzdHIxLCBzdHIyKSB7XG4gIHZhciB2YWx1ZXMgPSAnJyxcbiAgICAgIHRva2VuczEgPSBzdHIxLnNwbGl0KC9cXHMrLyksXG4gICAgICB0b2tlbnMyID0gc3RyMi5zcGxpdCgvXFxzKy8pO1xuXG4gIG91dGVyOlxuICBmb3IgKHZhciBpID0gMDsgaSA8IHRva2VuczEubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgdG9rZW4gPSB0b2tlbnMxW2ldO1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgdG9rZW5zMi5sZW5ndGg7IGorKykge1xuICAgICAgaWYgKHRva2VuID09IHRva2VuczJbal0pIGNvbnRpbnVlIG91dGVyO1xuICAgIH1cbiAgICB2YWx1ZXMgKz0gKHZhbHVlcy5sZW5ndGggPiAwID8gJyAnIDogJycpICsgdG9rZW47XG4gIH1cbiAgcmV0dXJuIHZhbHVlcztcbn1cblxuZnVuY3Rpb24gcmVtb3ZlQ29tbWVudHMoanFOb2Rlcykge1xuICBqcU5vZGVzID0ganFMaXRlKGpxTm9kZXMpO1xuICB2YXIgaSA9IGpxTm9kZXMubGVuZ3RoO1xuXG4gIGlmIChpIDw9IDEpIHtcbiAgICByZXR1cm4ganFOb2RlcztcbiAgfVxuXG4gIHdoaWxlIChpLS0pIHtcbiAgICB2YXIgbm9kZSA9IGpxTm9kZXNbaV07XG4gICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IE5PREVfVFlQRV9DT01NRU5UKSB7XG4gICAgICBzcGxpY2UuY2FsbChqcU5vZGVzLCBpLCAxKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGpxTm9kZXM7XG59XG5cbnZhciAkY29udHJvbGxlck1pbkVyciA9IG1pbkVycignJGNvbnRyb2xsZXInKTtcblxuXG52YXIgQ05UUkxfUkVHID0gL14oXFxTKykoXFxzK2FzXFxzKyhbXFx3JF0rKSk/JC87XG5mdW5jdGlvbiBpZGVudGlmaWVyRm9yQ29udHJvbGxlcihjb250cm9sbGVyLCBpZGVudCkge1xuICBpZiAoaWRlbnQgJiYgaXNTdHJpbmcoaWRlbnQpKSByZXR1cm4gaWRlbnQ7XG4gIGlmIChpc1N0cmluZyhjb250cm9sbGVyKSkge1xuICAgIHZhciBtYXRjaCA9IENOVFJMX1JFRy5leGVjKGNvbnRyb2xsZXIpO1xuICAgIGlmIChtYXRjaCkgcmV0dXJuIG1hdGNoWzNdO1xuICB9XG59XG5cblxuLyoqXG4gKiBAbmdkb2MgcHJvdmlkZXJcbiAqIEBuYW1lICRjb250cm9sbGVyUHJvdmlkZXJcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIHtAbGluayBuZy4kY29udHJvbGxlciAkY29udHJvbGxlciBzZXJ2aWNlfSBpcyB1c2VkIGJ5IEFuZ3VsYXIgdG8gY3JlYXRlIG5ld1xuICogY29udHJvbGxlcnMuXG4gKlxuICogVGhpcyBwcm92aWRlciBhbGxvd3MgY29udHJvbGxlciByZWdpc3RyYXRpb24gdmlhIHRoZVxuICoge0BsaW5rIG5nLiRjb250cm9sbGVyUHJvdmlkZXIjcmVnaXN0ZXIgcmVnaXN0ZXJ9IG1ldGhvZC5cbiAqL1xuZnVuY3Rpb24gJENvbnRyb2xsZXJQcm92aWRlcigpIHtcbiAgdmFyIGNvbnRyb2xsZXJzID0ge30sXG4gICAgICBnbG9iYWxzID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGNvbnRyb2xsZXJQcm92aWRlciNyZWdpc3RlclxuICAgKiBAcGFyYW0ge3N0cmluZ3xPYmplY3R9IG5hbWUgQ29udHJvbGxlciBuYW1lLCBvciBhbiBvYmplY3QgbWFwIG9mIGNvbnRyb2xsZXJzIHdoZXJlIHRoZSBrZXlzIGFyZVxuICAgKiAgICB0aGUgbmFtZXMgYW5kIHRoZSB2YWx1ZXMgYXJlIHRoZSBjb25zdHJ1Y3RvcnMuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb258QXJyYXl9IGNvbnN0cnVjdG9yIENvbnRyb2xsZXIgY29uc3RydWN0b3IgZm4gKG9wdGlvbmFsbHkgZGVjb3JhdGVkIHdpdGggRElcbiAgICogICAgYW5ub3RhdGlvbnMgaW4gdGhlIGFycmF5IG5vdGF0aW9uKS5cbiAgICovXG4gIHRoaXMucmVnaXN0ZXIgPSBmdW5jdGlvbihuYW1lLCBjb25zdHJ1Y3Rvcikge1xuICAgIGFzc2VydE5vdEhhc093blByb3BlcnR5KG5hbWUsICdjb250cm9sbGVyJyk7XG4gICAgaWYgKGlzT2JqZWN0KG5hbWUpKSB7XG4gICAgICBleHRlbmQoY29udHJvbGxlcnMsIG5hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250cm9sbGVyc1tuYW1lXSA9IGNvbnN0cnVjdG9yO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkY29udHJvbGxlclByb3ZpZGVyI2FsbG93R2xvYmFsc1xuICAgKiBAZGVzY3JpcHRpb24gSWYgY2FsbGVkLCBhbGxvd3MgYCRjb250cm9sbGVyYCB0byBmaW5kIGNvbnRyb2xsZXIgY29uc3RydWN0b3JzIG9uIGB3aW5kb3dgXG4gICAqL1xuICB0aGlzLmFsbG93R2xvYmFscyA9IGZ1bmN0aW9uKCkge1xuICAgIGdsb2JhbHMgPSB0cnVlO1xuICB9O1xuXG5cbiAgdGhpcy4kZ2V0ID0gWyckaW5qZWN0b3InLCAnJHdpbmRvdycsIGZ1bmN0aW9uKCRpbmplY3RvciwgJHdpbmRvdykge1xuXG4gICAgLyoqXG4gICAgICogQG5nZG9jIHNlcnZpY2VcbiAgICAgKiBAbmFtZSAkY29udHJvbGxlclxuICAgICAqIEByZXF1aXJlcyAkaW5qZWN0b3JcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb258c3RyaW5nfSBjb25zdHJ1Y3RvciBJZiBjYWxsZWQgd2l0aCBhIGZ1bmN0aW9uIHRoZW4gaXQncyBjb25zaWRlcmVkIHRvIGJlIHRoZVxuICAgICAqICAgIGNvbnRyb2xsZXIgY29uc3RydWN0b3IgZnVuY3Rpb24uIE90aGVyd2lzZSBpdCdzIGNvbnNpZGVyZWQgdG8gYmUgYSBzdHJpbmcgd2hpY2ggaXMgdXNlZFxuICAgICAqICAgIHRvIHJldHJpZXZlIHRoZSBjb250cm9sbGVyIGNvbnN0cnVjdG9yIHVzaW5nIHRoZSBmb2xsb3dpbmcgc3RlcHM6XG4gICAgICpcbiAgICAgKiAgICAqIGNoZWNrIGlmIGEgY29udHJvbGxlciB3aXRoIGdpdmVuIG5hbWUgaXMgcmVnaXN0ZXJlZCB2aWEgYCRjb250cm9sbGVyUHJvdmlkZXJgXG4gICAgICogICAgKiBjaGVjayBpZiBldmFsdWF0aW5nIHRoZSBzdHJpbmcgb24gdGhlIGN1cnJlbnQgc2NvcGUgcmV0dXJucyBhIGNvbnN0cnVjdG9yXG4gICAgICogICAgKiBpZiAkY29udHJvbGxlclByb3ZpZGVyI2FsbG93R2xvYmFscywgY2hlY2sgYHdpbmRvd1tjb25zdHJ1Y3Rvcl1gIG9uIHRoZSBnbG9iYWxcbiAgICAgKiAgICAgIGB3aW5kb3dgIG9iamVjdCAobm90IHJlY29tbWVuZGVkKVxuICAgICAqXG4gICAgICogICAgVGhlIHN0cmluZyBjYW4gdXNlIHRoZSBgY29udHJvbGxlciBhcyBwcm9wZXJ0eWAgc3ludGF4LCB3aGVyZSB0aGUgY29udHJvbGxlciBpbnN0YW5jZSBpcyBwdWJsaXNoZWRcbiAgICAgKiAgICBhcyB0aGUgc3BlY2lmaWVkIHByb3BlcnR5IG9uIHRoZSBgc2NvcGVgOyB0aGUgYHNjb3BlYCBtdXN0IGJlIGluamVjdGVkIGludG8gYGxvY2Fsc2AgcGFyYW0gZm9yIHRoaXNcbiAgICAgKiAgICB0byB3b3JrIGNvcnJlY3RseS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBsb2NhbHMgSW5qZWN0aW9uIGxvY2FscyBmb3IgQ29udHJvbGxlci5cbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IEluc3RhbmNlIG9mIGdpdmVuIGNvbnRyb2xsZXIuXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBgJGNvbnRyb2xsZXJgIHNlcnZpY2UgaXMgcmVzcG9uc2libGUgZm9yIGluc3RhbnRpYXRpbmcgY29udHJvbGxlcnMuXG4gICAgICpcbiAgICAgKiBJdCdzIGp1c3QgYSBzaW1wbGUgY2FsbCB0byB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfSwgYnV0IGV4dHJhY3RlZCBpbnRvXG4gICAgICogYSBzZXJ2aWNlLCBzbyB0aGF0IG9uZSBjYW4gb3ZlcnJpZGUgdGhpcyBzZXJ2aWNlIHdpdGggW0JDIHZlcnNpb25dKGh0dHBzOi8vZ2lzdC5naXRodWIuY29tLzE2NDk3ODgpLlxuICAgICAqL1xuICAgIHJldHVybiBmdW5jdGlvbihleHByZXNzaW9uLCBsb2NhbHMsIGxhdGVyLCBpZGVudCkge1xuICAgICAgLy8gUFJJVkFURSBBUEk6XG4gICAgICAvLyAgIHBhcmFtIGBsYXRlcmAgLS0tIGluZGljYXRlcyB0aGF0IHRoZSBjb250cm9sbGVyJ3MgY29uc3RydWN0b3IgaXMgaW52b2tlZCBhdCBhIGxhdGVyIHRpbWUuXG4gICAgICAvLyAgICAgICAgICAgICAgICAgICAgIElmIHRydWUsICRjb250cm9sbGVyIHdpbGwgYWxsb2NhdGUgdGhlIG9iamVjdCB3aXRoIHRoZSBjb3JyZWN0XG4gICAgICAvLyAgICAgICAgICAgICAgICAgICAgIHByb3RvdHlwZSBjaGFpbiwgYnV0IHdpbGwgbm90IGludm9rZSB0aGUgY29udHJvbGxlciB1bnRpbCBhIHJldHVybmVkXG4gICAgICAvLyAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrIGlzIGludm9rZWQuXG4gICAgICAvLyAgIHBhcmFtIGBpZGVudGAgLS0tIEFuIG9wdGlvbmFsIGxhYmVsIHdoaWNoIG92ZXJyaWRlcyB0aGUgbGFiZWwgcGFyc2VkIGZyb20gdGhlIGNvbnRyb2xsZXJcbiAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbiwgaWYgYW55LlxuICAgICAgdmFyIGluc3RhbmNlLCBtYXRjaCwgY29uc3RydWN0b3IsIGlkZW50aWZpZXI7XG4gICAgICBsYXRlciA9IGxhdGVyID09PSB0cnVlO1xuICAgICAgaWYgKGlkZW50ICYmIGlzU3RyaW5nKGlkZW50KSkge1xuICAgICAgICBpZGVudGlmaWVyID0gaWRlbnQ7XG4gICAgICB9XG5cbiAgICAgIGlmIChpc1N0cmluZyhleHByZXNzaW9uKSkge1xuICAgICAgICBtYXRjaCA9IGV4cHJlc3Npb24ubWF0Y2goQ05UUkxfUkVHKTtcbiAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgIHRocm93ICRjb250cm9sbGVyTWluRXJyKCdjdHJsZm10JyxcbiAgICAgICAgICAgIFwiQmFkbHkgZm9ybWVkIGNvbnRyb2xsZXIgc3RyaW5nICd7MH0nLiBcIiArXG4gICAgICAgICAgICBcIk11c3QgbWF0Y2ggYF9fbmFtZV9fIGFzIF9faWRfX2Agb3IgYF9fbmFtZV9fYC5cIiwgZXhwcmVzc2lvbik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3RydWN0b3IgPSBtYXRjaFsxXSxcbiAgICAgICAgaWRlbnRpZmllciA9IGlkZW50aWZpZXIgfHwgbWF0Y2hbM107XG4gICAgICAgIGV4cHJlc3Npb24gPSBjb250cm9sbGVycy5oYXNPd25Qcm9wZXJ0eShjb25zdHJ1Y3RvcilcbiAgICAgICAgICAgID8gY29udHJvbGxlcnNbY29uc3RydWN0b3JdXG4gICAgICAgICAgICA6IGdldHRlcihsb2NhbHMuJHNjb3BlLCBjb25zdHJ1Y3RvciwgdHJ1ZSkgfHxcbiAgICAgICAgICAgICAgICAoZ2xvYmFscyA/IGdldHRlcigkd2luZG93LCBjb25zdHJ1Y3RvciwgdHJ1ZSkgOiB1bmRlZmluZWQpO1xuXG4gICAgICAgIGFzc2VydEFyZ0ZuKGV4cHJlc3Npb24sIGNvbnN0cnVjdG9yLCB0cnVlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGxhdGVyKSB7XG4gICAgICAgIC8vIEluc3RhbnRpYXRlIGNvbnRyb2xsZXIgbGF0ZXI6XG4gICAgICAgIC8vIFRoaXMgbWFjaGluZXJ5IGlzIHVzZWQgdG8gY3JlYXRlIGFuIGluc3RhbmNlIG9mIHRoZSBvYmplY3QgYmVmb3JlIGNhbGxpbmcgdGhlXG4gICAgICAgIC8vIGNvbnRyb2xsZXIncyBjb25zdHJ1Y3RvciBpdHNlbGYuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIFRoaXMgYWxsb3dzIHByb3BlcnRpZXMgdG8gYmUgYWRkZWQgdG8gdGhlIGNvbnRyb2xsZXIgYmVmb3JlIHRoZSBjb25zdHJ1Y3RvciBpc1xuICAgICAgICAvLyBpbnZva2VkLiBQcmltYXJpbHksIHRoaXMgaXMgdXNlZCBmb3IgaXNvbGF0ZSBzY29wZSBiaW5kaW5ncyBpbiAkY29tcGlsZS5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gVGhpcyBmZWF0dXJlIGlzIG5vdCBpbnRlbmRlZCBmb3IgdXNlIGJ5IGFwcGxpY2F0aW9ucywgYW5kIGlzIHRodXMgbm90IGRvY3VtZW50ZWRcbiAgICAgICAgLy8gcHVibGljbHkuXG4gICAgICAgIC8vIE9iamVjdCBjcmVhdGlvbjogaHR0cDovL2pzcGVyZi5jb20vY3JlYXRlLWNvbnN0cnVjdG9yLzJcbiAgICAgICAgdmFyIGNvbnRyb2xsZXJQcm90b3R5cGUgPSAoaXNBcnJheShleHByZXNzaW9uKSA/XG4gICAgICAgICAgZXhwcmVzc2lvbltleHByZXNzaW9uLmxlbmd0aCAtIDFdIDogZXhwcmVzc2lvbikucHJvdG90eXBlO1xuICAgICAgICBpbnN0YW5jZSA9IE9iamVjdC5jcmVhdGUoY29udHJvbGxlclByb3RvdHlwZSB8fCBudWxsKTtcblxuICAgICAgICBpZiAoaWRlbnRpZmllcikge1xuICAgICAgICAgIGFkZElkZW50aWZpZXIobG9jYWxzLCBpZGVudGlmaWVyLCBpbnN0YW5jZSwgY29uc3RydWN0b3IgfHwgZXhwcmVzc2lvbi5uYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBpbnN0YW50aWF0ZTtcbiAgICAgICAgcmV0dXJuIGluc3RhbnRpYXRlID0gZXh0ZW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciByZXN1bHQgPSAkaW5qZWN0b3IuaW52b2tlKGV4cHJlc3Npb24sIGluc3RhbmNlLCBsb2NhbHMsIGNvbnN0cnVjdG9yKTtcbiAgICAgICAgICBpZiAocmVzdWx0ICE9PSBpbnN0YW5jZSAmJiAoaXNPYmplY3QocmVzdWx0KSB8fCBpc0Z1bmN0aW9uKHJlc3VsdCkpKSB7XG4gICAgICAgICAgICBpbnN0YW5jZSA9IHJlc3VsdDtcbiAgICAgICAgICAgIGlmIChpZGVudGlmaWVyKSB7XG4gICAgICAgICAgICAgIC8vIElmIHJlc3VsdCBjaGFuZ2VkLCByZS1hc3NpZ24gY29udHJvbGxlckFzIHZhbHVlIHRvIHNjb3BlLlxuICAgICAgICAgICAgICBhZGRJZGVudGlmaWVyKGxvY2FscywgaWRlbnRpZmllciwgaW5zdGFuY2UsIGNvbnN0cnVjdG9yIHx8IGV4cHJlc3Npb24ubmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICAgICAgfSwge1xuICAgICAgICAgIGluc3RhbmNlOiBpbnN0YW5jZSxcbiAgICAgICAgICBpZGVudGlmaWVyOiBpZGVudGlmaWVyXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpbnN0YW5jZSA9ICRpbmplY3Rvci5pbnN0YW50aWF0ZShleHByZXNzaW9uLCBsb2NhbHMsIGNvbnN0cnVjdG9yKTtcblxuICAgICAgaWYgKGlkZW50aWZpZXIpIHtcbiAgICAgICAgYWRkSWRlbnRpZmllcihsb2NhbHMsIGlkZW50aWZpZXIsIGluc3RhbmNlLCBjb25zdHJ1Y3RvciB8fCBleHByZXNzaW9uLm5hbWUpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGFkZElkZW50aWZpZXIobG9jYWxzLCBpZGVudGlmaWVyLCBpbnN0YW5jZSwgbmFtZSkge1xuICAgICAgaWYgKCEobG9jYWxzICYmIGlzT2JqZWN0KGxvY2Fscy4kc2NvcGUpKSkge1xuICAgICAgICB0aHJvdyBtaW5FcnIoJyRjb250cm9sbGVyJykoJ25vc2NwJyxcbiAgICAgICAgICBcIkNhbm5vdCBleHBvcnQgY29udHJvbGxlciAnezB9JyBhcyAnezF9JyEgTm8gJHNjb3BlIG9iamVjdCBwcm92aWRlZCB2aWEgYGxvY2Fsc2AuXCIsXG4gICAgICAgICAgbmFtZSwgaWRlbnRpZmllcik7XG4gICAgICB9XG5cbiAgICAgIGxvY2Fscy4kc2NvcGVbaWRlbnRpZmllcl0gPSBpbnN0YW5jZTtcbiAgICB9XG4gIH1dO1xufVxuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkZG9jdW1lbnRcbiAqIEByZXF1aXJlcyAkd2luZG93XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBBIHtAbGluayBhbmd1bGFyLmVsZW1lbnQgalF1ZXJ5IG9yIGpxTGl0ZX0gd3JhcHBlciBmb3IgdGhlIGJyb3dzZXIncyBgd2luZG93LmRvY3VtZW50YCBvYmplY3QuXG4gKlxuICogQGV4YW1wbGVcbiAgIDxleGFtcGxlIG1vZHVsZT1cImRvY3VtZW50RXhhbXBsZVwiPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gICAgICAgICA8cD4kZG9jdW1lbnQgdGl0bGU6IDxiIG5nLWJpbmQ9XCJ0aXRsZVwiPjwvYj48L3A+XG4gICAgICAgICA8cD53aW5kb3cuZG9jdW1lbnQgdGl0bGU6IDxiIG5nLWJpbmQ9XCJ3aW5kb3dUaXRsZVwiPjwvYj48L3A+XG4gICAgICAgPC9kaXY+XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuICAgICAgIGFuZ3VsYXIubW9kdWxlKCdkb2N1bWVudEV4YW1wbGUnLCBbXSlcbiAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRkb2N1bWVudCcsIGZ1bmN0aW9uKCRzY29wZSwgJGRvY3VtZW50KSB7XG4gICAgICAgICAgICRzY29wZS50aXRsZSA9ICRkb2N1bWVudFswXS50aXRsZTtcbiAgICAgICAgICAgJHNjb3BlLndpbmRvd1RpdGxlID0gYW5ndWxhci5lbGVtZW50KHdpbmRvdy5kb2N1bWVudClbMF0udGl0bGU7XG4gICAgICAgICB9XSk7XG4gICAgIDwvZmlsZT5cbiAgIDwvZXhhbXBsZT5cbiAqL1xuZnVuY3Rpb24gJERvY3VtZW50UHJvdmlkZXIoKSB7XG4gIHRoaXMuJGdldCA9IFsnJHdpbmRvdycsIGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIHJldHVybiBqcUxpdGUod2luZG93LmRvY3VtZW50KTtcbiAgfV07XG59XG5cbi8qKlxuICogQG5nZG9jIHNlcnZpY2VcbiAqIEBuYW1lICRleGNlcHRpb25IYW5kbGVyXG4gKiBAcmVxdWlyZXMgbmcuJGxvZ1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQW55IHVuY2F1Z2h0IGV4Y2VwdGlvbiBpbiBhbmd1bGFyIGV4cHJlc3Npb25zIGlzIGRlbGVnYXRlZCB0byB0aGlzIHNlcnZpY2UuXG4gKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBzaW1wbHkgZGVsZWdhdGVzIHRvIGAkbG9nLmVycm9yYCB3aGljaCBsb2dzIGl0IGludG9cbiAqIHRoZSBicm93c2VyIGNvbnNvbGUuXG4gKlxuICogSW4gdW5pdCB0ZXN0cywgaWYgYGFuZ3VsYXItbW9ja3MuanNgIGlzIGxvYWRlZCwgdGhpcyBzZXJ2aWNlIGlzIG92ZXJyaWRkZW4gYnlcbiAqIHtAbGluayBuZ01vY2suJGV4Y2VwdGlvbkhhbmRsZXIgbW9jayAkZXhjZXB0aW9uSGFuZGxlcn0gd2hpY2ggYWlkcyBpbiB0ZXN0aW5nLlxuICpcbiAqICMjIEV4YW1wbGU6XG4gKlxuICogYGBganNcbiAqICAgYW5ndWxhci5tb2R1bGUoJ2V4Y2VwdGlvbk92ZXJyaWRlJywgW10pLmZhY3RvcnkoJyRleGNlcHRpb25IYW5kbGVyJywgZnVuY3Rpb24oKSB7XG4gKiAgICAgcmV0dXJuIGZ1bmN0aW9uKGV4Y2VwdGlvbiwgY2F1c2UpIHtcbiAqICAgICAgIGV4Y2VwdGlvbi5tZXNzYWdlICs9ICcgKGNhdXNlZCBieSBcIicgKyBjYXVzZSArICdcIiknO1xuICogICAgICAgdGhyb3cgZXhjZXB0aW9uO1xuICogICAgIH07XG4gKiAgIH0pO1xuICogYGBgXG4gKlxuICogVGhpcyBleGFtcGxlIHdpbGwgb3ZlcnJpZGUgdGhlIG5vcm1hbCBhY3Rpb24gb2YgYCRleGNlcHRpb25IYW5kbGVyYCwgdG8gbWFrZSBhbmd1bGFyXG4gKiBleGNlcHRpb25zIGZhaWwgaGFyZCB3aGVuIHRoZXkgaGFwcGVuLCBpbnN0ZWFkIG9mIGp1c3QgbG9nZ2luZyB0byB0aGUgY29uc29sZS5cbiAqXG4gKiA8aHIgLz5cbiAqIE5vdGUsIHRoYXQgY29kZSBleGVjdXRlZCBpbiBldmVudC1saXN0ZW5lcnMgKGV2ZW4gdGhvc2UgcmVnaXN0ZXJlZCB1c2luZyBqcUxpdGUncyBgb25gL2BiaW5kYFxuICogbWV0aG9kcykgZG9lcyBub3QgZGVsZWdhdGUgZXhjZXB0aW9ucyB0byB0aGUge0BsaW5rIG5nLiRleGNlcHRpb25IYW5kbGVyICRleGNlcHRpb25IYW5kbGVyfVxuICogKHVubGVzcyBleGVjdXRlZCBkdXJpbmcgYSBkaWdlc3QpLlxuICpcbiAqIElmIHlvdSB3aXNoLCB5b3UgY2FuIG1hbnVhbGx5IGRlbGVnYXRlIGV4Y2VwdGlvbnMsIGUuZy5cbiAqIGB0cnkgeyAuLi4gfSBjYXRjaChlKSB7ICRleGNlcHRpb25IYW5kbGVyKGUpOyB9YFxuICpcbiAqIEBwYXJhbSB7RXJyb3J9IGV4Y2VwdGlvbiBFeGNlcHRpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBlcnJvci5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gY2F1c2Ugb3B0aW9uYWwgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGNvbnRleHQgaW4gd2hpY2hcbiAqICAgICAgIHRoZSBlcnJvciB3YXMgdGhyb3duLlxuICpcbiAqL1xuZnVuY3Rpb24gJEV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcigpIHtcbiAgdGhpcy4kZ2V0ID0gWyckbG9nJywgZnVuY3Rpb24oJGxvZykge1xuICAgIHJldHVybiBmdW5jdGlvbihleGNlcHRpb24sIGNhdXNlKSB7XG4gICAgICAkbG9nLmVycm9yLmFwcGx5KCRsb2csIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfV07XG59XG5cbnZhciAkJEZvcmNlUmVmbG93UHJvdmlkZXIgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy4kZ2V0ID0gWyckZG9jdW1lbnQnLCBmdW5jdGlvbigkZG9jdW1lbnQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oZG9tTm9kZSkge1xuICAgICAgLy90aGUgbGluZSBiZWxvdyB3aWxsIGZvcmNlIHRoZSBicm93c2VyIHRvIHBlcmZvcm0gYSByZXBhaW50IHNvXG4gICAgICAvL3RoYXQgYWxsIHRoZSBhbmltYXRlZCBlbGVtZW50cyB3aXRoaW4gdGhlIGFuaW1hdGlvbiBmcmFtZSB3aWxsXG4gICAgICAvL2JlIHByb3Blcmx5IHVwZGF0ZWQgYW5kIGRyYXduIG9uIHNjcmVlbi4gVGhpcyBpcyByZXF1aXJlZCB0b1xuICAgICAgLy9lbnN1cmUgdGhhdCB0aGUgcHJlcGFyYXRpb24gYW5pbWF0aW9uIGlzIHByb3Blcmx5IGZsdXNoZWQgc28gdGhhdFxuICAgICAgLy90aGUgYWN0aXZlIHN0YXRlIHBpY2tzIHVwIGZyb20gdGhlcmUuIERPIE5PVCBSRU1PVkUgVEhJUyBMSU5FLlxuICAgICAgLy9ETyBOT1QgT1BUSU1JWkUgVEhJUyBMSU5FLiBUSEUgTUlOSUZJRVIgV0lMTCBSRU1PVkUgSVQgT1RIRVJXSVNFIFdISUNIXG4gICAgICAvL1dJTEwgUkVTVUxUIElOIEFOIFVOUFJFRElDVEFCTEUgQlVHIFRIQVQgSVMgVkVSWSBIQVJEIFRPIFRSQUNLIERPV04gQU5EXG4gICAgICAvL1dJTEwgVEFLRSBZRUFSUyBBV0FZIEZST00gWU9VUiBMSUZFLlxuICAgICAgaWYgKGRvbU5vZGUpIHtcbiAgICAgICAgaWYgKCFkb21Ob2RlLm5vZGVUeXBlICYmIGRvbU5vZGUgaW5zdGFuY2VvZiBqcUxpdGUpIHtcbiAgICAgICAgICBkb21Ob2RlID0gZG9tTm9kZVswXTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZG9tTm9kZSA9ICRkb2N1bWVudFswXS5ib2R5O1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRvbU5vZGUub2Zmc2V0V2lkdGggKyAxO1xuICAgIH07XG4gIH1dO1xufTtcblxudmFyIEFQUExJQ0FUSU9OX0pTT04gPSAnYXBwbGljYXRpb24vanNvbic7XG52YXIgQ09OVEVOVF9UWVBFX0FQUExJQ0FUSU9OX0pTT04gPSB7J0NvbnRlbnQtVHlwZSc6IEFQUExJQ0FUSU9OX0pTT04gKyAnO2NoYXJzZXQ9dXRmLTgnfTtcbnZhciBKU09OX1NUQVJUID0gL15cXFt8Xlxceyg/IVxceykvO1xudmFyIEpTT05fRU5EUyA9IHtcbiAgJ1snOiAvXSQvLFxuICAneyc6IC99JC9cbn07XG52YXIgSlNPTl9QUk9URUNUSU9OX1BSRUZJWCA9IC9eXFwpXFxdXFx9Jyw/XFxuLztcbnZhciAkaHR0cE1pbkVyciA9IG1pbkVycignJGh0dHAnKTtcbnZhciAkaHR0cE1pbkVyckxlZ2FjeUZuID0gZnVuY3Rpb24obWV0aG9kKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB0aHJvdyAkaHR0cE1pbkVycignbGVnYWN5JywgJ1RoZSBtZXRob2QgYHswfWAgb24gdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbSBgJGh0dHBgIGhhcyBiZWVuIGRpc2FibGVkLicsIG1ldGhvZCk7XG4gIH07XG59O1xuXG5mdW5jdGlvbiBzZXJpYWxpemVWYWx1ZSh2KSB7XG4gIGlmIChpc09iamVjdCh2KSkge1xuICAgIHJldHVybiBpc0RhdGUodikgPyB2LnRvSVNPU3RyaW5nKCkgOiB0b0pzb24odik7XG4gIH1cbiAgcmV0dXJuIHY7XG59XG5cblxuZnVuY3Rpb24gJEh0dHBQYXJhbVNlcmlhbGl6ZXJQcm92aWRlcigpIHtcbiAgLyoqXG4gICAqIEBuZ2RvYyBzZXJ2aWNlXG4gICAqIEBuYW1lICRodHRwUGFyYW1TZXJpYWxpemVyXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBEZWZhdWx0IHtAbGluayAkaHR0cCBgJGh0dHBgfSBwYXJhbXMgc2VyaWFsaXplciB0aGF0IGNvbnZlcnRzIG9iamVjdHMgdG8gc3RyaW5nc1xuICAgKiBhY2NvcmRpbmcgdG8gdGhlIGZvbGxvd2luZyBydWxlczpcbiAgICpcbiAgICogKiBgeydmb28nOiAnYmFyJ31gIHJlc3VsdHMgaW4gYGZvbz1iYXJgXG4gICAqICogYHsnZm9vJzogRGF0ZS5ub3coKX1gIHJlc3VsdHMgaW4gYGZvbz0yMDE1LTA0LTAxVDA5JTNBNTAlM0E0OS4yNjJaYCAoYHRvSVNPU3RyaW5nKClgIGFuZCBlbmNvZGVkIHJlcHJlc2VudGF0aW9uIG9mIGEgRGF0ZSBvYmplY3QpXG4gICAqICogYHsnZm9vJzogWydiYXInLCAnYmF6J119YCByZXN1bHRzIGluIGBmb289YmFyJmZvbz1iYXpgIChyZXBlYXRlZCBrZXkgZm9yIGVhY2ggYXJyYXkgZWxlbWVudClcbiAgICogKiBgeydmb28nOiB7J2Jhcic6J2Jheid9fWAgcmVzdWx0cyBpbiBgZm9vPSU3QiUyMmJhciUyMiUzQSUyMmJheiUyMiU3RFwiYCAoc3RyaW5naWZpZWQgYW5kIGVuY29kZWQgcmVwcmVzZW50YXRpb24gb2YgYW4gb2JqZWN0KVxuICAgKlxuICAgKiBOb3RlIHRoYXQgc2VyaWFsaXplciB3aWxsIHNvcnQgdGhlIHJlcXVlc3QgcGFyYW1ldGVycyBhbHBoYWJldGljYWxseS5cbiAgICogKi9cblxuICB0aGlzLiRnZXQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gbmdQYXJhbVNlcmlhbGl6ZXIocGFyYW1zKSB7XG4gICAgICBpZiAoIXBhcmFtcykgcmV0dXJuICcnO1xuICAgICAgdmFyIHBhcnRzID0gW107XG4gICAgICBmb3JFYWNoU29ydGVkKHBhcmFtcywgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgaXNVbmRlZmluZWQodmFsdWUpKSByZXR1cm47XG4gICAgICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgIGZvckVhY2godmFsdWUsIGZ1bmN0aW9uKHYsIGspIHtcbiAgICAgICAgICAgIHBhcnRzLnB1c2goZW5jb2RlVXJpUXVlcnkoa2V5KSAgKyAnPScgKyBlbmNvZGVVcmlRdWVyeShzZXJpYWxpemVWYWx1ZSh2KSkpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBhcnRzLnB1c2goZW5jb2RlVXJpUXVlcnkoa2V5KSArICc9JyArIGVuY29kZVVyaVF1ZXJ5KHNlcmlhbGl6ZVZhbHVlKHZhbHVlKSkpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJyYnKTtcbiAgICB9O1xuICB9O1xufVxuXG5mdW5jdGlvbiAkSHR0cFBhcmFtU2VyaWFsaXplckpRTGlrZVByb3ZpZGVyKCkge1xuICAvKipcbiAgICogQG5nZG9jIHNlcnZpY2VcbiAgICogQG5hbWUgJGh0dHBQYXJhbVNlcmlhbGl6ZXJKUUxpa2VcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIEFsdGVybmF0aXZlIHtAbGluayAkaHR0cCBgJGh0dHBgfSBwYXJhbXMgc2VyaWFsaXplciB0aGF0IGZvbGxvd3NcbiAgICogalF1ZXJ5J3MgW2BwYXJhbSgpYF0oaHR0cDovL2FwaS5qcXVlcnkuY29tL2pxdWVyeS5wYXJhbS8pIG1ldGhvZCBsb2dpYy5cbiAgICogVGhlIHNlcmlhbGl6ZXIgd2lsbCBhbHNvIHNvcnQgdGhlIHBhcmFtcyBhbHBoYWJldGljYWxseS5cbiAgICpcbiAgICogVG8gdXNlIGl0IGZvciBzZXJpYWxpemluZyBgJGh0dHBgIHJlcXVlc3QgcGFyYW1ldGVycywgc2V0IGl0IGFzIHRoZSBgcGFyYW1TZXJpYWxpemVyYCBwcm9wZXJ0eTpcbiAgICpcbiAgICogYGBganNcbiAgICogJGh0dHAoe1xuICAgKiAgIHVybDogbXlVcmwsXG4gICAqICAgbWV0aG9kOiAnR0VUJyxcbiAgICogICBwYXJhbXM6IG15UGFyYW1zLFxuICAgKiAgIHBhcmFtU2VyaWFsaXplcjogJyRodHRwUGFyYW1TZXJpYWxpemVySlFMaWtlJ1xuICAgKiB9KTtcbiAgICogYGBgXG4gICAqXG4gICAqIEl0IGlzIGFsc28gcG9zc2libGUgdG8gc2V0IGl0IGFzIHRoZSBkZWZhdWx0IGBwYXJhbVNlcmlhbGl6ZXJgIGluIHRoZVxuICAgKiB7QGxpbmsgJGh0dHBQcm92aWRlciNkZWZhdWx0cyBgJGh0dHBQcm92aWRlcmB9LlxuICAgKlxuICAgKiBBZGRpdGlvbmFsbHksIHlvdSBjYW4gaW5qZWN0IHRoZSBzZXJpYWxpemVyIGFuZCB1c2UgaXQgZXhwbGljaXRseSwgZm9yIGV4YW1wbGUgdG8gc2VyaWFsaXplXG4gICAqIGZvcm0gZGF0YSBmb3Igc3VibWlzc2lvbjpcbiAgICpcbiAgICogYGBganNcbiAgICogLmNvbnRyb2xsZXIoZnVuY3Rpb24oJGh0dHAsICRodHRwUGFyYW1TZXJpYWxpemVySlFMaWtlKSB7XG4gICAqICAgLy8uLi5cbiAgICpcbiAgICogICAkaHR0cCh7XG4gICAqICAgICB1cmw6IG15VXJsLFxuICAgKiAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAqICAgICBkYXRhOiAkaHR0cFBhcmFtU2VyaWFsaXplckpRTGlrZShteURhdGEpLFxuICAgKiAgICAgaGVhZGVyczoge1xuICAgKiAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbiAgICogICAgIH1cbiAgICogICB9KTtcbiAgICpcbiAgICogfSk7XG4gICAqIGBgYFxuICAgKlxuICAgKiAqL1xuICB0aGlzLiRnZXQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24galF1ZXJ5TGlrZVBhcmFtU2VyaWFsaXplcihwYXJhbXMpIHtcbiAgICAgIGlmICghcGFyYW1zKSByZXR1cm4gJyc7XG4gICAgICB2YXIgcGFydHMgPSBbXTtcbiAgICAgIHNlcmlhbGl6ZShwYXJhbXMsICcnLCB0cnVlKTtcbiAgICAgIHJldHVybiBwYXJ0cy5qb2luKCcmJyk7XG5cbiAgICAgIGZ1bmN0aW9uIHNlcmlhbGl6ZSh0b1NlcmlhbGl6ZSwgcHJlZml4LCB0b3BMZXZlbCkge1xuICAgICAgICBpZiAodG9TZXJpYWxpemUgPT09IG51bGwgfHwgaXNVbmRlZmluZWQodG9TZXJpYWxpemUpKSByZXR1cm47XG4gICAgICAgIGlmIChpc0FycmF5KHRvU2VyaWFsaXplKSkge1xuICAgICAgICAgIGZvckVhY2godG9TZXJpYWxpemUsIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCkge1xuICAgICAgICAgICAgc2VyaWFsaXplKHZhbHVlLCBwcmVmaXggKyAnWycgKyAoaXNPYmplY3QodmFsdWUpID8gaW5kZXggOiAnJykgKyAnXScpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGlzT2JqZWN0KHRvU2VyaWFsaXplKSAmJiAhaXNEYXRlKHRvU2VyaWFsaXplKSkge1xuICAgICAgICAgIGZvckVhY2hTb3J0ZWQodG9TZXJpYWxpemUsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgIHNlcmlhbGl6ZSh2YWx1ZSwgcHJlZml4ICtcbiAgICAgICAgICAgICAgICAodG9wTGV2ZWwgPyAnJyA6ICdbJykgK1xuICAgICAgICAgICAgICAgIGtleSArXG4gICAgICAgICAgICAgICAgKHRvcExldmVsID8gJycgOiAnXScpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwYXJ0cy5wdXNoKGVuY29kZVVyaVF1ZXJ5KHByZWZpeCkgKyAnPScgKyBlbmNvZGVVcmlRdWVyeShzZXJpYWxpemVWYWx1ZSh0b1NlcmlhbGl6ZSkpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH07XG59XG5cbmZ1bmN0aW9uIGRlZmF1bHRIdHRwUmVzcG9uc2VUcmFuc2Zvcm0oZGF0YSwgaGVhZGVycykge1xuICBpZiAoaXNTdHJpbmcoZGF0YSkpIHtcbiAgICAvLyBTdHJpcCBqc29uIHZ1bG5lcmFiaWxpdHkgcHJvdGVjdGlvbiBwcmVmaXggYW5kIHRyaW0gd2hpdGVzcGFjZVxuICAgIHZhciB0ZW1wRGF0YSA9IGRhdGEucmVwbGFjZShKU09OX1BST1RFQ1RJT05fUFJFRklYLCAnJykudHJpbSgpO1xuXG4gICAgaWYgKHRlbXBEYXRhKSB7XG4gICAgICB2YXIgY29udGVudFR5cGUgPSBoZWFkZXJzKCdDb250ZW50LVR5cGUnKTtcbiAgICAgIGlmICgoY29udGVudFR5cGUgJiYgKGNvbnRlbnRUeXBlLmluZGV4T2YoQVBQTElDQVRJT05fSlNPTikgPT09IDApKSB8fCBpc0pzb25MaWtlKHRlbXBEYXRhKSkge1xuICAgICAgICBkYXRhID0gZnJvbUpzb24odGVtcERhdGEpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBkYXRhO1xufVxuXG5mdW5jdGlvbiBpc0pzb25MaWtlKHN0cikge1xuICAgIHZhciBqc29uU3RhcnQgPSBzdHIubWF0Y2goSlNPTl9TVEFSVCk7XG4gICAgcmV0dXJuIGpzb25TdGFydCAmJiBKU09OX0VORFNbanNvblN0YXJ0WzBdXS50ZXN0KHN0cik7XG59XG5cbi8qKlxuICogUGFyc2UgaGVhZGVycyBpbnRvIGtleSB2YWx1ZSBvYmplY3RcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gaGVhZGVycyBSYXcgaGVhZGVycyBhcyBhIHN0cmluZ1xuICogQHJldHVybnMge09iamVjdH0gUGFyc2VkIGhlYWRlcnMgYXMga2V5IHZhbHVlIG9iamVjdFxuICovXG5mdW5jdGlvbiBwYXJzZUhlYWRlcnMoaGVhZGVycykge1xuICB2YXIgcGFyc2VkID0gY3JlYXRlTWFwKCksIGk7XG5cbiAgZnVuY3Rpb24gZmlsbEluUGFyc2VkKGtleSwgdmFsKSB7XG4gICAgaWYgKGtleSkge1xuICAgICAgcGFyc2VkW2tleV0gPSBwYXJzZWRba2V5XSA/IHBhcnNlZFtrZXldICsgJywgJyArIHZhbCA6IHZhbDtcbiAgICB9XG4gIH1cblxuICBpZiAoaXNTdHJpbmcoaGVhZGVycykpIHtcbiAgICBmb3JFYWNoKGhlYWRlcnMuc3BsaXQoJ1xcbicpLCBmdW5jdGlvbihsaW5lKSB7XG4gICAgICBpID0gbGluZS5pbmRleE9mKCc6Jyk7XG4gICAgICBmaWxsSW5QYXJzZWQobG93ZXJjYXNlKHRyaW0obGluZS5zdWJzdHIoMCwgaSkpKSwgdHJpbShsaW5lLnN1YnN0cihpICsgMSkpKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmIChpc09iamVjdChoZWFkZXJzKSkge1xuICAgIGZvckVhY2goaGVhZGVycywgZnVuY3Rpb24oaGVhZGVyVmFsLCBoZWFkZXJLZXkpIHtcbiAgICAgIGZpbGxJblBhcnNlZChsb3dlcmNhc2UoaGVhZGVyS2V5KSwgdHJpbShoZWFkZXJWYWwpKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBwYXJzZWQ7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCBwcm92aWRlcyBhY2Nlc3MgdG8gcGFyc2VkIGhlYWRlcnMuXG4gKlxuICogSGVhZGVycyBhcmUgbGF6eSBwYXJzZWQgd2hlbiBmaXJzdCByZXF1ZXN0ZWQuXG4gKiBAc2VlIHBhcnNlSGVhZGVyc1xuICpcbiAqIEBwYXJhbSB7KHN0cmluZ3xPYmplY3QpfSBoZWFkZXJzIEhlYWRlcnMgdG8gcHJvdmlkZSBhY2Nlc3MgdG8uXG4gKiBAcmV0dXJucyB7ZnVuY3Rpb24oc3RyaW5nPSl9IFJldHVybnMgYSBnZXR0ZXIgZnVuY3Rpb24gd2hpY2ggaWYgY2FsbGVkIHdpdGg6XG4gKlxuICogICAtIGlmIGNhbGxlZCB3aXRoIHNpbmdsZSBhbiBhcmd1bWVudCByZXR1cm5zIGEgc2luZ2xlIGhlYWRlciB2YWx1ZSBvciBudWxsXG4gKiAgIC0gaWYgY2FsbGVkIHdpdGggbm8gYXJndW1lbnRzIHJldHVybnMgYW4gb2JqZWN0IGNvbnRhaW5pbmcgYWxsIGhlYWRlcnMuXG4gKi9cbmZ1bmN0aW9uIGhlYWRlcnNHZXR0ZXIoaGVhZGVycykge1xuICB2YXIgaGVhZGVyc09iajtcblxuICByZXR1cm4gZnVuY3Rpb24obmFtZSkge1xuICAgIGlmICghaGVhZGVyc09iaikgaGVhZGVyc09iaiA9ICBwYXJzZUhlYWRlcnMoaGVhZGVycyk7XG5cbiAgICBpZiAobmFtZSkge1xuICAgICAgdmFyIHZhbHVlID0gaGVhZGVyc09ialtsb3dlcmNhc2UobmFtZSldO1xuICAgICAgaWYgKHZhbHVlID09PSB2b2lkIDApIHtcbiAgICAgICAgdmFsdWUgPSBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIHJldHVybiBoZWFkZXJzT2JqO1xuICB9O1xufVxuXG5cbi8qKlxuICogQ2hhaW4gYWxsIGdpdmVuIGZ1bmN0aW9uc1xuICpcbiAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCBmb3IgYm90aCByZXF1ZXN0IGFuZCByZXNwb25zZSB0cmFuc2Zvcm1pbmdcbiAqXG4gKiBAcGFyYW0geyp9IGRhdGEgRGF0YSB0byB0cmFuc2Zvcm0uXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZz0pfSBoZWFkZXJzIEhUVFAgaGVhZGVycyBnZXR0ZXIgZm4uXG4gKiBAcGFyYW0ge251bWJlcn0gc3RhdHVzIEhUVFAgc3RhdHVzIGNvZGUgb2YgdGhlIHJlc3BvbnNlLlxuICogQHBhcmFtIHsoRnVuY3Rpb258QXJyYXkuPEZ1bmN0aW9uPil9IGZucyBGdW5jdGlvbiBvciBhbiBhcnJheSBvZiBmdW5jdGlvbnMuXG4gKiBAcmV0dXJucyB7Kn0gVHJhbnNmb3JtZWQgZGF0YS5cbiAqL1xuZnVuY3Rpb24gdHJhbnNmb3JtRGF0YShkYXRhLCBoZWFkZXJzLCBzdGF0dXMsIGZucykge1xuICBpZiAoaXNGdW5jdGlvbihmbnMpKSB7XG4gICAgcmV0dXJuIGZucyhkYXRhLCBoZWFkZXJzLCBzdGF0dXMpO1xuICB9XG5cbiAgZm9yRWFjaChmbnMsIGZ1bmN0aW9uKGZuKSB7XG4gICAgZGF0YSA9IGZuKGRhdGEsIGhlYWRlcnMsIHN0YXR1cyk7XG4gIH0pO1xuXG4gIHJldHVybiBkYXRhO1xufVxuXG5cbmZ1bmN0aW9uIGlzU3VjY2VzcyhzdGF0dXMpIHtcbiAgcmV0dXJuIDIwMCA8PSBzdGF0dXMgJiYgc3RhdHVzIDwgMzAwO1xufVxuXG5cbi8qKlxuICogQG5nZG9jIHByb3ZpZGVyXG4gKiBAbmFtZSAkaHR0cFByb3ZpZGVyXG4gKiBAZGVzY3JpcHRpb25cbiAqIFVzZSBgJGh0dHBQcm92aWRlcmAgdG8gY2hhbmdlIHRoZSBkZWZhdWx0IGJlaGF2aW9yIG9mIHRoZSB7QGxpbmsgbmcuJGh0dHAgJGh0dHB9IHNlcnZpY2UuXG4gKiAqL1xuZnVuY3Rpb24gJEh0dHBQcm92aWRlcigpIHtcbiAgLyoqXG4gICAqIEBuZ2RvYyBwcm9wZXJ0eVxuICAgKiBAbmFtZSAkaHR0cFByb3ZpZGVyI2RlZmF1bHRzXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBPYmplY3QgY29udGFpbmluZyBkZWZhdWx0IHZhbHVlcyBmb3IgYWxsIHtAbGluayBuZy4kaHR0cCAkaHR0cH0gcmVxdWVzdHMuXG4gICAqXG4gICAqIC0gKipgZGVmYXVsdHMuY2FjaGVgKiogLSB7T2JqZWN0fSAtIGFuIG9iamVjdCBidWlsdCB3aXRoIHtAbGluayBuZy4kY2FjaGVGYWN0b3J5IGAkY2FjaGVGYWN0b3J5YH1cbiAgICogdGhhdCB3aWxsIHByb3ZpZGUgdGhlIGNhY2hlIGZvciBhbGwgcmVxdWVzdHMgd2hvIHNldCB0aGVpciBgY2FjaGVgIHByb3BlcnR5IHRvIGB0cnVlYC5cbiAgICogSWYgeW91IHNldCB0aGUgYGRlZmF1bHRzLmNhY2hlID0gZmFsc2VgIHRoZW4gb25seSByZXF1ZXN0cyB0aGF0IHNwZWNpZnkgdGhlaXIgb3duIGN1c3RvbVxuICAgKiBjYWNoZSBvYmplY3Qgd2lsbCBiZSBjYWNoZWQuIFNlZSB7QGxpbmsgJGh0dHAjY2FjaGluZyAkaHR0cCBDYWNoaW5nfSBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAgICpcbiAgICogLSAqKmBkZWZhdWx0cy54c3JmQ29va2llTmFtZWAqKiAtIHtzdHJpbmd9IC0gTmFtZSBvZiBjb29raWUgY29udGFpbmluZyB0aGUgWFNSRiB0b2tlbi5cbiAgICogRGVmYXVsdHMgdmFsdWUgaXMgYCdYU1JGLVRPS0VOJ2AuXG4gICAqXG4gICAqIC0gKipgZGVmYXVsdHMueHNyZkhlYWRlck5hbWVgKiogLSB7c3RyaW5nfSAtIE5hbWUgb2YgSFRUUCBoZWFkZXIgdG8gcG9wdWxhdGUgd2l0aCB0aGVcbiAgICogWFNSRiB0b2tlbi4gRGVmYXVsdHMgdmFsdWUgaXMgYCdYLVhTUkYtVE9LRU4nYC5cbiAgICpcbiAgICogLSAqKmBkZWZhdWx0cy5oZWFkZXJzYCoqIC0ge09iamVjdH0gLSBEZWZhdWx0IGhlYWRlcnMgZm9yIGFsbCAkaHR0cCByZXF1ZXN0cy5cbiAgICogUmVmZXIgdG8ge0BsaW5rIG5nLiRodHRwI3NldHRpbmctaHR0cC1oZWFkZXJzICRodHRwfSBmb3IgZG9jdW1lbnRhdGlvbiBvblxuICAgKiBzZXR0aW5nIGRlZmF1bHQgaGVhZGVycy5cbiAgICogICAgIC0gKipgZGVmYXVsdHMuaGVhZGVycy5jb21tb25gKipcbiAgICogICAgIC0gKipgZGVmYXVsdHMuaGVhZGVycy5wb3N0YCoqXG4gICAqICAgICAtICoqYGRlZmF1bHRzLmhlYWRlcnMucHV0YCoqXG4gICAqICAgICAtICoqYGRlZmF1bHRzLmhlYWRlcnMucGF0Y2hgKipcbiAgICpcbiAgICpcbiAgICogLSAqKmBkZWZhdWx0cy5wYXJhbVNlcmlhbGl6ZXJgKiogLSBge3N0cmluZ3xmdW5jdGlvbihPYmplY3Q8c3RyaW5nLHN0cmluZz4pOnN0cmluZ31gIC0gQSBmdW5jdGlvblxuICAgKiAgdXNlZCB0byB0aGUgcHJlcGFyZSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgcmVxdWVzdCBwYXJhbWV0ZXJzIChzcGVjaWZpZWQgYXMgYW4gb2JqZWN0KS5cbiAgICogIElmIHNwZWNpZmllZCBhcyBzdHJpbmcsIGl0IGlzIGludGVycHJldGVkIGFzIGEgZnVuY3Rpb24gcmVnaXN0ZXJlZCB3aXRoIHRoZSB7QGxpbmsgYXV0by4kaW5qZWN0b3IgJGluamVjdG9yfS5cbiAgICogIERlZmF1bHRzIHRvIHtAbGluayBuZy4kaHR0cFBhcmFtU2VyaWFsaXplciAkaHR0cFBhcmFtU2VyaWFsaXplcn0uXG4gICAqXG4gICAqKi9cbiAgdmFyIGRlZmF1bHRzID0gdGhpcy5kZWZhdWx0cyA9IHtcbiAgICAvLyB0cmFuc2Zvcm0gaW5jb21pbmcgcmVzcG9uc2UgZGF0YVxuICAgIHRyYW5zZm9ybVJlc3BvbnNlOiBbZGVmYXVsdEh0dHBSZXNwb25zZVRyYW5zZm9ybV0sXG5cbiAgICAvLyB0cmFuc2Zvcm0gb3V0Z29pbmcgcmVxdWVzdCBkYXRhXG4gICAgdHJhbnNmb3JtUmVxdWVzdDogW2Z1bmN0aW9uKGQpIHtcbiAgICAgIHJldHVybiBpc09iamVjdChkKSAmJiAhaXNGaWxlKGQpICYmICFpc0Jsb2IoZCkgJiYgIWlzRm9ybURhdGEoZCkgPyB0b0pzb24oZCkgOiBkO1xuICAgIH1dLFxuXG4gICAgLy8gZGVmYXVsdCBoZWFkZXJzXG4gICAgaGVhZGVyczoge1xuICAgICAgY29tbW9uOiB7XG4gICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qJ1xuICAgICAgfSxcbiAgICAgIHBvc3Q6ICAgc2hhbGxvd0NvcHkoQ09OVEVOVF9UWVBFX0FQUExJQ0FUSU9OX0pTT04pLFxuICAgICAgcHV0OiAgICBzaGFsbG93Q29weShDT05URU5UX1RZUEVfQVBQTElDQVRJT05fSlNPTiksXG4gICAgICBwYXRjaDogIHNoYWxsb3dDb3B5KENPTlRFTlRfVFlQRV9BUFBMSUNBVElPTl9KU09OKVxuICAgIH0sXG5cbiAgICB4c3JmQ29va2llTmFtZTogJ1hTUkYtVE9LRU4nLFxuICAgIHhzcmZIZWFkZXJOYW1lOiAnWC1YU1JGLVRPS0VOJyxcblxuICAgIHBhcmFtU2VyaWFsaXplcjogJyRodHRwUGFyYW1TZXJpYWxpemVyJ1xuICB9O1xuXG4gIHZhciB1c2VBcHBseUFzeW5jID0gZmFsc2U7XG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRodHRwUHJvdmlkZXIjdXNlQXBwbHlBc3luY1xuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogQ29uZmlndXJlICRodHRwIHNlcnZpY2UgdG8gY29tYmluZSBwcm9jZXNzaW5nIG9mIG11bHRpcGxlIGh0dHAgcmVzcG9uc2VzIHJlY2VpdmVkIGF0IGFyb3VuZFxuICAgKiB0aGUgc2FtZSB0aW1lIHZpYSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkYXBwbHlBc3luYyAkcm9vdFNjb3BlLiRhcHBseUFzeW5jfS4gVGhpcyBjYW4gcmVzdWx0IGluXG4gICAqIHNpZ25pZmljYW50IHBlcmZvcm1hbmNlIGltcHJvdmVtZW50IGZvciBiaWdnZXIgYXBwbGljYXRpb25zIHRoYXQgbWFrZSBtYW55IEhUVFAgcmVxdWVzdHNcbiAgICogY29uY3VycmVudGx5IChjb21tb24gZHVyaW5nIGFwcGxpY2F0aW9uIGJvb3RzdHJhcCkuXG4gICAqXG4gICAqIERlZmF1bHRzIHRvIGZhbHNlLiBJZiBubyB2YWx1ZSBpcyBzcGVjaWZpZWQsIHJldHVybnMgdGhlIGN1cnJlbnQgY29uZmlndXJlZCB2YWx1ZS5cbiAgICpcbiAgICogQHBhcmFtIHtib29sZWFuPX0gdmFsdWUgSWYgdHJ1ZSwgd2hlbiByZXF1ZXN0cyBhcmUgbG9hZGVkLCB0aGV5IHdpbGwgc2NoZWR1bGUgYSBkZWZlcnJlZFxuICAgKiAgICBcImFwcGx5XCIgb24gdGhlIG5leHQgdGljaywgZ2l2aW5nIHRpbWUgZm9yIHN1YnNlcXVlbnQgcmVxdWVzdHMgaW4gYSByb3VnaGx5IH4xMG1zIHdpbmRvd1xuICAgKiAgICB0byBsb2FkIGFuZCBzaGFyZSB0aGUgc2FtZSBkaWdlc3QgY3ljbGUuXG4gICAqXG4gICAqIEByZXR1cm5zIHtib29sZWFufE9iamVjdH0gSWYgYSB2YWx1ZSBpcyBzcGVjaWZpZWQsIHJldHVybnMgdGhlICRodHRwUHJvdmlkZXIgZm9yIGNoYWluaW5nLlxuICAgKiAgICBvdGhlcndpc2UsIHJldHVybnMgdGhlIGN1cnJlbnQgY29uZmlndXJlZCB2YWx1ZS5cbiAgICoqL1xuICB0aGlzLnVzZUFwcGx5QXN5bmMgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIGlmIChpc0RlZmluZWQodmFsdWUpKSB7XG4gICAgICB1c2VBcHBseUFzeW5jID0gISF2YWx1ZTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gdXNlQXBwbHlBc3luYztcbiAgfTtcblxuICB2YXIgdXNlTGVnYWN5UHJvbWlzZSA9IHRydWU7XG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRodHRwUHJvdmlkZXIjdXNlTGVnYWN5UHJvbWlzZUV4dGVuc2lvbnNcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIENvbmZpZ3VyZSBgJGh0dHBgIHNlcnZpY2UgdG8gcmV0dXJuIHByb21pc2VzIHdpdGhvdXQgdGhlIHNob3J0aGFuZCBtZXRob2RzIGBzdWNjZXNzYCBhbmQgYGVycm9yYC5cbiAgICogVGhpcyBzaG91bGQgYmUgdXNlZCB0byBtYWtlIHN1cmUgdGhhdCBhcHBsaWNhdGlvbnMgd29yayB3aXRob3V0IHRoZXNlIG1ldGhvZHMuXG4gICAqXG4gICAqIERlZmF1bHRzIHRvIHRydWUuIElmIG5vIHZhbHVlIGlzIHNwZWNpZmllZCwgcmV0dXJucyB0aGUgY3VycmVudCBjb25maWd1cmVkIHZhbHVlLlxuICAgKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSB2YWx1ZSBJZiB0cnVlLCBgJGh0dHBgIHdpbGwgcmV0dXJuIGEgcHJvbWlzZSB3aXRoIHRoZSBkZXByZWNhdGVkIGxlZ2FjeSBgc3VjY2Vzc2AgYW5kIGBlcnJvcmAgbWV0aG9kcy5cbiAgICpcbiAgICogQHJldHVybnMge2Jvb2xlYW58T2JqZWN0fSBJZiBhIHZhbHVlIGlzIHNwZWNpZmllZCwgcmV0dXJucyB0aGUgJGh0dHBQcm92aWRlciBmb3IgY2hhaW5pbmcuXG4gICAqICAgIG90aGVyd2lzZSwgcmV0dXJucyB0aGUgY3VycmVudCBjb25maWd1cmVkIHZhbHVlLlxuICAgKiovXG4gIHRoaXMudXNlTGVnYWN5UHJvbWlzZUV4dGVuc2lvbnMgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIGlmIChpc0RlZmluZWQodmFsdWUpKSB7XG4gICAgICB1c2VMZWdhY3lQcm9taXNlID0gISF2YWx1ZTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gdXNlTGVnYWN5UHJvbWlzZTtcbiAgfTtcblxuICAvKipcbiAgICogQG5nZG9jIHByb3BlcnR5XG4gICAqIEBuYW1lICRodHRwUHJvdmlkZXIjaW50ZXJjZXB0b3JzXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBBcnJheSBjb250YWluaW5nIHNlcnZpY2UgZmFjdG9yaWVzIGZvciBhbGwgc3luY2hyb25vdXMgb3IgYXN5bmNocm9ub3VzIHtAbGluayBuZy4kaHR0cCAkaHR0cH1cbiAgICogcHJlLXByb2Nlc3Npbmcgb2YgcmVxdWVzdCBvciBwb3N0cHJvY2Vzc2luZyBvZiByZXNwb25zZXMuXG4gICAqXG4gICAqIFRoZXNlIHNlcnZpY2UgZmFjdG9yaWVzIGFyZSBvcmRlcmVkIGJ5IHJlcXVlc3QsIGkuZS4gdGhleSBhcmUgYXBwbGllZCBpbiB0aGUgc2FtZSBvcmRlciBhcyB0aGVcbiAgICogYXJyYXksIG9uIHJlcXVlc3QsIGJ1dCByZXZlcnNlIG9yZGVyLCBvbiByZXNwb25zZS5cbiAgICpcbiAgICoge0BsaW5rIG5nLiRodHRwI2ludGVyY2VwdG9ycyBJbnRlcmNlcHRvcnMgZGV0YWlsZWQgaW5mb31cbiAgICoqL1xuICB2YXIgaW50ZXJjZXB0b3JGYWN0b3JpZXMgPSB0aGlzLmludGVyY2VwdG9ycyA9IFtdO1xuXG4gIHRoaXMuJGdldCA9IFsnJGh0dHBCYWNrZW5kJywgJyQkY29va2llUmVhZGVyJywgJyRjYWNoZUZhY3RvcnknLCAnJHJvb3RTY29wZScsICckcScsICckaW5qZWN0b3InLFxuICAgICAgZnVuY3Rpb24oJGh0dHBCYWNrZW5kLCAkJGNvb2tpZVJlYWRlciwgJGNhY2hlRmFjdG9yeSwgJHJvb3RTY29wZSwgJHEsICRpbmplY3Rvcikge1xuXG4gICAgdmFyIGRlZmF1bHRDYWNoZSA9ICRjYWNoZUZhY3RvcnkoJyRodHRwJyk7XG5cbiAgICAvKipcbiAgICAgKiBNYWtlIHN1cmUgdGhhdCBkZWZhdWx0IHBhcmFtIHNlcmlhbGl6ZXIgaXMgZXhwb3NlZCBhcyBhIGZ1bmN0aW9uXG4gICAgICovXG4gICAgZGVmYXVsdHMucGFyYW1TZXJpYWxpemVyID0gaXNTdHJpbmcoZGVmYXVsdHMucGFyYW1TZXJpYWxpemVyKSA/XG4gICAgICAkaW5qZWN0b3IuZ2V0KGRlZmF1bHRzLnBhcmFtU2VyaWFsaXplcikgOiBkZWZhdWx0cy5wYXJhbVNlcmlhbGl6ZXI7XG5cbiAgICAvKipcbiAgICAgKiBJbnRlcmNlcHRvcnMgc3RvcmVkIGluIHJldmVyc2Ugb3JkZXIuIElubmVyIGludGVyY2VwdG9ycyBiZWZvcmUgb3V0ZXIgaW50ZXJjZXB0b3JzLlxuICAgICAqIFRoZSByZXZlcnNhbCBpcyBuZWVkZWQgc28gdGhhdCB3ZSBjYW4gYnVpbGQgdXAgdGhlIGludGVyY2VwdGlvbiBjaGFpbiBhcm91bmQgdGhlXG4gICAgICogc2VydmVyIHJlcXVlc3QuXG4gICAgICovXG4gICAgdmFyIHJldmVyc2VkSW50ZXJjZXB0b3JzID0gW107XG5cbiAgICBmb3JFYWNoKGludGVyY2VwdG9yRmFjdG9yaWVzLCBmdW5jdGlvbihpbnRlcmNlcHRvckZhY3RvcnkpIHtcbiAgICAgIHJldmVyc2VkSW50ZXJjZXB0b3JzLnVuc2hpZnQoaXNTdHJpbmcoaW50ZXJjZXB0b3JGYWN0b3J5KVxuICAgICAgICAgID8gJGluamVjdG9yLmdldChpbnRlcmNlcHRvckZhY3RvcnkpIDogJGluamVjdG9yLmludm9rZShpbnRlcmNlcHRvckZhY3RvcnkpKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBzZXJ2aWNlXG4gICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgKiBAbmFtZSAkaHR0cFxuICAgICAqIEByZXF1aXJlcyBuZy4kaHR0cEJhY2tlbmRcbiAgICAgKiBAcmVxdWlyZXMgJGNhY2hlRmFjdG9yeVxuICAgICAqIEByZXF1aXJlcyAkcm9vdFNjb3BlXG4gICAgICogQHJlcXVpcmVzICRxXG4gICAgICogQHJlcXVpcmVzICRpbmplY3RvclxuICAgICAqXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICogVGhlIGAkaHR0cGAgc2VydmljZSBpcyBhIGNvcmUgQW5ndWxhciBzZXJ2aWNlIHRoYXQgZmFjaWxpdGF0ZXMgY29tbXVuaWNhdGlvbiB3aXRoIHRoZSByZW1vdGVcbiAgICAgKiBIVFRQIHNlcnZlcnMgdmlhIHRoZSBicm93c2VyJ3MgW1hNTEh0dHBSZXF1ZXN0XShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi94bWxodHRwcmVxdWVzdClcbiAgICAgKiBvYmplY3Qgb3IgdmlhIFtKU09OUF0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9KU09OUCkuXG4gICAgICpcbiAgICAgKiBGb3IgdW5pdCB0ZXN0aW5nIGFwcGxpY2F0aW9ucyB0aGF0IHVzZSBgJGh0dHBgIHNlcnZpY2UsIHNlZVxuICAgICAqIHtAbGluayBuZ01vY2suJGh0dHBCYWNrZW5kICRodHRwQmFja2VuZCBtb2NrfS5cbiAgICAgKlxuICAgICAqIEZvciBhIGhpZ2hlciBsZXZlbCBvZiBhYnN0cmFjdGlvbiwgcGxlYXNlIGNoZWNrIG91dCB0aGUge0BsaW5rIG5nUmVzb3VyY2UuJHJlc291cmNlXG4gICAgICogJHJlc291cmNlfSBzZXJ2aWNlLlxuICAgICAqXG4gICAgICogVGhlICRodHRwIEFQSSBpcyBiYXNlZCBvbiB0aGUge0BsaW5rIG5nLiRxIGRlZmVycmVkL3Byb21pc2UgQVBJc30gZXhwb3NlZCBieVxuICAgICAqIHRoZSAkcSBzZXJ2aWNlLiBXaGlsZSBmb3Igc2ltcGxlIHVzYWdlIHBhdHRlcm5zIHRoaXMgZG9lc24ndCBtYXR0ZXIgbXVjaCwgZm9yIGFkdmFuY2VkIHVzYWdlXG4gICAgICogaXQgaXMgaW1wb3J0YW50IHRvIGZhbWlsaWFyaXplIHlvdXJzZWxmIHdpdGggdGhlc2UgQVBJcyBhbmQgdGhlIGd1YXJhbnRlZXMgdGhleSBwcm92aWRlLlxuICAgICAqXG4gICAgICpcbiAgICAgKiAjIyBHZW5lcmFsIHVzYWdlXG4gICAgICogVGhlIGAkaHR0cGAgc2VydmljZSBpcyBhIGZ1bmN0aW9uIHdoaWNoIHRha2VzIGEgc2luZ2xlIGFyZ3VtZW50IOKAlCBhIHtAbGluayAkaHR0cCN1c2FnZSBjb25maWd1cmF0aW9uIG9iamVjdH0g4oCUXG4gICAgICogdGhhdCBpcyB1c2VkIHRvIGdlbmVyYXRlIGFuIEhUVFAgcmVxdWVzdCBhbmQgcmV0dXJucyAgYSB7QGxpbmsgbmcuJHEgcHJvbWlzZX0uXG4gICAgICpcbiAgICAgKiBgYGBqc1xuICAgICAqICAgLy8gU2ltcGxlIEdFVCByZXF1ZXN0IGV4YW1wbGU6XG4gICAgICogICAkaHR0cCh7XG4gICAgICogICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICogICAgIHVybDogJy9zb21lVXJsJ1xuICAgICAqICAgfSkudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgKiAgICAgICAvLyB0aGlzIGNhbGxiYWNrIHdpbGwgYmUgY2FsbGVkIGFzeW5jaHJvbm91c2x5XG4gICAgICogICAgICAgLy8gd2hlbiB0aGUgcmVzcG9uc2UgaXMgYXZhaWxhYmxlXG4gICAgICogICAgIH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgKiAgICAgICAvLyBjYWxsZWQgYXN5bmNocm9ub3VzbHkgaWYgYW4gZXJyb3Igb2NjdXJzXG4gICAgICogICAgICAgLy8gb3Igc2VydmVyIHJldHVybnMgcmVzcG9uc2Ugd2l0aCBhbiBlcnJvciBzdGF0dXMuXG4gICAgICogICAgIH0pO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogVGhlIHJlc3BvbnNlIG9iamVjdCBoYXMgdGhlc2UgcHJvcGVydGllczpcbiAgICAgKlxuICAgICAqICAgLSAqKmRhdGEqKiDigJMgYHtzdHJpbmd8T2JqZWN0fWAg4oCTIFRoZSByZXNwb25zZSBib2R5IHRyYW5zZm9ybWVkIHdpdGggdGhlIHRyYW5zZm9ybVxuICAgICAqICAgICBmdW5jdGlvbnMuXG4gICAgICogICAtICoqc3RhdHVzKiog4oCTIGB7bnVtYmVyfWAg4oCTIEhUVFAgc3RhdHVzIGNvZGUgb2YgdGhlIHJlc3BvbnNlLlxuICAgICAqICAgLSAqKmhlYWRlcnMqKiDigJMgYHtmdW5jdGlvbihbaGVhZGVyTmFtZV0pfWAg4oCTIEhlYWRlciBnZXR0ZXIgZnVuY3Rpb24uXG4gICAgICogICAtICoqY29uZmlnKiog4oCTIGB7T2JqZWN0fWAg4oCTIFRoZSBjb25maWd1cmF0aW9uIG9iamVjdCB0aGF0IHdhcyB1c2VkIHRvIGdlbmVyYXRlIHRoZSByZXF1ZXN0LlxuICAgICAqICAgLSAqKnN0YXR1c1RleHQqKiDigJMgYHtzdHJpbmd9YCDigJMgSFRUUCBzdGF0dXMgdGV4dCBvZiB0aGUgcmVzcG9uc2UuXG4gICAgICpcbiAgICAgKiBBIHJlc3BvbnNlIHN0YXR1cyBjb2RlIGJldHdlZW4gMjAwIGFuZCAyOTkgaXMgY29uc2lkZXJlZCBhIHN1Y2Nlc3Mgc3RhdHVzIGFuZFxuICAgICAqIHdpbGwgcmVzdWx0IGluIHRoZSBzdWNjZXNzIGNhbGxiYWNrIGJlaW5nIGNhbGxlZC4gTm90ZSB0aGF0IGlmIHRoZSByZXNwb25zZSBpcyBhIHJlZGlyZWN0LFxuICAgICAqIFhNTEh0dHBSZXF1ZXN0IHdpbGwgdHJhbnNwYXJlbnRseSBmb2xsb3cgaXQsIG1lYW5pbmcgdGhhdCB0aGUgZXJyb3IgY2FsbGJhY2sgd2lsbCBub3QgYmVcbiAgICAgKiBjYWxsZWQgZm9yIHN1Y2ggcmVzcG9uc2VzLlxuICAgICAqXG4gICAgICpcbiAgICAgKiAjIyBTaG9ydGN1dCBtZXRob2RzXG4gICAgICpcbiAgICAgKiBTaG9ydGN1dCBtZXRob2RzIGFyZSBhbHNvIGF2YWlsYWJsZS4gQWxsIHNob3J0Y3V0IG1ldGhvZHMgcmVxdWlyZSBwYXNzaW5nIGluIHRoZSBVUkwsIGFuZFxuICAgICAqIHJlcXVlc3QgZGF0YSBtdXN0IGJlIHBhc3NlZCBpbiBmb3IgUE9TVC9QVVQgcmVxdWVzdHMuIEFuIG9wdGlvbmFsIGNvbmZpZyBjYW4gYmUgcGFzc2VkIGFzIHRoZVxuICAgICAqIGxhc3QgYXJndW1lbnQuXG4gICAgICpcbiAgICAgKiBgYGBqc1xuICAgICAqICAgJGh0dHAuZ2V0KCcvc29tZVVybCcsIGNvbmZpZykudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spO1xuICAgICAqICAgJGh0dHAucG9zdCgnL3NvbWVVcmwnLCBkYXRhLCBjb25maWcpLnRoZW4oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKTtcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIENvbXBsZXRlIGxpc3Qgb2Ygc2hvcnRjdXQgbWV0aG9kczpcbiAgICAgKlxuICAgICAqIC0ge0BsaW5rIG5nLiRodHRwI2dldCAkaHR0cC5nZXR9XG4gICAgICogLSB7QGxpbmsgbmcuJGh0dHAjaGVhZCAkaHR0cC5oZWFkfVxuICAgICAqIC0ge0BsaW5rIG5nLiRodHRwI3Bvc3QgJGh0dHAucG9zdH1cbiAgICAgKiAtIHtAbGluayBuZy4kaHR0cCNwdXQgJGh0dHAucHV0fVxuICAgICAqIC0ge0BsaW5rIG5nLiRodHRwI2RlbGV0ZSAkaHR0cC5kZWxldGV9XG4gICAgICogLSB7QGxpbmsgbmcuJGh0dHAjanNvbnAgJGh0dHAuanNvbnB9XG4gICAgICogLSB7QGxpbmsgbmcuJGh0dHAjcGF0Y2ggJGh0dHAucGF0Y2h9XG4gICAgICpcbiAgICAgKlxuICAgICAqICMjIFdyaXRpbmcgVW5pdCBUZXN0cyB0aGF0IHVzZSAkaHR0cFxuICAgICAqIFdoZW4gdW5pdCB0ZXN0aW5nICh1c2luZyB7QGxpbmsgbmdNb2NrIG5nTW9ja30pLCBpdCBpcyBuZWNlc3NhcnkgdG8gY2FsbFxuICAgICAqIHtAbGluayBuZ01vY2suJGh0dHBCYWNrZW5kI2ZsdXNoICRodHRwQmFja2VuZC5mbHVzaCgpfSB0byBmbHVzaCBlYWNoIHBlbmRpbmdcbiAgICAgKiByZXF1ZXN0IHVzaW5nIHRyYWluZWQgcmVzcG9uc2VzLlxuICAgICAqXG4gICAgICogYGBgXG4gICAgICogJGh0dHBCYWNrZW5kLmV4cGVjdEdFVCguLi4pO1xuICAgICAqICRodHRwLmdldCguLi4pO1xuICAgICAqICRodHRwQmFja2VuZC5mbHVzaCgpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogIyMgRGVwcmVjYXRpb24gTm90aWNlXG4gICAgICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWRhbmdlclwiPlxuICAgICAqICAgVGhlIGAkaHR0cGAgbGVnYWN5IHByb21pc2UgbWV0aG9kcyBgc3VjY2Vzc2AgYW5kIGBlcnJvcmAgaGF2ZSBiZWVuIGRlcHJlY2F0ZWQuXG4gICAgICogICBVc2UgdGhlIHN0YW5kYXJkIGB0aGVuYCBtZXRob2QgaW5zdGVhZC5cbiAgICAgKiAgIElmIHtAbGluayAkaHR0cFByb3ZpZGVyI3VzZUxlZ2FjeVByb21pc2VFeHRlbnNpb25zIGAkaHR0cFByb3ZpZGVyLnVzZUxlZ2FjeVByb21pc2VFeHRlbnNpb25zYH0gaXMgc2V0IHRvXG4gICAgICogICBgZmFsc2VgIHRoZW4gdGhlc2UgbWV0aG9kcyB3aWxsIHRocm93IHtAbGluayAkaHR0cDpsZWdhY3kgYCRodHRwL2xlZ2FjeWB9IGVycm9yLlxuICAgICAqIDwvZGl2PlxuICAgICAqXG4gICAgICogIyMgU2V0dGluZyBIVFRQIEhlYWRlcnNcbiAgICAgKlxuICAgICAqIFRoZSAkaHR0cCBzZXJ2aWNlIHdpbGwgYXV0b21hdGljYWxseSBhZGQgY2VydGFpbiBIVFRQIGhlYWRlcnMgdG8gYWxsIHJlcXVlc3RzLiBUaGVzZSBkZWZhdWx0c1xuICAgICAqIGNhbiBiZSBmdWxseSBjb25maWd1cmVkIGJ5IGFjY2Vzc2luZyB0aGUgYCRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVyc2AgY29uZmlndXJhdGlvblxuICAgICAqIG9iamVjdCwgd2hpY2ggY3VycmVudGx5IGNvbnRhaW5zIHRoaXMgZGVmYXVsdCBjb25maWd1cmF0aW9uOlxuICAgICAqXG4gICAgICogLSBgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vbmAgKGhlYWRlcnMgdGhhdCBhcmUgY29tbW9uIGZvciBhbGwgcmVxdWVzdHMpOlxuICAgICAqICAgLSBgQWNjZXB0OiBhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqIC8gKmBcbiAgICAgKiAtIGAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMucG9zdGA6IChoZWFkZXIgZGVmYXVsdHMgZm9yIFBPU1QgcmVxdWVzdHMpXG4gICAgICogICAtIGBDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb25gXG4gICAgICogLSBgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLnB1dGAgKGhlYWRlciBkZWZhdWx0cyBmb3IgUFVUIHJlcXVlc3RzKVxuICAgICAqICAgLSBgQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uYFxuICAgICAqXG4gICAgICogVG8gYWRkIG9yIG92ZXJ3cml0ZSB0aGVzZSBkZWZhdWx0cywgc2ltcGx5IGFkZCBvciByZW1vdmUgYSBwcm9wZXJ0eSBmcm9tIHRoZXNlIGNvbmZpZ3VyYXRpb25cbiAgICAgKiBvYmplY3RzLiBUbyBhZGQgaGVhZGVycyBmb3IgYW4gSFRUUCBtZXRob2Qgb3RoZXIgdGhhbiBQT1NUIG9yIFBVVCwgc2ltcGx5IGFkZCBhIG5ldyBvYmplY3RcbiAgICAgKiB3aXRoIHRoZSBsb3dlcmNhc2VkIEhUVFAgbWV0aG9kIG5hbWUgYXMgdGhlIGtleSwgZS5nLlxuICAgICAqIGAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0ID0geyAnTXktSGVhZGVyJyA6ICd2YWx1ZScgfWAuXG4gICAgICpcbiAgICAgKiBUaGUgZGVmYXVsdHMgY2FuIGFsc28gYmUgc2V0IGF0IHJ1bnRpbWUgdmlhIHRoZSBgJGh0dHAuZGVmYXVsdHNgIG9iamVjdCBpbiB0aGUgc2FtZVxuICAgICAqIGZhc2hpb24uIEZvciBleGFtcGxlOlxuICAgICAqXG4gICAgICogYGBgXG4gICAgICogbW9kdWxlLnJ1bihmdW5jdGlvbigkaHR0cCkge1xuICAgICAqICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb24uQXV0aG9yaXphdGlvbiA9ICdCYXNpYyBZbVZsY0RwaWIyOXcnO1xuICAgICAqIH0pO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogSW4gYWRkaXRpb24sIHlvdSBjYW4gc3VwcGx5IGEgYGhlYWRlcnNgIHByb3BlcnR5IGluIHRoZSBjb25maWcgb2JqZWN0IHBhc3NlZCB3aGVuXG4gICAgICogY2FsbGluZyBgJGh0dHAoY29uZmlnKWAsIHdoaWNoIG92ZXJyaWRlcyB0aGUgZGVmYXVsdHMgd2l0aG91dCBjaGFuZ2luZyB0aGVtIGdsb2JhbGx5LlxuICAgICAqXG4gICAgICogVG8gZXhwbGljaXRseSByZW1vdmUgYSBoZWFkZXIgYXV0b21hdGljYWxseSBhZGRlZCB2aWEgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzIG9uIGEgcGVyIHJlcXVlc3QgYmFzaXMsXG4gICAgICogVXNlIHRoZSBgaGVhZGVyc2AgcHJvcGVydHksIHNldHRpbmcgdGhlIGRlc2lyZWQgaGVhZGVyIHRvIGB1bmRlZmluZWRgLiBGb3IgZXhhbXBsZTpcbiAgICAgKlxuICAgICAqIGBgYGpzXG4gICAgICogdmFyIHJlcSA9IHtcbiAgICAgKiAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICogIHVybDogJ2h0dHA6Ly9leGFtcGxlLmNvbScsXG4gICAgICogIGhlYWRlcnM6IHtcbiAgICAgKiAgICAnQ29udGVudC1UeXBlJzogdW5kZWZpbmVkXG4gICAgICogIH0sXG4gICAgICogIGRhdGE6IHsgdGVzdDogJ3Rlc3QnIH1cbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiAkaHR0cChyZXEpLnRoZW4oZnVuY3Rpb24oKXsuLi59LCBmdW5jdGlvbigpey4uLn0pO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogIyMgVHJhbnNmb3JtaW5nIFJlcXVlc3RzIGFuZCBSZXNwb25zZXNcbiAgICAgKlxuICAgICAqIEJvdGggcmVxdWVzdHMgYW5kIHJlc3BvbnNlcyBjYW4gYmUgdHJhbnNmb3JtZWQgdXNpbmcgdHJhbnNmb3JtYXRpb24gZnVuY3Rpb25zOiBgdHJhbnNmb3JtUmVxdWVzdGBcbiAgICAgKiBhbmQgYHRyYW5zZm9ybVJlc3BvbnNlYC4gVGhlc2UgcHJvcGVydGllcyBjYW4gYmUgYSBzaW5nbGUgZnVuY3Rpb24gdGhhdCByZXR1cm5zXG4gICAgICogdGhlIHRyYW5zZm9ybWVkIHZhbHVlIChgZnVuY3Rpb24oZGF0YSwgaGVhZGVyc0dldHRlciwgc3RhdHVzKWApIG9yIGFuIGFycmF5IG9mIHN1Y2ggdHJhbnNmb3JtYXRpb24gZnVuY3Rpb25zLFxuICAgICAqIHdoaWNoIGFsbG93cyB5b3UgdG8gYHB1c2hgIG9yIGB1bnNoaWZ0YCBhIG5ldyB0cmFuc2Zvcm1hdGlvbiBmdW5jdGlvbiBpbnRvIHRoZSB0cmFuc2Zvcm1hdGlvbiBjaGFpbi5cbiAgICAgKlxuICAgICAqICMjIyBEZWZhdWx0IFRyYW5zZm9ybWF0aW9uc1xuICAgICAqXG4gICAgICogVGhlIGAkaHR0cFByb3ZpZGVyYCBwcm92aWRlciBhbmQgYCRodHRwYCBzZXJ2aWNlIGV4cG9zZSBgZGVmYXVsdHMudHJhbnNmb3JtUmVxdWVzdGAgYW5kXG4gICAgICogYGRlZmF1bHRzLnRyYW5zZm9ybVJlc3BvbnNlYCBwcm9wZXJ0aWVzLiBJZiBhIHJlcXVlc3QgZG9lcyBub3QgcHJvdmlkZSBpdHMgb3duIHRyYW5zZm9ybWF0aW9uc1xuICAgICAqIHRoZW4gdGhlc2Ugd2lsbCBiZSBhcHBsaWVkLlxuICAgICAqXG4gICAgICogWW91IGNhbiBhdWdtZW50IG9yIHJlcGxhY2UgdGhlIGRlZmF1bHQgdHJhbnNmb3JtYXRpb25zIGJ5IG1vZGlmeWluZyB0aGVzZSBwcm9wZXJ0aWVzIGJ5IGFkZGluZyB0byBvclxuICAgICAqIHJlcGxhY2luZyB0aGUgYXJyYXkuXG4gICAgICpcbiAgICAgKiBBbmd1bGFyIHByb3ZpZGVzIHRoZSBmb2xsb3dpbmcgZGVmYXVsdCB0cmFuc2Zvcm1hdGlvbnM6XG4gICAgICpcbiAgICAgKiBSZXF1ZXN0IHRyYW5zZm9ybWF0aW9ucyAoYCRodHRwUHJvdmlkZXIuZGVmYXVsdHMudHJhbnNmb3JtUmVxdWVzdGAgYW5kIGAkaHR0cC5kZWZhdWx0cy50cmFuc2Zvcm1SZXF1ZXN0YCk6XG4gICAgICpcbiAgICAgKiAtIElmIHRoZSBgZGF0YWAgcHJvcGVydHkgb2YgdGhlIHJlcXVlc3QgY29uZmlndXJhdGlvbiBvYmplY3QgY29udGFpbnMgYW4gb2JqZWN0LCBzZXJpYWxpemUgaXRcbiAgICAgKiAgIGludG8gSlNPTiBmb3JtYXQuXG4gICAgICpcbiAgICAgKiBSZXNwb25zZSB0cmFuc2Zvcm1hdGlvbnMgKGAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLnRyYW5zZm9ybVJlc3BvbnNlYCBhbmQgYCRodHRwLmRlZmF1bHRzLnRyYW5zZm9ybVJlc3BvbnNlYCk6XG4gICAgICpcbiAgICAgKiAgLSBJZiBYU1JGIHByZWZpeCBpcyBkZXRlY3RlZCwgc3RyaXAgaXQgKHNlZSBTZWN1cml0eSBDb25zaWRlcmF0aW9ucyBzZWN0aW9uIGJlbG93KS5cbiAgICAgKiAgLSBJZiBKU09OIHJlc3BvbnNlIGlzIGRldGVjdGVkLCBkZXNlcmlhbGl6ZSBpdCB1c2luZyBhIEpTT04gcGFyc2VyLlxuICAgICAqXG4gICAgICpcbiAgICAgKiAjIyMgT3ZlcnJpZGluZyB0aGUgRGVmYXVsdCBUcmFuc2Zvcm1hdGlvbnMgUGVyIFJlcXVlc3RcbiAgICAgKlxuICAgICAqIElmIHlvdSB3aXNoIG92ZXJyaWRlIHRoZSByZXF1ZXN0L3Jlc3BvbnNlIHRyYW5zZm9ybWF0aW9ucyBvbmx5IGZvciBhIHNpbmdsZSByZXF1ZXN0IHRoZW4gcHJvdmlkZVxuICAgICAqIGB0cmFuc2Zvcm1SZXF1ZXN0YCBhbmQvb3IgYHRyYW5zZm9ybVJlc3BvbnNlYCBwcm9wZXJ0aWVzIG9uIHRoZSBjb25maWd1cmF0aW9uIG9iamVjdCBwYXNzZWRcbiAgICAgKiBpbnRvIGAkaHR0cGAuXG4gICAgICpcbiAgICAgKiBOb3RlIHRoYXQgaWYgeW91IHByb3ZpZGUgdGhlc2UgcHJvcGVydGllcyBvbiB0aGUgY29uZmlnIG9iamVjdCB0aGUgZGVmYXVsdCB0cmFuc2Zvcm1hdGlvbnMgd2lsbCBiZVxuICAgICAqIG92ZXJ3cml0dGVuLiBJZiB5b3Ugd2lzaCB0byBhdWdtZW50IHRoZSBkZWZhdWx0IHRyYW5zZm9ybWF0aW9ucyB0aGVuIHlvdSBtdXN0IGluY2x1ZGUgdGhlbSBpbiB5b3VyXG4gICAgICogbG9jYWwgdHJhbnNmb3JtYXRpb24gYXJyYXkuXG4gICAgICpcbiAgICAgKiBUaGUgZm9sbG93aW5nIGNvZGUgZGVtb25zdHJhdGVzIGFkZGluZyBhIG5ldyByZXNwb25zZSB0cmFuc2Zvcm1hdGlvbiB0byBiZSBydW4gYWZ0ZXIgdGhlIGRlZmF1bHQgcmVzcG9uc2VcbiAgICAgKiB0cmFuc2Zvcm1hdGlvbnMgaGF2ZSBiZWVuIHJ1bi5cbiAgICAgKlxuICAgICAqIGBgYGpzXG4gICAgICogZnVuY3Rpb24gYXBwZW5kVHJhbnNmb3JtKGRlZmF1bHRzLCB0cmFuc2Zvcm0pIHtcbiAgICAgKlxuICAgICAqICAgLy8gV2UgY2FuJ3QgZ3VhcmFudGVlIHRoYXQgdGhlIGRlZmF1bHQgdHJhbnNmb3JtYXRpb24gaXMgYW4gYXJyYXlcbiAgICAgKiAgIGRlZmF1bHRzID0gYW5ndWxhci5pc0FycmF5KGRlZmF1bHRzKSA/IGRlZmF1bHRzIDogW2RlZmF1bHRzXTtcbiAgICAgKlxuICAgICAqICAgLy8gQXBwZW5kIHRoZSBuZXcgdHJhbnNmb3JtYXRpb24gdG8gdGhlIGRlZmF1bHRzXG4gICAgICogICByZXR1cm4gZGVmYXVsdHMuY29uY2F0KHRyYW5zZm9ybSk7XG4gICAgICogfVxuICAgICAqXG4gICAgICogJGh0dHAoe1xuICAgICAqICAgdXJsOiAnLi4uJyxcbiAgICAgKiAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICogICB0cmFuc2Zvcm1SZXNwb25zZTogYXBwZW5kVHJhbnNmb3JtKCRodHRwLmRlZmF1bHRzLnRyYW5zZm9ybVJlc3BvbnNlLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAqICAgICByZXR1cm4gZG9UcmFuc2Zvcm0odmFsdWUpO1xuICAgICAqICAgfSlcbiAgICAgKiB9KTtcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqXG4gICAgICogIyMgQ2FjaGluZ1xuICAgICAqXG4gICAgICogVG8gZW5hYmxlIGNhY2hpbmcsIHNldCB0aGUgcmVxdWVzdCBjb25maWd1cmF0aW9uIGBjYWNoZWAgcHJvcGVydHkgdG8gYHRydWVgICh0byB1c2UgZGVmYXVsdFxuICAgICAqIGNhY2hlKSBvciB0byBhIGN1c3RvbSBjYWNoZSBvYmplY3QgKGJ1aWx0IHdpdGgge0BsaW5rIG5nLiRjYWNoZUZhY3RvcnkgYCRjYWNoZUZhY3RvcnlgfSkuXG4gICAgICogV2hlbiB0aGUgY2FjaGUgaXMgZW5hYmxlZCwgYCRodHRwYCBzdG9yZXMgdGhlIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlciBpbiB0aGUgc3BlY2lmaWVkXG4gICAgICogY2FjaGUuIFRoZSBuZXh0IHRpbWUgdGhlIHNhbWUgcmVxdWVzdCBpcyBtYWRlLCB0aGUgcmVzcG9uc2UgaXMgc2VydmVkIGZyb20gdGhlIGNhY2hlIHdpdGhvdXRcbiAgICAgKiBzZW5kaW5nIGEgcmVxdWVzdCB0byB0aGUgc2VydmVyLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IGV2ZW4gaWYgdGhlIHJlc3BvbnNlIGlzIHNlcnZlZCBmcm9tIGNhY2hlLCBkZWxpdmVyeSBvZiB0aGUgZGF0YSBpcyBhc3luY2hyb25vdXMgaW5cbiAgICAgKiB0aGUgc2FtZSB3YXkgdGhhdCByZWFsIHJlcXVlc3RzIGFyZS5cbiAgICAgKlxuICAgICAqIElmIHRoZXJlIGFyZSBtdWx0aXBsZSBHRVQgcmVxdWVzdHMgZm9yIHRoZSBzYW1lIFVSTCB0aGF0IHNob3VsZCBiZSBjYWNoZWQgdXNpbmcgdGhlIHNhbWVcbiAgICAgKiBjYWNoZSwgYnV0IHRoZSBjYWNoZSBpcyBub3QgcG9wdWxhdGVkIHlldCwgb25seSBvbmUgcmVxdWVzdCB0byB0aGUgc2VydmVyIHdpbGwgYmUgbWFkZSBhbmRcbiAgICAgKiB0aGUgcmVtYWluaW5nIHJlcXVlc3RzIHdpbGwgYmUgZnVsZmlsbGVkIHVzaW5nIHRoZSByZXNwb25zZSBmcm9tIHRoZSBmaXJzdCByZXF1ZXN0LlxuICAgICAqXG4gICAgICogWW91IGNhbiBjaGFuZ2UgdGhlIGRlZmF1bHQgY2FjaGUgdG8gYSBuZXcgb2JqZWN0IChidWlsdCB3aXRoXG4gICAgICoge0BsaW5rIG5nLiRjYWNoZUZhY3RvcnkgYCRjYWNoZUZhY3RvcnlgfSkgYnkgdXBkYXRpbmcgdGhlXG4gICAgICoge0BsaW5rIG5nLiRodHRwI2RlZmF1bHRzIGAkaHR0cC5kZWZhdWx0cy5jYWNoZWB9IHByb3BlcnR5LiBBbGwgcmVxdWVzdHMgd2hvIHNldFxuICAgICAqIHRoZWlyIGBjYWNoZWAgcHJvcGVydHkgdG8gYHRydWVgIHdpbGwgbm93IHVzZSB0aGlzIGNhY2hlIG9iamVjdC5cbiAgICAgKlxuICAgICAqIElmIHlvdSBzZXQgdGhlIGRlZmF1bHQgY2FjaGUgdG8gYGZhbHNlYCB0aGVuIG9ubHkgcmVxdWVzdHMgdGhhdCBzcGVjaWZ5IHRoZWlyIG93biBjdXN0b21cbiAgICAgKiBjYWNoZSBvYmplY3Qgd2lsbCBiZSBjYWNoZWQuXG4gICAgICpcbiAgICAgKiAjIyBJbnRlcmNlcHRvcnNcbiAgICAgKlxuICAgICAqIEJlZm9yZSB5b3Ugc3RhcnQgY3JlYXRpbmcgaW50ZXJjZXB0b3JzLCBiZSBzdXJlIHRvIHVuZGVyc3RhbmQgdGhlXG4gICAgICoge0BsaW5rIG5nLiRxICRxIGFuZCBkZWZlcnJlZC9wcm9taXNlIEFQSXN9LlxuICAgICAqXG4gICAgICogRm9yIHB1cnBvc2VzIG9mIGdsb2JhbCBlcnJvciBoYW5kbGluZywgYXV0aGVudGljYXRpb24sIG9yIGFueSBraW5kIG9mIHN5bmNocm9ub3VzIG9yXG4gICAgICogYXN5bmNocm9ub3VzIHByZS1wcm9jZXNzaW5nIG9mIHJlcXVlc3Qgb3IgcG9zdHByb2Nlc3Npbmcgb2YgcmVzcG9uc2VzLCBpdCBpcyBkZXNpcmFibGUgdG8gYmVcbiAgICAgKiBhYmxlIHRvIGludGVyY2VwdCByZXF1ZXN0cyBiZWZvcmUgdGhleSBhcmUgaGFuZGVkIHRvIHRoZSBzZXJ2ZXIgYW5kXG4gICAgICogcmVzcG9uc2VzIGJlZm9yZSB0aGV5IGFyZSBoYW5kZWQgb3ZlciB0byB0aGUgYXBwbGljYXRpb24gY29kZSB0aGF0XG4gICAgICogaW5pdGlhdGVkIHRoZXNlIHJlcXVlc3RzLiBUaGUgaW50ZXJjZXB0b3JzIGxldmVyYWdlIHRoZSB7QGxpbmsgbmcuJHFcbiAgICAgKiBwcm9taXNlIEFQSXN9IHRvIGZ1bGZpbGwgdGhpcyBuZWVkIGZvciBib3RoIHN5bmNocm9ub3VzIGFuZCBhc3luY2hyb25vdXMgcHJlLXByb2Nlc3NpbmcuXG4gICAgICpcbiAgICAgKiBUaGUgaW50ZXJjZXB0b3JzIGFyZSBzZXJ2aWNlIGZhY3RvcmllcyB0aGF0IGFyZSByZWdpc3RlcmVkIHdpdGggdGhlIGAkaHR0cFByb3ZpZGVyYCBieVxuICAgICAqIGFkZGluZyB0aGVtIHRvIHRoZSBgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnNgIGFycmF5LiBUaGUgZmFjdG9yeSBpcyBjYWxsZWQgYW5kXG4gICAgICogaW5qZWN0ZWQgd2l0aCBkZXBlbmRlbmNpZXMgKGlmIHNwZWNpZmllZCkgYW5kIHJldHVybnMgdGhlIGludGVyY2VwdG9yLlxuICAgICAqXG4gICAgICogVGhlcmUgYXJlIHR3byBraW5kcyBvZiBpbnRlcmNlcHRvcnMgKGFuZCB0d28ga2luZHMgb2YgcmVqZWN0aW9uIGludGVyY2VwdG9ycyk6XG4gICAgICpcbiAgICAgKiAgICogYHJlcXVlc3RgOiBpbnRlcmNlcHRvcnMgZ2V0IGNhbGxlZCB3aXRoIGEgaHR0cCB7QGxpbmsgJGh0dHAjdXNhZ2UgY29uZmlnfSBvYmplY3QuIFRoZSBmdW5jdGlvbiBpcyBmcmVlIHRvXG4gICAgICogICAgIG1vZGlmeSB0aGUgYGNvbmZpZ2Agb2JqZWN0IG9yIGNyZWF0ZSBhIG5ldyBvbmUuIFRoZSBmdW5jdGlvbiBuZWVkcyB0byByZXR1cm4gdGhlIGBjb25maWdgXG4gICAgICogICAgIG9iamVjdCBkaXJlY3RseSwgb3IgYSBwcm9taXNlIGNvbnRhaW5pbmcgdGhlIGBjb25maWdgIG9yIGEgbmV3IGBjb25maWdgIG9iamVjdC5cbiAgICAgKiAgICogYHJlcXVlc3RFcnJvcmA6IGludGVyY2VwdG9yIGdldHMgY2FsbGVkIHdoZW4gYSBwcmV2aW91cyBpbnRlcmNlcHRvciB0aHJldyBhbiBlcnJvciBvclxuICAgICAqICAgICByZXNvbHZlZCB3aXRoIGEgcmVqZWN0aW9uLlxuICAgICAqICAgKiBgcmVzcG9uc2VgOiBpbnRlcmNlcHRvcnMgZ2V0IGNhbGxlZCB3aXRoIGh0dHAgYHJlc3BvbnNlYCBvYmplY3QuIFRoZSBmdW5jdGlvbiBpcyBmcmVlIHRvXG4gICAgICogICAgIG1vZGlmeSB0aGUgYHJlc3BvbnNlYCBvYmplY3Qgb3IgY3JlYXRlIGEgbmV3IG9uZS4gVGhlIGZ1bmN0aW9uIG5lZWRzIHRvIHJldHVybiB0aGUgYHJlc3BvbnNlYFxuICAgICAqICAgICBvYmplY3QgZGlyZWN0bHksIG9yIGFzIGEgcHJvbWlzZSBjb250YWluaW5nIHRoZSBgcmVzcG9uc2VgIG9yIGEgbmV3IGByZXNwb25zZWAgb2JqZWN0LlxuICAgICAqICAgKiBgcmVzcG9uc2VFcnJvcmA6IGludGVyY2VwdG9yIGdldHMgY2FsbGVkIHdoZW4gYSBwcmV2aW91cyBpbnRlcmNlcHRvciB0aHJldyBhbiBlcnJvciBvclxuICAgICAqICAgICByZXNvbHZlZCB3aXRoIGEgcmVqZWN0aW9uLlxuICAgICAqXG4gICAgICpcbiAgICAgKiBgYGBqc1xuICAgICAqICAgLy8gcmVnaXN0ZXIgdGhlIGludGVyY2VwdG9yIGFzIGEgc2VydmljZVxuICAgICAqICAgJHByb3ZpZGUuZmFjdG9yeSgnbXlIdHRwSW50ZXJjZXB0b3InLCBmdW5jdGlvbigkcSwgZGVwZW5kZW5jeTEsIGRlcGVuZGVuY3kyKSB7XG4gICAgICogICAgIHJldHVybiB7XG4gICAgICogICAgICAgLy8gb3B0aW9uYWwgbWV0aG9kXG4gICAgICogICAgICAgJ3JlcXVlc3QnOiBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgKiAgICAgICAgIC8vIGRvIHNvbWV0aGluZyBvbiBzdWNjZXNzXG4gICAgICogICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAqICAgICAgIH0sXG4gICAgICpcbiAgICAgKiAgICAgICAvLyBvcHRpb25hbCBtZXRob2RcbiAgICAgKiAgICAgICdyZXF1ZXN0RXJyb3InOiBmdW5jdGlvbihyZWplY3Rpb24pIHtcbiAgICAgKiAgICAgICAgIC8vIGRvIHNvbWV0aGluZyBvbiBlcnJvclxuICAgICAqICAgICAgICAgaWYgKGNhblJlY292ZXIocmVqZWN0aW9uKSkge1xuICAgICAqICAgICAgICAgICByZXR1cm4gcmVzcG9uc2VPck5ld1Byb21pc2VcbiAgICAgKiAgICAgICAgIH1cbiAgICAgKiAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVqZWN0aW9uKTtcbiAgICAgKiAgICAgICB9LFxuICAgICAqXG4gICAgICpcbiAgICAgKlxuICAgICAqICAgICAgIC8vIG9wdGlvbmFsIG1ldGhvZFxuICAgICAqICAgICAgICdyZXNwb25zZSc6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICogICAgICAgICAvLyBkbyBzb21ldGhpbmcgb24gc3VjY2Vzc1xuICAgICAqICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgICAqICAgICAgIH0sXG4gICAgICpcbiAgICAgKiAgICAgICAvLyBvcHRpb25hbCBtZXRob2RcbiAgICAgKiAgICAgICdyZXNwb25zZUVycm9yJzogZnVuY3Rpb24ocmVqZWN0aW9uKSB7XG4gICAgICogICAgICAgICAvLyBkbyBzb21ldGhpbmcgb24gZXJyb3JcbiAgICAgKiAgICAgICAgIGlmIChjYW5SZWNvdmVyKHJlamVjdGlvbikpIHtcbiAgICAgKiAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlT3JOZXdQcm9taXNlXG4gICAgICogICAgICAgICB9XG4gICAgICogICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlamVjdGlvbik7XG4gICAgICogICAgICAgfVxuICAgICAqICAgICB9O1xuICAgICAqICAgfSk7XG4gICAgICpcbiAgICAgKiAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ215SHR0cEludGVyY2VwdG9yJyk7XG4gICAgICpcbiAgICAgKlxuICAgICAqICAgLy8gYWx0ZXJuYXRpdmVseSwgcmVnaXN0ZXIgdGhlIGludGVyY2VwdG9yIHZpYSBhbiBhbm9ueW1vdXMgZmFjdG9yeVxuICAgICAqICAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaChmdW5jdGlvbigkcSwgZGVwZW5kZW5jeTEsIGRlcGVuZGVuY3kyKSB7XG4gICAgICogICAgIHJldHVybiB7XG4gICAgICogICAgICAncmVxdWVzdCc6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAqICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmVcbiAgICAgKiAgICAgICB9LFxuICAgICAqXG4gICAgICogICAgICAgJ3Jlc3BvbnNlJzogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgKiAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlXG4gICAgICogICAgICAgfVxuICAgICAqICAgICB9O1xuICAgICAqICAgfSk7XG4gICAgICogYGBgXG4gICAgICpcbiAgICAgKiAjIyBTZWN1cml0eSBDb25zaWRlcmF0aW9uc1xuICAgICAqXG4gICAgICogV2hlbiBkZXNpZ25pbmcgd2ViIGFwcGxpY2F0aW9ucywgY29uc2lkZXIgc2VjdXJpdHkgdGhyZWF0cyBmcm9tOlxuICAgICAqXG4gICAgICogLSBbSlNPTiB2dWxuZXJhYmlsaXR5XShodHRwOi8vaGFhY2tlZC5jb20vYXJjaGl2ZS8yMDA4LzExLzIwL2FuYXRvbXktb2YtYS1zdWJ0bGUtanNvbi12dWxuZXJhYmlsaXR5LmFzcHgpXG4gICAgICogLSBbWFNSRl0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Dcm9zcy1zaXRlX3JlcXVlc3RfZm9yZ2VyeSlcbiAgICAgKlxuICAgICAqIEJvdGggc2VydmVyIGFuZCB0aGUgY2xpZW50IG11c3QgY29vcGVyYXRlIGluIG9yZGVyIHRvIGVsaW1pbmF0ZSB0aGVzZSB0aHJlYXRzLiBBbmd1bGFyIGNvbWVzXG4gICAgICogcHJlLWNvbmZpZ3VyZWQgd2l0aCBzdHJhdGVnaWVzIHRoYXQgYWRkcmVzcyB0aGVzZSBpc3N1ZXMsIGJ1dCBmb3IgdGhpcyB0byB3b3JrIGJhY2tlbmQgc2VydmVyXG4gICAgICogY29vcGVyYXRpb24gaXMgcmVxdWlyZWQuXG4gICAgICpcbiAgICAgKiAjIyMgSlNPTiBWdWxuZXJhYmlsaXR5IFByb3RlY3Rpb25cbiAgICAgKlxuICAgICAqIEEgW0pTT04gdnVsbmVyYWJpbGl0eV0oaHR0cDovL2hhYWNrZWQuY29tL2FyY2hpdmUvMjAwOC8xMS8yMC9hbmF0b215LW9mLWEtc3VidGxlLWpzb24tdnVsbmVyYWJpbGl0eS5hc3B4KVxuICAgICAqIGFsbG93cyB0aGlyZCBwYXJ0eSB3ZWJzaXRlIHRvIHR1cm4geW91ciBKU09OIHJlc291cmNlIFVSTCBpbnRvXG4gICAgICogW0pTT05QXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0pTT05QKSByZXF1ZXN0IHVuZGVyIHNvbWUgY29uZGl0aW9ucy4gVG9cbiAgICAgKiBjb3VudGVyIHRoaXMgeW91ciBzZXJ2ZXIgY2FuIHByZWZpeCBhbGwgSlNPTiByZXF1ZXN0cyB3aXRoIGZvbGxvd2luZyBzdHJpbmcgYFwiKV19JyxcXG5cImAuXG4gICAgICogQW5ndWxhciB3aWxsIGF1dG9tYXRpY2FsbHkgc3RyaXAgdGhlIHByZWZpeCBiZWZvcmUgcHJvY2Vzc2luZyBpdCBhcyBKU09OLlxuICAgICAqXG4gICAgICogRm9yIGV4YW1wbGUgaWYgeW91ciBzZXJ2ZXIgbmVlZHMgdG8gcmV0dXJuOlxuICAgICAqIGBgYGpzXG4gICAgICogWydvbmUnLCd0d28nXVxuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogd2hpY2ggaXMgdnVsbmVyYWJsZSB0byBhdHRhY2ssIHlvdXIgc2VydmVyIGNhbiByZXR1cm46XG4gICAgICogYGBganNcbiAgICAgKiApXX0nLFxuICAgICAqIFsnb25lJywndHdvJ11cbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIEFuZ3VsYXIgd2lsbCBzdHJpcCB0aGUgcHJlZml4LCBiZWZvcmUgcHJvY2Vzc2luZyB0aGUgSlNPTi5cbiAgICAgKlxuICAgICAqXG4gICAgICogIyMjIENyb3NzIFNpdGUgUmVxdWVzdCBGb3JnZXJ5IChYU1JGKSBQcm90ZWN0aW9uXG4gICAgICpcbiAgICAgKiBbWFNSRl0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Dcm9zcy1zaXRlX3JlcXVlc3RfZm9yZ2VyeSkgaXMgYW4gYXR0YWNrIHRlY2huaXF1ZSBieVxuICAgICAqIHdoaWNoIHRoZSBhdHRhY2tlciBjYW4gdHJpY2sgYW4gYXV0aGVudGljYXRlZCB1c2VyIGludG8gdW5rbm93aW5nbHkgZXhlY3V0aW5nIGFjdGlvbnMgb24geW91clxuICAgICAqIHdlYnNpdGUuIEFuZ3VsYXIgcHJvdmlkZXMgYSBtZWNoYW5pc20gdG8gY291bnRlciBYU1JGLiBXaGVuIHBlcmZvcm1pbmcgWEhSIHJlcXVlc3RzLCB0aGVcbiAgICAgKiAkaHR0cCBzZXJ2aWNlIHJlYWRzIGEgdG9rZW4gZnJvbSBhIGNvb2tpZSAoYnkgZGVmYXVsdCwgYFhTUkYtVE9LRU5gKSBhbmQgc2V0cyBpdCBhcyBhbiBIVFRQXG4gICAgICogaGVhZGVyIChgWC1YU1JGLVRPS0VOYCkuIFNpbmNlIG9ubHkgSmF2YVNjcmlwdCB0aGF0IHJ1bnMgb24geW91ciBkb21haW4gY291bGQgcmVhZCB0aGVcbiAgICAgKiBjb29raWUsIHlvdXIgc2VydmVyIGNhbiBiZSBhc3N1cmVkIHRoYXQgdGhlIFhIUiBjYW1lIGZyb20gSmF2YVNjcmlwdCBydW5uaW5nIG9uIHlvdXIgZG9tYWluLlxuICAgICAqIFRoZSBoZWFkZXIgd2lsbCBub3QgYmUgc2V0IGZvciBjcm9zcy1kb21haW4gcmVxdWVzdHMuXG4gICAgICpcbiAgICAgKiBUbyB0YWtlIGFkdmFudGFnZSBvZiB0aGlzLCB5b3VyIHNlcnZlciBuZWVkcyB0byBzZXQgYSB0b2tlbiBpbiBhIEphdmFTY3JpcHQgcmVhZGFibGUgc2Vzc2lvblxuICAgICAqIGNvb2tpZSBjYWxsZWQgYFhTUkYtVE9LRU5gIG9uIHRoZSBmaXJzdCBIVFRQIEdFVCByZXF1ZXN0LiBPbiBzdWJzZXF1ZW50IFhIUiByZXF1ZXN0cyB0aGVcbiAgICAgKiBzZXJ2ZXIgY2FuIHZlcmlmeSB0aGF0IHRoZSBjb29raWUgbWF0Y2hlcyBgWC1YU1JGLVRPS0VOYCBIVFRQIGhlYWRlciwgYW5kIHRoZXJlZm9yZSBiZSBzdXJlXG4gICAgICogdGhhdCBvbmx5IEphdmFTY3JpcHQgcnVubmluZyBvbiB5b3VyIGRvbWFpbiBjb3VsZCBoYXZlIHNlbnQgdGhlIHJlcXVlc3QuIFRoZSB0b2tlbiBtdXN0IGJlXG4gICAgICogdW5pcXVlIGZvciBlYWNoIHVzZXIgYW5kIG11c3QgYmUgdmVyaWZpYWJsZSBieSB0aGUgc2VydmVyICh0byBwcmV2ZW50IHRoZSBKYXZhU2NyaXB0IGZyb21cbiAgICAgKiBtYWtpbmcgdXAgaXRzIG93biB0b2tlbnMpLiBXZSByZWNvbW1lbmQgdGhhdCB0aGUgdG9rZW4gaXMgYSBkaWdlc3Qgb2YgeW91ciBzaXRlJ3NcbiAgICAgKiBhdXRoZW50aWNhdGlvbiBjb29raWUgd2l0aCBhIFtzYWx0XShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TYWx0XyhjcnlwdG9ncmFwaHkmIzQxOylcbiAgICAgKiBmb3IgYWRkZWQgc2VjdXJpdHkuXG4gICAgICpcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgaGVhZGVycyBjYW4gYmUgc3BlY2lmaWVkIHVzaW5nIHRoZSB4c3JmSGVhZGVyTmFtZSBhbmQgeHNyZkNvb2tpZU5hbWVcbiAgICAgKiBwcm9wZXJ0aWVzIG9mIGVpdGhlciAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzIGF0IGNvbmZpZy10aW1lLCAkaHR0cC5kZWZhdWx0cyBhdCBydW4tdGltZSxcbiAgICAgKiBvciB0aGUgcGVyLXJlcXVlc3QgY29uZmlnIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEluIG9yZGVyIHRvIHByZXZlbnQgY29sbGlzaW9ucyBpbiBlbnZpcm9ubWVudHMgd2hlcmUgbXVsdGlwbGUgQW5ndWxhciBhcHBzIHNoYXJlIHRoZVxuICAgICAqIHNhbWUgZG9tYWluIG9yIHN1YmRvbWFpbiwgd2UgcmVjb21tZW5kIHRoYXQgZWFjaCBhcHBsaWNhdGlvbiB1c2VzIHVuaXF1ZSBjb29raWUgbmFtZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWcgT2JqZWN0IGRlc2NyaWJpbmcgdGhlIHJlcXVlc3QgdG8gYmUgbWFkZSBhbmQgaG93IGl0IHNob3VsZCBiZVxuICAgICAqICAgIHByb2Nlc3NlZC4gVGhlIG9iamVjdCBoYXMgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gICAgICpcbiAgICAgKiAgICAtICoqbWV0aG9kKiog4oCTIGB7c3RyaW5nfWAg4oCTIEhUVFAgbWV0aG9kIChlLmcuICdHRVQnLCAnUE9TVCcsIGV0YylcbiAgICAgKiAgICAtICoqdXJsKiog4oCTIGB7c3RyaW5nfWAg4oCTIEFic29sdXRlIG9yIHJlbGF0aXZlIFVSTCBvZiB0aGUgcmVzb3VyY2UgdGhhdCBpcyBiZWluZyByZXF1ZXN0ZWQuXG4gICAgICogICAgLSAqKnBhcmFtcyoqIOKAkyBge09iamVjdC48c3RyaW5nfE9iamVjdD59YCDigJMgTWFwIG9mIHN0cmluZ3Mgb3Igb2JqZWN0cyB3aGljaCB3aWxsIGJlIHNlcmlhbGl6ZWRcbiAgICAgKiAgICAgIHdpdGggdGhlIGBwYXJhbVNlcmlhbGl6ZXJgIGFuZCBhcHBlbmRlZCBhcyBHRVQgcGFyYW1ldGVycy5cbiAgICAgKiAgICAtICoqZGF0YSoqIOKAkyBge3N0cmluZ3xPYmplY3R9YCDigJMgRGF0YSB0byBiZSBzZW50IGFzIHRoZSByZXF1ZXN0IG1lc3NhZ2UgZGF0YS5cbiAgICAgKiAgICAtICoqaGVhZGVycyoqIOKAkyBge09iamVjdH1gIOKAkyBNYXAgb2Ygc3RyaW5ncyBvciBmdW5jdGlvbnMgd2hpY2ggcmV0dXJuIHN0cmluZ3MgcmVwcmVzZW50aW5nXG4gICAgICogICAgICBIVFRQIGhlYWRlcnMgdG8gc2VuZCB0byB0aGUgc2VydmVyLiBJZiB0aGUgcmV0dXJuIHZhbHVlIG9mIGEgZnVuY3Rpb24gaXMgbnVsbCwgdGhlXG4gICAgICogICAgICBoZWFkZXIgd2lsbCBub3QgYmUgc2VudC4gRnVuY3Rpb25zIGFjY2VwdCBhIGNvbmZpZyBvYmplY3QgYXMgYW4gYXJndW1lbnQuXG4gICAgICogICAgLSAqKnhzcmZIZWFkZXJOYW1lKiog4oCTIGB7c3RyaW5nfWAg4oCTIE5hbWUgb2YgSFRUUCBoZWFkZXIgdG8gcG9wdWxhdGUgd2l0aCB0aGUgWFNSRiB0b2tlbi5cbiAgICAgKiAgICAtICoqeHNyZkNvb2tpZU5hbWUqKiDigJMgYHtzdHJpbmd9YCDigJMgTmFtZSBvZiBjb29raWUgY29udGFpbmluZyB0aGUgWFNSRiB0b2tlbi5cbiAgICAgKiAgICAtICoqdHJhbnNmb3JtUmVxdWVzdCoqIOKAk1xuICAgICAqICAgICAgYHtmdW5jdGlvbihkYXRhLCBoZWFkZXJzR2V0dGVyKXxBcnJheS48ZnVuY3Rpb24oZGF0YSwgaGVhZGVyc0dldHRlcik+fWAg4oCTXG4gICAgICogICAgICB0cmFuc2Zvcm0gZnVuY3Rpb24gb3IgYW4gYXJyYXkgb2Ygc3VjaCBmdW5jdGlvbnMuIFRoZSB0cmFuc2Zvcm0gZnVuY3Rpb24gdGFrZXMgdGhlIGh0dHBcbiAgICAgKiAgICAgIHJlcXVlc3QgYm9keSBhbmQgaGVhZGVycyBhbmQgcmV0dXJucyBpdHMgdHJhbnNmb3JtZWQgKHR5cGljYWxseSBzZXJpYWxpemVkKSB2ZXJzaW9uLlxuICAgICAqICAgICAgU2VlIHtAbGluayBuZy4kaHR0cCNvdmVycmlkaW5nLXRoZS1kZWZhdWx0LXRyYW5zZm9ybWF0aW9ucy1wZXItcmVxdWVzdFxuICAgICAqICAgICAgT3ZlcnJpZGluZyB0aGUgRGVmYXVsdCBUcmFuc2Zvcm1hdGlvbnN9XG4gICAgICogICAgLSAqKnRyYW5zZm9ybVJlc3BvbnNlKiog4oCTXG4gICAgICogICAgICBge2Z1bmN0aW9uKGRhdGEsIGhlYWRlcnNHZXR0ZXIsIHN0YXR1cyl8QXJyYXkuPGZ1bmN0aW9uKGRhdGEsIGhlYWRlcnNHZXR0ZXIsIHN0YXR1cyk+fWAg4oCTXG4gICAgICogICAgICB0cmFuc2Zvcm0gZnVuY3Rpb24gb3IgYW4gYXJyYXkgb2Ygc3VjaCBmdW5jdGlvbnMuIFRoZSB0cmFuc2Zvcm0gZnVuY3Rpb24gdGFrZXMgdGhlIGh0dHBcbiAgICAgKiAgICAgIHJlc3BvbnNlIGJvZHksIGhlYWRlcnMgYW5kIHN0YXR1cyBhbmQgcmV0dXJucyBpdHMgdHJhbnNmb3JtZWQgKHR5cGljYWxseSBkZXNlcmlhbGl6ZWQpIHZlcnNpb24uXG4gICAgICogICAgICBTZWUge0BsaW5rIG5nLiRodHRwI292ZXJyaWRpbmctdGhlLWRlZmF1bHQtdHJhbnNmb3JtYXRpb25zLXBlci1yZXF1ZXN0XG4gICAgICogICAgICBPdmVycmlkaW5nIHRoZSBEZWZhdWx0IFRyYW5zZm9ybWF0aW9uanFMaWtzfVxuICAgICAqICAgIC0gKipwYXJhbVNlcmlhbGl6ZXIqKiAtIGB7c3RyaW5nfGZ1bmN0aW9uKE9iamVjdDxzdHJpbmcsc3RyaW5nPik6c3RyaW5nfWAgLSBBIGZ1bmN0aW9uIHVzZWQgdG9cbiAgICAgKiAgICAgIHByZXBhcmUgdGhlIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiByZXF1ZXN0IHBhcmFtZXRlcnMgKHNwZWNpZmllZCBhcyBhbiBvYmplY3QpLlxuICAgICAqICAgICAgSWYgc3BlY2lmaWVkIGFzIHN0cmluZywgaXQgaXMgaW50ZXJwcmV0ZWQgYXMgZnVuY3Rpb24gcmVnaXN0ZXJlZCB3aXRoIHRoZVxuICAgICAqICAgICAge0BsaW5rICRpbmplY3RvciAkaW5qZWN0b3J9LCB3aGljaCBtZWFucyB5b3UgY2FuIGNyZWF0ZSB5b3VyIG93biBzZXJpYWxpemVyXG4gICAgICogICAgICBieSByZWdpc3RlcmluZyBpdCBhcyBhIHtAbGluayBhdXRvLiRwcm92aWRlI3NlcnZpY2Ugc2VydmljZX0uXG4gICAgICogICAgICBUaGUgZGVmYXVsdCBzZXJpYWxpemVyIGlzIHRoZSB7QGxpbmsgJGh0dHBQYXJhbVNlcmlhbGl6ZXIgJGh0dHBQYXJhbVNlcmlhbGl6ZXJ9O1xuICAgICAqICAgICAgYWx0ZXJuYXRpdmVseSwgeW91IGNhbiB1c2UgdGhlIHtAbGluayAkaHR0cFBhcmFtU2VyaWFsaXplckpRTGlrZSAkaHR0cFBhcmFtU2VyaWFsaXplckpRTGlrZX1cbiAgICAgKiAgICAtICoqY2FjaGUqKiDigJMgYHtib29sZWFufENhY2hlfWAg4oCTIElmIHRydWUsIGEgZGVmYXVsdCAkaHR0cCBjYWNoZSB3aWxsIGJlIHVzZWQgdG8gY2FjaGUgdGhlXG4gICAgICogICAgICBHRVQgcmVxdWVzdCwgb3RoZXJ3aXNlIGlmIGEgY2FjaGUgaW5zdGFuY2UgYnVpbHQgd2l0aFxuICAgICAqICAgICAge0BsaW5rIG5nLiRjYWNoZUZhY3RvcnkgJGNhY2hlRmFjdG9yeX0sIHRoaXMgY2FjaGUgd2lsbCBiZSB1c2VkIGZvclxuICAgICAqICAgICAgY2FjaGluZy5cbiAgICAgKiAgICAtICoqdGltZW91dCoqIOKAkyBge251bWJlcnxQcm9taXNlfWAg4oCTIHRpbWVvdXQgaW4gbWlsbGlzZWNvbmRzLCBvciB7QGxpbmsgbmcuJHEgcHJvbWlzZX1cbiAgICAgKiAgICAgIHRoYXQgc2hvdWxkIGFib3J0IHRoZSByZXF1ZXN0IHdoZW4gcmVzb2x2ZWQuXG4gICAgICogICAgLSAqKndpdGhDcmVkZW50aWFscyoqIC0gYHtib29sZWFufWAgLSB3aGV0aGVyIHRvIHNldCB0aGUgYHdpdGhDcmVkZW50aWFsc2AgZmxhZyBvbiB0aGVcbiAgICAgKiAgICAgIFhIUiBvYmplY3QuIFNlZSBbcmVxdWVzdHMgd2l0aCBjcmVkZW50aWFsc10oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZG9jcy9XZWIvSFRUUC9BY2Nlc3NfY29udHJvbF9DT1JTI1JlcXVlc3RzX3dpdGhfY3JlZGVudGlhbHMpXG4gICAgICogICAgICBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAgICAgKiAgICAtICoqcmVzcG9uc2VUeXBlKiogLSBge3N0cmluZ31gIC0gc2VlXG4gICAgICogICAgICBbWE1MSHR0cFJlcXVlc3QucmVzcG9uc2VUeXBlXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvWE1MSHR0cFJlcXVlc3QjeG1saHR0cHJlcXVlc3QtcmVzcG9uc2V0eXBlKS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtIdHRwUHJvbWlzZX0gUmV0dXJucyBhIHtAbGluayBuZy4kcSBgUHJvbWlzZX1gIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB0byBhIHJlc3BvbnNlIG9iamVjdFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiB0aGUgcmVxdWVzdCBzdWNjZWVkcyBvciBmYWlscy5cbiAgICAgKlxuICAgICAqXG4gICAgICogQHByb3BlcnR5IHtBcnJheS48T2JqZWN0Pn0gcGVuZGluZ1JlcXVlc3RzIEFycmF5IG9mIGNvbmZpZyBvYmplY3RzIGZvciBjdXJyZW50bHkgcGVuZGluZ1xuICAgICAqICAgcmVxdWVzdHMuIFRoaXMgaXMgcHJpbWFyaWx5IG1lYW50IHRvIGJlIHVzZWQgZm9yIGRlYnVnZ2luZyBwdXJwb3Nlcy5cbiAgICAgKlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbjxleGFtcGxlIG1vZHVsZT1cImh0dHBFeGFtcGxlXCI+XG48ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJGZXRjaENvbnRyb2xsZXJcIj5cbiAgICA8c2VsZWN0IG5nLW1vZGVsPVwibWV0aG9kXCIgYXJpYS1sYWJlbD1cIlJlcXVlc3QgbWV0aG9kXCI+XG4gICAgICA8b3B0aW9uPkdFVDwvb3B0aW9uPlxuICAgICAgPG9wdGlvbj5KU09OUDwvb3B0aW9uPlxuICAgIDwvc2VsZWN0PlxuICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwidXJsXCIgc2l6ZT1cIjgwXCIgYXJpYS1sYWJlbD1cIlVSTFwiIC8+XG4gICAgPGJ1dHRvbiBpZD1cImZldGNoYnRuXCIgbmctY2xpY2s9XCJmZXRjaCgpXCI+ZmV0Y2g8L2J1dHRvbj48YnI+XG4gICAgPGJ1dHRvbiBpZD1cInNhbXBsZWdldGJ0blwiIG5nLWNsaWNrPVwidXBkYXRlTW9kZWwoJ0dFVCcsICdodHRwLWhlbGxvLmh0bWwnKVwiPlNhbXBsZSBHRVQ8L2J1dHRvbj5cbiAgICA8YnV0dG9uIGlkPVwic2FtcGxlanNvbnBidG5cIlxuICAgICAgbmctY2xpY2s9XCJ1cGRhdGVNb2RlbCgnSlNPTlAnLFxuICAgICAgICAgICAgICAgICAgICAnaHR0cHM6Ly9hbmd1bGFyanMub3JnL2dyZWV0LnBocD9jYWxsYmFjaz1KU09OX0NBTExCQUNLJm5hbWU9U3VwZXIlMjBIZXJvJylcIj5cbiAgICAgIFNhbXBsZSBKU09OUFxuICAgIDwvYnV0dG9uPlxuICAgIDxidXR0b24gaWQ9XCJpbnZhbGlkanNvbnBidG5cIlxuICAgICAgbmctY2xpY2s9XCJ1cGRhdGVNb2RlbCgnSlNPTlAnLCAnaHR0cHM6Ly9hbmd1bGFyanMub3JnL2RvZXNudGV4aXN0JmNhbGxiYWNrPUpTT05fQ0FMTEJBQ0snKVwiPlxuICAgICAgICBJbnZhbGlkIEpTT05QXG4gICAgICA8L2J1dHRvbj5cbiAgICA8cHJlPmh0dHAgc3RhdHVzIGNvZGU6IHt7c3RhdHVzfX08L3ByZT5cbiAgICA8cHJlPmh0dHAgcmVzcG9uc2UgZGF0YToge3tkYXRhfX08L3ByZT5cbiAgPC9kaXY+XG48L2ZpbGU+XG48ZmlsZSBuYW1lPVwic2NyaXB0LmpzXCI+XG4gIGFuZ3VsYXIubW9kdWxlKCdodHRwRXhhbXBsZScsIFtdKVxuICAgIC5jb250cm9sbGVyKCdGZXRjaENvbnRyb2xsZXInLCBbJyRzY29wZScsICckaHR0cCcsICckdGVtcGxhdGVDYWNoZScsXG4gICAgICBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkdGVtcGxhdGVDYWNoZSkge1xuICAgICAgICAkc2NvcGUubWV0aG9kID0gJ0dFVCc7XG4gICAgICAgICRzY29wZS51cmwgPSAnaHR0cC1oZWxsby5odG1sJztcblxuICAgICAgICAkc2NvcGUuZmV0Y2ggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkc2NvcGUuY29kZSA9IG51bGw7XG4gICAgICAgICAgJHNjb3BlLnJlc3BvbnNlID0gbnVsbDtcblxuICAgICAgICAgICRodHRwKHttZXRob2Q6ICRzY29wZS5tZXRob2QsIHVybDogJHNjb3BlLnVybCwgY2FjaGU6ICR0ZW1wbGF0ZUNhY2hlfSkuXG4gICAgICAgICAgICB0aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICRzY29wZS5zdGF0dXMgPSByZXNwb25zZS5zdGF0dXM7XG4gICAgICAgICAgICAgICRzY29wZS5kYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICRzY29wZS5kYXRhID0gcmVzcG9uc2UuZGF0YSB8fCBcIlJlcXVlc3QgZmFpbGVkXCI7XG4gICAgICAgICAgICAgICRzY29wZS5zdGF0dXMgPSByZXNwb25zZS5zdGF0dXM7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnVwZGF0ZU1vZGVsID0gZnVuY3Rpb24obWV0aG9kLCB1cmwpIHtcbiAgICAgICAgICAkc2NvcGUubWV0aG9kID0gbWV0aG9kO1xuICAgICAgICAgICRzY29wZS51cmwgPSB1cmw7XG4gICAgICAgIH07XG4gICAgICB9XSk7XG48L2ZpbGU+XG48ZmlsZSBuYW1lPVwiaHR0cC1oZWxsby5odG1sXCI+XG4gIEhlbGxvLCAkaHR0cCFcbjwvZmlsZT5cbjxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgdmFyIHN0YXR1cyA9IGVsZW1lbnQoYnkuYmluZGluZygnc3RhdHVzJykpO1xuICB2YXIgZGF0YSA9IGVsZW1lbnQoYnkuYmluZGluZygnZGF0YScpKTtcbiAgdmFyIGZldGNoQnRuID0gZWxlbWVudChieS5pZCgnZmV0Y2hidG4nKSk7XG4gIHZhciBzYW1wbGVHZXRCdG4gPSBlbGVtZW50KGJ5LmlkKCdzYW1wbGVnZXRidG4nKSk7XG4gIHZhciBzYW1wbGVKc29ucEJ0biA9IGVsZW1lbnQoYnkuaWQoJ3NhbXBsZWpzb25wYnRuJykpO1xuICB2YXIgaW52YWxpZEpzb25wQnRuID0gZWxlbWVudChieS5pZCgnaW52YWxpZGpzb25wYnRuJykpO1xuXG4gIGl0KCdzaG91bGQgbWFrZSBhbiB4aHIgR0VUIHJlcXVlc3QnLCBmdW5jdGlvbigpIHtcbiAgICBzYW1wbGVHZXRCdG4uY2xpY2soKTtcbiAgICBmZXRjaEJ0bi5jbGljaygpO1xuICAgIGV4cGVjdChzdGF0dXMuZ2V0VGV4dCgpKS50b01hdGNoKCcyMDAnKTtcbiAgICBleHBlY3QoZGF0YS5nZXRUZXh0KCkpLnRvTWF0Y2goL0hlbGxvLCBcXCRodHRwIS8pO1xuICB9KTtcblxuLy8gQ29tbWVudGVkIG91dCBkdWUgdG8gZmxha2VzLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy9pc3N1ZXMvOTE4NVxuLy8gaXQoJ3Nob3VsZCBtYWtlIGEgSlNPTlAgcmVxdWVzdCB0byBhbmd1bGFyanMub3JnJywgZnVuY3Rpb24oKSB7XG4vLyAgIHNhbXBsZUpzb25wQnRuLmNsaWNrKCk7XG4vLyAgIGZldGNoQnRuLmNsaWNrKCk7XG4vLyAgIGV4cGVjdChzdGF0dXMuZ2V0VGV4dCgpKS50b01hdGNoKCcyMDAnKTtcbi8vICAgZXhwZWN0KGRhdGEuZ2V0VGV4dCgpKS50b01hdGNoKC9TdXBlciBIZXJvIS8pO1xuLy8gfSk7XG5cbiAgaXQoJ3Nob3VsZCBtYWtlIEpTT05QIHJlcXVlc3QgdG8gaW52YWxpZCBVUkwgYW5kIGludm9rZSB0aGUgZXJyb3IgaGFuZGxlcicsXG4gICAgICBmdW5jdGlvbigpIHtcbiAgICBpbnZhbGlkSnNvbnBCdG4uY2xpY2soKTtcbiAgICBmZXRjaEJ0bi5jbGljaygpO1xuICAgIGV4cGVjdChzdGF0dXMuZ2V0VGV4dCgpKS50b01hdGNoKCcwJyk7XG4gICAgZXhwZWN0KGRhdGEuZ2V0VGV4dCgpKS50b01hdGNoKCdSZXF1ZXN0IGZhaWxlZCcpO1xuICB9KTtcbjwvZmlsZT5cbjwvZXhhbXBsZT5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiAkaHR0cChyZXF1ZXN0Q29uZmlnKSB7XG5cbiAgICAgIGlmICghaXNPYmplY3QocmVxdWVzdENvbmZpZykpIHtcbiAgICAgICAgdGhyb3cgbWluRXJyKCckaHR0cCcpKCdiYWRyZXEnLCAnSHR0cCByZXF1ZXN0IGNvbmZpZ3VyYXRpb24gbXVzdCBiZSBhbiBvYmplY3QuICBSZWNlaXZlZDogezB9JywgcmVxdWVzdENvbmZpZyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghaXNTdHJpbmcocmVxdWVzdENvbmZpZy51cmwpKSB7XG4gICAgICAgIHRocm93IG1pbkVycignJGh0dHAnKSgnYmFkcmVxJywgJ0h0dHAgcmVxdWVzdCBjb25maWd1cmF0aW9uIHVybCBtdXN0IGJlIGEgc3RyaW5nLiAgUmVjZWl2ZWQ6IHswfScsIHJlcXVlc3RDb25maWcudXJsKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGNvbmZpZyA9IGV4dGVuZCh7XG4gICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IGRlZmF1bHRzLnRyYW5zZm9ybVJlcXVlc3QsXG4gICAgICAgIHRyYW5zZm9ybVJlc3BvbnNlOiBkZWZhdWx0cy50cmFuc2Zvcm1SZXNwb25zZSxcbiAgICAgICAgcGFyYW1TZXJpYWxpemVyOiBkZWZhdWx0cy5wYXJhbVNlcmlhbGl6ZXJcbiAgICAgIH0sIHJlcXVlc3RDb25maWcpO1xuXG4gICAgICBjb25maWcuaGVhZGVycyA9IG1lcmdlSGVhZGVycyhyZXF1ZXN0Q29uZmlnKTtcbiAgICAgIGNvbmZpZy5tZXRob2QgPSB1cHBlcmNhc2UoY29uZmlnLm1ldGhvZCk7XG4gICAgICBjb25maWcucGFyYW1TZXJpYWxpemVyID0gaXNTdHJpbmcoY29uZmlnLnBhcmFtU2VyaWFsaXplcikgP1xuICAgICAgICAkaW5qZWN0b3IuZ2V0KGNvbmZpZy5wYXJhbVNlcmlhbGl6ZXIpIDogY29uZmlnLnBhcmFtU2VyaWFsaXplcjtcblxuICAgICAgdmFyIHNlcnZlclJlcXVlc3QgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgdmFyIGhlYWRlcnMgPSBjb25maWcuaGVhZGVycztcbiAgICAgICAgdmFyIHJlcURhdGEgPSB0cmFuc2Zvcm1EYXRhKGNvbmZpZy5kYXRhLCBoZWFkZXJzR2V0dGVyKGhlYWRlcnMpLCB1bmRlZmluZWQsIGNvbmZpZy50cmFuc2Zvcm1SZXF1ZXN0KTtcblxuICAgICAgICAvLyBzdHJpcCBjb250ZW50LXR5cGUgaWYgZGF0YSBpcyB1bmRlZmluZWRcbiAgICAgICAgaWYgKGlzVW5kZWZpbmVkKHJlcURhdGEpKSB7XG4gICAgICAgICAgZm9yRWFjaChoZWFkZXJzLCBmdW5jdGlvbih2YWx1ZSwgaGVhZGVyKSB7XG4gICAgICAgICAgICBpZiAobG93ZXJjYXNlKGhlYWRlcikgPT09ICdjb250ZW50LXR5cGUnKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGhlYWRlcnNbaGVhZGVyXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc1VuZGVmaW5lZChjb25maWcud2l0aENyZWRlbnRpYWxzKSAmJiAhaXNVbmRlZmluZWQoZGVmYXVsdHMud2l0aENyZWRlbnRpYWxzKSkge1xuICAgICAgICAgIGNvbmZpZy53aXRoQ3JlZGVudGlhbHMgPSBkZWZhdWx0cy53aXRoQ3JlZGVudGlhbHM7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzZW5kIHJlcXVlc3RcbiAgICAgICAgcmV0dXJuIHNlbmRSZXEoY29uZmlnLCByZXFEYXRhKS50aGVuKHRyYW5zZm9ybVJlc3BvbnNlLCB0cmFuc2Zvcm1SZXNwb25zZSk7XG4gICAgICB9O1xuXG4gICAgICB2YXIgY2hhaW4gPSBbc2VydmVyUmVxdWVzdCwgdW5kZWZpbmVkXTtcbiAgICAgIHZhciBwcm9taXNlID0gJHEud2hlbihjb25maWcpO1xuXG4gICAgICAvLyBhcHBseSBpbnRlcmNlcHRvcnNcbiAgICAgIGZvckVhY2gocmV2ZXJzZWRJbnRlcmNlcHRvcnMsIGZ1bmN0aW9uKGludGVyY2VwdG9yKSB7XG4gICAgICAgIGlmIChpbnRlcmNlcHRvci5yZXF1ZXN0IHx8IGludGVyY2VwdG9yLnJlcXVlc3RFcnJvcikge1xuICAgICAgICAgIGNoYWluLnVuc2hpZnQoaW50ZXJjZXB0b3IucmVxdWVzdCwgaW50ZXJjZXB0b3IucmVxdWVzdEVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW50ZXJjZXB0b3IucmVzcG9uc2UgfHwgaW50ZXJjZXB0b3IucmVzcG9uc2VFcnJvcikge1xuICAgICAgICAgIGNoYWluLnB1c2goaW50ZXJjZXB0b3IucmVzcG9uc2UsIGludGVyY2VwdG9yLnJlc3BvbnNlRXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgd2hpbGUgKGNoYWluLmxlbmd0aCkge1xuICAgICAgICB2YXIgdGhlbkZuID0gY2hhaW4uc2hpZnQoKTtcbiAgICAgICAgdmFyIHJlamVjdEZuID0gY2hhaW4uc2hpZnQoKTtcblxuICAgICAgICBwcm9taXNlID0gcHJvbWlzZS50aGVuKHRoZW5GbiwgcmVqZWN0Rm4pO1xuICAgICAgfVxuXG4gICAgICBpZiAodXNlTGVnYWN5UHJvbWlzZSkge1xuICAgICAgICBwcm9taXNlLnN1Y2Nlc3MgPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgIGFzc2VydEFyZ0ZuKGZuLCAnZm4nKTtcblxuICAgICAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgZm4ocmVzcG9uc2UuZGF0YSwgcmVzcG9uc2Uuc3RhdHVzLCByZXNwb25zZS5oZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHByb21pc2UuZXJyb3IgPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgIGFzc2VydEFyZ0ZuKGZuLCAnZm4nKTtcblxuICAgICAgICAgIHByb21pc2UudGhlbihudWxsLCBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgZm4ocmVzcG9uc2UuZGF0YSwgcmVzcG9uc2Uuc3RhdHVzLCByZXNwb25zZS5oZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJvbWlzZS5zdWNjZXNzID0gJGh0dHBNaW5FcnJMZWdhY3lGbignc3VjY2VzcycpO1xuICAgICAgICBwcm9taXNlLmVycm9yID0gJGh0dHBNaW5FcnJMZWdhY3lGbignZXJyb3InKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByb21pc2U7XG5cbiAgICAgIGZ1bmN0aW9uIHRyYW5zZm9ybVJlc3BvbnNlKHJlc3BvbnNlKSB7XG4gICAgICAgIC8vIG1ha2UgYSBjb3B5IHNpbmNlIHRoZSByZXNwb25zZSBtdXN0IGJlIGNhY2hlYWJsZVxuICAgICAgICB2YXIgcmVzcCA9IGV4dGVuZCh7fSwgcmVzcG9uc2UpO1xuICAgICAgICByZXNwLmRhdGEgPSB0cmFuc2Zvcm1EYXRhKHJlc3BvbnNlLmRhdGEsIHJlc3BvbnNlLmhlYWRlcnMsIHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWcudHJhbnNmb3JtUmVzcG9uc2UpO1xuICAgICAgICByZXR1cm4gKGlzU3VjY2VzcyhyZXNwb25zZS5zdGF0dXMpKVxuICAgICAgICAgID8gcmVzcFxuICAgICAgICAgIDogJHEucmVqZWN0KHJlc3ApO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBleGVjdXRlSGVhZGVyRm5zKGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICB2YXIgaGVhZGVyQ29udGVudCwgcHJvY2Vzc2VkSGVhZGVycyA9IHt9O1xuXG4gICAgICAgIGZvckVhY2goaGVhZGVycywgZnVuY3Rpb24oaGVhZGVyRm4sIGhlYWRlcikge1xuICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGhlYWRlckZuKSkge1xuICAgICAgICAgICAgaGVhZGVyQ29udGVudCA9IGhlYWRlckZuKGNvbmZpZyk7XG4gICAgICAgICAgICBpZiAoaGVhZGVyQ29udGVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHByb2Nlc3NlZEhlYWRlcnNbaGVhZGVyXSA9IGhlYWRlckNvbnRlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb2Nlc3NlZEhlYWRlcnNbaGVhZGVyXSA9IGhlYWRlckZuO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHByb2Nlc3NlZEhlYWRlcnM7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG1lcmdlSGVhZGVycyhjb25maWcpIHtcbiAgICAgICAgdmFyIGRlZkhlYWRlcnMgPSBkZWZhdWx0cy5oZWFkZXJzLFxuICAgICAgICAgICAgcmVxSGVhZGVycyA9IGV4dGVuZCh7fSwgY29uZmlnLmhlYWRlcnMpLFxuICAgICAgICAgICAgZGVmSGVhZGVyTmFtZSwgbG93ZXJjYXNlRGVmSGVhZGVyTmFtZSwgcmVxSGVhZGVyTmFtZTtcblxuICAgICAgICBkZWZIZWFkZXJzID0gZXh0ZW5kKHt9LCBkZWZIZWFkZXJzLmNvbW1vbiwgZGVmSGVhZGVyc1tsb3dlcmNhc2UoY29uZmlnLm1ldGhvZCldKTtcblxuICAgICAgICAvLyB1c2luZyBmb3ItaW4gaW5zdGVhZCBvZiBmb3JFYWNoIHRvIGF2b2lkIHVubmVjZXNzYXJ5IGl0ZXJhdGlvbiBhZnRlciBoZWFkZXIgaGFzIGJlZW4gZm91bmRcbiAgICAgICAgZGVmYXVsdEhlYWRlcnNJdGVyYXRpb246XG4gICAgICAgIGZvciAoZGVmSGVhZGVyTmFtZSBpbiBkZWZIZWFkZXJzKSB7XG4gICAgICAgICAgbG93ZXJjYXNlRGVmSGVhZGVyTmFtZSA9IGxvd2VyY2FzZShkZWZIZWFkZXJOYW1lKTtcblxuICAgICAgICAgIGZvciAocmVxSGVhZGVyTmFtZSBpbiByZXFIZWFkZXJzKSB7XG4gICAgICAgICAgICBpZiAobG93ZXJjYXNlKHJlcUhlYWRlck5hbWUpID09PSBsb3dlcmNhc2VEZWZIZWFkZXJOYW1lKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlIGRlZmF1bHRIZWFkZXJzSXRlcmF0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHJlcUhlYWRlcnNbZGVmSGVhZGVyTmFtZV0gPSBkZWZIZWFkZXJzW2RlZkhlYWRlck5hbWVdO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZXhlY3V0ZSBpZiBoZWFkZXIgdmFsdWUgaXMgYSBmdW5jdGlvbiBmb3IgbWVyZ2VkIGhlYWRlcnNcbiAgICAgICAgcmV0dXJuIGV4ZWN1dGVIZWFkZXJGbnMocmVxSGVhZGVycywgc2hhbGxvd0NvcHkoY29uZmlnKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgJGh0dHAucGVuZGluZ1JlcXVlc3RzID0gW107XG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgJGh0dHAjZ2V0XG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBTaG9ydGN1dCBtZXRob2QgdG8gcGVyZm9ybSBgR0VUYCByZXF1ZXN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCBSZWxhdGl2ZSBvciBhYnNvbHV0ZSBVUkwgc3BlY2lmeWluZyB0aGUgZGVzdGluYXRpb24gb2YgdGhlIHJlcXVlc3RcbiAgICAgKiBAcGFyYW0ge09iamVjdD19IGNvbmZpZyBPcHRpb25hbCBjb25maWd1cmF0aW9uIG9iamVjdFxuICAgICAqIEByZXR1cm5zIHtIdHRwUHJvbWlzZX0gRnV0dXJlIG9iamVjdFxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAqIEBuYW1lICRodHRwI2RlbGV0ZVxuICAgICAqXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICogU2hvcnRjdXQgbWV0aG9kIHRvIHBlcmZvcm0gYERFTEVURWAgcmVxdWVzdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgUmVsYXRpdmUgb3IgYWJzb2x1dGUgVVJMIHNwZWNpZnlpbmcgdGhlIGRlc3RpbmF0aW9uIG9mIHRoZSByZXF1ZXN0XG4gICAgICogQHBhcmFtIHtPYmplY3Q9fSBjb25maWcgT3B0aW9uYWwgY29uZmlndXJhdGlvbiBvYmplY3RcbiAgICAgKiBAcmV0dXJucyB7SHR0cFByb21pc2V9IEZ1dHVyZSBvYmplY3RcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkaHR0cCNoZWFkXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBTaG9ydGN1dCBtZXRob2QgdG8gcGVyZm9ybSBgSEVBRGAgcmVxdWVzdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgUmVsYXRpdmUgb3IgYWJzb2x1dGUgVVJMIHNwZWNpZnlpbmcgdGhlIGRlc3RpbmF0aW9uIG9mIHRoZSByZXF1ZXN0XG4gICAgICogQHBhcmFtIHtPYmplY3Q9fSBjb25maWcgT3B0aW9uYWwgY29uZmlndXJhdGlvbiBvYmplY3RcbiAgICAgKiBAcmV0dXJucyB7SHR0cFByb21pc2V9IEZ1dHVyZSBvYmplY3RcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkaHR0cCNqc29ucFxuICAgICAqXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICogU2hvcnRjdXQgbWV0aG9kIHRvIHBlcmZvcm0gYEpTT05QYCByZXF1ZXN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCBSZWxhdGl2ZSBvciBhYnNvbHV0ZSBVUkwgc3BlY2lmeWluZyB0aGUgZGVzdGluYXRpb24gb2YgdGhlIHJlcXVlc3QuXG4gICAgICogICAgICAgICAgICAgICAgICAgICBUaGUgbmFtZSBvZiB0aGUgY2FsbGJhY2sgc2hvdWxkIGJlIHRoZSBzdHJpbmcgYEpTT05fQ0FMTEJBQ0tgLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0PX0gY29uZmlnIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb24gb2JqZWN0XG4gICAgICogQHJldHVybnMge0h0dHBQcm9taXNlfSBGdXR1cmUgb2JqZWN0XG4gICAgICovXG4gICAgY3JlYXRlU2hvcnRNZXRob2RzKCdnZXQnLCAnZGVsZXRlJywgJ2hlYWQnLCAnanNvbnAnKTtcblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkaHR0cCNwb3N0XG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBTaG9ydGN1dCBtZXRob2QgdG8gcGVyZm9ybSBgUE9TVGAgcmVxdWVzdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgUmVsYXRpdmUgb3IgYWJzb2x1dGUgVVJMIHNwZWNpZnlpbmcgdGhlIGRlc3RpbmF0aW9uIG9mIHRoZSByZXF1ZXN0XG4gICAgICogQHBhcmFtIHsqfSBkYXRhIFJlcXVlc3QgY29udGVudFxuICAgICAqIEBwYXJhbSB7T2JqZWN0PX0gY29uZmlnIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb24gb2JqZWN0XG4gICAgICogQHJldHVybnMge0h0dHBQcm9taXNlfSBGdXR1cmUgb2JqZWN0XG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgJGh0dHAjcHV0XG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBTaG9ydGN1dCBtZXRob2QgdG8gcGVyZm9ybSBgUFVUYCByZXF1ZXN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCBSZWxhdGl2ZSBvciBhYnNvbHV0ZSBVUkwgc3BlY2lmeWluZyB0aGUgZGVzdGluYXRpb24gb2YgdGhlIHJlcXVlc3RcbiAgICAgKiBAcGFyYW0geyp9IGRhdGEgUmVxdWVzdCBjb250ZW50XG4gICAgICogQHBhcmFtIHtPYmplY3Q9fSBjb25maWcgT3B0aW9uYWwgY29uZmlndXJhdGlvbiBvYmplY3RcbiAgICAgKiBAcmV0dXJucyB7SHR0cFByb21pc2V9IEZ1dHVyZSBvYmplY3RcbiAgICAgKi9cblxuICAgICAvKipcbiAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgKiBAbmFtZSAkaHR0cCNwYXRjaFxuICAgICAgKlxuICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICogU2hvcnRjdXQgbWV0aG9kIHRvIHBlcmZvcm0gYFBBVENIYCByZXF1ZXN0LlxuICAgICAgKlxuICAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIFJlbGF0aXZlIG9yIGFic29sdXRlIFVSTCBzcGVjaWZ5aW5nIHRoZSBkZXN0aW5hdGlvbiBvZiB0aGUgcmVxdWVzdFxuICAgICAgKiBAcGFyYW0geyp9IGRhdGEgUmVxdWVzdCBjb250ZW50XG4gICAgICAqIEBwYXJhbSB7T2JqZWN0PX0gY29uZmlnIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb24gb2JqZWN0XG4gICAgICAqIEByZXR1cm5zIHtIdHRwUHJvbWlzZX0gRnV0dXJlIG9iamVjdFxuICAgICAgKi9cbiAgICBjcmVhdGVTaG9ydE1ldGhvZHNXaXRoRGF0YSgncG9zdCcsICdwdXQnLCAncGF0Y2gnKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIHByb3BlcnR5XG4gICAgICAgICAqIEBuYW1lICRodHRwI2RlZmF1bHRzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBSdW50aW1lIGVxdWl2YWxlbnQgb2YgdGhlIGAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzYCBwcm9wZXJ0eS4gQWxsb3dzIGNvbmZpZ3VyYXRpb24gb2ZcbiAgICAgICAgICogZGVmYXVsdCBoZWFkZXJzLCB3aXRoQ3JlZGVudGlhbHMgYXMgd2VsbCBhcyByZXF1ZXN0IGFuZCByZXNwb25zZSB0cmFuc2Zvcm1hdGlvbnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIFNlZSBcIlNldHRpbmcgSFRUUCBIZWFkZXJzXCIgYW5kIFwiVHJhbnNmb3JtaW5nIFJlcXVlc3RzIGFuZCBSZXNwb25zZXNcIiBzZWN0aW9ucyBhYm92ZS5cbiAgICAgICAgICovXG4gICAgJGh0dHAuZGVmYXVsdHMgPSBkZWZhdWx0cztcblxuXG4gICAgcmV0dXJuICRodHRwO1xuXG5cbiAgICBmdW5jdGlvbiBjcmVhdGVTaG9ydE1ldGhvZHMobmFtZXMpIHtcbiAgICAgIGZvckVhY2goYXJndW1lbnRzLCBmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgICRodHRwW25hbWVdID0gZnVuY3Rpb24odXJsLCBjb25maWcpIHtcbiAgICAgICAgICByZXR1cm4gJGh0dHAoZXh0ZW5kKHt9LCBjb25maWcgfHwge30sIHtcbiAgICAgICAgICAgIG1ldGhvZDogbmFtZSxcbiAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgICAgfSkpO1xuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBjcmVhdGVTaG9ydE1ldGhvZHNXaXRoRGF0YShuYW1lKSB7XG4gICAgICBmb3JFYWNoKGFyZ3VtZW50cywgZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAkaHR0cFtuYW1lXSA9IGZ1bmN0aW9uKHVybCwgZGF0YSwgY29uZmlnKSB7XG4gICAgICAgICAgcmV0dXJuICRodHRwKGV4dGVuZCh7fSwgY29uZmlnIHx8IHt9LCB7XG4gICAgICAgICAgICBtZXRob2Q6IG5hbWUsXG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIGRhdGE6IGRhdGFcbiAgICAgICAgICB9KSk7XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIE1ha2VzIHRoZSByZXF1ZXN0LlxuICAgICAqXG4gICAgICogISEhIEFDQ0VTU0VTIENMT1NVUkUgVkFSUzpcbiAgICAgKiAkaHR0cEJhY2tlbmQsIGRlZmF1bHRzLCAkbG9nLCAkcm9vdFNjb3BlLCBkZWZhdWx0Q2FjaGUsICRodHRwLnBlbmRpbmdSZXF1ZXN0c1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNlbmRSZXEoY29uZmlnLCByZXFEYXRhKSB7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpLFxuICAgICAgICAgIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNlLFxuICAgICAgICAgIGNhY2hlLFxuICAgICAgICAgIGNhY2hlZFJlc3AsXG4gICAgICAgICAgcmVxSGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzLFxuICAgICAgICAgIHVybCA9IGJ1aWxkVXJsKGNvbmZpZy51cmwsIGNvbmZpZy5wYXJhbVNlcmlhbGl6ZXIoY29uZmlnLnBhcmFtcykpO1xuXG4gICAgICAkaHR0cC5wZW5kaW5nUmVxdWVzdHMucHVzaChjb25maWcpO1xuICAgICAgcHJvbWlzZS50aGVuKHJlbW92ZVBlbmRpbmdSZXEsIHJlbW92ZVBlbmRpbmdSZXEpO1xuXG5cbiAgICAgIGlmICgoY29uZmlnLmNhY2hlIHx8IGRlZmF1bHRzLmNhY2hlKSAmJiBjb25maWcuY2FjaGUgIT09IGZhbHNlICYmXG4gICAgICAgICAgKGNvbmZpZy5tZXRob2QgPT09ICdHRVQnIHx8IGNvbmZpZy5tZXRob2QgPT09ICdKU09OUCcpKSB7XG4gICAgICAgIGNhY2hlID0gaXNPYmplY3QoY29uZmlnLmNhY2hlKSA/IGNvbmZpZy5jYWNoZVxuICAgICAgICAgICAgICA6IGlzT2JqZWN0KGRlZmF1bHRzLmNhY2hlKSA/IGRlZmF1bHRzLmNhY2hlXG4gICAgICAgICAgICAgIDogZGVmYXVsdENhY2hlO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2FjaGUpIHtcbiAgICAgICAgY2FjaGVkUmVzcCA9IGNhY2hlLmdldCh1cmwpO1xuICAgICAgICBpZiAoaXNEZWZpbmVkKGNhY2hlZFJlc3ApKSB7XG4gICAgICAgICAgaWYgKGlzUHJvbWlzZUxpa2UoY2FjaGVkUmVzcCkpIHtcbiAgICAgICAgICAgIC8vIGNhY2hlZCByZXF1ZXN0IGhhcyBhbHJlYWR5IGJlZW4gc2VudCwgYnV0IHRoZXJlIGlzIG5vIHJlc3BvbnNlIHlldFxuICAgICAgICAgICAgY2FjaGVkUmVzcC50aGVuKHJlc29sdmVQcm9taXNlV2l0aFJlc3VsdCwgcmVzb2x2ZVByb21pc2VXaXRoUmVzdWx0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gc2VydmluZyBmcm9tIGNhY2hlXG4gICAgICAgICAgICBpZiAoaXNBcnJheShjYWNoZWRSZXNwKSkge1xuICAgICAgICAgICAgICByZXNvbHZlUHJvbWlzZShjYWNoZWRSZXNwWzFdLCBjYWNoZWRSZXNwWzBdLCBzaGFsbG93Q29weShjYWNoZWRSZXNwWzJdKSwgY2FjaGVkUmVzcFszXSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXNvbHZlUHJvbWlzZShjYWNoZWRSZXNwLCAyMDAsIHt9LCAnT0snKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gcHV0IHRoZSBwcm9taXNlIGZvciB0aGUgbm9uLXRyYW5zZm9ybWVkIHJlc3BvbnNlIGludG8gY2FjaGUgYXMgYSBwbGFjZWhvbGRlclxuICAgICAgICAgIGNhY2hlLnB1dCh1cmwsIHByb21pc2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cblxuICAgICAgLy8gaWYgd2Ugd29uJ3QgaGF2ZSB0aGUgcmVzcG9uc2UgaW4gY2FjaGUsIHNldCB0aGUgeHNyZiBoZWFkZXJzIGFuZFxuICAgICAgLy8gc2VuZCB0aGUgcmVxdWVzdCB0byB0aGUgYmFja2VuZFxuICAgICAgaWYgKGlzVW5kZWZpbmVkKGNhY2hlZFJlc3ApKSB7XG4gICAgICAgIHZhciB4c3JmVmFsdWUgPSB1cmxJc1NhbWVPcmlnaW4oY29uZmlnLnVybClcbiAgICAgICAgICAgID8gJCRjb29raWVSZWFkZXIoKVtjb25maWcueHNyZkNvb2tpZU5hbWUgfHwgZGVmYXVsdHMueHNyZkNvb2tpZU5hbWVdXG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKHhzcmZWYWx1ZSkge1xuICAgICAgICAgIHJlcUhlYWRlcnNbKGNvbmZpZy54c3JmSGVhZGVyTmFtZSB8fCBkZWZhdWx0cy54c3JmSGVhZGVyTmFtZSldID0geHNyZlZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgJGh0dHBCYWNrZW5kKGNvbmZpZy5tZXRob2QsIHVybCwgcmVxRGF0YSwgZG9uZSwgcmVxSGVhZGVycywgY29uZmlnLnRpbWVvdXQsXG4gICAgICAgICAgICBjb25maWcud2l0aENyZWRlbnRpYWxzLCBjb25maWcucmVzcG9uc2VUeXBlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByb21pc2U7XG5cblxuICAgICAgLyoqXG4gICAgICAgKiBDYWxsYmFjayByZWdpc3RlcmVkIHRvICRodHRwQmFja2VuZCgpOlxuICAgICAgICogIC0gY2FjaGVzIHRoZSByZXNwb25zZSBpZiBkZXNpcmVkXG4gICAgICAgKiAgLSByZXNvbHZlcyB0aGUgcmF3ICRodHRwIHByb21pc2VcbiAgICAgICAqICAtIGNhbGxzICRhcHBseVxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBkb25lKHN0YXR1cywgcmVzcG9uc2UsIGhlYWRlcnNTdHJpbmcsIHN0YXR1c1RleHQpIHtcbiAgICAgICAgaWYgKGNhY2hlKSB7XG4gICAgICAgICAgaWYgKGlzU3VjY2VzcyhzdGF0dXMpKSB7XG4gICAgICAgICAgICBjYWNoZS5wdXQodXJsLCBbc3RhdHVzLCByZXNwb25zZSwgcGFyc2VIZWFkZXJzKGhlYWRlcnNTdHJpbmcpLCBzdGF0dXNUZXh0XSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIHJlbW92ZSBwcm9taXNlIGZyb20gdGhlIGNhY2hlXG4gICAgICAgICAgICBjYWNoZS5yZW1vdmUodXJsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZXNvbHZlSHR0cFByb21pc2UoKSB7XG4gICAgICAgICAgcmVzb2x2ZVByb21pc2UocmVzcG9uc2UsIHN0YXR1cywgaGVhZGVyc1N0cmluZywgc3RhdHVzVGV4dCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodXNlQXBwbHlBc3luYykge1xuICAgICAgICAgICRyb290U2NvcGUuJGFwcGx5QXN5bmMocmVzb2x2ZUh0dHBQcm9taXNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNvbHZlSHR0cFByb21pc2UoKTtcbiAgICAgICAgICBpZiAoISRyb290U2NvcGUuJCRwaGFzZSkgJHJvb3RTY29wZS4kYXBwbHkoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG5cbiAgICAgIC8qKlxuICAgICAgICogUmVzb2x2ZXMgdGhlIHJhdyAkaHR0cCBwcm9taXNlLlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiByZXNvbHZlUHJvbWlzZShyZXNwb25zZSwgc3RhdHVzLCBoZWFkZXJzLCBzdGF0dXNUZXh0KSB7XG4gICAgICAgIC8vc3RhdHVzOiBIVFRQIHJlc3BvbnNlIHN0YXR1cyBjb2RlLCAwLCAtMSAoYWJvcnRlZCBieSB0aW1lb3V0IC8gcHJvbWlzZSlcbiAgICAgICAgc3RhdHVzID0gc3RhdHVzID49IC0xID8gc3RhdHVzIDogMDtcblxuICAgICAgICAoaXNTdWNjZXNzKHN0YXR1cykgPyBkZWZlcnJlZC5yZXNvbHZlIDogZGVmZXJyZWQucmVqZWN0KSh7XG4gICAgICAgICAgZGF0YTogcmVzcG9uc2UsXG4gICAgICAgICAgc3RhdHVzOiBzdGF0dXMsXG4gICAgICAgICAgaGVhZGVyczogaGVhZGVyc0dldHRlcihoZWFkZXJzKSxcbiAgICAgICAgICBjb25maWc6IGNvbmZpZyxcbiAgICAgICAgICBzdGF0dXNUZXh0OiBzdGF0dXNUZXh0XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiByZXNvbHZlUHJvbWlzZVdpdGhSZXN1bHQocmVzdWx0KSB7XG4gICAgICAgIHJlc29sdmVQcm9taXNlKHJlc3VsdC5kYXRhLCByZXN1bHQuc3RhdHVzLCBzaGFsbG93Q29weShyZXN1bHQuaGVhZGVycygpKSwgcmVzdWx0LnN0YXR1c1RleHQpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiByZW1vdmVQZW5kaW5nUmVxKCkge1xuICAgICAgICB2YXIgaWR4ID0gJGh0dHAucGVuZGluZ1JlcXVlc3RzLmluZGV4T2YoY29uZmlnKTtcbiAgICAgICAgaWYgKGlkeCAhPT0gLTEpICRodHRwLnBlbmRpbmdSZXF1ZXN0cy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGJ1aWxkVXJsKHVybCwgc2VyaWFsaXplZFBhcmFtcykge1xuICAgICAgaWYgKHNlcmlhbGl6ZWRQYXJhbXMubGVuZ3RoID4gMCkge1xuICAgICAgICB1cmwgKz0gKCh1cmwuaW5kZXhPZignPycpID09IC0xKSA/ICc/JyA6ICcmJykgKyBzZXJpYWxpemVkUGFyYW1zO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHVybDtcbiAgICB9XG4gIH1dO1xufVxuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkeGhyRmFjdG9yeVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogRmFjdG9yeSBmdW5jdGlvbiB1c2VkIHRvIGNyZWF0ZSBYTUxIdHRwUmVxdWVzdCBvYmplY3RzLlxuICpcbiAqIFJlcGxhY2Ugb3IgZGVjb3JhdGUgdGhpcyBzZXJ2aWNlIHRvIGNyZWF0ZSB5b3VyIG93biBjdXN0b20gWE1MSHR0cFJlcXVlc3Qgb2JqZWN0cy5cbiAqXG4gKiBgYGBcbiAqIGFuZ3VsYXIubW9kdWxlKCdteUFwcCcsIFtdKVxuICogLmZhY3RvcnkoJyR4aHJGYWN0b3J5JywgZnVuY3Rpb24oKSB7XG4gKiAgIHJldHVybiBmdW5jdGlvbiBjcmVhdGVYaHIobWV0aG9kLCB1cmwpIHtcbiAqICAgICByZXR1cm4gbmV3IHdpbmRvdy5YTUxIdHRwUmVxdWVzdCh7bW96U3lzdGVtOiB0cnVlfSk7XG4gKiAgIH07XG4gKiB9KTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXRob2QgSFRUUCBtZXRob2Qgb2YgdGhlIHJlcXVlc3QgKEdFVCwgUE9TVCwgUFVULCAuLilcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgVVJMIG9mIHRoZSByZXF1ZXN0LlxuICovXG5mdW5jdGlvbiAkeGhyRmFjdG9yeVByb3ZpZGVyKCkge1xuICB0aGlzLiRnZXQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gY3JlYXRlWGhyKCkge1xuICAgICAgcmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTtcbiAgICB9O1xuICB9O1xufVxuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkaHR0cEJhY2tlbmRcbiAqIEByZXF1aXJlcyAkd2luZG93XG4gKiBAcmVxdWlyZXMgJGRvY3VtZW50XG4gKiBAcmVxdWlyZXMgJHhockZhY3RvcnlcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIEhUVFAgYmFja2VuZCB1c2VkIGJ5IHRoZSB7QGxpbmsgbmcuJGh0dHAgc2VydmljZX0gdGhhdCBkZWxlZ2F0ZXMgdG9cbiAqIFhNTEh0dHBSZXF1ZXN0IG9iamVjdCBvciBKU09OUCBhbmQgZGVhbHMgd2l0aCBicm93c2VyIGluY29tcGF0aWJpbGl0aWVzLlxuICpcbiAqIFlvdSBzaG91bGQgbmV2ZXIgbmVlZCB0byB1c2UgdGhpcyBzZXJ2aWNlIGRpcmVjdGx5LCBpbnN0ZWFkIHVzZSB0aGUgaGlnaGVyLWxldmVsIGFic3RyYWN0aW9uczpcbiAqIHtAbGluayBuZy4kaHR0cCAkaHR0cH0gb3Ige0BsaW5rIG5nUmVzb3VyY2UuJHJlc291cmNlICRyZXNvdXJjZX0uXG4gKlxuICogRHVyaW5nIHRlc3RpbmcgdGhpcyBpbXBsZW1lbnRhdGlvbiBpcyBzd2FwcGVkIHdpdGgge0BsaW5rIG5nTW9jay4kaHR0cEJhY2tlbmQgbW9ja1xuICogJGh0dHBCYWNrZW5kfSB3aGljaCBjYW4gYmUgdHJhaW5lZCB3aXRoIHJlc3BvbnNlcy5cbiAqL1xuZnVuY3Rpb24gJEh0dHBCYWNrZW5kUHJvdmlkZXIoKSB7XG4gIHRoaXMuJGdldCA9IFsnJGJyb3dzZXInLCAnJHdpbmRvdycsICckZG9jdW1lbnQnLCAnJHhockZhY3RvcnknLCBmdW5jdGlvbigkYnJvd3NlciwgJHdpbmRvdywgJGRvY3VtZW50LCAkeGhyRmFjdG9yeSkge1xuICAgIHJldHVybiBjcmVhdGVIdHRwQmFja2VuZCgkYnJvd3NlciwgJHhockZhY3RvcnksICRicm93c2VyLmRlZmVyLCAkd2luZG93LmFuZ3VsYXIuY2FsbGJhY2tzLCAkZG9jdW1lbnRbMF0pO1xuICB9XTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlSHR0cEJhY2tlbmQoJGJyb3dzZXIsIGNyZWF0ZVhociwgJGJyb3dzZXJEZWZlciwgY2FsbGJhY2tzLCByYXdEb2N1bWVudCkge1xuICAvLyBUT0RPKHZvanRhKTogZml4IHRoZSBzaWduYXR1cmVcbiAgcmV0dXJuIGZ1bmN0aW9uKG1ldGhvZCwgdXJsLCBwb3N0LCBjYWxsYmFjaywgaGVhZGVycywgdGltZW91dCwgd2l0aENyZWRlbnRpYWxzLCByZXNwb25zZVR5cGUpIHtcbiAgICAkYnJvd3Nlci4kJGluY091dHN0YW5kaW5nUmVxdWVzdENvdW50KCk7XG4gICAgdXJsID0gdXJsIHx8ICRicm93c2VyLnVybCgpO1xuXG4gICAgaWYgKGxvd2VyY2FzZShtZXRob2QpID09ICdqc29ucCcpIHtcbiAgICAgIHZhciBjYWxsYmFja0lkID0gJ18nICsgKGNhbGxiYWNrcy5jb3VudGVyKyspLnRvU3RyaW5nKDM2KTtcbiAgICAgIGNhbGxiYWNrc1tjYWxsYmFja0lkXSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgY2FsbGJhY2tzW2NhbGxiYWNrSWRdLmRhdGEgPSBkYXRhO1xuICAgICAgICBjYWxsYmFja3NbY2FsbGJhY2tJZF0uY2FsbGVkID0gdHJ1ZTtcbiAgICAgIH07XG5cbiAgICAgIHZhciBqc29ucERvbmUgPSBqc29ucFJlcSh1cmwucmVwbGFjZSgnSlNPTl9DQUxMQkFDSycsICdhbmd1bGFyLmNhbGxiYWNrcy4nICsgY2FsbGJhY2tJZCksXG4gICAgICAgICAgY2FsbGJhY2tJZCwgZnVuY3Rpb24oc3RhdHVzLCB0ZXh0KSB7XG4gICAgICAgIGNvbXBsZXRlUmVxdWVzdChjYWxsYmFjaywgc3RhdHVzLCBjYWxsYmFja3NbY2FsbGJhY2tJZF0uZGF0YSwgXCJcIiwgdGV4dCk7XG4gICAgICAgIGNhbGxiYWNrc1tjYWxsYmFja0lkXSA9IG5vb3A7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuXG4gICAgICB2YXIgeGhyID0gY3JlYXRlWGhyKG1ldGhvZCwgdXJsKTtcblxuICAgICAgeGhyLm9wZW4obWV0aG9kLCB1cmwsIHRydWUpO1xuICAgICAgZm9yRWFjaChoZWFkZXJzLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgIGlmIChpc0RlZmluZWQodmFsdWUpKSB7XG4gICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihrZXksIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiByZXF1ZXN0TG9hZGVkKCkge1xuICAgICAgICB2YXIgc3RhdHVzVGV4dCA9IHhoci5zdGF0dXNUZXh0IHx8ICcnO1xuXG4gICAgICAgIC8vIHJlc3BvbnNlVGV4dCBpcyB0aGUgb2xkLXNjaG9vbCB3YXkgb2YgcmV0cmlldmluZyByZXNwb25zZSAoc3VwcG9ydGVkIGJ5IElFOSlcbiAgICAgICAgLy8gcmVzcG9uc2UvcmVzcG9uc2VUeXBlIHByb3BlcnRpZXMgd2VyZSBpbnRyb2R1Y2VkIGluIFhIUiBMZXZlbDIgc3BlYyAoc3VwcG9ydGVkIGJ5IElFMTApXG4gICAgICAgIHZhciByZXNwb25zZSA9ICgncmVzcG9uc2UnIGluIHhocikgPyB4aHIucmVzcG9uc2UgOiB4aHIucmVzcG9uc2VUZXh0O1xuXG4gICAgICAgIC8vIG5vcm1hbGl6ZSBJRTkgYnVnIChodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xNDUwKVxuICAgICAgICB2YXIgc3RhdHVzID0geGhyLnN0YXR1cyA9PT0gMTIyMyA/IDIwNCA6IHhoci5zdGF0dXM7XG5cbiAgICAgICAgLy8gZml4IHN0YXR1cyBjb2RlIHdoZW4gaXQgaXMgMCAoMCBzdGF0dXMgaXMgdW5kb2N1bWVudGVkKS5cbiAgICAgICAgLy8gT2NjdXJzIHdoZW4gYWNjZXNzaW5nIGZpbGUgcmVzb3VyY2VzIG9yIG9uIEFuZHJvaWQgNC4xIHN0b2NrIGJyb3dzZXJcbiAgICAgICAgLy8gd2hpbGUgcmV0cmlldmluZyBmaWxlcyBmcm9tIGFwcGxpY2F0aW9uIGNhY2hlLlxuICAgICAgICBpZiAoc3RhdHVzID09PSAwKSB7XG4gICAgICAgICAgc3RhdHVzID0gcmVzcG9uc2UgPyAyMDAgOiB1cmxSZXNvbHZlKHVybCkucHJvdG9jb2wgPT0gJ2ZpbGUnID8gNDA0IDogMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbXBsZXRlUmVxdWVzdChjYWxsYmFjayxcbiAgICAgICAgICAgIHN0YXR1cyxcbiAgICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgICAgeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpLFxuICAgICAgICAgICAgc3RhdHVzVGV4dCk7XG4gICAgICB9O1xuXG4gICAgICB2YXIgcmVxdWVzdEVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFRoZSByZXNwb25zZSBpcyBhbHdheXMgZW1wdHlcbiAgICAgICAgLy8gU2VlIGh0dHBzOi8veGhyLnNwZWMud2hhdHdnLm9yZy8jcmVxdWVzdC1lcnJvci1zdGVwcyBhbmQgaHR0cHM6Ly9mZXRjaC5zcGVjLndoYXR3Zy5vcmcvI2NvbmNlcHQtbmV0d29yay1lcnJvclxuICAgICAgICBjb21wbGV0ZVJlcXVlc3QoY2FsbGJhY2ssIC0xLCBudWxsLCBudWxsLCAnJyk7XG4gICAgICB9O1xuXG4gICAgICB4aHIub25lcnJvciA9IHJlcXVlc3RFcnJvcjtcbiAgICAgIHhoci5vbmFib3J0ID0gcmVxdWVzdEVycm9yO1xuXG4gICAgICBpZiAod2l0aENyZWRlbnRpYWxzKSB7XG4gICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVzcG9uc2VUeXBlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9IHJlc3BvbnNlVHlwZTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIC8vIFdlYktpdCBhZGRlZCBzdXBwb3J0IGZvciB0aGUganNvbiByZXNwb25zZVR5cGUgdmFsdWUgb24gMDkvMDMvMjAxM1xuICAgICAgICAgIC8vIGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD03MzY0OC4gVmVyc2lvbnMgb2YgU2FmYXJpIHByaW9yIHRvIDcgYXJlXG4gICAgICAgICAgLy8ga25vd24gdG8gdGhyb3cgd2hlbiBzZXR0aW5nIHRoZSB2YWx1ZSBcImpzb25cIiBhcyB0aGUgcmVzcG9uc2UgdHlwZS4gT3RoZXIgb2xkZXJcbiAgICAgICAgICAvLyBicm93c2VycyBpbXBsZW1lbnRpbmcgdGhlIHJlc3BvbnNlVHlwZVxuICAgICAgICAgIC8vXG4gICAgICAgICAgLy8gVGhlIGpzb24gcmVzcG9uc2UgdHlwZSBjYW4gYmUgaWdub3JlZCBpZiBub3Qgc3VwcG9ydGVkLCBiZWNhdXNlIEpTT04gcGF5bG9hZHMgYXJlXG4gICAgICAgICAgLy8gcGFyc2VkIG9uIHRoZSBjbGllbnQtc2lkZSByZWdhcmRsZXNzLlxuICAgICAgICAgIGlmIChyZXNwb25zZVR5cGUgIT09ICdqc29uJykge1xuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgeGhyLnNlbmQoaXNVbmRlZmluZWQocG9zdCkgPyBudWxsIDogcG9zdCk7XG4gICAgfVxuXG4gICAgaWYgKHRpbWVvdXQgPiAwKSB7XG4gICAgICB2YXIgdGltZW91dElkID0gJGJyb3dzZXJEZWZlcih0aW1lb3V0UmVxdWVzdCwgdGltZW91dCk7XG4gICAgfSBlbHNlIGlmIChpc1Byb21pc2VMaWtlKHRpbWVvdXQpKSB7XG4gICAgICB0aW1lb3V0LnRoZW4odGltZW91dFJlcXVlc3QpO1xuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gdGltZW91dFJlcXVlc3QoKSB7XG4gICAgICBqc29ucERvbmUgJiYganNvbnBEb25lKCk7XG4gICAgICB4aHIgJiYgeGhyLmFib3J0KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcGxldGVSZXF1ZXN0KGNhbGxiYWNrLCBzdGF0dXMsIHJlc3BvbnNlLCBoZWFkZXJzU3RyaW5nLCBzdGF0dXNUZXh0KSB7XG4gICAgICAvLyBjYW5jZWwgdGltZW91dCBhbmQgc3Vic2VxdWVudCB0aW1lb3V0IHByb21pc2UgcmVzb2x1dGlvblxuICAgICAgaWYgKGlzRGVmaW5lZCh0aW1lb3V0SWQpKSB7XG4gICAgICAgICRicm93c2VyRGVmZXIuY2FuY2VsKHRpbWVvdXRJZCk7XG4gICAgICB9XG4gICAgICBqc29ucERvbmUgPSB4aHIgPSBudWxsO1xuXG4gICAgICBjYWxsYmFjayhzdGF0dXMsIHJlc3BvbnNlLCBoZWFkZXJzU3RyaW5nLCBzdGF0dXNUZXh0KTtcbiAgICAgICRicm93c2VyLiQkY29tcGxldGVPdXRzdGFuZGluZ1JlcXVlc3Qobm9vcCk7XG4gICAgfVxuICB9O1xuXG4gIGZ1bmN0aW9uIGpzb25wUmVxKHVybCwgY2FsbGJhY2tJZCwgZG9uZSkge1xuICAgIC8vIHdlIGNhbid0IHVzZSBqUXVlcnkvanFMaXRlIGhlcmUgYmVjYXVzZSBqUXVlcnkgZG9lcyBjcmF6eSBzdHVmZiB3aXRoIHNjcmlwdCBlbGVtZW50cywgZS5nLjpcbiAgICAvLyAtIGZldGNoZXMgbG9jYWwgc2NyaXB0cyB2aWEgWEhSIGFuZCBldmFscyB0aGVtXG4gICAgLy8gLSBhZGRzIGFuZCBpbW1lZGlhdGVseSByZW1vdmVzIHNjcmlwdCBlbGVtZW50cyBmcm9tIHRoZSBkb2N1bWVudFxuICAgIHZhciBzY3JpcHQgPSByYXdEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKSwgY2FsbGJhY2sgPSBudWxsO1xuICAgIHNjcmlwdC50eXBlID0gXCJ0ZXh0L2phdmFzY3JpcHRcIjtcbiAgICBzY3JpcHQuc3JjID0gdXJsO1xuICAgIHNjcmlwdC5hc3luYyA9IHRydWU7XG5cbiAgICBjYWxsYmFjayA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyRm4oc2NyaXB0LCBcImxvYWRcIiwgY2FsbGJhY2spO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lckZuKHNjcmlwdCwgXCJlcnJvclwiLCBjYWxsYmFjayk7XG4gICAgICByYXdEb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHNjcmlwdCk7XG4gICAgICBzY3JpcHQgPSBudWxsO1xuICAgICAgdmFyIHN0YXR1cyA9IC0xO1xuICAgICAgdmFyIHRleHQgPSBcInVua25vd25cIjtcblxuICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC50eXBlID09PSBcImxvYWRcIiAmJiAhY2FsbGJhY2tzW2NhbGxiYWNrSWRdLmNhbGxlZCkge1xuICAgICAgICAgIGV2ZW50ID0geyB0eXBlOiBcImVycm9yXCIgfTtcbiAgICAgICAgfVxuICAgICAgICB0ZXh0ID0gZXZlbnQudHlwZTtcbiAgICAgICAgc3RhdHVzID0gZXZlbnQudHlwZSA9PT0gXCJlcnJvclwiID8gNDA0IDogMjAwO1xuICAgICAgfVxuXG4gICAgICBpZiAoZG9uZSkge1xuICAgICAgICBkb25lKHN0YXR1cywgdGV4dCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGFkZEV2ZW50TGlzdGVuZXJGbihzY3JpcHQsIFwibG9hZFwiLCBjYWxsYmFjayk7XG4gICAgYWRkRXZlbnRMaXN0ZW5lckZuKHNjcmlwdCwgXCJlcnJvclwiLCBjYWxsYmFjayk7XG4gICAgcmF3RG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgIHJldHVybiBjYWxsYmFjaztcbiAgfVxufVxuXG52YXIgJGludGVycG9sYXRlTWluRXJyID0gYW5ndWxhci4kaW50ZXJwb2xhdGVNaW5FcnIgPSBtaW5FcnIoJyRpbnRlcnBvbGF0ZScpO1xuJGludGVycG9sYXRlTWluRXJyLnRocm93Tm9jb25jYXQgPSBmdW5jdGlvbih0ZXh0KSB7XG4gIHRocm93ICRpbnRlcnBvbGF0ZU1pbkVycignbm9jb25jYXQnLFxuICAgICAgXCJFcnJvciB3aGlsZSBpbnRlcnBvbGF0aW5nOiB7MH1cXG5TdHJpY3QgQ29udGV4dHVhbCBFc2NhcGluZyBkaXNhbGxvd3MgXCIgK1xuICAgICAgXCJpbnRlcnBvbGF0aW9ucyB0aGF0IGNvbmNhdGVuYXRlIG11bHRpcGxlIGV4cHJlc3Npb25zIHdoZW4gYSB0cnVzdGVkIHZhbHVlIGlzIFwiICtcbiAgICAgIFwicmVxdWlyZWQuICBTZWUgaHR0cDovL2RvY3MuYW5ndWxhcmpzLm9yZy9hcGkvbmcuJHNjZVwiLCB0ZXh0KTtcbn07XG5cbiRpbnRlcnBvbGF0ZU1pbkVyci5pbnRlcnIgPSBmdW5jdGlvbih0ZXh0LCBlcnIpIHtcbiAgcmV0dXJuICRpbnRlcnBvbGF0ZU1pbkVycignaW50ZXJyJywgXCJDYW4ndCBpbnRlcnBvbGF0ZTogezB9XFxuezF9XCIsIHRleHQsIGVyci50b1N0cmluZygpKTtcbn07XG5cbi8qKlxuICogQG5nZG9jIHByb3ZpZGVyXG4gKiBAbmFtZSAkaW50ZXJwb2xhdGVQcm92aWRlclxuICpcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIFVzZWQgZm9yIGNvbmZpZ3VyaW5nIHRoZSBpbnRlcnBvbGF0aW9uIG1hcmt1cC4gRGVmYXVsdHMgdG8gYHt7YCBhbmQgYH19YC5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtZGFuZ2VyXCI+XG4gKiBUaGlzIGZlYXR1cmUgaXMgc29tZXRpbWVzIHVzZWQgdG8gbWl4IGRpZmZlcmVudCBtYXJrdXAgbGFuZ3VhZ2VzLCBlLmcuIHRvIHdyYXAgYW4gQW5ndWxhclxuICogdGVtcGxhdGUgd2l0aGluIGEgUHl0aG9uIEppbmphIHRlbXBsYXRlIChvciBhbnkgb3RoZXIgdGVtcGxhdGUgbGFuZ3VhZ2UpLiBNaXhpbmcgdGVtcGxhdGluZ1xuICogbGFuZ3VhZ2VzIGlzICoqdmVyeSBkYW5nZXJvdXMqKi4gVGhlIGVtYmVkZGluZyB0ZW1wbGF0ZSBsYW5ndWFnZSB3aWxsIG5vdCBzYWZlbHkgZXNjYXBlIEFuZ3VsYXJcbiAqIGV4cHJlc3Npb25zLCBzbyBhbnkgdXNlci1jb250cm9sbGVkIHZhbHVlcyBpbiB0aGUgdGVtcGxhdGUgd2lsbCBjYXVzZSBDcm9zcyBTaXRlIFNjcmlwdGluZyAoWFNTKVxuICogc2VjdXJpdHkgYnVncyFcbiAqIDwvZGl2PlxuICpcbiAqIEBleGFtcGxlXG48ZXhhbXBsZSBuYW1lPVwiY3VzdG9tLWludGVycG9sYXRpb24tbWFya3VwXCIgbW9kdWxlPVwiY3VzdG9tSW50ZXJwb2xhdGlvbkFwcFwiPlxuPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbjxzY3JpcHQ+XG4gIHZhciBjdXN0b21JbnRlcnBvbGF0aW9uQXBwID0gYW5ndWxhci5tb2R1bGUoJ2N1c3RvbUludGVycG9sYXRpb25BcHAnLCBbXSk7XG5cbiAgY3VzdG9tSW50ZXJwb2xhdGlvbkFwcC5jb25maWcoZnVuY3Rpb24oJGludGVycG9sYXRlUHJvdmlkZXIpIHtcbiAgICAkaW50ZXJwb2xhdGVQcm92aWRlci5zdGFydFN5bWJvbCgnLy8nKTtcbiAgICAkaW50ZXJwb2xhdGVQcm92aWRlci5lbmRTeW1ib2woJy8vJyk7XG4gIH0pO1xuXG5cbiAgY3VzdG9tSW50ZXJwb2xhdGlvbkFwcC5jb250cm9sbGVyKCdEZW1vQ29udHJvbGxlcicsIGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5sYWJlbCA9IFwiVGhpcyBiaW5kaW5nIGlzIGJyb3VnaHQgeW91IGJ5IC8vIGludGVycG9sYXRpb24gc3ltYm9scy5cIjtcbiAgfSk7XG48L3NjcmlwdD5cbjxkaXYgbmctY29udHJvbGxlcj1cIkRlbW9Db250cm9sbGVyIGFzIGRlbW9cIj5cbiAgICAvL2RlbW8ubGFiZWwvL1xuPC9kaXY+XG48L2ZpbGU+XG48ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gIGl0KCdzaG91bGQgaW50ZXJwb2xhdGUgYmluZGluZyB3aXRoIGN1c3RvbSBzeW1ib2xzJywgZnVuY3Rpb24oKSB7XG4gICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygnZGVtby5sYWJlbCcpKS5nZXRUZXh0KCkpLnRvQmUoJ1RoaXMgYmluZGluZyBpcyBicm91Z2h0IHlvdSBieSAvLyBpbnRlcnBvbGF0aW9uIHN5bWJvbHMuJyk7XG4gIH0pO1xuPC9maWxlPlxuPC9leGFtcGxlPlxuICovXG5mdW5jdGlvbiAkSW50ZXJwb2xhdGVQcm92aWRlcigpIHtcbiAgdmFyIHN0YXJ0U3ltYm9sID0gJ3t7JztcbiAgdmFyIGVuZFN5bWJvbCA9ICd9fSc7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGludGVycG9sYXRlUHJvdmlkZXIjc3RhcnRTeW1ib2xcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFN5bWJvbCB0byBkZW5vdGUgc3RhcnQgb2YgZXhwcmVzc2lvbiBpbiB0aGUgaW50ZXJwb2xhdGVkIHN0cmluZy4gRGVmYXVsdHMgdG8gYHt7YC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmc9fSB2YWx1ZSBuZXcgdmFsdWUgdG8gc2V0IHRoZSBzdGFydGluZyBzeW1ib2wgdG8uXG4gICAqIEByZXR1cm5zIHtzdHJpbmd8c2VsZn0gUmV0dXJucyB0aGUgc3ltYm9sIHdoZW4gdXNlZCBhcyBnZXR0ZXIgYW5kIHNlbGYgaWYgdXNlZCBhcyBzZXR0ZXIuXG4gICAqL1xuICB0aGlzLnN0YXJ0U3ltYm9sID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIHN0YXJ0U3ltYm9sID0gdmFsdWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHN0YXJ0U3ltYm9sO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkaW50ZXJwb2xhdGVQcm92aWRlciNlbmRTeW1ib2xcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFN5bWJvbCB0byBkZW5vdGUgdGhlIGVuZCBvZiBleHByZXNzaW9uIGluIHRoZSBpbnRlcnBvbGF0ZWQgc3RyaW5nLiBEZWZhdWx0cyB0byBgfX1gLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZz19IHZhbHVlIG5ldyB2YWx1ZSB0byBzZXQgdGhlIGVuZGluZyBzeW1ib2wgdG8uXG4gICAqIEByZXR1cm5zIHtzdHJpbmd8c2VsZn0gUmV0dXJucyB0aGUgc3ltYm9sIHdoZW4gdXNlZCBhcyBnZXR0ZXIgYW5kIHNlbGYgaWYgdXNlZCBhcyBzZXR0ZXIuXG4gICAqL1xuICB0aGlzLmVuZFN5bWJvbCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBlbmRTeW1ib2wgPSB2YWx1ZTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZW5kU3ltYm9sO1xuICAgIH1cbiAgfTtcblxuXG4gIHRoaXMuJGdldCA9IFsnJHBhcnNlJywgJyRleGNlcHRpb25IYW5kbGVyJywgJyRzY2UnLCBmdW5jdGlvbigkcGFyc2UsICRleGNlcHRpb25IYW5kbGVyLCAkc2NlKSB7XG4gICAgdmFyIHN0YXJ0U3ltYm9sTGVuZ3RoID0gc3RhcnRTeW1ib2wubGVuZ3RoLFxuICAgICAgICBlbmRTeW1ib2xMZW5ndGggPSBlbmRTeW1ib2wubGVuZ3RoLFxuICAgICAgICBlc2NhcGVkU3RhcnRSZWdleHAgPSBuZXcgUmVnRXhwKHN0YXJ0U3ltYm9sLnJlcGxhY2UoLy4vZywgZXNjYXBlKSwgJ2cnKSxcbiAgICAgICAgZXNjYXBlZEVuZFJlZ2V4cCA9IG5ldyBSZWdFeHAoZW5kU3ltYm9sLnJlcGxhY2UoLy4vZywgZXNjYXBlKSwgJ2cnKTtcblxuICAgIGZ1bmN0aW9uIGVzY2FwZShjaCkge1xuICAgICAgcmV0dXJuICdcXFxcXFxcXFxcXFwnICsgY2g7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdW5lc2NhcGVUZXh0KHRleHQpIHtcbiAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoZXNjYXBlZFN0YXJ0UmVnZXhwLCBzdGFydFN5bWJvbCkuXG4gICAgICAgIHJlcGxhY2UoZXNjYXBlZEVuZFJlZ2V4cCwgZW5kU3ltYm9sKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdHJpbmdpZnkodmFsdWUpIHtcbiAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7IC8vIG51bGwgfHwgdW5kZWZpbmVkXG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cbiAgICAgIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7XG4gICAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ251bWJlcic6XG4gICAgICAgICAgdmFsdWUgPSAnJyArIHZhbHVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHZhbHVlID0gdG9Kc29uKHZhbHVlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIC8vVE9ETzogdGhpcyBpcyB0aGUgc2FtZSBhcyB0aGUgY29uc3RhbnRXYXRjaERlbGVnYXRlIGluIHBhcnNlLmpzXG4gICAgZnVuY3Rpb24gY29uc3RhbnRXYXRjaERlbGVnYXRlKHNjb3BlLCBsaXN0ZW5lciwgb2JqZWN0RXF1YWxpdHksIGNvbnN0YW50SW50ZXJwKSB7XG4gICAgICB2YXIgdW53YXRjaDtcbiAgICAgIHJldHVybiB1bndhdGNoID0gc2NvcGUuJHdhdGNoKGZ1bmN0aW9uIGNvbnN0YW50SW50ZXJwb2xhdGVXYXRjaChzY29wZSkge1xuICAgICAgICB1bndhdGNoKCk7XG4gICAgICAgIHJldHVybiBjb25zdGFudEludGVycChzY29wZSk7XG4gICAgICB9LCBsaXN0ZW5lciwgb2JqZWN0RXF1YWxpdHkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBzZXJ2aWNlXG4gICAgICogQG5hbWUgJGludGVycG9sYXRlXG4gICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgKlxuICAgICAqIEByZXF1aXJlcyAkcGFyc2VcbiAgICAgKiBAcmVxdWlyZXMgJHNjZVxuICAgICAqXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICpcbiAgICAgKiBDb21waWxlcyBhIHN0cmluZyB3aXRoIG1hcmt1cCBpbnRvIGFuIGludGVycG9sYXRpb24gZnVuY3Rpb24uIFRoaXMgc2VydmljZSBpcyB1c2VkIGJ5IHRoZVxuICAgICAqIEhUTUwge0BsaW5rIG5nLiRjb21waWxlICRjb21waWxlfSBzZXJ2aWNlIGZvciBkYXRhIGJpbmRpbmcuIFNlZVxuICAgICAqIHtAbGluayBuZy4kaW50ZXJwb2xhdGVQcm92aWRlciAkaW50ZXJwb2xhdGVQcm92aWRlcn0gZm9yIGNvbmZpZ3VyaW5nIHRoZVxuICAgICAqIGludGVycG9sYXRpb24gbWFya3VwLlxuICAgICAqXG4gICAgICpcbiAgICAgKiBgYGBqc1xuICAgICAqICAgdmFyICRpbnRlcnBvbGF0ZSA9IC4uLjsgLy8gaW5qZWN0ZWRcbiAgICAgKiAgIHZhciBleHAgPSAkaW50ZXJwb2xhdGUoJ0hlbGxvIHt7bmFtZSB8IHVwcGVyY2FzZX19IScpO1xuICAgICAqICAgZXhwZWN0KGV4cCh7bmFtZTonQW5ndWxhcid9KSkudG9FcXVhbCgnSGVsbG8gQU5HVUxBUiEnKTtcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIGAkaW50ZXJwb2xhdGVgIHRha2VzIGFuIG9wdGlvbmFsIGZvdXJ0aCBhcmd1bWVudCwgYGFsbE9yTm90aGluZ2AuIElmIGBhbGxPck5vdGhpbmdgIGlzXG4gICAgICogYHRydWVgLCB0aGUgaW50ZXJwb2xhdGlvbiBmdW5jdGlvbiB3aWxsIHJldHVybiBgdW5kZWZpbmVkYCB1bmxlc3MgYWxsIGVtYmVkZGVkIGV4cHJlc3Npb25zXG4gICAgICogZXZhbHVhdGUgdG8gYSB2YWx1ZSBvdGhlciB0aGFuIGB1bmRlZmluZWRgLlxuICAgICAqXG4gICAgICogYGBganNcbiAgICAgKiAgIHZhciAkaW50ZXJwb2xhdGUgPSAuLi47IC8vIGluamVjdGVkXG4gICAgICogICB2YXIgY29udGV4dCA9IHtncmVldGluZzogJ0hlbGxvJywgbmFtZTogdW5kZWZpbmVkIH07XG4gICAgICpcbiAgICAgKiAgIC8vIGRlZmF1bHQgXCJmb3JnaXZpbmdcIiBtb2RlXG4gICAgICogICB2YXIgZXhwID0gJGludGVycG9sYXRlKCd7e2dyZWV0aW5nfX0ge3tuYW1lfX0hJyk7XG4gICAgICogICBleHBlY3QoZXhwKGNvbnRleHQpKS50b0VxdWFsKCdIZWxsbyAhJyk7XG4gICAgICpcbiAgICAgKiAgIC8vIFwiYWxsT3JOb3RoaW5nXCIgbW9kZVxuICAgICAqICAgZXhwID0gJGludGVycG9sYXRlKCd7e2dyZWV0aW5nfX0ge3tuYW1lfX0hJywgZmFsc2UsIG51bGwsIHRydWUpO1xuICAgICAqICAgZXhwZWN0KGV4cChjb250ZXh0KSkudG9CZVVuZGVmaW5lZCgpO1xuICAgICAqICAgY29udGV4dC5uYW1lID0gJ0FuZ3VsYXInO1xuICAgICAqICAgZXhwZWN0KGV4cChjb250ZXh0KSkudG9FcXVhbCgnSGVsbG8gQW5ndWxhciEnKTtcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIGBhbGxPck5vdGhpbmdgIGlzIHVzZWZ1bCBmb3IgaW50ZXJwb2xhdGluZyBVUkxzLiBgbmdTcmNgIGFuZCBgbmdTcmNzZXRgIHVzZSB0aGlzIGJlaGF2aW9yLlxuICAgICAqXG4gICAgICogIyMjI0VzY2FwZWQgSW50ZXJwb2xhdGlvblxuICAgICAqICRpbnRlcnBvbGF0ZSBwcm92aWRlcyBhIG1lY2hhbmlzbSBmb3IgZXNjYXBpbmcgaW50ZXJwb2xhdGlvbiBtYXJrZXJzLiBTdGFydCBhbmQgZW5kIG1hcmtlcnNcbiAgICAgKiBjYW4gYmUgZXNjYXBlZCBieSBwcmVjZWRpbmcgZWFjaCBvZiB0aGVpciBjaGFyYWN0ZXJzIHdpdGggYSBSRVZFUlNFIFNPTElEVVMgVSswMDVDIChiYWNrc2xhc2gpLlxuICAgICAqIEl0IHdpbGwgYmUgcmVuZGVyZWQgYXMgYSByZWd1bGFyIHN0YXJ0L2VuZCBtYXJrZXIsIGFuZCB3aWxsIG5vdCBiZSBpbnRlcnByZXRlZCBhcyBhbiBleHByZXNzaW9uXG4gICAgICogb3IgYmluZGluZy5cbiAgICAgKlxuICAgICAqIFRoaXMgZW5hYmxlcyB3ZWItc2VydmVycyB0byBwcmV2ZW50IHNjcmlwdCBpbmplY3Rpb24gYXR0YWNrcyBhbmQgZGVmYWNpbmcgYXR0YWNrcywgdG8gc29tZVxuICAgICAqIGRlZ3JlZSwgd2hpbGUgYWxzbyBlbmFibGluZyBjb2RlIGV4YW1wbGVzIHRvIHdvcmsgd2l0aG91dCByZWx5aW5nIG9uIHRoZVxuICAgICAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdOb25CaW5kYWJsZSBuZ05vbkJpbmRhYmxlfSBkaXJlY3RpdmUuXG4gICAgICpcbiAgICAgKiAqKkZvciBzZWN1cml0eSBwdXJwb3NlcywgaXQgaXMgc3Ryb25nbHkgZW5jb3VyYWdlZCB0aGF0IHdlYiBzZXJ2ZXJzIGVzY2FwZSB1c2VyLXN1cHBsaWVkIGRhdGEsXG4gICAgICogcmVwbGFjaW5nIGFuZ2xlIGJyYWNrZXRzICgmbHQ7LCAmZ3Q7KSB3aXRoICZhbXA7bHQ7IGFuZCAmYW1wO2d0OyByZXNwZWN0aXZlbHksIGFuZCByZXBsYWNpbmcgYWxsXG4gICAgICogaW50ZXJwb2xhdGlvbiBzdGFydC9lbmQgbWFya2VycyB3aXRoIHRoZWlyIGVzY2FwZWQgY291bnRlcnBhcnRzLioqXG4gICAgICpcbiAgICAgKiBFc2NhcGVkIGludGVycG9sYXRpb24gbWFya2VycyBhcmUgb25seSByZXBsYWNlZCB3aXRoIHRoZSBhY3R1YWwgaW50ZXJwb2xhdGlvbiBtYXJrZXJzIGluIHJlbmRlcmVkXG4gICAgICogb3V0cHV0IHdoZW4gdGhlICRpbnRlcnBvbGF0ZSBzZXJ2aWNlIHByb2Nlc3NlcyB0aGUgdGV4dC4gU28sIGZvciBIVE1MIGVsZW1lbnRzIGludGVycG9sYXRlZFxuICAgICAqIGJ5IHtAbGluayBuZy4kY29tcGlsZSAkY29tcGlsZX0sIG9yIG90aGVyd2lzZSBpbnRlcnBvbGF0ZWQgd2l0aCB0aGUgYG11c3RIYXZlRXhwcmVzc2lvbmAgcGFyYW1ldGVyXG4gICAgICogc2V0IHRvIGB0cnVlYCwgdGhlIGludGVycG9sYXRlZCB0ZXh0IG11c3QgY29udGFpbiBhbiB1bmVzY2FwZWQgaW50ZXJwb2xhdGlvbiBleHByZXNzaW9uLiBBcyBzdWNoLFxuICAgICAqIHRoaXMgaXMgdHlwaWNhbGx5IHVzZWZ1bCBvbmx5IHdoZW4gdXNlci1kYXRhIGlzIHVzZWQgaW4gcmVuZGVyaW5nIGEgdGVtcGxhdGUgZnJvbSB0aGUgc2VydmVyLCBvclxuICAgICAqIHdoZW4gb3RoZXJ3aXNlIHVudHJ1c3RlZCBkYXRhIGlzIHVzZWQgYnkgYSBkaXJlY3RpdmUuXG4gICAgICpcbiAgICAgKiA8ZXhhbXBsZT5cbiAgICAgKiAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgKiAgICA8ZGl2IG5nLWluaXQ9XCJ1c2VybmFtZT0nQSB1c2VyJ1wiPlxuICAgICAqICAgICAgPHAgbmctaW5pdD1cImFwcHRpdGxlPSdFc2NhcGluZyBkZW1vJ1wiPnt7YXBwdGl0bGV9fTogXFx7XFx7IHVzZXJuYW1lID0gXCJkZWZhY2VkIHZhbHVlXCI7IFxcfVxcfVxuICAgICAqICAgICAgICA8L3A+XG4gICAgICogICAgICA8cD48c3Ryb25nPnt7dXNlcm5hbWV9fTwvc3Ryb25nPiBhdHRlbXB0cyB0byBpbmplY3QgY29kZSB3aGljaCB3aWxsIGRlZmFjZSB0aGVcbiAgICAgKiAgICAgICAgYXBwbGljYXRpb24sIGJ1dCBmYWlscyB0byBhY2NvbXBsaXNoIHRoZWlyIHRhc2ssIGJlY2F1c2UgdGhlIHNlcnZlciBoYXMgY29ycmVjdGx5XG4gICAgICogICAgICAgIGVzY2FwZWQgdGhlIGludGVycG9sYXRpb24gc3RhcnQvZW5kIG1hcmtlcnMgd2l0aCBSRVZFUlNFIFNPTElEVVMgVSswMDVDIChiYWNrc2xhc2gpXG4gICAgICogICAgICAgIGNoYXJhY3RlcnMuPC9wPlxuICAgICAqICAgICAgPHA+SW5zdGVhZCwgdGhlIHJlc3VsdCBvZiB0aGUgYXR0ZW1wdGVkIHNjcmlwdCBpbmplY3Rpb24gaXMgdmlzaWJsZSwgYW5kIGNhbiBiZSByZW1vdmVkXG4gICAgICogICAgICAgIGZyb20gdGhlIGRhdGFiYXNlIGJ5IGFuIGFkbWluaXN0cmF0b3IuPC9wPlxuICAgICAqICAgIDwvZGl2PlxuICAgICAqICA8L2ZpbGU+XG4gICAgICogPC9leGFtcGxlPlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgVGhlIHRleHQgd2l0aCBtYXJrdXAgdG8gaW50ZXJwb2xhdGUuXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gbXVzdEhhdmVFeHByZXNzaW9uIGlmIHNldCB0byB0cnVlIHRoZW4gdGhlIGludGVycG9sYXRpb24gc3RyaW5nIG11c3QgaGF2ZVxuICAgICAqICAgIGVtYmVkZGVkIGV4cHJlc3Npb24gaW4gb3JkZXIgdG8gcmV0dXJuIGFuIGludGVycG9sYXRpb24gZnVuY3Rpb24uIFN0cmluZ3Mgd2l0aCBub1xuICAgICAqICAgIGVtYmVkZGVkIGV4cHJlc3Npb24gd2lsbCByZXR1cm4gbnVsbCBmb3IgdGhlIGludGVycG9sYXRpb24gZnVuY3Rpb24uXG4gICAgICogQHBhcmFtIHtzdHJpbmc9fSB0cnVzdGVkQ29udGV4dCB3aGVuIHByb3ZpZGVkLCB0aGUgcmV0dXJuZWQgZnVuY3Rpb24gcGFzc2VzIHRoZSBpbnRlcnBvbGF0ZWRcbiAgICAgKiAgICByZXN1bHQgdGhyb3VnaCB7QGxpbmsgbmcuJHNjZSNnZXRUcnVzdGVkICRzY2UuZ2V0VHJ1c3RlZChpbnRlcnBvbGF0ZWRSZXN1bHQsXG4gICAgICogICAgdHJ1c3RlZENvbnRleHQpfSBiZWZvcmUgcmV0dXJuaW5nIGl0LiAgUmVmZXIgdG8gdGhlIHtAbGluayBuZy4kc2NlICRzY2V9IHNlcnZpY2UgdGhhdFxuICAgICAqICAgIHByb3ZpZGVzIFN0cmljdCBDb250ZXh0dWFsIEVzY2FwaW5nIGZvciBkZXRhaWxzLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IGFsbE9yTm90aGluZyBpZiBgdHJ1ZWAsIHRoZW4gdGhlIHJldHVybmVkIGZ1bmN0aW9uIHJldHVybnMgdW5kZWZpbmVkXG4gICAgICogICAgdW5sZXNzIGFsbCBlbWJlZGRlZCBleHByZXNzaW9ucyBldmFsdWF0ZSB0byBhIHZhbHVlIG90aGVyIHRoYW4gYHVuZGVmaW5lZGAuXG4gICAgICogQHJldHVybnMge2Z1bmN0aW9uKGNvbnRleHQpfSBhbiBpbnRlcnBvbGF0aW9uIGZ1bmN0aW9uIHdoaWNoIGlzIHVzZWQgdG8gY29tcHV0ZSB0aGVcbiAgICAgKiAgICBpbnRlcnBvbGF0ZWQgc3RyaW5nLiBUaGUgZnVuY3Rpb24gaGFzIHRoZXNlIHBhcmFtZXRlcnM6XG4gICAgICpcbiAgICAgKiAtIGBjb250ZXh0YDogZXZhbHVhdGlvbiBjb250ZXh0IGZvciBhbGwgZXhwcmVzc2lvbnMgZW1iZWRkZWQgaW4gdGhlIGludGVycG9sYXRlZCB0ZXh0XG4gICAgICovXG4gICAgZnVuY3Rpb24gJGludGVycG9sYXRlKHRleHQsIG11c3RIYXZlRXhwcmVzc2lvbiwgdHJ1c3RlZENvbnRleHQsIGFsbE9yTm90aGluZykge1xuICAgICAgLy8gUHJvdmlkZSBhIHF1aWNrIGV4aXQgYW5kIHNpbXBsaWZpZWQgcmVzdWx0IGZ1bmN0aW9uIGZvciB0ZXh0IHdpdGggbm8gaW50ZXJwb2xhdGlvblxuICAgICAgaWYgKCF0ZXh0Lmxlbmd0aCB8fCB0ZXh0LmluZGV4T2Yoc3RhcnRTeW1ib2wpID09PSAtMSkge1xuICAgICAgICB2YXIgY29uc3RhbnRJbnRlcnA7XG4gICAgICAgIGlmICghbXVzdEhhdmVFeHByZXNzaW9uKSB7XG4gICAgICAgICAgdmFyIHVuZXNjYXBlZFRleHQgPSB1bmVzY2FwZVRleHQodGV4dCk7XG4gICAgICAgICAgY29uc3RhbnRJbnRlcnAgPSB2YWx1ZUZuKHVuZXNjYXBlZFRleHQpO1xuICAgICAgICAgIGNvbnN0YW50SW50ZXJwLmV4cCA9IHRleHQ7XG4gICAgICAgICAgY29uc3RhbnRJbnRlcnAuZXhwcmVzc2lvbnMgPSBbXTtcbiAgICAgICAgICBjb25zdGFudEludGVycC4kJHdhdGNoRGVsZWdhdGUgPSBjb25zdGFudFdhdGNoRGVsZWdhdGU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnN0YW50SW50ZXJwO1xuICAgICAgfVxuXG4gICAgICBhbGxPck5vdGhpbmcgPSAhIWFsbE9yTm90aGluZztcbiAgICAgIHZhciBzdGFydEluZGV4LFxuICAgICAgICAgIGVuZEluZGV4LFxuICAgICAgICAgIGluZGV4ID0gMCxcbiAgICAgICAgICBleHByZXNzaW9ucyA9IFtdLFxuICAgICAgICAgIHBhcnNlRm5zID0gW10sXG4gICAgICAgICAgdGV4dExlbmd0aCA9IHRleHQubGVuZ3RoLFxuICAgICAgICAgIGV4cCxcbiAgICAgICAgICBjb25jYXQgPSBbXSxcbiAgICAgICAgICBleHByZXNzaW9uUG9zaXRpb25zID0gW107XG5cbiAgICAgIHdoaWxlIChpbmRleCA8IHRleHRMZW5ndGgpIHtcbiAgICAgICAgaWYgKCgoc3RhcnRJbmRleCA9IHRleHQuaW5kZXhPZihzdGFydFN5bWJvbCwgaW5kZXgpKSAhPSAtMSkgJiZcbiAgICAgICAgICAgICAoKGVuZEluZGV4ID0gdGV4dC5pbmRleE9mKGVuZFN5bWJvbCwgc3RhcnRJbmRleCArIHN0YXJ0U3ltYm9sTGVuZ3RoKSkgIT0gLTEpKSB7XG4gICAgICAgICAgaWYgKGluZGV4ICE9PSBzdGFydEluZGV4KSB7XG4gICAgICAgICAgICBjb25jYXQucHVzaCh1bmVzY2FwZVRleHQodGV4dC5zdWJzdHJpbmcoaW5kZXgsIHN0YXJ0SW5kZXgpKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGV4cCA9IHRleHQuc3Vic3RyaW5nKHN0YXJ0SW5kZXggKyBzdGFydFN5bWJvbExlbmd0aCwgZW5kSW5kZXgpO1xuICAgICAgICAgIGV4cHJlc3Npb25zLnB1c2goZXhwKTtcbiAgICAgICAgICBwYXJzZUZucy5wdXNoKCRwYXJzZShleHAsIHBhcnNlU3RyaW5naWZ5SW50ZXJjZXB0b3IpKTtcbiAgICAgICAgICBpbmRleCA9IGVuZEluZGV4ICsgZW5kU3ltYm9sTGVuZ3RoO1xuICAgICAgICAgIGV4cHJlc3Npb25Qb3NpdGlvbnMucHVzaChjb25jYXQubGVuZ3RoKTtcbiAgICAgICAgICBjb25jYXQucHVzaCgnJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gd2UgZGlkIG5vdCBmaW5kIGFuIGludGVycG9sYXRpb24sIHNvIHdlIGhhdmUgdG8gYWRkIHRoZSByZW1haW5kZXIgdG8gdGhlIHNlcGFyYXRvcnMgYXJyYXlcbiAgICAgICAgICBpZiAoaW5kZXggIT09IHRleHRMZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbmNhdC5wdXNoKHVuZXNjYXBlVGV4dCh0ZXh0LnN1YnN0cmluZyhpbmRleCkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ29uY2F0ZW5hdGluZyBleHByZXNzaW9ucyBtYWtlcyBpdCBoYXJkIHRvIHJlYXNvbiBhYm91dCB3aGV0aGVyIHNvbWUgY29tYmluYXRpb24gb2ZcbiAgICAgIC8vIGNvbmNhdGVuYXRlZCB2YWx1ZXMgYXJlIHVuc2FmZSB0byB1c2UgYW5kIGNvdWxkIGVhc2lseSBsZWFkIHRvIFhTUy4gIEJ5IHJlcXVpcmluZyB0aGF0IGFcbiAgICAgIC8vIHNpbmdsZSBleHByZXNzaW9uIGJlIHVzZWQgZm9yIGlmcmFtZVtzcmNdLCBvYmplY3Rbc3JjXSwgZXRjLiwgd2UgZW5zdXJlIHRoYXQgdGhlIHZhbHVlXG4gICAgICAvLyB0aGF0J3MgdXNlZCBpcyBhc3NpZ25lZCBvciBjb25zdHJ1Y3RlZCBieSBzb21lIEpTIGNvZGUgc29tZXdoZXJlIHRoYXQgaXMgbW9yZSB0ZXN0YWJsZSBvclxuICAgICAgLy8gbWFrZSBpdCBvYnZpb3VzIHRoYXQgeW91IGJvdW5kIHRoZSB2YWx1ZSB0byBzb21lIHVzZXIgY29udHJvbGxlZCB2YWx1ZS4gIFRoaXMgaGVscHMgcmVkdWNlXG4gICAgICAvLyB0aGUgbG9hZCB3aGVuIGF1ZGl0aW5nIGZvciBYU1MgaXNzdWVzLlxuICAgICAgaWYgKHRydXN0ZWRDb250ZXh0ICYmIGNvbmNhdC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgJGludGVycG9sYXRlTWluRXJyLnRocm93Tm9jb25jYXQodGV4dCk7XG4gICAgICB9XG5cbiAgICAgIGlmICghbXVzdEhhdmVFeHByZXNzaW9uIHx8IGV4cHJlc3Npb25zLmxlbmd0aCkge1xuICAgICAgICB2YXIgY29tcHV0ZSA9IGZ1bmN0aW9uKHZhbHVlcykge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGV4cHJlc3Npb25zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChhbGxPck5vdGhpbmcgJiYgaXNVbmRlZmluZWQodmFsdWVzW2ldKSkgcmV0dXJuO1xuICAgICAgICAgICAgY29uY2F0W2V4cHJlc3Npb25Qb3NpdGlvbnNbaV1dID0gdmFsdWVzW2ldO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY29uY2F0LmpvaW4oJycpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRWYWx1ZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHRydXN0ZWRDb250ZXh0ID9cbiAgICAgICAgICAgICRzY2UuZ2V0VHJ1c3RlZCh0cnVzdGVkQ29udGV4dCwgdmFsdWUpIDpcbiAgICAgICAgICAgICRzY2UudmFsdWVPZih2YWx1ZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGV4dGVuZChmdW5jdGlvbiBpbnRlcnBvbGF0aW9uRm4oY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgdmFyIGlpID0gZXhwcmVzc2lvbnMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IG5ldyBBcnJheShpaSk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGZvciAoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhbHVlc1tpXSA9IHBhcnNlRm5zW2ldKGNvbnRleHQpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIGNvbXB1dGUodmFsdWVzKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAkZXhjZXB0aW9uSGFuZGxlcigkaW50ZXJwb2xhdGVNaW5FcnIuaW50ZXJyKHRleHQsIGVycikpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSwge1xuICAgICAgICAgIC8vIGFsbCBvZiB0aGVzZSBwcm9wZXJ0aWVzIGFyZSB1bmRvY3VtZW50ZWQgZm9yIG5vd1xuICAgICAgICAgIGV4cDogdGV4dCwgLy9qdXN0IGZvciBjb21wYXRpYmlsaXR5IHdpdGggcmVndWxhciB3YXRjaGVycyBjcmVhdGVkIHZpYSAkd2F0Y2hcbiAgICAgICAgICBleHByZXNzaW9uczogZXhwcmVzc2lvbnMsXG4gICAgICAgICAgJCR3YXRjaERlbGVnYXRlOiBmdW5jdGlvbihzY29wZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHZhciBsYXN0VmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gc2NvcGUuJHdhdGNoR3JvdXAocGFyc2VGbnMsIGZ1bmN0aW9uIGludGVycG9sYXRlRm5XYXRjaGVyKHZhbHVlcywgb2xkVmFsdWVzKSB7XG4gICAgICAgICAgICAgIHZhciBjdXJyVmFsdWUgPSBjb21wdXRlKHZhbHVlcyk7XG4gICAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGxpc3RlbmVyKSkge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyLmNhbGwodGhpcywgY3VyclZhbHVlLCB2YWx1ZXMgIT09IG9sZFZhbHVlcyA/IGxhc3RWYWx1ZSA6IGN1cnJWYWx1ZSwgc2NvcGUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGxhc3RWYWx1ZSA9IGN1cnJWYWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHBhcnNlU3RyaW5naWZ5SW50ZXJjZXB0b3IodmFsdWUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB2YWx1ZSA9IGdldFZhbHVlKHZhbHVlKTtcbiAgICAgICAgICByZXR1cm4gYWxsT3JOb3RoaW5nICYmICFpc0RlZmluZWQodmFsdWUpID8gdmFsdWUgOiBzdHJpbmdpZnkodmFsdWUpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAkZXhjZXB0aW9uSGFuZGxlcigkaW50ZXJwb2xhdGVNaW5FcnIuaW50ZXJyKHRleHQsIGVycikpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgJGludGVycG9sYXRlI3N0YXJ0U3ltYm9sXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICogU3ltYm9sIHRvIGRlbm90ZSB0aGUgc3RhcnQgb2YgZXhwcmVzc2lvbiBpbiB0aGUgaW50ZXJwb2xhdGVkIHN0cmluZy4gRGVmYXVsdHMgdG8gYHt7YC5cbiAgICAgKlxuICAgICAqIFVzZSB7QGxpbmsgbmcuJGludGVycG9sYXRlUHJvdmlkZXIjc3RhcnRTeW1ib2wgYCRpbnRlcnBvbGF0ZVByb3ZpZGVyLnN0YXJ0U3ltYm9sYH0gdG8gY2hhbmdlXG4gICAgICogdGhlIHN5bWJvbC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHN0YXJ0IHN5bWJvbC5cbiAgICAgKi9cbiAgICAkaW50ZXJwb2xhdGUuc3RhcnRTeW1ib2wgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzdGFydFN5bWJvbDtcbiAgICB9O1xuXG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgJGludGVycG9sYXRlI2VuZFN5bWJvbFxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIFN5bWJvbCB0byBkZW5vdGUgdGhlIGVuZCBvZiBleHByZXNzaW9uIGluIHRoZSBpbnRlcnBvbGF0ZWQgc3RyaW5nLiBEZWZhdWx0cyB0byBgfX1gLlxuICAgICAqXG4gICAgICogVXNlIHtAbGluayBuZy4kaW50ZXJwb2xhdGVQcm92aWRlciNlbmRTeW1ib2wgYCRpbnRlcnBvbGF0ZVByb3ZpZGVyLmVuZFN5bWJvbGB9IHRvIGNoYW5nZVxuICAgICAqIHRoZSBzeW1ib2wuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBlbmQgc3ltYm9sLlxuICAgICAqL1xuICAgICRpbnRlcnBvbGF0ZS5lbmRTeW1ib2wgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBlbmRTeW1ib2w7XG4gICAgfTtcblxuICAgIHJldHVybiAkaW50ZXJwb2xhdGU7XG4gIH1dO1xufVxuXG5mdW5jdGlvbiAkSW50ZXJ2YWxQcm92aWRlcigpIHtcbiAgdGhpcy4kZ2V0ID0gWyckcm9vdFNjb3BlJywgJyR3aW5kb3cnLCAnJHEnLCAnJCRxJywgJyRicm93c2VyJyxcbiAgICAgICBmdW5jdGlvbigkcm9vdFNjb3BlLCAgICR3aW5kb3csICAgJHEsICAgJCRxLCAgICRicm93c2VyKSB7XG4gICAgdmFyIGludGVydmFscyA9IHt9O1xuXG5cbiAgICAgLyoqXG4gICAgICAqIEBuZ2RvYyBzZXJ2aWNlXG4gICAgICAqIEBuYW1lICRpbnRlcnZhbFxuICAgICAgKlxuICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICogQW5ndWxhcidzIHdyYXBwZXIgZm9yIGB3aW5kb3cuc2V0SW50ZXJ2YWxgLiBUaGUgYGZuYCBmdW5jdGlvbiBpcyBleGVjdXRlZCBldmVyeSBgZGVsYXlgXG4gICAgICAqIG1pbGxpc2Vjb25kcy5cbiAgICAgICpcbiAgICAgICogVGhlIHJldHVybiB2YWx1ZSBvZiByZWdpc3RlcmluZyBhbiBpbnRlcnZhbCBmdW5jdGlvbiBpcyBhIHByb21pc2UuIFRoaXMgcHJvbWlzZSB3aWxsIGJlXG4gICAgICAqIG5vdGlmaWVkIHVwb24gZWFjaCB0aWNrIG9mIHRoZSBpbnRlcnZhbCwgYW5kIHdpbGwgYmUgcmVzb2x2ZWQgYWZ0ZXIgYGNvdW50YCBpdGVyYXRpb25zLCBvclxuICAgICAgKiBydW4gaW5kZWZpbml0ZWx5IGlmIGBjb3VudGAgaXMgbm90IGRlZmluZWQuIFRoZSB2YWx1ZSBvZiB0aGUgbm90aWZpY2F0aW9uIHdpbGwgYmUgdGhlXG4gICAgICAqIG51bWJlciBvZiBpdGVyYXRpb25zIHRoYXQgaGF2ZSBydW4uXG4gICAgICAqIFRvIGNhbmNlbCBhbiBpbnRlcnZhbCwgY2FsbCBgJGludGVydmFsLmNhbmNlbChwcm9taXNlKWAuXG4gICAgICAqXG4gICAgICAqIEluIHRlc3RzIHlvdSBjYW4gdXNlIHtAbGluayBuZ01vY2suJGludGVydmFsI2ZsdXNoIGAkaW50ZXJ2YWwuZmx1c2gobWlsbGlzKWB9IHRvXG4gICAgICAqIG1vdmUgZm9yd2FyZCBieSBgbWlsbGlzYCBtaWxsaXNlY29uZHMgYW5kIHRyaWdnZXIgYW55IGZ1bmN0aW9ucyBzY2hlZHVsZWQgdG8gcnVuIGluIHRoYXRcbiAgICAgICogdGltZS5cbiAgICAgICpcbiAgICAgICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cbiAgICAgICogKipOb3RlKio6IEludGVydmFscyBjcmVhdGVkIGJ5IHRoaXMgc2VydmljZSBtdXN0IGJlIGV4cGxpY2l0bHkgZGVzdHJveWVkIHdoZW4geW91IGFyZSBmaW5pc2hlZFxuICAgICAgKiB3aXRoIHRoZW0uICBJbiBwYXJ0aWN1bGFyIHRoZXkgYXJlIG5vdCBhdXRvbWF0aWNhbGx5IGRlc3Ryb3llZCB3aGVuIGEgY29udHJvbGxlcidzIHNjb3BlIG9yIGFcbiAgICAgICogZGlyZWN0aXZlJ3MgZWxlbWVudCBhcmUgZGVzdHJveWVkLlxuICAgICAgKiBZb3Ugc2hvdWxkIHRha2UgdGhpcyBpbnRvIGNvbnNpZGVyYXRpb24gYW5kIG1ha2Ugc3VyZSB0byBhbHdheXMgY2FuY2VsIHRoZSBpbnRlcnZhbCBhdCB0aGVcbiAgICAgICogYXBwcm9wcmlhdGUgbW9tZW50LiAgU2VlIHRoZSBleGFtcGxlIGJlbG93IGZvciBtb3JlIGRldGFpbHMgb24gaG93IGFuZCB3aGVuIHRvIGRvIHRoaXMuXG4gICAgICAqIDwvZGl2PlxuICAgICAgKlxuICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGZuIEEgZnVuY3Rpb24gdGhhdCBzaG91bGQgYmUgY2FsbGVkIHJlcGVhdGVkbHkuXG4gICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkZWxheSBOdW1iZXIgb2YgbWlsbGlzZWNvbmRzIGJldHdlZW4gZWFjaCBmdW5jdGlvbiBjYWxsLlxuICAgICAgKiBAcGFyYW0ge251bWJlcj19IFtjb3VudD0wXSBOdW1iZXIgb2YgdGltZXMgdG8gcmVwZWF0LiBJZiBub3Qgc2V0LCBvciAwLCB3aWxsIHJlcGVhdFxuICAgICAgKiAgIGluZGVmaW5pdGVseS5cbiAgICAgICogQHBhcmFtIHtib29sZWFuPX0gW2ludm9rZUFwcGx5PXRydWVdIElmIHNldCB0byBgZmFsc2VgIHNraXBzIG1vZGVsIGRpcnR5IGNoZWNraW5nLCBvdGhlcndpc2VcbiAgICAgICogICB3aWxsIGludm9rZSBgZm5gIHdpdGhpbiB0aGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGFwcGx5ICRhcHBseX0gYmxvY2suXG4gICAgICAqIEBwYXJhbSB7Li4uKj19IFBhc3MgYWRkaXRpb25hbCBwYXJhbWV0ZXJzIHRvIHRoZSBleGVjdXRlZCBmdW5jdGlvbi5cbiAgICAgICogQHJldHVybnMge3Byb21pc2V9IEEgcHJvbWlzZSB3aGljaCB3aWxsIGJlIG5vdGlmaWVkIG9uIGVhY2ggaXRlcmF0aW9uLlxuICAgICAgKlxuICAgICAgKiBAZXhhbXBsZVxuICAgICAgKiA8ZXhhbXBsZSBtb2R1bGU9XCJpbnRlcnZhbEV4YW1wbGVcIj5cbiAgICAgICogPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICogICA8c2NyaXB0PlxuICAgICAgKiAgICAgYW5ndWxhci5tb2R1bGUoJ2ludGVydmFsRXhhbXBsZScsIFtdKVxuICAgICAgKiAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsICckaW50ZXJ2YWwnLFxuICAgICAgKiAgICAgICAgIGZ1bmN0aW9uKCRzY29wZSwgJGludGVydmFsKSB7XG4gICAgICAqICAgICAgICAgICAkc2NvcGUuZm9ybWF0ID0gJ00vZC95eSBoOm1tOnNzIGEnO1xuICAgICAgKiAgICAgICAgICAgJHNjb3BlLmJsb29kXzEgPSAxMDA7XG4gICAgICAqICAgICAgICAgICAkc2NvcGUuYmxvb2RfMiA9IDEyMDtcbiAgICAgICpcbiAgICAgICogICAgICAgICAgIHZhciBzdG9wO1xuICAgICAgKiAgICAgICAgICAgJHNjb3BlLmZpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAqICAgICAgICAgICAgIC8vIERvbid0IHN0YXJ0IGEgbmV3IGZpZ2h0IGlmIHdlIGFyZSBhbHJlYWR5IGZpZ2h0aW5nXG4gICAgICAqICAgICAgICAgICAgIGlmICggYW5ndWxhci5pc0RlZmluZWQoc3RvcCkgKSByZXR1cm47XG4gICAgICAqXG4gICAgICAqICAgICAgICAgICAgIHN0b3AgPSAkaW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAqICAgICAgICAgICAgICAgaWYgKCRzY29wZS5ibG9vZF8xID4gMCAmJiAkc2NvcGUuYmxvb2RfMiA+IDApIHtcbiAgICAgICogICAgICAgICAgICAgICAgICRzY29wZS5ibG9vZF8xID0gJHNjb3BlLmJsb29kXzEgLSAzO1xuICAgICAgKiAgICAgICAgICAgICAgICAgJHNjb3BlLmJsb29kXzIgPSAkc2NvcGUuYmxvb2RfMiAtIDQ7XG4gICAgICAqICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICogICAgICAgICAgICAgICAgICRzY29wZS5zdG9wRmlnaHQoKTtcbiAgICAgICogICAgICAgICAgICAgICB9XG4gICAgICAqICAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAqICAgICAgICAgICB9O1xuICAgICAgKlxuICAgICAgKiAgICAgICAgICAgJHNjb3BlLnN0b3BGaWdodCA9IGZ1bmN0aW9uKCkge1xuICAgICAgKiAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoc3RvcCkpIHtcbiAgICAgICogICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHN0b3ApO1xuICAgICAgKiAgICAgICAgICAgICAgIHN0b3AgPSB1bmRlZmluZWQ7XG4gICAgICAqICAgICAgICAgICAgIH1cbiAgICAgICogICAgICAgICAgIH07XG4gICAgICAqXG4gICAgICAqICAgICAgICAgICAkc2NvcGUucmVzZXRGaWdodCA9IGZ1bmN0aW9uKCkge1xuICAgICAgKiAgICAgICAgICAgICAkc2NvcGUuYmxvb2RfMSA9IDEwMDtcbiAgICAgICogICAgICAgICAgICAgJHNjb3BlLmJsb29kXzIgPSAxMjA7XG4gICAgICAqICAgICAgICAgICB9O1xuICAgICAgKlxuICAgICAgKiAgICAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAgICogICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgdGhlIGludGVydmFsIGlzIGRlc3Ryb3llZCB0b29cbiAgICAgICogICAgICAgICAgICAgJHNjb3BlLnN0b3BGaWdodCgpO1xuICAgICAgKiAgICAgICAgICAgfSk7XG4gICAgICAqICAgICAgICAgfV0pXG4gICAgICAqICAgICAgIC8vIFJlZ2lzdGVyIHRoZSAnbXlDdXJyZW50VGltZScgZGlyZWN0aXZlIGZhY3RvcnkgbWV0aG9kLlxuICAgICAgKiAgICAgICAvLyBXZSBpbmplY3QgJGludGVydmFsIGFuZCBkYXRlRmlsdGVyIHNlcnZpY2Ugc2luY2UgdGhlIGZhY3RvcnkgbWV0aG9kIGlzIERJLlxuICAgICAgKiAgICAgICAuZGlyZWN0aXZlKCdteUN1cnJlbnRUaW1lJywgWyckaW50ZXJ2YWwnLCAnZGF0ZUZpbHRlcicsXG4gICAgICAqICAgICAgICAgZnVuY3Rpb24oJGludGVydmFsLCBkYXRlRmlsdGVyKSB7XG4gICAgICAqICAgICAgICAgICAvLyByZXR1cm4gdGhlIGRpcmVjdGl2ZSBsaW5rIGZ1bmN0aW9uLiAoY29tcGlsZSBmdW5jdGlvbiBub3QgbmVlZGVkKVxuICAgICAgKiAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgKiAgICAgICAgICAgICB2YXIgZm9ybWF0LCAgLy8gZGF0ZSBmb3JtYXRcbiAgICAgICogICAgICAgICAgICAgICAgIHN0b3BUaW1lOyAvLyBzbyB0aGF0IHdlIGNhbiBjYW5jZWwgdGhlIHRpbWUgdXBkYXRlc1xuICAgICAgKlxuICAgICAgKiAgICAgICAgICAgICAvLyB1c2VkIHRvIHVwZGF0ZSB0aGUgVUlcbiAgICAgICogICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlVGltZSgpIHtcbiAgICAgICogICAgICAgICAgICAgICBlbGVtZW50LnRleHQoZGF0ZUZpbHRlcihuZXcgRGF0ZSgpLCBmb3JtYXQpKTtcbiAgICAgICogICAgICAgICAgICAgfVxuICAgICAgKlxuICAgICAgKiAgICAgICAgICAgICAvLyB3YXRjaCB0aGUgZXhwcmVzc2lvbiwgYW5kIHVwZGF0ZSB0aGUgVUkgb24gY2hhbmdlLlxuICAgICAgKiAgICAgICAgICAgICBzY29wZS4kd2F0Y2goYXR0cnMubXlDdXJyZW50VGltZSwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICogICAgICAgICAgICAgICBmb3JtYXQgPSB2YWx1ZTtcbiAgICAgICogICAgICAgICAgICAgICB1cGRhdGVUaW1lKCk7XG4gICAgICAqICAgICAgICAgICAgIH0pO1xuICAgICAgKlxuICAgICAgKiAgICAgICAgICAgICBzdG9wVGltZSA9ICRpbnRlcnZhbCh1cGRhdGVUaW1lLCAxMDAwKTtcbiAgICAgICpcbiAgICAgICogICAgICAgICAgICAgLy8gbGlzdGVuIG9uIERPTSBkZXN0cm95IChyZW1vdmFsKSBldmVudCwgYW5kIGNhbmNlbCB0aGUgbmV4dCBVSSB1cGRhdGVcbiAgICAgICogICAgICAgICAgICAgLy8gdG8gcHJldmVudCB1cGRhdGluZyB0aW1lIGFmdGVyIHRoZSBET00gZWxlbWVudCB3YXMgcmVtb3ZlZC5cbiAgICAgICogICAgICAgICAgICAgZWxlbWVudC5vbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAgICogICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHN0b3BUaW1lKTtcbiAgICAgICogICAgICAgICAgICAgfSk7XG4gICAgICAqICAgICAgICAgICB9XG4gICAgICAqICAgICAgICAgfV0pO1xuICAgICAgKiAgIDwvc2NyaXB0PlxuICAgICAgKlxuICAgICAgKiAgIDxkaXY+XG4gICAgICAqICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICAgKiAgICAgICA8bGFiZWw+RGF0ZSBmb3JtYXQ6IDxpbnB1dCBuZy1tb2RlbD1cImZvcm1hdFwiPjwvbGFiZWw+IDxoci8+XG4gICAgICAqICAgICAgIEN1cnJlbnQgdGltZSBpczogPHNwYW4gbXktY3VycmVudC10aW1lPVwiZm9ybWF0XCI+PC9zcGFuPlxuICAgICAgKiAgICAgICA8aHIvPlxuICAgICAgKiAgICAgICBCbG9vZCAxIDogPGZvbnQgY29sb3I9J3JlZCc+e3tibG9vZF8xfX08L2ZvbnQ+XG4gICAgICAqICAgICAgIEJsb29kIDIgOiA8Zm9udCBjb2xvcj0ncmVkJz57e2Jsb29kXzJ9fTwvZm9udD5cbiAgICAgICogICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgZGF0YS1uZy1jbGljaz1cImZpZ2h0KClcIj5GaWdodDwvYnV0dG9uPlxuICAgICAgKiAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBkYXRhLW5nLWNsaWNrPVwic3RvcEZpZ2h0KClcIj5TdG9wRmlnaHQ8L2J1dHRvbj5cbiAgICAgICogICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgZGF0YS1uZy1jbGljaz1cInJlc2V0RmlnaHQoKVwiPnJlc2V0RmlnaHQ8L2J1dHRvbj5cbiAgICAgICogICAgIDwvZGl2PlxuICAgICAgKiAgIDwvZGl2PlxuICAgICAgKlxuICAgICAgKiA8L2ZpbGU+XG4gICAgICAqIDwvZXhhbXBsZT5cbiAgICAgICovXG4gICAgZnVuY3Rpb24gaW50ZXJ2YWwoZm4sIGRlbGF5LCBjb3VudCwgaW52b2tlQXBwbHkpIHtcbiAgICAgIHZhciBoYXNQYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gNCxcbiAgICAgICAgICBhcmdzID0gaGFzUGFyYW1zID8gc2xpY2VBcmdzKGFyZ3VtZW50cywgNCkgOiBbXSxcbiAgICAgICAgICBzZXRJbnRlcnZhbCA9ICR3aW5kb3cuc2V0SW50ZXJ2YWwsXG4gICAgICAgICAgY2xlYXJJbnRlcnZhbCA9ICR3aW5kb3cuY2xlYXJJbnRlcnZhbCxcbiAgICAgICAgICBpdGVyYXRpb24gPSAwLFxuICAgICAgICAgIHNraXBBcHBseSA9IChpc0RlZmluZWQoaW52b2tlQXBwbHkpICYmICFpbnZva2VBcHBseSksXG4gICAgICAgICAgZGVmZXJyZWQgPSAoc2tpcEFwcGx5ID8gJCRxIDogJHEpLmRlZmVyKCksXG4gICAgICAgICAgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG5cbiAgICAgIGNvdW50ID0gaXNEZWZpbmVkKGNvdW50KSA/IGNvdW50IDogMDtcblxuICAgICAgcHJvbWlzZS4kJGludGVydmFsSWQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiB0aWNrKCkge1xuICAgICAgICBpZiAoc2tpcEFwcGx5KSB7XG4gICAgICAgICAgJGJyb3dzZXIuZGVmZXIoY2FsbGJhY2spO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRyb290U2NvcGUuJGV2YWxBc3luYyhjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmZXJyZWQubm90aWZ5KGl0ZXJhdGlvbisrKTtcblxuICAgICAgICBpZiAoY291bnQgPiAwICYmIGl0ZXJhdGlvbiA+PSBjb3VudCkge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoaXRlcmF0aW9uKTtcbiAgICAgICAgICBjbGVhckludGVydmFsKHByb21pc2UuJCRpbnRlcnZhbElkKTtcbiAgICAgICAgICBkZWxldGUgaW50ZXJ2YWxzW3Byb21pc2UuJCRpbnRlcnZhbElkXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghc2tpcEFwcGx5KSAkcm9vdFNjb3BlLiRhcHBseSgpO1xuXG4gICAgICB9LCBkZWxheSk7XG5cbiAgICAgIGludGVydmFsc1twcm9taXNlLiQkaW50ZXJ2YWxJZF0gPSBkZWZlcnJlZDtcblxuICAgICAgcmV0dXJuIHByb21pc2U7XG5cbiAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKCkge1xuICAgICAgICBpZiAoIWhhc1BhcmFtcykge1xuICAgICAgICAgIGZuKGl0ZXJhdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm4uYXBwbHkobnVsbCwgYXJncyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cblxuICAgICAvKipcbiAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgKiBAbmFtZSAkaW50ZXJ2YWwjY2FuY2VsXG4gICAgICAqXG4gICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgKiBDYW5jZWxzIGEgdGFzayBhc3NvY2lhdGVkIHdpdGggdGhlIGBwcm9taXNlYC5cbiAgICAgICpcbiAgICAgICogQHBhcmFtIHtQcm9taXNlPX0gcHJvbWlzZSByZXR1cm5lZCBieSB0aGUgYCRpbnRlcnZhbGAgZnVuY3Rpb24uXG4gICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgdGFzayB3YXMgc3VjY2Vzc2Z1bGx5IGNhbmNlbGVkLlxuICAgICAgKi9cbiAgICBpbnRlcnZhbC5jYW5jZWwgPSBmdW5jdGlvbihwcm9taXNlKSB7XG4gICAgICBpZiAocHJvbWlzZSAmJiBwcm9taXNlLiQkaW50ZXJ2YWxJZCBpbiBpbnRlcnZhbHMpIHtcbiAgICAgICAgaW50ZXJ2YWxzW3Byb21pc2UuJCRpbnRlcnZhbElkXS5yZWplY3QoJ2NhbmNlbGVkJyk7XG4gICAgICAgICR3aW5kb3cuY2xlYXJJbnRlcnZhbChwcm9taXNlLiQkaW50ZXJ2YWxJZCk7XG4gICAgICAgIGRlbGV0ZSBpbnRlcnZhbHNbcHJvbWlzZS4kJGludGVydmFsSWRdO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIGludGVydmFsO1xuICB9XTtcbn1cblxuLyoqXG4gKiBAbmdkb2Mgc2VydmljZVxuICogQG5hbWUgJGxvY2FsZVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogJGxvY2FsZSBzZXJ2aWNlIHByb3ZpZGVzIGxvY2FsaXphdGlvbiBydWxlcyBmb3IgdmFyaW91cyBBbmd1bGFyIGNvbXBvbmVudHMuIEFzIG9mIHJpZ2h0IG5vdyB0aGVcbiAqIG9ubHkgcHVibGljIGFwaSBpczpcbiAqXG4gKiAqIGBpZGAg4oCTIGB7c3RyaW5nfWAg4oCTIGxvY2FsZSBpZCBmb3JtYXR0ZWQgYXMgYGxhbmd1YWdlSWQtY291bnRyeUlkYCAoZS5nLiBgZW4tdXNgKVxuICovXG5cbnZhciBQQVRIX01BVENIID0gL14oW15cXD8jXSopKFxcPyhbXiNdKikpPygjKC4qKSk/JC8sXG4gICAgREVGQVVMVF9QT1JUUyA9IHsnaHR0cCc6IDgwLCAnaHR0cHMnOiA0NDMsICdmdHAnOiAyMX07XG52YXIgJGxvY2F0aW9uTWluRXJyID0gbWluRXJyKCckbG9jYXRpb24nKTtcblxuXG4vKipcbiAqIEVuY29kZSBwYXRoIHVzaW5nIGVuY29kZVVyaVNlZ21lbnQsIGlnbm9yaW5nIGZvcndhcmQgc2xhc2hlc1xuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoIFBhdGggdG8gZW5jb2RlXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBlbmNvZGVQYXRoKHBhdGgpIHtcbiAgdmFyIHNlZ21lbnRzID0gcGF0aC5zcGxpdCgnLycpLFxuICAgICAgaSA9IHNlZ21lbnRzLmxlbmd0aDtcblxuICB3aGlsZSAoaS0tKSB7XG4gICAgc2VnbWVudHNbaV0gPSBlbmNvZGVVcmlTZWdtZW50KHNlZ21lbnRzW2ldKTtcbiAgfVxuXG4gIHJldHVybiBzZWdtZW50cy5qb2luKCcvJyk7XG59XG5cbmZ1bmN0aW9uIHBhcnNlQWJzb2x1dGVVcmwoYWJzb2x1dGVVcmwsIGxvY2F0aW9uT2JqKSB7XG4gIHZhciBwYXJzZWRVcmwgPSB1cmxSZXNvbHZlKGFic29sdXRlVXJsKTtcblxuICBsb2NhdGlvbk9iai4kJHByb3RvY29sID0gcGFyc2VkVXJsLnByb3RvY29sO1xuICBsb2NhdGlvbk9iai4kJGhvc3QgPSBwYXJzZWRVcmwuaG9zdG5hbWU7XG4gIGxvY2F0aW9uT2JqLiQkcG9ydCA9IHRvSW50KHBhcnNlZFVybC5wb3J0KSB8fCBERUZBVUxUX1BPUlRTW3BhcnNlZFVybC5wcm90b2NvbF0gfHwgbnVsbDtcbn1cblxuXG5mdW5jdGlvbiBwYXJzZUFwcFVybChyZWxhdGl2ZVVybCwgbG9jYXRpb25PYmopIHtcbiAgdmFyIHByZWZpeGVkID0gKHJlbGF0aXZlVXJsLmNoYXJBdCgwKSAhPT0gJy8nKTtcbiAgaWYgKHByZWZpeGVkKSB7XG4gICAgcmVsYXRpdmVVcmwgPSAnLycgKyByZWxhdGl2ZVVybDtcbiAgfVxuICB2YXIgbWF0Y2ggPSB1cmxSZXNvbHZlKHJlbGF0aXZlVXJsKTtcbiAgbG9jYXRpb25PYmouJCRwYXRoID0gZGVjb2RlVVJJQ29tcG9uZW50KHByZWZpeGVkICYmIG1hdGNoLnBhdGhuYW1lLmNoYXJBdCgwKSA9PT0gJy8nID9cbiAgICAgIG1hdGNoLnBhdGhuYW1lLnN1YnN0cmluZygxKSA6IG1hdGNoLnBhdGhuYW1lKTtcbiAgbG9jYXRpb25PYmouJCRzZWFyY2ggPSBwYXJzZUtleVZhbHVlKG1hdGNoLnNlYXJjaCk7XG4gIGxvY2F0aW9uT2JqLiQkaGFzaCA9IGRlY29kZVVSSUNvbXBvbmVudChtYXRjaC5oYXNoKTtcblxuICAvLyBtYWtlIHN1cmUgcGF0aCBzdGFydHMgd2l0aCAnLyc7XG4gIGlmIChsb2NhdGlvbk9iai4kJHBhdGggJiYgbG9jYXRpb25PYmouJCRwYXRoLmNoYXJBdCgwKSAhPSAnLycpIHtcbiAgICBsb2NhdGlvbk9iai4kJHBhdGggPSAnLycgKyBsb2NhdGlvbk9iai4kJHBhdGg7XG4gIH1cbn1cblxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYmVnaW5cbiAqIEBwYXJhbSB7c3RyaW5nfSB3aG9sZVxuICogQHJldHVybnMge3N0cmluZ30gcmV0dXJucyB0ZXh0IGZyb20gd2hvbGUgYWZ0ZXIgYmVnaW4gb3IgdW5kZWZpbmVkIGlmIGl0IGRvZXMgbm90IGJlZ2luIHdpdGhcbiAqICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkIHN0cmluZy5cbiAqL1xuZnVuY3Rpb24gYmVnaW5zV2l0aChiZWdpbiwgd2hvbGUpIHtcbiAgaWYgKHdob2xlLmluZGV4T2YoYmVnaW4pID09PSAwKSB7XG4gICAgcmV0dXJuIHdob2xlLnN1YnN0cihiZWdpbi5sZW5ndGgpO1xuICB9XG59XG5cblxuZnVuY3Rpb24gc3RyaXBIYXNoKHVybCkge1xuICB2YXIgaW5kZXggPSB1cmwuaW5kZXhPZignIycpO1xuICByZXR1cm4gaW5kZXggPT0gLTEgPyB1cmwgOiB1cmwuc3Vic3RyKDAsIGluZGV4KTtcbn1cblxuZnVuY3Rpb24gdHJpbUVtcHR5SGFzaCh1cmwpIHtcbiAgcmV0dXJuIHVybC5yZXBsYWNlKC8oIy4rKXwjJC8sICckMScpO1xufVxuXG5cbmZ1bmN0aW9uIHN0cmlwRmlsZSh1cmwpIHtcbiAgcmV0dXJuIHVybC5zdWJzdHIoMCwgc3RyaXBIYXNoKHVybCkubGFzdEluZGV4T2YoJy8nKSArIDEpO1xufVxuXG4vKiByZXR1cm4gdGhlIHNlcnZlciBvbmx5IChzY2hlbWU6Ly9ob3N0OnBvcnQpICovXG5mdW5jdGlvbiBzZXJ2ZXJCYXNlKHVybCkge1xuICByZXR1cm4gdXJsLnN1YnN0cmluZygwLCB1cmwuaW5kZXhPZignLycsIHVybC5pbmRleE9mKCcvLycpICsgMikpO1xufVxuXG5cbi8qKlxuICogTG9jYXRpb25IdG1sNVVybCByZXByZXNlbnRzIGFuIHVybFxuICogVGhpcyBvYmplY3QgaXMgZXhwb3NlZCBhcyAkbG9jYXRpb24gc2VydmljZSB3aGVuIEhUTUw1IG1vZGUgaXMgZW5hYmxlZCBhbmQgc3VwcG9ydGVkXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwQmFzZSBhcHBsaWNhdGlvbiBiYXNlIFVSTFxuICogQHBhcmFtIHtzdHJpbmd9IGFwcEJhc2VOb0ZpbGUgYXBwbGljYXRpb24gYmFzZSBVUkwgc3RyaXBwZWQgb2YgYW55IGZpbGVuYW1lXG4gKiBAcGFyYW0ge3N0cmluZ30gYmFzZVByZWZpeCB1cmwgcGF0aCBwcmVmaXhcbiAqL1xuZnVuY3Rpb24gTG9jYXRpb25IdG1sNVVybChhcHBCYXNlLCBhcHBCYXNlTm9GaWxlLCBiYXNlUHJlZml4KSB7XG4gIHRoaXMuJCRodG1sNSA9IHRydWU7XG4gIGJhc2VQcmVmaXggPSBiYXNlUHJlZml4IHx8ICcnO1xuICBwYXJzZUFic29sdXRlVXJsKGFwcEJhc2UsIHRoaXMpO1xuXG5cbiAgLyoqXG4gICAqIFBhcnNlIGdpdmVuIGh0bWw1IChyZWd1bGFyKSB1cmwgc3RyaW5nIGludG8gcHJvcGVydGllc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIEhUTUw1IHVybFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy4kJHBhcnNlID0gZnVuY3Rpb24odXJsKSB7XG4gICAgdmFyIHBhdGhVcmwgPSBiZWdpbnNXaXRoKGFwcEJhc2VOb0ZpbGUsIHVybCk7XG4gICAgaWYgKCFpc1N0cmluZyhwYXRoVXJsKSkge1xuICAgICAgdGhyb3cgJGxvY2F0aW9uTWluRXJyKCdpcHRocHJmeCcsICdJbnZhbGlkIHVybCBcInswfVwiLCBtaXNzaW5nIHBhdGggcHJlZml4IFwiezF9XCIuJywgdXJsLFxuICAgICAgICAgIGFwcEJhc2VOb0ZpbGUpO1xuICAgIH1cblxuICAgIHBhcnNlQXBwVXJsKHBhdGhVcmwsIHRoaXMpO1xuXG4gICAgaWYgKCF0aGlzLiQkcGF0aCkge1xuICAgICAgdGhpcy4kJHBhdGggPSAnLyc7XG4gICAgfVxuXG4gICAgdGhpcy4kJGNvbXBvc2UoKTtcbiAgfTtcblxuICAvKipcbiAgICogQ29tcG9zZSB1cmwgYW5kIHVwZGF0ZSBgYWJzVXJsYCBwcm9wZXJ0eVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy4kJGNvbXBvc2UgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VhcmNoID0gdG9LZXlWYWx1ZSh0aGlzLiQkc2VhcmNoKSxcbiAgICAgICAgaGFzaCA9IHRoaXMuJCRoYXNoID8gJyMnICsgZW5jb2RlVXJpU2VnbWVudCh0aGlzLiQkaGFzaCkgOiAnJztcblxuICAgIHRoaXMuJCR1cmwgPSBlbmNvZGVQYXRoKHRoaXMuJCRwYXRoKSArIChzZWFyY2ggPyAnPycgKyBzZWFyY2ggOiAnJykgKyBoYXNoO1xuICAgIHRoaXMuJCRhYnNVcmwgPSBhcHBCYXNlTm9GaWxlICsgdGhpcy4kJHVybC5zdWJzdHIoMSk7IC8vIGZpcnN0IGNoYXIgaXMgYWx3YXlzICcvJ1xuICB9O1xuXG4gIHRoaXMuJCRwYXJzZUxpbmtVcmwgPSBmdW5jdGlvbih1cmwsIHJlbEhyZWYpIHtcbiAgICBpZiAocmVsSHJlZiAmJiByZWxIcmVmWzBdID09PSAnIycpIHtcbiAgICAgIC8vIHNwZWNpYWwgY2FzZSBmb3IgbGlua3MgdG8gaGFzaCBmcmFnbWVudHM6XG4gICAgICAvLyBrZWVwIHRoZSBvbGQgdXJsIGFuZCBvbmx5IHJlcGxhY2UgdGhlIGhhc2ggZnJhZ21lbnRcbiAgICAgIHRoaXMuaGFzaChyZWxIcmVmLnNsaWNlKDEpKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICB2YXIgYXBwVXJsLCBwcmV2QXBwVXJsO1xuICAgIHZhciByZXdyaXR0ZW5Vcmw7XG5cbiAgICBpZiAoaXNEZWZpbmVkKGFwcFVybCA9IGJlZ2luc1dpdGgoYXBwQmFzZSwgdXJsKSkpIHtcbiAgICAgIHByZXZBcHBVcmwgPSBhcHBVcmw7XG4gICAgICBpZiAoaXNEZWZpbmVkKGFwcFVybCA9IGJlZ2luc1dpdGgoYmFzZVByZWZpeCwgYXBwVXJsKSkpIHtcbiAgICAgICAgcmV3cml0dGVuVXJsID0gYXBwQmFzZU5vRmlsZSArIChiZWdpbnNXaXRoKCcvJywgYXBwVXJsKSB8fCBhcHBVcmwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV3cml0dGVuVXJsID0gYXBwQmFzZSArIHByZXZBcHBVcmw7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChpc0RlZmluZWQoYXBwVXJsID0gYmVnaW5zV2l0aChhcHBCYXNlTm9GaWxlLCB1cmwpKSkge1xuICAgICAgcmV3cml0dGVuVXJsID0gYXBwQmFzZU5vRmlsZSArIGFwcFVybDtcbiAgICB9IGVsc2UgaWYgKGFwcEJhc2VOb0ZpbGUgPT0gdXJsICsgJy8nKSB7XG4gICAgICByZXdyaXR0ZW5VcmwgPSBhcHBCYXNlTm9GaWxlO1xuICAgIH1cbiAgICBpZiAocmV3cml0dGVuVXJsKSB7XG4gICAgICB0aGlzLiQkcGFyc2UocmV3cml0dGVuVXJsKTtcbiAgICB9XG4gICAgcmV0dXJuICEhcmV3cml0dGVuVXJsO1xuICB9O1xufVxuXG5cbi8qKlxuICogTG9jYXRpb25IYXNoYmFuZ1VybCByZXByZXNlbnRzIHVybFxuICogVGhpcyBvYmplY3QgaXMgZXhwb3NlZCBhcyAkbG9jYXRpb24gc2VydmljZSB3aGVuIGRldmVsb3BlciBkb2Vzbid0IG9wdCBpbnRvIGh0bWw1IG1vZGUuXG4gKiBJdCBhbHNvIHNlcnZlcyBhcyB0aGUgYmFzZSBjbGFzcyBmb3IgaHRtbDUgbW9kZSBmYWxsYmFjayBvbiBsZWdhY3kgYnJvd3NlcnMuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwQmFzZSBhcHBsaWNhdGlvbiBiYXNlIFVSTFxuICogQHBhcmFtIHtzdHJpbmd9IGFwcEJhc2VOb0ZpbGUgYXBwbGljYXRpb24gYmFzZSBVUkwgc3RyaXBwZWQgb2YgYW55IGZpbGVuYW1lXG4gKiBAcGFyYW0ge3N0cmluZ30gaGFzaFByZWZpeCBoYXNoYmFuZyBwcmVmaXhcbiAqL1xuZnVuY3Rpb24gTG9jYXRpb25IYXNoYmFuZ1VybChhcHBCYXNlLCBhcHBCYXNlTm9GaWxlLCBoYXNoUHJlZml4KSB7XG5cbiAgcGFyc2VBYnNvbHV0ZVVybChhcHBCYXNlLCB0aGlzKTtcblxuXG4gIC8qKlxuICAgKiBQYXJzZSBnaXZlbiBoYXNoYmFuZyB1cmwgaW50byBwcm9wZXJ0aWVzXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgSGFzaGJhbmcgdXJsXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0aGlzLiQkcGFyc2UgPSBmdW5jdGlvbih1cmwpIHtcbiAgICB2YXIgd2l0aG91dEJhc2VVcmwgPSBiZWdpbnNXaXRoKGFwcEJhc2UsIHVybCkgfHwgYmVnaW5zV2l0aChhcHBCYXNlTm9GaWxlLCB1cmwpO1xuICAgIHZhciB3aXRob3V0SGFzaFVybDtcblxuICAgIGlmICghaXNVbmRlZmluZWQod2l0aG91dEJhc2VVcmwpICYmIHdpdGhvdXRCYXNlVXJsLmNoYXJBdCgwKSA9PT0gJyMnKSB7XG5cbiAgICAgIC8vIFRoZSByZXN0IG9mIHRoZSB1cmwgc3RhcnRzIHdpdGggYSBoYXNoIHNvIHdlIGhhdmVcbiAgICAgIC8vIGdvdCBlaXRoZXIgYSBoYXNoYmFuZyBwYXRoIG9yIGEgcGxhaW4gaGFzaCBmcmFnbWVudFxuICAgICAgd2l0aG91dEhhc2hVcmwgPSBiZWdpbnNXaXRoKGhhc2hQcmVmaXgsIHdpdGhvdXRCYXNlVXJsKTtcbiAgICAgIGlmIChpc1VuZGVmaW5lZCh3aXRob3V0SGFzaFVybCkpIHtcbiAgICAgICAgLy8gVGhlcmUgd2FzIG5vIGhhc2hiYW5nIHByZWZpeCBzbyB3ZSBqdXN0IGhhdmUgYSBoYXNoIGZyYWdtZW50XG4gICAgICAgIHdpdGhvdXRIYXNoVXJsID0gd2l0aG91dEJhc2VVcmw7XG4gICAgICB9XG5cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVGhlcmUgd2FzIG5vIGhhc2hiYW5nIHBhdGggbm9yIGhhc2ggZnJhZ21lbnQ6XG4gICAgICAvLyBJZiB3ZSBhcmUgaW4gSFRNTDUgbW9kZSB3ZSB1c2Ugd2hhdCBpcyBsZWZ0IGFzIHRoZSBwYXRoO1xuICAgICAgLy8gT3RoZXJ3aXNlIHdlIGlnbm9yZSB3aGF0IGlzIGxlZnRcbiAgICAgIGlmICh0aGlzLiQkaHRtbDUpIHtcbiAgICAgICAgd2l0aG91dEhhc2hVcmwgPSB3aXRob3V0QmFzZVVybDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHdpdGhvdXRIYXNoVXJsID0gJyc7XG4gICAgICAgIGlmIChpc1VuZGVmaW5lZCh3aXRob3V0QmFzZVVybCkpIHtcbiAgICAgICAgICBhcHBCYXNlID0gdXJsO1xuICAgICAgICAgIHRoaXMucmVwbGFjZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcGFyc2VBcHBVcmwod2l0aG91dEhhc2hVcmwsIHRoaXMpO1xuXG4gICAgdGhpcy4kJHBhdGggPSByZW1vdmVXaW5kb3dzRHJpdmVOYW1lKHRoaXMuJCRwYXRoLCB3aXRob3V0SGFzaFVybCwgYXBwQmFzZSk7XG5cbiAgICB0aGlzLiQkY29tcG9zZSgpO1xuXG4gICAgLypcbiAgICAgKiBJbiBXaW5kb3dzLCBvbiBhbiBhbmNob3Igbm9kZSBvbiBkb2N1bWVudHMgbG9hZGVkIGZyb21cbiAgICAgKiB0aGUgZmlsZXN5c3RlbSwgdGhlIGJyb3dzZXIgd2lsbCByZXR1cm4gYSBwYXRobmFtZVxuICAgICAqIHByZWZpeGVkIHdpdGggdGhlIGRyaXZlIG5hbWUgKCcvQzovcGF0aCcpIHdoZW4gYVxuICAgICAqIHBhdGhuYW1lIHdpdGhvdXQgYSBkcml2ZSBpcyBzZXQ6XG4gICAgICogICogYS5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnL2ZvbycpXG4gICAgICogICAqIGEucGF0aG5hbWUgPT09ICcvQzovZm9vJyAvL3RydWVcbiAgICAgKlxuICAgICAqIEluc2lkZSBvZiBBbmd1bGFyLCB3ZSdyZSBhbHdheXMgdXNpbmcgcGF0aG5hbWVzIHRoYXRcbiAgICAgKiBkbyBub3QgaW5jbHVkZSBkcml2ZSBuYW1lcyBmb3Igcm91dGluZy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW1vdmVXaW5kb3dzRHJpdmVOYW1lKHBhdGgsIHVybCwgYmFzZSkge1xuICAgICAgLypcbiAgICAgIE1hdGNoZXMgcGF0aHMgZm9yIGZpbGUgcHJvdG9jb2wgb24gd2luZG93cyxcbiAgICAgIHN1Y2ggYXMgL0M6L2Zvby9iYXIsIGFuZCBjYXB0dXJlcyBvbmx5IC9mb28vYmFyLlxuICAgICAgKi9cbiAgICAgIHZhciB3aW5kb3dzRmlsZVBhdGhFeHAgPSAvXlxcL1tBLVpdOihcXC8uKikvO1xuXG4gICAgICB2YXIgZmlyc3RQYXRoU2VnbWVudE1hdGNoO1xuXG4gICAgICAvL0dldCB0aGUgcmVsYXRpdmUgcGF0aCBmcm9tIHRoZSBpbnB1dCBVUkwuXG4gICAgICBpZiAodXJsLmluZGV4T2YoYmFzZSkgPT09IDApIHtcbiAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UoYmFzZSwgJycpO1xuICAgICAgfVxuXG4gICAgICAvLyBUaGUgaW5wdXQgVVJMIGludGVudGlvbmFsbHkgY29udGFpbnMgYSBmaXJzdCBwYXRoIHNlZ21lbnQgdGhhdCBlbmRzIHdpdGggYSBjb2xvbi5cbiAgICAgIGlmICh3aW5kb3dzRmlsZVBhdGhFeHAuZXhlYyh1cmwpKSB7XG4gICAgICAgIHJldHVybiBwYXRoO1xuICAgICAgfVxuXG4gICAgICBmaXJzdFBhdGhTZWdtZW50TWF0Y2ggPSB3aW5kb3dzRmlsZVBhdGhFeHAuZXhlYyhwYXRoKTtcbiAgICAgIHJldHVybiBmaXJzdFBhdGhTZWdtZW50TWF0Y2ggPyBmaXJzdFBhdGhTZWdtZW50TWF0Y2hbMV0gOiBwYXRoO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ29tcG9zZSBoYXNoYmFuZyB1cmwgYW5kIHVwZGF0ZSBgYWJzVXJsYCBwcm9wZXJ0eVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy4kJGNvbXBvc2UgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VhcmNoID0gdG9LZXlWYWx1ZSh0aGlzLiQkc2VhcmNoKSxcbiAgICAgICAgaGFzaCA9IHRoaXMuJCRoYXNoID8gJyMnICsgZW5jb2RlVXJpU2VnbWVudCh0aGlzLiQkaGFzaCkgOiAnJztcblxuICAgIHRoaXMuJCR1cmwgPSBlbmNvZGVQYXRoKHRoaXMuJCRwYXRoKSArIChzZWFyY2ggPyAnPycgKyBzZWFyY2ggOiAnJykgKyBoYXNoO1xuICAgIHRoaXMuJCRhYnNVcmwgPSBhcHBCYXNlICsgKHRoaXMuJCR1cmwgPyBoYXNoUHJlZml4ICsgdGhpcy4kJHVybCA6ICcnKTtcbiAgfTtcblxuICB0aGlzLiQkcGFyc2VMaW5rVXJsID0gZnVuY3Rpb24odXJsLCByZWxIcmVmKSB7XG4gICAgaWYgKHN0cmlwSGFzaChhcHBCYXNlKSA9PSBzdHJpcEhhc2godXJsKSkge1xuICAgICAgdGhpcy4kJHBhcnNlKHVybCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xufVxuXG5cbi8qKlxuICogTG9jYXRpb25IYXNoYmFuZ1VybCByZXByZXNlbnRzIHVybFxuICogVGhpcyBvYmplY3QgaXMgZXhwb3NlZCBhcyAkbG9jYXRpb24gc2VydmljZSB3aGVuIGh0bWw1IGhpc3RvcnkgYXBpIGlzIGVuYWJsZWQgYnV0IHRoZSBicm93c2VyXG4gKiBkb2VzIG5vdCBzdXBwb3J0IGl0LlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtzdHJpbmd9IGFwcEJhc2UgYXBwbGljYXRpb24gYmFzZSBVUkxcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHBCYXNlTm9GaWxlIGFwcGxpY2F0aW9uIGJhc2UgVVJMIHN0cmlwcGVkIG9mIGFueSBmaWxlbmFtZVxuICogQHBhcmFtIHtzdHJpbmd9IGhhc2hQcmVmaXggaGFzaGJhbmcgcHJlZml4XG4gKi9cbmZ1bmN0aW9uIExvY2F0aW9uSGFzaGJhbmdJbkh0bWw1VXJsKGFwcEJhc2UsIGFwcEJhc2VOb0ZpbGUsIGhhc2hQcmVmaXgpIHtcbiAgdGhpcy4kJGh0bWw1ID0gdHJ1ZTtcbiAgTG9jYXRpb25IYXNoYmFuZ1VybC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG4gIHRoaXMuJCRwYXJzZUxpbmtVcmwgPSBmdW5jdGlvbih1cmwsIHJlbEhyZWYpIHtcbiAgICBpZiAocmVsSHJlZiAmJiByZWxIcmVmWzBdID09PSAnIycpIHtcbiAgICAgIC8vIHNwZWNpYWwgY2FzZSBmb3IgbGlua3MgdG8gaGFzaCBmcmFnbWVudHM6XG4gICAgICAvLyBrZWVwIHRoZSBvbGQgdXJsIGFuZCBvbmx5IHJlcGxhY2UgdGhlIGhhc2ggZnJhZ21lbnRcbiAgICAgIHRoaXMuaGFzaChyZWxIcmVmLnNsaWNlKDEpKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHZhciByZXdyaXR0ZW5Vcmw7XG4gICAgdmFyIGFwcFVybDtcblxuICAgIGlmIChhcHBCYXNlID09IHN0cmlwSGFzaCh1cmwpKSB7XG4gICAgICByZXdyaXR0ZW5VcmwgPSB1cmw7XG4gICAgfSBlbHNlIGlmICgoYXBwVXJsID0gYmVnaW5zV2l0aChhcHBCYXNlTm9GaWxlLCB1cmwpKSkge1xuICAgICAgcmV3cml0dGVuVXJsID0gYXBwQmFzZSArIGhhc2hQcmVmaXggKyBhcHBVcmw7XG4gICAgfSBlbHNlIGlmIChhcHBCYXNlTm9GaWxlID09PSB1cmwgKyAnLycpIHtcbiAgICAgIHJld3JpdHRlblVybCA9IGFwcEJhc2VOb0ZpbGU7XG4gICAgfVxuICAgIGlmIChyZXdyaXR0ZW5VcmwpIHtcbiAgICAgIHRoaXMuJCRwYXJzZShyZXdyaXR0ZW5VcmwpO1xuICAgIH1cbiAgICByZXR1cm4gISFyZXdyaXR0ZW5Vcmw7XG4gIH07XG5cbiAgdGhpcy4kJGNvbXBvc2UgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VhcmNoID0gdG9LZXlWYWx1ZSh0aGlzLiQkc2VhcmNoKSxcbiAgICAgICAgaGFzaCA9IHRoaXMuJCRoYXNoID8gJyMnICsgZW5jb2RlVXJpU2VnbWVudCh0aGlzLiQkaGFzaCkgOiAnJztcblxuICAgIHRoaXMuJCR1cmwgPSBlbmNvZGVQYXRoKHRoaXMuJCRwYXRoKSArIChzZWFyY2ggPyAnPycgKyBzZWFyY2ggOiAnJykgKyBoYXNoO1xuICAgIC8vIGluY2x1ZGUgaGFzaFByZWZpeCBpbiAkJGFic1VybCB3aGVuICQkdXJsIGlzIGVtcHR5IHNvIElFOSBkb2VzIG5vdCByZWxvYWQgcGFnZSBiZWNhdXNlIG9mIHJlbW92YWwgb2YgJyMnXG4gICAgdGhpcy4kJGFic1VybCA9IGFwcEJhc2UgKyBoYXNoUHJlZml4ICsgdGhpcy4kJHVybDtcbiAgfTtcblxufVxuXG5cbnZhciBsb2NhdGlvblByb3RvdHlwZSA9IHtcblxuICAvKipcbiAgICogQXJlIHdlIGluIGh0bWw1IG1vZGU/XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICAkJGh0bWw1OiBmYWxzZSxcblxuICAvKipcbiAgICogSGFzIGFueSBjaGFuZ2UgYmVlbiByZXBsYWNpbmc/XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICAkJHJlcGxhY2U6IGZhbHNlLFxuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRsb2NhdGlvbiNhYnNVcmxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFRoaXMgbWV0aG9kIGlzIGdldHRlciBvbmx5LlxuICAgKlxuICAgKiBSZXR1cm4gZnVsbCB1cmwgcmVwcmVzZW50YXRpb24gd2l0aCBhbGwgc2VnbWVudHMgZW5jb2RlZCBhY2NvcmRpbmcgdG8gcnVsZXMgc3BlY2lmaWVkIGluXG4gICAqIFtSRkMgMzk4Nl0oaHR0cDovL3d3dy5pZXRmLm9yZy9yZmMvcmZjMzk4Ni50eHQpLlxuICAgKlxuICAgKlxuICAgKiBgYGBqc1xuICAgKiAvLyBnaXZlbiB1cmwgaHR0cDovL2V4YW1wbGUuY29tLyMvc29tZS9wYXRoP2Zvbz1iYXImYmF6PXhveG9cbiAgICogdmFyIGFic1VybCA9ICRsb2NhdGlvbi5hYnNVcmwoKTtcbiAgICogLy8gPT4gXCJodHRwOi8vZXhhbXBsZS5jb20vIy9zb21lL3BhdGg/Zm9vPWJhciZiYXo9eG94b1wiXG4gICAqIGBgYFxuICAgKlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IGZ1bGwgdXJsXG4gICAqL1xuICBhYnNVcmw6IGxvY2F0aW9uR2V0dGVyKCckJGFic1VybCcpLFxuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRsb2NhdGlvbiN1cmxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFRoaXMgbWV0aG9kIGlzIGdldHRlciAvIHNldHRlci5cbiAgICpcbiAgICogUmV0dXJuIHVybCAoZS5nLiBgL3BhdGg/YT1iI2hhc2hgKSB3aGVuIGNhbGxlZCB3aXRob3V0IGFueSBwYXJhbWV0ZXIuXG4gICAqXG4gICAqIENoYW5nZSBwYXRoLCBzZWFyY2ggYW5kIGhhc2gsIHdoZW4gY2FsbGVkIHdpdGggcGFyYW1ldGVyIGFuZCByZXR1cm4gYCRsb2NhdGlvbmAuXG4gICAqXG4gICAqXG4gICAqIGBgYGpzXG4gICAqIC8vIGdpdmVuIHVybCBodHRwOi8vZXhhbXBsZS5jb20vIy9zb21lL3BhdGg/Zm9vPWJhciZiYXo9eG94b1xuICAgKiB2YXIgdXJsID0gJGxvY2F0aW9uLnVybCgpO1xuICAgKiAvLyA9PiBcIi9zb21lL3BhdGg/Zm9vPWJhciZiYXo9eG94b1wiXG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZz19IHVybCBOZXcgdXJsIHdpdGhvdXQgYmFzZSBwcmVmaXggKGUuZy4gYC9wYXRoP2E9YiNoYXNoYClcbiAgICogQHJldHVybiB7c3RyaW5nfSB1cmxcbiAgICovXG4gIHVybDogZnVuY3Rpb24odXJsKSB7XG4gICAgaWYgKGlzVW5kZWZpbmVkKHVybCkpIHtcbiAgICAgIHJldHVybiB0aGlzLiQkdXJsO1xuICAgIH1cblxuICAgIHZhciBtYXRjaCA9IFBBVEhfTUFUQ0guZXhlYyh1cmwpO1xuICAgIGlmIChtYXRjaFsxXSB8fCB1cmwgPT09ICcnKSB0aGlzLnBhdGgoZGVjb2RlVVJJQ29tcG9uZW50KG1hdGNoWzFdKSk7XG4gICAgaWYgKG1hdGNoWzJdIHx8IG1hdGNoWzFdIHx8IHVybCA9PT0gJycpIHRoaXMuc2VhcmNoKG1hdGNoWzNdIHx8ICcnKTtcbiAgICB0aGlzLmhhc2gobWF0Y2hbNV0gfHwgJycpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGxvY2F0aW9uI3Byb3RvY29sXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBUaGlzIG1ldGhvZCBpcyBnZXR0ZXIgb25seS5cbiAgICpcbiAgICogUmV0dXJuIHByb3RvY29sIG9mIGN1cnJlbnQgdXJsLlxuICAgKlxuICAgKlxuICAgKiBgYGBqc1xuICAgKiAvLyBnaXZlbiB1cmwgaHR0cDovL2V4YW1wbGUuY29tLyMvc29tZS9wYXRoP2Zvbz1iYXImYmF6PXhveG9cbiAgICogdmFyIHByb3RvY29sID0gJGxvY2F0aW9uLnByb3RvY29sKCk7XG4gICAqIC8vID0+IFwiaHR0cFwiXG4gICAqIGBgYFxuICAgKlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IHByb3RvY29sIG9mIGN1cnJlbnQgdXJsXG4gICAqL1xuICBwcm90b2NvbDogbG9jYXRpb25HZXR0ZXIoJyQkcHJvdG9jb2wnKSxcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkbG9jYXRpb24jaG9zdFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogVGhpcyBtZXRob2QgaXMgZ2V0dGVyIG9ubHkuXG4gICAqXG4gICAqIFJldHVybiBob3N0IG9mIGN1cnJlbnQgdXJsLlxuICAgKlxuICAgKiBOb3RlOiBjb21wYXJlZCB0byB0aGUgbm9uLWFuZ3VsYXIgdmVyc2lvbiBgbG9jYXRpb24uaG9zdGAgd2hpY2ggcmV0dXJucyBgaG9zdG5hbWU6cG9ydGAsIHRoaXMgcmV0dXJucyB0aGUgYGhvc3RuYW1lYCBwb3J0aW9uIG9ubHkuXG4gICAqXG4gICAqXG4gICAqIGBgYGpzXG4gICAqIC8vIGdpdmVuIHVybCBodHRwOi8vZXhhbXBsZS5jb20vIy9zb21lL3BhdGg/Zm9vPWJhciZiYXo9eG94b1xuICAgKiB2YXIgaG9zdCA9ICRsb2NhdGlvbi5ob3N0KCk7XG4gICAqIC8vID0+IFwiZXhhbXBsZS5jb21cIlxuICAgKlxuICAgKiAvLyBnaXZlbiB1cmwgaHR0cDovL3VzZXI6cGFzc3dvcmRAZXhhbXBsZS5jb206ODA4MC8jL3NvbWUvcGF0aD9mb289YmFyJmJhej14b3hvXG4gICAqIGhvc3QgPSAkbG9jYXRpb24uaG9zdCgpO1xuICAgKiAvLyA9PiBcImV4YW1wbGUuY29tXCJcbiAgICogaG9zdCA9IGxvY2F0aW9uLmhvc3Q7XG4gICAqIC8vID0+IFwiZXhhbXBsZS5jb206ODA4MFwiXG4gICAqIGBgYFxuICAgKlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IGhvc3Qgb2YgY3VycmVudCB1cmwuXG4gICAqL1xuICBob3N0OiBsb2NhdGlvbkdldHRlcignJCRob3N0JyksXG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGxvY2F0aW9uI3BvcnRcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFRoaXMgbWV0aG9kIGlzIGdldHRlciBvbmx5LlxuICAgKlxuICAgKiBSZXR1cm4gcG9ydCBvZiBjdXJyZW50IHVybC5cbiAgICpcbiAgICpcbiAgICogYGBganNcbiAgICogLy8gZ2l2ZW4gdXJsIGh0dHA6Ly9leGFtcGxlLmNvbS8jL3NvbWUvcGF0aD9mb289YmFyJmJhej14b3hvXG4gICAqIHZhciBwb3J0ID0gJGxvY2F0aW9uLnBvcnQoKTtcbiAgICogLy8gPT4gODBcbiAgICogYGBgXG4gICAqXG4gICAqIEByZXR1cm4ge051bWJlcn0gcG9ydFxuICAgKi9cbiAgcG9ydDogbG9jYXRpb25HZXR0ZXIoJyQkcG9ydCcpLFxuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRsb2NhdGlvbiNwYXRoXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBUaGlzIG1ldGhvZCBpcyBnZXR0ZXIgLyBzZXR0ZXIuXG4gICAqXG4gICAqIFJldHVybiBwYXRoIG9mIGN1cnJlbnQgdXJsIHdoZW4gY2FsbGVkIHdpdGhvdXQgYW55IHBhcmFtZXRlci5cbiAgICpcbiAgICogQ2hhbmdlIHBhdGggd2hlbiBjYWxsZWQgd2l0aCBwYXJhbWV0ZXIgYW5kIHJldHVybiBgJGxvY2F0aW9uYC5cbiAgICpcbiAgICogTm90ZTogUGF0aCBzaG91bGQgYWx3YXlzIGJlZ2luIHdpdGggZm9yd2FyZCBzbGFzaCAoLyksIHRoaXMgbWV0aG9kIHdpbGwgYWRkIHRoZSBmb3J3YXJkIHNsYXNoXG4gICAqIGlmIGl0IGlzIG1pc3NpbmcuXG4gICAqXG4gICAqXG4gICAqIGBgYGpzXG4gICAqIC8vIGdpdmVuIHVybCBodHRwOi8vZXhhbXBsZS5jb20vIy9zb21lL3BhdGg/Zm9vPWJhciZiYXo9eG94b1xuICAgKiB2YXIgcGF0aCA9ICRsb2NhdGlvbi5wYXRoKCk7XG4gICAqIC8vID0+IFwiL3NvbWUvcGF0aFwiXG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0geyhzdHJpbmd8bnVtYmVyKT19IHBhdGggTmV3IHBhdGhcbiAgICogQHJldHVybiB7c3RyaW5nfSBwYXRoXG4gICAqL1xuICBwYXRoOiBsb2NhdGlvbkdldHRlclNldHRlcignJCRwYXRoJywgZnVuY3Rpb24ocGF0aCkge1xuICAgIHBhdGggPSBwYXRoICE9PSBudWxsID8gcGF0aC50b1N0cmluZygpIDogJyc7XG4gICAgcmV0dXJuIHBhdGguY2hhckF0KDApID09ICcvJyA/IHBhdGggOiAnLycgKyBwYXRoO1xuICB9KSxcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkbG9jYXRpb24jc2VhcmNoXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBUaGlzIG1ldGhvZCBpcyBnZXR0ZXIgLyBzZXR0ZXIuXG4gICAqXG4gICAqIFJldHVybiBzZWFyY2ggcGFydCAoYXMgb2JqZWN0KSBvZiBjdXJyZW50IHVybCB3aGVuIGNhbGxlZCB3aXRob3V0IGFueSBwYXJhbWV0ZXIuXG4gICAqXG4gICAqIENoYW5nZSBzZWFyY2ggcGFydCB3aGVuIGNhbGxlZCB3aXRoIHBhcmFtZXRlciBhbmQgcmV0dXJuIGAkbG9jYXRpb25gLlxuICAgKlxuICAgKlxuICAgKiBgYGBqc1xuICAgKiAvLyBnaXZlbiB1cmwgaHR0cDovL2V4YW1wbGUuY29tLyMvc29tZS9wYXRoP2Zvbz1iYXImYmF6PXhveG9cbiAgICogdmFyIHNlYXJjaE9iamVjdCA9ICRsb2NhdGlvbi5zZWFyY2goKTtcbiAgICogLy8gPT4ge2ZvbzogJ2JhcicsIGJhejogJ3hveG8nfVxuICAgKlxuICAgKiAvLyBzZXQgZm9vIHRvICd5aXBlZSdcbiAgICogJGxvY2F0aW9uLnNlYXJjaCgnZm9vJywgJ3lpcGVlJyk7XG4gICAqIC8vICRsb2NhdGlvbi5zZWFyY2goKSA9PiB7Zm9vOiAneWlwZWUnLCBiYXo6ICd4b3hvJ31cbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfE9iamVjdC48c3RyaW5nPnxPYmplY3QuPEFycmF5LjxzdHJpbmc+Pn0gc2VhcmNoIE5ldyBzZWFyY2ggcGFyYW1zIC0gc3RyaW5nIG9yXG4gICAqIGhhc2ggb2JqZWN0LlxuICAgKlxuICAgKiBXaGVuIGNhbGxlZCB3aXRoIGEgc2luZ2xlIGFyZ3VtZW50IHRoZSBtZXRob2QgYWN0cyBhcyBhIHNldHRlciwgc2V0dGluZyB0aGUgYHNlYXJjaGAgY29tcG9uZW50XG4gICAqIG9mIGAkbG9jYXRpb25gIHRvIHRoZSBzcGVjaWZpZWQgdmFsdWUuXG4gICAqXG4gICAqIElmIHRoZSBhcmd1bWVudCBpcyBhIGhhc2ggb2JqZWN0IGNvbnRhaW5pbmcgYW4gYXJyYXkgb2YgdmFsdWVzLCB0aGVzZSB2YWx1ZXMgd2lsbCBiZSBlbmNvZGVkXG4gICAqIGFzIGR1cGxpY2F0ZSBzZWFyY2ggcGFyYW1ldGVycyBpbiB0aGUgdXJsLlxuICAgKlxuICAgKiBAcGFyYW0geyhzdHJpbmd8TnVtYmVyfEFycmF5PHN0cmluZz58Ym9vbGVhbik9fSBwYXJhbVZhbHVlIElmIGBzZWFyY2hgIGlzIGEgc3RyaW5nIG9yIG51bWJlciwgdGhlbiBgcGFyYW1WYWx1ZWBcbiAgICogd2lsbCBvdmVycmlkZSBvbmx5IGEgc2luZ2xlIHNlYXJjaCBwcm9wZXJ0eS5cbiAgICpcbiAgICogSWYgYHBhcmFtVmFsdWVgIGlzIGFuIGFycmF5LCBpdCB3aWxsIG92ZXJyaWRlIHRoZSBwcm9wZXJ0eSBvZiB0aGUgYHNlYXJjaGAgY29tcG9uZW50IG9mXG4gICAqIGAkbG9jYXRpb25gIHNwZWNpZmllZCB2aWEgdGhlIGZpcnN0IGFyZ3VtZW50LlxuICAgKlxuICAgKiBJZiBgcGFyYW1WYWx1ZWAgaXMgYG51bGxgLCB0aGUgcHJvcGVydHkgc3BlY2lmaWVkIHZpYSB0aGUgZmlyc3QgYXJndW1lbnQgd2lsbCBiZSBkZWxldGVkLlxuICAgKlxuICAgKiBJZiBgcGFyYW1WYWx1ZWAgaXMgYHRydWVgLCB0aGUgcHJvcGVydHkgc3BlY2lmaWVkIHZpYSB0aGUgZmlyc3QgYXJndW1lbnQgd2lsbCBiZSBhZGRlZCB3aXRoIG5vXG4gICAqIHZhbHVlIG5vciB0cmFpbGluZyBlcXVhbCBzaWduLlxuICAgKlxuICAgKiBAcmV0dXJuIHtPYmplY3R9IElmIGNhbGxlZCB3aXRoIG5vIGFyZ3VtZW50cyByZXR1cm5zIHRoZSBwYXJzZWQgYHNlYXJjaGAgb2JqZWN0LiBJZiBjYWxsZWQgd2l0aFxuICAgKiBvbmUgb3IgbW9yZSBhcmd1bWVudHMgcmV0dXJucyBgJGxvY2F0aW9uYCBvYmplY3QgaXRzZWxmLlxuICAgKi9cbiAgc2VhcmNoOiBmdW5jdGlvbihzZWFyY2gsIHBhcmFtVmFsdWUpIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgIGNhc2UgMDpcbiAgICAgICAgcmV0dXJuIHRoaXMuJCRzZWFyY2g7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIGlmIChpc1N0cmluZyhzZWFyY2gpIHx8IGlzTnVtYmVyKHNlYXJjaCkpIHtcbiAgICAgICAgICBzZWFyY2ggPSBzZWFyY2gudG9TdHJpbmcoKTtcbiAgICAgICAgICB0aGlzLiQkc2VhcmNoID0gcGFyc2VLZXlWYWx1ZShzZWFyY2gpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzT2JqZWN0KHNlYXJjaCkpIHtcbiAgICAgICAgICBzZWFyY2ggPSBjb3B5KHNlYXJjaCwge30pO1xuICAgICAgICAgIC8vIHJlbW92ZSBvYmplY3QgdW5kZWZpbmVkIG9yIG51bGwgcHJvcGVydGllc1xuICAgICAgICAgIGZvckVhY2goc2VhcmNoLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgZGVsZXRlIHNlYXJjaFtrZXldO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdGhpcy4kJHNlYXJjaCA9IHNlYXJjaDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyAkbG9jYXRpb25NaW5FcnIoJ2lzcmNoYXJnJyxcbiAgICAgICAgICAgICAgJ1RoZSBmaXJzdCBhcmd1bWVudCBvZiB0aGUgYCRsb2NhdGlvbiNzZWFyY2goKWAgY2FsbCBtdXN0IGJlIGEgc3RyaW5nIG9yIGFuIG9iamVjdC4nKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChpc1VuZGVmaW5lZChwYXJhbVZhbHVlKSB8fCBwYXJhbVZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgZGVsZXRlIHRoaXMuJCRzZWFyY2hbc2VhcmNoXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLiQkc2VhcmNoW3NlYXJjaF0gPSBwYXJhbVZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy4kJGNvbXBvc2UoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfSxcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkbG9jYXRpb24jaGFzaFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogVGhpcyBtZXRob2QgaXMgZ2V0dGVyIC8gc2V0dGVyLlxuICAgKlxuICAgKiBSZXR1cm5zIHRoZSBoYXNoIGZyYWdtZW50IHdoZW4gY2FsbGVkIHdpdGhvdXQgYW55IHBhcmFtZXRlcnMuXG4gICAqXG4gICAqIENoYW5nZXMgdGhlIGhhc2ggZnJhZ21lbnQgd2hlbiBjYWxsZWQgd2l0aCBhIHBhcmFtZXRlciBhbmQgcmV0dXJucyBgJGxvY2F0aW9uYC5cbiAgICpcbiAgICpcbiAgICogYGBganNcbiAgICogLy8gZ2l2ZW4gdXJsIGh0dHA6Ly9leGFtcGxlLmNvbS8jL3NvbWUvcGF0aD9mb289YmFyJmJhej14b3hvI2hhc2hWYWx1ZVxuICAgKiB2YXIgaGFzaCA9ICRsb2NhdGlvbi5oYXNoKCk7XG4gICAqIC8vID0+IFwiaGFzaFZhbHVlXCJcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSB7KHN0cmluZ3xudW1iZXIpPX0gaGFzaCBOZXcgaGFzaCBmcmFnbWVudFxuICAgKiBAcmV0dXJuIHtzdHJpbmd9IGhhc2hcbiAgICovXG4gIGhhc2g6IGxvY2F0aW9uR2V0dGVyU2V0dGVyKCckJGhhc2gnLCBmdW5jdGlvbihoYXNoKSB7XG4gICAgcmV0dXJuIGhhc2ggIT09IG51bGwgPyBoYXNoLnRvU3RyaW5nKCkgOiAnJztcbiAgfSksXG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGxvY2F0aW9uI3JlcGxhY2VcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIElmIGNhbGxlZCwgYWxsIGNoYW5nZXMgdG8gJGxvY2F0aW9uIGR1cmluZyB0aGUgY3VycmVudCBgJGRpZ2VzdGAgd2lsbCByZXBsYWNlIHRoZSBjdXJyZW50IGhpc3RvcnlcbiAgICogcmVjb3JkLCBpbnN0ZWFkIG9mIGFkZGluZyBhIG5ldyBvbmUuXG4gICAqL1xuICByZXBsYWNlOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLiQkcmVwbGFjZSA9IHRydWU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn07XG5cbmZvckVhY2goW0xvY2F0aW9uSGFzaGJhbmdJbkh0bWw1VXJsLCBMb2NhdGlvbkhhc2hiYW5nVXJsLCBMb2NhdGlvbkh0bWw1VXJsXSwgZnVuY3Rpb24oTG9jYXRpb24pIHtcbiAgTG9jYXRpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShsb2NhdGlvblByb3RvdHlwZSk7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGxvY2F0aW9uI3N0YXRlXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBUaGlzIG1ldGhvZCBpcyBnZXR0ZXIgLyBzZXR0ZXIuXG4gICAqXG4gICAqIFJldHVybiB0aGUgaGlzdG9yeSBzdGF0ZSBvYmplY3Qgd2hlbiBjYWxsZWQgd2l0aG91dCBhbnkgcGFyYW1ldGVyLlxuICAgKlxuICAgKiBDaGFuZ2UgdGhlIGhpc3Rvcnkgc3RhdGUgb2JqZWN0IHdoZW4gY2FsbGVkIHdpdGggb25lIHBhcmFtZXRlciBhbmQgcmV0dXJuIGAkbG9jYXRpb25gLlxuICAgKiBUaGUgc3RhdGUgb2JqZWN0IGlzIGxhdGVyIHBhc3NlZCB0byBgcHVzaFN0YXRlYCBvciBgcmVwbGFjZVN0YXRlYC5cbiAgICpcbiAgICogTk9URTogVGhpcyBtZXRob2QgaXMgc3VwcG9ydGVkIG9ubHkgaW4gSFRNTDUgbW9kZSBhbmQgb25seSBpbiBicm93c2VycyBzdXBwb3J0aW5nXG4gICAqIHRoZSBIVE1MNSBIaXN0b3J5IEFQSSAoaS5lLiBtZXRob2RzIGBwdXNoU3RhdGVgIGFuZCBgcmVwbGFjZVN0YXRlYCkuIElmIHlvdSBuZWVkIHRvIHN1cHBvcnRcbiAgICogb2xkZXIgYnJvd3NlcnMgKGxpa2UgSUU5IG9yIEFuZHJvaWQgPCA0LjApLCBkb24ndCB1c2UgdGhpcyBtZXRob2QuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gc3RhdGUgU3RhdGUgb2JqZWN0IGZvciBwdXNoU3RhdGUgb3IgcmVwbGFjZVN0YXRlXG4gICAqIEByZXR1cm4ge29iamVjdH0gc3RhdGVcbiAgICovXG4gIExvY2F0aW9uLnByb3RvdHlwZS5zdGF0ZSA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gdGhpcy4kJHN0YXRlO1xuICAgIH1cblxuICAgIGlmIChMb2NhdGlvbiAhPT0gTG9jYXRpb25IdG1sNVVybCB8fCAhdGhpcy4kJGh0bWw1KSB7XG4gICAgICB0aHJvdyAkbG9jYXRpb25NaW5FcnIoJ25vc3RhdGUnLCAnSGlzdG9yeSBBUEkgc3RhdGUgc3VwcG9ydCBpcyBhdmFpbGFibGUgb25seSAnICtcbiAgICAgICAgJ2luIEhUTUw1IG1vZGUgYW5kIG9ubHkgaW4gYnJvd3NlcnMgc3VwcG9ydGluZyBIVE1MNSBIaXN0b3J5IEFQSScpO1xuICAgIH1cbiAgICAvLyBUaGUgdXNlciBtaWdodCBtb2RpZnkgYHN0YXRlT2JqZWN0YCBhZnRlciBpbnZva2luZyBgJGxvY2F0aW9uLnN0YXRlKHN0YXRlT2JqZWN0KWBcbiAgICAvLyBidXQgd2UncmUgY2hhbmdpbmcgdGhlICQkc3RhdGUgcmVmZXJlbmNlIHRvICRicm93c2VyLnN0YXRlKCkgZHVyaW5nIHRoZSAkZGlnZXN0XG4gICAgLy8gc28gdGhlIG1vZGlmaWNhdGlvbiB3aW5kb3cgaXMgbmFycm93LlxuICAgIHRoaXMuJCRzdGF0ZSA9IGlzVW5kZWZpbmVkKHN0YXRlKSA/IG51bGwgOiBzdGF0ZTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xufSk7XG5cblxuZnVuY3Rpb24gbG9jYXRpb25HZXR0ZXIocHJvcGVydHkpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzW3Byb3BlcnR5XTtcbiAgfTtcbn1cblxuXG5mdW5jdGlvbiBsb2NhdGlvbkdldHRlclNldHRlcihwcm9wZXJ0eSwgcHJlcHJvY2Vzcykge1xuICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICBpZiAoaXNVbmRlZmluZWQodmFsdWUpKSB7XG4gICAgICByZXR1cm4gdGhpc1twcm9wZXJ0eV07XG4gICAgfVxuXG4gICAgdGhpc1twcm9wZXJ0eV0gPSBwcmVwcm9jZXNzKHZhbHVlKTtcbiAgICB0aGlzLiQkY29tcG9zZSgpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG59XG5cblxuLyoqXG4gKiBAbmdkb2Mgc2VydmljZVxuICogQG5hbWUgJGxvY2F0aW9uXG4gKlxuICogQHJlcXVpcmVzICRyb290RWxlbWVudFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlICRsb2NhdGlvbiBzZXJ2aWNlIHBhcnNlcyB0aGUgVVJMIGluIHRoZSBicm93c2VyIGFkZHJlc3MgYmFyIChiYXNlZCBvbiB0aGVcbiAqIFt3aW5kb3cubG9jYXRpb25dKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL3dpbmRvdy5sb2NhdGlvbikpIGFuZCBtYWtlcyB0aGUgVVJMXG4gKiBhdmFpbGFibGUgdG8geW91ciBhcHBsaWNhdGlvbi4gQ2hhbmdlcyB0byB0aGUgVVJMIGluIHRoZSBhZGRyZXNzIGJhciBhcmUgcmVmbGVjdGVkIGludG9cbiAqICRsb2NhdGlvbiBzZXJ2aWNlIGFuZCBjaGFuZ2VzIHRvICRsb2NhdGlvbiBhcmUgcmVmbGVjdGVkIGludG8gdGhlIGJyb3dzZXIgYWRkcmVzcyBiYXIuXG4gKlxuICogKipUaGUgJGxvY2F0aW9uIHNlcnZpY2U6KipcbiAqXG4gKiAtIEV4cG9zZXMgdGhlIGN1cnJlbnQgVVJMIGluIHRoZSBicm93c2VyIGFkZHJlc3MgYmFyLCBzbyB5b3UgY2FuXG4gKiAgIC0gV2F0Y2ggYW5kIG9ic2VydmUgdGhlIFVSTC5cbiAqICAgLSBDaGFuZ2UgdGhlIFVSTC5cbiAqIC0gU3luY2hyb25pemVzIHRoZSBVUkwgd2l0aCB0aGUgYnJvd3NlciB3aGVuIHRoZSB1c2VyXG4gKiAgIC0gQ2hhbmdlcyB0aGUgYWRkcmVzcyBiYXIuXG4gKiAgIC0gQ2xpY2tzIHRoZSBiYWNrIG9yIGZvcndhcmQgYnV0dG9uIChvciBjbGlja3MgYSBIaXN0b3J5IGxpbmspLlxuICogICAtIENsaWNrcyBvbiBhIGxpbmsuXG4gKiAtIFJlcHJlc2VudHMgdGhlIFVSTCBvYmplY3QgYXMgYSBzZXQgb2YgbWV0aG9kcyAocHJvdG9jb2wsIGhvc3QsIHBvcnQsIHBhdGgsIHNlYXJjaCwgaGFzaCkuXG4gKlxuICogRm9yIG1vcmUgaW5mb3JtYXRpb24gc2VlIHtAbGluayBndWlkZS8kbG9jYXRpb24gRGV2ZWxvcGVyIEd1aWRlOiBVc2luZyAkbG9jYXRpb259XG4gKi9cblxuLyoqXG4gKiBAbmdkb2MgcHJvdmlkZXJcbiAqIEBuYW1lICRsb2NhdGlvblByb3ZpZGVyXG4gKiBAZGVzY3JpcHRpb25cbiAqIFVzZSB0aGUgYCRsb2NhdGlvblByb3ZpZGVyYCB0byBjb25maWd1cmUgaG93IHRoZSBhcHBsaWNhdGlvbiBkZWVwIGxpbmtpbmcgcGF0aHMgYXJlIHN0b3JlZC5cbiAqL1xuZnVuY3Rpb24gJExvY2F0aW9uUHJvdmlkZXIoKSB7XG4gIHZhciBoYXNoUHJlZml4ID0gJycsXG4gICAgICBodG1sNU1vZGUgPSB7XG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICByZXF1aXJlQmFzZTogdHJ1ZSxcbiAgICAgICAgcmV3cml0ZUxpbmtzOiB0cnVlXG4gICAgICB9O1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRsb2NhdGlvblByb3ZpZGVyI2hhc2hQcmVmaXhcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gcHJlZml4IFByZWZpeCBmb3IgaGFzaCBwYXJ0IChjb250YWluaW5nIHBhdGggYW5kIHNlYXJjaClcbiAgICogQHJldHVybnMgeyp9IGN1cnJlbnQgdmFsdWUgaWYgdXNlZCBhcyBnZXR0ZXIgb3IgaXRzZWxmIChjaGFpbmluZykgaWYgdXNlZCBhcyBzZXR0ZXJcbiAgICovXG4gIHRoaXMuaGFzaFByZWZpeCA9IGZ1bmN0aW9uKHByZWZpeCkge1xuICAgIGlmIChpc0RlZmluZWQocHJlZml4KSkge1xuICAgICAgaGFzaFByZWZpeCA9IHByZWZpeDtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gaGFzaFByZWZpeDtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGxvY2F0aW9uUHJvdmlkZXIjaHRtbDVNb2RlXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBAcGFyYW0geyhib29sZWFufE9iamVjdCk9fSBtb2RlIElmIGJvb2xlYW4sIHNldHMgYGh0bWw1TW9kZS5lbmFibGVkYCB0byB2YWx1ZS5cbiAgICogICBJZiBvYmplY3QsIHNldHMgYGVuYWJsZWRgLCBgcmVxdWlyZUJhc2VgIGFuZCBgcmV3cml0ZUxpbmtzYCB0byByZXNwZWN0aXZlIHZhbHVlcy4gU3VwcG9ydGVkXG4gICAqICAgcHJvcGVydGllczpcbiAgICogICAtICoqZW5hYmxlZCoqIOKAkyBge2Jvb2xlYW59YCDigJMgKGRlZmF1bHQ6IGZhbHNlKSBJZiB0cnVlLCB3aWxsIHJlbHkgb24gYGhpc3RvcnkucHVzaFN0YXRlYCB0b1xuICAgKiAgICAgY2hhbmdlIHVybHMgd2hlcmUgc3VwcG9ydGVkLiBXaWxsIGZhbGwgYmFjayB0byBoYXNoLXByZWZpeGVkIHBhdGhzIGluIGJyb3dzZXJzIHRoYXQgZG8gbm90XG4gICAqICAgICBzdXBwb3J0IGBwdXNoU3RhdGVgLlxuICAgKiAgIC0gKipyZXF1aXJlQmFzZSoqIC0gYHtib29sZWFufWAgLSAoZGVmYXVsdDogYHRydWVgKSBXaGVuIGh0bWw1TW9kZSBpcyBlbmFibGVkLCBzcGVjaWZpZXNcbiAgICogICAgIHdoZXRoZXIgb3Igbm90IGEgPGJhc2U+IHRhZyBpcyByZXF1aXJlZCB0byBiZSBwcmVzZW50LiBJZiBgZW5hYmxlZGAgYW5kIGByZXF1aXJlQmFzZWAgYXJlXG4gICAqICAgICB0cnVlLCBhbmQgYSBiYXNlIHRhZyBpcyBub3QgcHJlc2VudCwgYW4gZXJyb3Igd2lsbCBiZSB0aHJvd24gd2hlbiBgJGxvY2F0aW9uYCBpcyBpbmplY3RlZC5cbiAgICogICAgIFNlZSB0aGUge0BsaW5rIGd1aWRlLyRsb2NhdGlvbiAkbG9jYXRpb24gZ3VpZGUgZm9yIG1vcmUgaW5mb3JtYXRpb259XG4gICAqICAgLSAqKnJld3JpdGVMaW5rcyoqIC0gYHtib29sZWFufWAgLSAoZGVmYXVsdDogYHRydWVgKSBXaGVuIGh0bWw1TW9kZSBpcyBlbmFibGVkLFxuICAgKiAgICAgZW5hYmxlcy9kaXNhYmxlcyB1cmwgcmV3cml0aW5nIGZvciByZWxhdGl2ZSBsaW5rcy5cbiAgICpcbiAgICogQHJldHVybnMge09iamVjdH0gaHRtbDVNb2RlIG9iamVjdCBpZiB1c2VkIGFzIGdldHRlciBvciBpdHNlbGYgKGNoYWluaW5nKSBpZiB1c2VkIGFzIHNldHRlclxuICAgKi9cbiAgdGhpcy5odG1sNU1vZGUgPSBmdW5jdGlvbihtb2RlKSB7XG4gICAgaWYgKGlzQm9vbGVhbihtb2RlKSkge1xuICAgICAgaHRtbDVNb2RlLmVuYWJsZWQgPSBtb2RlO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSBlbHNlIGlmIChpc09iamVjdChtb2RlKSkge1xuXG4gICAgICBpZiAoaXNCb29sZWFuKG1vZGUuZW5hYmxlZCkpIHtcbiAgICAgICAgaHRtbDVNb2RlLmVuYWJsZWQgPSBtb2RlLmVuYWJsZWQ7XG4gICAgICB9XG5cbiAgICAgIGlmIChpc0Jvb2xlYW4obW9kZS5yZXF1aXJlQmFzZSkpIHtcbiAgICAgICAgaHRtbDVNb2RlLnJlcXVpcmVCYXNlID0gbW9kZS5yZXF1aXJlQmFzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGlzQm9vbGVhbihtb2RlLnJld3JpdGVMaW5rcykpIHtcbiAgICAgICAgaHRtbDVNb2RlLnJld3JpdGVMaW5rcyA9IG1vZGUucmV3cml0ZUxpbmtzO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGh0bWw1TW9kZTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBldmVudFxuICAgKiBAbmFtZSAkbG9jYXRpb24jJGxvY2F0aW9uQ2hhbmdlU3RhcnRcbiAgICogQGV2ZW50VHlwZSBicm9hZGNhc3Qgb24gcm9vdCBzY29wZVxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogQnJvYWRjYXN0ZWQgYmVmb3JlIGEgVVJMIHdpbGwgY2hhbmdlLlxuICAgKlxuICAgKiBUaGlzIGNoYW5nZSBjYW4gYmUgcHJldmVudGVkIGJ5IGNhbGxpbmdcbiAgICogYHByZXZlbnREZWZhdWx0YCBtZXRob2Qgb2YgdGhlIGV2ZW50LiBTZWUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJG9ufSBmb3IgbW9yZVxuICAgKiBkZXRhaWxzIGFib3V0IGV2ZW50IG9iamVjdC4gVXBvbiBzdWNjZXNzZnVsIGNoYW5nZVxuICAgKiB7QGxpbmsgbmcuJGxvY2F0aW9uIyRsb2NhdGlvbkNoYW5nZVN1Y2Nlc3MgJGxvY2F0aW9uQ2hhbmdlU3VjY2Vzc30gaXMgZmlyZWQuXG4gICAqXG4gICAqIFRoZSBgbmV3U3RhdGVgIGFuZCBgb2xkU3RhdGVgIHBhcmFtZXRlcnMgbWF5IGJlIGRlZmluZWQgb25seSBpbiBIVE1MNSBtb2RlIGFuZCB3aGVuXG4gICAqIHRoZSBicm93c2VyIHN1cHBvcnRzIHRoZSBIVE1MNSBIaXN0b3J5IEFQSS5cbiAgICpcbiAgICogQHBhcmFtIHtPYmplY3R9IGFuZ3VsYXJFdmVudCBTeW50aGV0aWMgZXZlbnQgb2JqZWN0LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmV3VXJsIE5ldyBVUkxcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvbGRVcmwgVVJMIHRoYXQgd2FzIGJlZm9yZSBpdCB3YXMgY2hhbmdlZC5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBuZXdTdGF0ZSBOZXcgaGlzdG9yeSBzdGF0ZSBvYmplY3RcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvbGRTdGF0ZSBIaXN0b3J5IHN0YXRlIG9iamVjdCB0aGF0IHdhcyBiZWZvcmUgaXQgd2FzIGNoYW5nZWQuXG4gICAqL1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgZXZlbnRcbiAgICogQG5hbWUgJGxvY2F0aW9uIyRsb2NhdGlvbkNoYW5nZVN1Y2Nlc3NcbiAgICogQGV2ZW50VHlwZSBicm9hZGNhc3Qgb24gcm9vdCBzY29wZVxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogQnJvYWRjYXN0ZWQgYWZ0ZXIgYSBVUkwgd2FzIGNoYW5nZWQuXG4gICAqXG4gICAqIFRoZSBgbmV3U3RhdGVgIGFuZCBgb2xkU3RhdGVgIHBhcmFtZXRlcnMgbWF5IGJlIGRlZmluZWQgb25seSBpbiBIVE1MNSBtb2RlIGFuZCB3aGVuXG4gICAqIHRoZSBicm93c2VyIHN1cHBvcnRzIHRoZSBIVE1MNSBIaXN0b3J5IEFQSS5cbiAgICpcbiAgICogQHBhcmFtIHtPYmplY3R9IGFuZ3VsYXJFdmVudCBTeW50aGV0aWMgZXZlbnQgb2JqZWN0LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmV3VXJsIE5ldyBVUkxcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvbGRVcmwgVVJMIHRoYXQgd2FzIGJlZm9yZSBpdCB3YXMgY2hhbmdlZC5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBuZXdTdGF0ZSBOZXcgaGlzdG9yeSBzdGF0ZSBvYmplY3RcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvbGRTdGF0ZSBIaXN0b3J5IHN0YXRlIG9iamVjdCB0aGF0IHdhcyBiZWZvcmUgaXQgd2FzIGNoYW5nZWQuXG4gICAqL1xuXG4gIHRoaXMuJGdldCA9IFsnJHJvb3RTY29wZScsICckYnJvd3NlcicsICckc25pZmZlcicsICckcm9vdEVsZW1lbnQnLCAnJHdpbmRvdycsXG4gICAgICBmdW5jdGlvbigkcm9vdFNjb3BlLCAkYnJvd3NlciwgJHNuaWZmZXIsICRyb290RWxlbWVudCwgJHdpbmRvdykge1xuICAgIHZhciAkbG9jYXRpb24sXG4gICAgICAgIExvY2F0aW9uTW9kZSxcbiAgICAgICAgYmFzZUhyZWYgPSAkYnJvd3Nlci5iYXNlSHJlZigpLCAvLyBpZiBiYXNlW2hyZWZdIGlzIHVuZGVmaW5lZCwgaXQgZGVmYXVsdHMgdG8gJydcbiAgICAgICAgaW5pdGlhbFVybCA9ICRicm93c2VyLnVybCgpLFxuICAgICAgICBhcHBCYXNlO1xuXG4gICAgaWYgKGh0bWw1TW9kZS5lbmFibGVkKSB7XG4gICAgICBpZiAoIWJhc2VIcmVmICYmIGh0bWw1TW9kZS5yZXF1aXJlQmFzZSkge1xuICAgICAgICB0aHJvdyAkbG9jYXRpb25NaW5FcnIoJ25vYmFzZScsXG4gICAgICAgICAgXCIkbG9jYXRpb24gaW4gSFRNTDUgbW9kZSByZXF1aXJlcyBhIDxiYXNlPiB0YWcgdG8gYmUgcHJlc2VudCFcIik7XG4gICAgICB9XG4gICAgICBhcHBCYXNlID0gc2VydmVyQmFzZShpbml0aWFsVXJsKSArIChiYXNlSHJlZiB8fCAnLycpO1xuICAgICAgTG9jYXRpb25Nb2RlID0gJHNuaWZmZXIuaGlzdG9yeSA/IExvY2F0aW9uSHRtbDVVcmwgOiBMb2NhdGlvbkhhc2hiYW5nSW5IdG1sNVVybDtcbiAgICB9IGVsc2Uge1xuICAgICAgYXBwQmFzZSA9IHN0cmlwSGFzaChpbml0aWFsVXJsKTtcbiAgICAgIExvY2F0aW9uTW9kZSA9IExvY2F0aW9uSGFzaGJhbmdVcmw7XG4gICAgfVxuICAgIHZhciBhcHBCYXNlTm9GaWxlID0gc3RyaXBGaWxlKGFwcEJhc2UpO1xuXG4gICAgJGxvY2F0aW9uID0gbmV3IExvY2F0aW9uTW9kZShhcHBCYXNlLCBhcHBCYXNlTm9GaWxlLCAnIycgKyBoYXNoUHJlZml4KTtcbiAgICAkbG9jYXRpb24uJCRwYXJzZUxpbmtVcmwoaW5pdGlhbFVybCwgaW5pdGlhbFVybCk7XG5cbiAgICAkbG9jYXRpb24uJCRzdGF0ZSA9ICRicm93c2VyLnN0YXRlKCk7XG5cbiAgICB2YXIgSUdOT1JFX1VSSV9SRUdFWFAgPSAvXlxccyooamF2YXNjcmlwdHxtYWlsdG8pOi9pO1xuXG4gICAgZnVuY3Rpb24gc2V0QnJvd3NlclVybFdpdGhGYWxsYmFjayh1cmwsIHJlcGxhY2UsIHN0YXRlKSB7XG4gICAgICB2YXIgb2xkVXJsID0gJGxvY2F0aW9uLnVybCgpO1xuICAgICAgdmFyIG9sZFN0YXRlID0gJGxvY2F0aW9uLiQkc3RhdGU7XG4gICAgICB0cnkge1xuICAgICAgICAkYnJvd3Nlci51cmwodXJsLCByZXBsYWNlLCBzdGF0ZSk7XG5cbiAgICAgICAgLy8gTWFrZSBzdXJlICRsb2NhdGlvbi5zdGF0ZSgpIHJldHVybnMgcmVmZXJlbnRpYWxseSBpZGVudGljYWwgKG5vdCBqdXN0IGRlZXBseSBlcXVhbClcbiAgICAgICAgLy8gc3RhdGUgb2JqZWN0OyB0aGlzIG1ha2VzIHBvc3NpYmxlIHF1aWNrIGNoZWNraW5nIGlmIHRoZSBzdGF0ZSBjaGFuZ2VkIGluIHRoZSBkaWdlc3RcbiAgICAgICAgLy8gbG9vcC4gQ2hlY2tpbmcgZGVlcCBlcXVhbGl0eSB3b3VsZCBiZSB0b28gZXhwZW5zaXZlLlxuICAgICAgICAkbG9jYXRpb24uJCRzdGF0ZSA9ICRicm93c2VyLnN0YXRlKCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vIFJlc3RvcmUgb2xkIHZhbHVlcyBpZiBwdXNoU3RhdGUgZmFpbHNcbiAgICAgICAgJGxvY2F0aW9uLnVybChvbGRVcmwpO1xuICAgICAgICAkbG9jYXRpb24uJCRzdGF0ZSA9IG9sZFN0YXRlO1xuXG4gICAgICAgIHRocm93IGU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgJHJvb3RFbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAvLyBUT0RPKHZvanRhKTogcmV3cml0ZSBsaW5rIHdoZW4gb3BlbmluZyBpbiBuZXcgdGFiL3dpbmRvdyAoaW4gbGVnYWN5IGJyb3dzZXIpXG4gICAgICAvLyBjdXJyZW50bHkgd2Ugb3BlbiBuaWNlIHVybCBsaW5rIGFuZCByZWRpcmVjdCB0aGVuXG5cbiAgICAgIGlmICghaHRtbDVNb2RlLnJld3JpdGVMaW5rcyB8fCBldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkgfHwgZXZlbnQuc2hpZnRLZXkgfHwgZXZlbnQud2hpY2ggPT0gMiB8fCBldmVudC5idXR0b24gPT0gMikgcmV0dXJuO1xuXG4gICAgICB2YXIgZWxtID0ganFMaXRlKGV2ZW50LnRhcmdldCk7XG5cbiAgICAgIC8vIHRyYXZlcnNlIHRoZSBET00gdXAgdG8gZmluZCBmaXJzdCBBIHRhZ1xuICAgICAgd2hpbGUgKG5vZGVOYW1lXyhlbG1bMF0pICE9PSAnYScpIHtcbiAgICAgICAgLy8gaWdub3JlIHJld3JpdGluZyBpZiBubyBBIHRhZyAocmVhY2hlZCByb290IGVsZW1lbnQsIG9yIG5vIHBhcmVudCAtIHJlbW92ZWQgZnJvbSBkb2N1bWVudClcbiAgICAgICAgaWYgKGVsbVswXSA9PT0gJHJvb3RFbGVtZW50WzBdIHx8ICEoZWxtID0gZWxtLnBhcmVudCgpKVswXSkgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgYWJzSHJlZiA9IGVsbS5wcm9wKCdocmVmJyk7XG4gICAgICAvLyBnZXQgdGhlIGFjdHVhbCBocmVmIGF0dHJpYnV0ZSAtIHNlZVxuICAgICAgLy8gaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2llL2RkMzQ3MTQ4KHY9dnMuODUpLmFzcHhcbiAgICAgIHZhciByZWxIcmVmID0gZWxtLmF0dHIoJ2hyZWYnKSB8fCBlbG0uYXR0cigneGxpbms6aHJlZicpO1xuXG4gICAgICBpZiAoaXNPYmplY3QoYWJzSHJlZikgJiYgYWJzSHJlZi50b1N0cmluZygpID09PSAnW29iamVjdCBTVkdBbmltYXRlZFN0cmluZ10nKSB7XG4gICAgICAgIC8vIFNWR0FuaW1hdGVkU3RyaW5nLmFuaW1WYWwgc2hvdWxkIGJlIGlkZW50aWNhbCB0byBTVkdBbmltYXRlZFN0cmluZy5iYXNlVmFsLCB1bmxlc3MgZHVyaW5nXG4gICAgICAgIC8vIGFuIGFuaW1hdGlvbi5cbiAgICAgICAgYWJzSHJlZiA9IHVybFJlc29sdmUoYWJzSHJlZi5hbmltVmFsKS5ocmVmO1xuICAgICAgfVxuXG4gICAgICAvLyBJZ25vcmUgd2hlbiB1cmwgaXMgc3RhcnRlZCB3aXRoIGphdmFzY3JpcHQ6IG9yIG1haWx0bzpcbiAgICAgIGlmIChJR05PUkVfVVJJX1JFR0VYUC50ZXN0KGFic0hyZWYpKSByZXR1cm47XG5cbiAgICAgIGlmIChhYnNIcmVmICYmICFlbG0uYXR0cigndGFyZ2V0JykgJiYgIWV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpKSB7XG4gICAgICAgIGlmICgkbG9jYXRpb24uJCRwYXJzZUxpbmtVcmwoYWJzSHJlZiwgcmVsSHJlZikpIHtcbiAgICAgICAgICAvLyBXZSBkbyBhIHByZXZlbnREZWZhdWx0IGZvciBhbGwgdXJscyB0aGF0IGFyZSBwYXJ0IG9mIHRoZSBhbmd1bGFyIGFwcGxpY2F0aW9uLFxuICAgICAgICAgIC8vIGluIGh0bWw1bW9kZSBhbmQgYWxzbyB3aXRob3V0LCBzbyB0aGF0IHdlIGFyZSBhYmxlIHRvIGFib3J0IG5hdmlnYXRpb24gd2l0aG91dFxuICAgICAgICAgIC8vIGdldHRpbmcgZG91YmxlIGVudHJpZXMgaW4gdGhlIGxvY2F0aW9uIGhpc3RvcnkuXG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAvLyB1cGRhdGUgbG9jYXRpb24gbWFudWFsbHlcbiAgICAgICAgICBpZiAoJGxvY2F0aW9uLmFic1VybCgpICE9ICRicm93c2VyLnVybCgpKSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRhcHBseSgpO1xuICAgICAgICAgICAgLy8gaGFjayB0byB3b3JrIGFyb3VuZCBGRjYgYnVnIDY4NDIwOCB3aGVuIHNjZW5hcmlvIHJ1bm5lciBjbGlja3Mgb24gbGlua3NcbiAgICAgICAgICAgICR3aW5kb3cuYW5ndWxhclsnZmYtNjg0MjA4LXByZXZlbnREZWZhdWx0J10gPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG5cbiAgICAvLyByZXdyaXRlIGhhc2hiYW5nIHVybCA8PiBodG1sNSB1cmxcbiAgICBpZiAodHJpbUVtcHR5SGFzaCgkbG9jYXRpb24uYWJzVXJsKCkpICE9IHRyaW1FbXB0eUhhc2goaW5pdGlhbFVybCkpIHtcbiAgICAgICRicm93c2VyLnVybCgkbG9jYXRpb24uYWJzVXJsKCksIHRydWUpO1xuICAgIH1cblxuICAgIHZhciBpbml0aWFsaXppbmcgPSB0cnVlO1xuXG4gICAgLy8gdXBkYXRlICRsb2NhdGlvbiB3aGVuICRicm93c2VyIHVybCBjaGFuZ2VzXG4gICAgJGJyb3dzZXIub25VcmxDaGFuZ2UoZnVuY3Rpb24obmV3VXJsLCBuZXdTdGF0ZSkge1xuXG4gICAgICBpZiAoaXNVbmRlZmluZWQoYmVnaW5zV2l0aChhcHBCYXNlTm9GaWxlLCBuZXdVcmwpKSkge1xuICAgICAgICAvLyBJZiB3ZSBhcmUgbmF2aWdhdGluZyBvdXRzaWRlIG9mIHRoZSBhcHAgdGhlbiBmb3JjZSBhIHJlbG9hZFxuICAgICAgICAkd2luZG93LmxvY2F0aW9uLmhyZWYgPSBuZXdVcmw7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgJHJvb3RTY29wZS4kZXZhbEFzeW5jKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2xkVXJsID0gJGxvY2F0aW9uLmFic1VybCgpO1xuICAgICAgICB2YXIgb2xkU3RhdGUgPSAkbG9jYXRpb24uJCRzdGF0ZTtcbiAgICAgICAgdmFyIGRlZmF1bHRQcmV2ZW50ZWQ7XG4gICAgICAgIG5ld1VybCA9IHRyaW1FbXB0eUhhc2gobmV3VXJsKTtcbiAgICAgICAgJGxvY2F0aW9uLiQkcGFyc2UobmV3VXJsKTtcbiAgICAgICAgJGxvY2F0aW9uLiQkc3RhdGUgPSBuZXdTdGF0ZTtcblxuICAgICAgICBkZWZhdWx0UHJldmVudGVkID0gJHJvb3RTY29wZS4kYnJvYWRjYXN0KCckbG9jYXRpb25DaGFuZ2VTdGFydCcsIG5ld1VybCwgb2xkVXJsLFxuICAgICAgICAgICAgbmV3U3RhdGUsIG9sZFN0YXRlKS5kZWZhdWx0UHJldmVudGVkO1xuXG4gICAgICAgIC8vIGlmIHRoZSBsb2NhdGlvbiB3YXMgY2hhbmdlZCBieSBhIGAkbG9jYXRpb25DaGFuZ2VTdGFydGAgaGFuZGxlciB0aGVuIHN0b3BcbiAgICAgICAgLy8gcHJvY2Vzc2luZyB0aGlzIGxvY2F0aW9uIGNoYW5nZVxuICAgICAgICBpZiAoJGxvY2F0aW9uLmFic1VybCgpICE9PSBuZXdVcmwpIHJldHVybjtcblxuICAgICAgICBpZiAoZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgICAgICRsb2NhdGlvbi4kJHBhcnNlKG9sZFVybCk7XG4gICAgICAgICAgJGxvY2F0aW9uLiQkc3RhdGUgPSBvbGRTdGF0ZTtcbiAgICAgICAgICBzZXRCcm93c2VyVXJsV2l0aEZhbGxiYWNrKG9sZFVybCwgZmFsc2UsIG9sZFN0YXRlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpbml0aWFsaXppbmcgPSBmYWxzZTtcbiAgICAgICAgICBhZnRlckxvY2F0aW9uQ2hhbmdlKG9sZFVybCwgb2xkU3RhdGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmICghJHJvb3RTY29wZS4kJHBoYXNlKSAkcm9vdFNjb3BlLiRkaWdlc3QoKTtcbiAgICB9KTtcblxuICAgIC8vIHVwZGF0ZSBicm93c2VyXG4gICAgJHJvb3RTY29wZS4kd2F0Y2goZnVuY3Rpb24gJGxvY2F0aW9uV2F0Y2goKSB7XG4gICAgICB2YXIgb2xkVXJsID0gdHJpbUVtcHR5SGFzaCgkYnJvd3Nlci51cmwoKSk7XG4gICAgICB2YXIgbmV3VXJsID0gdHJpbUVtcHR5SGFzaCgkbG9jYXRpb24uYWJzVXJsKCkpO1xuICAgICAgdmFyIG9sZFN0YXRlID0gJGJyb3dzZXIuc3RhdGUoKTtcbiAgICAgIHZhciBjdXJyZW50UmVwbGFjZSA9ICRsb2NhdGlvbi4kJHJlcGxhY2U7XG4gICAgICB2YXIgdXJsT3JTdGF0ZUNoYW5nZWQgPSBvbGRVcmwgIT09IG5ld1VybCB8fFxuICAgICAgICAoJGxvY2F0aW9uLiQkaHRtbDUgJiYgJHNuaWZmZXIuaGlzdG9yeSAmJiBvbGRTdGF0ZSAhPT0gJGxvY2F0aW9uLiQkc3RhdGUpO1xuXG4gICAgICBpZiAoaW5pdGlhbGl6aW5nIHx8IHVybE9yU3RhdGVDaGFuZ2VkKSB7XG4gICAgICAgIGluaXRpYWxpemluZyA9IGZhbHNlO1xuXG4gICAgICAgICRyb290U2NvcGUuJGV2YWxBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgbmV3VXJsID0gJGxvY2F0aW9uLmFic1VybCgpO1xuICAgICAgICAgIHZhciBkZWZhdWx0UHJldmVudGVkID0gJHJvb3RTY29wZS4kYnJvYWRjYXN0KCckbG9jYXRpb25DaGFuZ2VTdGFydCcsIG5ld1VybCwgb2xkVXJsLFxuICAgICAgICAgICAgICAkbG9jYXRpb24uJCRzdGF0ZSwgb2xkU3RhdGUpLmRlZmF1bHRQcmV2ZW50ZWQ7XG5cbiAgICAgICAgICAvLyBpZiB0aGUgbG9jYXRpb24gd2FzIGNoYW5nZWQgYnkgYSBgJGxvY2F0aW9uQ2hhbmdlU3RhcnRgIGhhbmRsZXIgdGhlbiBzdG9wXG4gICAgICAgICAgLy8gcHJvY2Vzc2luZyB0aGlzIGxvY2F0aW9uIGNoYW5nZVxuICAgICAgICAgIGlmICgkbG9jYXRpb24uYWJzVXJsKCkgIT09IG5ld1VybCkgcmV0dXJuO1xuXG4gICAgICAgICAgaWYgKGRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi4kJHBhcnNlKG9sZFVybCk7XG4gICAgICAgICAgICAkbG9jYXRpb24uJCRzdGF0ZSA9IG9sZFN0YXRlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodXJsT3JTdGF0ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgc2V0QnJvd3NlclVybFdpdGhGYWxsYmFjayhuZXdVcmwsIGN1cnJlbnRSZXBsYWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZFN0YXRlID09PSAkbG9jYXRpb24uJCRzdGF0ZSA/IG51bGwgOiAkbG9jYXRpb24uJCRzdGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZnRlckxvY2F0aW9uQ2hhbmdlKG9sZFVybCwgb2xkU3RhdGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgICRsb2NhdGlvbi4kJHJlcGxhY2UgPSBmYWxzZTtcblxuICAgICAgLy8gd2UgZG9uJ3QgbmVlZCB0byByZXR1cm4gYW55dGhpbmcgYmVjYXVzZSAkZXZhbEFzeW5jIHdpbGwgbWFrZSB0aGUgZGlnZXN0IGxvb3AgZGlydHkgd2hlblxuICAgICAgLy8gdGhlcmUgaXMgYSBjaGFuZ2VcbiAgICB9KTtcblxuICAgIHJldHVybiAkbG9jYXRpb247XG5cbiAgICBmdW5jdGlvbiBhZnRlckxvY2F0aW9uQ2hhbmdlKG9sZFVybCwgb2xkU3RhdGUpIHtcbiAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnJGxvY2F0aW9uQ2hhbmdlU3VjY2VzcycsICRsb2NhdGlvbi5hYnNVcmwoKSwgb2xkVXJsLFxuICAgICAgICAkbG9jYXRpb24uJCRzdGF0ZSwgb2xkU3RhdGUpO1xuICAgIH1cbn1dO1xufVxuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkbG9nXG4gKiBAcmVxdWlyZXMgJHdpbmRvd1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogU2ltcGxlIHNlcnZpY2UgZm9yIGxvZ2dpbmcuIERlZmF1bHQgaW1wbGVtZW50YXRpb24gc2FmZWx5IHdyaXRlcyB0aGUgbWVzc2FnZVxuICogaW50byB0aGUgYnJvd3NlcidzIGNvbnNvbGUgKGlmIHByZXNlbnQpLlxuICpcbiAqIFRoZSBtYWluIHB1cnBvc2Ugb2YgdGhpcyBzZXJ2aWNlIGlzIHRvIHNpbXBsaWZ5IGRlYnVnZ2luZyBhbmQgdHJvdWJsZXNob290aW5nLlxuICpcbiAqIFRoZSBkZWZhdWx0IGlzIHRvIGxvZyBgZGVidWdgIG1lc3NhZ2VzLiBZb3UgY2FuIHVzZVxuICoge0BsaW5rIG5nLiRsb2dQcm92aWRlciBuZy4kbG9nUHJvdmlkZXIjZGVidWdFbmFibGVkfSB0byBjaGFuZ2UgdGhpcy5cbiAqXG4gKiBAZXhhbXBsZVxuICAgPGV4YW1wbGUgbW9kdWxlPVwibG9nRXhhbXBsZVwiPlxuICAgICA8ZmlsZSBuYW1lPVwic2NyaXB0LmpzXCI+XG4gICAgICAgYW5ndWxhci5tb2R1bGUoJ2xvZ0V4YW1wbGUnLCBbXSlcbiAgICAgICAgIC5jb250cm9sbGVyKCdMb2dDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGxvZycsIGZ1bmN0aW9uKCRzY29wZSwgJGxvZykge1xuICAgICAgICAgICAkc2NvcGUuJGxvZyA9ICRsb2c7XG4gICAgICAgICAgICRzY29wZS5tZXNzYWdlID0gJ0hlbGxvIFdvcmxkISc7XG4gICAgICAgICB9XSk7XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJMb2dDb250cm9sbGVyXCI+XG4gICAgICAgICA8cD5SZWxvYWQgdGhpcyBwYWdlIHdpdGggb3BlbiBjb25zb2xlLCBlbnRlciB0ZXh0IGFuZCBoaXQgdGhlIGxvZyBidXR0b24uLi48L3A+XG4gICAgICAgICA8bGFiZWw+TWVzc2FnZTpcbiAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwibWVzc2FnZVwiIC8+PC9sYWJlbD5cbiAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCIkbG9nLmxvZyhtZXNzYWdlKVwiPmxvZzwvYnV0dG9uPlxuICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cIiRsb2cud2FybihtZXNzYWdlKVwiPndhcm48L2J1dHRvbj5cbiAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCIkbG9nLmluZm8obWVzc2FnZSlcIj5pbmZvPC9idXR0b24+XG4gICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwiJGxvZy5lcnJvcihtZXNzYWdlKVwiPmVycm9yPC9idXR0b24+XG4gICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwiJGxvZy5kZWJ1ZyhtZXNzYWdlKVwiPmRlYnVnPC9idXR0b24+XG4gICAgICAgPC9kaXY+XG4gICAgIDwvZmlsZT5cbiAgIDwvZXhhbXBsZT5cbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBwcm92aWRlclxuICogQG5hbWUgJGxvZ1Byb3ZpZGVyXG4gKiBAZGVzY3JpcHRpb25cbiAqIFVzZSB0aGUgYCRsb2dQcm92aWRlcmAgdG8gY29uZmlndXJlIGhvdyB0aGUgYXBwbGljYXRpb24gbG9ncyBtZXNzYWdlc1xuICovXG5mdW5jdGlvbiAkTG9nUHJvdmlkZXIoKSB7XG4gIHZhciBkZWJ1ZyA9IHRydWUsXG4gICAgICBzZWxmID0gdGhpcztcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkbG9nUHJvdmlkZXIjZGVidWdFbmFibGVkXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBmbGFnIGVuYWJsZSBvciBkaXNhYmxlIGRlYnVnIGxldmVsIG1lc3NhZ2VzXG4gICAqIEByZXR1cm5zIHsqfSBjdXJyZW50IHZhbHVlIGlmIHVzZWQgYXMgZ2V0dGVyIG9yIGl0c2VsZiAoY2hhaW5pbmcpIGlmIHVzZWQgYXMgc2V0dGVyXG4gICAqL1xuICB0aGlzLmRlYnVnRW5hYmxlZCA9IGZ1bmN0aW9uKGZsYWcpIHtcbiAgICBpZiAoaXNEZWZpbmVkKGZsYWcpKSB7XG4gICAgICBkZWJ1ZyA9IGZsYWc7XG4gICAgcmV0dXJuIHRoaXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBkZWJ1ZztcbiAgICB9XG4gIH07XG5cbiAgdGhpcy4kZ2V0ID0gWyckd2luZG93JywgZnVuY3Rpb24oJHdpbmRvdykge1xuICAgIHJldHVybiB7XG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRsb2cjbG9nXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBXcml0ZSBhIGxvZyBtZXNzYWdlXG4gICAgICAgKi9cbiAgICAgIGxvZzogY29uc29sZUxvZygnbG9nJyksXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJGxvZyNpbmZvXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBXcml0ZSBhbiBpbmZvcm1hdGlvbiBtZXNzYWdlXG4gICAgICAgKi9cbiAgICAgIGluZm86IGNvbnNvbGVMb2coJ2luZm8nKSxcblxuICAgICAgLyoqXG4gICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgKiBAbmFtZSAkbG9nI3dhcm5cbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIFdyaXRlIGEgd2FybmluZyBtZXNzYWdlXG4gICAgICAgKi9cbiAgICAgIHdhcm46IGNvbnNvbGVMb2coJ3dhcm4nKSxcblxuICAgICAgLyoqXG4gICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgKiBAbmFtZSAkbG9nI2Vycm9yXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBXcml0ZSBhbiBlcnJvciBtZXNzYWdlXG4gICAgICAgKi9cbiAgICAgIGVycm9yOiBjb25zb2xlTG9nKCdlcnJvcicpLFxuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRsb2cjZGVidWdcbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIFdyaXRlIGEgZGVidWcgbWVzc2FnZVxuICAgICAgICovXG4gICAgICBkZWJ1ZzogKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZm4gPSBjb25zb2xlTG9nKCdkZWJ1ZycpO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoZGVidWcpIHtcbiAgICAgICAgICAgIGZuLmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSgpKVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBmb3JtYXRFcnJvcihhcmcpIHtcbiAgICAgIGlmIChhcmcgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICBpZiAoYXJnLnN0YWNrKSB7XG4gICAgICAgICAgYXJnID0gKGFyZy5tZXNzYWdlICYmIGFyZy5zdGFjay5pbmRleE9mKGFyZy5tZXNzYWdlKSA9PT0gLTEpXG4gICAgICAgICAgICAgID8gJ0Vycm9yOiAnICsgYXJnLm1lc3NhZ2UgKyAnXFxuJyArIGFyZy5zdGFja1xuICAgICAgICAgICAgICA6IGFyZy5zdGFjaztcbiAgICAgICAgfSBlbHNlIGlmIChhcmcuc291cmNlVVJMKSB7XG4gICAgICAgICAgYXJnID0gYXJnLm1lc3NhZ2UgKyAnXFxuJyArIGFyZy5zb3VyY2VVUkwgKyAnOicgKyBhcmcubGluZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGFyZztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb25zb2xlTG9nKHR5cGUpIHtcbiAgICAgIHZhciBjb25zb2xlID0gJHdpbmRvdy5jb25zb2xlIHx8IHt9LFxuICAgICAgICAgIGxvZ0ZuID0gY29uc29sZVt0eXBlXSB8fCBjb25zb2xlLmxvZyB8fCBub29wLFxuICAgICAgICAgIGhhc0FwcGx5ID0gZmFsc2U7XG5cbiAgICAgIC8vIE5vdGU6IHJlYWRpbmcgbG9nRm4uYXBwbHkgdGhyb3dzIGFuIGVycm9yIGluIElFMTEgaW4gSUU4IGRvY3VtZW50IG1vZGUuXG4gICAgICAvLyBUaGUgcmVhc29uIGJlaGluZCB0aGlzIGlzIHRoYXQgY29uc29sZS5sb2cgaGFzIHR5cGUgXCJvYmplY3RcIiBpbiBJRTguLi5cbiAgICAgIHRyeSB7XG4gICAgICAgIGhhc0FwcGx5ID0gISFsb2dGbi5hcHBseTtcbiAgICAgIH0gY2F0Y2ggKGUpIHt9XG5cbiAgICAgIGlmIChoYXNBcHBseSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICBmb3JFYWNoKGFyZ3VtZW50cywgZnVuY3Rpb24oYXJnKSB7XG4gICAgICAgICAgICBhcmdzLnB1c2goZm9ybWF0RXJyb3IoYXJnKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGxvZ0ZuLmFwcGx5KGNvbnNvbGUsIGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyB3ZSBhcmUgSUUgd2hpY2ggZWl0aGVyIGRvZXNuJ3QgaGF2ZSB3aW5kb3cuY29uc29sZSA9PiB0aGlzIGlzIG5vb3AgYW5kIHdlIGRvIG5vdGhpbmcsXG4gICAgICAvLyBvciB3ZSBhcmUgSUUgd2hlcmUgY29uc29sZS5sb2cgZG9lc24ndCBoYXZlIGFwcGx5IHNvIHdlIGxvZyBhdCBsZWFzdCBmaXJzdCAyIGFyZ3NcbiAgICAgIHJldHVybiBmdW5jdGlvbihhcmcxLCBhcmcyKSB7XG4gICAgICAgIGxvZ0ZuKGFyZzEsIGFyZzIgPT0gbnVsbCA/ICcnIDogYXJnMik7XG4gICAgICB9O1xuICAgIH1cbiAgfV07XG59XG5cbi8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICpcbiAqICAgICBBbnkgY29tbWl0cyB0byB0aGlzIGZpbGUgc2hvdWxkIGJlIHJldmlld2VkIHdpdGggc2VjdXJpdHkgaW4gbWluZC4gICpcbiAqICAgQ2hhbmdlcyB0byB0aGlzIGZpbGUgY2FuIHBvdGVudGlhbGx5IGNyZWF0ZSBzZWN1cml0eSB2dWxuZXJhYmlsaXRpZXMuICpcbiAqICAgICAgICAgIEFuIGFwcHJvdmFsIGZyb20gMiBDb3JlIG1lbWJlcnMgd2l0aCBoaXN0b3J5IG9mIG1vZGlmeWluZyAgICAgICpcbiAqICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMgZmlsZSBpcyByZXF1aXJlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAqICBEb2VzIHRoZSBjaGFuZ2Ugc29tZWhvdyBhbGxvdyBmb3IgYXJiaXRyYXJ5IGphdmFzY3JpcHQgdG8gYmUgZXhlY3V0ZWQ/ICpcbiAqICAgIE9yIGFsbG93cyBmb3Igc29tZW9uZSB0byBjaGFuZ2UgdGhlIHByb3RvdHlwZSBvZiBidWlsdC1pbiBvYmplY3RzPyAgICpcbiAqICAgICBPciBnaXZlcyB1bmRlc2lyZWQgYWNjZXNzIHRvIHZhcmlhYmxlcyBsaWtlcyBkb2N1bWVudCBvciB3aW5kb3c/ICAgICpcbiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovXG5cbnZhciAkcGFyc2VNaW5FcnIgPSBtaW5FcnIoJyRwYXJzZScpO1xuXG4vLyBTYW5kYm94aW5nIEFuZ3VsYXIgRXhwcmVzc2lvbnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gQW5ndWxhciBleHByZXNzaW9ucyBhcmUgZ2VuZXJhbGx5IGNvbnNpZGVyZWQgc2FmZSBiZWNhdXNlIHRoZXNlIGV4cHJlc3Npb25zIG9ubHkgaGF2ZSBkaXJlY3Rcbi8vIGFjY2VzcyB0byBgJHNjb3BlYCBhbmQgbG9jYWxzLiBIb3dldmVyLCBvbmUgY2FuIG9idGFpbiB0aGUgYWJpbGl0eSB0byBleGVjdXRlIGFyYml0cmFyeSBKUyBjb2RlIGJ5XG4vLyBvYnRhaW5pbmcgYSByZWZlcmVuY2UgdG8gbmF0aXZlIEpTIGZ1bmN0aW9ucyBzdWNoIGFzIHRoZSBGdW5jdGlvbiBjb25zdHJ1Y3Rvci5cbi8vXG4vLyBBcyBhbiBleGFtcGxlLCBjb25zaWRlciB0aGUgZm9sbG93aW5nIEFuZ3VsYXIgZXhwcmVzc2lvbjpcbi8vXG4vLyAgIHt9LnRvU3RyaW5nLmNvbnN0cnVjdG9yKCdhbGVydChcImV2aWwgSlMgY29kZVwiKScpXG4vL1xuLy8gVGhpcyBzYW5kYm94aW5nIHRlY2huaXF1ZSBpcyBub3QgcGVyZmVjdCBhbmQgZG9lc24ndCBhaW0gdG8gYmUuIFRoZSBnb2FsIGlzIHRvIHByZXZlbnQgZXhwbG9pdHNcbi8vIGFnYWluc3QgdGhlIGV4cHJlc3Npb24gbGFuZ3VhZ2UsIGJ1dCBub3QgdG8gcHJldmVudCBleHBsb2l0cyB0aGF0IHdlcmUgZW5hYmxlZCBieSBleHBvc2luZ1xuLy8gc2Vuc2l0aXZlIEphdmFTY3JpcHQgb3IgYnJvd3NlciBBUElzIG9uIFNjb3BlLiBFeHBvc2luZyBzdWNoIG9iamVjdHMgb24gYSBTY29wZSBpcyBuZXZlciBhIGdvb2Rcbi8vIHByYWN0aWNlIGFuZCB0aGVyZWZvcmUgd2UgYXJlIG5vdCBldmVuIHRyeWluZyB0byBwcm90ZWN0IGFnYWluc3QgaW50ZXJhY3Rpb24gd2l0aCBhbiBvYmplY3Rcbi8vIGV4cGxpY2l0bHkgZXhwb3NlZCBpbiB0aGlzIHdheS5cbi8vXG4vLyBJbiBnZW5lcmFsLCBpdCBpcyBub3QgcG9zc2libGUgdG8gYWNjZXNzIGEgV2luZG93IG9iamVjdCBmcm9tIGFuIGFuZ3VsYXIgZXhwcmVzc2lvbiB1bmxlc3MgYVxuLy8gd2luZG93IG9yIHNvbWUgRE9NIG9iamVjdCB0aGF0IGhhcyBhIHJlZmVyZW5jZSB0byB3aW5kb3cgaXMgcHVibGlzaGVkIG9udG8gYSBTY29wZS5cbi8vIFNpbWlsYXJseSB3ZSBwcmV2ZW50IGludm9jYXRpb25zIG9mIGZ1bmN0aW9uIGtub3duIHRvIGJlIGRhbmdlcm91cywgYXMgd2VsbCBhcyBhc3NpZ25tZW50cyB0b1xuLy8gbmF0aXZlIG9iamVjdHMuXG4vL1xuLy8gU2VlIGh0dHBzOi8vZG9jcy5hbmd1bGFyanMub3JnL2d1aWRlL3NlY3VyaXR5XG5cblxuZnVuY3Rpb24gZW5zdXJlU2FmZU1lbWJlck5hbWUobmFtZSwgZnVsbEV4cHJlc3Npb24pIHtcbiAgaWYgKG5hbWUgPT09IFwiX19kZWZpbmVHZXR0ZXJfX1wiIHx8IG5hbWUgPT09IFwiX19kZWZpbmVTZXR0ZXJfX1wiXG4gICAgICB8fCBuYW1lID09PSBcIl9fbG9va3VwR2V0dGVyX19cIiB8fCBuYW1lID09PSBcIl9fbG9va3VwU2V0dGVyX19cIlxuICAgICAgfHwgbmFtZSA9PT0gXCJfX3Byb3RvX19cIikge1xuICAgIHRocm93ICRwYXJzZU1pbkVycignaXNlY2ZsZCcsXG4gICAgICAgICdBdHRlbXB0aW5nIHRvIGFjY2VzcyBhIGRpc2FsbG93ZWQgZmllbGQgaW4gQW5ndWxhciBleHByZXNzaW9ucyEgJ1xuICAgICAgICArICdFeHByZXNzaW9uOiB7MH0nLCBmdWxsRXhwcmVzc2lvbik7XG4gIH1cbiAgcmV0dXJuIG5hbWU7XG59XG5cbmZ1bmN0aW9uIGdldFN0cmluZ1ZhbHVlKG5hbWUpIHtcbiAgLy8gUHJvcGVydHkgbmFtZXMgbXVzdCBiZSBzdHJpbmdzLiBUaGlzIG1lYW5zIHRoYXQgbm9uLXN0cmluZyBvYmplY3RzIGNhbm5vdCBiZSB1c2VkXG4gIC8vIGFzIGtleXMgaW4gYW4gb2JqZWN0LiBBbnkgbm9uLXN0cmluZyBvYmplY3QsIGluY2x1ZGluZyBhIG51bWJlciwgaXMgdHlwZWNhc3RlZFxuICAvLyBpbnRvIGEgc3RyaW5nIHZpYSB0aGUgdG9TdHJpbmcgbWV0aG9kLlxuICAvLyAtLSBNRE4sIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL09wZXJhdG9ycy9Qcm9wZXJ0eV9hY2Nlc3NvcnMjUHJvcGVydHlfbmFtZXNcbiAgLy9cbiAgLy8gU28sIHRvIGVuc3VyZSB0aGF0IHdlIGFyZSBjaGVja2luZyB0aGUgc2FtZSBgbmFtZWAgdGhhdCBKYXZhU2NyaXB0IHdvdWxkIHVzZSwgd2UgY2FzdCBpdFxuICAvLyB0byBhIHN0cmluZy4gSXQncyBub3QgYWx3YXlzIHBvc3NpYmxlLiBJZiBgbmFtZWAgaXMgYW4gb2JqZWN0IGFuZCBpdHMgYHRvU3RyaW5nYCBtZXRob2QgaXNcbiAgLy8gJ2Jyb2tlbicgKGRvZXNuJ3QgcmV0dXJuIGEgc3RyaW5nLCBpc24ndCBhIGZ1bmN0aW9uLCBldGMuKSwgYW4gZXJyb3Igd2lsbCBiZSB0aHJvd246XG4gIC8vXG4gIC8vIFR5cGVFcnJvcjogQ2Fubm90IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZVxuICAvL1xuICAvLyBGb3IgcGVyZm9ybWFuY2UgcmVhc29ucywgd2UgZG9uJ3QgY2F0Y2ggdGhpcyBlcnJvciBoZXJlIGFuZCBhbGxvdyBpdCB0byBwcm9wYWdhdGUgdXAgdGhlIGNhbGxcbiAgLy8gc3RhY2suIE5vdGUgdGhhdCB5b3UnbGwgZ2V0IHRoZSBzYW1lIGVycm9yIGluIEphdmFTY3JpcHQgaWYgeW91IHRyeSB0byBhY2Nlc3MgYSBwcm9wZXJ0eSB1c2luZ1xuICAvLyBzdWNoIGEgJ2Jyb2tlbicgb2JqZWN0IGFzIGEga2V5LlxuICByZXR1cm4gbmFtZSArICcnO1xufVxuXG5mdW5jdGlvbiBlbnN1cmVTYWZlT2JqZWN0KG9iaiwgZnVsbEV4cHJlc3Npb24pIHtcbiAgLy8gbmlmdHkgY2hlY2sgaWYgb2JqIGlzIEZ1bmN0aW9uIHRoYXQgaXMgZmFzdCBhbmQgd29ya3MgYWNyb3NzIGlmcmFtZXMgYW5kIG90aGVyIGNvbnRleHRzXG4gIGlmIChvYmopIHtcbiAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBvYmopIHtcbiAgICAgIHRocm93ICRwYXJzZU1pbkVycignaXNlY2ZuJyxcbiAgICAgICAgICAnUmVmZXJlbmNpbmcgRnVuY3Rpb24gaW4gQW5ndWxhciBleHByZXNzaW9ucyBpcyBkaXNhbGxvd2VkISBFeHByZXNzaW9uOiB7MH0nLFxuICAgICAgICAgIGZ1bGxFeHByZXNzaW9uKTtcbiAgICB9IGVsc2UgaWYgKC8vIGlzV2luZG93KG9iailcbiAgICAgICAgb2JqLndpbmRvdyA9PT0gb2JqKSB7XG4gICAgICB0aHJvdyAkcGFyc2VNaW5FcnIoJ2lzZWN3aW5kb3cnLFxuICAgICAgICAgICdSZWZlcmVuY2luZyB0aGUgV2luZG93IGluIEFuZ3VsYXIgZXhwcmVzc2lvbnMgaXMgZGlzYWxsb3dlZCEgRXhwcmVzc2lvbjogezB9JyxcbiAgICAgICAgICBmdWxsRXhwcmVzc2lvbik7XG4gICAgfSBlbHNlIGlmICgvLyBpc0VsZW1lbnQob2JqKVxuICAgICAgICBvYmouY2hpbGRyZW4gJiYgKG9iai5ub2RlTmFtZSB8fCAob2JqLnByb3AgJiYgb2JqLmF0dHIgJiYgb2JqLmZpbmQpKSkge1xuICAgICAgdGhyb3cgJHBhcnNlTWluRXJyKCdpc2VjZG9tJyxcbiAgICAgICAgICAnUmVmZXJlbmNpbmcgRE9NIG5vZGVzIGluIEFuZ3VsYXIgZXhwcmVzc2lvbnMgaXMgZGlzYWxsb3dlZCEgRXhwcmVzc2lvbjogezB9JyxcbiAgICAgICAgICBmdWxsRXhwcmVzc2lvbik7XG4gICAgfSBlbHNlIGlmICgvLyBibG9jayBPYmplY3Qgc28gdGhhdCB3ZSBjYW4ndCBnZXQgaG9sZCBvZiBkYW5nZXJvdXMgT2JqZWN0LiogbWV0aG9kc1xuICAgICAgICBvYmogPT09IE9iamVjdCkge1xuICAgICAgdGhyb3cgJHBhcnNlTWluRXJyKCdpc2Vjb2JqJyxcbiAgICAgICAgICAnUmVmZXJlbmNpbmcgT2JqZWN0IGluIEFuZ3VsYXIgZXhwcmVzc2lvbnMgaXMgZGlzYWxsb3dlZCEgRXhwcmVzc2lvbjogezB9JyxcbiAgICAgICAgICBmdWxsRXhwcmVzc2lvbik7XG4gICAgfVxuICB9XG4gIHJldHVybiBvYmo7XG59XG5cbnZhciBDQUxMID0gRnVuY3Rpb24ucHJvdG90eXBlLmNhbGw7XG52YXIgQVBQTFkgPSBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHk7XG52YXIgQklORCA9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kO1xuXG5mdW5jdGlvbiBlbnN1cmVTYWZlRnVuY3Rpb24ob2JqLCBmdWxsRXhwcmVzc2lvbikge1xuICBpZiAob2JqKSB7XG4gICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gb2JqKSB7XG4gICAgICB0aHJvdyAkcGFyc2VNaW5FcnIoJ2lzZWNmbicsXG4gICAgICAgICdSZWZlcmVuY2luZyBGdW5jdGlvbiBpbiBBbmd1bGFyIGV4cHJlc3Npb25zIGlzIGRpc2FsbG93ZWQhIEV4cHJlc3Npb246IHswfScsXG4gICAgICAgIGZ1bGxFeHByZXNzaW9uKTtcbiAgICB9IGVsc2UgaWYgKG9iaiA9PT0gQ0FMTCB8fCBvYmogPT09IEFQUExZIHx8IG9iaiA9PT0gQklORCkge1xuICAgICAgdGhyb3cgJHBhcnNlTWluRXJyKCdpc2VjZmYnLFxuICAgICAgICAnUmVmZXJlbmNpbmcgY2FsbCwgYXBwbHkgb3IgYmluZCBpbiBBbmd1bGFyIGV4cHJlc3Npb25zIGlzIGRpc2FsbG93ZWQhIEV4cHJlc3Npb246IHswfScsXG4gICAgICAgIGZ1bGxFeHByZXNzaW9uKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZW5zdXJlU2FmZUFzc2lnbkNvbnRleHQob2JqLCBmdWxsRXhwcmVzc2lvbikge1xuICBpZiAob2JqKSB7XG4gICAgaWYgKG9iaiA9PT0gKDApLmNvbnN0cnVjdG9yIHx8IG9iaiA9PT0gKGZhbHNlKS5jb25zdHJ1Y3RvciB8fCBvYmogPT09ICcnLmNvbnN0cnVjdG9yIHx8XG4gICAgICAgIG9iaiA9PT0ge30uY29uc3RydWN0b3IgfHwgb2JqID09PSBbXS5jb25zdHJ1Y3RvciB8fCBvYmogPT09IEZ1bmN0aW9uLmNvbnN0cnVjdG9yKSB7XG4gICAgICB0aHJvdyAkcGFyc2VNaW5FcnIoJ2lzZWNhZicsXG4gICAgICAgICdBc3NpZ25pbmcgdG8gYSBjb25zdHJ1Y3RvciBpcyBkaXNhbGxvd2VkISBFeHByZXNzaW9uOiB7MH0nLCBmdWxsRXhwcmVzc2lvbik7XG4gICAgfVxuICB9XG59XG5cbnZhciBPUEVSQVRPUlMgPSBjcmVhdGVNYXAoKTtcbmZvckVhY2goJysgLSAqIC8gJSA9PT0gIT09ID09ICE9IDwgPiA8PSA+PSAmJiB8fCAhID0gfCcuc3BsaXQoJyAnKSwgZnVuY3Rpb24ob3BlcmF0b3IpIHsgT1BFUkFUT1JTW29wZXJhdG9yXSA9IHRydWU7IH0pO1xudmFyIEVTQ0FQRSA9IHtcIm5cIjpcIlxcblwiLCBcImZcIjpcIlxcZlwiLCBcInJcIjpcIlxcclwiLCBcInRcIjpcIlxcdFwiLCBcInZcIjpcIlxcdlwiLCBcIidcIjpcIidcIiwgJ1wiJzonXCInfTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbnZhciBMZXhlciA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbn07XG5cbkxleGVyLnByb3RvdHlwZSA9IHtcbiAgY29uc3RydWN0b3I6IExleGVyLFxuXG4gIGxleDogZnVuY3Rpb24odGV4dCkge1xuICAgIHRoaXMudGV4dCA9IHRleHQ7XG4gICAgdGhpcy5pbmRleCA9IDA7XG4gICAgdGhpcy50b2tlbnMgPSBbXTtcblxuICAgIHdoaWxlICh0aGlzLmluZGV4IDwgdGhpcy50ZXh0Lmxlbmd0aCkge1xuICAgICAgdmFyIGNoID0gdGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KTtcbiAgICAgIGlmIChjaCA9PT0gJ1wiJyB8fCBjaCA9PT0gXCInXCIpIHtcbiAgICAgICAgdGhpcy5yZWFkU3RyaW5nKGNoKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc051bWJlcihjaCkgfHwgY2ggPT09ICcuJyAmJiB0aGlzLmlzTnVtYmVyKHRoaXMucGVlaygpKSkge1xuICAgICAgICB0aGlzLnJlYWROdW1iZXIoKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0lkZW50KGNoKSkge1xuICAgICAgICB0aGlzLnJlYWRJZGVudCgpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmlzKGNoLCAnKCl7fVtdLiw7Oj8nKSkge1xuICAgICAgICB0aGlzLnRva2Vucy5wdXNoKHtpbmRleDogdGhpcy5pbmRleCwgdGV4dDogY2h9KTtcbiAgICAgICAgdGhpcy5pbmRleCsrO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmlzV2hpdGVzcGFjZShjaCkpIHtcbiAgICAgICAgdGhpcy5pbmRleCsrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGNoMiA9IGNoICsgdGhpcy5wZWVrKCk7XG4gICAgICAgIHZhciBjaDMgPSBjaDIgKyB0aGlzLnBlZWsoMik7XG4gICAgICAgIHZhciBvcDEgPSBPUEVSQVRPUlNbY2hdO1xuICAgICAgICB2YXIgb3AyID0gT1BFUkFUT1JTW2NoMl07XG4gICAgICAgIHZhciBvcDMgPSBPUEVSQVRPUlNbY2gzXTtcbiAgICAgICAgaWYgKG9wMSB8fCBvcDIgfHwgb3AzKSB7XG4gICAgICAgICAgdmFyIHRva2VuID0gb3AzID8gY2gzIDogKG9wMiA/IGNoMiA6IGNoKTtcbiAgICAgICAgICB0aGlzLnRva2Vucy5wdXNoKHtpbmRleDogdGhpcy5pbmRleCwgdGV4dDogdG9rZW4sIG9wZXJhdG9yOiB0cnVlfSk7XG4gICAgICAgICAgdGhpcy5pbmRleCArPSB0b2tlbi5sZW5ndGg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy50aHJvd0Vycm9yKCdVbmV4cGVjdGVkIG5leHQgY2hhcmFjdGVyICcsIHRoaXMuaW5kZXgsIHRoaXMuaW5kZXggKyAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy50b2tlbnM7XG4gIH0sXG5cbiAgaXM6IGZ1bmN0aW9uKGNoLCBjaGFycykge1xuICAgIHJldHVybiBjaGFycy5pbmRleE9mKGNoKSAhPT0gLTE7XG4gIH0sXG5cbiAgcGVlazogZnVuY3Rpb24oaSkge1xuICAgIHZhciBudW0gPSBpIHx8IDE7XG4gICAgcmV0dXJuICh0aGlzLmluZGV4ICsgbnVtIDwgdGhpcy50ZXh0Lmxlbmd0aCkgPyB0aGlzLnRleHQuY2hhckF0KHRoaXMuaW5kZXggKyBudW0pIDogZmFsc2U7XG4gIH0sXG5cbiAgaXNOdW1iZXI6IGZ1bmN0aW9uKGNoKSB7XG4gICAgcmV0dXJuICgnMCcgPD0gY2ggJiYgY2ggPD0gJzknKSAmJiB0eXBlb2YgY2ggPT09IFwic3RyaW5nXCI7XG4gIH0sXG5cbiAgaXNXaGl0ZXNwYWNlOiBmdW5jdGlvbihjaCkge1xuICAgIC8vIElFIHRyZWF0cyBub24tYnJlYWtpbmcgc3BhY2UgYXMgXFx1MDBBMFxuICAgIHJldHVybiAoY2ggPT09ICcgJyB8fCBjaCA9PT0gJ1xccicgfHwgY2ggPT09ICdcXHQnIHx8XG4gICAgICAgICAgICBjaCA9PT0gJ1xcbicgfHwgY2ggPT09ICdcXHYnIHx8IGNoID09PSAnXFx1MDBBMCcpO1xuICB9LFxuXG4gIGlzSWRlbnQ6IGZ1bmN0aW9uKGNoKSB7XG4gICAgcmV0dXJuICgnYScgPD0gY2ggJiYgY2ggPD0gJ3onIHx8XG4gICAgICAgICAgICAnQScgPD0gY2ggJiYgY2ggPD0gJ1onIHx8XG4gICAgICAgICAgICAnXycgPT09IGNoIHx8IGNoID09PSAnJCcpO1xuICB9LFxuXG4gIGlzRXhwT3BlcmF0b3I6IGZ1bmN0aW9uKGNoKSB7XG4gICAgcmV0dXJuIChjaCA9PT0gJy0nIHx8IGNoID09PSAnKycgfHwgdGhpcy5pc051bWJlcihjaCkpO1xuICB9LFxuXG4gIHRocm93RXJyb3I6IGZ1bmN0aW9uKGVycm9yLCBzdGFydCwgZW5kKSB7XG4gICAgZW5kID0gZW5kIHx8IHRoaXMuaW5kZXg7XG4gICAgdmFyIGNvbFN0ciA9IChpc0RlZmluZWQoc3RhcnQpXG4gICAgICAgICAgICA/ICdzICcgKyBzdGFydCArICAnLScgKyB0aGlzLmluZGV4ICsgJyBbJyArIHRoaXMudGV4dC5zdWJzdHJpbmcoc3RhcnQsIGVuZCkgKyAnXSdcbiAgICAgICAgICAgIDogJyAnICsgZW5kKTtcbiAgICB0aHJvdyAkcGFyc2VNaW5FcnIoJ2xleGVycicsICdMZXhlciBFcnJvcjogezB9IGF0IGNvbHVtbnsxfSBpbiBleHByZXNzaW9uIFt7Mn1dLicsXG4gICAgICAgIGVycm9yLCBjb2xTdHIsIHRoaXMudGV4dCk7XG4gIH0sXG5cbiAgcmVhZE51bWJlcjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIG51bWJlciA9ICcnO1xuICAgIHZhciBzdGFydCA9IHRoaXMuaW5kZXg7XG4gICAgd2hpbGUgKHRoaXMuaW5kZXggPCB0aGlzLnRleHQubGVuZ3RoKSB7XG4gICAgICB2YXIgY2ggPSBsb3dlcmNhc2UodGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KSk7XG4gICAgICBpZiAoY2ggPT0gJy4nIHx8IHRoaXMuaXNOdW1iZXIoY2gpKSB7XG4gICAgICAgIG51bWJlciArPSBjaDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBwZWVrQ2ggPSB0aGlzLnBlZWsoKTtcbiAgICAgICAgaWYgKGNoID09ICdlJyAmJiB0aGlzLmlzRXhwT3BlcmF0b3IocGVla0NoKSkge1xuICAgICAgICAgIG51bWJlciArPSBjaDtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzRXhwT3BlcmF0b3IoY2gpICYmXG4gICAgICAgICAgICBwZWVrQ2ggJiYgdGhpcy5pc051bWJlcihwZWVrQ2gpICYmXG4gICAgICAgICAgICBudW1iZXIuY2hhckF0KG51bWJlci5sZW5ndGggLSAxKSA9PSAnZScpIHtcbiAgICAgICAgICBudW1iZXIgKz0gY2g7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0V4cE9wZXJhdG9yKGNoKSAmJlxuICAgICAgICAgICAgKCFwZWVrQ2ggfHwgIXRoaXMuaXNOdW1iZXIocGVla0NoKSkgJiZcbiAgICAgICAgICAgIG51bWJlci5jaGFyQXQobnVtYmVyLmxlbmd0aCAtIDEpID09ICdlJykge1xuICAgICAgICAgIHRoaXMudGhyb3dFcnJvcignSW52YWxpZCBleHBvbmVudCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLmluZGV4Kys7XG4gICAgfVxuICAgIHRoaXMudG9rZW5zLnB1c2goe1xuICAgICAgaW5kZXg6IHN0YXJ0LFxuICAgICAgdGV4dDogbnVtYmVyLFxuICAgICAgY29uc3RhbnQ6IHRydWUsXG4gICAgICB2YWx1ZTogTnVtYmVyKG51bWJlcilcbiAgICB9KTtcbiAgfSxcblxuICByZWFkSWRlbnQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzdGFydCA9IHRoaXMuaW5kZXg7XG4gICAgd2hpbGUgKHRoaXMuaW5kZXggPCB0aGlzLnRleHQubGVuZ3RoKSB7XG4gICAgICB2YXIgY2ggPSB0aGlzLnRleHQuY2hhckF0KHRoaXMuaW5kZXgpO1xuICAgICAgaWYgKCEodGhpcy5pc0lkZW50KGNoKSB8fCB0aGlzLmlzTnVtYmVyKGNoKSkpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICB0aGlzLmluZGV4Kys7XG4gICAgfVxuICAgIHRoaXMudG9rZW5zLnB1c2goe1xuICAgICAgaW5kZXg6IHN0YXJ0LFxuICAgICAgdGV4dDogdGhpcy50ZXh0LnNsaWNlKHN0YXJ0LCB0aGlzLmluZGV4KSxcbiAgICAgIGlkZW50aWZpZXI6IHRydWVcbiAgICB9KTtcbiAgfSxcblxuICByZWFkU3RyaW5nOiBmdW5jdGlvbihxdW90ZSkge1xuICAgIHZhciBzdGFydCA9IHRoaXMuaW5kZXg7XG4gICAgdGhpcy5pbmRleCsrO1xuICAgIHZhciBzdHJpbmcgPSAnJztcbiAgICB2YXIgcmF3U3RyaW5nID0gcXVvdGU7XG4gICAgdmFyIGVzY2FwZSA9IGZhbHNlO1xuICAgIHdoaWxlICh0aGlzLmluZGV4IDwgdGhpcy50ZXh0Lmxlbmd0aCkge1xuICAgICAgdmFyIGNoID0gdGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KTtcbiAgICAgIHJhd1N0cmluZyArPSBjaDtcbiAgICAgIGlmIChlc2NhcGUpIHtcbiAgICAgICAgaWYgKGNoID09PSAndScpIHtcbiAgICAgICAgICB2YXIgaGV4ID0gdGhpcy50ZXh0LnN1YnN0cmluZyh0aGlzLmluZGV4ICsgMSwgdGhpcy5pbmRleCArIDUpO1xuICAgICAgICAgIGlmICghaGV4Lm1hdGNoKC9bXFxkYS1mXXs0fS9pKSkge1xuICAgICAgICAgICAgdGhpcy50aHJvd0Vycm9yKCdJbnZhbGlkIHVuaWNvZGUgZXNjYXBlIFtcXFxcdScgKyBoZXggKyAnXScpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmluZGV4ICs9IDQ7XG4gICAgICAgICAgc3RyaW5nICs9IFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoaGV4LCAxNikpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciByZXAgPSBFU0NBUEVbY2hdO1xuICAgICAgICAgIHN0cmluZyA9IHN0cmluZyArIChyZXAgfHwgY2gpO1xuICAgICAgICB9XG4gICAgICAgIGVzY2FwZSA9IGZhbHNlO1xuICAgICAgfSBlbHNlIGlmIChjaCA9PT0gJ1xcXFwnKSB7XG4gICAgICAgIGVzY2FwZSA9IHRydWU7XG4gICAgICB9IGVsc2UgaWYgKGNoID09PSBxdW90ZSkge1xuICAgICAgICB0aGlzLmluZGV4Kys7XG4gICAgICAgIHRoaXMudG9rZW5zLnB1c2goe1xuICAgICAgICAgIGluZGV4OiBzdGFydCxcbiAgICAgICAgICB0ZXh0OiByYXdTdHJpbmcsXG4gICAgICAgICAgY29uc3RhbnQ6IHRydWUsXG4gICAgICAgICAgdmFsdWU6IHN0cmluZ1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3RyaW5nICs9IGNoO1xuICAgICAgfVxuICAgICAgdGhpcy5pbmRleCsrO1xuICAgIH1cbiAgICB0aGlzLnRocm93RXJyb3IoJ1VudGVybWluYXRlZCBxdW90ZScsIHN0YXJ0KTtcbiAgfVxufTtcblxudmFyIEFTVCA9IGZ1bmN0aW9uKGxleGVyLCBvcHRpb25zKSB7XG4gIHRoaXMubGV4ZXIgPSBsZXhlcjtcbiAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbn07XG5cbkFTVC5Qcm9ncmFtID0gJ1Byb2dyYW0nO1xuQVNULkV4cHJlc3Npb25TdGF0ZW1lbnQgPSAnRXhwcmVzc2lvblN0YXRlbWVudCc7XG5BU1QuQXNzaWdubWVudEV4cHJlc3Npb24gPSAnQXNzaWdubWVudEV4cHJlc3Npb24nO1xuQVNULkNvbmRpdGlvbmFsRXhwcmVzc2lvbiA9ICdDb25kaXRpb25hbEV4cHJlc3Npb24nO1xuQVNULkxvZ2ljYWxFeHByZXNzaW9uID0gJ0xvZ2ljYWxFeHByZXNzaW9uJztcbkFTVC5CaW5hcnlFeHByZXNzaW9uID0gJ0JpbmFyeUV4cHJlc3Npb24nO1xuQVNULlVuYXJ5RXhwcmVzc2lvbiA9ICdVbmFyeUV4cHJlc3Npb24nO1xuQVNULkNhbGxFeHByZXNzaW9uID0gJ0NhbGxFeHByZXNzaW9uJztcbkFTVC5NZW1iZXJFeHByZXNzaW9uID0gJ01lbWJlckV4cHJlc3Npb24nO1xuQVNULklkZW50aWZpZXIgPSAnSWRlbnRpZmllcic7XG5BU1QuTGl0ZXJhbCA9ICdMaXRlcmFsJztcbkFTVC5BcnJheUV4cHJlc3Npb24gPSAnQXJyYXlFeHByZXNzaW9uJztcbkFTVC5Qcm9wZXJ0eSA9ICdQcm9wZXJ0eSc7XG5BU1QuT2JqZWN0RXhwcmVzc2lvbiA9ICdPYmplY3RFeHByZXNzaW9uJztcbkFTVC5UaGlzRXhwcmVzc2lvbiA9ICdUaGlzRXhwcmVzc2lvbic7XG5BU1QuTG9jYWxzRXhwcmVzc2lvbiA9ICdMb2NhbHNFeHByZXNzaW9uJztcblxuLy8gSW50ZXJuYWwgdXNlIG9ubHlcbkFTVC5OR1ZhbHVlUGFyYW1ldGVyID0gJ05HVmFsdWVQYXJhbWV0ZXInO1xuXG5BU1QucHJvdG90eXBlID0ge1xuICBhc3Q6IGZ1bmN0aW9uKHRleHQpIHtcbiAgICB0aGlzLnRleHQgPSB0ZXh0O1xuICAgIHRoaXMudG9rZW5zID0gdGhpcy5sZXhlci5sZXgodGV4dCk7XG5cbiAgICB2YXIgdmFsdWUgPSB0aGlzLnByb2dyYW0oKTtcblxuICAgIGlmICh0aGlzLnRva2Vucy5sZW5ndGggIT09IDApIHtcbiAgICAgIHRoaXMudGhyb3dFcnJvcignaXMgYW4gdW5leHBlY3RlZCB0b2tlbicsIHRoaXMudG9rZW5zWzBdKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFsdWU7XG4gIH0sXG5cbiAgcHJvZ3JhbTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGJvZHkgPSBbXTtcbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgaWYgKHRoaXMudG9rZW5zLmxlbmd0aCA+IDAgJiYgIXRoaXMucGVlaygnfScsICcpJywgJzsnLCAnXScpKVxuICAgICAgICBib2R5LnB1c2godGhpcy5leHByZXNzaW9uU3RhdGVtZW50KCkpO1xuICAgICAgaWYgKCF0aGlzLmV4cGVjdCgnOycpKSB7XG4gICAgICAgIHJldHVybiB7IHR5cGU6IEFTVC5Qcm9ncmFtLCBib2R5OiBib2R5fTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgZXhwcmVzc2lvblN0YXRlbWVudDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHsgdHlwZTogQVNULkV4cHJlc3Npb25TdGF0ZW1lbnQsIGV4cHJlc3Npb246IHRoaXMuZmlsdGVyQ2hhaW4oKSB9O1xuICB9LFxuXG4gIGZpbHRlckNoYWluOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgbGVmdCA9IHRoaXMuZXhwcmVzc2lvbigpO1xuICAgIHZhciB0b2tlbjtcbiAgICB3aGlsZSAoKHRva2VuID0gdGhpcy5leHBlY3QoJ3wnKSkpIHtcbiAgICAgIGxlZnQgPSB0aGlzLmZpbHRlcihsZWZ0KTtcbiAgICB9XG4gICAgcmV0dXJuIGxlZnQ7XG4gIH0sXG5cbiAgZXhwcmVzc2lvbjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuYXNzaWdubWVudCgpO1xuICB9LFxuXG4gIGFzc2lnbm1lbnQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciByZXN1bHQgPSB0aGlzLnRlcm5hcnkoKTtcbiAgICBpZiAodGhpcy5leHBlY3QoJz0nKSkge1xuICAgICAgcmVzdWx0ID0geyB0eXBlOiBBU1QuQXNzaWdubWVudEV4cHJlc3Npb24sIGxlZnQ6IHJlc3VsdCwgcmlnaHQ6IHRoaXMuYXNzaWdubWVudCgpLCBvcGVyYXRvcjogJz0nfTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcblxuICB0ZXJuYXJ5OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdGVzdCA9IHRoaXMubG9naWNhbE9SKCk7XG4gICAgdmFyIGFsdGVybmF0ZTtcbiAgICB2YXIgY29uc2VxdWVudDtcbiAgICBpZiAodGhpcy5leHBlY3QoJz8nKSkge1xuICAgICAgYWx0ZXJuYXRlID0gdGhpcy5leHByZXNzaW9uKCk7XG4gICAgICBpZiAodGhpcy5jb25zdW1lKCc6JykpIHtcbiAgICAgICAgY29uc2VxdWVudCA9IHRoaXMuZXhwcmVzc2lvbigpO1xuICAgICAgICByZXR1cm4geyB0eXBlOiBBU1QuQ29uZGl0aW9uYWxFeHByZXNzaW9uLCB0ZXN0OiB0ZXN0LCBhbHRlcm5hdGU6IGFsdGVybmF0ZSwgY29uc2VxdWVudDogY29uc2VxdWVudH07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0ZXN0O1xuICB9LFxuXG4gIGxvZ2ljYWxPUjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGxlZnQgPSB0aGlzLmxvZ2ljYWxBTkQoKTtcbiAgICB3aGlsZSAodGhpcy5leHBlY3QoJ3x8JykpIHtcbiAgICAgIGxlZnQgPSB7IHR5cGU6IEFTVC5Mb2dpY2FsRXhwcmVzc2lvbiwgb3BlcmF0b3I6ICd8fCcsIGxlZnQ6IGxlZnQsIHJpZ2h0OiB0aGlzLmxvZ2ljYWxBTkQoKSB9O1xuICAgIH1cbiAgICByZXR1cm4gbGVmdDtcbiAgfSxcblxuICBsb2dpY2FsQU5EOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgbGVmdCA9IHRoaXMuZXF1YWxpdHkoKTtcbiAgICB3aGlsZSAodGhpcy5leHBlY3QoJyYmJykpIHtcbiAgICAgIGxlZnQgPSB7IHR5cGU6IEFTVC5Mb2dpY2FsRXhwcmVzc2lvbiwgb3BlcmF0b3I6ICcmJicsIGxlZnQ6IGxlZnQsIHJpZ2h0OiB0aGlzLmVxdWFsaXR5KCl9O1xuICAgIH1cbiAgICByZXR1cm4gbGVmdDtcbiAgfSxcblxuICBlcXVhbGl0eTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGxlZnQgPSB0aGlzLnJlbGF0aW9uYWwoKTtcbiAgICB2YXIgdG9rZW47XG4gICAgd2hpbGUgKCh0b2tlbiA9IHRoaXMuZXhwZWN0KCc9PScsJyE9JywnPT09JywnIT09JykpKSB7XG4gICAgICBsZWZ0ID0geyB0eXBlOiBBU1QuQmluYXJ5RXhwcmVzc2lvbiwgb3BlcmF0b3I6IHRva2VuLnRleHQsIGxlZnQ6IGxlZnQsIHJpZ2h0OiB0aGlzLnJlbGF0aW9uYWwoKSB9O1xuICAgIH1cbiAgICByZXR1cm4gbGVmdDtcbiAgfSxcblxuICByZWxhdGlvbmFsOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgbGVmdCA9IHRoaXMuYWRkaXRpdmUoKTtcbiAgICB2YXIgdG9rZW47XG4gICAgd2hpbGUgKCh0b2tlbiA9IHRoaXMuZXhwZWN0KCc8JywgJz4nLCAnPD0nLCAnPj0nKSkpIHtcbiAgICAgIGxlZnQgPSB7IHR5cGU6IEFTVC5CaW5hcnlFeHByZXNzaW9uLCBvcGVyYXRvcjogdG9rZW4udGV4dCwgbGVmdDogbGVmdCwgcmlnaHQ6IHRoaXMuYWRkaXRpdmUoKSB9O1xuICAgIH1cbiAgICByZXR1cm4gbGVmdDtcbiAgfSxcblxuICBhZGRpdGl2ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGxlZnQgPSB0aGlzLm11bHRpcGxpY2F0aXZlKCk7XG4gICAgdmFyIHRva2VuO1xuICAgIHdoaWxlICgodG9rZW4gPSB0aGlzLmV4cGVjdCgnKycsJy0nKSkpIHtcbiAgICAgIGxlZnQgPSB7IHR5cGU6IEFTVC5CaW5hcnlFeHByZXNzaW9uLCBvcGVyYXRvcjogdG9rZW4udGV4dCwgbGVmdDogbGVmdCwgcmlnaHQ6IHRoaXMubXVsdGlwbGljYXRpdmUoKSB9O1xuICAgIH1cbiAgICByZXR1cm4gbGVmdDtcbiAgfSxcblxuICBtdWx0aXBsaWNhdGl2ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGxlZnQgPSB0aGlzLnVuYXJ5KCk7XG4gICAgdmFyIHRva2VuO1xuICAgIHdoaWxlICgodG9rZW4gPSB0aGlzLmV4cGVjdCgnKicsJy8nLCclJykpKSB7XG4gICAgICBsZWZ0ID0geyB0eXBlOiBBU1QuQmluYXJ5RXhwcmVzc2lvbiwgb3BlcmF0b3I6IHRva2VuLnRleHQsIGxlZnQ6IGxlZnQsIHJpZ2h0OiB0aGlzLnVuYXJ5KCkgfTtcbiAgICB9XG4gICAgcmV0dXJuIGxlZnQ7XG4gIH0sXG5cbiAgdW5hcnk6IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0b2tlbjtcbiAgICBpZiAoKHRva2VuID0gdGhpcy5leHBlY3QoJysnLCAnLScsICchJykpKSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBBU1QuVW5hcnlFeHByZXNzaW9uLCBvcGVyYXRvcjogdG9rZW4udGV4dCwgcHJlZml4OiB0cnVlLCBhcmd1bWVudDogdGhpcy51bmFyeSgpIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnByaW1hcnkoKTtcbiAgICB9XG4gIH0sXG5cbiAgcHJpbWFyeTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHByaW1hcnk7XG4gICAgaWYgKHRoaXMuZXhwZWN0KCcoJykpIHtcbiAgICAgIHByaW1hcnkgPSB0aGlzLmZpbHRlckNoYWluKCk7XG4gICAgICB0aGlzLmNvbnN1bWUoJyknKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZXhwZWN0KCdbJykpIHtcbiAgICAgIHByaW1hcnkgPSB0aGlzLmFycmF5RGVjbGFyYXRpb24oKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZXhwZWN0KCd7JykpIHtcbiAgICAgIHByaW1hcnkgPSB0aGlzLm9iamVjdCgpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5jb25zdGFudHMuaGFzT3duUHJvcGVydHkodGhpcy5wZWVrKCkudGV4dCkpIHtcbiAgICAgIHByaW1hcnkgPSBjb3B5KHRoaXMuY29uc3RhbnRzW3RoaXMuY29uc3VtZSgpLnRleHRdKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucGVlaygpLmlkZW50aWZpZXIpIHtcbiAgICAgIHByaW1hcnkgPSB0aGlzLmlkZW50aWZpZXIoKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucGVlaygpLmNvbnN0YW50KSB7XG4gICAgICBwcmltYXJ5ID0gdGhpcy5jb25zdGFudCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRocm93RXJyb3IoJ25vdCBhIHByaW1hcnkgZXhwcmVzc2lvbicsIHRoaXMucGVlaygpKTtcbiAgICB9XG5cbiAgICB2YXIgbmV4dDtcbiAgICB3aGlsZSAoKG5leHQgPSB0aGlzLmV4cGVjdCgnKCcsICdbJywgJy4nKSkpIHtcbiAgICAgIGlmIChuZXh0LnRleHQgPT09ICcoJykge1xuICAgICAgICBwcmltYXJ5ID0ge3R5cGU6IEFTVC5DYWxsRXhwcmVzc2lvbiwgY2FsbGVlOiBwcmltYXJ5LCBhcmd1bWVudHM6IHRoaXMucGFyc2VBcmd1bWVudHMoKSB9O1xuICAgICAgICB0aGlzLmNvbnN1bWUoJyknKTtcbiAgICAgIH0gZWxzZSBpZiAobmV4dC50ZXh0ID09PSAnWycpIHtcbiAgICAgICAgcHJpbWFyeSA9IHsgdHlwZTogQVNULk1lbWJlckV4cHJlc3Npb24sIG9iamVjdDogcHJpbWFyeSwgcHJvcGVydHk6IHRoaXMuZXhwcmVzc2lvbigpLCBjb21wdXRlZDogdHJ1ZSB9O1xuICAgICAgICB0aGlzLmNvbnN1bWUoJ10nKTtcbiAgICAgIH0gZWxzZSBpZiAobmV4dC50ZXh0ID09PSAnLicpIHtcbiAgICAgICAgcHJpbWFyeSA9IHsgdHlwZTogQVNULk1lbWJlckV4cHJlc3Npb24sIG9iamVjdDogcHJpbWFyeSwgcHJvcGVydHk6IHRoaXMuaWRlbnRpZmllcigpLCBjb21wdXRlZDogZmFsc2UgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudGhyb3dFcnJvcignSU1QT1NTSUJMRScpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcHJpbWFyeTtcbiAgfSxcblxuICBmaWx0ZXI6IGZ1bmN0aW9uKGJhc2VFeHByZXNzaW9uKSB7XG4gICAgdmFyIGFyZ3MgPSBbYmFzZUV4cHJlc3Npb25dO1xuICAgIHZhciByZXN1bHQgPSB7dHlwZTogQVNULkNhbGxFeHByZXNzaW9uLCBjYWxsZWU6IHRoaXMuaWRlbnRpZmllcigpLCBhcmd1bWVudHM6IGFyZ3MsIGZpbHRlcjogdHJ1ZX07XG5cbiAgICB3aGlsZSAodGhpcy5leHBlY3QoJzonKSkge1xuICAgICAgYXJncy5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LFxuXG4gIHBhcnNlQXJndW1lbnRzOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGlmICh0aGlzLnBlZWtUb2tlbigpLnRleHQgIT09ICcpJykge1xuICAgICAgZG8ge1xuICAgICAgICBhcmdzLnB1c2godGhpcy5leHByZXNzaW9uKCkpO1xuICAgICAgfSB3aGlsZSAodGhpcy5leHBlY3QoJywnKSk7XG4gICAgfVxuICAgIHJldHVybiBhcmdzO1xuICB9LFxuXG4gIGlkZW50aWZpZXI6IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0b2tlbiA9IHRoaXMuY29uc3VtZSgpO1xuICAgIGlmICghdG9rZW4uaWRlbnRpZmllcikge1xuICAgICAgdGhpcy50aHJvd0Vycm9yKCdpcyBub3QgYSB2YWxpZCBpZGVudGlmaWVyJywgdG9rZW4pO1xuICAgIH1cbiAgICByZXR1cm4geyB0eXBlOiBBU1QuSWRlbnRpZmllciwgbmFtZTogdG9rZW4udGV4dCB9O1xuICB9LFxuXG4gIGNvbnN0YW50OiBmdW5jdGlvbigpIHtcbiAgICAvLyBUT0RPIGNoZWNrIHRoYXQgaXQgaXMgYSBjb25zdGFudFxuICAgIHJldHVybiB7IHR5cGU6IEFTVC5MaXRlcmFsLCB2YWx1ZTogdGhpcy5jb25zdW1lKCkudmFsdWUgfTtcbiAgfSxcblxuICBhcnJheURlY2xhcmF0aW9uOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgZWxlbWVudHMgPSBbXTtcbiAgICBpZiAodGhpcy5wZWVrVG9rZW4oKS50ZXh0ICE9PSAnXScpIHtcbiAgICAgIGRvIHtcbiAgICAgICAgaWYgKHRoaXMucGVlaygnXScpKSB7XG4gICAgICAgICAgLy8gU3VwcG9ydCB0cmFpbGluZyBjb21tYXMgcGVyIEVTNS4xLlxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGVsZW1lbnRzLnB1c2godGhpcy5leHByZXNzaW9uKCkpO1xuICAgICAgfSB3aGlsZSAodGhpcy5leHBlY3QoJywnKSk7XG4gICAgfVxuICAgIHRoaXMuY29uc3VtZSgnXScpO1xuXG4gICAgcmV0dXJuIHsgdHlwZTogQVNULkFycmF5RXhwcmVzc2lvbiwgZWxlbWVudHM6IGVsZW1lbnRzIH07XG4gIH0sXG5cbiAgb2JqZWN0OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgcHJvcGVydGllcyA9IFtdLCBwcm9wZXJ0eTtcbiAgICBpZiAodGhpcy5wZWVrVG9rZW4oKS50ZXh0ICE9PSAnfScpIHtcbiAgICAgIGRvIHtcbiAgICAgICAgaWYgKHRoaXMucGVlaygnfScpKSB7XG4gICAgICAgICAgLy8gU3VwcG9ydCB0cmFpbGluZyBjb21tYXMgcGVyIEVTNS4xLlxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHByb3BlcnR5ID0ge3R5cGU6IEFTVC5Qcm9wZXJ0eSwga2luZDogJ2luaXQnfTtcbiAgICAgICAgaWYgKHRoaXMucGVlaygpLmNvbnN0YW50KSB7XG4gICAgICAgICAgcHJvcGVydHkua2V5ID0gdGhpcy5jb25zdGFudCgpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGVlaygpLmlkZW50aWZpZXIpIHtcbiAgICAgICAgICBwcm9wZXJ0eS5rZXkgPSB0aGlzLmlkZW50aWZpZXIoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnRocm93RXJyb3IoXCJpbnZhbGlkIGtleVwiLCB0aGlzLnBlZWsoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb25zdW1lKCc6Jyk7XG4gICAgICAgIHByb3BlcnR5LnZhbHVlID0gdGhpcy5leHByZXNzaW9uKCk7XG4gICAgICAgIHByb3BlcnRpZXMucHVzaChwcm9wZXJ0eSk7XG4gICAgICB9IHdoaWxlICh0aGlzLmV4cGVjdCgnLCcpKTtcbiAgICB9XG4gICAgdGhpcy5jb25zdW1lKCd9Jyk7XG5cbiAgICByZXR1cm4ge3R5cGU6IEFTVC5PYmplY3RFeHByZXNzaW9uLCBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzIH07XG4gIH0sXG5cbiAgdGhyb3dFcnJvcjogZnVuY3Rpb24obXNnLCB0b2tlbikge1xuICAgIHRocm93ICRwYXJzZU1pbkVycignc3ludGF4JyxcbiAgICAgICAgJ1N5bnRheCBFcnJvcjogVG9rZW4gXFwnezB9XFwnIHsxfSBhdCBjb2x1bW4gezJ9IG9mIHRoZSBleHByZXNzaW9uIFt7M31dIHN0YXJ0aW5nIGF0IFt7NH1dLicsXG4gICAgICAgICAgdG9rZW4udGV4dCwgbXNnLCAodG9rZW4uaW5kZXggKyAxKSwgdGhpcy50ZXh0LCB0aGlzLnRleHQuc3Vic3RyaW5nKHRva2VuLmluZGV4KSk7XG4gIH0sXG5cbiAgY29uc3VtZTogZnVuY3Rpb24oZTEpIHtcbiAgICBpZiAodGhpcy50b2tlbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyAkcGFyc2VNaW5FcnIoJ3Vlb2UnLCAnVW5leHBlY3RlZCBlbmQgb2YgZXhwcmVzc2lvbjogezB9JywgdGhpcy50ZXh0KTtcbiAgICB9XG5cbiAgICB2YXIgdG9rZW4gPSB0aGlzLmV4cGVjdChlMSk7XG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgdGhpcy50aHJvd0Vycm9yKCdpcyB1bmV4cGVjdGVkLCBleHBlY3RpbmcgWycgKyBlMSArICddJywgdGhpcy5wZWVrKCkpO1xuICAgIH1cbiAgICByZXR1cm4gdG9rZW47XG4gIH0sXG5cbiAgcGVla1Rva2VuOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy50b2tlbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyAkcGFyc2VNaW5FcnIoJ3Vlb2UnLCAnVW5leHBlY3RlZCBlbmQgb2YgZXhwcmVzc2lvbjogezB9JywgdGhpcy50ZXh0KTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudG9rZW5zWzBdO1xuICB9LFxuXG4gIHBlZWs6IGZ1bmN0aW9uKGUxLCBlMiwgZTMsIGU0KSB7XG4gICAgcmV0dXJuIHRoaXMucGVla0FoZWFkKDAsIGUxLCBlMiwgZTMsIGU0KTtcbiAgfSxcblxuICBwZWVrQWhlYWQ6IGZ1bmN0aW9uKGksIGUxLCBlMiwgZTMsIGU0KSB7XG4gICAgaWYgKHRoaXMudG9rZW5zLmxlbmd0aCA+IGkpIHtcbiAgICAgIHZhciB0b2tlbiA9IHRoaXMudG9rZW5zW2ldO1xuICAgICAgdmFyIHQgPSB0b2tlbi50ZXh0O1xuICAgICAgaWYgKHQgPT09IGUxIHx8IHQgPT09IGUyIHx8IHQgPT09IGUzIHx8IHQgPT09IGU0IHx8XG4gICAgICAgICAgKCFlMSAmJiAhZTIgJiYgIWUzICYmICFlNCkpIHtcbiAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG5cbiAgZXhwZWN0OiBmdW5jdGlvbihlMSwgZTIsIGUzLCBlNCkge1xuICAgIHZhciB0b2tlbiA9IHRoaXMucGVlayhlMSwgZTIsIGUzLCBlNCk7XG4gICAgaWYgKHRva2VuKSB7XG4gICAgICB0aGlzLnRva2Vucy5zaGlmdCgpO1xuICAgICAgcmV0dXJuIHRva2VuO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG5cblxuICAvKiBgdW5kZWZpbmVkYCBpcyBub3QgYSBjb25zdGFudCwgaXQgaXMgYW4gaWRlbnRpZmllcixcbiAgICogYnV0IHVzaW5nIGl0IGFzIGFuIGlkZW50aWZpZXIgaXMgbm90IHN1cHBvcnRlZFxuICAgKi9cbiAgY29uc3RhbnRzOiB7XG4gICAgJ3RydWUnOiB7IHR5cGU6IEFTVC5MaXRlcmFsLCB2YWx1ZTogdHJ1ZSB9LFxuICAgICdmYWxzZSc6IHsgdHlwZTogQVNULkxpdGVyYWwsIHZhbHVlOiBmYWxzZSB9LFxuICAgICdudWxsJzogeyB0eXBlOiBBU1QuTGl0ZXJhbCwgdmFsdWU6IG51bGwgfSxcbiAgICAndW5kZWZpbmVkJzoge3R5cGU6IEFTVC5MaXRlcmFsLCB2YWx1ZTogdW5kZWZpbmVkIH0sXG4gICAgJ3RoaXMnOiB7dHlwZTogQVNULlRoaXNFeHByZXNzaW9uIH0sXG4gICAgJyRsb2NhbHMnOiB7dHlwZTogQVNULkxvY2Fsc0V4cHJlc3Npb24gfVxuICB9XG59O1xuXG5mdW5jdGlvbiBpZkRlZmluZWQodiwgZCkge1xuICByZXR1cm4gdHlwZW9mIHYgIT09ICd1bmRlZmluZWQnID8gdiA6IGQ7XG59XG5cbmZ1bmN0aW9uIHBsdXNGbihsLCByKSB7XG4gIGlmICh0eXBlb2YgbCA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybiByO1xuICBpZiAodHlwZW9mIHIgPT09ICd1bmRlZmluZWQnKSByZXR1cm4gbDtcbiAgcmV0dXJuIGwgKyByO1xufVxuXG5mdW5jdGlvbiBpc1N0YXRlbGVzcygkZmlsdGVyLCBmaWx0ZXJOYW1lKSB7XG4gIHZhciBmbiA9ICRmaWx0ZXIoZmlsdGVyTmFtZSk7XG4gIHJldHVybiAhZm4uJHN0YXRlZnVsO1xufVxuXG5mdW5jdGlvbiBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGFzdCwgJGZpbHRlcikge1xuICB2YXIgYWxsQ29uc3RhbnRzO1xuICB2YXIgYXJnc1RvV2F0Y2g7XG4gIHN3aXRjaCAoYXN0LnR5cGUpIHtcbiAgY2FzZSBBU1QuUHJvZ3JhbTpcbiAgICBhbGxDb25zdGFudHMgPSB0cnVlO1xuICAgIGZvckVhY2goYXN0LmJvZHksIGZ1bmN0aW9uKGV4cHIpIHtcbiAgICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoZXhwci5leHByZXNzaW9uLCAkZmlsdGVyKTtcbiAgICAgIGFsbENvbnN0YW50cyA9IGFsbENvbnN0YW50cyAmJiBleHByLmV4cHJlc3Npb24uY29uc3RhbnQ7XG4gICAgfSk7XG4gICAgYXN0LmNvbnN0YW50ID0gYWxsQ29uc3RhbnRzO1xuICAgIGJyZWFrO1xuICBjYXNlIEFTVC5MaXRlcmFsOlxuICAgIGFzdC5jb25zdGFudCA9IHRydWU7XG4gICAgYXN0LnRvV2F0Y2ggPSBbXTtcbiAgICBicmVhaztcbiAgY2FzZSBBU1QuVW5hcnlFeHByZXNzaW9uOlxuICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LmFyZ3VtZW50LCAkZmlsdGVyKTtcbiAgICBhc3QuY29uc3RhbnQgPSBhc3QuYXJndW1lbnQuY29uc3RhbnQ7XG4gICAgYXN0LnRvV2F0Y2ggPSBhc3QuYXJndW1lbnQudG9XYXRjaDtcbiAgICBicmVhaztcbiAgY2FzZSBBU1QuQmluYXJ5RXhwcmVzc2lvbjpcbiAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGFzdC5sZWZ0LCAkZmlsdGVyKTtcbiAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGFzdC5yaWdodCwgJGZpbHRlcik7XG4gICAgYXN0LmNvbnN0YW50ID0gYXN0LmxlZnQuY29uc3RhbnQgJiYgYXN0LnJpZ2h0LmNvbnN0YW50O1xuICAgIGFzdC50b1dhdGNoID0gYXN0LmxlZnQudG9XYXRjaC5jb25jYXQoYXN0LnJpZ2h0LnRvV2F0Y2gpO1xuICAgIGJyZWFrO1xuICBjYXNlIEFTVC5Mb2dpY2FsRXhwcmVzc2lvbjpcbiAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGFzdC5sZWZ0LCAkZmlsdGVyKTtcbiAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGFzdC5yaWdodCwgJGZpbHRlcik7XG4gICAgYXN0LmNvbnN0YW50ID0gYXN0LmxlZnQuY29uc3RhbnQgJiYgYXN0LnJpZ2h0LmNvbnN0YW50O1xuICAgIGFzdC50b1dhdGNoID0gYXN0LmNvbnN0YW50ID8gW10gOiBbYXN0XTtcbiAgICBicmVhaztcbiAgY2FzZSBBU1QuQ29uZGl0aW9uYWxFeHByZXNzaW9uOlxuICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LnRlc3QsICRmaWx0ZXIpO1xuICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LmFsdGVybmF0ZSwgJGZpbHRlcik7XG4gICAgZmluZENvbnN0YW50QW5kV2F0Y2hFeHByZXNzaW9ucyhhc3QuY29uc2VxdWVudCwgJGZpbHRlcik7XG4gICAgYXN0LmNvbnN0YW50ID0gYXN0LnRlc3QuY29uc3RhbnQgJiYgYXN0LmFsdGVybmF0ZS5jb25zdGFudCAmJiBhc3QuY29uc2VxdWVudC5jb25zdGFudDtcbiAgICBhc3QudG9XYXRjaCA9IGFzdC5jb25zdGFudCA/IFtdIDogW2FzdF07XG4gICAgYnJlYWs7XG4gIGNhc2UgQVNULklkZW50aWZpZXI6XG4gICAgYXN0LmNvbnN0YW50ID0gZmFsc2U7XG4gICAgYXN0LnRvV2F0Y2ggPSBbYXN0XTtcbiAgICBicmVhaztcbiAgY2FzZSBBU1QuTWVtYmVyRXhwcmVzc2lvbjpcbiAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKGFzdC5vYmplY3QsICRmaWx0ZXIpO1xuICAgIGlmIChhc3QuY29tcHV0ZWQpIHtcbiAgICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LnByb3BlcnR5LCAkZmlsdGVyKTtcbiAgICB9XG4gICAgYXN0LmNvbnN0YW50ID0gYXN0Lm9iamVjdC5jb25zdGFudCAmJiAoIWFzdC5jb21wdXRlZCB8fCBhc3QucHJvcGVydHkuY29uc3RhbnQpO1xuICAgIGFzdC50b1dhdGNoID0gW2FzdF07XG4gICAgYnJlYWs7XG4gIGNhc2UgQVNULkNhbGxFeHByZXNzaW9uOlxuICAgIGFsbENvbnN0YW50cyA9IGFzdC5maWx0ZXIgPyBpc1N0YXRlbGVzcygkZmlsdGVyLCBhc3QuY2FsbGVlLm5hbWUpIDogZmFsc2U7XG4gICAgYXJnc1RvV2F0Y2ggPSBbXTtcbiAgICBmb3JFYWNoKGFzdC5hcmd1bWVudHMsIGZ1bmN0aW9uKGV4cHIpIHtcbiAgICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoZXhwciwgJGZpbHRlcik7XG4gICAgICBhbGxDb25zdGFudHMgPSBhbGxDb25zdGFudHMgJiYgZXhwci5jb25zdGFudDtcbiAgICAgIGlmICghZXhwci5jb25zdGFudCkge1xuICAgICAgICBhcmdzVG9XYXRjaC5wdXNoLmFwcGx5KGFyZ3NUb1dhdGNoLCBleHByLnRvV2F0Y2gpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGFzdC5jb25zdGFudCA9IGFsbENvbnN0YW50cztcbiAgICBhc3QudG9XYXRjaCA9IGFzdC5maWx0ZXIgJiYgaXNTdGF0ZWxlc3MoJGZpbHRlciwgYXN0LmNhbGxlZS5uYW1lKSA/IGFyZ3NUb1dhdGNoIDogW2FzdF07XG4gICAgYnJlYWs7XG4gIGNhc2UgQVNULkFzc2lnbm1lbnRFeHByZXNzaW9uOlxuICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LmxlZnQsICRmaWx0ZXIpO1xuICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LnJpZ2h0LCAkZmlsdGVyKTtcbiAgICBhc3QuY29uc3RhbnQgPSBhc3QubGVmdC5jb25zdGFudCAmJiBhc3QucmlnaHQuY29uc3RhbnQ7XG4gICAgYXN0LnRvV2F0Y2ggPSBbYXN0XTtcbiAgICBicmVhaztcbiAgY2FzZSBBU1QuQXJyYXlFeHByZXNzaW9uOlxuICAgIGFsbENvbnN0YW50cyA9IHRydWU7XG4gICAgYXJnc1RvV2F0Y2ggPSBbXTtcbiAgICBmb3JFYWNoKGFzdC5lbGVtZW50cywgZnVuY3Rpb24oZXhwcikge1xuICAgICAgZmluZENvbnN0YW50QW5kV2F0Y2hFeHByZXNzaW9ucyhleHByLCAkZmlsdGVyKTtcbiAgICAgIGFsbENvbnN0YW50cyA9IGFsbENvbnN0YW50cyAmJiBleHByLmNvbnN0YW50O1xuICAgICAgaWYgKCFleHByLmNvbnN0YW50KSB7XG4gICAgICAgIGFyZ3NUb1dhdGNoLnB1c2guYXBwbHkoYXJnc1RvV2F0Y2gsIGV4cHIudG9XYXRjaCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgYXN0LmNvbnN0YW50ID0gYWxsQ29uc3RhbnRzO1xuICAgIGFzdC50b1dhdGNoID0gYXJnc1RvV2F0Y2g7XG4gICAgYnJlYWs7XG4gIGNhc2UgQVNULk9iamVjdEV4cHJlc3Npb246XG4gICAgYWxsQ29uc3RhbnRzID0gdHJ1ZTtcbiAgICBhcmdzVG9XYXRjaCA9IFtdO1xuICAgIGZvckVhY2goYXN0LnByb3BlcnRpZXMsIGZ1bmN0aW9uKHByb3BlcnR5KSB7XG4gICAgICBmaW5kQ29uc3RhbnRBbmRXYXRjaEV4cHJlc3Npb25zKHByb3BlcnR5LnZhbHVlLCAkZmlsdGVyKTtcbiAgICAgIGFsbENvbnN0YW50cyA9IGFsbENvbnN0YW50cyAmJiBwcm9wZXJ0eS52YWx1ZS5jb25zdGFudDtcbiAgICAgIGlmICghcHJvcGVydHkudmFsdWUuY29uc3RhbnQpIHtcbiAgICAgICAgYXJnc1RvV2F0Y2gucHVzaC5hcHBseShhcmdzVG9XYXRjaCwgcHJvcGVydHkudmFsdWUudG9XYXRjaCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgYXN0LmNvbnN0YW50ID0gYWxsQ29uc3RhbnRzO1xuICAgIGFzdC50b1dhdGNoID0gYXJnc1RvV2F0Y2g7XG4gICAgYnJlYWs7XG4gIGNhc2UgQVNULlRoaXNFeHByZXNzaW9uOlxuICAgIGFzdC5jb25zdGFudCA9IGZhbHNlO1xuICAgIGFzdC50b1dhdGNoID0gW107XG4gICAgYnJlYWs7XG4gIGNhc2UgQVNULkxvY2Fsc0V4cHJlc3Npb246XG4gICAgYXN0LmNvbnN0YW50ID0gZmFsc2U7XG4gICAgYXN0LnRvV2F0Y2ggPSBbXTtcbiAgICBicmVhaztcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRJbnB1dHMoYm9keSkge1xuICBpZiAoYm9keS5sZW5ndGggIT0gMSkgcmV0dXJuO1xuICB2YXIgbGFzdEV4cHJlc3Npb24gPSBib2R5WzBdLmV4cHJlc3Npb247XG4gIHZhciBjYW5kaWRhdGUgPSBsYXN0RXhwcmVzc2lvbi50b1dhdGNoO1xuICBpZiAoY2FuZGlkYXRlLmxlbmd0aCAhPT0gMSkgcmV0dXJuIGNhbmRpZGF0ZTtcbiAgcmV0dXJuIGNhbmRpZGF0ZVswXSAhPT0gbGFzdEV4cHJlc3Npb24gPyBjYW5kaWRhdGUgOiB1bmRlZmluZWQ7XG59XG5cbmZ1bmN0aW9uIGlzQXNzaWduYWJsZShhc3QpIHtcbiAgcmV0dXJuIGFzdC50eXBlID09PSBBU1QuSWRlbnRpZmllciB8fCBhc3QudHlwZSA9PT0gQVNULk1lbWJlckV4cHJlc3Npb247XG59XG5cbmZ1bmN0aW9uIGFzc2lnbmFibGVBU1QoYXN0KSB7XG4gIGlmIChhc3QuYm9keS5sZW5ndGggPT09IDEgJiYgaXNBc3NpZ25hYmxlKGFzdC5ib2R5WzBdLmV4cHJlc3Npb24pKSB7XG4gICAgcmV0dXJuIHt0eXBlOiBBU1QuQXNzaWdubWVudEV4cHJlc3Npb24sIGxlZnQ6IGFzdC5ib2R5WzBdLmV4cHJlc3Npb24sIHJpZ2h0OiB7dHlwZTogQVNULk5HVmFsdWVQYXJhbWV0ZXJ9LCBvcGVyYXRvcjogJz0nfTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpc0xpdGVyYWwoYXN0KSB7XG4gIHJldHVybiBhc3QuYm9keS5sZW5ndGggPT09IDAgfHxcbiAgICAgIGFzdC5ib2R5Lmxlbmd0aCA9PT0gMSAmJiAoXG4gICAgICBhc3QuYm9keVswXS5leHByZXNzaW9uLnR5cGUgPT09IEFTVC5MaXRlcmFsIHx8XG4gICAgICBhc3QuYm9keVswXS5leHByZXNzaW9uLnR5cGUgPT09IEFTVC5BcnJheUV4cHJlc3Npb24gfHxcbiAgICAgIGFzdC5ib2R5WzBdLmV4cHJlc3Npb24udHlwZSA9PT0gQVNULk9iamVjdEV4cHJlc3Npb24pO1xufVxuXG5mdW5jdGlvbiBpc0NvbnN0YW50KGFzdCkge1xuICByZXR1cm4gYXN0LmNvbnN0YW50O1xufVxuXG5mdW5jdGlvbiBBU1RDb21waWxlcihhc3RCdWlsZGVyLCAkZmlsdGVyKSB7XG4gIHRoaXMuYXN0QnVpbGRlciA9IGFzdEJ1aWxkZXI7XG4gIHRoaXMuJGZpbHRlciA9ICRmaWx0ZXI7XG59XG5cbkFTVENvbXBpbGVyLnByb3RvdHlwZSA9IHtcbiAgY29tcGlsZTogZnVuY3Rpb24oZXhwcmVzc2lvbiwgZXhwZW5zaXZlQ2hlY2tzKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBhc3QgPSB0aGlzLmFzdEJ1aWxkZXIuYXN0KGV4cHJlc3Npb24pO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBuZXh0SWQ6IDAsXG4gICAgICBmaWx0ZXJzOiB7fSxcbiAgICAgIGV4cGVuc2l2ZUNoZWNrczogZXhwZW5zaXZlQ2hlY2tzLFxuICAgICAgZm46IHt2YXJzOiBbXSwgYm9keTogW10sIG93bjoge319LFxuICAgICAgYXNzaWduOiB7dmFyczogW10sIGJvZHk6IFtdLCBvd246IHt9fSxcbiAgICAgIGlucHV0czogW11cbiAgICB9O1xuICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LCBzZWxmLiRmaWx0ZXIpO1xuICAgIHZhciBleHRyYSA9ICcnO1xuICAgIHZhciBhc3NpZ25hYmxlO1xuICAgIHRoaXMuc3RhZ2UgPSAnYXNzaWduJztcbiAgICBpZiAoKGFzc2lnbmFibGUgPSBhc3NpZ25hYmxlQVNUKGFzdCkpKSB7XG4gICAgICB0aGlzLnN0YXRlLmNvbXB1dGluZyA9ICdhc3NpZ24nO1xuICAgICAgdmFyIHJlc3VsdCA9IHRoaXMubmV4dElkKCk7XG4gICAgICB0aGlzLnJlY3Vyc2UoYXNzaWduYWJsZSwgcmVzdWx0KTtcbiAgICAgIHRoaXMucmV0dXJuXyhyZXN1bHQpO1xuICAgICAgZXh0cmEgPSAnZm4uYXNzaWduPScgKyB0aGlzLmdlbmVyYXRlRnVuY3Rpb24oJ2Fzc2lnbicsICdzLHYsbCcpO1xuICAgIH1cbiAgICB2YXIgdG9XYXRjaCA9IGdldElucHV0cyhhc3QuYm9keSk7XG4gICAgc2VsZi5zdGFnZSA9ICdpbnB1dHMnO1xuICAgIGZvckVhY2godG9XYXRjaCwgZnVuY3Rpb24od2F0Y2gsIGtleSkge1xuICAgICAgdmFyIGZuS2V5ID0gJ2ZuJyArIGtleTtcbiAgICAgIHNlbGYuc3RhdGVbZm5LZXldID0ge3ZhcnM6IFtdLCBib2R5OiBbXSwgb3duOiB7fX07XG4gICAgICBzZWxmLnN0YXRlLmNvbXB1dGluZyA9IGZuS2V5O1xuICAgICAgdmFyIGludG9JZCA9IHNlbGYubmV4dElkKCk7XG4gICAgICBzZWxmLnJlY3Vyc2Uod2F0Y2gsIGludG9JZCk7XG4gICAgICBzZWxmLnJldHVybl8oaW50b0lkKTtcbiAgICAgIHNlbGYuc3RhdGUuaW5wdXRzLnB1c2goZm5LZXkpO1xuICAgICAgd2F0Y2gud2F0Y2hJZCA9IGtleTtcbiAgICB9KTtcbiAgICB0aGlzLnN0YXRlLmNvbXB1dGluZyA9ICdmbic7XG4gICAgdGhpcy5zdGFnZSA9ICdtYWluJztcbiAgICB0aGlzLnJlY3Vyc2UoYXN0KTtcbiAgICB2YXIgZm5TdHJpbmcgPVxuICAgICAgLy8gVGhlIGJ1aWxkIGFuZCBtaW5pZmljYXRpb24gc3RlcHMgcmVtb3ZlIHRoZSBzdHJpbmcgXCJ1c2Ugc3RyaWN0XCIgZnJvbSB0aGUgY29kZSwgYnV0IHRoaXMgaXMgZG9uZSB1c2luZyBhIHJlZ2V4LlxuICAgICAgLy8gVGhpcyBpcyBhIHdvcmthcm91bmQgZm9yIHRoaXMgdW50aWwgd2UgZG8gYSBiZXR0ZXIgam9iIGF0IG9ubHkgcmVtb3ZpbmcgdGhlIHByZWZpeCBvbmx5IHdoZW4gd2Ugc2hvdWxkLlxuICAgICAgJ1wiJyArIHRoaXMuVVNFICsgJyAnICsgdGhpcy5TVFJJQ1QgKyAnXCI7XFxuJyArXG4gICAgICB0aGlzLmZpbHRlclByZWZpeCgpICtcbiAgICAgICd2YXIgZm49JyArIHRoaXMuZ2VuZXJhdGVGdW5jdGlvbignZm4nLCAncyxsLGEsaScpICtcbiAgICAgIGV4dHJhICtcbiAgICAgIHRoaXMud2F0Y2hGbnMoKSArXG4gICAgICAncmV0dXJuIGZuOyc7XG5cbiAgICAvKiBqc2hpbnQgLVcwNTQgKi9cbiAgICB2YXIgZm4gPSAobmV3IEZ1bmN0aW9uKCckZmlsdGVyJyxcbiAgICAgICAgJ2Vuc3VyZVNhZmVNZW1iZXJOYW1lJyxcbiAgICAgICAgJ2Vuc3VyZVNhZmVPYmplY3QnLFxuICAgICAgICAnZW5zdXJlU2FmZUZ1bmN0aW9uJyxcbiAgICAgICAgJ2dldFN0cmluZ1ZhbHVlJyxcbiAgICAgICAgJ2Vuc3VyZVNhZmVBc3NpZ25Db250ZXh0JyxcbiAgICAgICAgJ2lmRGVmaW5lZCcsXG4gICAgICAgICdwbHVzJyxcbiAgICAgICAgJ3RleHQnLFxuICAgICAgICBmblN0cmluZykpKFxuICAgICAgICAgIHRoaXMuJGZpbHRlcixcbiAgICAgICAgICBlbnN1cmVTYWZlTWVtYmVyTmFtZSxcbiAgICAgICAgICBlbnN1cmVTYWZlT2JqZWN0LFxuICAgICAgICAgIGVuc3VyZVNhZmVGdW5jdGlvbixcbiAgICAgICAgICBnZXRTdHJpbmdWYWx1ZSxcbiAgICAgICAgICBlbnN1cmVTYWZlQXNzaWduQ29udGV4dCxcbiAgICAgICAgICBpZkRlZmluZWQsXG4gICAgICAgICAgcGx1c0ZuLFxuICAgICAgICAgIGV4cHJlc3Npb24pO1xuICAgIC8qIGpzaGludCArVzA1NCAqL1xuICAgIHRoaXMuc3RhdGUgPSB0aGlzLnN0YWdlID0gdW5kZWZpbmVkO1xuICAgIGZuLmxpdGVyYWwgPSBpc0xpdGVyYWwoYXN0KTtcbiAgICBmbi5jb25zdGFudCA9IGlzQ29uc3RhbnQoYXN0KTtcbiAgICByZXR1cm4gZm47XG4gIH0sXG5cbiAgVVNFOiAndXNlJyxcblxuICBTVFJJQ1Q6ICdzdHJpY3QnLFxuXG4gIHdhdGNoRm5zOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgdmFyIGZucyA9IHRoaXMuc3RhdGUuaW5wdXRzO1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBmb3JFYWNoKGZucywgZnVuY3Rpb24obmFtZSkge1xuICAgICAgcmVzdWx0LnB1c2goJ3ZhciAnICsgbmFtZSArICc9JyArIHNlbGYuZ2VuZXJhdGVGdW5jdGlvbihuYW1lLCAncycpKTtcbiAgICB9KTtcbiAgICBpZiAoZm5zLmxlbmd0aCkge1xuICAgICAgcmVzdWx0LnB1c2goJ2ZuLmlucHV0cz1bJyArIGZucy5qb2luKCcsJykgKyAnXTsnKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdC5qb2luKCcnKTtcbiAgfSxcblxuICBnZW5lcmF0ZUZ1bmN0aW9uOiBmdW5jdGlvbihuYW1lLCBwYXJhbXMpIHtcbiAgICByZXR1cm4gJ2Z1bmN0aW9uKCcgKyBwYXJhbXMgKyAnKXsnICtcbiAgICAgICAgdGhpcy52YXJzUHJlZml4KG5hbWUpICtcbiAgICAgICAgdGhpcy5ib2R5KG5hbWUpICtcbiAgICAgICAgJ307JztcbiAgfSxcblxuICBmaWx0ZXJQcmVmaXg6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwYXJ0cyA9IFtdO1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBmb3JFYWNoKHRoaXMuc3RhdGUuZmlsdGVycywgZnVuY3Rpb24oaWQsIGZpbHRlcikge1xuICAgICAgcGFydHMucHVzaChpZCArICc9JGZpbHRlcignICsgc2VsZi5lc2NhcGUoZmlsdGVyKSArICcpJyk7XG4gICAgfSk7XG4gICAgaWYgKHBhcnRzLmxlbmd0aCkgcmV0dXJuICd2YXIgJyArIHBhcnRzLmpvaW4oJywnKSArICc7JztcbiAgICByZXR1cm4gJyc7XG4gIH0sXG5cbiAgdmFyc1ByZWZpeDogZnVuY3Rpb24oc2VjdGlvbikge1xuICAgIHJldHVybiB0aGlzLnN0YXRlW3NlY3Rpb25dLnZhcnMubGVuZ3RoID8gJ3ZhciAnICsgdGhpcy5zdGF0ZVtzZWN0aW9uXS52YXJzLmpvaW4oJywnKSArICc7JyA6ICcnO1xuICB9LFxuXG4gIGJvZHk6IGZ1bmN0aW9uKHNlY3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZVtzZWN0aW9uXS5ib2R5LmpvaW4oJycpO1xuICB9LFxuXG4gIHJlY3Vyc2U6IGZ1bmN0aW9uKGFzdCwgaW50b0lkLCBuYW1lSWQsIHJlY3Vyc2lvbkZuLCBjcmVhdGUsIHNraXBXYXRjaElkQ2hlY2spIHtcbiAgICB2YXIgbGVmdCwgcmlnaHQsIHNlbGYgPSB0aGlzLCBhcmdzLCBleHByZXNzaW9uO1xuICAgIHJlY3Vyc2lvbkZuID0gcmVjdXJzaW9uRm4gfHwgbm9vcDtcbiAgICBpZiAoIXNraXBXYXRjaElkQ2hlY2sgJiYgaXNEZWZpbmVkKGFzdC53YXRjaElkKSkge1xuICAgICAgaW50b0lkID0gaW50b0lkIHx8IHRoaXMubmV4dElkKCk7XG4gICAgICB0aGlzLmlmXygnaScsXG4gICAgICAgIHRoaXMubGF6eUFzc2lnbihpbnRvSWQsIHRoaXMuY29tcHV0ZWRNZW1iZXIoJ2knLCBhc3Qud2F0Y2hJZCkpLFxuICAgICAgICB0aGlzLmxhenlSZWN1cnNlKGFzdCwgaW50b0lkLCBuYW1lSWQsIHJlY3Vyc2lvbkZuLCBjcmVhdGUsIHRydWUpXG4gICAgICApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzd2l0Y2ggKGFzdC50eXBlKSB7XG4gICAgY2FzZSBBU1QuUHJvZ3JhbTpcbiAgICAgIGZvckVhY2goYXN0LmJvZHksIGZ1bmN0aW9uKGV4cHJlc3Npb24sIHBvcykge1xuICAgICAgICBzZWxmLnJlY3Vyc2UoZXhwcmVzc2lvbi5leHByZXNzaW9uLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgZnVuY3Rpb24oZXhwcikgeyByaWdodCA9IGV4cHI7IH0pO1xuICAgICAgICBpZiAocG9zICE9PSBhc3QuYm9keS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgc2VsZi5jdXJyZW50KCkuYm9keS5wdXNoKHJpZ2h0LCAnOycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNlbGYucmV0dXJuXyhyaWdodCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBBU1QuTGl0ZXJhbDpcbiAgICAgIGV4cHJlc3Npb24gPSB0aGlzLmVzY2FwZShhc3QudmFsdWUpO1xuICAgICAgdGhpcy5hc3NpZ24oaW50b0lkLCBleHByZXNzaW9uKTtcbiAgICAgIHJlY3Vyc2lvbkZuKGV4cHJlc3Npb24pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBBU1QuVW5hcnlFeHByZXNzaW9uOlxuICAgICAgdGhpcy5yZWN1cnNlKGFzdC5hcmd1bWVudCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGZ1bmN0aW9uKGV4cHIpIHsgcmlnaHQgPSBleHByOyB9KTtcbiAgICAgIGV4cHJlc3Npb24gPSBhc3Qub3BlcmF0b3IgKyAnKCcgKyB0aGlzLmlmRGVmaW5lZChyaWdodCwgMCkgKyAnKSc7XG4gICAgICB0aGlzLmFzc2lnbihpbnRvSWQsIGV4cHJlc3Npb24pO1xuICAgICAgcmVjdXJzaW9uRm4oZXhwcmVzc2lvbik7XG4gICAgICBicmVhaztcbiAgICBjYXNlIEFTVC5CaW5hcnlFeHByZXNzaW9uOlxuICAgICAgdGhpcy5yZWN1cnNlKGFzdC5sZWZ0LCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgZnVuY3Rpb24oZXhwcikgeyBsZWZ0ID0gZXhwcjsgfSk7XG4gICAgICB0aGlzLnJlY3Vyc2UoYXN0LnJpZ2h0LCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgZnVuY3Rpb24oZXhwcikgeyByaWdodCA9IGV4cHI7IH0pO1xuICAgICAgaWYgKGFzdC5vcGVyYXRvciA9PT0gJysnKSB7XG4gICAgICAgIGV4cHJlc3Npb24gPSB0aGlzLnBsdXMobGVmdCwgcmlnaHQpO1xuICAgICAgfSBlbHNlIGlmIChhc3Qub3BlcmF0b3IgPT09ICctJykge1xuICAgICAgICBleHByZXNzaW9uID0gdGhpcy5pZkRlZmluZWQobGVmdCwgMCkgKyBhc3Qub3BlcmF0b3IgKyB0aGlzLmlmRGVmaW5lZChyaWdodCwgMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBleHByZXNzaW9uID0gJygnICsgbGVmdCArICcpJyArIGFzdC5vcGVyYXRvciArICcoJyArIHJpZ2h0ICsgJyknO1xuICAgICAgfVxuICAgICAgdGhpcy5hc3NpZ24oaW50b0lkLCBleHByZXNzaW9uKTtcbiAgICAgIHJlY3Vyc2lvbkZuKGV4cHJlc3Npb24pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBBU1QuTG9naWNhbEV4cHJlc3Npb246XG4gICAgICBpbnRvSWQgPSBpbnRvSWQgfHwgdGhpcy5uZXh0SWQoKTtcbiAgICAgIHNlbGYucmVjdXJzZShhc3QubGVmdCwgaW50b0lkKTtcbiAgICAgIHNlbGYuaWZfKGFzdC5vcGVyYXRvciA9PT0gJyYmJyA/IGludG9JZCA6IHNlbGYubm90KGludG9JZCksIHNlbGYubGF6eVJlY3Vyc2UoYXN0LnJpZ2h0LCBpbnRvSWQpKTtcbiAgICAgIHJlY3Vyc2lvbkZuKGludG9JZCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIEFTVC5Db25kaXRpb25hbEV4cHJlc3Npb246XG4gICAgICBpbnRvSWQgPSBpbnRvSWQgfHwgdGhpcy5uZXh0SWQoKTtcbiAgICAgIHNlbGYucmVjdXJzZShhc3QudGVzdCwgaW50b0lkKTtcbiAgICAgIHNlbGYuaWZfKGludG9JZCwgc2VsZi5sYXp5UmVjdXJzZShhc3QuYWx0ZXJuYXRlLCBpbnRvSWQpLCBzZWxmLmxhenlSZWN1cnNlKGFzdC5jb25zZXF1ZW50LCBpbnRvSWQpKTtcbiAgICAgIHJlY3Vyc2lvbkZuKGludG9JZCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIEFTVC5JZGVudGlmaWVyOlxuICAgICAgaW50b0lkID0gaW50b0lkIHx8IHRoaXMubmV4dElkKCk7XG4gICAgICBpZiAobmFtZUlkKSB7XG4gICAgICAgIG5hbWVJZC5jb250ZXh0ID0gc2VsZi5zdGFnZSA9PT0gJ2lucHV0cycgPyAncycgOiB0aGlzLmFzc2lnbih0aGlzLm5leHRJZCgpLCB0aGlzLmdldEhhc093blByb3BlcnR5KCdsJywgYXN0Lm5hbWUpICsgJz9sOnMnKTtcbiAgICAgICAgbmFtZUlkLmNvbXB1dGVkID0gZmFsc2U7XG4gICAgICAgIG5hbWVJZC5uYW1lID0gYXN0Lm5hbWU7XG4gICAgICB9XG4gICAgICBlbnN1cmVTYWZlTWVtYmVyTmFtZShhc3QubmFtZSk7XG4gICAgICBzZWxmLmlmXyhzZWxmLnN0YWdlID09PSAnaW5wdXRzJyB8fCBzZWxmLm5vdChzZWxmLmdldEhhc093blByb3BlcnR5KCdsJywgYXN0Lm5hbWUpKSxcbiAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgc2VsZi5pZl8oc2VsZi5zdGFnZSA9PT0gJ2lucHV0cycgfHwgJ3MnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChjcmVhdGUgJiYgY3JlYXRlICE9PSAxKSB7XG4gICAgICAgICAgICAgIHNlbGYuaWZfKFxuICAgICAgICAgICAgICAgIHNlbGYubm90KHNlbGYubm9uQ29tcHV0ZWRNZW1iZXIoJ3MnLCBhc3QubmFtZSkpLFxuICAgICAgICAgICAgICAgIHNlbGYubGF6eUFzc2lnbihzZWxmLm5vbkNvbXB1dGVkTWVtYmVyKCdzJywgYXN0Lm5hbWUpLCAne30nKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLmFzc2lnbihpbnRvSWQsIHNlbGYubm9uQ29tcHV0ZWRNZW1iZXIoJ3MnLCBhc3QubmFtZSkpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9LCBpbnRvSWQgJiYgc2VsZi5sYXp5QXNzaWduKGludG9JZCwgc2VsZi5ub25Db21wdXRlZE1lbWJlcignbCcsIGFzdC5uYW1lKSlcbiAgICAgICAgKTtcbiAgICAgIGlmIChzZWxmLnN0YXRlLmV4cGVuc2l2ZUNoZWNrcyB8fCBpc1Bvc3NpYmx5RGFuZ2Vyb3VzTWVtYmVyTmFtZShhc3QubmFtZSkpIHtcbiAgICAgICAgc2VsZi5hZGRFbnN1cmVTYWZlT2JqZWN0KGludG9JZCk7XG4gICAgICB9XG4gICAgICByZWN1cnNpb25GbihpbnRvSWQpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBBU1QuTWVtYmVyRXhwcmVzc2lvbjpcbiAgICAgIGxlZnQgPSBuYW1lSWQgJiYgKG5hbWVJZC5jb250ZXh0ID0gdGhpcy5uZXh0SWQoKSkgfHwgdGhpcy5uZXh0SWQoKTtcbiAgICAgIGludG9JZCA9IGludG9JZCB8fCB0aGlzLm5leHRJZCgpO1xuICAgICAgc2VsZi5yZWN1cnNlKGFzdC5vYmplY3QsIGxlZnQsIHVuZGVmaW5lZCwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlbGYuaWZfKHNlbGYubm90TnVsbChsZWZ0KSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKGNyZWF0ZSAmJiBjcmVhdGUgIT09IDEpIHtcbiAgICAgICAgICAgIHNlbGYuYWRkRW5zdXJlU2FmZUFzc2lnbkNvbnRleHQobGVmdCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChhc3QuY29tcHV0ZWQpIHtcbiAgICAgICAgICAgIHJpZ2h0ID0gc2VsZi5uZXh0SWQoKTtcbiAgICAgICAgICAgIHNlbGYucmVjdXJzZShhc3QucHJvcGVydHksIHJpZ2h0KTtcbiAgICAgICAgICAgIHNlbGYuZ2V0U3RyaW5nVmFsdWUocmlnaHQpO1xuICAgICAgICAgICAgc2VsZi5hZGRFbnN1cmVTYWZlTWVtYmVyTmFtZShyaWdodCk7XG4gICAgICAgICAgICBpZiAoY3JlYXRlICYmIGNyZWF0ZSAhPT0gMSkge1xuICAgICAgICAgICAgICBzZWxmLmlmXyhzZWxmLm5vdChzZWxmLmNvbXB1dGVkTWVtYmVyKGxlZnQsIHJpZ2h0KSksIHNlbGYubGF6eUFzc2lnbihzZWxmLmNvbXB1dGVkTWVtYmVyKGxlZnQsIHJpZ2h0KSwgJ3t9JykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXhwcmVzc2lvbiA9IHNlbGYuZW5zdXJlU2FmZU9iamVjdChzZWxmLmNvbXB1dGVkTWVtYmVyKGxlZnQsIHJpZ2h0KSk7XG4gICAgICAgICAgICBzZWxmLmFzc2lnbihpbnRvSWQsIGV4cHJlc3Npb24pO1xuICAgICAgICAgICAgaWYgKG5hbWVJZCkge1xuICAgICAgICAgICAgICBuYW1lSWQuY29tcHV0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICBuYW1lSWQubmFtZSA9IHJpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbnN1cmVTYWZlTWVtYmVyTmFtZShhc3QucHJvcGVydHkubmFtZSk7XG4gICAgICAgICAgICBpZiAoY3JlYXRlICYmIGNyZWF0ZSAhPT0gMSkge1xuICAgICAgICAgICAgICBzZWxmLmlmXyhzZWxmLm5vdChzZWxmLm5vbkNvbXB1dGVkTWVtYmVyKGxlZnQsIGFzdC5wcm9wZXJ0eS5uYW1lKSksIHNlbGYubGF6eUFzc2lnbihzZWxmLm5vbkNvbXB1dGVkTWVtYmVyKGxlZnQsIGFzdC5wcm9wZXJ0eS5uYW1lKSwgJ3t9JykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXhwcmVzc2lvbiA9IHNlbGYubm9uQ29tcHV0ZWRNZW1iZXIobGVmdCwgYXN0LnByb3BlcnR5Lm5hbWUpO1xuICAgICAgICAgICAgaWYgKHNlbGYuc3RhdGUuZXhwZW5zaXZlQ2hlY2tzIHx8IGlzUG9zc2libHlEYW5nZXJvdXNNZW1iZXJOYW1lKGFzdC5wcm9wZXJ0eS5uYW1lKSkge1xuICAgICAgICAgICAgICBleHByZXNzaW9uID0gc2VsZi5lbnN1cmVTYWZlT2JqZWN0KGV4cHJlc3Npb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5hc3NpZ24oaW50b0lkLCBleHByZXNzaW9uKTtcbiAgICAgICAgICAgIGlmIChuYW1lSWQpIHtcbiAgICAgICAgICAgICAgbmFtZUlkLmNvbXB1dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgIG5hbWVJZC5uYW1lID0gYXN0LnByb3BlcnR5Lm5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBzZWxmLmFzc2lnbihpbnRvSWQsICd1bmRlZmluZWQnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJlY3Vyc2lvbkZuKGludG9JZCk7XG4gICAgICB9LCAhIWNyZWF0ZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIEFTVC5DYWxsRXhwcmVzc2lvbjpcbiAgICAgIGludG9JZCA9IGludG9JZCB8fCB0aGlzLm5leHRJZCgpO1xuICAgICAgaWYgKGFzdC5maWx0ZXIpIHtcbiAgICAgICAgcmlnaHQgPSBzZWxmLmZpbHRlcihhc3QuY2FsbGVlLm5hbWUpO1xuICAgICAgICBhcmdzID0gW107XG4gICAgICAgIGZvckVhY2goYXN0LmFyZ3VtZW50cywgZnVuY3Rpb24oZXhwcikge1xuICAgICAgICAgIHZhciBhcmd1bWVudCA9IHNlbGYubmV4dElkKCk7XG4gICAgICAgICAgc2VsZi5yZWN1cnNlKGV4cHIsIGFyZ3VtZW50KTtcbiAgICAgICAgICBhcmdzLnB1c2goYXJndW1lbnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgZXhwcmVzc2lvbiA9IHJpZ2h0ICsgJygnICsgYXJncy5qb2luKCcsJykgKyAnKSc7XG4gICAgICAgIHNlbGYuYXNzaWduKGludG9JZCwgZXhwcmVzc2lvbik7XG4gICAgICAgIHJlY3Vyc2lvbkZuKGludG9JZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByaWdodCA9IHNlbGYubmV4dElkKCk7XG4gICAgICAgIGxlZnQgPSB7fTtcbiAgICAgICAgYXJncyA9IFtdO1xuICAgICAgICBzZWxmLnJlY3Vyc2UoYXN0LmNhbGxlZSwgcmlnaHQsIGxlZnQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHNlbGYuaWZfKHNlbGYubm90TnVsbChyaWdodCksIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5hZGRFbnN1cmVTYWZlRnVuY3Rpb24ocmlnaHQpO1xuICAgICAgICAgICAgZm9yRWFjaChhc3QuYXJndW1lbnRzLCBmdW5jdGlvbihleHByKSB7XG4gICAgICAgICAgICAgIHNlbGYucmVjdXJzZShleHByLCBzZWxmLm5leHRJZCgpLCB1bmRlZmluZWQsIGZ1bmN0aW9uKGFyZ3VtZW50KSB7XG4gICAgICAgICAgICAgICAgYXJncy5wdXNoKHNlbGYuZW5zdXJlU2FmZU9iamVjdChhcmd1bWVudCkpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGxlZnQubmFtZSkge1xuICAgICAgICAgICAgICBpZiAoIXNlbGYuc3RhdGUuZXhwZW5zaXZlQ2hlY2tzKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5hZGRFbnN1cmVTYWZlT2JqZWN0KGxlZnQuY29udGV4dCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZXhwcmVzc2lvbiA9IHNlbGYubWVtYmVyKGxlZnQuY29udGV4dCwgbGVmdC5uYW1lLCBsZWZ0LmNvbXB1dGVkKSArICcoJyArIGFyZ3Muam9pbignLCcpICsgJyknO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZXhwcmVzc2lvbiA9IHJpZ2h0ICsgJygnICsgYXJncy5qb2luKCcsJykgKyAnKSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBleHByZXNzaW9uID0gc2VsZi5lbnN1cmVTYWZlT2JqZWN0KGV4cHJlc3Npb24pO1xuICAgICAgICAgICAgc2VsZi5hc3NpZ24oaW50b0lkLCBleHByZXNzaW9uKTtcbiAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYuYXNzaWduKGludG9JZCwgJ3VuZGVmaW5lZCcpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJlY3Vyc2lvbkZuKGludG9JZCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBBU1QuQXNzaWdubWVudEV4cHJlc3Npb246XG4gICAgICByaWdodCA9IHRoaXMubmV4dElkKCk7XG4gICAgICBsZWZ0ID0ge307XG4gICAgICBpZiAoIWlzQXNzaWduYWJsZShhc3QubGVmdCkpIHtcbiAgICAgICAgdGhyb3cgJHBhcnNlTWluRXJyKCdsdmFsJywgJ1RyeWluZyB0byBhc3NpZ24gYSB2YWx1ZSB0byBhIG5vbiBsLXZhbHVlJyk7XG4gICAgICB9XG4gICAgICB0aGlzLnJlY3Vyc2UoYXN0LmxlZnQsIHVuZGVmaW5lZCwgbGVmdCwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlbGYuaWZfKHNlbGYubm90TnVsbChsZWZ0LmNvbnRleHQpLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBzZWxmLnJlY3Vyc2UoYXN0LnJpZ2h0LCByaWdodCk7XG4gICAgICAgICAgc2VsZi5hZGRFbnN1cmVTYWZlT2JqZWN0KHNlbGYubWVtYmVyKGxlZnQuY29udGV4dCwgbGVmdC5uYW1lLCBsZWZ0LmNvbXB1dGVkKSk7XG4gICAgICAgICAgc2VsZi5hZGRFbnN1cmVTYWZlQXNzaWduQ29udGV4dChsZWZ0LmNvbnRleHQpO1xuICAgICAgICAgIGV4cHJlc3Npb24gPSBzZWxmLm1lbWJlcihsZWZ0LmNvbnRleHQsIGxlZnQubmFtZSwgbGVmdC5jb21wdXRlZCkgKyBhc3Qub3BlcmF0b3IgKyByaWdodDtcbiAgICAgICAgICBzZWxmLmFzc2lnbihpbnRvSWQsIGV4cHJlc3Npb24pO1xuICAgICAgICAgIHJlY3Vyc2lvbkZuKGludG9JZCB8fCBleHByZXNzaW9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9LCAxKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgQVNULkFycmF5RXhwcmVzc2lvbjpcbiAgICAgIGFyZ3MgPSBbXTtcbiAgICAgIGZvckVhY2goYXN0LmVsZW1lbnRzLCBmdW5jdGlvbihleHByKSB7XG4gICAgICAgIHNlbGYucmVjdXJzZShleHByLCBzZWxmLm5leHRJZCgpLCB1bmRlZmluZWQsIGZ1bmN0aW9uKGFyZ3VtZW50KSB7XG4gICAgICAgICAgYXJncy5wdXNoKGFyZ3VtZW50KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIGV4cHJlc3Npb24gPSAnWycgKyBhcmdzLmpvaW4oJywnKSArICddJztcbiAgICAgIHRoaXMuYXNzaWduKGludG9JZCwgZXhwcmVzc2lvbik7XG4gICAgICByZWN1cnNpb25GbihleHByZXNzaW9uKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgQVNULk9iamVjdEV4cHJlc3Npb246XG4gICAgICBhcmdzID0gW107XG4gICAgICBmb3JFYWNoKGFzdC5wcm9wZXJ0aWVzLCBmdW5jdGlvbihwcm9wZXJ0eSkge1xuICAgICAgICBzZWxmLnJlY3Vyc2UocHJvcGVydHkudmFsdWUsIHNlbGYubmV4dElkKCksIHVuZGVmaW5lZCwgZnVuY3Rpb24oZXhwcikge1xuICAgICAgICAgIGFyZ3MucHVzaChzZWxmLmVzY2FwZShcbiAgICAgICAgICAgICAgcHJvcGVydHkua2V5LnR5cGUgPT09IEFTVC5JZGVudGlmaWVyID8gcHJvcGVydHkua2V5Lm5hbWUgOlxuICAgICAgICAgICAgICAgICgnJyArIHByb3BlcnR5LmtleS52YWx1ZSkpICtcbiAgICAgICAgICAgICAgJzonICsgZXhwcik7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBleHByZXNzaW9uID0gJ3snICsgYXJncy5qb2luKCcsJykgKyAnfSc7XG4gICAgICB0aGlzLmFzc2lnbihpbnRvSWQsIGV4cHJlc3Npb24pO1xuICAgICAgcmVjdXJzaW9uRm4oZXhwcmVzc2lvbik7XG4gICAgICBicmVhaztcbiAgICBjYXNlIEFTVC5UaGlzRXhwcmVzc2lvbjpcbiAgICAgIHRoaXMuYXNzaWduKGludG9JZCwgJ3MnKTtcbiAgICAgIHJlY3Vyc2lvbkZuKCdzJyk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIEFTVC5Mb2NhbHNFeHByZXNzaW9uOlxuICAgICAgdGhpcy5hc3NpZ24oaW50b0lkLCAnbCcpO1xuICAgICAgcmVjdXJzaW9uRm4oJ2wnKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgQVNULk5HVmFsdWVQYXJhbWV0ZXI6XG4gICAgICB0aGlzLmFzc2lnbihpbnRvSWQsICd2Jyk7XG4gICAgICByZWN1cnNpb25GbigndicpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9LFxuXG4gIGdldEhhc093blByb3BlcnR5OiBmdW5jdGlvbihlbGVtZW50LCBwcm9wZXJ0eSkge1xuICAgIHZhciBrZXkgPSBlbGVtZW50ICsgJy4nICsgcHJvcGVydHk7XG4gICAgdmFyIG93biA9IHRoaXMuY3VycmVudCgpLm93bjtcbiAgICBpZiAoIW93bi5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICBvd25ba2V5XSA9IHRoaXMubmV4dElkKGZhbHNlLCBlbGVtZW50ICsgJyYmKCcgKyB0aGlzLmVzY2FwZShwcm9wZXJ0eSkgKyAnIGluICcgKyBlbGVtZW50ICsgJyknKTtcbiAgICB9XG4gICAgcmV0dXJuIG93bltrZXldO1xuICB9LFxuXG4gIGFzc2lnbjogZnVuY3Rpb24oaWQsIHZhbHVlKSB7XG4gICAgaWYgKCFpZCkgcmV0dXJuO1xuICAgIHRoaXMuY3VycmVudCgpLmJvZHkucHVzaChpZCwgJz0nLCB2YWx1ZSwgJzsnKTtcbiAgICByZXR1cm4gaWQ7XG4gIH0sXG5cbiAgZmlsdGVyOiBmdW5jdGlvbihmaWx0ZXJOYW1lKSB7XG4gICAgaWYgKCF0aGlzLnN0YXRlLmZpbHRlcnMuaGFzT3duUHJvcGVydHkoZmlsdGVyTmFtZSkpIHtcbiAgICAgIHRoaXMuc3RhdGUuZmlsdGVyc1tmaWx0ZXJOYW1lXSA9IHRoaXMubmV4dElkKHRydWUpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5maWx0ZXJzW2ZpbHRlck5hbWVdO1xuICB9LFxuXG4gIGlmRGVmaW5lZDogZnVuY3Rpb24oaWQsIGRlZmF1bHRWYWx1ZSkge1xuICAgIHJldHVybiAnaWZEZWZpbmVkKCcgKyBpZCArICcsJyArIHRoaXMuZXNjYXBlKGRlZmF1bHRWYWx1ZSkgKyAnKSc7XG4gIH0sXG5cbiAgcGx1czogZnVuY3Rpb24obGVmdCwgcmlnaHQpIHtcbiAgICByZXR1cm4gJ3BsdXMoJyArIGxlZnQgKyAnLCcgKyByaWdodCArICcpJztcbiAgfSxcblxuICByZXR1cm5fOiBmdW5jdGlvbihpZCkge1xuICAgIHRoaXMuY3VycmVudCgpLmJvZHkucHVzaCgncmV0dXJuICcsIGlkLCAnOycpO1xuICB9LFxuXG4gIGlmXzogZnVuY3Rpb24odGVzdCwgYWx0ZXJuYXRlLCBjb25zZXF1ZW50KSB7XG4gICAgaWYgKHRlc3QgPT09IHRydWUpIHtcbiAgICAgIGFsdGVybmF0ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgYm9keSA9IHRoaXMuY3VycmVudCgpLmJvZHk7XG4gICAgICBib2R5LnB1c2goJ2lmKCcsIHRlc3QsICcpeycpO1xuICAgICAgYWx0ZXJuYXRlKCk7XG4gICAgICBib2R5LnB1c2goJ30nKTtcbiAgICAgIGlmIChjb25zZXF1ZW50KSB7XG4gICAgICAgIGJvZHkucHVzaCgnZWxzZXsnKTtcbiAgICAgICAgY29uc2VxdWVudCgpO1xuICAgICAgICBib2R5LnB1c2goJ30nKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgbm90OiBmdW5jdGlvbihleHByZXNzaW9uKSB7XG4gICAgcmV0dXJuICchKCcgKyBleHByZXNzaW9uICsgJyknO1xuICB9LFxuXG4gIG5vdE51bGw6IGZ1bmN0aW9uKGV4cHJlc3Npb24pIHtcbiAgICByZXR1cm4gZXhwcmVzc2lvbiArICchPW51bGwnO1xuICB9LFxuXG4gIG5vbkNvbXB1dGVkTWVtYmVyOiBmdW5jdGlvbihsZWZ0LCByaWdodCkge1xuICAgIHJldHVybiBsZWZ0ICsgJy4nICsgcmlnaHQ7XG4gIH0sXG5cbiAgY29tcHV0ZWRNZW1iZXI6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0KSB7XG4gICAgcmV0dXJuIGxlZnQgKyAnWycgKyByaWdodCArICddJztcbiAgfSxcblxuICBtZW1iZXI6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb21wdXRlZCkge1xuICAgIGlmIChjb21wdXRlZCkgcmV0dXJuIHRoaXMuY29tcHV0ZWRNZW1iZXIobGVmdCwgcmlnaHQpO1xuICAgIHJldHVybiB0aGlzLm5vbkNvbXB1dGVkTWVtYmVyKGxlZnQsIHJpZ2h0KTtcbiAgfSxcblxuICBhZGRFbnN1cmVTYWZlT2JqZWN0OiBmdW5jdGlvbihpdGVtKSB7XG4gICAgdGhpcy5jdXJyZW50KCkuYm9keS5wdXNoKHRoaXMuZW5zdXJlU2FmZU9iamVjdChpdGVtKSwgJzsnKTtcbiAgfSxcblxuICBhZGRFbnN1cmVTYWZlTWVtYmVyTmFtZTogZnVuY3Rpb24oaXRlbSkge1xuICAgIHRoaXMuY3VycmVudCgpLmJvZHkucHVzaCh0aGlzLmVuc3VyZVNhZmVNZW1iZXJOYW1lKGl0ZW0pLCAnOycpO1xuICB9LFxuXG4gIGFkZEVuc3VyZVNhZmVGdW5jdGlvbjogZnVuY3Rpb24oaXRlbSkge1xuICAgIHRoaXMuY3VycmVudCgpLmJvZHkucHVzaCh0aGlzLmVuc3VyZVNhZmVGdW5jdGlvbihpdGVtKSwgJzsnKTtcbiAgfSxcblxuICBhZGRFbnN1cmVTYWZlQXNzaWduQ29udGV4dDogZnVuY3Rpb24oaXRlbSkge1xuICAgIHRoaXMuY3VycmVudCgpLmJvZHkucHVzaCh0aGlzLmVuc3VyZVNhZmVBc3NpZ25Db250ZXh0KGl0ZW0pLCAnOycpO1xuICB9LFxuXG4gIGVuc3VyZVNhZmVPYmplY3Q6IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICByZXR1cm4gJ2Vuc3VyZVNhZmVPYmplY3QoJyArIGl0ZW0gKyAnLHRleHQpJztcbiAgfSxcblxuICBlbnN1cmVTYWZlTWVtYmVyTmFtZTogZnVuY3Rpb24oaXRlbSkge1xuICAgIHJldHVybiAnZW5zdXJlU2FmZU1lbWJlck5hbWUoJyArIGl0ZW0gKyAnLHRleHQpJztcbiAgfSxcblxuICBlbnN1cmVTYWZlRnVuY3Rpb246IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICByZXR1cm4gJ2Vuc3VyZVNhZmVGdW5jdGlvbignICsgaXRlbSArICcsdGV4dCknO1xuICB9LFxuXG4gIGdldFN0cmluZ1ZhbHVlOiBmdW5jdGlvbihpdGVtKSB7XG4gICAgdGhpcy5hc3NpZ24oaXRlbSwgJ2dldFN0cmluZ1ZhbHVlKCcgKyBpdGVtICsgJyknKTtcbiAgfSxcblxuICBlbnN1cmVTYWZlQXNzaWduQ29udGV4dDogZnVuY3Rpb24oaXRlbSkge1xuICAgIHJldHVybiAnZW5zdXJlU2FmZUFzc2lnbkNvbnRleHQoJyArIGl0ZW0gKyAnLHRleHQpJztcbiAgfSxcblxuICBsYXp5UmVjdXJzZTogZnVuY3Rpb24oYXN0LCBpbnRvSWQsIG5hbWVJZCwgcmVjdXJzaW9uRm4sIGNyZWF0ZSwgc2tpcFdhdGNoSWRDaGVjaykge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBzZWxmLnJlY3Vyc2UoYXN0LCBpbnRvSWQsIG5hbWVJZCwgcmVjdXJzaW9uRm4sIGNyZWF0ZSwgc2tpcFdhdGNoSWRDaGVjayk7XG4gICAgfTtcbiAgfSxcblxuICBsYXp5QXNzaWduOiBmdW5jdGlvbihpZCwgdmFsdWUpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgc2VsZi5hc3NpZ24oaWQsIHZhbHVlKTtcbiAgICB9O1xuICB9LFxuXG4gIHN0cmluZ0VzY2FwZVJlZ2V4OiAvW14gYS16QS1aMC05XS9nLFxuXG4gIHN0cmluZ0VzY2FwZUZuOiBmdW5jdGlvbihjKSB7XG4gICAgcmV0dXJuICdcXFxcdScgKyAoJzAwMDAnICsgYy5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTQpO1xuICB9LFxuXG4gIGVzY2FwZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICBpZiAoaXNTdHJpbmcodmFsdWUpKSByZXR1cm4gXCInXCIgKyB2YWx1ZS5yZXBsYWNlKHRoaXMuc3RyaW5nRXNjYXBlUmVnZXgsIHRoaXMuc3RyaW5nRXNjYXBlRm4pICsgXCInXCI7XG4gICAgaWYgKGlzTnVtYmVyKHZhbHVlKSkgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgaWYgKHZhbHVlID09PSB0cnVlKSByZXR1cm4gJ3RydWUnO1xuICAgIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHJldHVybiAnZmFsc2UnO1xuICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkgcmV0dXJuICdudWxsJztcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJykgcmV0dXJuICd1bmRlZmluZWQnO1xuXG4gICAgdGhyb3cgJHBhcnNlTWluRXJyKCdlc2MnLCAnSU1QT1NTSUJMRScpO1xuICB9LFxuXG4gIG5leHRJZDogZnVuY3Rpb24oc2tpcCwgaW5pdCkge1xuICAgIHZhciBpZCA9ICd2JyArICh0aGlzLnN0YXRlLm5leHRJZCsrKTtcbiAgICBpZiAoIXNraXApIHtcbiAgICAgIHRoaXMuY3VycmVudCgpLnZhcnMucHVzaChpZCArIChpbml0ID8gJz0nICsgaW5pdCA6ICcnKSk7XG4gICAgfVxuICAgIHJldHVybiBpZDtcbiAgfSxcblxuICBjdXJyZW50OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZVt0aGlzLnN0YXRlLmNvbXB1dGluZ107XG4gIH1cbn07XG5cblxuZnVuY3Rpb24gQVNUSW50ZXJwcmV0ZXIoYXN0QnVpbGRlciwgJGZpbHRlcikge1xuICB0aGlzLmFzdEJ1aWxkZXIgPSBhc3RCdWlsZGVyO1xuICB0aGlzLiRmaWx0ZXIgPSAkZmlsdGVyO1xufVxuXG5BU1RJbnRlcnByZXRlci5wcm90b3R5cGUgPSB7XG4gIGNvbXBpbGU6IGZ1bmN0aW9uKGV4cHJlc3Npb24sIGV4cGVuc2l2ZUNoZWNrcykge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgYXN0ID0gdGhpcy5hc3RCdWlsZGVyLmFzdChleHByZXNzaW9uKTtcbiAgICB0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uO1xuICAgIHRoaXMuZXhwZW5zaXZlQ2hlY2tzID0gZXhwZW5zaXZlQ2hlY2tzO1xuICAgIGZpbmRDb25zdGFudEFuZFdhdGNoRXhwcmVzc2lvbnMoYXN0LCBzZWxmLiRmaWx0ZXIpO1xuICAgIHZhciBhc3NpZ25hYmxlO1xuICAgIHZhciBhc3NpZ247XG4gICAgaWYgKChhc3NpZ25hYmxlID0gYXNzaWduYWJsZUFTVChhc3QpKSkge1xuICAgICAgYXNzaWduID0gdGhpcy5yZWN1cnNlKGFzc2lnbmFibGUpO1xuICAgIH1cbiAgICB2YXIgdG9XYXRjaCA9IGdldElucHV0cyhhc3QuYm9keSk7XG4gICAgdmFyIGlucHV0cztcbiAgICBpZiAodG9XYXRjaCkge1xuICAgICAgaW5wdXRzID0gW107XG4gICAgICBmb3JFYWNoKHRvV2F0Y2gsIGZ1bmN0aW9uKHdhdGNoLCBrZXkpIHtcbiAgICAgICAgdmFyIGlucHV0ID0gc2VsZi5yZWN1cnNlKHdhdGNoKTtcbiAgICAgICAgd2F0Y2guaW5wdXQgPSBpbnB1dDtcbiAgICAgICAgaW5wdXRzLnB1c2goaW5wdXQpO1xuICAgICAgICB3YXRjaC53YXRjaElkID0ga2V5O1xuICAgICAgfSk7XG4gICAgfVxuICAgIHZhciBleHByZXNzaW9ucyA9IFtdO1xuICAgIGZvckVhY2goYXN0LmJvZHksIGZ1bmN0aW9uKGV4cHJlc3Npb24pIHtcbiAgICAgIGV4cHJlc3Npb25zLnB1c2goc2VsZi5yZWN1cnNlKGV4cHJlc3Npb24uZXhwcmVzc2lvbikpO1xuICAgIH0pO1xuICAgIHZhciBmbiA9IGFzdC5ib2R5Lmxlbmd0aCA9PT0gMCA/IGZ1bmN0aW9uKCkge30gOlxuICAgICAgICAgICAgIGFzdC5ib2R5Lmxlbmd0aCA9PT0gMSA/IGV4cHJlc3Npb25zWzBdIDpcbiAgICAgICAgICAgICBmdW5jdGlvbihzY29wZSwgbG9jYWxzKSB7XG4gICAgICAgICAgICAgICB2YXIgbGFzdFZhbHVlO1xuICAgICAgICAgICAgICAgZm9yRWFjaChleHByZXNzaW9ucywgZnVuY3Rpb24oZXhwKSB7XG4gICAgICAgICAgICAgICAgIGxhc3RWYWx1ZSA9IGV4cChzY29wZSwgbG9jYWxzKTtcbiAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgcmV0dXJuIGxhc3RWYWx1ZTtcbiAgICAgICAgICAgICB9O1xuICAgIGlmIChhc3NpZ24pIHtcbiAgICAgIGZuLmFzc2lnbiA9IGZ1bmN0aW9uKHNjb3BlLCB2YWx1ZSwgbG9jYWxzKSB7XG4gICAgICAgIHJldHVybiBhc3NpZ24oc2NvcGUsIGxvY2FscywgdmFsdWUpO1xuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKGlucHV0cykge1xuICAgICAgZm4uaW5wdXRzID0gaW5wdXRzO1xuICAgIH1cbiAgICBmbi5saXRlcmFsID0gaXNMaXRlcmFsKGFzdCk7XG4gICAgZm4uY29uc3RhbnQgPSBpc0NvbnN0YW50KGFzdCk7XG4gICAgcmV0dXJuIGZuO1xuICB9LFxuXG4gIHJlY3Vyc2U6IGZ1bmN0aW9uKGFzdCwgY29udGV4dCwgY3JlYXRlKSB7XG4gICAgdmFyIGxlZnQsIHJpZ2h0LCBzZWxmID0gdGhpcywgYXJncywgZXhwcmVzc2lvbjtcbiAgICBpZiAoYXN0LmlucHV0KSB7XG4gICAgICByZXR1cm4gdGhpcy5pbnB1dHMoYXN0LmlucHV0LCBhc3Qud2F0Y2hJZCk7XG4gICAgfVxuICAgIHN3aXRjaCAoYXN0LnR5cGUpIHtcbiAgICBjYXNlIEFTVC5MaXRlcmFsOlxuICAgICAgcmV0dXJuIHRoaXMudmFsdWUoYXN0LnZhbHVlLCBjb250ZXh0KTtcbiAgICBjYXNlIEFTVC5VbmFyeUV4cHJlc3Npb246XG4gICAgICByaWdodCA9IHRoaXMucmVjdXJzZShhc3QuYXJndW1lbnQpO1xuICAgICAgcmV0dXJuIHRoaXNbJ3VuYXJ5JyArIGFzdC5vcGVyYXRvcl0ocmlnaHQsIGNvbnRleHQpO1xuICAgIGNhc2UgQVNULkJpbmFyeUV4cHJlc3Npb246XG4gICAgICBsZWZ0ID0gdGhpcy5yZWN1cnNlKGFzdC5sZWZ0KTtcbiAgICAgIHJpZ2h0ID0gdGhpcy5yZWN1cnNlKGFzdC5yaWdodCk7XG4gICAgICByZXR1cm4gdGhpc1snYmluYXJ5JyArIGFzdC5vcGVyYXRvcl0obGVmdCwgcmlnaHQsIGNvbnRleHQpO1xuICAgIGNhc2UgQVNULkxvZ2ljYWxFeHByZXNzaW9uOlxuICAgICAgbGVmdCA9IHRoaXMucmVjdXJzZShhc3QubGVmdCk7XG4gICAgICByaWdodCA9IHRoaXMucmVjdXJzZShhc3QucmlnaHQpO1xuICAgICAgcmV0dXJuIHRoaXNbJ2JpbmFyeScgKyBhc3Qub3BlcmF0b3JdKGxlZnQsIHJpZ2h0LCBjb250ZXh0KTtcbiAgICBjYXNlIEFTVC5Db25kaXRpb25hbEV4cHJlc3Npb246XG4gICAgICByZXR1cm4gdGhpc1sndGVybmFyeT86J10oXG4gICAgICAgIHRoaXMucmVjdXJzZShhc3QudGVzdCksXG4gICAgICAgIHRoaXMucmVjdXJzZShhc3QuYWx0ZXJuYXRlKSxcbiAgICAgICAgdGhpcy5yZWN1cnNlKGFzdC5jb25zZXF1ZW50KSxcbiAgICAgICAgY29udGV4dFxuICAgICAgKTtcbiAgICBjYXNlIEFTVC5JZGVudGlmaWVyOlxuICAgICAgZW5zdXJlU2FmZU1lbWJlck5hbWUoYXN0Lm5hbWUsIHNlbGYuZXhwcmVzc2lvbik7XG4gICAgICByZXR1cm4gc2VsZi5pZGVudGlmaWVyKGFzdC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmV4cGVuc2l2ZUNoZWNrcyB8fCBpc1Bvc3NpYmx5RGFuZ2Vyb3VzTWVtYmVyTmFtZShhc3QubmFtZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQsIGNyZWF0ZSwgc2VsZi5leHByZXNzaW9uKTtcbiAgICBjYXNlIEFTVC5NZW1iZXJFeHByZXNzaW9uOlxuICAgICAgbGVmdCA9IHRoaXMucmVjdXJzZShhc3Qub2JqZWN0LCBmYWxzZSwgISFjcmVhdGUpO1xuICAgICAgaWYgKCFhc3QuY29tcHV0ZWQpIHtcbiAgICAgICAgZW5zdXJlU2FmZU1lbWJlck5hbWUoYXN0LnByb3BlcnR5Lm5hbWUsIHNlbGYuZXhwcmVzc2lvbik7XG4gICAgICAgIHJpZ2h0ID0gYXN0LnByb3BlcnR5Lm5hbWU7XG4gICAgICB9XG4gICAgICBpZiAoYXN0LmNvbXB1dGVkKSByaWdodCA9IHRoaXMucmVjdXJzZShhc3QucHJvcGVydHkpO1xuICAgICAgcmV0dXJuIGFzdC5jb21wdXRlZCA/XG4gICAgICAgIHRoaXMuY29tcHV0ZWRNZW1iZXIobGVmdCwgcmlnaHQsIGNvbnRleHQsIGNyZWF0ZSwgc2VsZi5leHByZXNzaW9uKSA6XG4gICAgICAgIHRoaXMubm9uQ29tcHV0ZWRNZW1iZXIobGVmdCwgcmlnaHQsIHNlbGYuZXhwZW5zaXZlQ2hlY2tzLCBjb250ZXh0LCBjcmVhdGUsIHNlbGYuZXhwcmVzc2lvbik7XG4gICAgY2FzZSBBU1QuQ2FsbEV4cHJlc3Npb246XG4gICAgICBhcmdzID0gW107XG4gICAgICBmb3JFYWNoKGFzdC5hcmd1bWVudHMsIGZ1bmN0aW9uKGV4cHIpIHtcbiAgICAgICAgYXJncy5wdXNoKHNlbGYucmVjdXJzZShleHByKSk7XG4gICAgICB9KTtcbiAgICAgIGlmIChhc3QuZmlsdGVyKSByaWdodCA9IHRoaXMuJGZpbHRlcihhc3QuY2FsbGVlLm5hbWUpO1xuICAgICAgaWYgKCFhc3QuZmlsdGVyKSByaWdodCA9IHRoaXMucmVjdXJzZShhc3QuY2FsbGVlLCB0cnVlKTtcbiAgICAgIHJldHVybiBhc3QuZmlsdGVyID9cbiAgICAgICAgZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcbiAgICAgICAgICB2YXIgdmFsdWVzID0gW107XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaChhcmdzW2ldKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciB2YWx1ZSA9IHJpZ2h0LmFwcGx5KHVuZGVmaW5lZCwgdmFsdWVzLCBpbnB1dHMpO1xuICAgICAgICAgIHJldHVybiBjb250ZXh0ID8ge2NvbnRleHQ6IHVuZGVmaW5lZCwgbmFtZTogdW5kZWZpbmVkLCB2YWx1ZTogdmFsdWV9IDogdmFsdWU7XG4gICAgICAgIH0gOlxuICAgICAgICBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuICAgICAgICAgIHZhciByaHMgPSByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgIGlmIChyaHMudmFsdWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgZW5zdXJlU2FmZU9iamVjdChyaHMuY29udGV4dCwgc2VsZi5leHByZXNzaW9uKTtcbiAgICAgICAgICAgIGVuc3VyZVNhZmVGdW5jdGlvbihyaHMudmFsdWUsIHNlbGYuZXhwcmVzc2lvbik7XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgdmFsdWVzLnB1c2goZW5zdXJlU2FmZU9iamVjdChhcmdzW2ldKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSwgc2VsZi5leHByZXNzaW9uKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YWx1ZSA9IGVuc3VyZVNhZmVPYmplY3QocmhzLnZhbHVlLmFwcGx5KHJocy5jb250ZXh0LCB2YWx1ZXMpLCBzZWxmLmV4cHJlc3Npb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogdmFsdWV9IDogdmFsdWU7XG4gICAgICAgIH07XG4gICAgY2FzZSBBU1QuQXNzaWdubWVudEV4cHJlc3Npb246XG4gICAgICBsZWZ0ID0gdGhpcy5yZWN1cnNlKGFzdC5sZWZ0LCB0cnVlLCAxKTtcbiAgICAgIHJpZ2h0ID0gdGhpcy5yZWN1cnNlKGFzdC5yaWdodCk7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcbiAgICAgICAgdmFyIGxocyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuICAgICAgICB2YXIgcmhzID0gcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuICAgICAgICBlbnN1cmVTYWZlT2JqZWN0KGxocy52YWx1ZSwgc2VsZi5leHByZXNzaW9uKTtcbiAgICAgICAgZW5zdXJlU2FmZUFzc2lnbkNvbnRleHQobGhzLmNvbnRleHQpO1xuICAgICAgICBsaHMuY29udGV4dFtsaHMubmFtZV0gPSByaHM7XG4gICAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiByaHN9IDogcmhzO1xuICAgICAgfTtcbiAgICBjYXNlIEFTVC5BcnJheUV4cHJlc3Npb246XG4gICAgICBhcmdzID0gW107XG4gICAgICBmb3JFYWNoKGFzdC5lbGVtZW50cywgZnVuY3Rpb24oZXhwcikge1xuICAgICAgICBhcmdzLnB1c2goc2VsZi5yZWN1cnNlKGV4cHIpKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YWx1ZS5wdXNoKGFyZ3NbaV0oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogdmFsdWV9IDogdmFsdWU7XG4gICAgICB9O1xuICAgIGNhc2UgQVNULk9iamVjdEV4cHJlc3Npb246XG4gICAgICBhcmdzID0gW107XG4gICAgICBmb3JFYWNoKGFzdC5wcm9wZXJ0aWVzLCBmdW5jdGlvbihwcm9wZXJ0eSkge1xuICAgICAgICBhcmdzLnB1c2goe2tleTogcHJvcGVydHkua2V5LnR5cGUgPT09IEFTVC5JZGVudGlmaWVyID9cbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5LmtleS5uYW1lIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICgnJyArIHByb3BlcnR5LmtleS52YWx1ZSksXG4gICAgICAgICAgICAgICAgICAgdmFsdWU6IHNlbGYucmVjdXJzZShwcm9wZXJ0eS52YWx1ZSlcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuICAgICAgICB2YXIgdmFsdWUgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgdmFsdWVbYXJnc1tpXS5rZXldID0gYXJnc1tpXS52YWx1ZShzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRleHQgPyB7dmFsdWU6IHZhbHVlfSA6IHZhbHVlO1xuICAgICAgfTtcbiAgICBjYXNlIEFTVC5UaGlzRXhwcmVzc2lvbjpcbiAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSkge1xuICAgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogc2NvcGV9IDogc2NvcGU7XG4gICAgICB9O1xuICAgIGNhc2UgQVNULkxvY2Fsc0V4cHJlc3Npb246XG4gICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2Fscykge1xuICAgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogbG9jYWxzfSA6IGxvY2FscztcbiAgICAgIH07XG4gICAgY2FzZSBBU1QuTkdWYWx1ZVBhcmFtZXRlcjpcbiAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuICAgICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXNzaWdufSA6IGFzc2lnbjtcbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gICd1bmFyeSsnOiBmdW5jdGlvbihhcmd1bWVudCwgY29udGV4dCkge1xuICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcbiAgICAgIGlmIChpc0RlZmluZWQoYXJnKSkge1xuICAgICAgICBhcmcgPSArYXJnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXJnID0gMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuICAgIH07XG4gIH0sXG4gICd1bmFyeS0nOiBmdW5jdGlvbihhcmd1bWVudCwgY29udGV4dCkge1xuICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcbiAgICAgIGlmIChpc0RlZmluZWQoYXJnKSkge1xuICAgICAgICBhcmcgPSAtYXJnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXJnID0gMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuICAgIH07XG4gIH0sXG4gICd1bmFyeSEnOiBmdW5jdGlvbihhcmd1bWVudCwgY29udGV4dCkge1xuICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuICAgICAgdmFyIGFyZyA9ICFhcmd1bWVudChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcbiAgICB9O1xuICB9LFxuICAnYmluYXJ5Kyc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICB2YXIgbGhzID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICB2YXIgcmhzID0gcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuICAgICAgdmFyIGFyZyA9IHBsdXNGbihsaHMsIHJocyk7XG4gICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcbiAgICB9O1xuICB9LFxuICAnYmluYXJ5LSc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICB2YXIgbGhzID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICB2YXIgcmhzID0gcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuICAgICAgdmFyIGFyZyA9IChpc0RlZmluZWQobGhzKSA/IGxocyA6IDApIC0gKGlzRGVmaW5lZChyaHMpID8gcmhzIDogMCk7XG4gICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcbiAgICB9O1xuICB9LFxuICAnYmluYXJ5Kic6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICB2YXIgYXJnID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgKiByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcbiAgICB9O1xuICB9LFxuICAnYmluYXJ5Lyc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICB2YXIgYXJnID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgLyByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcbiAgICB9O1xuICB9LFxuICAnYmluYXJ5JSc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICB2YXIgYXJnID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgJSByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcbiAgICB9O1xuICB9LFxuICAnYmluYXJ5PT09JzogZnVuY3Rpb24obGVmdCwgcmlnaHQsIGNvbnRleHQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcbiAgICAgIHZhciBhcmcgPSBsZWZ0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSA9PT0gcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuICAgICAgcmV0dXJuIGNvbnRleHQgPyB7dmFsdWU6IGFyZ30gOiBhcmc7XG4gICAgfTtcbiAgfSxcbiAgJ2JpbmFyeSE9PSc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICB2YXIgYXJnID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgIT09IHJpZ2h0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcbiAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuICAgIH07XG4gIH0sXG4gICdiaW5hcnk9PSc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICB2YXIgYXJnID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgPT0gcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuICAgICAgcmV0dXJuIGNvbnRleHQgPyB7dmFsdWU6IGFyZ30gOiBhcmc7XG4gICAgfTtcbiAgfSxcbiAgJ2JpbmFyeSE9JzogZnVuY3Rpb24obGVmdCwgcmlnaHQsIGNvbnRleHQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcbiAgICAgIHZhciBhcmcgPSBsZWZ0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSAhPSByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcbiAgICB9O1xuICB9LFxuICAnYmluYXJ5PCc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICB2YXIgYXJnID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgPCByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcbiAgICB9O1xuICB9LFxuICAnYmluYXJ5Pic6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICB2YXIgYXJnID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgPiByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcbiAgICB9O1xuICB9LFxuICAnYmluYXJ5PD0nOiBmdW5jdGlvbihsZWZ0LCByaWdodCwgY29udGV4dCkge1xuICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuICAgICAgdmFyIGFyZyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIDw9IHJpZ2h0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcbiAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuICAgIH07XG4gIH0sXG4gICdiaW5hcnk+PSc6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICB2YXIgYXJnID0gbGVmdChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgPj0gcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuICAgICAgcmV0dXJuIGNvbnRleHQgPyB7dmFsdWU6IGFyZ30gOiBhcmc7XG4gICAgfTtcbiAgfSxcbiAgJ2JpbmFyeSYmJzogZnVuY3Rpb24obGVmdCwgcmlnaHQsIGNvbnRleHQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcbiAgICAgIHZhciBhcmcgPSBsZWZ0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSAmJiByaWdodChzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICByZXR1cm4gY29udGV4dCA/IHt2YWx1ZTogYXJnfSA6IGFyZztcbiAgICB9O1xuICB9LFxuICAnYmluYXJ5fHwnOiBmdW5jdGlvbihsZWZ0LCByaWdodCwgY29udGV4dCkge1xuICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuICAgICAgdmFyIGFyZyA9IGxlZnQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHx8IHJpZ2h0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcbiAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuICAgIH07XG4gIH0sXG4gICd0ZXJuYXJ5PzonOiBmdW5jdGlvbih0ZXN0LCBhbHRlcm5hdGUsIGNvbnNlcXVlbnQsIGNvbnRleHQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcbiAgICAgIHZhciBhcmcgPSB0ZXN0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSA/IGFsdGVybmF0ZShzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykgOiBjb25zZXF1ZW50KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcbiAgICAgIHJldHVybiBjb250ZXh0ID8ge3ZhbHVlOiBhcmd9IDogYXJnO1xuICAgIH07XG4gIH0sXG4gIHZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgY29udGV4dCkge1xuICAgIHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIGNvbnRleHQgPyB7Y29udGV4dDogdW5kZWZpbmVkLCBuYW1lOiB1bmRlZmluZWQsIHZhbHVlOiB2YWx1ZX0gOiB2YWx1ZTsgfTtcbiAgfSxcbiAgaWRlbnRpZmllcjogZnVuY3Rpb24obmFtZSwgZXhwZW5zaXZlQ2hlY2tzLCBjb250ZXh0LCBjcmVhdGUsIGV4cHJlc3Npb24pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcbiAgICAgIHZhciBiYXNlID0gbG9jYWxzICYmIChuYW1lIGluIGxvY2FscykgPyBsb2NhbHMgOiBzY29wZTtcbiAgICAgIGlmIChjcmVhdGUgJiYgY3JlYXRlICE9PSAxICYmIGJhc2UgJiYgIShiYXNlW25hbWVdKSkge1xuICAgICAgICBiYXNlW25hbWVdID0ge307XG4gICAgICB9XG4gICAgICB2YXIgdmFsdWUgPSBiYXNlID8gYmFzZVtuYW1lXSA6IHVuZGVmaW5lZDtcbiAgICAgIGlmIChleHBlbnNpdmVDaGVja3MpIHtcbiAgICAgICAgZW5zdXJlU2FmZU9iamVjdCh2YWx1ZSwgZXhwcmVzc2lvbik7XG4gICAgICB9XG4gICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICByZXR1cm4ge2NvbnRleHQ6IGJhc2UsIG5hbWU6IG5hbWUsIHZhbHVlOiB2YWx1ZX07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfTtcbiAgfSxcbiAgY29tcHV0ZWRNZW1iZXI6IGZ1bmN0aW9uKGxlZnQsIHJpZ2h0LCBjb250ZXh0LCBjcmVhdGUsIGV4cHJlc3Npb24pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcbiAgICAgIHZhciBsaHMgPSBsZWZ0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcbiAgICAgIHZhciByaHM7XG4gICAgICB2YXIgdmFsdWU7XG4gICAgICBpZiAobGhzICE9IG51bGwpIHtcbiAgICAgICAgcmhzID0gcmlnaHQoc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuICAgICAgICByaHMgPSBnZXRTdHJpbmdWYWx1ZShyaHMpO1xuICAgICAgICBlbnN1cmVTYWZlTWVtYmVyTmFtZShyaHMsIGV4cHJlc3Npb24pO1xuICAgICAgICBpZiAoY3JlYXRlICYmIGNyZWF0ZSAhPT0gMSkge1xuICAgICAgICAgIGVuc3VyZVNhZmVBc3NpZ25Db250ZXh0KGxocyk7XG4gICAgICAgICAgaWYgKGxocyAmJiAhKGxoc1tyaHNdKSkge1xuICAgICAgICAgICAgbGhzW3Joc10gPSB7fTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFsdWUgPSBsaHNbcmhzXTtcbiAgICAgICAgZW5zdXJlU2FmZU9iamVjdCh2YWx1ZSwgZXhwcmVzc2lvbik7XG4gICAgICB9XG4gICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICByZXR1cm4ge2NvbnRleHQ6IGxocywgbmFtZTogcmhzLCB2YWx1ZTogdmFsdWV9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuICAgIH07XG4gIH0sXG4gIG5vbkNvbXB1dGVkTWVtYmVyOiBmdW5jdGlvbihsZWZ0LCByaWdodCwgZXhwZW5zaXZlQ2hlY2tzLCBjb250ZXh0LCBjcmVhdGUsIGV4cHJlc3Npb24pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcbiAgICAgIHZhciBsaHMgPSBsZWZ0KHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKTtcbiAgICAgIGlmIChjcmVhdGUgJiYgY3JlYXRlICE9PSAxKSB7XG4gICAgICAgIGVuc3VyZVNhZmVBc3NpZ25Db250ZXh0KGxocyk7XG4gICAgICAgIGlmIChsaHMgJiYgIShsaHNbcmlnaHRdKSkge1xuICAgICAgICAgIGxoc1tyaWdodF0gPSB7fTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdmFyIHZhbHVlID0gbGhzICE9IG51bGwgPyBsaHNbcmlnaHRdIDogdW5kZWZpbmVkO1xuICAgICAgaWYgKGV4cGVuc2l2ZUNoZWNrcyB8fCBpc1Bvc3NpYmx5RGFuZ2Vyb3VzTWVtYmVyTmFtZShyaWdodCkpIHtcbiAgICAgICAgZW5zdXJlU2FmZU9iamVjdCh2YWx1ZSwgZXhwcmVzc2lvbik7XG4gICAgICB9XG4gICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICByZXR1cm4ge2NvbnRleHQ6IGxocywgbmFtZTogcmlnaHQsIHZhbHVlOiB2YWx1ZX07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfTtcbiAgfSxcbiAgaW5wdXRzOiBmdW5jdGlvbihpbnB1dCwgd2F0Y2hJZCkge1xuICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgdmFsdWUsIGxvY2FscywgaW5wdXRzKSB7XG4gICAgICBpZiAoaW5wdXRzKSByZXR1cm4gaW5wdXRzW3dhdGNoSWRdO1xuICAgICAgcmV0dXJuIGlucHV0KHNjb3BlLCB2YWx1ZSwgbG9jYWxzKTtcbiAgICB9O1xuICB9XG59O1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICovXG52YXIgUGFyc2VyID0gZnVuY3Rpb24obGV4ZXIsICRmaWx0ZXIsIG9wdGlvbnMpIHtcbiAgdGhpcy5sZXhlciA9IGxleGVyO1xuICB0aGlzLiRmaWx0ZXIgPSAkZmlsdGVyO1xuICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICB0aGlzLmFzdCA9IG5ldyBBU1QodGhpcy5sZXhlcik7XG4gIHRoaXMuYXN0Q29tcGlsZXIgPSBvcHRpb25zLmNzcCA/IG5ldyBBU1RJbnRlcnByZXRlcih0aGlzLmFzdCwgJGZpbHRlcikgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgQVNUQ29tcGlsZXIodGhpcy5hc3QsICRmaWx0ZXIpO1xufTtcblxuUGFyc2VyLnByb3RvdHlwZSA9IHtcbiAgY29uc3RydWN0b3I6IFBhcnNlcixcblxuICBwYXJzZTogZnVuY3Rpb24odGV4dCkge1xuICAgIHJldHVybiB0aGlzLmFzdENvbXBpbGVyLmNvbXBpbGUodGV4dCwgdGhpcy5vcHRpb25zLmV4cGVuc2l2ZUNoZWNrcyk7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGlzUG9zc2libHlEYW5nZXJvdXNNZW1iZXJOYW1lKG5hbWUpIHtcbiAgcmV0dXJuIG5hbWUgPT0gJ2NvbnN0cnVjdG9yJztcbn1cblxudmFyIG9iamVjdFZhbHVlT2YgPSBPYmplY3QucHJvdG90eXBlLnZhbHVlT2Y7XG5cbmZ1bmN0aW9uIGdldFZhbHVlT2YodmFsdWUpIHtcbiAgcmV0dXJuIGlzRnVuY3Rpb24odmFsdWUudmFsdWVPZikgPyB2YWx1ZS52YWx1ZU9mKCkgOiBvYmplY3RWYWx1ZU9mLmNhbGwodmFsdWUpO1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkcGFyc2VcbiAqIEBraW5kIGZ1bmN0aW9uXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogQ29udmVydHMgQW5ndWxhciB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufSBpbnRvIGEgZnVuY3Rpb24uXG4gKlxuICogYGBganNcbiAqICAgdmFyIGdldHRlciA9ICRwYXJzZSgndXNlci5uYW1lJyk7XG4gKiAgIHZhciBzZXR0ZXIgPSBnZXR0ZXIuYXNzaWduO1xuICogICB2YXIgY29udGV4dCA9IHt1c2VyOntuYW1lOidhbmd1bGFyJ319O1xuICogICB2YXIgbG9jYWxzID0ge3VzZXI6e25hbWU6J2xvY2FsJ319O1xuICpcbiAqICAgZXhwZWN0KGdldHRlcihjb250ZXh0KSkudG9FcXVhbCgnYW5ndWxhcicpO1xuICogICBzZXR0ZXIoY29udGV4dCwgJ25ld1ZhbHVlJyk7XG4gKiAgIGV4cGVjdChjb250ZXh0LnVzZXIubmFtZSkudG9FcXVhbCgnbmV3VmFsdWUnKTtcbiAqICAgZXhwZWN0KGdldHRlcihjb250ZXh0LCBsb2NhbHMpKS50b0VxdWFsKCdsb2NhbCcpO1xuICogYGBgXG4gKlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBleHByZXNzaW9uIFN0cmluZyBleHByZXNzaW9uIHRvIGNvbXBpbGUuXG4gKiBAcmV0dXJucyB7ZnVuY3Rpb24oY29udGV4dCwgbG9jYWxzKX0gYSBmdW5jdGlvbiB3aGljaCByZXByZXNlbnRzIHRoZSBjb21waWxlZCBleHByZXNzaW9uOlxuICpcbiAqICAgICogYGNvbnRleHRgIOKAkyBge29iamVjdH1gIOKAkyBhbiBvYmplY3QgYWdhaW5zdCB3aGljaCBhbnkgZXhwcmVzc2lvbnMgZW1iZWRkZWQgaW4gdGhlIHN0cmluZ3NcbiAqICAgICAgYXJlIGV2YWx1YXRlZCBhZ2FpbnN0ICh0eXBpY2FsbHkgYSBzY29wZSBvYmplY3QpLlxuICogICAgKiBgbG9jYWxzYCDigJMgYHtvYmplY3Q9fWAg4oCTIGxvY2FsIHZhcmlhYmxlcyBjb250ZXh0IG9iamVjdCwgdXNlZnVsIGZvciBvdmVycmlkaW5nIHZhbHVlcyBpblxuICogICAgICBgY29udGV4dGAuXG4gKlxuICogICAgVGhlIHJldHVybmVkIGZ1bmN0aW9uIGFsc28gaGFzIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqICAgICAgKiBgbGl0ZXJhbGAg4oCTIGB7Ym9vbGVhbn1gIOKAkyB3aGV0aGVyIHRoZSBleHByZXNzaW9uJ3MgdG9wLWxldmVsIG5vZGUgaXMgYSBKYXZhU2NyaXB0XG4gKiAgICAgICAgbGl0ZXJhbC5cbiAqICAgICAgKiBgY29uc3RhbnRgIOKAkyBge2Jvb2xlYW59YCDigJMgd2hldGhlciB0aGUgZXhwcmVzc2lvbiBpcyBtYWRlIGVudGlyZWx5IG9mIEphdmFTY3JpcHRcbiAqICAgICAgICBjb25zdGFudCBsaXRlcmFscy5cbiAqICAgICAgKiBgYXNzaWduYCDigJMgYHs/ZnVuY3Rpb24oY29udGV4dCwgdmFsdWUpfWAg4oCTIGlmIHRoZSBleHByZXNzaW9uIGlzIGFzc2lnbmFibGUsIHRoaXMgd2lsbCBiZVxuICogICAgICAgIHNldCB0byBhIGZ1bmN0aW9uIHRvIGNoYW5nZSBpdHMgdmFsdWUgb24gdGhlIGdpdmVuIGNvbnRleHQuXG4gKlxuICovXG5cblxuLyoqXG4gKiBAbmdkb2MgcHJvdmlkZXJcbiAqIEBuYW1lICRwYXJzZVByb3ZpZGVyXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBgJHBhcnNlUHJvdmlkZXJgIGNhbiBiZSB1c2VkIGZvciBjb25maWd1cmluZyB0aGUgZGVmYXVsdCBiZWhhdmlvciBvZiB0aGUge0BsaW5rIG5nLiRwYXJzZSAkcGFyc2V9XG4gKiAgc2VydmljZS5cbiAqL1xuZnVuY3Rpb24gJFBhcnNlUHJvdmlkZXIoKSB7XG4gIHZhciBjYWNoZURlZmF1bHQgPSBjcmVhdGVNYXAoKTtcbiAgdmFyIGNhY2hlRXhwZW5zaXZlID0gY3JlYXRlTWFwKCk7XG5cbiAgdGhpcy4kZ2V0ID0gWyckZmlsdGVyJywgZnVuY3Rpb24oJGZpbHRlcikge1xuICAgIHZhciBub1Vuc2FmZUV2YWwgPSBjc3AoKS5ub1Vuc2FmZUV2YWw7XG4gICAgdmFyICRwYXJzZU9wdGlvbnMgPSB7XG4gICAgICAgICAgY3NwOiBub1Vuc2FmZUV2YWwsXG4gICAgICAgICAgZXhwZW5zaXZlQ2hlY2tzOiBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICAkcGFyc2VPcHRpb25zRXhwZW5zaXZlID0ge1xuICAgICAgICAgIGNzcDogbm9VbnNhZmVFdmFsLFxuICAgICAgICAgIGV4cGVuc2l2ZUNoZWNrczogdHJ1ZVxuICAgICAgICB9O1xuICAgIHZhciBydW5uaW5nQ2hlY2tzRW5hYmxlZCA9IGZhbHNlO1xuXG4gICAgJHBhcnNlLiQkcnVubmluZ0V4cGVuc2l2ZUNoZWNrcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJ1bm5pbmdDaGVja3NFbmFibGVkO1xuICAgIH07XG5cbiAgICByZXR1cm4gJHBhcnNlO1xuXG4gICAgZnVuY3Rpb24gJHBhcnNlKGV4cCwgaW50ZXJjZXB0b3JGbiwgZXhwZW5zaXZlQ2hlY2tzKSB7XG4gICAgICB2YXIgcGFyc2VkRXhwcmVzc2lvbiwgb25lVGltZSwgY2FjaGVLZXk7XG5cbiAgICAgIGV4cGVuc2l2ZUNoZWNrcyA9IGV4cGVuc2l2ZUNoZWNrcyB8fCBydW5uaW5nQ2hlY2tzRW5hYmxlZDtcblxuICAgICAgc3dpdGNoICh0eXBlb2YgZXhwKSB7XG4gICAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgICAgZXhwID0gZXhwLnRyaW0oKTtcbiAgICAgICAgICBjYWNoZUtleSA9IGV4cDtcblxuICAgICAgICAgIHZhciBjYWNoZSA9IChleHBlbnNpdmVDaGVja3MgPyBjYWNoZUV4cGVuc2l2ZSA6IGNhY2hlRGVmYXVsdCk7XG4gICAgICAgICAgcGFyc2VkRXhwcmVzc2lvbiA9IGNhY2hlW2NhY2hlS2V5XTtcblxuICAgICAgICAgIGlmICghcGFyc2VkRXhwcmVzc2lvbikge1xuICAgICAgICAgICAgaWYgKGV4cC5jaGFyQXQoMCkgPT09ICc6JyAmJiBleHAuY2hhckF0KDEpID09PSAnOicpIHtcbiAgICAgICAgICAgICAgb25lVGltZSA9IHRydWU7XG4gICAgICAgICAgICAgIGV4cCA9IGV4cC5zdWJzdHJpbmcoMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcGFyc2VPcHRpb25zID0gZXhwZW5zaXZlQ2hlY2tzID8gJHBhcnNlT3B0aW9uc0V4cGVuc2l2ZSA6ICRwYXJzZU9wdGlvbnM7XG4gICAgICAgICAgICB2YXIgbGV4ZXIgPSBuZXcgTGV4ZXIocGFyc2VPcHRpb25zKTtcbiAgICAgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgUGFyc2VyKGxleGVyLCAkZmlsdGVyLCBwYXJzZU9wdGlvbnMpO1xuICAgICAgICAgICAgcGFyc2VkRXhwcmVzc2lvbiA9IHBhcnNlci5wYXJzZShleHApO1xuICAgICAgICAgICAgaWYgKHBhcnNlZEV4cHJlc3Npb24uY29uc3RhbnQpIHtcbiAgICAgICAgICAgICAgcGFyc2VkRXhwcmVzc2lvbi4kJHdhdGNoRGVsZWdhdGUgPSBjb25zdGFudFdhdGNoRGVsZWdhdGU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG9uZVRpbWUpIHtcbiAgICAgICAgICAgICAgcGFyc2VkRXhwcmVzc2lvbi4kJHdhdGNoRGVsZWdhdGUgPSBwYXJzZWRFeHByZXNzaW9uLmxpdGVyYWwgP1xuICAgICAgICAgICAgICAgICAgb25lVGltZUxpdGVyYWxXYXRjaERlbGVnYXRlIDogb25lVGltZVdhdGNoRGVsZWdhdGU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhcnNlZEV4cHJlc3Npb24uaW5wdXRzKSB7XG4gICAgICAgICAgICAgIHBhcnNlZEV4cHJlc3Npb24uJCR3YXRjaERlbGVnYXRlID0gaW5wdXRzV2F0Y2hEZWxlZ2F0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChleHBlbnNpdmVDaGVja3MpIHtcbiAgICAgICAgICAgICAgcGFyc2VkRXhwcmVzc2lvbiA9IGV4cGVuc2l2ZUNoZWNrc0ludGVyY2VwdG9yKHBhcnNlZEV4cHJlc3Npb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FjaGVbY2FjaGVLZXldID0gcGFyc2VkRXhwcmVzc2lvbjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGFkZEludGVyY2VwdG9yKHBhcnNlZEV4cHJlc3Npb24sIGludGVyY2VwdG9yRm4pO1xuXG4gICAgICAgIGNhc2UgJ2Z1bmN0aW9uJzpcbiAgICAgICAgICByZXR1cm4gYWRkSW50ZXJjZXB0b3IoZXhwLCBpbnRlcmNlcHRvckZuKTtcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiBhZGRJbnRlcmNlcHRvcihub29wLCBpbnRlcmNlcHRvckZuKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBleHBlbnNpdmVDaGVja3NJbnRlcmNlcHRvcihmbikge1xuICAgICAgaWYgKCFmbikgcmV0dXJuIGZuO1xuICAgICAgZXhwZW5zaXZlQ2hlY2tGbi4kJHdhdGNoRGVsZWdhdGUgPSBmbi4kJHdhdGNoRGVsZWdhdGU7XG4gICAgICBleHBlbnNpdmVDaGVja0ZuLmFzc2lnbiA9IGV4cGVuc2l2ZUNoZWNrc0ludGVyY2VwdG9yKGZuLmFzc2lnbik7XG4gICAgICBleHBlbnNpdmVDaGVja0ZuLmNvbnN0YW50ID0gZm4uY29uc3RhbnQ7XG4gICAgICBleHBlbnNpdmVDaGVja0ZuLmxpdGVyYWwgPSBmbi5saXRlcmFsO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGZuLmlucHV0cyAmJiBpIDwgZm4uaW5wdXRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGZuLmlucHV0c1tpXSA9IGV4cGVuc2l2ZUNoZWNrc0ludGVyY2VwdG9yKGZuLmlucHV0c1tpXSk7XG4gICAgICB9XG4gICAgICBleHBlbnNpdmVDaGVja0ZuLmlucHV0cyA9IGZuLmlucHV0cztcblxuICAgICAgcmV0dXJuIGV4cGVuc2l2ZUNoZWNrRm47XG5cbiAgICAgIGZ1bmN0aW9uIGV4cGVuc2l2ZUNoZWNrRm4oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpIHtcbiAgICAgICAgdmFyIGV4cGVuc2l2ZUNoZWNrT2xkVmFsdWUgPSBydW5uaW5nQ2hlY2tzRW5hYmxlZDtcbiAgICAgICAgcnVubmluZ0NoZWNrc0VuYWJsZWQgPSB0cnVlO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHJldHVybiBmbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgcnVubmluZ0NoZWNrc0VuYWJsZWQgPSBleHBlbnNpdmVDaGVja09sZFZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXhwcmVzc2lvbklucHV0RGlydHlDaGVjayhuZXdWYWx1ZSwgb2xkVmFsdWVPZlZhbHVlKSB7XG5cbiAgICAgIGlmIChuZXdWYWx1ZSA9PSBudWxsIHx8IG9sZFZhbHVlT2ZWYWx1ZSA9PSBudWxsKSB7IC8vIG51bGwvdW5kZWZpbmVkXG4gICAgICAgIHJldHVybiBuZXdWYWx1ZSA9PT0gb2xkVmFsdWVPZlZhbHVlO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIG5ld1ZhbHVlID09PSAnb2JqZWN0Jykge1xuXG4gICAgICAgIC8vIGF0dGVtcHQgdG8gY29udmVydCB0aGUgdmFsdWUgdG8gYSBwcmltaXRpdmUgdHlwZVxuICAgICAgICAvLyBUT0RPKGRvY3MpOiBhZGQgYSBub3RlIHRvIGRvY3MgdGhhdCBieSBpbXBsZW1lbnRpbmcgdmFsdWVPZiBldmVuIG9iamVjdHMgYW5kIGFycmF5cyBjYW5cbiAgICAgICAgLy8gICAgICAgICAgICAgYmUgY2hlYXBseSBkaXJ0eS1jaGVja2VkXG4gICAgICAgIG5ld1ZhbHVlID0gZ2V0VmFsdWVPZihuZXdWYWx1ZSk7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBuZXdWYWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAvLyBvYmplY3RzL2FycmF5cyBhcmUgbm90IHN1cHBvcnRlZCAtIGRlZXAtd2F0Y2hpbmcgdGhlbSB3b3VsZCBiZSB0b28gZXhwZW5zaXZlXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZmFsbC10aHJvdWdoIHRvIHRoZSBwcmltaXRpdmUgZXF1YWxpdHkgY2hlY2tcbiAgICAgIH1cblxuICAgICAgLy9QcmltaXRpdmUgb3IgTmFOXG4gICAgICByZXR1cm4gbmV3VmFsdWUgPT09IG9sZFZhbHVlT2ZWYWx1ZSB8fCAobmV3VmFsdWUgIT09IG5ld1ZhbHVlICYmIG9sZFZhbHVlT2ZWYWx1ZSAhPT0gb2xkVmFsdWVPZlZhbHVlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnB1dHNXYXRjaERlbGVnYXRlKHNjb3BlLCBsaXN0ZW5lciwgb2JqZWN0RXF1YWxpdHksIHBhcnNlZEV4cHJlc3Npb24sIHByZXR0eVByaW50RXhwcmVzc2lvbikge1xuICAgICAgdmFyIGlucHV0RXhwcmVzc2lvbnMgPSBwYXJzZWRFeHByZXNzaW9uLmlucHV0cztcbiAgICAgIHZhciBsYXN0UmVzdWx0O1xuXG4gICAgICBpZiAoaW5wdXRFeHByZXNzaW9ucy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgdmFyIG9sZElucHV0VmFsdWVPZiA9IGV4cHJlc3Npb25JbnB1dERpcnR5Q2hlY2s7IC8vIGluaXQgdG8gc29tZXRoaW5nIHVuaXF1ZSBzbyB0aGF0IGVxdWFscyBjaGVjayBmYWlsc1xuICAgICAgICBpbnB1dEV4cHJlc3Npb25zID0gaW5wdXRFeHByZXNzaW9uc1swXTtcbiAgICAgICAgcmV0dXJuIHNjb3BlLiR3YXRjaChmdW5jdGlvbiBleHByZXNzaW9uSW5wdXRXYXRjaChzY29wZSkge1xuICAgICAgICAgIHZhciBuZXdJbnB1dFZhbHVlID0gaW5wdXRFeHByZXNzaW9ucyhzY29wZSk7XG4gICAgICAgICAgaWYgKCFleHByZXNzaW9uSW5wdXREaXJ0eUNoZWNrKG5ld0lucHV0VmFsdWUsIG9sZElucHV0VmFsdWVPZikpIHtcbiAgICAgICAgICAgIGxhc3RSZXN1bHQgPSBwYXJzZWRFeHByZXNzaW9uKHNjb3BlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgW25ld0lucHV0VmFsdWVdKTtcbiAgICAgICAgICAgIG9sZElucHV0VmFsdWVPZiA9IG5ld0lucHV0VmFsdWUgJiYgZ2V0VmFsdWVPZihuZXdJbnB1dFZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGxhc3RSZXN1bHQ7XG4gICAgICAgIH0sIGxpc3RlbmVyLCBvYmplY3RFcXVhbGl0eSwgcHJldHR5UHJpbnRFeHByZXNzaW9uKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG9sZElucHV0VmFsdWVPZlZhbHVlcyA9IFtdO1xuICAgICAgdmFyIG9sZElucHV0VmFsdWVzID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBpbnB1dEV4cHJlc3Npb25zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgb2xkSW5wdXRWYWx1ZU9mVmFsdWVzW2ldID0gZXhwcmVzc2lvbklucHV0RGlydHlDaGVjazsgLy8gaW5pdCB0byBzb21ldGhpbmcgdW5pcXVlIHNvIHRoYXQgZXF1YWxzIGNoZWNrIGZhaWxzXG4gICAgICAgIG9sZElucHV0VmFsdWVzW2ldID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHNjb3BlLiR3YXRjaChmdW5jdGlvbiBleHByZXNzaW9uSW5wdXRzV2F0Y2goc2NvcGUpIHtcbiAgICAgICAgdmFyIGNoYW5nZWQgPSBmYWxzZTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBpbnB1dEV4cHJlc3Npb25zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICB2YXIgbmV3SW5wdXRWYWx1ZSA9IGlucHV0RXhwcmVzc2lvbnNbaV0oc2NvcGUpO1xuICAgICAgICAgIGlmIChjaGFuZ2VkIHx8IChjaGFuZ2VkID0gIWV4cHJlc3Npb25JbnB1dERpcnR5Q2hlY2sobmV3SW5wdXRWYWx1ZSwgb2xkSW5wdXRWYWx1ZU9mVmFsdWVzW2ldKSkpIHtcbiAgICAgICAgICAgIG9sZElucHV0VmFsdWVzW2ldID0gbmV3SW5wdXRWYWx1ZTtcbiAgICAgICAgICAgIG9sZElucHV0VmFsdWVPZlZhbHVlc1tpXSA9IG5ld0lucHV0VmFsdWUgJiYgZ2V0VmFsdWVPZihuZXdJbnB1dFZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICAgIGxhc3RSZXN1bHQgPSBwYXJzZWRFeHByZXNzaW9uKHNjb3BlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgb2xkSW5wdXRWYWx1ZXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGxhc3RSZXN1bHQ7XG4gICAgICB9LCBsaXN0ZW5lciwgb2JqZWN0RXF1YWxpdHksIHByZXR0eVByaW50RXhwcmVzc2lvbik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25lVGltZVdhdGNoRGVsZWdhdGUoc2NvcGUsIGxpc3RlbmVyLCBvYmplY3RFcXVhbGl0eSwgcGFyc2VkRXhwcmVzc2lvbikge1xuICAgICAgdmFyIHVud2F0Y2gsIGxhc3RWYWx1ZTtcbiAgICAgIHJldHVybiB1bndhdGNoID0gc2NvcGUuJHdhdGNoKGZ1bmN0aW9uIG9uZVRpbWVXYXRjaChzY29wZSkge1xuICAgICAgICByZXR1cm4gcGFyc2VkRXhwcmVzc2lvbihzY29wZSk7XG4gICAgICB9LCBmdW5jdGlvbiBvbmVUaW1lTGlzdGVuZXIodmFsdWUsIG9sZCwgc2NvcGUpIHtcbiAgICAgICAgbGFzdFZhbHVlID0gdmFsdWU7XG4gICAgICAgIGlmIChpc0Z1bmN0aW9uKGxpc3RlbmVyKSkge1xuICAgICAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzRGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgICAgICBzY29wZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoaXNEZWZpbmVkKGxhc3RWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgdW53YXRjaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LCBvYmplY3RFcXVhbGl0eSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25lVGltZUxpdGVyYWxXYXRjaERlbGVnYXRlKHNjb3BlLCBsaXN0ZW5lciwgb2JqZWN0RXF1YWxpdHksIHBhcnNlZEV4cHJlc3Npb24pIHtcbiAgICAgIHZhciB1bndhdGNoLCBsYXN0VmFsdWU7XG4gICAgICByZXR1cm4gdW53YXRjaCA9IHNjb3BlLiR3YXRjaChmdW5jdGlvbiBvbmVUaW1lV2F0Y2goc2NvcGUpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlZEV4cHJlc3Npb24oc2NvcGUpO1xuICAgICAgfSwgZnVuY3Rpb24gb25lVGltZUxpc3RlbmVyKHZhbHVlLCBvbGQsIHNjb3BlKSB7XG4gICAgICAgIGxhc3RWYWx1ZSA9IHZhbHVlO1xuICAgICAgICBpZiAoaXNGdW5jdGlvbihsaXN0ZW5lcikpIHtcbiAgICAgICAgICBsaXN0ZW5lci5jYWxsKHRoaXMsIHZhbHVlLCBvbGQsIHNjb3BlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNBbGxEZWZpbmVkKHZhbHVlKSkge1xuICAgICAgICAgIHNjb3BlLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChpc0FsbERlZmluZWQobGFzdFZhbHVlKSkgdW53YXRjaCgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LCBvYmplY3RFcXVhbGl0eSk7XG5cbiAgICAgIGZ1bmN0aW9uIGlzQWxsRGVmaW5lZCh2YWx1ZSkge1xuICAgICAgICB2YXIgYWxsRGVmaW5lZCA9IHRydWU7XG4gICAgICAgIGZvckVhY2godmFsdWUsIGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgIGlmICghaXNEZWZpbmVkKHZhbCkpIGFsbERlZmluZWQgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhbGxEZWZpbmVkO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbnN0YW50V2F0Y2hEZWxlZ2F0ZShzY29wZSwgbGlzdGVuZXIsIG9iamVjdEVxdWFsaXR5LCBwYXJzZWRFeHByZXNzaW9uKSB7XG4gICAgICB2YXIgdW53YXRjaDtcbiAgICAgIHJldHVybiB1bndhdGNoID0gc2NvcGUuJHdhdGNoKGZ1bmN0aW9uIGNvbnN0YW50V2F0Y2goc2NvcGUpIHtcbiAgICAgICAgdW53YXRjaCgpO1xuICAgICAgICByZXR1cm4gcGFyc2VkRXhwcmVzc2lvbihzY29wZSk7XG4gICAgICB9LCBsaXN0ZW5lciwgb2JqZWN0RXF1YWxpdHkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZEludGVyY2VwdG9yKHBhcnNlZEV4cHJlc3Npb24sIGludGVyY2VwdG9yRm4pIHtcbiAgICAgIGlmICghaW50ZXJjZXB0b3JGbikgcmV0dXJuIHBhcnNlZEV4cHJlc3Npb247XG4gICAgICB2YXIgd2F0Y2hEZWxlZ2F0ZSA9IHBhcnNlZEV4cHJlc3Npb24uJCR3YXRjaERlbGVnYXRlO1xuICAgICAgdmFyIHVzZUlucHV0cyA9IGZhbHNlO1xuXG4gICAgICB2YXIgcmVndWxhcldhdGNoID1cbiAgICAgICAgICB3YXRjaERlbGVnYXRlICE9PSBvbmVUaW1lTGl0ZXJhbFdhdGNoRGVsZWdhdGUgJiZcbiAgICAgICAgICB3YXRjaERlbGVnYXRlICE9PSBvbmVUaW1lV2F0Y2hEZWxlZ2F0ZTtcblxuICAgICAgdmFyIGZuID0gcmVndWxhcldhdGNoID8gZnVuY3Rpb24gcmVndWxhckludGVyY2VwdGVkRXhwcmVzc2lvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cykge1xuICAgICAgICB2YXIgdmFsdWUgPSB1c2VJbnB1dHMgJiYgaW5wdXRzID8gaW5wdXRzWzBdIDogcGFyc2VkRXhwcmVzc2lvbihzY29wZSwgbG9jYWxzLCBhc3NpZ24sIGlucHV0cyk7XG4gICAgICAgIHJldHVybiBpbnRlcmNlcHRvckZuKHZhbHVlLCBzY29wZSwgbG9jYWxzKTtcbiAgICAgIH0gOiBmdW5jdGlvbiBvbmVUaW1lSW50ZXJjZXB0ZWRFeHByZXNzaW9uKHNjb3BlLCBsb2NhbHMsIGFzc2lnbiwgaW5wdXRzKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHBhcnNlZEV4cHJlc3Npb24oc2NvcGUsIGxvY2FscywgYXNzaWduLCBpbnB1dHMpO1xuICAgICAgICB2YXIgcmVzdWx0ID0gaW50ZXJjZXB0b3JGbih2YWx1ZSwgc2NvcGUsIGxvY2Fscyk7XG4gICAgICAgIC8vIHdlIG9ubHkgcmV0dXJuIHRoZSBpbnRlcmNlcHRvcidzIHJlc3VsdCBpZiB0aGVcbiAgICAgICAgLy8gaW5pdGlhbCB2YWx1ZSBpcyBkZWZpbmVkIChmb3IgYmluZC1vbmNlKVxuICAgICAgICByZXR1cm4gaXNEZWZpbmVkKHZhbHVlKSA/IHJlc3VsdCA6IHZhbHVlO1xuICAgICAgfTtcblxuICAgICAgLy8gUHJvcGFnYXRlICQkd2F0Y2hEZWxlZ2F0ZXMgb3RoZXIgdGhlbiBpbnB1dHNXYXRjaERlbGVnYXRlXG4gICAgICBpZiAocGFyc2VkRXhwcmVzc2lvbi4kJHdhdGNoRGVsZWdhdGUgJiZcbiAgICAgICAgICBwYXJzZWRFeHByZXNzaW9uLiQkd2F0Y2hEZWxlZ2F0ZSAhPT0gaW5wdXRzV2F0Y2hEZWxlZ2F0ZSkge1xuICAgICAgICBmbi4kJHdhdGNoRGVsZWdhdGUgPSBwYXJzZWRFeHByZXNzaW9uLiQkd2F0Y2hEZWxlZ2F0ZTtcbiAgICAgIH0gZWxzZSBpZiAoIWludGVyY2VwdG9yRm4uJHN0YXRlZnVsKSB7XG4gICAgICAgIC8vIElmIHRoZXJlIGlzIGFuIGludGVyY2VwdG9yLCBidXQgbm8gd2F0Y2hEZWxlZ2F0ZSB0aGVuIHRyZWF0IHRoZSBpbnRlcmNlcHRvciBsaWtlXG4gICAgICAgIC8vIHdlIHRyZWF0IGZpbHRlcnMgLSBpdCBpcyBhc3N1bWVkIHRvIGJlIGEgcHVyZSBmdW5jdGlvbiB1bmxlc3MgZmxhZ2dlZCB3aXRoICRzdGF0ZWZ1bFxuICAgICAgICBmbi4kJHdhdGNoRGVsZWdhdGUgPSBpbnB1dHNXYXRjaERlbGVnYXRlO1xuICAgICAgICB1c2VJbnB1dHMgPSAhcGFyc2VkRXhwcmVzc2lvbi5pbnB1dHM7XG4gICAgICAgIGZuLmlucHV0cyA9IHBhcnNlZEV4cHJlc3Npb24uaW5wdXRzID8gcGFyc2VkRXhwcmVzc2lvbi5pbnB1dHMgOiBbcGFyc2VkRXhwcmVzc2lvbl07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmbjtcbiAgICB9XG4gIH1dO1xufVxuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkcVxuICogQHJlcXVpcmVzICRyb290U2NvcGVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIEEgc2VydmljZSB0aGF0IGhlbHBzIHlvdSBydW4gZnVuY3Rpb25zIGFzeW5jaHJvbm91c2x5LCBhbmQgdXNlIHRoZWlyIHJldHVybiB2YWx1ZXMgKG9yIGV4Y2VwdGlvbnMpXG4gKiB3aGVuIHRoZXkgYXJlIGRvbmUgcHJvY2Vzc2luZy5cbiAqXG4gKiBUaGlzIGlzIGFuIGltcGxlbWVudGF0aW9uIG9mIHByb21pc2VzL2RlZmVycmVkIG9iamVjdHMgaW5zcGlyZWQgYnlcbiAqIFtLcmlzIEtvd2FsJ3MgUV0oaHR0cHM6Ly9naXRodWIuY29tL2tyaXNrb3dhbC9xKS5cbiAqXG4gKiAkcSBjYW4gYmUgdXNlZCBpbiB0d28gZmFzaGlvbnMgLS0tIG9uZSB3aGljaCBpcyBtb3JlIHNpbWlsYXIgdG8gS3JpcyBLb3dhbCdzIFEgb3IgalF1ZXJ5J3MgRGVmZXJyZWRcbiAqIGltcGxlbWVudGF0aW9ucywgYW5kIHRoZSBvdGhlciB3aGljaCByZXNlbWJsZXMgRVM2IHByb21pc2VzIHRvIHNvbWUgZGVncmVlLlxuICpcbiAqICMgJHEgY29uc3RydWN0b3JcbiAqXG4gKiBUaGUgc3RyZWFtbGluZWQgRVM2IHN0eWxlIHByb21pc2UgaXMgZXNzZW50aWFsbHkganVzdCB1c2luZyAkcSBhcyBhIGNvbnN0cnVjdG9yIHdoaWNoIHRha2VzIGEgYHJlc29sdmVyYFxuICogZnVuY3Rpb24gYXMgdGhlIGZpcnN0IGFyZ3VtZW50LiBUaGlzIGlzIHNpbWlsYXIgdG8gdGhlIG5hdGl2ZSBQcm9taXNlIGltcGxlbWVudGF0aW9uIGZyb20gRVM2IEhhcm1vbnksXG4gKiBzZWUgW01ETl0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvUHJvbWlzZSkuXG4gKlxuICogV2hpbGUgdGhlIGNvbnN0cnVjdG9yLXN0eWxlIHVzZSBpcyBzdXBwb3J0ZWQsIG5vdCBhbGwgb2YgdGhlIHN1cHBvcnRpbmcgbWV0aG9kcyBmcm9tIEVTNiBIYXJtb255IHByb21pc2VzIGFyZVxuICogYXZhaWxhYmxlIHlldC5cbiAqXG4gKiBJdCBjYW4gYmUgdXNlZCBsaWtlIHNvOlxuICpcbiAqIGBgYGpzXG4gKiAgIC8vIGZvciB0aGUgcHVycG9zZSBvZiB0aGlzIGV4YW1wbGUgbGV0J3MgYXNzdW1lIHRoYXQgdmFyaWFibGVzIGAkcWAgYW5kIGBva1RvR3JlZXRgXG4gKiAgIC8vIGFyZSBhdmFpbGFibGUgaW4gdGhlIGN1cnJlbnQgbGV4aWNhbCBzY29wZSAodGhleSBjb3VsZCBoYXZlIGJlZW4gaW5qZWN0ZWQgb3IgcGFzc2VkIGluKS5cbiAqXG4gKiAgIGZ1bmN0aW9uIGFzeW5jR3JlZXQobmFtZSkge1xuICogICAgIC8vIHBlcmZvcm0gc29tZSBhc3luY2hyb25vdXMgb3BlcmF0aW9uLCByZXNvbHZlIG9yIHJlamVjdCB0aGUgcHJvbWlzZSB3aGVuIGFwcHJvcHJpYXRlLlxuICogICAgIHJldHVybiAkcShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAqICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gKiAgICAgICAgIGlmIChva1RvR3JlZXQobmFtZSkpIHtcbiAqICAgICAgICAgICByZXNvbHZlKCdIZWxsbywgJyArIG5hbWUgKyAnIScpO1xuICogICAgICAgICB9IGVsc2Uge1xuICogICAgICAgICAgIHJlamVjdCgnR3JlZXRpbmcgJyArIG5hbWUgKyAnIGlzIG5vdCBhbGxvd2VkLicpO1xuICogICAgICAgICB9XG4gKiAgICAgICB9LCAxMDAwKTtcbiAqICAgICB9KTtcbiAqICAgfVxuICpcbiAqICAgdmFyIHByb21pc2UgPSBhc3luY0dyZWV0KCdSb2JpbiBIb29kJyk7XG4gKiAgIHByb21pc2UudGhlbihmdW5jdGlvbihncmVldGluZykge1xuICogICAgIGFsZXJ0KCdTdWNjZXNzOiAnICsgZ3JlZXRpbmcpO1xuICogICB9LCBmdW5jdGlvbihyZWFzb24pIHtcbiAqICAgICBhbGVydCgnRmFpbGVkOiAnICsgcmVhc29uKTtcbiAqICAgfSk7XG4gKiBgYGBcbiAqXG4gKiBOb3RlOiBwcm9ncmVzcy9ub3RpZnkgY2FsbGJhY2tzIGFyZSBub3QgY3VycmVudGx5IHN1cHBvcnRlZCB2aWEgdGhlIEVTNi1zdHlsZSBpbnRlcmZhY2UuXG4gKlxuICogTm90ZTogdW5saWtlIEVTNiBiZWhhdmlvciwgYW4gZXhjZXB0aW9uIHRocm93biBpbiB0aGUgY29uc3RydWN0b3IgZnVuY3Rpb24gd2lsbCBOT1QgaW1wbGljaXRseSByZWplY3QgdGhlIHByb21pc2UuXG4gKlxuICogSG93ZXZlciwgdGhlIG1vcmUgdHJhZGl0aW9uYWwgQ29tbW9uSlMtc3R5bGUgdXNhZ2UgaXMgc3RpbGwgYXZhaWxhYmxlLCBhbmQgZG9jdW1lbnRlZCBiZWxvdy5cbiAqXG4gKiBbVGhlIENvbW1vbkpTIFByb21pc2UgcHJvcG9zYWxdKGh0dHA6Ly93aWtpLmNvbW1vbmpzLm9yZy93aWtpL1Byb21pc2VzKSBkZXNjcmliZXMgYSBwcm9taXNlIGFzIGFuXG4gKiBpbnRlcmZhY2UgZm9yIGludGVyYWN0aW5nIHdpdGggYW4gb2JqZWN0IHRoYXQgcmVwcmVzZW50cyB0aGUgcmVzdWx0IG9mIGFuIGFjdGlvbiB0aGF0IGlzXG4gKiBwZXJmb3JtZWQgYXN5bmNocm9ub3VzbHksIGFuZCBtYXkgb3IgbWF5IG5vdCBiZSBmaW5pc2hlZCBhdCBhbnkgZ2l2ZW4gcG9pbnQgaW4gdGltZS5cbiAqXG4gKiBGcm9tIHRoZSBwZXJzcGVjdGl2ZSBvZiBkZWFsaW5nIHdpdGggZXJyb3IgaGFuZGxpbmcsIGRlZmVycmVkIGFuZCBwcm9taXNlIEFQSXMgYXJlIHRvXG4gKiBhc3luY2hyb25vdXMgcHJvZ3JhbW1pbmcgd2hhdCBgdHJ5YCwgYGNhdGNoYCBhbmQgYHRocm93YCBrZXl3b3JkcyBhcmUgdG8gc3luY2hyb25vdXMgcHJvZ3JhbW1pbmcuXG4gKlxuICogYGBganNcbiAqICAgLy8gZm9yIHRoZSBwdXJwb3NlIG9mIHRoaXMgZXhhbXBsZSBsZXQncyBhc3N1bWUgdGhhdCB2YXJpYWJsZXMgYCRxYCBhbmQgYG9rVG9HcmVldGBcbiAqICAgLy8gYXJlIGF2YWlsYWJsZSBpbiB0aGUgY3VycmVudCBsZXhpY2FsIHNjb3BlICh0aGV5IGNvdWxkIGhhdmUgYmVlbiBpbmplY3RlZCBvciBwYXNzZWQgaW4pLlxuICpcbiAqICAgZnVuY3Rpb24gYXN5bmNHcmVldChuYW1lKSB7XG4gKiAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAqXG4gKiAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAqICAgICAgIGRlZmVycmVkLm5vdGlmeSgnQWJvdXQgdG8gZ3JlZXQgJyArIG5hbWUgKyAnLicpO1xuICpcbiAqICAgICAgIGlmIChva1RvR3JlZXQobmFtZSkpIHtcbiAqICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgnSGVsbG8sICcgKyBuYW1lICsgJyEnKTtcbiAqICAgICAgIH0gZWxzZSB7XG4gKiAgICAgICAgIGRlZmVycmVkLnJlamVjdCgnR3JlZXRpbmcgJyArIG5hbWUgKyAnIGlzIG5vdCBhbGxvd2VkLicpO1xuICogICAgICAgfVxuICogICAgIH0sIDEwMDApO1xuICpcbiAqICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAqICAgfVxuICpcbiAqICAgdmFyIHByb21pc2UgPSBhc3luY0dyZWV0KCdSb2JpbiBIb29kJyk7XG4gKiAgIHByb21pc2UudGhlbihmdW5jdGlvbihncmVldGluZykge1xuICogICAgIGFsZXJ0KCdTdWNjZXNzOiAnICsgZ3JlZXRpbmcpO1xuICogICB9LCBmdW5jdGlvbihyZWFzb24pIHtcbiAqICAgICBhbGVydCgnRmFpbGVkOiAnICsgcmVhc29uKTtcbiAqICAgfSwgZnVuY3Rpb24odXBkYXRlKSB7XG4gKiAgICAgYWxlcnQoJ0dvdCBub3RpZmljYXRpb246ICcgKyB1cGRhdGUpO1xuICogICB9KTtcbiAqIGBgYFxuICpcbiAqIEF0IGZpcnN0IGl0IG1pZ2h0IG5vdCBiZSBvYnZpb3VzIHdoeSB0aGlzIGV4dHJhIGNvbXBsZXhpdHkgaXMgd29ydGggdGhlIHRyb3VibGUuIFRoZSBwYXlvZmZcbiAqIGNvbWVzIGluIHRoZSB3YXkgb2YgZ3VhcmFudGVlcyB0aGF0IHByb21pc2UgYW5kIGRlZmVycmVkIEFQSXMgbWFrZSwgc2VlXG4gKiBodHRwczovL2dpdGh1Yi5jb20va3Jpc2tvd2FsL3VuY29tbW9uanMvYmxvYi9tYXN0ZXIvcHJvbWlzZXMvc3BlY2lmaWNhdGlvbi5tZC5cbiAqXG4gKiBBZGRpdGlvbmFsbHkgdGhlIHByb21pc2UgYXBpIGFsbG93cyBmb3IgY29tcG9zaXRpb24gdGhhdCBpcyB2ZXJ5IGhhcmQgdG8gZG8gd2l0aCB0aGVcbiAqIHRyYWRpdGlvbmFsIGNhbGxiYWNrIChbQ1BTXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NvbnRpbnVhdGlvbi1wYXNzaW5nX3N0eWxlKSkgYXBwcm9hY2guXG4gKiBGb3IgbW9yZSBvbiB0aGlzIHBsZWFzZSBzZWUgdGhlIFtRIGRvY3VtZW50YXRpb25dKGh0dHBzOi8vZ2l0aHViLmNvbS9rcmlza293YWwvcSkgZXNwZWNpYWxseSB0aGVcbiAqIHNlY3Rpb24gb24gc2VyaWFsIG9yIHBhcmFsbGVsIGpvaW5pbmcgb2YgcHJvbWlzZXMuXG4gKlxuICogIyBUaGUgRGVmZXJyZWQgQVBJXG4gKlxuICogQSBuZXcgaW5zdGFuY2Ugb2YgZGVmZXJyZWQgaXMgY29uc3RydWN0ZWQgYnkgY2FsbGluZyBgJHEuZGVmZXIoKWAuXG4gKlxuICogVGhlIHB1cnBvc2Ugb2YgdGhlIGRlZmVycmVkIG9iamVjdCBpcyB0byBleHBvc2UgdGhlIGFzc29jaWF0ZWQgUHJvbWlzZSBpbnN0YW5jZSBhcyB3ZWxsIGFzIEFQSXNcbiAqIHRoYXQgY2FuIGJlIHVzZWQgZm9yIHNpZ25hbGluZyB0aGUgc3VjY2Vzc2Z1bCBvciB1bnN1Y2Nlc3NmdWwgY29tcGxldGlvbiwgYXMgd2VsbCBhcyB0aGUgc3RhdHVzXG4gKiBvZiB0aGUgdGFzay5cbiAqXG4gKiAqKk1ldGhvZHMqKlxuICpcbiAqIC0gYHJlc29sdmUodmFsdWUpYCDigJMgcmVzb2x2ZXMgdGhlIGRlcml2ZWQgcHJvbWlzZSB3aXRoIHRoZSBgdmFsdWVgLiBJZiB0aGUgdmFsdWUgaXMgYSByZWplY3Rpb25cbiAqICAgY29uc3RydWN0ZWQgdmlhIGAkcS5yZWplY3RgLCB0aGUgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIGluc3RlYWQuXG4gKiAtIGByZWplY3QocmVhc29uKWAg4oCTIHJlamVjdHMgdGhlIGRlcml2ZWQgcHJvbWlzZSB3aXRoIHRoZSBgcmVhc29uYC4gVGhpcyBpcyBlcXVpdmFsZW50IHRvXG4gKiAgIHJlc29sdmluZyBpdCB3aXRoIGEgcmVqZWN0aW9uIGNvbnN0cnVjdGVkIHZpYSBgJHEucmVqZWN0YC5cbiAqIC0gYG5vdGlmeSh2YWx1ZSlgIC0gcHJvdmlkZXMgdXBkYXRlcyBvbiB0aGUgc3RhdHVzIG9mIHRoZSBwcm9taXNlJ3MgZXhlY3V0aW9uLiBUaGlzIG1heSBiZSBjYWxsZWRcbiAqICAgbXVsdGlwbGUgdGltZXMgYmVmb3JlIHRoZSBwcm9taXNlIGlzIGVpdGhlciByZXNvbHZlZCBvciByZWplY3RlZC5cbiAqXG4gKiAqKlByb3BlcnRpZXMqKlxuICpcbiAqIC0gcHJvbWlzZSDigJMgYHtQcm9taXNlfWAg4oCTIHByb21pc2Ugb2JqZWN0IGFzc29jaWF0ZWQgd2l0aCB0aGlzIGRlZmVycmVkLlxuICpcbiAqXG4gKiAjIFRoZSBQcm9taXNlIEFQSVxuICpcbiAqIEEgbmV3IHByb21pc2UgaW5zdGFuY2UgaXMgY3JlYXRlZCB3aGVuIGEgZGVmZXJyZWQgaW5zdGFuY2UgaXMgY3JlYXRlZCBhbmQgY2FuIGJlIHJldHJpZXZlZCBieVxuICogY2FsbGluZyBgZGVmZXJyZWQucHJvbWlzZWAuXG4gKlxuICogVGhlIHB1cnBvc2Ugb2YgdGhlIHByb21pc2Ugb2JqZWN0IGlzIHRvIGFsbG93IGZvciBpbnRlcmVzdGVkIHBhcnRpZXMgdG8gZ2V0IGFjY2VzcyB0byB0aGUgcmVzdWx0XG4gKiBvZiB0aGUgZGVmZXJyZWQgdGFzayB3aGVuIGl0IGNvbXBsZXRlcy5cbiAqXG4gKiAqKk1ldGhvZHMqKlxuICpcbiAqIC0gYHRoZW4oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBub3RpZnlDYWxsYmFjaylgIOKAkyByZWdhcmRsZXNzIG9mIHdoZW4gdGhlIHByb21pc2Ugd2FzIG9yXG4gKiAgIHdpbGwgYmUgcmVzb2x2ZWQgb3IgcmVqZWN0ZWQsIGB0aGVuYCBjYWxscyBvbmUgb2YgdGhlIHN1Y2Nlc3Mgb3IgZXJyb3IgY2FsbGJhY2tzIGFzeW5jaHJvbm91c2x5XG4gKiAgIGFzIHNvb24gYXMgdGhlIHJlc3VsdCBpcyBhdmFpbGFibGUuIFRoZSBjYWxsYmFja3MgYXJlIGNhbGxlZCB3aXRoIGEgc2luZ2xlIGFyZ3VtZW50OiB0aGUgcmVzdWx0XG4gKiAgIG9yIHJlamVjdGlvbiByZWFzb24uIEFkZGl0aW9uYWxseSwgdGhlIG5vdGlmeSBjYWxsYmFjayBtYXkgYmUgY2FsbGVkIHplcm8gb3IgbW9yZSB0aW1lcyB0b1xuICogICBwcm92aWRlIGEgcHJvZ3Jlc3MgaW5kaWNhdGlvbiwgYmVmb3JlIHRoZSBwcm9taXNlIGlzIHJlc29sdmVkIG9yIHJlamVjdGVkLlxuICpcbiAqICAgVGhpcyBtZXRob2QgKnJldHVybnMgYSBuZXcgcHJvbWlzZSogd2hpY2ggaXMgcmVzb2x2ZWQgb3IgcmVqZWN0ZWQgdmlhIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlXG4gKiAgIGBzdWNjZXNzQ2FsbGJhY2tgLCBgZXJyb3JDYWxsYmFja2AgKHVubGVzcyB0aGF0IHZhbHVlIGlzIGEgcHJvbWlzZSwgaW4gd2hpY2ggY2FzZSBpdCBpcyByZXNvbHZlZFxuICogICB3aXRoIHRoZSB2YWx1ZSB3aGljaCBpcyByZXNvbHZlZCBpbiB0aGF0IHByb21pc2UgdXNpbmdcbiAqICAgW3Byb21pc2UgY2hhaW5pbmddKGh0dHA6Ly93d3cuaHRtbDVyb2Nrcy5jb20vZW4vdHV0b3JpYWxzL2VzNi9wcm9taXNlcy8jdG9jLXByb21pc2VzLXF1ZXVlcykpLlxuICogICBJdCBhbHNvIG5vdGlmaWVzIHZpYSB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBgbm90aWZ5Q2FsbGJhY2tgIG1ldGhvZC4gVGhlIHByb21pc2UgY2Fubm90IGJlXG4gKiAgIHJlc29sdmVkIG9yIHJlamVjdGVkIGZyb20gdGhlIG5vdGlmeUNhbGxiYWNrIG1ldGhvZC5cbiAqXG4gKiAtIGBjYXRjaChlcnJvckNhbGxiYWNrKWAg4oCTIHNob3J0aGFuZCBmb3IgYHByb21pc2UudGhlbihudWxsLCBlcnJvckNhbGxiYWNrKWBcbiAqXG4gKiAtIGBmaW5hbGx5KGNhbGxiYWNrLCBub3RpZnlDYWxsYmFjaylgIOKAkyBhbGxvd3MgeW91IHRvIG9ic2VydmUgZWl0aGVyIHRoZSBmdWxmaWxsbWVudCBvciByZWplY3Rpb24gb2YgYSBwcm9taXNlLFxuICogICBidXQgdG8gZG8gc28gd2l0aG91dCBtb2RpZnlpbmcgdGhlIGZpbmFsIHZhbHVlLiBUaGlzIGlzIHVzZWZ1bCB0byByZWxlYXNlIHJlc291cmNlcyBvciBkbyBzb21lXG4gKiAgIGNsZWFuLXVwIHRoYXQgbmVlZHMgdG8gYmUgZG9uZSB3aGV0aGVyIHRoZSBwcm9taXNlIHdhcyByZWplY3RlZCBvciByZXNvbHZlZC4gU2VlIHRoZSBbZnVsbFxuICogICBzcGVjaWZpY2F0aW9uXShodHRwczovL2dpdGh1Yi5jb20va3Jpc2tvd2FsL3Evd2lraS9BUEktUmVmZXJlbmNlI3Byb21pc2VmaW5hbGx5Y2FsbGJhY2spIGZvclxuICogICBtb3JlIGluZm9ybWF0aW9uLlxuICpcbiAqICMgQ2hhaW5pbmcgcHJvbWlzZXNcbiAqXG4gKiBCZWNhdXNlIGNhbGxpbmcgdGhlIGB0aGVuYCBtZXRob2Qgb2YgYSBwcm9taXNlIHJldHVybnMgYSBuZXcgZGVyaXZlZCBwcm9taXNlLCBpdCBpcyBlYXNpbHlcbiAqIHBvc3NpYmxlIHRvIGNyZWF0ZSBhIGNoYWluIG9mIHByb21pc2VzOlxuICpcbiAqIGBgYGpzXG4gKiAgIHByb21pc2VCID0gcHJvbWlzZUEudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAqICAgICByZXR1cm4gcmVzdWx0ICsgMTtcbiAqICAgfSk7XG4gKlxuICogICAvLyBwcm9taXNlQiB3aWxsIGJlIHJlc29sdmVkIGltbWVkaWF0ZWx5IGFmdGVyIHByb21pc2VBIGlzIHJlc29sdmVkIGFuZCBpdHMgdmFsdWVcbiAqICAgLy8gd2lsbCBiZSB0aGUgcmVzdWx0IG9mIHByb21pc2VBIGluY3JlbWVudGVkIGJ5IDFcbiAqIGBgYFxuICpcbiAqIEl0IGlzIHBvc3NpYmxlIHRvIGNyZWF0ZSBjaGFpbnMgb2YgYW55IGxlbmd0aCBhbmQgc2luY2UgYSBwcm9taXNlIGNhbiBiZSByZXNvbHZlZCB3aXRoIGFub3RoZXJcbiAqIHByb21pc2UgKHdoaWNoIHdpbGwgZGVmZXIgaXRzIHJlc29sdXRpb24gZnVydGhlciksIGl0IGlzIHBvc3NpYmxlIHRvIHBhdXNlL2RlZmVyIHJlc29sdXRpb24gb2ZcbiAqIHRoZSBwcm9taXNlcyBhdCBhbnkgcG9pbnQgaW4gdGhlIGNoYWluLiBUaGlzIG1ha2VzIGl0IHBvc3NpYmxlIHRvIGltcGxlbWVudCBwb3dlcmZ1bCBBUElzIGxpa2VcbiAqICRodHRwJ3MgcmVzcG9uc2UgaW50ZXJjZXB0b3JzLlxuICpcbiAqXG4gKiAjIERpZmZlcmVuY2VzIGJldHdlZW4gS3JpcyBLb3dhbCdzIFEgYW5kICRxXG4gKlxuICogIFRoZXJlIGFyZSB0d28gbWFpbiBkaWZmZXJlbmNlczpcbiAqXG4gKiAtICRxIGlzIGludGVncmF0ZWQgd2l0aCB0aGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGV9IFNjb3BlIG1vZGVsIG9ic2VydmF0aW9uXG4gKiAgIG1lY2hhbmlzbSBpbiBhbmd1bGFyLCB3aGljaCBtZWFucyBmYXN0ZXIgcHJvcGFnYXRpb24gb2YgcmVzb2x1dGlvbiBvciByZWplY3Rpb24gaW50byB5b3VyXG4gKiAgIG1vZGVscyBhbmQgYXZvaWRpbmcgdW5uZWNlc3NhcnkgYnJvd3NlciByZXBhaW50cywgd2hpY2ggd291bGQgcmVzdWx0IGluIGZsaWNrZXJpbmcgVUkuXG4gKiAtIFEgaGFzIG1hbnkgbW9yZSBmZWF0dXJlcyB0aGFuICRxLCBidXQgdGhhdCBjb21lcyBhdCBhIGNvc3Qgb2YgYnl0ZXMuICRxIGlzIHRpbnksIGJ1dCBjb250YWluc1xuICogICBhbGwgdGhlIGltcG9ydGFudCBmdW5jdGlvbmFsaXR5IG5lZWRlZCBmb3IgY29tbW9uIGFzeW5jIHRhc2tzLlxuICpcbiAqICAjIFRlc3RpbmdcbiAqXG4gKiAgYGBganNcbiAqICAgIGl0KCdzaG91bGQgc2ltdWxhdGUgcHJvbWlzZScsIGluamVjdChmdW5jdGlvbigkcSwgJHJvb3RTY29wZSkge1xuICogICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICogICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gKiAgICAgIHZhciByZXNvbHZlZFZhbHVlO1xuICpcbiAqICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7IHJlc29sdmVkVmFsdWUgPSB2YWx1ZTsgfSk7XG4gKiAgICAgIGV4cGVjdChyZXNvbHZlZFZhbHVlKS50b0JlVW5kZWZpbmVkKCk7XG4gKlxuICogICAgICAvLyBTaW11bGF0ZSByZXNvbHZpbmcgb2YgcHJvbWlzZVxuICogICAgICBkZWZlcnJlZC5yZXNvbHZlKDEyMyk7XG4gKiAgICAgIC8vIE5vdGUgdGhhdCB0aGUgJ3RoZW4nIGZ1bmN0aW9uIGRvZXMgbm90IGdldCBjYWxsZWQgc3luY2hyb25vdXNseS5cbiAqICAgICAgLy8gVGhpcyBpcyBiZWNhdXNlIHdlIHdhbnQgdGhlIHByb21pc2UgQVBJIHRvIGFsd2F5cyBiZSBhc3luYywgd2hldGhlciBvciBub3RcbiAqICAgICAgLy8gaXQgZ290IGNhbGxlZCBzeW5jaHJvbm91c2x5IG9yIGFzeW5jaHJvbm91c2x5LlxuICogICAgICBleHBlY3QocmVzb2x2ZWRWYWx1ZSkudG9CZVVuZGVmaW5lZCgpO1xuICpcbiAqICAgICAgLy8gUHJvcGFnYXRlIHByb21pc2UgcmVzb2x1dGlvbiB0byAndGhlbicgZnVuY3Rpb25zIHVzaW5nICRhcHBseSgpLlxuICogICAgICAkcm9vdFNjb3BlLiRhcHBseSgpO1xuICogICAgICBleHBlY3QocmVzb2x2ZWRWYWx1ZSkudG9FcXVhbCgxMjMpO1xuICogICAgfSkpO1xuICogIGBgYFxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oZnVuY3Rpb24sIGZ1bmN0aW9uKX0gcmVzb2x2ZXIgRnVuY3Rpb24gd2hpY2ggaXMgcmVzcG9uc2libGUgZm9yIHJlc29sdmluZyBvclxuICogICByZWplY3RpbmcgdGhlIG5ld2x5IGNyZWF0ZWQgcHJvbWlzZS4gVGhlIGZpcnN0IHBhcmFtZXRlciBpcyBhIGZ1bmN0aW9uIHdoaWNoIHJlc29sdmVzIHRoZVxuICogICBwcm9taXNlLCB0aGUgc2Vjb25kIHBhcmFtZXRlciBpcyBhIGZ1bmN0aW9uIHdoaWNoIHJlamVjdHMgdGhlIHByb21pc2UuXG4gKlxuICogQHJldHVybnMge1Byb21pc2V9IFRoZSBuZXdseSBjcmVhdGVkIHByb21pc2UuXG4gKi9cbmZ1bmN0aW9uICRRUHJvdmlkZXIoKSB7XG5cbiAgdGhpcy4kZ2V0ID0gWyckcm9vdFNjb3BlJywgJyRleGNlcHRpb25IYW5kbGVyJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJGV4Y2VwdGlvbkhhbmRsZXIpIHtcbiAgICByZXR1cm4gcUZhY3RvcnkoZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgICRyb290U2NvcGUuJGV2YWxBc3luYyhjYWxsYmFjayk7XG4gICAgfSwgJGV4Y2VwdGlvbkhhbmRsZXIpO1xuICB9XTtcbn1cblxuZnVuY3Rpb24gJCRRUHJvdmlkZXIoKSB7XG4gIHRoaXMuJGdldCA9IFsnJGJyb3dzZXInLCAnJGV4Y2VwdGlvbkhhbmRsZXInLCBmdW5jdGlvbigkYnJvd3NlciwgJGV4Y2VwdGlvbkhhbmRsZXIpIHtcbiAgICByZXR1cm4gcUZhY3RvcnkoZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgICRicm93c2VyLmRlZmVyKGNhbGxiYWNrKTtcbiAgICB9LCAkZXhjZXB0aW9uSGFuZGxlcik7XG4gIH1dO1xufVxuXG4vKipcbiAqIENvbnN0cnVjdHMgYSBwcm9taXNlIG1hbmFnZXIuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbihmdW5jdGlvbil9IG5leHRUaWNrIEZ1bmN0aW9uIGZvciBleGVjdXRpbmcgZnVuY3Rpb25zIGluIHRoZSBuZXh0IHR1cm4uXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKC4uLiopfSBleGNlcHRpb25IYW5kbGVyIEZ1bmN0aW9uIGludG8gd2hpY2ggdW5leHBlY3RlZCBleGNlcHRpb25zIGFyZSBwYXNzZWQgZm9yXG4gKiAgICAgZGVidWdnaW5nIHB1cnBvc2VzLlxuICogQHJldHVybnMge29iamVjdH0gUHJvbWlzZSBtYW5hZ2VyLlxuICovXG5mdW5jdGlvbiBxRmFjdG9yeShuZXh0VGljaywgZXhjZXB0aW9uSGFuZGxlcikge1xuICB2YXIgJHFNaW5FcnIgPSBtaW5FcnIoJyRxJywgVHlwZUVycm9yKTtcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSBuZy4kcSNkZWZlclxuICAgKiBAa2luZCBmdW5jdGlvblxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogQ3JlYXRlcyBhIGBEZWZlcnJlZGAgb2JqZWN0IHdoaWNoIHJlcHJlc2VudHMgYSB0YXNrIHdoaWNoIHdpbGwgZmluaXNoIGluIHRoZSBmdXR1cmUuXG4gICAqXG4gICAqIEByZXR1cm5zIHtEZWZlcnJlZH0gUmV0dXJucyBhIG5ldyBpbnN0YW5jZSBvZiBkZWZlcnJlZC5cbiAgICovXG4gIHZhciBkZWZlciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBkID0gbmV3IERlZmVycmVkKCk7XG4gICAgLy9OZWNlc3NhcnkgdG8gc3VwcG9ydCB1bmJvdW5kIGV4ZWN1dGlvbiA6L1xuICAgIGQucmVzb2x2ZSA9IHNpbXBsZUJpbmQoZCwgZC5yZXNvbHZlKTtcbiAgICBkLnJlamVjdCA9IHNpbXBsZUJpbmQoZCwgZC5yZWplY3QpO1xuICAgIGQubm90aWZ5ID0gc2ltcGxlQmluZChkLCBkLm5vdGlmeSk7XG4gICAgcmV0dXJuIGQ7XG4gIH07XG5cbiAgZnVuY3Rpb24gUHJvbWlzZSgpIHtcbiAgICB0aGlzLiQkc3RhdGUgPSB7IHN0YXR1czogMCB9O1xuICB9XG5cbiAgZXh0ZW5kKFByb21pc2UucHJvdG90eXBlLCB7XG4gICAgdGhlbjogZnVuY3Rpb24ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQsIHByb2dyZXNzQmFjaykge1xuICAgICAgaWYgKGlzVW5kZWZpbmVkKG9uRnVsZmlsbGVkKSAmJiBpc1VuZGVmaW5lZChvblJlamVjdGVkKSAmJiBpc1VuZGVmaW5lZChwcm9ncmVzc0JhY2spKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgICAgdmFyIHJlc3VsdCA9IG5ldyBEZWZlcnJlZCgpO1xuXG4gICAgICB0aGlzLiQkc3RhdGUucGVuZGluZyA9IHRoaXMuJCRzdGF0ZS5wZW5kaW5nIHx8IFtdO1xuICAgICAgdGhpcy4kJHN0YXRlLnBlbmRpbmcucHVzaChbcmVzdWx0LCBvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCwgcHJvZ3Jlc3NCYWNrXSk7XG4gICAgICBpZiAodGhpcy4kJHN0YXRlLnN0YXR1cyA+IDApIHNjaGVkdWxlUHJvY2Vzc1F1ZXVlKHRoaXMuJCRzdGF0ZSk7XG5cbiAgICAgIHJldHVybiByZXN1bHQucHJvbWlzZTtcbiAgICB9LFxuXG4gICAgXCJjYXRjaFwiOiBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgcmV0dXJuIHRoaXMudGhlbihudWxsLCBjYWxsYmFjayk7XG4gICAgfSxcblxuICAgIFwiZmluYWxseVwiOiBmdW5jdGlvbihjYWxsYmFjaywgcHJvZ3Jlc3NCYWNrKSB7XG4gICAgICByZXR1cm4gdGhpcy50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBoYW5kbGVDYWxsYmFjayh2YWx1ZSwgdHJ1ZSwgY2FsbGJhY2spO1xuICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNhbGxiYWNrKGVycm9yLCBmYWxzZSwgY2FsbGJhY2spO1xuICAgICAgfSwgcHJvZ3Jlc3NCYWNrKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8vRmFzdGVyLCBtb3JlIGJhc2ljIHRoYW4gYW5ndWxhci5iaW5kIGh0dHA6Ly9qc3BlcmYuY29tL2FuZ3VsYXItYmluZC12cy1jdXN0b20tdnMtbmF0aXZlXG4gIGZ1bmN0aW9uIHNpbXBsZUJpbmQoY29udGV4dCwgZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIGZuLmNhbGwoY29udGV4dCwgdmFsdWUpO1xuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBwcm9jZXNzUXVldWUoc3RhdGUpIHtcbiAgICB2YXIgZm4sIGRlZmVycmVkLCBwZW5kaW5nO1xuXG4gICAgcGVuZGluZyA9IHN0YXRlLnBlbmRpbmc7XG4gICAgc3RhdGUucHJvY2Vzc1NjaGVkdWxlZCA9IGZhbHNlO1xuICAgIHN0YXRlLnBlbmRpbmcgPSB1bmRlZmluZWQ7XG4gICAgZm9yICh2YXIgaSA9IDAsIGlpID0gcGVuZGluZy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBkZWZlcnJlZCA9IHBlbmRpbmdbaV1bMF07XG4gICAgICBmbiA9IHBlbmRpbmdbaV1bc3RhdGUuc3RhdHVzXTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChpc0Z1bmN0aW9uKGZuKSkge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZm4oc3RhdGUudmFsdWUpKTtcbiAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5zdGF0dXMgPT09IDEpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHN0YXRlLnZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3Qoc3RhdGUudmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGRlZmVycmVkLnJlamVjdChlKTtcbiAgICAgICAgZXhjZXB0aW9uSGFuZGxlcihlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzY2hlZHVsZVByb2Nlc3NRdWV1ZShzdGF0ZSkge1xuICAgIGlmIChzdGF0ZS5wcm9jZXNzU2NoZWR1bGVkIHx8ICFzdGF0ZS5wZW5kaW5nKSByZXR1cm47XG4gICAgc3RhdGUucHJvY2Vzc1NjaGVkdWxlZCA9IHRydWU7XG4gICAgbmV4dFRpY2soZnVuY3Rpb24oKSB7IHByb2Nlc3NRdWV1ZShzdGF0ZSk7IH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gRGVmZXJyZWQoKSB7XG4gICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKTtcbiAgfVxuXG4gIGV4dGVuZChEZWZlcnJlZC5wcm90b3R5cGUsIHtcbiAgICByZXNvbHZlOiBmdW5jdGlvbih2YWwpIHtcbiAgICAgIGlmICh0aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXMpIHJldHVybjtcbiAgICAgIGlmICh2YWwgPT09IHRoaXMucHJvbWlzZSkge1xuICAgICAgICB0aGlzLiQkcmVqZWN0KCRxTWluRXJyKFxuICAgICAgICAgICdxY3ljbGUnLFxuICAgICAgICAgIFwiRXhwZWN0ZWQgcHJvbWlzZSB0byBiZSByZXNvbHZlZCB3aXRoIHZhbHVlIG90aGVyIHRoYW4gaXRzZWxmICd7MH0nXCIsXG4gICAgICAgICAgdmFsKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLiQkcmVzb2x2ZSh2YWwpO1xuICAgICAgfVxuXG4gICAgfSxcblxuICAgICQkcmVzb2x2ZTogZnVuY3Rpb24odmFsKSB7XG4gICAgICB2YXIgdGhlbjtcbiAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgIHZhciBkb25lID0gZmFsc2U7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoKGlzT2JqZWN0KHZhbCkgfHwgaXNGdW5jdGlvbih2YWwpKSkgdGhlbiA9IHZhbCAmJiB2YWwudGhlbjtcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24odGhlbikpIHtcbiAgICAgICAgICB0aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXMgPSAtMTtcbiAgICAgICAgICB0aGVuLmNhbGwodmFsLCByZXNvbHZlUHJvbWlzZSwgcmVqZWN0UHJvbWlzZSwgc2ltcGxlQmluZCh0aGlzLCB0aGlzLm5vdGlmeSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucHJvbWlzZS4kJHN0YXRlLnZhbHVlID0gdmFsO1xuICAgICAgICAgIHRoaXMucHJvbWlzZS4kJHN0YXRlLnN0YXR1cyA9IDE7XG4gICAgICAgICAgc2NoZWR1bGVQcm9jZXNzUXVldWUodGhpcy5wcm9taXNlLiQkc3RhdGUpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJlamVjdFByb21pc2UoZSk7XG4gICAgICAgIGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHJlc29sdmVQcm9taXNlKHZhbCkge1xuICAgICAgICBpZiAoZG9uZSkgcmV0dXJuO1xuICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgdGhhdC4kJHJlc29sdmUodmFsKTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHJlamVjdFByb21pc2UodmFsKSB7XG4gICAgICAgIGlmIChkb25lKSByZXR1cm47XG4gICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICB0aGF0LiQkcmVqZWN0KHZhbCk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlamVjdDogZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICBpZiAodGhpcy5wcm9taXNlLiQkc3RhdGUuc3RhdHVzKSByZXR1cm47XG4gICAgICB0aGlzLiQkcmVqZWN0KHJlYXNvbik7XG4gICAgfSxcblxuICAgICQkcmVqZWN0OiBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgIHRoaXMucHJvbWlzZS4kJHN0YXRlLnZhbHVlID0gcmVhc29uO1xuICAgICAgdGhpcy5wcm9taXNlLiQkc3RhdGUuc3RhdHVzID0gMjtcbiAgICAgIHNjaGVkdWxlUHJvY2Vzc1F1ZXVlKHRoaXMucHJvbWlzZS4kJHN0YXRlKTtcbiAgICB9LFxuXG4gICAgbm90aWZ5OiBmdW5jdGlvbihwcm9ncmVzcykge1xuICAgICAgdmFyIGNhbGxiYWNrcyA9IHRoaXMucHJvbWlzZS4kJHN0YXRlLnBlbmRpbmc7XG5cbiAgICAgIGlmICgodGhpcy5wcm9taXNlLiQkc3RhdGUuc3RhdHVzIDw9IDApICYmIGNhbGxiYWNrcyAmJiBjYWxsYmFja3MubGVuZ3RoKSB7XG4gICAgICAgIG5leHRUaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBjYWxsYmFjaywgcmVzdWx0O1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGNhbGxiYWNrcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBjYWxsYmFja3NbaV1bMF07XG4gICAgICAgICAgICBjYWxsYmFjayA9IGNhbGxiYWNrc1tpXVszXTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHJlc3VsdC5ub3RpZnkoaXNGdW5jdGlvbihjYWxsYmFjaykgPyBjYWxsYmFjayhwcm9ncmVzcykgOiBwcm9ncmVzcyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgIGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRxI3JlamVjdFxuICAgKiBAa2luZCBmdW5jdGlvblxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogQ3JlYXRlcyBhIHByb21pc2UgdGhhdCBpcyByZXNvbHZlZCBhcyByZWplY3RlZCB3aXRoIHRoZSBzcGVjaWZpZWQgYHJlYXNvbmAuIFRoaXMgYXBpIHNob3VsZCBiZVxuICAgKiB1c2VkIHRvIGZvcndhcmQgcmVqZWN0aW9uIGluIGEgY2hhaW4gb2YgcHJvbWlzZXMuIElmIHlvdSBhcmUgZGVhbGluZyB3aXRoIHRoZSBsYXN0IHByb21pc2UgaW5cbiAgICogYSBwcm9taXNlIGNoYWluLCB5b3UgZG9uJ3QgbmVlZCB0byB3b3JyeSBhYm91dCBpdC5cbiAgICpcbiAgICogV2hlbiBjb21wYXJpbmcgZGVmZXJyZWRzL3Byb21pc2VzIHRvIHRoZSBmYW1pbGlhciBiZWhhdmlvciBvZiB0cnkvY2F0Y2gvdGhyb3csIHRoaW5rIG9mXG4gICAqIGByZWplY3RgIGFzIHRoZSBgdGhyb3dgIGtleXdvcmQgaW4gSmF2YVNjcmlwdC4gVGhpcyBhbHNvIG1lYW5zIHRoYXQgaWYgeW91IFwiY2F0Y2hcIiBhbiBlcnJvciB2aWFcbiAgICogYSBwcm9taXNlIGVycm9yIGNhbGxiYWNrIGFuZCB5b3Ugd2FudCB0byBmb3J3YXJkIHRoZSBlcnJvciB0byB0aGUgcHJvbWlzZSBkZXJpdmVkIGZyb20gdGhlXG4gICAqIGN1cnJlbnQgcHJvbWlzZSwgeW91IGhhdmUgdG8gXCJyZXRocm93XCIgdGhlIGVycm9yIGJ5IHJldHVybmluZyBhIHJlamVjdGlvbiBjb25zdHJ1Y3RlZCB2aWFcbiAgICogYHJlamVjdGAuXG4gICAqXG4gICAqIGBgYGpzXG4gICAqICAgcHJvbWlzZUIgPSBwcm9taXNlQS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgKiAgICAgLy8gc3VjY2VzczogZG8gc29tZXRoaW5nIGFuZCByZXNvbHZlIHByb21pc2VCXG4gICAqICAgICAvLyAgICAgICAgICB3aXRoIHRoZSBvbGQgb3IgYSBuZXcgcmVzdWx0XG4gICAqICAgICByZXR1cm4gcmVzdWx0O1xuICAgKiAgIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgKiAgICAgLy8gZXJyb3I6IGhhbmRsZSB0aGUgZXJyb3IgaWYgcG9zc2libGUgYW5kXG4gICAqICAgICAvLyAgICAgICAgcmVzb2x2ZSBwcm9taXNlQiB3aXRoIG5ld1Byb21pc2VPclZhbHVlLFxuICAgKiAgICAgLy8gICAgICAgIG90aGVyd2lzZSBmb3J3YXJkIHRoZSByZWplY3Rpb24gdG8gcHJvbWlzZUJcbiAgICogICAgIGlmIChjYW5IYW5kbGUocmVhc29uKSkge1xuICAgKiAgICAgIC8vIGhhbmRsZSB0aGUgZXJyb3IgYW5kIHJlY292ZXJcbiAgICogICAgICByZXR1cm4gbmV3UHJvbWlzZU9yVmFsdWU7XG4gICAqICAgICB9XG4gICAqICAgICByZXR1cm4gJHEucmVqZWN0KHJlYXNvbik7XG4gICAqICAgfSk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0geyp9IHJlYXNvbiBDb25zdGFudCwgbWVzc2FnZSwgZXhjZXB0aW9uIG9yIGFuIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIHJlamVjdGlvbiByZWFzb24uXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdhcyBhbHJlYWR5IHJlc29sdmVkIGFzIHJlamVjdGVkIHdpdGggdGhlIGByZWFzb25gLlxuICAgKi9cbiAgdmFyIHJlamVjdCA9IGZ1bmN0aW9uKHJlYXNvbikge1xuICAgIHZhciByZXN1bHQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICByZXN1bHQucmVqZWN0KHJlYXNvbik7XG4gICAgcmV0dXJuIHJlc3VsdC5wcm9taXNlO1xuICB9O1xuXG4gIHZhciBtYWtlUHJvbWlzZSA9IGZ1bmN0aW9uIG1ha2VQcm9taXNlKHZhbHVlLCByZXNvbHZlZCkge1xuICAgIHZhciByZXN1bHQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICBpZiAocmVzb2x2ZWQpIHtcbiAgICAgIHJlc3VsdC5yZXNvbHZlKHZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0LnJlamVjdCh2YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQucHJvbWlzZTtcbiAgfTtcblxuICB2YXIgaGFuZGxlQ2FsbGJhY2sgPSBmdW5jdGlvbiBoYW5kbGVDYWxsYmFjayh2YWx1ZSwgaXNSZXNvbHZlZCwgY2FsbGJhY2spIHtcbiAgICB2YXIgY2FsbGJhY2tPdXRwdXQgPSBudWxsO1xuICAgIHRyeSB7XG4gICAgICBpZiAoaXNGdW5jdGlvbihjYWxsYmFjaykpIGNhbGxiYWNrT3V0cHV0ID0gY2FsbGJhY2soKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXR1cm4gbWFrZVByb21pc2UoZSwgZmFsc2UpO1xuICAgIH1cbiAgICBpZiAoaXNQcm9taXNlTGlrZShjYWxsYmFja091dHB1dCkpIHtcbiAgICAgIHJldHVybiBjYWxsYmFja091dHB1dC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbWFrZVByb21pc2UodmFsdWUsIGlzUmVzb2x2ZWQpO1xuICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG1ha2VQcm9taXNlKGVycm9yLCBmYWxzZSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG1ha2VQcm9taXNlKHZhbHVlLCBpc1Jlc29sdmVkKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJHEjd2hlblxuICAgKiBAa2luZCBmdW5jdGlvblxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogV3JhcHMgYW4gb2JqZWN0IHRoYXQgbWlnaHQgYmUgYSB2YWx1ZSBvciBhICgzcmQgcGFydHkpIHRoZW4tYWJsZSBwcm9taXNlIGludG8gYSAkcSBwcm9taXNlLlxuICAgKiBUaGlzIGlzIHVzZWZ1bCB3aGVuIHlvdSBhcmUgZGVhbGluZyB3aXRoIGFuIG9iamVjdCB0aGF0IG1pZ2h0IG9yIG1pZ2h0IG5vdCBiZSBhIHByb21pc2UsIG9yIGlmXG4gICAqIHRoZSBwcm9taXNlIGNvbWVzIGZyb20gYSBzb3VyY2UgdGhhdCBjYW4ndCBiZSB0cnVzdGVkLlxuICAgKlxuICAgKiBAcGFyYW0geyp9IHZhbHVlIFZhbHVlIG9yIGEgcHJvbWlzZVxuICAgKiBAcGFyYW0ge0Z1bmN0aW9uPX0gc3VjY2Vzc0NhbGxiYWNrXG4gICAqIEBwYXJhbSB7RnVuY3Rpb249fSBlcnJvckNhbGxiYWNrXG4gICAqIEBwYXJhbSB7RnVuY3Rpb249fSBwcm9ncmVzc0NhbGxiYWNrXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBSZXR1cm5zIGEgcHJvbWlzZSBvZiB0aGUgcGFzc2VkIHZhbHVlIG9yIHByb21pc2VcbiAgICovXG5cblxuICB2YXIgd2hlbiA9IGZ1bmN0aW9uKHZhbHVlLCBjYWxsYmFjaywgZXJyYmFjaywgcHJvZ3Jlc3NCYWNrKSB7XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgIHJlc3VsdC5yZXNvbHZlKHZhbHVlKTtcbiAgICByZXR1cm4gcmVzdWx0LnByb21pc2UudGhlbihjYWxsYmFjaywgZXJyYmFjaywgcHJvZ3Jlc3NCYWNrKTtcbiAgfTtcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkcSNyZXNvbHZlXG4gICAqIEBraW5kIGZ1bmN0aW9uXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBBbGlhcyBvZiB7QGxpbmsgbmcuJHEjd2hlbiB3aGVufSB0byBtYWludGFpbiBuYW1pbmcgY29uc2lzdGVuY3kgd2l0aCBFUzYuXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gdmFsdWUgVmFsdWUgb3IgYSBwcm9taXNlXG4gICAqIEBwYXJhbSB7RnVuY3Rpb249fSBzdWNjZXNzQ2FsbGJhY2tcbiAgICogQHBhcmFtIHtGdW5jdGlvbj19IGVycm9yQ2FsbGJhY2tcbiAgICogQHBhcmFtIHtGdW5jdGlvbj19IHByb2dyZXNzQ2FsbGJhY2tcbiAgICogQHJldHVybnMge1Byb21pc2V9IFJldHVybnMgYSBwcm9taXNlIG9mIHRoZSBwYXNzZWQgdmFsdWUgb3IgcHJvbWlzZVxuICAgKi9cbiAgdmFyIHJlc29sdmUgPSB3aGVuO1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRxI2FsbFxuICAgKiBAa2luZCBmdW5jdGlvblxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogQ29tYmluZXMgbXVsdGlwbGUgcHJvbWlzZXMgaW50byBhIHNpbmdsZSBwcm9taXNlIHRoYXQgaXMgcmVzb2x2ZWQgd2hlbiBhbGwgb2YgdGhlIGlucHV0XG4gICAqIHByb21pc2VzIGFyZSByZXNvbHZlZC5cbiAgICpcbiAgICogQHBhcmFtIHtBcnJheS48UHJvbWlzZT58T2JqZWN0LjxQcm9taXNlPn0gcHJvbWlzZXMgQW4gYXJyYXkgb3IgaGFzaCBvZiBwcm9taXNlcy5cbiAgICogQHJldHVybnMge1Byb21pc2V9IFJldHVybnMgYSBzaW5nbGUgcHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCBhbiBhcnJheS9oYXNoIG9mIHZhbHVlcyxcbiAgICogICBlYWNoIHZhbHVlIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHByb21pc2UgYXQgdGhlIHNhbWUgaW5kZXgva2V5IGluIHRoZSBgcHJvbWlzZXNgIGFycmF5L2hhc2guXG4gICAqICAgSWYgYW55IG9mIHRoZSBwcm9taXNlcyBpcyByZXNvbHZlZCB3aXRoIGEgcmVqZWN0aW9uLCB0aGlzIHJlc3VsdGluZyBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWRcbiAgICogICB3aXRoIHRoZSBzYW1lIHJlamVjdGlvbiB2YWx1ZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gYWxsKHByb21pc2VzKSB7XG4gICAgdmFyIGRlZmVycmVkID0gbmV3IERlZmVycmVkKCksXG4gICAgICAgIGNvdW50ZXIgPSAwLFxuICAgICAgICByZXN1bHRzID0gaXNBcnJheShwcm9taXNlcykgPyBbXSA6IHt9O1xuXG4gICAgZm9yRWFjaChwcm9taXNlcywgZnVuY3Rpb24ocHJvbWlzZSwga2V5KSB7XG4gICAgICBjb3VudGVyKys7XG4gICAgICB3aGVuKHByb21pc2UpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgaWYgKHJlc3VsdHMuaGFzT3duUHJvcGVydHkoa2V5KSkgcmV0dXJuO1xuICAgICAgICByZXN1bHRzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgaWYgKCEoLS1jb3VudGVyKSkgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHRzKTtcbiAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICBpZiAocmVzdWx0cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSByZXR1cm47XG4gICAgICAgIGRlZmVycmVkLnJlamVjdChyZWFzb24pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpZiAoY291bnRlciA9PT0gMCkge1xuICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgfVxuXG4gIHZhciAkUSA9IGZ1bmN0aW9uIFEocmVzb2x2ZXIpIHtcbiAgICBpZiAoIWlzRnVuY3Rpb24ocmVzb2x2ZXIpKSB7XG4gICAgICB0aHJvdyAkcU1pbkVycignbm9yc2x2cicsIFwiRXhwZWN0ZWQgcmVzb2x2ZXJGbiwgZ290ICd7MH0nXCIsIHJlc29sdmVyKTtcbiAgICB9XG5cbiAgICB2YXIgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcblxuICAgIGZ1bmN0aW9uIHJlc29sdmVGbih2YWx1ZSkge1xuICAgICAgZGVmZXJyZWQucmVzb2x2ZSh2YWx1ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVqZWN0Rm4ocmVhc29uKSB7XG4gICAgICBkZWZlcnJlZC5yZWplY3QocmVhc29uKTtcbiAgICB9XG5cbiAgICByZXNvbHZlcihyZXNvbHZlRm4sIHJlamVjdEZuKTtcblxuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICB9O1xuXG4gIC8vIExldCdzIG1ha2UgdGhlIGluc3RhbmNlb2Ygb3BlcmF0b3Igd29yayBmb3IgcHJvbWlzZXMsIHNvIHRoYXRcbiAgLy8gYG5ldyAkcShmbikgaW5zdGFuY2VvZiAkcWAgd291bGQgZXZhbHVhdGUgdG8gdHJ1ZS5cbiAgJFEucHJvdG90eXBlID0gUHJvbWlzZS5wcm90b3R5cGU7XG5cbiAgJFEuZGVmZXIgPSBkZWZlcjtcbiAgJFEucmVqZWN0ID0gcmVqZWN0O1xuICAkUS53aGVuID0gd2hlbjtcbiAgJFEucmVzb2x2ZSA9IHJlc29sdmU7XG4gICRRLmFsbCA9IGFsbDtcblxuICByZXR1cm4gJFE7XG59XG5cbmZ1bmN0aW9uICQkUkFGUHJvdmlkZXIoKSB7IC8vckFGXG4gIHRoaXMuJGdldCA9IFsnJHdpbmRvdycsICckdGltZW91dCcsIGZ1bmN0aW9uKCR3aW5kb3csICR0aW1lb3V0KSB7XG4gICAgdmFyIHJlcXVlc3RBbmltYXRpb25GcmFtZSA9ICR3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xuXG4gICAgdmFyIGNhbmNlbEFuaW1hdGlvbkZyYW1lID0gJHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR3aW5kb3cud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWUgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkd2luZG93LndlYmtpdENhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZTtcblxuICAgIHZhciByYWZTdXBwb3J0ZWQgPSAhIXJlcXVlc3RBbmltYXRpb25GcmFtZTtcbiAgICB2YXIgcmFmID0gcmFmU3VwcG9ydGVkXG4gICAgICA/IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgdmFyIGlkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZuKTtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShpZCk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgOiBmdW5jdGlvbihmbikge1xuICAgICAgICAgIHZhciB0aW1lciA9ICR0aW1lb3V0KGZuLCAxNi42NiwgZmFsc2UpOyAvLyAxMDAwIC8gNjAgPSAxNi42NjZcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xuICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICByYWYuc3VwcG9ydGVkID0gcmFmU3VwcG9ydGVkO1xuXG4gICAgcmV0dXJuIHJhZjtcbiAgfV07XG59XG5cbi8qKlxuICogREVTSUdOIE5PVEVTXG4gKlxuICogVGhlIGRlc2lnbiBkZWNpc2lvbnMgYmVoaW5kIHRoZSBzY29wZSBhcmUgaGVhdmlseSBmYXZvcmVkIGZvciBzcGVlZCBhbmQgbWVtb3J5IGNvbnN1bXB0aW9uLlxuICpcbiAqIFRoZSB0eXBpY2FsIHVzZSBvZiBzY29wZSBpcyB0byB3YXRjaCB0aGUgZXhwcmVzc2lvbnMsIHdoaWNoIG1vc3Qgb2YgdGhlIHRpbWUgcmV0dXJuIHRoZSBzYW1lXG4gKiB2YWx1ZSBhcyBsYXN0IHRpbWUgc28gd2Ugb3B0aW1pemUgdGhlIG9wZXJhdGlvbi5cbiAqXG4gKiBDbG9zdXJlcyBjb25zdHJ1Y3Rpb24gaXMgZXhwZW5zaXZlIGluIHRlcm1zIG9mIHNwZWVkIGFzIHdlbGwgYXMgbWVtb3J5OlxuICogICAtIE5vIGNsb3N1cmVzLCBpbnN0ZWFkIHVzZSBwcm90b3R5cGljYWwgaW5oZXJpdGFuY2UgZm9yIEFQSVxuICogICAtIEludGVybmFsIHN0YXRlIG5lZWRzIHRvIGJlIHN0b3JlZCBvbiBzY29wZSBkaXJlY3RseSwgd2hpY2ggbWVhbnMgdGhhdCBwcml2YXRlIHN0YXRlIGlzXG4gKiAgICAgZXhwb3NlZCBhcyAkJF9fX18gcHJvcGVydGllc1xuICpcbiAqIExvb3Agb3BlcmF0aW9ucyBhcmUgb3B0aW1pemVkIGJ5IHVzaW5nIHdoaWxlKGNvdW50LS0pIHsgLi4uIH1cbiAqICAgLSBUaGlzIG1lYW5zIHRoYXQgaW4gb3JkZXIgdG8ga2VlcCB0aGUgc2FtZSBvcmRlciBvZiBleGVjdXRpb24gYXMgYWRkaXRpb24gd2UgaGF2ZSB0byBhZGRcbiAqICAgICBpdGVtcyB0byB0aGUgYXJyYXkgYXQgdGhlIGJlZ2lubmluZyAodW5zaGlmdCkgaW5zdGVhZCBvZiBhdCB0aGUgZW5kIChwdXNoKVxuICpcbiAqIENoaWxkIHNjb3BlcyBhcmUgY3JlYXRlZCBhbmQgcmVtb3ZlZCBvZnRlblxuICogICAtIFVzaW5nIGFuIGFycmF5IHdvdWxkIGJlIHNsb3cgc2luY2UgaW5zZXJ0cyBpbiB0aGUgbWlkZGxlIGFyZSBleHBlbnNpdmU7IHNvIHdlIHVzZSBsaW5rZWQgbGlzdHNcbiAqXG4gKiBUaGVyZSBhcmUgZmV3ZXIgd2F0Y2hlcyB0aGFuIG9ic2VydmVycy4gVGhpcyBpcyB3aHkgeW91IGRvbid0IHdhbnQgdGhlIG9ic2VydmVyIHRvIGJlIGltcGxlbWVudGVkXG4gKiBpbiB0aGUgc2FtZSB3YXkgYXMgd2F0Y2guIFdhdGNoIHJlcXVpcmVzIHJldHVybiBvZiB0aGUgaW5pdGlhbGl6YXRpb24gZnVuY3Rpb24gd2hpY2ggaXMgZXhwZW5zaXZlXG4gKiB0byBjb25zdHJ1Y3QuXG4gKi9cblxuXG4vKipcbiAqIEBuZ2RvYyBwcm92aWRlclxuICogQG5hbWUgJHJvb3RTY29wZVByb3ZpZGVyXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBQcm92aWRlciBmb3IgdGhlICRyb290U2NvcGUgc2VydmljZS5cbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBtZXRob2RcbiAqIEBuYW1lICRyb290U2NvcGVQcm92aWRlciNkaWdlc3RUdGxcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIFNldHMgdGhlIG51bWJlciBvZiBgJGRpZ2VzdGAgaXRlcmF0aW9ucyB0aGUgc2NvcGUgc2hvdWxkIGF0dGVtcHQgdG8gZXhlY3V0ZSBiZWZvcmUgZ2l2aW5nIHVwIGFuZFxuICogYXNzdW1pbmcgdGhhdCB0aGUgbW9kZWwgaXMgdW5zdGFibGUuXG4gKlxuICogVGhlIGN1cnJlbnQgZGVmYXVsdCBpcyAxMCBpdGVyYXRpb25zLlxuICpcbiAqIEluIGNvbXBsZXggYXBwbGljYXRpb25zIGl0J3MgcG9zc2libGUgdGhhdCB0aGUgZGVwZW5kZW5jaWVzIGJldHdlZW4gYCR3YXRjaGBzIHdpbGwgcmVzdWx0IGluXG4gKiBzZXZlcmFsIGRpZ2VzdCBpdGVyYXRpb25zLiBIb3dldmVyIGlmIGFuIGFwcGxpY2F0aW9uIG5lZWRzIG1vcmUgdGhhbiB0aGUgZGVmYXVsdCAxMCBkaWdlc3RcbiAqIGl0ZXJhdGlvbnMgZm9yIGl0cyBtb2RlbCB0byBzdGFiaWxpemUgdGhlbiB5b3Ugc2hvdWxkIGludmVzdGlnYXRlIHdoYXQgaXMgY2F1c2luZyB0aGUgbW9kZWwgdG9cbiAqIGNvbnRpbnVvdXNseSBjaGFuZ2UgZHVyaW5nIHRoZSBkaWdlc3QuXG4gKlxuICogSW5jcmVhc2luZyB0aGUgVFRMIGNvdWxkIGhhdmUgcGVyZm9ybWFuY2UgaW1wbGljYXRpb25zLCBzbyB5b3Ugc2hvdWxkIG5vdCBjaGFuZ2UgaXQgd2l0aG91dFxuICogcHJvcGVyIGp1c3RpZmljYXRpb24uXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IGxpbWl0IFRoZSBudW1iZXIgb2YgZGlnZXN0IGl0ZXJhdGlvbnMuXG4gKi9cblxuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkcm9vdFNjb3BlXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBFdmVyeSBhcHBsaWNhdGlvbiBoYXMgYSBzaW5nbGUgcm9vdCB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSBzY29wZX0uXG4gKiBBbGwgb3RoZXIgc2NvcGVzIGFyZSBkZXNjZW5kYW50IHNjb3BlcyBvZiB0aGUgcm9vdCBzY29wZS4gU2NvcGVzIHByb3ZpZGUgc2VwYXJhdGlvblxuICogYmV0d2VlbiB0aGUgbW9kZWwgYW5kIHRoZSB2aWV3LCB2aWEgYSBtZWNoYW5pc20gZm9yIHdhdGNoaW5nIHRoZSBtb2RlbCBmb3IgY2hhbmdlcy5cbiAqIFRoZXkgYWxzbyBwcm92aWRlIGV2ZW50IGVtaXNzaW9uL2Jyb2FkY2FzdCBhbmQgc3Vic2NyaXB0aW9uIGZhY2lsaXR5LiBTZWUgdGhlXG4gKiB7QGxpbmsgZ3VpZGUvc2NvcGUgZGV2ZWxvcGVyIGd1aWRlIG9uIHNjb3Blc30uXG4gKi9cbmZ1bmN0aW9uICRSb290U2NvcGVQcm92aWRlcigpIHtcbiAgdmFyIFRUTCA9IDEwO1xuICB2YXIgJHJvb3RTY29wZU1pbkVyciA9IG1pbkVycignJHJvb3RTY29wZScpO1xuICB2YXIgbGFzdERpcnR5V2F0Y2ggPSBudWxsO1xuICB2YXIgYXBwbHlBc3luY0lkID0gbnVsbDtcblxuICB0aGlzLmRpZ2VzdFR0bCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgIFRUTCA9IHZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gVFRMO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGNyZWF0ZUNoaWxkU2NvcGVDbGFzcyhwYXJlbnQpIHtcbiAgICBmdW5jdGlvbiBDaGlsZFNjb3BlKCkge1xuICAgICAgdGhpcy4kJHdhdGNoZXJzID0gdGhpcy4kJG5leHRTaWJsaW5nID1cbiAgICAgICAgICB0aGlzLiQkY2hpbGRIZWFkID0gdGhpcy4kJGNoaWxkVGFpbCA9IG51bGw7XG4gICAgICB0aGlzLiQkbGlzdGVuZXJzID0ge307XG4gICAgICB0aGlzLiQkbGlzdGVuZXJDb3VudCA9IHt9O1xuICAgICAgdGhpcy4kJHdhdGNoZXJzQ291bnQgPSAwO1xuICAgICAgdGhpcy4kaWQgPSBuZXh0VWlkKCk7XG4gICAgICB0aGlzLiQkQ2hpbGRTY29wZSA9IG51bGw7XG4gICAgfVxuICAgIENoaWxkU2NvcGUucHJvdG90eXBlID0gcGFyZW50O1xuICAgIHJldHVybiBDaGlsZFNjb3BlO1xuICB9XG5cbiAgdGhpcy4kZ2V0ID0gWyckZXhjZXB0aW9uSGFuZGxlcicsICckcGFyc2UnLCAnJGJyb3dzZXInLFxuICAgICAgZnVuY3Rpb24oJGV4Y2VwdGlvbkhhbmRsZXIsICRwYXJzZSwgJGJyb3dzZXIpIHtcblxuICAgIGZ1bmN0aW9uIGRlc3Ryb3lDaGlsZFNjb3BlKCRldmVudCkge1xuICAgICAgICAkZXZlbnQuY3VycmVudFNjb3BlLiQkZGVzdHJveWVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjbGVhblVwU2NvcGUoJHNjb3BlKSB7XG5cbiAgICAgIGlmIChtc2llID09PSA5KSB7XG4gICAgICAgIC8vIFRoZXJlIGlzIGEgbWVtb3J5IGxlYWsgaW4gSUU5IGlmIGFsbCBjaGlsZCBzY29wZXMgYXJlIG5vdCBkaXNjb25uZWN0ZWRcbiAgICAgICAgLy8gY29tcGxldGVseSB3aGVuIGEgc2NvcGUgaXMgZGVzdHJveWVkLiBTbyB0aGlzIGNvZGUgd2lsbCByZWN1cnNlIHVwIHRocm91Z2hcbiAgICAgICAgLy8gYWxsIHRoaXMgc2NvcGVzIGNoaWxkcmVuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIFNlZSBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL2lzc3Vlcy8xMDcwNlxuICAgICAgICAkc2NvcGUuJCRjaGlsZEhlYWQgJiYgY2xlYW5VcFNjb3BlKCRzY29wZS4kJGNoaWxkSGVhZCk7XG4gICAgICAgICRzY29wZS4kJG5leHRTaWJsaW5nICYmIGNsZWFuVXBTY29wZSgkc2NvcGUuJCRuZXh0U2libGluZyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFRoZSBjb2RlIGJlbG93IHdvcmtzIGFyb3VuZCBJRTkgYW5kIFY4J3MgbWVtb3J5IGxlYWtzXG4gICAgICAvL1xuICAgICAgLy8gU2VlOlxuICAgICAgLy8gLSBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9MjA3MyNjMjZcbiAgICAgIC8vIC0gaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy9pc3N1ZXMvNjc5NCNpc3N1ZWNvbW1lbnQtMzg2NDg5MDlcbiAgICAgIC8vIC0gaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy9pc3N1ZXMvMTMxMyNpc3N1ZWNvbW1lbnQtMTAzNzg0NTFcblxuICAgICAgJHNjb3BlLiRwYXJlbnQgPSAkc2NvcGUuJCRuZXh0U2libGluZyA9ICRzY29wZS4kJHByZXZTaWJsaW5nID0gJHNjb3BlLiQkY2hpbGRIZWFkID1cbiAgICAgICAgICAkc2NvcGUuJCRjaGlsZFRhaWwgPSAkc2NvcGUuJHJvb3QgPSAkc2NvcGUuJCR3YXRjaGVycyA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQG5nZG9jIHR5cGVcbiAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBBIHJvb3Qgc2NvcGUgY2FuIGJlIHJldHJpZXZlZCB1c2luZyB0aGUge0BsaW5rIG5nLiRyb290U2NvcGUgJHJvb3RTY29wZX0ga2V5IGZyb20gdGhlXG4gICAgICoge0BsaW5rIGF1dG8uJGluamVjdG9yICRpbmplY3Rvcn0uIENoaWxkIHNjb3BlcyBhcmUgY3JlYXRlZCB1c2luZyB0aGVcbiAgICAgKiB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkbmV3ICRuZXcoKX0gbWV0aG9kLiAoTW9zdCBzY29wZXMgYXJlIGNyZWF0ZWQgYXV0b21hdGljYWxseSB3aGVuXG4gICAgICogY29tcGlsZWQgSFRNTCB0ZW1wbGF0ZSBpcyBleGVjdXRlZC4pIFNlZSBhbHNvIHRoZSB7QGxpbmsgZ3VpZGUvc2NvcGUgU2NvcGVzIGd1aWRlfSBmb3JcbiAgICAgKiBhbiBpbi1kZXB0aCBpbnRyb2R1Y3Rpb24gYW5kIHVzYWdlIGV4YW1wbGVzLlxuICAgICAqXG4gICAgICpcbiAgICAgKiAjIEluaGVyaXRhbmNlXG4gICAgICogQSBzY29wZSBjYW4gaW5oZXJpdCBmcm9tIGEgcGFyZW50IHNjb3BlLCBhcyBpbiB0aGlzIGV4YW1wbGU6XG4gICAgICogYGBganNcbiAgICAgICAgIHZhciBwYXJlbnQgPSAkcm9vdFNjb3BlO1xuICAgICAgICAgdmFyIGNoaWxkID0gcGFyZW50LiRuZXcoKTtcblxuICAgICAgICAgcGFyZW50LnNhbHV0YXRpb24gPSBcIkhlbGxvXCI7XG4gICAgICAgICBleHBlY3QoY2hpbGQuc2FsdXRhdGlvbikudG9FcXVhbCgnSGVsbG8nKTtcblxuICAgICAgICAgY2hpbGQuc2FsdXRhdGlvbiA9IFwiV2VsY29tZVwiO1xuICAgICAgICAgZXhwZWN0KGNoaWxkLnNhbHV0YXRpb24pLnRvRXF1YWwoJ1dlbGNvbWUnKTtcbiAgICAgICAgIGV4cGVjdChwYXJlbnQuc2FsdXRhdGlvbikudG9FcXVhbCgnSGVsbG8nKTtcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIFdoZW4gaW50ZXJhY3Rpbmcgd2l0aCBgU2NvcGVgIGluIHRlc3RzLCBhZGRpdGlvbmFsIGhlbHBlciBtZXRob2RzIGFyZSBhdmFpbGFibGUgb24gdGhlXG4gICAgICogaW5zdGFuY2VzIG9mIGBTY29wZWAgdHlwZS4gU2VlIHtAbGluayBuZ01vY2suJHJvb3RTY29wZS5TY29wZSBuZ01vY2sgU2NvcGV9IGZvciBhZGRpdGlvbmFsXG4gICAgICogZGV0YWlscy5cbiAgICAgKlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3QuPHN0cmluZywgZnVuY3Rpb24oKT49fSBwcm92aWRlcnMgTWFwIG9mIHNlcnZpY2UgZmFjdG9yeSB3aGljaCBuZWVkIHRvIGJlXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZCBmb3IgdGhlIGN1cnJlbnQgc2NvcGUuIERlZmF1bHRzIHRvIHtAbGluayBuZ30uXG4gICAgICogQHBhcmFtIHtPYmplY3QuPHN0cmluZywgKj49fSBpbnN0YW5jZUNhY2hlIFByb3ZpZGVzIHByZS1pbnN0YW50aWF0ZWQgc2VydmljZXMgd2hpY2ggc2hvdWxkXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmQvb3ZlcnJpZGUgc2VydmljZXMgcHJvdmlkZWQgYnkgYHByb3ZpZGVyc2AuIFRoaXMgaXMgaGFuZHlcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gdW5pdC10ZXN0aW5nIGFuZCBoYXZpbmcgdGhlIG5lZWQgdG8gb3ZlcnJpZGUgYSBkZWZhdWx0XG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IE5ld2x5IGNyZWF0ZWQgc2NvcGUuXG4gICAgICpcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTY29wZSgpIHtcbiAgICAgIHRoaXMuJGlkID0gbmV4dFVpZCgpO1xuICAgICAgdGhpcy4kJHBoYXNlID0gdGhpcy4kcGFyZW50ID0gdGhpcy4kJHdhdGNoZXJzID1cbiAgICAgICAgICAgICAgICAgICAgIHRoaXMuJCRuZXh0U2libGluZyA9IHRoaXMuJCRwcmV2U2libGluZyA9XG4gICAgICAgICAgICAgICAgICAgICB0aGlzLiQkY2hpbGRIZWFkID0gdGhpcy4kJGNoaWxkVGFpbCA9IG51bGw7XG4gICAgICB0aGlzLiRyb290ID0gdGhpcztcbiAgICAgIHRoaXMuJCRkZXN0cm95ZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuJCRsaXN0ZW5lcnMgPSB7fTtcbiAgICAgIHRoaXMuJCRsaXN0ZW5lckNvdW50ID0ge307XG4gICAgICB0aGlzLiQkd2F0Y2hlcnNDb3VudCA9IDA7XG4gICAgICB0aGlzLiQkaXNvbGF0ZUJpbmRpbmdzID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgcHJvcGVydHlcbiAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRpZFxuICAgICAqXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICogVW5pcXVlIHNjb3BlIElEIChtb25vdG9uaWNhbGx5IGluY3JlYXNpbmcpIHVzZWZ1bCBmb3IgZGVidWdnaW5nLlxuICAgICAqL1xuXG4gICAgIC8qKlxuICAgICAgKiBAbmdkb2MgcHJvcGVydHlcbiAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkcGFyZW50XG4gICAgICAqXG4gICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgKiBSZWZlcmVuY2UgdG8gdGhlIHBhcmVudCBzY29wZS5cbiAgICAgICovXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIHByb3BlcnR5XG4gICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRyb290XG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBSZWZlcmVuY2UgdG8gdGhlIHJvb3Qgc2NvcGUuXG4gICAgICAgKi9cblxuICAgIFNjb3BlLnByb3RvdHlwZSA9IHtcbiAgICAgIGNvbnN0cnVjdG9yOiBTY29wZSxcbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkbmV3XG4gICAgICAgKiBAa2luZCBmdW5jdGlvblxuICAgICAgICpcbiAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICogQ3JlYXRlcyBhIG5ldyBjaGlsZCB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSBzY29wZX0uXG4gICAgICAgKlxuICAgICAgICogVGhlIHBhcmVudCBzY29wZSB3aWxsIHByb3BhZ2F0ZSB0aGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGRpZ2VzdCAkZGlnZXN0KCl9IGV2ZW50LlxuICAgICAgICogVGhlIHNjb3BlIGNhbiBiZSByZW1vdmVkIGZyb20gdGhlIHNjb3BlIGhpZXJhcmNoeSB1c2luZyB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGVzdHJveSAkZGVzdHJveSgpfS5cbiAgICAgICAqXG4gICAgICAgKiB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGVzdHJveSAkZGVzdHJveSgpfSBtdXN0IGJlIGNhbGxlZCBvbiBhIHNjb3BlIHdoZW4gaXQgaXNcbiAgICAgICAqIGRlc2lyZWQgZm9yIHRoZSBzY29wZSBhbmQgaXRzIGNoaWxkIHNjb3BlcyB0byBiZSBwZXJtYW5lbnRseSBkZXRhY2hlZCBmcm9tIHRoZSBwYXJlbnQgYW5kXG4gICAgICAgKiB0aHVzIHN0b3AgcGFydGljaXBhdGluZyBpbiBtb2RlbCBjaGFuZ2UgZGV0ZWN0aW9uIGFuZCBsaXN0ZW5lciBub3RpZmljYXRpb24gYnkgaW52b2tpbmcuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtib29sZWFufSBpc29sYXRlIElmIHRydWUsIHRoZW4gdGhlIHNjb3BlIGRvZXMgbm90IHByb3RvdHlwaWNhbGx5IGluaGVyaXQgZnJvbSB0aGVcbiAgICAgICAqICAgICAgICAgcGFyZW50IHNjb3BlLiBUaGUgc2NvcGUgaXMgaXNvbGF0ZWQsIGFzIGl0IGNhbiBub3Qgc2VlIHBhcmVudCBzY29wZSBwcm9wZXJ0aWVzLlxuICAgICAgICogICAgICAgICBXaGVuIGNyZWF0aW5nIHdpZGdldHMsIGl0IGlzIHVzZWZ1bCBmb3IgdGhlIHdpZGdldCB0byBub3QgYWNjaWRlbnRhbGx5IHJlYWQgcGFyZW50XG4gICAgICAgKiAgICAgICAgIHN0YXRlLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7U2NvcGV9IFtwYXJlbnQ9dGhpc10gVGhlIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIGBTY29wZWB9IHRoYXQgd2lsbCBiZSB0aGUgYCRwYXJlbnRgXG4gICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mIHRoZSBuZXdseSBjcmVhdGVkIHNjb3BlLiBEZWZhdWx0cyB0byBgdGhpc2Agc2NvcGUgaWYgbm90IHByb3ZpZGVkLlxuICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaGlzIGlzIHVzZWQgd2hlbiBjcmVhdGluZyBhIHRyYW5zY2x1ZGUgc2NvcGUgdG8gY29ycmVjdGx5IHBsYWNlIGl0XG4gICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIHRoZSBzY29wZSBoaWVyYXJjaHkgd2hpbGUgbWFpbnRhaW5pbmcgdGhlIGNvcnJlY3QgcHJvdG90eXBpY2FsXG4gICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaGVyaXRhbmNlLlxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBuZXdseSBjcmVhdGVkIGNoaWxkIHNjb3BlLlxuICAgICAgICpcbiAgICAgICAqL1xuICAgICAgJG5ldzogZnVuY3Rpb24oaXNvbGF0ZSwgcGFyZW50KSB7XG4gICAgICAgIHZhciBjaGlsZDtcblxuICAgICAgICBwYXJlbnQgPSBwYXJlbnQgfHwgdGhpcztcblxuICAgICAgICBpZiAoaXNvbGF0ZSkge1xuICAgICAgICAgIGNoaWxkID0gbmV3IFNjb3BlKCk7XG4gICAgICAgICAgY2hpbGQuJHJvb3QgPSB0aGlzLiRyb290O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIE9ubHkgY3JlYXRlIGEgY2hpbGQgc2NvcGUgY2xhc3MgaWYgc29tZWJvZHkgYXNrcyBmb3Igb25lLFxuICAgICAgICAgIC8vIGJ1dCBjYWNoZSBpdCB0byBhbGxvdyB0aGUgVk0gdG8gb3B0aW1pemUgbG9va3Vwcy5cbiAgICAgICAgICBpZiAoIXRoaXMuJCRDaGlsZFNjb3BlKSB7XG4gICAgICAgICAgICB0aGlzLiQkQ2hpbGRTY29wZSA9IGNyZWF0ZUNoaWxkU2NvcGVDbGFzcyh0aGlzKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2hpbGQgPSBuZXcgdGhpcy4kJENoaWxkU2NvcGUoKTtcbiAgICAgICAgfVxuICAgICAgICBjaGlsZC4kcGFyZW50ID0gcGFyZW50O1xuICAgICAgICBjaGlsZC4kJHByZXZTaWJsaW5nID0gcGFyZW50LiQkY2hpbGRUYWlsO1xuICAgICAgICBpZiAocGFyZW50LiQkY2hpbGRIZWFkKSB7XG4gICAgICAgICAgcGFyZW50LiQkY2hpbGRUYWlsLiQkbmV4dFNpYmxpbmcgPSBjaGlsZDtcbiAgICAgICAgICBwYXJlbnQuJCRjaGlsZFRhaWwgPSBjaGlsZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwYXJlbnQuJCRjaGlsZEhlYWQgPSBwYXJlbnQuJCRjaGlsZFRhaWwgPSBjaGlsZDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFdoZW4gdGhlIG5ldyBzY29wZSBpcyBub3QgaXNvbGF0ZWQgb3Igd2UgaW5oZXJpdCBmcm9tIGB0aGlzYCwgYW5kXG4gICAgICAgIC8vIHRoZSBwYXJlbnQgc2NvcGUgaXMgZGVzdHJveWVkLCB0aGUgcHJvcGVydHkgYCQkZGVzdHJveWVkYCBpcyBpbmhlcml0ZWRcbiAgICAgICAgLy8gcHJvdG90eXBpY2FsbHkuIEluIGFsbCBvdGhlciBjYXNlcywgdGhpcyBwcm9wZXJ0eSBuZWVkcyB0byBiZSBzZXRcbiAgICAgICAgLy8gd2hlbiB0aGUgcGFyZW50IHNjb3BlIGlzIGRlc3Ryb3llZC5cbiAgICAgICAgLy8gVGhlIGxpc3RlbmVyIG5lZWRzIHRvIGJlIGFkZGVkIGFmdGVyIHRoZSBwYXJlbnQgaXMgc2V0XG4gICAgICAgIGlmIChpc29sYXRlIHx8IHBhcmVudCAhPSB0aGlzKSBjaGlsZC4kb24oJyRkZXN0cm95JywgZGVzdHJveUNoaWxkU2NvcGUpO1xuXG4gICAgICAgIHJldHVybiBjaGlsZDtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkd2F0Y2hcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBSZWdpc3RlcnMgYSBgbGlzdGVuZXJgIGNhbGxiYWNrIHRvIGJlIGV4ZWN1dGVkIHdoZW5ldmVyIHRoZSBgd2F0Y2hFeHByZXNzaW9uYCBjaGFuZ2VzLlxuICAgICAgICpcbiAgICAgICAqIC0gVGhlIGB3YXRjaEV4cHJlc3Npb25gIGlzIGNhbGxlZCBvbiBldmVyeSBjYWxsIHRvIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRkaWdlc3RcbiAgICAgICAqICAgJGRpZ2VzdCgpfSBhbmQgc2hvdWxkIHJldHVybiB0aGUgdmFsdWUgdGhhdCB3aWxsIGJlIHdhdGNoZWQuIChgd2F0Y2hFeHByZXNzaW9uYCBzaG91bGQgbm90IGNoYW5nZVxuICAgICAgICogICBpdHMgdmFsdWUgd2hlbiBleGVjdXRlZCBtdWx0aXBsZSB0aW1lcyB3aXRoIHRoZSBzYW1lIGlucHV0IGJlY2F1c2UgaXQgbWF5IGJlIGV4ZWN1dGVkIG11bHRpcGxlXG4gICAgICAgKiAgIHRpbWVzIGJ5IHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRkaWdlc3QgJGRpZ2VzdCgpfS4gVGhhdCBpcywgYHdhdGNoRXhwcmVzc2lvbmAgc2hvdWxkIGJlXG4gICAgICAgKiAgIFtpZGVtcG90ZW50XShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0lkZW1wb3RlbmNlKS5cbiAgICAgICAqIC0gVGhlIGBsaXN0ZW5lcmAgaXMgY2FsbGVkIG9ubHkgd2hlbiB0aGUgdmFsdWUgZnJvbSB0aGUgY3VycmVudCBgd2F0Y2hFeHByZXNzaW9uYCBhbmQgdGhlXG4gICAgICAgKiAgIHByZXZpb3VzIGNhbGwgdG8gYHdhdGNoRXhwcmVzc2lvbmAgYXJlIG5vdCBlcXVhbCAod2l0aCB0aGUgZXhjZXB0aW9uIG9mIHRoZSBpbml0aWFsIHJ1bixcbiAgICAgICAqICAgc2VlIGJlbG93KS4gSW5lcXVhbGl0eSBpcyBkZXRlcm1pbmVkIGFjY29yZGluZyB0byByZWZlcmVuY2UgaW5lcXVhbGl0eSxcbiAgICAgICAqICAgW3N0cmljdCBjb21wYXJpc29uXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9PcGVyYXRvcnMvQ29tcGFyaXNvbl9PcGVyYXRvcnMpXG4gICAgICAgKiAgICB2aWEgdGhlIGAhPT1gIEphdmFzY3JpcHQgb3BlcmF0b3IsIHVubGVzcyBgb2JqZWN0RXF1YWxpdHkgPT0gdHJ1ZWBcbiAgICAgICAqICAgKHNlZSBuZXh0IHBvaW50KVxuICAgICAgICogLSBXaGVuIGBvYmplY3RFcXVhbGl0eSA9PSB0cnVlYCwgaW5lcXVhbGl0eSBvZiB0aGUgYHdhdGNoRXhwcmVzc2lvbmAgaXMgZGV0ZXJtaW5lZFxuICAgICAgICogICBhY2NvcmRpbmcgdG8gdGhlIHtAbGluayBhbmd1bGFyLmVxdWFsc30gZnVuY3Rpb24uIFRvIHNhdmUgdGhlIHZhbHVlIG9mIHRoZSBvYmplY3QgZm9yXG4gICAgICAgKiAgIGxhdGVyIGNvbXBhcmlzb24sIHRoZSB7QGxpbmsgYW5ndWxhci5jb3B5fSBmdW5jdGlvbiBpcyB1c2VkLiBUaGlzIHRoZXJlZm9yZSBtZWFucyB0aGF0XG4gICAgICAgKiAgIHdhdGNoaW5nIGNvbXBsZXggb2JqZWN0cyB3aWxsIGhhdmUgYWR2ZXJzZSBtZW1vcnkgYW5kIHBlcmZvcm1hbmNlIGltcGxpY2F0aW9ucy5cbiAgICAgICAqIC0gVGhlIHdhdGNoIGBsaXN0ZW5lcmAgbWF5IGNoYW5nZSB0aGUgbW9kZWwsIHdoaWNoIG1heSB0cmlnZ2VyIG90aGVyIGBsaXN0ZW5lcmBzIHRvIGZpcmUuXG4gICAgICAgKiAgIFRoaXMgaXMgYWNoaWV2ZWQgYnkgcmVydW5uaW5nIHRoZSB3YXRjaGVycyB1bnRpbCBubyBjaGFuZ2VzIGFyZSBkZXRlY3RlZC4gVGhlIHJlcnVuXG4gICAgICAgKiAgIGl0ZXJhdGlvbiBsaW1pdCBpcyAxMCB0byBwcmV2ZW50IGFuIGluZmluaXRlIGxvb3AgZGVhZGxvY2suXG4gICAgICAgKlxuICAgICAgICpcbiAgICAgICAqIElmIHlvdSB3YW50IHRvIGJlIG5vdGlmaWVkIHdoZW5ldmVyIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRkaWdlc3QgJGRpZ2VzdH0gaXMgY2FsbGVkLFxuICAgICAgICogeW91IGNhbiByZWdpc3RlciBhIGB3YXRjaEV4cHJlc3Npb25gIGZ1bmN0aW9uIHdpdGggbm8gYGxpc3RlbmVyYC4gKEJlIHByZXBhcmVkIGZvclxuICAgICAgICogbXVsdGlwbGUgY2FsbHMgdG8geW91ciBgd2F0Y2hFeHByZXNzaW9uYCBiZWNhdXNlIGl0IHdpbGwgZXhlY3V0ZSBtdWx0aXBsZSB0aW1lcyBpbiBhXG4gICAgICAgKiBzaW5nbGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGRpZ2VzdCAkZGlnZXN0fSBjeWNsZSBpZiBhIGNoYW5nZSBpcyBkZXRlY3RlZC4pXG4gICAgICAgKlxuICAgICAgICogQWZ0ZXIgYSB3YXRjaGVyIGlzIHJlZ2lzdGVyZWQgd2l0aCB0aGUgc2NvcGUsIHRoZSBgbGlzdGVuZXJgIGZuIGlzIGNhbGxlZCBhc3luY2hyb25vdXNseVxuICAgICAgICogKHZpYSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZXZhbEFzeW5jICRldmFsQXN5bmN9KSB0byBpbml0aWFsaXplIHRoZVxuICAgICAgICogd2F0Y2hlci4gSW4gcmFyZSBjYXNlcywgdGhpcyBpcyB1bmRlc2lyYWJsZSBiZWNhdXNlIHRoZSBsaXN0ZW5lciBpcyBjYWxsZWQgd2hlbiB0aGUgcmVzdWx0XG4gICAgICAgKiBvZiBgd2F0Y2hFeHByZXNzaW9uYCBkaWRuJ3QgY2hhbmdlLiBUbyBkZXRlY3QgdGhpcyBzY2VuYXJpbyB3aXRoaW4gdGhlIGBsaXN0ZW5lcmAgZm4sIHlvdVxuICAgICAgICogY2FuIGNvbXBhcmUgdGhlIGBuZXdWYWxgIGFuZCBgb2xkVmFsYC4gSWYgdGhlc2UgdHdvIHZhbHVlcyBhcmUgaWRlbnRpY2FsIChgPT09YCkgdGhlbiB0aGVcbiAgICAgICAqIGxpc3RlbmVyIHdhcyBjYWxsZWQgZHVlIHRvIGluaXRpYWxpemF0aW9uLlxuICAgICAgICpcbiAgICAgICAqXG4gICAgICAgKlxuICAgICAgICogIyBFeGFtcGxlXG4gICAgICAgKiBgYGBqc1xuICAgICAgICAgICAvLyBsZXQncyBhc3N1bWUgdGhhdCBzY29wZSB3YXMgZGVwZW5kZW5jeSBpbmplY3RlZCBhcyB0aGUgJHJvb3RTY29wZVxuICAgICAgICAgICB2YXIgc2NvcGUgPSAkcm9vdFNjb3BlO1xuICAgICAgICAgICBzY29wZS5uYW1lID0gJ21pc2tvJztcbiAgICAgICAgICAgc2NvcGUuY291bnRlciA9IDA7XG5cbiAgICAgICAgICAgZXhwZWN0KHNjb3BlLmNvdW50ZXIpLnRvRXF1YWwoMCk7XG4gICAgICAgICAgIHNjb3BlLiR3YXRjaCgnbmFtZScsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgIHNjb3BlLmNvdW50ZXIgPSBzY29wZS5jb3VudGVyICsgMTtcbiAgICAgICAgICAgfSk7XG4gICAgICAgICAgIGV4cGVjdChzY29wZS5jb3VudGVyKS50b0VxdWFsKDApO1xuXG4gICAgICAgICAgIHNjb3BlLiRkaWdlc3QoKTtcbiAgICAgICAgICAgLy8gdGhlIGxpc3RlbmVyIGlzIGFsd2F5cyBjYWxsZWQgZHVyaW5nIHRoZSBmaXJzdCAkZGlnZXN0IGxvb3AgYWZ0ZXIgaXQgd2FzIHJlZ2lzdGVyZWRcbiAgICAgICAgICAgZXhwZWN0KHNjb3BlLmNvdW50ZXIpLnRvRXF1YWwoMSk7XG5cbiAgICAgICAgICAgc2NvcGUuJGRpZ2VzdCgpO1xuICAgICAgICAgICAvLyBidXQgbm93IGl0IHdpbGwgbm90IGJlIGNhbGxlZCB1bmxlc3MgdGhlIHZhbHVlIGNoYW5nZXNcbiAgICAgICAgICAgZXhwZWN0KHNjb3BlLmNvdW50ZXIpLnRvRXF1YWwoMSk7XG5cbiAgICAgICAgICAgc2NvcGUubmFtZSA9ICdhZGFtJztcbiAgICAgICAgICAgc2NvcGUuJGRpZ2VzdCgpO1xuICAgICAgICAgICBleHBlY3Qoc2NvcGUuY291bnRlcikudG9FcXVhbCgyKTtcblxuXG5cbiAgICAgICAgICAgLy8gVXNpbmcgYSBmdW5jdGlvbiBhcyBhIHdhdGNoRXhwcmVzc2lvblxuICAgICAgICAgICB2YXIgZm9vZDtcbiAgICAgICAgICAgc2NvcGUuZm9vZENvdW50ZXIgPSAwO1xuICAgICAgICAgICBleHBlY3Qoc2NvcGUuZm9vZENvdW50ZXIpLnRvRXF1YWwoMCk7XG4gICAgICAgICAgIHNjb3BlLiR3YXRjaChcbiAgICAgICAgICAgICAvLyBUaGlzIGZ1bmN0aW9uIHJldHVybnMgdGhlIHZhbHVlIGJlaW5nIHdhdGNoZWQuIEl0IGlzIGNhbGxlZCBmb3IgZWFjaCB0dXJuIG9mIHRoZSAkZGlnZXN0IGxvb3BcbiAgICAgICAgICAgICBmdW5jdGlvbigpIHsgcmV0dXJuIGZvb2Q7IH0sXG4gICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgY2hhbmdlIGxpc3RlbmVyLCBjYWxsZWQgd2hlbiB0aGUgdmFsdWUgcmV0dXJuZWQgZnJvbSB0aGUgYWJvdmUgZnVuY3Rpb24gY2hhbmdlc1xuICAgICAgICAgICAgIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgaWYgKCBuZXdWYWx1ZSAhPT0gb2xkVmFsdWUgKSB7XG4gICAgICAgICAgICAgICAgIC8vIE9ubHkgaW5jcmVtZW50IHRoZSBjb3VudGVyIGlmIHRoZSB2YWx1ZSBjaGFuZ2VkXG4gICAgICAgICAgICAgICAgIHNjb3BlLmZvb2RDb3VudGVyID0gc2NvcGUuZm9vZENvdW50ZXIgKyAxO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgKTtcbiAgICAgICAgICAgLy8gTm8gZGlnZXN0IGhhcyBiZWVuIHJ1biBzbyB0aGUgY291bnRlciB3aWxsIGJlIHplcm9cbiAgICAgICAgICAgZXhwZWN0KHNjb3BlLmZvb2RDb3VudGVyKS50b0VxdWFsKDApO1xuXG4gICAgICAgICAgIC8vIFJ1biB0aGUgZGlnZXN0IGJ1dCBzaW5jZSBmb29kIGhhcyBub3QgY2hhbmdlZCBjb3VudCB3aWxsIHN0aWxsIGJlIHplcm9cbiAgICAgICAgICAgc2NvcGUuJGRpZ2VzdCgpO1xuICAgICAgICAgICBleHBlY3Qoc2NvcGUuZm9vZENvdW50ZXIpLnRvRXF1YWwoMCk7XG5cbiAgICAgICAgICAgLy8gVXBkYXRlIGZvb2QgYW5kIHJ1biBkaWdlc3QuICBOb3cgdGhlIGNvdW50ZXIgd2lsbCBpbmNyZW1lbnRcbiAgICAgICAgICAgZm9vZCA9ICdjaGVlc2VidXJnZXInO1xuICAgICAgICAgICBzY29wZS4kZGlnZXN0KCk7XG4gICAgICAgICAgIGV4cGVjdChzY29wZS5mb29kQ291bnRlcikudG9FcXVhbCgxKTtcblxuICAgICAgICogYGBgXG4gICAgICAgKlxuICAgICAgICpcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0geyhmdW5jdGlvbigpfHN0cmluZyl9IHdhdGNoRXhwcmVzc2lvbiBFeHByZXNzaW9uIHRoYXQgaXMgZXZhbHVhdGVkIG9uIGVhY2hcbiAgICAgICAqICAgIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRkaWdlc3QgJGRpZ2VzdH0gY3ljbGUuIEEgY2hhbmdlIGluIHRoZSByZXR1cm4gdmFsdWUgdHJpZ2dlcnNcbiAgICAgICAqICAgIGEgY2FsbCB0byB0aGUgYGxpc3RlbmVyYC5cbiAgICAgICAqXG4gICAgICAgKiAgICAtIGBzdHJpbmdgOiBFdmFsdWF0ZWQgYXMge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gZXhwcmVzc2lvbn1cbiAgICAgICAqICAgIC0gYGZ1bmN0aW9uKHNjb3BlKWA6IGNhbGxlZCB3aXRoIGN1cnJlbnQgYHNjb3BlYCBhcyBhIHBhcmFtZXRlci5cbiAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24obmV3VmFsLCBvbGRWYWwsIHNjb3BlKX0gbGlzdGVuZXIgQ2FsbGJhY2sgY2FsbGVkIHdoZW5ldmVyIHRoZSB2YWx1ZVxuICAgICAgICogICAgb2YgYHdhdGNoRXhwcmVzc2lvbmAgY2hhbmdlcy5cbiAgICAgICAqXG4gICAgICAgKiAgICAtIGBuZXdWYWxgIGNvbnRhaW5zIHRoZSBjdXJyZW50IHZhbHVlIG9mIHRoZSBgd2F0Y2hFeHByZXNzaW9uYFxuICAgICAgICogICAgLSBgb2xkVmFsYCBjb250YWlucyB0aGUgcHJldmlvdXMgdmFsdWUgb2YgdGhlIGB3YXRjaEV4cHJlc3Npb25gXG4gICAgICAgKiAgICAtIGBzY29wZWAgcmVmZXJzIHRvIHRoZSBjdXJyZW50IHNjb3BlXG4gICAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBbb2JqZWN0RXF1YWxpdHk9ZmFsc2VdIENvbXBhcmUgZm9yIG9iamVjdCBlcXVhbGl0eSB1c2luZyB7QGxpbmsgYW5ndWxhci5lcXVhbHN9IGluc3RlYWQgb2ZcbiAgICAgICAqICAgICBjb21wYXJpbmcgZm9yIHJlZmVyZW5jZSBlcXVhbGl0eS5cbiAgICAgICAqIEByZXR1cm5zIHtmdW5jdGlvbigpfSBSZXR1cm5zIGEgZGVyZWdpc3RyYXRpb24gZnVuY3Rpb24gZm9yIHRoaXMgbGlzdGVuZXIuXG4gICAgICAgKi9cbiAgICAgICR3YXRjaDogZnVuY3Rpb24od2F0Y2hFeHAsIGxpc3RlbmVyLCBvYmplY3RFcXVhbGl0eSwgcHJldHR5UHJpbnRFeHByZXNzaW9uKSB7XG4gICAgICAgIHZhciBnZXQgPSAkcGFyc2Uod2F0Y2hFeHApO1xuXG4gICAgICAgIGlmIChnZXQuJCR3YXRjaERlbGVnYXRlKSB7XG4gICAgICAgICAgcmV0dXJuIGdldC4kJHdhdGNoRGVsZWdhdGUodGhpcywgbGlzdGVuZXIsIG9iamVjdEVxdWFsaXR5LCBnZXQsIHdhdGNoRXhwKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2NvcGUgPSB0aGlzLFxuICAgICAgICAgICAgYXJyYXkgPSBzY29wZS4kJHdhdGNoZXJzLFxuICAgICAgICAgICAgd2F0Y2hlciA9IHtcbiAgICAgICAgICAgICAgZm46IGxpc3RlbmVyLFxuICAgICAgICAgICAgICBsYXN0OiBpbml0V2F0Y2hWYWwsXG4gICAgICAgICAgICAgIGdldDogZ2V0LFxuICAgICAgICAgICAgICBleHA6IHByZXR0eVByaW50RXhwcmVzc2lvbiB8fCB3YXRjaEV4cCxcbiAgICAgICAgICAgICAgZXE6ICEhb2JqZWN0RXF1YWxpdHlcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgbGFzdERpcnR5V2F0Y2ggPSBudWxsO1xuXG4gICAgICAgIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpIHtcbiAgICAgICAgICB3YXRjaGVyLmZuID0gbm9vcDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghYXJyYXkpIHtcbiAgICAgICAgICBhcnJheSA9IHNjb3BlLiQkd2F0Y2hlcnMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICAvLyB3ZSB1c2UgdW5zaGlmdCBzaW5jZSB3ZSB1c2UgYSB3aGlsZSBsb29wIGluICRkaWdlc3QgZm9yIHNwZWVkLlxuICAgICAgICAvLyB0aGUgd2hpbGUgbG9vcCByZWFkcyBpbiByZXZlcnNlIG9yZGVyLlxuICAgICAgICBhcnJheS51bnNoaWZ0KHdhdGNoZXIpO1xuICAgICAgICBpbmNyZW1lbnRXYXRjaGVyc0NvdW50KHRoaXMsIDEpO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBkZXJlZ2lzdGVyV2F0Y2goKSB7XG4gICAgICAgICAgaWYgKGFycmF5UmVtb3ZlKGFycmF5LCB3YXRjaGVyKSA+PSAwKSB7XG4gICAgICAgICAgICBpbmNyZW1lbnRXYXRjaGVyc0NvdW50KHNjb3BlLCAtMSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxhc3REaXJ0eVdhdGNoID0gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkd2F0Y2hHcm91cFxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIEEgdmFyaWFudCBvZiB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkd2F0Y2ggJHdhdGNoKCl9IHdoZXJlIGl0IHdhdGNoZXMgYW4gYXJyYXkgb2YgYHdhdGNoRXhwcmVzc2lvbnNgLlxuICAgICAgICogSWYgYW55IG9uZSBleHByZXNzaW9uIGluIHRoZSBjb2xsZWN0aW9uIGNoYW5nZXMgdGhlIGBsaXN0ZW5lcmAgaXMgZXhlY3V0ZWQuXG4gICAgICAgKlxuICAgICAgICogLSBUaGUgaXRlbXMgaW4gdGhlIGB3YXRjaEV4cHJlc3Npb25zYCBhcnJheSBhcmUgb2JzZXJ2ZWQgdmlhIHN0YW5kYXJkICR3YXRjaCBvcGVyYXRpb24gYW5kIGFyZSBleGFtaW5lZCBvbiBldmVyeVxuICAgICAgICogICBjYWxsIHRvICRkaWdlc3QoKSB0byBzZWUgaWYgYW55IGl0ZW1zIGNoYW5nZXMuXG4gICAgICAgKiAtIFRoZSBgbGlzdGVuZXJgIGlzIGNhbGxlZCB3aGVuZXZlciBhbnkgZXhwcmVzc2lvbiBpbiB0aGUgYHdhdGNoRXhwcmVzc2lvbnNgIGFycmF5IGNoYW5nZXMuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtBcnJheS48c3RyaW5nfEZ1bmN0aW9uKHNjb3BlKT59IHdhdGNoRXhwcmVzc2lvbnMgQXJyYXkgb2YgZXhwcmVzc2lvbnMgdGhhdCB3aWxsIGJlIGluZGl2aWR1YWxseVxuICAgICAgICogd2F0Y2hlZCB1c2luZyB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkd2F0Y2ggJHdhdGNoKCl9XG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtmdW5jdGlvbihuZXdWYWx1ZXMsIG9sZFZhbHVlcywgc2NvcGUpfSBsaXN0ZW5lciBDYWxsYmFjayBjYWxsZWQgd2hlbmV2ZXIgdGhlIHJldHVybiB2YWx1ZSBvZiBhbnlcbiAgICAgICAqICAgIGV4cHJlc3Npb24gaW4gYHdhdGNoRXhwcmVzc2lvbnNgIGNoYW5nZXNcbiAgICAgICAqICAgIFRoZSBgbmV3VmFsdWVzYCBhcnJheSBjb250YWlucyB0aGUgY3VycmVudCB2YWx1ZXMgb2YgdGhlIGB3YXRjaEV4cHJlc3Npb25zYCwgd2l0aCB0aGUgaW5kZXhlcyBtYXRjaGluZ1xuICAgICAgICogICAgdGhvc2Ugb2YgYHdhdGNoRXhwcmVzc2lvbmBcbiAgICAgICAqICAgIGFuZCB0aGUgYG9sZFZhbHVlc2AgYXJyYXkgY29udGFpbnMgdGhlIHByZXZpb3VzIHZhbHVlcyBvZiB0aGUgYHdhdGNoRXhwcmVzc2lvbnNgLCB3aXRoIHRoZSBpbmRleGVzIG1hdGNoaW5nXG4gICAgICAgKiAgICB0aG9zZSBvZiBgd2F0Y2hFeHByZXNzaW9uYFxuICAgICAgICogICAgVGhlIGBzY29wZWAgcmVmZXJzIHRvIHRoZSBjdXJyZW50IHNjb3BlLlxuICAgICAgICogQHJldHVybnMge2Z1bmN0aW9uKCl9IFJldHVybnMgYSBkZS1yZWdpc3RyYXRpb24gZnVuY3Rpb24gZm9yIGFsbCBsaXN0ZW5lcnMuXG4gICAgICAgKi9cbiAgICAgICR3YXRjaEdyb3VwOiBmdW5jdGlvbih3YXRjaEV4cHJlc3Npb25zLCBsaXN0ZW5lcikge1xuICAgICAgICB2YXIgb2xkVmFsdWVzID0gbmV3IEFycmF5KHdhdGNoRXhwcmVzc2lvbnMubGVuZ3RoKTtcbiAgICAgICAgdmFyIG5ld1ZhbHVlcyA9IG5ldyBBcnJheSh3YXRjaEV4cHJlc3Npb25zLmxlbmd0aCk7XG4gICAgICAgIHZhciBkZXJlZ2lzdGVyRm5zID0gW107XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGNoYW5nZVJlYWN0aW9uU2NoZWR1bGVkID0gZmFsc2U7XG4gICAgICAgIHZhciBmaXJzdFJ1biA9IHRydWU7XG5cbiAgICAgICAgaWYgKCF3YXRjaEV4cHJlc3Npb25zLmxlbmd0aCkge1xuICAgICAgICAgIC8vIE5vIGV4cHJlc3Npb25zIG1lYW5zIHdlIGNhbGwgdGhlIGxpc3RlbmVyIEFTQVBcbiAgICAgICAgICB2YXIgc2hvdWxkQ2FsbCA9IHRydWU7XG4gICAgICAgICAgc2VsZi4kZXZhbEFzeW5jKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHNob3VsZENhbGwpIGxpc3RlbmVyKG5ld1ZhbHVlcywgbmV3VmFsdWVzLCBzZWxmKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gZGVyZWdpc3RlcldhdGNoR3JvdXAoKSB7XG4gICAgICAgICAgICBzaG91bGRDYWxsID0gZmFsc2U7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh3YXRjaEV4cHJlc3Npb25zLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBzaXplIG9mIG9uZVxuICAgICAgICAgIHJldHVybiB0aGlzLiR3YXRjaCh3YXRjaEV4cHJlc3Npb25zWzBdLCBmdW5jdGlvbiB3YXRjaEdyb3VwQWN0aW9uKHZhbHVlLCBvbGRWYWx1ZSwgc2NvcGUpIHtcbiAgICAgICAgICAgIG5ld1ZhbHVlc1swXSA9IHZhbHVlO1xuICAgICAgICAgICAgb2xkVmFsdWVzWzBdID0gb2xkVmFsdWU7XG4gICAgICAgICAgICBsaXN0ZW5lcihuZXdWYWx1ZXMsICh2YWx1ZSA9PT0gb2xkVmFsdWUpID8gbmV3VmFsdWVzIDogb2xkVmFsdWVzLCBzY29wZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3JFYWNoKHdhdGNoRXhwcmVzc2lvbnMsIGZ1bmN0aW9uKGV4cHIsIGkpIHtcbiAgICAgICAgICB2YXIgdW53YXRjaEZuID0gc2VsZi4kd2F0Y2goZXhwciwgZnVuY3Rpb24gd2F0Y2hHcm91cFN1YkFjdGlvbih2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICAgIG5ld1ZhbHVlc1tpXSA9IHZhbHVlO1xuICAgICAgICAgICAgb2xkVmFsdWVzW2ldID0gb2xkVmFsdWU7XG4gICAgICAgICAgICBpZiAoIWNoYW5nZVJlYWN0aW9uU2NoZWR1bGVkKSB7XG4gICAgICAgICAgICAgIGNoYW5nZVJlYWN0aW9uU2NoZWR1bGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgc2VsZi4kZXZhbEFzeW5jKHdhdGNoR3JvdXBBY3Rpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGRlcmVnaXN0ZXJGbnMucHVzaCh1bndhdGNoRm4pO1xuICAgICAgICB9KTtcblxuICAgICAgICBmdW5jdGlvbiB3YXRjaEdyb3VwQWN0aW9uKCkge1xuICAgICAgICAgIGNoYW5nZVJlYWN0aW9uU2NoZWR1bGVkID0gZmFsc2U7XG5cbiAgICAgICAgICBpZiAoZmlyc3RSdW4pIHtcbiAgICAgICAgICAgIGZpcnN0UnVuID0gZmFsc2U7XG4gICAgICAgICAgICBsaXN0ZW5lcihuZXdWYWx1ZXMsIG5ld1ZhbHVlcywgc2VsZik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxpc3RlbmVyKG5ld1ZhbHVlcywgb2xkVmFsdWVzLCBzZWxmKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gZGVyZWdpc3RlcldhdGNoR3JvdXAoKSB7XG4gICAgICAgICAgd2hpbGUgKGRlcmVnaXN0ZXJGbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBkZXJlZ2lzdGVyRm5zLnNoaWZ0KCkoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9LFxuXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkd2F0Y2hDb2xsZWN0aW9uXG4gICAgICAgKiBAa2luZCBmdW5jdGlvblxuICAgICAgICpcbiAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICogU2hhbGxvdyB3YXRjaGVzIHRoZSBwcm9wZXJ0aWVzIG9mIGFuIG9iamVjdCBhbmQgZmlyZXMgd2hlbmV2ZXIgYW55IG9mIHRoZSBwcm9wZXJ0aWVzIGNoYW5nZVxuICAgICAgICogKGZvciBhcnJheXMsIHRoaXMgaW1wbGllcyB3YXRjaGluZyB0aGUgYXJyYXkgaXRlbXM7IGZvciBvYmplY3QgbWFwcywgdGhpcyBpbXBsaWVzIHdhdGNoaW5nXG4gICAgICAgKiB0aGUgcHJvcGVydGllcykuIElmIGEgY2hhbmdlIGlzIGRldGVjdGVkLCB0aGUgYGxpc3RlbmVyYCBjYWxsYmFjayBpcyBmaXJlZC5cbiAgICAgICAqXG4gICAgICAgKiAtIFRoZSBgb2JqYCBjb2xsZWN0aW9uIGlzIG9ic2VydmVkIHZpYSBzdGFuZGFyZCAkd2F0Y2ggb3BlcmF0aW9uIGFuZCBpcyBleGFtaW5lZCBvbiBldmVyeVxuICAgICAgICogICBjYWxsIHRvICRkaWdlc3QoKSB0byBzZWUgaWYgYW55IGl0ZW1zIGhhdmUgYmVlbiBhZGRlZCwgcmVtb3ZlZCwgb3IgbW92ZWQuXG4gICAgICAgKiAtIFRoZSBgbGlzdGVuZXJgIGlzIGNhbGxlZCB3aGVuZXZlciBhbnl0aGluZyB3aXRoaW4gdGhlIGBvYmpgIGhhcyBjaGFuZ2VkLiBFeGFtcGxlcyBpbmNsdWRlXG4gICAgICAgKiAgIGFkZGluZywgcmVtb3ZpbmcsIGFuZCBtb3ZpbmcgaXRlbXMgYmVsb25naW5nIHRvIGFuIG9iamVjdCBvciBhcnJheS5cbiAgICAgICAqXG4gICAgICAgKlxuICAgICAgICogIyBFeGFtcGxlXG4gICAgICAgKiBgYGBqc1xuICAgICAgICAgICRzY29wZS5uYW1lcyA9IFsnaWdvcicsICdtYXRpYXMnLCAnbWlza28nLCAnamFtZXMnXTtcbiAgICAgICAgICAkc2NvcGUuZGF0YUNvdW50ID0gNDtcblxuICAgICAgICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCduYW1lcycsIGZ1bmN0aW9uKG5ld05hbWVzLCBvbGROYW1lcykge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGFDb3VudCA9IG5ld05hbWVzLmxlbmd0aDtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGV4cGVjdCgkc2NvcGUuZGF0YUNvdW50KS50b0VxdWFsKDQpO1xuICAgICAgICAgICRzY29wZS4kZGlnZXN0KCk7XG5cbiAgICAgICAgICAvL3N0aWxsIGF0IDQgLi4uIG5vIGNoYW5nZXNcbiAgICAgICAgICBleHBlY3QoJHNjb3BlLmRhdGFDb3VudCkudG9FcXVhbCg0KTtcblxuICAgICAgICAgICRzY29wZS5uYW1lcy5wb3AoKTtcbiAgICAgICAgICAkc2NvcGUuJGRpZ2VzdCgpO1xuXG4gICAgICAgICAgLy9ub3cgdGhlcmUncyBiZWVuIGEgY2hhbmdlXG4gICAgICAgICAgZXhwZWN0KCRzY29wZS5kYXRhQ291bnQpLnRvRXF1YWwoMyk7XG4gICAgICAgKiBgYGBcbiAgICAgICAqXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtzdHJpbmd8ZnVuY3Rpb24oc2NvcGUpfSBvYmogRXZhbHVhdGVkIGFzIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259LiBUaGVcbiAgICAgICAqICAgIGV4cHJlc3Npb24gdmFsdWUgc2hvdWxkIGV2YWx1YXRlIHRvIGFuIG9iamVjdCBvciBhbiBhcnJheSB3aGljaCBpcyBvYnNlcnZlZCBvbiBlYWNoXG4gICAgICAgKiAgICB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0ICRkaWdlc3R9IGN5Y2xlLiBBbnkgc2hhbGxvdyBjaGFuZ2Ugd2l0aGluIHRoZVxuICAgICAgICogICAgY29sbGVjdGlvbiB3aWxsIHRyaWdnZXIgYSBjYWxsIHRvIHRoZSBgbGlzdGVuZXJgLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24obmV3Q29sbGVjdGlvbiwgb2xkQ29sbGVjdGlvbiwgc2NvcGUpfSBsaXN0ZW5lciBhIGNhbGxiYWNrIGZ1bmN0aW9uIGNhbGxlZFxuICAgICAgICogICAgd2hlbiBhIGNoYW5nZSBpcyBkZXRlY3RlZC5cbiAgICAgICAqICAgIC0gVGhlIGBuZXdDb2xsZWN0aW9uYCBvYmplY3QgaXMgdGhlIG5ld2x5IG1vZGlmaWVkIGRhdGEgb2J0YWluZWQgZnJvbSB0aGUgYG9iamAgZXhwcmVzc2lvblxuICAgICAgICogICAgLSBUaGUgYG9sZENvbGxlY3Rpb25gIG9iamVjdCBpcyBhIGNvcHkgb2YgdGhlIGZvcm1lciBjb2xsZWN0aW9uIGRhdGEuXG4gICAgICAgKiAgICAgIER1ZSB0byBwZXJmb3JtYW5jZSBjb25zaWRlcmF0aW9ucywgdGhlYG9sZENvbGxlY3Rpb25gIHZhbHVlIGlzIGNvbXB1dGVkIG9ubHkgaWYgdGhlXG4gICAgICAgKiAgICAgIGBsaXN0ZW5lcmAgZnVuY3Rpb24gZGVjbGFyZXMgdHdvIG9yIG1vcmUgYXJndW1lbnRzLlxuICAgICAgICogICAgLSBUaGUgYHNjb3BlYCBhcmd1bWVudCByZWZlcnMgdG8gdGhlIGN1cnJlbnQgc2NvcGUuXG4gICAgICAgKlxuICAgICAgICogQHJldHVybnMge2Z1bmN0aW9uKCl9IFJldHVybnMgYSBkZS1yZWdpc3RyYXRpb24gZnVuY3Rpb24gZm9yIHRoaXMgbGlzdGVuZXIuIFdoZW4gdGhlXG4gICAgICAgKiAgICBkZS1yZWdpc3RyYXRpb24gZnVuY3Rpb24gaXMgZXhlY3V0ZWQsIHRoZSBpbnRlcm5hbCB3YXRjaCBvcGVyYXRpb24gaXMgdGVybWluYXRlZC5cbiAgICAgICAqL1xuICAgICAgJHdhdGNoQ29sbGVjdGlvbjogZnVuY3Rpb24ob2JqLCBsaXN0ZW5lcikge1xuICAgICAgICAkd2F0Y2hDb2xsZWN0aW9uSW50ZXJjZXB0b3IuJHN0YXRlZnVsID0gdHJ1ZTtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIC8vIHRoZSBjdXJyZW50IHZhbHVlLCB1cGRhdGVkIG9uIGVhY2ggZGlydHktY2hlY2sgcnVuXG4gICAgICAgIHZhciBuZXdWYWx1ZTtcbiAgICAgICAgLy8gYSBzaGFsbG93IGNvcHkgb2YgdGhlIG5ld1ZhbHVlIGZyb20gdGhlIGxhc3QgZGlydHktY2hlY2sgcnVuLFxuICAgICAgICAvLyB1cGRhdGVkIHRvIG1hdGNoIG5ld1ZhbHVlIGR1cmluZyBkaXJ0eS1jaGVjayBydW5cbiAgICAgICAgdmFyIG9sZFZhbHVlO1xuICAgICAgICAvLyBhIHNoYWxsb3cgY29weSBvZiB0aGUgbmV3VmFsdWUgZnJvbSB3aGVuIHRoZSBsYXN0IGNoYW5nZSBoYXBwZW5lZFxuICAgICAgICB2YXIgdmVyeU9sZFZhbHVlO1xuICAgICAgICAvLyBvbmx5IHRyYWNrIHZlcnlPbGRWYWx1ZSBpZiB0aGUgbGlzdGVuZXIgaXMgYXNraW5nIGZvciBpdFxuICAgICAgICB2YXIgdHJhY2tWZXJ5T2xkVmFsdWUgPSAobGlzdGVuZXIubGVuZ3RoID4gMSk7XG4gICAgICAgIHZhciBjaGFuZ2VEZXRlY3RlZCA9IDA7XG4gICAgICAgIHZhciBjaGFuZ2VEZXRlY3RvciA9ICRwYXJzZShvYmosICR3YXRjaENvbGxlY3Rpb25JbnRlcmNlcHRvcik7XG4gICAgICAgIHZhciBpbnRlcm5hbEFycmF5ID0gW107XG4gICAgICAgIHZhciBpbnRlcm5hbE9iamVjdCA9IHt9O1xuICAgICAgICB2YXIgaW5pdFJ1biA9IHRydWU7XG4gICAgICAgIHZhciBvbGRMZW5ndGggPSAwO1xuXG4gICAgICAgIGZ1bmN0aW9uICR3YXRjaENvbGxlY3Rpb25JbnRlcmNlcHRvcihfdmFsdWUpIHtcbiAgICAgICAgICBuZXdWYWx1ZSA9IF92YWx1ZTtcbiAgICAgICAgICB2YXIgbmV3TGVuZ3RoLCBrZXksIGJvdGhOYU4sIG5ld0l0ZW0sIG9sZEl0ZW07XG5cbiAgICAgICAgICAvLyBJZiB0aGUgbmV3IHZhbHVlIGlzIHVuZGVmaW5lZCwgdGhlbiByZXR1cm4gdW5kZWZpbmVkIGFzIHRoZSB3YXRjaCBtYXkgYmUgYSBvbmUtdGltZSB3YXRjaFxuICAgICAgICAgIGlmIChpc1VuZGVmaW5lZChuZXdWYWx1ZSkpIHJldHVybjtcblxuICAgICAgICAgIGlmICghaXNPYmplY3QobmV3VmFsdWUpKSB7IC8vIGlmIHByaW1pdGl2ZVxuICAgICAgICAgICAgaWYgKG9sZFZhbHVlICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICBvbGRWYWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3RlZCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoaXNBcnJheUxpa2UobmV3VmFsdWUpKSB7XG4gICAgICAgICAgICBpZiAob2xkVmFsdWUgIT09IGludGVybmFsQXJyYXkpIHtcbiAgICAgICAgICAgICAgLy8gd2UgYXJlIHRyYW5zaXRpb25pbmcgZnJvbSBzb21ldGhpbmcgd2hpY2ggd2FzIG5vdCBhbiBhcnJheSBpbnRvIGFycmF5LlxuICAgICAgICAgICAgICBvbGRWYWx1ZSA9IGludGVybmFsQXJyYXk7XG4gICAgICAgICAgICAgIG9sZExlbmd0aCA9IG9sZFZhbHVlLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICAgIGNoYW5nZURldGVjdGVkKys7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5ld0xlbmd0aCA9IG5ld1ZhbHVlLmxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKG9sZExlbmd0aCAhPT0gbmV3TGVuZ3RoKSB7XG4gICAgICAgICAgICAgIC8vIGlmIGxlbmd0aHMgZG8gbm90IG1hdGNoIHdlIG5lZWQgdG8gdHJpZ2dlciBjaGFuZ2Ugbm90aWZpY2F0aW9uXG4gICAgICAgICAgICAgIGNoYW5nZURldGVjdGVkKys7XG4gICAgICAgICAgICAgIG9sZFZhbHVlLmxlbmd0aCA9IG9sZExlbmd0aCA9IG5ld0xlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNvcHkgdGhlIGl0ZW1zIHRvIG9sZFZhbHVlIGFuZCBsb29rIGZvciBjaGFuZ2VzLlxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuZXdMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICBvbGRJdGVtID0gb2xkVmFsdWVbaV07XG4gICAgICAgICAgICAgIG5ld0l0ZW0gPSBuZXdWYWx1ZVtpXTtcblxuICAgICAgICAgICAgICBib3RoTmFOID0gKG9sZEl0ZW0gIT09IG9sZEl0ZW0pICYmIChuZXdJdGVtICE9PSBuZXdJdGVtKTtcbiAgICAgICAgICAgICAgaWYgKCFib3RoTmFOICYmIChvbGRJdGVtICE9PSBuZXdJdGVtKSkge1xuICAgICAgICAgICAgICAgIGNoYW5nZURldGVjdGVkKys7XG4gICAgICAgICAgICAgICAgb2xkVmFsdWVbaV0gPSBuZXdJdGVtO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChvbGRWYWx1ZSAhPT0gaW50ZXJuYWxPYmplY3QpIHtcbiAgICAgICAgICAgICAgLy8gd2UgYXJlIHRyYW5zaXRpb25pbmcgZnJvbSBzb21ldGhpbmcgd2hpY2ggd2FzIG5vdCBhbiBvYmplY3QgaW50byBvYmplY3QuXG4gICAgICAgICAgICAgIG9sZFZhbHVlID0gaW50ZXJuYWxPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgb2xkTGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgY2hhbmdlRGV0ZWN0ZWQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNvcHkgdGhlIGl0ZW1zIHRvIG9sZFZhbHVlIGFuZCBsb29rIGZvciBjaGFuZ2VzLlxuICAgICAgICAgICAgbmV3TGVuZ3RoID0gMDtcbiAgICAgICAgICAgIGZvciAoa2V5IGluIG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKG5ld1ZhbHVlLCBrZXkpKSB7XG4gICAgICAgICAgICAgICAgbmV3TGVuZ3RoKys7XG4gICAgICAgICAgICAgICAgbmV3SXRlbSA9IG5ld1ZhbHVlW2tleV07XG4gICAgICAgICAgICAgICAgb2xkSXRlbSA9IG9sZFZhbHVlW2tleV07XG5cbiAgICAgICAgICAgICAgICBpZiAoa2V5IGluIG9sZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICBib3RoTmFOID0gKG9sZEl0ZW0gIT09IG9sZEl0ZW0pICYmIChuZXdJdGVtICE9PSBuZXdJdGVtKTtcbiAgICAgICAgICAgICAgICAgIGlmICghYm90aE5hTiAmJiAob2xkSXRlbSAhPT0gbmV3SXRlbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlRGV0ZWN0ZWQrKztcbiAgICAgICAgICAgICAgICAgICAgb2xkVmFsdWVba2V5XSA9IG5ld0l0ZW07XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIG9sZExlbmd0aCsrO1xuICAgICAgICAgICAgICAgICAgb2xkVmFsdWVba2V5XSA9IG5ld0l0ZW07XG4gICAgICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3RlZCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9sZExlbmd0aCA+IG5ld0xlbmd0aCkge1xuICAgICAgICAgICAgICAvLyB3ZSB1c2VkIHRvIGhhdmUgbW9yZSBrZXlzLCBuZWVkIHRvIGZpbmQgdGhlbSBhbmQgZGVzdHJveSB0aGVtLlxuICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3RlZCsrO1xuICAgICAgICAgICAgICBmb3IgKGtleSBpbiBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICghaGFzT3duUHJvcGVydHkuY2FsbChuZXdWYWx1ZSwga2V5KSkge1xuICAgICAgICAgICAgICAgICAgb2xkTGVuZ3RoLS07XG4gICAgICAgICAgICAgICAgICBkZWxldGUgb2xkVmFsdWVba2V5XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGNoYW5nZURldGVjdGVkO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gJHdhdGNoQ29sbGVjdGlvbkFjdGlvbigpIHtcbiAgICAgICAgICBpZiAoaW5pdFJ1bikge1xuICAgICAgICAgICAgaW5pdFJ1biA9IGZhbHNlO1xuICAgICAgICAgICAgbGlzdGVuZXIobmV3VmFsdWUsIG5ld1ZhbHVlLCBzZWxmKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGlzdGVuZXIobmV3VmFsdWUsIHZlcnlPbGRWYWx1ZSwgc2VsZik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gbWFrZSBhIGNvcHkgZm9yIHRoZSBuZXh0IHRpbWUgYSBjb2xsZWN0aW9uIGlzIGNoYW5nZWRcbiAgICAgICAgICBpZiAodHJhY2tWZXJ5T2xkVmFsdWUpIHtcbiAgICAgICAgICAgIGlmICghaXNPYmplY3QobmV3VmFsdWUpKSB7XG4gICAgICAgICAgICAgIC8vcHJpbWl0aXZlXG4gICAgICAgICAgICAgIHZlcnlPbGRWYWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5TGlrZShuZXdWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgdmVyeU9sZFZhbHVlID0gbmV3IEFycmF5KG5ld1ZhbHVlLmxlbmd0aCk7XG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbmV3VmFsdWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2ZXJ5T2xkVmFsdWVbaV0gPSBuZXdWYWx1ZVtpXTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHsgLy8gaWYgb2JqZWN0XG4gICAgICAgICAgICAgIHZlcnlPbGRWYWx1ZSA9IHt9O1xuICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gbmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChuZXdWYWx1ZSwga2V5KSkge1xuICAgICAgICAgICAgICAgICAgdmVyeU9sZFZhbHVlW2tleV0gPSBuZXdWYWx1ZVtrZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLiR3YXRjaChjaGFuZ2VEZXRlY3RvciwgJHdhdGNoQ29sbGVjdGlvbkFjdGlvbik7XG4gICAgICB9LFxuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRyb290U2NvcGUuU2NvcGUjJGRpZ2VzdFxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIFByb2Nlc3NlcyBhbGwgb2YgdGhlIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyR3YXRjaCB3YXRjaGVyc30gb2YgdGhlIGN1cnJlbnQgc2NvcGUgYW5kXG4gICAgICAgKiBpdHMgY2hpbGRyZW4uIEJlY2F1c2UgYSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkd2F0Y2ggd2F0Y2hlcn0ncyBsaXN0ZW5lciBjYW4gY2hhbmdlXG4gICAgICAgKiB0aGUgbW9kZWwsIHRoZSBgJGRpZ2VzdCgpYCBrZWVwcyBjYWxsaW5nIHRoZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkd2F0Y2ggd2F0Y2hlcnN9XG4gICAgICAgKiB1bnRpbCBubyBtb3JlIGxpc3RlbmVycyBhcmUgZmlyaW5nLiBUaGlzIG1lYW5zIHRoYXQgaXQgaXMgcG9zc2libGUgdG8gZ2V0IGludG8gYW4gaW5maW5pdGVcbiAgICAgICAqIGxvb3AuIFRoaXMgZnVuY3Rpb24gd2lsbCB0aHJvdyBgJ01heGltdW0gaXRlcmF0aW9uIGxpbWl0IGV4Y2VlZGVkLidgIGlmIHRoZSBudW1iZXIgb2ZcbiAgICAgICAqIGl0ZXJhdGlvbnMgZXhjZWVkcyAxMC5cbiAgICAgICAqXG4gICAgICAgKiBVc3VhbGx5LCB5b3UgZG9uJ3QgY2FsbCBgJGRpZ2VzdCgpYCBkaXJlY3RseSBpblxuICAgICAgICoge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0NvbnRyb2xsZXIgY29udHJvbGxlcnN9IG9yIGluXG4gICAgICAgKiB7QGxpbmsgbmcuJGNvbXBpbGVQcm92aWRlciNkaXJlY3RpdmUgZGlyZWN0aXZlc30uXG4gICAgICAgKiBJbnN0ZWFkLCB5b3Ugc2hvdWxkIGNhbGwge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGFwcGx5ICRhcHBseSgpfSAodHlwaWNhbGx5IGZyb20gd2l0aGluXG4gICAgICAgKiBhIHtAbGluayBuZy4kY29tcGlsZVByb3ZpZGVyI2RpcmVjdGl2ZSBkaXJlY3RpdmV9KSwgd2hpY2ggd2lsbCBmb3JjZSBhIGAkZGlnZXN0KClgLlxuICAgICAgICpcbiAgICAgICAqIElmIHlvdSB3YW50IHRvIGJlIG5vdGlmaWVkIHdoZW5ldmVyIGAkZGlnZXN0KClgIGlzIGNhbGxlZCxcbiAgICAgICAqIHlvdSBjYW4gcmVnaXN0ZXIgYSBgd2F0Y2hFeHByZXNzaW9uYCBmdW5jdGlvbiB3aXRoXG4gICAgICAgKiB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkd2F0Y2ggJHdhdGNoKCl9IHdpdGggbm8gYGxpc3RlbmVyYC5cbiAgICAgICAqXG4gICAgICAgKiBJbiB1bml0IHRlc3RzLCB5b3UgbWF5IG5lZWQgdG8gY2FsbCBgJGRpZ2VzdCgpYCB0byBzaW11bGF0ZSB0aGUgc2NvcGUgbGlmZSBjeWNsZS5cbiAgICAgICAqXG4gICAgICAgKiAjIEV4YW1wbGVcbiAgICAgICAqIGBgYGpzXG4gICAgICAgICAgIHZhciBzY29wZSA9IC4uLjtcbiAgICAgICAgICAgc2NvcGUubmFtZSA9ICdtaXNrbyc7XG4gICAgICAgICAgIHNjb3BlLmNvdW50ZXIgPSAwO1xuXG4gICAgICAgICAgIGV4cGVjdChzY29wZS5jb3VudGVyKS50b0VxdWFsKDApO1xuICAgICAgICAgICBzY29wZS4kd2F0Y2goJ25hbWUnLCBmdW5jdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICAgICBzY29wZS5jb3VudGVyID0gc2NvcGUuY291bnRlciArIDE7XG4gICAgICAgICAgIH0pO1xuICAgICAgICAgICBleHBlY3Qoc2NvcGUuY291bnRlcikudG9FcXVhbCgwKTtcblxuICAgICAgICAgICBzY29wZS4kZGlnZXN0KCk7XG4gICAgICAgICAgIC8vIHRoZSBsaXN0ZW5lciBpcyBhbHdheXMgY2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgJGRpZ2VzdCBsb29wIGFmdGVyIGl0IHdhcyByZWdpc3RlcmVkXG4gICAgICAgICAgIGV4cGVjdChzY29wZS5jb3VudGVyKS50b0VxdWFsKDEpO1xuXG4gICAgICAgICAgIHNjb3BlLiRkaWdlc3QoKTtcbiAgICAgICAgICAgLy8gYnV0IG5vdyBpdCB3aWxsIG5vdCBiZSBjYWxsZWQgdW5sZXNzIHRoZSB2YWx1ZSBjaGFuZ2VzXG4gICAgICAgICAgIGV4cGVjdChzY29wZS5jb3VudGVyKS50b0VxdWFsKDEpO1xuXG4gICAgICAgICAgIHNjb3BlLm5hbWUgPSAnYWRhbSc7XG4gICAgICAgICAgIHNjb3BlLiRkaWdlc3QoKTtcbiAgICAgICAgICAgZXhwZWN0KHNjb3BlLmNvdW50ZXIpLnRvRXF1YWwoMik7XG4gICAgICAgKiBgYGBcbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgICRkaWdlc3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgd2F0Y2gsIHZhbHVlLCBsYXN0LCBmbiwgZ2V0LFxuICAgICAgICAgICAgd2F0Y2hlcnMsXG4gICAgICAgICAgICBsZW5ndGgsXG4gICAgICAgICAgICBkaXJ0eSwgdHRsID0gVFRMLFxuICAgICAgICAgICAgbmV4dCwgY3VycmVudCwgdGFyZ2V0ID0gdGhpcyxcbiAgICAgICAgICAgIHdhdGNoTG9nID0gW10sXG4gICAgICAgICAgICBsb2dJZHgsIGxvZ01zZywgYXN5bmNUYXNrO1xuXG4gICAgICAgIGJlZ2luUGhhc2UoJyRkaWdlc3QnKTtcbiAgICAgICAgLy8gQ2hlY2sgZm9yIGNoYW5nZXMgdG8gYnJvd3NlciB1cmwgdGhhdCBoYXBwZW5lZCBpbiBzeW5jIGJlZm9yZSB0aGUgY2FsbCB0byAkZGlnZXN0XG4gICAgICAgICRicm93c2VyLiQkY2hlY2tVcmxDaGFuZ2UoKTtcblxuICAgICAgICBpZiAodGhpcyA9PT0gJHJvb3RTY29wZSAmJiBhcHBseUFzeW5jSWQgIT09IG51bGwpIHtcbiAgICAgICAgICAvLyBJZiB0aGlzIGlzIHRoZSByb290IHNjb3BlLCBhbmQgJGFwcGx5QXN5bmMgaGFzIHNjaGVkdWxlZCBhIGRlZmVycmVkICRhcHBseSgpLCB0aGVuXG4gICAgICAgICAgLy8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgJGFwcGx5IGFuZCBmbHVzaCB0aGUgcXVldWUgb2YgZXhwcmVzc2lvbnMgdG8gYmUgZXZhbHVhdGVkLlxuICAgICAgICAgICRicm93c2VyLmRlZmVyLmNhbmNlbChhcHBseUFzeW5jSWQpO1xuICAgICAgICAgIGZsdXNoQXBwbHlBc3luYygpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGFzdERpcnR5V2F0Y2ggPSBudWxsO1xuXG4gICAgICAgIGRvIHsgLy8gXCJ3aGlsZSBkaXJ0eVwiIGxvb3BcbiAgICAgICAgICBkaXJ0eSA9IGZhbHNlO1xuICAgICAgICAgIGN1cnJlbnQgPSB0YXJnZXQ7XG5cbiAgICAgICAgICB3aGlsZSAoYXN5bmNRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGFzeW5jVGFzayA9IGFzeW5jUXVldWUuc2hpZnQoKTtcbiAgICAgICAgICAgICAgYXN5bmNUYXNrLnNjb3BlLiRldmFsKGFzeW5jVGFzay5leHByZXNzaW9uLCBhc3luY1Rhc2subG9jYWxzKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsYXN0RGlydHlXYXRjaCA9IG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdHJhdmVyc2VTY29wZXNMb29wOlxuICAgICAgICAgIGRvIHsgLy8gXCJ0cmF2ZXJzZSB0aGUgc2NvcGVzXCIgbG9vcFxuICAgICAgICAgICAgaWYgKCh3YXRjaGVycyA9IGN1cnJlbnQuJCR3YXRjaGVycykpIHtcbiAgICAgICAgICAgICAgLy8gcHJvY2VzcyBvdXIgd2F0Y2hlc1xuICAgICAgICAgICAgICBsZW5ndGggPSB3YXRjaGVycy5sZW5ndGg7XG4gICAgICAgICAgICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICB3YXRjaCA9IHdhdGNoZXJzW2xlbmd0aF07XG4gICAgICAgICAgICAgICAgICAvLyBNb3N0IGNvbW1vbiB3YXRjaGVzIGFyZSBvbiBwcmltaXRpdmVzLCBpbiB3aGljaCBjYXNlIHdlIGNhbiBzaG9ydFxuICAgICAgICAgICAgICAgICAgLy8gY2lyY3VpdCBpdCB3aXRoID09PSBvcGVyYXRvciwgb25seSB3aGVuID09PSBmYWlscyBkbyB3ZSB1c2UgLmVxdWFsc1xuICAgICAgICAgICAgICAgICAgaWYgKHdhdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldCA9IHdhdGNoLmdldDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSA9IGdldChjdXJyZW50KSkgIT09IChsYXN0ID0gd2F0Y2gubGFzdCkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICEod2F0Y2guZXFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGVxdWFscyh2YWx1ZSwgbGFzdClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIHR5cGVvZiBsYXN0ID09PSAnbnVtYmVyJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGlzTmFOKHZhbHVlKSAmJiBpc05hTihsYXN0KSkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZGlydHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgIGxhc3REaXJ0eVdhdGNoID0gd2F0Y2g7XG4gICAgICAgICAgICAgICAgICAgICAgd2F0Y2gubGFzdCA9IHdhdGNoLmVxID8gY29weSh2YWx1ZSwgbnVsbCkgOiB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICBmbiA9IHdhdGNoLmZuO1xuICAgICAgICAgICAgICAgICAgICAgIGZuKHZhbHVlLCAoKGxhc3QgPT09IGluaXRXYXRjaFZhbCkgPyB2YWx1ZSA6IGxhc3QpLCBjdXJyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAodHRsIDwgNSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nSWR4ID0gNCAtIHR0bDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghd2F0Y2hMb2dbbG9nSWR4XSkgd2F0Y2hMb2dbbG9nSWR4XSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2F0Y2hMb2dbbG9nSWR4XS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnOiBpc0Z1bmN0aW9uKHdhdGNoLmV4cCkgPyAnZm46ICcgKyAod2F0Y2guZXhwLm5hbWUgfHwgd2F0Y2guZXhwLnRvU3RyaW5nKCkpIDogd2F0Y2guZXhwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdWYWw6IHZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRWYWw6IGxhc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh3YXRjaCA9PT0gbGFzdERpcnR5V2F0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgbW9zdCByZWNlbnRseSBkaXJ0eSB3YXRjaGVyIGlzIG5vdyBjbGVhbiwgc2hvcnQgY2lyY3VpdCBzaW5jZSB0aGUgcmVtYWluaW5nIHdhdGNoZXJzXG4gICAgICAgICAgICAgICAgICAgICAgLy8gaGF2ZSBhbHJlYWR5IGJlZW4gdGVzdGVkLlxuICAgICAgICAgICAgICAgICAgICAgIGRpcnR5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWsgdHJhdmVyc2VTY29wZXNMb29wO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEluc2FuaXR5IFdhcm5pbmc6IHNjb3BlIGRlcHRoLWZpcnN0IHRyYXZlcnNhbFxuICAgICAgICAgICAgLy8geWVzLCB0aGlzIGNvZGUgaXMgYSBiaXQgY3JhenksIGJ1dCBpdCB3b3JrcyBhbmQgd2UgaGF2ZSB0ZXN0cyB0byBwcm92ZSBpdCFcbiAgICAgICAgICAgIC8vIHRoaXMgcGllY2Ugc2hvdWxkIGJlIGtlcHQgaW4gc3luYyB3aXRoIHRoZSB0cmF2ZXJzYWwgaW4gJGJyb2FkY2FzdFxuICAgICAgICAgICAgaWYgKCEobmV4dCA9ICgoY3VycmVudC4kJHdhdGNoZXJzQ291bnQgJiYgY3VycmVudC4kJGNoaWxkSGVhZCkgfHxcbiAgICAgICAgICAgICAgICAoY3VycmVudCAhPT0gdGFyZ2V0ICYmIGN1cnJlbnQuJCRuZXh0U2libGluZykpKSkge1xuICAgICAgICAgICAgICB3aGlsZSAoY3VycmVudCAhPT0gdGFyZ2V0ICYmICEobmV4dCA9IGN1cnJlbnQuJCRuZXh0U2libGluZykpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC4kcGFyZW50O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSB3aGlsZSAoKGN1cnJlbnQgPSBuZXh0KSk7XG5cbiAgICAgICAgICAvLyBgYnJlYWsgdHJhdmVyc2VTY29wZXNMb29wO2AgdGFrZXMgdXMgdG8gaGVyZVxuXG4gICAgICAgICAgaWYgKChkaXJ0eSB8fCBhc3luY1F1ZXVlLmxlbmd0aCkgJiYgISh0dGwtLSkpIHtcbiAgICAgICAgICAgIGNsZWFyUGhhc2UoKTtcbiAgICAgICAgICAgIHRocm93ICRyb290U2NvcGVNaW5FcnIoJ2luZmRpZycsXG4gICAgICAgICAgICAgICAgJ3swfSAkZGlnZXN0KCkgaXRlcmF0aW9ucyByZWFjaGVkLiBBYm9ydGluZyFcXG4nICtcbiAgICAgICAgICAgICAgICAnV2F0Y2hlcnMgZmlyZWQgaW4gdGhlIGxhc3QgNSBpdGVyYXRpb25zOiB7MX0nLFxuICAgICAgICAgICAgICAgIFRUTCwgd2F0Y2hMb2cpO1xuICAgICAgICAgIH1cblxuICAgICAgICB9IHdoaWxlIChkaXJ0eSB8fCBhc3luY1F1ZXVlLmxlbmd0aCk7XG5cbiAgICAgICAgY2xlYXJQaGFzZSgpO1xuXG4gICAgICAgIHdoaWxlIChwb3N0RGlnZXN0UXVldWUubGVuZ3RoKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHBvc3REaWdlc3RRdWV1ZS5zaGlmdCgpKCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIGV2ZW50XG4gICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRkZXN0cm95XG4gICAgICAgKiBAZXZlbnRUeXBlIGJyb2FkY2FzdCBvbiBzY29wZSBiZWluZyBkZXN0cm95ZWRcbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIEJyb2FkY2FzdGVkIHdoZW4gYSBzY29wZSBhbmQgaXRzIGNoaWxkcmVuIGFyZSBiZWluZyBkZXN0cm95ZWQuXG4gICAgICAgKlxuICAgICAgICogTm90ZSB0aGF0LCBpbiBBbmd1bGFySlMsIHRoZXJlIGlzIGFsc28gYSBgJGRlc3Ryb3lgIGpRdWVyeSBldmVudCwgd2hpY2ggY2FuIGJlIHVzZWQgdG9cbiAgICAgICAqIGNsZWFuIHVwIERPTSBiaW5kaW5ncyBiZWZvcmUgYW4gZWxlbWVudCBpcyByZW1vdmVkIGZyb20gdGhlIERPTS5cbiAgICAgICAqL1xuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRyb290U2NvcGUuU2NvcGUjJGRlc3Ryb3lcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBSZW1vdmVzIHRoZSBjdXJyZW50IHNjb3BlIChhbmQgYWxsIG9mIGl0cyBjaGlsZHJlbikgZnJvbSB0aGUgcGFyZW50IHNjb3BlLiBSZW1vdmFsIGltcGxpZXNcbiAgICAgICAqIHRoYXQgY2FsbHMgdG8ge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGRpZ2VzdCAkZGlnZXN0KCl9IHdpbGwgbm8gbG9uZ2VyXG4gICAgICAgKiBwcm9wYWdhdGUgdG8gdGhlIGN1cnJlbnQgc2NvcGUgYW5kIGl0cyBjaGlsZHJlbi4gUmVtb3ZhbCBhbHNvIGltcGxpZXMgdGhhdCB0aGUgY3VycmVudFxuICAgICAgICogc2NvcGUgaXMgZWxpZ2libGUgZm9yIGdhcmJhZ2UgY29sbGVjdGlvbi5cbiAgICAgICAqXG4gICAgICAgKiBUaGUgYCRkZXN0cm95KClgIGlzIHVzdWFsbHkgdXNlZCBieSBkaXJlY3RpdmVzIHN1Y2ggYXNcbiAgICAgICAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdSZXBlYXQgbmdSZXBlYXR9IGZvciBtYW5hZ2luZyB0aGVcbiAgICAgICAqIHVucm9sbGluZyBvZiB0aGUgbG9vcC5cbiAgICAgICAqXG4gICAgICAgKiBKdXN0IGJlZm9yZSBhIHNjb3BlIGlzIGRlc3Ryb3llZCwgYSBgJGRlc3Ryb3lgIGV2ZW50IGlzIGJyb2FkY2FzdGVkIG9uIHRoaXMgc2NvcGUuXG4gICAgICAgKiBBcHBsaWNhdGlvbiBjb2RlIGNhbiByZWdpc3RlciBhIGAkZGVzdHJveWAgZXZlbnQgaGFuZGxlciB0aGF0IHdpbGwgZ2l2ZSBpdCBhIGNoYW5jZSB0b1xuICAgICAgICogcGVyZm9ybSBhbnkgbmVjZXNzYXJ5IGNsZWFudXAuXG4gICAgICAgKlxuICAgICAgICogTm90ZSB0aGF0LCBpbiBBbmd1bGFySlMsIHRoZXJlIGlzIGFsc28gYSBgJGRlc3Ryb3lgIGpRdWVyeSBldmVudCwgd2hpY2ggY2FuIGJlIHVzZWQgdG9cbiAgICAgICAqIGNsZWFuIHVwIERPTSBiaW5kaW5ncyBiZWZvcmUgYW4gZWxlbWVudCBpcyByZW1vdmVkIGZyb20gdGhlIERPTS5cbiAgICAgICAqL1xuICAgICAgJGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBXZSBjYW4ndCBkZXN0cm95IGEgc2NvcGUgdGhhdCBoYXMgYmVlbiBhbHJlYWR5IGRlc3Ryb3llZC5cbiAgICAgICAgaWYgKHRoaXMuJCRkZXN0cm95ZWQpIHJldHVybjtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMuJHBhcmVudDtcblxuICAgICAgICB0aGlzLiRicm9hZGNhc3QoJyRkZXN0cm95Jyk7XG4gICAgICAgIHRoaXMuJCRkZXN0cm95ZWQgPSB0cnVlO1xuXG4gICAgICAgIGlmICh0aGlzID09PSAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgLy9SZW1vdmUgaGFuZGxlcnMgYXR0YWNoZWQgdG8gd2luZG93IHdoZW4gJHJvb3RTY29wZSBpcyByZW1vdmVkXG4gICAgICAgICAgJGJyb3dzZXIuJCRhcHBsaWNhdGlvbkRlc3Ryb3llZCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaW5jcmVtZW50V2F0Y2hlcnNDb3VudCh0aGlzLCAtdGhpcy4kJHdhdGNoZXJzQ291bnQpO1xuICAgICAgICBmb3IgKHZhciBldmVudE5hbWUgaW4gdGhpcy4kJGxpc3RlbmVyQ291bnQpIHtcbiAgICAgICAgICBkZWNyZW1lbnRMaXN0ZW5lckNvdW50KHRoaXMsIHRoaXMuJCRsaXN0ZW5lckNvdW50W2V2ZW50TmFtZV0sIGV2ZW50TmFtZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzZXZlciBhbGwgdGhlIHJlZmVyZW5jZXMgdG8gcGFyZW50IHNjb3BlcyAoYWZ0ZXIgdGhpcyBjbGVhbnVwLCB0aGUgY3VycmVudCBzY29wZSBzaG91bGRcbiAgICAgICAgLy8gbm90IGJlIHJldGFpbmVkIGJ5IGFueSBvZiBvdXIgcmVmZXJlbmNlcyBhbmQgc2hvdWxkIGJlIGVsaWdpYmxlIGZvciBnYXJiYWdlIGNvbGxlY3Rpb24pXG4gICAgICAgIGlmIChwYXJlbnQgJiYgcGFyZW50LiQkY2hpbGRIZWFkID09IHRoaXMpIHBhcmVudC4kJGNoaWxkSGVhZCA9IHRoaXMuJCRuZXh0U2libGluZztcbiAgICAgICAgaWYgKHBhcmVudCAmJiBwYXJlbnQuJCRjaGlsZFRhaWwgPT0gdGhpcykgcGFyZW50LiQkY2hpbGRUYWlsID0gdGhpcy4kJHByZXZTaWJsaW5nO1xuICAgICAgICBpZiAodGhpcy4kJHByZXZTaWJsaW5nKSB0aGlzLiQkcHJldlNpYmxpbmcuJCRuZXh0U2libGluZyA9IHRoaXMuJCRuZXh0U2libGluZztcbiAgICAgICAgaWYgKHRoaXMuJCRuZXh0U2libGluZykgdGhpcy4kJG5leHRTaWJsaW5nLiQkcHJldlNpYmxpbmcgPSB0aGlzLiQkcHJldlNpYmxpbmc7XG5cbiAgICAgICAgLy8gRGlzYWJsZSBsaXN0ZW5lcnMsIHdhdGNoZXJzIGFuZCBhcHBseS9kaWdlc3QgbWV0aG9kc1xuICAgICAgICB0aGlzLiRkZXN0cm95ID0gdGhpcy4kZGlnZXN0ID0gdGhpcy4kYXBwbHkgPSB0aGlzLiRldmFsQXN5bmMgPSB0aGlzLiRhcHBseUFzeW5jID0gbm9vcDtcbiAgICAgICAgdGhpcy4kb24gPSB0aGlzLiR3YXRjaCA9IHRoaXMuJHdhdGNoR3JvdXAgPSBmdW5jdGlvbigpIHsgcmV0dXJuIG5vb3A7IH07XG4gICAgICAgIHRoaXMuJCRsaXN0ZW5lcnMgPSB7fTtcblxuICAgICAgICAvLyBEaXNjb25uZWN0IHRoZSBuZXh0IHNpYmxpbmcgdG8gcHJldmVudCBgY2xlYW5VcFNjb3BlYCBkZXN0cm95aW5nIHRob3NlIHRvb1xuICAgICAgICB0aGlzLiQkbmV4dFNpYmxpbmcgPSBudWxsO1xuICAgICAgICBjbGVhblVwU2NvcGUodGhpcyk7XG4gICAgICB9LFxuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRyb290U2NvcGUuU2NvcGUjJGV2YWxcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBFeGVjdXRlcyB0aGUgYGV4cHJlc3Npb25gIG9uIHRoZSBjdXJyZW50IHNjb3BlIGFuZCByZXR1cm5zIHRoZSByZXN1bHQuIEFueSBleGNlcHRpb25zIGluXG4gICAgICAgKiB0aGUgZXhwcmVzc2lvbiBhcmUgcHJvcGFnYXRlZCAodW5jYXVnaHQpLiBUaGlzIGlzIHVzZWZ1bCB3aGVuIGV2YWx1YXRpbmcgQW5ndWxhclxuICAgICAgICogZXhwcmVzc2lvbnMuXG4gICAgICAgKlxuICAgICAgICogIyBFeGFtcGxlXG4gICAgICAgKiBgYGBqc1xuICAgICAgICAgICB2YXIgc2NvcGUgPSBuZy4kcm9vdFNjb3BlLlNjb3BlKCk7XG4gICAgICAgICAgIHNjb3BlLmEgPSAxO1xuICAgICAgICAgICBzY29wZS5iID0gMjtcblxuICAgICAgICAgICBleHBlY3Qoc2NvcGUuJGV2YWwoJ2ErYicpKS50b0VxdWFsKDMpO1xuICAgICAgICAgICBleHBlY3Qoc2NvcGUuJGV2YWwoZnVuY3Rpb24oc2NvcGUpeyByZXR1cm4gc2NvcGUuYSArIHNjb3BlLmI7IH0pKS50b0VxdWFsKDMpO1xuICAgICAgICogYGBgXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHsoc3RyaW5nfGZ1bmN0aW9uKCkpPX0gZXhwcmVzc2lvbiBBbiBhbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQuXG4gICAgICAgKlxuICAgICAgICogICAgLSBgc3RyaW5nYDogZXhlY3V0ZSB1c2luZyB0aGUgcnVsZXMgYXMgZGVmaW5lZCBpbiAge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gZXhwcmVzc2lvbn0uXG4gICAgICAgKiAgICAtIGBmdW5jdGlvbihzY29wZSlgOiBleGVjdXRlIHRoZSBmdW5jdGlvbiB3aXRoIHRoZSBjdXJyZW50IGBzY29wZWAgcGFyYW1ldGVyLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7KG9iamVjdCk9fSBsb2NhbHMgTG9jYWwgdmFyaWFibGVzIG9iamVjdCwgdXNlZnVsIGZvciBvdmVycmlkaW5nIHZhbHVlcyBpbiBzY29wZS5cbiAgICAgICAqIEByZXR1cm5zIHsqfSBUaGUgcmVzdWx0IG9mIGV2YWx1YXRpbmcgdGhlIGV4cHJlc3Npb24uXG4gICAgICAgKi9cbiAgICAgICRldmFsOiBmdW5jdGlvbihleHByLCBsb2NhbHMpIHtcbiAgICAgICAgcmV0dXJuICRwYXJzZShleHByKSh0aGlzLCBsb2NhbHMpO1xuICAgICAgfSxcblxuICAgICAgLyoqXG4gICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRldmFsQXN5bmNcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBFeGVjdXRlcyB0aGUgZXhwcmVzc2lvbiBvbiB0aGUgY3VycmVudCBzY29wZSBhdCBhIGxhdGVyIHBvaW50IGluIHRpbWUuXG4gICAgICAgKlxuICAgICAgICogVGhlIGAkZXZhbEFzeW5jYCBtYWtlcyBubyBndWFyYW50ZWVzIGFzIHRvIHdoZW4gdGhlIGBleHByZXNzaW9uYCB3aWxsIGJlIGV4ZWN1dGVkLCBvbmx5XG4gICAgICAgKiB0aGF0OlxuICAgICAgICpcbiAgICAgICAqICAgLSBpdCB3aWxsIGV4ZWN1dGUgYWZ0ZXIgdGhlIGZ1bmN0aW9uIHRoYXQgc2NoZWR1bGVkIHRoZSBldmFsdWF0aW9uIChwcmVmZXJhYmx5IGJlZm9yZSBET01cbiAgICAgICAqICAgICByZW5kZXJpbmcpLlxuICAgICAgICogICAtIGF0IGxlYXN0IG9uZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0ICRkaWdlc3QgY3ljbGV9IHdpbGwgYmUgcGVyZm9ybWVkIGFmdGVyXG4gICAgICAgKiAgICAgYGV4cHJlc3Npb25gIGV4ZWN1dGlvbi5cbiAgICAgICAqXG4gICAgICAgKiBBbnkgZXhjZXB0aW9ucyBmcm9tIHRoZSBleGVjdXRpb24gb2YgdGhlIGV4cHJlc3Npb24gYXJlIGZvcndhcmRlZCB0byB0aGVcbiAgICAgICAqIHtAbGluayBuZy4kZXhjZXB0aW9uSGFuZGxlciAkZXhjZXB0aW9uSGFuZGxlcn0gc2VydmljZS5cbiAgICAgICAqXG4gICAgICAgKiBfX05vdGU6X18gaWYgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgb3V0c2lkZSBvZiBhIGAkZGlnZXN0YCBjeWNsZSwgYSBuZXcgYCRkaWdlc3RgIGN5Y2xlXG4gICAgICAgKiB3aWxsIGJlIHNjaGVkdWxlZC4gSG93ZXZlciwgaXQgaXMgZW5jb3VyYWdlZCB0byBhbHdheXMgY2FsbCBjb2RlIHRoYXQgY2hhbmdlcyB0aGUgbW9kZWxcbiAgICAgICAqIGZyb20gd2l0aGluIGFuIGAkYXBwbHlgIGNhbGwuIFRoYXQgaW5jbHVkZXMgY29kZSBldmFsdWF0ZWQgdmlhIGAkZXZhbEFzeW5jYC5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0geyhzdHJpbmd8ZnVuY3Rpb24oKSk9fSBleHByZXNzaW9uIEFuIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZC5cbiAgICAgICAqXG4gICAgICAgKiAgICAtIGBzdHJpbmdgOiBleGVjdXRlIHVzaW5nIHRoZSBydWxlcyBhcyBkZWZpbmVkIGluIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259LlxuICAgICAgICogICAgLSBgZnVuY3Rpb24oc2NvcGUpYDogZXhlY3V0ZSB0aGUgZnVuY3Rpb24gd2l0aCB0aGUgY3VycmVudCBgc2NvcGVgIHBhcmFtZXRlci5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0geyhvYmplY3QpPX0gbG9jYWxzIExvY2FsIHZhcmlhYmxlcyBvYmplY3QsIHVzZWZ1bCBmb3Igb3ZlcnJpZGluZyB2YWx1ZXMgaW4gc2NvcGUuXG4gICAgICAgKi9cbiAgICAgICRldmFsQXN5bmM6IGZ1bmN0aW9uKGV4cHIsIGxvY2Fscykge1xuICAgICAgICAvLyBpZiB3ZSBhcmUgb3V0c2lkZSBvZiBhbiAkZGlnZXN0IGxvb3AgYW5kIHRoaXMgaXMgdGhlIGZpcnN0IHRpbWUgd2UgYXJlIHNjaGVkdWxpbmcgYXN5bmNcbiAgICAgICAgLy8gdGFzayBhbHNvIHNjaGVkdWxlIGFzeW5jIGF1dG8tZmx1c2hcbiAgICAgICAgaWYgKCEkcm9vdFNjb3BlLiQkcGhhc2UgJiYgIWFzeW5jUXVldWUubGVuZ3RoKSB7XG4gICAgICAgICAgJGJyb3dzZXIuZGVmZXIoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoYXN5bmNRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgJHJvb3RTY29wZS4kZGlnZXN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBhc3luY1F1ZXVlLnB1c2goe3Njb3BlOiB0aGlzLCBleHByZXNzaW9uOiAkcGFyc2UoZXhwciksIGxvY2FsczogbG9jYWxzfSk7XG4gICAgICB9LFxuXG4gICAgICAkJHBvc3REaWdlc3Q6IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgIHBvc3REaWdlc3RRdWV1ZS5wdXNoKGZuKTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkYXBwbHlcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBgJGFwcGx5KClgIGlzIHVzZWQgdG8gZXhlY3V0ZSBhbiBleHByZXNzaW9uIGluIGFuZ3VsYXIgZnJvbSBvdXRzaWRlIG9mIHRoZSBhbmd1bGFyXG4gICAgICAgKiBmcmFtZXdvcmsuIChGb3IgZXhhbXBsZSBmcm9tIGJyb3dzZXIgRE9NIGV2ZW50cywgc2V0VGltZW91dCwgWEhSIG9yIHRoaXJkIHBhcnR5IGxpYnJhcmllcykuXG4gICAgICAgKiBCZWNhdXNlIHdlIGFyZSBjYWxsaW5nIGludG8gdGhlIGFuZ3VsYXIgZnJhbWV3b3JrIHdlIG5lZWQgdG8gcGVyZm9ybSBwcm9wZXIgc2NvcGUgbGlmZVxuICAgICAgICogY3ljbGUgb2Yge0BsaW5rIG5nLiRleGNlcHRpb25IYW5kbGVyIGV4Y2VwdGlvbiBoYW5kbGluZ30sXG4gICAgICAgKiB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZGlnZXN0IGV4ZWN1dGluZyB3YXRjaGVzfS5cbiAgICAgICAqXG4gICAgICAgKiAjIyBMaWZlIGN5Y2xlXG4gICAgICAgKlxuICAgICAgICogIyBQc2V1ZG8tQ29kZSBvZiBgJGFwcGx5KClgXG4gICAgICAgKiBgYGBqc1xuICAgICAgICAgICBmdW5jdGlvbiAkYXBwbHkoZXhwcikge1xuICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICByZXR1cm4gJGV2YWwoZXhwcik7XG4gICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG4gICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICRyb290LiRkaWdlc3QoKTtcbiAgICAgICAgICAgICB9XG4gICAgICAgICAgIH1cbiAgICAgICAqIGBgYFxuICAgICAgICpcbiAgICAgICAqXG4gICAgICAgKiBTY29wZSdzIGAkYXBwbHkoKWAgbWV0aG9kIHRyYW5zaXRpb25zIHRocm91Z2ggdGhlIGZvbGxvd2luZyBzdGFnZXM6XG4gICAgICAgKlxuICAgICAgICogMS4gVGhlIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259IGlzIGV4ZWN1dGVkIHVzaW5nIHRoZVxuICAgICAgICogICAge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJGV2YWwgJGV2YWwoKX0gbWV0aG9kLlxuICAgICAgICogMi4gQW55IGV4Y2VwdGlvbnMgZnJvbSB0aGUgZXhlY3V0aW9uIG9mIHRoZSBleHByZXNzaW9uIGFyZSBmb3J3YXJkZWQgdG8gdGhlXG4gICAgICAgKiAgICB7QGxpbmsgbmcuJGV4Y2VwdGlvbkhhbmRsZXIgJGV4Y2VwdGlvbkhhbmRsZXJ9IHNlcnZpY2UuXG4gICAgICAgKiAzLiBUaGUge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJHdhdGNoIHdhdGNofSBsaXN0ZW5lcnMgYXJlIGZpcmVkIGltbWVkaWF0ZWx5IGFmdGVyIHRoZVxuICAgICAgICogICAgZXhwcmVzc2lvbiB3YXMgZXhlY3V0ZWQgdXNpbmcgdGhlIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRkaWdlc3QgJGRpZ2VzdCgpfSBtZXRob2QuXG4gICAgICAgKlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7KHN0cmluZ3xmdW5jdGlvbigpKT19IGV4cCBBbiBhbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQuXG4gICAgICAgKlxuICAgICAgICogICAgLSBgc3RyaW5nYDogZXhlY3V0ZSB1c2luZyB0aGUgcnVsZXMgYXMgZGVmaW5lZCBpbiB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufS5cbiAgICAgICAqICAgIC0gYGZ1bmN0aW9uKHNjb3BlKWA6IGV4ZWN1dGUgdGhlIGZ1bmN0aW9uIHdpdGggY3VycmVudCBgc2NvcGVgIHBhcmFtZXRlci5cbiAgICAgICAqXG4gICAgICAgKiBAcmV0dXJucyB7Kn0gVGhlIHJlc3VsdCBvZiBldmFsdWF0aW5nIHRoZSBleHByZXNzaW9uLlxuICAgICAgICovXG4gICAgICAkYXBwbHk6IGZ1bmN0aW9uKGV4cHIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBiZWdpblBoYXNlKCckYXBwbHknKTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGV2YWwoZXhwcik7XG4gICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIGNsZWFyUGhhc2UoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAkZXhjZXB0aW9uSGFuZGxlcihlKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kZGlnZXN0KCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLyoqXG4gICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgKiBAbmFtZSAkcm9vdFNjb3BlLlNjb3BlIyRhcHBseUFzeW5jXG4gICAgICAgKiBAa2luZCBmdW5jdGlvblxuICAgICAgICpcbiAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICogU2NoZWR1bGUgdGhlIGludm9jYXRpb24gb2YgJGFwcGx5IHRvIG9jY3VyIGF0IGEgbGF0ZXIgdGltZS4gVGhlIGFjdHVhbCB0aW1lIGRpZmZlcmVuY2VcbiAgICAgICAqIHZhcmllcyBhY3Jvc3MgYnJvd3NlcnMsIGJ1dCBpcyB0eXBpY2FsbHkgYXJvdW5kIH4xMCBtaWxsaXNlY29uZHMuXG4gICAgICAgKlxuICAgICAgICogVGhpcyBjYW4gYmUgdXNlZCB0byBxdWV1ZSB1cCBtdWx0aXBsZSBleHByZXNzaW9ucyB3aGljaCBuZWVkIHRvIGJlIGV2YWx1YXRlZCBpbiB0aGUgc2FtZVxuICAgICAgICogZGlnZXN0LlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7KHN0cmluZ3xmdW5jdGlvbigpKT19IGV4cCBBbiBhbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQuXG4gICAgICAgKlxuICAgICAgICogICAgLSBgc3RyaW5nYDogZXhlY3V0ZSB1c2luZyB0aGUgcnVsZXMgYXMgZGVmaW5lZCBpbiB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufS5cbiAgICAgICAqICAgIC0gYGZ1bmN0aW9uKHNjb3BlKWA6IGV4ZWN1dGUgdGhlIGZ1bmN0aW9uIHdpdGggY3VycmVudCBgc2NvcGVgIHBhcmFtZXRlci5cbiAgICAgICAqL1xuICAgICAgJGFwcGx5QXN5bmM6IGZ1bmN0aW9uKGV4cHIpIHtcbiAgICAgICAgdmFyIHNjb3BlID0gdGhpcztcbiAgICAgICAgZXhwciAmJiBhcHBseUFzeW5jUXVldWUucHVzaCgkYXBwbHlBc3luY0V4cHJlc3Npb24pO1xuICAgICAgICBleHByID0gJHBhcnNlKGV4cHIpO1xuICAgICAgICBzY2hlZHVsZUFwcGx5QXN5bmMoKTtcblxuICAgICAgICBmdW5jdGlvbiAkYXBwbHlBc3luY0V4cHJlc3Npb24oKSB7XG4gICAgICAgICAgc2NvcGUuJGV2YWwoZXhwcik7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICogQG5hbWUgJHJvb3RTY29wZS5TY29wZSMkb25cbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBMaXN0ZW5zIG9uIGV2ZW50cyBvZiBhIGdpdmVuIHR5cGUuIFNlZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkZW1pdCAkZW1pdH0gZm9yXG4gICAgICAgKiBkaXNjdXNzaW9uIG9mIGV2ZW50IGxpZmUgY3ljbGUuXG4gICAgICAgKlxuICAgICAgICogVGhlIGV2ZW50IGxpc3RlbmVyIGZ1bmN0aW9uIGZvcm1hdCBpczogYGZ1bmN0aW9uKGV2ZW50LCBhcmdzLi4uKWAuIFRoZSBgZXZlbnRgIG9iamVjdFxuICAgICAgICogcGFzc2VkIGludG8gdGhlIGxpc3RlbmVyIGhhcyB0aGUgZm9sbG93aW5nIGF0dHJpYnV0ZXM6XG4gICAgICAgKlxuICAgICAgICogICAtIGB0YXJnZXRTY29wZWAgLSBge1Njb3BlfWA6IHRoZSBzY29wZSBvbiB3aGljaCB0aGUgZXZlbnQgd2FzIGAkZW1pdGAtZWQgb3JcbiAgICAgICAqICAgICBgJGJyb2FkY2FzdGAtZWQuXG4gICAgICAgKiAgIC0gYGN1cnJlbnRTY29wZWAgLSBge1Njb3BlfWA6IHRoZSBzY29wZSB0aGF0IGlzIGN1cnJlbnRseSBoYW5kbGluZyB0aGUgZXZlbnQuIE9uY2UgdGhlXG4gICAgICAgKiAgICAgZXZlbnQgcHJvcGFnYXRlcyB0aHJvdWdoIHRoZSBzY29wZSBoaWVyYXJjaHksIHRoaXMgcHJvcGVydHkgaXMgc2V0IHRvIG51bGwuXG4gICAgICAgKiAgIC0gYG5hbWVgIC0gYHtzdHJpbmd9YDogbmFtZSBvZiB0aGUgZXZlbnQuXG4gICAgICAgKiAgIC0gYHN0b3BQcm9wYWdhdGlvbmAgLSBge2Z1bmN0aW9uPX1gOiBjYWxsaW5nIGBzdG9wUHJvcGFnYXRpb25gIGZ1bmN0aW9uIHdpbGwgY2FuY2VsXG4gICAgICAgKiAgICAgZnVydGhlciBldmVudCBwcm9wYWdhdGlvbiAoYXZhaWxhYmxlIG9ubHkgZm9yIGV2ZW50cyB0aGF0IHdlcmUgYCRlbWl0YC1lZCkuXG4gICAgICAgKiAgIC0gYHByZXZlbnREZWZhdWx0YCAtIGB7ZnVuY3Rpb259YDogY2FsbGluZyBgcHJldmVudERlZmF1bHRgIHNldHMgYGRlZmF1bHRQcmV2ZW50ZWRgIGZsYWdcbiAgICAgICAqICAgICB0byB0cnVlLlxuICAgICAgICogICAtIGBkZWZhdWx0UHJldmVudGVkYCAtIGB7Ym9vbGVhbn1gOiB0cnVlIGlmIGBwcmV2ZW50RGVmYXVsdGAgd2FzIGNhbGxlZC5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBFdmVudCBuYW1lIHRvIGxpc3RlbiBvbi5cbiAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQsIC4uLmFyZ3MpfSBsaXN0ZW5lciBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIGV2ZW50IGlzIGVtaXR0ZWQuXG4gICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb24oKX0gUmV0dXJucyBhIGRlcmVnaXN0cmF0aW9uIGZ1bmN0aW9uIGZvciB0aGlzIGxpc3RlbmVyLlxuICAgICAgICovXG4gICAgICAkb246IGZ1bmN0aW9uKG5hbWUsIGxpc3RlbmVyKSB7XG4gICAgICAgIHZhciBuYW1lZExpc3RlbmVycyA9IHRoaXMuJCRsaXN0ZW5lcnNbbmFtZV07XG4gICAgICAgIGlmICghbmFtZWRMaXN0ZW5lcnMpIHtcbiAgICAgICAgICB0aGlzLiQkbGlzdGVuZXJzW25hbWVdID0gbmFtZWRMaXN0ZW5lcnMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBuYW1lZExpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcblxuICAgICAgICB2YXIgY3VycmVudCA9IHRoaXM7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICBpZiAoIWN1cnJlbnQuJCRsaXN0ZW5lckNvdW50W25hbWVdKSB7XG4gICAgICAgICAgICBjdXJyZW50LiQkbGlzdGVuZXJDb3VudFtuYW1lXSA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIGN1cnJlbnQuJCRsaXN0ZW5lckNvdW50W25hbWVdKys7XG4gICAgICAgIH0gd2hpbGUgKChjdXJyZW50ID0gY3VycmVudC4kcGFyZW50KSk7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGluZGV4T2ZMaXN0ZW5lciA9IG5hbWVkTGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgICAgIGlmIChpbmRleE9mTGlzdGVuZXIgIT09IC0xKSB7XG4gICAgICAgICAgICBuYW1lZExpc3RlbmVyc1tpbmRleE9mTGlzdGVuZXJdID0gbnVsbDtcbiAgICAgICAgICAgIGRlY3JlbWVudExpc3RlbmVyQ291bnQoc2VsZiwgMSwgbmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSxcblxuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRyb290U2NvcGUuU2NvcGUjJGVtaXRcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBEaXNwYXRjaGVzIGFuIGV2ZW50IGBuYW1lYCB1cHdhcmRzIHRocm91Z2ggdGhlIHNjb3BlIGhpZXJhcmNoeSBub3RpZnlpbmcgdGhlXG4gICAgICAgKiByZWdpc3RlcmVkIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRvbn0gbGlzdGVuZXJzLlxuICAgICAgICpcbiAgICAgICAqIFRoZSBldmVudCBsaWZlIGN5Y2xlIHN0YXJ0cyBhdCB0aGUgc2NvcGUgb24gd2hpY2ggYCRlbWl0YCB3YXMgY2FsbGVkLiBBbGxcbiAgICAgICAqIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRvbiBsaXN0ZW5lcnN9IGxpc3RlbmluZyBmb3IgYG5hbWVgIGV2ZW50IG9uIHRoaXMgc2NvcGUgZ2V0XG4gICAgICAgKiBub3RpZmllZC4gQWZ0ZXJ3YXJkcywgdGhlIGV2ZW50IHRyYXZlcnNlcyB1cHdhcmRzIHRvd2FyZCB0aGUgcm9vdCBzY29wZSBhbmQgY2FsbHMgYWxsXG4gICAgICAgKiByZWdpc3RlcmVkIGxpc3RlbmVycyBhbG9uZyB0aGUgd2F5LiBUaGUgZXZlbnQgd2lsbCBzdG9wIHByb3BhZ2F0aW5nIGlmIG9uZSBvZiB0aGUgbGlzdGVuZXJzXG4gICAgICAgKiBjYW5jZWxzIGl0LlxuICAgICAgICpcbiAgICAgICAqIEFueSBleGNlcHRpb24gZW1pdHRlZCBmcm9tIHRoZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkb24gbGlzdGVuZXJzfSB3aWxsIGJlIHBhc3NlZFxuICAgICAgICogb250byB0aGUge0BsaW5rIG5nLiRleGNlcHRpb25IYW5kbGVyICRleGNlcHRpb25IYW5kbGVyfSBzZXJ2aWNlLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIEV2ZW50IG5hbWUgdG8gZW1pdC5cbiAgICAgICAqIEBwYXJhbSB7Li4uKn0gYXJncyBPcHRpb25hbCBvbmUgb3IgbW9yZSBhcmd1bWVudHMgd2hpY2ggd2lsbCBiZSBwYXNzZWQgb250byB0aGUgZXZlbnQgbGlzdGVuZXJzLlxuICAgICAgICogQHJldHVybiB7T2JqZWN0fSBFdmVudCBvYmplY3QgKHNlZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkb259KS5cbiAgICAgICAqL1xuICAgICAgJGVtaXQ6IGZ1bmN0aW9uKG5hbWUsIGFyZ3MpIHtcbiAgICAgICAgdmFyIGVtcHR5ID0gW10sXG4gICAgICAgICAgICBuYW1lZExpc3RlbmVycyxcbiAgICAgICAgICAgIHNjb3BlID0gdGhpcyxcbiAgICAgICAgICAgIHN0b3BQcm9wYWdhdGlvbiA9IGZhbHNlLFxuICAgICAgICAgICAgZXZlbnQgPSB7XG4gICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgIHRhcmdldFNjb3BlOiBzY29wZSxcbiAgICAgICAgICAgICAgc3RvcFByb3BhZ2F0aW9uOiBmdW5jdGlvbigpIHtzdG9wUHJvcGFnYXRpb24gPSB0cnVlO30sXG4gICAgICAgICAgICAgIHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBldmVudC5kZWZhdWx0UHJldmVudGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZGVmYXVsdFByZXZlbnRlZDogZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaXN0ZW5lckFyZ3MgPSBjb25jYXQoW2V2ZW50XSwgYXJndW1lbnRzLCAxKSxcbiAgICAgICAgICAgIGksIGxlbmd0aDtcblxuICAgICAgICBkbyB7XG4gICAgICAgICAgbmFtZWRMaXN0ZW5lcnMgPSBzY29wZS4kJGxpc3RlbmVyc1tuYW1lXSB8fCBlbXB0eTtcbiAgICAgICAgICBldmVudC5jdXJyZW50U2NvcGUgPSBzY29wZTtcbiAgICAgICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBuYW1lZExpc3RlbmVycy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuXG4gICAgICAgICAgICAvLyBpZiBsaXN0ZW5lcnMgd2VyZSBkZXJlZ2lzdGVyZWQsIGRlZnJhZ21lbnQgdGhlIGFycmF5XG4gICAgICAgICAgICBpZiAoIW5hbWVkTGlzdGVuZXJzW2ldKSB7XG4gICAgICAgICAgICAgIG5hbWVkTGlzdGVuZXJzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgaS0tO1xuICAgICAgICAgICAgICBsZW5ndGgtLTtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAvL2FsbG93IGFsbCBsaXN0ZW5lcnMgYXR0YWNoZWQgdG8gdGhlIGN1cnJlbnQgc2NvcGUgdG8gcnVuXG4gICAgICAgICAgICAgIG5hbWVkTGlzdGVuZXJzW2ldLmFwcGx5KG51bGwsIGxpc3RlbmVyQXJncyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICRleGNlcHRpb25IYW5kbGVyKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvL2lmIGFueSBsaXN0ZW5lciBvbiB0aGUgY3VycmVudCBzY29wZSBzdG9wcyBwcm9wYWdhdGlvbiwgcHJldmVudCBidWJibGluZ1xuICAgICAgICAgIGlmIChzdG9wUHJvcGFnYXRpb24pIHtcbiAgICAgICAgICAgIGV2ZW50LmN1cnJlbnRTY29wZSA9IG51bGw7XG4gICAgICAgICAgICByZXR1cm4gZXZlbnQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vdHJhdmVyc2UgdXB3YXJkc1xuICAgICAgICAgIHNjb3BlID0gc2NvcGUuJHBhcmVudDtcbiAgICAgICAgfSB3aGlsZSAoc2NvcGUpO1xuXG4gICAgICAgIGV2ZW50LmN1cnJlbnRTY29wZSA9IG51bGw7XG5cbiAgICAgICAgcmV0dXJuIGV2ZW50O1xuICAgICAgfSxcblxuXG4gICAgICAvKipcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICRyb290U2NvcGUuU2NvcGUjJGJyb2FkY2FzdFxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIERpc3BhdGNoZXMgYW4gZXZlbnQgYG5hbWVgIGRvd253YXJkcyB0byBhbGwgY2hpbGQgc2NvcGVzIChhbmQgdGhlaXIgY2hpbGRyZW4pIG5vdGlmeWluZyB0aGVcbiAgICAgICAqIHJlZ2lzdGVyZWQge0BsaW5rIG5nLiRyb290U2NvcGUuU2NvcGUjJG9ufSBsaXN0ZW5lcnMuXG4gICAgICAgKlxuICAgICAgICogVGhlIGV2ZW50IGxpZmUgY3ljbGUgc3RhcnRzIGF0IHRoZSBzY29wZSBvbiB3aGljaCBgJGJyb2FkY2FzdGAgd2FzIGNhbGxlZC4gQWxsXG4gICAgICAgKiB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkb24gbGlzdGVuZXJzfSBsaXN0ZW5pbmcgZm9yIGBuYW1lYCBldmVudCBvbiB0aGlzIHNjb3BlIGdldFxuICAgICAgICogbm90aWZpZWQuIEFmdGVyd2FyZHMsIHRoZSBldmVudCBwcm9wYWdhdGVzIHRvIGFsbCBkaXJlY3QgYW5kIGluZGlyZWN0IHNjb3BlcyBvZiB0aGUgY3VycmVudFxuICAgICAgICogc2NvcGUgYW5kIGNhbGxzIGFsbCByZWdpc3RlcmVkIGxpc3RlbmVycyBhbG9uZyB0aGUgd2F5LiBUaGUgZXZlbnQgY2Fubm90IGJlIGNhbmNlbGVkLlxuICAgICAgICpcbiAgICAgICAqIEFueSBleGNlcHRpb24gZW1pdHRlZCBmcm9tIHRoZSB7QGxpbmsgbmcuJHJvb3RTY29wZS5TY29wZSMkb24gbGlzdGVuZXJzfSB3aWxsIGJlIHBhc3NlZFxuICAgICAgICogb250byB0aGUge0BsaW5rIG5nLiRleGNlcHRpb25IYW5kbGVyICRleGNlcHRpb25IYW5kbGVyfSBzZXJ2aWNlLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIEV2ZW50IG5hbWUgdG8gYnJvYWRjYXN0LlxuICAgICAgICogQHBhcmFtIHsuLi4qfSBhcmdzIE9wdGlvbmFsIG9uZSBvciBtb3JlIGFyZ3VtZW50cyB3aGljaCB3aWxsIGJlIHBhc3NlZCBvbnRvIHRoZSBldmVudCBsaXN0ZW5lcnMuXG4gICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IEV2ZW50IG9iamVjdCwgc2VlIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRvbn1cbiAgICAgICAqL1xuICAgICAgJGJyb2FkY2FzdDogZnVuY3Rpb24obmFtZSwgYXJncykge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcyxcbiAgICAgICAgICAgIGN1cnJlbnQgPSB0YXJnZXQsXG4gICAgICAgICAgICBuZXh0ID0gdGFyZ2V0LFxuICAgICAgICAgICAgZXZlbnQgPSB7XG4gICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgIHRhcmdldFNjb3BlOiB0YXJnZXQsXG4gICAgICAgICAgICAgIHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBldmVudC5kZWZhdWx0UHJldmVudGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZGVmYXVsdFByZXZlbnRlZDogZmFsc2VcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgaWYgKCF0YXJnZXQuJCRsaXN0ZW5lckNvdW50W25hbWVdKSByZXR1cm4gZXZlbnQ7XG5cbiAgICAgICAgdmFyIGxpc3RlbmVyQXJncyA9IGNvbmNhdChbZXZlbnRdLCBhcmd1bWVudHMsIDEpLFxuICAgICAgICAgICAgbGlzdGVuZXJzLCBpLCBsZW5ndGg7XG5cbiAgICAgICAgLy9kb3duIHdoaWxlIHlvdSBjYW4sIHRoZW4gdXAgYW5kIG5leHQgc2libGluZyBvciB1cCBhbmQgbmV4dCBzaWJsaW5nIHVudGlsIGJhY2sgYXQgcm9vdFxuICAgICAgICB3aGlsZSAoKGN1cnJlbnQgPSBuZXh0KSkge1xuICAgICAgICAgIGV2ZW50LmN1cnJlbnRTY29wZSA9IGN1cnJlbnQ7XG4gICAgICAgICAgbGlzdGVuZXJzID0gY3VycmVudC4kJGxpc3RlbmVyc1tuYW1lXSB8fCBbXTtcbiAgICAgICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBsaXN0ZW5lcnMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vIGlmIGxpc3RlbmVycyB3ZXJlIGRlcmVnaXN0ZXJlZCwgZGVmcmFnbWVudCB0aGUgYXJyYXlcbiAgICAgICAgICAgIGlmICghbGlzdGVuZXJzW2ldKSB7XG4gICAgICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgIGktLTtcbiAgICAgICAgICAgICAgbGVuZ3RoLS07XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBsaXN0ZW5lcnNbaV0uYXBwbHkobnVsbCwgbGlzdGVuZXJBcmdzKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gSW5zYW5pdHkgV2FybmluZzogc2NvcGUgZGVwdGgtZmlyc3QgdHJhdmVyc2FsXG4gICAgICAgICAgLy8geWVzLCB0aGlzIGNvZGUgaXMgYSBiaXQgY3JhenksIGJ1dCBpdCB3b3JrcyBhbmQgd2UgaGF2ZSB0ZXN0cyB0byBwcm92ZSBpdCFcbiAgICAgICAgICAvLyB0aGlzIHBpZWNlIHNob3VsZCBiZSBrZXB0IGluIHN5bmMgd2l0aCB0aGUgdHJhdmVyc2FsIGluICRkaWdlc3RcbiAgICAgICAgICAvLyAodGhvdWdoIGl0IGRpZmZlcnMgZHVlIHRvIGhhdmluZyB0aGUgZXh0cmEgY2hlY2sgZm9yICQkbGlzdGVuZXJDb3VudClcbiAgICAgICAgICBpZiAoIShuZXh0ID0gKChjdXJyZW50LiQkbGlzdGVuZXJDb3VudFtuYW1lXSAmJiBjdXJyZW50LiQkY2hpbGRIZWFkKSB8fFxuICAgICAgICAgICAgICAoY3VycmVudCAhPT0gdGFyZ2V0ICYmIGN1cnJlbnQuJCRuZXh0U2libGluZykpKSkge1xuICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnQgIT09IHRhcmdldCAmJiAhKG5leHQgPSBjdXJyZW50LiQkbmV4dFNpYmxpbmcpKSB7XG4gICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50LiRwYXJlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZXZlbnQuY3VycmVudFNjb3BlID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIGV2ZW50O1xuICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgJHJvb3RTY29wZSA9IG5ldyBTY29wZSgpO1xuXG4gICAgLy9UaGUgaW50ZXJuYWwgcXVldWVzLiBFeHBvc2UgdGhlbSBvbiB0aGUgJHJvb3RTY29wZSBmb3IgZGVidWdnaW5nL3Rlc3RpbmcgcHVycG9zZXMuXG4gICAgdmFyIGFzeW5jUXVldWUgPSAkcm9vdFNjb3BlLiQkYXN5bmNRdWV1ZSA9IFtdO1xuICAgIHZhciBwb3N0RGlnZXN0UXVldWUgPSAkcm9vdFNjb3BlLiQkcG9zdERpZ2VzdFF1ZXVlID0gW107XG4gICAgdmFyIGFwcGx5QXN5bmNRdWV1ZSA9ICRyb290U2NvcGUuJCRhcHBseUFzeW5jUXVldWUgPSBbXTtcblxuICAgIHJldHVybiAkcm9vdFNjb3BlO1xuXG5cbiAgICBmdW5jdGlvbiBiZWdpblBoYXNlKHBoYXNlKSB7XG4gICAgICBpZiAoJHJvb3RTY29wZS4kJHBoYXNlKSB7XG4gICAgICAgIHRocm93ICRyb290U2NvcGVNaW5FcnIoJ2lucHJvZycsICd7MH0gYWxyZWFkeSBpbiBwcm9ncmVzcycsICRyb290U2NvcGUuJCRwaGFzZSk7XG4gICAgICB9XG5cbiAgICAgICRyb290U2NvcGUuJCRwaGFzZSA9IHBoYXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFyUGhhc2UoKSB7XG4gICAgICAkcm9vdFNjb3BlLiQkcGhhc2UgPSBudWxsO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluY3JlbWVudFdhdGNoZXJzQ291bnQoY3VycmVudCwgY291bnQpIHtcbiAgICAgIGRvIHtcbiAgICAgICAgY3VycmVudC4kJHdhdGNoZXJzQ291bnQgKz0gY291bnQ7XG4gICAgICB9IHdoaWxlICgoY3VycmVudCA9IGN1cnJlbnQuJHBhcmVudCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlY3JlbWVudExpc3RlbmVyQ291bnQoY3VycmVudCwgY291bnQsIG5hbWUpIHtcbiAgICAgIGRvIHtcbiAgICAgICAgY3VycmVudC4kJGxpc3RlbmVyQ291bnRbbmFtZV0gLT0gY291bnQ7XG5cbiAgICAgICAgaWYgKGN1cnJlbnQuJCRsaXN0ZW5lckNvdW50W25hbWVdID09PSAwKSB7XG4gICAgICAgICAgZGVsZXRlIGN1cnJlbnQuJCRsaXN0ZW5lckNvdW50W25hbWVdO1xuICAgICAgICB9XG4gICAgICB9IHdoaWxlICgoY3VycmVudCA9IGN1cnJlbnQuJHBhcmVudCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGZ1bmN0aW9uIHVzZWQgYXMgYW4gaW5pdGlhbCB2YWx1ZSBmb3Igd2F0Y2hlcnMuXG4gICAgICogYmVjYXVzZSBpdCdzIHVuaXF1ZSB3ZSBjYW4gZWFzaWx5IHRlbGwgaXQgYXBhcnQgZnJvbSBvdGhlciB2YWx1ZXNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpbml0V2F0Y2hWYWwoKSB7fVxuXG4gICAgZnVuY3Rpb24gZmx1c2hBcHBseUFzeW5jKCkge1xuICAgICAgd2hpbGUgKGFwcGx5QXN5bmNRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhcHBseUFzeW5jUXVldWUuc2hpZnQoKSgpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgJGV4Y2VwdGlvbkhhbmRsZXIoZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGFwcGx5QXN5bmNJZCA9IG51bGw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2NoZWR1bGVBcHBseUFzeW5jKCkge1xuICAgICAgaWYgKGFwcGx5QXN5bmNJZCA9PT0gbnVsbCkge1xuICAgICAgICBhcHBseUFzeW5jSWQgPSAkYnJvd3Nlci5kZWZlcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAkcm9vdFNjb3BlLiRhcHBseShmbHVzaEFwcGx5QXN5bmMpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1dO1xufVxuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkcm9vdEVsZW1lbnRcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSByb290IGVsZW1lbnQgb2YgQW5ndWxhciBhcHBsaWNhdGlvbi4gVGhpcyBpcyBlaXRoZXIgdGhlIGVsZW1lbnQgd2hlcmUge0BsaW5rXG4gKiBuZy5kaXJlY3RpdmU6bmdBcHAgbmdBcHB9IHdhcyBkZWNsYXJlZCBvciB0aGUgZWxlbWVudCBwYXNzZWQgaW50b1xuICoge0BsaW5rIGFuZ3VsYXIuYm9vdHN0cmFwfS4gVGhlIGVsZW1lbnQgcmVwcmVzZW50cyB0aGUgcm9vdCBlbGVtZW50IG9mIGFwcGxpY2F0aW9uLiBJdCBpcyBhbHNvIHRoZVxuICogbG9jYXRpb24gd2hlcmUgdGhlIGFwcGxpY2F0aW9uJ3Mge0BsaW5rIGF1dG8uJGluamVjdG9yICRpbmplY3Rvcn0gc2VydmljZSBnZXRzXG4gKiBwdWJsaXNoZWQsIGFuZCBjYW4gYmUgcmV0cmlldmVkIHVzaW5nIGAkcm9vdEVsZW1lbnQuaW5qZWN0b3IoKWAuXG4gKi9cblxuXG4vLyB0aGUgaW1wbGVtZW50YXRpb24gaXMgaW4gYW5ndWxhci5ib290c3RyYXBcblxuLyoqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFByaXZhdGUgc2VydmljZSB0byBzYW5pdGl6ZSB1cmlzIGZvciBsaW5rcyBhbmQgaW1hZ2VzLiBVc2VkIGJ5ICRjb21waWxlIGFuZCAkc2FuaXRpemUuXG4gKi9cbmZ1bmN0aW9uICQkU2FuaXRpemVVcmlQcm92aWRlcigpIHtcbiAgdmFyIGFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0ID0gL15cXHMqKGh0dHBzP3xmdHB8bWFpbHRvfHRlbHxmaWxlKTovLFxuICAgIGltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdCA9IC9eXFxzKigoaHR0cHM/fGZ0cHxmaWxlfGJsb2IpOnxkYXRhOmltYWdlXFwvKS87XG5cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBSZXRyaWV2ZXMgb3Igb3ZlcnJpZGVzIHRoZSBkZWZhdWx0IHJlZ3VsYXIgZXhwcmVzc2lvbiB0aGF0IGlzIHVzZWQgZm9yIHdoaXRlbGlzdGluZyBvZiBzYWZlXG4gICAqIHVybHMgZHVyaW5nIGFbaHJlZl0gc2FuaXRpemF0aW9uLlxuICAgKlxuICAgKiBUaGUgc2FuaXRpemF0aW9uIGlzIGEgc2VjdXJpdHkgbWVhc3VyZSBhaW1lZCBhdCBwcmV2ZW50IFhTUyBhdHRhY2tzIHZpYSBodG1sIGxpbmtzLlxuICAgKlxuICAgKiBBbnkgdXJsIGFib3V0IHRvIGJlIGFzc2lnbmVkIHRvIGFbaHJlZl0gdmlhIGRhdGEtYmluZGluZyBpcyBmaXJzdCBub3JtYWxpemVkIGFuZCB0dXJuZWQgaW50b1xuICAgKiBhbiBhYnNvbHV0ZSB1cmwuIEFmdGVyd2FyZHMsIHRoZSB1cmwgaXMgbWF0Y2hlZCBhZ2FpbnN0IHRoZSBgYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3RgXG4gICAqIHJlZ3VsYXIgZXhwcmVzc2lvbi4gSWYgYSBtYXRjaCBpcyBmb3VuZCwgdGhlIG9yaWdpbmFsIHVybCBpcyB3cml0dGVuIGludG8gdGhlIGRvbS4gT3RoZXJ3aXNlLFxuICAgKiB0aGUgYWJzb2x1dGUgdXJsIGlzIHByZWZpeGVkIHdpdGggYCd1bnNhZmU6J2Agc3RyaW5nIGFuZCBvbmx5IHRoZW4gaXMgaXQgd3JpdHRlbiBpbnRvIHRoZSBET00uXG4gICAqXG4gICAqIEBwYXJhbSB7UmVnRXhwPX0gcmVnZXhwIE5ldyByZWdleHAgdG8gd2hpdGVsaXN0IHVybHMgd2l0aC5cbiAgICogQHJldHVybnMge1JlZ0V4cHxuZy4kY29tcGlsZVByb3ZpZGVyfSBDdXJyZW50IFJlZ0V4cCBpZiBjYWxsZWQgd2l0aG91dCB2YWx1ZSBvciBzZWxmIGZvclxuICAgKiAgICBjaGFpbmluZyBvdGhlcndpc2UuXG4gICAqL1xuICB0aGlzLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0ID0gZnVuY3Rpb24ocmVnZXhwKSB7XG4gICAgaWYgKGlzRGVmaW5lZChyZWdleHApKSB7XG4gICAgICBhSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdCA9IHJlZ2V4cDtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3Q7XG4gIH07XG5cblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFJldHJpZXZlcyBvciBvdmVycmlkZXMgdGhlIGRlZmF1bHQgcmVndWxhciBleHByZXNzaW9uIHRoYXQgaXMgdXNlZCBmb3Igd2hpdGVsaXN0aW5nIG9mIHNhZmVcbiAgICogdXJscyBkdXJpbmcgaW1nW3NyY10gc2FuaXRpemF0aW9uLlxuICAgKlxuICAgKiBUaGUgc2FuaXRpemF0aW9uIGlzIGEgc2VjdXJpdHkgbWVhc3VyZSBhaW1lZCBhdCBwcmV2ZW50IFhTUyBhdHRhY2tzIHZpYSBodG1sIGxpbmtzLlxuICAgKlxuICAgKiBBbnkgdXJsIGFib3V0IHRvIGJlIGFzc2lnbmVkIHRvIGltZ1tzcmNdIHZpYSBkYXRhLWJpbmRpbmcgaXMgZmlyc3Qgbm9ybWFsaXplZCBhbmQgdHVybmVkIGludG9cbiAgICogYW4gYWJzb2x1dGUgdXJsLiBBZnRlcndhcmRzLCB0aGUgdXJsIGlzIG1hdGNoZWQgYWdhaW5zdCB0aGUgYGltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdGBcbiAgICogcmVndWxhciBleHByZXNzaW9uLiBJZiBhIG1hdGNoIGlzIGZvdW5kLCB0aGUgb3JpZ2luYWwgdXJsIGlzIHdyaXR0ZW4gaW50byB0aGUgZG9tLiBPdGhlcndpc2UsXG4gICAqIHRoZSBhYnNvbHV0ZSB1cmwgaXMgcHJlZml4ZWQgd2l0aCBgJ3Vuc2FmZTonYCBzdHJpbmcgYW5kIG9ubHkgdGhlbiBpcyBpdCB3cml0dGVuIGludG8gdGhlIERPTS5cbiAgICpcbiAgICogQHBhcmFtIHtSZWdFeHA9fSByZWdleHAgTmV3IHJlZ2V4cCB0byB3aGl0ZWxpc3QgdXJscyB3aXRoLlxuICAgKiBAcmV0dXJucyB7UmVnRXhwfG5nLiRjb21waWxlUHJvdmlkZXJ9IEN1cnJlbnQgUmVnRXhwIGlmIGNhbGxlZCB3aXRob3V0IHZhbHVlIG9yIHNlbGYgZm9yXG4gICAqICAgIGNoYWluaW5nIG90aGVyd2lzZS5cbiAgICovXG4gIHRoaXMuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0ID0gZnVuY3Rpb24ocmVnZXhwKSB7XG4gICAgaWYgKGlzRGVmaW5lZChyZWdleHApKSB7XG4gICAgICBpbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3QgPSByZWdleHA7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIGltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdDtcbiAgfTtcblxuICB0aGlzLiRnZXQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gc2FuaXRpemVVcmkodXJpLCBpc0ltYWdlKSB7XG4gICAgICB2YXIgcmVnZXggPSBpc0ltYWdlID8gaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0IDogYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3Q7XG4gICAgICB2YXIgbm9ybWFsaXplZFZhbDtcbiAgICAgIG5vcm1hbGl6ZWRWYWwgPSB1cmxSZXNvbHZlKHVyaSkuaHJlZjtcbiAgICAgIGlmIChub3JtYWxpemVkVmFsICE9PSAnJyAmJiAhbm9ybWFsaXplZFZhbC5tYXRjaChyZWdleCkpIHtcbiAgICAgICAgcmV0dXJuICd1bnNhZmU6JyArIG5vcm1hbGl6ZWRWYWw7XG4gICAgICB9XG4gICAgICByZXR1cm4gdXJpO1xuICAgIH07XG4gIH07XG59XG5cbi8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICpcbiAqICAgICBBbnkgY29tbWl0cyB0byB0aGlzIGZpbGUgc2hvdWxkIGJlIHJldmlld2VkIHdpdGggc2VjdXJpdHkgaW4gbWluZC4gICpcbiAqICAgQ2hhbmdlcyB0byB0aGlzIGZpbGUgY2FuIHBvdGVudGlhbGx5IGNyZWF0ZSBzZWN1cml0eSB2dWxuZXJhYmlsaXRpZXMuICpcbiAqICAgICAgICAgIEFuIGFwcHJvdmFsIGZyb20gMiBDb3JlIG1lbWJlcnMgd2l0aCBoaXN0b3J5IG9mIG1vZGlmeWluZyAgICAgICpcbiAqICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMgZmlsZSBpcyByZXF1aXJlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAqICBEb2VzIHRoZSBjaGFuZ2Ugc29tZWhvdyBhbGxvdyBmb3IgYXJiaXRyYXJ5IGphdmFzY3JpcHQgdG8gYmUgZXhlY3V0ZWQ/ICpcbiAqICAgIE9yIGFsbG93cyBmb3Igc29tZW9uZSB0byBjaGFuZ2UgdGhlIHByb3RvdHlwZSBvZiBidWlsdC1pbiBvYmplY3RzPyAgICpcbiAqICAgICBPciBnaXZlcyB1bmRlc2lyZWQgYWNjZXNzIHRvIHZhcmlhYmxlcyBsaWtlcyBkb2N1bWVudCBvciB3aW5kb3c/ICAgICpcbiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovXG5cbnZhciAkc2NlTWluRXJyID0gbWluRXJyKCckc2NlJyk7XG5cbnZhciBTQ0VfQ09OVEVYVFMgPSB7XG4gIEhUTUw6ICdodG1sJyxcbiAgQ1NTOiAnY3NzJyxcbiAgVVJMOiAndXJsJyxcbiAgLy8gUkVTT1VSQ0VfVVJMIGlzIGEgc3VidHlwZSBvZiBVUkwgdXNlZCBpbiBjb250ZXh0cyB3aGVyZSBhIHByaXZpbGVnZWQgcmVzb3VyY2UgaXMgc291cmNlZCBmcm9tIGFcbiAgLy8gdXJsLiAgKGUuZy4gbmctaW5jbHVkZSwgc2NyaXB0IHNyYywgdGVtcGxhdGVVcmwpXG4gIFJFU09VUkNFX1VSTDogJ3Jlc291cmNlVXJsJyxcbiAgSlM6ICdqcydcbn07XG5cbi8vIEhlbHBlciBmdW5jdGlvbnMgZm9sbG93LlxuXG5mdW5jdGlvbiBhZGp1c3RNYXRjaGVyKG1hdGNoZXIpIHtcbiAgaWYgKG1hdGNoZXIgPT09ICdzZWxmJykge1xuICAgIHJldHVybiBtYXRjaGVyO1xuICB9IGVsc2UgaWYgKGlzU3RyaW5nKG1hdGNoZXIpKSB7XG4gICAgLy8gU3RyaW5ncyBtYXRjaCBleGFjdGx5IGV4Y2VwdCBmb3IgMiB3aWxkY2FyZHMgLSAnKicgYW5kICcqKicuXG4gICAgLy8gJyonIG1hdGNoZXMgYW55IGNoYXJhY3RlciBleGNlcHQgdGhvc2UgZnJvbSB0aGUgc2V0ICc6Ly4/JicuXG4gICAgLy8gJyoqJyBtYXRjaGVzIGFueSBjaGFyYWN0ZXIgKGxpa2UgLiogaW4gYSBSZWdFeHApLlxuICAgIC8vIE1vcmUgdGhhbiAyIConcyByYWlzZXMgYW4gZXJyb3IgYXMgaXQncyBpbGwgZGVmaW5lZC5cbiAgICBpZiAobWF0Y2hlci5pbmRleE9mKCcqKionKSA+IC0xKSB7XG4gICAgICB0aHJvdyAkc2NlTWluRXJyKCdpd2NhcmQnLFxuICAgICAgICAgICdJbGxlZ2FsIHNlcXVlbmNlICoqKiBpbiBzdHJpbmcgbWF0Y2hlci4gIFN0cmluZzogezB9JywgbWF0Y2hlcik7XG4gICAgfVxuICAgIG1hdGNoZXIgPSBlc2NhcGVGb3JSZWdleHAobWF0Y2hlcikuXG4gICAgICAgICAgICAgICAgICByZXBsYWNlKCdcXFxcKlxcXFwqJywgJy4qJykuXG4gICAgICAgICAgICAgICAgICByZXBsYWNlKCdcXFxcKicsICdbXjovLj8mO10qJyk7XG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoJ14nICsgbWF0Y2hlciArICckJyk7XG4gIH0gZWxzZSBpZiAoaXNSZWdFeHAobWF0Y2hlcikpIHtcbiAgICAvLyBUaGUgb25seSBvdGhlciB0eXBlIG9mIG1hdGNoZXIgYWxsb3dlZCBpcyBhIFJlZ2V4cC5cbiAgICAvLyBNYXRjaCBlbnRpcmUgVVJMIC8gZGlzYWxsb3cgcGFydGlhbCBtYXRjaGVzLlxuICAgIC8vIEZsYWdzIGFyZSByZXNldCAoaS5lLiBubyBnbG9iYWwsIGlnbm9yZUNhc2Ugb3IgbXVsdGlsaW5lKVxuICAgIHJldHVybiBuZXcgUmVnRXhwKCdeJyArIG1hdGNoZXIuc291cmNlICsgJyQnKTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyAkc2NlTWluRXJyKCdpbWF0Y2hlcicsXG4gICAgICAgICdNYXRjaGVycyBtYXkgb25seSBiZSBcInNlbGZcIiwgc3RyaW5nIHBhdHRlcm5zIG9yIFJlZ0V4cCBvYmplY3RzJyk7XG4gIH1cbn1cblxuXG5mdW5jdGlvbiBhZGp1c3RNYXRjaGVycyhtYXRjaGVycykge1xuICB2YXIgYWRqdXN0ZWRNYXRjaGVycyA9IFtdO1xuICBpZiAoaXNEZWZpbmVkKG1hdGNoZXJzKSkge1xuICAgIGZvckVhY2gobWF0Y2hlcnMsIGZ1bmN0aW9uKG1hdGNoZXIpIHtcbiAgICAgIGFkanVzdGVkTWF0Y2hlcnMucHVzaChhZGp1c3RNYXRjaGVyKG1hdGNoZXIpKTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gYWRqdXN0ZWRNYXRjaGVycztcbn1cblxuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkc2NlRGVsZWdhdGVcbiAqIEBraW5kIGZ1bmN0aW9uXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogYCRzY2VEZWxlZ2F0ZWAgaXMgYSBzZXJ2aWNlIHRoYXQgaXMgdXNlZCBieSB0aGUgYCRzY2VgIHNlcnZpY2UgdG8gcHJvdmlkZSB7QGxpbmsgbmcuJHNjZSBTdHJpY3RcbiAqIENvbnRleHR1YWwgRXNjYXBpbmcgKFNDRSl9IHNlcnZpY2VzIHRvIEFuZ3VsYXJKUy5cbiAqXG4gKiBUeXBpY2FsbHksIHlvdSB3b3VsZCBjb25maWd1cmUgb3Igb3ZlcnJpZGUgdGhlIHtAbGluayBuZy4kc2NlRGVsZWdhdGUgJHNjZURlbGVnYXRlfSBpbnN0ZWFkIG9mXG4gKiB0aGUgYCRzY2VgIHNlcnZpY2UgdG8gY3VzdG9taXplIHRoZSB3YXkgU3RyaWN0IENvbnRleHR1YWwgRXNjYXBpbmcgd29ya3MgaW4gQW5ndWxhckpTLiAgVGhpcyBpc1xuICogYmVjYXVzZSwgd2hpbGUgdGhlIGAkc2NlYCBwcm92aWRlcyBudW1lcm91cyBzaG9ydGhhbmQgbWV0aG9kcywgZXRjLiwgeW91IHJlYWxseSBvbmx5IG5lZWQgdG9cbiAqIG92ZXJyaWRlIDMgY29yZSBmdW5jdGlvbnMgKGB0cnVzdEFzYCwgYGdldFRydXN0ZWRgIGFuZCBgdmFsdWVPZmApIHRvIHJlcGxhY2UgdGhlIHdheSB0aGluZ3NcbiAqIHdvcmsgYmVjYXVzZSBgJHNjZWAgZGVsZWdhdGVzIHRvIGAkc2NlRGVsZWdhdGVgIGZvciB0aGVzZSBvcGVyYXRpb25zLlxuICpcbiAqIFJlZmVyIHtAbGluayBuZy4kc2NlRGVsZWdhdGVQcm92aWRlciAkc2NlRGVsZWdhdGVQcm92aWRlcn0gdG8gY29uZmlndXJlIHRoaXMgc2VydmljZS5cbiAqXG4gKiBUaGUgZGVmYXVsdCBpbnN0YW5jZSBvZiBgJHNjZURlbGVnYXRlYCBzaG91bGQgd29yayBvdXQgb2YgdGhlIGJveCB3aXRoIGxpdHRsZSBwYWluLiAgV2hpbGUgeW91XG4gKiBjYW4gb3ZlcnJpZGUgaXQgY29tcGxldGVseSB0byBjaGFuZ2UgdGhlIGJlaGF2aW9yIG9mIGAkc2NlYCwgdGhlIGNvbW1vbiBjYXNlIHdvdWxkXG4gKiBpbnZvbHZlIGNvbmZpZ3VyaW5nIHRoZSB7QGxpbmsgbmcuJHNjZURlbGVnYXRlUHJvdmlkZXIgJHNjZURlbGVnYXRlUHJvdmlkZXJ9IGluc3RlYWQgYnkgc2V0dGluZ1xuICogeW91ciBvd24gd2hpdGVsaXN0cyBhbmQgYmxhY2tsaXN0cyBmb3IgdHJ1c3RpbmcgVVJMcyB1c2VkIGZvciBsb2FkaW5nIEFuZ3VsYXJKUyByZXNvdXJjZXMgc3VjaCBhc1xuICogdGVtcGxhdGVzLiAgUmVmZXIge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZVByb3ZpZGVyI3Jlc291cmNlVXJsV2hpdGVsaXN0XG4gKiAkc2NlRGVsZWdhdGVQcm92aWRlci5yZXNvdXJjZVVybFdoaXRlbGlzdH0gYW5kIHtAbGlua1xuICogbmcuJHNjZURlbGVnYXRlUHJvdmlkZXIjcmVzb3VyY2VVcmxCbGFja2xpc3QgJHNjZURlbGVnYXRlUHJvdmlkZXIucmVzb3VyY2VVcmxCbGFja2xpc3R9XG4gKi9cblxuLyoqXG4gKiBAbmdkb2MgcHJvdmlkZXJcbiAqIEBuYW1lICRzY2VEZWxlZ2F0ZVByb3ZpZGVyXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBUaGUgYCRzY2VEZWxlZ2F0ZVByb3ZpZGVyYCBwcm92aWRlciBhbGxvd3MgZGV2ZWxvcGVycyB0byBjb25maWd1cmUgdGhlIHtAbGluayBuZy4kc2NlRGVsZWdhdGVcbiAqICRzY2VEZWxlZ2F0ZX0gc2VydmljZS4gIFRoaXMgYWxsb3dzIG9uZSB0byBnZXQvc2V0IHRoZSB3aGl0ZWxpc3RzIGFuZCBibGFja2xpc3RzIHVzZWQgdG8gZW5zdXJlXG4gKiB0aGF0IHRoZSBVUkxzIHVzZWQgZm9yIHNvdXJjaW5nIEFuZ3VsYXIgdGVtcGxhdGVzIGFyZSBzYWZlLiAgUmVmZXIge0BsaW5rXG4gKiBuZy4kc2NlRGVsZWdhdGVQcm92aWRlciNyZXNvdXJjZVVybFdoaXRlbGlzdCAkc2NlRGVsZWdhdGVQcm92aWRlci5yZXNvdXJjZVVybFdoaXRlbGlzdH0gYW5kXG4gKiB7QGxpbmsgbmcuJHNjZURlbGVnYXRlUHJvdmlkZXIjcmVzb3VyY2VVcmxCbGFja2xpc3QgJHNjZURlbGVnYXRlUHJvdmlkZXIucmVzb3VyY2VVcmxCbGFja2xpc3R9XG4gKlxuICogRm9yIHRoZSBnZW5lcmFsIGRldGFpbHMgYWJvdXQgdGhpcyBzZXJ2aWNlIGluIEFuZ3VsYXIsIHJlYWQgdGhlIG1haW4gcGFnZSBmb3Ige0BsaW5rIG5nLiRzY2VcbiAqIFN0cmljdCBDb250ZXh0dWFsIEVzY2FwaW5nIChTQ0UpfS5cbiAqXG4gKiAqKkV4YW1wbGUqKjogIENvbnNpZGVyIHRoZSBmb2xsb3dpbmcgY2FzZS4gPGEgbmFtZT1cImV4YW1wbGVcIj48L2E+XG4gKlxuICogLSB5b3VyIGFwcCBpcyBob3N0ZWQgYXQgdXJsIGBodHRwOi8vbXlhcHAuZXhhbXBsZS5jb20vYFxuICogLSBidXQgc29tZSBvZiB5b3VyIHRlbXBsYXRlcyBhcmUgaG9zdGVkIG9uIG90aGVyIGRvbWFpbnMgeW91IGNvbnRyb2wgc3VjaCBhc1xuICogICBgaHR0cDovL3NydjAxLmFzc2V0cy5leGFtcGxlLmNvbS9gLMKgIGBodHRwOi8vc3J2MDIuYXNzZXRzLmV4YW1wbGUuY29tL2AsIGV0Yy5cbiAqIC0gYW5kIHlvdSBoYXZlIGFuIG9wZW4gcmVkaXJlY3QgYXQgYGh0dHA6Ly9teWFwcC5leGFtcGxlLmNvbS9jbGlja1RocnU/Li4uYC5cbiAqXG4gKiBIZXJlIGlzIHdoYXQgYSBzZWN1cmUgY29uZmlndXJhdGlvbiBmb3IgdGhpcyBzY2VuYXJpbyBtaWdodCBsb29rIGxpa2U6XG4gKlxuICogYGBgXG4gKiAgYW5ndWxhci5tb2R1bGUoJ215QXBwJywgW10pLmNvbmZpZyhmdW5jdGlvbigkc2NlRGVsZWdhdGVQcm92aWRlcikge1xuICogICAgJHNjZURlbGVnYXRlUHJvdmlkZXIucmVzb3VyY2VVcmxXaGl0ZWxpc3QoW1xuICogICAgICAvLyBBbGxvdyBzYW1lIG9yaWdpbiByZXNvdXJjZSBsb2Fkcy5cbiAqICAgICAgJ3NlbGYnLFxuICogICAgICAvLyBBbGxvdyBsb2FkaW5nIGZyb20gb3VyIGFzc2V0cyBkb21haW4uICBOb3RpY2UgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiAqIGFuZCAqKi5cbiAqICAgICAgJ2h0dHA6Ly9zcnYqLmFzc2V0cy5leGFtcGxlLmNvbS8qKidcbiAqICAgIF0pO1xuICpcbiAqICAgIC8vIFRoZSBibGFja2xpc3Qgb3ZlcnJpZGVzIHRoZSB3aGl0ZWxpc3Qgc28gdGhlIG9wZW4gcmVkaXJlY3QgaGVyZSBpcyBibG9ja2VkLlxuICogICAgJHNjZURlbGVnYXRlUHJvdmlkZXIucmVzb3VyY2VVcmxCbGFja2xpc3QoW1xuICogICAgICAnaHR0cDovL215YXBwLmV4YW1wbGUuY29tL2NsaWNrVGhydSoqJ1xuICogICAgXSk7XG4gKiAgfSk7XG4gKiBgYGBcbiAqL1xuXG5mdW5jdGlvbiAkU2NlRGVsZWdhdGVQcm92aWRlcigpIHtcbiAgdGhpcy5TQ0VfQ09OVEVYVFMgPSBTQ0VfQ09OVEVYVFM7XG5cbiAgLy8gUmVzb3VyY2UgVVJMcyBjYW4gYWxzbyBiZSB0cnVzdGVkIGJ5IHBvbGljeS5cbiAgdmFyIHJlc291cmNlVXJsV2hpdGVsaXN0ID0gWydzZWxmJ10sXG4gICAgICByZXNvdXJjZVVybEJsYWNrbGlzdCA9IFtdO1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRzY2VEZWxlZ2F0ZVByb3ZpZGVyI3Jlc291cmNlVXJsV2hpdGVsaXN0XG4gICAqIEBraW5kIGZ1bmN0aW9uXG4gICAqXG4gICAqIEBwYXJhbSB7QXJyYXk9fSB3aGl0ZWxpc3QgV2hlbiBwcm92aWRlZCwgcmVwbGFjZXMgdGhlIHJlc291cmNlVXJsV2hpdGVsaXN0IHdpdGggdGhlIHZhbHVlXG4gICAqICAgIHByb3ZpZGVkLiAgVGhpcyBtdXN0IGJlIGFuIGFycmF5IG9yIG51bGwuICBBIHNuYXBzaG90IG9mIHRoaXMgYXJyYXkgaXMgdXNlZCBzbyBmdXJ0aGVyXG4gICAqICAgIGNoYW5nZXMgdG8gdGhlIGFycmF5IGFyZSBpZ25vcmVkLlxuICAgKlxuICAgKiAgICBGb2xsb3cge0BsaW5rIG5nLiRzY2UjcmVzb3VyY2VVcmxQYXR0ZXJuSXRlbSB0aGlzIGxpbmt9IGZvciBhIGRlc2NyaXB0aW9uIG9mIHRoZSBpdGVtc1xuICAgKiAgICBhbGxvd2VkIGluIHRoaXMgYXJyYXkuXG4gICAqXG4gICAqICAgIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG4gICAqICAgICoqTm90ZToqKiBhbiBlbXB0eSB3aGl0ZWxpc3QgYXJyYXkgd2lsbCBibG9jayBhbGwgVVJMcyFcbiAgICogICAgPC9kaXY+XG4gICAqXG4gICAqIEByZXR1cm4ge0FycmF5fSB0aGUgY3VycmVudGx5IHNldCB3aGl0ZWxpc3QgYXJyYXkuXG4gICAqXG4gICAqIFRoZSAqKmRlZmF1bHQgdmFsdWUqKiB3aGVuIG5vIHdoaXRlbGlzdCBoYXMgYmVlbiBleHBsaWNpdGx5IHNldCBpcyBgWydzZWxmJ11gIGFsbG93aW5nIG9ubHlcbiAgICogc2FtZSBvcmlnaW4gcmVzb3VyY2UgcmVxdWVzdHMuXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBTZXRzL0dldHMgdGhlIHdoaXRlbGlzdCBvZiB0cnVzdGVkIHJlc291cmNlIFVSTHMuXG4gICAqL1xuICB0aGlzLnJlc291cmNlVXJsV2hpdGVsaXN0ID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgcmVzb3VyY2VVcmxXaGl0ZWxpc3QgPSBhZGp1c3RNYXRjaGVycyh2YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiByZXNvdXJjZVVybFdoaXRlbGlzdDtcbiAgfTtcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkc2NlRGVsZWdhdGVQcm92aWRlciNyZXNvdXJjZVVybEJsYWNrbGlzdFxuICAgKiBAa2luZCBmdW5jdGlvblxuICAgKlxuICAgKiBAcGFyYW0ge0FycmF5PX0gYmxhY2tsaXN0IFdoZW4gcHJvdmlkZWQsIHJlcGxhY2VzIHRoZSByZXNvdXJjZVVybEJsYWNrbGlzdCB3aXRoIHRoZSB2YWx1ZVxuICAgKiAgICBwcm92aWRlZC4gIFRoaXMgbXVzdCBiZSBhbiBhcnJheSBvciBudWxsLiAgQSBzbmFwc2hvdCBvZiB0aGlzIGFycmF5IGlzIHVzZWQgc28gZnVydGhlclxuICAgKiAgICBjaGFuZ2VzIHRvIHRoZSBhcnJheSBhcmUgaWdub3JlZC5cbiAgICpcbiAgICogICAgRm9sbG93IHtAbGluayBuZy4kc2NlI3Jlc291cmNlVXJsUGF0dGVybkl0ZW0gdGhpcyBsaW5rfSBmb3IgYSBkZXNjcmlwdGlvbiBvZiB0aGUgaXRlbXNcbiAgICogICAgYWxsb3dlZCBpbiB0aGlzIGFycmF5LlxuICAgKlxuICAgKiAgICBUaGUgdHlwaWNhbCB1c2FnZSBmb3IgdGhlIGJsYWNrbGlzdCBpcyB0byAqKmJsb2NrXG4gICAqICAgIFtvcGVuIHJlZGlyZWN0c10oaHR0cDovL2N3ZS5taXRyZS5vcmcvZGF0YS9kZWZpbml0aW9ucy82MDEuaHRtbCkqKiBzZXJ2ZWQgYnkgeW91ciBkb21haW4gYXNcbiAgICogICAgdGhlc2Ugd291bGQgb3RoZXJ3aXNlIGJlIHRydXN0ZWQgYnV0IGFjdHVhbGx5IHJldHVybiBjb250ZW50IGZyb20gdGhlIHJlZGlyZWN0ZWQgZG9tYWluLlxuICAgKlxuICAgKiAgICBGaW5hbGx5LCAqKnRoZSBibGFja2xpc3Qgb3ZlcnJpZGVzIHRoZSB3aGl0ZWxpc3QqKiBhbmQgaGFzIHRoZSBmaW5hbCBzYXkuXG4gICAqXG4gICAqIEByZXR1cm4ge0FycmF5fSB0aGUgY3VycmVudGx5IHNldCBibGFja2xpc3QgYXJyYXkuXG4gICAqXG4gICAqIFRoZSAqKmRlZmF1bHQgdmFsdWUqKiB3aGVuIG5vIHdoaXRlbGlzdCBoYXMgYmVlbiBleHBsaWNpdGx5IHNldCBpcyB0aGUgZW1wdHkgYXJyYXkgKGkuZS4gdGhlcmVcbiAgICogaXMgbm8gYmxhY2tsaXN0LilcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFNldHMvR2V0cyB0aGUgYmxhY2tsaXN0IG9mIHRydXN0ZWQgcmVzb3VyY2UgVVJMcy5cbiAgICovXG5cbiAgdGhpcy5yZXNvdXJjZVVybEJsYWNrbGlzdCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgIHJlc291cmNlVXJsQmxhY2tsaXN0ID0gYWRqdXN0TWF0Y2hlcnModmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzb3VyY2VVcmxCbGFja2xpc3Q7XG4gIH07XG5cbiAgdGhpcy4kZ2V0ID0gWyckaW5qZWN0b3InLCBmdW5jdGlvbigkaW5qZWN0b3IpIHtcblxuICAgIHZhciBodG1sU2FuaXRpemVyID0gZnVuY3Rpb24gaHRtbFNhbml0aXplcihodG1sKSB7XG4gICAgICB0aHJvdyAkc2NlTWluRXJyKCd1bnNhZmUnLCAnQXR0ZW1wdGluZyB0byB1c2UgYW4gdW5zYWZlIHZhbHVlIGluIGEgc2FmZSBjb250ZXh0LicpO1xuICAgIH07XG5cbiAgICBpZiAoJGluamVjdG9yLmhhcygnJHNhbml0aXplJykpIHtcbiAgICAgIGh0bWxTYW5pdGl6ZXIgPSAkaW5qZWN0b3IuZ2V0KCckc2FuaXRpemUnKTtcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIG1hdGNoVXJsKG1hdGNoZXIsIHBhcnNlZFVybCkge1xuICAgICAgaWYgKG1hdGNoZXIgPT09ICdzZWxmJykge1xuICAgICAgICByZXR1cm4gdXJsSXNTYW1lT3JpZ2luKHBhcnNlZFVybCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBkZWZpbml0ZWx5IGEgcmVnZXguICBTZWUgYWRqdXN0TWF0Y2hlcnMoKVxuICAgICAgICByZXR1cm4gISFtYXRjaGVyLmV4ZWMocGFyc2VkVXJsLmhyZWYpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzUmVzb3VyY2VVcmxBbGxvd2VkQnlQb2xpY3kodXJsKSB7XG4gICAgICB2YXIgcGFyc2VkVXJsID0gdXJsUmVzb2x2ZSh1cmwudG9TdHJpbmcoKSk7XG4gICAgICB2YXIgaSwgbiwgYWxsb3dlZCA9IGZhbHNlO1xuICAgICAgLy8gRW5zdXJlIHRoYXQgYXQgbGVhc3Qgb25lIGl0ZW0gZnJvbSB0aGUgd2hpdGVsaXN0IGFsbG93cyB0aGlzIHVybC5cbiAgICAgIGZvciAoaSA9IDAsIG4gPSByZXNvdXJjZVVybFdoaXRlbGlzdC5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgaWYgKG1hdGNoVXJsKHJlc291cmNlVXJsV2hpdGVsaXN0W2ldLCBwYXJzZWRVcmwpKSB7XG4gICAgICAgICAgYWxsb3dlZCA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChhbGxvd2VkKSB7XG4gICAgICAgIC8vIEVuc3VyZSB0aGF0IG5vIGl0ZW0gZnJvbSB0aGUgYmxhY2tsaXN0IGJsb2NrZWQgdGhpcyB1cmwuXG4gICAgICAgIGZvciAoaSA9IDAsIG4gPSByZXNvdXJjZVVybEJsYWNrbGlzdC5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICBpZiAobWF0Y2hVcmwocmVzb3VyY2VVcmxCbGFja2xpc3RbaV0sIHBhcnNlZFVybCkpIHtcbiAgICAgICAgICAgIGFsbG93ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGFsbG93ZWQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2VuZXJhdGVIb2xkZXJUeXBlKEJhc2UpIHtcbiAgICAgIHZhciBob2xkZXJUeXBlID0gZnVuY3Rpb24gVHJ1c3RlZFZhbHVlSG9sZGVyVHlwZSh0cnVzdGVkVmFsdWUpIHtcbiAgICAgICAgdGhpcy4kJHVud3JhcFRydXN0ZWRWYWx1ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0cnVzdGVkVmFsdWU7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgaWYgKEJhc2UpIHtcbiAgICAgICAgaG9sZGVyVHlwZS5wcm90b3R5cGUgPSBuZXcgQmFzZSgpO1xuICAgICAgfVxuICAgICAgaG9sZGVyVHlwZS5wcm90b3R5cGUudmFsdWVPZiA9IGZ1bmN0aW9uIHNjZVZhbHVlT2YoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCk7XG4gICAgICB9O1xuICAgICAgaG9sZGVyVHlwZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiBzY2VUb1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJCR1bndyYXBUcnVzdGVkVmFsdWUoKS50b1N0cmluZygpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBob2xkZXJUeXBlO1xuICAgIH1cblxuICAgIHZhciB0cnVzdGVkVmFsdWVIb2xkZXJCYXNlID0gZ2VuZXJhdGVIb2xkZXJUeXBlKCksXG4gICAgICAgIGJ5VHlwZSA9IHt9O1xuXG4gICAgYnlUeXBlW1NDRV9DT05URVhUUy5IVE1MXSA9IGdlbmVyYXRlSG9sZGVyVHlwZSh0cnVzdGVkVmFsdWVIb2xkZXJCYXNlKTtcbiAgICBieVR5cGVbU0NFX0NPTlRFWFRTLkNTU10gPSBnZW5lcmF0ZUhvbGRlclR5cGUodHJ1c3RlZFZhbHVlSG9sZGVyQmFzZSk7XG4gICAgYnlUeXBlW1NDRV9DT05URVhUUy5VUkxdID0gZ2VuZXJhdGVIb2xkZXJUeXBlKHRydXN0ZWRWYWx1ZUhvbGRlckJhc2UpO1xuICAgIGJ5VHlwZVtTQ0VfQ09OVEVYVFMuSlNdID0gZ2VuZXJhdGVIb2xkZXJUeXBlKHRydXN0ZWRWYWx1ZUhvbGRlckJhc2UpO1xuICAgIGJ5VHlwZVtTQ0VfQ09OVEVYVFMuUkVTT1VSQ0VfVVJMXSA9IGdlbmVyYXRlSG9sZGVyVHlwZShieVR5cGVbU0NFX0NPTlRFWFRTLlVSTF0pO1xuXG4gICAgLyoqXG4gICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAqIEBuYW1lICRzY2VEZWxlZ2F0ZSN0cnVzdEFzXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBSZXR1cm5zIGFuIG9iamVjdCB0aGF0IGlzIHRydXN0ZWQgYnkgYW5ndWxhciBmb3IgdXNlIGluIHNwZWNpZmllZCBzdHJpY3RcbiAgICAgKiBjb250ZXh0dWFsIGVzY2FwaW5nIGNvbnRleHRzIChzdWNoIGFzIG5nLWJpbmQtaHRtbCwgbmctaW5jbHVkZSwgYW55IHNyY1xuICAgICAqIGF0dHJpYnV0ZSBpbnRlcnBvbGF0aW9uLCBhbnkgZG9tIGV2ZW50IGJpbmRpbmcgYXR0cmlidXRlIGludGVycG9sYXRpb25cbiAgICAgKiBzdWNoIGFzIGZvciBvbmNsaWNrLCAgZXRjLikgdGhhdCB1c2VzIHRoZSBwcm92aWRlZCB2YWx1ZS5cbiAgICAgKiBTZWUge0BsaW5rIG5nLiRzY2UgJHNjZX0gZm9yIGVuYWJsaW5nIHN0cmljdCBjb250ZXh0dWFsIGVzY2FwaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVGhlIGtpbmQgb2YgY29udGV4dCBpbiB3aGljaCB0aGlzIHZhbHVlIGlzIHNhZmUgZm9yIHVzZS4gIGUuZy4gdXJsLFxuICAgICAqICAgcmVzb3VyY2VVcmwsIGh0bWwsIGpzIGFuZCBjc3MuXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdGhhdCB0aGF0IHNob3VsZCBiZSBjb25zaWRlcmVkIHRydXN0ZWQvc2FmZS5cbiAgICAgKiBAcmV0dXJucyB7Kn0gQSB2YWx1ZSB0aGF0IGNhbiBiZSB1c2VkIHRvIHN0YW5kIGluIGZvciB0aGUgcHJvdmlkZWQgYHZhbHVlYCBpbiBwbGFjZXNcbiAgICAgKiB3aGVyZSBBbmd1bGFyIGV4cGVjdHMgYSAkc2NlLnRydXN0QXMoKSByZXR1cm4gdmFsdWUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gdHJ1c3RBcyh0eXBlLCB0cnVzdGVkVmFsdWUpIHtcbiAgICAgIHZhciBDb25zdHJ1Y3RvciA9IChieVR5cGUuaGFzT3duUHJvcGVydHkodHlwZSkgPyBieVR5cGVbdHlwZV0gOiBudWxsKTtcbiAgICAgIGlmICghQ29uc3RydWN0b3IpIHtcbiAgICAgICAgdGhyb3cgJHNjZU1pbkVycignaWNvbnRleHQnLFxuICAgICAgICAgICAgJ0F0dGVtcHRlZCB0byB0cnVzdCBhIHZhbHVlIGluIGludmFsaWQgY29udGV4dC4gQ29udGV4dDogezB9OyBWYWx1ZTogezF9JyxcbiAgICAgICAgICAgIHR5cGUsIHRydXN0ZWRWYWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAodHJ1c3RlZFZhbHVlID09PSBudWxsIHx8IGlzVW5kZWZpbmVkKHRydXN0ZWRWYWx1ZSkgfHwgdHJ1c3RlZFZhbHVlID09PSAnJykge1xuICAgICAgICByZXR1cm4gdHJ1c3RlZFZhbHVlO1xuICAgICAgfVxuICAgICAgLy8gQWxsIHRoZSBjdXJyZW50IGNvbnRleHRzIGluIFNDRV9DT05URVhUUyBoYXBwZW4gdG8gYmUgc3RyaW5ncy4gIEluIG9yZGVyIHRvIGF2b2lkIHRydXN0aW5nXG4gICAgICAvLyBtdXRhYmxlIG9iamVjdHMsIHdlIGVuc3VyZSBoZXJlIHRoYXQgdGhlIHZhbHVlIHBhc3NlZCBpbiBpcyBhY3R1YWxseSBhIHN0cmluZy5cbiAgICAgIGlmICh0eXBlb2YgdHJ1c3RlZFZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyAkc2NlTWluRXJyKCdpdHlwZScsXG4gICAgICAgICAgICAnQXR0ZW1wdGVkIHRvIHRydXN0IGEgbm9uLXN0cmluZyB2YWx1ZSBpbiBhIGNvbnRlbnQgcmVxdWlyaW5nIGEgc3RyaW5nOiBDb250ZXh0OiB7MH0nLFxuICAgICAgICAgICAgdHlwZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRydXN0ZWRWYWx1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAqIEBuYW1lICRzY2VEZWxlZ2F0ZSN2YWx1ZU9mXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBJZiB0aGUgcGFzc2VkIHBhcmFtZXRlciBoYWQgYmVlbiByZXR1cm5lZCBieSBhIHByaW9yIGNhbGwgdG8ge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZSN0cnVzdEFzXG4gICAgICogYCRzY2VEZWxlZ2F0ZS50cnVzdEFzYH0sIHJldHVybnMgdGhlIHZhbHVlIHRoYXQgaGFkIGJlZW4gcGFzc2VkIHRvIHtAbGlua1xuICAgICAqIG5nLiRzY2VEZWxlZ2F0ZSN0cnVzdEFzIGAkc2NlRGVsZWdhdGUudHJ1c3RBc2B9LlxuICAgICAqXG4gICAgICogSWYgdGhlIHBhc3NlZCBwYXJhbWV0ZXIgaXMgbm90IGEgdmFsdWUgdGhhdCBoYWQgYmVlbiByZXR1cm5lZCBieSB7QGxpbmtcbiAgICAgKiBuZy4kc2NlRGVsZWdhdGUjdHJ1c3RBcyBgJHNjZURlbGVnYXRlLnRydXN0QXNgfSwgcmV0dXJucyBpdCBhcy1pcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHJlc3VsdCBvZiBhIHByaW9yIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjdHJ1c3RBcyBgJHNjZURlbGVnYXRlLnRydXN0QXNgfVxuICAgICAqICAgICAgY2FsbCBvciBhbnl0aGluZyBlbHNlLlxuICAgICAqIEByZXR1cm5zIHsqfSBUaGUgYHZhbHVlYCB0aGF0IHdhcyBvcmlnaW5hbGx5IHByb3ZpZGVkIHRvIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjdHJ1c3RBc1xuICAgICAqICAgICBgJHNjZURlbGVnYXRlLnRydXN0QXNgfSBpZiBgdmFsdWVgIGlzIHRoZSByZXN1bHQgb2Ygc3VjaCBhIGNhbGwuICBPdGhlcndpc2UsIHJldHVybnNcbiAgICAgKiAgICAgYHZhbHVlYCB1bmNoYW5nZWQuXG4gICAgICovXG4gICAgZnVuY3Rpb24gdmFsdWVPZihtYXliZVRydXN0ZWQpIHtcbiAgICAgIGlmIChtYXliZVRydXN0ZWQgaW5zdGFuY2VvZiB0cnVzdGVkVmFsdWVIb2xkZXJCYXNlKSB7XG4gICAgICAgIHJldHVybiBtYXliZVRydXN0ZWQuJCR1bndyYXBUcnVzdGVkVmFsdWUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBtYXliZVRydXN0ZWQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAqIEBuYW1lICRzY2VEZWxlZ2F0ZSNnZXRUcnVzdGVkXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBUYWtlcyB0aGUgcmVzdWx0IG9mIGEge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZSN0cnVzdEFzIGAkc2NlRGVsZWdhdGUudHJ1c3RBc2B9IGNhbGwgYW5kXG4gICAgICogcmV0dXJucyB0aGUgb3JpZ2luYWxseSBzdXBwbGllZCB2YWx1ZSBpZiB0aGUgcXVlcmllZCBjb250ZXh0IHR5cGUgaXMgYSBzdXBlcnR5cGUgb2YgdGhlXG4gICAgICogY3JlYXRlZCB0eXBlLiAgSWYgdGhpcyBjb25kaXRpb24gaXNuJ3Qgc2F0aXNmaWVkLCB0aHJvd3MgYW4gZXhjZXB0aW9uLlxuICAgICAqXG4gICAgICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWRhbmdlclwiPlxuICAgICAqIERpc2FibGluZyBhdXRvLWVzY2FwaW5nIGlzIGV4dHJlbWVseSBkYW5nZXJvdXMsIGl0IHVzdWFsbHkgY3JlYXRlcyBhIENyb3NzIFNpdGUgU2NyaXB0aW5nXG4gICAgICogKFhTUykgdnVsbmVyYWJpbGl0eSBpbiB5b3VyIGFwcGxpY2F0aW9uLlxuICAgICAqIDwvZGl2PlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVGhlIGtpbmQgb2YgY29udGV4dCBpbiB3aGljaCB0aGlzIHZhbHVlIGlzIHRvIGJlIHVzZWQuXG4gICAgICogQHBhcmFtIHsqfSBtYXliZVRydXN0ZWQgVGhlIHJlc3VsdCBvZiBhIHByaW9yIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjdHJ1c3RBc1xuICAgICAqICAgICBgJHNjZURlbGVnYXRlLnRydXN0QXNgfSBjYWxsLlxuICAgICAqIEByZXR1cm5zIHsqfSBUaGUgdmFsdWUgdGhlIHdhcyBvcmlnaW5hbGx5IHByb3ZpZGVkIHRvIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjdHJ1c3RBc1xuICAgICAqICAgICBgJHNjZURlbGVnYXRlLnRydXN0QXNgfSBpZiB2YWxpZCBpbiB0aGlzIGNvbnRleHQuICBPdGhlcndpc2UsIHRocm93cyBhbiBleGNlcHRpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0VHJ1c3RlZCh0eXBlLCBtYXliZVRydXN0ZWQpIHtcbiAgICAgIGlmIChtYXliZVRydXN0ZWQgPT09IG51bGwgfHwgaXNVbmRlZmluZWQobWF5YmVUcnVzdGVkKSB8fCBtYXliZVRydXN0ZWQgPT09ICcnKSB7XG4gICAgICAgIHJldHVybiBtYXliZVRydXN0ZWQ7XG4gICAgICB9XG4gICAgICB2YXIgY29uc3RydWN0b3IgPSAoYnlUeXBlLmhhc093blByb3BlcnR5KHR5cGUpID8gYnlUeXBlW3R5cGVdIDogbnVsbCk7XG4gICAgICBpZiAoY29uc3RydWN0b3IgJiYgbWF5YmVUcnVzdGVkIGluc3RhbmNlb2YgY29uc3RydWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIG1heWJlVHJ1c3RlZC4kJHVud3JhcFRydXN0ZWRWYWx1ZSgpO1xuICAgICAgfVxuICAgICAgLy8gSWYgd2UgZ2V0IGhlcmUsIHRoZW4gd2UgbWF5IG9ubHkgdGFrZSBvbmUgb2YgdHdvIGFjdGlvbnMuXG4gICAgICAvLyAxLiBzYW5pdGl6ZSB0aGUgdmFsdWUgZm9yIHRoZSByZXF1ZXN0ZWQgdHlwZSwgb3JcbiAgICAgIC8vIDIuIHRocm93IGFuIGV4Y2VwdGlvbi5cbiAgICAgIGlmICh0eXBlID09PSBTQ0VfQ09OVEVYVFMuUkVTT1VSQ0VfVVJMKSB7XG4gICAgICAgIGlmIChpc1Jlc291cmNlVXJsQWxsb3dlZEJ5UG9saWN5KG1heWJlVHJ1c3RlZCkpIHtcbiAgICAgICAgICByZXR1cm4gbWF5YmVUcnVzdGVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93ICRzY2VNaW5FcnIoJ2luc2VjdXJsJyxcbiAgICAgICAgICAgICAgJ0Jsb2NrZWQgbG9hZGluZyByZXNvdXJjZSBmcm9tIHVybCBub3QgYWxsb3dlZCBieSAkc2NlRGVsZWdhdGUgcG9saWN5LiAgVVJMOiB7MH0nLFxuICAgICAgICAgICAgICBtYXliZVRydXN0ZWQudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gU0NFX0NPTlRFWFRTLkhUTUwpIHtcbiAgICAgICAgcmV0dXJuIGh0bWxTYW5pdGl6ZXIobWF5YmVUcnVzdGVkKTtcbiAgICAgIH1cbiAgICAgIHRocm93ICRzY2VNaW5FcnIoJ3Vuc2FmZScsICdBdHRlbXB0aW5nIHRvIHVzZSBhbiB1bnNhZmUgdmFsdWUgaW4gYSBzYWZlIGNvbnRleHQuJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgdHJ1c3RBczogdHJ1c3RBcyxcbiAgICAgICAgICAgICBnZXRUcnVzdGVkOiBnZXRUcnVzdGVkLFxuICAgICAgICAgICAgIHZhbHVlT2Y6IHZhbHVlT2YgfTtcbiAgfV07XG59XG5cblxuLyoqXG4gKiBAbmdkb2MgcHJvdmlkZXJcbiAqIEBuYW1lICRzY2VQcm92aWRlclxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogVGhlICRzY2VQcm92aWRlciBwcm92aWRlciBhbGxvd3MgZGV2ZWxvcGVycyB0byBjb25maWd1cmUgdGhlIHtAbGluayBuZy4kc2NlICRzY2V9IHNlcnZpY2UuXG4gKiAtICAgZW5hYmxlL2Rpc2FibGUgU3RyaWN0IENvbnRleHR1YWwgRXNjYXBpbmcgKFNDRSkgaW4gYSBtb2R1bGVcbiAqIC0gICBvdmVycmlkZSB0aGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB3aXRoIGEgY3VzdG9tIGRlbGVnYXRlXG4gKlxuICogUmVhZCBtb3JlIGFib3V0IHtAbGluayBuZy4kc2NlIFN0cmljdCBDb250ZXh0dWFsIEVzY2FwaW5nIChTQ0UpfS5cbiAqL1xuXG4vKiBqc2hpbnQgbWF4bGVuOiBmYWxzZSovXG5cbi8qKlxuICogQG5nZG9jIHNlcnZpY2VcbiAqIEBuYW1lICRzY2VcbiAqIEBraW5kIGZ1bmN0aW9uXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogYCRzY2VgIGlzIGEgc2VydmljZSB0aGF0IHByb3ZpZGVzIFN0cmljdCBDb250ZXh0dWFsIEVzY2FwaW5nIHNlcnZpY2VzIHRvIEFuZ3VsYXJKUy5cbiAqXG4gKiAjIFN0cmljdCBDb250ZXh0dWFsIEVzY2FwaW5nXG4gKlxuICogU3RyaWN0IENvbnRleHR1YWwgRXNjYXBpbmcgKFNDRSkgaXMgYSBtb2RlIGluIHdoaWNoIEFuZ3VsYXJKUyByZXF1aXJlcyBiaW5kaW5ncyBpbiBjZXJ0YWluXG4gKiBjb250ZXh0cyB0byByZXN1bHQgaW4gYSB2YWx1ZSB0aGF0IGlzIG1hcmtlZCBhcyBzYWZlIHRvIHVzZSBmb3IgdGhhdCBjb250ZXh0LiAgT25lIGV4YW1wbGUgb2ZcbiAqIHN1Y2ggYSBjb250ZXh0IGlzIGJpbmRpbmcgYXJiaXRyYXJ5IGh0bWwgY29udHJvbGxlZCBieSB0aGUgdXNlciB2aWEgYG5nLWJpbmQtaHRtbGAuICBXZSByZWZlclxuICogdG8gdGhlc2UgY29udGV4dHMgYXMgcHJpdmlsZWdlZCBvciBTQ0UgY29udGV4dHMuXG4gKlxuICogQXMgb2YgdmVyc2lvbiAxLjIsIEFuZ3VsYXIgc2hpcHMgd2l0aCBTQ0UgZW5hYmxlZCBieSBkZWZhdWx0LlxuICpcbiAqIE5vdGU6ICBXaGVuIGVuYWJsZWQgKHRoZSBkZWZhdWx0KSwgSUU8MTEgaW4gcXVpcmtzIG1vZGUgaXMgbm90IHN1cHBvcnRlZC4gIEluIHRoaXMgbW9kZSwgSUU8MTEgYWxsb3dcbiAqIG9uZSB0byBleGVjdXRlIGFyYml0cmFyeSBqYXZhc2NyaXB0IGJ5IHRoZSB1c2Ugb2YgdGhlIGV4cHJlc3Npb24oKSBzeW50YXguICBSZWZlclxuICogPGh0dHA6Ly9ibG9ncy5tc2RuLmNvbS9iL2llL2FyY2hpdmUvMjAwOC8xMC8xNi9lbmRpbmctZXhwcmVzc2lvbnMuYXNweD4gdG8gbGVhcm4gbW9yZSBhYm91dCB0aGVtLlxuICogWW91IGNhbiBlbnN1cmUgeW91ciBkb2N1bWVudCBpcyBpbiBzdGFuZGFyZHMgbW9kZSBhbmQgbm90IHF1aXJrcyBtb2RlIGJ5IGFkZGluZyBgPCFkb2N0eXBlIGh0bWw+YFxuICogdG8gdGhlIHRvcCBvZiB5b3VyIEhUTUwgZG9jdW1lbnQuXG4gKlxuICogU0NFIGFzc2lzdHMgaW4gd3JpdGluZyBjb2RlIGluIHdheSB0aGF0IChhKSBpcyBzZWN1cmUgYnkgZGVmYXVsdCBhbmQgKGIpIG1ha2VzIGF1ZGl0aW5nIGZvclxuICogc2VjdXJpdHkgdnVsbmVyYWJpbGl0aWVzIHN1Y2ggYXMgWFNTLCBjbGlja2phY2tpbmcsIGV0Yy4gYSBsb3QgZWFzaWVyLlxuICpcbiAqIEhlcmUncyBhbiBleGFtcGxlIG9mIGEgYmluZGluZyBpbiBhIHByaXZpbGVnZWQgY29udGV4dDpcbiAqXG4gKiBgYGBcbiAqIDxpbnB1dCBuZy1tb2RlbD1cInVzZXJIdG1sXCIgYXJpYS1sYWJlbD1cIlVzZXIgaW5wdXRcIj5cbiAqIDxkaXYgbmctYmluZC1odG1sPVwidXNlckh0bWxcIj48L2Rpdj5cbiAqIGBgYFxuICpcbiAqIE5vdGljZSB0aGF0IGBuZy1iaW5kLWh0bWxgIGlzIGJvdW5kIHRvIGB1c2VySHRtbGAgY29udHJvbGxlZCBieSB0aGUgdXNlci4gIFdpdGggU0NFXG4gKiBkaXNhYmxlZCwgdGhpcyBhcHBsaWNhdGlvbiBhbGxvd3MgdGhlIHVzZXIgdG8gcmVuZGVyIGFyYml0cmFyeSBIVE1MIGludG8gdGhlIERJVi5cbiAqIEluIGEgbW9yZSByZWFsaXN0aWMgZXhhbXBsZSwgb25lIG1heSBiZSByZW5kZXJpbmcgdXNlciBjb21tZW50cywgYmxvZyBhcnRpY2xlcywgZXRjLiB2aWFcbiAqIGJpbmRpbmdzLiAgKEhUTUwgaXMganVzdCBvbmUgZXhhbXBsZSBvZiBhIGNvbnRleHQgd2hlcmUgcmVuZGVyaW5nIHVzZXIgY29udHJvbGxlZCBpbnB1dCBjcmVhdGVzXG4gKiBzZWN1cml0eSB2dWxuZXJhYmlsaXRpZXMuKVxuICpcbiAqIEZvciB0aGUgY2FzZSBvZiBIVE1MLCB5b3UgbWlnaHQgdXNlIGEgbGlicmFyeSwgZWl0aGVyIG9uIHRoZSBjbGllbnQgc2lkZSwgb3Igb24gdGhlIHNlcnZlciBzaWRlLFxuICogdG8gc2FuaXRpemUgdW5zYWZlIEhUTUwgYmVmb3JlIGJpbmRpbmcgdG8gdGhlIHZhbHVlIGFuZCByZW5kZXJpbmcgaXQgaW4gdGhlIGRvY3VtZW50LlxuICpcbiAqIEhvdyB3b3VsZCB5b3UgZW5zdXJlIHRoYXQgZXZlcnkgcGxhY2UgdGhhdCB1c2VkIHRoZXNlIHR5cGVzIG9mIGJpbmRpbmdzIHdhcyBib3VuZCB0byBhIHZhbHVlIHRoYXRcbiAqIHdhcyBzYW5pdGl6ZWQgYnkgeW91ciBsaWJyYXJ5IChvciByZXR1cm5lZCBhcyBzYWZlIGZvciByZW5kZXJpbmcgYnkgeW91ciBzZXJ2ZXI/KSAgSG93IGNhbiB5b3VcbiAqIGVuc3VyZSB0aGF0IHlvdSBkaWRuJ3QgYWNjaWRlbnRhbGx5IGRlbGV0ZSB0aGUgbGluZSB0aGF0IHNhbml0aXplZCB0aGUgdmFsdWUsIG9yIHJlbmFtZWQgc29tZVxuICogcHJvcGVydGllcy9maWVsZHMgYW5kIGZvcmdvdCB0byB1cGRhdGUgdGhlIGJpbmRpbmcgdG8gdGhlIHNhbml0aXplZCB2YWx1ZT9cbiAqXG4gKiBUbyBiZSBzZWN1cmUgYnkgZGVmYXVsdCwgeW91IHdhbnQgdG8gZW5zdXJlIHRoYXQgYW55IHN1Y2ggYmluZGluZ3MgYXJlIGRpc2FsbG93ZWQgdW5sZXNzIHlvdSBjYW5cbiAqIGRldGVybWluZSB0aGF0IHNvbWV0aGluZyBleHBsaWNpdGx5IHNheXMgaXQncyBzYWZlIHRvIHVzZSBhIHZhbHVlIGZvciBiaW5kaW5nIGluIHRoYXRcbiAqIGNvbnRleHQuICBZb3UgY2FuIHRoZW4gYXVkaXQgeW91ciBjb2RlIChhIHNpbXBsZSBncmVwIHdvdWxkIGRvKSB0byBlbnN1cmUgdGhhdCB0aGlzIGlzIG9ubHkgZG9uZVxuICogZm9yIHRob3NlIHZhbHVlcyB0aGF0IHlvdSBjYW4gZWFzaWx5IHRlbGwgYXJlIHNhZmUgLSBiZWNhdXNlIHRoZXkgd2VyZSByZWNlaXZlZCBmcm9tIHlvdXIgc2VydmVyLFxuICogc2FuaXRpemVkIGJ5IHlvdXIgbGlicmFyeSwgZXRjLiAgWW91IGNhbiBvcmdhbml6ZSB5b3VyIGNvZGViYXNlIHRvIGhlbHAgd2l0aCB0aGlzIC0gcGVyaGFwc1xuICogYWxsb3dpbmcgb25seSB0aGUgZmlsZXMgaW4gYSBzcGVjaWZpYyBkaXJlY3RvcnkgdG8gZG8gdGhpcy4gIEVuc3VyaW5nIHRoYXQgdGhlIGludGVybmFsIEFQSVxuICogZXhwb3NlZCBieSB0aGF0IGNvZGUgZG9lc24ndCBtYXJrdXAgYXJiaXRyYXJ5IHZhbHVlcyBhcyBzYWZlIHRoZW4gYmVjb21lcyBhIG1vcmUgbWFuYWdlYWJsZSB0YXNrLlxuICpcbiAqIEluIHRoZSBjYXNlIG9mIEFuZ3VsYXJKUycgU0NFIHNlcnZpY2UsIG9uZSB1c2VzIHtAbGluayBuZy4kc2NlI3RydXN0QXMgJHNjZS50cnVzdEFzfVxuICogKGFuZCBzaG9ydGhhbmQgbWV0aG9kcyBzdWNoIGFzIHtAbGluayBuZy4kc2NlI3RydXN0QXNIdG1sICRzY2UudHJ1c3RBc0h0bWx9LCBldGMuKSB0b1xuICogb2J0YWluIHZhbHVlcyB0aGF0IHdpbGwgYmUgYWNjZXB0ZWQgYnkgU0NFIC8gcHJpdmlsZWdlZCBjb250ZXh0cy5cbiAqXG4gKlxuICogIyMgSG93IGRvZXMgaXQgd29yaz9cbiAqXG4gKiBJbiBwcml2aWxlZ2VkIGNvbnRleHRzLCBkaXJlY3RpdmVzIGFuZCBjb2RlIHdpbGwgYmluZCB0byB0aGUgcmVzdWx0IG9mIHtAbGluayBuZy4kc2NlI2dldFRydXN0ZWRcbiAqICRzY2UuZ2V0VHJ1c3RlZChjb250ZXh0LCB2YWx1ZSl9IHJhdGhlciB0aGFuIHRvIHRoZSB2YWx1ZSBkaXJlY3RseS4gIERpcmVjdGl2ZXMgdXNlIHtAbGlua1xuICogbmcuJHNjZSNwYXJzZUFzICRzY2UucGFyc2VBc30gcmF0aGVyIHRoYW4gYCRwYXJzZWAgdG8gd2F0Y2ggYXR0cmlidXRlIGJpbmRpbmdzLCB3aGljaCBwZXJmb3JtcyB0aGVcbiAqIHtAbGluayBuZy4kc2NlI2dldFRydXN0ZWQgJHNjZS5nZXRUcnVzdGVkfSBiZWhpbmQgdGhlIHNjZW5lcyBvbiBub24tY29uc3RhbnQgbGl0ZXJhbHMuXG4gKlxuICogQXMgYW4gZXhhbXBsZSwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0JpbmRIdG1sIG5nQmluZEh0bWx9IHVzZXMge0BsaW5rXG4gKiBuZy4kc2NlI3BhcnNlQXNIdG1sICRzY2UucGFyc2VBc0h0bWwoYmluZGluZyBleHByZXNzaW9uKX0uICBIZXJlJ3MgdGhlIGFjdHVhbCBjb2RlIChzbGlnaHRseVxuICogc2ltcGxpZmllZCk6XG4gKlxuICogYGBgXG4gKiB2YXIgbmdCaW5kSHRtbERpcmVjdGl2ZSA9IFsnJHNjZScsIGZ1bmN0aW9uKCRzY2UpIHtcbiAqICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG4gKiAgICAgc2NvcGUuJHdhdGNoKCRzY2UucGFyc2VBc0h0bWwoYXR0ci5uZ0JpbmRIdG1sKSwgZnVuY3Rpb24odmFsdWUpIHtcbiAqICAgICAgIGVsZW1lbnQuaHRtbCh2YWx1ZSB8fCAnJyk7XG4gKiAgICAgfSk7XG4gKiAgIH07XG4gKiB9XTtcbiAqIGBgYFxuICpcbiAqICMjIEltcGFjdCBvbiBsb2FkaW5nIHRlbXBsYXRlc1xuICpcbiAqIFRoaXMgYXBwbGllcyBib3RoIHRvIHRoZSB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nSW5jbHVkZSBgbmctaW5jbHVkZWB9IGRpcmVjdGl2ZSBhcyB3ZWxsIGFzXG4gKiBgdGVtcGxhdGVVcmxgJ3Mgc3BlY2lmaWVkIGJ5IHtAbGluayBndWlkZS9kaXJlY3RpdmUgZGlyZWN0aXZlc30uXG4gKlxuICogQnkgZGVmYXVsdCwgQW5ndWxhciBvbmx5IGxvYWRzIHRlbXBsYXRlcyBmcm9tIHRoZSBzYW1lIGRvbWFpbiBhbmQgcHJvdG9jb2wgYXMgdGhlIGFwcGxpY2F0aW9uXG4gKiBkb2N1bWVudC4gIFRoaXMgaXMgZG9uZSBieSBjYWxsaW5nIHtAbGluayBuZy4kc2NlI2dldFRydXN0ZWRSZXNvdXJjZVVybFxuICogJHNjZS5nZXRUcnVzdGVkUmVzb3VyY2VVcmx9IG9uIHRoZSB0ZW1wbGF0ZSBVUkwuICBUbyBsb2FkIHRlbXBsYXRlcyBmcm9tIG90aGVyIGRvbWFpbnMgYW5kL29yXG4gKiBwcm90b2NvbHMsIHlvdSBtYXkgZWl0aGVyIHtAbGluayBuZy4kc2NlRGVsZWdhdGVQcm92aWRlciNyZXNvdXJjZVVybFdoaXRlbGlzdCB3aGl0ZWxpc3RcbiAqIHRoZW19IG9yIHtAbGluayBuZy4kc2NlI3RydXN0QXNSZXNvdXJjZVVybCB3cmFwIGl0fSBpbnRvIGEgdHJ1c3RlZCB2YWx1ZS5cbiAqXG4gKiAqUGxlYXNlIG5vdGUqOlxuICogVGhlIGJyb3dzZXInc1xuICogW1NhbWUgT3JpZ2luIFBvbGljeV0oaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9icm93c2Vyc2VjL3dpa2kvUGFydDIjU2FtZS1vcmlnaW5fcG9saWN5X2Zvcl9YTUxIdHRwUmVxdWVzdClcbiAqIGFuZCBbQ3Jvc3MtT3JpZ2luIFJlc291cmNlIFNoYXJpbmcgKENPUlMpXShodHRwOi8vd3d3LnczLm9yZy9UUi9jb3JzLylcbiAqIHBvbGljeSBhcHBseSBpbiBhZGRpdGlvbiB0byB0aGlzIGFuZCBtYXkgZnVydGhlciByZXN0cmljdCB3aGV0aGVyIHRoZSB0ZW1wbGF0ZSBpcyBzdWNjZXNzZnVsbHlcbiAqIGxvYWRlZC4gIFRoaXMgbWVhbnMgdGhhdCB3aXRob3V0IHRoZSByaWdodCBDT1JTIHBvbGljeSwgbG9hZGluZyB0ZW1wbGF0ZXMgZnJvbSBhIGRpZmZlcmVudCBkb21haW5cbiAqIHdvbid0IHdvcmsgb24gYWxsIGJyb3dzZXJzLiAgQWxzbywgbG9hZGluZyB0ZW1wbGF0ZXMgZnJvbSBgZmlsZTovL2AgVVJMIGRvZXMgbm90IHdvcmsgb24gc29tZVxuICogYnJvd3NlcnMuXG4gKlxuICogIyMgVGhpcyBmZWVscyBsaWtlIHRvbyBtdWNoIG92ZXJoZWFkXG4gKlxuICogSXQncyBpbXBvcnRhbnQgdG8gcmVtZW1iZXIgdGhhdCBTQ0Ugb25seSBhcHBsaWVzIHRvIGludGVycG9sYXRpb24gZXhwcmVzc2lvbnMuXG4gKlxuICogSWYgeW91ciBleHByZXNzaW9ucyBhcmUgY29uc3RhbnQgbGl0ZXJhbHMsIHRoZXkncmUgYXV0b21hdGljYWxseSB0cnVzdGVkIGFuZCB5b3UgZG9uJ3QgbmVlZCB0b1xuICogY2FsbCBgJHNjZS50cnVzdEFzYCBvbiB0aGVtIChyZW1lbWJlciB0byBpbmNsdWRlIHRoZSBgbmdTYW5pdGl6ZWAgbW9kdWxlKSAoZS5nLlxuICogYDxkaXYgbmctYmluZC1odG1sPVwiJzxiPmltcGxpY2l0bHkgdHJ1c3RlZDwvYj4nXCI+PC9kaXY+YCkganVzdCB3b3Jrcy5cbiAqXG4gKiBBZGRpdGlvbmFsbHksIGBhW2hyZWZdYCBhbmQgYGltZ1tzcmNdYCBhdXRvbWF0aWNhbGx5IHNhbml0aXplIHRoZWlyIFVSTHMgYW5kIGRvIG5vdCBwYXNzIHRoZW1cbiAqIHRocm91Z2gge0BsaW5rIG5nLiRzY2UjZ2V0VHJ1c3RlZCAkc2NlLmdldFRydXN0ZWR9LiAgU0NFIGRvZXNuJ3QgcGxheSBhIHJvbGUgaGVyZS5cbiAqXG4gKiBUaGUgaW5jbHVkZWQge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZSAkc2NlRGVsZWdhdGV9IGNvbWVzIHdpdGggc2FuZSBkZWZhdWx0cyB0byBhbGxvdyB5b3UgdG8gbG9hZFxuICogdGVtcGxhdGVzIGluIGBuZy1pbmNsdWRlYCBmcm9tIHlvdXIgYXBwbGljYXRpb24ncyBkb21haW4gd2l0aG91dCBoYXZpbmcgdG8gZXZlbiBrbm93IGFib3V0IFNDRS5cbiAqIEl0IGJsb2NrcyBsb2FkaW5nIHRlbXBsYXRlcyBmcm9tIG90aGVyIGRvbWFpbnMgb3IgbG9hZGluZyB0ZW1wbGF0ZXMgb3ZlciBodHRwIGZyb20gYW4gaHR0cHNcbiAqIHNlcnZlZCBkb2N1bWVudC4gIFlvdSBjYW4gY2hhbmdlIHRoZXNlIGJ5IHNldHRpbmcgeW91ciBvd24gY3VzdG9tIHtAbGlua1xuICogbmcuJHNjZURlbGVnYXRlUHJvdmlkZXIjcmVzb3VyY2VVcmxXaGl0ZWxpc3Qgd2hpdGVsaXN0c30gYW5kIHtAbGlua1xuICogbmcuJHNjZURlbGVnYXRlUHJvdmlkZXIjcmVzb3VyY2VVcmxCbGFja2xpc3QgYmxhY2tsaXN0c30gZm9yIG1hdGNoaW5nIHN1Y2ggVVJMcy5cbiAqXG4gKiBUaGlzIHNpZ25pZmljYW50bHkgcmVkdWNlcyB0aGUgb3ZlcmhlYWQuICBJdCBpcyBmYXIgZWFzaWVyIHRvIHBheSB0aGUgc21hbGwgb3ZlcmhlYWQgYW5kIGhhdmUgYW5cbiAqIGFwcGxpY2F0aW9uIHRoYXQncyBzZWN1cmUgYW5kIGNhbiBiZSBhdWRpdGVkIHRvIHZlcmlmeSB0aGF0IHdpdGggbXVjaCBtb3JlIGVhc2UgdGhhbiBib2x0aW5nXG4gKiBzZWN1cml0eSBvbnRvIGFuIGFwcGxpY2F0aW9uIGxhdGVyLlxuICpcbiAqIDxhIG5hbWU9XCJjb250ZXh0c1wiPjwvYT5cbiAqICMjIFdoYXQgdHJ1c3RlZCBjb250ZXh0IHR5cGVzIGFyZSBzdXBwb3J0ZWQ/XG4gKlxuICogfCBDb250ZXh0ICAgICAgICAgICAgIHwgTm90ZXMgICAgICAgICAgfFxuICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tfFxuICogfCBgJHNjZS5IVE1MYCAgICAgICAgIHwgRm9yIEhUTUwgdGhhdCdzIHNhZmUgdG8gc291cmNlIGludG8gdGhlIGFwcGxpY2F0aW9uLiAgVGhlIHtAbGluayBuZy5kaXJlY3RpdmU6bmdCaW5kSHRtbCBuZ0JpbmRIdG1sfSBkaXJlY3RpdmUgdXNlcyB0aGlzIGNvbnRleHQgZm9yIGJpbmRpbmdzLiBJZiBhbiB1bnNhZmUgdmFsdWUgaXMgZW5jb3VudGVyZWQgYW5kIHRoZSB7QGxpbmsgbmdTYW5pdGl6ZSAkc2FuaXRpemV9IG1vZHVsZSBpcyBwcmVzZW50IHRoaXMgd2lsbCBzYW5pdGl6ZSB0aGUgdmFsdWUgaW5zdGVhZCBvZiB0aHJvd2luZyBhbiBlcnJvci4gfFxuICogfCBgJHNjZS5DU1NgICAgICAgICAgIHwgRm9yIENTUyB0aGF0J3Mgc2FmZSB0byBzb3VyY2UgaW50byB0aGUgYXBwbGljYXRpb24uICBDdXJyZW50bHkgdW51c2VkLiAgRmVlbCBmcmVlIHRvIHVzZSBpdCBpbiB5b3VyIG93biBkaXJlY3RpdmVzLiB8XG4gKiB8IGAkc2NlLlVSTGAgICAgICAgICAgfCBGb3IgVVJMcyB0aGF0IGFyZSBzYWZlIHRvIGZvbGxvdyBhcyBsaW5rcy4gIEN1cnJlbnRseSB1bnVzZWQgKGA8YSBocmVmPWAgYW5kIGA8aW1nIHNyYz1gIHNhbml0aXplIHRoZWlyIHVybHMgYW5kIGRvbid0IGNvbnN0aXR1dGUgYW4gU0NFIGNvbnRleHQuIHxcbiAqIHwgYCRzY2UuUkVTT1VSQ0VfVVJMYCB8IEZvciBVUkxzIHRoYXQgYXJlIG5vdCBvbmx5IHNhZmUgdG8gZm9sbG93IGFzIGxpbmtzLCBidXQgd2hvc2UgY29udGVudHMgYXJlIGFsc28gc2FmZSB0byBpbmNsdWRlIGluIHlvdXIgYXBwbGljYXRpb24uICBFeGFtcGxlcyBpbmNsdWRlIGBuZy1pbmNsdWRlYCwgYHNyY2AgLyBgbmdTcmNgIGJpbmRpbmdzIGZvciB0YWdzIG90aGVyIHRoYW4gYElNR2AgKGUuZy4gYElGUkFNRWAsIGBPQkpFQ1RgLCBldGMuKSAgPGJyPjxicj5Ob3RlIHRoYXQgYCRzY2UuUkVTT1VSQ0VfVVJMYCBtYWtlcyBhIHN0cm9uZ2VyIHN0YXRlbWVudCBhYm91dCB0aGUgVVJMIHRoYW4gYCRzY2UuVVJMYCBkb2VzIGFuZCB0aGVyZWZvcmUgY29udGV4dHMgcmVxdWlyaW5nIHZhbHVlcyB0cnVzdGVkIGZvciBgJHNjZS5SRVNPVVJDRV9VUkxgIGNhbiBiZSB1c2VkIGFueXdoZXJlIHRoYXQgdmFsdWVzIHRydXN0ZWQgZm9yIGAkc2NlLlVSTGAgYXJlIHJlcXVpcmVkLiB8XG4gKiB8IGAkc2NlLkpTYCAgICAgICAgICAgfCBGb3IgSmF2YVNjcmlwdCB0aGF0IGlzIHNhZmUgdG8gZXhlY3V0ZSBpbiB5b3VyIGFwcGxpY2F0aW9uJ3MgY29udGV4dC4gIEN1cnJlbnRseSB1bnVzZWQuICBGZWVsIGZyZWUgdG8gdXNlIGl0IGluIHlvdXIgb3duIGRpcmVjdGl2ZXMuIHxcbiAqXG4gKiAjIyBGb3JtYXQgb2YgaXRlbXMgaW4ge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZVByb3ZpZGVyI3Jlc291cmNlVXJsV2hpdGVsaXN0IHJlc291cmNlVXJsV2hpdGVsaXN0fS97QGxpbmsgbmcuJHNjZURlbGVnYXRlUHJvdmlkZXIjcmVzb3VyY2VVcmxCbGFja2xpc3QgQmxhY2tsaXN0fSA8YSBuYW1lPVwicmVzb3VyY2VVcmxQYXR0ZXJuSXRlbVwiPjwvYT5cbiAqXG4gKiAgRWFjaCBlbGVtZW50IGluIHRoZXNlIGFycmF5cyBtdXN0IGJlIG9uZSBvZiB0aGUgZm9sbG93aW5nOlxuICpcbiAqICAtICoqJ3NlbGYnKipcbiAqICAgIC0gVGhlIHNwZWNpYWwgKipzdHJpbmcqKiwgYCdzZWxmJ2AsIGNhbiBiZSB1c2VkIHRvIG1hdGNoIGFnYWluc3QgYWxsIFVSTHMgb2YgdGhlICoqc2FtZVxuICogICAgICBkb21haW4qKiBhcyB0aGUgYXBwbGljYXRpb24gZG9jdW1lbnQgdXNpbmcgdGhlICoqc2FtZSBwcm90b2NvbCoqLlxuICogIC0gKipTdHJpbmcqKiAoZXhjZXB0IHRoZSBzcGVjaWFsIHZhbHVlIGAnc2VsZidgKVxuICogICAgLSBUaGUgc3RyaW5nIGlzIG1hdGNoZWQgYWdhaW5zdCB0aGUgZnVsbCAqbm9ybWFsaXplZCAvIGFic29sdXRlIFVSTCogb2YgdGhlIHJlc291cmNlXG4gKiAgICAgIGJlaW5nIHRlc3RlZCAoc3Vic3RyaW5nIG1hdGNoZXMgYXJlIG5vdCBnb29kIGVub3VnaC4pXG4gKiAgICAtIFRoZXJlIGFyZSBleGFjdGx5ICoqdHdvIHdpbGRjYXJkIHNlcXVlbmNlcyoqIC0gYCpgIGFuZCBgKipgLiAgQWxsIG90aGVyIGNoYXJhY3RlcnNcbiAqICAgICAgbWF0Y2ggdGhlbXNlbHZlcy5cbiAqICAgIC0gYCpgOiBtYXRjaGVzIHplcm8gb3IgbW9yZSBvY2N1cnJlbmNlcyBvZiBhbnkgY2hhcmFjdGVyIG90aGVyIHRoYW4gb25lIG9mIHRoZSBmb2xsb3dpbmcgNlxuICogICAgICBjaGFyYWN0ZXJzOiAnYDpgJywgJ2AvYCcsICdgLmAnLCAnYD9gJywgJ2AmYCcgYW5kICdgO2AnLiAgSXQncyBhIHVzZWZ1bCB3aWxkY2FyZCBmb3IgdXNlXG4gKiAgICAgIGluIGEgd2hpdGVsaXN0LlxuICogICAgLSBgKipgOiBtYXRjaGVzIHplcm8gb3IgbW9yZSBvY2N1cnJlbmNlcyBvZiAqYW55KiBjaGFyYWN0ZXIuICBBcyBzdWNoLCBpdCdzIG5vdFxuICogICAgICBhcHByb3ByaWF0ZSBmb3IgdXNlIGluIGEgc2NoZW1lLCBkb21haW4sIGV0Yy4gYXMgaXQgd291bGQgbWF0Y2ggdG9vIG11Y2guICAoZS5nLlxuICogICAgICBodHRwOi8vKiouZXhhbXBsZS5jb20vIHdvdWxkIG1hdGNoIGh0dHA6Ly9ldmlsLmNvbS8/aWdub3JlPS5leGFtcGxlLmNvbS8gYW5kIHRoYXQgbWlnaHRcbiAqICAgICAgbm90IGhhdmUgYmVlbiB0aGUgaW50ZW50aW9uLikgIEl0cyB1c2FnZSBhdCB0aGUgdmVyeSBlbmQgb2YgdGhlIHBhdGggaXMgb2suICAoZS5nLlxuICogICAgICBodHRwOi8vZm9vLmV4YW1wbGUuY29tL3RlbXBsYXRlcy8qKikuXG4gKiAgLSAqKlJlZ0V4cCoqICgqc2VlIGNhdmVhdCBiZWxvdyopXG4gKiAgICAtICpDYXZlYXQqOiAgV2hpbGUgcmVndWxhciBleHByZXNzaW9ucyBhcmUgcG93ZXJmdWwgYW5kIG9mZmVyIGdyZWF0IGZsZXhpYmlsaXR5LCAgdGhlaXIgc3ludGF4XG4gKiAgICAgIChhbmQgYWxsIHRoZSBpbmV2aXRhYmxlIGVzY2FwaW5nKSBtYWtlcyB0aGVtICpoYXJkZXIgdG8gbWFpbnRhaW4qLiAgSXQncyBlYXN5IHRvXG4gKiAgICAgIGFjY2lkZW50YWxseSBpbnRyb2R1Y2UgYSBidWcgd2hlbiBvbmUgdXBkYXRlcyBhIGNvbXBsZXggZXhwcmVzc2lvbiAoaW1obywgYWxsIHJlZ2V4ZXMgc2hvdWxkXG4gKiAgICAgIGhhdmUgZ29vZCB0ZXN0IGNvdmVyYWdlKS4gIEZvciBpbnN0YW5jZSwgdGhlIHVzZSBvZiBgLmAgaW4gdGhlIHJlZ2V4IGlzIGNvcnJlY3Qgb25seSBpbiBhXG4gKiAgICAgIHNtYWxsIG51bWJlciBvZiBjYXNlcy4gIEEgYC5gIGNoYXJhY3RlciBpbiB0aGUgcmVnZXggdXNlZCB3aGVuIG1hdGNoaW5nIHRoZSBzY2hlbWUgb3IgYVxuICogICAgICBzdWJkb21haW4gY291bGQgYmUgbWF0Y2hlZCBhZ2FpbnN0IGEgYDpgIG9yIGxpdGVyYWwgYC5gIHRoYXQgd2FzIGxpa2VseSBub3QgaW50ZW5kZWQuICAgSXRcbiAqICAgICAgaXMgaGlnaGx5IHJlY29tbWVuZGVkIHRvIHVzZSB0aGUgc3RyaW5nIHBhdHRlcm5zIGFuZCBvbmx5IGZhbGwgYmFjayB0byByZWd1bGFyIGV4cHJlc3Npb25zXG4gKiAgICAgIGFzIGEgbGFzdCByZXNvcnQuXG4gKiAgICAtIFRoZSByZWd1bGFyIGV4cHJlc3Npb24gbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiBSZWdFeHAgKGkuZS4gbm90IGEgc3RyaW5nLikgIEl0IGlzXG4gKiAgICAgIG1hdGNoZWQgYWdhaW5zdCB0aGUgKiplbnRpcmUqKiAqbm9ybWFsaXplZCAvIGFic29sdXRlIFVSTCogb2YgdGhlIHJlc291cmNlIGJlaW5nIHRlc3RlZFxuICogICAgICAoZXZlbiB3aGVuIHRoZSBSZWdFeHAgZGlkIG5vdCBoYXZlIHRoZSBgXmAgYW5kIGAkYCBjb2Rlcy4pICBJbiBhZGRpdGlvbiwgYW55IGZsYWdzXG4gKiAgICAgIHByZXNlbnQgb24gdGhlIFJlZ0V4cCAoc3VjaCBhcyBtdWx0aWxpbmUsIGdsb2JhbCwgaWdub3JlQ2FzZSkgYXJlIGlnbm9yZWQuXG4gKiAgICAtIElmIHlvdSBhcmUgZ2VuZXJhdGluZyB5b3VyIEphdmFTY3JpcHQgZnJvbSBzb21lIG90aGVyIHRlbXBsYXRpbmcgZW5naW5lIChub3RcbiAqICAgICAgcmVjb21tZW5kZWQsIGUuZy4gaW4gaXNzdWUgWyM0MDA2XShodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL2lzc3Vlcy80MDA2KSksXG4gKiAgICAgIHJlbWVtYmVyIHRvIGVzY2FwZSB5b3VyIHJlZ3VsYXIgZXhwcmVzc2lvbiAoYW5kIGJlIGF3YXJlIHRoYXQgeW91IG1pZ2h0IG5lZWQgbW9yZSB0aGFuXG4gKiAgICAgIG9uZSBsZXZlbCBvZiBlc2NhcGluZyBkZXBlbmRpbmcgb24geW91ciB0ZW1wbGF0aW5nIGVuZ2luZSBhbmQgdGhlIHdheSB5b3UgaW50ZXJwb2xhdGVkXG4gKiAgICAgIHRoZSB2YWx1ZS4pICBEbyBtYWtlIHVzZSBvZiB5b3VyIHBsYXRmb3JtJ3MgZXNjYXBpbmcgbWVjaGFuaXNtIGFzIGl0IG1pZ2h0IGJlIGdvb2RcbiAqICAgICAgZW5vdWdoIGJlZm9yZSBjb2RpbmcgeW91ciBvd24uICBFLmcuIFJ1YnkgaGFzXG4gKiAgICAgIFtSZWdleHAuZXNjYXBlKHN0cildKGh0dHA6Ly93d3cucnVieS1kb2Mub3JnL2NvcmUtMi4wLjAvUmVnZXhwLmh0bWwjbWV0aG9kLWMtZXNjYXBlKVxuICogICAgICBhbmQgUHl0aG9uIGhhcyBbcmUuZXNjYXBlXShodHRwOi8vZG9jcy5weXRob24ub3JnL2xpYnJhcnkvcmUuaHRtbCNyZS5lc2NhcGUpLlxuICogICAgICBKYXZhc2NyaXB0IGxhY2tzIGEgc2ltaWxhciBidWlsdCBpbiBmdW5jdGlvbiBmb3IgZXNjYXBpbmcuICBUYWtlIGEgbG9vayBhdCBHb29nbGVcbiAqICAgICAgQ2xvc3VyZSBsaWJyYXJ5J3MgW2dvb2cuc3RyaW5nLnJlZ0V4cEVzY2FwZShzKV0oXG4gKiAgICAgIGh0dHA6Ly9kb2NzLmNsb3N1cmUtbGlicmFyeS5nb29nbGVjb2RlLmNvbS9naXQvY2xvc3VyZV9nb29nX3N0cmluZ19zdHJpbmcuanMuc291cmNlLmh0bWwjbGluZTk2MikuXG4gKlxuICogUmVmZXIge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZVByb3ZpZGVyICRzY2VEZWxlZ2F0ZVByb3ZpZGVyfSBmb3IgYW4gZXhhbXBsZS5cbiAqXG4gKiAjIyBTaG93IG1lIGFuIGV4YW1wbGUgdXNpbmcgU0NFLlxuICpcbiAqIDxleGFtcGxlIG1vZHVsZT1cIm15U2NlQXBwXCIgZGVwcz1cImFuZ3VsYXItc2FuaXRpemUuanNcIj5cbiAqIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gKiAgIDxkaXYgbmctY29udHJvbGxlcj1cIkFwcENvbnRyb2xsZXIgYXMgbXlDdHJsXCI+XG4gKiAgICAgPGkgbmctYmluZC1odG1sPVwibXlDdHJsLmV4cGxpY2l0bHlUcnVzdGVkSHRtbFwiIGlkPVwiZXhwbGljaXRseVRydXN0ZWRIdG1sXCI+PC9pPjxicj48YnI+XG4gKiAgICAgPGI+VXNlciBjb21tZW50czwvYj48YnI+XG4gKiAgICAgQnkgZGVmYXVsdCwgSFRNTCB0aGF0IGlzbid0IGV4cGxpY2l0bHkgdHJ1c3RlZCAoZS5nLiBBbGljZSdzIGNvbW1lbnQpIGlzIHNhbml0aXplZCB3aGVuXG4gKiAgICAgJHNhbml0aXplIGlzIGF2YWlsYWJsZS4gIElmICRzYW5pdGl6ZSBpc24ndCBhdmFpbGFibGUsIHRoaXMgcmVzdWx0cyBpbiBhbiBlcnJvciBpbnN0ZWFkIG9mIGFuXG4gKiAgICAgZXhwbG9pdC5cbiAqICAgICA8ZGl2IGNsYXNzPVwid2VsbFwiPlxuICogICAgICAgPGRpdiBuZy1yZXBlYXQ9XCJ1c2VyQ29tbWVudCBpbiBteUN0cmwudXNlckNvbW1lbnRzXCI+XG4gKiAgICAgICAgIDxiPnt7dXNlckNvbW1lbnQubmFtZX19PC9iPjpcbiAqICAgICAgICAgPHNwYW4gbmctYmluZC1odG1sPVwidXNlckNvbW1lbnQuaHRtbENvbW1lbnRcIiBjbGFzcz1cImh0bWxDb21tZW50XCI+PC9zcGFuPlxuICogICAgICAgICA8YnI+XG4gKiAgICAgICA8L2Rpdj5cbiAqICAgICA8L2Rpdj5cbiAqICAgPC9kaXY+XG4gKiA8L2ZpbGU+XG4gKlxuICogPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuICogICBhbmd1bGFyLm1vZHVsZSgnbXlTY2VBcHAnLCBbJ25nU2FuaXRpemUnXSlcbiAqICAgICAuY29udHJvbGxlcignQXBwQ29udHJvbGxlcicsIFsnJGh0dHAnLCAnJHRlbXBsYXRlQ2FjaGUnLCAnJHNjZScsXG4gKiAgICAgICBmdW5jdGlvbigkaHR0cCwgJHRlbXBsYXRlQ2FjaGUsICRzY2UpIHtcbiAqICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICogICAgICAgICAkaHR0cC5nZXQoXCJ0ZXN0X2RhdGEuanNvblwiLCB7Y2FjaGU6ICR0ZW1wbGF0ZUNhY2hlfSkuc3VjY2VzcyhmdW5jdGlvbih1c2VyQ29tbWVudHMpIHtcbiAqICAgICAgICAgICBzZWxmLnVzZXJDb21tZW50cyA9IHVzZXJDb21tZW50cztcbiAqICAgICAgICAgfSk7XG4gKiAgICAgICAgIHNlbGYuZXhwbGljaXRseVRydXN0ZWRIdG1sID0gJHNjZS50cnVzdEFzSHRtbChcbiAqICAgICAgICAgICAgICc8c3BhbiBvbm1vdXNlb3Zlcj1cInRoaXMudGV4dENvbnRlbnQ9JnF1b3Q7RXhwbGljaXRseSB0cnVzdGVkIEhUTUwgYnlwYXNzZXMgJyArXG4gKiAgICAgICAgICAgICAnc2FuaXRpemF0aW9uLiZxdW90O1wiPkhvdmVyIG92ZXIgdGhpcyB0ZXh0Ljwvc3Bhbj4nKTtcbiAqICAgICAgIH1dKTtcbiAqIDwvZmlsZT5cbiAqXG4gKiA8ZmlsZSBuYW1lPVwidGVzdF9kYXRhLmpzb25cIj5cbiAqIFtcbiAqICAgeyBcIm5hbWVcIjogXCJBbGljZVwiLFxuICogICAgIFwiaHRtbENvbW1lbnRcIjpcbiAqICAgICAgICAgXCI8c3BhbiBvbm1vdXNlb3Zlcj0ndGhpcy50ZXh0Q29udGVudD1cXFwiUFdOM0QhXFxcIic+SXMgPGk+YW55b25lPC9pPiByZWFkaW5nIHRoaXM/PC9zcGFuPlwiXG4gKiAgIH0sXG4gKiAgIHsgXCJuYW1lXCI6IFwiQm9iXCIsXG4gKiAgICAgXCJodG1sQ29tbWVudFwiOiBcIjxpPlllcyE8L2k+ICBBbSBJIHRoZSBvbmx5IG90aGVyIG9uZT9cIlxuICogICB9XG4gKiBdXG4gKiA8L2ZpbGU+XG4gKlxuICogPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICogICBkZXNjcmliZSgnU0NFIGRvYyBkZW1vJywgZnVuY3Rpb24oKSB7XG4gKiAgICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSB1bnRydXN0ZWQgdmFsdWVzJywgZnVuY3Rpb24oKSB7XG4gKiAgICAgICBleHBlY3QoZWxlbWVudC5hbGwoYnkuY3NzKCcuaHRtbENvbW1lbnQnKSkuZmlyc3QoKS5nZXRJbm5lckh0bWwoKSlcbiAqICAgICAgICAgICAudG9CZSgnPHNwYW4+SXMgPGk+YW55b25lPC9pPiByZWFkaW5nIHRoaXM/PC9zcGFuPicpO1xuICogICAgIH0pO1xuICpcbiAqICAgICBpdCgnc2hvdWxkIE5PVCBzYW5pdGl6ZSBleHBsaWNpdGx5IHRydXN0ZWQgdmFsdWVzJywgZnVuY3Rpb24oKSB7XG4gKiAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnZXhwbGljaXRseVRydXN0ZWRIdG1sJykpLmdldElubmVySHRtbCgpKS50b0JlKFxuICogICAgICAgICAgICc8c3BhbiBvbm1vdXNlb3Zlcj1cInRoaXMudGV4dENvbnRlbnQ9JnF1b3Q7RXhwbGljaXRseSB0cnVzdGVkIEhUTUwgYnlwYXNzZXMgJyArXG4gKiAgICAgICAgICAgJ3Nhbml0aXphdGlvbi4mcXVvdDtcIj5Ib3ZlciBvdmVyIHRoaXMgdGV4dC48L3NwYW4+Jyk7XG4gKiAgICAgfSk7XG4gKiAgIH0pO1xuICogPC9maWxlPlxuICogPC9leGFtcGxlPlxuICpcbiAqXG4gKlxuICogIyMgQ2FuIEkgZGlzYWJsZSBTQ0UgY29tcGxldGVseT9cbiAqXG4gKiBZZXMsIHlvdSBjYW4uICBIb3dldmVyLCB0aGlzIGlzIHN0cm9uZ2x5IGRpc2NvdXJhZ2VkLiAgU0NFIGdpdmVzIHlvdSBhIGxvdCBvZiBzZWN1cml0eSBiZW5lZml0c1xuICogZm9yIGxpdHRsZSBjb2Rpbmcgb3ZlcmhlYWQuICBJdCB3aWxsIGJlIG11Y2ggaGFyZGVyIHRvIHRha2UgYW4gU0NFIGRpc2FibGVkIGFwcGxpY2F0aW9uIGFuZFxuICogZWl0aGVyIHNlY3VyZSBpdCBvbiB5b3VyIG93biBvciBlbmFibGUgU0NFIGF0IGEgbGF0ZXIgc3RhZ2UuICBJdCBtaWdodCBtYWtlIHNlbnNlIHRvIGRpc2FibGUgU0NFXG4gKiBmb3IgY2FzZXMgd2hlcmUgeW91IGhhdmUgYSBsb3Qgb2YgZXhpc3RpbmcgY29kZSB0aGF0IHdhcyB3cml0dGVuIGJlZm9yZSBTQ0Ugd2FzIGludHJvZHVjZWQgYW5kXG4gKiB5b3UncmUgbWlncmF0aW5nIHRoZW0gYSBtb2R1bGUgYXQgYSB0aW1lLlxuICpcbiAqIFRoYXQgc2FpZCwgaGVyZSdzIGhvdyB5b3UgY2FuIGNvbXBsZXRlbHkgZGlzYWJsZSBTQ0U6XG4gKlxuICogYGBgXG4gKiBhbmd1bGFyLm1vZHVsZSgnbXlBcHBXaXRoU2NlRGlzYWJsZWRteUFwcCcsIFtdKS5jb25maWcoZnVuY3Rpb24oJHNjZVByb3ZpZGVyKSB7XG4gKiAgIC8vIENvbXBsZXRlbHkgZGlzYWJsZSBTQ0UuICBGb3IgZGVtb25zdHJhdGlvbiBwdXJwb3NlcyBvbmx5IVxuICogICAvLyBEbyBub3QgdXNlIGluIG5ldyBwcm9qZWN0cy5cbiAqICAgJHNjZVByb3ZpZGVyLmVuYWJsZWQoZmFsc2UpO1xuICogfSk7XG4gKiBgYGBcbiAqXG4gKi9cbi8qIGpzaGludCBtYXhsZW46IDEwMCAqL1xuXG5mdW5jdGlvbiAkU2NlUHJvdmlkZXIoKSB7XG4gIHZhciBlbmFibGVkID0gdHJ1ZTtcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkc2NlUHJvdmlkZXIjZW5hYmxlZFxuICAgKiBAa2luZCBmdW5jdGlvblxuICAgKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSB2YWx1ZSBJZiBwcm92aWRlZCwgdGhlbiBlbmFibGVzL2Rpc2FibGVzIFNDRS5cbiAgICogQHJldHVybiB7Ym9vbGVhbn0gdHJ1ZSBpZiBTQ0UgaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogRW5hYmxlcy9kaXNhYmxlcyBTQ0UgYW5kIHJldHVybnMgdGhlIGN1cnJlbnQgdmFsdWUuXG4gICAqL1xuICB0aGlzLmVuYWJsZWQgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICBlbmFibGVkID0gISF2YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGVuYWJsZWQ7XG4gIH07XG5cblxuICAvKiBEZXNpZ24gbm90ZXMgb24gdGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gZm9yIFNDRS5cbiAgICpcbiAgICogVGhlIEFQSSBjb250cmFjdCBmb3IgdGhlIFNDRSBkZWxlZ2F0ZVxuICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAqIFRoZSBTQ0UgZGVsZWdhdGUgb2JqZWN0IG11c3QgcHJvdmlkZSB0aGUgZm9sbG93aW5nIDMgbWV0aG9kczpcbiAgICpcbiAgICogLSB0cnVzdEFzKGNvbnRleHRFbnVtLCB2YWx1ZSlcbiAgICogICAgIFRoaXMgbWV0aG9kIGlzIHVzZWQgdG8gdGVsbCB0aGUgU0NFIHNlcnZpY2UgdGhhdCB0aGUgcHJvdmlkZWQgdmFsdWUgaXMgT0sgdG8gdXNlIGluIHRoZVxuICAgKiAgICAgY29udGV4dHMgc3BlY2lmaWVkIGJ5IGNvbnRleHRFbnVtLiAgSXQgbXVzdCByZXR1cm4gYW4gb2JqZWN0IHRoYXQgd2lsbCBiZSBhY2NlcHRlZCBieVxuICAgKiAgICAgZ2V0VHJ1c3RlZCgpIGZvciBhIGNvbXBhdGlibGUgY29udGV4dEVudW0gYW5kIHJldHVybiB0aGlzIHZhbHVlLlxuICAgKlxuICAgKiAtIHZhbHVlT2YodmFsdWUpXG4gICAqICAgICBGb3IgdmFsdWVzIHRoYXQgd2VyZSBub3QgcHJvZHVjZWQgYnkgdHJ1c3RBcygpLCByZXR1cm4gdGhlbSBhcyBpcy4gIEZvciB2YWx1ZXMgdGhhdCB3ZXJlXG4gICAqICAgICBwcm9kdWNlZCBieSB0cnVzdEFzKCksIHJldHVybiB0aGUgY29ycmVzcG9uZGluZyBpbnB1dCB2YWx1ZSB0byB0cnVzdEFzLiAgQmFzaWNhbGx5LCBpZlxuICAgKiAgICAgdHJ1c3RBcyBpcyB3cmFwcGluZyB0aGUgZ2l2ZW4gdmFsdWVzIGludG8gc29tZSB0eXBlLCB0aGlzIG9wZXJhdGlvbiB1bndyYXBzIGl0IHdoZW4gZ2l2ZW5cbiAgICogICAgIHN1Y2ggYSB2YWx1ZS5cbiAgICpcbiAgICogLSBnZXRUcnVzdGVkKGNvbnRleHRFbnVtLCB2YWx1ZSlcbiAgICogICAgIFRoaXMgZnVuY3Rpb24gc2hvdWxkIHJldHVybiB0aGUgYSB2YWx1ZSB0aGF0IGlzIHNhZmUgdG8gdXNlIGluIHRoZSBjb250ZXh0IHNwZWNpZmllZCBieVxuICAgKiAgICAgY29udGV4dEVudW0gb3IgdGhyb3cgYW5kIGV4Y2VwdGlvbiBvdGhlcndpc2UuXG4gICAqXG4gICAqIE5PVEU6IFRoaXMgY29udHJhY3QgZGVsaWJlcmF0ZWx5IGRvZXMgTk9UIHN0YXRlIHRoYXQgdmFsdWVzIHJldHVybmVkIGJ5IHRydXN0QXMoKSBtdXN0IGJlXG4gICAqIG9wYXF1ZSBvciB3cmFwcGVkIGluIHNvbWUgaG9sZGVyIG9iamVjdC4gIFRoYXQgaGFwcGVucyB0byBiZSBhbiBpbXBsZW1lbnRhdGlvbiBkZXRhaWwuICBGb3JcbiAgICogaW5zdGFuY2UsIGFuIGltcGxlbWVudGF0aW9uIGNvdWxkIG1haW50YWluIGEgcmVnaXN0cnkgb2YgYWxsIHRydXN0ZWQgb2JqZWN0cyBieSBjb250ZXh0LiAgSW5cbiAgICogc3VjaCBhIGNhc2UsIHRydXN0QXMoKSB3b3VsZCByZXR1cm4gdGhlIHNhbWUgb2JqZWN0IHRoYXQgd2FzIHBhc3NlZCBpbi4gIGdldFRydXN0ZWQoKSB3b3VsZFxuICAgKiByZXR1cm4gdGhlIHNhbWUgb2JqZWN0IHBhc3NlZCBpbiBpZiBpdCB3YXMgZm91bmQgaW4gdGhlIHJlZ2lzdHJ5IHVuZGVyIGEgY29tcGF0aWJsZSBjb250ZXh0IG9yXG4gICAqIHRocm93IGFuIGV4Y2VwdGlvbiBvdGhlcndpc2UuICBBbiBpbXBsZW1lbnRhdGlvbiBtaWdodCBvbmx5IHdyYXAgdmFsdWVzIHNvbWUgb2YgdGhlIHRpbWUgYmFzZWRcbiAgICogb24gc29tZSBjcml0ZXJpYS4gIGdldFRydXN0ZWQoKSBtaWdodCByZXR1cm4gYSB2YWx1ZSBhbmQgbm90IHRocm93IGFuIGV4Y2VwdGlvbiBmb3Igc3BlY2lhbFxuICAgKiBjb25zdGFudHMgb3Igb2JqZWN0cyBldmVuIGlmIG5vdCB3cmFwcGVkLiAgQWxsIHN1Y2ggaW1wbGVtZW50YXRpb25zIGZ1bGZpbGwgdGhpcyBjb250cmFjdC5cbiAgICpcbiAgICpcbiAgICogQSBub3RlIG9uIHRoZSBpbmhlcml0YW5jZSBtb2RlbCBmb3IgU0NFIGNvbnRleHRzXG4gICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgKiBJJ3ZlIHVzZWQgaW5oZXJpdGFuY2UgYW5kIG1hZGUgUkVTT1VSQ0VfVVJMIHdyYXBwZWQgdHlwZXMgYSBzdWJ0eXBlIG9mIFVSTCB3cmFwcGVkIHR5cGVzLiAgVGhpc1xuICAgKiBpcyBwdXJlbHkgYW4gaW1wbGVtZW50YXRpb24gZGV0YWlscy5cbiAgICpcbiAgICogVGhlIGNvbnRyYWN0IGlzIHNpbXBseSB0aGlzOlxuICAgKlxuICAgKiAgICAgZ2V0VHJ1c3RlZCgkc2NlLlJFU09VUkNFX1VSTCwgdmFsdWUpIHN1Y2NlZWRpbmcgaW1wbGllcyB0aGF0IGdldFRydXN0ZWQoJHNjZS5VUkwsIHZhbHVlKVxuICAgKiAgICAgd2lsbCBhbHNvIHN1Y2NlZWQuXG4gICAqXG4gICAqIEluaGVyaXRhbmNlIGhhcHBlbnMgdG8gY2FwdHVyZSB0aGlzIGluIGEgbmF0dXJhbCB3YXkuICBJbiBzb21lIGZ1dHVyZSwgd2VcbiAgICogbWF5IG5vdCB1c2UgaW5oZXJpdGFuY2UgYW55bW9yZS4gIFRoYXQgaXMgT0sgYmVjYXVzZSBubyBjb2RlIG91dHNpZGUgb2ZcbiAgICogc2NlLmpzIGFuZCBzY2VTcGVjcy5qcyB3b3VsZCBuZWVkIHRvIGJlIGF3YXJlIG9mIHRoaXMgZGV0YWlsLlxuICAgKi9cblxuICB0aGlzLiRnZXQgPSBbJyRwYXJzZScsICckc2NlRGVsZWdhdGUnLCBmdW5jdGlvbihcbiAgICAgICAgICAgICAgICAkcGFyc2UsICAgJHNjZURlbGVnYXRlKSB7XG4gICAgLy8gUHJlcmVxOiBFbnN1cmUgdGhhdCB3ZSdyZSBub3QgcnVubmluZyBpbiBJRTwxMSBxdWlya3MgbW9kZS4gIEluIHRoYXQgbW9kZSwgSUUgPCAxMSBhbGxvd1xuICAgIC8vIHRoZSBcImV4cHJlc3Npb24oamF2YXNjcmlwdCBleHByZXNzaW9uKVwiIHN5bnRheCB3aGljaCBpcyBpbnNlY3VyZS5cbiAgICBpZiAoZW5hYmxlZCAmJiBtc2llIDwgOCkge1xuICAgICAgdGhyb3cgJHNjZU1pbkVycignaWVxdWlya3MnLFxuICAgICAgICAnU3RyaWN0IENvbnRleHR1YWwgRXNjYXBpbmcgZG9lcyBub3Qgc3VwcG9ydCBJbnRlcm5ldCBFeHBsb3JlciB2ZXJzaW9uIDwgMTEgaW4gcXVpcmtzICcgK1xuICAgICAgICAnbW9kZS4gIFlvdSBjYW4gZml4IHRoaXMgYnkgYWRkaW5nIHRoZSB0ZXh0IDwhZG9jdHlwZSBodG1sPiB0byB0aGUgdG9wIG9mIHlvdXIgSFRNTCAnICtcbiAgICAgICAgJ2RvY3VtZW50LiAgU2VlIGh0dHA6Ly9kb2NzLmFuZ3VsYXJqcy5vcmcvYXBpL25nLiRzY2UgZm9yIG1vcmUgaW5mb3JtYXRpb24uJyk7XG4gICAgfVxuXG4gICAgdmFyIHNjZSA9IHNoYWxsb3dDb3B5KFNDRV9DT05URVhUUyk7XG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgJHNjZSNpc0VuYWJsZWRcbiAgICAgKiBAa2luZCBmdW5jdGlvblxuICAgICAqXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gdHJ1ZSBpZiBTQ0UgaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLiAgSWYgeW91IHdhbnQgdG8gc2V0IHRoZSB2YWx1ZSwgeW91XG4gICAgICogaGF2ZSB0byBkbyBpdCBhdCBtb2R1bGUgY29uZmlnIHRpbWUgb24ge0BsaW5rIG5nLiRzY2VQcm92aWRlciAkc2NlUHJvdmlkZXJ9LlxuICAgICAqXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICogUmV0dXJucyBhIGJvb2xlYW4gaW5kaWNhdGluZyBpZiBTQ0UgaXMgZW5hYmxlZC5cbiAgICAgKi9cbiAgICBzY2UuaXNFbmFibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZW5hYmxlZDtcbiAgICB9O1xuICAgIHNjZS50cnVzdEFzID0gJHNjZURlbGVnYXRlLnRydXN0QXM7XG4gICAgc2NlLmdldFRydXN0ZWQgPSAkc2NlRGVsZWdhdGUuZ2V0VHJ1c3RlZDtcbiAgICBzY2UudmFsdWVPZiA9ICRzY2VEZWxlZ2F0ZS52YWx1ZU9mO1xuXG4gICAgaWYgKCFlbmFibGVkKSB7XG4gICAgICBzY2UudHJ1c3RBcyA9IHNjZS5nZXRUcnVzdGVkID0gZnVuY3Rpb24odHlwZSwgdmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9O1xuICAgICAgc2NlLnZhbHVlT2YgPSBpZGVudGl0eTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgJHNjZSNwYXJzZUFzXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBDb252ZXJ0cyBBbmd1bGFyIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259IGludG8gYSBmdW5jdGlvbi4gIFRoaXMgaXMgbGlrZSB7QGxpbmtcbiAgICAgKiBuZy4kcGFyc2UgJHBhcnNlfSBhbmQgaXMgaWRlbnRpY2FsIHdoZW4gdGhlIGV4cHJlc3Npb24gaXMgYSBsaXRlcmFsIGNvbnN0YW50LiAgT3RoZXJ3aXNlLCBpdFxuICAgICAqIHdyYXBzIHRoZSBleHByZXNzaW9uIGluIGEgY2FsbCB0byB7QGxpbmsgbmcuJHNjZSNnZXRUcnVzdGVkICRzY2UuZ2V0VHJ1c3RlZCgqdHlwZSosXG4gICAgICogKnJlc3VsdCopfVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVGhlIGtpbmQgb2YgU0NFIGNvbnRleHQgaW4gd2hpY2ggdGhpcyByZXN1bHQgd2lsbCBiZSB1c2VkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBleHByZXNzaW9uIFN0cmluZyBleHByZXNzaW9uIHRvIGNvbXBpbGUuXG4gICAgICogQHJldHVybnMge2Z1bmN0aW9uKGNvbnRleHQsIGxvY2Fscyl9IGEgZnVuY3Rpb24gd2hpY2ggcmVwcmVzZW50cyB0aGUgY29tcGlsZWQgZXhwcmVzc2lvbjpcbiAgICAgKlxuICAgICAqICAgICogYGNvbnRleHRgIOKAkyBge29iamVjdH1gIOKAkyBhbiBvYmplY3QgYWdhaW5zdCB3aGljaCBhbnkgZXhwcmVzc2lvbnMgZW1iZWRkZWQgaW4gdGhlIHN0cmluZ3NcbiAgICAgKiAgICAgIGFyZSBldmFsdWF0ZWQgYWdhaW5zdCAodHlwaWNhbGx5IGEgc2NvcGUgb2JqZWN0KS5cbiAgICAgKiAgICAqIGBsb2NhbHNgIOKAkyBge29iamVjdD19YCDigJMgbG9jYWwgdmFyaWFibGVzIGNvbnRleHQgb2JqZWN0LCB1c2VmdWwgZm9yIG92ZXJyaWRpbmcgdmFsdWVzIGluXG4gICAgICogICAgICBgY29udGV4dGAuXG4gICAgICovXG4gICAgc2NlLnBhcnNlQXMgPSBmdW5jdGlvbiBzY2VQYXJzZUFzKHR5cGUsIGV4cHIpIHtcbiAgICAgIHZhciBwYXJzZWQgPSAkcGFyc2UoZXhwcik7XG4gICAgICBpZiAocGFyc2VkLmxpdGVyYWwgJiYgcGFyc2VkLmNvbnN0YW50KSB7XG4gICAgICAgIHJldHVybiBwYXJzZWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJHBhcnNlKGV4cHIsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHNjZS5nZXRUcnVzdGVkKHR5cGUsIHZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkc2NlI3RydXN0QXNcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIERlbGVnYXRlcyB0byB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI3RydXN0QXMgYCRzY2VEZWxlZ2F0ZS50cnVzdEFzYH0uICBBcyBzdWNoLFxuICAgICAqIHJldHVybnMgYW4gb2JqZWN0IHRoYXQgaXMgdHJ1c3RlZCBieSBhbmd1bGFyIGZvciB1c2UgaW4gc3BlY2lmaWVkIHN0cmljdCBjb250ZXh0dWFsXG4gICAgICogZXNjYXBpbmcgY29udGV4dHMgKHN1Y2ggYXMgbmctYmluZC1odG1sLCBuZy1pbmNsdWRlLCBhbnkgc3JjIGF0dHJpYnV0ZVxuICAgICAqIGludGVycG9sYXRpb24sIGFueSBkb20gZXZlbnQgYmluZGluZyBhdHRyaWJ1dGUgaW50ZXJwb2xhdGlvbiBzdWNoIGFzIGZvciBvbmNsaWNrLCAgZXRjLilcbiAgICAgKiB0aGF0IHVzZXMgdGhlIHByb3ZpZGVkIHZhbHVlLiAgU2VlICoge0BsaW5rIG5nLiRzY2UgJHNjZX0gZm9yIGVuYWJsaW5nIHN0cmljdCBjb250ZXh0dWFsXG4gICAgICogZXNjYXBpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBUaGUga2luZCBvZiBjb250ZXh0IGluIHdoaWNoIHRoaXMgdmFsdWUgaXMgc2FmZSBmb3IgdXNlLiAgZS5nLiB1cmwsXG4gICAgICogICByZXNvdXJjZVVybCwgaHRtbCwganMgYW5kIGNzcy5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0aGF0IHRoYXQgc2hvdWxkIGJlIGNvbnNpZGVyZWQgdHJ1c3RlZC9zYWZlLlxuICAgICAqIEByZXR1cm5zIHsqfSBBIHZhbHVlIHRoYXQgY2FuIGJlIHVzZWQgdG8gc3RhbmQgaW4gZm9yIHRoZSBwcm92aWRlZCBgdmFsdWVgIGluIHBsYWNlc1xuICAgICAqIHdoZXJlIEFuZ3VsYXIgZXhwZWN0cyBhICRzY2UudHJ1c3RBcygpIHJldHVybiB2YWx1ZS5cbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkc2NlI3RydXN0QXNIdG1sXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBTaG9ydGhhbmQgbWV0aG9kLiAgYCRzY2UudHJ1c3RBc0h0bWwodmFsdWUpYCDihpJcbiAgICAgKiAgICAge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZSN0cnVzdEFzIGAkc2NlRGVsZWdhdGUudHJ1c3RBcygkc2NlLkhUTUwsIHZhbHVlKWB9XG4gICAgICpcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byB0cnVzdEFzLlxuICAgICAqIEByZXR1cm5zIHsqfSBBbiBvYmplY3QgdGhhdCBjYW4gYmUgcGFzc2VkIHRvIHtAbGluayBuZy4kc2NlI2dldFRydXN0ZWRIdG1sXG4gICAgICogICAgICRzY2UuZ2V0VHJ1c3RlZEh0bWwodmFsdWUpfSB0byBvYnRhaW4gdGhlIG9yaWdpbmFsIHZhbHVlLiAgKHByaXZpbGVnZWQgZGlyZWN0aXZlc1xuICAgICAqICAgICBvbmx5IGFjY2VwdCBleHByZXNzaW9ucyB0aGF0IGFyZSBlaXRoZXIgbGl0ZXJhbCBjb25zdGFudHMgb3IgYXJlIHRoZVxuICAgICAqICAgICByZXR1cm4gdmFsdWUgb2Yge0BsaW5rIG5nLiRzY2UjdHJ1c3RBcyAkc2NlLnRydXN0QXN9LilcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkc2NlI3RydXN0QXNVcmxcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS50cnVzdEFzVXJsKHZhbHVlKWAg4oaSXG4gICAgICogICAgIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjdHJ1c3RBcyBgJHNjZURlbGVnYXRlLnRydXN0QXMoJHNjZS5VUkwsIHZhbHVlKWB9XG4gICAgICpcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byB0cnVzdEFzLlxuICAgICAqIEByZXR1cm5zIHsqfSBBbiBvYmplY3QgdGhhdCBjYW4gYmUgcGFzc2VkIHRvIHtAbGluayBuZy4kc2NlI2dldFRydXN0ZWRVcmxcbiAgICAgKiAgICAgJHNjZS5nZXRUcnVzdGVkVXJsKHZhbHVlKX0gdG8gb2J0YWluIHRoZSBvcmlnaW5hbCB2YWx1ZS4gIChwcml2aWxlZ2VkIGRpcmVjdGl2ZXNcbiAgICAgKiAgICAgb25seSBhY2NlcHQgZXhwcmVzc2lvbnMgdGhhdCBhcmUgZWl0aGVyIGxpdGVyYWwgY29uc3RhbnRzIG9yIGFyZSB0aGVcbiAgICAgKiAgICAgcmV0dXJuIHZhbHVlIG9mIHtAbGluayBuZy4kc2NlI3RydXN0QXMgJHNjZS50cnVzdEFzfS4pXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgJHNjZSN0cnVzdEFzUmVzb3VyY2VVcmxcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS50cnVzdEFzUmVzb3VyY2VVcmwodmFsdWUpYCDihpJcbiAgICAgKiAgICAge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZSN0cnVzdEFzIGAkc2NlRGVsZWdhdGUudHJ1c3RBcygkc2NlLlJFU09VUkNFX1VSTCwgdmFsdWUpYH1cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHRydXN0QXMuXG4gICAgICogQHJldHVybnMgeyp9IEFuIG9iamVjdCB0aGF0IGNhbiBiZSBwYXNzZWQgdG8ge0BsaW5rIG5nLiRzY2UjZ2V0VHJ1c3RlZFJlc291cmNlVXJsXG4gICAgICogICAgICRzY2UuZ2V0VHJ1c3RlZFJlc291cmNlVXJsKHZhbHVlKX0gdG8gb2J0YWluIHRoZSBvcmlnaW5hbCB2YWx1ZS4gIChwcml2aWxlZ2VkIGRpcmVjdGl2ZXNcbiAgICAgKiAgICAgb25seSBhY2NlcHQgZXhwcmVzc2lvbnMgdGhhdCBhcmUgZWl0aGVyIGxpdGVyYWwgY29uc3RhbnRzIG9yIGFyZSB0aGUgcmV0dXJuXG4gICAgICogICAgIHZhbHVlIG9mIHtAbGluayBuZy4kc2NlI3RydXN0QXMgJHNjZS50cnVzdEFzfS4pXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgJHNjZSN0cnVzdEFzSnNcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS50cnVzdEFzSnModmFsdWUpYCDihpJcbiAgICAgKiAgICAge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZSN0cnVzdEFzIGAkc2NlRGVsZWdhdGUudHJ1c3RBcygkc2NlLkpTLCB2YWx1ZSlgfVxuICAgICAqXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gdHJ1c3RBcy5cbiAgICAgKiBAcmV0dXJucyB7Kn0gQW4gb2JqZWN0IHRoYXQgY2FuIGJlIHBhc3NlZCB0byB7QGxpbmsgbmcuJHNjZSNnZXRUcnVzdGVkSnNcbiAgICAgKiAgICAgJHNjZS5nZXRUcnVzdGVkSnModmFsdWUpfSB0byBvYnRhaW4gdGhlIG9yaWdpbmFsIHZhbHVlLiAgKHByaXZpbGVnZWQgZGlyZWN0aXZlc1xuICAgICAqICAgICBvbmx5IGFjY2VwdCBleHByZXNzaW9ucyB0aGF0IGFyZSBlaXRoZXIgbGl0ZXJhbCBjb25zdGFudHMgb3IgYXJlIHRoZVxuICAgICAqICAgICByZXR1cm4gdmFsdWUgb2Yge0BsaW5rIG5nLiRzY2UjdHJ1c3RBcyAkc2NlLnRydXN0QXN9LilcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkc2NlI2dldFRydXN0ZWRcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIERlbGVnYXRlcyB0byB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI2dldFRydXN0ZWQgYCRzY2VEZWxlZ2F0ZS5nZXRUcnVzdGVkYH0uICBBcyBzdWNoLFxuICAgICAqIHRha2VzIHRoZSByZXN1bHQgb2YgYSB7QGxpbmsgbmcuJHNjZSN0cnVzdEFzIGAkc2NlLnRydXN0QXNgfSgpIGNhbGwgYW5kIHJldHVybnMgdGhlXG4gICAgICogb3JpZ2luYWxseSBzdXBwbGllZCB2YWx1ZSBpZiB0aGUgcXVlcmllZCBjb250ZXh0IHR5cGUgaXMgYSBzdXBlcnR5cGUgb2YgdGhlIGNyZWF0ZWQgdHlwZS5cbiAgICAgKiBJZiB0aGlzIGNvbmRpdGlvbiBpc24ndCBzYXRpc2ZpZWQsIHRocm93cyBhbiBleGNlcHRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBUaGUga2luZCBvZiBjb250ZXh0IGluIHdoaWNoIHRoaXMgdmFsdWUgaXMgdG8gYmUgdXNlZC5cbiAgICAgKiBAcGFyYW0geyp9IG1heWJlVHJ1c3RlZCBUaGUgcmVzdWx0IG9mIGEgcHJpb3Ige0BsaW5rIG5nLiRzY2UjdHJ1c3RBcyBgJHNjZS50cnVzdEFzYH1cbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsLlxuICAgICAqIEByZXR1cm5zIHsqfSBUaGUgdmFsdWUgdGhlIHdhcyBvcmlnaW5hbGx5IHByb3ZpZGVkIHRvXG4gICAgICogICAgICAgICAgICAgIHtAbGluayBuZy4kc2NlI3RydXN0QXMgYCRzY2UudHJ1c3RBc2B9IGlmIHZhbGlkIGluIHRoaXMgY29udGV4dC5cbiAgICAgKiAgICAgICAgICAgICAgT3RoZXJ3aXNlLCB0aHJvd3MgYW4gZXhjZXB0aW9uLlxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAqIEBuYW1lICRzY2UjZ2V0VHJ1c3RlZEh0bWxcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS5nZXRUcnVzdGVkSHRtbCh2YWx1ZSlgIOKGklxuICAgICAqICAgICB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI2dldFRydXN0ZWQgYCRzY2VEZWxlZ2F0ZS5nZXRUcnVzdGVkKCRzY2UuSFRNTCwgdmFsdWUpYH1cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHBhc3MgdG8gYCRzY2UuZ2V0VHJ1c3RlZGAuXG4gICAgICogQHJldHVybnMgeyp9IFRoZSByZXR1cm4gdmFsdWUgb2YgYCRzY2UuZ2V0VHJ1c3RlZCgkc2NlLkhUTUwsIHZhbHVlKWBcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkc2NlI2dldFRydXN0ZWRDc3NcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS5nZXRUcnVzdGVkQ3NzKHZhbHVlKWAg4oaSXG4gICAgICogICAgIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjZ2V0VHJ1c3RlZCBgJHNjZURlbGVnYXRlLmdldFRydXN0ZWQoJHNjZS5DU1MsIHZhbHVlKWB9XG4gICAgICpcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBwYXNzIHRvIGAkc2NlLmdldFRydXN0ZWRgLlxuICAgICAqIEByZXR1cm5zIHsqfSBUaGUgcmV0dXJuIHZhbHVlIG9mIGAkc2NlLmdldFRydXN0ZWQoJHNjZS5DU1MsIHZhbHVlKWBcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkc2NlI2dldFRydXN0ZWRVcmxcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS5nZXRUcnVzdGVkVXJsKHZhbHVlKWAg4oaSXG4gICAgICogICAgIHtAbGluayBuZy4kc2NlRGVsZWdhdGUjZ2V0VHJ1c3RlZCBgJHNjZURlbGVnYXRlLmdldFRydXN0ZWQoJHNjZS5VUkwsIHZhbHVlKWB9XG4gICAgICpcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBwYXNzIHRvIGAkc2NlLmdldFRydXN0ZWRgLlxuICAgICAqIEByZXR1cm5zIHsqfSBUaGUgcmV0dXJuIHZhbHVlIG9mIGAkc2NlLmdldFRydXN0ZWQoJHNjZS5VUkwsIHZhbHVlKWBcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkc2NlI2dldFRydXN0ZWRSZXNvdXJjZVVybFxuICAgICAqXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICogU2hvcnRoYW5kIG1ldGhvZC4gIGAkc2NlLmdldFRydXN0ZWRSZXNvdXJjZVVybCh2YWx1ZSlgIOKGklxuICAgICAqICAgICB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI2dldFRydXN0ZWQgYCRzY2VEZWxlZ2F0ZS5nZXRUcnVzdGVkKCRzY2UuUkVTT1VSQ0VfVVJMLCB2YWx1ZSlgfVxuICAgICAqXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gcGFzcyB0byBgJHNjZURlbGVnYXRlLmdldFRydXN0ZWRgLlxuICAgICAqIEByZXR1cm5zIHsqfSBUaGUgcmV0dXJuIHZhbHVlIG9mIGAkc2NlLmdldFRydXN0ZWQoJHNjZS5SRVNPVVJDRV9VUkwsIHZhbHVlKWBcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkc2NlI2dldFRydXN0ZWRKc1xuICAgICAqXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICogU2hvcnRoYW5kIG1ldGhvZC4gIGAkc2NlLmdldFRydXN0ZWRKcyh2YWx1ZSlgIOKGklxuICAgICAqICAgICB7QGxpbmsgbmcuJHNjZURlbGVnYXRlI2dldFRydXN0ZWQgYCRzY2VEZWxlZ2F0ZS5nZXRUcnVzdGVkKCRzY2UuSlMsIHZhbHVlKWB9XG4gICAgICpcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBwYXNzIHRvIGAkc2NlLmdldFRydXN0ZWRgLlxuICAgICAqIEByZXR1cm5zIHsqfSBUaGUgcmV0dXJuIHZhbHVlIG9mIGAkc2NlLmdldFRydXN0ZWQoJHNjZS5KUywgdmFsdWUpYFxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAqIEBuYW1lICRzY2UjcGFyc2VBc0h0bWxcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS5wYXJzZUFzSHRtbChleHByZXNzaW9uIHN0cmluZylgIOKGklxuICAgICAqICAgICB7QGxpbmsgbmcuJHNjZSNwYXJzZUFzIGAkc2NlLnBhcnNlQXMoJHNjZS5IVE1MLCB2YWx1ZSlgfVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGV4cHJlc3Npb24gU3RyaW5nIGV4cHJlc3Npb24gdG8gY29tcGlsZS5cbiAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb24oY29udGV4dCwgbG9jYWxzKX0gYSBmdW5jdGlvbiB3aGljaCByZXByZXNlbnRzIHRoZSBjb21waWxlZCBleHByZXNzaW9uOlxuICAgICAqXG4gICAgICogICAgKiBgY29udGV4dGAg4oCTIGB7b2JqZWN0fWAg4oCTIGFuIG9iamVjdCBhZ2FpbnN0IHdoaWNoIGFueSBleHByZXNzaW9ucyBlbWJlZGRlZCBpbiB0aGUgc3RyaW5nc1xuICAgICAqICAgICAgYXJlIGV2YWx1YXRlZCBhZ2FpbnN0ICh0eXBpY2FsbHkgYSBzY29wZSBvYmplY3QpLlxuICAgICAqICAgICogYGxvY2Fsc2Ag4oCTIGB7b2JqZWN0PX1gIOKAkyBsb2NhbCB2YXJpYWJsZXMgY29udGV4dCBvYmplY3QsIHVzZWZ1bCBmb3Igb3ZlcnJpZGluZyB2YWx1ZXMgaW5cbiAgICAgKiAgICAgIGBjb250ZXh0YC5cbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgKiBAbmFtZSAkc2NlI3BhcnNlQXNDc3NcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS5wYXJzZUFzQ3NzKHZhbHVlKWAg4oaSXG4gICAgICogICAgIHtAbGluayBuZy4kc2NlI3BhcnNlQXMgYCRzY2UucGFyc2VBcygkc2NlLkNTUywgdmFsdWUpYH1cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBleHByZXNzaW9uIFN0cmluZyBleHByZXNzaW9uIHRvIGNvbXBpbGUuXG4gICAgICogQHJldHVybnMge2Z1bmN0aW9uKGNvbnRleHQsIGxvY2Fscyl9IGEgZnVuY3Rpb24gd2hpY2ggcmVwcmVzZW50cyB0aGUgY29tcGlsZWQgZXhwcmVzc2lvbjpcbiAgICAgKlxuICAgICAqICAgICogYGNvbnRleHRgIOKAkyBge29iamVjdH1gIOKAkyBhbiBvYmplY3QgYWdhaW5zdCB3aGljaCBhbnkgZXhwcmVzc2lvbnMgZW1iZWRkZWQgaW4gdGhlIHN0cmluZ3NcbiAgICAgKiAgICAgIGFyZSBldmFsdWF0ZWQgYWdhaW5zdCAodHlwaWNhbGx5IGEgc2NvcGUgb2JqZWN0KS5cbiAgICAgKiAgICAqIGBsb2NhbHNgIOKAkyBge29iamVjdD19YCDigJMgbG9jYWwgdmFyaWFibGVzIGNvbnRleHQgb2JqZWN0LCB1c2VmdWwgZm9yIG92ZXJyaWRpbmcgdmFsdWVzIGluXG4gICAgICogICAgICBgY29udGV4dGAuXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgJHNjZSNwYXJzZUFzVXJsXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBTaG9ydGhhbmQgbWV0aG9kLiAgYCRzY2UucGFyc2VBc1VybCh2YWx1ZSlgIOKGklxuICAgICAqICAgICB7QGxpbmsgbmcuJHNjZSNwYXJzZUFzIGAkc2NlLnBhcnNlQXMoJHNjZS5VUkwsIHZhbHVlKWB9XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXhwcmVzc2lvbiBTdHJpbmcgZXhwcmVzc2lvbiB0byBjb21waWxlLlxuICAgICAqIEByZXR1cm5zIHtmdW5jdGlvbihjb250ZXh0LCBsb2NhbHMpfSBhIGZ1bmN0aW9uIHdoaWNoIHJlcHJlc2VudHMgdGhlIGNvbXBpbGVkIGV4cHJlc3Npb246XG4gICAgICpcbiAgICAgKiAgICAqIGBjb250ZXh0YCDigJMgYHtvYmplY3R9YCDigJMgYW4gb2JqZWN0IGFnYWluc3Qgd2hpY2ggYW55IGV4cHJlc3Npb25zIGVtYmVkZGVkIGluIHRoZSBzdHJpbmdzXG4gICAgICogICAgICBhcmUgZXZhbHVhdGVkIGFnYWluc3QgKHR5cGljYWxseSBhIHNjb3BlIG9iamVjdCkuXG4gICAgICogICAgKiBgbG9jYWxzYCDigJMgYHtvYmplY3Q9fWAg4oCTIGxvY2FsIHZhcmlhYmxlcyBjb250ZXh0IG9iamVjdCwgdXNlZnVsIGZvciBvdmVycmlkaW5nIHZhbHVlcyBpblxuICAgICAqICAgICAgYGNvbnRleHRgLlxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAqIEBuYW1lICRzY2UjcGFyc2VBc1Jlc291cmNlVXJsXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBTaG9ydGhhbmQgbWV0aG9kLiAgYCRzY2UucGFyc2VBc1Jlc291cmNlVXJsKHZhbHVlKWAg4oaSXG4gICAgICogICAgIHtAbGluayBuZy4kc2NlI3BhcnNlQXMgYCRzY2UucGFyc2VBcygkc2NlLlJFU09VUkNFX1VSTCwgdmFsdWUpYH1cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBleHByZXNzaW9uIFN0cmluZyBleHByZXNzaW9uIHRvIGNvbXBpbGUuXG4gICAgICogQHJldHVybnMge2Z1bmN0aW9uKGNvbnRleHQsIGxvY2Fscyl9IGEgZnVuY3Rpb24gd2hpY2ggcmVwcmVzZW50cyB0aGUgY29tcGlsZWQgZXhwcmVzc2lvbjpcbiAgICAgKlxuICAgICAqICAgICogYGNvbnRleHRgIOKAkyBge29iamVjdH1gIOKAkyBhbiBvYmplY3QgYWdhaW5zdCB3aGljaCBhbnkgZXhwcmVzc2lvbnMgZW1iZWRkZWQgaW4gdGhlIHN0cmluZ3NcbiAgICAgKiAgICAgIGFyZSBldmFsdWF0ZWQgYWdhaW5zdCAodHlwaWNhbGx5IGEgc2NvcGUgb2JqZWN0KS5cbiAgICAgKiAgICAqIGBsb2NhbHNgIOKAkyBge29iamVjdD19YCDigJMgbG9jYWwgdmFyaWFibGVzIGNvbnRleHQgb2JqZWN0LCB1c2VmdWwgZm9yIG92ZXJyaWRpbmcgdmFsdWVzIGluXG4gICAgICogICAgICBgY29udGV4dGAuXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICogQG5hbWUgJHNjZSNwYXJzZUFzSnNcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIFNob3J0aGFuZCBtZXRob2QuICBgJHNjZS5wYXJzZUFzSnModmFsdWUpYCDihpJcbiAgICAgKiAgICAge0BsaW5rIG5nLiRzY2UjcGFyc2VBcyBgJHNjZS5wYXJzZUFzKCRzY2UuSlMsIHZhbHVlKWB9XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXhwcmVzc2lvbiBTdHJpbmcgZXhwcmVzc2lvbiB0byBjb21waWxlLlxuICAgICAqIEByZXR1cm5zIHtmdW5jdGlvbihjb250ZXh0LCBsb2NhbHMpfSBhIGZ1bmN0aW9uIHdoaWNoIHJlcHJlc2VudHMgdGhlIGNvbXBpbGVkIGV4cHJlc3Npb246XG4gICAgICpcbiAgICAgKiAgICAqIGBjb250ZXh0YCDigJMgYHtvYmplY3R9YCDigJMgYW4gb2JqZWN0IGFnYWluc3Qgd2hpY2ggYW55IGV4cHJlc3Npb25zIGVtYmVkZGVkIGluIHRoZSBzdHJpbmdzXG4gICAgICogICAgICBhcmUgZXZhbHVhdGVkIGFnYWluc3QgKHR5cGljYWxseSBhIHNjb3BlIG9iamVjdCkuXG4gICAgICogICAgKiBgbG9jYWxzYCDigJMgYHtvYmplY3Q9fWAg4oCTIGxvY2FsIHZhcmlhYmxlcyBjb250ZXh0IG9iamVjdCwgdXNlZnVsIGZvciBvdmVycmlkaW5nIHZhbHVlcyBpblxuICAgICAqICAgICAgYGNvbnRleHRgLlxuICAgICAqL1xuXG4gICAgLy8gU2hvcnRoYW5kIGRlbGVnYXRpb25zLlxuICAgIHZhciBwYXJzZSA9IHNjZS5wYXJzZUFzLFxuICAgICAgICBnZXRUcnVzdGVkID0gc2NlLmdldFRydXN0ZWQsXG4gICAgICAgIHRydXN0QXMgPSBzY2UudHJ1c3RBcztcblxuICAgIGZvckVhY2goU0NFX0NPTlRFWFRTLCBmdW5jdGlvbihlbnVtVmFsdWUsIG5hbWUpIHtcbiAgICAgIHZhciBsTmFtZSA9IGxvd2VyY2FzZShuYW1lKTtcbiAgICAgIHNjZVtjYW1lbENhc2UoXCJwYXJzZV9hc19cIiArIGxOYW1lKV0gPSBmdW5jdGlvbihleHByKSB7XG4gICAgICAgIHJldHVybiBwYXJzZShlbnVtVmFsdWUsIGV4cHIpO1xuICAgICAgfTtcbiAgICAgIHNjZVtjYW1lbENhc2UoXCJnZXRfdHJ1c3RlZF9cIiArIGxOYW1lKV0gPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gZ2V0VHJ1c3RlZChlbnVtVmFsdWUsIHZhbHVlKTtcbiAgICAgIH07XG4gICAgICBzY2VbY2FtZWxDYXNlKFwidHJ1c3RfYXNfXCIgKyBsTmFtZSldID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHRydXN0QXMoZW51bVZhbHVlLCB2YWx1ZSk7XG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNjZTtcbiAgfV07XG59XG5cbi8qKlxuICogISEhIFRoaXMgaXMgYW4gdW5kb2N1bWVudGVkIFwicHJpdmF0ZVwiIHNlcnZpY2UgISEhXG4gKlxuICogQG5hbWUgJHNuaWZmZXJcbiAqIEByZXF1aXJlcyAkd2luZG93XG4gKiBAcmVxdWlyZXMgJGRvY3VtZW50XG4gKlxuICogQHByb3BlcnR5IHtib29sZWFufSBoaXN0b3J5IERvZXMgdGhlIGJyb3dzZXIgc3VwcG9ydCBodG1sNSBoaXN0b3J5IGFwaSA/XG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IHRyYW5zaXRpb25zIERvZXMgdGhlIGJyb3dzZXIgc3VwcG9ydCBDU1MgdHJhbnNpdGlvbiBldmVudHMgP1xuICogQHByb3BlcnR5IHtib29sZWFufSBhbmltYXRpb25zIERvZXMgdGhlIGJyb3dzZXIgc3VwcG9ydCBDU1MgYW5pbWF0aW9uIGV2ZW50cyA/XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGlzIGlzIHZlcnkgc2ltcGxlIGltcGxlbWVudGF0aW9uIG9mIHRlc3RpbmcgYnJvd3NlcidzIGZlYXR1cmVzLlxuICovXG5mdW5jdGlvbiAkU25pZmZlclByb3ZpZGVyKCkge1xuICB0aGlzLiRnZXQgPSBbJyR3aW5kb3cnLCAnJGRvY3VtZW50JywgZnVuY3Rpb24oJHdpbmRvdywgJGRvY3VtZW50KSB7XG4gICAgdmFyIGV2ZW50U3VwcG9ydCA9IHt9LFxuICAgICAgICBhbmRyb2lkID1cbiAgICAgICAgICB0b0ludCgoL2FuZHJvaWQgKFxcZCspLy5leGVjKGxvd2VyY2FzZSgoJHdpbmRvdy5uYXZpZ2F0b3IgfHwge30pLnVzZXJBZ2VudCkpIHx8IFtdKVsxXSksXG4gICAgICAgIGJveGVlID0gL0JveGVlL2kudGVzdCgoJHdpbmRvdy5uYXZpZ2F0b3IgfHwge30pLnVzZXJBZ2VudCksXG4gICAgICAgIGRvY3VtZW50ID0gJGRvY3VtZW50WzBdIHx8IHt9LFxuICAgICAgICB2ZW5kb3JQcmVmaXgsXG4gICAgICAgIHZlbmRvclJlZ2V4ID0gL14oTW96fHdlYmtpdHxtcykoPz1bQS1aXSkvLFxuICAgICAgICBib2R5U3R5bGUgPSBkb2N1bWVudC5ib2R5ICYmIGRvY3VtZW50LmJvZHkuc3R5bGUsXG4gICAgICAgIHRyYW5zaXRpb25zID0gZmFsc2UsXG4gICAgICAgIGFuaW1hdGlvbnMgPSBmYWxzZSxcbiAgICAgICAgbWF0Y2g7XG5cbiAgICBpZiAoYm9keVN0eWxlKSB7XG4gICAgICBmb3IgKHZhciBwcm9wIGluIGJvZHlTdHlsZSkge1xuICAgICAgICBpZiAobWF0Y2ggPSB2ZW5kb3JSZWdleC5leGVjKHByb3ApKSB7XG4gICAgICAgICAgdmVuZG9yUHJlZml4ID0gbWF0Y2hbMF07XG4gICAgICAgICAgdmVuZG9yUHJlZml4ID0gdmVuZG9yUHJlZml4LnN1YnN0cigwLCAxKS50b1VwcGVyQ2FzZSgpICsgdmVuZG9yUHJlZml4LnN1YnN0cigxKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIXZlbmRvclByZWZpeCkge1xuICAgICAgICB2ZW5kb3JQcmVmaXggPSAoJ1dlYmtpdE9wYWNpdHknIGluIGJvZHlTdHlsZSkgJiYgJ3dlYmtpdCc7XG4gICAgICB9XG5cbiAgICAgIHRyYW5zaXRpb25zID0gISEoKCd0cmFuc2l0aW9uJyBpbiBib2R5U3R5bGUpIHx8ICh2ZW5kb3JQcmVmaXggKyAnVHJhbnNpdGlvbicgaW4gYm9keVN0eWxlKSk7XG4gICAgICBhbmltYXRpb25zICA9ICEhKCgnYW5pbWF0aW9uJyBpbiBib2R5U3R5bGUpIHx8ICh2ZW5kb3JQcmVmaXggKyAnQW5pbWF0aW9uJyBpbiBib2R5U3R5bGUpKTtcblxuICAgICAgaWYgKGFuZHJvaWQgJiYgKCF0cmFuc2l0aW9ucyB8fCAgIWFuaW1hdGlvbnMpKSB7XG4gICAgICAgIHRyYW5zaXRpb25zID0gaXNTdHJpbmcoYm9keVN0eWxlLndlYmtpdFRyYW5zaXRpb24pO1xuICAgICAgICBhbmltYXRpb25zID0gaXNTdHJpbmcoYm9keVN0eWxlLndlYmtpdEFuaW1hdGlvbik7XG4gICAgICB9XG4gICAgfVxuXG5cbiAgICByZXR1cm4ge1xuICAgICAgLy8gQW5kcm9pZCBoYXMgaGlzdG9yeS5wdXNoU3RhdGUsIGJ1dCBpdCBkb2VzIG5vdCB1cGRhdGUgbG9jYXRpb24gY29ycmVjdGx5XG4gICAgICAvLyBzbyBsZXQncyBub3QgdXNlIHRoZSBoaXN0b3J5IEFQSSBhdCBhbGwuXG4gICAgICAvLyBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvYW5kcm9pZC9pc3N1ZXMvZGV0YWlsP2lkPTE3NDcxXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL2lzc3Vlcy85MDRcblxuICAgICAgLy8gb2xkZXIgd2Via2l0IGJyb3dzZXIgKDUzMy45KSBvbiBCb3hlZSBib3ggaGFzIGV4YWN0bHkgdGhlIHNhbWUgcHJvYmxlbSBhcyBBbmRyb2lkIGhhc1xuICAgICAgLy8gc28gbGV0J3Mgbm90IHVzZSB0aGUgaGlzdG9yeSBBUEkgYWxzb1xuICAgICAgLy8gV2UgYXJlIHB1cnBvc2VmdWxseSB1c2luZyBgIShhbmRyb2lkIDwgNClgIHRvIGNvdmVyIHRoZSBjYXNlIHdoZW4gYGFuZHJvaWRgIGlzIHVuZGVmaW5lZFxuICAgICAgLy8ganNoaW50IC1XMDE4XG4gICAgICBoaXN0b3J5OiAhISgkd2luZG93Lmhpc3RvcnkgJiYgJHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSAmJiAhKGFuZHJvaWQgPCA0KSAmJiAhYm94ZWUpLFxuICAgICAgLy8ganNoaW50ICtXMDE4XG4gICAgICBoYXNFdmVudDogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgLy8gSUU5IGltcGxlbWVudHMgJ2lucHV0JyBldmVudCBpdCdzIHNvIGZ1YmFyZWQgdGhhdCB3ZSByYXRoZXIgcHJldGVuZCB0aGF0IGl0IGRvZXNuJ3QgaGF2ZVxuICAgICAgICAvLyBpdC4gSW4gcGFydGljdWxhciB0aGUgZXZlbnQgaXMgbm90IGZpcmVkIHdoZW4gYmFja3NwYWNlIG9yIGRlbGV0ZSBrZXkgYXJlIHByZXNzZWQgb3JcbiAgICAgICAgLy8gd2hlbiBjdXQgb3BlcmF0aW9uIGlzIHBlcmZvcm1lZC5cbiAgICAgICAgLy8gSUUxMCsgaW1wbGVtZW50cyAnaW5wdXQnIGV2ZW50IGJ1dCBpdCBlcnJvbmVvdXNseSBmaXJlcyB1bmRlciB2YXJpb3VzIHNpdHVhdGlvbnMsXG4gICAgICAgIC8vIGUuZy4gd2hlbiBwbGFjZWhvbGRlciBjaGFuZ2VzLCBvciBhIGZvcm0gaXMgZm9jdXNlZC5cbiAgICAgICAgaWYgKGV2ZW50ID09PSAnaW5wdXQnICYmIG1zaWUgPD0gMTEpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBpZiAoaXNVbmRlZmluZWQoZXZlbnRTdXBwb3J0W2V2ZW50XSkpIHtcbiAgICAgICAgICB2YXIgZGl2RWxtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgZXZlbnRTdXBwb3J0W2V2ZW50XSA9ICdvbicgKyBldmVudCBpbiBkaXZFbG07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZXZlbnRTdXBwb3J0W2V2ZW50XTtcbiAgICAgIH0sXG4gICAgICBjc3A6IGNzcCgpLFxuICAgICAgdmVuZG9yUHJlZml4OiB2ZW5kb3JQcmVmaXgsXG4gICAgICB0cmFuc2l0aW9uczogdHJhbnNpdGlvbnMsXG4gICAgICBhbmltYXRpb25zOiBhbmltYXRpb25zLFxuICAgICAgYW5kcm9pZDogYW5kcm9pZFxuICAgIH07XG4gIH1dO1xufVxuXG52YXIgJGNvbXBpbGVNaW5FcnIgPSBtaW5FcnIoJyRjb21waWxlJyk7XG5cbi8qKlxuICogQG5nZG9jIHByb3ZpZGVyXG4gKiBAbmFtZSAkdGVtcGxhdGVSZXF1ZXN0UHJvdmlkZXJcbiAqIEBkZXNjcmlwdGlvblxuICogVXNlZCB0byBjb25maWd1cmUgdGhlIG9wdGlvbnMgcGFzc2VkIHRvIHRoZSB7QGxpbmsgJGh0dHB9IHNlcnZpY2Ugd2hlbiBtYWtpbmcgYSB0ZW1wbGF0ZSByZXF1ZXN0LlxuICpcbiAqIEZvciBleGFtcGxlLCBpdCBjYW4gYmUgdXNlZCBmb3Igc3BlY2lmeWluZyB0aGUgXCJBY2NlcHRcIiBoZWFkZXIgdGhhdCBpcyBzZW50IHRvIHRoZSBzZXJ2ZXIsIHdoZW5cbiAqIHJlcXVlc3RpbmcgYSB0ZW1wbGF0ZS5cbiAqL1xuZnVuY3Rpb24gJFRlbXBsYXRlUmVxdWVzdFByb3ZpZGVyKCkge1xuXG4gIHZhciBodHRwT3B0aW9ucztcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSAkdGVtcGxhdGVSZXF1ZXN0UHJvdmlkZXIjaHR0cE9wdGlvbnNcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFRoZSBvcHRpb25zIHRvIGJlIHBhc3NlZCB0byB0aGUge0BsaW5rICRodHRwfSBzZXJ2aWNlIHdoZW4gbWFraW5nIHRoZSByZXF1ZXN0LlxuICAgKiBZb3UgY2FuIHVzZSB0aGlzIHRvIG92ZXJyaWRlIG9wdGlvbnMgc3VjaCBhcyB0aGUgXCJBY2NlcHRcIiBoZWFkZXIgZm9yIHRlbXBsYXRlIHJlcXVlc3RzLlxuICAgKlxuICAgKiBUaGUge0BsaW5rICR0ZW1wbGF0ZVJlcXVlc3R9IHdpbGwgc2V0IHRoZSBgY2FjaGVgIGFuZCB0aGUgYHRyYW5zZm9ybVJlc3BvbnNlYCBwcm9wZXJ0aWVzIG9mIHRoZVxuICAgKiBvcHRpb25zIGlmIG5vdCBvdmVycmlkZGVuIGhlcmUuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gdmFsdWUgbmV3IHZhbHVlIGZvciB0aGUge0BsaW5rICRodHRwfSBvcHRpb25zLlxuICAgKiBAcmV0dXJucyB7c3RyaW5nfHNlbGZ9IFJldHVybnMgdGhlIHtAbGluayAkaHR0cH0gb3B0aW9ucyB3aGVuIHVzZWQgYXMgZ2V0dGVyIGFuZCBzZWxmIGlmIHVzZWQgYXMgc2V0dGVyLlxuICAgKi9cbiAgdGhpcy5odHRwT3B0aW9ucyA9IGZ1bmN0aW9uKHZhbCkge1xuICAgIGlmICh2YWwpIHtcbiAgICAgIGh0dHBPcHRpb25zID0gdmFsO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHJldHVybiBodHRwT3B0aW9ucztcbiAgfTtcblxuICAvKipcbiAgICogQG5nZG9jIHNlcnZpY2VcbiAgICogQG5hbWUgJHRlbXBsYXRlUmVxdWVzdFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogVGhlIGAkdGVtcGxhdGVSZXF1ZXN0YCBzZXJ2aWNlIHJ1bnMgc2VjdXJpdHkgY2hlY2tzIHRoZW4gZG93bmxvYWRzIHRoZSBwcm92aWRlZCB0ZW1wbGF0ZSB1c2luZ1xuICAgKiBgJGh0dHBgIGFuZCwgdXBvbiBzdWNjZXNzLCBzdG9yZXMgdGhlIGNvbnRlbnRzIGluc2lkZSBvZiBgJHRlbXBsYXRlQ2FjaGVgLiBJZiB0aGUgSFRUUCByZXF1ZXN0XG4gICAqIGZhaWxzIG9yIHRoZSByZXNwb25zZSBkYXRhIG9mIHRoZSBIVFRQIHJlcXVlc3QgaXMgZW1wdHksIGEgYCRjb21waWxlYCBlcnJvciB3aWxsIGJlIHRocm93biAodGhlXG4gICAqIGV4Y2VwdGlvbiBjYW4gYmUgdGh3YXJ0ZWQgYnkgc2V0dGluZyB0aGUgMm5kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gdG8gdHJ1ZSkuIE5vdGUgdGhhdCB0aGVcbiAgICogY29udGVudHMgb2YgYCR0ZW1wbGF0ZUNhY2hlYCBhcmUgdHJ1c3RlZCwgc28gdGhlIGNhbGwgdG8gYCRzY2UuZ2V0VHJ1c3RlZFVybCh0cGwpYCBpcyBvbWl0dGVkXG4gICAqIHdoZW4gYHRwbGAgaXMgb2YgdHlwZSBzdHJpbmcgYW5kIGAkdGVtcGxhdGVDYWNoZWAgaGFzIHRoZSBtYXRjaGluZyBlbnRyeS5cbiAgICpcbiAgICogSWYgeW91IHdhbnQgdG8gcGFzcyBjdXN0b20gb3B0aW9ucyB0byB0aGUgYCRodHRwYCBzZXJ2aWNlLCBzdWNoIGFzIHNldHRpbmcgdGhlIEFjY2VwdCBoZWFkZXIgeW91XG4gICAqIGNhbiBjb25maWd1cmUgdGhpcyB2aWEge0BsaW5rICR0ZW1wbGF0ZVJlcXVlc3RQcm92aWRlciNodHRwT3B0aW9uc30uXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfFRydXN0ZWRSZXNvdXJjZVVybH0gdHBsIFRoZSBIVFRQIHJlcXVlc3QgdGVtcGxhdGUgVVJMXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IGlnbm9yZVJlcXVlc3RFcnJvciBXaGV0aGVyIG9yIG5vdCB0byBpZ25vcmUgdGhlIGV4Y2VwdGlvbiB3aGVuIHRoZSByZXF1ZXN0IGZhaWxzIG9yIHRoZSB0ZW1wbGF0ZSBpcyBlbXB0eVxuICAgKlxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBhIHByb21pc2UgZm9yIHRoZSBIVFRQIHJlc3BvbnNlIGRhdGEgb2YgdGhlIGdpdmVuIFVSTC5cbiAgICpcbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IHRvdGFsUGVuZGluZ1JlcXVlc3RzIHRvdGFsIGFtb3VudCBvZiBwZW5kaW5nIHRlbXBsYXRlIHJlcXVlc3RzIGJlaW5nIGRvd25sb2FkZWQuXG4gICAqL1xuICB0aGlzLiRnZXQgPSBbJyR0ZW1wbGF0ZUNhY2hlJywgJyRodHRwJywgJyRxJywgJyRzY2UnLCBmdW5jdGlvbigkdGVtcGxhdGVDYWNoZSwgJGh0dHAsICRxLCAkc2NlKSB7XG5cbiAgICBmdW5jdGlvbiBoYW5kbGVSZXF1ZXN0Rm4odHBsLCBpZ25vcmVSZXF1ZXN0RXJyb3IpIHtcbiAgICAgIGhhbmRsZVJlcXVlc3RGbi50b3RhbFBlbmRpbmdSZXF1ZXN0cysrO1xuXG4gICAgICAvLyBXZSBjb25zaWRlciB0aGUgdGVtcGxhdGUgY2FjaGUgaG9sZHMgb25seSB0cnVzdGVkIHRlbXBsYXRlcywgc29cbiAgICAgIC8vIHRoZXJlJ3Mgbm8gbmVlZCB0byBnbyB0aHJvdWdoIHdoaXRlbGlzdGluZyBhZ2FpbiBmb3Iga2V5cyB0aGF0IGFscmVhZHlcbiAgICAgIC8vIGFyZSBpbmNsdWRlZCBpbiB0aGVyZS4gVGhpcyBhbHNvIG1ha2VzIEFuZ3VsYXIgYWNjZXB0IGFueSBzY3JpcHRcbiAgICAgIC8vIGRpcmVjdGl2ZSwgbm8gbWF0dGVyIGl0cyBuYW1lLiBIb3dldmVyLCB3ZSBzdGlsbCBuZWVkIHRvIHVud3JhcCB0cnVzdGVkXG4gICAgICAvLyB0eXBlcy5cbiAgICAgIGlmICghaXNTdHJpbmcodHBsKSB8fCAhJHRlbXBsYXRlQ2FjaGUuZ2V0KHRwbCkpIHtcbiAgICAgICAgdHBsID0gJHNjZS5nZXRUcnVzdGVkUmVzb3VyY2VVcmwodHBsKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHRyYW5zZm9ybVJlc3BvbnNlID0gJGh0dHAuZGVmYXVsdHMgJiYgJGh0dHAuZGVmYXVsdHMudHJhbnNmb3JtUmVzcG9uc2U7XG5cbiAgICAgIGlmIChpc0FycmF5KHRyYW5zZm9ybVJlc3BvbnNlKSkge1xuICAgICAgICB0cmFuc2Zvcm1SZXNwb25zZSA9IHRyYW5zZm9ybVJlc3BvbnNlLmZpbHRlcihmdW5jdGlvbih0cmFuc2Zvcm1lcikge1xuICAgICAgICAgIHJldHVybiB0cmFuc2Zvcm1lciAhPT0gZGVmYXVsdEh0dHBSZXNwb25zZVRyYW5zZm9ybTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKHRyYW5zZm9ybVJlc3BvbnNlID09PSBkZWZhdWx0SHR0cFJlc3BvbnNlVHJhbnNmb3JtKSB7XG4gICAgICAgIHRyYW5zZm9ybVJlc3BvbnNlID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuICRodHRwLmdldCh0cGwsIGV4dGVuZCh7XG4gICAgICAgICAgY2FjaGU6ICR0ZW1wbGF0ZUNhY2hlLFxuICAgICAgICAgIHRyYW5zZm9ybVJlc3BvbnNlOiB0cmFuc2Zvcm1SZXNwb25zZVxuICAgICAgICB9LCBodHRwT3B0aW9ucykpXG4gICAgICAgIFsnZmluYWxseSddKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGhhbmRsZVJlcXVlc3RGbi50b3RhbFBlbmRpbmdSZXF1ZXN0cy0tO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICR0ZW1wbGF0ZUNhY2hlLnB1dCh0cGwsIHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICB9LCBoYW5kbGVFcnJvcik7XG5cbiAgICAgIGZ1bmN0aW9uIGhhbmRsZUVycm9yKHJlc3ApIHtcbiAgICAgICAgaWYgKCFpZ25vcmVSZXF1ZXN0RXJyb3IpIHtcbiAgICAgICAgICB0aHJvdyAkY29tcGlsZU1pbkVycigndHBsb2FkJywgJ0ZhaWxlZCB0byBsb2FkIHRlbXBsYXRlOiB7MH0gKEhUVFAgc3RhdHVzOiB7MX0gezJ9KScsXG4gICAgICAgICAgICB0cGwsIHJlc3Auc3RhdHVzLCByZXNwLnN0YXR1c1RleHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaGFuZGxlUmVxdWVzdEZuLnRvdGFsUGVuZGluZ1JlcXVlc3RzID0gMDtcblxuICAgIHJldHVybiBoYW5kbGVSZXF1ZXN0Rm47XG4gIH1dO1xufVxuXG5mdW5jdGlvbiAkJFRlc3RhYmlsaXR5UHJvdmlkZXIoKSB7XG4gIHRoaXMuJGdldCA9IFsnJHJvb3RTY29wZScsICckYnJvd3NlcicsICckbG9jYXRpb24nLFxuICAgICAgIGZ1bmN0aW9uKCRyb290U2NvcGUsICAgJGJyb3dzZXIsICAgJGxvY2F0aW9uKSB7XG5cbiAgICAvKipcbiAgICAgKiBAbmFtZSAkdGVzdGFiaWxpdHlcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIFRoZSBwcml2YXRlICQkdGVzdGFiaWxpdHkgc2VydmljZSBwcm92aWRlcyBhIGNvbGxlY3Rpb24gb2YgbWV0aG9kcyBmb3IgdXNlIHdoZW4gZGVidWdnaW5nXG4gICAgICogb3IgYnkgYXV0b21hdGVkIHRlc3QgYW5kIGRlYnVnZ2luZyB0b29scy5cbiAgICAgKi9cbiAgICB2YXIgdGVzdGFiaWxpdHkgPSB7fTtcblxuICAgIC8qKlxuICAgICAqIEBuYW1lICQkdGVzdGFiaWxpdHkjZmluZEJpbmRpbmdzXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIGVsZW1lbnRzIHRoYXQgYXJlIGJvdW5kICh2aWEgbmctYmluZCBvciB7e319KVxuICAgICAqIHRvIGV4cHJlc3Npb25zIG1hdGNoaW5nIHRoZSBpbnB1dC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCBUaGUgZWxlbWVudCByb290IHRvIHNlYXJjaCBmcm9tLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBleHByZXNzaW9uIFRoZSBiaW5kaW5nIGV4cHJlc3Npb24gdG8gbWF0Y2guXG4gICAgICogQHBhcmFtIHtib29sZWFufSBvcHRfZXhhY3RNYXRjaCBJZiB0cnVlLCBvbmx5IHJldHVybnMgZXhhY3QgbWF0Y2hlc1xuICAgICAqICAgICBmb3IgdGhlIGV4cHJlc3Npb24uIEZpbHRlcnMgYW5kIHdoaXRlc3BhY2UgYXJlIGlnbm9yZWQuXG4gICAgICovXG4gICAgdGVzdGFiaWxpdHkuZmluZEJpbmRpbmdzID0gZnVuY3Rpb24oZWxlbWVudCwgZXhwcmVzc2lvbiwgb3B0X2V4YWN0TWF0Y2gpIHtcbiAgICAgIHZhciBiaW5kaW5ncyA9IGVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbmctYmluZGluZycpO1xuICAgICAgdmFyIG1hdGNoZXMgPSBbXTtcbiAgICAgIGZvckVhY2goYmluZGluZ3MsIGZ1bmN0aW9uKGJpbmRpbmcpIHtcbiAgICAgICAgdmFyIGRhdGFCaW5kaW5nID0gYW5ndWxhci5lbGVtZW50KGJpbmRpbmcpLmRhdGEoJyRiaW5kaW5nJyk7XG4gICAgICAgIGlmIChkYXRhQmluZGluZykge1xuICAgICAgICAgIGZvckVhY2goZGF0YUJpbmRpbmcsIGZ1bmN0aW9uKGJpbmRpbmdOYW1lKSB7XG4gICAgICAgICAgICBpZiAob3B0X2V4YWN0TWF0Y2gpIHtcbiAgICAgICAgICAgICAgdmFyIG1hdGNoZXIgPSBuZXcgUmVnRXhwKCcoXnxcXFxccyknICsgZXNjYXBlRm9yUmVnZXhwKGV4cHJlc3Npb24pICsgJyhcXFxcc3xcXFxcfHwkKScpO1xuICAgICAgICAgICAgICBpZiAobWF0Y2hlci50ZXN0KGJpbmRpbmdOYW1lKSkge1xuICAgICAgICAgICAgICAgIG1hdGNoZXMucHVzaChiaW5kaW5nKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaWYgKGJpbmRpbmdOYW1lLmluZGV4T2YoZXhwcmVzc2lvbikgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICBtYXRjaGVzLnB1c2goYmluZGluZyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gbWF0Y2hlcztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQG5hbWUgJCR0ZXN0YWJpbGl0eSNmaW5kTW9kZWxzXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIGVsZW1lbnRzIHRoYXQgYXJlIHR3by13YXkgZm91bmQgdmlhIG5nLW1vZGVsIHRvXG4gICAgICogZXhwcmVzc2lvbnMgbWF0Y2hpbmcgdGhlIGlucHV0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IFRoZSBlbGVtZW50IHJvb3QgdG8gc2VhcmNoIGZyb20uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGV4cHJlc3Npb24gVGhlIG1vZGVsIGV4cHJlc3Npb24gdG8gbWF0Y2guXG4gICAgICogQHBhcmFtIHtib29sZWFufSBvcHRfZXhhY3RNYXRjaCBJZiB0cnVlLCBvbmx5IHJldHVybnMgZXhhY3QgbWF0Y2hlc1xuICAgICAqICAgICBmb3IgdGhlIGV4cHJlc3Npb24uXG4gICAgICovXG4gICAgdGVzdGFiaWxpdHkuZmluZE1vZGVscyA9IGZ1bmN0aW9uKGVsZW1lbnQsIGV4cHJlc3Npb24sIG9wdF9leGFjdE1hdGNoKSB7XG4gICAgICB2YXIgcHJlZml4ZXMgPSBbJ25nLScsICdkYXRhLW5nLScsICduZ1xcXFw6J107XG4gICAgICBmb3IgKHZhciBwID0gMDsgcCA8IHByZWZpeGVzLmxlbmd0aDsgKytwKSB7XG4gICAgICAgIHZhciBhdHRyaWJ1dGVFcXVhbHMgPSBvcHRfZXhhY3RNYXRjaCA/ICc9JyA6ICcqPSc7XG4gICAgICAgIHZhciBzZWxlY3RvciA9ICdbJyArIHByZWZpeGVzW3BdICsgJ21vZGVsJyArIGF0dHJpYnV0ZUVxdWFscyArICdcIicgKyBleHByZXNzaW9uICsgJ1wiXSc7XG4gICAgICAgIHZhciBlbGVtZW50cyA9IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG4gICAgICAgIGlmIChlbGVtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm4gZWxlbWVudHM7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQG5hbWUgJCR0ZXN0YWJpbGl0eSNnZXRMb2NhdGlvblxuICAgICAqXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICogU2hvcnRjdXQgZm9yIGdldHRpbmcgdGhlIGxvY2F0aW9uIGluIGEgYnJvd3NlciBhZ25vc3RpYyB3YXkuIFJldHVybnNcbiAgICAgKiAgICAgdGhlIHBhdGgsIHNlYXJjaCwgYW5kIGhhc2guIChlLmcuIC9wYXRoP2E9YiNoYXNoKVxuICAgICAqL1xuICAgIHRlc3RhYmlsaXR5LmdldExvY2F0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJGxvY2F0aW9uLnVybCgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBAbmFtZSAkJHRlc3RhYmlsaXR5I3NldExvY2F0aW9uXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBTaG9ydGN1dCBmb3IgbmF2aWdhdGluZyB0byBhIGxvY2F0aW9uIHdpdGhvdXQgZG9pbmcgYSBmdWxsIHBhZ2UgcmVsb2FkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCBUaGUgbG9jYXRpb24gdXJsIChwYXRoLCBzZWFyY2ggYW5kIGhhc2gsXG4gICAgICogICAgIGUuZy4gL3BhdGg/YT1iI2hhc2gpIHRvIGdvIHRvLlxuICAgICAqL1xuICAgIHRlc3RhYmlsaXR5LnNldExvY2F0aW9uID0gZnVuY3Rpb24odXJsKSB7XG4gICAgICBpZiAodXJsICE9PSAkbG9jYXRpb24udXJsKCkpIHtcbiAgICAgICAgJGxvY2F0aW9uLnVybCh1cmwpO1xuICAgICAgICAkcm9vdFNjb3BlLiRkaWdlc3QoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQG5hbWUgJCR0ZXN0YWJpbGl0eSN3aGVuU3RhYmxlXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBDYWxscyB0aGUgY2FsbGJhY2sgd2hlbiAkdGltZW91dCBhbmQgJGh0dHAgcmVxdWVzdHMgYXJlIGNvbXBsZXRlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrXG4gICAgICovXG4gICAgdGVzdGFiaWxpdHkud2hlblN0YWJsZSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICAkYnJvd3Nlci5ub3RpZnlXaGVuTm9PdXRzdGFuZGluZ1JlcXVlc3RzKGNhbGxiYWNrKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRlc3RhYmlsaXR5O1xuICB9XTtcbn1cblxuZnVuY3Rpb24gJFRpbWVvdXRQcm92aWRlcigpIHtcbiAgdGhpcy4kZ2V0ID0gWyckcm9vdFNjb3BlJywgJyRicm93c2VyJywgJyRxJywgJyQkcScsICckZXhjZXB0aW9uSGFuZGxlcicsXG4gICAgICAgZnVuY3Rpb24oJHJvb3RTY29wZSwgICAkYnJvd3NlciwgICAkcSwgICAkJHEsICAgJGV4Y2VwdGlvbkhhbmRsZXIpIHtcblxuICAgIHZhciBkZWZlcnJlZHMgPSB7fTtcblxuXG4gICAgIC8qKlxuICAgICAgKiBAbmdkb2Mgc2VydmljZVxuICAgICAgKiBAbmFtZSAkdGltZW91dFxuICAgICAgKlxuICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICogQW5ndWxhcidzIHdyYXBwZXIgZm9yIGB3aW5kb3cuc2V0VGltZW91dGAuIFRoZSBgZm5gIGZ1bmN0aW9uIGlzIHdyYXBwZWQgaW50byBhIHRyeS9jYXRjaFxuICAgICAgKiBibG9jayBhbmQgZGVsZWdhdGVzIGFueSBleGNlcHRpb25zIHRvXG4gICAgICAqIHtAbGluayBuZy4kZXhjZXB0aW9uSGFuZGxlciAkZXhjZXB0aW9uSGFuZGxlcn0gc2VydmljZS5cbiAgICAgICpcbiAgICAgICogVGhlIHJldHVybiB2YWx1ZSBvZiBjYWxsaW5nIGAkdGltZW91dGAgaXMgYSBwcm9taXNlLCB3aGljaCB3aWxsIGJlIHJlc29sdmVkIHdoZW5cbiAgICAgICogdGhlIGRlbGF5IGhhcyBwYXNzZWQgYW5kIHRoZSB0aW1lb3V0IGZ1bmN0aW9uLCBpZiBwcm92aWRlZCwgaXMgZXhlY3V0ZWQuXG4gICAgICAqXG4gICAgICAqIFRvIGNhbmNlbCBhIHRpbWVvdXQgcmVxdWVzdCwgY2FsbCBgJHRpbWVvdXQuY2FuY2VsKHByb21pc2UpYC5cbiAgICAgICpcbiAgICAgICogSW4gdGVzdHMgeW91IGNhbiB1c2Uge0BsaW5rIG5nTW9jay4kdGltZW91dCBgJHRpbWVvdXQuZmx1c2goKWB9IHRvXG4gICAgICAqIHN5bmNocm9ub3VzbHkgZmx1c2ggdGhlIHF1ZXVlIG9mIGRlZmVycmVkIGZ1bmN0aW9ucy5cbiAgICAgICpcbiAgICAgICogSWYgeW91IG9ubHkgd2FudCBhIHByb21pc2UgdGhhdCB3aWxsIGJlIHJlc29sdmVkIGFmdGVyIHNvbWUgc3BlY2lmaWVkIGRlbGF5XG4gICAgICAqIHRoZW4geW91IGNhbiBjYWxsIGAkdGltZW91dGAgd2l0aG91dCB0aGUgYGZuYCBmdW5jdGlvbi5cbiAgICAgICpcbiAgICAgICogQHBhcmFtIHtmdW5jdGlvbigpPX0gZm4gQSBmdW5jdGlvbiwgd2hvc2UgZXhlY3V0aW9uIHNob3VsZCBiZSBkZWxheWVkLlxuICAgICAgKiBAcGFyYW0ge251bWJlcj19IFtkZWxheT0wXSBEZWxheSBpbiBtaWxsaXNlY29uZHMuXG4gICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IFtpbnZva2VBcHBseT10cnVlXSBJZiBzZXQgdG8gYGZhbHNlYCBza2lwcyBtb2RlbCBkaXJ0eSBjaGVja2luZywgb3RoZXJ3aXNlXG4gICAgICAqICAgd2lsbCBpbnZva2UgYGZuYCB3aXRoaW4gdGhlIHtAbGluayBuZy4kcm9vdFNjb3BlLlNjb3BlIyRhcHBseSAkYXBwbHl9IGJsb2NrLlxuICAgICAgKiBAcGFyYW0gey4uLio9fSBQYXNzIGFkZGl0aW9uYWwgcGFyYW1ldGVycyB0byB0aGUgZXhlY3V0ZWQgZnVuY3Rpb24uXG4gICAgICAqIEByZXR1cm5zIHtQcm9taXNlfSBQcm9taXNlIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB3aGVuIHRoZSB0aW1lb3V0IGlzIHJlYWNoZWQuIFRoZSBwcm9taXNlXG4gICAgICAqICAgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGBmbmAgZnVuY3Rpb24uXG4gICAgICAqXG4gICAgICAqL1xuICAgIGZ1bmN0aW9uIHRpbWVvdXQoZm4sIGRlbGF5LCBpbnZva2VBcHBseSkge1xuICAgICAgaWYgKCFpc0Z1bmN0aW9uKGZuKSkge1xuICAgICAgICBpbnZva2VBcHBseSA9IGRlbGF5O1xuICAgICAgICBkZWxheSA9IGZuO1xuICAgICAgICBmbiA9IG5vb3A7XG4gICAgICB9XG5cbiAgICAgIHZhciBhcmdzID0gc2xpY2VBcmdzKGFyZ3VtZW50cywgMyksXG4gICAgICAgICAgc2tpcEFwcGx5ID0gKGlzRGVmaW5lZChpbnZva2VBcHBseSkgJiYgIWludm9rZUFwcGx5KSxcbiAgICAgICAgICBkZWZlcnJlZCA9IChza2lwQXBwbHkgPyAkJHEgOiAkcSkuZGVmZXIoKSxcbiAgICAgICAgICBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZSxcbiAgICAgICAgICB0aW1lb3V0SWQ7XG5cbiAgICAgIHRpbWVvdXRJZCA9ICRicm93c2VyLmRlZmVyKGZ1bmN0aW9uKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZm4uYXBwbHkobnVsbCwgYXJncykpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGUpO1xuICAgICAgICAgICRleGNlcHRpb25IYW5kbGVyKGUpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgIGRlbGV0ZSBkZWZlcnJlZHNbcHJvbWlzZS4kJHRpbWVvdXRJZF07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXNraXBBcHBseSkgJHJvb3RTY29wZS4kYXBwbHkoKTtcbiAgICAgIH0sIGRlbGF5KTtcblxuICAgICAgcHJvbWlzZS4kJHRpbWVvdXRJZCA9IHRpbWVvdXRJZDtcbiAgICAgIGRlZmVycmVkc1t0aW1lb3V0SWRdID0gZGVmZXJyZWQ7XG5cbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH1cblxuXG4gICAgIC8qKlxuICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAqIEBuYW1lICR0aW1lb3V0I2NhbmNlbFxuICAgICAgKlxuICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICogQ2FuY2VscyBhIHRhc2sgYXNzb2NpYXRlZCB3aXRoIHRoZSBgcHJvbWlzZWAuIEFzIGEgcmVzdWx0IG9mIHRoaXMsIHRoZSBwcm9taXNlIHdpbGwgYmVcbiAgICAgICogcmVzb2x2ZWQgd2l0aCBhIHJlamVjdGlvbi5cbiAgICAgICpcbiAgICAgICogQHBhcmFtIHtQcm9taXNlPX0gcHJvbWlzZSBQcm9taXNlIHJldHVybmVkIGJ5IHRoZSBgJHRpbWVvdXRgIGZ1bmN0aW9uLlxuICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHRhc2sgaGFzbid0IGV4ZWN1dGVkIHlldCBhbmQgd2FzIHN1Y2Nlc3NmdWxseVxuICAgICAgKiAgIGNhbmNlbGVkLlxuICAgICAgKi9cbiAgICB0aW1lb3V0LmNhbmNlbCA9IGZ1bmN0aW9uKHByb21pc2UpIHtcbiAgICAgIGlmIChwcm9taXNlICYmIHByb21pc2UuJCR0aW1lb3V0SWQgaW4gZGVmZXJyZWRzKSB7XG4gICAgICAgIGRlZmVycmVkc1twcm9taXNlLiQkdGltZW91dElkXS5yZWplY3QoJ2NhbmNlbGVkJyk7XG4gICAgICAgIGRlbGV0ZSBkZWZlcnJlZHNbcHJvbWlzZS4kJHRpbWVvdXRJZF07XG4gICAgICAgIHJldHVybiAkYnJvd3Nlci5kZWZlci5jYW5jZWwocHJvbWlzZS4kJHRpbWVvdXRJZCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIHJldHVybiB0aW1lb3V0O1xuICB9XTtcbn1cblxuLy8gTk9URTogIFRoZSB1c2FnZSBvZiB3aW5kb3cgYW5kIGRvY3VtZW50IGluc3RlYWQgb2YgJHdpbmRvdyBhbmQgJGRvY3VtZW50IGhlcmUgaXNcbi8vIGRlbGliZXJhdGUuICBUaGlzIHNlcnZpY2UgZGVwZW5kcyBvbiB0aGUgc3BlY2lmaWMgYmVoYXZpb3Igb2YgYW5jaG9yIG5vZGVzIGNyZWF0ZWQgYnkgdGhlXG4vLyBicm93c2VyIChyZXNvbHZpbmcgYW5kIHBhcnNpbmcgVVJMcykgdGhhdCBpcyB1bmxpa2VseSB0byBiZSBwcm92aWRlZCBieSBtb2NrIG9iamVjdHMgYW5kXG4vLyBjYXVzZSB1cyB0byBicmVhayB0ZXN0cy4gIEluIGFkZGl0aW9uLCB3aGVuIHRoZSBicm93c2VyIHJlc29sdmVzIGEgVVJMIGZvciBYSFIsIGl0XG4vLyBkb2Vzbid0IGtub3cgYWJvdXQgbW9ja2VkIGxvY2F0aW9ucyBhbmQgcmVzb2x2ZXMgVVJMcyB0byB0aGUgcmVhbCBkb2N1bWVudCAtIHdoaWNoIGlzXG4vLyBleGFjdGx5IHRoZSBiZWhhdmlvciBuZWVkZWQgaGVyZS4gIFRoZXJlIGlzIGxpdHRsZSB2YWx1ZSBpcyBtb2NraW5nIHRoZXNlIG91dCBmb3IgdGhpc1xuLy8gc2VydmljZS5cbnZhciB1cmxQYXJzaW5nTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xudmFyIG9yaWdpblVybCA9IHVybFJlc29sdmUod2luZG93LmxvY2F0aW9uLmhyZWYpO1xuXG5cbi8qKlxuICpcbiAqIEltcGxlbWVudGF0aW9uIE5vdGVzIGZvciBub24tSUUgYnJvd3NlcnNcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIEFzc2lnbmluZyBhIFVSTCB0byB0aGUgaHJlZiBwcm9wZXJ0eSBvZiBhbiBhbmNob3IgRE9NIG5vZGUsIGV2ZW4gb25lIGF0dGFjaGVkIHRvIHRoZSBET00sXG4gKiByZXN1bHRzIGJvdGggaW4gdGhlIG5vcm1hbGl6aW5nIGFuZCBwYXJzaW5nIG9mIHRoZSBVUkwuICBOb3JtYWxpemluZyBtZWFucyB0aGF0IGEgcmVsYXRpdmVcbiAqIFVSTCB3aWxsIGJlIHJlc29sdmVkIGludG8gYW4gYWJzb2x1dGUgVVJMIGluIHRoZSBjb250ZXh0IG9mIHRoZSBhcHBsaWNhdGlvbiBkb2N1bWVudC5cbiAqIFBhcnNpbmcgbWVhbnMgdGhhdCB0aGUgYW5jaG9yIG5vZGUncyBob3N0LCBob3N0bmFtZSwgcHJvdG9jb2wsIHBvcnQsIHBhdGhuYW1lIGFuZCByZWxhdGVkXG4gKiBwcm9wZXJ0aWVzIGFyZSBhbGwgcG9wdWxhdGVkIHRvIHJlZmxlY3QgdGhlIG5vcm1hbGl6ZWQgVVJMLiAgVGhpcyBhcHByb2FjaCBoYXMgd2lkZVxuICogY29tcGF0aWJpbGl0eSAtIFNhZmFyaSAxKywgTW96aWxsYSAxKywgT3BlcmEgNyssZSBldGMuICBTZWVcbiAqIGh0dHA6Ly93d3cuYXB0YW5hLmNvbS9yZWZlcmVuY2UvaHRtbC9hcGkvSFRNTEFuY2hvckVsZW1lbnQuaHRtbFxuICpcbiAqIEltcGxlbWVudGF0aW9uIE5vdGVzIGZvciBJRVxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBJRSA8PSAxMCBub3JtYWxpemVzIHRoZSBVUkwgd2hlbiBhc3NpZ25lZCB0byB0aGUgYW5jaG9yIG5vZGUgc2ltaWxhciB0byB0aGUgb3RoZXJcbiAqIGJyb3dzZXJzLiAgSG93ZXZlciwgdGhlIHBhcnNlZCBjb21wb25lbnRzIHdpbGwgbm90IGJlIHNldCBpZiB0aGUgVVJMIGFzc2lnbmVkIGRpZCBub3Qgc3BlY2lmeVxuICogdGhlbS4gIChlLmcuIGlmIHlvdSBhc3NpZ24gYS5ocmVmID0gXCJmb29cIiwgdGhlbiBhLnByb3RvY29sLCBhLmhvc3QsIGV0Yy4gd2lsbCBiZSBlbXB0eS4pICBXZVxuICogd29yayBhcm91bmQgdGhhdCBieSBwZXJmb3JtaW5nIHRoZSBwYXJzaW5nIGluIGEgMm5kIHN0ZXAgYnkgdGFraW5nIGEgcHJldmlvdXNseSBub3JtYWxpemVkXG4gKiBVUkwgKGUuZy4gYnkgYXNzaWduaW5nIHRvIGEuaHJlZikgYW5kIGFzc2lnbmluZyBpdCBhLmhyZWYgYWdhaW4uICBUaGlzIGNvcnJlY3RseSBwb3B1bGF0ZXMgdGhlXG4gKiBwcm9wZXJ0aWVzIHN1Y2ggYXMgcHJvdG9jb2wsIGhvc3RuYW1lLCBwb3J0LCBldGMuXG4gKlxuICogUmVmZXJlbmNlczpcbiAqICAgaHR0cDovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSFRNTEFuY2hvckVsZW1lbnRcbiAqICAgaHR0cDovL3d3dy5hcHRhbmEuY29tL3JlZmVyZW5jZS9odG1sL2FwaS9IVE1MQW5jaG9yRWxlbWVudC5odG1sXG4gKiAgIGh0dHA6Ly91cmwuc3BlYy53aGF0d2cub3JnLyN1cmx1dGlsc1xuICogICBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL3B1bGwvMjkwMlxuICogICBodHRwOi8vamFtZXMucGFkb2xzZXkuY29tL2phdmFzY3JpcHQvcGFyc2luZy11cmxzLXdpdGgtdGhlLWRvbS9cbiAqXG4gKiBAa2luZCBmdW5jdGlvblxuICogQHBhcmFtIHtzdHJpbmd9IHVybCBUaGUgVVJMIHRvIGJlIHBhcnNlZC5cbiAqIEBkZXNjcmlwdGlvbiBOb3JtYWxpemVzIGFuZCBwYXJzZXMgYSBVUkwuXG4gKiBAcmV0dXJucyB7b2JqZWN0fSBSZXR1cm5zIHRoZSBub3JtYWxpemVkIFVSTCBhcyBhIGRpY3Rpb25hcnkuXG4gKlxuICogICB8IG1lbWJlciBuYW1lICAgfCBEZXNjcmlwdGlvbiAgICB8XG4gKiAgIHwtLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLXxcbiAqICAgfCBocmVmICAgICAgICAgIHwgQSBub3JtYWxpemVkIHZlcnNpb24gb2YgdGhlIHByb3ZpZGVkIFVSTCBpZiBpdCB3YXMgbm90IGFuIGFic29sdXRlIFVSTCB8XG4gKiAgIHwgcHJvdG9jb2wgICAgICB8IFRoZSBwcm90b2NvbCBpbmNsdWRpbmcgdGhlIHRyYWlsaW5nIGNvbG9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICogICB8IGhvc3QgICAgICAgICAgfCBUaGUgaG9zdCBhbmQgcG9ydCAoaWYgdGhlIHBvcnQgaXMgbm9uLWRlZmF1bHQpIG9mIHRoZSBub3JtYWxpemVkVXJsICAgIHxcbiAqICAgfCBzZWFyY2ggICAgICAgIHwgVGhlIHNlYXJjaCBwYXJhbXMsIG1pbnVzIHRoZSBxdWVzdGlvbiBtYXJrICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiAgIHwgaGFzaCAgICAgICAgICB8IFRoZSBoYXNoIHN0cmluZywgbWludXMgdGhlIGhhc2ggc3ltYm9sXG4gKiAgIHwgaG9zdG5hbWUgICAgICB8IFRoZSBob3N0bmFtZVxuICogICB8IHBvcnQgICAgICAgICAgfCBUaGUgcG9ydCwgd2l0aG91dCBcIjpcIlxuICogICB8IHBhdGhuYW1lICAgICAgfCBUaGUgcGF0aG5hbWUsIGJlZ2lubmluZyB3aXRoIFwiL1wiXG4gKlxuICovXG5mdW5jdGlvbiB1cmxSZXNvbHZlKHVybCkge1xuICB2YXIgaHJlZiA9IHVybDtcblxuICBpZiAobXNpZSkge1xuICAgIC8vIE5vcm1hbGl6ZSBiZWZvcmUgcGFyc2UuICBSZWZlciBJbXBsZW1lbnRhdGlvbiBOb3RlcyBvbiB3aHkgdGhpcyBpc1xuICAgIC8vIGRvbmUgaW4gdHdvIHN0ZXBzIG9uIElFLlxuICAgIHVybFBhcnNpbmdOb2RlLnNldEF0dHJpYnV0ZShcImhyZWZcIiwgaHJlZik7XG4gICAgaHJlZiA9IHVybFBhcnNpbmdOb2RlLmhyZWY7XG4gIH1cblxuICB1cmxQYXJzaW5nTm9kZS5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBocmVmKTtcblxuICAvLyB1cmxQYXJzaW5nTm9kZSBwcm92aWRlcyB0aGUgVXJsVXRpbHMgaW50ZXJmYWNlIC0gaHR0cDovL3VybC5zcGVjLndoYXR3Zy5vcmcvI3VybHV0aWxzXG4gIHJldHVybiB7XG4gICAgaHJlZjogdXJsUGFyc2luZ05vZGUuaHJlZixcbiAgICBwcm90b2NvbDogdXJsUGFyc2luZ05vZGUucHJvdG9jb2wgPyB1cmxQYXJzaW5nTm9kZS5wcm90b2NvbC5yZXBsYWNlKC86JC8sICcnKSA6ICcnLFxuICAgIGhvc3Q6IHVybFBhcnNpbmdOb2RlLmhvc3QsXG4gICAgc2VhcmNoOiB1cmxQYXJzaW5nTm9kZS5zZWFyY2ggPyB1cmxQYXJzaW5nTm9kZS5zZWFyY2gucmVwbGFjZSgvXlxcPy8sICcnKSA6ICcnLFxuICAgIGhhc2g6IHVybFBhcnNpbmdOb2RlLmhhc2ggPyB1cmxQYXJzaW5nTm9kZS5oYXNoLnJlcGxhY2UoL14jLywgJycpIDogJycsXG4gICAgaG9zdG5hbWU6IHVybFBhcnNpbmdOb2RlLmhvc3RuYW1lLFxuICAgIHBvcnQ6IHVybFBhcnNpbmdOb2RlLnBvcnQsXG4gICAgcGF0aG5hbWU6ICh1cmxQYXJzaW5nTm9kZS5wYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJylcbiAgICAgID8gdXJsUGFyc2luZ05vZGUucGF0aG5hbWVcbiAgICAgIDogJy8nICsgdXJsUGFyc2luZ05vZGUucGF0aG5hbWVcbiAgfTtcbn1cblxuLyoqXG4gKiBQYXJzZSBhIHJlcXVlc3QgVVJMIGFuZCBkZXRlcm1pbmUgd2hldGhlciB0aGlzIGlzIGEgc2FtZS1vcmlnaW4gcmVxdWVzdCBhcyB0aGUgYXBwbGljYXRpb24gZG9jdW1lbnQuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd8b2JqZWN0fSByZXF1ZXN0VXJsIFRoZSB1cmwgb2YgdGhlIHJlcXVlc3QgYXMgYSBzdHJpbmcgdGhhdCB3aWxsIGJlIHJlc29sdmVkXG4gKiBvciBhIHBhcnNlZCBVUkwgb2JqZWN0LlxuICogQHJldHVybnMge2Jvb2xlYW59IFdoZXRoZXIgdGhlIHJlcXVlc3QgaXMgZm9yIHRoZSBzYW1lIG9yaWdpbiBhcyB0aGUgYXBwbGljYXRpb24gZG9jdW1lbnQuXG4gKi9cbmZ1bmN0aW9uIHVybElzU2FtZU9yaWdpbihyZXF1ZXN0VXJsKSB7XG4gIHZhciBwYXJzZWQgPSAoaXNTdHJpbmcocmVxdWVzdFVybCkpID8gdXJsUmVzb2x2ZShyZXF1ZXN0VXJsKSA6IHJlcXVlc3RVcmw7XG4gIHJldHVybiAocGFyc2VkLnByb3RvY29sID09PSBvcmlnaW5VcmwucHJvdG9jb2wgJiZcbiAgICAgICAgICBwYXJzZWQuaG9zdCA9PT0gb3JpZ2luVXJsLmhvc3QpO1xufVxuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkd2luZG93XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBBIHJlZmVyZW5jZSB0byB0aGUgYnJvd3NlcidzIGB3aW5kb3dgIG9iamVjdC4gV2hpbGUgYHdpbmRvd2BcbiAqIGlzIGdsb2JhbGx5IGF2YWlsYWJsZSBpbiBKYXZhU2NyaXB0LCBpdCBjYXVzZXMgdGVzdGFiaWxpdHkgcHJvYmxlbXMsIGJlY2F1c2VcbiAqIGl0IGlzIGEgZ2xvYmFsIHZhcmlhYmxlLiBJbiBhbmd1bGFyIHdlIGFsd2F5cyByZWZlciB0byBpdCB0aHJvdWdoIHRoZVxuICogYCR3aW5kb3dgIHNlcnZpY2UsIHNvIGl0IG1heSBiZSBvdmVycmlkZGVuLCByZW1vdmVkIG9yIG1vY2tlZCBmb3IgdGVzdGluZy5cbiAqXG4gKiBFeHByZXNzaW9ucywgbGlrZSB0aGUgb25lIGRlZmluZWQgZm9yIHRoZSBgbmdDbGlja2AgZGlyZWN0aXZlIGluIHRoZSBleGFtcGxlXG4gKiBiZWxvdywgYXJlIGV2YWx1YXRlZCB3aXRoIHJlc3BlY3QgdG8gdGhlIGN1cnJlbnQgc2NvcGUuICBUaGVyZWZvcmUsIHRoZXJlIGlzXG4gKiBubyByaXNrIG9mIGluYWR2ZXJ0ZW50bHkgY29kaW5nIGluIGEgZGVwZW5kZW5jeSBvbiBhIGdsb2JhbCB2YWx1ZSBpbiBzdWNoIGFuXG4gKiBleHByZXNzaW9uLlxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZSBtb2R1bGU9XCJ3aW5kb3dFeGFtcGxlXCI+XG4gICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgPHNjcmlwdD5cbiAgICAgICAgIGFuZ3VsYXIubW9kdWxlKCd3aW5kb3dFeGFtcGxlJywgW10pXG4gICAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyR3aW5kb3cnLCBmdW5jdGlvbigkc2NvcGUsICR3aW5kb3cpIHtcbiAgICAgICAgICAgICAkc2NvcGUuZ3JlZXRpbmcgPSAnSGVsbG8sIFdvcmxkISc7XG4gICAgICAgICAgICAgJHNjb3BlLmRvR3JlZXRpbmcgPSBmdW5jdGlvbihncmVldGluZykge1xuICAgICAgICAgICAgICAgJHdpbmRvdy5hbGVydChncmVldGluZyk7XG4gICAgICAgICAgICAgfTtcbiAgICAgICAgICAgfV0pO1xuICAgICAgIDwvc2NyaXB0PlxuICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cImdyZWV0aW5nXCIgYXJpYS1sYWJlbD1cImdyZWV0aW5nXCIgLz5cbiAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJkb0dyZWV0aW5nKGdyZWV0aW5nKVwiPkFMRVJUPC9idXR0b24+XG4gICAgICAgPC9kaXY+XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgaXQoJ3Nob3VsZCBkaXNwbGF5IHRoZSBncmVldGluZyBpbiB0aGUgaW5wdXQgYm94JywgZnVuY3Rpb24oKSB7XG4gICAgICAgZWxlbWVudChieS5tb2RlbCgnZ3JlZXRpbmcnKSkuc2VuZEtleXMoJ0hlbGxvLCBFMkUgVGVzdHMnKTtcbiAgICAgICAvLyBJZiB3ZSBjbGljayB0aGUgYnV0dG9uIGl0IHdpbGwgYmxvY2sgdGhlIHRlc3QgcnVubmVyXG4gICAgICAgLy8gZWxlbWVudCgnOmJ1dHRvbicpLmNsaWNrKCk7XG4gICAgICB9KTtcbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG5mdW5jdGlvbiAkV2luZG93UHJvdmlkZXIoKSB7XG4gIHRoaXMuJGdldCA9IHZhbHVlRm4od2luZG93KTtcbn1cblxuLyoqXG4gKiBAbmFtZSAkJGNvb2tpZVJlYWRlclxuICogQHJlcXVpcmVzICRkb2N1bWVudFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhpcyBpcyBhIHByaXZhdGUgc2VydmljZSBmb3IgcmVhZGluZyBjb29raWVzIHVzZWQgYnkgJGh0dHAgYW5kIG5nQ29va2llc1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gYSBrZXkvdmFsdWUgbWFwIG9mIHRoZSBjdXJyZW50IGNvb2tpZXNcbiAqL1xuZnVuY3Rpb24gJCRDb29raWVSZWFkZXIoJGRvY3VtZW50KSB7XG4gIHZhciByYXdEb2N1bWVudCA9ICRkb2N1bWVudFswXSB8fCB7fTtcbiAgdmFyIGxhc3RDb29raWVzID0ge307XG4gIHZhciBsYXN0Q29va2llU3RyaW5nID0gJyc7XG5cbiAgZnVuY3Rpb24gc2FmZURlY29kZVVSSUNvbXBvbmVudChzdHIpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzdHIpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBjb29raWVBcnJheSwgY29va2llLCBpLCBpbmRleCwgbmFtZTtcbiAgICB2YXIgY3VycmVudENvb2tpZVN0cmluZyA9IHJhd0RvY3VtZW50LmNvb2tpZSB8fCAnJztcblxuICAgIGlmIChjdXJyZW50Q29va2llU3RyaW5nICE9PSBsYXN0Q29va2llU3RyaW5nKSB7XG4gICAgICBsYXN0Q29va2llU3RyaW5nID0gY3VycmVudENvb2tpZVN0cmluZztcbiAgICAgIGNvb2tpZUFycmF5ID0gbGFzdENvb2tpZVN0cmluZy5zcGxpdCgnOyAnKTtcbiAgICAgIGxhc3RDb29raWVzID0ge307XG5cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBjb29raWVBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb29raWUgPSBjb29raWVBcnJheVtpXTtcbiAgICAgICAgaW5kZXggPSBjb29raWUuaW5kZXhPZignPScpO1xuICAgICAgICBpZiAoaW5kZXggPiAwKSB7IC8vaWdub3JlIG5hbWVsZXNzIGNvb2tpZXNcbiAgICAgICAgICBuYW1lID0gc2FmZURlY29kZVVSSUNvbXBvbmVudChjb29raWUuc3Vic3RyaW5nKDAsIGluZGV4KSk7XG4gICAgICAgICAgLy8gdGhlIGZpcnN0IHZhbHVlIHRoYXQgaXMgc2VlbiBmb3IgYSBjb29raWUgaXMgdGhlIG1vc3RcbiAgICAgICAgICAvLyBzcGVjaWZpYyBvbmUuICB2YWx1ZXMgZm9yIHRoZSBzYW1lIGNvb2tpZSBuYW1lIHRoYXRcbiAgICAgICAgICAvLyBmb2xsb3cgYXJlIGZvciBsZXNzIHNwZWNpZmljIHBhdGhzLlxuICAgICAgICAgIGlmIChpc1VuZGVmaW5lZChsYXN0Q29va2llc1tuYW1lXSkpIHtcbiAgICAgICAgICAgIGxhc3RDb29raWVzW25hbWVdID0gc2FmZURlY29kZVVSSUNvbXBvbmVudChjb29raWUuc3Vic3RyaW5nKGluZGV4ICsgMSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbGFzdENvb2tpZXM7XG4gIH07XG59XG5cbiQkQ29va2llUmVhZGVyLiRpbmplY3QgPSBbJyRkb2N1bWVudCddO1xuXG5mdW5jdGlvbiAkJENvb2tpZVJlYWRlclByb3ZpZGVyKCkge1xuICB0aGlzLiRnZXQgPSAkJENvb2tpZVJlYWRlcjtcbn1cblxuLyogZ2xvYmFsIGN1cnJlbmN5RmlsdGVyOiB0cnVlLFxuIGRhdGVGaWx0ZXI6IHRydWUsXG4gZmlsdGVyRmlsdGVyOiB0cnVlLFxuIGpzb25GaWx0ZXI6IHRydWUsXG4gbGltaXRUb0ZpbHRlcjogdHJ1ZSxcbiBsb3dlcmNhc2VGaWx0ZXI6IHRydWUsXG4gbnVtYmVyRmlsdGVyOiB0cnVlLFxuIG9yZGVyQnlGaWx0ZXI6IHRydWUsXG4gdXBwZXJjYXNlRmlsdGVyOiB0cnVlLFxuICovXG5cbi8qKlxuICogQG5nZG9jIHByb3ZpZGVyXG4gKiBAbmFtZSAkZmlsdGVyUHJvdmlkZXJcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIEZpbHRlcnMgYXJlIGp1c3QgZnVuY3Rpb25zIHdoaWNoIHRyYW5zZm9ybSBpbnB1dCB0byBhbiBvdXRwdXQuIEhvd2V2ZXIgZmlsdGVycyBuZWVkIHRvIGJlXG4gKiBEZXBlbmRlbmN5IEluamVjdGVkLiBUbyBhY2hpZXZlIHRoaXMgYSBmaWx0ZXIgZGVmaW5pdGlvbiBjb25zaXN0cyBvZiBhIGZhY3RvcnkgZnVuY3Rpb24gd2hpY2ggaXNcbiAqIGFubm90YXRlZCB3aXRoIGRlcGVuZGVuY2llcyBhbmQgaXMgcmVzcG9uc2libGUgZm9yIGNyZWF0aW5nIGEgZmlsdGVyIGZ1bmN0aW9uLlxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG4gKiAqKk5vdGU6KiogRmlsdGVyIG5hbWVzIG11c3QgYmUgdmFsaWQgYW5ndWxhciB7QGxpbmsgZXhwcmVzc2lvbn0gaWRlbnRpZmllcnMsIHN1Y2ggYXMgYHVwcGVyY2FzZWAgb3IgYG9yZGVyQnlgLlxuICogTmFtZXMgd2l0aCBzcGVjaWFsIGNoYXJhY3RlcnMsIHN1Y2ggYXMgaHlwaGVucyBhbmQgZG90cywgYXJlIG5vdCBhbGxvd2VkLiBJZiB5b3Ugd2lzaCB0byBuYW1lc3BhY2VcbiAqIHlvdXIgZmlsdGVycywgdGhlbiB5b3UgY2FuIHVzZSBjYXBpdGFsaXphdGlvbiAoYG15YXBwU3Vic2VjdGlvbkZpbHRlcnhgKSBvciB1bmRlcnNjb3Jlc1xuICogKGBteWFwcF9zdWJzZWN0aW9uX2ZpbHRlcnhgKS5cbiAqIDwvZGl2PlxuICpcbiAqIGBgYGpzXG4gKiAgIC8vIEZpbHRlciByZWdpc3RyYXRpb25cbiAqICAgZnVuY3Rpb24gTXlNb2R1bGUoJHByb3ZpZGUsICRmaWx0ZXJQcm92aWRlcikge1xuICogICAgIC8vIGNyZWF0ZSBhIHNlcnZpY2UgdG8gZGVtb25zdHJhdGUgaW5qZWN0aW9uIChub3QgYWx3YXlzIG5lZWRlZClcbiAqICAgICAkcHJvdmlkZS52YWx1ZSgnZ3JlZXQnLCBmdW5jdGlvbihuYW1lKXtcbiAqICAgICAgIHJldHVybiAnSGVsbG8gJyArIG5hbWUgKyAnISc7XG4gKiAgICAgfSk7XG4gKlxuICogICAgIC8vIHJlZ2lzdGVyIGEgZmlsdGVyIGZhY3Rvcnkgd2hpY2ggdXNlcyB0aGVcbiAqICAgICAvLyBncmVldCBzZXJ2aWNlIHRvIGRlbW9uc3RyYXRlIERJLlxuICogICAgICRmaWx0ZXJQcm92aWRlci5yZWdpc3RlcignZ3JlZXQnLCBmdW5jdGlvbihncmVldCl7XG4gKiAgICAgICAvLyByZXR1cm4gdGhlIGZpbHRlciBmdW5jdGlvbiB3aGljaCB1c2VzIHRoZSBncmVldCBzZXJ2aWNlXG4gKiAgICAgICAvLyB0byBnZW5lcmF0ZSBzYWx1dGF0aW9uXG4gKiAgICAgICByZXR1cm4gZnVuY3Rpb24odGV4dCkge1xuICogICAgICAgICAvLyBmaWx0ZXJzIG5lZWQgdG8gYmUgZm9yZ2l2aW5nIHNvIGNoZWNrIGlucHV0IHZhbGlkaXR5XG4gKiAgICAgICAgIHJldHVybiB0ZXh0ICYmIGdyZWV0KHRleHQpIHx8IHRleHQ7XG4gKiAgICAgICB9O1xuICogICAgIH0pO1xuICogICB9XG4gKiBgYGBcbiAqXG4gKiBUaGUgZmlsdGVyIGZ1bmN0aW9uIGlzIHJlZ2lzdGVyZWQgd2l0aCB0aGUgYCRpbmplY3RvcmAgdW5kZXIgdGhlIGZpbHRlciBuYW1lIHN1ZmZpeCB3aXRoXG4gKiBgRmlsdGVyYC5cbiAqXG4gKiBgYGBqc1xuICogICBpdCgnc2hvdWxkIGJlIHRoZSBzYW1lIGluc3RhbmNlJywgaW5qZWN0KFxuICogICAgIGZ1bmN0aW9uKCRmaWx0ZXJQcm92aWRlcikge1xuICogICAgICAgJGZpbHRlclByb3ZpZGVyLnJlZ2lzdGVyKCdyZXZlcnNlJywgZnVuY3Rpb24oKXtcbiAqICAgICAgICAgcmV0dXJuIC4uLjtcbiAqICAgICAgIH0pO1xuICogICAgIH0sXG4gKiAgICAgZnVuY3Rpb24oJGZpbHRlciwgcmV2ZXJzZUZpbHRlcikge1xuICogICAgICAgZXhwZWN0KCRmaWx0ZXIoJ3JldmVyc2UnKSkudG9CZShyZXZlcnNlRmlsdGVyKTtcbiAqICAgICB9KTtcbiAqIGBgYFxuICpcbiAqXG4gKiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBob3cgYW5ndWxhciBmaWx0ZXJzIHdvcmssIGFuZCBob3cgdG8gY3JlYXRlIHlvdXIgb3duIGZpbHRlcnMsIHNlZVxuICoge0BsaW5rIGd1aWRlL2ZpbHRlciBGaWx0ZXJzfSBpbiB0aGUgQW5ndWxhciBEZXZlbG9wZXIgR3VpZGUuXG4gKi9cblxuLyoqXG4gKiBAbmdkb2Mgc2VydmljZVxuICogQG5hbWUgJGZpbHRlclxuICogQGtpbmQgZnVuY3Rpb25cbiAqIEBkZXNjcmlwdGlvblxuICogRmlsdGVycyBhcmUgdXNlZCBmb3IgZm9ybWF0dGluZyBkYXRhIGRpc3BsYXllZCB0byB0aGUgdXNlci5cbiAqXG4gKiBUaGUgZ2VuZXJhbCBzeW50YXggaW4gdGVtcGxhdGVzIGlzIGFzIGZvbGxvd3M6XG4gKlxuICogICAgICAgICB7eyBleHByZXNzaW9uIFt8IGZpbHRlcl9uYW1lWzpwYXJhbWV0ZXJfdmFsdWVdIC4uLiBdIH19XG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgTmFtZSBvZiB0aGUgZmlsdGVyIGZ1bmN0aW9uIHRvIHJldHJpZXZlXG4gKiBAcmV0dXJuIHtGdW5jdGlvbn0gdGhlIGZpbHRlciBmdW5jdGlvblxuICogQGV4YW1wbGVcbiAgIDxleGFtcGxlIG5hbWU9XCIkZmlsdGVyXCIgbW9kdWxlPVwiZmlsdGVyRXhhbXBsZVwiPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIk1haW5DdHJsXCI+XG4gICAgICAgIDxoMz57eyBvcmlnaW5hbFRleHQgfX08L2gzPlxuICAgICAgICA8aDM+e3sgZmlsdGVyZWRUZXh0IH19PC9oMz5cbiAgICAgICA8L2Rpdj5cbiAgICAgPC9maWxlPlxuXG4gICAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cbiAgICAgIGFuZ3VsYXIubW9kdWxlKCdmaWx0ZXJFeGFtcGxlJywgW10pXG4gICAgICAuY29udHJvbGxlcignTWFpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRmaWx0ZXIpIHtcbiAgICAgICAgJHNjb3BlLm9yaWdpbmFsVGV4dCA9ICdoZWxsbyc7XG4gICAgICAgICRzY29wZS5maWx0ZXJlZFRleHQgPSAkZmlsdGVyKCd1cHBlcmNhc2UnKSgkc2NvcGUub3JpZ2luYWxUZXh0KTtcbiAgICAgIH0pO1xuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gICovXG4kRmlsdGVyUHJvdmlkZXIuJGluamVjdCA9IFsnJHByb3ZpZGUnXTtcbmZ1bmN0aW9uICRGaWx0ZXJQcm92aWRlcigkcHJvdmlkZSkge1xuICB2YXIgc3VmZml4ID0gJ0ZpbHRlcic7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGZpbHRlclByb3ZpZGVyI3JlZ2lzdGVyXG4gICAqIEBwYXJhbSB7c3RyaW5nfE9iamVjdH0gbmFtZSBOYW1lIG9mIHRoZSBmaWx0ZXIgZnVuY3Rpb24sIG9yIGFuIG9iamVjdCBtYXAgb2YgZmlsdGVycyB3aGVyZVxuICAgKiAgICB0aGUga2V5cyBhcmUgdGhlIGZpbHRlciBuYW1lcyBhbmQgdGhlIHZhbHVlcyBhcmUgdGhlIGZpbHRlciBmYWN0b3JpZXMuXG4gICAqXG4gICAqICAgIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG4gICAqICAgICoqTm90ZToqKiBGaWx0ZXIgbmFtZXMgbXVzdCBiZSB2YWxpZCBhbmd1bGFyIHtAbGluayBleHByZXNzaW9ufSBpZGVudGlmaWVycywgc3VjaCBhcyBgdXBwZXJjYXNlYCBvciBgb3JkZXJCeWAuXG4gICAqICAgIE5hbWVzIHdpdGggc3BlY2lhbCBjaGFyYWN0ZXJzLCBzdWNoIGFzIGh5cGhlbnMgYW5kIGRvdHMsIGFyZSBub3QgYWxsb3dlZC4gSWYgeW91IHdpc2ggdG8gbmFtZXNwYWNlXG4gICAqICAgIHlvdXIgZmlsdGVycywgdGhlbiB5b3UgY2FuIHVzZSBjYXBpdGFsaXphdGlvbiAoYG15YXBwU3Vic2VjdGlvbkZpbHRlcnhgKSBvciB1bmRlcnNjb3Jlc1xuICAgKiAgICAoYG15YXBwX3N1YnNlY3Rpb25fZmlsdGVyeGApLlxuICAgKiAgICA8L2Rpdj5cbiAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZhY3RvcnkgSWYgdGhlIGZpcnN0IGFyZ3VtZW50IHdhcyBhIHN0cmluZywgYSBmYWN0b3J5IGZ1bmN0aW9uIGZvciB0aGUgZmlsdGVyIHRvIGJlIHJlZ2lzdGVyZWQuXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFJlZ2lzdGVyZWQgZmlsdGVyIGluc3RhbmNlLCBvciBpZiBhIG1hcCBvZiBmaWx0ZXJzIHdhcyBwcm92aWRlZCB0aGVuIGEgbWFwXG4gICAqICAgIG9mIHRoZSByZWdpc3RlcmVkIGZpbHRlciBpbnN0YW5jZXMuXG4gICAqL1xuICBmdW5jdGlvbiByZWdpc3RlcihuYW1lLCBmYWN0b3J5KSB7XG4gICAgaWYgKGlzT2JqZWN0KG5hbWUpKSB7XG4gICAgICB2YXIgZmlsdGVycyA9IHt9O1xuICAgICAgZm9yRWFjaChuYW1lLCBmdW5jdGlvbihmaWx0ZXIsIGtleSkge1xuICAgICAgICBmaWx0ZXJzW2tleV0gPSByZWdpc3RlcihrZXksIGZpbHRlcik7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBmaWx0ZXJzO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJHByb3ZpZGUuZmFjdG9yeShuYW1lICsgc3VmZml4LCBmYWN0b3J5KTtcbiAgICB9XG4gIH1cbiAgdGhpcy5yZWdpc3RlciA9IHJlZ2lzdGVyO1xuXG4gIHRoaXMuJGdldCA9IFsnJGluamVjdG9yJywgZnVuY3Rpb24oJGluamVjdG9yKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHJldHVybiAkaW5qZWN0b3IuZ2V0KG5hbWUgKyBzdWZmaXgpO1xuICAgIH07XG4gIH1dO1xuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKiBnbG9iYWxcbiAgICBjdXJyZW5jeUZpbHRlcjogZmFsc2UsXG4gICAgZGF0ZUZpbHRlcjogZmFsc2UsXG4gICAgZmlsdGVyRmlsdGVyOiBmYWxzZSxcbiAgICBqc29uRmlsdGVyOiBmYWxzZSxcbiAgICBsaW1pdFRvRmlsdGVyOiBmYWxzZSxcbiAgICBsb3dlcmNhc2VGaWx0ZXI6IGZhbHNlLFxuICAgIG51bWJlckZpbHRlcjogZmFsc2UsXG4gICAgb3JkZXJCeUZpbHRlcjogZmFsc2UsXG4gICAgdXBwZXJjYXNlRmlsdGVyOiBmYWxzZSxcbiAgKi9cblxuICByZWdpc3RlcignY3VycmVuY3knLCBjdXJyZW5jeUZpbHRlcik7XG4gIHJlZ2lzdGVyKCdkYXRlJywgZGF0ZUZpbHRlcik7XG4gIHJlZ2lzdGVyKCdmaWx0ZXInLCBmaWx0ZXJGaWx0ZXIpO1xuICByZWdpc3RlcignanNvbicsIGpzb25GaWx0ZXIpO1xuICByZWdpc3RlcignbGltaXRUbycsIGxpbWl0VG9GaWx0ZXIpO1xuICByZWdpc3RlcignbG93ZXJjYXNlJywgbG93ZXJjYXNlRmlsdGVyKTtcbiAgcmVnaXN0ZXIoJ251bWJlcicsIG51bWJlckZpbHRlcik7XG4gIHJlZ2lzdGVyKCdvcmRlckJ5Jywgb3JkZXJCeUZpbHRlcik7XG4gIHJlZ2lzdGVyKCd1cHBlcmNhc2UnLCB1cHBlcmNhc2VGaWx0ZXIpO1xufVxuXG4vKipcbiAqIEBuZ2RvYyBmaWx0ZXJcbiAqIEBuYW1lIGZpbHRlclxuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFNlbGVjdHMgYSBzdWJzZXQgb2YgaXRlbXMgZnJvbSBgYXJyYXlgIGFuZCByZXR1cm5zIGl0IGFzIGEgbmV3IGFycmF5LlxuICpcbiAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBzb3VyY2UgYXJyYXkuXG4gKiBAcGFyYW0ge3N0cmluZ3xPYmplY3R8ZnVuY3Rpb24oKX0gZXhwcmVzc2lvbiBUaGUgcHJlZGljYXRlIHRvIGJlIHVzZWQgZm9yIHNlbGVjdGluZyBpdGVtcyBmcm9tXG4gKiAgIGBhcnJheWAuXG4gKlxuICogICBDYW4gYmUgb25lIG9mOlxuICpcbiAqICAgLSBgc3RyaW5nYDogVGhlIHN0cmluZyBpcyB1c2VkIGZvciBtYXRjaGluZyBhZ2FpbnN0IHRoZSBjb250ZW50cyBvZiB0aGUgYGFycmF5YC4gQWxsIHN0cmluZ3Mgb3JcbiAqICAgICBvYmplY3RzIHdpdGggc3RyaW5nIHByb3BlcnRpZXMgaW4gYGFycmF5YCB0aGF0IG1hdGNoIHRoaXMgc3RyaW5nIHdpbGwgYmUgcmV0dXJuZWQuIFRoaXMgYWxzb1xuICogICAgIGFwcGxpZXMgdG8gbmVzdGVkIG9iamVjdCBwcm9wZXJ0aWVzLlxuICogICAgIFRoZSBwcmVkaWNhdGUgY2FuIGJlIG5lZ2F0ZWQgYnkgcHJlZml4aW5nIHRoZSBzdHJpbmcgd2l0aCBgIWAuXG4gKlxuICogICAtIGBPYmplY3RgOiBBIHBhdHRlcm4gb2JqZWN0IGNhbiBiZSB1c2VkIHRvIGZpbHRlciBzcGVjaWZpYyBwcm9wZXJ0aWVzIG9uIG9iamVjdHMgY29udGFpbmVkXG4gKiAgICAgYnkgYGFycmF5YC4gRm9yIGV4YW1wbGUgYHtuYW1lOlwiTVwiLCBwaG9uZTpcIjFcIn1gIHByZWRpY2F0ZSB3aWxsIHJldHVybiBhbiBhcnJheSBvZiBpdGVtc1xuICogICAgIHdoaWNoIGhhdmUgcHJvcGVydHkgYG5hbWVgIGNvbnRhaW5pbmcgXCJNXCIgYW5kIHByb3BlcnR5IGBwaG9uZWAgY29udGFpbmluZyBcIjFcIi4gQSBzcGVjaWFsXG4gKiAgICAgcHJvcGVydHkgbmFtZSBgJGAgY2FuIGJlIHVzZWQgKGFzIGluIGB7JDpcInRleHRcIn1gKSB0byBhY2NlcHQgYSBtYXRjaCBhZ2FpbnN0IGFueVxuICogICAgIHByb3BlcnR5IG9mIHRoZSBvYmplY3Qgb3IgaXRzIG5lc3RlZCBvYmplY3QgcHJvcGVydGllcy4gVGhhdCdzIGVxdWl2YWxlbnQgdG8gdGhlIHNpbXBsZVxuICogICAgIHN1YnN0cmluZyBtYXRjaCB3aXRoIGEgYHN0cmluZ2AgYXMgZGVzY3JpYmVkIGFib3ZlLiBUaGUgcHJlZGljYXRlIGNhbiBiZSBuZWdhdGVkIGJ5IHByZWZpeGluZ1xuICogICAgIHRoZSBzdHJpbmcgd2l0aCBgIWAuXG4gKiAgICAgRm9yIGV4YW1wbGUgYHtuYW1lOiBcIiFNXCJ9YCBwcmVkaWNhdGUgd2lsbCByZXR1cm4gYW4gYXJyYXkgb2YgaXRlbXMgd2hpY2ggaGF2ZSBwcm9wZXJ0eSBgbmFtZWBcbiAqICAgICBub3QgY29udGFpbmluZyBcIk1cIi5cbiAqXG4gKiAgICAgTm90ZSB0aGF0IGEgbmFtZWQgcHJvcGVydHkgd2lsbCBtYXRjaCBwcm9wZXJ0aWVzIG9uIHRoZSBzYW1lIGxldmVsIG9ubHksIHdoaWxlIHRoZSBzcGVjaWFsXG4gKiAgICAgYCRgIHByb3BlcnR5IHdpbGwgbWF0Y2ggcHJvcGVydGllcyBvbiB0aGUgc2FtZSBsZXZlbCBvciBkZWVwZXIuIEUuZy4gYW4gYXJyYXkgaXRlbSBsaWtlXG4gKiAgICAgYHtuYW1lOiB7Zmlyc3Q6ICdKb2huJywgbGFzdDogJ0RvZSd9fWAgd2lsbCAqKm5vdCoqIGJlIG1hdGNoZWQgYnkgYHtuYW1lOiAnSm9obid9YCwgYnV0XG4gKiAgICAgKip3aWxsKiogYmUgbWF0Y2hlZCBieSBgeyQ6ICdKb2huJ31gLlxuICpcbiAqICAgLSBgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBhcnJheSlgOiBBIHByZWRpY2F0ZSBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byB3cml0ZSBhcmJpdHJhcnkgZmlsdGVycy5cbiAqICAgICBUaGUgZnVuY3Rpb24gaXMgY2FsbGVkIGZvciBlYWNoIGVsZW1lbnQgb2YgdGhlIGFycmF5LCB3aXRoIHRoZSBlbGVtZW50LCBpdHMgaW5kZXgsIGFuZFxuICogICAgIHRoZSBlbnRpcmUgYXJyYXkgaXRzZWxmIGFzIGFyZ3VtZW50cy5cbiAqXG4gKiAgICAgVGhlIGZpbmFsIHJlc3VsdCBpcyBhbiBhcnJheSBvZiB0aG9zZSBlbGVtZW50cyB0aGF0IHRoZSBwcmVkaWNhdGUgcmV0dXJuZWQgdHJ1ZSBmb3IuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbihhY3R1YWwsIGV4cGVjdGVkKXx0cnVlfHVuZGVmaW5lZH0gY29tcGFyYXRvciBDb21wYXJhdG9yIHdoaWNoIGlzIHVzZWQgaW5cbiAqICAgICBkZXRlcm1pbmluZyBpZiB0aGUgZXhwZWN0ZWQgdmFsdWUgKGZyb20gdGhlIGZpbHRlciBleHByZXNzaW9uKSBhbmQgYWN0dWFsIHZhbHVlIChmcm9tXG4gKiAgICAgdGhlIG9iamVjdCBpbiB0aGUgYXJyYXkpIHNob3VsZCBiZSBjb25zaWRlcmVkIGEgbWF0Y2guXG4gKlxuICogICBDYW4gYmUgb25lIG9mOlxuICpcbiAqICAgLSBgZnVuY3Rpb24oYWN0dWFsLCBleHBlY3RlZClgOlxuICogICAgIFRoZSBmdW5jdGlvbiB3aWxsIGJlIGdpdmVuIHRoZSBvYmplY3QgdmFsdWUgYW5kIHRoZSBwcmVkaWNhdGUgdmFsdWUgdG8gY29tcGFyZSBhbmRcbiAqICAgICBzaG91bGQgcmV0dXJuIHRydWUgaWYgYm90aCB2YWx1ZXMgc2hvdWxkIGJlIGNvbnNpZGVyZWQgZXF1YWwuXG4gKlxuICogICAtIGB0cnVlYDogQSBzaG9ydGhhbmQgZm9yIGBmdW5jdGlvbihhY3R1YWwsIGV4cGVjdGVkKSB7IHJldHVybiBhbmd1bGFyLmVxdWFscyhhY3R1YWwsIGV4cGVjdGVkKX1gLlxuICogICAgIFRoaXMgaXMgZXNzZW50aWFsbHkgc3RyaWN0IGNvbXBhcmlzb24gb2YgZXhwZWN0ZWQgYW5kIGFjdHVhbC5cbiAqXG4gKiAgIC0gYGZhbHNlfHVuZGVmaW5lZGA6IEEgc2hvcnQgaGFuZCBmb3IgYSBmdW5jdGlvbiB3aGljaCB3aWxsIGxvb2sgZm9yIGEgc3Vic3RyaW5nIG1hdGNoIGluIGNhc2VcbiAqICAgICBpbnNlbnNpdGl2ZSB3YXkuXG4gKlxuICogICAgIFByaW1pdGl2ZSB2YWx1ZXMgYXJlIGNvbnZlcnRlZCB0byBzdHJpbmdzLiBPYmplY3RzIGFyZSBub3QgY29tcGFyZWQgYWdhaW5zdCBwcmltaXRpdmVzLFxuICogICAgIHVubGVzcyB0aGV5IGhhdmUgYSBjdXN0b20gYHRvU3RyaW5nYCBtZXRob2QgKGUuZy4gYERhdGVgIG9iamVjdHMpLlxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZT5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICA8ZGl2IG5nLWluaXQ9XCJmcmllbmRzID0gW3tuYW1lOidKb2huJywgcGhvbmU6JzU1NS0xMjc2J30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtuYW1lOidNYXJ5JywgcGhvbmU6JzgwMC1CSUctTUFSWSd9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bmFtZTonTWlrZScsIHBob25lOic1NTUtNDMyMSd9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bmFtZTonQWRhbScsIHBob25lOic1NTUtNTY3OCd9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bmFtZTonSnVsaWUnLCBwaG9uZTonNTU1LTg3NjUnfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge25hbWU6J0p1bGlldHRlJywgcGhvbmU6JzU1NS01Njc4J31dXCI+PC9kaXY+XG5cbiAgICAgICA8bGFiZWw+U2VhcmNoOiA8aW5wdXQgbmctbW9kZWw9XCJzZWFyY2hUZXh0XCI+PC9sYWJlbD5cbiAgICAgICA8dGFibGUgaWQ9XCJzZWFyY2hUZXh0UmVzdWx0c1wiPlxuICAgICAgICAgPHRyPjx0aD5OYW1lPC90aD48dGg+UGhvbmU8L3RoPjwvdHI+XG4gICAgICAgICA8dHIgbmctcmVwZWF0PVwiZnJpZW5kIGluIGZyaWVuZHMgfCBmaWx0ZXI6c2VhcmNoVGV4dFwiPlxuICAgICAgICAgICA8dGQ+e3tmcmllbmQubmFtZX19PC90ZD5cbiAgICAgICAgICAgPHRkPnt7ZnJpZW5kLnBob25lfX08L3RkPlxuICAgICAgICAgPC90cj5cbiAgICAgICA8L3RhYmxlPlxuICAgICAgIDxocj5cbiAgICAgICA8bGFiZWw+QW55OiA8aW5wdXQgbmctbW9kZWw9XCJzZWFyY2guJFwiPjwvbGFiZWw+IDxicj5cbiAgICAgICA8bGFiZWw+TmFtZSBvbmx5IDxpbnB1dCBuZy1tb2RlbD1cInNlYXJjaC5uYW1lXCI+PC9sYWJlbD48YnI+XG4gICAgICAgPGxhYmVsPlBob25lIG9ubHkgPGlucHV0IG5nLW1vZGVsPVwic2VhcmNoLnBob25lXCI+PC9sYWJlbD48YnI+XG4gICAgICAgPGxhYmVsPkVxdWFsaXR5IDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cInN0cmljdFwiPjwvbGFiZWw+PGJyPlxuICAgICAgIDx0YWJsZSBpZD1cInNlYXJjaE9ialJlc3VsdHNcIj5cbiAgICAgICAgIDx0cj48dGg+TmFtZTwvdGg+PHRoPlBob25lPC90aD48L3RyPlxuICAgICAgICAgPHRyIG5nLXJlcGVhdD1cImZyaWVuZE9iaiBpbiBmcmllbmRzIHwgZmlsdGVyOnNlYXJjaDpzdHJpY3RcIj5cbiAgICAgICAgICAgPHRkPnt7ZnJpZW5kT2JqLm5hbWV9fTwvdGQ+XG4gICAgICAgICAgIDx0ZD57e2ZyaWVuZE9iai5waG9uZX19PC90ZD5cbiAgICAgICAgIDwvdHI+XG4gICAgICAgPC90YWJsZT5cbiAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgdmFyIGV4cGVjdEZyaWVuZE5hbWVzID0gZnVuY3Rpb24oZXhwZWN0ZWROYW1lcywga2V5KSB7XG4gICAgICAgICBlbGVtZW50LmFsbChieS5yZXBlYXRlcihrZXkgKyAnIGluIGZyaWVuZHMnKS5jb2x1bW4oa2V5ICsgJy5uYW1lJykpLnRoZW4oZnVuY3Rpb24oYXJyKSB7XG4gICAgICAgICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uKHdkLCBpKSB7XG4gICAgICAgICAgICAgZXhwZWN0KHdkLmdldFRleHQoKSkudG9NYXRjaChleHBlY3RlZE5hbWVzW2ldKTtcbiAgICAgICAgICAgfSk7XG4gICAgICAgICB9KTtcbiAgICAgICB9O1xuXG4gICAgICAgaXQoJ3Nob3VsZCBzZWFyY2ggYWNyb3NzIGFsbCBmaWVsZHMgd2hlbiBmaWx0ZXJpbmcgd2l0aCBhIHN0cmluZycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgdmFyIHNlYXJjaFRleHQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdzZWFyY2hUZXh0JykpO1xuICAgICAgICAgc2VhcmNoVGV4dC5jbGVhcigpO1xuICAgICAgICAgc2VhcmNoVGV4dC5zZW5kS2V5cygnbScpO1xuICAgICAgICAgZXhwZWN0RnJpZW5kTmFtZXMoWydNYXJ5JywgJ01pa2UnLCAnQWRhbSddLCAnZnJpZW5kJyk7XG5cbiAgICAgICAgIHNlYXJjaFRleHQuY2xlYXIoKTtcbiAgICAgICAgIHNlYXJjaFRleHQuc2VuZEtleXMoJzc2Jyk7XG4gICAgICAgICBleHBlY3RGcmllbmROYW1lcyhbJ0pvaG4nLCAnSnVsaWUnXSwgJ2ZyaWVuZCcpO1xuICAgICAgIH0pO1xuXG4gICAgICAgaXQoJ3Nob3VsZCBzZWFyY2ggaW4gc3BlY2lmaWMgZmllbGRzIHdoZW4gZmlsdGVyaW5nIHdpdGggYSBwcmVkaWNhdGUgb2JqZWN0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICB2YXIgc2VhcmNoQW55ID0gZWxlbWVudChieS5tb2RlbCgnc2VhcmNoLiQnKSk7XG4gICAgICAgICBzZWFyY2hBbnkuY2xlYXIoKTtcbiAgICAgICAgIHNlYXJjaEFueS5zZW5kS2V5cygnaScpO1xuICAgICAgICAgZXhwZWN0RnJpZW5kTmFtZXMoWydNYXJ5JywgJ01pa2UnLCAnSnVsaWUnLCAnSnVsaWV0dGUnXSwgJ2ZyaWVuZE9iaicpO1xuICAgICAgIH0pO1xuICAgICAgIGl0KCdzaG91bGQgdXNlIGEgZXF1YWwgY29tcGFyaXNvbiB3aGVuIGNvbXBhcmF0b3IgaXMgdHJ1ZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgdmFyIHNlYXJjaE5hbWUgPSBlbGVtZW50KGJ5Lm1vZGVsKCdzZWFyY2gubmFtZScpKTtcbiAgICAgICAgIHZhciBzdHJpY3QgPSBlbGVtZW50KGJ5Lm1vZGVsKCdzdHJpY3QnKSk7XG4gICAgICAgICBzZWFyY2hOYW1lLmNsZWFyKCk7XG4gICAgICAgICBzZWFyY2hOYW1lLnNlbmRLZXlzKCdKdWxpZScpO1xuICAgICAgICAgc3RyaWN0LmNsaWNrKCk7XG4gICAgICAgICBleHBlY3RGcmllbmROYW1lcyhbJ0p1bGllJ10sICdmcmllbmRPYmonKTtcbiAgICAgICB9KTtcbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG5mdW5jdGlvbiBmaWx0ZXJGaWx0ZXIoKSB7XG4gIHJldHVybiBmdW5jdGlvbihhcnJheSwgZXhwcmVzc2lvbiwgY29tcGFyYXRvcikge1xuICAgIGlmICghaXNBcnJheUxpa2UoYXJyYXkpKSB7XG4gICAgICBpZiAoYXJyYXkgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gYXJyYXk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBtaW5FcnIoJ2ZpbHRlcicpKCdub3RhcnJheScsICdFeHBlY3RlZCBhcnJheSBidXQgcmVjZWl2ZWQ6IHswfScsIGFycmF5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZXhwcmVzc2lvblR5cGUgPSBnZXRUeXBlRm9yRmlsdGVyKGV4cHJlc3Npb24pO1xuICAgIHZhciBwcmVkaWNhdGVGbjtcbiAgICB2YXIgbWF0Y2hBZ2FpbnN0QW55UHJvcDtcblxuICAgIHN3aXRjaCAoZXhwcmVzc2lvblR5cGUpIHtcbiAgICAgIGNhc2UgJ2Z1bmN0aW9uJzpcbiAgICAgICAgcHJlZGljYXRlRm4gPSBleHByZXNzaW9uO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgY2FzZSAnbnVsbCc6XG4gICAgICBjYXNlICdudW1iZXInOlxuICAgICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgICAgbWF0Y2hBZ2FpbnN0QW55UHJvcCA9IHRydWU7XG4gICAgICAgIC8vanNoaW50IC1XMDg2XG4gICAgICBjYXNlICdvYmplY3QnOlxuICAgICAgICAvL2pzaGludCArVzA4NlxuICAgICAgICBwcmVkaWNhdGVGbiA9IGNyZWF0ZVByZWRpY2F0ZUZuKGV4cHJlc3Npb24sIGNvbXBhcmF0b3IsIG1hdGNoQWdhaW5zdEFueVByb3ApO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBhcnJheTtcbiAgICB9XG5cbiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLmZpbHRlci5jYWxsKGFycmF5LCBwcmVkaWNhdGVGbik7XG4gIH07XG59XG5cbi8vIEhlbHBlciBmdW5jdGlvbnMgZm9yIGBmaWx0ZXJGaWx0ZXJgXG5mdW5jdGlvbiBjcmVhdGVQcmVkaWNhdGVGbihleHByZXNzaW9uLCBjb21wYXJhdG9yLCBtYXRjaEFnYWluc3RBbnlQcm9wKSB7XG4gIHZhciBzaG91bGRNYXRjaFByaW1pdGl2ZXMgPSBpc09iamVjdChleHByZXNzaW9uKSAmJiAoJyQnIGluIGV4cHJlc3Npb24pO1xuICB2YXIgcHJlZGljYXRlRm47XG5cbiAgaWYgKGNvbXBhcmF0b3IgPT09IHRydWUpIHtcbiAgICBjb21wYXJhdG9yID0gZXF1YWxzO1xuICB9IGVsc2UgaWYgKCFpc0Z1bmN0aW9uKGNvbXBhcmF0b3IpKSB7XG4gICAgY29tcGFyYXRvciA9IGZ1bmN0aW9uKGFjdHVhbCwgZXhwZWN0ZWQpIHtcbiAgICAgIGlmIChpc1VuZGVmaW5lZChhY3R1YWwpKSB7XG4gICAgICAgIC8vIE5vIHN1YnN0cmluZyBtYXRjaGluZyBhZ2FpbnN0IGB1bmRlZmluZWRgXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmICgoYWN0dWFsID09PSBudWxsKSB8fCAoZXhwZWN0ZWQgPT09IG51bGwpKSB7XG4gICAgICAgIC8vIE5vIHN1YnN0cmluZyBtYXRjaGluZyBhZ2FpbnN0IGBudWxsYDsgb25seSBtYXRjaCBhZ2FpbnN0IGBudWxsYFxuICAgICAgICByZXR1cm4gYWN0dWFsID09PSBleHBlY3RlZDtcbiAgICAgIH1cbiAgICAgIGlmIChpc09iamVjdChleHBlY3RlZCkgfHwgKGlzT2JqZWN0KGFjdHVhbCkgJiYgIWhhc0N1c3RvbVRvU3RyaW5nKGFjdHVhbCkpKSB7XG4gICAgICAgIC8vIFNob3VsZCBub3QgY29tcGFyZSBwcmltaXRpdmVzIGFnYWluc3Qgb2JqZWN0cywgdW5sZXNzIHRoZXkgaGF2ZSBjdXN0b20gYHRvU3RyaW5nYCBtZXRob2RcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBhY3R1YWwgPSBsb3dlcmNhc2UoJycgKyBhY3R1YWwpO1xuICAgICAgZXhwZWN0ZWQgPSBsb3dlcmNhc2UoJycgKyBleHBlY3RlZCk7XG4gICAgICByZXR1cm4gYWN0dWFsLmluZGV4T2YoZXhwZWN0ZWQpICE9PSAtMTtcbiAgICB9O1xuICB9XG5cbiAgcHJlZGljYXRlRm4gPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgaWYgKHNob3VsZE1hdGNoUHJpbWl0aXZlcyAmJiAhaXNPYmplY3QoaXRlbSkpIHtcbiAgICAgIHJldHVybiBkZWVwQ29tcGFyZShpdGVtLCBleHByZXNzaW9uLiQsIGNvbXBhcmF0b3IsIGZhbHNlKTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZXBDb21wYXJlKGl0ZW0sIGV4cHJlc3Npb24sIGNvbXBhcmF0b3IsIG1hdGNoQWdhaW5zdEFueVByb3ApO1xuICB9O1xuXG4gIHJldHVybiBwcmVkaWNhdGVGbjtcbn1cblxuZnVuY3Rpb24gZGVlcENvbXBhcmUoYWN0dWFsLCBleHBlY3RlZCwgY29tcGFyYXRvciwgbWF0Y2hBZ2FpbnN0QW55UHJvcCwgZG9udE1hdGNoV2hvbGVPYmplY3QpIHtcbiAgdmFyIGFjdHVhbFR5cGUgPSBnZXRUeXBlRm9yRmlsdGVyKGFjdHVhbCk7XG4gIHZhciBleHBlY3RlZFR5cGUgPSBnZXRUeXBlRm9yRmlsdGVyKGV4cGVjdGVkKTtcblxuICBpZiAoKGV4cGVjdGVkVHlwZSA9PT0gJ3N0cmluZycpICYmIChleHBlY3RlZC5jaGFyQXQoMCkgPT09ICchJykpIHtcbiAgICByZXR1cm4gIWRlZXBDb21wYXJlKGFjdHVhbCwgZXhwZWN0ZWQuc3Vic3RyaW5nKDEpLCBjb21wYXJhdG9yLCBtYXRjaEFnYWluc3RBbnlQcm9wKTtcbiAgfSBlbHNlIGlmIChpc0FycmF5KGFjdHVhbCkpIHtcbiAgICAvLyBJbiBjYXNlIGBhY3R1YWxgIGlzIGFuIGFycmF5LCBjb25zaWRlciBpdCBhIG1hdGNoXG4gICAgLy8gaWYgQU5ZIG9mIGl0J3MgaXRlbXMgbWF0Y2hlcyBgZXhwZWN0ZWRgXG4gICAgcmV0dXJuIGFjdHVhbC5zb21lKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIHJldHVybiBkZWVwQ29tcGFyZShpdGVtLCBleHBlY3RlZCwgY29tcGFyYXRvciwgbWF0Y2hBZ2FpbnN0QW55UHJvcCk7XG4gICAgfSk7XG4gIH1cblxuICBzd2l0Y2ggKGFjdHVhbFR5cGUpIHtcbiAgICBjYXNlICdvYmplY3QnOlxuICAgICAgdmFyIGtleTtcbiAgICAgIGlmIChtYXRjaEFnYWluc3RBbnlQcm9wKSB7XG4gICAgICAgIGZvciAoa2V5IGluIGFjdHVhbCkge1xuICAgICAgICAgIGlmICgoa2V5LmNoYXJBdCgwKSAhPT0gJyQnKSAmJiBkZWVwQ29tcGFyZShhY3R1YWxba2V5XSwgZXhwZWN0ZWQsIGNvbXBhcmF0b3IsIHRydWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbnRNYXRjaFdob2xlT2JqZWN0ID8gZmFsc2UgOiBkZWVwQ29tcGFyZShhY3R1YWwsIGV4cGVjdGVkLCBjb21wYXJhdG9yLCBmYWxzZSk7XG4gICAgICB9IGVsc2UgaWYgKGV4cGVjdGVkVHlwZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgZm9yIChrZXkgaW4gZXhwZWN0ZWQpIHtcbiAgICAgICAgICB2YXIgZXhwZWN0ZWRWYWwgPSBleHBlY3RlZFtrZXldO1xuICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGV4cGVjdGVkVmFsKSB8fCBpc1VuZGVmaW5lZChleHBlY3RlZFZhbCkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBtYXRjaEFueVByb3BlcnR5ID0ga2V5ID09PSAnJCc7XG4gICAgICAgICAgdmFyIGFjdHVhbFZhbCA9IG1hdGNoQW55UHJvcGVydHkgPyBhY3R1YWwgOiBhY3R1YWxba2V5XTtcbiAgICAgICAgICBpZiAoIWRlZXBDb21wYXJlKGFjdHVhbFZhbCwgZXhwZWN0ZWRWYWwsIGNvbXBhcmF0b3IsIG1hdGNoQW55UHJvcGVydHksIG1hdGNoQW55UHJvcGVydHkpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGNvbXBhcmF0b3IoYWN0dWFsLCBleHBlY3RlZCk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlICdmdW5jdGlvbic6XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBjb21wYXJhdG9yKGFjdHVhbCwgZXhwZWN0ZWQpO1xuICB9XG59XG5cbi8vIFVzZWQgZm9yIGVhc2lseSBkaWZmZXJlbnRpYXRpbmcgYmV0d2VlbiBgbnVsbGAgYW5kIGFjdHVhbCBgb2JqZWN0YFxuZnVuY3Rpb24gZ2V0VHlwZUZvckZpbHRlcih2YWwpIHtcbiAgcmV0dXJuICh2YWwgPT09IG51bGwpID8gJ251bGwnIDogdHlwZW9mIHZhbDtcbn1cblxudmFyIE1BWF9ESUdJVFMgPSAyMjtcbnZhciBERUNJTUFMX1NFUCA9ICcuJztcbnZhciBaRVJPX0NIQVIgPSAnMCc7XG5cbi8qKlxuICogQG5nZG9jIGZpbHRlclxuICogQG5hbWUgY3VycmVuY3lcbiAqIEBraW5kIGZ1bmN0aW9uXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBGb3JtYXRzIGEgbnVtYmVyIGFzIGEgY3VycmVuY3kgKGllICQxLDIzNC41NikuIFdoZW4gbm8gY3VycmVuY3kgc3ltYm9sIGlzIHByb3ZpZGVkLCBkZWZhdWx0XG4gKiBzeW1ib2wgZm9yIGN1cnJlbnQgbG9jYWxlIGlzIHVzZWQuXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCBJbnB1dCB0byBmaWx0ZXIuXG4gKiBAcGFyYW0ge3N0cmluZz19IHN5bWJvbCBDdXJyZW5jeSBzeW1ib2wgb3IgaWRlbnRpZmllciB0byBiZSBkaXNwbGF5ZWQuXG4gKiBAcGFyYW0ge251bWJlcj19IGZyYWN0aW9uU2l6ZSBOdW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMgdG8gcm91bmQgdGhlIGFtb3VudCB0bywgZGVmYXVsdHMgdG8gZGVmYXVsdCBtYXggZnJhY3Rpb24gc2l6ZSBmb3IgY3VycmVudCBsb2NhbGVcbiAqIEByZXR1cm5zIHtzdHJpbmd9IEZvcm1hdHRlZCBudW1iZXIuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZSBtb2R1bGU9XCJjdXJyZW5jeUV4YW1wbGVcIj5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICA8c2NyaXB0PlxuICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2N1cnJlbmN5RXhhbXBsZScsIFtdKVxuICAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICAgICRzY29wZS5hbW91bnQgPSAxMjM0LjU2O1xuICAgICAgICAgICB9XSk7XG4gICAgICAgPC9zY3JpcHQ+XG4gICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiAgICAgICAgIDxpbnB1dCB0eXBlPVwibnVtYmVyXCIgbmctbW9kZWw9XCJhbW91bnRcIiBhcmlhLWxhYmVsPVwiYW1vdW50XCI+IDxicj5cbiAgICAgICAgIGRlZmF1bHQgY3VycmVuY3kgc3ltYm9sICgkKTogPHNwYW4gaWQ9XCJjdXJyZW5jeS1kZWZhdWx0XCI+e3thbW91bnQgfCBjdXJyZW5jeX19PC9zcGFuPjxicj5cbiAgICAgICAgIGN1c3RvbSBjdXJyZW5jeSBpZGVudGlmaWVyIChVU0QkKTogPHNwYW4gaWQ9XCJjdXJyZW5jeS1jdXN0b21cIj57e2Ftb3VudCB8IGN1cnJlbmN5OlwiVVNEJFwifX08L3NwYW4+XG4gICAgICAgICBubyBmcmFjdGlvbnMgKDApOiA8c3BhbiBpZD1cImN1cnJlbmN5LW5vLWZyYWN0aW9uc1wiPnt7YW1vdW50IHwgY3VycmVuY3k6XCJVU0QkXCI6MH19PC9zcGFuPlxuICAgICAgIDwvZGl2PlxuICAgICA8L2ZpbGU+XG4gICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgICBpdCgnc2hvdWxkIGluaXQgd2l0aCAxMjM0LjU2JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnY3VycmVuY3ktZGVmYXVsdCcpKS5nZXRUZXh0KCkpLnRvQmUoJyQxLDIzNC41NicpO1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2N1cnJlbmN5LWN1c3RvbScpKS5nZXRUZXh0KCkpLnRvQmUoJ1VTRCQxLDIzNC41NicpO1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2N1cnJlbmN5LW5vLWZyYWN0aW9ucycpKS5nZXRUZXh0KCkpLnRvQmUoJ1VTRCQxLDIzNScpO1xuICAgICAgIH0pO1xuICAgICAgIGl0KCdzaG91bGQgdXBkYXRlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICBpZiAoYnJvd3Nlci5wYXJhbXMuYnJvd3NlciA9PSAnc2FmYXJpJykge1xuICAgICAgICAgICAvLyBTYWZhcmkgZG9lcyBub3QgdW5kZXJzdGFuZCB0aGUgbWludXMga2V5LiBTZWVcbiAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvcHJvdHJhY3Rvci9pc3N1ZXMvNDgxXG4gICAgICAgICAgIHJldHVybjtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ2Ftb3VudCcpKS5jbGVhcigpO1xuICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnYW1vdW50JykpLnNlbmRLZXlzKCctMTIzNCcpO1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2N1cnJlbmN5LWRlZmF1bHQnKSkuZ2V0VGV4dCgpKS50b0JlKCctJDEsMjM0LjAwJyk7XG4gICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnY3VycmVuY3ktY3VzdG9tJykpLmdldFRleHQoKSkudG9CZSgnLVVTRCQxLDIzNC4wMCcpO1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2N1cnJlbmN5LW5vLWZyYWN0aW9ucycpKS5nZXRUZXh0KCkpLnRvQmUoJy1VU0QkMSwyMzQnKTtcbiAgICAgICB9KTtcbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG5jdXJyZW5jeUZpbHRlci4kaW5qZWN0ID0gWyckbG9jYWxlJ107XG5mdW5jdGlvbiBjdXJyZW5jeUZpbHRlcigkbG9jYWxlKSB7XG4gIHZhciBmb3JtYXRzID0gJGxvY2FsZS5OVU1CRVJfRk9STUFUUztcbiAgcmV0dXJuIGZ1bmN0aW9uKGFtb3VudCwgY3VycmVuY3lTeW1ib2wsIGZyYWN0aW9uU2l6ZSkge1xuICAgIGlmIChpc1VuZGVmaW5lZChjdXJyZW5jeVN5bWJvbCkpIHtcbiAgICAgIGN1cnJlbmN5U3ltYm9sID0gZm9ybWF0cy5DVVJSRU5DWV9TWU07XG4gICAgfVxuXG4gICAgaWYgKGlzVW5kZWZpbmVkKGZyYWN0aW9uU2l6ZSkpIHtcbiAgICAgIGZyYWN0aW9uU2l6ZSA9IGZvcm1hdHMuUEFUVEVSTlNbMV0ubWF4RnJhYztcbiAgICB9XG5cbiAgICAvLyBpZiBudWxsIG9yIHVuZGVmaW5lZCBwYXNzIGl0IHRocm91Z2hcbiAgICByZXR1cm4gKGFtb3VudCA9PSBudWxsKVxuICAgICAgICA/IGFtb3VudFxuICAgICAgICA6IGZvcm1hdE51bWJlcihhbW91bnQsIGZvcm1hdHMuUEFUVEVSTlNbMV0sIGZvcm1hdHMuR1JPVVBfU0VQLCBmb3JtYXRzLkRFQ0lNQUxfU0VQLCBmcmFjdGlvblNpemUpLlxuICAgICAgICAgICAgcmVwbGFjZSgvXFx1MDBBNC9nLCBjdXJyZW5jeVN5bWJvbCk7XG4gIH07XG59XG5cbi8qKlxuICogQG5nZG9jIGZpbHRlclxuICogQG5hbWUgbnVtYmVyXG4gKiBAa2luZCBmdW5jdGlvblxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogRm9ybWF0cyBhIG51bWJlciBhcyB0ZXh0LlxuICpcbiAqIElmIHRoZSBpbnB1dCBpcyBudWxsIG9yIHVuZGVmaW5lZCwgaXQgd2lsbCBqdXN0IGJlIHJldHVybmVkLlxuICogSWYgdGhlIGlucHV0IGlzIGluZmluaXRlIChJbmZpbml0eS8tSW5maW5pdHkpIHRoZSBJbmZpbml0eSBzeW1ib2wgJ+KInicgaXMgcmV0dXJuZWQuXG4gKiBJZiB0aGUgaW5wdXQgaXMgbm90IGEgbnVtYmVyIGFuIGVtcHR5IHN0cmluZyBpcyByZXR1cm5lZC5cbiAqXG4gKlxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSBudW1iZXIgTnVtYmVyIHRvIGZvcm1hdC5cbiAqIEBwYXJhbSB7KG51bWJlcnxzdHJpbmcpPX0gZnJhY3Rpb25TaXplIE51bWJlciBvZiBkZWNpbWFsIHBsYWNlcyB0byByb3VuZCB0aGUgbnVtYmVyIHRvLlxuICogSWYgdGhpcyBpcyBub3QgcHJvdmlkZWQgdGhlbiB0aGUgZnJhY3Rpb24gc2l6ZSBpcyBjb21wdXRlZCBmcm9tIHRoZSBjdXJyZW50IGxvY2FsZSdzIG51bWJlclxuICogZm9ybWF0dGluZyBwYXR0ZXJuLiBJbiB0aGUgY2FzZSBvZiB0aGUgZGVmYXVsdCBsb2NhbGUsIGl0IHdpbGwgYmUgMy5cbiAqIEByZXR1cm5zIHtzdHJpbmd9IE51bWJlciByb3VuZGVkIHRvIGZyYWN0aW9uU2l6ZSBhbmQgcGxhY2VzIGEg4oCcLOKAnSBhZnRlciBlYWNoIHRoaXJkIGRpZ2l0LlxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZSBtb2R1bGU9XCJudW1iZXJGaWx0ZXJFeGFtcGxlXCI+XG4gICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgPHNjcmlwdD5cbiAgICAgICAgIGFuZ3VsYXIubW9kdWxlKCdudW1iZXJGaWx0ZXJFeGFtcGxlJywgW10pXG4gICAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgICAgJHNjb3BlLnZhbCA9IDEyMzQuNTY3ODk7XG4gICAgICAgICAgIH1dKTtcbiAgICAgICA8L3NjcmlwdD5cbiAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICAgICAgPGxhYmVsPkVudGVyIG51bWJlcjogPGlucHV0IG5nLW1vZGVsPSd2YWwnPjwvbGFiZWw+PGJyPlxuICAgICAgICAgRGVmYXVsdCBmb3JtYXR0aW5nOiA8c3BhbiBpZD0nbnVtYmVyLWRlZmF1bHQnPnt7dmFsIHwgbnVtYmVyfX08L3NwYW4+PGJyPlxuICAgICAgICAgTm8gZnJhY3Rpb25zOiA8c3Bhbj57e3ZhbCB8IG51bWJlcjowfX08L3NwYW4+PGJyPlxuICAgICAgICAgTmVnYXRpdmUgbnVtYmVyOiA8c3Bhbj57ey12YWwgfCBudW1iZXI6NH19PC9zcGFuPlxuICAgICAgIDwvZGl2PlxuICAgICA8L2ZpbGU+XG4gICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgICBpdCgnc2hvdWxkIGZvcm1hdCBudW1iZXJzJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnbnVtYmVyLWRlZmF1bHQnKSkuZ2V0VGV4dCgpKS50b0JlKCcxLDIzNC41NjgnKTtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ3ZhbCB8IG51bWJlcjowJykpLmdldFRleHQoKSkudG9CZSgnMSwyMzUnKTtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJy12YWwgfCBudW1iZXI6NCcpKS5nZXRUZXh0KCkpLnRvQmUoJy0xLDIzNC41Njc5Jyk7XG4gICAgICAgfSk7XG5cbiAgICAgICBpdCgnc2hvdWxkIHVwZGF0ZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgZWxlbWVudChieS5tb2RlbCgndmFsJykpLmNsZWFyKCk7XG4gICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCd2YWwnKSkuc2VuZEtleXMoJzMzNzQuMzMzJyk7XG4gICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnbnVtYmVyLWRlZmF1bHQnKSkuZ2V0VGV4dCgpKS50b0JlKCczLDM3NC4zMzMnKTtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ3ZhbCB8IG51bWJlcjowJykpLmdldFRleHQoKSkudG9CZSgnMywzNzQnKTtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJy12YWwgfCBudW1iZXI6NCcpKS5nZXRUZXh0KCkpLnRvQmUoJy0zLDM3NC4zMzMwJyk7XG4gICAgICB9KTtcbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG5udW1iZXJGaWx0ZXIuJGluamVjdCA9IFsnJGxvY2FsZSddO1xuZnVuY3Rpb24gbnVtYmVyRmlsdGVyKCRsb2NhbGUpIHtcbiAgdmFyIGZvcm1hdHMgPSAkbG9jYWxlLk5VTUJFUl9GT1JNQVRTO1xuICByZXR1cm4gZnVuY3Rpb24obnVtYmVyLCBmcmFjdGlvblNpemUpIHtcblxuICAgIC8vIGlmIG51bGwgb3IgdW5kZWZpbmVkIHBhc3MgaXQgdGhyb3VnaFxuICAgIHJldHVybiAobnVtYmVyID09IG51bGwpXG4gICAgICAgID8gbnVtYmVyXG4gICAgICAgIDogZm9ybWF0TnVtYmVyKG51bWJlciwgZm9ybWF0cy5QQVRURVJOU1swXSwgZm9ybWF0cy5HUk9VUF9TRVAsIGZvcm1hdHMuREVDSU1BTF9TRVAsXG4gICAgICAgICAgICAgICAgICAgICAgIGZyYWN0aW9uU2l6ZSk7XG4gIH07XG59XG5cbi8qKlxuICogUGFyc2UgYSBudW1iZXIgKGFzIGEgc3RyaW5nKSBpbnRvIHRocmVlIGNvbXBvbmVudHMgdGhhdCBjYW4gYmUgdXNlZFxuICogZm9yIGZvcm1hdHRpbmcgdGhlIG51bWJlci5cbiAqXG4gKiAoU2lnbmlmaWNhbnQgYml0cyBvZiB0aGlzIHBhcnNlIGFsZ29yaXRobSBjYW1lIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL01pa2VNY2wvYmlnLmpzLylcbiAqXG4gKiBAcGFyYW0gIHtzdHJpbmd9IG51bVN0ciBUaGUgbnVtYmVyIHRvIHBhcnNlXG4gKiBAcmV0dXJuIHtvYmplY3R9IEFuIG9iamVjdCBkZXNjcmliaW5nIHRoaXMgbnVtYmVyLCBjb250YWluaW5nIHRoZSBmb2xsb3dpbmcga2V5czpcbiAqICAtIGQgOiBhbiBhcnJheSBvZiBkaWdpdHMgY29udGFpbmluZyBsZWFkaW5nIHplcm9zIGFzIG5lY2Vzc2FyeVxuICogIC0gaSA6IHRoZSBudW1iZXIgb2YgdGhlIGRpZ2l0cyBpbiBgZGAgdGhhdCBhcmUgdG8gdGhlIGxlZnQgb2YgdGhlIGRlY2ltYWwgcG9pbnRcbiAqICAtIGUgOiB0aGUgZXhwb25lbnQgZm9yIG51bWJlcnMgdGhhdCB3b3VsZCBuZWVkIG1vcmUgdGhhbiBgTUFYX0RJR0lUU2AgZGlnaXRzIGluIGBkYFxuICpcbiAqL1xuZnVuY3Rpb24gcGFyc2UobnVtU3RyKSB7XG4gIHZhciBleHBvbmVudCA9IDAsIGRpZ2l0cywgbnVtYmVyT2ZJbnRlZ2VyRGlnaXRzO1xuICB2YXIgaSwgaiwgemVyb3M7XG5cbiAgLy8gRGVjaW1hbCBwb2ludD9cbiAgaWYgKChudW1iZXJPZkludGVnZXJEaWdpdHMgPSBudW1TdHIuaW5kZXhPZihERUNJTUFMX1NFUCkpID4gLTEpIHtcbiAgICBudW1TdHIgPSBudW1TdHIucmVwbGFjZShERUNJTUFMX1NFUCwgJycpO1xuICB9XG5cbiAgLy8gRXhwb25lbnRpYWwgZm9ybT9cbiAgaWYgKChpID0gbnVtU3RyLnNlYXJjaCgvZS9pKSkgPiAwKSB7XG4gICAgLy8gV29yayBvdXQgdGhlIGV4cG9uZW50LlxuICAgIGlmIChudW1iZXJPZkludGVnZXJEaWdpdHMgPCAwKSBudW1iZXJPZkludGVnZXJEaWdpdHMgPSBpO1xuICAgIG51bWJlck9mSW50ZWdlckRpZ2l0cyArPSArbnVtU3RyLnNsaWNlKGkgKyAxKTtcbiAgICBudW1TdHIgPSBudW1TdHIuc3Vic3RyaW5nKDAsIGkpO1xuICB9IGVsc2UgaWYgKG51bWJlck9mSW50ZWdlckRpZ2l0cyA8IDApIHtcbiAgICAvLyBUaGVyZSB3YXMgbm8gZGVjaW1hbCBwb2ludCBvciBleHBvbmVudCBzbyBpdCBpcyBhbiBpbnRlZ2VyLlxuICAgIG51bWJlck9mSW50ZWdlckRpZ2l0cyA9IG51bVN0ci5sZW5ndGg7XG4gIH1cblxuICAvLyBDb3VudCB0aGUgbnVtYmVyIG9mIGxlYWRpbmcgemVyb3MuXG4gIGZvciAoaSA9IDA7IG51bVN0ci5jaGFyQXQoaSkgPT0gWkVST19DSEFSOyBpKyspO1xuXG4gIGlmIChpID09ICh6ZXJvcyA9IG51bVN0ci5sZW5ndGgpKSB7XG4gICAgLy8gVGhlIGRpZ2l0cyBhcmUgYWxsIHplcm8uXG4gICAgZGlnaXRzID0gWzBdO1xuICAgIG51bWJlck9mSW50ZWdlckRpZ2l0cyA9IDE7XG4gIH0gZWxzZSB7XG4gICAgLy8gQ291bnQgdGhlIG51bWJlciBvZiB0cmFpbGluZyB6ZXJvc1xuICAgIHplcm9zLS07XG4gICAgd2hpbGUgKG51bVN0ci5jaGFyQXQoemVyb3MpID09IFpFUk9fQ0hBUikgemVyb3MtLTtcblxuICAgIC8vIFRyYWlsaW5nIHplcm9zIGFyZSBpbnNpZ25pZmljYW50IHNvIGlnbm9yZSB0aGVtXG4gICAgbnVtYmVyT2ZJbnRlZ2VyRGlnaXRzIC09IGk7XG4gICAgZGlnaXRzID0gW107XG4gICAgLy8gQ29udmVydCBzdHJpbmcgdG8gYXJyYXkgb2YgZGlnaXRzIHdpdGhvdXQgbGVhZGluZy90cmFpbGluZyB6ZXJvcy5cbiAgICBmb3IgKGogPSAwOyBpIDw9IHplcm9zOyBpKyssIGorKykge1xuICAgICAgZGlnaXRzW2pdID0gK251bVN0ci5jaGFyQXQoaSk7XG4gICAgfVxuICB9XG5cbiAgLy8gSWYgdGhlIG51bWJlciBvdmVyZmxvd3MgdGhlIG1heGltdW0gYWxsb3dlZCBkaWdpdHMgdGhlbiB1c2UgYW4gZXhwb25lbnQuXG4gIGlmIChudW1iZXJPZkludGVnZXJEaWdpdHMgPiBNQVhfRElHSVRTKSB7XG4gICAgZGlnaXRzID0gZGlnaXRzLnNwbGljZSgwLCBNQVhfRElHSVRTIC0gMSk7XG4gICAgZXhwb25lbnQgPSBudW1iZXJPZkludGVnZXJEaWdpdHMgLSAxO1xuICAgIG51bWJlck9mSW50ZWdlckRpZ2l0cyA9IDE7XG4gIH1cblxuICByZXR1cm4geyBkOiBkaWdpdHMsIGU6IGV4cG9uZW50LCBpOiBudW1iZXJPZkludGVnZXJEaWdpdHMgfTtcbn1cblxuLyoqXG4gKiBSb3VuZCB0aGUgcGFyc2VkIG51bWJlciB0byB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlc1xuICogVGhpcyBmdW5jdGlvbiBjaGFuZ2VkIHRoZSBwYXJzZWROdW1iZXIgaW4tcGxhY2VcbiAqL1xuZnVuY3Rpb24gcm91bmROdW1iZXIocGFyc2VkTnVtYmVyLCBmcmFjdGlvblNpemUsIG1pbkZyYWMsIG1heEZyYWMpIHtcbiAgICB2YXIgZGlnaXRzID0gcGFyc2VkTnVtYmVyLmQ7XG4gICAgdmFyIGZyYWN0aW9uTGVuID0gZGlnaXRzLmxlbmd0aCAtIHBhcnNlZE51bWJlci5pO1xuXG4gICAgLy8gZGV0ZXJtaW5lIGZyYWN0aW9uU2l6ZSBpZiBpdCBpcyBub3Qgc3BlY2lmaWVkOyBgK2ZyYWN0aW9uU2l6ZWAgY29udmVydHMgaXQgdG8gYSBudW1iZXJcbiAgICBmcmFjdGlvblNpemUgPSAoaXNVbmRlZmluZWQoZnJhY3Rpb25TaXplKSkgPyBNYXRoLm1pbihNYXRoLm1heChtaW5GcmFjLCBmcmFjdGlvbkxlbiksIG1heEZyYWMpIDogK2ZyYWN0aW9uU2l6ZTtcblxuICAgIC8vIFRoZSBpbmRleCBvZiB0aGUgZGlnaXQgdG8gd2hlcmUgcm91bmRpbmcgaXMgdG8gb2NjdXJcbiAgICB2YXIgcm91bmRBdCA9IGZyYWN0aW9uU2l6ZSArIHBhcnNlZE51bWJlci5pO1xuICAgIHZhciBkaWdpdCA9IGRpZ2l0c1tyb3VuZEF0XTtcblxuICAgIGlmIChyb3VuZEF0ID4gMCkge1xuICAgICAgZGlnaXRzLnNwbGljZShyb3VuZEF0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gV2Ugcm91bmRlZCB0byB6ZXJvIHNvIHJlc2V0IHRoZSBwYXJzZWROdW1iZXJcbiAgICAgIHBhcnNlZE51bWJlci5pID0gMTtcbiAgICAgIGRpZ2l0cy5sZW5ndGggPSByb3VuZEF0ID0gZnJhY3Rpb25TaXplICsgMTtcbiAgICAgIGZvciAodmFyIGk9MDsgaSA8IHJvdW5kQXQ7IGkrKykgZGlnaXRzW2ldID0gMDtcbiAgICB9XG5cbiAgICBpZiAoZGlnaXQgPj0gNSkgZGlnaXRzW3JvdW5kQXQgLSAxXSsrO1xuXG4gICAgLy8gUGFkIG91dCB3aXRoIHplcm9zIHRvIGdldCB0aGUgcmVxdWlyZWQgZnJhY3Rpb24gbGVuZ3RoXG4gICAgZm9yICg7IGZyYWN0aW9uTGVuIDwgZnJhY3Rpb25TaXplOyBmcmFjdGlvbkxlbisrKSBkaWdpdHMucHVzaCgwKTtcblxuXG4gICAgLy8gRG8gYW55IGNhcnJ5aW5nLCBlLmcuIGEgZGlnaXQgd2FzIHJvdW5kZWQgdXAgdG8gMTBcbiAgICB2YXIgY2FycnkgPSBkaWdpdHMucmVkdWNlUmlnaHQoZnVuY3Rpb24oY2FycnksIGQsIGksIGRpZ2l0cykge1xuICAgICAgZCA9IGQgKyBjYXJyeTtcbiAgICAgIGRpZ2l0c1tpXSA9IGQgJSAxMDtcbiAgICAgIHJldHVybiBNYXRoLmZsb29yKGQgLyAxMCk7XG4gICAgfSwgMCk7XG4gICAgaWYgKGNhcnJ5KSB7XG4gICAgICBkaWdpdHMudW5zaGlmdChjYXJyeSk7XG4gICAgICBwYXJzZWROdW1iZXIuaSsrO1xuICAgIH1cbn1cblxuLyoqXG4gKiBGb3JtYXQgYSBudW1iZXIgaW50byBhIHN0cmluZ1xuICogQHBhcmFtICB7bnVtYmVyfSBudW1iZXIgICAgICAgVGhlIG51bWJlciB0byBmb3JtYXRcbiAqIEBwYXJhbSAge3tcbiAqICAgICAgICAgICBtaW5GcmFjLCAvLyB0aGUgbWluaW11bSBudW1iZXIgb2YgZGlnaXRzIHJlcXVpcmVkIGluIHRoZSBmcmFjdGlvbiBwYXJ0IG9mIHRoZSBudW1iZXJcbiAqICAgICAgICAgICBtYXhGcmFjLCAvLyB0aGUgbWF4aW11bSBudW1iZXIgb2YgZGlnaXRzIHJlcXVpcmVkIGluIHRoZSBmcmFjdGlvbiBwYXJ0IG9mIHRoZSBudW1iZXJcbiAqICAgICAgICAgICBnU2l6ZSwgICAvLyBudW1iZXIgb2YgZGlnaXRzIGluIGVhY2ggZ3JvdXAgb2Ygc2VwYXJhdGVkIGRpZ2l0c1xuICogICAgICAgICAgIGxnU2l6ZSwgIC8vIG51bWJlciBvZiBkaWdpdHMgaW4gdGhlIGxhc3QgZ3JvdXAgb2YgZGlnaXRzIGJlZm9yZSB0aGUgZGVjaW1hbCBzZXBhcmF0b3JcbiAqICAgICAgICAgICBuZWdQcmUsICAvLyB0aGUgc3RyaW5nIHRvIGdvIGluIGZyb250IG9mIGEgbmVnYXRpdmUgbnVtYmVyIChlLmcuIGAtYCBvciBgKGApKVxuICogICAgICAgICAgIHBvc1ByZSwgIC8vIHRoZSBzdHJpbmcgdG8gZ28gaW4gZnJvbnQgb2YgYSBwb3NpdGl2ZSBudW1iZXJcbiAqICAgICAgICAgICBuZWdTdWYsICAvLyB0aGUgc3RyaW5nIHRvIGdvIGFmdGVyIGEgbmVnYXRpdmUgbnVtYmVyIChlLmcuIGApYClcbiAqICAgICAgICAgICBwb3NTdWYgICAvLyB0aGUgc3RyaW5nIHRvIGdvIGFmdGVyIGEgcG9zaXRpdmUgbnVtYmVyXG4gKiAgICAgICAgIH19IHBhdHRlcm5cbiAqIEBwYXJhbSAge3N0cmluZ30gZ3JvdXBTZXAgICAgIFRoZSBzdHJpbmcgdG8gc2VwYXJhdGUgZ3JvdXBzIG9mIG51bWJlciAoZS5nLiBgLGApXG4gKiBAcGFyYW0gIHtzdHJpbmd9IGRlY2ltYWxTZXAgICBUaGUgc3RyaW5nIHRvIGFjdCBhcyB0aGUgZGVjaW1hbCBzZXBhcmF0b3IgKGUuZy4gYC5gKVxuICogQHBhcmFtICB7W3R5cGVdfSBmcmFjdGlvblNpemUgVGhlIHNpemUgb2YgdGhlIGZyYWN0aW9uYWwgcGFydCBvZiB0aGUgbnVtYmVyXG4gKiBAcmV0dXJuIHtzdHJpbmd9ICAgICAgICAgICAgICBUaGUgbnVtYmVyIGZvcm1hdHRlZCBhcyBhIHN0cmluZ1xuICovXG5mdW5jdGlvbiBmb3JtYXROdW1iZXIobnVtYmVyLCBwYXR0ZXJuLCBncm91cFNlcCwgZGVjaW1hbFNlcCwgZnJhY3Rpb25TaXplKSB7XG5cbiAgaWYgKCEoaXNTdHJpbmcobnVtYmVyKSB8fCBpc051bWJlcihudW1iZXIpKSB8fCBpc05hTihudW1iZXIpKSByZXR1cm4gJyc7XG5cbiAgdmFyIGlzSW5maW5pdHkgPSAhaXNGaW5pdGUobnVtYmVyKTtcbiAgdmFyIGlzWmVybyA9IGZhbHNlO1xuICB2YXIgbnVtU3RyID0gTWF0aC5hYnMobnVtYmVyKSArICcnLFxuICAgICAgZm9ybWF0dGVkVGV4dCA9ICcnLFxuICAgICAgcGFyc2VkTnVtYmVyO1xuXG4gIGlmIChpc0luZmluaXR5KSB7XG4gICAgZm9ybWF0dGVkVGV4dCA9ICdcXHUyMjFlJztcbiAgfSBlbHNlIHtcbiAgICBwYXJzZWROdW1iZXIgPSBwYXJzZShudW1TdHIpO1xuXG4gICAgcm91bmROdW1iZXIocGFyc2VkTnVtYmVyLCBmcmFjdGlvblNpemUsIHBhdHRlcm4ubWluRnJhYywgcGF0dGVybi5tYXhGcmFjKTtcblxuICAgIHZhciBkaWdpdHMgPSBwYXJzZWROdW1iZXIuZDtcbiAgICB2YXIgaW50ZWdlckxlbiA9IHBhcnNlZE51bWJlci5pO1xuICAgIHZhciBleHBvbmVudCA9IHBhcnNlZE51bWJlci5lO1xuICAgIHZhciBkZWNpbWFscyA9IFtdO1xuICAgIGlzWmVybyA9IGRpZ2l0cy5yZWR1Y2UoZnVuY3Rpb24oaXNaZXJvLCBkKSB7IHJldHVybiBpc1plcm8gJiYgIWQ7IH0sIHRydWUpO1xuXG4gICAgLy8gcGFkIHplcm9zIGZvciBzbWFsbCBudW1iZXJzXG4gICAgd2hpbGUgKGludGVnZXJMZW4gPCAwKSB7XG4gICAgICBkaWdpdHMudW5zaGlmdCgwKTtcbiAgICAgIGludGVnZXJMZW4rKztcbiAgICB9XG5cbiAgICAvLyBleHRyYWN0IGRlY2ltYWxzIGRpZ2l0c1xuICAgIGlmIChpbnRlZ2VyTGVuID4gMCkge1xuICAgICAgZGVjaW1hbHMgPSBkaWdpdHMuc3BsaWNlKGludGVnZXJMZW4pO1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWNpbWFscyA9IGRpZ2l0cztcbiAgICAgIGRpZ2l0cyA9IFswXTtcbiAgICB9XG5cbiAgICAvLyBmb3JtYXQgdGhlIGludGVnZXIgZGlnaXRzIHdpdGggZ3JvdXBpbmcgc2VwYXJhdG9yc1xuICAgIHZhciBncm91cHMgPSBbXTtcbiAgICBpZiAoZGlnaXRzLmxlbmd0aCA+IHBhdHRlcm4ubGdTaXplKSB7XG4gICAgICBncm91cHMudW5zaGlmdChkaWdpdHMuc3BsaWNlKC1wYXR0ZXJuLmxnU2l6ZSkuam9pbignJykpO1xuICAgIH1cbiAgICB3aGlsZSAoZGlnaXRzLmxlbmd0aCA+IHBhdHRlcm4uZ1NpemUpIHtcbiAgICAgIGdyb3Vwcy51bnNoaWZ0KGRpZ2l0cy5zcGxpY2UoLXBhdHRlcm4uZ1NpemUpLmpvaW4oJycpKTtcbiAgICB9XG4gICAgaWYgKGRpZ2l0cy5sZW5ndGgpIHtcbiAgICAgIGdyb3Vwcy51bnNoaWZ0KGRpZ2l0cy5qb2luKCcnKSk7XG4gICAgfVxuICAgIGZvcm1hdHRlZFRleHQgPSBncm91cHMuam9pbihncm91cFNlcCk7XG5cbiAgICAvLyBhcHBlbmQgdGhlIGRlY2ltYWwgZGlnaXRzXG4gICAgaWYgKGRlY2ltYWxzLmxlbmd0aCkge1xuICAgICAgZm9ybWF0dGVkVGV4dCArPSBkZWNpbWFsU2VwICsgZGVjaW1hbHMuam9pbignJyk7XG4gICAgfVxuXG4gICAgaWYgKGV4cG9uZW50KSB7XG4gICAgICBmb3JtYXR0ZWRUZXh0ICs9ICdlKycgKyBleHBvbmVudDtcbiAgICB9XG4gIH1cbiAgaWYgKG51bWJlciA8IDAgJiYgIWlzWmVybykge1xuICAgIHJldHVybiBwYXR0ZXJuLm5lZ1ByZSArIGZvcm1hdHRlZFRleHQgKyBwYXR0ZXJuLm5lZ1N1ZjtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gcGF0dGVybi5wb3NQcmUgKyBmb3JtYXR0ZWRUZXh0ICsgcGF0dGVybi5wb3NTdWY7XG4gIH1cbn1cblxuZnVuY3Rpb24gcGFkTnVtYmVyKG51bSwgZGlnaXRzLCB0cmltKSB7XG4gIHZhciBuZWcgPSAnJztcbiAgaWYgKG51bSA8IDApIHtcbiAgICBuZWcgPSAgJy0nO1xuICAgIG51bSA9IC1udW07XG4gIH1cbiAgbnVtID0gJycgKyBudW07XG4gIHdoaWxlIChudW0ubGVuZ3RoIDwgZGlnaXRzKSBudW0gPSBaRVJPX0NIQVIgKyBudW07XG4gIGlmICh0cmltKSB7XG4gICAgbnVtID0gbnVtLnN1YnN0cihudW0ubGVuZ3RoIC0gZGlnaXRzKTtcbiAgfVxuICByZXR1cm4gbmVnICsgbnVtO1xufVxuXG5cbmZ1bmN0aW9uIGRhdGVHZXR0ZXIobmFtZSwgc2l6ZSwgb2Zmc2V0LCB0cmltKSB7XG4gIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuICByZXR1cm4gZnVuY3Rpb24oZGF0ZSkge1xuICAgIHZhciB2YWx1ZSA9IGRhdGVbJ2dldCcgKyBuYW1lXSgpO1xuICAgIGlmIChvZmZzZXQgPiAwIHx8IHZhbHVlID4gLW9mZnNldCkge1xuICAgICAgdmFsdWUgKz0gb2Zmc2V0O1xuICAgIH1cbiAgICBpZiAodmFsdWUgPT09IDAgJiYgb2Zmc2V0ID09IC0xMikgdmFsdWUgPSAxMjtcbiAgICByZXR1cm4gcGFkTnVtYmVyKHZhbHVlLCBzaXplLCB0cmltKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gZGF0ZVN0ckdldHRlcihuYW1lLCBzaG9ydEZvcm0pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGRhdGUsIGZvcm1hdHMpIHtcbiAgICB2YXIgdmFsdWUgPSBkYXRlWydnZXQnICsgbmFtZV0oKTtcbiAgICB2YXIgZ2V0ID0gdXBwZXJjYXNlKHNob3J0Rm9ybSA/ICgnU0hPUlQnICsgbmFtZSkgOiBuYW1lKTtcblxuICAgIHJldHVybiBmb3JtYXRzW2dldF1bdmFsdWVdO1xuICB9O1xufVxuXG5mdW5jdGlvbiB0aW1lWm9uZUdldHRlcihkYXRlLCBmb3JtYXRzLCBvZmZzZXQpIHtcbiAgdmFyIHpvbmUgPSAtMSAqIG9mZnNldDtcbiAgdmFyIHBhZGRlZFpvbmUgPSAoem9uZSA+PSAwKSA/IFwiK1wiIDogXCJcIjtcblxuICBwYWRkZWRab25lICs9IHBhZE51bWJlcihNYXRoW3pvbmUgPiAwID8gJ2Zsb29yJyA6ICdjZWlsJ10oem9uZSAvIDYwKSwgMikgK1xuICAgICAgICAgICAgICAgIHBhZE51bWJlcihNYXRoLmFicyh6b25lICUgNjApLCAyKTtcblxuICByZXR1cm4gcGFkZGVkWm9uZTtcbn1cblxuZnVuY3Rpb24gZ2V0Rmlyc3RUaHVyc2RheU9mWWVhcih5ZWFyKSB7XG4gICAgLy8gMCA9IGluZGV4IG9mIEphbnVhcnlcbiAgICB2YXIgZGF5T2ZXZWVrT25GaXJzdCA9IChuZXcgRGF0ZSh5ZWFyLCAwLCAxKSkuZ2V0RGF5KCk7XG4gICAgLy8gNCA9IGluZGV4IG9mIFRodXJzZGF5ICgrMSB0byBhY2NvdW50IGZvciAxc3QgPSA1KVxuICAgIC8vIDExID0gaW5kZXggb2YgKm5leHQqIFRodXJzZGF5ICgrMSBhY2NvdW50IGZvciAxc3QgPSAxMilcbiAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgMCwgKChkYXlPZldlZWtPbkZpcnN0IDw9IDQpID8gNSA6IDEyKSAtIGRheU9mV2Vla09uRmlyc3QpO1xufVxuXG5mdW5jdGlvbiBnZXRUaHVyc2RheVRoaXNXZWVrKGRhdGV0aW1lKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKGRhdGV0aW1lLmdldEZ1bGxZZWFyKCksIGRhdGV0aW1lLmdldE1vbnRoKCksXG4gICAgICAvLyA0ID0gaW5kZXggb2YgVGh1cnNkYXlcbiAgICAgIGRhdGV0aW1lLmdldERhdGUoKSArICg0IC0gZGF0ZXRpbWUuZ2V0RGF5KCkpKTtcbn1cblxuZnVuY3Rpb24gd2Vla0dldHRlcihzaXplKSB7XG4gICByZXR1cm4gZnVuY3Rpb24oZGF0ZSkge1xuICAgICAgdmFyIGZpcnN0VGh1cnMgPSBnZXRGaXJzdFRodXJzZGF5T2ZZZWFyKGRhdGUuZ2V0RnVsbFllYXIoKSksXG4gICAgICAgICB0aGlzVGh1cnMgPSBnZXRUaHVyc2RheVRoaXNXZWVrKGRhdGUpO1xuXG4gICAgICB2YXIgZGlmZiA9ICt0aGlzVGh1cnMgLSArZmlyc3RUaHVycyxcbiAgICAgICAgIHJlc3VsdCA9IDEgKyBNYXRoLnJvdW5kKGRpZmYgLyA2LjA0OGU4KTsgLy8gNi4wNDhlOCBtcyBwZXIgd2Vla1xuXG4gICAgICByZXR1cm4gcGFkTnVtYmVyKHJlc3VsdCwgc2l6ZSk7XG4gICB9O1xufVxuXG5mdW5jdGlvbiBhbXBtR2V0dGVyKGRhdGUsIGZvcm1hdHMpIHtcbiAgcmV0dXJuIGRhdGUuZ2V0SG91cnMoKSA8IDEyID8gZm9ybWF0cy5BTVBNU1swXSA6IGZvcm1hdHMuQU1QTVNbMV07XG59XG5cbmZ1bmN0aW9uIGVyYUdldHRlcihkYXRlLCBmb3JtYXRzKSB7XG4gIHJldHVybiBkYXRlLmdldEZ1bGxZZWFyKCkgPD0gMCA/IGZvcm1hdHMuRVJBU1swXSA6IGZvcm1hdHMuRVJBU1sxXTtcbn1cblxuZnVuY3Rpb24gbG9uZ0VyYUdldHRlcihkYXRlLCBmb3JtYXRzKSB7XG4gIHJldHVybiBkYXRlLmdldEZ1bGxZZWFyKCkgPD0gMCA/IGZvcm1hdHMuRVJBTkFNRVNbMF0gOiBmb3JtYXRzLkVSQU5BTUVTWzFdO1xufVxuXG52YXIgREFURV9GT1JNQVRTID0ge1xuICB5eXl5OiBkYXRlR2V0dGVyKCdGdWxsWWVhcicsIDQpLFxuICAgIHl5OiBkYXRlR2V0dGVyKCdGdWxsWWVhcicsIDIsIDAsIHRydWUpLFxuICAgICB5OiBkYXRlR2V0dGVyKCdGdWxsWWVhcicsIDEpLFxuICBNTU1NOiBkYXRlU3RyR2V0dGVyKCdNb250aCcpLFxuICAgTU1NOiBkYXRlU3RyR2V0dGVyKCdNb250aCcsIHRydWUpLFxuICAgIE1NOiBkYXRlR2V0dGVyKCdNb250aCcsIDIsIDEpLFxuICAgICBNOiBkYXRlR2V0dGVyKCdNb250aCcsIDEsIDEpLFxuICAgIGRkOiBkYXRlR2V0dGVyKCdEYXRlJywgMiksXG4gICAgIGQ6IGRhdGVHZXR0ZXIoJ0RhdGUnLCAxKSxcbiAgICBISDogZGF0ZUdldHRlcignSG91cnMnLCAyKSxcbiAgICAgSDogZGF0ZUdldHRlcignSG91cnMnLCAxKSxcbiAgICBoaDogZGF0ZUdldHRlcignSG91cnMnLCAyLCAtMTIpLFxuICAgICBoOiBkYXRlR2V0dGVyKCdIb3VycycsIDEsIC0xMiksXG4gICAgbW06IGRhdGVHZXR0ZXIoJ01pbnV0ZXMnLCAyKSxcbiAgICAgbTogZGF0ZUdldHRlcignTWludXRlcycsIDEpLFxuICAgIHNzOiBkYXRlR2V0dGVyKCdTZWNvbmRzJywgMiksXG4gICAgIHM6IGRhdGVHZXR0ZXIoJ1NlY29uZHMnLCAxKSxcbiAgICAgLy8gd2hpbGUgSVNPIDg2MDEgcmVxdWlyZXMgZnJhY3Rpb25zIHRvIGJlIHByZWZpeGVkIHdpdGggYC5gIG9yIGAsYFxuICAgICAvLyB3ZSBjYW4gYmUganVzdCBzYWZlbHkgcmVseSBvbiB1c2luZyBgc3NzYCBzaW5jZSB3ZSBjdXJyZW50bHkgZG9uJ3Qgc3VwcG9ydCBzaW5nbGUgb3IgdHdvIGRpZ2l0IGZyYWN0aW9uc1xuICAgc3NzOiBkYXRlR2V0dGVyKCdNaWxsaXNlY29uZHMnLCAzKSxcbiAgRUVFRTogZGF0ZVN0ckdldHRlcignRGF5JyksXG4gICBFRUU6IGRhdGVTdHJHZXR0ZXIoJ0RheScsIHRydWUpLFxuICAgICBhOiBhbXBtR2V0dGVyLFxuICAgICBaOiB0aW1lWm9uZUdldHRlcixcbiAgICB3dzogd2Vla0dldHRlcigyKSxcbiAgICAgdzogd2Vla0dldHRlcigxKSxcbiAgICAgRzogZXJhR2V0dGVyLFxuICAgICBHRzogZXJhR2V0dGVyLFxuICAgICBHR0c6IGVyYUdldHRlcixcbiAgICAgR0dHRzogbG9uZ0VyYUdldHRlclxufTtcblxudmFyIERBVEVfRk9STUFUU19TUExJVCA9IC8oKD86W155TWRIaG1zYVpFd0cnXSspfCg/OicoPzpbXiddfCcnKSonKXwoPzpFK3x5K3xNK3xkK3xIK3xoK3xtK3xzK3xhfFp8Ryt8dyspKSguKikvLFxuICAgIE5VTUJFUl9TVFJJTkcgPSAvXlxcLT9cXGQrJC87XG5cbi8qKlxuICogQG5nZG9jIGZpbHRlclxuICogQG5hbWUgZGF0ZVxuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqICAgRm9ybWF0cyBgZGF0ZWAgdG8gYSBzdHJpbmcgYmFzZWQgb24gdGhlIHJlcXVlc3RlZCBgZm9ybWF0YC5cbiAqXG4gKiAgIGBmb3JtYXRgIHN0cmluZyBjYW4gYmUgY29tcG9zZWQgb2YgdGhlIGZvbGxvd2luZyBlbGVtZW50czpcbiAqXG4gKiAgICogYCd5eXl5J2A6IDQgZGlnaXQgcmVwcmVzZW50YXRpb24gb2YgeWVhciAoZS5nLiBBRCAxID0+IDAwMDEsIEFEIDIwMTAgPT4gMjAxMClcbiAqICAgKiBgJ3l5J2A6IDIgZGlnaXQgcmVwcmVzZW50YXRpb24gb2YgeWVhciwgcGFkZGVkICgwMC05OSkuIChlLmcuIEFEIDIwMDEgPT4gMDEsIEFEIDIwMTAgPT4gMTApXG4gKiAgICogYCd5J2A6IDEgZGlnaXQgcmVwcmVzZW50YXRpb24gb2YgeWVhciwgZS5nLiAoQUQgMSA9PiAxLCBBRCAxOTkgPT4gMTk5KVxuICogICAqIGAnTU1NTSdgOiBNb250aCBpbiB5ZWFyIChKYW51YXJ5LURlY2VtYmVyKVxuICogICAqIGAnTU1NJ2A6IE1vbnRoIGluIHllYXIgKEphbi1EZWMpXG4gKiAgICogYCdNTSdgOiBNb250aCBpbiB5ZWFyLCBwYWRkZWQgKDAxLTEyKVxuICogICAqIGAnTSdgOiBNb250aCBpbiB5ZWFyICgxLTEyKVxuICogICAqIGAnZGQnYDogRGF5IGluIG1vbnRoLCBwYWRkZWQgKDAxLTMxKVxuICogICAqIGAnZCdgOiBEYXkgaW4gbW9udGggKDEtMzEpXG4gKiAgICogYCdFRUVFJ2A6IERheSBpbiBXZWVrLChTdW5kYXktU2F0dXJkYXkpXG4gKiAgICogYCdFRUUnYDogRGF5IGluIFdlZWssIChTdW4tU2F0KVxuICogICAqIGAnSEgnYDogSG91ciBpbiBkYXksIHBhZGRlZCAoMDAtMjMpXG4gKiAgICogYCdIJ2A6IEhvdXIgaW4gZGF5ICgwLTIzKVxuICogICAqIGAnaGgnYDogSG91ciBpbiBBTS9QTSwgcGFkZGVkICgwMS0xMilcbiAqICAgKiBgJ2gnYDogSG91ciBpbiBBTS9QTSwgKDEtMTIpXG4gKiAgICogYCdtbSdgOiBNaW51dGUgaW4gaG91ciwgcGFkZGVkICgwMC01OSlcbiAqICAgKiBgJ20nYDogTWludXRlIGluIGhvdXIgKDAtNTkpXG4gKiAgICogYCdzcydgOiBTZWNvbmQgaW4gbWludXRlLCBwYWRkZWQgKDAwLTU5KVxuICogICAqIGAncydgOiBTZWNvbmQgaW4gbWludXRlICgwLTU5KVxuICogICAqIGAnc3NzJ2A6IE1pbGxpc2Vjb25kIGluIHNlY29uZCwgcGFkZGVkICgwMDAtOTk5KVxuICogICAqIGAnYSdgOiBBTS9QTSBtYXJrZXJcbiAqICAgKiBgJ1onYDogNCBkaWdpdCAoK3NpZ24pIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB0aW1lem9uZSBvZmZzZXQgKC0xMjAwLSsxMjAwKVxuICogICAqIGAnd3cnYDogV2VlayBvZiB5ZWFyLCBwYWRkZWQgKDAwLTUzKS4gV2VlayAwMSBpcyB0aGUgd2VlayB3aXRoIHRoZSBmaXJzdCBUaHVyc2RheSBvZiB0aGUgeWVhclxuICogICAqIGAndydgOiBXZWVrIG9mIHllYXIgKDAtNTMpLiBXZWVrIDEgaXMgdGhlIHdlZWsgd2l0aCB0aGUgZmlyc3QgVGh1cnNkYXkgb2YgdGhlIHllYXJcbiAqICAgKiBgJ0cnYCwgYCdHRydgLCBgJ0dHRydgOiBUaGUgYWJicmV2aWF0ZWQgZm9ybSBvZiB0aGUgZXJhIHN0cmluZyAoZS5nLiAnQUQnKVxuICogICAqIGAnR0dHRydgOiBUaGUgbG9uZyBmb3JtIG9mIHRoZSBlcmEgc3RyaW5nIChlLmcuICdBbm5vIERvbWluaScpXG4gKlxuICogICBgZm9ybWF0YCBzdHJpbmcgY2FuIGFsc28gYmUgb25lIG9mIHRoZSBmb2xsb3dpbmcgcHJlZGVmaW5lZFxuICogICB7QGxpbmsgZ3VpZGUvaTE4biBsb2NhbGl6YWJsZSBmb3JtYXRzfTpcbiAqXG4gKiAgICogYCdtZWRpdW0nYDogZXF1aXZhbGVudCB0byBgJ01NTSBkLCB5IGg6bW06c3MgYSdgIGZvciBlbl9VUyBsb2NhbGVcbiAqICAgICAoZS5nLiBTZXAgMywgMjAxMCAxMjowNTowOCBQTSlcbiAqICAgKiBgJ3Nob3J0J2A6IGVxdWl2YWxlbnQgdG8gYCdNL2QveXkgaDptbSBhJ2AgZm9yIGVuX1VTICBsb2NhbGUgKGUuZy4gOS8zLzEwIDEyOjA1IFBNKVxuICogICAqIGAnZnVsbERhdGUnYDogZXF1aXZhbGVudCB0byBgJ0VFRUUsIE1NTU0gZCwgeSdgIGZvciBlbl9VUyAgbG9jYWxlXG4gKiAgICAgKGUuZy4gRnJpZGF5LCBTZXB0ZW1iZXIgMywgMjAxMClcbiAqICAgKiBgJ2xvbmdEYXRlJ2A6IGVxdWl2YWxlbnQgdG8gYCdNTU1NIGQsIHknYCBmb3IgZW5fVVMgIGxvY2FsZSAoZS5nLiBTZXB0ZW1iZXIgMywgMjAxMClcbiAqICAgKiBgJ21lZGl1bURhdGUnYDogZXF1aXZhbGVudCB0byBgJ01NTSBkLCB5J2AgZm9yIGVuX1VTICBsb2NhbGUgKGUuZy4gU2VwIDMsIDIwMTApXG4gKiAgICogYCdzaG9ydERhdGUnYDogZXF1aXZhbGVudCB0byBgJ00vZC95eSdgIGZvciBlbl9VUyBsb2NhbGUgKGUuZy4gOS8zLzEwKVxuICogICAqIGAnbWVkaXVtVGltZSdgOiBlcXVpdmFsZW50IHRvIGAnaDptbTpzcyBhJ2AgZm9yIGVuX1VTIGxvY2FsZSAoZS5nLiAxMjowNTowOCBQTSlcbiAqICAgKiBgJ3Nob3J0VGltZSdgOiBlcXVpdmFsZW50IHRvIGAnaDptbSBhJ2AgZm9yIGVuX1VTIGxvY2FsZSAoZS5nLiAxMjowNSBQTSlcbiAqXG4gKiAgIGBmb3JtYXRgIHN0cmluZyBjYW4gY29udGFpbiBsaXRlcmFsIHZhbHVlcy4gVGhlc2UgbmVlZCB0byBiZSBlc2NhcGVkIGJ5IHN1cnJvdW5kaW5nIHdpdGggc2luZ2xlIHF1b3RlcyAoZS5nLlxuICogICBgXCJoICdpbiB0aGUgbW9ybmluZydcImApLiBJbiBvcmRlciB0byBvdXRwdXQgYSBzaW5nbGUgcXVvdGUsIGVzY2FwZSBpdCAtIGkuZS4sIHR3byBzaW5nbGUgcXVvdGVzIGluIGEgc2VxdWVuY2VcbiAqICAgKGUuZy4gYFwiaCAnbycnY2xvY2snXCJgKS5cbiAqXG4gKiBAcGFyYW0geyhEYXRlfG51bWJlcnxzdHJpbmcpfSBkYXRlIERhdGUgdG8gZm9ybWF0IGVpdGhlciBhcyBEYXRlIG9iamVjdCwgbWlsbGlzZWNvbmRzIChzdHJpbmcgb3JcbiAqICAgIG51bWJlcikgb3IgdmFyaW91cyBJU08gODYwMSBkYXRldGltZSBzdHJpbmcgZm9ybWF0cyAoZS5nLiB5eXl5LU1NLWRkVEhIOm1tOnNzLnNzc1ogYW5kIGl0c1xuICogICAgc2hvcnRlciB2ZXJzaW9ucyBsaWtlIHl5eXktTU0tZGRUSEg6bW1aLCB5eXl5LU1NLWRkIG9yIHl5eXlNTWRkVEhIbW1zc1opLiBJZiBubyB0aW1lem9uZSBpc1xuICogICAgc3BlY2lmaWVkIGluIHRoZSBzdHJpbmcgaW5wdXQsIHRoZSB0aW1lIGlzIGNvbnNpZGVyZWQgdG8gYmUgaW4gdGhlIGxvY2FsIHRpbWV6b25lLlxuICogQHBhcmFtIHtzdHJpbmc9fSBmb3JtYXQgRm9ybWF0dGluZyBydWxlcyAoc2VlIERlc2NyaXB0aW9uKS4gSWYgbm90IHNwZWNpZmllZCxcbiAqICAgIGBtZWRpdW1EYXRlYCBpcyB1c2VkLlxuICogQHBhcmFtIHtzdHJpbmc9fSB0aW1lem9uZSBUaW1lem9uZSB0byBiZSB1c2VkIGZvciBmb3JtYXR0aW5nLiBJdCB1bmRlcnN0YW5kcyBVVEMvR01UIGFuZCB0aGVcbiAqICAgIGNvbnRpbmVudGFsIFVTIHRpbWUgem9uZSBhYmJyZXZpYXRpb25zLCBidXQgZm9yIGdlbmVyYWwgdXNlLCB1c2UgYSB0aW1lIHpvbmUgb2Zmc2V0LCBmb3JcbiAqICAgIGV4YW1wbGUsIGAnKzA0MzAnYCAoNCBob3VycywgMzAgbWludXRlcyBlYXN0IG9mIHRoZSBHcmVlbndpY2ggbWVyaWRpYW4pXG4gKiAgICBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgdGltZXpvbmUgb2YgdGhlIGJyb3dzZXIgd2lsbCBiZSB1c2VkLlxuICogQHJldHVybnMge3N0cmluZ30gRm9ybWF0dGVkIHN0cmluZyBvciB0aGUgaW5wdXQgaWYgaW5wdXQgaXMgbm90IHJlY29nbml6ZWQgYXMgZGF0ZS9taWxsaXMuXG4gKlxuICogQGV4YW1wbGVcbiAgIDxleGFtcGxlPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxzcGFuIG5nLW5vbi1iaW5kYWJsZT57ezEyODgzMjM2MjMwMDYgfCBkYXRlOidtZWRpdW0nfX08L3NwYW4+OlxuICAgICAgICAgICA8c3Bhbj57ezEyODgzMjM2MjMwMDYgfCBkYXRlOidtZWRpdW0nfX08L3NwYW4+PGJyPlxuICAgICAgIDxzcGFuIG5nLW5vbi1iaW5kYWJsZT57ezEyODgzMjM2MjMwMDYgfCBkYXRlOid5eXl5LU1NLWRkIEhIOm1tOnNzIFonfX08L3NwYW4+OlxuICAgICAgICAgIDxzcGFuPnt7MTI4ODMyMzYyMzAwNiB8IGRhdGU6J3l5eXktTU0tZGQgSEg6bW06c3MgWid9fTwvc3Bhbj48YnI+XG4gICAgICAgPHNwYW4gbmctbm9uLWJpbmRhYmxlPnt7MTI4ODMyMzYyMzAwNiB8IGRhdGU6J01NL2RkL3l5eXkgQCBoOm1tYSd9fTwvc3Bhbj46XG4gICAgICAgICAgPHNwYW4+e3snMTI4ODMyMzYyMzAwNicgfCBkYXRlOidNTS9kZC95eXl5IEAgaDptbWEnfX08L3NwYW4+PGJyPlxuICAgICAgIDxzcGFuIG5nLW5vbi1iaW5kYWJsZT57ezEyODgzMjM2MjMwMDYgfCBkYXRlOlwiTU0vZGQveXl5eSAnYXQnIGg6bW1hXCJ9fTwvc3Bhbj46XG4gICAgICAgICAgPHNwYW4+e3snMTI4ODMyMzYyMzAwNicgfCBkYXRlOlwiTU0vZGQveXl5eSAnYXQnIGg6bW1hXCJ9fTwvc3Bhbj48YnI+XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgIGl0KCdzaG91bGQgZm9ybWF0IGRhdGUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoXCIxMjg4MzIzNjIzMDA2IHwgZGF0ZTonbWVkaXVtJ1wiKSkuZ2V0VGV4dCgpKS5cbiAgICAgICAgICAgIHRvTWF0Y2goL09jdCAyXFxkLCAyMDEwIFxcZHsxLDJ9OlxcZHsyfTpcXGR7Mn0gKEFNfFBNKS8pO1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZyhcIjEyODgzMjM2MjMwMDYgfCBkYXRlOid5eXl5LU1NLWRkIEhIOm1tOnNzIFonXCIpKS5nZXRUZXh0KCkpLlxuICAgICAgICAgICAgdG9NYXRjaCgvMjAxMFxcLTEwXFwtMlxcZCBcXGR7Mn06XFxkezJ9OlxcZHsyfSAoXFwtfFxcKyk/XFxkezR9Lyk7XG4gICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKFwiJzEyODgzMjM2MjMwMDYnIHwgZGF0ZTonTU0vZGQveXl5eSBAIGg6bW1hJ1wiKSkuZ2V0VGV4dCgpKS5cbiAgICAgICAgICAgIHRvTWF0Y2goLzEwXFwvMlxcZFxcLzIwMTAgQCBcXGR7MSwyfTpcXGR7Mn0oQU18UE0pLyk7XG4gICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKFwiJzEyODgzMjM2MjMwMDYnIHwgZGF0ZTpcXFwiTU0vZGQveXl5eSAnYXQnIGg6bW1hXFxcIlwiKSkuZ2V0VGV4dCgpKS5cbiAgICAgICAgICAgIHRvTWF0Y2goLzEwXFwvMlxcZFxcLzIwMTAgYXQgXFxkezEsMn06XFxkezJ9KEFNfFBNKS8pO1xuICAgICAgIH0pO1xuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gKi9cbmRhdGVGaWx0ZXIuJGluamVjdCA9IFsnJGxvY2FsZSddO1xuZnVuY3Rpb24gZGF0ZUZpbHRlcigkbG9jYWxlKSB7XG5cblxuICB2YXIgUl9JU084NjAxX1NUUiA9IC9eKFxcZHs0fSktPyhcXGRcXGQpLT8oXFxkXFxkKSg/OlQoXFxkXFxkKSg/Ojo/KFxcZFxcZCkoPzo6PyhcXGRcXGQpKD86XFwuKFxcZCspKT8pPyk/KFp8KFsrLV0pKFxcZFxcZCk6PyhcXGRcXGQpKT8pPyQvO1xuICAgICAgICAgICAgICAgICAgICAgLy8gMSAgICAgICAgMiAgICAgICAzICAgICAgICAgNCAgICAgICAgICA1ICAgICAgICAgIDYgICAgICAgICAgNyAgICAgICAgICA4ICA5ICAgICAxMCAgICAgIDExXG4gIGZ1bmN0aW9uIGpzb25TdHJpbmdUb0RhdGUoc3RyaW5nKSB7XG4gICAgdmFyIG1hdGNoO1xuICAgIGlmIChtYXRjaCA9IHN0cmluZy5tYXRjaChSX0lTTzg2MDFfU1RSKSkge1xuICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgwKSxcbiAgICAgICAgICB0ekhvdXIgPSAwLFxuICAgICAgICAgIHR6TWluICA9IDAsXG4gICAgICAgICAgZGF0ZVNldHRlciA9IG1hdGNoWzhdID8gZGF0ZS5zZXRVVENGdWxsWWVhciA6IGRhdGUuc2V0RnVsbFllYXIsXG4gICAgICAgICAgdGltZVNldHRlciA9IG1hdGNoWzhdID8gZGF0ZS5zZXRVVENIb3VycyA6IGRhdGUuc2V0SG91cnM7XG5cbiAgICAgIGlmIChtYXRjaFs5XSkge1xuICAgICAgICB0ekhvdXIgPSB0b0ludChtYXRjaFs5XSArIG1hdGNoWzEwXSk7XG4gICAgICAgIHR6TWluID0gdG9JbnQobWF0Y2hbOV0gKyBtYXRjaFsxMV0pO1xuICAgICAgfVxuICAgICAgZGF0ZVNldHRlci5jYWxsKGRhdGUsIHRvSW50KG1hdGNoWzFdKSwgdG9JbnQobWF0Y2hbMl0pIC0gMSwgdG9JbnQobWF0Y2hbM10pKTtcbiAgICAgIHZhciBoID0gdG9JbnQobWF0Y2hbNF0gfHwgMCkgLSB0ekhvdXI7XG4gICAgICB2YXIgbSA9IHRvSW50KG1hdGNoWzVdIHx8IDApIC0gdHpNaW47XG4gICAgICB2YXIgcyA9IHRvSW50KG1hdGNoWzZdIHx8IDApO1xuICAgICAgdmFyIG1zID0gTWF0aC5yb3VuZChwYXJzZUZsb2F0KCcwLicgKyAobWF0Y2hbN10gfHwgMCkpICogMTAwMCk7XG4gICAgICB0aW1lU2V0dGVyLmNhbGwoZGF0ZSwgaCwgbSwgcywgbXMpO1xuICAgICAgcmV0dXJuIGRhdGU7XG4gICAgfVxuICAgIHJldHVybiBzdHJpbmc7XG4gIH1cblxuXG4gIHJldHVybiBmdW5jdGlvbihkYXRlLCBmb3JtYXQsIHRpbWV6b25lKSB7XG4gICAgdmFyIHRleHQgPSAnJyxcbiAgICAgICAgcGFydHMgPSBbXSxcbiAgICAgICAgZm4sIG1hdGNoO1xuXG4gICAgZm9ybWF0ID0gZm9ybWF0IHx8ICdtZWRpdW1EYXRlJztcbiAgICBmb3JtYXQgPSAkbG9jYWxlLkRBVEVUSU1FX0ZPUk1BVFNbZm9ybWF0XSB8fCBmb3JtYXQ7XG4gICAgaWYgKGlzU3RyaW5nKGRhdGUpKSB7XG4gICAgICBkYXRlID0gTlVNQkVSX1NUUklORy50ZXN0KGRhdGUpID8gdG9JbnQoZGF0ZSkgOiBqc29uU3RyaW5nVG9EYXRlKGRhdGUpO1xuICAgIH1cblxuICAgIGlmIChpc051bWJlcihkYXRlKSkge1xuICAgICAgZGF0ZSA9IG5ldyBEYXRlKGRhdGUpO1xuICAgIH1cblxuICAgIGlmICghaXNEYXRlKGRhdGUpIHx8ICFpc0Zpbml0ZShkYXRlLmdldFRpbWUoKSkpIHtcbiAgICAgIHJldHVybiBkYXRlO1xuICAgIH1cblxuICAgIHdoaWxlIChmb3JtYXQpIHtcbiAgICAgIG1hdGNoID0gREFURV9GT1JNQVRTX1NQTElULmV4ZWMoZm9ybWF0KTtcbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBwYXJ0cyA9IGNvbmNhdChwYXJ0cywgbWF0Y2gsIDEpO1xuICAgICAgICBmb3JtYXQgPSBwYXJ0cy5wb3AoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcnRzLnB1c2goZm9ybWF0KTtcbiAgICAgICAgZm9ybWF0ID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZGF0ZVRpbWV6b25lT2Zmc2V0ID0gZGF0ZS5nZXRUaW1lem9uZU9mZnNldCgpO1xuICAgIGlmICh0aW1lem9uZSkge1xuICAgICAgZGF0ZVRpbWV6b25lT2Zmc2V0ID0gdGltZXpvbmVUb09mZnNldCh0aW1lem9uZSwgZGF0ZVRpbWV6b25lT2Zmc2V0KTtcbiAgICAgIGRhdGUgPSBjb252ZXJ0VGltZXpvbmVUb0xvY2FsKGRhdGUsIHRpbWV6b25lLCB0cnVlKTtcbiAgICB9XG4gICAgZm9yRWFjaChwYXJ0cywgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIGZuID0gREFURV9GT1JNQVRTW3ZhbHVlXTtcbiAgICAgIHRleHQgKz0gZm4gPyBmbihkYXRlLCAkbG9jYWxlLkRBVEVUSU1FX0ZPUk1BVFMsIGRhdGVUaW1lem9uZU9mZnNldClcbiAgICAgICAgICAgICAgICAgOiB2YWx1ZSA9PT0gXCInJ1wiID8gXCInXCIgOiB2YWx1ZS5yZXBsYWNlKC8oXid8JyQpL2csICcnKS5yZXBsYWNlKC8nJy9nLCBcIidcIik7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGV4dDtcbiAgfTtcbn1cblxuXG4vKipcbiAqIEBuZ2RvYyBmaWx0ZXJcbiAqIEBuYW1lIGpzb25cbiAqIEBraW5kIGZ1bmN0aW9uXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiAgIEFsbG93cyB5b3UgdG8gY29udmVydCBhIEphdmFTY3JpcHQgb2JqZWN0IGludG8gSlNPTiBzdHJpbmcuXG4gKlxuICogICBUaGlzIGZpbHRlciBpcyBtb3N0bHkgdXNlZnVsIGZvciBkZWJ1Z2dpbmcuIFdoZW4gdXNpbmcgdGhlIGRvdWJsZSBjdXJseSB7e3ZhbHVlfX0gbm90YXRpb25cbiAqICAgdGhlIGJpbmRpbmcgaXMgYXV0b21hdGljYWxseSBjb252ZXJ0ZWQgdG8gSlNPTi5cbiAqXG4gKiBAcGFyYW0geyp9IG9iamVjdCBBbnkgSmF2YVNjcmlwdCBvYmplY3QgKGluY2x1ZGluZyBhcnJheXMgYW5kIHByaW1pdGl2ZSB0eXBlcykgdG8gZmlsdGVyLlxuICogQHBhcmFtIHtudW1iZXI9fSBzcGFjaW5nIFRoZSBudW1iZXIgb2Ygc3BhY2VzIHRvIHVzZSBwZXIgaW5kZW50YXRpb24sIGRlZmF1bHRzIHRvIDIuXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBKU09OIHN0cmluZy5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAgIDxleGFtcGxlPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxwcmUgaWQ9XCJkZWZhdWx0LXNwYWNpbmdcIj57eyB7J25hbWUnOid2YWx1ZSd9IHwganNvbiB9fTwvcHJlPlxuICAgICAgIDxwcmUgaWQ9XCJjdXN0b20tc3BhY2luZ1wiPnt7IHsnbmFtZSc6J3ZhbHVlJ30gfCBqc29uOjQgfX08L3ByZT5cbiAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgaXQoJ3Nob3VsZCBqc29uaWZ5IGZpbHRlcmVkIG9iamVjdHMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmlkKCdkZWZhdWx0LXNwYWNpbmcnKSkuZ2V0VGV4dCgpKS50b01hdGNoKC9cXHtcXG4gIFwibmFtZVwiOiA/XCJ2YWx1ZVwiXFxufS8pO1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2N1c3RvbS1zcGFjaW5nJykpLmdldFRleHQoKSkudG9NYXRjaCgvXFx7XFxuICAgIFwibmFtZVwiOiA/XCJ2YWx1ZVwiXFxufS8pO1xuICAgICAgIH0pO1xuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gKlxuICovXG5mdW5jdGlvbiBqc29uRmlsdGVyKCkge1xuICByZXR1cm4gZnVuY3Rpb24ob2JqZWN0LCBzcGFjaW5nKSB7XG4gICAgaWYgKGlzVW5kZWZpbmVkKHNwYWNpbmcpKSB7XG4gICAgICAgIHNwYWNpbmcgPSAyO1xuICAgIH1cbiAgICByZXR1cm4gdG9Kc29uKG9iamVjdCwgc3BhY2luZyk7XG4gIH07XG59XG5cblxuLyoqXG4gKiBAbmdkb2MgZmlsdGVyXG4gKiBAbmFtZSBsb3dlcmNhc2VcbiAqIEBraW5kIGZ1bmN0aW9uXG4gKiBAZGVzY3JpcHRpb25cbiAqIENvbnZlcnRzIHN0cmluZyB0byBsb3dlcmNhc2UuXG4gKiBAc2VlIGFuZ3VsYXIubG93ZXJjYXNlXG4gKi9cbnZhciBsb3dlcmNhc2VGaWx0ZXIgPSB2YWx1ZUZuKGxvd2VyY2FzZSk7XG5cblxuLyoqXG4gKiBAbmdkb2MgZmlsdGVyXG4gKiBAbmFtZSB1cHBlcmNhc2VcbiAqIEBraW5kIGZ1bmN0aW9uXG4gKiBAZGVzY3JpcHRpb25cbiAqIENvbnZlcnRzIHN0cmluZyB0byB1cHBlcmNhc2UuXG4gKiBAc2VlIGFuZ3VsYXIudXBwZXJjYXNlXG4gKi9cbnZhciB1cHBlcmNhc2VGaWx0ZXIgPSB2YWx1ZUZuKHVwcGVyY2FzZSk7XG5cbi8qKlxuICogQG5nZG9jIGZpbHRlclxuICogQG5hbWUgbGltaXRUb1xuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIENyZWF0ZXMgYSBuZXcgYXJyYXkgb3Igc3RyaW5nIGNvbnRhaW5pbmcgb25seSBhIHNwZWNpZmllZCBudW1iZXIgb2YgZWxlbWVudHMuIFRoZSBlbGVtZW50c1xuICogYXJlIHRha2VuIGZyb20gZWl0aGVyIHRoZSBiZWdpbm5pbmcgb3IgdGhlIGVuZCBvZiB0aGUgc291cmNlIGFycmF5LCBzdHJpbmcgb3IgbnVtYmVyLCBhcyBzcGVjaWZpZWQgYnlcbiAqIHRoZSB2YWx1ZSBhbmQgc2lnbiAocG9zaXRpdmUgb3IgbmVnYXRpdmUpIG9mIGBsaW1pdGAuIElmIGEgbnVtYmVyIGlzIHVzZWQgYXMgaW5wdXQsIGl0IGlzXG4gKiBjb252ZXJ0ZWQgdG8gYSBzdHJpbmcuXG4gKlxuICogQHBhcmFtIHtBcnJheXxzdHJpbmd8bnVtYmVyfSBpbnB1dCBTb3VyY2UgYXJyYXksIHN0cmluZyBvciBudW1iZXIgdG8gYmUgbGltaXRlZC5cbiAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gbGltaXQgVGhlIGxlbmd0aCBvZiB0aGUgcmV0dXJuZWQgYXJyYXkgb3Igc3RyaW5nLiBJZiB0aGUgYGxpbWl0YCBudW1iZXJcbiAqICAgICBpcyBwb3NpdGl2ZSwgYGxpbWl0YCBudW1iZXIgb2YgaXRlbXMgZnJvbSB0aGUgYmVnaW5uaW5nIG9mIHRoZSBzb3VyY2UgYXJyYXkvc3RyaW5nIGFyZSBjb3BpZWQuXG4gKiAgICAgSWYgdGhlIG51bWJlciBpcyBuZWdhdGl2ZSwgYGxpbWl0YCBudW1iZXIgIG9mIGl0ZW1zIGZyb20gdGhlIGVuZCBvZiB0aGUgc291cmNlIGFycmF5L3N0cmluZ1xuICogICAgIGFyZSBjb3BpZWQuIFRoZSBgbGltaXRgIHdpbGwgYmUgdHJpbW1lZCBpZiBpdCBleGNlZWRzIGBhcnJheS5sZW5ndGhgLiBJZiBgbGltaXRgIGlzIHVuZGVmaW5lZCxcbiAqICAgICB0aGUgaW5wdXQgd2lsbCBiZSByZXR1cm5lZCB1bmNoYW5nZWQuXG4gKiBAcGFyYW0geyhzdHJpbmd8bnVtYmVyKT19IGJlZ2luIEluZGV4IGF0IHdoaWNoIHRvIGJlZ2luIGxpbWl0YXRpb24uIEFzIGEgbmVnYXRpdmUgaW5kZXgsIGBiZWdpbmBcbiAqICAgICBpbmRpY2F0ZXMgYW4gb2Zmc2V0IGZyb20gdGhlIGVuZCBvZiBgaW5wdXRgLiBEZWZhdWx0cyB0byBgMGAuXG4gKiBAcmV0dXJucyB7QXJyYXl8c3RyaW5nfSBBIG5ldyBzdWItYXJyYXkgb3Igc3Vic3RyaW5nIG9mIGxlbmd0aCBgbGltaXRgIG9yIGxlc3MgaWYgaW5wdXQgYXJyYXlcbiAqICAgICBoYWQgbGVzcyB0aGFuIGBsaW1pdGAgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAgIDxleGFtcGxlIG1vZHVsZT1cImxpbWl0VG9FeGFtcGxlXCI+XG4gICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgPHNjcmlwdD5cbiAgICAgICAgIGFuZ3VsYXIubW9kdWxlKCdsaW1pdFRvRXhhbXBsZScsIFtdKVxuICAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICAgICRzY29wZS5udW1iZXJzID0gWzEsMiwzLDQsNSw2LDcsOCw5XTtcbiAgICAgICAgICAgICAkc2NvcGUubGV0dGVycyA9IFwiYWJjZGVmZ2hpXCI7XG4gICAgICAgICAgICAgJHNjb3BlLmxvbmdOdW1iZXIgPSAyMzQ1NDMyMzQyO1xuICAgICAgICAgICAgICRzY29wZS5udW1MaW1pdCA9IDM7XG4gICAgICAgICAgICAgJHNjb3BlLmxldHRlckxpbWl0ID0gMztcbiAgICAgICAgICAgICAkc2NvcGUubG9uZ051bWJlckxpbWl0ID0gMztcbiAgICAgICAgICAgfV0pO1xuICAgICAgIDwvc2NyaXB0PlxuICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICBMaW1pdCB7e251bWJlcnN9fSB0bzpcbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwibnVtYmVyXCIgc3RlcD1cIjFcIiBuZy1tb2RlbD1cIm51bUxpbWl0XCI+XG4gICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgPHA+T3V0cHV0IG51bWJlcnM6IHt7IG51bWJlcnMgfCBsaW1pdFRvOm51bUxpbWl0IH19PC9wPlxuICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgTGltaXQge3tsZXR0ZXJzfX0gdG86XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIHN0ZXA9XCIxXCIgbmctbW9kZWw9XCJsZXR0ZXJMaW1pdFwiPlxuICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgIDxwPk91dHB1dCBsZXR0ZXJzOiB7eyBsZXR0ZXJzIHwgbGltaXRUbzpsZXR0ZXJMaW1pdCB9fTwvcD5cbiAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgIExpbWl0IHt7bG9uZ051bWJlcn19IHRvOlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJudW1iZXJcIiBzdGVwPVwiMVwiIG5nLW1vZGVsPVwibG9uZ051bWJlckxpbWl0XCI+XG4gICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgPHA+T3V0cHV0IGxvbmcgbnVtYmVyOiB7eyBsb25nTnVtYmVyIHwgbGltaXRUbzpsb25nTnVtYmVyTGltaXQgfX08L3A+XG4gICAgICAgPC9kaXY+XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgIHZhciBudW1MaW1pdElucHV0ID0gZWxlbWVudChieS5tb2RlbCgnbnVtTGltaXQnKSk7XG4gICAgICAgdmFyIGxldHRlckxpbWl0SW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdsZXR0ZXJMaW1pdCcpKTtcbiAgICAgICB2YXIgbG9uZ051bWJlckxpbWl0SW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdsb25nTnVtYmVyTGltaXQnKSk7XG4gICAgICAgdmFyIGxpbWl0ZWROdW1iZXJzID0gZWxlbWVudChieS5iaW5kaW5nKCdudW1iZXJzIHwgbGltaXRUbzpudW1MaW1pdCcpKTtcbiAgICAgICB2YXIgbGltaXRlZExldHRlcnMgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2xldHRlcnMgfCBsaW1pdFRvOmxldHRlckxpbWl0JykpO1xuICAgICAgIHZhciBsaW1pdGVkTG9uZ051bWJlciA9IGVsZW1lbnQoYnkuYmluZGluZygnbG9uZ051bWJlciB8IGxpbWl0VG86bG9uZ051bWJlckxpbWl0JykpO1xuXG4gICAgICAgaXQoJ3Nob3VsZCBsaW1pdCB0aGUgbnVtYmVyIGFycmF5IHRvIGZpcnN0IHRocmVlIGl0ZW1zJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICBleHBlY3QobnVtTGltaXRJbnB1dC5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpLnRvQmUoJzMnKTtcbiAgICAgICAgIGV4cGVjdChsZXR0ZXJMaW1pdElucHV0LmdldEF0dHJpYnV0ZSgndmFsdWUnKSkudG9CZSgnMycpO1xuICAgICAgICAgZXhwZWN0KGxvbmdOdW1iZXJMaW1pdElucHV0LmdldEF0dHJpYnV0ZSgndmFsdWUnKSkudG9CZSgnMycpO1xuICAgICAgICAgZXhwZWN0KGxpbWl0ZWROdW1iZXJzLmdldFRleHQoKSkudG9FcXVhbCgnT3V0cHV0IG51bWJlcnM6IFsxLDIsM10nKTtcbiAgICAgICAgIGV4cGVjdChsaW1pdGVkTGV0dGVycy5nZXRUZXh0KCkpLnRvRXF1YWwoJ091dHB1dCBsZXR0ZXJzOiBhYmMnKTtcbiAgICAgICAgIGV4cGVjdChsaW1pdGVkTG9uZ051bWJlci5nZXRUZXh0KCkpLnRvRXF1YWwoJ091dHB1dCBsb25nIG51bWJlcjogMjM0Jyk7XG4gICAgICAgfSk7XG5cbiAgICAgICAvLyBUaGVyZSBpcyBhIGJ1ZyBpbiBzYWZhcmkgYW5kIHByb3RyYWN0b3IgdGhhdCBkb2Vzbid0IGxpa2UgdGhlIG1pbnVzIGtleVxuICAgICAgIC8vIGl0KCdzaG91bGQgdXBkYXRlIHRoZSBvdXRwdXQgd2hlbiAtMyBpcyBlbnRlcmVkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgLy8gICBudW1MaW1pdElucHV0LmNsZWFyKCk7XG4gICAgICAgLy8gICBudW1MaW1pdElucHV0LnNlbmRLZXlzKCctMycpO1xuICAgICAgIC8vICAgbGV0dGVyTGltaXRJbnB1dC5jbGVhcigpO1xuICAgICAgIC8vICAgbGV0dGVyTGltaXRJbnB1dC5zZW5kS2V5cygnLTMnKTtcbiAgICAgICAvLyAgIGxvbmdOdW1iZXJMaW1pdElucHV0LmNsZWFyKCk7XG4gICAgICAgLy8gICBsb25nTnVtYmVyTGltaXRJbnB1dC5zZW5kS2V5cygnLTMnKTtcbiAgICAgICAvLyAgIGV4cGVjdChsaW1pdGVkTnVtYmVycy5nZXRUZXh0KCkpLnRvRXF1YWwoJ091dHB1dCBudW1iZXJzOiBbNyw4LDldJyk7XG4gICAgICAgLy8gICBleHBlY3QobGltaXRlZExldHRlcnMuZ2V0VGV4dCgpKS50b0VxdWFsKCdPdXRwdXQgbGV0dGVyczogZ2hpJyk7XG4gICAgICAgLy8gICBleHBlY3QobGltaXRlZExvbmdOdW1iZXIuZ2V0VGV4dCgpKS50b0VxdWFsKCdPdXRwdXQgbG9uZyBudW1iZXI6IDM0MicpO1xuICAgICAgIC8vIH0pO1xuXG4gICAgICAgaXQoJ3Nob3VsZCBub3QgZXhjZWVkIHRoZSBtYXhpbXVtIHNpemUgb2YgaW5wdXQgYXJyYXknLCBmdW5jdGlvbigpIHtcbiAgICAgICAgIG51bUxpbWl0SW5wdXQuY2xlYXIoKTtcbiAgICAgICAgIG51bUxpbWl0SW5wdXQuc2VuZEtleXMoJzEwMCcpO1xuICAgICAgICAgbGV0dGVyTGltaXRJbnB1dC5jbGVhcigpO1xuICAgICAgICAgbGV0dGVyTGltaXRJbnB1dC5zZW5kS2V5cygnMTAwJyk7XG4gICAgICAgICBsb25nTnVtYmVyTGltaXRJbnB1dC5jbGVhcigpO1xuICAgICAgICAgbG9uZ051bWJlckxpbWl0SW5wdXQuc2VuZEtleXMoJzEwMCcpO1xuICAgICAgICAgZXhwZWN0KGxpbWl0ZWROdW1iZXJzLmdldFRleHQoKSkudG9FcXVhbCgnT3V0cHV0IG51bWJlcnM6IFsxLDIsMyw0LDUsNiw3LDgsOV0nKTtcbiAgICAgICAgIGV4cGVjdChsaW1pdGVkTGV0dGVycy5nZXRUZXh0KCkpLnRvRXF1YWwoJ091dHB1dCBsZXR0ZXJzOiBhYmNkZWZnaGknKTtcbiAgICAgICAgIGV4cGVjdChsaW1pdGVkTG9uZ051bWJlci5nZXRUZXh0KCkpLnRvRXF1YWwoJ091dHB1dCBsb25nIG51bWJlcjogMjM0NTQzMjM0MicpO1xuICAgICAgIH0pO1xuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4qL1xuZnVuY3Rpb24gbGltaXRUb0ZpbHRlcigpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0LCBsaW1pdCwgYmVnaW4pIHtcbiAgICBpZiAoTWF0aC5hYnMoTnVtYmVyKGxpbWl0KSkgPT09IEluZmluaXR5KSB7XG4gICAgICBsaW1pdCA9IE51bWJlcihsaW1pdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxpbWl0ID0gdG9JbnQobGltaXQpO1xuICAgIH1cbiAgICBpZiAoaXNOYU4obGltaXQpKSByZXR1cm4gaW5wdXQ7XG5cbiAgICBpZiAoaXNOdW1iZXIoaW5wdXQpKSBpbnB1dCA9IGlucHV0LnRvU3RyaW5nKCk7XG4gICAgaWYgKCFpc0FycmF5KGlucHV0KSAmJiAhaXNTdHJpbmcoaW5wdXQpKSByZXR1cm4gaW5wdXQ7XG5cbiAgICBiZWdpbiA9ICghYmVnaW4gfHwgaXNOYU4oYmVnaW4pKSA/IDAgOiB0b0ludChiZWdpbik7XG4gICAgYmVnaW4gPSAoYmVnaW4gPCAwKSA/IE1hdGgubWF4KDAsIGlucHV0Lmxlbmd0aCArIGJlZ2luKSA6IGJlZ2luO1xuXG4gICAgaWYgKGxpbWl0ID49IDApIHtcbiAgICAgIHJldHVybiBpbnB1dC5zbGljZShiZWdpbiwgYmVnaW4gKyBsaW1pdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChiZWdpbiA9PT0gMCkge1xuICAgICAgICByZXR1cm4gaW5wdXQuc2xpY2UobGltaXQsIGlucHV0Lmxlbmd0aCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gaW5wdXQuc2xpY2UoTWF0aC5tYXgoMCwgYmVnaW4gKyBsaW1pdCksIGJlZ2luKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICogQG5nZG9jIGZpbHRlclxuICogQG5hbWUgb3JkZXJCeVxuICogQGtpbmQgZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIE9yZGVycyBhIHNwZWNpZmllZCBgYXJyYXlgIGJ5IHRoZSBgZXhwcmVzc2lvbmAgcHJlZGljYXRlLiBJdCBpcyBvcmRlcmVkIGFscGhhYmV0aWNhbGx5XG4gKiBmb3Igc3RyaW5ncyBhbmQgbnVtZXJpY2FsbHkgZm9yIG51bWJlcnMuIE5vdGU6IGlmIHlvdSBub3RpY2UgbnVtYmVycyBhcmUgbm90IGJlaW5nIHNvcnRlZFxuICogYXMgZXhwZWN0ZWQsIG1ha2Ugc3VyZSB0aGV5IGFyZSBhY3R1YWxseSBiZWluZyBzYXZlZCBhcyBudW1iZXJzIGFuZCBub3Qgc3RyaW5ncy5cbiAqIEFycmF5LWxpa2UgdmFsdWVzIChlLmcuIE5vZGVMaXN0cywgalF1ZXJ5IG9iamVjdHMsIFR5cGVkQXJyYXlzLCBTdHJpbmdzLCBldGMpIGFyZSBhbHNvIHN1cHBvcnRlZC5cbiAqXG4gKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgKG9yIGFycmF5LWxpa2Ugb2JqZWN0KSB0byBzb3J0LlxuICogQHBhcmFtIHtmdW5jdGlvbigqKXxzdHJpbmd8QXJyYXkuPChmdW5jdGlvbigqKXxzdHJpbmcpPj19IGV4cHJlc3Npb24gQSBwcmVkaWNhdGUgdG8gYmVcbiAqICAgIHVzZWQgYnkgdGhlIGNvbXBhcmF0b3IgdG8gZGV0ZXJtaW5lIHRoZSBvcmRlciBvZiBlbGVtZW50cy5cbiAqXG4gKiAgICBDYW4gYmUgb25lIG9mOlxuICpcbiAqICAgIC0gYGZ1bmN0aW9uYDogR2V0dGVyIGZ1bmN0aW9uLiBUaGUgcmVzdWx0IG9mIHRoaXMgZnVuY3Rpb24gd2lsbCBiZSBzb3J0ZWQgdXNpbmcgdGhlXG4gKiAgICAgIGA8YCwgYD09PWAsIGA+YCBvcGVyYXRvci5cbiAqICAgIC0gYHN0cmluZ2A6IEFuIEFuZ3VsYXIgZXhwcmVzc2lvbi4gVGhlIHJlc3VsdCBvZiB0aGlzIGV4cHJlc3Npb24gaXMgdXNlZCB0byBjb21wYXJlIGVsZW1lbnRzXG4gKiAgICAgIChmb3IgZXhhbXBsZSBgbmFtZWAgdG8gc29ydCBieSBhIHByb3BlcnR5IGNhbGxlZCBgbmFtZWAgb3IgYG5hbWUuc3Vic3RyKDAsIDMpYCB0byBzb3J0IGJ5XG4gKiAgICAgIDMgZmlyc3QgY2hhcmFjdGVycyBvZiBhIHByb3BlcnR5IGNhbGxlZCBgbmFtZWApLiBUaGUgcmVzdWx0IG9mIGEgY29uc3RhbnQgZXhwcmVzc2lvblxuICogICAgICBpcyBpbnRlcnByZXRlZCBhcyBhIHByb3BlcnR5IG5hbWUgdG8gYmUgdXNlZCBpbiBjb21wYXJpc29ucyAoZm9yIGV4YW1wbGUgYFwic3BlY2lhbCBuYW1lXCJgXG4gKiAgICAgIHRvIHNvcnQgb2JqZWN0IGJ5IHRoZSB2YWx1ZSBvZiB0aGVpciBgc3BlY2lhbCBuYW1lYCBwcm9wZXJ0eSkuIEFuIGV4cHJlc3Npb24gY2FuIGJlXG4gKiAgICAgIG9wdGlvbmFsbHkgcHJlZml4ZWQgd2l0aCBgK2Agb3IgYC1gIHRvIGNvbnRyb2wgYXNjZW5kaW5nIG9yIGRlc2NlbmRpbmcgc29ydCBvcmRlclxuICogICAgICAoZm9yIGV4YW1wbGUsIGArbmFtZWAgb3IgYC1uYW1lYCkuIElmIG5vIHByb3BlcnR5IGlzIHByb3ZpZGVkLCAoZS5nLiBgJysnYCkgdGhlbiB0aGUgYXJyYXlcbiAqICAgICAgZWxlbWVudCBpdHNlbGYgaXMgdXNlZCB0byBjb21wYXJlIHdoZXJlIHNvcnRpbmcuXG4gKiAgICAtIGBBcnJheWA6IEFuIGFycmF5IG9mIGZ1bmN0aW9uIG9yIHN0cmluZyBwcmVkaWNhdGVzLiBUaGUgZmlyc3QgcHJlZGljYXRlIGluIHRoZSBhcnJheVxuICogICAgICBpcyB1c2VkIGZvciBzb3J0aW5nLCBidXQgd2hlbiB0d28gaXRlbXMgYXJlIGVxdWl2YWxlbnQsIHRoZSBuZXh0IHByZWRpY2F0ZSBpcyB1c2VkLlxuICpcbiAqICAgIElmIHRoZSBwcmVkaWNhdGUgaXMgbWlzc2luZyBvciBlbXB0eSB0aGVuIGl0IGRlZmF1bHRzIHRvIGAnKydgLlxuICpcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IHJldmVyc2UgUmV2ZXJzZSB0aGUgb3JkZXIgb2YgdGhlIGFycmF5LlxuICogQHJldHVybnMge0FycmF5fSBTb3J0ZWQgY29weSBvZiB0aGUgc291cmNlIGFycmF5LlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogVGhlIGV4YW1wbGUgYmVsb3cgZGVtb25zdHJhdGVzIGEgc2ltcGxlIG5nUmVwZWF0LCB3aGVyZSB0aGUgZGF0YSBpcyBzb3J0ZWRcbiAqIGJ5IGFnZSBpbiBkZXNjZW5kaW5nIG9yZGVyIChwcmVkaWNhdGUgaXMgc2V0IHRvIGAnLWFnZSdgKS5cbiAqIGByZXZlcnNlYCBpcyBub3Qgc2V0LCB3aGljaCBtZWFucyBpdCBkZWZhdWx0cyB0byBgZmFsc2VgLlxuICAgPGV4YW1wbGUgbW9kdWxlPVwib3JkZXJCeUV4YW1wbGVcIj5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICAgICAgPHRhYmxlIGNsYXNzPVwiZnJpZW5kXCI+XG4gICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICA8dGg+TmFtZTwvdGg+XG4gICAgICAgICAgICAgPHRoPlBob25lIE51bWJlcjwvdGg+XG4gICAgICAgICAgICAgPHRoPkFnZTwvdGg+XG4gICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgIDx0ciBuZy1yZXBlYXQ9XCJmcmllbmQgaW4gZnJpZW5kcyB8IG9yZGVyQnk6Jy1hZ2UnXCI+XG4gICAgICAgICAgICAgPHRkPnt7ZnJpZW5kLm5hbWV9fTwvdGQ+XG4gICAgICAgICAgICAgPHRkPnt7ZnJpZW5kLnBob25lfX08L3RkPlxuICAgICAgICAgICAgIDx0ZD57e2ZyaWVuZC5hZ2V9fTwvdGQ+XG4gICAgICAgICAgIDwvdHI+XG4gICAgICAgICA8L3RhYmxlPlxuICAgICAgIDwvZGl2PlxuICAgICA8L2ZpbGU+XG4gICAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cbiAgICAgICBhbmd1bGFyLm1vZHVsZSgnb3JkZXJCeUV4YW1wbGUnLCBbXSlcbiAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgICRzY29wZS5mcmllbmRzID1cbiAgICAgICAgICAgICAgIFt7bmFtZTonSm9obicsIHBob25lOic1NTUtMTIxMicsIGFnZToxMH0sXG4gICAgICAgICAgICAgICAge25hbWU6J01hcnknLCBwaG9uZTonNTU1LTk4NzYnLCBhZ2U6MTl9LFxuICAgICAgICAgICAgICAgIHtuYW1lOidNaWtlJywgcGhvbmU6JzU1NS00MzIxJywgYWdlOjIxfSxcbiAgICAgICAgICAgICAgICB7bmFtZTonQWRhbScsIHBob25lOic1NTUtNTY3OCcsIGFnZTozNX0sXG4gICAgICAgICAgICAgICAge25hbWU6J0p1bGllJywgcGhvbmU6JzU1NS04NzY1JywgYWdlOjI5fV07XG4gICAgICAgICB9XSk7XG4gICAgIDwvZmlsZT5cbiAgIDwvZXhhbXBsZT5cbiAqXG4gKiBUaGUgcHJlZGljYXRlIGFuZCByZXZlcnNlIHBhcmFtZXRlcnMgY2FuIGJlIGNvbnRyb2xsZWQgZHluYW1pY2FsbHkgdGhyb3VnaCBzY29wZSBwcm9wZXJ0aWVzLFxuICogYXMgc2hvd24gaW4gdGhlIG5leHQgZXhhbXBsZS5cbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZSBtb2R1bGU9XCJvcmRlckJ5RXhhbXBsZVwiPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gICAgICAgICA8cHJlPlNvcnRpbmcgcHJlZGljYXRlID0ge3twcmVkaWNhdGV9fTsgcmV2ZXJzZSA9IHt7cmV2ZXJzZX19PC9wcmU+XG4gICAgICAgICA8aHIvPlxuICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cInByZWRpY2F0ZT0nJ1wiPlNldCB0byB1bnNvcnRlZDwvYnV0dG9uPlxuICAgICAgICAgPHRhYmxlIGNsYXNzPVwiZnJpZW5kXCI+XG4gICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgIDx0aD5cbiAgICAgICAgICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwib3JkZXIoJ25hbWUnKVwiPk5hbWU8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInNvcnRvcmRlclwiIG5nLXNob3c9XCJwcmVkaWNhdGUgPT09ICduYW1lJ1wiIG5nLWNsYXNzPVwie3JldmVyc2U6cmV2ZXJzZX1cIj48L3NwYW4+XG4gICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgPHRoPlxuICAgICAgICAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJvcmRlcigncGhvbmUnKVwiPlBob25lIE51bWJlcjwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwic29ydG9yZGVyXCIgbmctc2hvdz1cInByZWRpY2F0ZSA9PT0gJ3Bob25lJ1wiIG5nLWNsYXNzPVwie3JldmVyc2U6cmV2ZXJzZX1cIj48L3NwYW4+XG4gICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgPHRoPlxuICAgICAgICAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJvcmRlcignYWdlJylcIj5BZ2U8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInNvcnRvcmRlclwiIG5nLXNob3c9XCJwcmVkaWNhdGUgPT09ICdhZ2UnXCIgbmctY2xhc3M9XCJ7cmV2ZXJzZTpyZXZlcnNlfVwiPjwvc3Bhbj5cbiAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgIDx0ciBuZy1yZXBlYXQ9XCJmcmllbmQgaW4gZnJpZW5kcyB8IG9yZGVyQnk6cHJlZGljYXRlOnJldmVyc2VcIj5cbiAgICAgICAgICAgICA8dGQ+e3tmcmllbmQubmFtZX19PC90ZD5cbiAgICAgICAgICAgICA8dGQ+e3tmcmllbmQucGhvbmV9fTwvdGQ+XG4gICAgICAgICAgICAgPHRkPnt7ZnJpZW5kLmFnZX19PC90ZD5cbiAgICAgICAgICAgPC90cj5cbiAgICAgICAgIDwvdGFibGU+XG4gICAgICAgPC9kaXY+XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuICAgICAgIGFuZ3VsYXIubW9kdWxlKCdvcmRlckJ5RXhhbXBsZScsIFtdKVxuICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAgJHNjb3BlLmZyaWVuZHMgPVxuICAgICAgICAgICAgICAgW3tuYW1lOidKb2huJywgcGhvbmU6JzU1NS0xMjEyJywgYWdlOjEwfSxcbiAgICAgICAgICAgICAgICB7bmFtZTonTWFyeScsIHBob25lOic1NTUtOTg3NicsIGFnZToxOX0sXG4gICAgICAgICAgICAgICAge25hbWU6J01pa2UnLCBwaG9uZTonNTU1LTQzMjEnLCBhZ2U6MjF9LFxuICAgICAgICAgICAgICAgIHtuYW1lOidBZGFtJywgcGhvbmU6JzU1NS01Njc4JywgYWdlOjM1fSxcbiAgICAgICAgICAgICAgICB7bmFtZTonSnVsaWUnLCBwaG9uZTonNTU1LTg3NjUnLCBhZ2U6Mjl9XTtcbiAgICAgICAgICAgJHNjb3BlLnByZWRpY2F0ZSA9ICdhZ2UnO1xuICAgICAgICAgICAkc2NvcGUucmV2ZXJzZSA9IHRydWU7XG4gICAgICAgICAgICRzY29wZS5vcmRlciA9IGZ1bmN0aW9uKHByZWRpY2F0ZSkge1xuICAgICAgICAgICAgICRzY29wZS5yZXZlcnNlID0gKCRzY29wZS5wcmVkaWNhdGUgPT09IHByZWRpY2F0ZSkgPyAhJHNjb3BlLnJldmVyc2UgOiBmYWxzZTtcbiAgICAgICAgICAgICAkc2NvcGUucHJlZGljYXRlID0gcHJlZGljYXRlO1xuICAgICAgICAgICB9O1xuICAgICAgICAgfV0pO1xuICAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwic3R5bGUuY3NzXCI+XG4gICAgICAgLnNvcnRvcmRlcjphZnRlciB7XG4gICAgICAgICBjb250ZW50OiAnXFwyNWIyJztcbiAgICAgICB9XG4gICAgICAgLnNvcnRvcmRlci5yZXZlcnNlOmFmdGVyIHtcbiAgICAgICAgIGNvbnRlbnQ6ICdcXDI1YmMnO1xuICAgICAgIH1cbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICpcbiAqIEl0J3MgYWxzbyBwb3NzaWJsZSB0byBjYWxsIHRoZSBvcmRlckJ5IGZpbHRlciBtYW51YWxseSwgYnkgaW5qZWN0aW5nIGAkZmlsdGVyYCwgcmV0cmlldmluZyB0aGVcbiAqIGZpbHRlciByb3V0aW5lIHdpdGggYCRmaWx0ZXIoJ29yZGVyQnknKWAsIGFuZCBjYWxsaW5nIHRoZSByZXR1cm5lZCBmaWx0ZXIgcm91dGluZSB3aXRoIHRoZVxuICogZGVzaXJlZCBwYXJhbWV0ZXJzLlxuICpcbiAqIEV4YW1wbGU6XG4gKlxuICogQGV4YW1wbGVcbiAgPGV4YW1wbGUgbW9kdWxlPVwib3JkZXJCeUV4YW1wbGVcIj5cbiAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gICAgICA8cHJlPlNvcnRpbmcgcHJlZGljYXRlID0ge3twcmVkaWNhdGV9fTsgcmV2ZXJzZSA9IHt7cmV2ZXJzZX19PC9wcmU+XG4gICAgICA8dGFibGUgY2xhc3M9XCJmcmllbmRcIj5cbiAgICAgICAgPHRyPlxuICAgICAgICAgIDx0aD5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cIm9yZGVyKCduYW1lJylcIj5OYW1lPC9idXR0b24+XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwic29ydG9yZGVyXCIgbmctc2hvdz1cInByZWRpY2F0ZSA9PT0gJ25hbWUnXCIgbmctY2xhc3M9XCJ7cmV2ZXJzZTpyZXZlcnNlfVwiPjwvc3Bhbj5cbiAgICAgICAgICA8L3RoPlxuICAgICAgICAgIDx0aD5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cIm9yZGVyKCdwaG9uZScpXCI+UGhvbmUgTnVtYmVyPC9idXR0b24+XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwic29ydG9yZGVyXCIgbmctc2hvdz1cInByZWRpY2F0ZSA9PT0gJ3Bob25lJ1wiIG5nLWNsYXNzPVwie3JldmVyc2U6cmV2ZXJzZX1cIj48L3NwYW4+XG4gICAgICAgICAgPC90aD5cbiAgICAgICAgICA8dGg+XG4gICAgICAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJvcmRlcignYWdlJylcIj5BZ2U8L2J1dHRvbj5cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJzb3J0b3JkZXJcIiBuZy1zaG93PVwicHJlZGljYXRlID09PSAnYWdlJ1wiIG5nLWNsYXNzPVwie3JldmVyc2U6cmV2ZXJzZX1cIj48L3NwYW4+XG4gICAgICAgICAgPC90aD5cbiAgICAgICAgPC90cj5cbiAgICAgICAgPHRyIG5nLXJlcGVhdD1cImZyaWVuZCBpbiBmcmllbmRzXCI+XG4gICAgICAgICAgPHRkPnt7ZnJpZW5kLm5hbWV9fTwvdGQ+XG4gICAgICAgICAgPHRkPnt7ZnJpZW5kLnBob25lfX08L3RkPlxuICAgICAgICAgIDx0ZD57e2ZyaWVuZC5hZ2V9fTwvdGQ+XG4gICAgICAgIDwvdHI+XG4gICAgICA8L3RhYmxlPlxuICAgIDwvZGl2PlxuICAgIDwvZmlsZT5cblxuICAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cbiAgICAgIGFuZ3VsYXIubW9kdWxlKCdvcmRlckJ5RXhhbXBsZScsIFtdKVxuICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsICckZmlsdGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkZmlsdGVyKSB7XG4gICAgICAgICAgdmFyIG9yZGVyQnkgPSAkZmlsdGVyKCdvcmRlckJ5Jyk7XG4gICAgICAgICAgJHNjb3BlLmZyaWVuZHMgPSBbXG4gICAgICAgICAgICB7IG5hbWU6ICdKb2huJywgICAgcGhvbmU6ICc1NTUtMTIxMicsICAgIGFnZTogMTAgfSxcbiAgICAgICAgICAgIHsgbmFtZTogJ01hcnknLCAgICBwaG9uZTogJzU1NS05ODc2JywgICAgYWdlOiAxOSB9LFxuICAgICAgICAgICAgeyBuYW1lOiAnTWlrZScsICAgIHBob25lOiAnNTU1LTQzMjEnLCAgICBhZ2U6IDIxIH0sXG4gICAgICAgICAgICB7IG5hbWU6ICdBZGFtJywgICAgcGhvbmU6ICc1NTUtNTY3OCcsICAgIGFnZTogMzUgfSxcbiAgICAgICAgICAgIHsgbmFtZTogJ0p1bGllJywgICBwaG9uZTogJzU1NS04NzY1JywgICAgYWdlOiAyOSB9XG4gICAgICAgICAgXTtcbiAgICAgICAgICAkc2NvcGUub3JkZXIgPSBmdW5jdGlvbihwcmVkaWNhdGUpIHtcbiAgICAgICAgICAgICRzY29wZS5wcmVkaWNhdGUgPSBwcmVkaWNhdGU7XG4gICAgICAgICAgICAkc2NvcGUucmV2ZXJzZSA9ICgkc2NvcGUucHJlZGljYXRlID09PSBwcmVkaWNhdGUpID8gISRzY29wZS5yZXZlcnNlIDogZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuZnJpZW5kcyA9IG9yZGVyQnkoJHNjb3BlLmZyaWVuZHMsIHByZWRpY2F0ZSwgJHNjb3BlLnJldmVyc2UpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgJHNjb3BlLm9yZGVyKCdhZ2UnLCB0cnVlKTtcbiAgICAgICAgfV0pO1xuICAgIDwvZmlsZT5cblxuICAgIDxmaWxlIG5hbWU9XCJzdHlsZS5jc3NcIj5cbiAgICAgICAuc29ydG9yZGVyOmFmdGVyIHtcbiAgICAgICAgIGNvbnRlbnQ6ICdcXDI1YjInO1xuICAgICAgIH1cbiAgICAgICAuc29ydG9yZGVyLnJldmVyc2U6YWZ0ZXIge1xuICAgICAgICAgY29udGVudDogJ1xcMjViYyc7XG4gICAgICAgfVxuICAgIDwvZmlsZT5cbjwvZXhhbXBsZT5cbiAqL1xub3JkZXJCeUZpbHRlci4kaW5qZWN0ID0gWyckcGFyc2UnXTtcbmZ1bmN0aW9uIG9yZGVyQnlGaWx0ZXIoJHBhcnNlKSB7XG4gIHJldHVybiBmdW5jdGlvbihhcnJheSwgc29ydFByZWRpY2F0ZSwgcmV2ZXJzZU9yZGVyKSB7XG5cbiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIGFycmF5O1xuICAgIGlmICghaXNBcnJheUxpa2UoYXJyYXkpKSB7XG4gICAgICB0aHJvdyBtaW5FcnIoJ29yZGVyQnknKSgnbm90YXJyYXknLCAnRXhwZWN0ZWQgYXJyYXkgYnV0IHJlY2VpdmVkOiB7MH0nLCBhcnJheSk7XG4gICAgfVxuXG4gICAgaWYgKCFpc0FycmF5KHNvcnRQcmVkaWNhdGUpKSB7IHNvcnRQcmVkaWNhdGUgPSBbc29ydFByZWRpY2F0ZV07IH1cbiAgICBpZiAoc29ydFByZWRpY2F0ZS5sZW5ndGggPT09IDApIHsgc29ydFByZWRpY2F0ZSA9IFsnKyddOyB9XG5cbiAgICB2YXIgcHJlZGljYXRlcyA9IHByb2Nlc3NQcmVkaWNhdGVzKHNvcnRQcmVkaWNhdGUsIHJldmVyc2VPcmRlcik7XG4gICAgLy8gQWRkIGEgcHJlZGljYXRlIGF0IHRoZSBlbmQgdGhhdCBldmFsdWF0ZXMgdG8gdGhlIGVsZW1lbnQgaW5kZXguIFRoaXMgbWFrZXMgdGhlXG4gICAgLy8gc29ydCBzdGFibGUgYXMgaXQgd29ya3MgYXMgYSB0aWUtYnJlYWtlciB3aGVuIGFsbCB0aGUgaW5wdXQgcHJlZGljYXRlcyBjYW5ub3RcbiAgICAvLyBkaXN0aW5ndWlzaCBiZXR3ZWVuIHR3byBlbGVtZW50cy5cbiAgICBwcmVkaWNhdGVzLnB1c2goeyBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4ge307IH0sIGRlc2NlbmRpbmc6IHJldmVyc2VPcmRlciA/IC0xIDogMX0pO1xuXG4gICAgLy8gVGhlIG5leHQgdGhyZWUgbGluZXMgYXJlIGEgdmVyc2lvbiBvZiBhIFN3YXJ0emlhbiBUcmFuc2Zvcm0gaWRpb20gZnJvbSBQZXJsXG4gICAgLy8gKHNvbWV0aW1lcyBjYWxsZWQgdGhlIERlY29yYXRlLVNvcnQtVW5kZWNvcmF0ZSBpZGlvbSlcbiAgICAvLyBTZWUgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU2Nod2FydHppYW5fdHJhbnNmb3JtXG4gICAgdmFyIGNvbXBhcmVWYWx1ZXMgPSBBcnJheS5wcm90b3R5cGUubWFwLmNhbGwoYXJyYXksIGdldENvbXBhcmlzb25PYmplY3QpO1xuICAgIGNvbXBhcmVWYWx1ZXMuc29ydChkb0NvbXBhcmlzb24pO1xuICAgIGFycmF5ID0gY29tcGFyZVZhbHVlcy5tYXAoZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRlbS52YWx1ZTsgfSk7XG5cbiAgICByZXR1cm4gYXJyYXk7XG5cbiAgICBmdW5jdGlvbiBnZXRDb21wYXJpc29uT2JqZWN0KHZhbHVlLCBpbmRleCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICBwcmVkaWNhdGVWYWx1ZXM6IHByZWRpY2F0ZXMubWFwKGZ1bmN0aW9uKHByZWRpY2F0ZSkge1xuICAgICAgICAgIHJldHVybiBnZXRQcmVkaWNhdGVWYWx1ZShwcmVkaWNhdGUuZ2V0KHZhbHVlKSwgaW5kZXgpO1xuICAgICAgICB9KVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkb0NvbXBhcmlzb24odjEsIHYyKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gMDtcbiAgICAgIGZvciAodmFyIGluZGV4PTAsIGxlbmd0aCA9IHByZWRpY2F0ZXMubGVuZ3RoOyBpbmRleCA8IGxlbmd0aDsgKytpbmRleCkge1xuICAgICAgICByZXN1bHQgPSBjb21wYXJlKHYxLnByZWRpY2F0ZVZhbHVlc1tpbmRleF0sIHYyLnByZWRpY2F0ZVZhbHVlc1tpbmRleF0pICogcHJlZGljYXRlc1tpbmRleF0uZGVzY2VuZGluZztcbiAgICAgICAgaWYgKHJlc3VsdCkgYnJlYWs7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiBwcm9jZXNzUHJlZGljYXRlcyhzb3J0UHJlZGljYXRlLCByZXZlcnNlT3JkZXIpIHtcbiAgICByZXZlcnNlT3JkZXIgPSByZXZlcnNlT3JkZXIgPyAtMSA6IDE7XG4gICAgcmV0dXJuIHNvcnRQcmVkaWNhdGUubWFwKGZ1bmN0aW9uKHByZWRpY2F0ZSkge1xuICAgICAgdmFyIGRlc2NlbmRpbmcgPSAxLCBnZXQgPSBpZGVudGl0eTtcblxuICAgICAgaWYgKGlzRnVuY3Rpb24ocHJlZGljYXRlKSkge1xuICAgICAgICBnZXQgPSBwcmVkaWNhdGU7XG4gICAgICB9IGVsc2UgaWYgKGlzU3RyaW5nKHByZWRpY2F0ZSkpIHtcbiAgICAgICAgaWYgKChwcmVkaWNhdGUuY2hhckF0KDApID09ICcrJyB8fCBwcmVkaWNhdGUuY2hhckF0KDApID09ICctJykpIHtcbiAgICAgICAgICBkZXNjZW5kaW5nID0gcHJlZGljYXRlLmNoYXJBdCgwKSA9PSAnLScgPyAtMSA6IDE7XG4gICAgICAgICAgcHJlZGljYXRlID0gcHJlZGljYXRlLnN1YnN0cmluZygxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJlZGljYXRlICE9PSAnJykge1xuICAgICAgICAgIGdldCA9ICRwYXJzZShwcmVkaWNhdGUpO1xuICAgICAgICAgIGlmIChnZXQuY29uc3RhbnQpIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBnZXQoKTtcbiAgICAgICAgICAgIGdldCA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZVtrZXldOyB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHsgZ2V0OiBnZXQsIGRlc2NlbmRpbmc6IGRlc2NlbmRpbmcgKiByZXZlcnNlT3JkZXIgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzUHJpbWl0aXZlKHZhbHVlKSB7XG4gICAgc3dpdGNoICh0eXBlb2YgdmFsdWUpIHtcbiAgICAgIGNhc2UgJ251bWJlcic6IC8qIGZhbGxzIHRocm91Z2ggKi9cbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOiAvKiBmYWxscyB0aHJvdWdoICovXG4gICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBvYmplY3RWYWx1ZSh2YWx1ZSwgaW5kZXgpIHtcbiAgICAvLyBJZiBgdmFsdWVPZmAgaXMgYSB2YWxpZCBmdW5jdGlvbiB1c2UgdGhhdFxuICAgIGlmICh0eXBlb2YgdmFsdWUudmFsdWVPZiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdmFsdWUgPSB2YWx1ZS52YWx1ZU9mKCk7XG4gICAgICBpZiAoaXNQcmltaXRpdmUodmFsdWUpKSByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIC8vIElmIGB0b1N0cmluZ2AgaXMgYSB2YWxpZCBmdW5jdGlvbiBhbmQgbm90IHRoZSBvbmUgZnJvbSBgT2JqZWN0LnByb3RvdHlwZWAgdXNlIHRoYXRcbiAgICBpZiAoaGFzQ3VzdG9tVG9TdHJpbmcodmFsdWUpKSB7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICBpZiAoaXNQcmltaXRpdmUodmFsdWUpKSByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIC8vIFdlIGhhdmUgYSBiYXNpYyBvYmplY3Qgc28gd2UgdXNlIHRoZSBwb3NpdGlvbiBvZiB0aGUgb2JqZWN0IGluIHRoZSBjb2xsZWN0aW9uXG4gICAgcmV0dXJuIGluZGV4O1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0UHJlZGljYXRlVmFsdWUodmFsdWUsIGluZGV4KSB7XG4gICAgdmFyIHR5cGUgPSB0eXBlb2YgdmFsdWU7XG4gICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICB0eXBlID0gJ3N0cmluZyc7XG4gICAgICB2YWx1ZSA9ICdudWxsJztcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdzdHJpbmcnKSB7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnb2JqZWN0Jykge1xuICAgICAgdmFsdWUgPSBvYmplY3RWYWx1ZSh2YWx1ZSwgaW5kZXgpO1xuICAgIH1cbiAgICByZXR1cm4geyB2YWx1ZTogdmFsdWUsIHR5cGU6IHR5cGUgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbXBhcmUodjEsIHYyKSB7XG4gICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgaWYgKHYxLnR5cGUgPT09IHYyLnR5cGUpIHtcbiAgICAgIGlmICh2MS52YWx1ZSAhPT0gdjIudmFsdWUpIHtcbiAgICAgICAgcmVzdWx0ID0gdjEudmFsdWUgPCB2Mi52YWx1ZSA/IC0xIDogMTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0ID0gdjEudHlwZSA8IHYyLnR5cGUgPyAtMSA6IDE7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbn1cblxuZnVuY3Rpb24gbmdEaXJlY3RpdmUoZGlyZWN0aXZlKSB7XG4gIGlmIChpc0Z1bmN0aW9uKGRpcmVjdGl2ZSkpIHtcbiAgICBkaXJlY3RpdmUgPSB7XG4gICAgICBsaW5rOiBkaXJlY3RpdmVcbiAgICB9O1xuICB9XG4gIGRpcmVjdGl2ZS5yZXN0cmljdCA9IGRpcmVjdGl2ZS5yZXN0cmljdCB8fCAnQUMnO1xuICByZXR1cm4gdmFsdWVGbihkaXJlY3RpdmUpO1xufVxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIGFcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBNb2RpZmllcyB0aGUgZGVmYXVsdCBiZWhhdmlvciBvZiB0aGUgaHRtbCBBIHRhZyBzbyB0aGF0IHRoZSBkZWZhdWx0IGFjdGlvbiBpcyBwcmV2ZW50ZWQgd2hlblxuICogdGhlIGhyZWYgYXR0cmlidXRlIGlzIGVtcHR5LlxuICpcbiAqIFRoaXMgY2hhbmdlIHBlcm1pdHMgdGhlIGVhc3kgY3JlYXRpb24gb2YgYWN0aW9uIGxpbmtzIHdpdGggdGhlIGBuZ0NsaWNrYCBkaXJlY3RpdmVcbiAqIHdpdGhvdXQgY2hhbmdpbmcgdGhlIGxvY2F0aW9uIG9yIGNhdXNpbmcgcGFnZSByZWxvYWRzLCBlLmcuOlxuICogYDxhIGhyZWY9XCJcIiBuZy1jbGljaz1cImxpc3QuYWRkSXRlbSgpXCI+QWRkIEl0ZW08L2E+YFxuICovXG52YXIgaHRtbEFuY2hvckRpcmVjdGl2ZSA9IHZhbHVlRm4oe1xuICByZXN0cmljdDogJ0UnLFxuICBjb21waWxlOiBmdW5jdGlvbihlbGVtZW50LCBhdHRyKSB7XG4gICAgaWYgKCFhdHRyLmhyZWYgJiYgIWF0dHIueGxpbmtIcmVmKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgICAgLy8gSWYgdGhlIGxpbmtlZCBlbGVtZW50IGlzIG5vdCBhbiBhbmNob3IgdGFnIGFueW1vcmUsIGRvIG5vdGhpbmdcbiAgICAgICAgaWYgKGVsZW1lbnRbMF0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gJ2EnKSByZXR1cm47XG5cbiAgICAgICAgLy8gU1ZHQUVsZW1lbnQgZG9lcyBub3QgdXNlIHRoZSBocmVmIGF0dHJpYnV0ZSwgYnV0IHJhdGhlciB0aGUgJ3hsaW5rSHJlZicgYXR0cmlidXRlLlxuICAgICAgICB2YXIgaHJlZiA9IHRvU3RyaW5nLmNhbGwoZWxlbWVudC5wcm9wKCdocmVmJykpID09PSAnW29iamVjdCBTVkdBbmltYXRlZFN0cmluZ10nID9cbiAgICAgICAgICAgICAgICAgICAneGxpbms6aHJlZicgOiAnaHJlZic7XG4gICAgICAgIGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAvLyBpZiB3ZSBoYXZlIG5vIGhyZWYgdXJsLCB0aGVuIGRvbid0IG5hdmlnYXRlIGFueXdoZXJlLlxuICAgICAgICAgIGlmICghZWxlbWVudC5hdHRyKGhyZWYpKSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH1cbiAgfVxufSk7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdIcmVmXG4gKiBAcmVzdHJpY3QgQVxuICogQHByaW9yaXR5IDk5XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBVc2luZyBBbmd1bGFyIG1hcmt1cCBsaWtlIGB7e2hhc2h9fWAgaW4gYW4gaHJlZiBhdHRyaWJ1dGUgd2lsbFxuICogbWFrZSB0aGUgbGluayBnbyB0byB0aGUgd3JvbmcgVVJMIGlmIHRoZSB1c2VyIGNsaWNrcyBpdCBiZWZvcmVcbiAqIEFuZ3VsYXIgaGFzIGEgY2hhbmNlIHRvIHJlcGxhY2UgdGhlIGB7e2hhc2h9fWAgbWFya3VwIHdpdGggaXRzXG4gKiB2YWx1ZS4gVW50aWwgQW5ndWxhciByZXBsYWNlcyB0aGUgbWFya3VwIHRoZSBsaW5rIHdpbGwgYmUgYnJva2VuXG4gKiBhbmQgd2lsbCBtb3N0IGxpa2VseSByZXR1cm4gYSA0MDQgZXJyb3IuIFRoZSBgbmdIcmVmYCBkaXJlY3RpdmVcbiAqIHNvbHZlcyB0aGlzIHByb2JsZW0uXG4gKlxuICogVGhlIHdyb25nIHdheSB0byB3cml0ZSBpdDpcbiAqIGBgYGh0bWxcbiAqIDxhIGhyZWY9XCJodHRwOi8vd3d3LmdyYXZhdGFyLmNvbS9hdmF0YXIve3toYXNofX1cIj5saW5rMTwvYT5cbiAqIGBgYFxuICpcbiAqIFRoZSBjb3JyZWN0IHdheSB0byB3cml0ZSBpdDpcbiAqIGBgYGh0bWxcbiAqIDxhIG5nLWhyZWY9XCJodHRwOi8vd3d3LmdyYXZhdGFyLmNvbS9hdmF0YXIve3toYXNofX1cIj5saW5rMTwvYT5cbiAqIGBgYFxuICpcbiAqIEBlbGVtZW50IEFcbiAqIEBwYXJhbSB7dGVtcGxhdGV9IG5nSHJlZiBhbnkgc3RyaW5nIHdoaWNoIGNhbiBjb250YWluIGB7e319YCBtYXJrdXAuXG4gKlxuICogQGV4YW1wbGVcbiAqIFRoaXMgZXhhbXBsZSBzaG93cyB2YXJpb3VzIGNvbWJpbmF0aW9ucyBvZiBgaHJlZmAsIGBuZy1ocmVmYCBhbmQgYG5nLWNsaWNrYCBhdHRyaWJ1dGVzXG4gKiBpbiBsaW5rcyBhbmQgdGhlaXIgZGlmZmVyZW50IGJlaGF2aW9yczpcbiAgICA8ZXhhbXBsZT5cbiAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgIDxpbnB1dCBuZy1tb2RlbD1cInZhbHVlXCIgLz48YnIgLz5cbiAgICAgICAgPGEgaWQ9XCJsaW5rLTFcIiBocmVmIG5nLWNsaWNrPVwidmFsdWUgPSAxXCI+bGluayAxPC9hPiAobGluaywgZG9uJ3QgcmVsb2FkKTxiciAvPlxuICAgICAgICA8YSBpZD1cImxpbmstMlwiIGhyZWY9XCJcIiBuZy1jbGljaz1cInZhbHVlID0gMlwiPmxpbmsgMjwvYT4gKGxpbmssIGRvbid0IHJlbG9hZCk8YnIgLz5cbiAgICAgICAgPGEgaWQ9XCJsaW5rLTNcIiBuZy1ocmVmPVwiL3t7JzEyMyd9fVwiPmxpbmsgMzwvYT4gKGxpbmssIHJlbG9hZCEpPGJyIC8+XG4gICAgICAgIDxhIGlkPVwibGluay00XCIgaHJlZj1cIlwiIG5hbWU9XCJ4eFwiIG5nLWNsaWNrPVwidmFsdWUgPSA0XCI+YW5jaG9yPC9hPiAobGluaywgZG9uJ3QgcmVsb2FkKTxiciAvPlxuICAgICAgICA8YSBpZD1cImxpbmstNVwiIG5hbWU9XCJ4eHhcIiBuZy1jbGljaz1cInZhbHVlID0gNVwiPmFuY2hvcjwvYT4gKG5vIGxpbmspPGJyIC8+XG4gICAgICAgIDxhIGlkPVwibGluay02XCIgbmctaHJlZj1cInt7dmFsdWV9fVwiPmxpbms8L2E+IChsaW5rLCBjaGFuZ2UgbG9jYXRpb24pXG4gICAgICA8L2ZpbGU+XG4gICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBuZy1jbGljayBidXQgbm90IHJlbG9hZCB3aGVuIGhyZWYgd2l0aG91dCB2YWx1ZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGVsZW1lbnQoYnkuaWQoJ2xpbmstMScpKS5jbGljaygpO1xuICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5Lm1vZGVsKCd2YWx1ZScpKS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpLnRvRXF1YWwoJzEnKTtcbiAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnbGluay0xJykpLmdldEF0dHJpYnV0ZSgnaHJlZicpKS50b0JlKCcnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBleGVjdXRlIG5nLWNsaWNrIGJ1dCBub3QgcmVsb2FkIHdoZW4gaHJlZiBlbXB0eSBzdHJpbmcnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBlbGVtZW50KGJ5LmlkKCdsaW5rLTInKSkuY2xpY2soKTtcbiAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5tb2RlbCgndmFsdWUnKSkuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKS50b0VxdWFsKCcyJyk7XG4gICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2xpbmstMicpKS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSkudG9CZSgnJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBuZy1jbGljayBhbmQgY2hhbmdlIHVybCB3aGVuIG5nLWhyZWYgc3BlY2lmaWVkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2xpbmstMycpKS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSkudG9NYXRjaCgvXFwvMTIzJC8pO1xuXG4gICAgICAgICAgZWxlbWVudChieS5pZCgnbGluay0zJykpLmNsaWNrKCk7XG5cbiAgICAgICAgICAvLyBBdCB0aGlzIHBvaW50LCB3ZSBuYXZpZ2F0ZSBhd2F5IGZyb20gYW4gQW5ndWxhciBwYWdlLCBzbyB3ZSBuZWVkXG4gICAgICAgICAgLy8gdG8gdXNlIGJyb3dzZXIuZHJpdmVyIHRvIGdldCB0aGUgYmFzZSB3ZWJkcml2ZXIuXG5cbiAgICAgICAgICBicm93c2VyLndhaXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gYnJvd3Nlci5kcml2ZXIuZ2V0Q3VycmVudFVybCgpLnRoZW4oZnVuY3Rpb24odXJsKSB7XG4gICAgICAgICAgICAgIHJldHVybiB1cmwubWF0Y2goL1xcLzEyMyQvKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sIDUwMDAsICdwYWdlIHNob3VsZCBuYXZpZ2F0ZSB0byAvMTIzJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBuZy1jbGljayBidXQgbm90IHJlbG9hZCB3aGVuIGhyZWYgZW1wdHkgc3RyaW5nIGFuZCBuYW1lIHNwZWNpZmllZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGVsZW1lbnQoYnkuaWQoJ2xpbmstNCcpKS5jbGljaygpO1xuICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5Lm1vZGVsKCd2YWx1ZScpKS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpLnRvRXF1YWwoJzQnKTtcbiAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnbGluay00JykpLmdldEF0dHJpYnV0ZSgnaHJlZicpKS50b0JlKCcnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBleGVjdXRlIG5nLWNsaWNrIGJ1dCBub3QgcmVsb2FkIHdoZW4gbm8gaHJlZiBidXQgbmFtZSBzcGVjaWZpZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBlbGVtZW50KGJ5LmlkKCdsaW5rLTUnKSkuY2xpY2soKTtcbiAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5tb2RlbCgndmFsdWUnKSkuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKS50b0VxdWFsKCc1Jyk7XG4gICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2xpbmstNScpKS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSkudG9CZShudWxsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBvbmx5IGNoYW5nZSB1cmwgd2hlbiBvbmx5IG5nLWhyZWYnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCd2YWx1ZScpKS5jbGVhcigpO1xuICAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ3ZhbHVlJykpLnNlbmRLZXlzKCc2Jyk7XG4gICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2xpbmstNicpKS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSkudG9NYXRjaCgvXFwvNiQvKTtcblxuICAgICAgICAgIGVsZW1lbnQoYnkuaWQoJ2xpbmstNicpKS5jbGljaygpO1xuXG4gICAgICAgICAgLy8gQXQgdGhpcyBwb2ludCwgd2UgbmF2aWdhdGUgYXdheSBmcm9tIGFuIEFuZ3VsYXIgcGFnZSwgc28gd2UgbmVlZFxuICAgICAgICAgIC8vIHRvIHVzZSBicm93c2VyLmRyaXZlciB0byBnZXQgdGhlIGJhc2Ugd2ViZHJpdmVyLlxuICAgICAgICAgIGJyb3dzZXIud2FpdChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBicm93c2VyLmRyaXZlci5nZXRDdXJyZW50VXJsKCkudGhlbihmdW5jdGlvbih1cmwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHVybC5tYXRjaCgvXFwvNiQvKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sIDUwMDAsICdwYWdlIHNob3VsZCBuYXZpZ2F0ZSB0byAvNicpO1xuICAgICAgICB9KTtcbiAgICAgIDwvZmlsZT5cbiAgICA8L2V4YW1wbGU+XG4gKi9cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ1NyY1xuICogQHJlc3RyaWN0IEFcbiAqIEBwcmlvcml0eSA5OVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVXNpbmcgQW5ndWxhciBtYXJrdXAgbGlrZSBge3toYXNofX1gIGluIGEgYHNyY2AgYXR0cmlidXRlIGRvZXNuJ3RcbiAqIHdvcmsgcmlnaHQ6IFRoZSBicm93c2VyIHdpbGwgZmV0Y2ggZnJvbSB0aGUgVVJMIHdpdGggdGhlIGxpdGVyYWxcbiAqIHRleHQgYHt7aGFzaH19YCB1bnRpbCBBbmd1bGFyIHJlcGxhY2VzIHRoZSBleHByZXNzaW9uIGluc2lkZVxuICogYHt7aGFzaH19YC4gVGhlIGBuZ1NyY2AgZGlyZWN0aXZlIHNvbHZlcyB0aGlzIHByb2JsZW0uXG4gKlxuICogVGhlIGJ1Z2d5IHdheSB0byB3cml0ZSBpdDpcbiAqIGBgYGh0bWxcbiAqIDxpbWcgc3JjPVwiaHR0cDovL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyL3t7aGFzaH19XCIgYWx0PVwiRGVzY3JpcHRpb25cIi8+XG4gKiBgYGBcbiAqXG4gKiBUaGUgY29ycmVjdCB3YXkgdG8gd3JpdGUgaXQ6XG4gKiBgYGBodG1sXG4gKiA8aW1nIG5nLXNyYz1cImh0dHA6Ly93d3cuZ3JhdmF0YXIuY29tL2F2YXRhci97e2hhc2h9fVwiIGFsdD1cIkRlc2NyaXB0aW9uXCIgLz5cbiAqIGBgYFxuICpcbiAqIEBlbGVtZW50IElNR1xuICogQHBhcmFtIHt0ZW1wbGF0ZX0gbmdTcmMgYW55IHN0cmluZyB3aGljaCBjYW4gY29udGFpbiBge3t9fWAgbWFya3VwLlxuICovXG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdTcmNzZXRcbiAqIEByZXN0cmljdCBBXG4gKiBAcHJpb3JpdHkgOTlcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFVzaW5nIEFuZ3VsYXIgbWFya3VwIGxpa2UgYHt7aGFzaH19YCBpbiBhIGBzcmNzZXRgIGF0dHJpYnV0ZSBkb2Vzbid0XG4gKiB3b3JrIHJpZ2h0OiBUaGUgYnJvd3NlciB3aWxsIGZldGNoIGZyb20gdGhlIFVSTCB3aXRoIHRoZSBsaXRlcmFsXG4gKiB0ZXh0IGB7e2hhc2h9fWAgdW50aWwgQW5ndWxhciByZXBsYWNlcyB0aGUgZXhwcmVzc2lvbiBpbnNpZGVcbiAqIGB7e2hhc2h9fWAuIFRoZSBgbmdTcmNzZXRgIGRpcmVjdGl2ZSBzb2x2ZXMgdGhpcyBwcm9ibGVtLlxuICpcbiAqIFRoZSBidWdneSB3YXkgdG8gd3JpdGUgaXQ6XG4gKiBgYGBodG1sXG4gKiA8aW1nIHNyY3NldD1cImh0dHA6Ly93d3cuZ3JhdmF0YXIuY29tL2F2YXRhci97e2hhc2h9fSAyeFwiIGFsdD1cIkRlc2NyaXB0aW9uXCIvPlxuICogYGBgXG4gKlxuICogVGhlIGNvcnJlY3Qgd2F5IHRvIHdyaXRlIGl0OlxuICogYGBgaHRtbFxuICogPGltZyBuZy1zcmNzZXQ9XCJodHRwOi8vd3d3LmdyYXZhdGFyLmNvbS9hdmF0YXIve3toYXNofX0gMnhcIiBhbHQ9XCJEZXNjcmlwdGlvblwiIC8+XG4gKiBgYGBcbiAqXG4gKiBAZWxlbWVudCBJTUdcbiAqIEBwYXJhbSB7dGVtcGxhdGV9IG5nU3Jjc2V0IGFueSBzdHJpbmcgd2hpY2ggY2FuIGNvbnRhaW4gYHt7fX1gIG1hcmt1cC5cbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nRGlzYWJsZWRcbiAqIEByZXN0cmljdCBBXG4gKiBAcHJpb3JpdHkgMTAwXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogVGhpcyBkaXJlY3RpdmUgc2V0cyB0aGUgYGRpc2FibGVkYCBhdHRyaWJ1dGUgb24gdGhlIGVsZW1lbnQgaWYgdGhlXG4gKiB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufSBpbnNpZGUgYG5nRGlzYWJsZWRgIGV2YWx1YXRlcyB0byB0cnV0aHkuXG4gKlxuICogQSBzcGVjaWFsIGRpcmVjdGl2ZSBpcyBuZWNlc3NhcnkgYmVjYXVzZSB3ZSBjYW5ub3QgdXNlIGludGVycG9sYXRpb24gaW5zaWRlIHRoZSBgZGlzYWJsZWRgXG4gKiBhdHRyaWJ1dGUuIFNlZSB0aGUge0BsaW5rIGd1aWRlL2ludGVycG9sYXRpb24gaW50ZXJwb2xhdGlvbiBndWlkZX0gZm9yIG1vcmUgaW5mby5cbiAqXG4gKiBAZXhhbXBsZVxuICAgIDxleGFtcGxlPlxuICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICAgPGxhYmVsPkNsaWNrIG1lIHRvIHRvZ2dsZTogPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiY2hlY2tlZFwiPjwvbGFiZWw+PGJyLz5cbiAgICAgICAgPGJ1dHRvbiBuZy1tb2RlbD1cImJ1dHRvblwiIG5nLWRpc2FibGVkPVwiY2hlY2tlZFwiPkJ1dHRvbjwvYnV0dG9uPlxuICAgICAgPC9maWxlPlxuICAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgICBpdCgnc2hvdWxkIHRvZ2dsZSBidXR0b24nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5jc3MoJ2J1dHRvbicpKS5nZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpLnRvQmVGYWxzeSgpO1xuICAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ2NoZWNrZWQnKSkuY2xpY2soKTtcbiAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5jc3MoJ2J1dHRvbicpKS5nZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpLnRvQmVUcnV0aHkoKTtcbiAgICAgICAgfSk7XG4gICAgICA8L2ZpbGU+XG4gICAgPC9leGFtcGxlPlxuICpcbiAqIEBlbGVtZW50IElOUFVUXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nRGlzYWJsZWQgSWYgdGhlIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259IGlzIHRydXRoeSxcbiAqICAgICB0aGVuIHRoZSBgZGlzYWJsZWRgIGF0dHJpYnV0ZSB3aWxsIGJlIHNldCBvbiB0aGUgZWxlbWVudFxuICovXG5cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ0NoZWNrZWRcbiAqIEByZXN0cmljdCBBXG4gKiBAcHJpb3JpdHkgMTAwXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBTZXRzIHRoZSBgY2hlY2tlZGAgYXR0cmlidXRlIG9uIHRoZSBlbGVtZW50LCBpZiB0aGUgZXhwcmVzc2lvbiBpbnNpZGUgYG5nQ2hlY2tlZGAgaXMgdHJ1dGh5LlxuICpcbiAqIE5vdGUgdGhhdCB0aGlzIGRpcmVjdGl2ZSBzaG91bGQgbm90IGJlIHVzZWQgdG9nZXRoZXIgd2l0aCB7QGxpbmsgbmdNb2RlbCBgbmdNb2RlbGB9LFxuICogYXMgdGhpcyBjYW4gbGVhZCB0byB1bmV4cGVjdGVkIGJlaGF2aW9yLlxuICpcbiAqIEEgc3BlY2lhbCBkaXJlY3RpdmUgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugd2UgY2Fubm90IHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSB0aGUgYGNoZWNrZWRgXG4gKiBhdHRyaWJ1dGUuIFNlZSB0aGUge0BsaW5rIGd1aWRlL2ludGVycG9sYXRpb24gaW50ZXJwb2xhdGlvbiBndWlkZX0gZm9yIG1vcmUgaW5mby5cbiAqXG4gKiBAZXhhbXBsZVxuICAgIDxleGFtcGxlPlxuICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICAgPGxhYmVsPkNoZWNrIG1lIHRvIGNoZWNrIGJvdGg6IDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cIm1hc3RlclwiPjwvbGFiZWw+PGJyLz5cbiAgICAgICAgPGlucHV0IGlkPVwiY2hlY2tTbGF2ZVwiIHR5cGU9XCJjaGVja2JveFwiIG5nLWNoZWNrZWQ9XCJtYXN0ZXJcIiBhcmlhLWxhYmVsPVwiU2xhdmUgaW5wdXRcIj5cbiAgICAgIDwvZmlsZT5cbiAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgICAgaXQoJ3Nob3VsZCBjaGVjayBib3RoIGNoZWNrQm94ZXMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnY2hlY2tTbGF2ZScpKS5nZXRBdHRyaWJ1dGUoJ2NoZWNrZWQnKSkudG9CZUZhbHN5KCk7XG4gICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnbWFzdGVyJykpLmNsaWNrKCk7XG4gICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2NoZWNrU2xhdmUnKSkuZ2V0QXR0cmlidXRlKCdjaGVja2VkJykpLnRvQmVUcnV0aHkoKTtcbiAgICAgICAgfSk7XG4gICAgICA8L2ZpbGU+XG4gICAgPC9leGFtcGxlPlxuICpcbiAqIEBlbGVtZW50IElOUFVUXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nQ2hlY2tlZCBJZiB0aGUge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gZXhwcmVzc2lvbn0gaXMgdHJ1dGh5LFxuICogICAgIHRoZW4gdGhlIGBjaGVja2VkYCBhdHRyaWJ1dGUgd2lsbCBiZSBzZXQgb24gdGhlIGVsZW1lbnRcbiAqL1xuXG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdSZWFkb25seVxuICogQHJlc3RyaWN0IEFcbiAqIEBwcmlvcml0eSAxMDBcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBTZXRzIHRoZSBgcmVhZE9ubHlgIGF0dHJpYnV0ZSBvbiB0aGUgZWxlbWVudCwgaWYgdGhlIGV4cHJlc3Npb24gaW5zaWRlIGBuZ1JlYWRvbmx5YCBpcyB0cnV0aHkuXG4gKlxuICogQSBzcGVjaWFsIGRpcmVjdGl2ZSBpcyBuZWNlc3NhcnkgYmVjYXVzZSB3ZSBjYW5ub3QgdXNlIGludGVycG9sYXRpb24gaW5zaWRlIHRoZSBgcmVhZE9ubHlgXG4gKiBhdHRyaWJ1dGUuIFNlZSB0aGUge0BsaW5rIGd1aWRlL2ludGVycG9sYXRpb24gaW50ZXJwb2xhdGlvbiBndWlkZX0gZm9yIG1vcmUgaW5mby5cbiAqXG4gKiBAZXhhbXBsZVxuICAgIDxleGFtcGxlPlxuICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICAgPGxhYmVsPkNoZWNrIG1lIHRvIG1ha2UgdGV4dCByZWFkb25seTogPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiY2hlY2tlZFwiPjwvbGFiZWw+PGJyLz5cbiAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctcmVhZG9ubHk9XCJjaGVja2VkXCIgdmFsdWU9XCJJJ20gQW5ndWxhclwiIGFyaWEtbGFiZWw9XCJSZWFkb25seSBmaWVsZFwiIC8+XG4gICAgICA8L2ZpbGU+XG4gICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgIGl0KCdzaG91bGQgdG9nZ2xlIHJlYWRvbmx5IGF0dHInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5jc3MoJ1t0eXBlPVwidGV4dFwiXScpKS5nZXRBdHRyaWJ1dGUoJ3JlYWRvbmx5JykpLnRvQmVGYWxzeSgpO1xuICAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ2NoZWNrZWQnKSkuY2xpY2soKTtcbiAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5jc3MoJ1t0eXBlPVwidGV4dFwiXScpKS5nZXRBdHRyaWJ1dGUoJ3JlYWRvbmx5JykpLnRvQmVUcnV0aHkoKTtcbiAgICAgICAgfSk7XG4gICAgICA8L2ZpbGU+XG4gICAgPC9leGFtcGxlPlxuICpcbiAqIEBlbGVtZW50IElOUFVUXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nUmVhZG9ubHkgSWYgdGhlIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259IGlzIHRydXRoeSxcbiAqICAgICB0aGVuIHNwZWNpYWwgYXR0cmlidXRlIFwicmVhZG9ubHlcIiB3aWxsIGJlIHNldCBvbiB0aGUgZWxlbWVudFxuICovXG5cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ1NlbGVjdGVkXG4gKiBAcmVzdHJpY3QgQVxuICogQHByaW9yaXR5IDEwMFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIFNldHMgdGhlIGBzZWxlY3RlZGAgYXR0cmlidXRlIG9uIHRoZSBlbGVtZW50LCBpZiB0aGUgZXhwcmVzc2lvbiBpbnNpZGUgYG5nU2VsZWN0ZWRgIGlzIHRydXRoeS5cbiAqXG4gKiBBIHNwZWNpYWwgZGlyZWN0aXZlIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHdlIGNhbm5vdCB1c2UgaW50ZXJwb2xhdGlvbiBpbnNpZGUgdGhlIGBzZWxlY3RlZGBcbiAqIGF0dHJpYnV0ZS4gU2VlIHRoZSB7QGxpbmsgZ3VpZGUvaW50ZXJwb2xhdGlvbiBpbnRlcnBvbGF0aW9uIGd1aWRlfSBmb3IgbW9yZSBpbmZvLlxuICpcbiAqIEBleGFtcGxlXG4gICAgPGV4YW1wbGU+XG4gICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgICA8bGFiZWw+Q2hlY2sgbWUgdG8gc2VsZWN0OiA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmctbW9kZWw9XCJzZWxlY3RlZFwiPjwvbGFiZWw+PGJyLz5cbiAgICAgICAgPHNlbGVjdCBhcmlhLWxhYmVsPVwibmdTZWxlY3RlZCBkZW1vXCI+XG4gICAgICAgICAgPG9wdGlvbj5IZWxsbyE8L29wdGlvbj5cbiAgICAgICAgICA8b3B0aW9uIGlkPVwiZ3JlZXRcIiBuZy1zZWxlY3RlZD1cInNlbGVjdGVkXCI+R3JlZXRpbmdzITwvb3B0aW9uPlxuICAgICAgICA8L3NlbGVjdD5cbiAgICAgIDwvZmlsZT5cbiAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgICAgaXQoJ3Nob3VsZCBzZWxlY3QgR3JlZXRpbmdzIScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmlkKCdncmVldCcpKS5nZXRBdHRyaWJ1dGUoJ3NlbGVjdGVkJykpLnRvQmVGYWxzeSgpO1xuICAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ3NlbGVjdGVkJykpLmNsaWNrKCk7XG4gICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2dyZWV0JykpLmdldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnKSkudG9CZVRydXRoeSgpO1xuICAgICAgICB9KTtcbiAgICAgIDwvZmlsZT5cbiAgICA8L2V4YW1wbGU+XG4gKlxuICogQGVsZW1lbnQgT1BUSU9OXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nU2VsZWN0ZWQgSWYgdGhlIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259IGlzIHRydXRoeSxcbiAqICAgICB0aGVuIHNwZWNpYWwgYXR0cmlidXRlIFwic2VsZWN0ZWRcIiB3aWxsIGJlIHNldCBvbiB0aGUgZWxlbWVudFxuICovXG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdPcGVuXG4gKiBAcmVzdHJpY3QgQVxuICogQHByaW9yaXR5IDEwMFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIFNldHMgdGhlIGBvcGVuYCBhdHRyaWJ1dGUgb24gdGhlIGVsZW1lbnQsIGlmIHRoZSBleHByZXNzaW9uIGluc2lkZSBgbmdPcGVuYCBpcyB0cnV0aHkuXG4gKlxuICogQSBzcGVjaWFsIGRpcmVjdGl2ZSBpcyBuZWNlc3NhcnkgYmVjYXVzZSB3ZSBjYW5ub3QgdXNlIGludGVycG9sYXRpb24gaW5zaWRlIHRoZSBgb3BlbmBcbiAqIGF0dHJpYnV0ZS4gU2VlIHRoZSB7QGxpbmsgZ3VpZGUvaW50ZXJwb2xhdGlvbiBpbnRlcnBvbGF0aW9uIGd1aWRlfSBmb3IgbW9yZSBpbmZvLlxuICpcbiAqIEBleGFtcGxlXG4gICAgIDxleGFtcGxlPlxuICAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgICA8bGFiZWw+Q2hlY2sgbWUgY2hlY2sgbXVsdGlwbGU6IDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cIm9wZW5cIj48L2xhYmVsPjxici8+XG4gICAgICAgICA8ZGV0YWlscyBpZD1cImRldGFpbHNcIiBuZy1vcGVuPVwib3BlblwiPlxuICAgICAgICAgICAgPHN1bW1hcnk+U2hvdy9IaWRlIG1lPC9zdW1tYXJ5PlxuICAgICAgICAgPC9kZXRhaWxzPlxuICAgICAgIDwvZmlsZT5cbiAgICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgICBpdCgnc2hvdWxkIHRvZ2dsZSBvcGVuJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmlkKCdkZXRhaWxzJykpLmdldEF0dHJpYnV0ZSgnb3BlbicpKS50b0JlRmFsc3koKTtcbiAgICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnb3BlbicpKS5jbGljaygpO1xuICAgICAgICAgICBleHBlY3QoZWxlbWVudChieS5pZCgnZGV0YWlscycpKS5nZXRBdHRyaWJ1dGUoJ29wZW4nKSkudG9CZVRydXRoeSgpO1xuICAgICAgICAgfSk7XG4gICAgICAgPC9maWxlPlxuICAgICA8L2V4YW1wbGU+XG4gKlxuICogQGVsZW1lbnQgREVUQUlMU1xuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ09wZW4gSWYgdGhlIHtAbGluayBndWlkZS9leHByZXNzaW9uIGV4cHJlc3Npb259IGlzIHRydXRoeSxcbiAqICAgICB0aGVuIHNwZWNpYWwgYXR0cmlidXRlIFwib3BlblwiIHdpbGwgYmUgc2V0IG9uIHRoZSBlbGVtZW50XG4gKi9cblxudmFyIG5nQXR0cmlidXRlQWxpYXNEaXJlY3RpdmVzID0ge307XG5cbi8vIGJvb2xlYW4gYXR0cnMgYXJlIGV2YWx1YXRlZFxuZm9yRWFjaChCT09MRUFOX0FUVFIsIGZ1bmN0aW9uKHByb3BOYW1lLCBhdHRyTmFtZSkge1xuICAvLyBiaW5kaW5nIHRvIG11bHRpcGxlIGlzIG5vdCBzdXBwb3J0ZWRcbiAgaWYgKHByb3BOYW1lID09IFwibXVsdGlwbGVcIikgcmV0dXJuO1xuXG4gIGZ1bmN0aW9uIGRlZmF1bHRMaW5rRm4oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICBzY29wZS4kd2F0Y2goYXR0cltub3JtYWxpemVkXSwgZnVuY3Rpb24gbmdCb29sZWFuQXR0cldhdGNoQWN0aW9uKHZhbHVlKSB7XG4gICAgICBhdHRyLiRzZXQoYXR0ck5hbWUsICEhdmFsdWUpO1xuICAgIH0pO1xuICB9XG5cbiAgdmFyIG5vcm1hbGl6ZWQgPSBkaXJlY3RpdmVOb3JtYWxpemUoJ25nLScgKyBhdHRyTmFtZSk7XG4gIHZhciBsaW5rRm4gPSBkZWZhdWx0TGlua0ZuO1xuXG4gIGlmIChwcm9wTmFtZSA9PT0gJ2NoZWNrZWQnKSB7XG4gICAgbGlua0ZuID0gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgIC8vIGVuc3VyaW5nIG5nQ2hlY2tlZCBkb2Vzbid0IGludGVyZmVyZSB3aXRoIG5nTW9kZWwgd2hlbiBib3RoIGFyZSBzZXQgb24gdGhlIHNhbWUgaW5wdXRcbiAgICAgIGlmIChhdHRyLm5nTW9kZWwgIT09IGF0dHJbbm9ybWFsaXplZF0pIHtcbiAgICAgICAgZGVmYXVsdExpbmtGbihzY29wZSwgZWxlbWVudCwgYXR0cik7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIG5nQXR0cmlidXRlQWxpYXNEaXJlY3RpdmVzW25vcm1hbGl6ZWRdID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICBwcmlvcml0eTogMTAwLFxuICAgICAgbGluazogbGlua0ZuXG4gICAgfTtcbiAgfTtcbn0pO1xuXG4vLyBhbGlhc2VkIGlucHV0IGF0dHJzIGFyZSBldmFsdWF0ZWRcbmZvckVhY2goQUxJQVNFRF9BVFRSLCBmdW5jdGlvbihodG1sQXR0ciwgbmdBdHRyKSB7XG4gIG5nQXR0cmlidXRlQWxpYXNEaXJlY3RpdmVzW25nQXR0cl0gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcHJpb3JpdHk6IDEwMCxcbiAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG4gICAgICAgIC8vc3BlY2lhbCBjYXNlIG5nUGF0dGVybiB3aGVuIGEgbGl0ZXJhbCByZWd1bGFyIGV4cHJlc3Npb24gdmFsdWVcbiAgICAgICAgLy9pcyB1c2VkIGFzIHRoZSBleHByZXNzaW9uICh0aGlzIHdheSB3ZSBkb24ndCBoYXZlIHRvIHdhdGNoIGFueXRoaW5nKS5cbiAgICAgICAgaWYgKG5nQXR0ciA9PT0gXCJuZ1BhdHRlcm5cIiAmJiBhdHRyLm5nUGF0dGVybi5jaGFyQXQoMCkgPT0gXCIvXCIpIHtcbiAgICAgICAgICB2YXIgbWF0Y2ggPSBhdHRyLm5nUGF0dGVybi5tYXRjaChSRUdFWF9TVFJJTkdfUkVHRVhQKTtcbiAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgIGF0dHIuJHNldChcIm5nUGF0dGVyblwiLCBuZXcgUmVnRXhwKG1hdGNoWzFdLCBtYXRjaFsyXSkpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHNjb3BlLiR3YXRjaChhdHRyW25nQXR0cl0sIGZ1bmN0aW9uIG5nQXR0ckFsaWFzV2F0Y2hBY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICBhdHRyLiRzZXQobmdBdHRyLCB2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH07XG59KTtcblxuLy8gbmctc3JjLCBuZy1zcmNzZXQsIG5nLWhyZWYgYXJlIGludGVycG9sYXRlZFxuZm9yRWFjaChbJ3NyYycsICdzcmNzZXQnLCAnaHJlZiddLCBmdW5jdGlvbihhdHRyTmFtZSkge1xuICB2YXIgbm9ybWFsaXplZCA9IGRpcmVjdGl2ZU5vcm1hbGl6ZSgnbmctJyArIGF0dHJOYW1lKTtcbiAgbmdBdHRyaWJ1dGVBbGlhc0RpcmVjdGl2ZXNbbm9ybWFsaXplZF0gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcHJpb3JpdHk6IDk5LCAvLyBpdCBuZWVkcyB0byBydW4gYWZ0ZXIgdGhlIGF0dHJpYnV0ZXMgYXJlIGludGVycG9sYXRlZFxuICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgICAgdmFyIHByb3BOYW1lID0gYXR0ck5hbWUsXG4gICAgICAgICAgICBuYW1lID0gYXR0ck5hbWU7XG5cbiAgICAgICAgaWYgKGF0dHJOYW1lID09PSAnaHJlZicgJiZcbiAgICAgICAgICAgIHRvU3RyaW5nLmNhbGwoZWxlbWVudC5wcm9wKCdocmVmJykpID09PSAnW29iamVjdCBTVkdBbmltYXRlZFN0cmluZ10nKSB7XG4gICAgICAgICAgbmFtZSA9ICd4bGlua0hyZWYnO1xuICAgICAgICAgIGF0dHIuJGF0dHJbbmFtZV0gPSAneGxpbms6aHJlZic7XG4gICAgICAgICAgcHJvcE5hbWUgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgYXR0ci4kb2JzZXJ2ZShub3JtYWxpemVkLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChhdHRyTmFtZSA9PT0gJ2hyZWYnKSB7XG4gICAgICAgICAgICAgIGF0dHIuJHNldChuYW1lLCBudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhdHRyLiRzZXQobmFtZSwgdmFsdWUpO1xuXG4gICAgICAgICAgLy8gb24gSUUsIGlmIFwibmc6c3JjXCIgZGlyZWN0aXZlIGRlY2xhcmF0aW9uIGlzIHVzZWQgYW5kIFwic3JjXCIgYXR0cmlidXRlIGRvZXNuJ3QgZXhpc3RcbiAgICAgICAgICAvLyB0aGVuIGNhbGxpbmcgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3NyYycsICdmb28nKSBkb2Vzbid0IGRvIGFueXRoaW5nLCBzbyB3ZSBuZWVkXG4gICAgICAgICAgLy8gdG8gc2V0IHRoZSBwcm9wZXJ0eSBhcyB3ZWxsIHRvIGFjaGlldmUgdGhlIGRlc2lyZWQgZWZmZWN0LlxuICAgICAgICAgIC8vIHdlIHVzZSBhdHRyW2F0dHJOYW1lXSB2YWx1ZSBzaW5jZSAkc2V0IGNhbiBzYW5pdGl6ZSB0aGUgdXJsLlxuICAgICAgICAgIGlmIChtc2llICYmIHByb3BOYW1lKSBlbGVtZW50LnByb3AocHJvcE5hbWUsIGF0dHJbbmFtZV0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xufSk7XG5cbi8qIGdsb2JhbCAtbnVsbEZvcm1DdHJsLCAtU1VCTUlUVEVEX0NMQVNTLCBhZGRTZXRWYWxpZGl0eU1ldGhvZDogdHJ1ZVxuICovXG52YXIgbnVsbEZvcm1DdHJsID0ge1xuICAkYWRkQ29udHJvbDogbm9vcCxcbiAgJCRyZW5hbWVDb250cm9sOiBudWxsRm9ybVJlbmFtZUNvbnRyb2wsXG4gICRyZW1vdmVDb250cm9sOiBub29wLFxuICAkc2V0VmFsaWRpdHk6IG5vb3AsXG4gICRzZXREaXJ0eTogbm9vcCxcbiAgJHNldFByaXN0aW5lOiBub29wLFxuICAkc2V0U3VibWl0dGVkOiBub29wXG59LFxuU1VCTUlUVEVEX0NMQVNTID0gJ25nLXN1Ym1pdHRlZCc7XG5cbmZ1bmN0aW9uIG51bGxGb3JtUmVuYW1lQ29udHJvbChjb250cm9sLCBuYW1lKSB7XG4gIGNvbnRyb2wuJG5hbWUgPSBuYW1lO1xufVxuXG4vKipcbiAqIEBuZ2RvYyB0eXBlXG4gKiBAbmFtZSBmb3JtLkZvcm1Db250cm9sbGVyXG4gKlxuICogQHByb3BlcnR5IHtib29sZWFufSAkcHJpc3RpbmUgVHJ1ZSBpZiB1c2VyIGhhcyBub3QgaW50ZXJhY3RlZCB3aXRoIHRoZSBmb3JtIHlldC5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gJGRpcnR5IFRydWUgaWYgdXNlciBoYXMgYWxyZWFkeSBpbnRlcmFjdGVkIHdpdGggdGhlIGZvcm0uXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59ICR2YWxpZCBUcnVlIGlmIGFsbCBvZiB0aGUgY29udGFpbmluZyBmb3JtcyBhbmQgY29udHJvbHMgYXJlIHZhbGlkLlxuICogQHByb3BlcnR5IHtib29sZWFufSAkaW52YWxpZCBUcnVlIGlmIGF0IGxlYXN0IG9uZSBjb250YWluaW5nIGNvbnRyb2wgb3IgZm9ybSBpcyBpbnZhbGlkLlxuICogQHByb3BlcnR5IHtib29sZWFufSAkcGVuZGluZyBUcnVlIGlmIGF0IGxlYXN0IG9uZSBjb250YWluaW5nIGNvbnRyb2wgb3IgZm9ybSBpcyBwZW5kaW5nLlxuICogQHByb3BlcnR5IHtib29sZWFufSAkc3VibWl0dGVkIFRydWUgaWYgdXNlciBoYXMgc3VibWl0dGVkIHRoZSBmb3JtIGV2ZW4gaWYgaXRzIGludmFsaWQuXG4gKlxuICogQHByb3BlcnR5IHtPYmplY3R9ICRlcnJvciBJcyBhbiBvYmplY3QgaGFzaCwgY29udGFpbmluZyByZWZlcmVuY2VzIHRvIGNvbnRyb2xzIG9yXG4gKiAgZm9ybXMgd2l0aCBmYWlsaW5nIHZhbGlkYXRvcnMsIHdoZXJlOlxuICpcbiAqICAtIGtleXMgYXJlIHZhbGlkYXRpb24gdG9rZW5zIChlcnJvciBuYW1lcyksXG4gKiAgLSB2YWx1ZXMgYXJlIGFycmF5cyBvZiBjb250cm9scyBvciBmb3JtcyB0aGF0IGhhdmUgYSBmYWlsaW5nIHZhbGlkYXRvciBmb3IgZ2l2ZW4gZXJyb3IgbmFtZS5cbiAqXG4gKiAgQnVpbHQtaW4gdmFsaWRhdGlvbiB0b2tlbnM6XG4gKlxuICogIC0gYGVtYWlsYFxuICogIC0gYG1heGBcbiAqICAtIGBtYXhsZW5ndGhgXG4gKiAgLSBgbWluYFxuICogIC0gYG1pbmxlbmd0aGBcbiAqICAtIGBudW1iZXJgXG4gKiAgLSBgcGF0dGVybmBcbiAqICAtIGByZXF1aXJlZGBcbiAqICAtIGB1cmxgXG4gKiAgLSBgZGF0ZWBcbiAqICAtIGBkYXRldGltZWxvY2FsYFxuICogIC0gYHRpbWVgXG4gKiAgLSBgd2Vla2BcbiAqICAtIGBtb250aGBcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIGBGb3JtQ29udHJvbGxlcmAga2VlcHMgdHJhY2sgb2YgYWxsIGl0cyBjb250cm9scyBhbmQgbmVzdGVkIGZvcm1zIGFzIHdlbGwgYXMgdGhlIHN0YXRlIG9mIHRoZW0sXG4gKiBzdWNoIGFzIGJlaW5nIHZhbGlkL2ludmFsaWQgb3IgZGlydHkvcHJpc3RpbmUuXG4gKlxuICogRWFjaCB7QGxpbmsgbmcuZGlyZWN0aXZlOmZvcm0gZm9ybX0gZGlyZWN0aXZlIGNyZWF0ZXMgYW4gaW5zdGFuY2VcbiAqIG9mIGBGb3JtQ29udHJvbGxlcmAuXG4gKlxuICovXG4vL2Fza3MgZm9yICRzY29wZSB0byBmb29sIHRoZSBCQyBjb250cm9sbGVyIG1vZHVsZVxuRm9ybUNvbnRyb2xsZXIuJGluamVjdCA9IFsnJGVsZW1lbnQnLCAnJGF0dHJzJywgJyRzY29wZScsICckYW5pbWF0ZScsICckaW50ZXJwb2xhdGUnXTtcbmZ1bmN0aW9uIEZvcm1Db250cm9sbGVyKGVsZW1lbnQsIGF0dHJzLCAkc2NvcGUsICRhbmltYXRlLCAkaW50ZXJwb2xhdGUpIHtcbiAgdmFyIGZvcm0gPSB0aGlzLFxuICAgICAgY29udHJvbHMgPSBbXTtcblxuICAvLyBpbml0IHN0YXRlXG4gIGZvcm0uJGVycm9yID0ge307XG4gIGZvcm0uJCRzdWNjZXNzID0ge307XG4gIGZvcm0uJHBlbmRpbmcgPSB1bmRlZmluZWQ7XG4gIGZvcm0uJG5hbWUgPSAkaW50ZXJwb2xhdGUoYXR0cnMubmFtZSB8fCBhdHRycy5uZ0Zvcm0gfHwgJycpKCRzY29wZSk7XG4gIGZvcm0uJGRpcnR5ID0gZmFsc2U7XG4gIGZvcm0uJHByaXN0aW5lID0gdHJ1ZTtcbiAgZm9ybS4kdmFsaWQgPSB0cnVlO1xuICBmb3JtLiRpbnZhbGlkID0gZmFsc2U7XG4gIGZvcm0uJHN1Ym1pdHRlZCA9IGZhbHNlO1xuICBmb3JtLiQkcGFyZW50Rm9ybSA9IG51bGxGb3JtQ3RybDtcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSBmb3JtLkZvcm1Db250cm9sbGVyIyRyb2xsYmFja1ZpZXdWYWx1ZVxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogUm9sbGJhY2sgYWxsIGZvcm0gY29udHJvbHMgcGVuZGluZyB1cGRhdGVzIHRvIHRoZSBgJG1vZGVsVmFsdWVgLlxuICAgKlxuICAgKiBVcGRhdGVzIG1heSBiZSBwZW5kaW5nIGJ5IGEgZGVib3VuY2VkIGV2ZW50IG9yIGJlY2F1c2UgdGhlIGlucHV0IGlzIHdhaXRpbmcgZm9yIGEgc29tZSBmdXR1cmVcbiAgICogZXZlbnQgZGVmaW5lZCBpbiBgbmctbW9kZWwtb3B0aW9uc2AuIFRoaXMgbWV0aG9kIGlzIHR5cGljYWxseSBuZWVkZWQgYnkgdGhlIHJlc2V0IGJ1dHRvbiBvZlxuICAgKiBhIGZvcm0gdGhhdCB1c2VzIGBuZy1tb2RlbC1vcHRpb25zYCB0byBwZW5kIHVwZGF0ZXMuXG4gICAqL1xuICBmb3JtLiRyb2xsYmFja1ZpZXdWYWx1ZSA9IGZ1bmN0aW9uKCkge1xuICAgIGZvckVhY2goY29udHJvbHMsIGZ1bmN0aW9uKGNvbnRyb2wpIHtcbiAgICAgIGNvbnRyb2wuJHJvbGxiYWNrVmlld1ZhbHVlKCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgZm9ybS5Gb3JtQ29udHJvbGxlciMkY29tbWl0Vmlld1ZhbHVlXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBDb21taXQgYWxsIGZvcm0gY29udHJvbHMgcGVuZGluZyB1cGRhdGVzIHRvIHRoZSBgJG1vZGVsVmFsdWVgLlxuICAgKlxuICAgKiBVcGRhdGVzIG1heSBiZSBwZW5kaW5nIGJ5IGEgZGVib3VuY2VkIGV2ZW50IG9yIGJlY2F1c2UgdGhlIGlucHV0IGlzIHdhaXRpbmcgZm9yIGEgc29tZSBmdXR1cmVcbiAgICogZXZlbnQgZGVmaW5lZCBpbiBgbmctbW9kZWwtb3B0aW9uc2AuIFRoaXMgbWV0aG9kIGlzIHJhcmVseSBuZWVkZWQgYXMgYE5nTW9kZWxDb250cm9sbGVyYFxuICAgKiB1c3VhbGx5IGhhbmRsZXMgY2FsbGluZyB0aGlzIGluIHJlc3BvbnNlIHRvIGlucHV0IGV2ZW50cy5cbiAgICovXG4gIGZvcm0uJGNvbW1pdFZpZXdWYWx1ZSA9IGZ1bmN0aW9uKCkge1xuICAgIGZvckVhY2goY29udHJvbHMsIGZ1bmN0aW9uKGNvbnRyb2wpIHtcbiAgICAgIGNvbnRyb2wuJGNvbW1pdFZpZXdWYWx1ZSgpO1xuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lIGZvcm0uRm9ybUNvbnRyb2xsZXIjJGFkZENvbnRyb2xcbiAgICogQHBhcmFtIHtvYmplY3R9IGNvbnRyb2wgY29udHJvbCBvYmplY3QsIGVpdGhlciBhIHtAbGluayBmb3JtLkZvcm1Db250cm9sbGVyfSBvciBhblxuICAgKiB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlcn1cbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFJlZ2lzdGVyIGEgY29udHJvbCB3aXRoIHRoZSBmb3JtLiBJbnB1dCBlbGVtZW50cyB1c2luZyBuZ01vZGVsQ29udHJvbGxlciBkbyB0aGlzIGF1dG9tYXRpY2FsbHlcbiAgICogd2hlbiB0aGV5IGFyZSBsaW5rZWQuXG4gICAqXG4gICAqIE5vdGUgdGhhdCB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgY29udHJvbCB3aWxsIG5vdCBiZSByZWZsZWN0ZWQgb24gdGhlIG5ldyBwYXJlbnQgZm9ybS4gVGhpc1xuICAgKiBpcyBub3QgYW4gaXNzdWUgd2l0aCBub3JtYWwgdXNlLCBhcyBmcmVzaGx5IGNvbXBpbGVkIGFuZCBsaW5rZWQgY29udHJvbHMgYXJlIGluIGEgYCRwcmlzdGluZWBcbiAgICogc3RhdGUuXG4gICAqXG4gICAqIEhvd2V2ZXIsIGlmIHRoZSBtZXRob2QgaXMgdXNlZCBwcm9ncmFtbWF0aWNhbGx5LCBmb3IgZXhhbXBsZSBieSBhZGRpbmcgZHluYW1pY2FsbHkgY3JlYXRlZCBjb250cm9scyxcbiAgICogb3IgY29udHJvbHMgdGhhdCBoYXZlIGJlZW4gcHJldmlvdXNseSByZW1vdmVkIHdpdGhvdXQgZGVzdHJveWluZyB0aGVpciBjb3JyZXNwb25kaW5nIERPTSBlbGVtZW50LFxuICAgKiBpdCdzIHRoZSBkZXZlbG9wZXJzIHJlc3BvbnNpYmlsaXR5IHRvIG1ha2Ugc3VyZSB0aGUgY3VycmVudCBzdGF0ZSBwcm9wYWdhdGVzIHRvIHRoZSBwYXJlbnQgZm9ybS5cbiAgICpcbiAgICogRm9yIGV4YW1wbGUsIGlmIGFuIGlucHV0IGNvbnRyb2wgaXMgYWRkZWQgdGhhdCBpcyBhbHJlYWR5IGAkZGlydHlgIGFuZCBoYXMgYCRlcnJvcmAgcHJvcGVydGllcyxcbiAgICogY2FsbGluZyBgJHNldERpcnR5KClgIGFuZCBgJHZhbGlkYXRlKClgIGFmdGVyd2FyZHMgd2lsbCBwcm9wYWdhdGUgdGhlIHN0YXRlIHRvIHRoZSBwYXJlbnQgZm9ybS5cbiAgICovXG4gIGZvcm0uJGFkZENvbnRyb2wgPSBmdW5jdGlvbihjb250cm9sKSB7XG4gICAgLy8gQnJlYWtpbmcgY2hhbmdlIC0gYmVmb3JlLCBpbnB1dHMgd2hvc2UgbmFtZSB3YXMgXCJoYXNPd25Qcm9wZXJ0eVwiIHdlcmUgcXVpZXRseSBpZ25vcmVkXG4gICAgLy8gYW5kIG5vdCBhZGRlZCB0byB0aGUgc2NvcGUuICBOb3cgd2UgdGhyb3cgYW4gZXJyb3IuXG4gICAgYXNzZXJ0Tm90SGFzT3duUHJvcGVydHkoY29udHJvbC4kbmFtZSwgJ2lucHV0Jyk7XG4gICAgY29udHJvbHMucHVzaChjb250cm9sKTtcblxuICAgIGlmIChjb250cm9sLiRuYW1lKSB7XG4gICAgICBmb3JtW2NvbnRyb2wuJG5hbWVdID0gY29udHJvbDtcbiAgICB9XG5cbiAgICBjb250cm9sLiQkcGFyZW50Rm9ybSA9IGZvcm07XG4gIH07XG5cbiAgLy8gUHJpdmF0ZSBBUEk6IHJlbmFtZSBhIGZvcm0gY29udHJvbFxuICBmb3JtLiQkcmVuYW1lQ29udHJvbCA9IGZ1bmN0aW9uKGNvbnRyb2wsIG5ld05hbWUpIHtcbiAgICB2YXIgb2xkTmFtZSA9IGNvbnRyb2wuJG5hbWU7XG5cbiAgICBpZiAoZm9ybVtvbGROYW1lXSA9PT0gY29udHJvbCkge1xuICAgICAgZGVsZXRlIGZvcm1bb2xkTmFtZV07XG4gICAgfVxuICAgIGZvcm1bbmV3TmFtZV0gPSBjb250cm9sO1xuICAgIGNvbnRyb2wuJG5hbWUgPSBuZXdOYW1lO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lIGZvcm0uRm9ybUNvbnRyb2xsZXIjJHJlbW92ZUNvbnRyb2xcbiAgICogQHBhcmFtIHtvYmplY3R9IGNvbnRyb2wgY29udHJvbCBvYmplY3QsIGVpdGhlciBhIHtAbGluayBmb3JtLkZvcm1Db250cm9sbGVyfSBvciBhblxuICAgKiB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlcn1cbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIERlcmVnaXN0ZXIgYSBjb250cm9sIGZyb20gdGhlIGZvcm0uXG4gICAqXG4gICAqIElucHV0IGVsZW1lbnRzIHVzaW5nIG5nTW9kZWxDb250cm9sbGVyIGRvIHRoaXMgYXV0b21hdGljYWxseSB3aGVuIHRoZXkgYXJlIGRlc3Ryb3llZC5cbiAgICpcbiAgICogTm90ZSB0aGF0IG9ubHkgdGhlIHJlbW92ZWQgY29udHJvbCdzIHZhbGlkYXRpb24gc3RhdGUgKGAkZXJyb3JzYGV0Yy4pIHdpbGwgYmUgcmVtb3ZlZCBmcm9tIHRoZVxuICAgKiBmb3JtLiBgJGRpcnR5YCwgYCRzdWJtaXR0ZWRgIHN0YXRlcyB3aWxsIG5vdCBiZSBjaGFuZ2VkLCBiZWNhdXNlIHRoZSBleHBlY3RlZCBiZWhhdmlvciBjYW4gYmVcbiAgICogZGlmZmVyZW50IGZyb20gY2FzZSB0byBjYXNlLiBGb3IgZXhhbXBsZSwgcmVtb3ZpbmcgdGhlIG9ubHkgYCRkaXJ0eWAgY29udHJvbCBmcm9tIGEgZm9ybSBtYXkgb3JcbiAgICogbWF5IG5vdCBtZWFuIHRoYXQgdGhlIGZvcm0gaXMgc3RpbGwgYCRkaXJ0eWAuXG4gICAqL1xuICBmb3JtLiRyZW1vdmVDb250cm9sID0gZnVuY3Rpb24oY29udHJvbCkge1xuICAgIGlmIChjb250cm9sLiRuYW1lICYmIGZvcm1bY29udHJvbC4kbmFtZV0gPT09IGNvbnRyb2wpIHtcbiAgICAgIGRlbGV0ZSBmb3JtW2NvbnRyb2wuJG5hbWVdO1xuICAgIH1cbiAgICBmb3JFYWNoKGZvcm0uJHBlbmRpbmcsIGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICBmb3JtLiRzZXRWYWxpZGl0eShuYW1lLCBudWxsLCBjb250cm9sKTtcbiAgICB9KTtcbiAgICBmb3JFYWNoKGZvcm0uJGVycm9yLCBmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgICAgZm9ybS4kc2V0VmFsaWRpdHkobmFtZSwgbnVsbCwgY29udHJvbCk7XG4gICAgfSk7XG4gICAgZm9yRWFjaChmb3JtLiQkc3VjY2VzcywgZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICAgIGZvcm0uJHNldFZhbGlkaXR5KG5hbWUsIG51bGwsIGNvbnRyb2wpO1xuICAgIH0pO1xuXG4gICAgYXJyYXlSZW1vdmUoY29udHJvbHMsIGNvbnRyb2wpO1xuICAgIGNvbnRyb2wuJCRwYXJlbnRGb3JtID0gbnVsbEZvcm1DdHJsO1xuICB9O1xuXG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgZm9ybS5Gb3JtQ29udHJvbGxlciMkc2V0VmFsaWRpdHlcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFNldHMgdGhlIHZhbGlkaXR5IG9mIGEgZm9ybSBjb250cm9sLlxuICAgKlxuICAgKiBUaGlzIG1ldGhvZCB3aWxsIGFsc28gcHJvcGFnYXRlIHRvIHBhcmVudCBmb3Jtcy5cbiAgICovXG4gIGFkZFNldFZhbGlkaXR5TWV0aG9kKHtcbiAgICBjdHJsOiB0aGlzLFxuICAgICRlbGVtZW50OiBlbGVtZW50LFxuICAgIHNldDogZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSwgY29udHJvbGxlcikge1xuICAgICAgdmFyIGxpc3QgPSBvYmplY3RbcHJvcGVydHldO1xuICAgICAgaWYgKCFsaXN0KSB7XG4gICAgICAgIG9iamVjdFtwcm9wZXJ0eV0gPSBbY29udHJvbGxlcl07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgaW5kZXggPSBsaXN0LmluZGV4T2YoY29udHJvbGxlcik7XG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICBsaXN0LnB1c2goY29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIHVuc2V0OiBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5LCBjb250cm9sbGVyKSB7XG4gICAgICB2YXIgbGlzdCA9IG9iamVjdFtwcm9wZXJ0eV07XG4gICAgICBpZiAoIWxpc3QpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgYXJyYXlSZW1vdmUobGlzdCwgY29udHJvbGxlcik7XG4gICAgICBpZiAobGlzdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgZGVsZXRlIG9iamVjdFtwcm9wZXJ0eV07XG4gICAgICB9XG4gICAgfSxcbiAgICAkYW5pbWF0ZTogJGFuaW1hdGVcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgZm9ybS5Gb3JtQ29udHJvbGxlciMkc2V0RGlydHlcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFNldHMgdGhlIGZvcm0gdG8gYSBkaXJ0eSBzdGF0ZS5cbiAgICpcbiAgICogVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byBhZGQgdGhlICduZy1kaXJ0eScgY2xhc3MgYW5kIHNldCB0aGUgZm9ybSB0byBhIGRpcnR5XG4gICAqIHN0YXRlIChuZy1kaXJ0eSBjbGFzcykuIFRoaXMgbWV0aG9kIHdpbGwgYWxzbyBwcm9wYWdhdGUgdG8gcGFyZW50IGZvcm1zLlxuICAgKi9cbiAgZm9ybS4kc2V0RGlydHkgPSBmdW5jdGlvbigpIHtcbiAgICAkYW5pbWF0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBQUklTVElORV9DTEFTUyk7XG4gICAgJGFuaW1hdGUuYWRkQ2xhc3MoZWxlbWVudCwgRElSVFlfQ0xBU1MpO1xuICAgIGZvcm0uJGRpcnR5ID0gdHJ1ZTtcbiAgICBmb3JtLiRwcmlzdGluZSA9IGZhbHNlO1xuICAgIGZvcm0uJCRwYXJlbnRGb3JtLiRzZXREaXJ0eSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lIGZvcm0uRm9ybUNvbnRyb2xsZXIjJHNldFByaXN0aW5lXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBTZXRzIHRoZSBmb3JtIHRvIGl0cyBwcmlzdGluZSBzdGF0ZS5cbiAgICpcbiAgICogVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byByZW1vdmUgdGhlICduZy1kaXJ0eScgY2xhc3MgYW5kIHNldCB0aGUgZm9ybSB0byBpdHMgcHJpc3RpbmVcbiAgICogc3RhdGUgKG5nLXByaXN0aW5lIGNsYXNzKS4gVGhpcyBtZXRob2Qgd2lsbCBhbHNvIHByb3BhZ2F0ZSB0byBhbGwgdGhlIGNvbnRyb2xzIGNvbnRhaW5lZFxuICAgKiBpbiB0aGlzIGZvcm0uXG4gICAqXG4gICAqIFNldHRpbmcgYSBmb3JtIGJhY2sgdG8gYSBwcmlzdGluZSBzdGF0ZSBpcyBvZnRlbiB1c2VmdWwgd2hlbiB3ZSB3YW50IHRvICdyZXVzZScgYSBmb3JtIGFmdGVyXG4gICAqIHNhdmluZyBvciByZXNldHRpbmcgaXQuXG4gICAqL1xuICBmb3JtLiRzZXRQcmlzdGluZSA9IGZ1bmN0aW9uKCkge1xuICAgICRhbmltYXRlLnNldENsYXNzKGVsZW1lbnQsIFBSSVNUSU5FX0NMQVNTLCBESVJUWV9DTEFTUyArICcgJyArIFNVQk1JVFRFRF9DTEFTUyk7XG4gICAgZm9ybS4kZGlydHkgPSBmYWxzZTtcbiAgICBmb3JtLiRwcmlzdGluZSA9IHRydWU7XG4gICAgZm9ybS4kc3VibWl0dGVkID0gZmFsc2U7XG4gICAgZm9yRWFjaChjb250cm9scywgZnVuY3Rpb24oY29udHJvbCkge1xuICAgICAgY29udHJvbC4kc2V0UHJpc3RpbmUoKTtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSBmb3JtLkZvcm1Db250cm9sbGVyIyRzZXRVbnRvdWNoZWRcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFNldHMgdGhlIGZvcm0gdG8gaXRzIHVudG91Y2hlZCBzdGF0ZS5cbiAgICpcbiAgICogVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byByZW1vdmUgdGhlICduZy10b3VjaGVkJyBjbGFzcyBhbmQgc2V0IHRoZSBmb3JtIGNvbnRyb2xzIHRvIHRoZWlyXG4gICAqIHVudG91Y2hlZCBzdGF0ZSAobmctdW50b3VjaGVkIGNsYXNzKS5cbiAgICpcbiAgICogU2V0dGluZyBhIGZvcm0gY29udHJvbHMgYmFjayB0byB0aGVpciB1bnRvdWNoZWQgc3RhdGUgaXMgb2Z0ZW4gdXNlZnVsIHdoZW4gc2V0dGluZyB0aGUgZm9ybVxuICAgKiBiYWNrIHRvIGl0cyBwcmlzdGluZSBzdGF0ZS5cbiAgICovXG4gIGZvcm0uJHNldFVudG91Y2hlZCA9IGZ1bmN0aW9uKCkge1xuICAgIGZvckVhY2goY29udHJvbHMsIGZ1bmN0aW9uKGNvbnRyb2wpIHtcbiAgICAgIGNvbnRyb2wuJHNldFVudG91Y2hlZCgpO1xuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lIGZvcm0uRm9ybUNvbnRyb2xsZXIjJHNldFN1Ym1pdHRlZFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogU2V0cyB0aGUgZm9ybSB0byBpdHMgc3VibWl0dGVkIHN0YXRlLlxuICAgKi9cbiAgZm9ybS4kc2V0U3VibWl0dGVkID0gZnVuY3Rpb24oKSB7XG4gICAgJGFuaW1hdGUuYWRkQ2xhc3MoZWxlbWVudCwgU1VCTUlUVEVEX0NMQVNTKTtcbiAgICBmb3JtLiRzdWJtaXR0ZWQgPSB0cnVlO1xuICAgIGZvcm0uJCRwYXJlbnRGb3JtLiRzZXRTdWJtaXR0ZWQoKTtcbiAgfTtcbn1cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ0Zvcm1cbiAqIEByZXN0cmljdCBFQUNcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIE5lc3RhYmxlIGFsaWFzIG9mIHtAbGluayBuZy5kaXJlY3RpdmU6Zm9ybSBgZm9ybWB9IGRpcmVjdGl2ZS4gSFRNTFxuICogZG9lcyBub3QgYWxsb3cgbmVzdGluZyBvZiBmb3JtIGVsZW1lbnRzLiBJdCBpcyB1c2VmdWwgdG8gbmVzdCBmb3JtcywgZm9yIGV4YW1wbGUgaWYgdGhlIHZhbGlkaXR5IG9mIGFcbiAqIHN1Yi1ncm91cCBvZiBjb250cm9scyBuZWVkcyB0byBiZSBkZXRlcm1pbmVkLlxuICpcbiAqIE5vdGU6IHRoZSBwdXJwb3NlIG9mIGBuZ0Zvcm1gIGlzIHRvIGdyb3VwIGNvbnRyb2xzLFxuICogYnV0IG5vdCB0byBiZSBhIHJlcGxhY2VtZW50IGZvciB0aGUgYDxmb3JtPmAgdGFnIHdpdGggYWxsIG9mIGl0cyBjYXBhYmlsaXRpZXNcbiAqIChlLmcuIHBvc3RpbmcgdG8gdGhlIHNlcnZlciwgLi4uKS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZz19IG5nRm9ybXxuYW1lIE5hbWUgb2YgdGhlIGZvcm0uIElmIHNwZWNpZmllZCwgdGhlIGZvcm0gY29udHJvbGxlciB3aWxsIGJlIHB1Ymxpc2hlZCBpbnRvXG4gKiAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRlZCBzY29wZSwgdW5kZXIgdGhpcyBuYW1lLlxuICpcbiAqL1xuXG4gLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBmb3JtXG4gKiBAcmVzdHJpY3QgRVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogRGlyZWN0aXZlIHRoYXQgaW5zdGFudGlhdGVzXG4gKiB7QGxpbmsgZm9ybS5Gb3JtQ29udHJvbGxlciBGb3JtQ29udHJvbGxlcn0uXG4gKlxuICogSWYgdGhlIGBuYW1lYCBhdHRyaWJ1dGUgaXMgc3BlY2lmaWVkLCB0aGUgZm9ybSBjb250cm9sbGVyIGlzIHB1Ymxpc2hlZCBvbnRvIHRoZSBjdXJyZW50IHNjb3BlIHVuZGVyXG4gKiB0aGlzIG5hbWUuXG4gKlxuICogIyBBbGlhczoge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0Zvcm0gYG5nRm9ybWB9XG4gKlxuICogSW4gQW5ndWxhciwgZm9ybXMgY2FuIGJlIG5lc3RlZC4gVGhpcyBtZWFucyB0aGF0IHRoZSBvdXRlciBmb3JtIGlzIHZhbGlkIHdoZW4gYWxsIG9mIHRoZSBjaGlsZFxuICogZm9ybXMgYXJlIHZhbGlkIGFzIHdlbGwuIEhvd2V2ZXIsIGJyb3dzZXJzIGRvIG5vdCBhbGxvdyBuZXN0aW5nIG9mIGA8Zm9ybT5gIGVsZW1lbnRzLCBzb1xuICogQW5ndWxhciBwcm92aWRlcyB0aGUge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0Zvcm0gYG5nRm9ybWB9IGRpcmVjdGl2ZSwgd2hpY2ggYmVoYXZlcyBpZGVudGljYWxseSB0b1xuICogYGZvcm1gIGJ1dCBjYW4gYmUgbmVzdGVkLiBOZXN0ZWQgZm9ybXMgY2FuIGJlIHVzZWZ1bCwgZm9yIGV4YW1wbGUsIGlmIHRoZSB2YWxpZGl0eSBvZiBhIHN1Yi1ncm91cFxuICogb2YgY29udHJvbHMgbmVlZHMgdG8gYmUgZGV0ZXJtaW5lZC5cbiAqXG4gKiAjIENTUyBjbGFzc2VzXG4gKiAgLSBgbmctdmFsaWRgIGlzIHNldCBpZiB0aGUgZm9ybSBpcyB2YWxpZC5cbiAqICAtIGBuZy1pbnZhbGlkYCBpcyBzZXQgaWYgdGhlIGZvcm0gaXMgaW52YWxpZC5cbiAqICAtIGBuZy1wZW5kaW5nYCBpcyBzZXQgaWYgdGhlIGZvcm0gaXMgcGVuZGluZy5cbiAqICAtIGBuZy1wcmlzdGluZWAgaXMgc2V0IGlmIHRoZSBmb3JtIGlzIHByaXN0aW5lLlxuICogIC0gYG5nLWRpcnR5YCBpcyBzZXQgaWYgdGhlIGZvcm0gaXMgZGlydHkuXG4gKiAgLSBgbmctc3VibWl0dGVkYCBpcyBzZXQgaWYgdGhlIGZvcm0gd2FzIHN1Ym1pdHRlZC5cbiAqXG4gKiBLZWVwIGluIG1pbmQgdGhhdCBuZ0FuaW1hdGUgY2FuIGRldGVjdCBlYWNoIG9mIHRoZXNlIGNsYXNzZXMgd2hlbiBhZGRlZCBhbmQgcmVtb3ZlZC5cbiAqXG4gKlxuICogIyBTdWJtaXR0aW5nIGEgZm9ybSBhbmQgcHJldmVudGluZyB0aGUgZGVmYXVsdCBhY3Rpb25cbiAqXG4gKiBTaW5jZSB0aGUgcm9sZSBvZiBmb3JtcyBpbiBjbGllbnQtc2lkZSBBbmd1bGFyIGFwcGxpY2F0aW9ucyBpcyBkaWZmZXJlbnQgdGhhbiBpbiBjbGFzc2ljYWxcbiAqIHJvdW5kdHJpcCBhcHBzLCBpdCBpcyBkZXNpcmFibGUgZm9yIHRoZSBicm93c2VyIG5vdCB0byB0cmFuc2xhdGUgdGhlIGZvcm0gc3VibWlzc2lvbiBpbnRvIGEgZnVsbFxuICogcGFnZSByZWxvYWQgdGhhdCBzZW5kcyB0aGUgZGF0YSB0byB0aGUgc2VydmVyLiBJbnN0ZWFkIHNvbWUgamF2YXNjcmlwdCBsb2dpYyBzaG91bGQgYmUgdHJpZ2dlcmVkXG4gKiB0byBoYW5kbGUgdGhlIGZvcm0gc3VibWlzc2lvbiBpbiBhbiBhcHBsaWNhdGlvbi1zcGVjaWZpYyB3YXkuXG4gKlxuICogRm9yIHRoaXMgcmVhc29uLCBBbmd1bGFyIHByZXZlbnRzIHRoZSBkZWZhdWx0IGFjdGlvbiAoZm9ybSBzdWJtaXNzaW9uIHRvIHRoZSBzZXJ2ZXIpIHVubGVzcyB0aGVcbiAqIGA8Zm9ybT5gIGVsZW1lbnQgaGFzIGFuIGBhY3Rpb25gIGF0dHJpYnV0ZSBzcGVjaWZpZWQuXG4gKlxuICogWW91IGNhbiB1c2Ugb25lIG9mIHRoZSBmb2xsb3dpbmcgdHdvIHdheXMgdG8gc3BlY2lmeSB3aGF0IGphdmFzY3JpcHQgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgd2hlblxuICogYSBmb3JtIGlzIHN1Ym1pdHRlZDpcbiAqXG4gKiAtIHtAbGluayBuZy5kaXJlY3RpdmU6bmdTdWJtaXQgbmdTdWJtaXR9IGRpcmVjdGl2ZSBvbiB0aGUgZm9ybSBlbGVtZW50XG4gKiAtIHtAbGluayBuZy5kaXJlY3RpdmU6bmdDbGljayBuZ0NsaWNrfSBkaXJlY3RpdmUgb24gdGhlIGZpcnN0XG4gICogIGJ1dHRvbiBvciBpbnB1dCBmaWVsZCBvZiB0eXBlIHN1Ym1pdCAoaW5wdXRbdHlwZT1zdWJtaXRdKVxuICpcbiAqIFRvIHByZXZlbnQgZG91YmxlIGV4ZWN1dGlvbiBvZiB0aGUgaGFuZGxlciwgdXNlIG9ubHkgb25lIG9mIHRoZSB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nU3VibWl0IG5nU3VibWl0fVxuICogb3Ige0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0NsaWNrIG5nQ2xpY2t9IGRpcmVjdGl2ZXMuXG4gKiBUaGlzIGlzIGJlY2F1c2Ugb2YgdGhlIGZvbGxvd2luZyBmb3JtIHN1Ym1pc3Npb24gcnVsZXMgaW4gdGhlIEhUTUwgc3BlY2lmaWNhdGlvbjpcbiAqXG4gKiAtIElmIGEgZm9ybSBoYXMgb25seSBvbmUgaW5wdXQgZmllbGQgdGhlbiBoaXR0aW5nIGVudGVyIGluIHRoaXMgZmllbGQgdHJpZ2dlcnMgZm9ybSBzdWJtaXRcbiAqIChgbmdTdWJtaXRgKVxuICogLSBpZiBhIGZvcm0gaGFzIDIrIGlucHV0IGZpZWxkcyBhbmQgbm8gYnV0dG9ucyBvciBpbnB1dFt0eXBlPXN1Ym1pdF0gdGhlbiBoaXR0aW5nIGVudGVyXG4gKiBkb2Vzbid0IHRyaWdnZXIgc3VibWl0XG4gKiAtIGlmIGEgZm9ybSBoYXMgb25lIG9yIG1vcmUgaW5wdXQgZmllbGRzIGFuZCBvbmUgb3IgbW9yZSBidXR0b25zIG9yIGlucHV0W3R5cGU9c3VibWl0XSB0aGVuXG4gKiBoaXR0aW5nIGVudGVyIGluIGFueSBvZiB0aGUgaW5wdXQgZmllbGRzIHdpbGwgdHJpZ2dlciB0aGUgY2xpY2sgaGFuZGxlciBvbiB0aGUgKmZpcnN0KiBidXR0b24gb3JcbiAqIGlucHV0W3R5cGU9c3VibWl0XSAoYG5nQ2xpY2tgKSAqYW5kKiBhIHN1Ym1pdCBoYW5kbGVyIG9uIHRoZSBlbmNsb3NpbmcgZm9ybSAoYG5nU3VibWl0YClcbiAqXG4gKiBBbnkgcGVuZGluZyBgbmdNb2RlbE9wdGlvbnNgIGNoYW5nZXMgd2lsbCB0YWtlIHBsYWNlIGltbWVkaWF0ZWx5IHdoZW4gYW4gZW5jbG9zaW5nIGZvcm0gaXNcbiAqIHN1Ym1pdHRlZC4gTm90ZSB0aGF0IGBuZ0NsaWNrYCBldmVudHMgd2lsbCBvY2N1ciBiZWZvcmUgdGhlIG1vZGVsIGlzIHVwZGF0ZWQuIFVzZSBgbmdTdWJtaXRgXG4gKiB0byBoYXZlIGFjY2VzcyB0byB0aGUgdXBkYXRlZCBtb2RlbC5cbiAqXG4gKiAjIyBBbmltYXRpb24gSG9va3NcbiAqXG4gKiBBbmltYXRpb25zIGluIG5nRm9ybSBhcmUgdHJpZ2dlcmVkIHdoZW4gYW55IG9mIHRoZSBhc3NvY2lhdGVkIENTUyBjbGFzc2VzIGFyZSBhZGRlZCBhbmQgcmVtb3ZlZC5cbiAqIFRoZXNlIGNsYXNzZXMgYXJlOiBgLm5nLXByaXN0aW5lYCwgYC5uZy1kaXJ0eWAsIGAubmctaW52YWxpZGAgYW5kIGAubmctdmFsaWRgIGFzIHdlbGwgYXMgYW55XG4gKiBvdGhlciB2YWxpZGF0aW9ucyB0aGF0IGFyZSBwZXJmb3JtZWQgd2l0aGluIHRoZSBmb3JtLiBBbmltYXRpb25zIGluIG5nRm9ybSBhcmUgc2ltaWxhciB0byBob3dcbiAqIHRoZXkgd29yayBpbiBuZ0NsYXNzIGFuZCBhbmltYXRpb25zIGNhbiBiZSBob29rZWQgaW50byB1c2luZyBDU1MgdHJhbnNpdGlvbnMsIGtleWZyYW1lcyBhcyB3ZWxsXG4gKiBhcyBKUyBhbmltYXRpb25zLlxuICpcbiAqIFRoZSBmb2xsb3dpbmcgZXhhbXBsZSBzaG93cyBhIHNpbXBsZSB3YXkgdG8gdXRpbGl6ZSBDU1MgdHJhbnNpdGlvbnMgdG8gc3R5bGUgYSBmb3JtIGVsZW1lbnRcbiAqIHRoYXQgaGFzIGJlZW4gcmVuZGVyZWQgYXMgaW52YWxpZCBhZnRlciBpdCBoYXMgYmVlbiB2YWxpZGF0ZWQ6XG4gKlxuICogPHByZT5cbiAqIC8vYmUgc3VyZSB0byBpbmNsdWRlIG5nQW5pbWF0ZSBhcyBhIG1vZHVsZSB0byBob29rIGludG8gbW9yZVxuICogLy9hZHZhbmNlZCBhbmltYXRpb25zXG4gKiAubXktZm9ybSB7XG4gKiAgIHRyYW5zaXRpb246MC41cyBsaW5lYXIgYWxsO1xuICogICBiYWNrZ3JvdW5kOiB3aGl0ZTtcbiAqIH1cbiAqIC5teS1mb3JtLm5nLWludmFsaWQge1xuICogICBiYWNrZ3JvdW5kOiByZWQ7XG4gKiAgIGNvbG9yOndoaXRlO1xuICogfVxuICogPC9wcmU+XG4gKlxuICogQGV4YW1wbGVcbiAgICA8ZXhhbXBsZSBkZXBzPVwiYW5ndWxhci1hbmltYXRlLmpzXCIgYW5pbWF0aW9ucz1cInRydWVcIiBmaXhCYXNlPVwidHJ1ZVwiIG1vZHVsZT1cImZvcm1FeGFtcGxlXCI+XG4gICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxzY3JpcHQ+XG4gICAgICAgICBhbmd1bGFyLm1vZHVsZSgnZm9ybUV4YW1wbGUnLCBbXSlcbiAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0Zvcm1Db250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAgICAkc2NvcGUudXNlclR5cGUgPSAnZ3Vlc3QnO1xuICAgICAgICAgICB9XSk7XG4gICAgICAgPC9zY3JpcHQ+XG4gICAgICAgPHN0eWxlPlxuICAgICAgICAubXktZm9ybSB7XG4gICAgICAgICAgdHJhbnNpdGlvbjphbGwgbGluZWFyIDAuNXM7XG4gICAgICAgICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgLm15LWZvcm0ubmctaW52YWxpZCB7XG4gICAgICAgICAgYmFja2dyb3VuZDogcmVkO1xuICAgICAgICB9XG4gICAgICAgPC9zdHlsZT5cbiAgICAgICA8Zm9ybSBuYW1lPVwibXlGb3JtXCIgbmctY29udHJvbGxlcj1cIkZvcm1Db250cm9sbGVyXCIgY2xhc3M9XCJteS1mb3JtXCI+XG4gICAgICAgICB1c2VyVHlwZTogPGlucHV0IG5hbWU9XCJpbnB1dFwiIG5nLW1vZGVsPVwidXNlclR5cGVcIiByZXF1aXJlZD5cbiAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5yZXF1aXJlZFwiPlJlcXVpcmVkITwvc3Bhbj48YnI+XG4gICAgICAgICA8Y29kZT51c2VyVHlwZSA9IHt7dXNlclR5cGV9fTwvY29kZT48YnI+XG4gICAgICAgICA8Y29kZT5teUZvcm0uaW5wdXQuJHZhbGlkID0ge3tteUZvcm0uaW5wdXQuJHZhbGlkfX08L2NvZGU+PGJyPlxuICAgICAgICAgPGNvZGU+bXlGb3JtLmlucHV0LiRlcnJvciA9IHt7bXlGb3JtLmlucHV0LiRlcnJvcn19PC9jb2RlPjxicj5cbiAgICAgICAgIDxjb2RlPm15Rm9ybS4kdmFsaWQgPSB7e215Rm9ybS4kdmFsaWR9fTwvY29kZT48YnI+XG4gICAgICAgICA8Y29kZT5teUZvcm0uJGVycm9yLnJlcXVpcmVkID0ge3shIW15Rm9ybS4kZXJyb3IucmVxdWlyZWR9fTwvY29kZT48YnI+XG4gICAgICAgIDwvZm9ybT5cbiAgICAgIDwvZmlsZT5cbiAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIHVzZXJUeXBlID0gZWxlbWVudChieS5iaW5kaW5nKCd1c2VyVHlwZScpKTtcbiAgICAgICAgICB2YXIgdmFsaWQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ215Rm9ybS5pbnB1dC4kdmFsaWQnKSk7XG5cbiAgICAgICAgICBleHBlY3QodXNlclR5cGUuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2d1ZXN0Jyk7XG4gICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCd0cnVlJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciB1c2VyVHlwZSA9IGVsZW1lbnQoYnkuYmluZGluZygndXNlclR5cGUnKSk7XG4gICAgICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuICAgICAgICAgIHZhciB1c2VySW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCd1c2VyVHlwZScpKTtcblxuICAgICAgICAgIHVzZXJJbnB1dC5jbGVhcigpO1xuICAgICAgICAgIHVzZXJJbnB1dC5zZW5kS2V5cygnJyk7XG5cbiAgICAgICAgICBleHBlY3QodXNlclR5cGUuZ2V0VGV4dCgpKS50b0VxdWFsKCd1c2VyVHlwZSA9Jyk7XG4gICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdmYWxzZScpO1xuICAgICAgICB9KTtcbiAgICAgIDwvZmlsZT5cbiAgICA8L2V4YW1wbGU+XG4gKlxuICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIE5hbWUgb2YgdGhlIGZvcm0uIElmIHNwZWNpZmllZCwgdGhlIGZvcm0gY29udHJvbGxlciB3aWxsIGJlIHB1Ymxpc2hlZCBpbnRvXG4gKiAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRlZCBzY29wZSwgdW5kZXIgdGhpcyBuYW1lLlxuICovXG52YXIgZm9ybURpcmVjdGl2ZUZhY3RvcnkgPSBmdW5jdGlvbihpc05nRm9ybSkge1xuICByZXR1cm4gWyckdGltZW91dCcsICckcGFyc2UnLCBmdW5jdGlvbigkdGltZW91dCwgJHBhcnNlKSB7XG4gICAgdmFyIGZvcm1EaXJlY3RpdmUgPSB7XG4gICAgICBuYW1lOiAnZm9ybScsXG4gICAgICByZXN0cmljdDogaXNOZ0Zvcm0gPyAnRUFDJyA6ICdFJyxcbiAgICAgIHJlcXVpcmU6IFsnZm9ybScsICdeXj9mb3JtJ10sIC8vZmlyc3QgaXMgdGhlIGZvcm0ncyBvd24gY3RybCwgc2Vjb25kIGlzIGFuIG9wdGlvbmFsIHBhcmVudCBmb3JtXG4gICAgICBjb250cm9sbGVyOiBGb3JtQ29udHJvbGxlcixcbiAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uIG5nRm9ybUNvbXBpbGUoZm9ybUVsZW1lbnQsIGF0dHIpIHtcbiAgICAgICAgLy8gU2V0dXAgaW5pdGlhbCBzdGF0ZSBvZiB0aGUgY29udHJvbFxuICAgICAgICBmb3JtRWxlbWVudC5hZGRDbGFzcyhQUklTVElORV9DTEFTUykuYWRkQ2xhc3MoVkFMSURfQ0xBU1MpO1xuXG4gICAgICAgIHZhciBuYW1lQXR0ciA9IGF0dHIubmFtZSA/ICduYW1lJyA6IChpc05nRm9ybSAmJiBhdHRyLm5nRm9ybSA/ICduZ0Zvcm0nIDogZmFsc2UpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcHJlOiBmdW5jdGlvbiBuZ0Zvcm1QcmVMaW5rKHNjb3BlLCBmb3JtRWxlbWVudCwgYXR0ciwgY3RybHMpIHtcbiAgICAgICAgICAgIHZhciBjb250cm9sbGVyID0gY3RybHNbMF07XG5cbiAgICAgICAgICAgIC8vIGlmIGBhY3Rpb25gIGF0dHIgaXMgbm90IHByZXNlbnQgb24gdGhlIGZvcm0sIHByZXZlbnQgdGhlIGRlZmF1bHQgYWN0aW9uIChzdWJtaXNzaW9uKVxuICAgICAgICAgICAgaWYgKCEoJ2FjdGlvbicgaW4gYXR0cikpIHtcbiAgICAgICAgICAgICAgLy8gd2UgY2FuJ3QgdXNlIGpxIGV2ZW50cyBiZWNhdXNlIGlmIGEgZm9ybSBpcyBkZXN0cm95ZWQgZHVyaW5nIHN1Ym1pc3Npb24gdGhlIGRlZmF1bHRcbiAgICAgICAgICAgICAgLy8gYWN0aW9uIGlzIG5vdCBwcmV2ZW50ZWQuIHNlZSAjMTIzOFxuICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAvLyBJRSA5IGlzIG5vdCBhZmZlY3RlZCBiZWNhdXNlIGl0IGRvZXNuJ3QgZmlyZSBhIHN1Ym1pdCBldmVudCBhbmQgdHJ5IHRvIGRvIGEgZnVsbFxuICAgICAgICAgICAgICAvLyBwYWdlIHJlbG9hZCBpZiB0aGUgZm9ybSB3YXMgZGVzdHJveWVkIGJ5IHN1Ym1pc3Npb24gb2YgdGhlIGZvcm0gdmlhIGEgY2xpY2sgaGFuZGxlclxuICAgICAgICAgICAgICAvLyBvbiBhIGJ1dHRvbiBpbiB0aGUgZm9ybS4gTG9va3MgbGlrZSBhbiBJRTkgc3BlY2lmaWMgYnVnLlxuICAgICAgICAgICAgICB2YXIgaGFuZGxlRm9ybVN1Ym1pc3Npb24gPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuJGNvbW1pdFZpZXdWYWx1ZSgpO1xuICAgICAgICAgICAgICAgICAgY29udHJvbGxlci4kc2V0U3VibWl0dGVkKCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXJGbihmb3JtRWxlbWVudFswXSwgJ3N1Ym1pdCcsIGhhbmRsZUZvcm1TdWJtaXNzaW9uKTtcblxuICAgICAgICAgICAgICAvLyB1bnJlZ2lzdGVyIHRoZSBwcmV2ZW50RGVmYXVsdCBsaXN0ZW5lciBzbyB0aGF0IHdlIGRvbid0IG5vdCBsZWFrIG1lbW9yeSBidXQgaW4gYVxuICAgICAgICAgICAgICAvLyB3YXkgdGhhdCB3aWxsIGFjaGlldmUgdGhlIHByZXZlbnRpb24gb2YgdGhlIGRlZmF1bHQgYWN0aW9uLlxuICAgICAgICAgICAgICBmb3JtRWxlbWVudC5vbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXJGbihmb3JtRWxlbWVudFswXSwgJ3N1Ym1pdCcsIGhhbmRsZUZvcm1TdWJtaXNzaW9uKTtcbiAgICAgICAgICAgICAgICB9LCAwLCBmYWxzZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcGFyZW50Rm9ybUN0cmwgPSBjdHJsc1sxXSB8fCBjb250cm9sbGVyLiQkcGFyZW50Rm9ybTtcbiAgICAgICAgICAgIHBhcmVudEZvcm1DdHJsLiRhZGRDb250cm9sKGNvbnRyb2xsZXIpO1xuXG4gICAgICAgICAgICB2YXIgc2V0dGVyID0gbmFtZUF0dHIgPyBnZXRTZXR0ZXIoY29udHJvbGxlci4kbmFtZSkgOiBub29wO1xuXG4gICAgICAgICAgICBpZiAobmFtZUF0dHIpIHtcbiAgICAgICAgICAgICAgc2V0dGVyKHNjb3BlLCBjb250cm9sbGVyKTtcbiAgICAgICAgICAgICAgYXR0ci4kb2JzZXJ2ZShuYW1lQXR0ciwgZnVuY3Rpb24obmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29udHJvbGxlci4kbmFtZSA9PT0gbmV3VmFsdWUpIHJldHVybjtcbiAgICAgICAgICAgICAgICBzZXR0ZXIoc2NvcGUsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci4kJHBhcmVudEZvcm0uJCRyZW5hbWVDb250cm9sKGNvbnRyb2xsZXIsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBzZXR0ZXIgPSBnZXRTZXR0ZXIoY29udHJvbGxlci4kbmFtZSk7XG4gICAgICAgICAgICAgICAgc2V0dGVyKHNjb3BlLCBjb250cm9sbGVyKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3JtRWxlbWVudC5vbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgY29udHJvbGxlci4kJHBhcmVudEZvcm0uJHJlbW92ZUNvbnRyb2woY29udHJvbGxlcik7XG4gICAgICAgICAgICAgIHNldHRlcihzY29wZSwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgZXh0ZW5kKGNvbnRyb2xsZXIsIG51bGxGb3JtQ3RybCk7IC8vc3RvcCBwcm9wYWdhdGluZyBjaGlsZCBkZXN0cnVjdGlvbiBoYW5kbGVycyB1cHdhcmRzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiBmb3JtRGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gZ2V0U2V0dGVyKGV4cHJlc3Npb24pIHtcbiAgICAgIGlmIChleHByZXNzaW9uID09PSAnJykge1xuICAgICAgICAvL2NyZWF0ZSBhbiBhc3NpZ25hYmxlIGV4cHJlc3Npb24sIHNvIGZvcm1zIHdpdGggYW4gZW1wdHkgbmFtZSBjYW4gYmUgcmVuYW1lZCBsYXRlclxuICAgICAgICByZXR1cm4gJHBhcnNlKCd0aGlzW1wiXCJdJykuYXNzaWduO1xuICAgICAgfVxuICAgICAgcmV0dXJuICRwYXJzZShleHByZXNzaW9uKS5hc3NpZ24gfHwgbm9vcDtcbiAgICB9XG4gIH1dO1xufTtcblxudmFyIGZvcm1EaXJlY3RpdmUgPSBmb3JtRGlyZWN0aXZlRmFjdG9yeSgpO1xudmFyIG5nRm9ybURpcmVjdGl2ZSA9IGZvcm1EaXJlY3RpdmVGYWN0b3J5KHRydWUpO1xuXG4vKiBnbG9iYWwgVkFMSURfQ0xBU1M6IGZhbHNlLFxuICBJTlZBTElEX0NMQVNTOiBmYWxzZSxcbiAgUFJJU1RJTkVfQ0xBU1M6IGZhbHNlLFxuICBESVJUWV9DTEFTUzogZmFsc2UsXG4gIFVOVE9VQ0hFRF9DTEFTUzogZmFsc2UsXG4gIFRPVUNIRURfQ0xBU1M6IGZhbHNlLFxuICBuZ01vZGVsTWluRXJyOiBmYWxzZSxcbiovXG5cbi8vIFJlZ2V4IGNvZGUgaXMgb2J0YWluZWQgZnJvbSBTTzogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzE0MzA3MC9qYXZhc2NyaXB0LXJlZ2V4LWlzby1kYXRldGltZSNhbnN3ZXItMzE0MzIzMVxudmFyIElTT19EQVRFX1JFR0VYUCA9IC9cXGR7NH0tWzAxXVxcZC1bMC0zXVxcZFRbMC0yXVxcZDpbMC01XVxcZDpbMC01XVxcZFxcLlxcZCsoWystXVswLTJdXFxkOlswLTVdXFxkfFopLztcbi8vIFNlZSB2YWxpZCBVUkxzIGluIFJGQzM5ODcgKGh0dHA6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzM5ODcpXG4vLyBOb3RlOiBXZSBhcmUgYmVpbmcgbW9yZSBsZW5pZW50LCBiZWNhdXNlIGJyb3dzZXJzIGFyZSB0b28uXG4vLyAgIDEuIFNjaGVtZVxuLy8gICAyLiBTbGFzaGVzXG4vLyAgIDMuIFVzZXJuYW1lXG4vLyAgIDQuIFBhc3N3b3JkXG4vLyAgIDUuIEhvc3RuYW1lXG4vLyAgIDYuIFBvcnRcbi8vICAgNy4gUGF0aFxuLy8gICA4LiBRdWVyeVxuLy8gICA5LiBGcmFnbWVudFxuLy8gICAgICAgICAgICAgICAgIDExMTExMTExMTExMTExMTEgMjIyICAgMzMzMzMzICAgIDQ0NDQ0ICAgICAgICA1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTUgICAgNjY2ICAgICA3Nzc3Nzc3NyAgICAgODg4ODg4OCAgICAgOTk5XG52YXIgVVJMX1JFR0VYUCA9IC9eW2Etel1bYS16XFxkListXSo6XFwvKig/OlteOkBdKyg/OjpbXkBdKyk/QCk/KD86W15cXHM6Lz8jXSt8XFxbW2EtZlxcZDpdK1xcXSkoPzo6XFxkKyk/KD86XFwvW14/I10qKT8oPzpcXD9bXiNdKik/KD86Iy4qKT8kL2k7XG52YXIgRU1BSUxfUkVHRVhQID0gL15bYS16MC05ISMkJSYnKitcXC89P15fYHt8fX4uLV0rQFthLXowLTldKFthLXowLTktXSpbYS16MC05XSk/KFxcLlthLXowLTldKFthLXowLTktXSpbYS16MC05XSk/KSokL2k7XG52YXIgTlVNQkVSX1JFR0VYUCA9IC9eXFxzKihcXC18XFwrKT8oXFxkK3woXFxkKihcXC5cXGQqKSkpKFtlRV1bKy1dP1xcZCspP1xccyokLztcbnZhciBEQVRFX1JFR0VYUCA9IC9eKFxcZHs0fSktKFxcZHsyfSktKFxcZHsyfSkkLztcbnZhciBEQVRFVElNRUxPQ0FMX1JFR0VYUCA9IC9eKFxcZHs0fSktKFxcZFxcZCktKFxcZFxcZClUKFxcZFxcZCk6KFxcZFxcZCkoPzo6KFxcZFxcZCkoXFwuXFxkezEsM30pPyk/JC87XG52YXIgV0VFS19SRUdFWFAgPSAvXihcXGR7NH0pLVcoXFxkXFxkKSQvO1xudmFyIE1PTlRIX1JFR0VYUCA9IC9eKFxcZHs0fSktKFxcZFxcZCkkLztcbnZhciBUSU1FX1JFR0VYUCA9IC9eKFxcZFxcZCk6KFxcZFxcZCkoPzo6KFxcZFxcZCkoXFwuXFxkezEsM30pPyk/JC87XG5cbnZhciBpbnB1dFR5cGUgPSB7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBpbnB1dFxuICAgKiBAbmFtZSBpbnB1dFt0ZXh0XVxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogU3RhbmRhcmQgSFRNTCB0ZXh0IGlucHV0IHdpdGggYW5ndWxhciBkYXRhIGJpbmRpbmcsIGluaGVyaXRlZCBieSBtb3N0IG9mIHRoZSBgaW5wdXRgIGVsZW1lbnRzLlxuICAgKlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmdNb2RlbCBBc3NpZ25hYmxlIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBkYXRhLWJpbmQgdG8uXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSByZXF1aXJlZCBBZGRzIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIG5vdCBlbnRlcmVkLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG5nUmVxdWlyZWQgQWRkcyBgcmVxdWlyZWRgIGF0dHJpYnV0ZSBhbmQgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGNvbnN0cmFpbnQgdG9cbiAgICogICAgdGhlIGVsZW1lbnQgd2hlbiB0aGUgbmdSZXF1aXJlZCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLiBVc2UgYG5nUmVxdWlyZWRgIGluc3RlYWQgb2ZcbiAgICogICAgYHJlcXVpcmVkYCB3aGVuIHlvdSB3YW50IHRvIGRhdGEtYmluZCB0byB0aGUgYHJlcXVpcmVkYCBhdHRyaWJ1dGUuXG4gICAqIEBwYXJhbSB7bnVtYmVyPX0gbmdNaW5sZW5ndGggU2V0cyBgbWlubGVuZ3RoYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgc2hvcnRlciB0aGFuXG4gICAqICAgIG1pbmxlbmd0aC5cbiAgICogQHBhcmFtIHtudW1iZXI9fSBuZ01heGxlbmd0aCBTZXRzIGBtYXhsZW5ndGhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBsb25nZXIgdGhhblxuICAgKiAgICBtYXhsZW5ndGguIFNldHRpbmcgdGhlIGF0dHJpYnV0ZSB0byBhIG5lZ2F0aXZlIG9yIG5vbi1udW1lcmljIHZhbHVlLCBhbGxvd3MgdmlldyB2YWx1ZXMgb2ZcbiAgICogICAgYW55IGxlbmd0aC5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBwYXR0ZXJuIFNpbWlsYXIgdG8gYG5nUGF0dGVybmAgZXhjZXB0IHRoYXQgdGhlIGF0dHJpYnV0ZSB2YWx1ZSBpcyB0aGUgYWN0dWFsIHN0cmluZ1xuICAgKiAgICB0aGF0IGNvbnRhaW5zIHRoZSByZWd1bGFyIGV4cHJlc3Npb24gYm9keSB0aGF0IHdpbGwgYmUgY29udmVydGVkIHRvIGEgcmVndWxhciBleHByZXNzaW9uXG4gICAqICAgIGFzIGluIHRoZSBuZ1BhdHRlcm4gZGlyZWN0aXZlLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG5nUGF0dGVybiBTZXRzIGBwYXR0ZXJuYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgbmdNb2RlbCB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmlld1ZhbHVlICR2aWV3VmFsdWV9XG4gICAqICAgIGRvZXMgbm90IG1hdGNoIGEgUmVnRXhwIGZvdW5kIGJ5IGV2YWx1YXRpbmcgdGhlIEFuZ3VsYXIgZXhwcmVzc2lvbiBnaXZlbiBpbiB0aGUgYXR0cmlidXRlIHZhbHVlLlxuICAgKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBSZWdFeHAgb2JqZWN0LCB0aGVuIHRoaXMgaXMgdXNlZCBkaXJlY3RseS5cbiAgICogICAgSWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgc3RyaW5nLCB0aGVuIGl0IHdpbGwgYmUgY29udmVydGVkIHRvIGEgUmVnRXhwXG4gICAqICAgIGFmdGVyIHdyYXBwaW5nIGl0IGluIGBeYCBhbmQgYCRgIGNoYXJhY3RlcnMuIEZvciBpbnN0YW5jZSwgYFwiYWJjXCJgIHdpbGwgYmUgY29udmVydGVkIHRvXG4gICAqICAgIGBuZXcgUmVnRXhwKCdeYWJjJCcpYC48YnIgLz5cbiAgICogICAgKipOb3RlOioqIEF2b2lkIHVzaW5nIHRoZSBgZ2AgZmxhZyBvbiB0aGUgUmVnRXhwLCBhcyBpdCB3aWxsIGNhdXNlIGVhY2ggc3VjY2Vzc2l2ZSBzZWFyY2ggdG9cbiAgICogICAgc3RhcnQgYXQgdGhlIGluZGV4IG9mIHRoZSBsYXN0IHNlYXJjaCdzIG1hdGNoLCB0aHVzIG5vdCB0YWtpbmcgdGhlIHdob2xlIGlucHV0IHZhbHVlIGludG9cbiAgICogICAgYWNjb3VudC5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ0NoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyXG4gICAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IFtuZ1RyaW09dHJ1ZV0gSWYgc2V0IHRvIGZhbHNlIEFuZ3VsYXIgd2lsbCBub3QgYXV0b21hdGljYWxseSB0cmltIHRoZSBpbnB1dC5cbiAgICogICAgVGhpcyBwYXJhbWV0ZXIgaXMgaWdub3JlZCBmb3IgaW5wdXRbdHlwZT1wYXNzd29yZF0gY29udHJvbHMsIHdoaWNoIHdpbGwgbmV2ZXIgdHJpbSB0aGVcbiAgICogICAgaW5wdXQuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAgICA8ZXhhbXBsZSBuYW1lPVwidGV4dC1pbnB1dC1kaXJlY3RpdmVcIiBtb2R1bGU9XCJ0ZXh0SW5wdXRFeGFtcGxlXCI+XG4gICAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgICA8c2NyaXB0PlxuICAgICAgICAgICBhbmd1bGFyLm1vZHVsZSgndGV4dElucHV0RXhhbXBsZScsIFtdKVxuICAgICAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgICAgICAkc2NvcGUuZXhhbXBsZSA9IHtcbiAgICAgICAgICAgICAgICAgdGV4dDogJ2d1ZXN0JyxcbiAgICAgICAgICAgICAgICAgd29yZDogL15cXHMqXFx3KlxccyokL1xuICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICB9XSk7XG4gICAgICAgICA8L3NjcmlwdD5cbiAgICAgICAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiAgICAgICAgICAgPGxhYmVsPlNpbmdsZSB3b3JkOlxuICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJpbnB1dFwiIG5nLW1vZGVsPVwiZXhhbXBsZS50ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgbmctcGF0dGVybj1cImV4YW1wbGUud29yZFwiIHJlcXVpcmVkIG5nLXRyaW09XCJmYWxzZVwiPlxuICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICA8ZGl2IHJvbGU9XCJhbGVydFwiPlxuICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5yZXF1aXJlZFwiPlxuICAgICAgICAgICAgICAgUmVxdWlyZWQhPC9zcGFuPlxuICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5wYXR0ZXJuXCI+XG4gICAgICAgICAgICAgICBTaW5nbGUgd29yZCBvbmx5ITwvc3Bhbj5cbiAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgIDx0dD50ZXh0ID0ge3tleGFtcGxlLnRleHR9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kdmFsaWQgPSB7e215Rm9ybS5pbnB1dC4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kZXJyb3IgPSB7e215Rm9ybS5pbnB1dC4kZXJyb3J9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS4kdmFsaWQgPSB7e215Rm9ybS4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IucmVxdWlyZWQgPSB7eyEhbXlGb3JtLiRlcnJvci5yZXF1aXJlZH19PC90dD48YnIvPlxuICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgPC9maWxlPlxuICAgICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgICAgdmFyIHRleHQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2V4YW1wbGUudGV4dCcpKTtcbiAgICAgICAgICB2YXIgdmFsaWQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ215Rm9ybS5pbnB1dC4kdmFsaWQnKSk7XG4gICAgICAgICAgdmFyIGlucHV0ID0gZWxlbWVudChieS5tb2RlbCgnZXhhbXBsZS50ZXh0JykpO1xuXG4gICAgICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBleHBlY3QodGV4dC5nZXRUZXh0KCkpLnRvQ29udGFpbignZ3Vlc3QnKTtcbiAgICAgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbigndHJ1ZScpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIGVtcHR5JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpbnB1dC5jbGVhcigpO1xuICAgICAgICAgICAgaW5wdXQuc2VuZEtleXMoJycpO1xuXG4gICAgICAgICAgICBleHBlY3QodGV4dC5nZXRUZXh0KCkpLnRvRXF1YWwoJ3RleHQgPScpO1xuICAgICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdmYWxzZScpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIG11bHRpIHdvcmQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlucHV0LmNsZWFyKCk7XG4gICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygnaGVsbG8gd29ybGQnKTtcblxuICAgICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdmYWxzZScpO1xuICAgICAgICAgIH0pO1xuICAgICAgICA8L2ZpbGU+XG4gICAgICA8L2V4YW1wbGU+XG4gICAqL1xuICAndGV4dCc6IHRleHRJbnB1dFR5cGUsXG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgaW5wdXRcbiAgICAgKiBAbmFtZSBpbnB1dFtkYXRlXVxuICAgICAqXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICogSW5wdXQgd2l0aCBkYXRlIHZhbGlkYXRpb24gYW5kIHRyYW5zZm9ybWF0aW9uLiBJbiBicm93c2VycyB0aGF0IGRvIG5vdCB5ZXQgc3VwcG9ydFxuICAgICAqIHRoZSBIVE1MNSBkYXRlIGlucHV0LCBhIHRleHQgZWxlbWVudCB3aWxsIGJlIHVzZWQuIEluIHRoYXQgY2FzZSwgdGV4dCBtdXN0IGJlIGVudGVyZWQgaW4gYSB2YWxpZCBJU08tODYwMVxuICAgICAqIGRhdGUgZm9ybWF0ICh5eXl5LU1NLWRkKSwgZm9yIGV4YW1wbGU6IGAyMDA5LTAxLTA2YC4gU2luY2UgbWFueVxuICAgICAqIG1vZGVybiBicm93c2VycyBkbyBub3QgeWV0IHN1cHBvcnQgdGhpcyBpbnB1dCB0eXBlLCBpdCBpcyBpbXBvcnRhbnQgdG8gcHJvdmlkZSBjdWVzIHRvIHVzZXJzIG9uIHRoZVxuICAgICAqIGV4cGVjdGVkIGlucHV0IGZvcm1hdCB2aWEgYSBwbGFjZWhvbGRlciBvciBsYWJlbC5cbiAgICAgKlxuICAgICAqIFRoZSBtb2RlbCBtdXN0IGFsd2F5cyBiZSBhIERhdGUgb2JqZWN0LCBvdGhlcndpc2UgQW5ndWxhciB3aWxsIHRocm93IGFuIGVycm9yLlxuICAgICAqIEludmFsaWQgYERhdGVgIG9iamVjdHMgKGRhdGVzIHdob3NlIGBnZXRUaW1lKClgIGlzIGBOYU5gKSB3aWxsIGJlIHJlbmRlcmVkIGFzIGFuIGVtcHR5IHN0cmluZy5cbiAgICAgKlxuICAgICAqIFRoZSB0aW1lem9uZSB0byBiZSB1c2VkIHRvIHJlYWQvd3JpdGUgdGhlIGBEYXRlYCBpbnN0YW5jZSBpbiB0aGUgbW9kZWwgY2FuIGJlIGRlZmluZWQgdXNpbmdcbiAgICAgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nTW9kZWxPcHRpb25zIG5nTW9kZWxPcHRpb25zfS4gQnkgZGVmYXVsdCwgdGhpcyBpcyB0aGUgdGltZXpvbmUgb2YgdGhlIGJyb3dzZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmdNb2RlbCBBc3NpZ25hYmxlIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBkYXRhLWJpbmQgdG8uXG4gICAgICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gbWluIFNldHMgdGhlIGBtaW5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBlbnRlcmVkIGlzIGxlc3MgdGhhbiBgbWluYC4gVGhpcyBtdXN0IGJlIGFcbiAgICAgKiAgIHZhbGlkIElTTyBkYXRlIHN0cmluZyAoeXl5eS1NTS1kZCkuIFlvdSBjYW4gYWxzbyB1c2UgaW50ZXJwb2xhdGlvbiBpbnNpZGUgdGhpcyBhdHRyaWJ1dGVcbiAgICAgKiAgIChlLmcuIGBtaW49XCJ7e21pbkRhdGUgfCBkYXRlOid5eXl5LU1NLWRkJ319XCJgKS4gTm90ZSB0aGF0IGBtaW5gIHdpbGwgYWxzbyBhZGQgbmF0aXZlIEhUTUw1XG4gICAgICogICBjb25zdHJhaW50IHZhbGlkYXRpb24uXG4gICAgICogQHBhcmFtIHtzdHJpbmc9fSBtYXggU2V0cyB0aGUgYG1heGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGVudGVyZWQgaXMgZ3JlYXRlciB0aGFuIGBtYXhgLiBUaGlzIG11c3QgYmVcbiAgICAgKiAgIGEgdmFsaWQgSVNPIGRhdGUgc3RyaW5nICh5eXl5LU1NLWRkKS4gWW91IGNhbiBhbHNvIHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSB0aGlzIGF0dHJpYnV0ZVxuICAgICAqICAgKGUuZy4gYG1heD1cInt7bWF4RGF0ZSB8IGRhdGU6J3l5eXktTU0tZGQnfX1cImApLiBOb3RlIHRoYXQgYG1heGAgd2lsbCBhbHNvIGFkZCBuYXRpdmUgSFRNTDVcbiAgICAgKiAgIGNvbnN0cmFpbnQgdmFsaWRhdGlvbi5cbiAgICAgKiBAcGFyYW0geyhkYXRlfHN0cmluZyk9fSBuZ01pbiBTZXRzIHRoZSBgbWluYCB2YWxpZGF0aW9uIGNvbnN0cmFpbnQgdG8gdGhlIERhdGUgLyBJU08gZGF0ZSBzdHJpbmdcbiAgICAgKiAgIHRoZSBgbmdNaW5gIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvLiBOb3RlIHRoYXQgaXQgZG9lcyBub3Qgc2V0IHRoZSBgbWluYCBhdHRyaWJ1dGUuXG4gICAgICogQHBhcmFtIHsoZGF0ZXxzdHJpbmcpPX0gbmdNYXggU2V0cyB0aGUgYG1heGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvIHRoZSBEYXRlIC8gSVNPIGRhdGUgc3RyaW5nXG4gICAgICogICB0aGUgYG5nTWF4YCBleHByZXNzaW9uIGV2YWx1YXRlcyB0by4gTm90ZSB0aGF0IGl0IGRvZXMgbm90IHNldCB0aGUgYG1heGAgYXR0cmlidXRlLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gcmVxdWlyZWQgU2V0cyBgcmVxdWlyZWRgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBub3QgZW50ZXJlZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZz19IG5nUmVxdWlyZWQgQWRkcyBgcmVxdWlyZWRgIGF0dHJpYnV0ZSBhbmQgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGNvbnN0cmFpbnQgdG9cbiAgICAgKiAgICB0aGUgZWxlbWVudCB3aGVuIHRoZSBuZ1JlcXVpcmVkIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIHRydWUuIFVzZSBgbmdSZXF1aXJlZGAgaW5zdGVhZCBvZlxuICAgICAqICAgIGByZXF1aXJlZGAgd2hlbiB5b3Ugd2FudCB0byBkYXRhLWJpbmQgdG8gdGhlIGByZXF1aXJlZGAgYXR0cmlidXRlLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdDaGFuZ2UgQW5ndWxhciBleHByZXNzaW9uIHRvIGJlIGV4ZWN1dGVkIHdoZW4gaW5wdXQgY2hhbmdlcyBkdWUgdG8gdXNlclxuICAgICAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICA8ZXhhbXBsZSBuYW1lPVwiZGF0ZS1pbnB1dC1kaXJlY3RpdmVcIiBtb2R1bGU9XCJkYXRlSW5wdXRFeGFtcGxlXCI+XG4gICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgPHNjcmlwdD5cbiAgICAgICAgICBhbmd1bGFyLm1vZHVsZSgnZGF0ZUlucHV0RXhhbXBsZScsIFtdKVxuICAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0RhdGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAgICAgJHNjb3BlLmV4YW1wbGUgPSB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IG5ldyBEYXRlKDIwMTMsIDksIDIyKVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfV0pO1xuICAgICAgIDwvc2NyaXB0PlxuICAgICAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIiBuZy1jb250cm9sbGVyPVwiRGF0ZUNvbnRyb2xsZXIgYXMgZGF0ZUN0cmxcIj5cbiAgICAgICAgICA8bGFiZWwgZm9yPVwiZXhhbXBsZUlucHV0XCI+UGljayBhIGRhdGUgaW4gMjAxMzo8L2xhYmVsPlxuICAgICAgICAgIDxpbnB1dCB0eXBlPVwiZGF0ZVwiIGlkPVwiZXhhbXBsZUlucHV0XCIgbmFtZT1cImlucHV0XCIgbmctbW9kZWw9XCJleGFtcGxlLnZhbHVlXCJcbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJ5eXl5LU1NLWRkXCIgbWluPVwiMjAxMy0wMS0wMVwiIG1heD1cIjIwMTMtMTItMzFcIiByZXF1aXJlZCAvPlxuICAgICAgICAgIDxkaXYgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS5pbnB1dC4kZXJyb3IucmVxdWlyZWRcIj5cbiAgICAgICAgICAgICAgICBSZXF1aXJlZCE8L3NwYW4+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS5pbnB1dC4kZXJyb3IuZGF0ZVwiPlxuICAgICAgICAgICAgICAgIE5vdCBhIHZhbGlkIGRhdGUhPC9zcGFuPlxuICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgPHR0PnZhbHVlID0ge3tleGFtcGxlLnZhbHVlIHwgZGF0ZTogXCJ5eXl5LU1NLWRkXCJ9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kdmFsaWQgPSB7e215Rm9ybS5pbnB1dC4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kZXJyb3IgPSB7e215Rm9ybS5pbnB1dC4kZXJyb3J9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS4kdmFsaWQgPSB7e215Rm9ybS4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IucmVxdWlyZWQgPSB7eyEhbXlGb3JtLiRlcnJvci5yZXF1aXJlZH19PC90dD48YnIvPlxuICAgICAgIDwvZm9ybT5cbiAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQoYnkuYmluZGluZygnZXhhbXBsZS52YWx1ZSB8IGRhdGU6IFwieXl5eS1NTS1kZFwiJykpO1xuICAgICAgICB2YXIgdmFsaWQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ215Rm9ybS5pbnB1dC4kdmFsaWQnKSk7XG4gICAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ2V4YW1wbGUudmFsdWUnKSk7XG5cbiAgICAgICAgLy8gY3VycmVudGx5IHByb3RyYWN0b3Ivd2ViZHJpdmVyIGRvZXMgbm90IHN1cHBvcnRcbiAgICAgICAgLy8gc2VuZGluZyBrZXlzIHRvIGFsbCBrbm93biBIVE1MNSBpbnB1dCBjb250cm9sc1xuICAgICAgICAvLyBmb3IgdmFyaW91cyBicm93c2VycyAoc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL3Byb3RyYWN0b3IvaXNzdWVzLzU2MikuXG4gICAgICAgIGZ1bmN0aW9uIHNldElucHV0KHZhbCkge1xuICAgICAgICAgIC8vIHNldCB0aGUgdmFsdWUgb2YgdGhlIGVsZW1lbnQgYW5kIGZvcmNlIHZhbGlkYXRpb24uXG4gICAgICAgICAgdmFyIHNjciA9IFwidmFyIGlwdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGFtcGxlSW5wdXQnKTsgXCIgK1xuICAgICAgICAgIFwiaXB0LnZhbHVlID0gJ1wiICsgdmFsICsgXCInO1wiICtcbiAgICAgICAgICBcImFuZ3VsYXIuZWxlbWVudChpcHQpLnNjb3BlKCkuJGFwcGx5KGZ1bmN0aW9uKHMpIHsgcy5teUZvcm1baXB0Lm5hbWVdLiRzZXRWaWV3VmFsdWUoJ1wiICsgdmFsICsgXCInKTsgfSk7XCI7XG4gICAgICAgICAgYnJvd3Nlci5leGVjdXRlU2NyaXB0KHNjcik7XG4gICAgICAgIH1cblxuICAgICAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgdG8gbW9kZWwnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJzIwMTMtMTAtMjInKTtcbiAgICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ215Rm9ybS5pbnB1dC4kdmFsaWQgPSB0cnVlJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHNldElucHV0KCcnKTtcbiAgICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0VxdWFsKCd2YWx1ZSA9Jyk7XG4gICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gZmFsc2UnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIG92ZXIgbWF4JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgc2V0SW5wdXQoJzIwMTUtMDEtMDEnKTtcbiAgICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJycpO1xuICAgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignbXlGb3JtLmlucHV0LiR2YWxpZCA9IGZhbHNlJyk7XG4gICAgICAgIH0pO1xuICAgICA8L2ZpbGU+XG4gICAgIDwvZXhhbXBsZT5cbiAgICAgKi9cbiAgJ2RhdGUnOiBjcmVhdGVEYXRlSW5wdXRUeXBlKCdkYXRlJywgREFURV9SRUdFWFAsXG4gICAgICAgICBjcmVhdGVEYXRlUGFyc2VyKERBVEVfUkVHRVhQLCBbJ3l5eXknLCAnTU0nLCAnZGQnXSksXG4gICAgICAgICAneXl5eS1NTS1kZCcpLFxuXG4gICAvKipcbiAgICAqIEBuZ2RvYyBpbnB1dFxuICAgICogQG5hbWUgaW5wdXRbZGF0ZXRpbWUtbG9jYWxdXG4gICAgKlxuICAgICogQGRlc2NyaXB0aW9uXG4gICAgKiBJbnB1dCB3aXRoIGRhdGV0aW1lIHZhbGlkYXRpb24gYW5kIHRyYW5zZm9ybWF0aW9uLiBJbiBicm93c2VycyB0aGF0IGRvIG5vdCB5ZXQgc3VwcG9ydFxuICAgICogdGhlIEhUTUw1IGRhdGUgaW5wdXQsIGEgdGV4dCBlbGVtZW50IHdpbGwgYmUgdXNlZC4gSW4gdGhhdCBjYXNlLCB0aGUgdGV4dCBtdXN0IGJlIGVudGVyZWQgaW4gYSB2YWxpZCBJU08tODYwMVxuICAgICogbG9jYWwgZGF0ZXRpbWUgZm9ybWF0ICh5eXl5LU1NLWRkVEhIOm1tOnNzKSwgZm9yIGV4YW1wbGU6IGAyMDEwLTEyLTI4VDE0OjU3OjAwYC5cbiAgICAqXG4gICAgKiBUaGUgbW9kZWwgbXVzdCBhbHdheXMgYmUgYSBEYXRlIG9iamVjdCwgb3RoZXJ3aXNlIEFuZ3VsYXIgd2lsbCB0aHJvdyBhbiBlcnJvci5cbiAgICAqIEludmFsaWQgYERhdGVgIG9iamVjdHMgKGRhdGVzIHdob3NlIGBnZXRUaW1lKClgIGlzIGBOYU5gKSB3aWxsIGJlIHJlbmRlcmVkIGFzIGFuIGVtcHR5IHN0cmluZy5cbiAgICAqXG4gICAgKiBUaGUgdGltZXpvbmUgdG8gYmUgdXNlZCB0byByZWFkL3dyaXRlIHRoZSBgRGF0ZWAgaW5zdGFuY2UgaW4gdGhlIG1vZGVsIGNhbiBiZSBkZWZpbmVkIHVzaW5nXG4gICAgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nTW9kZWxPcHRpb25zIG5nTW9kZWxPcHRpb25zfS4gQnkgZGVmYXVsdCwgdGhpcyBpcyB0aGUgdGltZXpvbmUgb2YgdGhlIGJyb3dzZXIuXG4gICAgKlxuICAgICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuICAgICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxuICAgICogQHBhcmFtIHtzdHJpbmc9fSBtaW4gU2V0cyB0aGUgYG1pbmAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGVudGVyZWQgaXMgbGVzcyB0aGFuIGBtaW5gLlxuICAgICogICBUaGlzIG11c3QgYmUgYSB2YWxpZCBJU08gZGF0ZXRpbWUgZm9ybWF0ICh5eXl5LU1NLWRkVEhIOm1tOnNzKS4gWW91IGNhbiBhbHNvIHVzZSBpbnRlcnBvbGF0aW9uXG4gICAgKiAgIGluc2lkZSB0aGlzIGF0dHJpYnV0ZSAoZS5nLiBgbWluPVwie3ttaW5EYXRldGltZUxvY2FsIHwgZGF0ZToneXl5eS1NTS1kZFRISDptbTpzcyd9fVwiYCkuXG4gICAgKiAgIE5vdGUgdGhhdCBgbWluYCB3aWxsIGFsc28gYWRkIG5hdGl2ZSBIVE1MNSBjb25zdHJhaW50IHZhbGlkYXRpb24uXG4gICAgKiBAcGFyYW0ge3N0cmluZz19IG1heCBTZXRzIHRoZSBgbWF4YCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgZW50ZXJlZCBpcyBncmVhdGVyIHRoYW4gYG1heGAuXG4gICAgKiAgIFRoaXMgbXVzdCBiZSBhIHZhbGlkIElTTyBkYXRldGltZSBmb3JtYXQgKHl5eXktTU0tZGRUSEg6bW06c3MpLiBZb3UgY2FuIGFsc28gdXNlIGludGVycG9sYXRpb25cbiAgICAqICAgaW5zaWRlIHRoaXMgYXR0cmlidXRlIChlLmcuIGBtYXg9XCJ7e21heERhdGV0aW1lTG9jYWwgfCBkYXRlOid5eXl5LU1NLWRkVEhIOm1tOnNzJ319XCJgKS5cbiAgICAqICAgTm90ZSB0aGF0IGBtYXhgIHdpbGwgYWxzbyBhZGQgbmF0aXZlIEhUTUw1IGNvbnN0cmFpbnQgdmFsaWRhdGlvbi5cbiAgICAqIEBwYXJhbSB7KGRhdGV8c3RyaW5nKT19IG5nTWluIFNldHMgdGhlIGBtaW5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IHRvIHRoZSBEYXRlIC8gSVNPIGRhdGV0aW1lIHN0cmluZ1xuICAgICogICB0aGUgYG5nTWluYCBleHByZXNzaW9uIGV2YWx1YXRlcyB0by4gTm90ZSB0aGF0IGl0IGRvZXMgbm90IHNldCB0aGUgYG1pbmAgYXR0cmlidXRlLlxuICAgICogQHBhcmFtIHsoZGF0ZXxzdHJpbmcpPX0gbmdNYXggU2V0cyB0aGUgYG1heGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgdG8gdGhlIERhdGUgLyBJU08gZGF0ZXRpbWUgc3RyaW5nXG4gICAgKiAgIHRoZSBgbmdNYXhgIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvLiBOb3RlIHRoYXQgaXQgZG9lcyBub3Qgc2V0IHRoZSBgbWF4YCBhdHRyaWJ1dGUuXG4gICAgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG4gICAgKiBAcGFyYW0ge3N0cmluZz19IG5nUmVxdWlyZWQgQWRkcyBgcmVxdWlyZWRgIGF0dHJpYnV0ZSBhbmQgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGNvbnN0cmFpbnQgdG9cbiAgICAqICAgIHRoZSBlbGVtZW50IHdoZW4gdGhlIG5nUmVxdWlyZWQgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gdHJ1ZS4gVXNlIGBuZ1JlcXVpcmVkYCBpbnN0ZWFkIG9mXG4gICAgKiAgICBgcmVxdWlyZWRgIHdoZW4geW91IHdhbnQgdG8gZGF0YS1iaW5kIHRvIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0ZS5cbiAgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdDaGFuZ2UgQW5ndWxhciBleHByZXNzaW9uIHRvIGJlIGV4ZWN1dGVkIHdoZW4gaW5wdXQgY2hhbmdlcyBkdWUgdG8gdXNlclxuICAgICogICAgaW50ZXJhY3Rpb24gd2l0aCB0aGUgaW5wdXQgZWxlbWVudC5cbiAgICAqXG4gICAgKiBAZXhhbXBsZVxuICAgIDxleGFtcGxlIG5hbWU9XCJkYXRldGltZWxvY2FsLWlucHV0LWRpcmVjdGl2ZVwiIG1vZHVsZT1cImRhdGVFeGFtcGxlXCI+XG4gICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxzY3JpcHQ+XG4gICAgICAgIGFuZ3VsYXIubW9kdWxlKCdkYXRlRXhhbXBsZScsIFtdKVxuICAgICAgICAgIC5jb250cm9sbGVyKCdEYXRlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgICAkc2NvcGUuZXhhbXBsZSA9IHtcbiAgICAgICAgICAgICAgdmFsdWU6IG5ldyBEYXRlKDIwMTAsIDExLCAyOCwgMTQsIDU3KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XSk7XG4gICAgICA8L3NjcmlwdD5cbiAgICAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIiBuZy1jb250cm9sbGVyPVwiRGF0ZUNvbnRyb2xsZXIgYXMgZGF0ZUN0cmxcIj5cbiAgICAgICAgPGxhYmVsIGZvcj1cImV4YW1wbGVJbnB1dFwiPlBpY2sgYSBkYXRlIGJldHdlZW4gaW4gMjAxMzo8L2xhYmVsPlxuICAgICAgICA8aW5wdXQgdHlwZT1cImRhdGV0aW1lLWxvY2FsXCIgaWQ9XCJleGFtcGxlSW5wdXRcIiBuYW1lPVwiaW5wdXRcIiBuZy1tb2RlbD1cImV4YW1wbGUudmFsdWVcIlxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJ5eXl5LU1NLWRkVEhIOm1tOnNzXCIgbWluPVwiMjAwMS0wMS0wMVQwMDowMDowMFwiIG1heD1cIjIwMTMtMTItMzFUMDA6MDA6MDBcIiByZXF1aXJlZCAvPlxuICAgICAgICA8ZGl2IHJvbGU9XCJhbGVydFwiPlxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5yZXF1aXJlZFwiPlxuICAgICAgICAgICAgICBSZXF1aXJlZCE8L3NwYW4+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLmRhdGV0aW1lbG9jYWxcIj5cbiAgICAgICAgICAgICAgTm90IGEgdmFsaWQgZGF0ZSE8L3NwYW4+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8dHQ+dmFsdWUgPSB7e2V4YW1wbGUudmFsdWUgfCBkYXRlOiBcInl5eXktTU0tZGRUSEg6bW06c3NcIn19PC90dD48YnIvPlxuICAgICAgICA8dHQ+bXlGb3JtLmlucHV0LiR2YWxpZCA9IHt7bXlGb3JtLmlucHV0LiR2YWxpZH19PC90dD48YnIvPlxuICAgICAgICA8dHQ+bXlGb3JtLmlucHV0LiRlcnJvciA9IHt7bXlGb3JtLmlucHV0LiRlcnJvcn19PC90dD48YnIvPlxuICAgICAgICA8dHQ+bXlGb3JtLiR2YWxpZCA9IHt7bXlGb3JtLiR2YWxpZH19PC90dD48YnIvPlxuICAgICAgICA8dHQ+bXlGb3JtLiRlcnJvci5yZXF1aXJlZCA9IHt7ISFteUZvcm0uJGVycm9yLnJlcXVpcmVkfX08L3R0Pjxici8+XG4gICAgICA8L2Zvcm0+XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQoYnkuYmluZGluZygnZXhhbXBsZS52YWx1ZSB8IGRhdGU6IFwieXl5eS1NTS1kZFRISDptbTpzc1wiJykpO1xuICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuICAgICAgdmFyIGlucHV0ID0gZWxlbWVudChieS5tb2RlbCgnZXhhbXBsZS52YWx1ZScpKTtcblxuICAgICAgLy8gY3VycmVudGx5IHByb3RyYWN0b3Ivd2ViZHJpdmVyIGRvZXMgbm90IHN1cHBvcnRcbiAgICAgIC8vIHNlbmRpbmcga2V5cyB0byBhbGwga25vd24gSFRNTDUgaW5wdXQgY29udHJvbHNcbiAgICAgIC8vIGZvciB2YXJpb3VzIGJyb3dzZXJzIChodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9wcm90cmFjdG9yL2lzc3Vlcy81NjIpLlxuICAgICAgZnVuY3Rpb24gc2V0SW5wdXQodmFsKSB7XG4gICAgICAgIC8vIHNldCB0aGUgdmFsdWUgb2YgdGhlIGVsZW1lbnQgYW5kIGZvcmNlIHZhbGlkYXRpb24uXG4gICAgICAgIHZhciBzY3IgPSBcInZhciBpcHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhhbXBsZUlucHV0Jyk7IFwiICtcbiAgICAgICAgXCJpcHQudmFsdWUgPSAnXCIgKyB2YWwgKyBcIic7XCIgK1xuICAgICAgICBcImFuZ3VsYXIuZWxlbWVudChpcHQpLnNjb3BlKCkuJGFwcGx5KGZ1bmN0aW9uKHMpIHsgcy5teUZvcm1baXB0Lm5hbWVdLiRzZXRWaWV3VmFsdWUoJ1wiICsgdmFsICsgXCInKTsgfSk7XCI7XG4gICAgICAgIGJyb3dzZXIuZXhlY3V0ZVNjcmlwdChzY3IpO1xuICAgICAgfVxuXG4gICAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgdG8gbW9kZWwnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9Db250YWluKCcyMDEwLTEyLTI4VDE0OjU3OjAwJyk7XG4gICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignbXlGb3JtLmlucHV0LiR2YWxpZCA9IHRydWUnKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgZW1wdHknLCBmdW5jdGlvbigpIHtcbiAgICAgICAgc2V0SW5wdXQoJycpO1xuICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0VxdWFsKCd2YWx1ZSA9Jyk7XG4gICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignbXlGb3JtLmlucHV0LiR2YWxpZCA9IGZhbHNlJyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIG92ZXIgbWF4JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNldElucHV0KCcyMDE1LTAxLTAxVDIzOjU5OjAwJyk7XG4gICAgICAgIGV4cGVjdCh2YWx1ZS5nZXRUZXh0KCkpLnRvQ29udGFpbignJyk7XG4gICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignbXlGb3JtLmlucHV0LiR2YWxpZCA9IGZhbHNlJyk7XG4gICAgICB9KTtcbiAgICA8L2ZpbGU+XG4gICAgPC9leGFtcGxlPlxuICAgICovXG4gICdkYXRldGltZS1sb2NhbCc6IGNyZWF0ZURhdGVJbnB1dFR5cGUoJ2RhdGV0aW1lbG9jYWwnLCBEQVRFVElNRUxPQ0FMX1JFR0VYUCxcbiAgICAgIGNyZWF0ZURhdGVQYXJzZXIoREFURVRJTUVMT0NBTF9SRUdFWFAsIFsneXl5eScsICdNTScsICdkZCcsICdISCcsICdtbScsICdzcycsICdzc3MnXSksXG4gICAgICAneXl5eS1NTS1kZFRISDptbTpzcy5zc3MnKSxcblxuICAvKipcbiAgICogQG5nZG9jIGlucHV0XG4gICAqIEBuYW1lIGlucHV0W3RpbWVdXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBJbnB1dCB3aXRoIHRpbWUgdmFsaWRhdGlvbiBhbmQgdHJhbnNmb3JtYXRpb24uIEluIGJyb3dzZXJzIHRoYXQgZG8gbm90IHlldCBzdXBwb3J0XG4gICAqIHRoZSBIVE1MNSB0aW1lIGlucHV0LCBhIHRleHQgZWxlbWVudCB3aWxsIGJlIHVzZWQuIEluIHRoYXQgY2FzZSwgdGhlIHRleHQgbXVzdCBiZSBlbnRlcmVkIGluIGEgdmFsaWQgSVNPLTg2MDFcbiAgICogbG9jYWwgdGltZSBmb3JtYXQgKEhIOm1tOnNzKSwgZm9yIGV4YW1wbGU6IGAxNDo1NzowMGAuIE1vZGVsIG11c3QgYmUgYSBEYXRlIG9iamVjdC4gVGhpcyBiaW5kaW5nIHdpbGwgYWx3YXlzIG91dHB1dCBhXG4gICAqIERhdGUgb2JqZWN0IHRvIHRoZSBtb2RlbCBvZiBKYW51YXJ5IDEsIDE5NzAsIG9yIGxvY2FsIGRhdGUgYG5ldyBEYXRlKDE5NzAsIDAsIDEsIEhILCBtbSwgc3MpYC5cbiAgICpcbiAgICogVGhlIG1vZGVsIG11c3QgYWx3YXlzIGJlIGEgRGF0ZSBvYmplY3QsIG90aGVyd2lzZSBBbmd1bGFyIHdpbGwgdGhyb3cgYW4gZXJyb3IuXG4gICAqIEludmFsaWQgYERhdGVgIG9iamVjdHMgKGRhdGVzIHdob3NlIGBnZXRUaW1lKClgIGlzIGBOYU5gKSB3aWxsIGJlIHJlbmRlcmVkIGFzIGFuIGVtcHR5IHN0cmluZy5cbiAgICpcbiAgICogVGhlIHRpbWV6b25lIHRvIGJlIHVzZWQgdG8gcmVhZC93cml0ZSB0aGUgYERhdGVgIGluc3RhbmNlIGluIHRoZSBtb2RlbCBjYW4gYmUgZGVmaW5lZCB1c2luZ1xuICAgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nTW9kZWxPcHRpb25zIG5nTW9kZWxPcHRpb25zfS4gQnkgZGVmYXVsdCwgdGhpcyBpcyB0aGUgdGltZXpvbmUgb2YgdGhlIGJyb3dzZXIuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuZ01vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG1pbiBTZXRzIHRoZSBgbWluYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgZW50ZXJlZCBpcyBsZXNzIHRoYW4gYG1pbmAuXG4gICAqICAgVGhpcyBtdXN0IGJlIGEgdmFsaWQgSVNPIHRpbWUgZm9ybWF0IChISDptbTpzcykuIFlvdSBjYW4gYWxzbyB1c2UgaW50ZXJwb2xhdGlvbiBpbnNpZGUgdGhpc1xuICAgKiAgIGF0dHJpYnV0ZSAoZS5nLiBgbWluPVwie3ttaW5UaW1lIHwgZGF0ZTonSEg6bW06c3MnfX1cImApLiBOb3RlIHRoYXQgYG1pbmAgd2lsbCBhbHNvIGFkZFxuICAgKiAgIG5hdGl2ZSBIVE1MNSBjb25zdHJhaW50IHZhbGlkYXRpb24uXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbWF4IFNldHMgdGhlIGBtYXhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBlbnRlcmVkIGlzIGdyZWF0ZXIgdGhhbiBgbWF4YC5cbiAgICogICBUaGlzIG11c3QgYmUgYSB2YWxpZCBJU08gdGltZSBmb3JtYXQgKEhIOm1tOnNzKS4gWW91IGNhbiBhbHNvIHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSB0aGlzXG4gICAqICAgYXR0cmlidXRlIChlLmcuIGBtYXg9XCJ7e21heFRpbWUgfCBkYXRlOidISDptbTpzcyd9fVwiYCkuIE5vdGUgdGhhdCBgbWF4YCB3aWxsIGFsc28gYWRkXG4gICAqICAgbmF0aXZlIEhUTUw1IGNvbnN0cmFpbnQgdmFsaWRhdGlvbi5cbiAgICogQHBhcmFtIHsoZGF0ZXxzdHJpbmcpPX0gbmdNaW4gU2V0cyB0aGUgYG1pbmAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvIHRoZSBEYXRlIC8gSVNPIHRpbWUgc3RyaW5nIHRoZVxuICAgKiAgIGBuZ01pbmAgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8uIE5vdGUgdGhhdCBpdCBkb2VzIG5vdCBzZXQgdGhlIGBtaW5gIGF0dHJpYnV0ZS5cbiAgICogQHBhcmFtIHsoZGF0ZXxzdHJpbmcpPX0gbmdNYXggU2V0cyB0aGUgYG1heGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvIHRoZSBEYXRlIC8gSVNPIHRpbWUgc3RyaW5nIHRoZVxuICAgKiAgIGBuZ01heGAgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8uIE5vdGUgdGhhdCBpdCBkb2VzIG5vdCBzZXQgdGhlIGBtYXhgIGF0dHJpYnV0ZS5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSByZXF1aXJlZCBTZXRzIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIG5vdCBlbnRlcmVkLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG5nUmVxdWlyZWQgQWRkcyBgcmVxdWlyZWRgIGF0dHJpYnV0ZSBhbmQgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGNvbnN0cmFpbnQgdG9cbiAgICogICAgdGhlIGVsZW1lbnQgd2hlbiB0aGUgbmdSZXF1aXJlZCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLiBVc2UgYG5nUmVxdWlyZWRgIGluc3RlYWQgb2ZcbiAgICogICAgYHJlcXVpcmVkYCB3aGVuIHlvdSB3YW50IHRvIGRhdGEtYmluZCB0byB0aGUgYHJlcXVpcmVkYCBhdHRyaWJ1dGUuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdDaGFuZ2UgQW5ndWxhciBleHByZXNzaW9uIHRvIGJlIGV4ZWN1dGVkIHdoZW4gaW5wdXQgY2hhbmdlcyBkdWUgdG8gdXNlclxuICAgKiAgICBpbnRlcmFjdGlvbiB3aXRoIHRoZSBpbnB1dCBlbGVtZW50LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgPGV4YW1wbGUgbmFtZT1cInRpbWUtaW5wdXQtZGlyZWN0aXZlXCIgbW9kdWxlPVwidGltZUV4YW1wbGVcIj5cbiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgIDxzY3JpcHQ+XG4gICAgICBhbmd1bGFyLm1vZHVsZSgndGltZUV4YW1wbGUnLCBbXSlcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0RhdGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAkc2NvcGUuZXhhbXBsZSA9IHtcbiAgICAgICAgICAgIHZhbHVlOiBuZXcgRGF0ZSgxOTcwLCAwLCAxLCAxNCwgNTcsIDApXG4gICAgICAgICAgfTtcbiAgICAgICAgfV0pO1xuICAgICA8L3NjcmlwdD5cbiAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiIG5nLWNvbnRyb2xsZXI9XCJEYXRlQ29udHJvbGxlciBhcyBkYXRlQ3RybFwiPlxuICAgICAgICA8bGFiZWwgZm9yPVwiZXhhbXBsZUlucHV0XCI+UGljayBhIGJldHdlZW4gOGFtIGFuZCA1cG06PC9sYWJlbD5cbiAgICAgICAgPGlucHV0IHR5cGU9XCJ0aW1lXCIgaWQ9XCJleGFtcGxlSW5wdXRcIiBuYW1lPVwiaW5wdXRcIiBuZy1tb2RlbD1cImV4YW1wbGUudmFsdWVcIlxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJISDptbTpzc1wiIG1pbj1cIjA4OjAwOjAwXCIgbWF4PVwiMTc6MDA6MDBcIiByZXF1aXJlZCAvPlxuICAgICAgICA8ZGl2IHJvbGU9XCJhbGVydFwiPlxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5yZXF1aXJlZFwiPlxuICAgICAgICAgICAgICBSZXF1aXJlZCE8L3NwYW4+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLnRpbWVcIj5cbiAgICAgICAgICAgICAgTm90IGEgdmFsaWQgZGF0ZSE8L3NwYW4+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8dHQ+dmFsdWUgPSB7e2V4YW1wbGUudmFsdWUgfCBkYXRlOiBcIkhIOm1tOnNzXCJ9fTwvdHQ+PGJyLz5cbiAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kdmFsaWQgPSB7e215Rm9ybS5pbnB1dC4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kZXJyb3IgPSB7e215Rm9ybS5pbnB1dC4kZXJyb3J9fTwvdHQ+PGJyLz5cbiAgICAgICAgPHR0Pm15Rm9ybS4kdmFsaWQgPSB7e215Rm9ybS4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IucmVxdWlyZWQgPSB7eyEhbXlGb3JtLiRlcnJvci5yZXF1aXJlZH19PC90dD48YnIvPlxuICAgICA8L2Zvcm0+XG4gICA8L2ZpbGU+XG4gICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICB2YXIgdmFsdWUgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2V4YW1wbGUudmFsdWUgfCBkYXRlOiBcIkhIOm1tOnNzXCInKSk7XG4gICAgICB2YXIgdmFsaWQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ215Rm9ybS5pbnB1dC4kdmFsaWQnKSk7XG4gICAgICB2YXIgaW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdleGFtcGxlLnZhbHVlJykpO1xuXG4gICAgICAvLyBjdXJyZW50bHkgcHJvdHJhY3Rvci93ZWJkcml2ZXIgZG9lcyBub3Qgc3VwcG9ydFxuICAgICAgLy8gc2VuZGluZyBrZXlzIHRvIGFsbCBrbm93biBIVE1MNSBpbnB1dCBjb250cm9sc1xuICAgICAgLy8gZm9yIHZhcmlvdXMgYnJvd3NlcnMgKGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL3Byb3RyYWN0b3IvaXNzdWVzLzU2MikuXG4gICAgICBmdW5jdGlvbiBzZXRJbnB1dCh2YWwpIHtcbiAgICAgICAgLy8gc2V0IHRoZSB2YWx1ZSBvZiB0aGUgZWxlbWVudCBhbmQgZm9yY2UgdmFsaWRhdGlvbi5cbiAgICAgICAgdmFyIHNjciA9IFwidmFyIGlwdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGFtcGxlSW5wdXQnKTsgXCIgK1xuICAgICAgICBcImlwdC52YWx1ZSA9ICdcIiArIHZhbCArIFwiJztcIiArXG4gICAgICAgIFwiYW5ndWxhci5lbGVtZW50KGlwdCkuc2NvcGUoKS4kYXBwbHkoZnVuY3Rpb24ocykgeyBzLm15Rm9ybVtpcHQubmFtZV0uJHNldFZpZXdWYWx1ZSgnXCIgKyB2YWwgKyBcIicpOyB9KTtcIjtcbiAgICAgICAgYnJvd3Nlci5leGVjdXRlU2NyaXB0KHNjcik7XG4gICAgICB9XG5cbiAgICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB0byBtb2RlbCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJzE0OjU3OjAwJyk7XG4gICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignbXlGb3JtLmlucHV0LiR2YWxpZCA9IHRydWUnKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgZW1wdHknLCBmdW5jdGlvbigpIHtcbiAgICAgICAgc2V0SW5wdXQoJycpO1xuICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0VxdWFsKCd2YWx1ZSA9Jyk7XG4gICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignbXlGb3JtLmlucHV0LiR2YWxpZCA9IGZhbHNlJyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIG92ZXIgbWF4JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNldElucHV0KCcyMzo1OTowMCcpO1xuICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJycpO1xuICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ215Rm9ybS5pbnB1dC4kdmFsaWQgPSBmYWxzZScpO1xuICAgICAgfSk7XG4gICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gICAqL1xuICAndGltZSc6IGNyZWF0ZURhdGVJbnB1dFR5cGUoJ3RpbWUnLCBUSU1FX1JFR0VYUCxcbiAgICAgIGNyZWF0ZURhdGVQYXJzZXIoVElNRV9SRUdFWFAsIFsnSEgnLCAnbW0nLCAnc3MnLCAnc3NzJ10pLFxuICAgICAnSEg6bW06c3Muc3NzJyksXG5cbiAgIC8qKlxuICAgICogQG5nZG9jIGlucHV0XG4gICAgKiBAbmFtZSBpbnB1dFt3ZWVrXVxuICAgICpcbiAgICAqIEBkZXNjcmlwdGlvblxuICAgICogSW5wdXQgd2l0aCB3ZWVrLW9mLXRoZS15ZWFyIHZhbGlkYXRpb24gYW5kIHRyYW5zZm9ybWF0aW9uIHRvIERhdGUuIEluIGJyb3dzZXJzIHRoYXQgZG8gbm90IHlldCBzdXBwb3J0XG4gICAgKiB0aGUgSFRNTDUgd2VlayBpbnB1dCwgYSB0ZXh0IGVsZW1lbnQgd2lsbCBiZSB1c2VkLiBJbiB0aGF0IGNhc2UsIHRoZSB0ZXh0IG11c3QgYmUgZW50ZXJlZCBpbiBhIHZhbGlkIElTTy04NjAxXG4gICAgKiB3ZWVrIGZvcm1hdCAoeXl5eS1XIyMpLCBmb3IgZXhhbXBsZTogYDIwMTMtVzAyYC5cbiAgICAqXG4gICAgKiBUaGUgbW9kZWwgbXVzdCBhbHdheXMgYmUgYSBEYXRlIG9iamVjdCwgb3RoZXJ3aXNlIEFuZ3VsYXIgd2lsbCB0aHJvdyBhbiBlcnJvci5cbiAgICAqIEludmFsaWQgYERhdGVgIG9iamVjdHMgKGRhdGVzIHdob3NlIGBnZXRUaW1lKClgIGlzIGBOYU5gKSB3aWxsIGJlIHJlbmRlcmVkIGFzIGFuIGVtcHR5IHN0cmluZy5cbiAgICAqXG4gICAgKiBUaGUgdGltZXpvbmUgdG8gYmUgdXNlZCB0byByZWFkL3dyaXRlIHRoZSBgRGF0ZWAgaW5zdGFuY2UgaW4gdGhlIG1vZGVsIGNhbiBiZSBkZWZpbmVkIHVzaW5nXG4gICAgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nTW9kZWxPcHRpb25zIG5nTW9kZWxPcHRpb25zfS4gQnkgZGVmYXVsdCwgdGhpcyBpcyB0aGUgdGltZXpvbmUgb2YgdGhlIGJyb3dzZXIuXG4gICAgKlxuICAgICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuICAgICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxuICAgICogQHBhcmFtIHtzdHJpbmc9fSBtaW4gU2V0cyB0aGUgYG1pbmAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGVudGVyZWQgaXMgbGVzcyB0aGFuIGBtaW5gLlxuICAgICogICBUaGlzIG11c3QgYmUgYSB2YWxpZCBJU08gd2VlayBmb3JtYXQgKHl5eXktVyMjKS4gWW91IGNhbiBhbHNvIHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSB0aGlzXG4gICAgKiAgIGF0dHJpYnV0ZSAoZS5nLiBgbWluPVwie3ttaW5XZWVrIHwgZGF0ZToneXl5eS1Xd3cnfX1cImApLiBOb3RlIHRoYXQgYG1pbmAgd2lsbCBhbHNvIGFkZFxuICAgICogICBuYXRpdmUgSFRNTDUgY29uc3RyYWludCB2YWxpZGF0aW9uLlxuICAgICogQHBhcmFtIHtzdHJpbmc9fSBtYXggU2V0cyB0aGUgYG1heGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGVudGVyZWQgaXMgZ3JlYXRlciB0aGFuIGBtYXhgLlxuICAgICogICBUaGlzIG11c3QgYmUgYSB2YWxpZCBJU08gd2VlayBmb3JtYXQgKHl5eXktVyMjKS4gWW91IGNhbiBhbHNvIHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSB0aGlzXG4gICAgKiAgIGF0dHJpYnV0ZSAoZS5nLiBgbWF4PVwie3ttYXhXZWVrIHwgZGF0ZToneXl5eS1Xd3cnfX1cImApLiBOb3RlIHRoYXQgYG1heGAgd2lsbCBhbHNvIGFkZFxuICAgICogICBuYXRpdmUgSFRNTDUgY29uc3RyYWludCB2YWxpZGF0aW9uLlxuICAgICogQHBhcmFtIHsoZGF0ZXxzdHJpbmcpPX0gbmdNaW4gU2V0cyB0aGUgYG1pbmAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvIHRoZSBEYXRlIC8gSVNPIHdlZWsgc3RyaW5nXG4gICAgKiAgIHRoZSBgbmdNaW5gIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvLiBOb3RlIHRoYXQgaXQgZG9lcyBub3Qgc2V0IHRoZSBgbWluYCBhdHRyaWJ1dGUuXG4gICAgKiBAcGFyYW0geyhkYXRlfHN0cmluZyk9fSBuZ01heCBTZXRzIHRoZSBgbWF4YCB2YWxpZGF0aW9uIGNvbnN0cmFpbnQgdG8gdGhlIERhdGUgLyBJU08gd2VlayBzdHJpbmdcbiAgICAqICAgdGhlIGBuZ01heGAgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8uIE5vdGUgdGhhdCBpdCBkb2VzIG5vdCBzZXQgdGhlIGBtYXhgIGF0dHJpYnV0ZS5cbiAgICAqIEBwYXJhbSB7c3RyaW5nPX0gcmVxdWlyZWQgU2V0cyBgcmVxdWlyZWRgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBub3QgZW50ZXJlZC5cbiAgICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdSZXF1aXJlZCBBZGRzIGByZXF1aXJlZGAgYXR0cmlidXRlIGFuZCBgcmVxdWlyZWRgIHZhbGlkYXRpb24gY29uc3RyYWludCB0b1xuICAgICogICAgdGhlIGVsZW1lbnQgd2hlbiB0aGUgbmdSZXF1aXJlZCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLiBVc2UgYG5nUmVxdWlyZWRgIGluc3RlYWQgb2ZcbiAgICAqICAgIGByZXF1aXJlZGAgd2hlbiB5b3Ugd2FudCB0byBkYXRhLWJpbmQgdG8gdGhlIGByZXF1aXJlZGAgYXR0cmlidXRlLlxuICAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ0NoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyXG4gICAgKiAgICBpbnRlcmFjdGlvbiB3aXRoIHRoZSBpbnB1dCBlbGVtZW50LlxuICAgICpcbiAgICAqIEBleGFtcGxlXG4gICAgPGV4YW1wbGUgbmFtZT1cIndlZWstaW5wdXQtZGlyZWN0aXZlXCIgbW9kdWxlPVwid2Vla0V4YW1wbGVcIj5cbiAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgPHNjcmlwdD5cbiAgICAgIGFuZ3VsYXIubW9kdWxlKCd3ZWVrRXhhbXBsZScsIFtdKVxuICAgICAgICAuY29udHJvbGxlcignRGF0ZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICRzY29wZS5leGFtcGxlID0ge1xuICAgICAgICAgICAgdmFsdWU6IG5ldyBEYXRlKDIwMTMsIDAsIDMpXG4gICAgICAgICAgfTtcbiAgICAgICAgfV0pO1xuICAgICAgPC9zY3JpcHQ+XG4gICAgICA8Zm9ybSBuYW1lPVwibXlGb3JtXCIgbmctY29udHJvbGxlcj1cIkRhdGVDb250cm9sbGVyIGFzIGRhdGVDdHJsXCI+XG4gICAgICAgIDxsYWJlbD5QaWNrIGEgZGF0ZSBiZXR3ZWVuIGluIDIwMTM6XG4gICAgICAgICAgPGlucHV0IGlkPVwiZXhhbXBsZUlucHV0XCIgdHlwZT1cIndlZWtcIiBuYW1lPVwiaW5wdXRcIiBuZy1tb2RlbD1cImV4YW1wbGUudmFsdWVcIlxuICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIllZWVktVyMjXCIgbWluPVwiMjAxMi1XMzJcIlxuICAgICAgICAgICAgICAgICBtYXg9XCIyMDEzLVc1MlwiIHJlcXVpcmVkIC8+XG4gICAgICAgIDwvbGFiZWw+XG4gICAgICAgIDxkaXYgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLnJlcXVpcmVkXCI+XG4gICAgICAgICAgICAgIFJlcXVpcmVkITwvc3Bhbj5cbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS5pbnB1dC4kZXJyb3Iud2Vla1wiPlxuICAgICAgICAgICAgICBOb3QgYSB2YWxpZCBkYXRlITwvc3Bhbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDx0dD52YWx1ZSA9IHt7ZXhhbXBsZS52YWx1ZSB8IGRhdGU6IFwieXl5eS1Xd3dcIn19PC90dD48YnIvPlxuICAgICAgICA8dHQ+bXlGb3JtLmlucHV0LiR2YWxpZCA9IHt7bXlGb3JtLmlucHV0LiR2YWxpZH19PC90dD48YnIvPlxuICAgICAgICA8dHQ+bXlGb3JtLmlucHV0LiRlcnJvciA9IHt7bXlGb3JtLmlucHV0LiRlcnJvcn19PC90dD48YnIvPlxuICAgICAgICA8dHQ+bXlGb3JtLiR2YWxpZCA9IHt7bXlGb3JtLiR2YWxpZH19PC90dD48YnIvPlxuICAgICAgICA8dHQ+bXlGb3JtLiRlcnJvci5yZXF1aXJlZCA9IHt7ISFteUZvcm0uJGVycm9yLnJlcXVpcmVkfX08L3R0Pjxici8+XG4gICAgICA8L2Zvcm0+XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQoYnkuYmluZGluZygnZXhhbXBsZS52YWx1ZSB8IGRhdGU6IFwieXl5eS1Xd3dcIicpKTtcbiAgICAgIHZhciB2YWxpZCA9IGVsZW1lbnQoYnkuYmluZGluZygnbXlGb3JtLmlucHV0LiR2YWxpZCcpKTtcbiAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ2V4YW1wbGUudmFsdWUnKSk7XG5cbiAgICAgIC8vIGN1cnJlbnRseSBwcm90cmFjdG9yL3dlYmRyaXZlciBkb2VzIG5vdCBzdXBwb3J0XG4gICAgICAvLyBzZW5kaW5nIGtleXMgdG8gYWxsIGtub3duIEhUTUw1IGlucHV0IGNvbnRyb2xzXG4gICAgICAvLyBmb3IgdmFyaW91cyBicm93c2VycyAoaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvcHJvdHJhY3Rvci9pc3N1ZXMvNTYyKS5cbiAgICAgIGZ1bmN0aW9uIHNldElucHV0KHZhbCkge1xuICAgICAgICAvLyBzZXQgdGhlIHZhbHVlIG9mIHRoZSBlbGVtZW50IGFuZCBmb3JjZSB2YWxpZGF0aW9uLlxuICAgICAgICB2YXIgc2NyID0gXCJ2YXIgaXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4YW1wbGVJbnB1dCcpOyBcIiArXG4gICAgICAgIFwiaXB0LnZhbHVlID0gJ1wiICsgdmFsICsgXCInO1wiICtcbiAgICAgICAgXCJhbmd1bGFyLmVsZW1lbnQoaXB0KS5zY29wZSgpLiRhcHBseShmdW5jdGlvbihzKSB7IHMubXlGb3JtW2lwdC5uYW1lXS4kc2V0Vmlld1ZhbHVlKCdcIiArIHZhbCArIFwiJyk7IH0pO1wiO1xuICAgICAgICBicm93c2VyLmV4ZWN1dGVTY3JpcHQoc2NyKTtcbiAgICAgIH1cblxuICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGV4cGVjdCh2YWx1ZS5nZXRUZXh0KCkpLnRvQ29udGFpbignMjAxMy1XMDEnKTtcbiAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gdHJ1ZScpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuICAgICAgICBzZXRJbnB1dCgnJyk7XG4gICAgICAgIGV4cGVjdCh2YWx1ZS5nZXRUZXh0KCkpLnRvRXF1YWwoJ3ZhbHVlID0nKTtcbiAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdteUZvcm0uaW5wdXQuJHZhbGlkID0gZmFsc2UnKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgb3ZlciBtYXgnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgc2V0SW5wdXQoJzIwMTUtVzAxJyk7XG4gICAgICAgIGV4cGVjdCh2YWx1ZS5nZXRUZXh0KCkpLnRvQ29udGFpbignJyk7XG4gICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignbXlGb3JtLmlucHV0LiR2YWxpZCA9IGZhbHNlJyk7XG4gICAgICB9KTtcbiAgICA8L2ZpbGU+XG4gICAgPC9leGFtcGxlPlxuICAgICovXG4gICd3ZWVrJzogY3JlYXRlRGF0ZUlucHV0VHlwZSgnd2VlaycsIFdFRUtfUkVHRVhQLCB3ZWVrUGFyc2VyLCAneXl5eS1Xd3cnKSxcblxuICAvKipcbiAgICogQG5nZG9jIGlucHV0XG4gICAqIEBuYW1lIGlucHV0W21vbnRoXVxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogSW5wdXQgd2l0aCBtb250aCB2YWxpZGF0aW9uIGFuZCB0cmFuc2Zvcm1hdGlvbi4gSW4gYnJvd3NlcnMgdGhhdCBkbyBub3QgeWV0IHN1cHBvcnRcbiAgICogdGhlIEhUTUw1IG1vbnRoIGlucHV0LCBhIHRleHQgZWxlbWVudCB3aWxsIGJlIHVzZWQuIEluIHRoYXQgY2FzZSwgdGhlIHRleHQgbXVzdCBiZSBlbnRlcmVkIGluIGEgdmFsaWQgSVNPLTg2MDFcbiAgICogbW9udGggZm9ybWF0ICh5eXl5LU1NKSwgZm9yIGV4YW1wbGU6IGAyMDA5LTAxYC5cbiAgICpcbiAgICogVGhlIG1vZGVsIG11c3QgYWx3YXlzIGJlIGEgRGF0ZSBvYmplY3QsIG90aGVyd2lzZSBBbmd1bGFyIHdpbGwgdGhyb3cgYW4gZXJyb3IuXG4gICAqIEludmFsaWQgYERhdGVgIG9iamVjdHMgKGRhdGVzIHdob3NlIGBnZXRUaW1lKClgIGlzIGBOYU5gKSB3aWxsIGJlIHJlbmRlcmVkIGFzIGFuIGVtcHR5IHN0cmluZy5cbiAgICogSWYgdGhlIG1vZGVsIGlzIG5vdCBzZXQgdG8gdGhlIGZpcnN0IG9mIHRoZSBtb250aCwgdGhlIG5leHQgdmlldyB0byBtb2RlbCB1cGRhdGUgd2lsbCBzZXQgaXRcbiAgICogdG8gdGhlIGZpcnN0IG9mIHRoZSBtb250aC5cbiAgICpcbiAgICogVGhlIHRpbWV6b25lIHRvIGJlIHVzZWQgdG8gcmVhZC93cml0ZSB0aGUgYERhdGVgIGluc3RhbmNlIGluIHRoZSBtb2RlbCBjYW4gYmUgZGVmaW5lZCB1c2luZ1xuICAgKiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nTW9kZWxPcHRpb25zIG5nTW9kZWxPcHRpb25zfS4gQnkgZGVmYXVsdCwgdGhpcyBpcyB0aGUgdGltZXpvbmUgb2YgdGhlIGJyb3dzZXIuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuZ01vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG1pbiBTZXRzIHRoZSBgbWluYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgZW50ZXJlZCBpcyBsZXNzIHRoYW4gYG1pbmAuXG4gICAqICAgVGhpcyBtdXN0IGJlIGEgdmFsaWQgSVNPIG1vbnRoIGZvcm1hdCAoeXl5eS1NTSkuIFlvdSBjYW4gYWxzbyB1c2UgaW50ZXJwb2xhdGlvbiBpbnNpZGUgdGhpc1xuICAgKiAgIGF0dHJpYnV0ZSAoZS5nLiBgbWluPVwie3ttaW5Nb250aCB8IGRhdGU6J3l5eXktTU0nfX1cImApLiBOb3RlIHRoYXQgYG1pbmAgd2lsbCBhbHNvIGFkZFxuICAgKiAgIG5hdGl2ZSBIVE1MNSBjb25zdHJhaW50IHZhbGlkYXRpb24uXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbWF4IFNldHMgdGhlIGBtYXhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBlbnRlcmVkIGlzIGdyZWF0ZXIgdGhhbiBgbWF4YC5cbiAgICogICBUaGlzIG11c3QgYmUgYSB2YWxpZCBJU08gbW9udGggZm9ybWF0ICh5eXl5LU1NKS4gWW91IGNhbiBhbHNvIHVzZSBpbnRlcnBvbGF0aW9uIGluc2lkZSB0aGlzXG4gICAqICAgYXR0cmlidXRlIChlLmcuIGBtYXg9XCJ7e21heE1vbnRoIHwgZGF0ZToneXl5eS1NTSd9fVwiYCkuIE5vdGUgdGhhdCBgbWF4YCB3aWxsIGFsc28gYWRkXG4gICAqICAgbmF0aXZlIEhUTUw1IGNvbnN0cmFpbnQgdmFsaWRhdGlvbi5cbiAgICogQHBhcmFtIHsoZGF0ZXxzdHJpbmcpPX0gbmdNaW4gU2V0cyB0aGUgYG1pbmAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvIHRoZSBEYXRlIC8gSVNPIHdlZWsgc3RyaW5nXG4gICAqICAgdGhlIGBuZ01pbmAgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8uIE5vdGUgdGhhdCBpdCBkb2VzIG5vdCBzZXQgdGhlIGBtaW5gIGF0dHJpYnV0ZS5cbiAgICogQHBhcmFtIHsoZGF0ZXxzdHJpbmcpPX0gbmdNYXggU2V0cyB0aGUgYG1heGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvIHRoZSBEYXRlIC8gSVNPIHdlZWsgc3RyaW5nXG4gICAqICAgdGhlIGBuZ01heGAgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8uIE5vdGUgdGhhdCBpdCBkb2VzIG5vdCBzZXQgdGhlIGBtYXhgIGF0dHJpYnV0ZS5cblxuICAgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdSZXF1aXJlZCBBZGRzIGByZXF1aXJlZGAgYXR0cmlidXRlIGFuZCBgcmVxdWlyZWRgIHZhbGlkYXRpb24gY29uc3RyYWludCB0b1xuICAgKiAgICB0aGUgZWxlbWVudCB3aGVuIHRoZSBuZ1JlcXVpcmVkIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIHRydWUuIFVzZSBgbmdSZXF1aXJlZGAgaW5zdGVhZCBvZlxuICAgKiAgICBgcmVxdWlyZWRgIHdoZW4geW91IHdhbnQgdG8gZGF0YS1iaW5kIHRvIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0ZS5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ0NoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyXG4gICAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZSBuYW1lPVwibW9udGgtaW5wdXQtZGlyZWN0aXZlXCIgbW9kdWxlPVwibW9udGhFeGFtcGxlXCI+XG4gICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICA8c2NyaXB0PlxuICAgICAgYW5ndWxhci5tb2R1bGUoJ21vbnRoRXhhbXBsZScsIFtdKVxuICAgICAgICAuY29udHJvbGxlcignRGF0ZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICRzY29wZS5leGFtcGxlID0ge1xuICAgICAgICAgICAgdmFsdWU6IG5ldyBEYXRlKDIwMTMsIDksIDEpXG4gICAgICAgICAgfTtcbiAgICAgICAgfV0pO1xuICAgICA8L3NjcmlwdD5cbiAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiIG5nLWNvbnRyb2xsZXI9XCJEYXRlQ29udHJvbGxlciBhcyBkYXRlQ3RybFwiPlxuICAgICAgIDxsYWJlbCBmb3I9XCJleGFtcGxlSW5wdXRcIj5QaWNrIGEgbW9udGggaW4gMjAxMzo8L2xhYmVsPlxuICAgICAgIDxpbnB1dCBpZD1cImV4YW1wbGVJbnB1dFwiIHR5cGU9XCJtb250aFwiIG5hbWU9XCJpbnB1dFwiIG5nLW1vZGVsPVwiZXhhbXBsZS52YWx1ZVwiXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJ5eXl5LU1NXCIgbWluPVwiMjAxMy0wMVwiIG1heD1cIjIwMTMtMTJcIiByZXF1aXJlZCAvPlxuICAgICAgIDxkaXYgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS5pbnB1dC4kZXJyb3IucmVxdWlyZWRcIj5cbiAgICAgICAgICAgIFJlcXVpcmVkITwvc3Bhbj5cbiAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5tb250aFwiPlxuICAgICAgICAgICAgTm90IGEgdmFsaWQgbW9udGghPC9zcGFuPlxuICAgICAgIDwvZGl2PlxuICAgICAgIDx0dD52YWx1ZSA9IHt7ZXhhbXBsZS52YWx1ZSB8IGRhdGU6IFwieXl5eS1NTVwifX08L3R0Pjxici8+XG4gICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kdmFsaWQgPSB7e215Rm9ybS5pbnB1dC4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAgICAgICA8dHQ+bXlGb3JtLmlucHV0LiRlcnJvciA9IHt7bXlGb3JtLmlucHV0LiRlcnJvcn19PC90dD48YnIvPlxuICAgICAgIDx0dD5teUZvcm0uJHZhbGlkID0ge3tteUZvcm0uJHZhbGlkfX08L3R0Pjxici8+XG4gICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IucmVxdWlyZWQgPSB7eyEhbXlGb3JtLiRlcnJvci5yZXF1aXJlZH19PC90dD48YnIvPlxuICAgICA8L2Zvcm0+XG4gICA8L2ZpbGU+XG4gICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICB2YXIgdmFsdWUgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2V4YW1wbGUudmFsdWUgfCBkYXRlOiBcInl5eXktTU1cIicpKTtcbiAgICAgIHZhciB2YWxpZCA9IGVsZW1lbnQoYnkuYmluZGluZygnbXlGb3JtLmlucHV0LiR2YWxpZCcpKTtcbiAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ2V4YW1wbGUudmFsdWUnKSk7XG5cbiAgICAgIC8vIGN1cnJlbnRseSBwcm90cmFjdG9yL3dlYmRyaXZlciBkb2VzIG5vdCBzdXBwb3J0XG4gICAgICAvLyBzZW5kaW5nIGtleXMgdG8gYWxsIGtub3duIEhUTUw1IGlucHV0IGNvbnRyb2xzXG4gICAgICAvLyBmb3IgdmFyaW91cyBicm93c2VycyAoaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvcHJvdHJhY3Rvci9pc3N1ZXMvNTYyKS5cbiAgICAgIGZ1bmN0aW9uIHNldElucHV0KHZhbCkge1xuICAgICAgICAvLyBzZXQgdGhlIHZhbHVlIG9mIHRoZSBlbGVtZW50IGFuZCBmb3JjZSB2YWxpZGF0aW9uLlxuICAgICAgICB2YXIgc2NyID0gXCJ2YXIgaXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4YW1wbGVJbnB1dCcpOyBcIiArXG4gICAgICAgIFwiaXB0LnZhbHVlID0gJ1wiICsgdmFsICsgXCInO1wiICtcbiAgICAgICAgXCJhbmd1bGFyLmVsZW1lbnQoaXB0KS5zY29wZSgpLiRhcHBseShmdW5jdGlvbihzKSB7IHMubXlGb3JtW2lwdC5uYW1lXS4kc2V0Vmlld1ZhbHVlKCdcIiArIHZhbCArIFwiJyk7IH0pO1wiO1xuICAgICAgICBicm93c2VyLmV4ZWN1dGVTY3JpcHQoc2NyKTtcbiAgICAgIH1cblxuICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGV4cGVjdCh2YWx1ZS5nZXRUZXh0KCkpLnRvQ29udGFpbignMjAxMy0xMCcpO1xuICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ215Rm9ybS5pbnB1dC4kdmFsaWQgPSB0cnVlJyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIGVtcHR5JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNldElucHV0KCcnKTtcbiAgICAgICAgZXhwZWN0KHZhbHVlLmdldFRleHQoKSkudG9FcXVhbCgndmFsdWUgPScpO1xuICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ215Rm9ybS5pbnB1dC4kdmFsaWQgPSBmYWxzZScpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBvdmVyIG1heCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICBzZXRJbnB1dCgnMjAxNS0wMScpO1xuICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJycpO1xuICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ215Rm9ybS5pbnB1dC4kdmFsaWQgPSBmYWxzZScpO1xuICAgICAgfSk7XG4gICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gICAqL1xuICAnbW9udGgnOiBjcmVhdGVEYXRlSW5wdXRUeXBlKCdtb250aCcsIE1PTlRIX1JFR0VYUCxcbiAgICAgY3JlYXRlRGF0ZVBhcnNlcihNT05USF9SRUdFWFAsIFsneXl5eScsICdNTSddKSxcbiAgICAgJ3l5eXktTU0nKSxcblxuICAvKipcbiAgICogQG5nZG9jIGlucHV0XG4gICAqIEBuYW1lIGlucHV0W251bWJlcl1cbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFRleHQgaW5wdXQgd2l0aCBudW1iZXIgdmFsaWRhdGlvbiBhbmQgdHJhbnNmb3JtYXRpb24uIFNldHMgdGhlIGBudW1iZXJgIHZhbGlkYXRpb25cbiAgICogZXJyb3IgaWYgbm90IGEgdmFsaWQgbnVtYmVyLlxuICAgKlxuICAgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuICAgKiBUaGUgbW9kZWwgbXVzdCBhbHdheXMgYmUgb2YgdHlwZSBgbnVtYmVyYCBvdGhlcndpc2UgQW5ndWxhciB3aWxsIHRocm93IGFuIGVycm9yLlxuICAgKiBCZSBhd2FyZSB0aGF0IGEgc3RyaW5nIGNvbnRhaW5pbmcgYSBudW1iZXIgaXMgbm90IGVub3VnaC4gU2VlIHRoZSB7QGxpbmsgbmdNb2RlbDpudW1mbXR9XG4gICAqIGVycm9yIGRvY3MgZm9yIG1vcmUgaW5mb3JtYXRpb24gYW5kIGFuIGV4YW1wbGUgb2YgaG93IHRvIGNvbnZlcnQgeW91ciBtb2RlbCBpZiBuZWNlc3NhcnkuXG4gICAqIDwvZGl2PlxuICAgKlxuICAgKiAjIyBJc3N1ZXMgd2l0aCBIVE1MNSBjb25zdHJhaW50IHZhbGlkYXRpb25cbiAgICpcbiAgICogSW4gYnJvd3NlcnMgdGhhdCBmb2xsb3cgdGhlXG4gICAqIFtIVE1MNSBzcGVjaWZpY2F0aW9uXShodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9mb3Jtcy5odG1sI251bWJlci1zdGF0ZS0lMjh0eXBlPW51bWJlciUyOSksXG4gICAqIGBpbnB1dFtudW1iZXJdYCBkb2VzIG5vdCB3b3JrIGFzIGV4cGVjdGVkIHdpdGgge0BsaW5rIG5nTW9kZWxPcHRpb25zIGBuZ01vZGVsT3B0aW9ucy5hbGxvd0ludmFsaWRgfS5cbiAgICogSWYgYSBub24tbnVtYmVyIGlzIGVudGVyZWQgaW4gdGhlIGlucHV0LCB0aGUgYnJvd3NlciB3aWxsIHJlcG9ydCB0aGUgdmFsdWUgYXMgYW4gZW1wdHkgc3RyaW5nLFxuICAgKiB3aGljaCBtZWFucyB0aGUgdmlldyAvIG1vZGVsIHZhbHVlcyBpbiBgbmdNb2RlbGAgYW5kIHN1YnNlcXVlbnRseSB0aGUgc2NvcGUgdmFsdWVcbiAgICogd2lsbCBhbHNvIGJlIGFuIGVtcHR5IHN0cmluZy5cbiAgICpcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbWluIFNldHMgdGhlIGBtaW5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBlbnRlcmVkIGlzIGxlc3MgdGhhbiBgbWluYC5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBtYXggU2V0cyB0aGUgYG1heGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGVudGVyZWQgaXMgZ3JlYXRlciB0aGFuIGBtYXhgLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdSZXF1aXJlZCBBZGRzIGByZXF1aXJlZGAgYXR0cmlidXRlIGFuZCBgcmVxdWlyZWRgIHZhbGlkYXRpb24gY29uc3RyYWludCB0b1xuICAgKiAgICB0aGUgZWxlbWVudCB3aGVuIHRoZSBuZ1JlcXVpcmVkIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIHRydWUuIFVzZSBgbmdSZXF1aXJlZGAgaW5zdGVhZCBvZlxuICAgKiAgICBgcmVxdWlyZWRgIHdoZW4geW91IHdhbnQgdG8gZGF0YS1iaW5kIHRvIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0ZS5cbiAgICogQHBhcmFtIHtudW1iZXI9fSBuZ01pbmxlbmd0aCBTZXRzIGBtaW5sZW5ndGhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBzaG9ydGVyIHRoYW5cbiAgICogICAgbWlubGVuZ3RoLlxuICAgKiBAcGFyYW0ge251bWJlcj19IG5nTWF4bGVuZ3RoIFNldHMgYG1heGxlbmd0aGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIGxvbmdlciB0aGFuXG4gICAqICAgIG1heGxlbmd0aC4gU2V0dGluZyB0aGUgYXR0cmlidXRlIHRvIGEgbmVnYXRpdmUgb3Igbm9uLW51bWVyaWMgdmFsdWUsIGFsbG93cyB2aWV3IHZhbHVlcyBvZlxuICAgKiAgICBhbnkgbGVuZ3RoLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IHBhdHRlcm4gU2ltaWxhciB0byBgbmdQYXR0ZXJuYCBleGNlcHQgdGhhdCB0aGUgYXR0cmlidXRlIHZhbHVlIGlzIHRoZSBhY3R1YWwgc3RyaW5nXG4gICAqICAgIHRoYXQgY29udGFpbnMgdGhlIHJlZ3VsYXIgZXhwcmVzc2lvbiBib2R5IHRoYXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSByZWd1bGFyIGV4cHJlc3Npb25cbiAgICogICAgYXMgaW4gdGhlIG5nUGF0dGVybiBkaXJlY3RpdmUuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdQYXR0ZXJuIFNldHMgYHBhdHRlcm5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSBuZ01vZGVsIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2aWV3VmFsdWUgJHZpZXdWYWx1ZX1cbiAgICogICAgZG9lcyBub3QgbWF0Y2ggYSBSZWdFeHAgZm91bmQgYnkgZXZhbHVhdGluZyB0aGUgQW5ndWxhciBleHByZXNzaW9uIGdpdmVuIGluIHRoZSBhdHRyaWJ1dGUgdmFsdWUuXG4gICAqICAgIElmIHRoZSBleHByZXNzaW9uIGV2YWx1YXRlcyB0byBhIFJlZ0V4cCBvYmplY3QsIHRoZW4gdGhpcyBpcyB1c2VkIGRpcmVjdGx5LlxuICAgKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBzdHJpbmcsIHRoZW4gaXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSBSZWdFeHBcbiAgICogICAgYWZ0ZXIgd3JhcHBpbmcgaXQgaW4gYF5gIGFuZCBgJGAgY2hhcmFjdGVycy4gRm9yIGluc3RhbmNlLCBgXCJhYmNcImAgd2lsbCBiZSBjb252ZXJ0ZWQgdG9cbiAgICogICAgYG5ldyBSZWdFeHAoJ15hYmMkJylgLjxiciAvPlxuICAgKiAgICAqKk5vdGU6KiogQXZvaWQgdXNpbmcgdGhlIGBnYCBmbGFnIG9uIHRoZSBSZWdFeHAsIGFzIGl0IHdpbGwgY2F1c2UgZWFjaCBzdWNjZXNzaXZlIHNlYXJjaCB0b1xuICAgKiAgICBzdGFydCBhdCB0aGUgaW5kZXggb2YgdGhlIGxhc3Qgc2VhcmNoJ3MgbWF0Y2gsIHRodXMgbm90IHRha2luZyB0aGUgd2hvbGUgaW5wdXQgdmFsdWUgaW50b1xuICAgKiAgICBhY2NvdW50LlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcbiAgICogICAgaW50ZXJhY3Rpb24gd2l0aCB0aGUgaW5wdXQgZWxlbWVudC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICAgIDxleGFtcGxlIG5hbWU9XCJudW1iZXItaW5wdXQtZGlyZWN0aXZlXCIgbW9kdWxlPVwibnVtYmVyRXhhbXBsZVwiPlxuICAgICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgICAgPHNjcmlwdD5cbiAgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ251bWJlckV4YW1wbGUnLCBbXSlcbiAgICAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICAgICAgJHNjb3BlLmV4YW1wbGUgPSB7XG4gICAgICAgICAgICAgICAgIHZhbHVlOiAxMlxuICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICB9XSk7XG4gICAgICAgICA8L3NjcmlwdD5cbiAgICAgICAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiAgICAgICAgICAgPGxhYmVsPk51bWJlcjpcbiAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIG5hbWU9XCJpbnB1dFwiIG5nLW1vZGVsPVwiZXhhbXBsZS52YWx1ZVwiXG4gICAgICAgICAgICAgICAgICAgIG1pbj1cIjBcIiBtYXg9XCI5OVwiIHJlcXVpcmVkPlxuICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgIDxkaXYgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLnJlcXVpcmVkXCI+XG4gICAgICAgICAgICAgICBSZXF1aXJlZCE8L3NwYW4+XG4gICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLm51bWJlclwiPlxuICAgICAgICAgICAgICAgTm90IHZhbGlkIG51bWJlciE8L3NwYW4+XG4gICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICA8dHQ+dmFsdWUgPSB7e2V4YW1wbGUudmFsdWV9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kdmFsaWQgPSB7e215Rm9ybS5pbnB1dC4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kZXJyb3IgPSB7e215Rm9ybS5pbnB1dC4kZXJyb3J9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS4kdmFsaWQgPSB7e215Rm9ybS4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IucmVxdWlyZWQgPSB7eyEhbXlGb3JtLiRlcnJvci5yZXF1aXJlZH19PC90dD48YnIvPlxuICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgPC9maWxlPlxuICAgICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgICAgdmFyIHZhbHVlID0gZWxlbWVudChieS5iaW5kaW5nKCdleGFtcGxlLnZhbHVlJykpO1xuICAgICAgICAgIHZhciB2YWxpZCA9IGVsZW1lbnQoYnkuYmluZGluZygnbXlGb3JtLmlucHV0LiR2YWxpZCcpKTtcbiAgICAgICAgICB2YXIgaW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCdleGFtcGxlLnZhbHVlJykpO1xuXG4gICAgICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBleHBlY3QodmFsdWUuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJzEyJyk7XG4gICAgICAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaW5wdXQuY2xlYXIoKTtcbiAgICAgICAgICAgIGlucHV0LnNlbmRLZXlzKCcnKTtcbiAgICAgICAgICAgIGV4cGVjdCh2YWx1ZS5nZXRUZXh0KCkpLnRvRXF1YWwoJ3ZhbHVlID0nKTtcbiAgICAgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBvdmVyIG1heCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaW5wdXQuY2xlYXIoKTtcbiAgICAgICAgICAgIGlucHV0LnNlbmRLZXlzKCcxMjMnKTtcbiAgICAgICAgICAgIGV4cGVjdCh2YWx1ZS5nZXRUZXh0KCkpLnRvRXF1YWwoJ3ZhbHVlID0nKTtcbiAgICAgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgPC9maWxlPlxuICAgICAgPC9leGFtcGxlPlxuICAgKi9cbiAgJ251bWJlcic6IG51bWJlcklucHV0VHlwZSxcblxuXG4gIC8qKlxuICAgKiBAbmdkb2MgaW5wdXRcbiAgICogQG5hbWUgaW5wdXRbdXJsXVxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogVGV4dCBpbnB1dCB3aXRoIFVSTCB2YWxpZGF0aW9uLiBTZXRzIHRoZSBgdXJsYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgY29udGVudCBpcyBub3QgYVxuICAgKiB2YWxpZCBVUkwuXG4gICAqXG4gICAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG4gICAqICoqTm90ZToqKiBgaW5wdXRbdXJsXWAgdXNlcyBhIHJlZ2V4IHRvIHZhbGlkYXRlIHVybHMgdGhhdCBpcyBkZXJpdmVkIGZyb20gdGhlIHJlZ2V4XG4gICAqIHVzZWQgaW4gQ2hyb21pdW0uIElmIHlvdSBuZWVkIHN0cmljdGVyIHZhbGlkYXRpb24sIHlvdSBjYW4gdXNlIGBuZy1wYXR0ZXJuYCBvciBtb2RpZnlcbiAgICogdGhlIGJ1aWx0LWluIHZhbGlkYXRvcnMgKHNlZSB0aGUge0BsaW5rIGd1aWRlL2Zvcm1zIEZvcm1zIGd1aWRlfSlcbiAgICogPC9kaXY+XG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuZ01vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdSZXF1aXJlZCBBZGRzIGByZXF1aXJlZGAgYXR0cmlidXRlIGFuZCBgcmVxdWlyZWRgIHZhbGlkYXRpb24gY29uc3RyYWludCB0b1xuICAgKiAgICB0aGUgZWxlbWVudCB3aGVuIHRoZSBuZ1JlcXVpcmVkIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIHRydWUuIFVzZSBgbmdSZXF1aXJlZGAgaW5zdGVhZCBvZlxuICAgKiAgICBgcmVxdWlyZWRgIHdoZW4geW91IHdhbnQgdG8gZGF0YS1iaW5kIHRvIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0ZS5cbiAgICogQHBhcmFtIHtudW1iZXI9fSBuZ01pbmxlbmd0aCBTZXRzIGBtaW5sZW5ndGhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBzaG9ydGVyIHRoYW5cbiAgICogICAgbWlubGVuZ3RoLlxuICAgKiBAcGFyYW0ge251bWJlcj19IG5nTWF4bGVuZ3RoIFNldHMgYG1heGxlbmd0aGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIGxvbmdlciB0aGFuXG4gICAqICAgIG1heGxlbmd0aC4gU2V0dGluZyB0aGUgYXR0cmlidXRlIHRvIGEgbmVnYXRpdmUgb3Igbm9uLW51bWVyaWMgdmFsdWUsIGFsbG93cyB2aWV3IHZhbHVlcyBvZlxuICAgKiAgICBhbnkgbGVuZ3RoLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IHBhdHRlcm4gU2ltaWxhciB0byBgbmdQYXR0ZXJuYCBleGNlcHQgdGhhdCB0aGUgYXR0cmlidXRlIHZhbHVlIGlzIHRoZSBhY3R1YWwgc3RyaW5nXG4gICAqICAgIHRoYXQgY29udGFpbnMgdGhlIHJlZ3VsYXIgZXhwcmVzc2lvbiBib2R5IHRoYXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSByZWd1bGFyIGV4cHJlc3Npb25cbiAgICogICAgYXMgaW4gdGhlIG5nUGF0dGVybiBkaXJlY3RpdmUuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdQYXR0ZXJuIFNldHMgYHBhdHRlcm5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSBuZ01vZGVsIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2aWV3VmFsdWUgJHZpZXdWYWx1ZX1cbiAgICogICAgZG9lcyBub3QgbWF0Y2ggYSBSZWdFeHAgZm91bmQgYnkgZXZhbHVhdGluZyB0aGUgQW5ndWxhciBleHByZXNzaW9uIGdpdmVuIGluIHRoZSBhdHRyaWJ1dGUgdmFsdWUuXG4gICAqICAgIElmIHRoZSBleHByZXNzaW9uIGV2YWx1YXRlcyB0byBhIFJlZ0V4cCBvYmplY3QsIHRoZW4gdGhpcyBpcyB1c2VkIGRpcmVjdGx5LlxuICAgKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBzdHJpbmcsIHRoZW4gaXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSBSZWdFeHBcbiAgICogICAgYWZ0ZXIgd3JhcHBpbmcgaXQgaW4gYF5gIGFuZCBgJGAgY2hhcmFjdGVycy4gRm9yIGluc3RhbmNlLCBgXCJhYmNcImAgd2lsbCBiZSBjb252ZXJ0ZWQgdG9cbiAgICogICAgYG5ldyBSZWdFeHAoJ15hYmMkJylgLjxiciAvPlxuICAgKiAgICAqKk5vdGU6KiogQXZvaWQgdXNpbmcgdGhlIGBnYCBmbGFnIG9uIHRoZSBSZWdFeHAsIGFzIGl0IHdpbGwgY2F1c2UgZWFjaCBzdWNjZXNzaXZlIHNlYXJjaCB0b1xuICAgKiAgICBzdGFydCBhdCB0aGUgaW5kZXggb2YgdGhlIGxhc3Qgc2VhcmNoJ3MgbWF0Y2gsIHRodXMgbm90IHRha2luZyB0aGUgd2hvbGUgaW5wdXQgdmFsdWUgaW50b1xuICAgKiAgICBhY2NvdW50LlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcbiAgICogICAgaW50ZXJhY3Rpb24gd2l0aCB0aGUgaW5wdXQgZWxlbWVudC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICAgIDxleGFtcGxlIG5hbWU9XCJ1cmwtaW5wdXQtZGlyZWN0aXZlXCIgbW9kdWxlPVwidXJsRXhhbXBsZVwiPlxuICAgICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgICAgPHNjcmlwdD5cbiAgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ3VybEV4YW1wbGUnLCBbXSlcbiAgICAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICAgICAgJHNjb3BlLnVybCA9IHtcbiAgICAgICAgICAgICAgICAgdGV4dDogJ2h0dHA6Ly9nb29nbGUuY29tJ1xuICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICB9XSk7XG4gICAgICAgICA8L3NjcmlwdD5cbiAgICAgICAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiAgICAgICAgICAgPGxhYmVsPlVSTDpcbiAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInVybFwiIG5hbWU9XCJpbnB1dFwiIG5nLW1vZGVsPVwidXJsLnRleHRcIiByZXF1aXJlZD5cbiAgICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICA8ZGl2IHJvbGU9XCJhbGVydFwiPlxuICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5yZXF1aXJlZFwiPlxuICAgICAgICAgICAgICAgUmVxdWlyZWQhPC9zcGFuPlxuICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci51cmxcIj5cbiAgICAgICAgICAgICAgIE5vdCB2YWxpZCB1cmwhPC9zcGFuPlxuICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgPHR0PnRleHQgPSB7e3VybC50ZXh0fX08L3R0Pjxici8+XG4gICAgICAgICAgIDx0dD5teUZvcm0uaW5wdXQuJHZhbGlkID0ge3tteUZvcm0uaW5wdXQuJHZhbGlkfX08L3R0Pjxici8+XG4gICAgICAgICAgIDx0dD5teUZvcm0uaW5wdXQuJGVycm9yID0ge3tteUZvcm0uaW5wdXQuJGVycm9yfX08L3R0Pjxici8+XG4gICAgICAgICAgIDx0dD5teUZvcm0uJHZhbGlkID0ge3tteUZvcm0uJHZhbGlkfX08L3R0Pjxici8+XG4gICAgICAgICAgIDx0dD5teUZvcm0uJGVycm9yLnJlcXVpcmVkID0ge3shIW15Rm9ybS4kZXJyb3IucmVxdWlyZWR9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IudXJsID0ge3shIW15Rm9ybS4kZXJyb3IudXJsfX08L3R0Pjxici8+XG4gICAgICAgICAgPC9mb3JtPlxuICAgICAgICA8L2ZpbGU+XG4gICAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgICAgICB2YXIgdGV4dCA9IGVsZW1lbnQoYnkuYmluZGluZygndXJsLnRleHQnKSk7XG4gICAgICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuICAgICAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ3VybC50ZXh0JykpO1xuXG4gICAgICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBleHBlY3QodGV4dC5nZXRUZXh0KCkpLnRvQ29udGFpbignaHR0cDovL2dvb2dsZS5jb20nKTtcbiAgICAgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbigndHJ1ZScpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIGVtcHR5JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpbnB1dC5jbGVhcigpO1xuICAgICAgICAgICAgaW5wdXQuc2VuZEtleXMoJycpO1xuXG4gICAgICAgICAgICBleHBlY3QodGV4dC5nZXRUZXh0KCkpLnRvRXF1YWwoJ3RleHQgPScpO1xuICAgICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdmYWxzZScpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIG5vdCB1cmwnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlucHV0LmNsZWFyKCk7XG4gICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygnYm94Jyk7XG5cbiAgICAgICAgICAgIGV4cGVjdCh2YWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgPC9maWxlPlxuICAgICAgPC9leGFtcGxlPlxuICAgKi9cbiAgJ3VybCc6IHVybElucHV0VHlwZSxcblxuXG4gIC8qKlxuICAgKiBAbmdkb2MgaW5wdXRcbiAgICogQG5hbWUgaW5wdXRbZW1haWxdXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBUZXh0IGlucHV0IHdpdGggZW1haWwgdmFsaWRhdGlvbi4gU2V0cyB0aGUgYGVtYWlsYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiBub3QgYSB2YWxpZCBlbWFpbFxuICAgKiBhZGRyZXNzLlxuICAgKlxuICAgKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuICAgKiAqKk5vdGU6KiogYGlucHV0W2VtYWlsXWAgdXNlcyBhIHJlZ2V4IHRvIHZhbGlkYXRlIGVtYWlsIGFkZHJlc3NlcyB0aGF0IGlzIGRlcml2ZWQgZnJvbSB0aGUgcmVnZXhcbiAgICogdXNlZCBpbiBDaHJvbWl1bS4gSWYgeW91IG5lZWQgc3RyaWN0ZXIgdmFsaWRhdGlvbiAoZS5nLiByZXF1aXJpbmcgYSB0b3AtbGV2ZWwgZG9tYWluKSwgeW91IGNhblxuICAgKiB1c2UgYG5nLXBhdHRlcm5gIG9yIG1vZGlmeSB0aGUgYnVpbHQtaW4gdmFsaWRhdG9ycyAoc2VlIHRoZSB7QGxpbmsgZ3VpZGUvZm9ybXMgRm9ybXMgZ3VpZGV9KVxuICAgKiA8L2Rpdj5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gcmVxdWlyZWQgU2V0cyBgcmVxdWlyZWRgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBub3QgZW50ZXJlZC5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ1JlcXVpcmVkIEFkZHMgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgYW5kIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvXG4gICAqICAgIHRoZSBlbGVtZW50IHdoZW4gdGhlIG5nUmVxdWlyZWQgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gdHJ1ZS4gVXNlIGBuZ1JlcXVpcmVkYCBpbnN0ZWFkIG9mXG4gICAqICAgIGByZXF1aXJlZGAgd2hlbiB5b3Ugd2FudCB0byBkYXRhLWJpbmQgdG8gdGhlIGByZXF1aXJlZGAgYXR0cmlidXRlLlxuICAgKiBAcGFyYW0ge251bWJlcj19IG5nTWlubGVuZ3RoIFNldHMgYG1pbmxlbmd0aGAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIHZhbHVlIGlzIHNob3J0ZXIgdGhhblxuICAgKiAgICBtaW5sZW5ndGguXG4gICAqIEBwYXJhbSB7bnVtYmVyPX0gbmdNYXhsZW5ndGggU2V0cyBgbWF4bGVuZ3RoYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbG9uZ2VyIHRoYW5cbiAgICogICAgbWF4bGVuZ3RoLiBTZXR0aW5nIHRoZSBhdHRyaWJ1dGUgdG8gYSBuZWdhdGl2ZSBvciBub24tbnVtZXJpYyB2YWx1ZSwgYWxsb3dzIHZpZXcgdmFsdWVzIG9mXG4gICAqICAgIGFueSBsZW5ndGguXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gcGF0dGVybiBTaW1pbGFyIHRvIGBuZ1BhdHRlcm5gIGV4Y2VwdCB0aGF0IHRoZSBhdHRyaWJ1dGUgdmFsdWUgaXMgdGhlIGFjdHVhbCBzdHJpbmdcbiAgICogICAgdGhhdCBjb250YWlucyB0aGUgcmVndWxhciBleHByZXNzaW9uIGJvZHkgdGhhdCB3aWxsIGJlIGNvbnZlcnRlZCB0byBhIHJlZ3VsYXIgZXhwcmVzc2lvblxuICAgKiAgICBhcyBpbiB0aGUgbmdQYXR0ZXJuIGRpcmVjdGl2ZS5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ1BhdHRlcm4gU2V0cyBgcGF0dGVybmAgdmFsaWRhdGlvbiBlcnJvciBrZXkgaWYgdGhlIG5nTW9kZWwge0BsaW5rIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHZpZXdWYWx1ZSAkdmlld1ZhbHVlfVxuICAgKiAgICBkb2VzIG5vdCBtYXRjaCBhIFJlZ0V4cCBmb3VuZCBieSBldmFsdWF0aW5nIHRoZSBBbmd1bGFyIGV4cHJlc3Npb24gZ2l2ZW4gaW4gdGhlIGF0dHJpYnV0ZSB2YWx1ZS5cbiAgICogICAgSWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgUmVnRXhwIG9iamVjdCwgdGhlbiB0aGlzIGlzIHVzZWQgZGlyZWN0bHkuXG4gICAqICAgIElmIHRoZSBleHByZXNzaW9uIGV2YWx1YXRlcyB0byBhIHN0cmluZywgdGhlbiBpdCB3aWxsIGJlIGNvbnZlcnRlZCB0byBhIFJlZ0V4cFxuICAgKiAgICBhZnRlciB3cmFwcGluZyBpdCBpbiBgXmAgYW5kIGAkYCBjaGFyYWN0ZXJzLiBGb3IgaW5zdGFuY2UsIGBcImFiY1wiYCB3aWxsIGJlIGNvbnZlcnRlZCB0b1xuICAgKiAgICBgbmV3IFJlZ0V4cCgnXmFiYyQnKWAuPGJyIC8+XG4gICAqICAgICoqTm90ZToqKiBBdm9pZCB1c2luZyB0aGUgYGdgIGZsYWcgb24gdGhlIFJlZ0V4cCwgYXMgaXQgd2lsbCBjYXVzZSBlYWNoIHN1Y2Nlc3NpdmUgc2VhcmNoIHRvXG4gICAqICAgIHN0YXJ0IGF0IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBzZWFyY2gncyBtYXRjaCwgdGh1cyBub3QgdGFraW5nIHRoZSB3aG9sZSBpbnB1dCB2YWx1ZSBpbnRvXG4gICAqICAgIGFjY291bnQuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbmdDaGFuZ2UgQW5ndWxhciBleHByZXNzaW9uIHRvIGJlIGV4ZWN1dGVkIHdoZW4gaW5wdXQgY2hhbmdlcyBkdWUgdG8gdXNlclxuICAgKiAgICBpbnRlcmFjdGlvbiB3aXRoIHRoZSBpbnB1dCBlbGVtZW50LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgICAgPGV4YW1wbGUgbmFtZT1cImVtYWlsLWlucHV0LWRpcmVjdGl2ZVwiIG1vZHVsZT1cImVtYWlsRXhhbXBsZVwiPlxuICAgICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgICAgPHNjcmlwdD5cbiAgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2VtYWlsRXhhbXBsZScsIFtdKVxuICAgICAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgICAgICAkc2NvcGUuZW1haWwgPSB7XG4gICAgICAgICAgICAgICAgIHRleHQ6ICdtZUBleGFtcGxlLmNvbSdcbiAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgfV0pO1xuICAgICAgICAgPC9zY3JpcHQ+XG4gICAgICAgICAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiAgICAgICAgICAgICA8bGFiZWw+RW1haWw6XG4gICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImVtYWlsXCIgbmFtZT1cImlucHV0XCIgbmctbW9kZWw9XCJlbWFpbC50ZXh0XCIgcmVxdWlyZWQ+XG4gICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgICA8ZGl2IHJvbGU9XCJhbGVydFwiPlxuICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0uaW5wdXQuJGVycm9yLnJlcXVpcmVkXCI+XG4gICAgICAgICAgICAgICAgIFJlcXVpcmVkITwvc3Bhbj5cbiAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLmlucHV0LiRlcnJvci5lbWFpbFwiPlxuICAgICAgICAgICAgICAgICBOb3QgdmFsaWQgZW1haWwhPC9zcGFuPlxuICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgIDx0dD50ZXh0ID0ge3tlbWFpbC50ZXh0fX08L3R0Pjxici8+XG4gICAgICAgICAgICAgPHR0Pm15Rm9ybS5pbnB1dC4kdmFsaWQgPSB7e215Rm9ybS5pbnB1dC4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgICA8dHQ+bXlGb3JtLmlucHV0LiRlcnJvciA9IHt7bXlGb3JtLmlucHV0LiRlcnJvcn19PC90dD48YnIvPlxuICAgICAgICAgICAgIDx0dD5teUZvcm0uJHZhbGlkID0ge3tteUZvcm0uJHZhbGlkfX08L3R0Pjxici8+XG4gICAgICAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IucmVxdWlyZWQgPSB7eyEhbXlGb3JtLiRlcnJvci5yZXF1aXJlZH19PC90dD48YnIvPlxuICAgICAgICAgICAgIDx0dD5teUZvcm0uJGVycm9yLmVtYWlsID0ge3shIW15Rm9ybS4kZXJyb3IuZW1haWx9fTwvdHQ+PGJyLz5cbiAgICAgICAgICAgPC9mb3JtPlxuICAgICAgICAgPC9maWxlPlxuICAgICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgICAgdmFyIHRleHQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2VtYWlsLnRleHQnKSk7XG4gICAgICAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0uaW5wdXQuJHZhbGlkJykpO1xuICAgICAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ2VtYWlsLnRleHQnKSk7XG5cbiAgICAgICAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgdG8gbW9kZWwnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGV4cGVjdCh0ZXh0LmdldFRleHQoKSkudG9Db250YWluKCdtZUBleGFtcGxlLmNvbScpO1xuICAgICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCd0cnVlJyk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgZW1wdHknLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlucHV0LmNsZWFyKCk7XG4gICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygnJyk7XG4gICAgICAgICAgICBleHBlY3QodGV4dC5nZXRUZXh0KCkpLnRvRXF1YWwoJ3RleHQgPScpO1xuICAgICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdmYWxzZScpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIG5vdCBlbWFpbCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaW5wdXQuY2xlYXIoKTtcbiAgICAgICAgICAgIGlucHV0LnNlbmRLZXlzKCd4eHgnKTtcblxuICAgICAgICAgICAgZXhwZWN0KHZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCdmYWxzZScpO1xuICAgICAgICAgIH0pO1xuICAgICAgICA8L2ZpbGU+XG4gICAgICA8L2V4YW1wbGU+XG4gICAqL1xuICAnZW1haWwnOiBlbWFpbElucHV0VHlwZSxcblxuXG4gIC8qKlxuICAgKiBAbmdkb2MgaW5wdXRcbiAgICogQG5hbWUgaW5wdXRbcmFkaW9dXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBIVE1MIHJhZGlvIGJ1dHRvbi5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgVGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBgbmdNb2RlbGAgZXhwcmVzc2lvbiBzaG91bGQgYmUgc2V0IHdoZW4gc2VsZWN0ZWQuXG4gICAqICAgIE5vdGUgdGhhdCBgdmFsdWVgIG9ubHkgc3VwcG9ydHMgYHN0cmluZ2AgdmFsdWVzLCBpLmUuIHRoZSBzY29wZSBtb2RlbCBuZWVkcyB0byBiZSBhIHN0cmluZyxcbiAgICogICAgdG9vLiBVc2UgYG5nVmFsdWVgIGlmIHlvdSBuZWVkIGNvbXBsZXggbW9kZWxzIChgbnVtYmVyYCwgYG9iamVjdGAsIC4uLikuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBuZ0NoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyXG4gICAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuZ1ZhbHVlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byB3aGljaCBgbmdNb2RlbGAgd2lsbCBiZSBiZSBzZXQgd2hlbiB0aGUgcmFkaW9cbiAgICogICAgaXMgc2VsZWN0ZWQuIFNob3VsZCBiZSB1c2VkIGluc3RlYWQgb2YgdGhlIGB2YWx1ZWAgYXR0cmlidXRlIGlmIHlvdSBuZWVkXG4gICAqICAgIGEgbm9uLXN0cmluZyBgbmdNb2RlbGAgKGBib29sZWFuYCwgYGFycmF5YCwgLi4uKS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICAgIDxleGFtcGxlIG5hbWU9XCJyYWRpby1pbnB1dC1kaXJlY3RpdmVcIiBtb2R1bGU9XCJyYWRpb0V4YW1wbGVcIj5cbiAgICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICAgIDxzY3JpcHQ+XG4gICAgICAgICAgIGFuZ3VsYXIubW9kdWxlKCdyYWRpb0V4YW1wbGUnLCBbXSlcbiAgICAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICAgICAgJHNjb3BlLmNvbG9yID0ge1xuICAgICAgICAgICAgICAgICBuYW1lOiAnYmx1ZSdcbiAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAkc2NvcGUuc3BlY2lhbFZhbHVlID0ge1xuICAgICAgICAgICAgICAgICBcImlkXCI6IFwiMTIzNDVcIixcbiAgICAgICAgICAgICAgICAgXCJ2YWx1ZVwiOiBcImdyZWVuXCJcbiAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgfV0pO1xuICAgICAgICAgPC9zY3JpcHQ+XG4gICAgICAgICA8Zm9ybSBuYW1lPVwibXlGb3JtXCIgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInJhZGlvXCIgbmctbW9kZWw9XCJjb2xvci5uYW1lXCIgdmFsdWU9XCJyZWRcIj5cbiAgICAgICAgICAgICBSZWRcbiAgICAgICAgICAgPC9sYWJlbD48YnIvPlxuICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5nLW1vZGVsPVwiY29sb3IubmFtZVwiIG5nLXZhbHVlPVwic3BlY2lhbFZhbHVlXCI+XG4gICAgICAgICAgICAgR3JlZW5cbiAgICAgICAgICAgPC9sYWJlbD48YnIvPlxuICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5nLW1vZGVsPVwiY29sb3IubmFtZVwiIHZhbHVlPVwiYmx1ZVwiPlxuICAgICAgICAgICAgIEJsdWVcbiAgICAgICAgICAgPC9sYWJlbD48YnIvPlxuICAgICAgICAgICA8dHQ+Y29sb3IgPSB7e2NvbG9yLm5hbWUgfCBqc29ufX08L3R0Pjxici8+XG4gICAgICAgICAgPC9mb3JtPlxuICAgICAgICAgIE5vdGUgdGhhdCBgbmctdmFsdWU9XCJzcGVjaWFsVmFsdWVcImAgc2V0cyByYWRpbyBpdGVtJ3MgdmFsdWUgdG8gYmUgdGhlIHZhbHVlIG9mIGAkc2NvcGUuc3BlY2lhbFZhbHVlYC5cbiAgICAgICAgPC9maWxlPlxuICAgICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgICAgaXQoJ3Nob3VsZCBjaGFuZ2Ugc3RhdGUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBjb2xvciA9IGVsZW1lbnQoYnkuYmluZGluZygnY29sb3IubmFtZScpKTtcblxuICAgICAgICAgICAgZXhwZWN0KGNvbG9yLmdldFRleHQoKSkudG9Db250YWluKCdibHVlJyk7XG5cbiAgICAgICAgICAgIGVsZW1lbnQuYWxsKGJ5Lm1vZGVsKCdjb2xvci5uYW1lJykpLmdldCgwKS5jbGljaygpO1xuXG4gICAgICAgICAgICBleHBlY3QoY29sb3IuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3JlZCcpO1xuICAgICAgICAgIH0pO1xuICAgICAgICA8L2ZpbGU+XG4gICAgICA8L2V4YW1wbGU+XG4gICAqL1xuICAncmFkaW8nOiByYWRpb0lucHV0VHlwZSxcblxuXG4gIC8qKlxuICAgKiBAbmdkb2MgaW5wdXRcbiAgICogQG5hbWUgaW5wdXRbY2hlY2tib3hdXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBIVE1MIGNoZWNrYm94LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmdNb2RlbCBBc3NpZ25hYmxlIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBkYXRhLWJpbmQgdG8uXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cbiAgICogQHBhcmFtIHtleHByZXNzaW9uPX0gbmdUcnVlVmFsdWUgVGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBleHByZXNzaW9uIHNob3VsZCBiZSBzZXQgd2hlbiBzZWxlY3RlZC5cbiAgICogQHBhcmFtIHtleHByZXNzaW9uPX0gbmdGYWxzZVZhbHVlIFRoZSB2YWx1ZSB0byB3aGljaCB0aGUgZXhwcmVzc2lvbiBzaG91bGQgYmUgc2V0IHdoZW4gbm90IHNlbGVjdGVkLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcbiAgICogICAgaW50ZXJhY3Rpb24gd2l0aCB0aGUgaW5wdXQgZWxlbWVudC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICAgIDxleGFtcGxlIG5hbWU9XCJjaGVja2JveC1pbnB1dC1kaXJlY3RpdmVcIiBtb2R1bGU9XCJjaGVja2JveEV4YW1wbGVcIj5cbiAgICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICAgIDxzY3JpcHQ+XG4gICAgICAgICAgIGFuZ3VsYXIubW9kdWxlKCdjaGVja2JveEV4YW1wbGUnLCBbXSlcbiAgICAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICAgICAgJHNjb3BlLmNoZWNrYm94TW9kZWwgPSB7XG4gICAgICAgICAgICAgICAgdmFsdWUxIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB2YWx1ZTIgOiAnWUVTJ1xuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgIH1dKTtcbiAgICAgICAgIDwvc2NyaXB0PlxuICAgICAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiIG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICAgICAgICA8bGFiZWw+VmFsdWUxOlxuICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cImNoZWNrYm94TW9kZWwudmFsdWUxXCI+XG4gICAgICAgICAgIDwvbGFiZWw+PGJyLz5cbiAgICAgICAgICAgPGxhYmVsPlZhbHVlMjpcbiAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmctbW9kZWw9XCJjaGVja2JveE1vZGVsLnZhbHVlMlwiXG4gICAgICAgICAgICAgICAgICAgIG5nLXRydWUtdmFsdWU9XCInWUVTJ1wiIG5nLWZhbHNlLXZhbHVlPVwiJ05PJ1wiPlxuICAgICAgICAgICAgPC9sYWJlbD48YnIvPlxuICAgICAgICAgICA8dHQ+dmFsdWUxID0ge3tjaGVja2JveE1vZGVsLnZhbHVlMX19PC90dD48YnIvPlxuICAgICAgICAgICA8dHQ+dmFsdWUyID0ge3tjaGVja2JveE1vZGVsLnZhbHVlMn19PC90dD48YnIvPlxuICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgPC9maWxlPlxuICAgICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgICAgaXQoJ3Nob3VsZCBjaGFuZ2Ugc3RhdGUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZTEgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2NoZWNrYm94TW9kZWwudmFsdWUxJykpO1xuICAgICAgICAgICAgdmFyIHZhbHVlMiA9IGVsZW1lbnQoYnkuYmluZGluZygnY2hlY2tib3hNb2RlbC52YWx1ZTInKSk7XG5cbiAgICAgICAgICAgIGV4cGVjdCh2YWx1ZTEuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcbiAgICAgICAgICAgIGV4cGVjdCh2YWx1ZTIuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ1lFUycpO1xuXG4gICAgICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCdjaGVja2JveE1vZGVsLnZhbHVlMScpKS5jbGljaygpO1xuICAgICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnY2hlY2tib3hNb2RlbC52YWx1ZTInKSkuY2xpY2soKTtcblxuICAgICAgICAgICAgZXhwZWN0KHZhbHVlMS5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcbiAgICAgICAgICAgIGV4cGVjdCh2YWx1ZTIuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ05PJyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIDwvZmlsZT5cbiAgICAgIDwvZXhhbXBsZT5cbiAgICovXG4gICdjaGVja2JveCc6IGNoZWNrYm94SW5wdXRUeXBlLFxuXG4gICdoaWRkZW4nOiBub29wLFxuICAnYnV0dG9uJzogbm9vcCxcbiAgJ3N1Ym1pdCc6IG5vb3AsXG4gICdyZXNldCc6IG5vb3AsXG4gICdmaWxlJzogbm9vcFxufTtcblxuZnVuY3Rpb24gc3RyaW5nQmFzZWRJbnB1dFR5cGUoY3RybCkge1xuICBjdHJsLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gY3RybC4kaXNFbXB0eSh2YWx1ZSkgPyB2YWx1ZSA6IHZhbHVlLnRvU3RyaW5nKCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB0ZXh0SW5wdXRUeXBlKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsLCAkc25pZmZlciwgJGJyb3dzZXIpIHtcbiAgYmFzZUlucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyKTtcbiAgc3RyaW5nQmFzZWRJbnB1dFR5cGUoY3RybCk7XG59XG5cbmZ1bmN0aW9uIGJhc2VJbnB1dFR5cGUoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwsICRzbmlmZmVyLCAkYnJvd3Nlcikge1xuICB2YXIgdHlwZSA9IGxvd2VyY2FzZShlbGVtZW50WzBdLnR5cGUpO1xuXG4gIC8vIEluIGNvbXBvc2l0aW9uIG1vZGUsIHVzZXJzIGFyZSBzdGlsbCBpbnB1dGluZyBpbnRlcm1lZGlhdGUgdGV4dCBidWZmZXIsXG4gIC8vIGhvbGQgdGhlIGxpc3RlbmVyIHVudGlsIGNvbXBvc2l0aW9uIGlzIGRvbmUuXG4gIC8vIE1vcmUgYWJvdXQgY29tcG9zaXRpb24gZXZlbnRzOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQ29tcG9zaXRpb25FdmVudFxuICBpZiAoISRzbmlmZmVyLmFuZHJvaWQpIHtcbiAgICB2YXIgY29tcG9zaW5nID0gZmFsc2U7XG5cbiAgICBlbGVtZW50Lm9uKCdjb21wb3NpdGlvbnN0YXJ0JywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgY29tcG9zaW5nID0gdHJ1ZTtcbiAgICB9KTtcblxuICAgIGVsZW1lbnQub24oJ2NvbXBvc2l0aW9uZW5kJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb21wb3NpbmcgPSBmYWxzZTtcbiAgICAgIGxpc3RlbmVyKCk7XG4gICAgfSk7XG4gIH1cblxuICB2YXIgbGlzdGVuZXIgPSBmdW5jdGlvbihldikge1xuICAgIGlmICh0aW1lb3V0KSB7XG4gICAgICAkYnJvd3Nlci5kZWZlci5jYW5jZWwodGltZW91dCk7XG4gICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICB9XG4gICAgaWYgKGNvbXBvc2luZykgcmV0dXJuO1xuICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQudmFsKCksXG4gICAgICAgIGV2ZW50ID0gZXYgJiYgZXYudHlwZTtcblxuICAgIC8vIEJ5IGRlZmF1bHQgd2Ugd2lsbCB0cmltIHRoZSB2YWx1ZVxuICAgIC8vIElmIHRoZSBhdHRyaWJ1dGUgbmctdHJpbSBleGlzdHMgd2Ugd2lsbCBhdm9pZCB0cmltbWluZ1xuICAgIC8vIElmIGlucHV0IHR5cGUgaXMgJ3Bhc3N3b3JkJywgdGhlIHZhbHVlIGlzIG5ldmVyIHRyaW1tZWRcbiAgICBpZiAodHlwZSAhPT0gJ3Bhc3N3b3JkJyAmJiAoIWF0dHIubmdUcmltIHx8IGF0dHIubmdUcmltICE9PSAnZmFsc2UnKSkge1xuICAgICAgdmFsdWUgPSB0cmltKHZhbHVlKTtcbiAgICB9XG5cbiAgICAvLyBJZiBhIGNvbnRyb2wgaXMgc3VmZmVyaW5nIGZyb20gYmFkIGlucHV0IChkdWUgdG8gbmF0aXZlIHZhbGlkYXRvcnMpLCBicm93c2VycyBkaXNjYXJkIGl0c1xuICAgIC8vIHZhbHVlLCBzbyBpdCBtYXkgYmUgbmVjZXNzYXJ5IHRvIHJldmFsaWRhdGUgKGJ5IGNhbGxpbmcgJHNldFZpZXdWYWx1ZSBhZ2FpbikgZXZlbiBpZiB0aGVcbiAgICAvLyBjb250cm9sJ3MgdmFsdWUgaXMgdGhlIHNhbWUgZW1wdHkgdmFsdWUgdHdpY2UgaW4gYSByb3cuXG4gICAgaWYgKGN0cmwuJHZpZXdWYWx1ZSAhPT0gdmFsdWUgfHwgKHZhbHVlID09PSAnJyAmJiBjdHJsLiQkaGFzTmF0aXZlVmFsaWRhdG9ycykpIHtcbiAgICAgIGN0cmwuJHNldFZpZXdWYWx1ZSh2YWx1ZSwgZXZlbnQpO1xuICAgIH1cbiAgfTtcblxuICAvLyBpZiB0aGUgYnJvd3NlciBkb2VzIHN1cHBvcnQgXCJpbnB1dFwiIGV2ZW50LCB3ZSBhcmUgZmluZSAtIGV4Y2VwdCBvbiBJRTkgd2hpY2ggZG9lc24ndCBmaXJlIHRoZVxuICAvLyBpbnB1dCBldmVudCBvbiBiYWNrc3BhY2UsIGRlbGV0ZSBvciBjdXRcbiAgaWYgKCRzbmlmZmVyLmhhc0V2ZW50KCdpbnB1dCcpKSB7XG4gICAgZWxlbWVudC5vbignaW5wdXQnLCBsaXN0ZW5lcik7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHRpbWVvdXQ7XG5cbiAgICB2YXIgZGVmZXJMaXN0ZW5lciA9IGZ1bmN0aW9uKGV2LCBpbnB1dCwgb3JpZ1ZhbHVlKSB7XG4gICAgICBpZiAoIXRpbWVvdXQpIHtcbiAgICAgICAgdGltZW91dCA9ICRicm93c2VyLmRlZmVyKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgICAgIGlmICghaW5wdXQgfHwgaW5wdXQudmFsdWUgIT09IG9yaWdWYWx1ZSkge1xuICAgICAgICAgICAgbGlzdGVuZXIoZXYpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGVsZW1lbnQub24oJ2tleWRvd24nLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgdmFyIGtleSA9IGV2ZW50LmtleUNvZGU7XG5cbiAgICAgIC8vIGlnbm9yZVxuICAgICAgLy8gICAgY29tbWFuZCAgICAgICAgICAgIG1vZGlmaWVycyAgICAgICAgICAgICAgICAgICBhcnJvd3NcbiAgICAgIGlmIChrZXkgPT09IDkxIHx8ICgxNSA8IGtleSAmJiBrZXkgPCAxOSkgfHwgKDM3IDw9IGtleSAmJiBrZXkgPD0gNDApKSByZXR1cm47XG5cbiAgICAgIGRlZmVyTGlzdGVuZXIoZXZlbnQsIHRoaXMsIHRoaXMudmFsdWUpO1xuICAgIH0pO1xuXG4gICAgLy8gaWYgdXNlciBtb2RpZmllcyBpbnB1dCB2YWx1ZSB1c2luZyBjb250ZXh0IG1lbnUgaW4gSUUsIHdlIG5lZWQgXCJwYXN0ZVwiIGFuZCBcImN1dFwiIGV2ZW50cyB0byBjYXRjaCBpdFxuICAgIGlmICgkc25pZmZlci5oYXNFdmVudCgncGFzdGUnKSkge1xuICAgICAgZWxlbWVudC5vbigncGFzdGUgY3V0JywgZGVmZXJMaXN0ZW5lcik7XG4gICAgfVxuICB9XG5cbiAgLy8gaWYgdXNlciBwYXN0ZSBpbnRvIGlucHV0IHVzaW5nIG1vdXNlIG9uIG9sZGVyIGJyb3dzZXJcbiAgLy8gb3IgZm9ybSBhdXRvY29tcGxldGUgb24gbmV3ZXIgYnJvd3Nlciwgd2UgbmVlZCBcImNoYW5nZVwiIGV2ZW50IHRvIGNhdGNoIGl0XG4gIGVsZW1lbnQub24oJ2NoYW5nZScsIGxpc3RlbmVyKTtcblxuICBjdHJsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBXb3JrYXJvdW5kIGZvciBGaXJlZm94IHZhbGlkYXRpb24gIzEyMTAyLlxuICAgIHZhciB2YWx1ZSA9IGN0cmwuJGlzRW1wdHkoY3RybC4kdmlld1ZhbHVlKSA/ICcnIDogY3RybC4kdmlld1ZhbHVlO1xuICAgIGlmIChlbGVtZW50LnZhbCgpICE9PSB2YWx1ZSkge1xuICAgICAgZWxlbWVudC52YWwodmFsdWUpO1xuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gd2Vla1BhcnNlcihpc29XZWVrLCBleGlzdGluZ0RhdGUpIHtcbiAgaWYgKGlzRGF0ZShpc29XZWVrKSkge1xuICAgIHJldHVybiBpc29XZWVrO1xuICB9XG5cbiAgaWYgKGlzU3RyaW5nKGlzb1dlZWspKSB7XG4gICAgV0VFS19SRUdFWFAubGFzdEluZGV4ID0gMDtcbiAgICB2YXIgcGFydHMgPSBXRUVLX1JFR0VYUC5leGVjKGlzb1dlZWspO1xuICAgIGlmIChwYXJ0cykge1xuICAgICAgdmFyIHllYXIgPSArcGFydHNbMV0sXG4gICAgICAgICAgd2VlayA9ICtwYXJ0c1syXSxcbiAgICAgICAgICBob3VycyA9IDAsXG4gICAgICAgICAgbWludXRlcyA9IDAsXG4gICAgICAgICAgc2Vjb25kcyA9IDAsXG4gICAgICAgICAgbWlsbGlzZWNvbmRzID0gMCxcbiAgICAgICAgICBmaXJzdFRodXJzID0gZ2V0Rmlyc3RUaHVyc2RheU9mWWVhcih5ZWFyKSxcbiAgICAgICAgICBhZGREYXlzID0gKHdlZWsgLSAxKSAqIDc7XG5cbiAgICAgIGlmIChleGlzdGluZ0RhdGUpIHtcbiAgICAgICAgaG91cnMgPSBleGlzdGluZ0RhdGUuZ2V0SG91cnMoKTtcbiAgICAgICAgbWludXRlcyA9IGV4aXN0aW5nRGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgICAgIHNlY29uZHMgPSBleGlzdGluZ0RhdGUuZ2V0U2Vjb25kcygpO1xuICAgICAgICBtaWxsaXNlY29uZHMgPSBleGlzdGluZ0RhdGUuZ2V0TWlsbGlzZWNvbmRzKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBuZXcgRGF0ZSh5ZWFyLCAwLCBmaXJzdFRodXJzLmdldERhdGUoKSArIGFkZERheXMsIGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzLCBtaWxsaXNlY29uZHMpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBOYU47XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZURhdGVQYXJzZXIocmVnZXhwLCBtYXBwaW5nKSB7XG4gIHJldHVybiBmdW5jdGlvbihpc28sIGRhdGUpIHtcbiAgICB2YXIgcGFydHMsIG1hcDtcblxuICAgIGlmIChpc0RhdGUoaXNvKSkge1xuICAgICAgcmV0dXJuIGlzbztcbiAgICB9XG5cbiAgICBpZiAoaXNTdHJpbmcoaXNvKSkge1xuICAgICAgLy8gV2hlbiBhIGRhdGUgaXMgSlNPTidpZmllZCB0byB3cmFwcyBpdHNlbGYgaW5zaWRlIG9mIGFuIGV4dHJhXG4gICAgICAvLyBzZXQgb2YgZG91YmxlIHF1b3Rlcy4gVGhpcyBtYWtlcyB0aGUgZGF0ZSBwYXJzaW5nIGNvZGUgdW5hYmxlXG4gICAgICAvLyB0byBtYXRjaCB0aGUgZGF0ZSBzdHJpbmcgYW5kIHBhcnNlIGl0IGFzIGEgZGF0ZS5cbiAgICAgIGlmIChpc28uY2hhckF0KDApID09ICdcIicgJiYgaXNvLmNoYXJBdChpc28ubGVuZ3RoIC0gMSkgPT0gJ1wiJykge1xuICAgICAgICBpc28gPSBpc28uc3Vic3RyaW5nKDEsIGlzby5sZW5ndGggLSAxKTtcbiAgICAgIH1cbiAgICAgIGlmIChJU09fREFURV9SRUdFWFAudGVzdChpc28pKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShpc28pO1xuICAgICAgfVxuICAgICAgcmVnZXhwLmxhc3RJbmRleCA9IDA7XG4gICAgICBwYXJ0cyA9IHJlZ2V4cC5leGVjKGlzbyk7XG5cbiAgICAgIGlmIChwYXJ0cykge1xuICAgICAgICBwYXJ0cy5zaGlmdCgpO1xuICAgICAgICBpZiAoZGF0ZSkge1xuICAgICAgICAgIG1hcCA9IHtcbiAgICAgICAgICAgIHl5eXk6IGRhdGUuZ2V0RnVsbFllYXIoKSxcbiAgICAgICAgICAgIE1NOiBkYXRlLmdldE1vbnRoKCkgKyAxLFxuICAgICAgICAgICAgZGQ6IGRhdGUuZ2V0RGF0ZSgpLFxuICAgICAgICAgICAgSEg6IGRhdGUuZ2V0SG91cnMoKSxcbiAgICAgICAgICAgIG1tOiBkYXRlLmdldE1pbnV0ZXMoKSxcbiAgICAgICAgICAgIHNzOiBkYXRlLmdldFNlY29uZHMoKSxcbiAgICAgICAgICAgIHNzczogZGF0ZS5nZXRNaWxsaXNlY29uZHMoKSAvIDEwMDBcbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1hcCA9IHsgeXl5eTogMTk3MCwgTU06IDEsIGRkOiAxLCBISDogMCwgbW06IDAsIHNzOiAwLCBzc3M6IDAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvckVhY2gocGFydHMsIGZ1bmN0aW9uKHBhcnQsIGluZGV4KSB7XG4gICAgICAgICAgaWYgKGluZGV4IDwgbWFwcGluZy5sZW5ndGgpIHtcbiAgICAgICAgICAgIG1hcFttYXBwaW5nW2luZGV4XV0gPSArcGFydDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbmV3IERhdGUobWFwLnl5eXksIG1hcC5NTSAtIDEsIG1hcC5kZCwgbWFwLkhILCBtYXAubW0sIG1hcC5zcyB8fCAwLCBtYXAuc3NzICogMTAwMCB8fCAwKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gTmFOO1xuICB9O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVEYXRlSW5wdXRUeXBlKHR5cGUsIHJlZ2V4cCwgcGFyc2VEYXRlLCBmb3JtYXQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGR5bmFtaWNEYXRlSW5wdXRUeXBlKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsLCAkc25pZmZlciwgJGJyb3dzZXIsICRmaWx0ZXIpIHtcbiAgICBiYWRJbnB1dENoZWNrZXIoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwpO1xuICAgIGJhc2VJbnB1dFR5cGUoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwsICRzbmlmZmVyLCAkYnJvd3Nlcik7XG4gICAgdmFyIHRpbWV6b25lID0gY3RybCAmJiBjdHJsLiRvcHRpb25zICYmIGN0cmwuJG9wdGlvbnMudGltZXpvbmU7XG4gICAgdmFyIHByZXZpb3VzRGF0ZTtcblxuICAgIGN0cmwuJCRwYXJzZXJOYW1lID0gdHlwZTtcbiAgICBjdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIGlmIChjdHJsLiRpc0VtcHR5KHZhbHVlKSkgcmV0dXJuIG51bGw7XG4gICAgICBpZiAocmVnZXhwLnRlc3QodmFsdWUpKSB7XG4gICAgICAgIC8vIE5vdGU6IFdlIGNhbm5vdCByZWFkIGN0cmwuJG1vZGVsVmFsdWUsIGFzIHRoZXJlIG1pZ2h0IGJlIGEgZGlmZmVyZW50XG4gICAgICAgIC8vIHBhcnNlci9mb3JtYXR0ZXIgaW4gdGhlIHByb2Nlc3NpbmcgY2hhaW4gc28gdGhhdCB0aGUgbW9kZWxcbiAgICAgICAgLy8gY29udGFpbnMgc29tZSBkaWZmZXJlbnQgZGF0YSBmb3JtYXQhXG4gICAgICAgIHZhciBwYXJzZWREYXRlID0gcGFyc2VEYXRlKHZhbHVlLCBwcmV2aW91c0RhdGUpO1xuICAgICAgICBpZiAodGltZXpvbmUpIHtcbiAgICAgICAgICBwYXJzZWREYXRlID0gY29udmVydFRpbWV6b25lVG9Mb2NhbChwYXJzZWREYXRlLCB0aW1lem9uZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcnNlZERhdGU7XG4gICAgICB9XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH0pO1xuXG4gICAgY3RybC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgJiYgIWlzRGF0ZSh2YWx1ZSkpIHtcbiAgICAgICAgdGhyb3cgbmdNb2RlbE1pbkVycignZGF0ZWZtdCcsICdFeHBlY3RlZCBgezB9YCB0byBiZSBhIGRhdGUnLCB2YWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAoaXNWYWxpZERhdGUodmFsdWUpKSB7XG4gICAgICAgIHByZXZpb3VzRGF0ZSA9IHZhbHVlO1xuICAgICAgICBpZiAocHJldmlvdXNEYXRlICYmIHRpbWV6b25lKSB7XG4gICAgICAgICAgcHJldmlvdXNEYXRlID0gY29udmVydFRpbWV6b25lVG9Mb2NhbChwcmV2aW91c0RhdGUsIHRpbWV6b25lLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJGZpbHRlcignZGF0ZScpKHZhbHVlLCBmb3JtYXQsIHRpbWV6b25lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByZXZpb3VzRGF0ZSA9IG51bGw7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChpc0RlZmluZWQoYXR0ci5taW4pIHx8IGF0dHIubmdNaW4pIHtcbiAgICAgIHZhciBtaW5WYWw7XG4gICAgICBjdHJsLiR2YWxpZGF0b3JzLm1pbiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAhaXNWYWxpZERhdGUodmFsdWUpIHx8IGlzVW5kZWZpbmVkKG1pblZhbCkgfHwgcGFyc2VEYXRlKHZhbHVlKSA+PSBtaW5WYWw7XG4gICAgICB9O1xuICAgICAgYXR0ci4kb2JzZXJ2ZSgnbWluJywgZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIG1pblZhbCA9IHBhcnNlT2JzZXJ2ZWREYXRlVmFsdWUodmFsKTtcbiAgICAgICAgY3RybC4kdmFsaWRhdGUoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChpc0RlZmluZWQoYXR0ci5tYXgpIHx8IGF0dHIubmdNYXgpIHtcbiAgICAgIHZhciBtYXhWYWw7XG4gICAgICBjdHJsLiR2YWxpZGF0b3JzLm1heCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAhaXNWYWxpZERhdGUodmFsdWUpIHx8IGlzVW5kZWZpbmVkKG1heFZhbCkgfHwgcGFyc2VEYXRlKHZhbHVlKSA8PSBtYXhWYWw7XG4gICAgICB9O1xuICAgICAgYXR0ci4kb2JzZXJ2ZSgnbWF4JywgZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIG1heFZhbCA9IHBhcnNlT2JzZXJ2ZWREYXRlVmFsdWUodmFsKTtcbiAgICAgICAgY3RybC4kdmFsaWRhdGUoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzVmFsaWREYXRlKHZhbHVlKSB7XG4gICAgICAvLyBJbnZhbGlkIERhdGU6IGdldFRpbWUoKSByZXR1cm5zIE5hTlxuICAgICAgcmV0dXJuIHZhbHVlICYmICEodmFsdWUuZ2V0VGltZSAmJiB2YWx1ZS5nZXRUaW1lKCkgIT09IHZhbHVlLmdldFRpbWUoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VPYnNlcnZlZERhdGVWYWx1ZSh2YWwpIHtcbiAgICAgIHJldHVybiBpc0RlZmluZWQodmFsKSAmJiAhaXNEYXRlKHZhbCkgPyBwYXJzZURhdGUodmFsKSB8fCB1bmRlZmluZWQgOiB2YWw7XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBiYWRJbnB1dENoZWNrZXIoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwpIHtcbiAgdmFyIG5vZGUgPSBlbGVtZW50WzBdO1xuICB2YXIgbmF0aXZlVmFsaWRhdGlvbiA9IGN0cmwuJCRoYXNOYXRpdmVWYWxpZGF0b3JzID0gaXNPYmplY3Qobm9kZS52YWxpZGl0eSk7XG4gIGlmIChuYXRpdmVWYWxpZGF0aW9uKSB7XG4gICAgY3RybC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgdmFsaWRpdHkgPSBlbGVtZW50LnByb3AoVkFMSURJVFlfU1RBVEVfUFJPUEVSVFkpIHx8IHt9O1xuICAgICAgcmV0dXJuIHZhbGlkaXR5LmJhZElucHV0IHx8IHZhbGlkaXR5LnR5cGVNaXNtYXRjaCA/IHVuZGVmaW5lZCA6IHZhbHVlO1xuICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIG51bWJlcklucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyKSB7XG4gIGJhZElucHV0Q2hlY2tlcihzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCk7XG4gIGJhc2VJbnB1dFR5cGUoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwsICRzbmlmZmVyLCAkYnJvd3Nlcik7XG5cbiAgY3RybC4kJHBhcnNlck5hbWUgPSAnbnVtYmVyJztcbiAgY3RybC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgaWYgKGN0cmwuJGlzRW1wdHkodmFsdWUpKSAgICAgIHJldHVybiBudWxsO1xuICAgIGlmIChOVU1CRVJfUkVHRVhQLnRlc3QodmFsdWUpKSByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfSk7XG5cbiAgY3RybC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgaWYgKCFjdHJsLiRpc0VtcHR5KHZhbHVlKSkge1xuICAgICAgaWYgKCFpc051bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgdGhyb3cgbmdNb2RlbE1pbkVycignbnVtZm10JywgJ0V4cGVjdGVkIGB7MH1gIHRvIGJlIGEgbnVtYmVyJywgdmFsdWUpO1xuICAgICAgfVxuICAgICAgdmFsdWUgPSB2YWx1ZS50b1N0cmluZygpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH0pO1xuXG4gIGlmIChpc0RlZmluZWQoYXR0ci5taW4pIHx8IGF0dHIubmdNaW4pIHtcbiAgICB2YXIgbWluVmFsO1xuICAgIGN0cmwuJHZhbGlkYXRvcnMubWluID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiBjdHJsLiRpc0VtcHR5KHZhbHVlKSB8fCBpc1VuZGVmaW5lZChtaW5WYWwpIHx8IHZhbHVlID49IG1pblZhbDtcbiAgICB9O1xuXG4gICAgYXR0ci4kb2JzZXJ2ZSgnbWluJywgZnVuY3Rpb24odmFsKSB7XG4gICAgICBpZiAoaXNEZWZpbmVkKHZhbCkgJiYgIWlzTnVtYmVyKHZhbCkpIHtcbiAgICAgICAgdmFsID0gcGFyc2VGbG9hdCh2YWwsIDEwKTtcbiAgICAgIH1cbiAgICAgIG1pblZhbCA9IGlzTnVtYmVyKHZhbCkgJiYgIWlzTmFOKHZhbCkgPyB2YWwgOiB1bmRlZmluZWQ7XG4gICAgICAvLyBUT0RPKG1hdHNrbyk6IGltcGxlbWVudCB2YWxpZGF0ZUxhdGVyIHRvIHJlZHVjZSBudW1iZXIgb2YgdmFsaWRhdGlvbnNcbiAgICAgIGN0cmwuJHZhbGlkYXRlKCk7XG4gICAgfSk7XG4gIH1cblxuICBpZiAoaXNEZWZpbmVkKGF0dHIubWF4KSB8fCBhdHRyLm5nTWF4KSB7XG4gICAgdmFyIG1heFZhbDtcbiAgICBjdHJsLiR2YWxpZGF0b3JzLm1heCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gY3RybC4kaXNFbXB0eSh2YWx1ZSkgfHwgaXNVbmRlZmluZWQobWF4VmFsKSB8fCB2YWx1ZSA8PSBtYXhWYWw7XG4gICAgfTtcblxuICAgIGF0dHIuJG9ic2VydmUoJ21heCcsIGZ1bmN0aW9uKHZhbCkge1xuICAgICAgaWYgKGlzRGVmaW5lZCh2YWwpICYmICFpc051bWJlcih2YWwpKSB7XG4gICAgICAgIHZhbCA9IHBhcnNlRmxvYXQodmFsLCAxMCk7XG4gICAgICB9XG4gICAgICBtYXhWYWwgPSBpc051bWJlcih2YWwpICYmICFpc05hTih2YWwpID8gdmFsIDogdW5kZWZpbmVkO1xuICAgICAgLy8gVE9ETyhtYXRza28pOiBpbXBsZW1lbnQgdmFsaWRhdGVMYXRlciB0byByZWR1Y2UgbnVtYmVyIG9mIHZhbGlkYXRpb25zXG4gICAgICBjdHJsLiR2YWxpZGF0ZSgpO1xuICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIHVybElucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyKSB7XG4gIC8vIE5vdGU6IG5vIGJhZElucHV0Q2hlY2tlciBoZXJlIGJ5IHB1cnBvc2UgYXMgYHVybGAgaXMgb25seSBhIHZhbGlkYXRpb25cbiAgLy8gaW4gYnJvd3NlcnMsIGkuZS4gd2UgY2FuIGFsd2F5cyByZWFkIG91dCBpbnB1dC52YWx1ZSBldmVuIGlmIGl0IGlzIG5vdCB2YWxpZCFcbiAgYmFzZUlucHV0VHlwZShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHNuaWZmZXIsICRicm93c2VyKTtcbiAgc3RyaW5nQmFzZWRJbnB1dFR5cGUoY3RybCk7XG5cbiAgY3RybC4kJHBhcnNlck5hbWUgPSAndXJsJztcbiAgY3RybC4kdmFsaWRhdG9ycy51cmwgPSBmdW5jdGlvbihtb2RlbFZhbHVlLCB2aWV3VmFsdWUpIHtcbiAgICB2YXIgdmFsdWUgPSBtb2RlbFZhbHVlIHx8IHZpZXdWYWx1ZTtcbiAgICByZXR1cm4gY3RybC4kaXNFbXB0eSh2YWx1ZSkgfHwgVVJMX1JFR0VYUC50ZXN0KHZhbHVlKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gZW1haWxJbnB1dFR5cGUoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwsICRzbmlmZmVyLCAkYnJvd3Nlcikge1xuICAvLyBOb3RlOiBubyBiYWRJbnB1dENoZWNrZXIgaGVyZSBieSBwdXJwb3NlIGFzIGB1cmxgIGlzIG9ubHkgYSB2YWxpZGF0aW9uXG4gIC8vIGluIGJyb3dzZXJzLCBpLmUuIHdlIGNhbiBhbHdheXMgcmVhZCBvdXQgaW5wdXQudmFsdWUgZXZlbiBpZiBpdCBpcyBub3QgdmFsaWQhXG4gIGJhc2VJbnB1dFR5cGUoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwsICRzbmlmZmVyLCAkYnJvd3Nlcik7XG4gIHN0cmluZ0Jhc2VkSW5wdXRUeXBlKGN0cmwpO1xuXG4gIGN0cmwuJCRwYXJzZXJOYW1lID0gJ2VtYWlsJztcbiAgY3RybC4kdmFsaWRhdG9ycy5lbWFpbCA9IGZ1bmN0aW9uKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSkge1xuICAgIHZhciB2YWx1ZSA9IG1vZGVsVmFsdWUgfHwgdmlld1ZhbHVlO1xuICAgIHJldHVybiBjdHJsLiRpc0VtcHR5KHZhbHVlKSB8fCBFTUFJTF9SRUdFWFAudGVzdCh2YWx1ZSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHJhZGlvSW5wdXRUeXBlKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XG4gIC8vIG1ha2UgdGhlIG5hbWUgdW5pcXVlLCBpZiBub3QgZGVmaW5lZFxuICBpZiAoaXNVbmRlZmluZWQoYXR0ci5uYW1lKSkge1xuICAgIGVsZW1lbnQuYXR0cignbmFtZScsIG5leHRVaWQoKSk7XG4gIH1cblxuICB2YXIgbGlzdGVuZXIgPSBmdW5jdGlvbihldikge1xuICAgIGlmIChlbGVtZW50WzBdLmNoZWNrZWQpIHtcbiAgICAgIGN0cmwuJHNldFZpZXdWYWx1ZShhdHRyLnZhbHVlLCBldiAmJiBldi50eXBlKTtcbiAgICB9XG4gIH07XG5cbiAgZWxlbWVudC5vbignY2xpY2snLCBsaXN0ZW5lcik7XG5cbiAgY3RybC4kcmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHZhbHVlID0gYXR0ci52YWx1ZTtcbiAgICBlbGVtZW50WzBdLmNoZWNrZWQgPSAodmFsdWUgPT0gY3RybC4kdmlld1ZhbHVlKTtcbiAgfTtcblxuICBhdHRyLiRvYnNlcnZlKCd2YWx1ZScsIGN0cmwuJHJlbmRlcik7XG59XG5cbmZ1bmN0aW9uIHBhcnNlQ29uc3RhbnRFeHByKCRwYXJzZSwgY29udGV4dCwgbmFtZSwgZXhwcmVzc2lvbiwgZmFsbGJhY2spIHtcbiAgdmFyIHBhcnNlRm47XG4gIGlmIChpc0RlZmluZWQoZXhwcmVzc2lvbikpIHtcbiAgICBwYXJzZUZuID0gJHBhcnNlKGV4cHJlc3Npb24pO1xuICAgIGlmICghcGFyc2VGbi5jb25zdGFudCkge1xuICAgICAgdGhyb3cgbmdNb2RlbE1pbkVycignY29uc3RleHByJywgJ0V4cGVjdGVkIGNvbnN0YW50IGV4cHJlc3Npb24gZm9yIGB7MH1gLCBidXQgc2F3ICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYHsxfWAuJywgbmFtZSwgZXhwcmVzc2lvbik7XG4gICAgfVxuICAgIHJldHVybiBwYXJzZUZuKGNvbnRleHQpO1xuICB9XG4gIHJldHVybiBmYWxsYmFjaztcbn1cblxuZnVuY3Rpb24gY2hlY2tib3hJbnB1dFR5cGUoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwsICRzbmlmZmVyLCAkYnJvd3NlciwgJGZpbHRlciwgJHBhcnNlKSB7XG4gIHZhciB0cnVlVmFsdWUgPSBwYXJzZUNvbnN0YW50RXhwcigkcGFyc2UsIHNjb3BlLCAnbmdUcnVlVmFsdWUnLCBhdHRyLm5nVHJ1ZVZhbHVlLCB0cnVlKTtcbiAgdmFyIGZhbHNlVmFsdWUgPSBwYXJzZUNvbnN0YW50RXhwcigkcGFyc2UsIHNjb3BlLCAnbmdGYWxzZVZhbHVlJywgYXR0ci5uZ0ZhbHNlVmFsdWUsIGZhbHNlKTtcblxuICB2YXIgbGlzdGVuZXIgPSBmdW5jdGlvbihldikge1xuICAgIGN0cmwuJHNldFZpZXdWYWx1ZShlbGVtZW50WzBdLmNoZWNrZWQsIGV2ICYmIGV2LnR5cGUpO1xuICB9O1xuXG4gIGVsZW1lbnQub24oJ2NsaWNrJywgbGlzdGVuZXIpO1xuXG4gIGN0cmwuJHJlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgIGVsZW1lbnRbMF0uY2hlY2tlZCA9IGN0cmwuJHZpZXdWYWx1ZTtcbiAgfTtcblxuICAvLyBPdmVycmlkZSB0aGUgc3RhbmRhcmQgYCRpc0VtcHR5YCBiZWNhdXNlIHRoZSAkdmlld1ZhbHVlIG9mIGFuIGVtcHR5IGNoZWNrYm94IGlzIGFsd2F5cyBzZXQgdG8gYGZhbHNlYFxuICAvLyBUaGlzIGlzIGJlY2F1c2Ugb2YgdGhlIHBhcnNlciBiZWxvdywgd2hpY2ggY29tcGFyZXMgdGhlIGAkbW9kZWxWYWx1ZWAgd2l0aCBgdHJ1ZVZhbHVlYCB0byBjb252ZXJ0XG4gIC8vIGl0IHRvIGEgYm9vbGVhbi5cbiAgY3RybC4kaXNFbXB0eSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09PSBmYWxzZTtcbiAgfTtcblxuICBjdHJsLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gZXF1YWxzKHZhbHVlLCB0cnVlVmFsdWUpO1xuICB9KTtcblxuICBjdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPyB0cnVlVmFsdWUgOiBmYWxzZVZhbHVlO1xuICB9KTtcbn1cblxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIHRleHRhcmVhXG4gKiBAcmVzdHJpY3QgRVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogSFRNTCB0ZXh0YXJlYSBlbGVtZW50IGNvbnRyb2wgd2l0aCBhbmd1bGFyIGRhdGEtYmluZGluZy4gVGhlIGRhdGEtYmluZGluZyBhbmQgdmFsaWRhdGlvblxuICogcHJvcGVydGllcyBvZiB0aGlzIGVsZW1lbnQgYXJlIGV4YWN0bHkgdGhlIHNhbWUgYXMgdGhvc2Ugb2YgdGhlXG4gKiB7QGxpbmsgbmcuZGlyZWN0aXZlOmlucHV0IGlucHV0IGVsZW1lbnR9LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBuZ01vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gcmVxdWlyZWQgU2V0cyBgcmVxdWlyZWRgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBub3QgZW50ZXJlZC5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmdSZXF1aXJlZCBBZGRzIGByZXF1aXJlZGAgYXR0cmlidXRlIGFuZCBgcmVxdWlyZWRgIHZhbGlkYXRpb24gY29uc3RyYWludCB0b1xuICogICAgdGhlIGVsZW1lbnQgd2hlbiB0aGUgbmdSZXF1aXJlZCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLiBVc2UgYG5nUmVxdWlyZWRgIGluc3RlYWQgb2ZcbiAqICAgIGByZXF1aXJlZGAgd2hlbiB5b3Ugd2FudCB0byBkYXRhLWJpbmQgdG8gdGhlIGByZXF1aXJlZGAgYXR0cmlidXRlLlxuICogQHBhcmFtIHtudW1iZXI9fSBuZ01pbmxlbmd0aCBTZXRzIGBtaW5sZW5ndGhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBzaG9ydGVyIHRoYW5cbiAqICAgIG1pbmxlbmd0aC5cbiAqIEBwYXJhbSB7bnVtYmVyPX0gbmdNYXhsZW5ndGggU2V0cyBgbWF4bGVuZ3RoYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbG9uZ2VyIHRoYW5cbiAqICAgIG1heGxlbmd0aC4gU2V0dGluZyB0aGUgYXR0cmlidXRlIHRvIGEgbmVnYXRpdmUgb3Igbm9uLW51bWVyaWMgdmFsdWUsIGFsbG93cyB2aWV3IHZhbHVlcyBvZiBhbnlcbiAqICAgIGxlbmd0aC5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmdQYXR0ZXJuIFNldHMgYHBhdHRlcm5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSBuZ01vZGVsIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2aWV3VmFsdWUgJHZpZXdWYWx1ZX1cbiAqICAgIGRvZXMgbm90IG1hdGNoIGEgUmVnRXhwIGZvdW5kIGJ5IGV2YWx1YXRpbmcgdGhlIEFuZ3VsYXIgZXhwcmVzc2lvbiBnaXZlbiBpbiB0aGUgYXR0cmlidXRlIHZhbHVlLlxuICogICAgSWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgUmVnRXhwIG9iamVjdCwgdGhlbiB0aGlzIGlzIHVzZWQgZGlyZWN0bHkuXG4gKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBzdHJpbmcsIHRoZW4gaXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSBSZWdFeHBcbiAqICAgIGFmdGVyIHdyYXBwaW5nIGl0IGluIGBeYCBhbmQgYCRgIGNoYXJhY3RlcnMuIEZvciBpbnN0YW5jZSwgYFwiYWJjXCJgIHdpbGwgYmUgY29udmVydGVkIHRvXG4gKiAgICBgbmV3IFJlZ0V4cCgnXmFiYyQnKWAuPGJyIC8+XG4gKiAgICAqKk5vdGU6KiogQXZvaWQgdXNpbmcgdGhlIGBnYCBmbGFnIG9uIHRoZSBSZWdFeHAsIGFzIGl0IHdpbGwgY2F1c2UgZWFjaCBzdWNjZXNzaXZlIHNlYXJjaCB0b1xuICogICAgc3RhcnQgYXQgdGhlIGluZGV4IG9mIHRoZSBsYXN0IHNlYXJjaCdzIG1hdGNoLCB0aHVzIG5vdCB0YWtpbmcgdGhlIHdob2xlIGlucHV0IHZhbHVlIGludG9cbiAqICAgIGFjY291bnQuXG4gKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcbiAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBbbmdUcmltPXRydWVdIElmIHNldCB0byBmYWxzZSBBbmd1bGFyIHdpbGwgbm90IGF1dG9tYXRpY2FsbHkgdHJpbSB0aGUgaW5wdXQuXG4gKi9cblxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIGlucHV0XG4gKiBAcmVzdHJpY3QgRVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogSFRNTCBpbnB1dCBlbGVtZW50IGNvbnRyb2wuIFdoZW4gdXNlZCB0b2dldGhlciB3aXRoIHtAbGluayBuZ01vZGVsIGBuZ01vZGVsYH0sIGl0IHByb3ZpZGVzIGRhdGEtYmluZGluZyxcbiAqIGlucHV0IHN0YXRlIGNvbnRyb2wsIGFuZCB2YWxpZGF0aW9uLlxuICogSW5wdXQgY29udHJvbCBmb2xsb3dzIEhUTUw1IGlucHV0IHR5cGVzIGFuZCBwb2x5ZmlsbHMgdGhlIEhUTUw1IHZhbGlkYXRpb24gYmVoYXZpb3IgZm9yIG9sZGVyIGJyb3dzZXJzLlxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG4gKiAqKk5vdGU6KiogTm90IGV2ZXJ5IGZlYXR1cmUgb2ZmZXJlZCBpcyBhdmFpbGFibGUgZm9yIGFsbCBpbnB1dCB0eXBlcy5cbiAqIFNwZWNpZmljYWxseSwgZGF0YSBiaW5kaW5nIGFuZCBldmVudCBoYW5kbGluZyB2aWEgYG5nLW1vZGVsYCBpcyB1bnN1cHBvcnRlZCBmb3IgYGlucHV0W2ZpbGVdYC5cbiAqIDwvZGl2PlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBuZ01vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gcmVxdWlyZWQgU2V0cyBgcmVxdWlyZWRgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBub3QgZW50ZXJlZC5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG5nUmVxdWlyZWQgU2V0cyBgcmVxdWlyZWRgIGF0dHJpYnV0ZSBpZiBzZXQgdG8gdHJ1ZVxuICogQHBhcmFtIHtudW1iZXI9fSBuZ01pbmxlbmd0aCBTZXRzIGBtaW5sZW5ndGhgIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSB2YWx1ZSBpcyBzaG9ydGVyIHRoYW5cbiAqICAgIG1pbmxlbmd0aC5cbiAqIEBwYXJhbSB7bnVtYmVyPX0gbmdNYXhsZW5ndGggU2V0cyBgbWF4bGVuZ3RoYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbG9uZ2VyIHRoYW5cbiAqICAgIG1heGxlbmd0aC4gU2V0dGluZyB0aGUgYXR0cmlidXRlIHRvIGEgbmVnYXRpdmUgb3Igbm9uLW51bWVyaWMgdmFsdWUsIGFsbG93cyB2aWV3IHZhbHVlcyBvZiBhbnlcbiAqICAgIGxlbmd0aC5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmdQYXR0ZXJuIFNldHMgYHBhdHRlcm5gIHZhbGlkYXRpb24gZXJyb3Iga2V5IGlmIHRoZSBuZ01vZGVsIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2aWV3VmFsdWUgJHZpZXdWYWx1ZX1cbiAqICAgIHZhbHVlIGRvZXMgbm90IG1hdGNoIGEgUmVnRXhwIGZvdW5kIGJ5IGV2YWx1YXRpbmcgdGhlIEFuZ3VsYXIgZXhwcmVzc2lvbiBnaXZlbiBpbiB0aGUgYXR0cmlidXRlIHZhbHVlLlxuICogICAgSWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgUmVnRXhwIG9iamVjdCwgdGhlbiB0aGlzIGlzIHVzZWQgZGlyZWN0bHkuXG4gKiAgICBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBzdHJpbmcsIHRoZW4gaXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSBSZWdFeHBcbiAqICAgIGFmdGVyIHdyYXBwaW5nIGl0IGluIGBeYCBhbmQgYCRgIGNoYXJhY3RlcnMuIEZvciBpbnN0YW5jZSwgYFwiYWJjXCJgIHdpbGwgYmUgY29udmVydGVkIHRvXG4gKiAgICBgbmV3IFJlZ0V4cCgnXmFiYyQnKWAuPGJyIC8+XG4gKiAgICAqKk5vdGU6KiogQXZvaWQgdXNpbmcgdGhlIGBnYCBmbGFnIG9uIHRoZSBSZWdFeHAsIGFzIGl0IHdpbGwgY2F1c2UgZWFjaCBzdWNjZXNzaXZlIHNlYXJjaCB0b1xuICogICAgc3RhcnQgYXQgdGhlIGluZGV4IG9mIHRoZSBsYXN0IHNlYXJjaCdzIG1hdGNoLCB0aHVzIG5vdCB0YWtpbmcgdGhlIHdob2xlIGlucHV0IHZhbHVlIGludG9cbiAqICAgIGFjY291bnQuXG4gKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcbiAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBbbmdUcmltPXRydWVdIElmIHNldCB0byBmYWxzZSBBbmd1bGFyIHdpbGwgbm90IGF1dG9tYXRpY2FsbHkgdHJpbSB0aGUgaW5wdXQuXG4gKiAgICBUaGlzIHBhcmFtZXRlciBpcyBpZ25vcmVkIGZvciBpbnB1dFt0eXBlPXBhc3N3b3JkXSBjb250cm9scywgd2hpY2ggd2lsbCBuZXZlciB0cmltIHRoZVxuICogICAgaW5wdXQuXG4gKlxuICogQGV4YW1wbGVcbiAgICA8ZXhhbXBsZSBuYW1lPVwiaW5wdXQtZGlyZWN0aXZlXCIgbW9kdWxlPVwiaW5wdXRFeGFtcGxlXCI+XG4gICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxzY3JpcHQ+XG4gICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2lucHV0RXhhbXBsZScsIFtdKVxuICAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSB7bmFtZTogJ2d1ZXN0JywgbGFzdDogJ3Zpc2l0b3InfTtcbiAgICAgICAgICAgIH1dKTtcbiAgICAgICA8L3NjcmlwdD5cbiAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiPlxuICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgIFVzZXIgbmFtZTpcbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmFtZT1cInVzZXJOYW1lXCIgbmctbW9kZWw9XCJ1c2VyLm5hbWVcIiByZXF1aXJlZD5cbiAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgPGRpdiByb2xlPVwiYWxlcnRcIj5cbiAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS51c2VyTmFtZS4kZXJyb3IucmVxdWlyZWRcIj5cbiAgICAgICAgICAgICAgUmVxdWlyZWQhPC9zcGFuPlxuICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgICBMYXN0IG5hbWU6XG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJsYXN0TmFtZVwiIG5nLW1vZGVsPVwidXNlci5sYXN0XCJcbiAgICAgICAgICAgICAgbmctbWlubGVuZ3RoPVwiM1wiIG5nLW1heGxlbmd0aD1cIjEwXCI+XG4gICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgIDxkaXYgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcnJvclwiIG5nLXNob3c9XCJteUZvcm0ubGFzdE5hbWUuJGVycm9yLm1pbmxlbmd0aFwiPlxuICAgICAgICAgICAgICAgVG9vIHNob3J0ITwvc3Bhbj5cbiAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImVycm9yXCIgbmctc2hvdz1cIm15Rm9ybS5sYXN0TmFtZS4kZXJyb3IubWF4bGVuZ3RoXCI+XG4gICAgICAgICAgICAgICBUb28gbG9uZyE8L3NwYW4+XG4gICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgPC9mb3JtPlxuICAgICAgICAgPGhyPlxuICAgICAgICAgPHR0PnVzZXIgPSB7e3VzZXJ9fTwvdHQ+PGJyLz5cbiAgICAgICAgIDx0dD5teUZvcm0udXNlck5hbWUuJHZhbGlkID0ge3tteUZvcm0udXNlck5hbWUuJHZhbGlkfX08L3R0Pjxici8+XG4gICAgICAgICA8dHQ+bXlGb3JtLnVzZXJOYW1lLiRlcnJvciA9IHt7bXlGb3JtLnVzZXJOYW1lLiRlcnJvcn19PC90dD48YnIvPlxuICAgICAgICAgPHR0Pm15Rm9ybS5sYXN0TmFtZS4kdmFsaWQgPSB7e215Rm9ybS5sYXN0TmFtZS4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAgICAgICAgIDx0dD5teUZvcm0ubGFzdE5hbWUuJGVycm9yID0ge3tteUZvcm0ubGFzdE5hbWUuJGVycm9yfX08L3R0Pjxici8+XG4gICAgICAgICA8dHQ+bXlGb3JtLiR2YWxpZCA9IHt7bXlGb3JtLiR2YWxpZH19PC90dD48YnIvPlxuICAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IucmVxdWlyZWQgPSB7eyEhbXlGb3JtLiRlcnJvci5yZXF1aXJlZH19PC90dD48YnIvPlxuICAgICAgICAgPHR0Pm15Rm9ybS4kZXJyb3IubWlubGVuZ3RoID0ge3shIW15Rm9ybS4kZXJyb3IubWlubGVuZ3RofX08L3R0Pjxici8+XG4gICAgICAgICA8dHQ+bXlGb3JtLiRlcnJvci5tYXhsZW5ndGggPSB7eyEhbXlGb3JtLiRlcnJvci5tYXhsZW5ndGh9fTwvdHQ+PGJyLz5cbiAgICAgICA8L2Rpdj5cbiAgICAgIDwvZmlsZT5cbiAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgICAgdmFyIHVzZXIgPSBlbGVtZW50KGJ5LmV4YWN0QmluZGluZygndXNlcicpKTtcbiAgICAgICAgdmFyIHVzZXJOYW1lVmFsaWQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ215Rm9ybS51c2VyTmFtZS4kdmFsaWQnKSk7XG4gICAgICAgIHZhciBsYXN0TmFtZVZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0ubGFzdE5hbWUuJHZhbGlkJykpO1xuICAgICAgICB2YXIgbGFzdE5hbWVFcnJvciA9IGVsZW1lbnQoYnkuYmluZGluZygnbXlGb3JtLmxhc3ROYW1lLiRlcnJvcicpKTtcbiAgICAgICAgdmFyIGZvcm1WYWxpZCA9IGVsZW1lbnQoYnkuYmluZGluZygnbXlGb3JtLiR2YWxpZCcpKTtcbiAgICAgICAgdmFyIHVzZXJOYW1lSW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCd1c2VyLm5hbWUnKSk7XG4gICAgICAgIHZhciB1c2VyTGFzdElucHV0ID0gZWxlbWVudChieS5tb2RlbCgndXNlci5sYXN0JykpO1xuXG4gICAgICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB0byBtb2RlbCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGV4cGVjdCh1c2VyLmdldFRleHQoKSkudG9Db250YWluKCd7XCJuYW1lXCI6XCJndWVzdFwiLFwibGFzdFwiOlwidmlzaXRvclwifScpO1xuICAgICAgICAgIGV4cGVjdCh1c2VyTmFtZVZhbGlkLmdldFRleHQoKSkudG9Db250YWluKCd0cnVlJyk7XG4gICAgICAgICAgZXhwZWN0KGZvcm1WYWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbigndHJ1ZScpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGJlIGludmFsaWQgaWYgZW1wdHkgd2hlbiByZXF1aXJlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHVzZXJOYW1lSW5wdXQuY2xlYXIoKTtcbiAgICAgICAgICB1c2VyTmFtZUlucHV0LnNlbmRLZXlzKCcnKTtcblxuICAgICAgICAgIGV4cGVjdCh1c2VyLmdldFRleHQoKSkudG9Db250YWluKCd7XCJsYXN0XCI6XCJ2aXNpdG9yXCJ9Jyk7XG4gICAgICAgICAgZXhwZWN0KHVzZXJOYW1lVmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2ZhbHNlJyk7XG4gICAgICAgICAgZXhwZWN0KGZvcm1WYWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBiZSB2YWxpZCBpZiBlbXB0eSB3aGVuIG1pbiBsZW5ndGggaXMgc2V0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdXNlckxhc3RJbnB1dC5jbGVhcigpO1xuICAgICAgICAgIHVzZXJMYXN0SW5wdXQuc2VuZEtleXMoJycpO1xuXG4gICAgICAgICAgZXhwZWN0KHVzZXIuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3tcIm5hbWVcIjpcImd1ZXN0XCIsXCJsYXN0XCI6XCJcIn0nKTtcbiAgICAgICAgICBleHBlY3QobGFzdE5hbWVWYWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbigndHJ1ZScpO1xuICAgICAgICAgIGV4cGVjdChmb3JtVmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIGxlc3MgdGhhbiByZXF1aXJlZCBtaW4gbGVuZ3RoJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdXNlckxhc3RJbnB1dC5jbGVhcigpO1xuICAgICAgICAgIHVzZXJMYXN0SW5wdXQuc2VuZEtleXMoJ3h4Jyk7XG5cbiAgICAgICAgICBleHBlY3QodXNlci5nZXRUZXh0KCkpLnRvQ29udGFpbigne1wibmFtZVwiOlwiZ3Vlc3RcIn0nKTtcbiAgICAgICAgICBleHBlY3QobGFzdE5hbWVWYWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcbiAgICAgICAgICBleHBlY3QobGFzdE5hbWVFcnJvci5nZXRUZXh0KCkpLnRvQ29udGFpbignbWlubGVuZ3RoJyk7XG4gICAgICAgICAgZXhwZWN0KGZvcm1WYWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBiZSBpbnZhbGlkIGlmIGxvbmdlciB0aGFuIG1heCBsZW5ndGgnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICB1c2VyTGFzdElucHV0LmNsZWFyKCk7XG4gICAgICAgICAgdXNlckxhc3RJbnB1dC5zZW5kS2V5cygnc29tZSByaWRpY3Vsb3VzbHkgbG9uZyBuYW1lJyk7XG5cbiAgICAgICAgICBleHBlY3QodXNlci5nZXRUZXh0KCkpLnRvQ29udGFpbigne1wibmFtZVwiOlwiZ3Vlc3RcIn0nKTtcbiAgICAgICAgICBleHBlY3QobGFzdE5hbWVWYWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcbiAgICAgICAgICBleHBlY3QobGFzdE5hbWVFcnJvci5nZXRUZXh0KCkpLnRvQ29udGFpbignbWF4bGVuZ3RoJyk7XG4gICAgICAgICAgZXhwZWN0KGZvcm1WYWxpZC5nZXRUZXh0KCkpLnRvQ29udGFpbignZmFsc2UnKTtcbiAgICAgICAgfSk7XG4gICAgICA8L2ZpbGU+XG4gICAgPC9leGFtcGxlPlxuICovXG52YXIgaW5wdXREaXJlY3RpdmUgPSBbJyRicm93c2VyJywgJyRzbmlmZmVyJywgJyRmaWx0ZXInLCAnJHBhcnNlJyxcbiAgICBmdW5jdGlvbigkYnJvd3NlciwgJHNuaWZmZXIsICRmaWx0ZXIsICRwYXJzZSkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgcmVxdWlyZTogWyc/bmdNb2RlbCddLFxuICAgIGxpbms6IHtcbiAgICAgIHByZTogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmxzKSB7XG4gICAgICAgIGlmIChjdHJsc1swXSkge1xuICAgICAgICAgIChpbnB1dFR5cGVbbG93ZXJjYXNlKGF0dHIudHlwZSldIHx8IGlucHV0VHlwZS50ZXh0KShzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHNbMF0sICRzbmlmZmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYnJvd3NlciwgJGZpbHRlciwgJHBhcnNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbn1dO1xuXG5cblxudmFyIENPTlNUQU5UX1ZBTFVFX1JFR0VYUCA9IC9eKHRydWV8ZmFsc2V8XFxkKykkLztcbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdWYWx1ZVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQmluZHMgdGhlIGdpdmVuIGV4cHJlc3Npb24gdG8gdGhlIHZhbHVlIG9mIGA8b3B0aW9uPmAgb3Ige0BsaW5rIGlucHV0W3JhZGlvXSBgaW5wdXRbcmFkaW9dYH0sXG4gKiBzbyB0aGF0IHdoZW4gdGhlIGVsZW1lbnQgaXMgc2VsZWN0ZWQsIHRoZSB7QGxpbmsgbmdNb2RlbCBgbmdNb2RlbGB9IG9mIHRoYXQgZWxlbWVudCBpcyBzZXQgdG9cbiAqIHRoZSBib3VuZCB2YWx1ZS5cbiAqXG4gKiBgbmdWYWx1ZWAgaXMgdXNlZnVsIHdoZW4gZHluYW1pY2FsbHkgZ2VuZXJhdGluZyBsaXN0cyBvZiByYWRpbyBidXR0b25zIHVzaW5nXG4gKiB7QGxpbmsgbmdSZXBlYXQgYG5nUmVwZWF0YH0sIGFzIHNob3duIGJlbG93LlxuICpcbiAqIExpa2V3aXNlLCBgbmdWYWx1ZWAgY2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgYDxvcHRpb24+YCBlbGVtZW50cyBmb3JcbiAqIHRoZSB7QGxpbmsgc2VsZWN0IGBzZWxlY3RgfSBlbGVtZW50LiBJbiB0aGF0IGNhc2UgaG93ZXZlciwgb25seSBzdHJpbmdzIGFyZSBzdXBwb3J0ZWRcbiAqIGZvciB0aGUgYHZhbHVlIGBhdHRyaWJ1dGUsIHNvIHRoZSByZXN1bHRpbmcgYG5nTW9kZWxgIHdpbGwgYWx3YXlzIGJlIGEgc3RyaW5nLlxuICogU3VwcG9ydCBmb3IgYHNlbGVjdGAgbW9kZWxzIHdpdGggbm9uLXN0cmluZyB2YWx1ZXMgaXMgYXZhaWxhYmxlIHZpYSBgbmdPcHRpb25zYC5cbiAqXG4gKiBAZWxlbWVudCBpbnB1dFxuICogQHBhcmFtIHtzdHJpbmc9fSBuZ1ZhbHVlIGFuZ3VsYXIgZXhwcmVzc2lvbiwgd2hvc2UgdmFsdWUgd2lsbCBiZSBib3VuZCB0byB0aGUgYHZhbHVlYCBhdHRyaWJ1dGVcbiAqICAgb2YgdGhlIGBpbnB1dGAgZWxlbWVudFxuICpcbiAqIEBleGFtcGxlXG4gICAgPGV4YW1wbGUgbmFtZT1cIm5nVmFsdWUtZGlyZWN0aXZlXCIgbW9kdWxlPVwidmFsdWVFeGFtcGxlXCI+XG4gICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxzY3JpcHQ+XG4gICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ3ZhbHVlRXhhbXBsZScsIFtdKVxuICAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAgICAgJHNjb3BlLm5hbWVzID0gWydwaXp6YScsICd1bmljb3JucycsICdyb2JvdHMnXTtcbiAgICAgICAgICAgICAgJHNjb3BlLm15ID0geyBmYXZvcml0ZTogJ3VuaWNvcm5zJyB9O1xuICAgICAgICAgICAgfV0pO1xuICAgICAgIDwvc2NyaXB0PlxuICAgICAgICA8Zm9ybSBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiAgICAgICAgICA8aDI+V2hpY2ggaXMgeW91ciBmYXZvcml0ZT88L2gyPlxuICAgICAgICAgICAgPGxhYmVsIG5nLXJlcGVhdD1cIm5hbWUgaW4gbmFtZXNcIiBmb3I9XCJ7e25hbWV9fVwiPlxuICAgICAgICAgICAgICB7e25hbWV9fVxuICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInJhZGlvXCJcbiAgICAgICAgICAgICAgICAgICAgIG5nLW1vZGVsPVwibXkuZmF2b3JpdGVcIlxuICAgICAgICAgICAgICAgICAgICAgbmctdmFsdWU9XCJuYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgIGlkPVwie3tuYW1lfX1cIlxuICAgICAgICAgICAgICAgICAgICAgbmFtZT1cImZhdm9yaXRlXCI+XG4gICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgIDxkaXY+WW91IGNob3NlIHt7bXkuZmF2b3JpdGV9fTwvZGl2PlxuICAgICAgICA8L2Zvcm0+XG4gICAgICA8L2ZpbGU+XG4gICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgIHZhciBmYXZvcml0ZSA9IGVsZW1lbnQoYnkuYmluZGluZygnbXkuZmF2b3JpdGUnKSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHRvIG1vZGVsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZXhwZWN0KGZhdm9yaXRlLmdldFRleHQoKSkudG9Db250YWluKCd1bmljb3JucycpO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCBiaW5kIHRoZSB2YWx1ZXMgdG8gdGhlIGlucHV0cycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGVsZW1lbnQuYWxsKGJ5Lm1vZGVsKCdteS5mYXZvcml0ZScpKS5nZXQoMCkuY2xpY2soKTtcbiAgICAgICAgICBleHBlY3QoZmF2b3JpdGUuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3BpenphJyk7XG4gICAgICAgIH0pO1xuICAgICAgPC9maWxlPlxuICAgIDwvZXhhbXBsZT5cbiAqL1xudmFyIG5nVmFsdWVEaXJlY3RpdmUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHByaW9yaXR5OiAxMDAsXG4gICAgY29tcGlsZTogZnVuY3Rpb24odHBsLCB0cGxBdHRyKSB7XG4gICAgICBpZiAoQ09OU1RBTlRfVkFMVUVfUkVHRVhQLnRlc3QodHBsQXR0ci5uZ1ZhbHVlKSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gbmdWYWx1ZUNvbnN0YW50TGluayhzY29wZSwgZWxtLCBhdHRyKSB7XG4gICAgICAgICAgYXR0ci4kc2V0KCd2YWx1ZScsIHNjb3BlLiRldmFsKGF0dHIubmdWYWx1ZSkpO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5nVmFsdWVMaW5rKHNjb3BlLCBlbG0sIGF0dHIpIHtcbiAgICAgICAgICBzY29wZS4kd2F0Y2goYXR0ci5uZ1ZhbHVlLCBmdW5jdGlvbiB2YWx1ZVdhdGNoQWN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICBhdHRyLiRzZXQoJ3ZhbHVlJywgdmFsdWUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn07XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdCaW5kXG4gKiBAcmVzdHJpY3QgQUNcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBgbmdCaW5kYCBhdHRyaWJ1dGUgdGVsbHMgQW5ndWxhciB0byByZXBsYWNlIHRoZSB0ZXh0IGNvbnRlbnQgb2YgdGhlIHNwZWNpZmllZCBIVE1MIGVsZW1lbnRcbiAqIHdpdGggdGhlIHZhbHVlIG9mIGEgZ2l2ZW4gZXhwcmVzc2lvbiwgYW5kIHRvIHVwZGF0ZSB0aGUgdGV4dCBjb250ZW50IHdoZW4gdGhlIHZhbHVlIG9mIHRoYXRcbiAqIGV4cHJlc3Npb24gY2hhbmdlcy5cbiAqXG4gKiBUeXBpY2FsbHksIHlvdSBkb24ndCB1c2UgYG5nQmluZGAgZGlyZWN0bHksIGJ1dCBpbnN0ZWFkIHlvdSB1c2UgdGhlIGRvdWJsZSBjdXJseSBtYXJrdXAgbGlrZVxuICogYHt7IGV4cHJlc3Npb24gfX1gIHdoaWNoIGlzIHNpbWlsYXIgYnV0IGxlc3MgdmVyYm9zZS5cbiAqXG4gKiBJdCBpcyBwcmVmZXJhYmxlIHRvIHVzZSBgbmdCaW5kYCBpbnN0ZWFkIG9mIGB7eyBleHByZXNzaW9uIH19YCBpZiBhIHRlbXBsYXRlIGlzIG1vbWVudGFyaWx5XG4gKiBkaXNwbGF5ZWQgYnkgdGhlIGJyb3dzZXIgaW4gaXRzIHJhdyBzdGF0ZSBiZWZvcmUgQW5ndWxhciBjb21waWxlcyBpdC4gU2luY2UgYG5nQmluZGAgaXMgYW5cbiAqIGVsZW1lbnQgYXR0cmlidXRlLCBpdCBtYWtlcyB0aGUgYmluZGluZ3MgaW52aXNpYmxlIHRvIHRoZSB1c2VyIHdoaWxlIHRoZSBwYWdlIGlzIGxvYWRpbmcuXG4gKlxuICogQW4gYWx0ZXJuYXRpdmUgc29sdXRpb24gdG8gdGhpcyBwcm9ibGVtIHdvdWxkIGJlIHVzaW5nIHRoZVxuICoge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0Nsb2FrIG5nQ2xvYWt9IGRpcmVjdGl2ZS5cbiAqXG4gKlxuICogQGVsZW1lbnQgQU5ZXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nQmluZCB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogRW50ZXIgYSBuYW1lIGluIHRoZSBMaXZlIFByZXZpZXcgdGV4dCBib3g7IHRoZSBncmVldGluZyBiZWxvdyB0aGUgdGV4dCBib3ggY2hhbmdlcyBpbnN0YW50bHkuXG4gICA8ZXhhbXBsZSBtb2R1bGU9XCJiaW5kRXhhbXBsZVwiPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxzY3JpcHQ+XG4gICAgICAgICBhbmd1bGFyLm1vZHVsZSgnYmluZEV4YW1wbGUnLCBbXSlcbiAgICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAgICAkc2NvcGUubmFtZSA9ICdXaGlybGVkJztcbiAgICAgICAgICAgfV0pO1xuICAgICAgIDwvc2NyaXB0PlxuICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gICAgICAgICA8bGFiZWw+RW50ZXIgbmFtZTogPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJuYW1lXCI+PC9sYWJlbD48YnI+XG4gICAgICAgICBIZWxsbyA8c3BhbiBuZy1iaW5kPVwibmFtZVwiPjwvc3Bhbj4hXG4gICAgICAgPC9kaXY+XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgIGl0KCdzaG91bGQgY2hlY2sgbmctYmluZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgdmFyIG5hbWVJbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ25hbWUnKSk7XG5cbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ25hbWUnKSkuZ2V0VGV4dCgpKS50b0JlKCdXaGlybGVkJyk7XG4gICAgICAgICBuYW1lSW5wdXQuY2xlYXIoKTtcbiAgICAgICAgIG5hbWVJbnB1dC5zZW5kS2V5cygnd29ybGQnKTtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ25hbWUnKSkuZ2V0VGV4dCgpKS50b0JlKCd3b3JsZCcpO1xuICAgICAgIH0pO1xuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gKi9cbnZhciBuZ0JpbmREaXJlY3RpdmUgPSBbJyRjb21waWxlJywgZnVuY3Rpb24oJGNvbXBpbGUpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0FDJyxcbiAgICBjb21waWxlOiBmdW5jdGlvbiBuZ0JpbmRDb21waWxlKHRlbXBsYXRlRWxlbWVudCkge1xuICAgICAgJGNvbXBpbGUuJCRhZGRCaW5kaW5nQ2xhc3ModGVtcGxhdGVFbGVtZW50KTtcbiAgICAgIHJldHVybiBmdW5jdGlvbiBuZ0JpbmRMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG4gICAgICAgICRjb21waWxlLiQkYWRkQmluZGluZ0luZm8oZWxlbWVudCwgYXR0ci5uZ0JpbmQpO1xuICAgICAgICBlbGVtZW50ID0gZWxlbWVudFswXTtcbiAgICAgICAgc2NvcGUuJHdhdGNoKGF0dHIubmdCaW5kLCBmdW5jdGlvbiBuZ0JpbmRXYXRjaEFjdGlvbih2YWx1ZSkge1xuICAgICAgICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSBpc1VuZGVmaW5lZCh2YWx1ZSkgPyAnJyA6IHZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfVxuICB9O1xufV07XG5cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ0JpbmRUZW1wbGF0ZVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIGBuZ0JpbmRUZW1wbGF0ZWAgZGlyZWN0aXZlIHNwZWNpZmllcyB0aGF0IHRoZSBlbGVtZW50XG4gKiB0ZXh0IGNvbnRlbnQgc2hvdWxkIGJlIHJlcGxhY2VkIHdpdGggdGhlIGludGVycG9sYXRpb24gb2YgdGhlIHRlbXBsYXRlXG4gKiBpbiB0aGUgYG5nQmluZFRlbXBsYXRlYCBhdHRyaWJ1dGUuXG4gKiBVbmxpa2UgYG5nQmluZGAsIHRoZSBgbmdCaW5kVGVtcGxhdGVgIGNhbiBjb250YWluIG11bHRpcGxlIGB7e2AgYH19YFxuICogZXhwcmVzc2lvbnMuIFRoaXMgZGlyZWN0aXZlIGlzIG5lZWRlZCBzaW5jZSBzb21lIEhUTUwgZWxlbWVudHNcbiAqIChzdWNoIGFzIFRJVExFIGFuZCBPUFRJT04pIGNhbm5vdCBjb250YWluIFNQQU4gZWxlbWVudHMuXG4gKlxuICogQGVsZW1lbnQgQU5ZXG4gKiBAcGFyYW0ge3N0cmluZ30gbmdCaW5kVGVtcGxhdGUgdGVtcGxhdGUgb2YgZm9ybVxuICogICA8dHQ+e3s8L3R0PiA8dHQ+ZXhwcmVzc2lvbjwvdHQ+IDx0dD59fTwvdHQ+IHRvIGV2YWwuXG4gKlxuICogQGV4YW1wbGVcbiAqIFRyeSBpdCBoZXJlOiBlbnRlciB0ZXh0IGluIHRleHQgYm94IGFuZCB3YXRjaCB0aGUgZ3JlZXRpbmcgY2hhbmdlLlxuICAgPGV4YW1wbGUgbW9kdWxlPVwiYmluZEV4YW1wbGVcIj5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICA8c2NyaXB0PlxuICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2JpbmRFeGFtcGxlJywgW10pXG4gICAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgICAgJHNjb3BlLnNhbHV0YXRpb24gPSAnSGVsbG8nO1xuICAgICAgICAgICAgICRzY29wZS5uYW1lID0gJ1dvcmxkJztcbiAgICAgICAgICAgfV0pO1xuICAgICAgIDwvc2NyaXB0PlxuICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gICAgICAgIDxsYWJlbD5TYWx1dGF0aW9uOiA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cInNhbHV0YXRpb25cIj48L2xhYmVsPjxicj5cbiAgICAgICAgPGxhYmVsPk5hbWU6IDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwibmFtZVwiPjwvbGFiZWw+PGJyPlxuICAgICAgICA8cHJlIG5nLWJpbmQtdGVtcGxhdGU9XCJ7e3NhbHV0YXRpb259fSB7e25hbWV9fSFcIj48L3ByZT5cbiAgICAgICA8L2Rpdj5cbiAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1iaW5kJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICB2YXIgc2FsdXRhdGlvbkVsZW0gPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ3NhbHV0YXRpb24nKSk7XG4gICAgICAgICB2YXIgc2FsdXRhdGlvbklucHV0ID0gZWxlbWVudChieS5tb2RlbCgnc2FsdXRhdGlvbicpKTtcbiAgICAgICAgIHZhciBuYW1lSW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCduYW1lJykpO1xuXG4gICAgICAgICBleHBlY3Qoc2FsdXRhdGlvbkVsZW0uZ2V0VGV4dCgpKS50b0JlKCdIZWxsbyBXb3JsZCEnKTtcblxuICAgICAgICAgc2FsdXRhdGlvbklucHV0LmNsZWFyKCk7XG4gICAgICAgICBzYWx1dGF0aW9uSW5wdXQuc2VuZEtleXMoJ0dyZWV0aW5ncycpO1xuICAgICAgICAgbmFtZUlucHV0LmNsZWFyKCk7XG4gICAgICAgICBuYW1lSW5wdXQuc2VuZEtleXMoJ3VzZXInKTtcblxuICAgICAgICAgZXhwZWN0KHNhbHV0YXRpb25FbGVtLmdldFRleHQoKSkudG9CZSgnR3JlZXRpbmdzIHVzZXIhJyk7XG4gICAgICAgfSk7XG4gICAgIDwvZmlsZT5cbiAgIDwvZXhhbXBsZT5cbiAqL1xudmFyIG5nQmluZFRlbXBsYXRlRGlyZWN0aXZlID0gWyckaW50ZXJwb2xhdGUnLCAnJGNvbXBpbGUnLCBmdW5jdGlvbigkaW50ZXJwb2xhdGUsICRjb21waWxlKSB7XG4gIHJldHVybiB7XG4gICAgY29tcGlsZTogZnVuY3Rpb24gbmdCaW5kVGVtcGxhdGVDb21waWxlKHRlbXBsYXRlRWxlbWVudCkge1xuICAgICAgJGNvbXBpbGUuJCRhZGRCaW5kaW5nQ2xhc3ModGVtcGxhdGVFbGVtZW50KTtcbiAgICAgIHJldHVybiBmdW5jdGlvbiBuZ0JpbmRUZW1wbGF0ZUxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgICAgdmFyIGludGVycG9sYXRlRm4gPSAkaW50ZXJwb2xhdGUoZWxlbWVudC5hdHRyKGF0dHIuJGF0dHIubmdCaW5kVGVtcGxhdGUpKTtcbiAgICAgICAgJGNvbXBpbGUuJCRhZGRCaW5kaW5nSW5mbyhlbGVtZW50LCBpbnRlcnBvbGF0ZUZuLmV4cHJlc3Npb25zKTtcbiAgICAgICAgZWxlbWVudCA9IGVsZW1lbnRbMF07XG4gICAgICAgIGF0dHIuJG9ic2VydmUoJ25nQmluZFRlbXBsYXRlJywgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICBlbGVtZW50LnRleHRDb250ZW50ID0gaXNVbmRlZmluZWQodmFsdWUpID8gJycgOiB2YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn1dO1xuXG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdCaW5kSHRtbFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogRXZhbHVhdGVzIHRoZSBleHByZXNzaW9uIGFuZCBpbnNlcnRzIHRoZSByZXN1bHRpbmcgSFRNTCBpbnRvIHRoZSBlbGVtZW50IGluIGEgc2VjdXJlIHdheS4gQnkgZGVmYXVsdCxcbiAqIHRoZSByZXN1bHRpbmcgSFRNTCBjb250ZW50IHdpbGwgYmUgc2FuaXRpemVkIHVzaW5nIHRoZSB7QGxpbmsgbmdTYW5pdGl6ZS4kc2FuaXRpemUgJHNhbml0aXplfSBzZXJ2aWNlLlxuICogVG8gdXRpbGl6ZSB0aGlzIGZ1bmN0aW9uYWxpdHksIGVuc3VyZSB0aGF0IGAkc2FuaXRpemVgIGlzIGF2YWlsYWJsZSwgZm9yIGV4YW1wbGUsIGJ5IGluY2x1ZGluZyB7QGxpbmtcbiAqIG5nU2FuaXRpemV9IGluIHlvdXIgbW9kdWxlJ3MgZGVwZW5kZW5jaWVzIChub3QgaW4gY29yZSBBbmd1bGFyKS4gSW4gb3JkZXIgdG8gdXNlIHtAbGluayBuZ1Nhbml0aXplfVxuICogaW4geW91ciBtb2R1bGUncyBkZXBlbmRlbmNpZXMsIHlvdSBuZWVkIHRvIGluY2x1ZGUgXCJhbmd1bGFyLXNhbml0aXplLmpzXCIgaW4geW91ciBhcHBsaWNhdGlvbi5cbiAqXG4gKiBZb3UgbWF5IGFsc28gYnlwYXNzIHNhbml0aXphdGlvbiBmb3IgdmFsdWVzIHlvdSBrbm93IGFyZSBzYWZlLiBUbyBkbyBzbywgYmluZCB0b1xuICogYW4gZXhwbGljaXRseSB0cnVzdGVkIHZhbHVlIHZpYSB7QGxpbmsgbmcuJHNjZSN0cnVzdEFzSHRtbCAkc2NlLnRydXN0QXNIdG1sfS4gIFNlZSB0aGUgZXhhbXBsZVxuICogdW5kZXIge0BsaW5rIG5nLiRzY2Ujc2hvdy1tZS1hbi1leGFtcGxlLXVzaW5nLXNjZS0gU3RyaWN0IENvbnRleHR1YWwgRXNjYXBpbmcgKFNDRSl9LlxuICpcbiAqIE5vdGU6IElmIGEgYCRzYW5pdGl6ZWAgc2VydmljZSBpcyB1bmF2YWlsYWJsZSBhbmQgdGhlIGJvdW5kIHZhbHVlIGlzbid0IGV4cGxpY2l0bHkgdHJ1c3RlZCwgeW91XG4gKiB3aWxsIGhhdmUgYW4gZXhjZXB0aW9uIChpbnN0ZWFkIG9mIGFuIGV4cGxvaXQuKVxuICpcbiAqIEBlbGVtZW50IEFOWVxuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0JpbmRIdG1sIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWx1YXRlLlxuICpcbiAqIEBleGFtcGxlXG5cbiAgIDxleGFtcGxlIG1vZHVsZT1cImJpbmRIdG1sRXhhbXBsZVwiIGRlcHM9XCJhbmd1bGFyLXNhbml0aXplLmpzXCI+XG4gICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiAgICAgICAgPHAgbmctYmluZC1odG1sPVwibXlIVE1MXCI+PC9wPlxuICAgICAgIDwvZGl2PlxuICAgICA8L2ZpbGU+XG5cbiAgICAgPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuICAgICAgIGFuZ3VsYXIubW9kdWxlKCdiaW5kSHRtbEV4YW1wbGUnLCBbJ25nU2FuaXRpemUnXSlcbiAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgICRzY29wZS5teUhUTUwgPVxuICAgICAgICAgICAgICAnSSBhbSBhbiA8Y29kZT5IVE1MPC9jb2RlPnN0cmluZyB3aXRoICcgK1xuICAgICAgICAgICAgICAnPGEgaHJlZj1cIiNcIj5saW5rcyE8L2E+IGFuZCBvdGhlciA8ZW0+c3R1ZmY8L2VtPic7XG4gICAgICAgICB9XSk7XG4gICAgIDwvZmlsZT5cblxuICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1iaW5kLWh0bWwnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ215SFRNTCcpKS5nZXRUZXh0KCkpLnRvQmUoXG4gICAgICAgICAgICAgJ0kgYW0gYW4gSFRNTHN0cmluZyB3aXRoIGxpbmtzISBhbmQgb3RoZXIgc3R1ZmYnKTtcbiAgICAgICB9KTtcbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG52YXIgbmdCaW5kSHRtbERpcmVjdGl2ZSA9IFsnJHNjZScsICckcGFyc2UnLCAnJGNvbXBpbGUnLCBmdW5jdGlvbigkc2NlLCAkcGFyc2UsICRjb21waWxlKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICBjb21waWxlOiBmdW5jdGlvbiBuZ0JpbmRIdG1sQ29tcGlsZSh0RWxlbWVudCwgdEF0dHJzKSB7XG4gICAgICB2YXIgbmdCaW5kSHRtbEdldHRlciA9ICRwYXJzZSh0QXR0cnMubmdCaW5kSHRtbCk7XG4gICAgICB2YXIgbmdCaW5kSHRtbFdhdGNoID0gJHBhcnNlKHRBdHRycy5uZ0JpbmRIdG1sLCBmdW5jdGlvbiBnZXRTdHJpbmdWYWx1ZSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gKHZhbHVlIHx8ICcnKS50b1N0cmluZygpO1xuICAgICAgfSk7XG4gICAgICAkY29tcGlsZS4kJGFkZEJpbmRpbmdDbGFzcyh0RWxlbWVudCk7XG5cbiAgICAgIHJldHVybiBmdW5jdGlvbiBuZ0JpbmRIdG1sTGluayhzY29wZSwgZWxlbWVudCwgYXR0cikge1xuICAgICAgICAkY29tcGlsZS4kJGFkZEJpbmRpbmdJbmZvKGVsZW1lbnQsIGF0dHIubmdCaW5kSHRtbCk7XG5cbiAgICAgICAgc2NvcGUuJHdhdGNoKG5nQmluZEh0bWxXYXRjaCwgZnVuY3Rpb24gbmdCaW5kSHRtbFdhdGNoQWN0aW9uKCkge1xuICAgICAgICAgIC8vIHdlIHJlLWV2YWx1YXRlIHRoZSBleHByIGJlY2F1c2Ugd2Ugd2FudCBhIFRydXN0ZWRWYWx1ZUhvbGRlclR5cGVcbiAgICAgICAgICAvLyBmb3IgJHNjZSwgbm90IGEgc3RyaW5nXG4gICAgICAgICAgZWxlbWVudC5odG1sKCRzY2UuZ2V0VHJ1c3RlZEh0bWwobmdCaW5kSHRtbEdldHRlcihzY29wZSkpIHx8ICcnKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn1dO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nQ2hhbmdlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBFdmFsdWF0ZSB0aGUgZ2l2ZW4gZXhwcmVzc2lvbiB3aGVuIHRoZSB1c2VyIGNoYW5nZXMgdGhlIGlucHV0LlxuICogVGhlIGV4cHJlc3Npb24gaXMgZXZhbHVhdGVkIGltbWVkaWF0ZWx5LCB1bmxpa2UgdGhlIEphdmFTY3JpcHQgb25jaGFuZ2UgZXZlbnRcbiAqIHdoaWNoIG9ubHkgdHJpZ2dlcnMgYXQgdGhlIGVuZCBvZiBhIGNoYW5nZSAodXN1YWxseSwgd2hlbiB0aGUgdXNlciBsZWF2ZXMgdGhlXG4gKiBmb3JtIGVsZW1lbnQgb3IgcHJlc3NlcyB0aGUgcmV0dXJuIGtleSkuXG4gKlxuICogVGhlIGBuZ0NoYW5nZWAgZXhwcmVzc2lvbiBpcyBvbmx5IGV2YWx1YXRlZCB3aGVuIGEgY2hhbmdlIGluIHRoZSBpbnB1dCB2YWx1ZSBjYXVzZXNcbiAqIGEgbmV3IHZhbHVlIHRvIGJlIGNvbW1pdHRlZCB0byB0aGUgbW9kZWwuXG4gKlxuICogSXQgd2lsbCBub3QgYmUgZXZhbHVhdGVkOlxuICogKiBpZiB0aGUgdmFsdWUgcmV0dXJuZWQgZnJvbSB0aGUgYCRwYXJzZXJzYCB0cmFuc2Zvcm1hdGlvbiBwaXBlbGluZSBoYXMgbm90IGNoYW5nZWRcbiAqICogaWYgdGhlIGlucHV0IGhhcyBjb250aW51ZWQgdG8gYmUgaW52YWxpZCBzaW5jZSB0aGUgbW9kZWwgd2lsbCBzdGF5IGBudWxsYFxuICogKiBpZiB0aGUgbW9kZWwgaXMgY2hhbmdlZCBwcm9ncmFtbWF0aWNhbGx5IGFuZCBub3QgYnkgYSBjaGFuZ2UgdG8gdGhlIGlucHV0IHZhbHVlXG4gKlxuICpcbiAqIE5vdGUsIHRoaXMgZGlyZWN0aXZlIHJlcXVpcmVzIGBuZ01vZGVsYCB0byBiZSBwcmVzZW50LlxuICpcbiAqIEBlbGVtZW50IGlucHV0XG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nQ2hhbmdlIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWx1YXRlIHVwb24gY2hhbmdlXG4gKiBpbiBpbnB1dCB2YWx1ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogPGV4YW1wbGUgbmFtZT1cIm5nQ2hhbmdlLWRpcmVjdGl2ZVwiIG1vZHVsZT1cImNoYW5nZUV4YW1wbGVcIj5cbiAqICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAqICAgICA8c2NyaXB0PlxuICogICAgICAgYW5ndWxhci5tb2R1bGUoJ2NoYW5nZUV4YW1wbGUnLCBbXSlcbiAqICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAqICAgICAgICAgICAkc2NvcGUuY291bnRlciA9IDA7XG4gKiAgICAgICAgICAgJHNjb3BlLmNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICogICAgICAgICAgICAgJHNjb3BlLmNvdW50ZXIrKztcbiAqICAgICAgICAgICB9O1xuICogICAgICAgICB9XSk7XG4gKiAgICAgPC9zY3JpcHQ+XG4gKiAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiAqICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cImNvbmZpcm1lZFwiIG5nLWNoYW5nZT1cImNoYW5nZSgpXCIgaWQ9XCJuZy1jaGFuZ2UtZXhhbXBsZTFcIiAvPlxuICogICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiY29uZmlybWVkXCIgaWQ9XCJuZy1jaGFuZ2UtZXhhbXBsZTJcIiAvPlxuICogICAgICAgPGxhYmVsIGZvcj1cIm5nLWNoYW5nZS1leGFtcGxlMlwiPkNvbmZpcm1lZDwvbGFiZWw+PGJyIC8+XG4gKiAgICAgICA8dHQ+ZGVidWcgPSB7e2NvbmZpcm1lZH19PC90dD48YnIvPlxuICogICAgICAgPHR0PmNvdW50ZXIgPSB7e2NvdW50ZXJ9fTwvdHQ+PGJyLz5cbiAqICAgICA8L2Rpdj5cbiAqICAgPC9maWxlPlxuICogICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gKiAgICAgdmFyIGNvdW50ZXIgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2NvdW50ZXInKSk7XG4gKiAgICAgdmFyIGRlYnVnID0gZWxlbWVudChieS5iaW5kaW5nKCdjb25maXJtZWQnKSk7XG4gKlxuICogICAgIGl0KCdzaG91bGQgZXZhbHVhdGUgdGhlIGV4cHJlc3Npb24gaWYgY2hhbmdpbmcgZnJvbSB2aWV3JywgZnVuY3Rpb24oKSB7XG4gKiAgICAgICBleHBlY3QoY291bnRlci5nZXRUZXh0KCkpLnRvQ29udGFpbignMCcpO1xuICpcbiAqICAgICAgIGVsZW1lbnQoYnkuaWQoJ25nLWNoYW5nZS1leGFtcGxlMScpKS5jbGljaygpO1xuICpcbiAqICAgICAgIGV4cGVjdChjb3VudGVyLmdldFRleHQoKSkudG9Db250YWluKCcxJyk7XG4gKiAgICAgICBleHBlY3QoZGVidWcuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcbiAqICAgICB9KTtcbiAqXG4gKiAgICAgaXQoJ3Nob3VsZCBub3QgZXZhbHVhdGUgdGhlIGV4cHJlc3Npb24gaWYgY2hhbmdpbmcgZnJvbSBtb2RlbCcsIGZ1bmN0aW9uKCkge1xuICogICAgICAgZWxlbWVudChieS5pZCgnbmctY2hhbmdlLWV4YW1wbGUyJykpLmNsaWNrKCk7XG5cbiAqICAgICAgIGV4cGVjdChjb3VudGVyLmdldFRleHQoKSkudG9Db250YWluKCcwJyk7XG4gKiAgICAgICBleHBlY3QoZGVidWcuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcbiAqICAgICB9KTtcbiAqICAgPC9maWxlPlxuICogPC9leGFtcGxlPlxuICovXG52YXIgbmdDaGFuZ2VEaXJlY3RpdmUgPSB2YWx1ZUZuKHtcbiAgcmVzdHJpY3Q6ICdBJyxcbiAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCkge1xuICAgIGN0cmwuJHZpZXdDaGFuZ2VMaXN0ZW5lcnMucHVzaChmdW5jdGlvbigpIHtcbiAgICAgIHNjb3BlLiRldmFsKGF0dHIubmdDaGFuZ2UpO1xuICAgIH0pO1xuICB9XG59KTtcblxuZnVuY3Rpb24gY2xhc3NEaXJlY3RpdmUobmFtZSwgc2VsZWN0b3IpIHtcbiAgbmFtZSA9ICduZ0NsYXNzJyArIG5hbWU7XG4gIHJldHVybiBbJyRhbmltYXRlJywgZnVuY3Rpb24oJGFuaW1hdGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdBQycsXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cikge1xuICAgICAgICB2YXIgb2xkVmFsO1xuXG4gICAgICAgIHNjb3BlLiR3YXRjaChhdHRyW25hbWVdLCBuZ0NsYXNzV2F0Y2hBY3Rpb24sIHRydWUpO1xuXG4gICAgICAgIGF0dHIuJG9ic2VydmUoJ2NsYXNzJywgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICBuZ0NsYXNzV2F0Y2hBY3Rpb24oc2NvcGUuJGV2YWwoYXR0cltuYW1lXSkpO1xuICAgICAgICB9KTtcblxuXG4gICAgICAgIGlmIChuYW1lICE9PSAnbmdDbGFzcycpIHtcbiAgICAgICAgICBzY29wZS4kd2F0Y2goJyRpbmRleCcsIGZ1bmN0aW9uKCRpbmRleCwgb2xkJGluZGV4KSB7XG4gICAgICAgICAgICAvLyBqc2hpbnQgYml0d2lzZTogZmFsc2VcbiAgICAgICAgICAgIHZhciBtb2QgPSAkaW5kZXggJiAxO1xuICAgICAgICAgICAgaWYgKG1vZCAhPT0gKG9sZCRpbmRleCAmIDEpKSB7XG4gICAgICAgICAgICAgIHZhciBjbGFzc2VzID0gYXJyYXlDbGFzc2VzKHNjb3BlLiRldmFsKGF0dHJbbmFtZV0pKTtcbiAgICAgICAgICAgICAgbW9kID09PSBzZWxlY3RvciA/XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3NlcyhjbGFzc2VzKSA6XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3NlcyhjbGFzc2VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFkZENsYXNzZXMoY2xhc3Nlcykge1xuICAgICAgICAgIHZhciBuZXdDbGFzc2VzID0gZGlnZXN0Q2xhc3NDb3VudHMoY2xhc3NlcywgMSk7XG4gICAgICAgICAgYXR0ci4kYWRkQ2xhc3MobmV3Q2xhc3Nlcyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVDbGFzc2VzKGNsYXNzZXMpIHtcbiAgICAgICAgICB2YXIgbmV3Q2xhc3NlcyA9IGRpZ2VzdENsYXNzQ291bnRzKGNsYXNzZXMsIC0xKTtcbiAgICAgICAgICBhdHRyLiRyZW1vdmVDbGFzcyhuZXdDbGFzc2VzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGRpZ2VzdENsYXNzQ291bnRzKGNsYXNzZXMsIGNvdW50KSB7XG4gICAgICAgICAgLy8gVXNlIGNyZWF0ZU1hcCgpIHRvIHByZXZlbnQgY2xhc3MgYXNzdW1wdGlvbnMgaW52b2x2aW5nIHByb3BlcnR5XG4gICAgICAgICAgLy8gbmFtZXMgaW4gT2JqZWN0LnByb3RvdHlwZVxuICAgICAgICAgIHZhciBjbGFzc0NvdW50cyA9IGVsZW1lbnQuZGF0YSgnJGNsYXNzQ291bnRzJykgfHwgY3JlYXRlTWFwKCk7XG4gICAgICAgICAgdmFyIGNsYXNzZXNUb1VwZGF0ZSA9IFtdO1xuICAgICAgICAgIGZvckVhY2goY2xhc3NlcywgZnVuY3Rpb24oY2xhc3NOYW1lKSB7XG4gICAgICAgICAgICBpZiAoY291bnQgPiAwIHx8IGNsYXNzQ291bnRzW2NsYXNzTmFtZV0pIHtcbiAgICAgICAgICAgICAgY2xhc3NDb3VudHNbY2xhc3NOYW1lXSA9IChjbGFzc0NvdW50c1tjbGFzc05hbWVdIHx8IDApICsgY291bnQ7XG4gICAgICAgICAgICAgIGlmIChjbGFzc0NvdW50c1tjbGFzc05hbWVdID09PSArKGNvdW50ID4gMCkpIHtcbiAgICAgICAgICAgICAgICBjbGFzc2VzVG9VcGRhdGUucHVzaChjbGFzc05hbWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZWxlbWVudC5kYXRhKCckY2xhc3NDb3VudHMnLCBjbGFzc0NvdW50cyk7XG4gICAgICAgICAgcmV0dXJuIGNsYXNzZXNUb1VwZGF0ZS5qb2luKCcgJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVDbGFzc2VzKG9sZENsYXNzZXMsIG5ld0NsYXNzZXMpIHtcbiAgICAgICAgICB2YXIgdG9BZGQgPSBhcnJheURpZmZlcmVuY2UobmV3Q2xhc3Nlcywgb2xkQ2xhc3Nlcyk7XG4gICAgICAgICAgdmFyIHRvUmVtb3ZlID0gYXJyYXlEaWZmZXJlbmNlKG9sZENsYXNzZXMsIG5ld0NsYXNzZXMpO1xuICAgICAgICAgIHRvQWRkID0gZGlnZXN0Q2xhc3NDb3VudHModG9BZGQsIDEpO1xuICAgICAgICAgIHRvUmVtb3ZlID0gZGlnZXN0Q2xhc3NDb3VudHModG9SZW1vdmUsIC0xKTtcbiAgICAgICAgICBpZiAodG9BZGQgJiYgdG9BZGQubGVuZ3RoKSB7XG4gICAgICAgICAgICAkYW5pbWF0ZS5hZGRDbGFzcyhlbGVtZW50LCB0b0FkZCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0b1JlbW92ZSAmJiB0b1JlbW92ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICRhbmltYXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIHRvUmVtb3ZlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBuZ0NsYXNzV2F0Y2hBY3Rpb24obmV3VmFsKSB7XG4gICAgICAgICAgaWYgKHNlbGVjdG9yID09PSB0cnVlIHx8IHNjb3BlLiRpbmRleCAlIDIgPT09IHNlbGVjdG9yKSB7XG4gICAgICAgICAgICB2YXIgbmV3Q2xhc3NlcyA9IGFycmF5Q2xhc3NlcyhuZXdWYWwgfHwgW10pO1xuICAgICAgICAgICAgaWYgKCFvbGRWYWwpIHtcbiAgICAgICAgICAgICAgYWRkQ2xhc3NlcyhuZXdDbGFzc2VzKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWVxdWFscyhuZXdWYWwsb2xkVmFsKSkge1xuICAgICAgICAgICAgICB2YXIgb2xkQ2xhc3NlcyA9IGFycmF5Q2xhc3NlcyhvbGRWYWwpO1xuICAgICAgICAgICAgICB1cGRhdGVDbGFzc2VzKG9sZENsYXNzZXMsIG5ld0NsYXNzZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBvbGRWYWwgPSBzaGFsbG93Q29weShuZXdWYWwpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGFycmF5RGlmZmVyZW5jZSh0b2tlbnMxLCB0b2tlbnMyKSB7XG4gICAgICB2YXIgdmFsdWVzID0gW107XG5cbiAgICAgIG91dGVyOlxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b2tlbnMxLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IHRva2VuczFbaV07XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdG9rZW5zMi5sZW5ndGg7IGorKykge1xuICAgICAgICAgIGlmICh0b2tlbiA9PSB0b2tlbnMyW2pdKSBjb250aW51ZSBvdXRlcjtcbiAgICAgICAgfVxuICAgICAgICB2YWx1ZXMucHVzaCh0b2tlbik7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWVzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFycmF5Q2xhc3NlcyhjbGFzc1ZhbCkge1xuICAgICAgdmFyIGNsYXNzZXMgPSBbXTtcbiAgICAgIGlmIChpc0FycmF5KGNsYXNzVmFsKSkge1xuICAgICAgICBmb3JFYWNoKGNsYXNzVmFsLCBmdW5jdGlvbih2KSB7XG4gICAgICAgICAgY2xhc3NlcyA9IGNsYXNzZXMuY29uY2F0KGFycmF5Q2xhc3Nlcyh2KSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2xhc3NlcztcbiAgICAgIH0gZWxzZSBpZiAoaXNTdHJpbmcoY2xhc3NWYWwpKSB7XG4gICAgICAgIHJldHVybiBjbGFzc1ZhbC5zcGxpdCgnICcpO1xuICAgICAgfSBlbHNlIGlmIChpc09iamVjdChjbGFzc1ZhbCkpIHtcbiAgICAgICAgZm9yRWFjaChjbGFzc1ZhbCwgZnVuY3Rpb24odiwgaykge1xuICAgICAgICAgIGlmICh2KSB7XG4gICAgICAgICAgICBjbGFzc2VzID0gY2xhc3Nlcy5jb25jYXQoay5zcGxpdCgnICcpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2xhc3NlcztcbiAgICAgIH1cbiAgICAgIHJldHVybiBjbGFzc1ZhbDtcbiAgICB9XG4gIH1dO1xufVxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nQ2xhc3NcbiAqIEByZXN0cmljdCBBQ1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIGBuZ0NsYXNzYCBkaXJlY3RpdmUgYWxsb3dzIHlvdSB0byBkeW5hbWljYWxseSBzZXQgQ1NTIGNsYXNzZXMgb24gYW4gSFRNTCBlbGVtZW50IGJ5IGRhdGFiaW5kaW5nXG4gKiBhbiBleHByZXNzaW9uIHRoYXQgcmVwcmVzZW50cyBhbGwgY2xhc3NlcyB0byBiZSBhZGRlZC5cbiAqXG4gKiBUaGUgZGlyZWN0aXZlIG9wZXJhdGVzIGluIHRocmVlIGRpZmZlcmVudCB3YXlzLCBkZXBlbmRpbmcgb24gd2hpY2ggb2YgdGhyZWUgdHlwZXMgdGhlIGV4cHJlc3Npb25cbiAqIGV2YWx1YXRlcyB0bzpcbiAqXG4gKiAxLiBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBzdHJpbmcsIHRoZSBzdHJpbmcgc2hvdWxkIGJlIG9uZSBvciBtb3JlIHNwYWNlLWRlbGltaXRlZCBjbGFzc1xuICogbmFtZXMuXG4gKlxuICogMi4gSWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGFuIG9iamVjdCwgdGhlbiBmb3IgZWFjaCBrZXktdmFsdWUgcGFpciBvZiB0aGVcbiAqIG9iamVjdCB3aXRoIGEgdHJ1dGh5IHZhbHVlIHRoZSBjb3JyZXNwb25kaW5nIGtleSBpcyB1c2VkIGFzIGEgY2xhc3MgbmFtZS5cbiAqXG4gKiAzLiBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYW4gYXJyYXksIGVhY2ggZWxlbWVudCBvZiB0aGUgYXJyYXkgc2hvdWxkIGVpdGhlciBiZSBhIHN0cmluZyBhcyBpblxuICogdHlwZSAxIG9yIGFuIG9iamVjdCBhcyBpbiB0eXBlIDIuIFRoaXMgbWVhbnMgdGhhdCB5b3UgY2FuIG1peCBzdHJpbmdzIGFuZCBvYmplY3RzIHRvZ2V0aGVyIGluIGFuIGFycmF5XG4gKiB0byBnaXZlIHlvdSBtb3JlIGNvbnRyb2wgb3ZlciB3aGF0IENTUyBjbGFzc2VzIGFwcGVhci4gU2VlIHRoZSBjb2RlIGJlbG93IGZvciBhbiBleGFtcGxlIG9mIHRoaXMuXG4gKlxuICpcbiAqIFRoZSBkaXJlY3RpdmUgd29uJ3QgYWRkIGR1cGxpY2F0ZSBjbGFzc2VzIGlmIGEgcGFydGljdWxhciBjbGFzcyB3YXMgYWxyZWFkeSBzZXQuXG4gKlxuICogV2hlbiB0aGUgZXhwcmVzc2lvbiBjaGFuZ2VzLCB0aGUgcHJldmlvdXNseSBhZGRlZCBjbGFzc2VzIGFyZSByZW1vdmVkIGFuZCBvbmx5IHRoZW4gYXJlIHRoZVxuICogbmV3IGNsYXNzZXMgYWRkZWQuXG4gKlxuICogQGFuaW1hdGlvbnNcbiAqICoqYWRkKiogLSBoYXBwZW5zIGp1c3QgYmVmb3JlIHRoZSBjbGFzcyBpcyBhcHBsaWVkIHRvIHRoZSBlbGVtZW50c1xuICpcbiAqICoqcmVtb3ZlKiogLSBoYXBwZW5zIGp1c3QgYmVmb3JlIHRoZSBjbGFzcyBpcyByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnRcbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdDbGFzcyB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsLiBUaGUgcmVzdWx0XG4gKiAgIG9mIHRoZSBldmFsdWF0aW9uIGNhbiBiZSBhIHN0cmluZyByZXByZXNlbnRpbmcgc3BhY2UgZGVsaW1pdGVkIGNsYXNzXG4gKiAgIG5hbWVzLCBhbiBhcnJheSwgb3IgYSBtYXAgb2YgY2xhc3MgbmFtZXMgdG8gYm9vbGVhbiB2YWx1ZXMuIEluIHRoZSBjYXNlIG9mIGEgbWFwLCB0aGVcbiAqICAgbmFtZXMgb2YgdGhlIHByb3BlcnRpZXMgd2hvc2UgdmFsdWVzIGFyZSB0cnV0aHkgd2lsbCBiZSBhZGRlZCBhcyBjc3MgY2xhc3NlcyB0byB0aGVcbiAqICAgZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZSBFeGFtcGxlIHRoYXQgZGVtb25zdHJhdGVzIGJhc2ljIGJpbmRpbmdzIHZpYSBuZ0NsYXNzIGRpcmVjdGl2ZS5cbiAgIDxleGFtcGxlPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxwIG5nLWNsYXNzPVwie3N0cmlrZTogZGVsZXRlZCwgYm9sZDogaW1wb3J0YW50LCAnaGFzLWVycm9yJzogZXJyb3J9XCI+TWFwIFN5bnRheCBFeGFtcGxlPC9wPlxuICAgICAgIDxsYWJlbD5cbiAgICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmctbW9kZWw9XCJkZWxldGVkXCI+XG4gICAgICAgICAgZGVsZXRlZCAoYXBwbHkgXCJzdHJpa2VcIiBjbGFzcylcbiAgICAgICA8L2xhYmVsPjxicj5cbiAgICAgICA8bGFiZWw+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiaW1wb3J0YW50XCI+XG4gICAgICAgICAgaW1wb3J0YW50IChhcHBseSBcImJvbGRcIiBjbGFzcylcbiAgICAgICA8L2xhYmVsPjxicj5cbiAgICAgICA8bGFiZWw+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiZXJyb3JcIj5cbiAgICAgICAgICBlcnJvciAoYXBwbHkgXCJoYXMtZXJyb3JcIiBjbGFzcylcbiAgICAgICA8L2xhYmVsPlxuICAgICAgIDxocj5cbiAgICAgICA8cCBuZy1jbGFzcz1cInN0eWxlXCI+VXNpbmcgU3RyaW5nIFN5bnRheDwvcD5cbiAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cInN0eWxlXCJcbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJUeXBlOiBib2xkIHN0cmlrZSByZWRcIiBhcmlhLWxhYmVsPVwiVHlwZTogYm9sZCBzdHJpa2UgcmVkXCI+XG4gICAgICAgPGhyPlxuICAgICAgIDxwIG5nLWNsYXNzPVwiW3N0eWxlMSwgc3R5bGUyLCBzdHlsZTNdXCI+VXNpbmcgQXJyYXkgU3ludGF4PC9wPlxuICAgICAgIDxpbnB1dCBuZy1tb2RlbD1cInN0eWxlMVwiXG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVHlwZTogYm9sZCwgc3RyaWtlIG9yIHJlZFwiIGFyaWEtbGFiZWw9XCJUeXBlOiBib2xkLCBzdHJpa2Ugb3IgcmVkXCI+PGJyPlxuICAgICAgIDxpbnB1dCBuZy1tb2RlbD1cInN0eWxlMlwiXG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVHlwZTogYm9sZCwgc3RyaWtlIG9yIHJlZFwiIGFyaWEtbGFiZWw9XCJUeXBlOiBib2xkLCBzdHJpa2Ugb3IgcmVkIDJcIj48YnI+XG4gICAgICAgPGlucHV0IG5nLW1vZGVsPVwic3R5bGUzXCJcbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJUeXBlOiBib2xkLCBzdHJpa2Ugb3IgcmVkXCIgYXJpYS1sYWJlbD1cIlR5cGU6IGJvbGQsIHN0cmlrZSBvciByZWQgM1wiPjxicj5cbiAgICAgICA8aHI+XG4gICAgICAgPHAgbmctY2xhc3M9XCJbc3R5bGU0LCB7b3JhbmdlOiB3YXJuaW5nfV1cIj5Vc2luZyBBcnJheSBhbmQgTWFwIFN5bnRheDwvcD5cbiAgICAgICA8aW5wdXQgbmctbW9kZWw9XCJzdHlsZTRcIiBwbGFjZWhvbGRlcj1cIlR5cGU6IGJvbGQsIHN0cmlrZVwiIGFyaWEtbGFiZWw9XCJUeXBlOiBib2xkLCBzdHJpa2VcIj48YnI+XG4gICAgICAgPGxhYmVsPjxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cIndhcm5pbmdcIj4gd2FybmluZyAoYXBwbHkgXCJvcmFuZ2VcIiBjbGFzcyk8L2xhYmVsPlxuICAgICA8L2ZpbGU+XG4gICAgIDxmaWxlIG5hbWU9XCJzdHlsZS5jc3NcIj5cbiAgICAgICAuc3RyaWtlIHtcbiAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBsaW5lLXRocm91Z2g7XG4gICAgICAgfVxuICAgICAgIC5ib2xkIHtcbiAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7XG4gICAgICAgfVxuICAgICAgIC5yZWQge1xuICAgICAgICAgICBjb2xvcjogcmVkO1xuICAgICAgIH1cbiAgICAgICAuaGFzLWVycm9yIHtcbiAgICAgICAgICAgY29sb3I6IHJlZDtcbiAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogeWVsbG93O1xuICAgICAgIH1cbiAgICAgICAub3JhbmdlIHtcbiAgICAgICAgICAgY29sb3I6IG9yYW5nZTtcbiAgICAgICB9XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgIHZhciBwcyA9IGVsZW1lbnQuYWxsKGJ5LmNzcygncCcpKTtcblxuICAgICAgIGl0KCdzaG91bGQgbGV0IHlvdSB0b2dnbGUgdGhlIGNsYXNzJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgIGV4cGVjdChwcy5maXJzdCgpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSkubm90LnRvTWF0Y2goL2JvbGQvKTtcbiAgICAgICAgIGV4cGVjdChwcy5maXJzdCgpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSkubm90LnRvTWF0Y2goL2hhcy1lcnJvci8pO1xuXG4gICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCdpbXBvcnRhbnQnKSkuY2xpY2soKTtcbiAgICAgICAgIGV4cGVjdChwcy5maXJzdCgpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSkudG9NYXRjaCgvYm9sZC8pO1xuXG4gICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCdlcnJvcicpKS5jbGljaygpO1xuICAgICAgICAgZXhwZWN0KHBzLmZpcnN0KCkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS50b01hdGNoKC9oYXMtZXJyb3IvKTtcbiAgICAgICB9KTtcblxuICAgICAgIGl0KCdzaG91bGQgbGV0IHlvdSB0b2dnbGUgc3RyaW5nIGV4YW1wbGUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgIGV4cGVjdChwcy5nZXQoMSkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS50b0JlKCcnKTtcbiAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ3N0eWxlJykpLmNsZWFyKCk7XG4gICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCdzdHlsZScpKS5zZW5kS2V5cygncmVkJyk7XG4gICAgICAgICBleHBlY3QocHMuZ2V0KDEpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSkudG9CZSgncmVkJyk7XG4gICAgICAgfSk7XG5cbiAgICAgICBpdCgnYXJyYXkgZXhhbXBsZSBzaG91bGQgaGF2ZSAzIGNsYXNzZXMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgIGV4cGVjdChwcy5nZXQoMikuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS50b0JlKCcnKTtcbiAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ3N0eWxlMScpKS5zZW5kS2V5cygnYm9sZCcpO1xuICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnc3R5bGUyJykpLnNlbmRLZXlzKCdzdHJpa2UnKTtcbiAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ3N0eWxlMycpKS5zZW5kS2V5cygncmVkJyk7XG4gICAgICAgICBleHBlY3QocHMuZ2V0KDIpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSkudG9CZSgnYm9sZCBzdHJpa2UgcmVkJyk7XG4gICAgICAgfSk7XG5cbiAgICAgICBpdCgnYXJyYXkgd2l0aCBtYXAgZXhhbXBsZSBzaG91bGQgaGF2ZSAyIGNsYXNzZXMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgIGV4cGVjdChwcy5sYXN0KCkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS50b0JlKCcnKTtcbiAgICAgICAgIGVsZW1lbnQoYnkubW9kZWwoJ3N0eWxlNCcpKS5zZW5kS2V5cygnYm9sZCcpO1xuICAgICAgICAgZWxlbWVudChieS5tb2RlbCgnd2FybmluZycpKS5jbGljaygpO1xuICAgICAgICAgZXhwZWN0KHBzLmxhc3QoKS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLnRvQmUoJ2JvbGQgb3JhbmdlJyk7XG4gICAgICAgfSk7XG4gICAgIDwvZmlsZT5cbiAgIDwvZXhhbXBsZT5cblxuICAgIyMgQW5pbWF0aW9uc1xuXG4gICBUaGUgZXhhbXBsZSBiZWxvdyBkZW1vbnN0cmF0ZXMgaG93IHRvIHBlcmZvcm0gYW5pbWF0aW9ucyB1c2luZyBuZ0NsYXNzLlxuXG4gICA8ZXhhbXBsZSBtb2R1bGU9XCJuZ0FuaW1hdGVcIiBkZXBzPVwiYW5ndWxhci1hbmltYXRlLmpzXCIgYW5pbWF0aW9ucz1cInRydWVcIj5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxpbnB1dCBpZD1cInNldGJ0blwiIHR5cGU9XCJidXR0b25cIiB2YWx1ZT1cInNldFwiIG5nLWNsaWNrPVwibXlWYXI9J215LWNsYXNzJ1wiPlxuICAgICAgPGlucHV0IGlkPVwiY2xlYXJidG5cIiB0eXBlPVwiYnV0dG9uXCIgdmFsdWU9XCJjbGVhclwiIG5nLWNsaWNrPVwibXlWYXI9JydcIj5cbiAgICAgIDxicj5cbiAgICAgIDxzcGFuIGNsYXNzPVwiYmFzZS1jbGFzc1wiIG5nLWNsYXNzPVwibXlWYXJcIj5TYW1wbGUgVGV4dDwvc3Bhbj5cbiAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwic3R5bGUuY3NzXCI+XG4gICAgICAgLmJhc2UtY2xhc3Mge1xuICAgICAgICAgdHJhbnNpdGlvbjphbGwgY3ViaWMtYmV6aWVyKDAuMjUwLCAwLjQ2MCwgMC40NTAsIDAuOTQwKSAwLjVzO1xuICAgICAgIH1cblxuICAgICAgIC5iYXNlLWNsYXNzLm15LWNsYXNzIHtcbiAgICAgICAgIGNvbG9yOiByZWQ7XG4gICAgICAgICBmb250LXNpemU6M2VtO1xuICAgICAgIH1cbiAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1jbGFzcycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuY3NzKCcuYmFzZS1jbGFzcycpKS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLm5vdC5cbiAgICAgICAgICAgdG9NYXRjaCgvbXktY2xhc3MvKTtcblxuICAgICAgICAgZWxlbWVudChieS5pZCgnc2V0YnRuJykpLmNsaWNrKCk7XG5cbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmNzcygnLmJhc2UtY2xhc3MnKSkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS5cbiAgICAgICAgICAgdG9NYXRjaCgvbXktY2xhc3MvKTtcblxuICAgICAgICAgZWxlbWVudChieS5pZCgnY2xlYXJidG4nKSkuY2xpY2soKTtcblxuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuY3NzKCcuYmFzZS1jbGFzcycpKS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLm5vdC5cbiAgICAgICAgICAgdG9NYXRjaCgvbXktY2xhc3MvKTtcbiAgICAgICB9KTtcbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuXG5cbiAgICMjIG5nQ2xhc3MgYW5kIHByZS1leGlzdGluZyBDU1MzIFRyYW5zaXRpb25zL0FuaW1hdGlvbnNcbiAgIFRoZSBuZ0NsYXNzIGRpcmVjdGl2ZSBzdGlsbCBzdXBwb3J0cyBDU1MzIFRyYW5zaXRpb25zL0FuaW1hdGlvbnMgZXZlbiBpZiB0aGV5IGRvIG5vdCBmb2xsb3cgdGhlIG5nQW5pbWF0ZSBDU1MgbmFtaW5nIHN0cnVjdHVyZS5cbiAgIFVwb24gYW5pbWF0aW9uIG5nQW5pbWF0ZSB3aWxsIGFwcGx5IHN1cHBsZW1lbnRhcnkgQ1NTIGNsYXNzZXMgdG8gdHJhY2sgdGhlIHN0YXJ0IGFuZCBlbmQgb2YgYW4gYW5pbWF0aW9uLCBidXQgdGhpcyB3aWxsIG5vdCBoaW5kZXJcbiAgIGFueSBwcmUtZXhpc3RpbmcgQ1NTIHRyYW5zaXRpb25zIGFscmVhZHkgb24gdGhlIGVsZW1lbnQuIFRvIGdldCBhbiBpZGVhIG9mIHdoYXQgaGFwcGVucyBkdXJpbmcgYSBjbGFzcy1iYXNlZCBhbmltYXRpb24sIGJlIHN1cmVcbiAgIHRvIHZpZXcgdGhlIHN0ZXAgYnkgc3RlcCBkZXRhaWxzIG9mIHtAbGluayAkYW5pbWF0ZSNhZGRDbGFzcyAkYW5pbWF0ZS5hZGRDbGFzc30gYW5kXG4gICB7QGxpbmsgJGFuaW1hdGUjcmVtb3ZlQ2xhc3MgJGFuaW1hdGUucmVtb3ZlQ2xhc3N9LlxuICovXG52YXIgbmdDbGFzc0RpcmVjdGl2ZSA9IGNsYXNzRGlyZWN0aXZlKCcnLCB0cnVlKTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ0NsYXNzT2RkXG4gKiBAcmVzdHJpY3QgQUNcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBgbmdDbGFzc09kZGAgYW5kIGBuZ0NsYXNzRXZlbmAgZGlyZWN0aXZlcyB3b3JrIGV4YWN0bHkgYXNcbiAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdDbGFzcyBuZ0NsYXNzfSwgZXhjZXB0IHRoZXkgd29yayBpblxuICogY29uanVuY3Rpb24gd2l0aCBgbmdSZXBlYXRgIGFuZCB0YWtlIGVmZmVjdCBvbmx5IG9uIG9kZCAoZXZlbikgcm93cy5cbiAqXG4gKiBUaGlzIGRpcmVjdGl2ZSBjYW4gYmUgYXBwbGllZCBvbmx5IHdpdGhpbiB0aGUgc2NvcGUgb2YgYW5cbiAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdSZXBlYXQgbmdSZXBlYXR9LlxuICpcbiAqIEBlbGVtZW50IEFOWVxuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0NsYXNzT2RkIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWwuIFRoZSByZXN1bHRcbiAqICAgb2YgdGhlIGV2YWx1YXRpb24gY2FuIGJlIGEgc3RyaW5nIHJlcHJlc2VudGluZyBzcGFjZSBkZWxpbWl0ZWQgY2xhc3MgbmFtZXMgb3IgYW4gYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAgIDxleGFtcGxlPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgICA8b2wgbmctaW5pdD1cIm5hbWVzPVsnSm9obicsICdNYXJ5JywgJ0NhdGUnLCAnU3V6J11cIj5cbiAgICAgICAgICA8bGkgbmctcmVwZWF0PVwibmFtZSBpbiBuYW1lc1wiPlxuICAgICAgICAgICA8c3BhbiBuZy1jbGFzcy1vZGQ9XCInb2RkJ1wiIG5nLWNsYXNzLWV2ZW49XCInZXZlbidcIj5cbiAgICAgICAgICAgICB7e25hbWV9fVxuICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgPC9saT5cbiAgICAgICAgPC9vbD5cbiAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwic3R5bGUuY3NzXCI+XG4gICAgICAgLm9kZCB7XG4gICAgICAgICBjb2xvcjogcmVkO1xuICAgICAgIH1cbiAgICAgICAuZXZlbiB7XG4gICAgICAgICBjb2xvcjogYmx1ZTtcbiAgICAgICB9XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgIGl0KCdzaG91bGQgY2hlY2sgbmctY2xhc3Mtb2RkIGFuZCBuZy1jbGFzcy1ldmVuJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICBleHBlY3QoZWxlbWVudChieS5yZXBlYXRlcignbmFtZSBpbiBuYW1lcycpLnJvdygwKS5jb2x1bW4oJ25hbWUnKSkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS5cbiAgICAgICAgICAgdG9NYXRjaCgvb2RkLyk7XG4gICAgICAgICBleHBlY3QoZWxlbWVudChieS5yZXBlYXRlcignbmFtZSBpbiBuYW1lcycpLnJvdygxKS5jb2x1bW4oJ25hbWUnKSkuZ2V0QXR0cmlidXRlKCdjbGFzcycpKS5cbiAgICAgICAgICAgdG9NYXRjaCgvZXZlbi8pO1xuICAgICAgIH0pO1xuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gKi9cbnZhciBuZ0NsYXNzT2RkRGlyZWN0aXZlID0gY2xhc3NEaXJlY3RpdmUoJ09kZCcsIDApO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nQ2xhc3NFdmVuXG4gKiBAcmVzdHJpY3QgQUNcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBgbmdDbGFzc09kZGAgYW5kIGBuZ0NsYXNzRXZlbmAgZGlyZWN0aXZlcyB3b3JrIGV4YWN0bHkgYXNcbiAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdDbGFzcyBuZ0NsYXNzfSwgZXhjZXB0IHRoZXkgd29yayBpblxuICogY29uanVuY3Rpb24gd2l0aCBgbmdSZXBlYXRgIGFuZCB0YWtlIGVmZmVjdCBvbmx5IG9uIG9kZCAoZXZlbikgcm93cy5cbiAqXG4gKiBUaGlzIGRpcmVjdGl2ZSBjYW4gYmUgYXBwbGllZCBvbmx5IHdpdGhpbiB0aGUgc2NvcGUgb2YgYW5cbiAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdSZXBlYXQgbmdSZXBlYXR9LlxuICpcbiAqIEBlbGVtZW50IEFOWVxuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0NsYXNzRXZlbiB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsLiBUaGVcbiAqICAgcmVzdWx0IG9mIHRoZSBldmFsdWF0aW9uIGNhbiBiZSBhIHN0cmluZyByZXByZXNlbnRpbmcgc3BhY2UgZGVsaW1pdGVkIGNsYXNzIG5hbWVzIG9yIGFuIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZT5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICAgPG9sIG5nLWluaXQ9XCJuYW1lcz1bJ0pvaG4nLCAnTWFyeScsICdDYXRlJywgJ1N1eiddXCI+XG4gICAgICAgICAgPGxpIG5nLXJlcGVhdD1cIm5hbWUgaW4gbmFtZXNcIj5cbiAgICAgICAgICAgPHNwYW4gbmctY2xhc3Mtb2RkPVwiJ29kZCdcIiBuZy1jbGFzcy1ldmVuPVwiJ2V2ZW4nXCI+XG4gICAgICAgICAgICAge3tuYW1lfX0gJm5ic3A7ICZuYnNwOyAmbmJzcDtcbiAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgIDwvbGk+XG4gICAgICAgIDwvb2w+XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInN0eWxlLmNzc1wiPlxuICAgICAgIC5vZGQge1xuICAgICAgICAgY29sb3I6IHJlZDtcbiAgICAgICB9XG4gICAgICAgLmV2ZW4ge1xuICAgICAgICAgY29sb3I6IGJsdWU7XG4gICAgICAgfVxuICAgICA8L2ZpbGU+XG4gICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgICBpdCgnc2hvdWxkIGNoZWNrIG5nLWNsYXNzLW9kZCBhbmQgbmctY2xhc3MtZXZlbicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkucmVwZWF0ZXIoJ25hbWUgaW4gbmFtZXMnKS5yb3coMCkuY29sdW1uKCduYW1lJykpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSkuXG4gICAgICAgICAgIHRvTWF0Y2goL29kZC8pO1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkucmVwZWF0ZXIoJ25hbWUgaW4gbmFtZXMnKS5yb3coMSkuY29sdW1uKCduYW1lJykpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSkuXG4gICAgICAgICAgIHRvTWF0Y2goL2V2ZW4vKTtcbiAgICAgICB9KTtcbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG52YXIgbmdDbGFzc0V2ZW5EaXJlY3RpdmUgPSBjbGFzc0RpcmVjdGl2ZSgnRXZlbicsIDEpO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nQ2xvYWtcbiAqIEByZXN0cmljdCBBQ1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIGBuZ0Nsb2FrYCBkaXJlY3RpdmUgaXMgdXNlZCB0byBwcmV2ZW50IHRoZSBBbmd1bGFyIGh0bWwgdGVtcGxhdGUgZnJvbSBiZWluZyBicmllZmx5XG4gKiBkaXNwbGF5ZWQgYnkgdGhlIGJyb3dzZXIgaW4gaXRzIHJhdyAodW5jb21waWxlZCkgZm9ybSB3aGlsZSB5b3VyIGFwcGxpY2F0aW9uIGlzIGxvYWRpbmcuIFVzZSB0aGlzXG4gKiBkaXJlY3RpdmUgdG8gYXZvaWQgdGhlIHVuZGVzaXJhYmxlIGZsaWNrZXIgZWZmZWN0IGNhdXNlZCBieSB0aGUgaHRtbCB0ZW1wbGF0ZSBkaXNwbGF5LlxuICpcbiAqIFRoZSBkaXJlY3RpdmUgY2FuIGJlIGFwcGxpZWQgdG8gdGhlIGA8Ym9keT5gIGVsZW1lbnQsIGJ1dCB0aGUgcHJlZmVycmVkIHVzYWdlIGlzIHRvIGFwcGx5XG4gKiBtdWx0aXBsZSBgbmdDbG9ha2AgZGlyZWN0aXZlcyB0byBzbWFsbCBwb3J0aW9ucyBvZiB0aGUgcGFnZSB0byBwZXJtaXQgcHJvZ3Jlc3NpdmUgcmVuZGVyaW5nXG4gKiBvZiB0aGUgYnJvd3NlciB2aWV3LlxuICpcbiAqIGBuZ0Nsb2FrYCB3b3JrcyBpbiBjb29wZXJhdGlvbiB3aXRoIHRoZSBmb2xsb3dpbmcgY3NzIHJ1bGUgZW1iZWRkZWQgd2l0aGluIGBhbmd1bGFyLmpzYCBhbmRcbiAqIGBhbmd1bGFyLm1pbi5qc2AuXG4gKiBGb3IgQ1NQIG1vZGUgcGxlYXNlIGFkZCBgYW5ndWxhci1jc3AuY3NzYCB0byB5b3VyIGh0bWwgZmlsZSAoc2VlIHtAbGluayBuZy5kaXJlY3RpdmU6bmdDc3AgbmdDc3B9KS5cbiAqXG4gKiBgYGBjc3NcbiAqIFtuZ1xcOmNsb2FrXSwgW25nLWNsb2FrXSwgW2RhdGEtbmctY2xvYWtdLCBbeC1uZy1jbG9ha10sIC5uZy1jbG9haywgLngtbmctY2xvYWsge1xuICogICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBXaGVuIHRoaXMgY3NzIHJ1bGUgaXMgbG9hZGVkIGJ5IHRoZSBicm93c2VyLCBhbGwgaHRtbCBlbGVtZW50cyAoaW5jbHVkaW5nIHRoZWlyIGNoaWxkcmVuKSB0aGF0XG4gKiBhcmUgdGFnZ2VkIHdpdGggdGhlIGBuZ0Nsb2FrYCBkaXJlY3RpdmUgYXJlIGhpZGRlbi4gV2hlbiBBbmd1bGFyIGVuY291bnRlcnMgdGhpcyBkaXJlY3RpdmVcbiAqIGR1cmluZyB0aGUgY29tcGlsYXRpb24gb2YgdGhlIHRlbXBsYXRlIGl0IGRlbGV0ZXMgdGhlIGBuZ0Nsb2FrYCBlbGVtZW50IGF0dHJpYnV0ZSwgbWFraW5nXG4gKiB0aGUgY29tcGlsZWQgZWxlbWVudCB2aXNpYmxlLlxuICpcbiAqIEZvciB0aGUgYmVzdCByZXN1bHQsIHRoZSBgYW5ndWxhci5qc2Agc2NyaXB0IG11c3QgYmUgbG9hZGVkIGluIHRoZSBoZWFkIHNlY3Rpb24gb2YgdGhlIGh0bWxcbiAqIGRvY3VtZW50OyBhbHRlcm5hdGl2ZWx5LCB0aGUgY3NzIHJ1bGUgYWJvdmUgbXVzdCBiZSBpbmNsdWRlZCBpbiB0aGUgZXh0ZXJuYWwgc3R5bGVzaGVldCBvZiB0aGVcbiAqIGFwcGxpY2F0aW9uLlxuICpcbiAqIEBlbGVtZW50IEFOWVxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZT5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICAgPGRpdiBpZD1cInRlbXBsYXRlMVwiIG5nLWNsb2FrPnt7ICdoZWxsbycgfX08L2Rpdj5cbiAgICAgICAgPGRpdiBpZD1cInRlbXBsYXRlMlwiIGNsYXNzPVwibmctY2xvYWtcIj57eyAnd29ybGQnIH19PC9kaXY+XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgIGl0KCdzaG91bGQgcmVtb3ZlIHRoZSB0ZW1wbGF0ZSBkaXJlY3RpdmUgYW5kIGNzcyBjbGFzcycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgZXhwZWN0KCQoJyN0ZW1wbGF0ZTEnKS5nZXRBdHRyaWJ1dGUoJ25nLWNsb2FrJykpLlxuICAgICAgICAgICB0b0JlTnVsbCgpO1xuICAgICAgICAgZXhwZWN0KCQoJyN0ZW1wbGF0ZTInKS5nZXRBdHRyaWJ1dGUoJ25nLWNsb2FrJykpLlxuICAgICAgICAgICB0b0JlTnVsbCgpO1xuICAgICAgIH0pO1xuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gKlxuICovXG52YXIgbmdDbG9ha0RpcmVjdGl2ZSA9IG5nRGlyZWN0aXZlKHtcbiAgY29tcGlsZTogZnVuY3Rpb24oZWxlbWVudCwgYXR0cikge1xuICAgIGF0dHIuJHNldCgnbmdDbG9haycsIHVuZGVmaW5lZCk7XG4gICAgZWxlbWVudC5yZW1vdmVDbGFzcygnbmctY2xvYWsnKTtcbiAgfVxufSk7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdDb250cm9sbGVyXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGUgYG5nQ29udHJvbGxlcmAgZGlyZWN0aXZlIGF0dGFjaGVzIGEgY29udHJvbGxlciBjbGFzcyB0byB0aGUgdmlldy4gVGhpcyBpcyBhIGtleSBhc3BlY3Qgb2YgaG93IGFuZ3VsYXJcbiAqIHN1cHBvcnRzIHRoZSBwcmluY2lwbGVzIGJlaGluZCB0aGUgTW9kZWwtVmlldy1Db250cm9sbGVyIGRlc2lnbiBwYXR0ZXJuLlxuICpcbiAqIE1WQyBjb21wb25lbnRzIGluIGFuZ3VsYXI6XG4gKlxuICogKiBNb2RlbCDigJQgTW9kZWxzIGFyZSB0aGUgcHJvcGVydGllcyBvZiBhIHNjb3BlOyBzY29wZXMgYXJlIGF0dGFjaGVkIHRvIHRoZSBET00gd2hlcmUgc2NvcGUgcHJvcGVydGllc1xuICogICBhcmUgYWNjZXNzZWQgdGhyb3VnaCBiaW5kaW5ncy5cbiAqICogVmlldyDigJQgVGhlIHRlbXBsYXRlIChIVE1MIHdpdGggZGF0YSBiaW5kaW5ncykgdGhhdCBpcyByZW5kZXJlZCBpbnRvIHRoZSBWaWV3LlxuICogKiBDb250cm9sbGVyIOKAlCBUaGUgYG5nQ29udHJvbGxlcmAgZGlyZWN0aXZlIHNwZWNpZmllcyBhIENvbnRyb2xsZXIgY2xhc3M7IHRoZSBjbGFzcyBjb250YWlucyBidXNpbmVzc1xuICogICBsb2dpYyBiZWhpbmQgdGhlIGFwcGxpY2F0aW9uIHRvIGRlY29yYXRlIHRoZSBzY29wZSB3aXRoIGZ1bmN0aW9ucyBhbmQgdmFsdWVzXG4gKlxuICogTm90ZSB0aGF0IHlvdSBjYW4gYWxzbyBhdHRhY2ggY29udHJvbGxlcnMgdG8gdGhlIERPTSBieSBkZWNsYXJpbmcgaXQgaW4gYSByb3V0ZSBkZWZpbml0aW9uXG4gKiB2aWEgdGhlIHtAbGluayBuZ1JvdXRlLiRyb3V0ZSAkcm91dGV9IHNlcnZpY2UuIEEgY29tbW9uIG1pc3Rha2UgaXMgdG8gZGVjbGFyZSB0aGUgY29udHJvbGxlclxuICogYWdhaW4gdXNpbmcgYG5nLWNvbnRyb2xsZXJgIGluIHRoZSB0ZW1wbGF0ZSBpdHNlbGYuICBUaGlzIHdpbGwgY2F1c2UgdGhlIGNvbnRyb2xsZXIgdG8gYmUgYXR0YWNoZWRcbiAqIGFuZCBleGVjdXRlZCB0d2ljZS5cbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqIEBzY29wZVxuICogQHByaW9yaXR5IDUwMFxuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0NvbnRyb2xsZXIgTmFtZSBvZiBhIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHJlZ2lzdGVyZWQgd2l0aCB0aGUgY3VycmVudFxuICoge0BsaW5rIG5nLiRjb250cm9sbGVyUHJvdmlkZXIgJGNvbnRyb2xsZXJQcm92aWRlcn0gb3IgYW4ge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gZXhwcmVzc2lvbn1cbiAqIHRoYXQgb24gdGhlIGN1cnJlbnQgc2NvcGUgZXZhbHVhdGVzIHRvIGEgY29uc3RydWN0b3IgZnVuY3Rpb24uXG4gKlxuICogVGhlIGNvbnRyb2xsZXIgaW5zdGFuY2UgY2FuIGJlIHB1Ymxpc2hlZCBpbnRvIGEgc2NvcGUgcHJvcGVydHkgYnkgc3BlY2lmeWluZ1xuICogYG5nLWNvbnRyb2xsZXI9XCJhcyBwcm9wZXJ0eU5hbWVcImAuXG4gKlxuICogSWYgdGhlIGN1cnJlbnQgYCRjb250cm9sbGVyUHJvdmlkZXJgIGlzIGNvbmZpZ3VyZWQgdG8gdXNlIGdsb2JhbHMgKHZpYVxuICoge0BsaW5rIG5nLiRjb250cm9sbGVyUHJvdmlkZXIjYWxsb3dHbG9iYWxzIGAkY29udHJvbGxlclByb3ZpZGVyLmFsbG93R2xvYmFscygpYCB9KSwgdGhpcyBtYXlcbiAqIGFsc28gYmUgdGhlIG5hbWUgb2YgYSBnbG9iYWxseSBhY2Nlc3NpYmxlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIChub3QgcmVjb21tZW5kZWQpLlxuICpcbiAqIEBleGFtcGxlXG4gKiBIZXJlIGlzIGEgc2ltcGxlIGZvcm0gZm9yIGVkaXRpbmcgdXNlciBjb250YWN0IGluZm9ybWF0aW9uLiBBZGRpbmcsIHJlbW92aW5nLCBjbGVhcmluZywgYW5kXG4gKiBncmVldGluZyBhcmUgbWV0aG9kcyBkZWNsYXJlZCBvbiB0aGUgY29udHJvbGxlciAoc2VlIHNvdXJjZSB0YWIpLiBUaGVzZSBtZXRob2RzIGNhblxuICogZWFzaWx5IGJlIGNhbGxlZCBmcm9tIHRoZSBhbmd1bGFyIG1hcmt1cC4gQW55IGNoYW5nZXMgdG8gdGhlIGRhdGEgYXJlIGF1dG9tYXRpY2FsbHkgcmVmbGVjdGVkXG4gKiBpbiB0aGUgVmlldyB3aXRob3V0IHRoZSBuZWVkIGZvciBhIG1hbnVhbCB1cGRhdGUuXG4gKlxuICogVHdvIGRpZmZlcmVudCBkZWNsYXJhdGlvbiBzdHlsZXMgYXJlIGluY2x1ZGVkIGJlbG93OlxuICpcbiAqICogb25lIGJpbmRzIG1ldGhvZHMgYW5kIHByb3BlcnRpZXMgZGlyZWN0bHkgb250byB0aGUgY29udHJvbGxlciB1c2luZyBgdGhpc2A6XG4gKiBgbmctY29udHJvbGxlcj1cIlNldHRpbmdzQ29udHJvbGxlcjEgYXMgc2V0dGluZ3NcImBcbiAqICogb25lIGluamVjdHMgYCRzY29wZWAgaW50byB0aGUgY29udHJvbGxlcjpcbiAqIGBuZy1jb250cm9sbGVyPVwiU2V0dGluZ3NDb250cm9sbGVyMlwiYFxuICpcbiAqIFRoZSBzZWNvbmQgb3B0aW9uIGlzIG1vcmUgY29tbW9uIGluIHRoZSBBbmd1bGFyIGNvbW11bml0eSwgYW5kIGlzIGdlbmVyYWxseSB1c2VkIGluIGJvaWxlcnBsYXRlc1xuICogYW5kIGluIHRoaXMgZ3VpZGUuIEhvd2V2ZXIsIHRoZXJlIGFyZSBhZHZhbnRhZ2VzIHRvIGJpbmRpbmcgcHJvcGVydGllcyBkaXJlY3RseSB0byB0aGUgY29udHJvbGxlclxuICogYW5kIGF2b2lkaW5nIHNjb3BlLlxuICpcbiAqICogVXNpbmcgYGNvbnRyb2xsZXIgYXNgIG1ha2VzIGl0IG9idmlvdXMgd2hpY2ggY29udHJvbGxlciB5b3UgYXJlIGFjY2Vzc2luZyBpbiB0aGUgdGVtcGxhdGUgd2hlblxuICogbXVsdGlwbGUgY29udHJvbGxlcnMgYXBwbHkgdG8gYW4gZWxlbWVudC5cbiAqICogSWYgeW91IGFyZSB3cml0aW5nIHlvdXIgY29udHJvbGxlcnMgYXMgY2xhc3NlcyB5b3UgaGF2ZSBlYXNpZXIgYWNjZXNzIHRvIHRoZSBwcm9wZXJ0aWVzIGFuZFxuICogbWV0aG9kcywgd2hpY2ggd2lsbCBhcHBlYXIgb24gdGhlIHNjb3BlLCBmcm9tIGluc2lkZSB0aGUgY29udHJvbGxlciBjb2RlLlxuICogKiBTaW5jZSB0aGVyZSBpcyBhbHdheXMgYSBgLmAgaW4gdGhlIGJpbmRpbmdzLCB5b3UgZG9uJ3QgaGF2ZSB0byB3b3JyeSBhYm91dCBwcm90b3R5cGFsXG4gKiBpbmhlcml0YW5jZSBtYXNraW5nIHByaW1pdGl2ZXMuXG4gKlxuICogVGhpcyBleGFtcGxlIGRlbW9uc3RyYXRlcyB0aGUgYGNvbnRyb2xsZXIgYXNgIHN5bnRheC5cbiAqXG4gKiA8ZXhhbXBsZSBuYW1lPVwibmdDb250cm9sbGVyQXNcIiBtb2R1bGU9XCJjb250cm9sbGVyQXNFeGFtcGxlXCI+XG4gKiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gKiAgICA8ZGl2IGlkPVwiY3RybC1hcy1leG1wbFwiIG5nLWNvbnRyb2xsZXI9XCJTZXR0aW5nc0NvbnRyb2xsZXIxIGFzIHNldHRpbmdzXCI+XG4gKiAgICAgIDxsYWJlbD5OYW1lOiA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cInNldHRpbmdzLm5hbWVcIi8+PC9sYWJlbD5cbiAqICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cInNldHRpbmdzLmdyZWV0KClcIj5ncmVldDwvYnV0dG9uPjxici8+XG4gKiAgICAgIENvbnRhY3Q6XG4gKiAgICAgIDx1bD5cbiAqICAgICAgICA8bGkgbmctcmVwZWF0PVwiY29udGFjdCBpbiBzZXR0aW5ncy5jb250YWN0c1wiPlxuICogICAgICAgICAgPHNlbGVjdCBuZy1tb2RlbD1cImNvbnRhY3QudHlwZVwiIGFyaWEtbGFiZWw9XCJDb250YWN0IG1ldGhvZFwiIGlkPVwic2VsZWN0X3t7JGluZGV4fX1cIj5cbiAqICAgICAgICAgICAgIDxvcHRpb24+cGhvbmU8L29wdGlvbj5cbiAqICAgICAgICAgICAgIDxvcHRpb24+ZW1haWw8L29wdGlvbj5cbiAqICAgICAgICAgIDwvc2VsZWN0PlxuICogICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJjb250YWN0LnZhbHVlXCIgYXJpYS1sYWJlbGxlZGJ5PVwic2VsZWN0X3t7JGluZGV4fX1cIiAvPlxuICogICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cInNldHRpbmdzLmNsZWFyQ29udGFjdChjb250YWN0KVwiPmNsZWFyPC9idXR0b24+XG4gKiAgICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwic2V0dGluZ3MucmVtb3ZlQ29udGFjdChjb250YWN0KVwiIGFyaWEtbGFiZWw9XCJSZW1vdmVcIj5YPC9idXR0b24+XG4gKiAgICAgICAgPC9saT5cbiAqICAgICAgICA8bGk+PGJ1dHRvbiBuZy1jbGljaz1cInNldHRpbmdzLmFkZENvbnRhY3QoKVwiPmFkZDwvYnV0dG9uPjwvbGk+XG4gKiAgICAgPC91bD5cbiAqICAgIDwvZGl2PlxuICogICA8L2ZpbGU+XG4gKiAgIDxmaWxlIG5hbWU9XCJhcHAuanNcIj5cbiAqICAgIGFuZ3VsYXIubW9kdWxlKCdjb250cm9sbGVyQXNFeGFtcGxlJywgW10pXG4gKiAgICAgIC5jb250cm9sbGVyKCdTZXR0aW5nc0NvbnRyb2xsZXIxJywgU2V0dGluZ3NDb250cm9sbGVyMSk7XG4gKlxuICogICAgZnVuY3Rpb24gU2V0dGluZ3NDb250cm9sbGVyMSgpIHtcbiAqICAgICAgdGhpcy5uYW1lID0gXCJKb2huIFNtaXRoXCI7XG4gKiAgICAgIHRoaXMuY29udGFjdHMgPSBbXG4gKiAgICAgICAge3R5cGU6ICdwaG9uZScsIHZhbHVlOiAnNDA4IDU1NSAxMjEyJ30sXG4gKiAgICAgICAge3R5cGU6ICdlbWFpbCcsIHZhbHVlOiAnam9obi5zbWl0aEBleGFtcGxlLm9yZyd9IF07XG4gKiAgICB9XG4gKlxuICogICAgU2V0dGluZ3NDb250cm9sbGVyMS5wcm90b3R5cGUuZ3JlZXQgPSBmdW5jdGlvbigpIHtcbiAqICAgICAgYWxlcnQodGhpcy5uYW1lKTtcbiAqICAgIH07XG4gKlxuICogICAgU2V0dGluZ3NDb250cm9sbGVyMS5wcm90b3R5cGUuYWRkQ29udGFjdCA9IGZ1bmN0aW9uKCkge1xuICogICAgICB0aGlzLmNvbnRhY3RzLnB1c2goe3R5cGU6ICdlbWFpbCcsIHZhbHVlOiAneW91cm5hbWVAZXhhbXBsZS5vcmcnfSk7XG4gKiAgICB9O1xuICpcbiAqICAgIFNldHRpbmdzQ29udHJvbGxlcjEucHJvdG90eXBlLnJlbW92ZUNvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0VG9SZW1vdmUpIHtcbiAqICAgICB2YXIgaW5kZXggPSB0aGlzLmNvbnRhY3RzLmluZGV4T2YoY29udGFjdFRvUmVtb3ZlKTtcbiAqICAgICAgdGhpcy5jb250YWN0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICogICAgfTtcbiAqXG4gKiAgICBTZXR0aW5nc0NvbnRyb2xsZXIxLnByb3RvdHlwZS5jbGVhckNvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0KSB7XG4gKiAgICAgIGNvbnRhY3QudHlwZSA9ICdwaG9uZSc7XG4gKiAgICAgIGNvbnRhY3QudmFsdWUgPSAnJztcbiAqICAgIH07XG4gKiAgIDwvZmlsZT5cbiAqICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICogICAgIGl0KCdzaG91bGQgY2hlY2sgY29udHJvbGxlciBhcycsIGZ1bmN0aW9uKCkge1xuICogICAgICAgdmFyIGNvbnRhaW5lciA9IGVsZW1lbnQoYnkuaWQoJ2N0cmwtYXMtZXhtcGwnKSk7XG4gKiAgICAgICAgIGV4cGVjdChjb250YWluZXIuZWxlbWVudChieS5tb2RlbCgnc2V0dGluZ3MubmFtZScpKVxuICogICAgICAgICAgIC5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpLnRvQmUoJ0pvaG4gU21pdGgnKTtcbiAqXG4gKiAgICAgICB2YXIgZmlyc3RSZXBlYXQgPVxuICogICAgICAgICAgIGNvbnRhaW5lci5lbGVtZW50KGJ5LnJlcGVhdGVyKCdjb250YWN0IGluIHNldHRpbmdzLmNvbnRhY3RzJykucm93KDApKTtcbiAqICAgICAgIHZhciBzZWNvbmRSZXBlYXQgPVxuICogICAgICAgICAgIGNvbnRhaW5lci5lbGVtZW50KGJ5LnJlcGVhdGVyKCdjb250YWN0IGluIHNldHRpbmdzLmNvbnRhY3RzJykucm93KDEpKTtcbiAqXG4gKiAgICAgICBleHBlY3QoZmlyc3RSZXBlYXQuZWxlbWVudChieS5tb2RlbCgnY29udGFjdC52YWx1ZScpKS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpXG4gKiAgICAgICAgICAgLnRvQmUoJzQwOCA1NTUgMTIxMicpO1xuICpcbiAqICAgICAgIGV4cGVjdChzZWNvbmRSZXBlYXQuZWxlbWVudChieS5tb2RlbCgnY29udGFjdC52YWx1ZScpKS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpXG4gKiAgICAgICAgICAgLnRvQmUoJ2pvaG4uc21pdGhAZXhhbXBsZS5vcmcnKTtcbiAqXG4gKiAgICAgICBmaXJzdFJlcGVhdC5lbGVtZW50KGJ5LmJ1dHRvblRleHQoJ2NsZWFyJykpLmNsaWNrKCk7XG4gKlxuICogICAgICAgZXhwZWN0KGZpcnN0UmVwZWF0LmVsZW1lbnQoYnkubW9kZWwoJ2NvbnRhY3QudmFsdWUnKSkuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKVxuICogICAgICAgICAgIC50b0JlKCcnKTtcbiAqXG4gKiAgICAgICBjb250YWluZXIuZWxlbWVudChieS5idXR0b25UZXh0KCdhZGQnKSkuY2xpY2soKTtcbiAqXG4gKiAgICAgICBleHBlY3QoY29udGFpbmVyLmVsZW1lbnQoYnkucmVwZWF0ZXIoJ2NvbnRhY3QgaW4gc2V0dGluZ3MuY29udGFjdHMnKS5yb3coMikpXG4gKiAgICAgICAgICAgLmVsZW1lbnQoYnkubW9kZWwoJ2NvbnRhY3QudmFsdWUnKSlcbiAqICAgICAgICAgICAuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKVxuICogICAgICAgICAgIC50b0JlKCd5b3VybmFtZUBleGFtcGxlLm9yZycpO1xuICogICAgIH0pO1xuICogICA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICogVGhpcyBleGFtcGxlIGRlbW9uc3RyYXRlcyB0aGUgXCJhdHRhY2ggdG8gYCRzY29wZWBcIiBzdHlsZSBvZiBjb250cm9sbGVyLlxuICpcbiAqIDxleGFtcGxlIG5hbWU9XCJuZ0NvbnRyb2xsZXJcIiBtb2R1bGU9XCJjb250cm9sbGVyRXhhbXBsZVwiPlxuICogIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gKiAgIDxkaXYgaWQ9XCJjdHJsLWV4bXBsXCIgbmctY29udHJvbGxlcj1cIlNldHRpbmdzQ29udHJvbGxlcjJcIj5cbiAqICAgICA8bGFiZWw+TmFtZTogPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJuYW1lXCIvPjwvbGFiZWw+XG4gKiAgICAgPGJ1dHRvbiBuZy1jbGljaz1cImdyZWV0KClcIj5ncmVldDwvYnV0dG9uPjxici8+XG4gKiAgICAgQ29udGFjdDpcbiAqICAgICA8dWw+XG4gKiAgICAgICA8bGkgbmctcmVwZWF0PVwiY29udGFjdCBpbiBjb250YWN0c1wiPlxuICogICAgICAgICA8c2VsZWN0IG5nLW1vZGVsPVwiY29udGFjdC50eXBlXCIgaWQ9XCJzZWxlY3Rfe3skaW5kZXh9fVwiPlxuICogICAgICAgICAgICA8b3B0aW9uPnBob25lPC9vcHRpb24+XG4gKiAgICAgICAgICAgIDxvcHRpb24+ZW1haWw8L29wdGlvbj5cbiAqICAgICAgICAgPC9zZWxlY3Q+XG4gKiAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwiY29udGFjdC52YWx1ZVwiIGFyaWEtbGFiZWxsZWRieT1cInNlbGVjdF97eyRpbmRleH19XCIgLz5cbiAqICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cImNsZWFyQ29udGFjdChjb250YWN0KVwiPmNsZWFyPC9idXR0b24+XG4gKiAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJyZW1vdmVDb250YWN0KGNvbnRhY3QpXCI+WDwvYnV0dG9uPlxuICogICAgICAgPC9saT5cbiAqICAgICAgIDxsaT5bIDxidXR0b24gbmctY2xpY2s9XCJhZGRDb250YWN0KClcIj5hZGQ8L2J1dHRvbj4gXTwvbGk+XG4gKiAgICA8L3VsPlxuICogICA8L2Rpdj5cbiAqICA8L2ZpbGU+XG4gKiAgPGZpbGUgbmFtZT1cImFwcC5qc1wiPlxuICogICBhbmd1bGFyLm1vZHVsZSgnY29udHJvbGxlckV4YW1wbGUnLCBbXSlcbiAqICAgICAuY29udHJvbGxlcignU2V0dGluZ3NDb250cm9sbGVyMicsIFsnJHNjb3BlJywgU2V0dGluZ3NDb250cm9sbGVyMl0pO1xuICpcbiAqICAgZnVuY3Rpb24gU2V0dGluZ3NDb250cm9sbGVyMigkc2NvcGUpIHtcbiAqICAgICAkc2NvcGUubmFtZSA9IFwiSm9obiBTbWl0aFwiO1xuICogICAgICRzY29wZS5jb250YWN0cyA9IFtcbiAqICAgICAgIHt0eXBlOidwaG9uZScsIHZhbHVlOic0MDggNTU1IDEyMTInfSxcbiAqICAgICAgIHt0eXBlOidlbWFpbCcsIHZhbHVlOidqb2huLnNtaXRoQGV4YW1wbGUub3JnJ30gXTtcbiAqXG4gKiAgICAgJHNjb3BlLmdyZWV0ID0gZnVuY3Rpb24oKSB7XG4gKiAgICAgICBhbGVydCgkc2NvcGUubmFtZSk7XG4gKiAgICAgfTtcbiAqXG4gKiAgICAgJHNjb3BlLmFkZENvbnRhY3QgPSBmdW5jdGlvbigpIHtcbiAqICAgICAgICRzY29wZS5jb250YWN0cy5wdXNoKHt0eXBlOidlbWFpbCcsIHZhbHVlOid5b3VybmFtZUBleGFtcGxlLm9yZyd9KTtcbiAqICAgICB9O1xuICpcbiAqICAgICAkc2NvcGUucmVtb3ZlQ29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3RUb1JlbW92ZSkge1xuICogICAgICAgdmFyIGluZGV4ID0gJHNjb3BlLmNvbnRhY3RzLmluZGV4T2YoY29udGFjdFRvUmVtb3ZlKTtcbiAqICAgICAgICRzY29wZS5jb250YWN0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICogICAgIH07XG4gKlxuICogICAgICRzY29wZS5jbGVhckNvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0KSB7XG4gKiAgICAgICBjb250YWN0LnR5cGUgPSAncGhvbmUnO1xuICogICAgICAgY29udGFjdC52YWx1ZSA9ICcnO1xuICogICAgIH07XG4gKiAgIH1cbiAqICA8L2ZpbGU+XG4gKiAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICogICAgaXQoJ3Nob3VsZCBjaGVjayBjb250cm9sbGVyJywgZnVuY3Rpb24oKSB7XG4gKiAgICAgIHZhciBjb250YWluZXIgPSBlbGVtZW50KGJ5LmlkKCdjdHJsLWV4bXBsJykpO1xuICpcbiAqICAgICAgZXhwZWN0KGNvbnRhaW5lci5lbGVtZW50KGJ5Lm1vZGVsKCduYW1lJykpXG4gKiAgICAgICAgICAuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKS50b0JlKCdKb2huIFNtaXRoJyk7XG4gKlxuICogICAgICB2YXIgZmlyc3RSZXBlYXQgPVxuICogICAgICAgICAgY29udGFpbmVyLmVsZW1lbnQoYnkucmVwZWF0ZXIoJ2NvbnRhY3QgaW4gY29udGFjdHMnKS5yb3coMCkpO1xuICogICAgICB2YXIgc2Vjb25kUmVwZWF0ID1cbiAqICAgICAgICAgIGNvbnRhaW5lci5lbGVtZW50KGJ5LnJlcGVhdGVyKCdjb250YWN0IGluIGNvbnRhY3RzJykucm93KDEpKTtcbiAqXG4gKiAgICAgIGV4cGVjdChmaXJzdFJlcGVhdC5lbGVtZW50KGJ5Lm1vZGVsKCdjb250YWN0LnZhbHVlJykpLmdldEF0dHJpYnV0ZSgndmFsdWUnKSlcbiAqICAgICAgICAgIC50b0JlKCc0MDggNTU1IDEyMTInKTtcbiAqICAgICAgZXhwZWN0KHNlY29uZFJlcGVhdC5lbGVtZW50KGJ5Lm1vZGVsKCdjb250YWN0LnZhbHVlJykpLmdldEF0dHJpYnV0ZSgndmFsdWUnKSlcbiAqICAgICAgICAgIC50b0JlKCdqb2huLnNtaXRoQGV4YW1wbGUub3JnJyk7XG4gKlxuICogICAgICBmaXJzdFJlcGVhdC5lbGVtZW50KGJ5LmJ1dHRvblRleHQoJ2NsZWFyJykpLmNsaWNrKCk7XG4gKlxuICogICAgICBleHBlY3QoZmlyc3RSZXBlYXQuZWxlbWVudChieS5tb2RlbCgnY29udGFjdC52YWx1ZScpKS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpXG4gKiAgICAgICAgICAudG9CZSgnJyk7XG4gKlxuICogICAgICBjb250YWluZXIuZWxlbWVudChieS5idXR0b25UZXh0KCdhZGQnKSkuY2xpY2soKTtcbiAqXG4gKiAgICAgIGV4cGVjdChjb250YWluZXIuZWxlbWVudChieS5yZXBlYXRlcignY29udGFjdCBpbiBjb250YWN0cycpLnJvdygyKSlcbiAqICAgICAgICAgIC5lbGVtZW50KGJ5Lm1vZGVsKCdjb250YWN0LnZhbHVlJykpXG4gKiAgICAgICAgICAuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKVxuICogICAgICAgICAgLnRvQmUoJ3lvdXJuYW1lQGV4YW1wbGUub3JnJyk7XG4gKiAgICB9KTtcbiAqICA8L2ZpbGU+XG4gKjwvZXhhbXBsZT5cblxuICovXG52YXIgbmdDb250cm9sbGVyRGlyZWN0aXZlID0gW2Z1bmN0aW9uKCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgc2NvcGU6IHRydWUsXG4gICAgY29udHJvbGxlcjogJ0AnLFxuICAgIHByaW9yaXR5OiA1MDBcbiAgfTtcbn1dO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nQ3NwXG4gKlxuICogQGVsZW1lbnQgaHRtbFxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogQW5ndWxhciBoYXMgc29tZSBmZWF0dXJlcyB0aGF0IGNhbiBicmVhayBjZXJ0YWluXG4gKiBbQ1NQIChDb250ZW50IFNlY3VyaXR5IFBvbGljeSldKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL1NlY3VyaXR5L0NTUCkgcnVsZXMuXG4gKlxuICogSWYgeW91IGludGVuZCB0byBpbXBsZW1lbnQgdGhlc2UgcnVsZXMgdGhlbiB5b3UgbXVzdCB0ZWxsIEFuZ3VsYXIgbm90IHRvIHVzZSB0aGVzZSBmZWF0dXJlcy5cbiAqXG4gKiBUaGlzIGlzIG5lY2Vzc2FyeSB3aGVuIGRldmVsb3BpbmcgdGhpbmdzIGxpa2UgR29vZ2xlIENocm9tZSBFeHRlbnNpb25zIG9yIFVuaXZlcnNhbCBXaW5kb3dzIEFwcHMuXG4gKlxuICpcbiAqIFRoZSBmb2xsb3dpbmcgcnVsZXMgYWZmZWN0IEFuZ3VsYXI6XG4gKlxuICogKiBgdW5zYWZlLWV2YWxgOiB0aGlzIHJ1bGUgZm9yYmlkcyBhcHBzIHRvIHVzZSBgZXZhbGAgb3IgYEZ1bmN0aW9uKHN0cmluZylgIGdlbmVyYXRlZCBmdW5jdGlvbnNcbiAqIChhbW9uZyBvdGhlciB0aGluZ3MpLiBBbmd1bGFyIG1ha2VzIHVzZSBvZiB0aGlzIGluIHRoZSB7QGxpbmsgJHBhcnNlfSBzZXJ2aWNlIHRvIHByb3ZpZGUgYSAzMCVcbiAqIGluY3JlYXNlIGluIHRoZSBzcGVlZCBvZiBldmFsdWF0aW5nIEFuZ3VsYXIgZXhwcmVzc2lvbnMuXG4gKlxuICogKiBgdW5zYWZlLWlubGluZWA6IHRoaXMgcnVsZSBmb3JiaWRzIGFwcHMgZnJvbSBpbmplY3QgY3VzdG9tIHN0eWxlcyBpbnRvIHRoZSBkb2N1bWVudC4gQW5ndWxhclxuICogbWFrZXMgdXNlIG9mIHRoaXMgdG8gaW5jbHVkZSBzb21lIENTUyBydWxlcyAoZS5nLiB7QGxpbmsgbmdDbG9ha30gYW5kIHtAbGluayBuZ0hpZGV9KS5cbiAqIFRvIG1ha2UgdGhlc2UgZGlyZWN0aXZlcyB3b3JrIHdoZW4gYSBDU1AgcnVsZSBpcyBibG9ja2luZyBpbmxpbmUgc3R5bGVzLCB5b3UgbXVzdCBsaW5rIHRvIHRoZVxuICogYGFuZ3VsYXItY3NwLmNzc2AgaW4geW91ciBIVE1MIG1hbnVhbGx5LlxuICpcbiAqIElmIHlvdSBkbyBub3QgcHJvdmlkZSBgbmdDc3BgIHRoZW4gQW5ndWxhciB0cmllcyB0byBhdXRvZGV0ZWN0IGlmIENTUCBpcyBibG9ja2luZyB1bnNhZmUtZXZhbFxuICogYW5kIGF1dG9tYXRpY2FsbHkgZGVhY3RpdmF0ZXMgdGhpcyBmZWF0dXJlIGluIHRoZSB7QGxpbmsgJHBhcnNlfSBzZXJ2aWNlLiBUaGlzIGF1dG9kZXRlY3Rpb24sXG4gKiBob3dldmVyLCB0cmlnZ2VycyBhIENTUCBlcnJvciB0byBiZSBsb2dnZWQgaW4gdGhlIGNvbnNvbGU6XG4gKlxuICogYGBgXG4gKiBSZWZ1c2VkIHRvIGV2YWx1YXRlIGEgc3RyaW5nIGFzIEphdmFTY3JpcHQgYmVjYXVzZSAndW5zYWZlLWV2YWwnIGlzIG5vdCBhbiBhbGxvd2VkIHNvdXJjZSBvZlxuICogc2NyaXB0IGluIHRoZSBmb2xsb3dpbmcgQ29udGVudCBTZWN1cml0eSBQb2xpY3kgZGlyZWN0aXZlOiBcImRlZmF1bHQtc3JjICdzZWxmJ1wiLiBOb3RlIHRoYXRcbiAqICdzY3JpcHQtc3JjJyB3YXMgbm90IGV4cGxpY2l0bHkgc2V0LCBzbyAnZGVmYXVsdC1zcmMnIGlzIHVzZWQgYXMgYSBmYWxsYmFjay5cbiAqIGBgYFxuICpcbiAqIFRoaXMgZXJyb3IgaXMgaGFybWxlc3MgYnV0IGFubm95aW5nLiBUbyBwcmV2ZW50IHRoZSBlcnJvciBmcm9tIHNob3dpbmcgdXAsIHB1dCB0aGUgYG5nQ3NwYFxuICogZGlyZWN0aXZlIG9uIGFuIGVsZW1lbnQgb2YgdGhlIEhUTUwgZG9jdW1lbnQgdGhhdCBhcHBlYXJzIGJlZm9yZSB0aGUgYDxzY3JpcHQ+YCB0YWcgdGhhdCBsb2Fkc1xuICogdGhlIGBhbmd1bGFyLmpzYCBmaWxlLlxuICpcbiAqICpOb3RlOiBUaGlzIGRpcmVjdGl2ZSBpcyBvbmx5IGF2YWlsYWJsZSBpbiB0aGUgYG5nLWNzcGAgYW5kIGBkYXRhLW5nLWNzcGAgYXR0cmlidXRlIGZvcm0uKlxuICpcbiAqIFlvdSBjYW4gc3BlY2lmeSB3aGljaCBvZiB0aGUgQ1NQIHJlbGF0ZWQgQW5ndWxhciBmZWF0dXJlcyBzaG91bGQgYmUgZGVhY3RpdmF0ZWQgYnkgcHJvdmlkaW5nXG4gKiBhIHZhbHVlIGZvciB0aGUgYG5nLWNzcGAgYXR0cmlidXRlLiBUaGUgb3B0aW9ucyBhcmUgYXMgZm9sbG93czpcbiAqXG4gKiAqIG5vLWlubGluZS1zdHlsZTogdGhpcyBzdG9wcyBBbmd1bGFyIGZyb20gaW5qZWN0aW5nIENTUyBzdHlsZXMgaW50byB0aGUgRE9NXG4gKlxuICogKiBuby11bnNhZmUtZXZhbDogdGhpcyBzdG9wcyBBbmd1bGFyIGZyb20gb3B0aW1pemluZyAkcGFyc2Ugd2l0aCB1bnNhZmUgZXZhbCBvZiBzdHJpbmdzXG4gKlxuICogWW91IGNhbiB1c2UgdGhlc2UgdmFsdWVzIGluIHRoZSBmb2xsb3dpbmcgY29tYmluYXRpb25zOlxuICpcbiAqXG4gKiAqIE5vIGRlY2xhcmF0aW9uIG1lYW5zIHRoYXQgQW5ndWxhciB3aWxsIGFzc3VtZSB0aGF0IHlvdSBjYW4gZG8gaW5saW5lIHN0eWxlcywgYnV0IGl0IHdpbGwgZG9cbiAqIGEgcnVudGltZSBjaGVjayBmb3IgdW5zYWZlLWV2YWwuIEUuZy4gYDxib2R5PmAuIFRoaXMgaXMgYmFja3dhcmRseSBjb21wYXRpYmxlIHdpdGggcHJldmlvdXMgdmVyc2lvbnNcbiAqIG9mIEFuZ3VsYXIuXG4gKlxuICogKiBBIHNpbXBsZSBgbmctY3NwYCAob3IgYGRhdGEtbmctY3NwYCkgYXR0cmlidXRlIHdpbGwgdGVsbCBBbmd1bGFyIHRvIGRlYWN0aXZhdGUgYm90aCBpbmxpbmVcbiAqIHN0eWxlcyBhbmQgdW5zYWZlIGV2YWwuIEUuZy4gYDxib2R5IG5nLWNzcD5gLiBUaGlzIGlzIGJhY2t3YXJkbHkgY29tcGF0aWJsZSB3aXRoIHByZXZpb3VzIHZlcnNpb25zXG4gKiBvZiBBbmd1bGFyLlxuICpcbiAqICogU3BlY2lmeWluZyBvbmx5IGBuby11bnNhZmUtZXZhbGAgdGVsbHMgQW5ndWxhciB0aGF0IHdlIG11c3Qgbm90IHVzZSBldmFsLCBidXQgdGhhdCB3ZSBjYW4gaW5qZWN0XG4gKiBpbmxpbmUgc3R5bGVzLiBFLmcuIGA8Ym9keSBuZy1jc3A9XCJuby11bnNhZmUtZXZhbFwiPmAuXG4gKlxuICogKiBTcGVjaWZ5aW5nIG9ubHkgYG5vLWlubGluZS1zdHlsZWAgdGVsbHMgQW5ndWxhciB0aGF0IHdlIG11c3Qgbm90IGluamVjdCBzdHlsZXMsIGJ1dCB0aGF0IHdlIGNhblxuICogcnVuIGV2YWwgLSBubyBhdXRvbWF0aWMgY2hlY2sgZm9yIHVuc2FmZSBldmFsIHdpbGwgb2NjdXIuIEUuZy4gYDxib2R5IG5nLWNzcD1cIm5vLWlubGluZS1zdHlsZVwiPmBcbiAqXG4gKiAqIFNwZWNpZnlpbmcgYm90aCBgbm8tdW5zYWZlLWV2YWxgIGFuZCBgbm8taW5saW5lLXN0eWxlYCB0ZWxscyBBbmd1bGFyIHRoYXQgd2UgbXVzdCBub3QgaW5qZWN0XG4gKiBzdHlsZXMgbm9yIHVzZSBldmFsLCB3aGljaCBpcyB0aGUgc2FtZSBhcyBhbiBlbXB0eTogbmctY3NwLlxuICogRS5nLmA8Ym9keSBuZy1jc3A9XCJuby1pbmxpbmUtc3R5bGU7bm8tdW5zYWZlLWV2YWxcIj5gXG4gKlxuICogQGV4YW1wbGVcbiAqIFRoaXMgZXhhbXBsZSBzaG93cyBob3cgdG8gYXBwbHkgdGhlIGBuZ0NzcGAgZGlyZWN0aXZlIHRvIHRoZSBgaHRtbGAgdGFnLlxuICAgYGBgaHRtbFxuICAgICA8IWRvY3R5cGUgaHRtbD5cbiAgICAgPGh0bWwgbmctYXBwIG5nLWNzcD5cbiAgICAgLi4uXG4gICAgIC4uLlxuICAgICA8L2h0bWw+XG4gICBgYGBcbiAgKiBAZXhhbXBsZVxuICAgICAgLy8gTm90ZTogdGhlIHN1ZmZpeCBgLmNzcGAgaW4gdGhlIGV4YW1wbGUgbmFtZSB0cmlnZ2Vyc1xuICAgICAgLy8gY3NwIG1vZGUgaW4gb3VyIGh0dHAgc2VydmVyIVxuICAgICAgPGV4YW1wbGUgbmFtZT1cImV4YW1wbGUuY3NwXCIgbW9kdWxlPVwiY3NwRXhhbXBsZVwiIG5nLWNzcD1cInRydWVcIj5cbiAgICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJNYWluQ29udHJvbGxlciBhcyBjdHJsXCI+XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwiY3RybC5pbmMoKVwiIGlkPVwiaW5jXCI+SW5jcmVtZW50PC9idXR0b24+XG4gICAgICAgICAgICAgIDxzcGFuIGlkPVwiY291bnRlclwiPlxuICAgICAgICAgICAgICAgIHt7Y3RybC5jb3VudGVyfX1cbiAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJjdHJsLmV2aWwoKVwiIGlkPVwiZXZpbFwiPkV2aWw8L2J1dHRvbj5cbiAgICAgICAgICAgICAgPHNwYW4gaWQ9XCJldmlsRXJyb3JcIj5cbiAgICAgICAgICAgICAgICB7e2N0cmwuZXZpbEVycm9yfX1cbiAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZmlsZT5cbiAgICAgICAgPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuICAgICAgICAgICBhbmd1bGFyLm1vZHVsZSgnY3NwRXhhbXBsZScsIFtdKVxuICAgICAgICAgICAgIC5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY291bnRlciA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuY291bnRlcisrO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5ldmlsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAvLyBqc2hpbnQgZXZpbDp0cnVlXG4gICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBldmFsKCcxKzInKTtcbiAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmlsRXJyb3IgPSBlLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgIDwvZmlsZT5cbiAgICAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgICAgIHZhciB1dGlsLCB3ZWJkcml2ZXI7XG5cbiAgICAgICAgICB2YXIgaW5jQnRuID0gZWxlbWVudChieS5pZCgnaW5jJykpO1xuICAgICAgICAgIHZhciBjb3VudGVyID0gZWxlbWVudChieS5pZCgnY291bnRlcicpKTtcbiAgICAgICAgICB2YXIgZXZpbEJ0biA9IGVsZW1lbnQoYnkuaWQoJ2V2aWwnKSk7XG4gICAgICAgICAgdmFyIGV2aWxFcnJvciA9IGVsZW1lbnQoYnkuaWQoJ2V2aWxFcnJvcicpKTtcblxuICAgICAgICAgIGZ1bmN0aW9uIGdldEFuZENsZWFyU2V2ZXJlRXJyb3JzKCkge1xuICAgICAgICAgICAgcmV0dXJuIGJyb3dzZXIubWFuYWdlKCkubG9ncygpLmdldCgnYnJvd3NlcicpLnRoZW4oZnVuY3Rpb24oYnJvd3NlckxvZykge1xuICAgICAgICAgICAgICByZXR1cm4gYnJvd3NlckxvZy5maWx0ZXIoZnVuY3Rpb24obG9nRW50cnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9nRW50cnkubGV2ZWwudmFsdWUgPiB3ZWJkcml2ZXIubG9nZ2luZy5MZXZlbC5XQVJOSU5HLnZhbHVlO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGNsZWFyRXJyb3JzKCkge1xuICAgICAgICAgICAgZ2V0QW5kQ2xlYXJTZXZlcmVFcnJvcnMoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBleHBlY3ROb0Vycm9ycygpIHtcbiAgICAgICAgICAgIGdldEFuZENsZWFyU2V2ZXJlRXJyb3JzKCkudGhlbihmdW5jdGlvbihmaWx0ZXJlZExvZykge1xuICAgICAgICAgICAgICBleHBlY3QoZmlsdGVyZWRMb2cubGVuZ3RoKS50b0VxdWFsKDApO1xuICAgICAgICAgICAgICBpZiAoZmlsdGVyZWRMb2cubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Jyb3dzZXIgY29uc29sZSBlcnJvcnM6ICcgKyB1dGlsLmluc3BlY3QoZmlsdGVyZWRMb2cpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gZXhwZWN0RXJyb3IocmVnZXgpIHtcbiAgICAgICAgICAgIGdldEFuZENsZWFyU2V2ZXJlRXJyb3JzKCkudGhlbihmdW5jdGlvbihmaWx0ZXJlZExvZykge1xuICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgZmlsdGVyZWRMb2cuZm9yRWFjaChmdW5jdGlvbihsb2cpIHtcbiAgICAgICAgICAgICAgICBpZiAobG9nLm1lc3NhZ2UubWF0Y2gocmVnZXgpKSB7XG4gICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgaWYgKCFmb3VuZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignZXhwZWN0ZWQgYW4gZXJyb3IgdGhhdCBtYXRjaGVzICcgKyByZWdleCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJlZm9yZUVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB1dGlsID0gcmVxdWlyZSgndXRpbCcpO1xuICAgICAgICAgICAgd2ViZHJpdmVyID0gcmVxdWlyZSgncHJvdHJhY3Rvci9ub2RlX21vZHVsZXMvc2VsZW5pdW0td2ViZHJpdmVyJyk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBGb3Igbm93LCB3ZSBvbmx5IHRlc3Qgb24gQ2hyb21lLFxuICAgICAgICAgIC8vIGFzIFNhZmFyaSBkb2VzIG5vdCBsb2FkIHRoZSBwYWdlIHdpdGggUHJvdHJhY3RvcidzIGluamVjdGVkIHNjcmlwdHMsXG4gICAgICAgICAgLy8gYW5kIEZpcmVmb3ggd2ViZHJpdmVyIGFsd2F5cyBkaXNhYmxlcyBjb250ZW50IHNlY3VyaXR5IHBvbGljeSAoIzYzNTgpXG4gICAgICAgICAgaWYgKGJyb3dzZXIucGFyYW1zLmJyb3dzZXIgIT09ICdjaHJvbWUnKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaXQoJ3Nob3VsZCBub3QgcmVwb3J0IGVycm9ycyB3aGVuIHRoZSBwYWdlIGlzIGxvYWRlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gY2xlYXIgZXJyb3JzIHNvIHdlIGFyZSBub3QgZGVwZW5kZW50IG9uIHByZXZpb3VzIHRlc3RzXG4gICAgICAgICAgICBjbGVhckVycm9ycygpO1xuICAgICAgICAgICAgLy8gTmVlZCB0byByZWxvYWQgdGhlIHBhZ2UgYXMgdGhlIHBhZ2UgaXMgYWxyZWFkeSBsb2FkZWQgd2hlblxuICAgICAgICAgICAgLy8gd2UgY29tZSBoZXJlXG4gICAgICAgICAgICBicm93c2VyLmRyaXZlci5nZXRDdXJyZW50VXJsKCkudGhlbihmdW5jdGlvbih1cmwpIHtcbiAgICAgICAgICAgICAgYnJvd3Nlci5nZXQodXJsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZXhwZWN0Tm9FcnJvcnMoKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGl0KCdzaG91bGQgZXZhbHVhdGUgZXhwcmVzc2lvbnMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGV4cGVjdChjb3VudGVyLmdldFRleHQoKSkudG9FcXVhbCgnMCcpO1xuICAgICAgICAgICAgaW5jQnRuLmNsaWNrKCk7XG4gICAgICAgICAgICBleHBlY3QoY291bnRlci5nZXRUZXh0KCkpLnRvRXF1YWwoJzEnKTtcbiAgICAgICAgICAgIGV4cGVjdE5vRXJyb3JzKCk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpdCgnc2hvdWxkIHRocm93IGFuZCByZXBvcnQgYW4gZXJyb3Igd2hlbiB1c2luZyBcImV2YWxcIicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZXZpbEJ0bi5jbGljaygpO1xuICAgICAgICAgICAgZXhwZWN0KGV2aWxFcnJvci5nZXRUZXh0KCkpLnRvTWF0Y2goL0NvbnRlbnQgU2VjdXJpdHkgUG9saWN5Lyk7XG4gICAgICAgICAgICBleHBlY3RFcnJvcigvQ29udGVudCBTZWN1cml0eSBQb2xpY3kvKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgPC9maWxlPlxuICAgICAgPC9leGFtcGxlPlxuICAqL1xuXG4vLyBuZ0NzcCBpcyBub3QgaW1wbGVtZW50ZWQgYXMgYSBwcm9wZXIgZGlyZWN0aXZlIGFueSBtb3JlLCBiZWNhdXNlIHdlIG5lZWQgaXQgYmUgcHJvY2Vzc2VkIHdoaWxlIHdlXG4vLyBib290c3RyYXAgdGhlIHN5c3RlbSAoYmVmb3JlICRwYXJzZSBpcyBpbnN0YW50aWF0ZWQpLCBmb3IgdGhpcyByZWFzb24gd2UganVzdCBoYXZlXG4vLyB0aGUgY3NwKCkgZm4gdGhhdCBsb29rcyBmb3IgdGhlIGBuZy1jc3BgIGF0dHJpYnV0ZSBhbnl3aGVyZSBpbiB0aGUgY3VycmVudCBkb2NcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ0NsaWNrXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGUgbmdDbGljayBkaXJlY3RpdmUgYWxsb3dzIHlvdSB0byBzcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciB3aGVuXG4gKiBhbiBlbGVtZW50IGlzIGNsaWNrZWQuXG4gKlxuICogQGVsZW1lbnQgQU5ZXG4gKiBAcHJpb3JpdHkgMFxuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0NsaWNrIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWx1YXRlIHVwb25cbiAqIGNsaWNrLiAoe0BsaW5rIGd1aWRlL2V4cHJlc3Npb24jLWV2ZW50LSBFdmVudCBvYmplY3QgaXMgYXZhaWxhYmxlIGFzIGAkZXZlbnRgfSlcbiAqXG4gKiBAZXhhbXBsZVxuICAgPGV4YW1wbGU+XG4gICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICA8YnV0dG9uIG5nLWNsaWNrPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuICAgICAgICBJbmNyZW1lbnRcbiAgICAgIDwvYnV0dG9uPlxuICAgICAgPHNwYW4+XG4gICAgICAgIGNvdW50OiB7e2NvdW50fX1cbiAgICAgIDwvc3Bhbj5cbiAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1jbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygnY291bnQnKSkuZ2V0VGV4dCgpKS50b01hdGNoKCcwJyk7XG4gICAgICAgICBlbGVtZW50KGJ5LmNzcygnYnV0dG9uJykpLmNsaWNrKCk7XG4gICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKCdjb3VudCcpKS5nZXRUZXh0KCkpLnRvTWF0Y2goJzEnKTtcbiAgICAgICB9KTtcbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG4vKlxuICogQSBjb2xsZWN0aW9uIG9mIGRpcmVjdGl2ZXMgdGhhdCBhbGxvd3MgY3JlYXRpb24gb2YgY3VzdG9tIGV2ZW50IGhhbmRsZXJzIHRoYXQgYXJlIGRlZmluZWQgYXNcbiAqIGFuZ3VsYXIgZXhwcmVzc2lvbnMgYW5kIGFyZSBjb21waWxlZCBhbmQgZXhlY3V0ZWQgd2l0aGluIHRoZSBjdXJyZW50IHNjb3BlLlxuICovXG52YXIgbmdFdmVudERpcmVjdGl2ZXMgPSB7fTtcblxuLy8gRm9yIGV2ZW50cyB0aGF0IG1pZ2h0IGZpcmUgc3luY2hyb25vdXNseSBkdXJpbmcgRE9NIG1hbmlwdWxhdGlvblxuLy8gd2UgbmVlZCB0byBleGVjdXRlIHRoZWlyIGV2ZW50IGhhbmRsZXJzIGFzeW5jaHJvbm91c2x5IHVzaW5nICRldmFsQXN5bmMsXG4vLyBzbyB0aGF0IHRoZXkgYXJlIG5vdCBleGVjdXRlZCBpbiBhbiBpbmNvbnNpc3RlbnQgc3RhdGUuXG52YXIgZm9yY2VBc3luY0V2ZW50cyA9IHtcbiAgJ2JsdXInOiB0cnVlLFxuICAnZm9jdXMnOiB0cnVlXG59O1xuZm9yRWFjaChcbiAgJ2NsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZW1vdmUgbW91c2VlbnRlciBtb3VzZWxlYXZlIGtleWRvd24ga2V5dXAga2V5cHJlc3Mgc3VibWl0IGZvY3VzIGJsdXIgY29weSBjdXQgcGFzdGUnLnNwbGl0KCcgJyksXG4gIGZ1bmN0aW9uKGV2ZW50TmFtZSkge1xuICAgIHZhciBkaXJlY3RpdmVOYW1lID0gZGlyZWN0aXZlTm9ybWFsaXplKCduZy0nICsgZXZlbnROYW1lKTtcbiAgICBuZ0V2ZW50RGlyZWN0aXZlc1tkaXJlY3RpdmVOYW1lXSA9IFsnJHBhcnNlJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkcGFyc2UsICRyb290U2NvcGUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uKCRlbGVtZW50LCBhdHRyKSB7XG4gICAgICAgICAgLy8gV2UgZXhwb3NlIHRoZSBwb3dlcmZ1bCAkZXZlbnQgb2JqZWN0IG9uIHRoZSBzY29wZSB0aGF0IHByb3ZpZGVzIGFjY2VzcyB0byB0aGUgV2luZG93LFxuICAgICAgICAgIC8vIGV0Yy4gdGhhdCBpc24ndCBwcm90ZWN0ZWQgYnkgdGhlIGZhc3QgcGF0aHMgaW4gJHBhcnNlLiAgV2UgZXhwbGljaXRseSByZXF1ZXN0IGJldHRlclxuICAgICAgICAgIC8vIGNoZWNrcyBhdCB0aGUgY29zdCBvZiBzcGVlZCBzaW5jZSBldmVudCBoYW5kbGVyIGV4cHJlc3Npb25zIGFyZSBub3QgZXhlY3V0ZWQgYXNcbiAgICAgICAgICAvLyBmcmVxdWVudGx5IGFzIHJlZ3VsYXIgY2hhbmdlIGRldGVjdGlvbi5cbiAgICAgICAgICB2YXIgZm4gPSAkcGFyc2UoYXR0cltkaXJlY3RpdmVOYW1lXSwgLyogaW50ZXJjZXB0b3JGbiAqLyBudWxsLCAvKiBleHBlbnNpdmVDaGVja3MgKi8gdHJ1ZSk7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5nRXZlbnRIYW5kbGVyKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgICAgICBlbGVtZW50Lm9uKGV2ZW50TmFtZSwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZm4oc2NvcGUsIHskZXZlbnQ6ZXZlbnR9KTtcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgaWYgKGZvcmNlQXN5bmNFdmVudHNbZXZlbnROYW1lXSAmJiAkcm9vdFNjb3BlLiQkcGhhc2UpIHtcbiAgICAgICAgICAgICAgICBzY29wZS4kZXZhbEFzeW5jKGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoY2FsbGJhY2spO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1dO1xuICB9XG4pO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nRGJsY2xpY2tcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBgbmdEYmxjbGlja2AgZGlyZWN0aXZlIGFsbG93cyB5b3UgdG8gc3BlY2lmeSBjdXN0b20gYmVoYXZpb3Igb24gYSBkYmxjbGljayBldmVudC5cbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqIEBwcmlvcml0eSAwXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nRGJsY2xpY2sge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvblxuICogYSBkYmxjbGljay4gKFRoZSBFdmVudCBvYmplY3QgaXMgYXZhaWxhYmxlIGFzIGAkZXZlbnRgKVxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZT5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxidXR0b24gbmctZGJsY2xpY2s9XCJjb3VudCA9IGNvdW50ICsgMVwiIG5nLWluaXQ9XCJjb3VudD0wXCI+XG4gICAgICAgIEluY3JlbWVudCAob24gZG91YmxlIGNsaWNrKVxuICAgICAgPC9idXR0b24+XG4gICAgICBjb3VudDoge3tjb3VudH19XG4gICAgIDwvZmlsZT5cbiAgIDwvZXhhbXBsZT5cbiAqL1xuXG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdNb3VzZWRvd25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBuZ01vdXNlZG93biBkaXJlY3RpdmUgYWxsb3dzIHlvdSB0byBzcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBtb3VzZWRvd24gZXZlbnQuXG4gKlxuICogQGVsZW1lbnQgQU5ZXG4gKiBAcHJpb3JpdHkgMFxuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ01vdXNlZG93biB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG4gKiBtb3VzZWRvd24uICh7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiMtZXZlbnQtIEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGB9KVxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZT5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxidXR0b24gbmctbW91c2Vkb3duPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuICAgICAgICBJbmNyZW1lbnQgKG9uIG1vdXNlIGRvd24pXG4gICAgICA8L2J1dHRvbj5cbiAgICAgIGNvdW50OiB7e2NvdW50fX1cbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG5cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ01vdXNldXBcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIG9uIG1vdXNldXAgZXZlbnQuXG4gKlxuICogQGVsZW1lbnQgQU5ZXG4gKiBAcHJpb3JpdHkgMFxuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ01vdXNldXAge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvblxuICogbW91c2V1cC4gKHtAbGluayBndWlkZS9leHByZXNzaW9uIy1ldmVudC0gRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YH0pXG4gKlxuICogQGV4YW1wbGVcbiAgIDxleGFtcGxlPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgPGJ1dHRvbiBuZy1tb3VzZXVwPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuICAgICAgICBJbmNyZW1lbnQgKG9uIG1vdXNlIHVwKVxuICAgICAgPC9idXR0b24+XG4gICAgICBjb3VudDoge3tjb3VudH19XG4gICAgIDwvZmlsZT5cbiAgIDwvZXhhbXBsZT5cbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nTW91c2VvdmVyXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBtb3VzZW92ZXIgZXZlbnQuXG4gKlxuICogQGVsZW1lbnQgQU5ZXG4gKiBAcHJpb3JpdHkgMFxuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ01vdXNlb3ZlciB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG4gKiBtb3VzZW92ZXIuICh7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiMtZXZlbnQtIEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGB9KVxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZT5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxidXR0b24gbmctbW91c2VvdmVyPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuICAgICAgICBJbmNyZW1lbnQgKHdoZW4gbW91c2UgaXMgb3ZlcilcbiAgICAgIDwvYnV0dG9uPlxuICAgICAgY291bnQ6IHt7Y291bnR9fVxuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gKi9cblxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nTW91c2VlbnRlclxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogU3BlY2lmeSBjdXN0b20gYmVoYXZpb3Igb24gbW91c2VlbnRlciBldmVudC5cbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqIEBwcmlvcml0eSAwXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nTW91c2VlbnRlciB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG4gKiBtb3VzZWVudGVyLiAoe0BsaW5rIGd1aWRlL2V4cHJlc3Npb24jLWV2ZW50LSBFdmVudCBvYmplY3QgaXMgYXZhaWxhYmxlIGFzIGAkZXZlbnRgfSlcbiAqXG4gKiBAZXhhbXBsZVxuICAgPGV4YW1wbGU+XG4gICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICA8YnV0dG9uIG5nLW1vdXNlZW50ZXI9XCJjb3VudCA9IGNvdW50ICsgMVwiIG5nLWluaXQ9XCJjb3VudD0wXCI+XG4gICAgICAgIEluY3JlbWVudCAod2hlbiBtb3VzZSBlbnRlcnMpXG4gICAgICA8L2J1dHRvbj5cbiAgICAgIGNvdW50OiB7e2NvdW50fX1cbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG5cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ01vdXNlbGVhdmVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIG9uIG1vdXNlbGVhdmUgZXZlbnQuXG4gKlxuICogQGVsZW1lbnQgQU5ZXG4gKiBAcHJpb3JpdHkgMFxuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ01vdXNlbGVhdmUge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvblxuICogbW91c2VsZWF2ZS4gKHtAbGluayBndWlkZS9leHByZXNzaW9uIy1ldmVudC0gRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YH0pXG4gKlxuICogQGV4YW1wbGVcbiAgIDxleGFtcGxlPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgPGJ1dHRvbiBuZy1tb3VzZWxlYXZlPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuICAgICAgICBJbmNyZW1lbnQgKHdoZW4gbW91c2UgbGVhdmVzKVxuICAgICAgPC9idXR0b24+XG4gICAgICBjb3VudDoge3tjb3VudH19XG4gICAgIDwvZmlsZT5cbiAgIDwvZXhhbXBsZT5cbiAqL1xuXG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdNb3VzZW1vdmVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIG9uIG1vdXNlbW92ZSBldmVudC5cbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqIEBwcmlvcml0eSAwXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nTW91c2Vtb3ZlIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWx1YXRlIHVwb25cbiAqIG1vdXNlbW92ZS4gKHtAbGluayBndWlkZS9leHByZXNzaW9uIy1ldmVudC0gRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YH0pXG4gKlxuICogQGV4YW1wbGVcbiAgIDxleGFtcGxlPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgPGJ1dHRvbiBuZy1tb3VzZW1vdmU9XCJjb3VudCA9IGNvdW50ICsgMVwiIG5nLWluaXQ9XCJjb3VudD0wXCI+XG4gICAgICAgIEluY3JlbWVudCAod2hlbiBtb3VzZSBtb3ZlcylcbiAgICAgIDwvYnV0dG9uPlxuICAgICAgY291bnQ6IHt7Y291bnR9fVxuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gKi9cblxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nS2V5ZG93blxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogU3BlY2lmeSBjdXN0b20gYmVoYXZpb3Igb24ga2V5ZG93biBldmVudC5cbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqIEBwcmlvcml0eSAwXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nS2V5ZG93biB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG4gKiBrZXlkb3duLiAoRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YCBhbmQgY2FuIGJlIGludGVycm9nYXRlZCBmb3Iga2V5Q29kZSwgYWx0S2V5LCBldGMuKVxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZT5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxpbnB1dCBuZy1rZXlkb3duPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuICAgICAga2V5IGRvd24gY291bnQ6IHt7Y291bnR9fVxuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gKi9cblxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nS2V5dXBcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIG9uIGtleXVwIGV2ZW50LlxuICpcbiAqIEBlbGVtZW50IEFOWVxuICogQHByaW9yaXR5IDBcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdLZXl1cCB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG4gKiBrZXl1cC4gKEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGAgYW5kIGNhbiBiZSBpbnRlcnJvZ2F0ZWQgZm9yIGtleUNvZGUsIGFsdEtleSwgZXRjLilcbiAqXG4gKiBAZXhhbXBsZVxuICAgPGV4YW1wbGU+XG4gICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgPHA+VHlwaW5nIGluIHRoZSBpbnB1dCBib3ggYmVsb3cgdXBkYXRlcyB0aGUga2V5IGNvdW50PC9wPlxuICAgICAgIDxpbnB1dCBuZy1rZXl1cD1cImNvdW50ID0gY291bnQgKyAxXCIgbmctaW5pdD1cImNvdW50PTBcIj4ga2V5IHVwIGNvdW50OiB7e2NvdW50fX1cblxuICAgICAgIDxwPlR5cGluZyBpbiB0aGUgaW5wdXQgYm94IGJlbG93IHVwZGF0ZXMgdGhlIGtleWNvZGU8L3A+XG4gICAgICAgPGlucHV0IG5nLWtleXVwPVwiZXZlbnQ9JGV2ZW50XCI+XG4gICAgICAgPHA+ZXZlbnQga2V5Q29kZToge3sgZXZlbnQua2V5Q29kZSB9fTwvcD5cbiAgICAgICA8cD5ldmVudCBhbHRLZXk6IHt7IGV2ZW50LmFsdEtleSB9fTwvcD5cbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG5cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ0tleXByZXNzXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBrZXlwcmVzcyBldmVudC5cbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdLZXlwcmVzcyB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG4gKiBrZXlwcmVzcy4gKHtAbGluayBndWlkZS9leHByZXNzaW9uIy1ldmVudC0gRXZlbnQgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YH1cbiAqIGFuZCBjYW4gYmUgaW50ZXJyb2dhdGVkIGZvciBrZXlDb2RlLCBhbHRLZXksIGV0Yy4pXG4gKlxuICogQGV4YW1wbGVcbiAgIDxleGFtcGxlPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgPGlucHV0IG5nLWtleXByZXNzPVwiY291bnQgPSBjb3VudCArIDFcIiBuZy1pbml0PVwiY291bnQ9MFwiPlxuICAgICAga2V5IHByZXNzIGNvdW50OiB7e2NvdW50fX1cbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG5cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ1N1Ym1pdFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogRW5hYmxlcyBiaW5kaW5nIGFuZ3VsYXIgZXhwcmVzc2lvbnMgdG8gb25zdWJtaXQgZXZlbnRzLlxuICpcbiAqIEFkZGl0aW9uYWxseSBpdCBwcmV2ZW50cyB0aGUgZGVmYXVsdCBhY3Rpb24gKHdoaWNoIGZvciBmb3JtIG1lYW5zIHNlbmRpbmcgdGhlIHJlcXVlc3QgdG8gdGhlXG4gKiBzZXJ2ZXIgYW5kIHJlbG9hZGluZyB0aGUgY3VycmVudCBwYWdlKSwgYnV0IG9ubHkgaWYgdGhlIGZvcm0gZG9lcyBub3QgY29udGFpbiBgYWN0aW9uYCxcbiAqIGBkYXRhLWFjdGlvbmAsIG9yIGB4LWFjdGlvbmAgYXR0cmlidXRlcy5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiPlxuICogKipXYXJuaW5nOioqIEJlIGNhcmVmdWwgbm90IHRvIGNhdXNlIFwiZG91YmxlLXN1Ym1pc3Npb25cIiBieSB1c2luZyBib3RoIHRoZSBgbmdDbGlja2AgYW5kXG4gKiBgbmdTdWJtaXRgIGhhbmRsZXJzIHRvZ2V0aGVyLiBTZWUgdGhlXG4gKiB7QGxpbmsgZm9ybSNzdWJtaXR0aW5nLWEtZm9ybS1hbmQtcHJldmVudGluZy10aGUtZGVmYXVsdC1hY3Rpb24gYGZvcm1gIGRpcmVjdGl2ZSBkb2N1bWVudGF0aW9ufVxuICogZm9yIGEgZGV0YWlsZWQgZGlzY3Vzc2lvbiBvZiB3aGVuIGBuZ1N1Ym1pdGAgbWF5IGJlIHRyaWdnZXJlZC5cbiAqIDwvZGl2PlxuICpcbiAqIEBlbGVtZW50IGZvcm1cbiAqIEBwcmlvcml0eSAwXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nU3VibWl0IHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWwuXG4gKiAoe0BsaW5rIGd1aWRlL2V4cHJlc3Npb24jLWV2ZW50LSBFdmVudCBvYmplY3QgaXMgYXZhaWxhYmxlIGFzIGAkZXZlbnRgfSlcbiAqXG4gKiBAZXhhbXBsZVxuICAgPGV4YW1wbGUgbW9kdWxlPVwic3VibWl0RXhhbXBsZVwiPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgPHNjcmlwdD5cbiAgICAgICAgYW5ndWxhci5tb2R1bGUoJ3N1Ym1pdEV4YW1wbGUnLCBbXSlcbiAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICAgJHNjb3BlLmxpc3QgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS50ZXh0ID0gJ2hlbGxvJztcbiAgICAgICAgICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgaWYgKCRzY29wZS50ZXh0KSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpc3QucHVzaCh0aGlzLnRleHQpO1xuICAgICAgICAgICAgICAgICRzY29wZS50ZXh0ID0gJyc7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfV0pO1xuICAgICAgPC9zY3JpcHQ+XG4gICAgICA8Zm9ybSBuZy1zdWJtaXQ9XCJzdWJtaXQoKVwiIG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICAgICBFbnRlciB0ZXh0IGFuZCBoaXQgZW50ZXI6XG4gICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwidGV4dFwiIG5hbWU9XCJ0ZXh0XCIgLz5cbiAgICAgICAgPGlucHV0IHR5cGU9XCJzdWJtaXRcIiBpZD1cInN1Ym1pdFwiIHZhbHVlPVwiU3VibWl0XCIgLz5cbiAgICAgICAgPHByZT5saXN0PXt7bGlzdH19PC9wcmU+XG4gICAgICA8L2Zvcm0+XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgIGl0KCdzaG91bGQgY2hlY2sgbmctc3VibWl0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKCdsaXN0JykpLmdldFRleHQoKSkudG9CZSgnbGlzdD1bXScpO1xuICAgICAgICAgZWxlbWVudChieS5jc3MoJyNzdWJtaXQnKSkuY2xpY2soKTtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ2xpc3QnKSkuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2hlbGxvJyk7XG4gICAgICAgICBleHBlY3QoZWxlbWVudChieS5tb2RlbCgndGV4dCcpKS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpLnRvQmUoJycpO1xuICAgICAgIH0pO1xuICAgICAgIGl0KCdzaG91bGQgaWdub3JlIGVtcHR5IHN0cmluZ3MnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ2xpc3QnKSkuZ2V0VGV4dCgpKS50b0JlKCdsaXN0PVtdJyk7XG4gICAgICAgICBlbGVtZW50KGJ5LmNzcygnI3N1Ym1pdCcpKS5jbGljaygpO1xuICAgICAgICAgZWxlbWVudChieS5jc3MoJyNzdWJtaXQnKSkuY2xpY2soKTtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ2xpc3QnKSkuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2hlbGxvJyk7XG4gICAgICAgIH0pO1xuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gKi9cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ0ZvY3VzXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBmb2N1cyBldmVudC5cbiAqXG4gKiBOb3RlOiBBcyB0aGUgYGZvY3VzYCBldmVudCBpcyBleGVjdXRlZCBzeW5jaHJvbm91c2x5IHdoZW4gY2FsbGluZyBgaW5wdXQuZm9jdXMoKWBcbiAqIEFuZ3VsYXJKUyBleGVjdXRlcyB0aGUgZXhwcmVzc2lvbiB1c2luZyBgc2NvcGUuJGV2YWxBc3luY2AgaWYgdGhlIGV2ZW50IGlzIGZpcmVkXG4gKiBkdXJpbmcgYW4gYCRhcHBseWAgdG8gZW5zdXJlIGEgY29uc2lzdGVudCBzdGF0ZS5cbiAqXG4gKiBAZWxlbWVudCB3aW5kb3csIGlucHV0LCBzZWxlY3QsIHRleHRhcmVhLCBhXG4gKiBAcHJpb3JpdHkgMFxuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0ZvY3VzIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWx1YXRlIHVwb25cbiAqIGZvY3VzLiAoe0BsaW5rIGd1aWRlL2V4cHJlc3Npb24jLWV2ZW50LSBFdmVudCBvYmplY3QgaXMgYXZhaWxhYmxlIGFzIGAkZXZlbnRgfSlcbiAqXG4gKiBAZXhhbXBsZVxuICogU2VlIHtAbGluayBuZy5kaXJlY3RpdmU6bmdDbGljayBuZ0NsaWNrfVxuICovXG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdCbHVyXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBTcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciBvbiBibHVyIGV2ZW50LlxuICpcbiAqIEEgW2JsdXIgZXZlbnRdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0V2ZW50cy9ibHVyKSBmaXJlcyB3aGVuXG4gKiBhbiBlbGVtZW50IGhhcyBsb3N0IGZvY3VzLlxuICpcbiAqIE5vdGU6IEFzIHRoZSBgYmx1cmAgZXZlbnQgaXMgZXhlY3V0ZWQgc3luY2hyb25vdXNseSBhbHNvIGR1cmluZyBET00gbWFuaXB1bGF0aW9uc1xuICogKGUuZy4gcmVtb3ZpbmcgYSBmb2N1c3NlZCBpbnB1dCksXG4gKiBBbmd1bGFySlMgZXhlY3V0ZXMgdGhlIGV4cHJlc3Npb24gdXNpbmcgYHNjb3BlLiRldmFsQXN5bmNgIGlmIHRoZSBldmVudCBpcyBmaXJlZFxuICogZHVyaW5nIGFuIGAkYXBwbHlgIHRvIGVuc3VyZSBhIGNvbnNpc3RlbnQgc3RhdGUuXG4gKlxuICogQGVsZW1lbnQgd2luZG93LCBpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSwgYVxuICogQHByaW9yaXR5IDBcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdCbHVyIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWx1YXRlIHVwb25cbiAqIGJsdXIuICh7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiMtZXZlbnQtIEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGB9KVxuICpcbiAqIEBleGFtcGxlXG4gKiBTZWUge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0NsaWNrIG5nQ2xpY2t9XG4gKi9cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ0NvcHlcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIG9uIGNvcHkgZXZlbnQuXG4gKlxuICogQGVsZW1lbnQgd2luZG93LCBpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSwgYVxuICogQHByaW9yaXR5IDBcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdDb3B5IHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWx1YXRlIHVwb25cbiAqIGNvcHkuICh7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiMtZXZlbnQtIEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGB9KVxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZT5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxpbnB1dCBuZy1jb3B5PVwiY29waWVkPXRydWVcIiBuZy1pbml0PVwiY29waWVkPWZhbHNlOyB2YWx1ZT0nY29weSBtZSdcIiBuZy1tb2RlbD1cInZhbHVlXCI+XG4gICAgICBjb3BpZWQ6IHt7Y29waWVkfX1cbiAgICAgPC9maWxlPlxuICAgPC9leGFtcGxlPlxuICovXG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdDdXRcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIG9uIGN1dCBldmVudC5cbiAqXG4gKiBAZWxlbWVudCB3aW5kb3csIGlucHV0LCBzZWxlY3QsIHRleHRhcmVhLCBhXG4gKiBAcHJpb3JpdHkgMFxuICogQHBhcmFtIHtleHByZXNzaW9ufSBuZ0N1dCB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBFeHByZXNzaW9ufSB0byBldmFsdWF0ZSB1cG9uXG4gKiBjdXQuICh7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiMtZXZlbnQtIEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGB9KVxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZT5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxpbnB1dCBuZy1jdXQ9XCJjdXQ9dHJ1ZVwiIG5nLWluaXQ9XCJjdXQ9ZmFsc2U7IHZhbHVlPSdjdXQgbWUnXCIgbmctbW9kZWw9XCJ2YWx1ZVwiPlxuICAgICAgY3V0OiB7e2N1dH19XG4gICAgIDwvZmlsZT5cbiAgIDwvZXhhbXBsZT5cbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nUGFzdGVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIG9uIHBhc3RlIGV2ZW50LlxuICpcbiAqIEBlbGVtZW50IHdpbmRvdywgaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEsIGFcbiAqIEBwcmlvcml0eSAwXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nUGFzdGUge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gRXhwcmVzc2lvbn0gdG8gZXZhbHVhdGUgdXBvblxuICogcGFzdGUuICh7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiMtZXZlbnQtIEV2ZW50IG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGB9KVxuICpcbiAqIEBleGFtcGxlXG4gICA8ZXhhbXBsZT5cbiAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxpbnB1dCBuZy1wYXN0ZT1cInBhc3RlPXRydWVcIiBuZy1pbml0PVwicGFzdGU9ZmFsc2VcIiBwbGFjZWhvbGRlcj0ncGFzdGUgaGVyZSc+XG4gICAgICBwYXN0ZWQ6IHt7cGFzdGV9fVxuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gKi9cblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ0lmXG4gKiBAcmVzdHJpY3QgQVxuICogQG11bHRpRWxlbWVudFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIGBuZ0lmYCBkaXJlY3RpdmUgcmVtb3ZlcyBvciByZWNyZWF0ZXMgYSBwb3J0aW9uIG9mIHRoZSBET00gdHJlZSBiYXNlZCBvbiBhblxuICoge2V4cHJlc3Npb259LiBJZiB0aGUgZXhwcmVzc2lvbiBhc3NpZ25lZCB0byBgbmdJZmAgZXZhbHVhdGVzIHRvIGEgZmFsc2VcbiAqIHZhbHVlIHRoZW4gdGhlIGVsZW1lbnQgaXMgcmVtb3ZlZCBmcm9tIHRoZSBET00sIG90aGVyd2lzZSBhIGNsb25lIG9mIHRoZVxuICogZWxlbWVudCBpcyByZWluc2VydGVkIGludG8gdGhlIERPTS5cbiAqXG4gKiBgbmdJZmAgZGlmZmVycyBmcm9tIGBuZ1Nob3dgIGFuZCBgbmdIaWRlYCBpbiB0aGF0IGBuZ0lmYCBjb21wbGV0ZWx5IHJlbW92ZXMgYW5kIHJlY3JlYXRlcyB0aGVcbiAqIGVsZW1lbnQgaW4gdGhlIERPTSByYXRoZXIgdGhhbiBjaGFuZ2luZyBpdHMgdmlzaWJpbGl0eSB2aWEgdGhlIGBkaXNwbGF5YCBjc3MgcHJvcGVydHkuICBBIGNvbW1vblxuICogY2FzZSB3aGVuIHRoaXMgZGlmZmVyZW5jZSBpcyBzaWduaWZpY2FudCBpcyB3aGVuIHVzaW5nIGNzcyBzZWxlY3RvcnMgdGhhdCByZWx5IG9uIGFuIGVsZW1lbnQnc1xuICogcG9zaXRpb24gd2l0aGluIHRoZSBET00sIHN1Y2ggYXMgdGhlIGA6Zmlyc3QtY2hpbGRgIG9yIGA6bGFzdC1jaGlsZGAgcHNldWRvLWNsYXNzZXMuXG4gKlxuICogTm90ZSB0aGF0IHdoZW4gYW4gZWxlbWVudCBpcyByZW1vdmVkIHVzaW5nIGBuZ0lmYCBpdHMgc2NvcGUgaXMgZGVzdHJveWVkIGFuZCBhIG5ldyBzY29wZVxuICogaXMgY3JlYXRlZCB3aGVuIHRoZSBlbGVtZW50IGlzIHJlc3RvcmVkLiAgVGhlIHNjb3BlIGNyZWF0ZWQgd2l0aGluIGBuZ0lmYCBpbmhlcml0cyBmcm9tXG4gKiBpdHMgcGFyZW50IHNjb3BlIHVzaW5nXG4gKiBbcHJvdG90eXBhbCBpbmhlcml0YW5jZV0oaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy93aWtpL1VuZGVyc3RhbmRpbmctU2NvcGVzI2phdmFzY3JpcHQtcHJvdG90eXBhbC1pbmhlcml0YW5jZSkuXG4gKiBBbiBpbXBvcnRhbnQgaW1wbGljYXRpb24gb2YgdGhpcyBpcyBpZiBgbmdNb2RlbGAgaXMgdXNlZCB3aXRoaW4gYG5nSWZgIHRvIGJpbmQgdG9cbiAqIGEgamF2YXNjcmlwdCBwcmltaXRpdmUgZGVmaW5lZCBpbiB0aGUgcGFyZW50IHNjb3BlLiBJbiB0aGlzIGNhc2UgYW55IG1vZGlmaWNhdGlvbnMgbWFkZSB0byB0aGVcbiAqIHZhcmlhYmxlIHdpdGhpbiB0aGUgY2hpbGQgc2NvcGUgd2lsbCBvdmVycmlkZSAoaGlkZSkgdGhlIHZhbHVlIGluIHRoZSBwYXJlbnQgc2NvcGUuXG4gKlxuICogQWxzbywgYG5nSWZgIHJlY3JlYXRlcyBlbGVtZW50cyB1c2luZyB0aGVpciBjb21waWxlZCBzdGF0ZS4gQW4gZXhhbXBsZSBvZiB0aGlzIGJlaGF2aW9yXG4gKiBpcyBpZiBhbiBlbGVtZW50J3MgY2xhc3MgYXR0cmlidXRlIGlzIGRpcmVjdGx5IG1vZGlmaWVkIGFmdGVyIGl0J3MgY29tcGlsZWQsIHVzaW5nIHNvbWV0aGluZyBsaWtlXG4gKiBqUXVlcnkncyBgLmFkZENsYXNzKClgIG1ldGhvZCwgYW5kIHRoZSBlbGVtZW50IGlzIGxhdGVyIHJlbW92ZWQuIFdoZW4gYG5nSWZgIHJlY3JlYXRlcyB0aGUgZWxlbWVudFxuICogdGhlIGFkZGVkIGNsYXNzIHdpbGwgYmUgbG9zdCBiZWNhdXNlIHRoZSBvcmlnaW5hbCBjb21waWxlZCBzdGF0ZSBpcyB1c2VkIHRvIHJlZ2VuZXJhdGUgdGhlIGVsZW1lbnQuXG4gKlxuICogQWRkaXRpb25hbGx5LCB5b3UgY2FuIHByb3ZpZGUgYW5pbWF0aW9ucyB2aWEgdGhlIGBuZ0FuaW1hdGVgIG1vZHVsZSB0byBhbmltYXRlIHRoZSBgZW50ZXJgXG4gKiBhbmQgYGxlYXZlYCBlZmZlY3RzLlxuICpcbiAqIEBhbmltYXRpb25zXG4gKiBlbnRlciAtIGhhcHBlbnMganVzdCBhZnRlciB0aGUgYG5nSWZgIGNvbnRlbnRzIGNoYW5nZSBhbmQgYSBuZXcgRE9NIGVsZW1lbnQgaXMgY3JlYXRlZCBhbmQgaW5qZWN0ZWQgaW50byB0aGUgYG5nSWZgIGNvbnRhaW5lclxuICogbGVhdmUgLSBoYXBwZW5zIGp1c3QgYmVmb3JlIHRoZSBgbmdJZmAgY29udGVudHMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgRE9NXG4gKlxuICogQGVsZW1lbnQgQU5ZXG4gKiBAc2NvcGVcbiAqIEBwcmlvcml0eSA2MDBcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdJZiBJZiB0aGUge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gZXhwcmVzc2lvbn0gaXMgZmFsc3kgdGhlblxuICogICAgIHRoZSBlbGVtZW50IGlzIHJlbW92ZWQgZnJvbSB0aGUgRE9NIHRyZWUuIElmIGl0IGlzIHRydXRoeSBhIGNvcHkgb2YgdGhlIGNvbXBpbGVkXG4gKiAgICAgZWxlbWVudCBpcyBhZGRlZCB0byB0aGUgRE9NIHRyZWUuXG4gKlxuICogQGV4YW1wbGVcbiAgPGV4YW1wbGUgbW9kdWxlPVwibmdBbmltYXRlXCIgZGVwcz1cImFuZ3VsYXItYW5pbWF0ZS5qc1wiIGFuaW1hdGlvbnM9XCJ0cnVlXCI+XG4gICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxsYWJlbD5DbGljayBtZTogPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiY2hlY2tlZFwiIG5nLWluaXQ9XCJjaGVja2VkPXRydWVcIiAvPjwvbGFiZWw+PGJyLz5cbiAgICAgIFNob3cgd2hlbiBjaGVja2VkOlxuICAgICAgPHNwYW4gbmctaWY9XCJjaGVja2VkXCIgY2xhc3M9XCJhbmltYXRlLWlmXCI+XG4gICAgICAgIFRoaXMgaXMgcmVtb3ZlZCB3aGVuIHRoZSBjaGVja2JveCBpcyB1bmNoZWNrZWQuXG4gICAgICA8L3NwYW4+XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJhbmltYXRpb25zLmNzc1wiPlxuICAgICAgLmFuaW1hdGUtaWYge1xuICAgICAgICBiYWNrZ3JvdW5kOndoaXRlO1xuICAgICAgICBib3JkZXI6MXB4IHNvbGlkIGJsYWNrO1xuICAgICAgICBwYWRkaW5nOjEwcHg7XG4gICAgICB9XG5cbiAgICAgIC5hbmltYXRlLWlmLm5nLWVudGVyLCAuYW5pbWF0ZS1pZi5uZy1sZWF2ZSB7XG4gICAgICAgIHRyYW5zaXRpb246YWxsIGN1YmljLWJlemllcigwLjI1MCwgMC40NjAsIDAuNDUwLCAwLjk0MCkgMC41cztcbiAgICAgIH1cblxuICAgICAgLmFuaW1hdGUtaWYubmctZW50ZXIsXG4gICAgICAuYW5pbWF0ZS1pZi5uZy1sZWF2ZS5uZy1sZWF2ZS1hY3RpdmUge1xuICAgICAgICBvcGFjaXR5OjA7XG4gICAgICB9XG5cbiAgICAgIC5hbmltYXRlLWlmLm5nLWxlYXZlLFxuICAgICAgLmFuaW1hdGUtaWYubmctZW50ZXIubmctZW50ZXItYWN0aXZlIHtcbiAgICAgICAgb3BhY2l0eToxO1xuICAgICAgfVxuICAgIDwvZmlsZT5cbiAgPC9leGFtcGxlPlxuICovXG52YXIgbmdJZkRpcmVjdGl2ZSA9IFsnJGFuaW1hdGUnLCBmdW5jdGlvbigkYW5pbWF0ZSkge1xuICByZXR1cm4ge1xuICAgIG11bHRpRWxlbWVudDogdHJ1ZSxcbiAgICB0cmFuc2NsdWRlOiAnZWxlbWVudCcsXG4gICAgcHJpb3JpdHk6IDYwMCxcbiAgICB0ZXJtaW5hbDogdHJ1ZSxcbiAgICByZXN0cmljdDogJ0EnLFxuICAgICQkdGxiOiB0cnVlLFxuICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRyLCBjdHJsLCAkdHJhbnNjbHVkZSkge1xuICAgICAgICB2YXIgYmxvY2ssIGNoaWxkU2NvcGUsIHByZXZpb3VzRWxlbWVudHM7XG4gICAgICAgICRzY29wZS4kd2F0Y2goJGF0dHIubmdJZiwgZnVuY3Rpb24gbmdJZldhdGNoQWN0aW9uKHZhbHVlKSB7XG5cbiAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICghY2hpbGRTY29wZSkge1xuICAgICAgICAgICAgICAkdHJhbnNjbHVkZShmdW5jdGlvbihjbG9uZSwgbmV3U2NvcGUpIHtcbiAgICAgICAgICAgICAgICBjaGlsZFNjb3BlID0gbmV3U2NvcGU7XG4gICAgICAgICAgICAgICAgY2xvbmVbY2xvbmUubGVuZ3RoKytdID0gZG9jdW1lbnQuY3JlYXRlQ29tbWVudCgnIGVuZCBuZ0lmOiAnICsgJGF0dHIubmdJZiArICcgJyk7XG4gICAgICAgICAgICAgICAgLy8gTm90ZTogV2Ugb25seSBuZWVkIHRoZSBmaXJzdC9sYXN0IG5vZGUgb2YgdGhlIGNsb25lZCBub2Rlcy5cbiAgICAgICAgICAgICAgICAvLyBIb3dldmVyLCB3ZSBuZWVkIHRvIGtlZXAgdGhlIHJlZmVyZW5jZSB0byB0aGUganFsaXRlIHdyYXBwZXIgYXMgaXQgbWlnaHQgYmUgY2hhbmdlZCBsYXRlclxuICAgICAgICAgICAgICAgIC8vIGJ5IGEgZGlyZWN0aXZlIHdpdGggdGVtcGxhdGVVcmwgd2hlbiBpdHMgdGVtcGxhdGUgYXJyaXZlcy5cbiAgICAgICAgICAgICAgICBibG9jayA9IHtcbiAgICAgICAgICAgICAgICAgIGNsb25lOiBjbG9uZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJGFuaW1hdGUuZW50ZXIoY2xvbmUsICRlbGVtZW50LnBhcmVudCgpLCAkZWxlbWVudCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAocHJldmlvdXNFbGVtZW50cykge1xuICAgICAgICAgICAgICBwcmV2aW91c0VsZW1lbnRzLnJlbW92ZSgpO1xuICAgICAgICAgICAgICBwcmV2aW91c0VsZW1lbnRzID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjaGlsZFNjb3BlKSB7XG4gICAgICAgICAgICAgIGNoaWxkU2NvcGUuJGRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgY2hpbGRTY29wZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYmxvY2spIHtcbiAgICAgICAgICAgICAgcHJldmlvdXNFbGVtZW50cyA9IGdldEJsb2NrTm9kZXMoYmxvY2suY2xvbmUpO1xuICAgICAgICAgICAgICAkYW5pbWF0ZS5sZWF2ZShwcmV2aW91c0VsZW1lbnRzKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzRWxlbWVudHMgPSBudWxsO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgYmxvY2sgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICB9O1xufV07XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdJbmNsdWRlXG4gKiBAcmVzdHJpY3QgRUNBXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBGZXRjaGVzLCBjb21waWxlcyBhbmQgaW5jbHVkZXMgYW4gZXh0ZXJuYWwgSFRNTCBmcmFnbWVudC5cbiAqXG4gKiBCeSBkZWZhdWx0LCB0aGUgdGVtcGxhdGUgVVJMIGlzIHJlc3RyaWN0ZWQgdG8gdGhlIHNhbWUgZG9tYWluIGFuZCBwcm90b2NvbCBhcyB0aGVcbiAqIGFwcGxpY2F0aW9uIGRvY3VtZW50LiBUaGlzIGlzIGRvbmUgYnkgY2FsbGluZyB7QGxpbmsgJHNjZSNnZXRUcnVzdGVkUmVzb3VyY2VVcmxcbiAqICRzY2UuZ2V0VHJ1c3RlZFJlc291cmNlVXJsfSBvbiBpdC4gVG8gbG9hZCB0ZW1wbGF0ZXMgZnJvbSBvdGhlciBkb21haW5zIG9yIHByb3RvY29sc1xuICogeW91IG1heSBlaXRoZXIge0BsaW5rIG5nLiRzY2VEZWxlZ2F0ZVByb3ZpZGVyI3Jlc291cmNlVXJsV2hpdGVsaXN0IHdoaXRlbGlzdCB0aGVtfSBvclxuICoge0BsaW5rICRzY2UjdHJ1c3RBc1Jlc291cmNlVXJsIHdyYXAgdGhlbX0gYXMgdHJ1c3RlZCB2YWx1ZXMuIFJlZmVyIHRvIEFuZ3VsYXIncyB7QGxpbmtcbiAqIG5nLiRzY2UgU3RyaWN0IENvbnRleHR1YWwgRXNjYXBpbmd9LlxuICpcbiAqIEluIGFkZGl0aW9uLCB0aGUgYnJvd3NlcidzXG4gKiBbU2FtZSBPcmlnaW4gUG9saWN5XShodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Jyb3dzZXJzZWMvd2lraS9QYXJ0MiNTYW1lLW9yaWdpbl9wb2xpY3lfZm9yX1hNTEh0dHBSZXF1ZXN0KVxuICogYW5kIFtDcm9zcy1PcmlnaW4gUmVzb3VyY2UgU2hhcmluZyAoQ09SUyldKGh0dHA6Ly93d3cudzMub3JnL1RSL2NvcnMvKVxuICogcG9saWN5IG1heSBmdXJ0aGVyIHJlc3RyaWN0IHdoZXRoZXIgdGhlIHRlbXBsYXRlIGlzIHN1Y2Nlc3NmdWxseSBsb2FkZWQuXG4gKiBGb3IgZXhhbXBsZSwgYG5nSW5jbHVkZWAgd29uJ3Qgd29yayBmb3IgY3Jvc3MtZG9tYWluIHJlcXVlc3RzIG9uIGFsbCBicm93c2VycyBhbmQgZm9yIGBmaWxlOi8vYFxuICogYWNjZXNzIG9uIHNvbWUgYnJvd3NlcnMuXG4gKlxuICogQGFuaW1hdGlvbnNcbiAqIGVudGVyIC0gYW5pbWF0aW9uIGlzIHVzZWQgdG8gYnJpbmcgbmV3IGNvbnRlbnQgaW50byB0aGUgYnJvd3Nlci5cbiAqIGxlYXZlIC0gYW5pbWF0aW9uIGlzIHVzZWQgdG8gYW5pbWF0ZSBleGlzdGluZyBjb250ZW50IGF3YXkuXG4gKlxuICogVGhlIGVudGVyIGFuZCBsZWF2ZSBhbmltYXRpb24gb2NjdXIgY29uY3VycmVudGx5LlxuICpcbiAqIEBzY29wZVxuICogQHByaW9yaXR5IDQwMFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBuZ0luY2x1ZGV8c3JjIGFuZ3VsYXIgZXhwcmVzc2lvbiBldmFsdWF0aW5nIHRvIFVSTC4gSWYgdGhlIHNvdXJjZSBpcyBhIHN0cmluZyBjb25zdGFudCxcbiAqICAgICAgICAgICAgICAgICBtYWtlIHN1cmUgeW91IHdyYXAgaXQgaW4gKipzaW5nbGUqKiBxdW90ZXMsIGUuZy4gYHNyYz1cIidteVBhcnRpYWxUZW1wbGF0ZS5odG1sJ1wiYC5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gb25sb2FkIEV4cHJlc3Npb24gdG8gZXZhbHVhdGUgd2hlbiBhIG5ldyBwYXJ0aWFsIGlzIGxvYWRlZC5cbiAqICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cbiAqICAgICAgICAgICAgICAgICAgKipOb3RlOioqIFdoZW4gdXNpbmcgb25sb2FkIG9uIFNWRyBlbGVtZW50cyBpbiBJRTExLCB0aGUgYnJvd3NlciB3aWxsIHRyeSB0byBjYWxsXG4gKiAgICAgICAgICAgICAgICAgIGEgZnVuY3Rpb24gd2l0aCB0aGUgbmFtZSBvbiB0aGUgd2luZG93IGVsZW1lbnQsIHdoaWNoIHdpbGwgdXN1YWxseSB0aHJvdyBhXG4gKiAgICAgICAgICAgICAgICAgIFwiZnVuY3Rpb24gaXMgdW5kZWZpbmVkXCIgZXJyb3IuIFRvIGZpeCB0aGlzLCB5b3UgY2FuIGluc3RlYWQgdXNlIGBkYXRhLW9ubG9hZGAgb3IgYVxuICogICAgICAgICAgICAgICAgICBkaWZmZXJlbnQgZm9ybSB0aGF0IHtAbGluayBndWlkZS9kaXJlY3RpdmUjbm9ybWFsaXphdGlvbiBtYXRjaGVzfSBgb25sb2FkYC5cbiAqICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAqXG4gKiBAcGFyYW0ge3N0cmluZz19IGF1dG9zY3JvbGwgV2hldGhlciBgbmdJbmNsdWRlYCBzaG91bGQgY2FsbCB7QGxpbmsgbmcuJGFuY2hvclNjcm9sbFxuICogICAgICAgICAgICAgICAgICAkYW5jaG9yU2Nyb2xsfSB0byBzY3JvbGwgdGhlIHZpZXdwb3J0IGFmdGVyIHRoZSBjb250ZW50IGlzIGxvYWRlZC5cbiAqXG4gKiAgICAgICAgICAgICAgICAgIC0gSWYgdGhlIGF0dHJpYnV0ZSBpcyBub3Qgc2V0LCBkaXNhYmxlIHNjcm9sbGluZy5cbiAqICAgICAgICAgICAgICAgICAgLSBJZiB0aGUgYXR0cmlidXRlIGlzIHNldCB3aXRob3V0IHZhbHVlLCBlbmFibGUgc2Nyb2xsaW5nLlxuICogICAgICAgICAgICAgICAgICAtIE90aGVyd2lzZSBlbmFibGUgc2Nyb2xsaW5nIG9ubHkgaWYgdGhlIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIHRydXRoeSB2YWx1ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICA8ZXhhbXBsZSBtb2R1bGU9XCJpbmNsdWRlRXhhbXBsZVwiIGRlcHM9XCJhbmd1bGFyLWFuaW1hdGUuanNcIiBhbmltYXRpb25zPVwidHJ1ZVwiPlxuICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gICAgICAgPHNlbGVjdCBuZy1tb2RlbD1cInRlbXBsYXRlXCIgbmctb3B0aW9ucz1cInQubmFtZSBmb3IgdCBpbiB0ZW1wbGF0ZXNcIj5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlwiPihibGFuayk8L29wdGlvbj5cbiAgICAgICA8L3NlbGVjdD5cbiAgICAgICB1cmwgb2YgdGhlIHRlbXBsYXRlOiA8Y29kZT57e3RlbXBsYXRlLnVybH19PC9jb2RlPlxuICAgICAgIDxoci8+XG4gICAgICAgPGRpdiBjbGFzcz1cInNsaWRlLWFuaW1hdGUtY29udGFpbmVyXCI+XG4gICAgICAgICA8ZGl2IGNsYXNzPVwic2xpZGUtYW5pbWF0ZVwiIG5nLWluY2x1ZGU9XCJ0ZW1wbGF0ZS51cmxcIj48L2Rpdj5cbiAgICAgICA8L2Rpdj5cbiAgICAgPC9kaXY+XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJzY3JpcHQuanNcIj5cbiAgICAgIGFuZ3VsYXIubW9kdWxlKCdpbmNsdWRlRXhhbXBsZScsIFsnbmdBbmltYXRlJ10pXG4gICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLnRlbXBsYXRlcyA9XG4gICAgICAgICAgICBbIHsgbmFtZTogJ3RlbXBsYXRlMS5odG1sJywgdXJsOiAndGVtcGxhdGUxLmh0bWwnfSxcbiAgICAgICAgICAgICAgeyBuYW1lOiAndGVtcGxhdGUyLmh0bWwnLCB1cmw6ICd0ZW1wbGF0ZTIuaHRtbCd9IF07XG4gICAgICAgICAgJHNjb3BlLnRlbXBsYXRlID0gJHNjb3BlLnRlbXBsYXRlc1swXTtcbiAgICAgICAgfV0pO1xuICAgICA8L2ZpbGU+XG4gICAgPGZpbGUgbmFtZT1cInRlbXBsYXRlMS5odG1sXCI+XG4gICAgICBDb250ZW50IG9mIHRlbXBsYXRlMS5odG1sXG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJ0ZW1wbGF0ZTIuaHRtbFwiPlxuICAgICAgQ29udGVudCBvZiB0ZW1wbGF0ZTIuaHRtbFxuICAgIDwvZmlsZT5cbiAgICA8ZmlsZSBuYW1lPVwiYW5pbWF0aW9ucy5jc3NcIj5cbiAgICAgIC5zbGlkZS1hbmltYXRlLWNvbnRhaW5lciB7XG4gICAgICAgIHBvc2l0aW9uOnJlbGF0aXZlO1xuICAgICAgICBiYWNrZ3JvdW5kOndoaXRlO1xuICAgICAgICBib3JkZXI6MXB4IHNvbGlkIGJsYWNrO1xuICAgICAgICBoZWlnaHQ6NDBweDtcbiAgICAgICAgb3ZlcmZsb3c6aGlkZGVuO1xuICAgICAgfVxuXG4gICAgICAuc2xpZGUtYW5pbWF0ZSB7XG4gICAgICAgIHBhZGRpbmc6MTBweDtcbiAgICAgIH1cblxuICAgICAgLnNsaWRlLWFuaW1hdGUubmctZW50ZXIsIC5zbGlkZS1hbmltYXRlLm5nLWxlYXZlIHtcbiAgICAgICAgdHJhbnNpdGlvbjphbGwgY3ViaWMtYmV6aWVyKDAuMjUwLCAwLjQ2MCwgMC40NTAsIDAuOTQwKSAwLjVzO1xuXG4gICAgICAgIHBvc2l0aW9uOmFic29sdXRlO1xuICAgICAgICB0b3A6MDtcbiAgICAgICAgbGVmdDowO1xuICAgICAgICByaWdodDowO1xuICAgICAgICBib3R0b206MDtcbiAgICAgICAgZGlzcGxheTpibG9jaztcbiAgICAgICAgcGFkZGluZzoxMHB4O1xuICAgICAgfVxuXG4gICAgICAuc2xpZGUtYW5pbWF0ZS5uZy1lbnRlciB7XG4gICAgICAgIHRvcDotNTBweDtcbiAgICAgIH1cbiAgICAgIC5zbGlkZS1hbmltYXRlLm5nLWVudGVyLm5nLWVudGVyLWFjdGl2ZSB7XG4gICAgICAgIHRvcDowO1xuICAgICAgfVxuXG4gICAgICAuc2xpZGUtYW5pbWF0ZS5uZy1sZWF2ZSB7XG4gICAgICAgIHRvcDowO1xuICAgICAgfVxuICAgICAgLnNsaWRlLWFuaW1hdGUubmctbGVhdmUubmctbGVhdmUtYWN0aXZlIHtcbiAgICAgICAgdG9wOjUwcHg7XG4gICAgICB9XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgIHZhciB0ZW1wbGF0ZVNlbGVjdCA9IGVsZW1lbnQoYnkubW9kZWwoJ3RlbXBsYXRlJykpO1xuICAgICAgdmFyIGluY2x1ZGVFbGVtID0gZWxlbWVudChieS5jc3MoJ1tuZy1pbmNsdWRlXScpKTtcblxuICAgICAgaXQoJ3Nob3VsZCBsb2FkIHRlbXBsYXRlMS5odG1sJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGV4cGVjdChpbmNsdWRlRWxlbS5nZXRUZXh0KCkpLnRvTWF0Y2goL0NvbnRlbnQgb2YgdGVtcGxhdGUxLmh0bWwvKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGxvYWQgdGVtcGxhdGUyLmh0bWwnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGJyb3dzZXIucGFyYW1zLmJyb3dzZXIgPT0gJ2ZpcmVmb3gnKSB7XG4gICAgICAgICAgLy8gRmlyZWZveCBjYW4ndCBoYW5kbGUgdXNpbmcgc2VsZWN0c1xuICAgICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9wcm90cmFjdG9yL2lzc3Vlcy80ODBcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGVtcGxhdGVTZWxlY3QuY2xpY2soKTtcbiAgICAgICAgdGVtcGxhdGVTZWxlY3QuYWxsKGJ5LmNzcygnb3B0aW9uJykpLmdldCgyKS5jbGljaygpO1xuICAgICAgICBleHBlY3QoaW5jbHVkZUVsZW0uZ2V0VGV4dCgpKS50b01hdGNoKC9Db250ZW50IG9mIHRlbXBsYXRlMi5odG1sLyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBjaGFuZ2UgdG8gYmxhbmsnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGJyb3dzZXIucGFyYW1zLmJyb3dzZXIgPT0gJ2ZpcmVmb3gnKSB7XG4gICAgICAgICAgLy8gRmlyZWZveCBjYW4ndCBoYW5kbGUgdXNpbmcgc2VsZWN0c1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0ZW1wbGF0ZVNlbGVjdC5jbGljaygpO1xuICAgICAgICB0ZW1wbGF0ZVNlbGVjdC5hbGwoYnkuY3NzKCdvcHRpb24nKSkuZ2V0KDApLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChpbmNsdWRlRWxlbS5pc1ByZXNlbnQoKSkudG9CZShmYWxzZSk7XG4gICAgICB9KTtcbiAgICA8L2ZpbGU+XG4gIDwvZXhhbXBsZT5cbiAqL1xuXG5cbi8qKlxuICogQG5nZG9jIGV2ZW50XG4gKiBAbmFtZSBuZ0luY2x1ZGUjJGluY2x1ZGVDb250ZW50UmVxdWVzdGVkXG4gKiBAZXZlbnRUeXBlIGVtaXQgb24gdGhlIHNjb3BlIG5nSW5jbHVkZSB3YXMgZGVjbGFyZWQgaW5cbiAqIEBkZXNjcmlwdGlvblxuICogRW1pdHRlZCBldmVyeSB0aW1lIHRoZSBuZ0luY2x1ZGUgY29udGVudCBpcyByZXF1ZXN0ZWQuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGFuZ3VsYXJFdmVudCBTeW50aGV0aWMgZXZlbnQgb2JqZWN0LlxuICogQHBhcmFtIHtTdHJpbmd9IHNyYyBVUkwgb2YgY29udGVudCB0byBsb2FkLlxuICovXG5cblxuLyoqXG4gKiBAbmdkb2MgZXZlbnRcbiAqIEBuYW1lIG5nSW5jbHVkZSMkaW5jbHVkZUNvbnRlbnRMb2FkZWRcbiAqIEBldmVudFR5cGUgZW1pdCBvbiB0aGUgY3VycmVudCBuZ0luY2x1ZGUgc2NvcGVcbiAqIEBkZXNjcmlwdGlvblxuICogRW1pdHRlZCBldmVyeSB0aW1lIHRoZSBuZ0luY2x1ZGUgY29udGVudCBpcyByZWxvYWRlZC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gYW5ndWxhckV2ZW50IFN5bnRoZXRpYyBldmVudCBvYmplY3QuXG4gKiBAcGFyYW0ge1N0cmluZ30gc3JjIFVSTCBvZiBjb250ZW50IHRvIGxvYWQuXG4gKi9cblxuXG4vKipcbiAqIEBuZ2RvYyBldmVudFxuICogQG5hbWUgbmdJbmNsdWRlIyRpbmNsdWRlQ29udGVudEVycm9yXG4gKiBAZXZlbnRUeXBlIGVtaXQgb24gdGhlIHNjb3BlIG5nSW5jbHVkZSB3YXMgZGVjbGFyZWQgaW5cbiAqIEBkZXNjcmlwdGlvblxuICogRW1pdHRlZCB3aGVuIGEgdGVtcGxhdGUgSFRUUCByZXF1ZXN0IHlpZWxkcyBhbiBlcnJvbmVvdXMgcmVzcG9uc2UgKHN0YXR1cyA8IDIwMCB8fCBzdGF0dXMgPiAyOTkpXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGFuZ3VsYXJFdmVudCBTeW50aGV0aWMgZXZlbnQgb2JqZWN0LlxuICogQHBhcmFtIHtTdHJpbmd9IHNyYyBVUkwgb2YgY29udGVudCB0byBsb2FkLlxuICovXG52YXIgbmdJbmNsdWRlRGlyZWN0aXZlID0gWyckdGVtcGxhdGVSZXF1ZXN0JywgJyRhbmNob3JTY3JvbGwnLCAnJGFuaW1hdGUnLFxuICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oJHRlbXBsYXRlUmVxdWVzdCwgICAkYW5jaG9yU2Nyb2xsLCAgICRhbmltYXRlKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFQ0EnLFxuICAgIHByaW9yaXR5OiA0MDAsXG4gICAgdGVybWluYWw6IHRydWUsXG4gICAgdHJhbnNjbHVkZTogJ2VsZW1lbnQnLFxuICAgIGNvbnRyb2xsZXI6IGFuZ3VsYXIubm9vcCxcbiAgICBjb21waWxlOiBmdW5jdGlvbihlbGVtZW50LCBhdHRyKSB7XG4gICAgICB2YXIgc3JjRXhwID0gYXR0ci5uZ0luY2x1ZGUgfHwgYXR0ci5zcmMsXG4gICAgICAgICAgb25sb2FkRXhwID0gYXR0ci5vbmxvYWQgfHwgJycsXG4gICAgICAgICAgYXV0b1Njcm9sbEV4cCA9IGF0dHIuYXV0b3Njcm9sbDtcblxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCAkZWxlbWVudCwgJGF0dHIsIGN0cmwsICR0cmFuc2NsdWRlKSB7XG4gICAgICAgIHZhciBjaGFuZ2VDb3VudGVyID0gMCxcbiAgICAgICAgICAgIGN1cnJlbnRTY29wZSxcbiAgICAgICAgICAgIHByZXZpb3VzRWxlbWVudCxcbiAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50O1xuXG4gICAgICAgIHZhciBjbGVhbnVwTGFzdEluY2x1ZGVDb250ZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHByZXZpb3VzRWxlbWVudCkge1xuICAgICAgICAgICAgcHJldmlvdXNFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgICAgICAgcHJldmlvdXNFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGN1cnJlbnRTY29wZSkge1xuICAgICAgICAgICAgY3VycmVudFNjb3BlLiRkZXN0cm95KCk7XG4gICAgICAgICAgICBjdXJyZW50U2NvcGUgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY3VycmVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgICRhbmltYXRlLmxlYXZlKGN1cnJlbnRFbGVtZW50KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBwcmV2aW91c0VsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwcmV2aW91c0VsZW1lbnQgPSBjdXJyZW50RWxlbWVudDtcbiAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2NvcGUuJHdhdGNoKHNyY0V4cCwgZnVuY3Rpb24gbmdJbmNsdWRlV2F0Y2hBY3Rpb24oc3JjKSB7XG4gICAgICAgICAgdmFyIGFmdGVyQW5pbWF0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoaXNEZWZpbmVkKGF1dG9TY3JvbGxFeHApICYmICghYXV0b1Njcm9sbEV4cCB8fCBzY29wZS4kZXZhbChhdXRvU2Nyb2xsRXhwKSkpIHtcbiAgICAgICAgICAgICAgJGFuY2hvclNjcm9sbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgICAgdmFyIHRoaXNDaGFuZ2VJZCA9ICsrY2hhbmdlQ291bnRlcjtcblxuICAgICAgICAgIGlmIChzcmMpIHtcbiAgICAgICAgICAgIC8vc2V0IHRoZSAybmQgcGFyYW0gdG8gdHJ1ZSB0byBpZ25vcmUgdGhlIHRlbXBsYXRlIHJlcXVlc3QgZXJyb3Igc28gdGhhdCB0aGUgaW5uZXJcbiAgICAgICAgICAgIC8vY29udGVudHMgYW5kIHNjb3BlIGNhbiBiZSBjbGVhbmVkIHVwLlxuICAgICAgICAgICAgJHRlbXBsYXRlUmVxdWVzdChzcmMsIHRydWUpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgaWYgKHNjb3BlLiQkZGVzdHJveWVkKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgaWYgKHRoaXNDaGFuZ2VJZCAhPT0gY2hhbmdlQ291bnRlcikgcmV0dXJuO1xuICAgICAgICAgICAgICB2YXIgbmV3U2NvcGUgPSBzY29wZS4kbmV3KCk7XG4gICAgICAgICAgICAgIGN0cmwudGVtcGxhdGUgPSByZXNwb25zZTtcblxuICAgICAgICAgICAgICAvLyBOb3RlOiBUaGlzIHdpbGwgYWxzbyBsaW5rIGFsbCBjaGlsZHJlbiBvZiBuZy1pbmNsdWRlIHRoYXQgd2VyZSBjb250YWluZWQgaW4gdGhlIG9yaWdpbmFsXG4gICAgICAgICAgICAgIC8vIGh0bWwuIElmIHRoYXQgY29udGVudCBjb250YWlucyBjb250cm9sbGVycywgLi4uIHRoZXkgY291bGQgcG9sbHV0ZS9jaGFuZ2UgdGhlIHNjb3BlLlxuICAgICAgICAgICAgICAvLyBIb3dldmVyLCB1c2luZyBuZy1pbmNsdWRlIG9uIGFuIGVsZW1lbnQgd2l0aCBhZGRpdGlvbmFsIGNvbnRlbnQgZG9lcyBub3QgbWFrZSBzZW5zZS4uLlxuICAgICAgICAgICAgICAvLyBOb3RlOiBXZSBjYW4ndCByZW1vdmUgdGhlbSBpbiB0aGUgY2xvbmVBdHRjaEZuIG9mICR0cmFuc2NsdWRlIGFzIHRoYXRcbiAgICAgICAgICAgICAgLy8gZnVuY3Rpb24gaXMgY2FsbGVkIGJlZm9yZSBsaW5raW5nIHRoZSBjb250ZW50LCB3aGljaCB3b3VsZCBhcHBseSBjaGlsZFxuICAgICAgICAgICAgICAvLyBkaXJlY3RpdmVzIHRvIG5vbiBleGlzdGluZyBlbGVtZW50cy5cbiAgICAgICAgICAgICAgdmFyIGNsb25lID0gJHRyYW5zY2x1ZGUobmV3U2NvcGUsIGZ1bmN0aW9uKGNsb25lKSB7XG4gICAgICAgICAgICAgICAgY2xlYW51cExhc3RJbmNsdWRlQ29udGVudCgpO1xuICAgICAgICAgICAgICAgICRhbmltYXRlLmVudGVyKGNsb25lLCBudWxsLCAkZWxlbWVudCkudGhlbihhZnRlckFuaW1hdGlvbik7XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIGN1cnJlbnRTY29wZSA9IG5ld1Njb3BlO1xuICAgICAgICAgICAgICBjdXJyZW50RWxlbWVudCA9IGNsb25lO1xuXG4gICAgICAgICAgICAgIGN1cnJlbnRTY29wZS4kZW1pdCgnJGluY2x1ZGVDb250ZW50TG9hZGVkJywgc3JjKTtcbiAgICAgICAgICAgICAgc2NvcGUuJGV2YWwob25sb2FkRXhwKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBpZiAoc2NvcGUuJCRkZXN0cm95ZWQpIHJldHVybjtcblxuICAgICAgICAgICAgICBpZiAodGhpc0NoYW5nZUlkID09PSBjaGFuZ2VDb3VudGVyKSB7XG4gICAgICAgICAgICAgICAgY2xlYW51cExhc3RJbmNsdWRlQ29udGVudCgpO1xuICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCckaW5jbHVkZUNvbnRlbnRFcnJvcicsIHNyYyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJyRpbmNsdWRlQ29udGVudFJlcXVlc3RlZCcsIHNyYyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNsZWFudXBMYXN0SW5jbHVkZUNvbnRlbnQoKTtcbiAgICAgICAgICAgIGN0cmwudGVtcGxhdGUgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn1dO1xuXG4vLyBUaGlzIGRpcmVjdGl2ZSBpcyBjYWxsZWQgZHVyaW5nIHRoZSAkdHJhbnNjbHVkZSBjYWxsIG9mIHRoZSBmaXJzdCBgbmdJbmNsdWRlYCBkaXJlY3RpdmUuXG4vLyBJdCB3aWxsIHJlcGxhY2UgYW5kIGNvbXBpbGUgdGhlIGNvbnRlbnQgb2YgdGhlIGVsZW1lbnQgd2l0aCB0aGUgbG9hZGVkIHRlbXBsYXRlLlxuLy8gV2UgbmVlZCB0aGlzIGRpcmVjdGl2ZSBzbyB0aGF0IHRoZSBlbGVtZW50IGNvbnRlbnQgaXMgYWxyZWFkeSBmaWxsZWQgd2hlblxuLy8gdGhlIGxpbmsgZnVuY3Rpb24gb2YgYW5vdGhlciBkaXJlY3RpdmUgb24gdGhlIHNhbWUgZWxlbWVudCBhcyBuZ0luY2x1ZGVcbi8vIGlzIGNhbGxlZC5cbnZhciBuZ0luY2x1ZGVGaWxsQ29udGVudERpcmVjdGl2ZSA9IFsnJGNvbXBpbGUnLFxuICBmdW5jdGlvbigkY29tcGlsZSkge1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0VDQScsXG4gICAgICBwcmlvcml0eTogLTQwMCxcbiAgICAgIHJlcXVpcmU6ICduZ0luY2x1ZGUnLFxuICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsICRlbGVtZW50LCAkYXR0ciwgY3RybCkge1xuICAgICAgICBpZiAodG9TdHJpbmcuY2FsbCgkZWxlbWVudFswXSkubWF0Y2goL1NWRy8pKSB7XG4gICAgICAgICAgLy8gV2ViS2l0OiBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTM1Njk4IC0tLSBTVkcgZWxlbWVudHMgZG8gbm90XG4gICAgICAgICAgLy8gc3VwcG9ydCBpbm5lckhUTUwsIHNvIGRldGVjdCB0aGlzIGhlcmUgYW5kIHRyeSB0byBnZW5lcmF0ZSB0aGUgY29udGVudHNcbiAgICAgICAgICAvLyBzcGVjaWFsbHkuXG4gICAgICAgICAgJGVsZW1lbnQuZW1wdHkoKTtcbiAgICAgICAgICAkY29tcGlsZShqcUxpdGVCdWlsZEZyYWdtZW50KGN0cmwudGVtcGxhdGUsIGRvY3VtZW50KS5jaGlsZE5vZGVzKShzY29wZSxcbiAgICAgICAgICAgICAgZnVuY3Rpb24gbmFtZXNwYWNlQWRhcHRlZENsb25lKGNsb25lKSB7XG4gICAgICAgICAgICAkZWxlbWVudC5hcHBlbmQoY2xvbmUpO1xuICAgICAgICAgIH0sIHtmdXR1cmVQYXJlbnRFbGVtZW50OiAkZWxlbWVudH0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgICRlbGVtZW50Lmh0bWwoY3RybC50ZW1wbGF0ZSk7XG4gICAgICAgICRjb21waWxlKCRlbGVtZW50LmNvbnRlbnRzKCkpKHNjb3BlKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ0luaXRcbiAqIEByZXN0cmljdCBBQ1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIGBuZ0luaXRgIGRpcmVjdGl2ZSBhbGxvd3MgeW91IHRvIGV2YWx1YXRlIGFuIGV4cHJlc3Npb24gaW4gdGhlXG4gKiBjdXJyZW50IHNjb3BlLlxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1kYW5nZXJcIj5cbiAqIFRoaXMgZGlyZWN0aXZlIGNhbiBiZSBhYnVzZWQgdG8gYWRkIHVubmVjZXNzYXJ5IGFtb3VudHMgb2YgbG9naWMgaW50byB5b3VyIHRlbXBsYXRlcy5cbiAqIFRoZXJlIGFyZSBvbmx5IGEgZmV3IGFwcHJvcHJpYXRlIHVzZXMgb2YgYG5nSW5pdGAsIHN1Y2ggYXMgZm9yIGFsaWFzaW5nIHNwZWNpYWwgcHJvcGVydGllcyBvZlxuICoge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ1JlcGVhdCBgbmdSZXBlYXRgfSwgYXMgc2VlbiBpbiB0aGUgZGVtbyBiZWxvdzsgYW5kIGZvciBpbmplY3RpbmcgZGF0YSB2aWFcbiAqIHNlcnZlciBzaWRlIHNjcmlwdGluZy4gQmVzaWRlcyB0aGVzZSBmZXcgY2FzZXMsIHlvdSBzaG91bGQgdXNlIHtAbGluayBndWlkZS9jb250cm9sbGVyIGNvbnRyb2xsZXJzfVxuICogcmF0aGVyIHRoYW4gYG5nSW5pdGAgdG8gaW5pdGlhbGl6ZSB2YWx1ZXMgb24gYSBzY29wZS5cbiAqIDwvZGl2PlxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCI+XG4gKiAqKk5vdGUqKjogSWYgeW91IGhhdmUgYXNzaWdubWVudCBpbiBgbmdJbml0YCBhbG9uZyB3aXRoIGEge0BsaW5rIG5nLiRmaWx0ZXIgYGZpbHRlcmB9LCBtYWtlXG4gKiBzdXJlIHlvdSBoYXZlIHBhcmVudGhlc2VzIHRvIGVuc3VyZSBjb3JyZWN0IG9wZXJhdG9yIHByZWNlZGVuY2U6XG4gKiA8cHJlIGNsYXNzPVwicHJldHR5cHJpbnRcIj5cbiAqIGA8ZGl2IG5nLWluaXQ9XCJ0ZXN0MSA9ICgkaW5kZXggfCB0b1N0cmluZylcIj48L2Rpdj5gXG4gKiA8L3ByZT5cbiAqIDwvZGl2PlxuICpcbiAqIEBwcmlvcml0eSA0NTBcbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdJbml0IHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHRvIGV2YWwuXG4gKlxuICogQGV4YW1wbGVcbiAgIDxleGFtcGxlIG1vZHVsZT1cImluaXRFeGFtcGxlXCI+XG4gICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICA8c2NyaXB0PlxuICAgICBhbmd1bGFyLm1vZHVsZSgnaW5pdEV4YW1wbGUnLCBbXSlcbiAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgJHNjb3BlLmxpc3QgPSBbWydhJywgJ2InXSwgWydjJywgJ2QnXV07XG4gICAgICAgfV0pO1xuICAgPC9zY3JpcHQ+XG4gICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICA8ZGl2IG5nLXJlcGVhdD1cImlubmVyTGlzdCBpbiBsaXN0XCIgbmctaW5pdD1cIm91dGVySW5kZXggPSAkaW5kZXhcIj5cbiAgICAgICA8ZGl2IG5nLXJlcGVhdD1cInZhbHVlIGluIGlubmVyTGlzdFwiIG5nLWluaXQ9XCJpbm5lckluZGV4ID0gJGluZGV4XCI+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJleGFtcGxlLWluaXRcIj5saXN0WyB7e291dGVySW5kZXh9fSBdWyB7e2lubmVySW5kZXh9fSBdID0ge3t2YWx1ZX19Ozwvc3Bhbj5cbiAgICAgICA8L2Rpdj5cbiAgICAgPC9kaXY+XG4gICA8L2Rpdj5cbiAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgaXQoJ3Nob3VsZCBhbGlhcyBpbmRleCBwb3NpdGlvbnMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgIHZhciBlbGVtZW50cyA9IGVsZW1lbnQuYWxsKGJ5LmNzcygnLmV4YW1wbGUtaW5pdCcpKTtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50cy5nZXQoMCkuZ2V0VGV4dCgpKS50b0JlKCdsaXN0WyAwIF1bIDAgXSA9IGE7Jyk7XG4gICAgICAgICBleHBlY3QoZWxlbWVudHMuZ2V0KDEpLmdldFRleHQoKSkudG9CZSgnbGlzdFsgMCBdWyAxIF0gPSBiOycpO1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnRzLmdldCgyKS5nZXRUZXh0KCkpLnRvQmUoJ2xpc3RbIDEgXVsgMCBdID0gYzsnKTtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50cy5nZXQoMykuZ2V0VGV4dCgpKS50b0JlKCdsaXN0WyAxIF1bIDEgXSA9IGQ7Jyk7XG4gICAgICAgfSk7XG4gICAgIDwvZmlsZT5cbiAgIDwvZXhhbXBsZT5cbiAqL1xudmFyIG5nSW5pdERpcmVjdGl2ZSA9IG5nRGlyZWN0aXZlKHtcbiAgcHJpb3JpdHk6IDQ1MCxcbiAgY29tcGlsZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHByZTogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgIHNjb3BlLiRldmFsKGF0dHJzLm5nSW5pdCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxufSk7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdMaXN0XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUZXh0IGlucHV0IHRoYXQgY29udmVydHMgYmV0d2VlbiBhIGRlbGltaXRlZCBzdHJpbmcgYW5kIGFuIGFycmF5IG9mIHN0cmluZ3MuIFRoZSBkZWZhdWx0XG4gKiBkZWxpbWl0ZXIgaXMgYSBjb21tYSBmb2xsb3dlZCBieSBhIHNwYWNlIC0gZXF1aXZhbGVudCB0byBgbmctbGlzdD1cIiwgXCJgLiBZb3UgY2FuIHNwZWNpZnkgYSBjdXN0b21cbiAqIGRlbGltaXRlciBhcyB0aGUgdmFsdWUgb2YgdGhlIGBuZ0xpc3RgIGF0dHJpYnV0ZSAtIGZvciBleGFtcGxlLCBgbmctbGlzdD1cIiB8IFwiYC5cbiAqXG4gKiBUaGUgYmVoYXZpb3VyIG9mIHRoZSBkaXJlY3RpdmUgaXMgYWZmZWN0ZWQgYnkgdGhlIHVzZSBvZiB0aGUgYG5nVHJpbWAgYXR0cmlidXRlLlxuICogKiBJZiBgbmdUcmltYCBpcyBzZXQgdG8gYFwiZmFsc2VcImAgdGhlbiB3aGl0ZXNwYWNlIGFyb3VuZCBib3RoIHRoZSBzZXBhcmF0b3IgYW5kIGVhY2hcbiAqICAgbGlzdCBpdGVtIGlzIHJlc3BlY3RlZC4gVGhpcyBpbXBsaWVzIHRoYXQgdGhlIHVzZXIgb2YgdGhlIGRpcmVjdGl2ZSBpcyByZXNwb25zaWJsZSBmb3JcbiAqICAgZGVhbGluZyB3aXRoIHdoaXRlc3BhY2UgYnV0IGFsc28gYWxsb3dzIHlvdSB0byB1c2Ugd2hpdGVzcGFjZSBhcyBhIGRlbGltaXRlciwgc3VjaCBhcyBhXG4gKiAgIHRhYiBvciBuZXdsaW5lIGNoYXJhY3Rlci5cbiAqICogT3RoZXJ3aXNlIHdoaXRlc3BhY2UgYXJvdW5kIHRoZSBkZWxpbWl0ZXIgaXMgaWdub3JlZCB3aGVuIHNwbGl0dGluZyAoYWx0aG91Z2ggaXQgaXMgcmVzcGVjdGVkXG4gKiAgIHdoZW4gam9pbmluZyB0aGUgbGlzdCBpdGVtcyBiYWNrIHRvZ2V0aGVyKSBhbmQgd2hpdGVzcGFjZSBhcm91bmQgZWFjaCBsaXN0IGl0ZW0gaXMgc3RyaXBwZWRcbiAqICAgYmVmb3JlIGl0IGlzIGFkZGVkIHRvIHRoZSBtb2RlbC5cbiAqXG4gKiAjIyMgRXhhbXBsZSB3aXRoIFZhbGlkYXRpb25cbiAqXG4gKiA8ZXhhbXBsZSBuYW1lPVwibmdMaXN0LWRpcmVjdGl2ZVwiIG1vZHVsZT1cImxpc3RFeGFtcGxlXCI+XG4gKiAgIDxmaWxlIG5hbWU9XCJhcHAuanNcIj5cbiAqICAgICAgYW5ndWxhci5tb2R1bGUoJ2xpc3RFeGFtcGxlJywgW10pXG4gKiAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAqICAgICAgICAgICRzY29wZS5uYW1lcyA9IFsnbW9ycGhldXMnLCAnbmVvJywgJ3RyaW5pdHknXTtcbiAqICAgICAgICB9XSk7XG4gKiAgIDwvZmlsZT5cbiAqICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAqICAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiAqICAgICAgPGxhYmVsPkxpc3Q6IDxpbnB1dCBuYW1lPVwibmFtZXNJbnB1dFwiIG5nLW1vZGVsPVwibmFtZXNcIiBuZy1saXN0IHJlcXVpcmVkPjwvbGFiZWw+XG4gKiAgICAgIDxzcGFuIHJvbGU9XCJhbGVydFwiPlxuICogICAgICAgIDxzcGFuIGNsYXNzPVwiZXJyb3JcIiBuZy1zaG93PVwibXlGb3JtLm5hbWVzSW5wdXQuJGVycm9yLnJlcXVpcmVkXCI+XG4gKiAgICAgICAgUmVxdWlyZWQhPC9zcGFuPlxuICogICAgICA8L3NwYW4+XG4gKiAgICAgIDxicj5cbiAqICAgICAgPHR0Pm5hbWVzID0ge3tuYW1lc319PC90dD48YnIvPlxuICogICAgICA8dHQ+bXlGb3JtLm5hbWVzSW5wdXQuJHZhbGlkID0ge3tteUZvcm0ubmFtZXNJbnB1dC4kdmFsaWR9fTwvdHQ+PGJyLz5cbiAqICAgICAgPHR0Pm15Rm9ybS5uYW1lc0lucHV0LiRlcnJvciA9IHt7bXlGb3JtLm5hbWVzSW5wdXQuJGVycm9yfX08L3R0Pjxici8+XG4gKiAgICAgIDx0dD5teUZvcm0uJHZhbGlkID0ge3tteUZvcm0uJHZhbGlkfX08L3R0Pjxici8+XG4gKiAgICAgIDx0dD5teUZvcm0uJGVycm9yLnJlcXVpcmVkID0ge3shIW15Rm9ybS4kZXJyb3IucmVxdWlyZWR9fTwvdHQ+PGJyLz5cbiAqICAgICA8L2Zvcm0+XG4gKiAgIDwvZmlsZT5cbiAqICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICogICAgIHZhciBsaXN0SW5wdXQgPSBlbGVtZW50KGJ5Lm1vZGVsKCduYW1lcycpKTtcbiAqICAgICB2YXIgbmFtZXMgPSBlbGVtZW50KGJ5LmV4YWN0QmluZGluZygnbmFtZXMnKSk7XG4gKiAgICAgdmFyIHZhbGlkID0gZWxlbWVudChieS5iaW5kaW5nKCdteUZvcm0ubmFtZXNJbnB1dC4kdmFsaWQnKSk7XG4gKiAgICAgdmFyIGVycm9yID0gZWxlbWVudChieS5jc3MoJ3NwYW4uZXJyb3InKSk7XG4gKlxuICogICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB0byBtb2RlbCcsIGZ1bmN0aW9uKCkge1xuICogICAgICAgZXhwZWN0KG5hbWVzLmdldFRleHQoKSkudG9Db250YWluKCdbXCJtb3JwaGV1c1wiLFwibmVvXCIsXCJ0cmluaXR5XCJdJyk7XG4gKiAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ3RydWUnKTtcbiAqICAgICAgIGV4cGVjdChlcnJvci5nZXRDc3NWYWx1ZSgnZGlzcGxheScpKS50b0JlKCdub25lJyk7XG4gKiAgICAgfSk7XG4gKlxuICogICAgIGl0KCdzaG91bGQgYmUgaW52YWxpZCBpZiBlbXB0eScsIGZ1bmN0aW9uKCkge1xuICogICAgICAgbGlzdElucHV0LmNsZWFyKCk7XG4gKiAgICAgICBsaXN0SW5wdXQuc2VuZEtleXMoJycpO1xuICpcbiAqICAgICAgIGV4cGVjdChuYW1lcy5nZXRUZXh0KCkpLnRvQ29udGFpbignJyk7XG4gKiAgICAgICBleHBlY3QodmFsaWQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ2ZhbHNlJyk7XG4gKiAgICAgICBleHBlY3QoZXJyb3IuZ2V0Q3NzVmFsdWUoJ2Rpc3BsYXknKSkubm90LnRvQmUoJ25vbmUnKTtcbiAqICAgICB9KTtcbiAqICAgPC9maWxlPlxuICogPC9leGFtcGxlPlxuICpcbiAqICMjIyBFeGFtcGxlIC0gc3BsaXR0aW5nIG9uIG5ld2xpbmVcbiAqIDxleGFtcGxlIG5hbWU9XCJuZ0xpc3QtZGlyZWN0aXZlLW5ld2xpbmVzXCI+XG4gKiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gKiAgICA8dGV4dGFyZWEgbmctbW9kZWw9XCJsaXN0XCIgbmctbGlzdD1cIiYjMTA7XCIgbmctdHJpbT1cImZhbHNlXCI+PC90ZXh0YXJlYT5cbiAqICAgIDxwcmU+e3sgbGlzdCB8IGpzb24gfX08L3ByZT5cbiAqICAgPC9maWxlPlxuICogICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gKiAgICAgaXQoXCJzaG91bGQgc3BsaXQgdGhlIHRleHQgYnkgbmV3bGluZXNcIiwgZnVuY3Rpb24oKSB7XG4gKiAgICAgICB2YXIgbGlzdElucHV0ID0gZWxlbWVudChieS5tb2RlbCgnbGlzdCcpKTtcbiAqICAgICAgIHZhciBvdXRwdXQgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ2xpc3QgfCBqc29uJykpO1xuICogICAgICAgbGlzdElucHV0LnNlbmRLZXlzKCdhYmNcXG5kZWZcXG5naGknKTtcbiAqICAgICAgIGV4cGVjdChvdXRwdXQuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJ1tcXG4gIFwiYWJjXCIsXFxuICBcImRlZlwiLFxcbiAgXCJnaGlcIlxcbl0nKTtcbiAqICAgICB9KTtcbiAqICAgPC9maWxlPlxuICogPC9leGFtcGxlPlxuICpcbiAqIEBlbGVtZW50IGlucHV0XG4gKiBAcGFyYW0ge3N0cmluZz19IG5nTGlzdCBvcHRpb25hbCBkZWxpbWl0ZXIgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBzcGxpdCB0aGUgdmFsdWUuXG4gKi9cbnZhciBuZ0xpc3REaXJlY3RpdmUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHByaW9yaXR5OiAxMDAsXG4gICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XG4gICAgICAvLyBXZSB3YW50IHRvIGNvbnRyb2wgd2hpdGVzcGFjZSB0cmltbWluZyBzbyB3ZSB1c2UgdGhpcyBjb252b2x1dGVkIGFwcHJvYWNoXG4gICAgICAvLyB0byBhY2Nlc3MgdGhlIG5nTGlzdCBhdHRyaWJ1dGUsIHdoaWNoIGRvZXNuJ3QgcHJlLXRyaW0gdGhlIGF0dHJpYnV0ZVxuICAgICAgdmFyIG5nTGlzdCA9IGVsZW1lbnQuYXR0cihhdHRyLiRhdHRyLm5nTGlzdCkgfHwgJywgJztcbiAgICAgIHZhciB0cmltVmFsdWVzID0gYXR0ci5uZ1RyaW0gIT09ICdmYWxzZSc7XG4gICAgICB2YXIgc2VwYXJhdG9yID0gdHJpbVZhbHVlcyA/IHRyaW0obmdMaXN0KSA6IG5nTGlzdDtcblxuICAgICAgdmFyIHBhcnNlID0gZnVuY3Rpb24odmlld1ZhbHVlKSB7XG4gICAgICAgIC8vIElmIHRoZSB2aWV3VmFsdWUgaXMgaW52YWxpZCAoc2F5IHJlcXVpcmVkIGJ1dCBlbXB0eSkgaXQgd2lsbCBiZSBgdW5kZWZpbmVkYFxuICAgICAgICBpZiAoaXNVbmRlZmluZWQodmlld1ZhbHVlKSkgcmV0dXJuO1xuXG4gICAgICAgIHZhciBsaXN0ID0gW107XG5cbiAgICAgICAgaWYgKHZpZXdWYWx1ZSkge1xuICAgICAgICAgIGZvckVhY2godmlld1ZhbHVlLnNwbGl0KHNlcGFyYXRvciksIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUpIGxpc3QucHVzaCh0cmltVmFsdWVzID8gdHJpbSh2YWx1ZSkgOiB2YWx1ZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbGlzdDtcbiAgICAgIH07XG5cbiAgICAgIGN0cmwuJHBhcnNlcnMucHVzaChwYXJzZSk7XG4gICAgICBjdHJsLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlLmpvaW4obmdMaXN0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICB9KTtcblxuICAgICAgLy8gT3ZlcnJpZGUgdGhlIHN0YW5kYXJkICRpc0VtcHR5IGJlY2F1c2UgYW4gZW1wdHkgYXJyYXkgbWVhbnMgdGhlIGlucHV0IGlzIGVtcHR5LlxuICAgICAgY3RybC4kaXNFbXB0eSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAhdmFsdWUgfHwgIXZhbHVlLmxlbmd0aDtcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcblxuLyogZ2xvYmFsIFZBTElEX0NMQVNTOiB0cnVlLFxuICBJTlZBTElEX0NMQVNTOiB0cnVlLFxuICBQUklTVElORV9DTEFTUzogdHJ1ZSxcbiAgRElSVFlfQ0xBU1M6IHRydWUsXG4gIFVOVE9VQ0hFRF9DTEFTUzogdHJ1ZSxcbiAgVE9VQ0hFRF9DTEFTUzogdHJ1ZSxcbiovXG5cbnZhciBWQUxJRF9DTEFTUyA9ICduZy12YWxpZCcsXG4gICAgSU5WQUxJRF9DTEFTUyA9ICduZy1pbnZhbGlkJyxcbiAgICBQUklTVElORV9DTEFTUyA9ICduZy1wcmlzdGluZScsXG4gICAgRElSVFlfQ0xBU1MgPSAnbmctZGlydHknLFxuICAgIFVOVE9VQ0hFRF9DTEFTUyA9ICduZy11bnRvdWNoZWQnLFxuICAgIFRPVUNIRURfQ0xBU1MgPSAnbmctdG91Y2hlZCcsXG4gICAgUEVORElOR19DTEFTUyA9ICduZy1wZW5kaW5nJyxcbiAgICBFTVBUWV9DTEFTUyA9ICduZy1lbXB0eScsXG4gICAgTk9UX0VNUFRZX0NMQVNTID0gJ25nLW5vdC1lbXB0eSc7XG5cbnZhciBuZ01vZGVsTWluRXJyID0gbWluRXJyKCduZ01vZGVsJyk7XG5cbi8qKlxuICogQG5nZG9jIHR5cGVcbiAqIEBuYW1lIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXJcbiAqXG4gKiBAcHJvcGVydHkgeyp9ICR2aWV3VmFsdWUgVGhlIGFjdHVhbCB2YWx1ZSBmcm9tIHRoZSBjb250cm9sJ3Mgdmlldy4gRm9yIGBpbnB1dGAgZWxlbWVudHMsIHRoaXMgaXMgYVxuICogU3RyaW5nLiBTZWUge0BsaW5rIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHNldFZpZXdWYWx1ZX0gZm9yIGluZm9ybWF0aW9uIGFib3V0IHdoZW4gdGhlICR2aWV3VmFsdWVcbiAqIGlzIHNldC5cbiAqIEBwcm9wZXJ0eSB7Kn0gJG1vZGVsVmFsdWUgVGhlIHZhbHVlIGluIHRoZSBtb2RlbCB0aGF0IHRoZSBjb250cm9sIGlzIGJvdW5kIHRvLlxuICogQHByb3BlcnR5IHtBcnJheS48RnVuY3Rpb24+fSAkcGFyc2VycyBBcnJheSBvZiBmdW5jdGlvbnMgdG8gZXhlY3V0ZSwgYXMgYSBwaXBlbGluZSwgd2hlbmV2ZXJcbiAgICAgICB0aGUgY29udHJvbCByZWFkcyB2YWx1ZSBmcm9tIHRoZSBET00uIFRoZSBmdW5jdGlvbnMgYXJlIGNhbGxlZCBpbiBhcnJheSBvcmRlciwgZWFjaCBwYXNzaW5nXG4gICAgICAgaXRzIHJldHVybiB2YWx1ZSB0aHJvdWdoIHRvIHRoZSBuZXh0LiBUaGUgbGFzdCByZXR1cm4gdmFsdWUgaXMgZm9yd2FyZGVkIHRvIHRoZVxuICAgICAgIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2YWxpZGF0b3JzIGAkdmFsaWRhdG9yc2B9IGNvbGxlY3Rpb24uXG5cblBhcnNlcnMgYXJlIHVzZWQgdG8gc2FuaXRpemUgLyBjb252ZXJ0IHRoZSB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmlld1ZhbHVlXG5gJHZpZXdWYWx1ZWB9LlxuXG5SZXR1cm5pbmcgYHVuZGVmaW5lZGAgZnJvbSBhIHBhcnNlciBtZWFucyBhIHBhcnNlIGVycm9yIG9jY3VycmVkLiBJbiB0aGF0IGNhc2UsXG5ubyB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmFsaWRhdG9ycyBgJHZhbGlkYXRvcnNgfSB3aWxsIHJ1biBhbmQgdGhlIGBuZ01vZGVsYFxud2lsbCBiZSBzZXQgdG8gYHVuZGVmaW5lZGAgdW5sZXNzIHtAbGluayBuZ01vZGVsT3B0aW9ucyBgbmdNb2RlbE9wdGlvbnMuYWxsb3dJbnZhbGlkYH1cbmlzIHNldCB0byBgdHJ1ZWAuIFRoZSBwYXJzZSBlcnJvciBpcyBzdG9yZWQgaW4gYG5nTW9kZWwuJGVycm9yLnBhcnNlYC5cblxuICpcbiAqIEBwcm9wZXJ0eSB7QXJyYXkuPEZ1bmN0aW9uPn0gJGZvcm1hdHRlcnMgQXJyYXkgb2YgZnVuY3Rpb25zIHRvIGV4ZWN1dGUsIGFzIGEgcGlwZWxpbmUsIHdoZW5ldmVyXG4gICAgICAgdGhlIG1vZGVsIHZhbHVlIGNoYW5nZXMuIFRoZSBmdW5jdGlvbnMgYXJlIGNhbGxlZCBpbiByZXZlcnNlIGFycmF5IG9yZGVyLCBlYWNoIHBhc3NpbmcgdGhlIHZhbHVlIHRocm91Z2ggdG8gdGhlXG4gICAgICAgbmV4dC4gVGhlIGxhc3QgcmV0dXJuIHZhbHVlIGlzIHVzZWQgYXMgdGhlIGFjdHVhbCBET00gdmFsdWUuXG4gICAgICAgVXNlZCB0byBmb3JtYXQgLyBjb252ZXJ0IHZhbHVlcyBmb3IgZGlzcGxheSBpbiB0aGUgY29udHJvbC5cbiAqIGBgYGpzXG4gKiBmdW5jdGlvbiBmb3JtYXR0ZXIodmFsdWUpIHtcbiAqICAgaWYgKHZhbHVlKSB7XG4gKiAgICAgcmV0dXJuIHZhbHVlLnRvVXBwZXJDYXNlKCk7XG4gKiAgIH1cbiAqIH1cbiAqIG5nTW9kZWwuJGZvcm1hdHRlcnMucHVzaChmb3JtYXR0ZXIpO1xuICogYGBgXG4gKlxuICogQHByb3BlcnR5IHtPYmplY3QuPHN0cmluZywgZnVuY3Rpb24+fSAkdmFsaWRhdG9ycyBBIGNvbGxlY3Rpb24gb2YgdmFsaWRhdG9ycyB0aGF0IGFyZSBhcHBsaWVkXG4gKiAgICAgIHdoZW5ldmVyIHRoZSBtb2RlbCB2YWx1ZSBjaGFuZ2VzLiBUaGUga2V5IHZhbHVlIHdpdGhpbiB0aGUgb2JqZWN0IHJlZmVycyB0byB0aGUgbmFtZSBvZiB0aGVcbiAqICAgICAgdmFsaWRhdG9yIHdoaWxlIHRoZSBmdW5jdGlvbiByZWZlcnMgdG8gdGhlIHZhbGlkYXRpb24gb3BlcmF0aW9uLiBUaGUgdmFsaWRhdGlvbiBvcGVyYXRpb24gaXNcbiAqICAgICAgcHJvdmlkZWQgd2l0aCB0aGUgbW9kZWwgdmFsdWUgYXMgYW4gYXJndW1lbnQgYW5kIG11c3QgcmV0dXJuIGEgdHJ1ZSBvciBmYWxzZSB2YWx1ZSBkZXBlbmRpbmdcbiAqICAgICAgb24gdGhlIHJlc3BvbnNlIG9mIHRoYXQgdmFsaWRhdGlvbi5cbiAqXG4gKiBgYGBqc1xuICogbmdNb2RlbC4kdmFsaWRhdG9ycy52YWxpZENoYXJhY3RlcnMgPSBmdW5jdGlvbihtb2RlbFZhbHVlLCB2aWV3VmFsdWUpIHtcbiAqICAgdmFyIHZhbHVlID0gbW9kZWxWYWx1ZSB8fCB2aWV3VmFsdWU7XG4gKiAgIHJldHVybiAvWzAtOV0rLy50ZXN0KHZhbHVlKSAmJlxuICogICAgICAgICAgL1thLXpdKy8udGVzdCh2YWx1ZSkgJiZcbiAqICAgICAgICAgIC9bQS1aXSsvLnRlc3QodmFsdWUpICYmXG4gKiAgICAgICAgICAvXFxXKy8udGVzdCh2YWx1ZSk7XG4gKiB9O1xuICogYGBgXG4gKlxuICogQHByb3BlcnR5IHtPYmplY3QuPHN0cmluZywgZnVuY3Rpb24+fSAkYXN5bmNWYWxpZGF0b3JzIEEgY29sbGVjdGlvbiBvZiB2YWxpZGF0aW9ucyB0aGF0IGFyZSBleHBlY3RlZCB0b1xuICogICAgICBwZXJmb3JtIGFuIGFzeW5jaHJvbm91cyB2YWxpZGF0aW9uIChlLmcuIGEgSFRUUCByZXF1ZXN0KS4gVGhlIHZhbGlkYXRpb24gZnVuY3Rpb24gdGhhdCBpcyBwcm92aWRlZFxuICogICAgICBpcyBleHBlY3RlZCB0byByZXR1cm4gYSBwcm9taXNlIHdoZW4gaXQgaXMgcnVuIGR1cmluZyB0aGUgbW9kZWwgdmFsaWRhdGlvbiBwcm9jZXNzLiBPbmNlIHRoZSBwcm9taXNlXG4gKiAgICAgIGlzIGRlbGl2ZXJlZCB0aGVuIHRoZSB2YWxpZGF0aW9uIHN0YXR1cyB3aWxsIGJlIHNldCB0byB0cnVlIHdoZW4gZnVsZmlsbGVkIGFuZCBmYWxzZSB3aGVuIHJlamVjdGVkLlxuICogICAgICBXaGVuIHRoZSBhc3luY2hyb25vdXMgdmFsaWRhdG9ycyBhcmUgdHJpZ2dlcmVkLCBlYWNoIG9mIHRoZSB2YWxpZGF0b3JzIHdpbGwgcnVuIGluIHBhcmFsbGVsIGFuZCB0aGUgbW9kZWxcbiAqICAgICAgdmFsdWUgd2lsbCBvbmx5IGJlIHVwZGF0ZWQgb25jZSBhbGwgdmFsaWRhdG9ycyBoYXZlIGJlZW4gZnVsZmlsbGVkLiBBcyBsb25nIGFzIGFuIGFzeW5jaHJvbm91cyB2YWxpZGF0b3JcbiAqICAgICAgaXMgdW5mdWxmaWxsZWQsIGl0cyBrZXkgd2lsbCBiZSBhZGRlZCB0byB0aGUgY29udHJvbGxlcnMgYCRwZW5kaW5nYCBwcm9wZXJ0eS4gQWxzbywgYWxsIGFzeW5jaHJvbm91cyB2YWxpZGF0b3JzXG4gKiAgICAgIHdpbGwgb25seSBydW4gb25jZSBhbGwgc3luY2hyb25vdXMgdmFsaWRhdG9ycyBoYXZlIHBhc3NlZC5cbiAqXG4gKiBQbGVhc2Ugbm90ZSB0aGF0IGlmICRodHRwIGlzIHVzZWQgdGhlbiBpdCBpcyBpbXBvcnRhbnQgdGhhdCB0aGUgc2VydmVyIHJldHVybnMgYSBzdWNjZXNzIEhUVFAgcmVzcG9uc2UgY29kZVxuICogaW4gb3JkZXIgdG8gZnVsZmlsbCB0aGUgdmFsaWRhdGlvbiBhbmQgYSBzdGF0dXMgbGV2ZWwgb2YgYDR4eGAgaW4gb3JkZXIgdG8gcmVqZWN0IHRoZSB2YWxpZGF0aW9uLlxuICpcbiAqIGBgYGpzXG4gKiBuZ01vZGVsLiRhc3luY1ZhbGlkYXRvcnMudW5pcXVlVXNlcm5hbWUgPSBmdW5jdGlvbihtb2RlbFZhbHVlLCB2aWV3VmFsdWUpIHtcbiAqICAgdmFyIHZhbHVlID0gbW9kZWxWYWx1ZSB8fCB2aWV3VmFsdWU7XG4gKlxuICogICAvLyBMb29rdXAgdXNlciBieSB1c2VybmFtZVxuICogICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzLycgKyB2YWx1ZSkuXG4gKiAgICAgIHRoZW4oZnVuY3Rpb24gcmVzb2x2ZWQoKSB7XG4gKiAgICAgICAgLy91c2VybmFtZSBleGlzdHMsIHRoaXMgbWVhbnMgdmFsaWRhdGlvbiBmYWlsc1xuICogICAgICAgIHJldHVybiAkcS5yZWplY3QoJ2V4aXN0cycpO1xuICogICAgICB9LCBmdW5jdGlvbiByZWplY3RlZCgpIHtcbiAqICAgICAgICAvL3VzZXJuYW1lIGRvZXMgbm90IGV4aXN0LCB0aGVyZWZvcmUgdGhpcyB2YWxpZGF0aW9uIHBhc3Nlc1xuICogICAgICAgIHJldHVybiB0cnVlO1xuICogICAgICB9KTtcbiAqIH07XG4gKiBgYGBcbiAqXG4gKiBAcHJvcGVydHkge0FycmF5LjxGdW5jdGlvbj59ICR2aWV3Q2hhbmdlTGlzdGVuZXJzIEFycmF5IG9mIGZ1bmN0aW9ucyB0byBleGVjdXRlIHdoZW5ldmVyIHRoZVxuICogICAgIHZpZXcgdmFsdWUgaGFzIGNoYW5nZWQuIEl0IGlzIGNhbGxlZCB3aXRoIG5vIGFyZ3VtZW50cywgYW5kIGl0cyByZXR1cm4gdmFsdWUgaXMgaWdub3JlZC5cbiAqICAgICBUaGlzIGNhbiBiZSB1c2VkIGluIHBsYWNlIG9mIGFkZGl0aW9uYWwgJHdhdGNoZXMgYWdhaW5zdCB0aGUgbW9kZWwgdmFsdWUuXG4gKlxuICogQHByb3BlcnR5IHtPYmplY3R9ICRlcnJvciBBbiBvYmplY3QgaGFzaCB3aXRoIGFsbCBmYWlsaW5nIHZhbGlkYXRvciBpZHMgYXMga2V5cy5cbiAqIEBwcm9wZXJ0eSB7T2JqZWN0fSAkcGVuZGluZyBBbiBvYmplY3QgaGFzaCB3aXRoIGFsbCBwZW5kaW5nIHZhbGlkYXRvciBpZHMgYXMga2V5cy5cbiAqXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59ICR1bnRvdWNoZWQgVHJ1ZSBpZiBjb250cm9sIGhhcyBub3QgbG9zdCBmb2N1cyB5ZXQuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59ICR0b3VjaGVkIFRydWUgaWYgY29udHJvbCBoYXMgbG9zdCBmb2N1cy5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gJHByaXN0aW5lIFRydWUgaWYgdXNlciBoYXMgbm90IGludGVyYWN0ZWQgd2l0aCB0aGUgY29udHJvbCB5ZXQuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59ICRkaXJ0eSBUcnVlIGlmIHVzZXIgaGFzIGFscmVhZHkgaW50ZXJhY3RlZCB3aXRoIHRoZSBjb250cm9sLlxuICogQHByb3BlcnR5IHtib29sZWFufSAkdmFsaWQgVHJ1ZSBpZiB0aGVyZSBpcyBubyBlcnJvci5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gJGludmFsaWQgVHJ1ZSBpZiBhdCBsZWFzdCBvbmUgZXJyb3Igb24gdGhlIGNvbnRyb2wuXG4gKiBAcHJvcGVydHkge3N0cmluZ30gJG5hbWUgVGhlIG5hbWUgYXR0cmlidXRlIG9mIHRoZSBjb250cm9sLlxuICpcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIGBOZ01vZGVsQ29udHJvbGxlcmAgcHJvdmlkZXMgQVBJIGZvciB0aGUge0BsaW5rIG5nTW9kZWwgYG5nTW9kZWxgfSBkaXJlY3RpdmUuXG4gKiBUaGUgY29udHJvbGxlciBjb250YWlucyBzZXJ2aWNlcyBmb3IgZGF0YS1iaW5kaW5nLCB2YWxpZGF0aW9uLCBDU1MgdXBkYXRlcywgYW5kIHZhbHVlIGZvcm1hdHRpbmdcbiAqIGFuZCBwYXJzaW5nLiBJdCBwdXJwb3NlZnVsbHkgZG9lcyBub3QgY29udGFpbiBhbnkgbG9naWMgd2hpY2ggZGVhbHMgd2l0aCBET00gcmVuZGVyaW5nIG9yXG4gKiBsaXN0ZW5pbmcgdG8gRE9NIGV2ZW50cy5cbiAqIFN1Y2ggRE9NIHJlbGF0ZWQgbG9naWMgc2hvdWxkIGJlIHByb3ZpZGVkIGJ5IG90aGVyIGRpcmVjdGl2ZXMgd2hpY2ggbWFrZSB1c2Ugb2ZcbiAqIGBOZ01vZGVsQ29udHJvbGxlcmAgZm9yIGRhdGEtYmluZGluZyB0byBjb250cm9sIGVsZW1lbnRzLlxuICogQW5ndWxhciBwcm92aWRlcyB0aGlzIERPTSBsb2dpYyBmb3IgbW9zdCB7QGxpbmsgaW5wdXQgYGlucHV0YH0gZWxlbWVudHMuXG4gKiBBdCB0aGUgZW5kIG9mIHRoaXMgcGFnZSB5b3UgY2FuIGZpbmQgYSB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciNjdXN0b20tY29udHJvbC1leGFtcGxlXG4gKiBjdXN0b20gY29udHJvbCBleGFtcGxlfSB0aGF0IHVzZXMgYG5nTW9kZWxDb250cm9sbGVyYCB0byBiaW5kIHRvIGBjb250ZW50ZWRpdGFibGVgIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiAjIyMgQ3VzdG9tIENvbnRyb2wgRXhhbXBsZVxuICogVGhpcyBleGFtcGxlIHNob3dzIGhvdyB0byB1c2UgYE5nTW9kZWxDb250cm9sbGVyYCB3aXRoIGEgY3VzdG9tIGNvbnRyb2wgdG8gYWNoaWV2ZVxuICogZGF0YS1iaW5kaW5nLiBOb3RpY2UgaG93IGRpZmZlcmVudCBkaXJlY3RpdmVzIChgY29udGVudGVkaXRhYmxlYCwgYG5nLW1vZGVsYCwgYW5kIGByZXF1aXJlZGApXG4gKiBjb2xsYWJvcmF0ZSB0b2dldGhlciB0byBhY2hpZXZlIHRoZSBkZXNpcmVkIHJlc3VsdC5cbiAqXG4gKiBgY29udGVudGVkaXRhYmxlYCBpcyBhbiBIVE1MNSBhdHRyaWJ1dGUsIHdoaWNoIHRlbGxzIHRoZSBicm93c2VyIHRvIGxldCB0aGUgZWxlbWVudFxuICogY29udGVudHMgYmUgZWRpdGVkIGluIHBsYWNlIGJ5IHRoZSB1c2VyLlxuICpcbiAqIFdlIGFyZSB1c2luZyB0aGUge0BsaW5rIG5nLnNlcnZpY2U6JHNjZSAkc2NlfSBzZXJ2aWNlIGhlcmUgYW5kIGluY2x1ZGUgdGhlIHtAbGluayBuZ1Nhbml0aXplICRzYW5pdGl6ZX1cbiAqIG1vZHVsZSB0byBhdXRvbWF0aWNhbGx5IHJlbW92ZSBcImJhZFwiIGNvbnRlbnQgbGlrZSBpbmxpbmUgZXZlbnQgbGlzdGVuZXIgKGUuZy4gYDxzcGFuIG9uY2xpY2s9XCIuLi5cIj5gKS5cbiAqIEhvd2V2ZXIsIGFzIHdlIGFyZSB1c2luZyBgJHNjZWAgdGhlIG1vZGVsIGNhbiBzdGlsbCBkZWNpZGUgdG8gcHJvdmlkZSB1bnNhZmUgY29udGVudCBpZiBpdCBtYXJrc1xuICogdGhhdCBjb250ZW50IHVzaW5nIHRoZSBgJHNjZWAgc2VydmljZS5cbiAqXG4gKiA8ZXhhbXBsZSBuYW1lPVwiTmdNb2RlbENvbnRyb2xsZXJcIiBtb2R1bGU9XCJjdXN0b21Db250cm9sXCIgZGVwcz1cImFuZ3VsYXItc2FuaXRpemUuanNcIj5cbiAgICA8ZmlsZSBuYW1lPVwic3R5bGUuY3NzXCI+XG4gICAgICBbY29udGVudGVkaXRhYmxlXSB7XG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbiAgICAgICAgbWluLWhlaWdodDogMjBweDtcbiAgICAgIH1cblxuICAgICAgLm5nLWludmFsaWQge1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCByZWQ7XG4gICAgICB9XG5cbiAgICA8L2ZpbGU+XG4gICAgPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuICAgICAgYW5ndWxhci5tb2R1bGUoJ2N1c3RvbUNvbnRyb2wnLCBbJ25nU2FuaXRpemUnXSkuXG4gICAgICAgIGRpcmVjdGl2ZSgnY29udGVudGVkaXRhYmxlJywgWyckc2NlJywgZnVuY3Rpb24oJHNjZSkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLCAvLyBvbmx5IGFjdGl2YXRlIG9uIGVsZW1lbnQgYXR0cmlidXRlXG4gICAgICAgICAgICByZXF1aXJlOiAnP25nTW9kZWwnLCAvLyBnZXQgYSBob2xkIG9mIE5nTW9kZWxDb250cm9sbGVyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcbiAgICAgICAgICAgICAgaWYgKCFuZ01vZGVsKSByZXR1cm47IC8vIGRvIG5vdGhpbmcgaWYgbm8gbmctbW9kZWxcblxuICAgICAgICAgICAgICAvLyBTcGVjaWZ5IGhvdyBVSSBzaG91bGQgYmUgdXBkYXRlZFxuICAgICAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50Lmh0bWwoJHNjZS5nZXRUcnVzdGVkSHRtbChuZ01vZGVsLiR2aWV3VmFsdWUgfHwgJycpKTtcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIGNoYW5nZSBldmVudHMgdG8gZW5hYmxlIGJpbmRpbmdcbiAgICAgICAgICAgICAgZWxlbWVudC5vbignYmx1ciBrZXl1cCBjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzY29wZS4kZXZhbEFzeW5jKHJlYWQpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgcmVhZCgpOyAvLyBpbml0aWFsaXplXG5cbiAgICAgICAgICAgICAgLy8gV3JpdGUgZGF0YSB0byB0aGUgbW9kZWxcbiAgICAgICAgICAgICAgZnVuY3Rpb24gcmVhZCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IGVsZW1lbnQuaHRtbCgpO1xuICAgICAgICAgICAgICAgIC8vIFdoZW4gd2UgY2xlYXIgdGhlIGNvbnRlbnQgZWRpdGFibGUgdGhlIGJyb3dzZXIgbGVhdmVzIGEgPGJyPiBiZWhpbmRcbiAgICAgICAgICAgICAgICAvLyBJZiBzdHJpcC1iciBhdHRyaWJ1dGUgaXMgcHJvdmlkZWQgdGhlbiB3ZSBzdHJpcCB0aGlzIG91dFxuICAgICAgICAgICAgICAgIGlmICggYXR0cnMuc3RyaXBCciAmJiBodG1sID09ICc8YnI+JyApIHtcbiAgICAgICAgICAgICAgICAgIGh0bWwgPSAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKGh0bWwpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfV0pO1xuICAgIDwvZmlsZT5cbiAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiPlxuICAgICAgIDxkaXYgY29udGVudGVkaXRhYmxlXG4gICAgICAgICAgICBuYW1lPVwibXlXaWRnZXRcIiBuZy1tb2RlbD1cInVzZXJDb250ZW50XCJcbiAgICAgICAgICAgIHN0cmlwLWJyPVwidHJ1ZVwiXG4gICAgICAgICAgICByZXF1aXJlZD5DaGFuZ2UgbWUhPC9kaXY+XG4gICAgICAgIDxzcGFuIG5nLXNob3c9XCJteUZvcm0ubXlXaWRnZXQuJGVycm9yLnJlcXVpcmVkXCI+UmVxdWlyZWQhPC9zcGFuPlxuICAgICAgIDxocj5cbiAgICAgICA8dGV4dGFyZWEgbmctbW9kZWw9XCJ1c2VyQ29udGVudFwiIGFyaWEtbGFiZWw9XCJEeW5hbWljIHRleHRhcmVhXCI+PC90ZXh0YXJlYT5cbiAgICAgIDwvZm9ybT5cbiAgICA8L2ZpbGU+XG4gICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgIGl0KCdzaG91bGQgZGF0YS1iaW5kIGFuZCBiZWNvbWUgaW52YWxpZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKGJyb3dzZXIucGFyYW1zLmJyb3dzZXIgPT0gJ3NhZmFyaScgfHwgYnJvd3Nlci5wYXJhbXMuYnJvd3NlciA9PSAnZmlyZWZveCcpIHtcbiAgICAgICAgLy8gU2FmYXJpRHJpdmVyIGNhbid0IGhhbmRsZSBjb250ZW50ZWRpdGFibGVcbiAgICAgICAgLy8gYW5kIEZpcmVmb3ggZHJpdmVyIGNhbid0IGNsZWFyIGNvbnRlbnRlZGl0YWJsZXMgdmVyeSB3ZWxsXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBjb250ZW50RWRpdGFibGUgPSBlbGVtZW50KGJ5LmNzcygnW2NvbnRlbnRlZGl0YWJsZV0nKSk7XG4gICAgICB2YXIgY29udGVudCA9ICdDaGFuZ2UgbWUhJztcblxuICAgICAgZXhwZWN0KGNvbnRlbnRFZGl0YWJsZS5nZXRUZXh0KCkpLnRvRXF1YWwoY29udGVudCk7XG5cbiAgICAgIGNvbnRlbnRFZGl0YWJsZS5jbGVhcigpO1xuICAgICAgY29udGVudEVkaXRhYmxlLnNlbmRLZXlzKHByb3RyYWN0b3IuS2V5LkJBQ0tfU1BBQ0UpO1xuICAgICAgZXhwZWN0KGNvbnRlbnRFZGl0YWJsZS5nZXRUZXh0KCkpLnRvRXF1YWwoJycpO1xuICAgICAgZXhwZWN0KGNvbnRlbnRFZGl0YWJsZS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpLnRvTWF0Y2goL25nLWludmFsaWQtcmVxdWlyZWQvKTtcbiAgICB9KTtcbiAgICA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICpcbiAqL1xudmFyIE5nTW9kZWxDb250cm9sbGVyID0gWyckc2NvcGUnLCAnJGV4Y2VwdGlvbkhhbmRsZXInLCAnJGF0dHJzJywgJyRlbGVtZW50JywgJyRwYXJzZScsICckYW5pbWF0ZScsICckdGltZW91dCcsICckcm9vdFNjb3BlJywgJyRxJywgJyRpbnRlcnBvbGF0ZScsXG4gICAgZnVuY3Rpb24oJHNjb3BlLCAkZXhjZXB0aW9uSGFuZGxlciwgJGF0dHIsICRlbGVtZW50LCAkcGFyc2UsICRhbmltYXRlLCAkdGltZW91dCwgJHJvb3RTY29wZSwgJHEsICRpbnRlcnBvbGF0ZSkge1xuICB0aGlzLiR2aWV3VmFsdWUgPSBOdW1iZXIuTmFOO1xuICB0aGlzLiRtb2RlbFZhbHVlID0gTnVtYmVyLk5hTjtcbiAgdGhpcy4kJHJhd01vZGVsVmFsdWUgPSB1bmRlZmluZWQ7IC8vIHN0b3JlcyB0aGUgcGFyc2VkIG1vZGVsVmFsdWUgLyBtb2RlbCBzZXQgZnJvbSBzY29wZSByZWdhcmRsZXNzIG9mIHZhbGlkaXR5LlxuICB0aGlzLiR2YWxpZGF0b3JzID0ge307XG4gIHRoaXMuJGFzeW5jVmFsaWRhdG9ycyA9IHt9O1xuICB0aGlzLiRwYXJzZXJzID0gW107XG4gIHRoaXMuJGZvcm1hdHRlcnMgPSBbXTtcbiAgdGhpcy4kdmlld0NoYW5nZUxpc3RlbmVycyA9IFtdO1xuICB0aGlzLiR1bnRvdWNoZWQgPSB0cnVlO1xuICB0aGlzLiR0b3VjaGVkID0gZmFsc2U7XG4gIHRoaXMuJHByaXN0aW5lID0gdHJ1ZTtcbiAgdGhpcy4kZGlydHkgPSBmYWxzZTtcbiAgdGhpcy4kdmFsaWQgPSB0cnVlO1xuICB0aGlzLiRpbnZhbGlkID0gZmFsc2U7XG4gIHRoaXMuJGVycm9yID0ge307IC8vIGtlZXAgaW52YWxpZCBrZXlzIGhlcmVcbiAgdGhpcy4kJHN1Y2Nlc3MgPSB7fTsgLy8ga2VlcCB2YWxpZCBrZXlzIGhlcmVcbiAgdGhpcy4kcGVuZGluZyA9IHVuZGVmaW5lZDsgLy8ga2VlcCBwZW5kaW5nIGtleXMgaGVyZVxuICB0aGlzLiRuYW1lID0gJGludGVycG9sYXRlKCRhdHRyLm5hbWUgfHwgJycsIGZhbHNlKSgkc2NvcGUpO1xuICB0aGlzLiQkcGFyZW50Rm9ybSA9IG51bGxGb3JtQ3RybDtcblxuICB2YXIgcGFyc2VkTmdNb2RlbCA9ICRwYXJzZSgkYXR0ci5uZ01vZGVsKSxcbiAgICAgIHBhcnNlZE5nTW9kZWxBc3NpZ24gPSBwYXJzZWROZ01vZGVsLmFzc2lnbixcbiAgICAgIG5nTW9kZWxHZXQgPSBwYXJzZWROZ01vZGVsLFxuICAgICAgbmdNb2RlbFNldCA9IHBhcnNlZE5nTW9kZWxBc3NpZ24sXG4gICAgICBwZW5kaW5nRGVib3VuY2UgPSBudWxsLFxuICAgICAgcGFyc2VyVmFsaWQsXG4gICAgICBjdHJsID0gdGhpcztcblxuICB0aGlzLiQkc2V0T3B0aW9ucyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICBjdHJsLiRvcHRpb25zID0gb3B0aW9ucztcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmdldHRlclNldHRlcikge1xuICAgICAgdmFyIGludm9rZU1vZGVsR2V0dGVyID0gJHBhcnNlKCRhdHRyLm5nTW9kZWwgKyAnKCknKSxcbiAgICAgICAgICBpbnZva2VNb2RlbFNldHRlciA9ICRwYXJzZSgkYXR0ci5uZ01vZGVsICsgJygkJCRwKScpO1xuXG4gICAgICBuZ01vZGVsR2V0ID0gZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgIHZhciBtb2RlbFZhbHVlID0gcGFyc2VkTmdNb2RlbCgkc2NvcGUpO1xuICAgICAgICBpZiAoaXNGdW5jdGlvbihtb2RlbFZhbHVlKSkge1xuICAgICAgICAgIG1vZGVsVmFsdWUgPSBpbnZva2VNb2RlbEdldHRlcigkc2NvcGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtb2RlbFZhbHVlO1xuICAgICAgfTtcbiAgICAgIG5nTW9kZWxTZXQgPSBmdW5jdGlvbigkc2NvcGUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChpc0Z1bmN0aW9uKHBhcnNlZE5nTW9kZWwoJHNjb3BlKSkpIHtcbiAgICAgICAgICBpbnZva2VNb2RlbFNldHRlcigkc2NvcGUsIHskJCRwOiBjdHJsLiRtb2RlbFZhbHVlfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcGFyc2VkTmdNb2RlbEFzc2lnbigkc2NvcGUsIGN0cmwuJG1vZGVsVmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAoIXBhcnNlZE5nTW9kZWwuYXNzaWduKSB7XG4gICAgICB0aHJvdyBuZ01vZGVsTWluRXJyKCdub25hc3NpZ24nLCBcIkV4cHJlc3Npb24gJ3swfScgaXMgbm9uLWFzc2lnbmFibGUuIEVsZW1lbnQ6IHsxfVwiLFxuICAgICAgICAgICRhdHRyLm5nTW9kZWwsIHN0YXJ0aW5nVGFnKCRlbGVtZW50KSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHJlbmRlclxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogQ2FsbGVkIHdoZW4gdGhlIHZpZXcgbmVlZHMgdG8gYmUgdXBkYXRlZC4gSXQgaXMgZXhwZWN0ZWQgdGhhdCB0aGUgdXNlciBvZiB0aGUgbmctbW9kZWxcbiAgICogZGlyZWN0aXZlIHdpbGwgaW1wbGVtZW50IHRoaXMgbWV0aG9kLlxuICAgKlxuICAgKiBUaGUgYCRyZW5kZXIoKWAgbWV0aG9kIGlzIGludm9rZWQgaW4gdGhlIGZvbGxvd2luZyBzaXR1YXRpb25zOlxuICAgKlxuICAgKiAqIGAkcm9sbGJhY2tWaWV3VmFsdWUoKWAgaXMgY2FsbGVkLiAgSWYgd2UgYXJlIHJvbGxpbmcgYmFjayB0aGUgdmlldyB2YWx1ZSB0byB0aGUgbGFzdFxuICAgKiAgIGNvbW1pdHRlZCB2YWx1ZSB0aGVuIGAkcmVuZGVyKClgIGlzIGNhbGxlZCB0byB1cGRhdGUgdGhlIGlucHV0IGNvbnRyb2wuXG4gICAqICogVGhlIHZhbHVlIHJlZmVyZW5jZWQgYnkgYG5nLW1vZGVsYCBpcyBjaGFuZ2VkIHByb2dyYW1tYXRpY2FsbHkgYW5kIGJvdGggdGhlIGAkbW9kZWxWYWx1ZWAgYW5kXG4gICAqICAgdGhlIGAkdmlld1ZhbHVlYCBhcmUgZGlmZmVyZW50IGZyb20gbGFzdCB0aW1lLlxuICAgKlxuICAgKiBTaW5jZSBgbmctbW9kZWxgIGRvZXMgbm90IGRvIGEgZGVlcCB3YXRjaCwgYCRyZW5kZXIoKWAgaXMgb25seSBpbnZva2VkIGlmIHRoZSB2YWx1ZXMgb2ZcbiAgICogYCRtb2RlbFZhbHVlYCBhbmQgYCR2aWV3VmFsdWVgIGFyZSBhY3R1YWxseSBkaWZmZXJlbnQgZnJvbSB0aGVpciBwcmV2aW91cyB2YWx1ZS4gSWYgYCRtb2RlbFZhbHVlYFxuICAgKiBvciBgJHZpZXdWYWx1ZWAgYXJlIG9iamVjdHMgKHJhdGhlciB0aGFuIGEgc3RyaW5nIG9yIG51bWJlcikgdGhlbiBgJHJlbmRlcigpYCB3aWxsIG5vdCBiZVxuICAgKiBpbnZva2VkIGlmIHlvdSBvbmx5IGNoYW5nZSBhIHByb3BlcnR5IG9uIHRoZSBvYmplY3RzLlxuICAgKi9cbiAgdGhpcy4kcmVuZGVyID0gbm9vcDtcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyRpc0VtcHR5XG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBUaGlzIGlzIGNhbGxlZCB3aGVuIHdlIG5lZWQgdG8gZGV0ZXJtaW5lIGlmIHRoZSB2YWx1ZSBvZiBhbiBpbnB1dCBpcyBlbXB0eS5cbiAgICpcbiAgICogRm9yIGluc3RhbmNlLCB0aGUgcmVxdWlyZWQgZGlyZWN0aXZlIGRvZXMgdGhpcyB0byB3b3JrIG91dCBpZiB0aGUgaW5wdXQgaGFzIGRhdGEgb3Igbm90LlxuICAgKlxuICAgKiBUaGUgZGVmYXVsdCBgJGlzRW1wdHlgIGZ1bmN0aW9uIGNoZWNrcyB3aGV0aGVyIHRoZSB2YWx1ZSBpcyBgdW5kZWZpbmVkYCwgYCcnYCwgYG51bGxgIG9yIGBOYU5gLlxuICAgKlxuICAgKiBZb3UgY2FuIG92ZXJyaWRlIHRoaXMgZm9yIGlucHV0IGRpcmVjdGl2ZXMgd2hvc2UgY29uY2VwdCBvZiBiZWluZyBlbXB0eSBpcyBkaWZmZXJlbnQgZnJvbSB0aGVcbiAgICogZGVmYXVsdC4gVGhlIGBjaGVja2JveElucHV0VHlwZWAgZGlyZWN0aXZlIGRvZXMgdGhpcyBiZWNhdXNlIGluIGl0cyBjYXNlIGEgdmFsdWUgb2YgYGZhbHNlYFxuICAgKiBpbXBsaWVzIGVtcHR5LlxuICAgKlxuICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSBvZiB0aGUgaW5wdXQgdG8gY2hlY2sgZm9yIGVtcHRpbmVzcy5cbiAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgYHZhbHVlYCBpcyBcImVtcHR5XCIuXG4gICAqL1xuICB0aGlzLiRpc0VtcHR5ID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gaXNVbmRlZmluZWQodmFsdWUpIHx8IHZhbHVlID09PSAnJyB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSAhPT0gdmFsdWU7XG4gIH07XG5cbiAgdGhpcy4kJHVwZGF0ZUVtcHR5Q2xhc3NlcyA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgaWYgKGN0cmwuJGlzRW1wdHkodmFsdWUpKSB7XG4gICAgICAkYW5pbWF0ZS5yZW1vdmVDbGFzcygkZWxlbWVudCwgTk9UX0VNUFRZX0NMQVNTKTtcbiAgICAgICRhbmltYXRlLmFkZENsYXNzKCRlbGVtZW50LCBFTVBUWV9DTEFTUyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICRhbmltYXRlLnJlbW92ZUNsYXNzKCRlbGVtZW50LCBFTVBUWV9DTEFTUyk7XG4gICAgICAkYW5pbWF0ZS5hZGRDbGFzcygkZWxlbWVudCwgTk9UX0VNUFRZX0NMQVNTKTtcbiAgICB9XG4gIH07XG5cblxuICB2YXIgY3VycmVudFZhbGlkYXRpb25SdW5JZCA9IDA7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkc2V0VmFsaWRpdHlcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIENoYW5nZSB0aGUgdmFsaWRpdHkgc3RhdGUsIGFuZCBub3RpZnkgdGhlIGZvcm0uXG4gICAqXG4gICAqIFRoaXMgbWV0aG9kIGNhbiBiZSBjYWxsZWQgd2l0aGluICRwYXJzZXJzLyRmb3JtYXR0ZXJzIG9yIGEgY3VzdG9tIHZhbGlkYXRpb24gaW1wbGVtZW50YXRpb24uXG4gICAqIEhvd2V2ZXIsIGluIG1vc3QgY2FzZXMgaXQgc2hvdWxkIGJlIHN1ZmZpY2llbnQgdG8gdXNlIHRoZSBgbmdNb2RlbC4kdmFsaWRhdG9yc2AgYW5kXG4gICAqIGBuZ01vZGVsLiRhc3luY1ZhbGlkYXRvcnNgIGNvbGxlY3Rpb25zIHdoaWNoIHdpbGwgY2FsbCBgJHNldFZhbGlkaXR5YCBhdXRvbWF0aWNhbGx5LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsaWRhdGlvbkVycm9yS2V5IE5hbWUgb2YgdGhlIHZhbGlkYXRvci4gVGhlIGB2YWxpZGF0aW9uRXJyb3JLZXlgIHdpbGwgYmUgYXNzaWduZWRcbiAgICogICAgICAgIHRvIGVpdGhlciBgJGVycm9yW3ZhbGlkYXRpb25FcnJvcktleV1gIG9yIGAkcGVuZGluZ1t2YWxpZGF0aW9uRXJyb3JLZXldYFxuICAgKiAgICAgICAgKGZvciB1bmZ1bGZpbGxlZCBgJGFzeW5jVmFsaWRhdG9yc2ApLCBzbyB0aGF0IGl0IGlzIGF2YWlsYWJsZSBmb3IgZGF0YS1iaW5kaW5nLlxuICAgKiAgICAgICAgVGhlIGB2YWxpZGF0aW9uRXJyb3JLZXlgIHNob3VsZCBiZSBpbiBjYW1lbENhc2UgYW5kIHdpbGwgZ2V0IGNvbnZlcnRlZCBpbnRvIGRhc2gtY2FzZVxuICAgKiAgICAgICAgZm9yIGNsYXNzIG5hbWUuIEV4YW1wbGU6IGBteUVycm9yYCB3aWxsIHJlc3VsdCBpbiBgbmctdmFsaWQtbXktZXJyb3JgIGFuZCBgbmctaW52YWxpZC1teS1lcnJvcmBcbiAgICogICAgICAgIGNsYXNzIGFuZCBjYW4gYmUgYm91bmQgdG8gYXMgIGB7e3NvbWVGb3JtLnNvbWVDb250cm9sLiRlcnJvci5teUVycm9yfX1gIC5cbiAgICogQHBhcmFtIHtib29sZWFufSBpc1ZhbGlkIFdoZXRoZXIgdGhlIGN1cnJlbnQgc3RhdGUgaXMgdmFsaWQgKHRydWUpLCBpbnZhbGlkIChmYWxzZSksIHBlbmRpbmcgKHVuZGVmaW5lZCksXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICBvciBza2lwcGVkIChudWxsKS4gUGVuZGluZyBpcyB1c2VkIGZvciB1bmZ1bGZpbGxlZCBgJGFzeW5jVmFsaWRhdG9yc2AuXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICBTa2lwcGVkIGlzIHVzZWQgYnkgQW5ndWxhciB3aGVuIHZhbGlkYXRvcnMgZG8gbm90IHJ1biBiZWNhdXNlIG9mIHBhcnNlIGVycm9ycyBhbmRcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gYCRhc3luY1ZhbGlkYXRvcnNgIGRvIG5vdCBydW4gYmVjYXVzZSBhbnkgb2YgdGhlIGAkdmFsaWRhdG9yc2AgZmFpbGVkLlxuICAgKi9cbiAgYWRkU2V0VmFsaWRpdHlNZXRob2Qoe1xuICAgIGN0cmw6IHRoaXMsXG4gICAgJGVsZW1lbnQ6ICRlbGVtZW50LFxuICAgIHNldDogZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkge1xuICAgICAgb2JqZWN0W3Byb3BlcnR5XSA9IHRydWU7XG4gICAgfSxcbiAgICB1bnNldDogZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkge1xuICAgICAgZGVsZXRlIG9iamVjdFtwcm9wZXJ0eV07XG4gICAgfSxcbiAgICAkYW5pbWF0ZTogJGFuaW1hdGVcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkc2V0UHJpc3RpbmVcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFNldHMgdGhlIGNvbnRyb2wgdG8gaXRzIHByaXN0aW5lIHN0YXRlLlxuICAgKlxuICAgKiBUaGlzIG1ldGhvZCBjYW4gYmUgY2FsbGVkIHRvIHJlbW92ZSB0aGUgYG5nLWRpcnR5YCBjbGFzcyBhbmQgc2V0IHRoZSBjb250cm9sIHRvIGl0cyBwcmlzdGluZVxuICAgKiBzdGF0ZSAoYG5nLXByaXN0aW5lYCBjbGFzcykuIEEgbW9kZWwgaXMgY29uc2lkZXJlZCB0byBiZSBwcmlzdGluZSB3aGVuIHRoZSBjb250cm9sXG4gICAqIGhhcyBub3QgYmVlbiBjaGFuZ2VkIGZyb20gd2hlbiBmaXJzdCBjb21waWxlZC5cbiAgICovXG4gIHRoaXMuJHNldFByaXN0aW5lID0gZnVuY3Rpb24oKSB7XG4gICAgY3RybC4kZGlydHkgPSBmYWxzZTtcbiAgICBjdHJsLiRwcmlzdGluZSA9IHRydWU7XG4gICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoJGVsZW1lbnQsIERJUlRZX0NMQVNTKTtcbiAgICAkYW5pbWF0ZS5hZGRDbGFzcygkZWxlbWVudCwgUFJJU1RJTkVfQ0xBU1MpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHNldERpcnR5XG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBTZXRzIHRoZSBjb250cm9sIHRvIGl0cyBkaXJ0eSBzdGF0ZS5cbiAgICpcbiAgICogVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byByZW1vdmUgdGhlIGBuZy1wcmlzdGluZWAgY2xhc3MgYW5kIHNldCB0aGUgY29udHJvbCB0byBpdHMgZGlydHlcbiAgICogc3RhdGUgKGBuZy1kaXJ0eWAgY2xhc3MpLiBBIG1vZGVsIGlzIGNvbnNpZGVyZWQgdG8gYmUgZGlydHkgd2hlbiB0aGUgY29udHJvbCBoYXMgYmVlbiBjaGFuZ2VkXG4gICAqIGZyb20gd2hlbiBmaXJzdCBjb21waWxlZC5cbiAgICovXG4gIHRoaXMuJHNldERpcnR5ID0gZnVuY3Rpb24oKSB7XG4gICAgY3RybC4kZGlydHkgPSB0cnVlO1xuICAgIGN0cmwuJHByaXN0aW5lID0gZmFsc2U7XG4gICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoJGVsZW1lbnQsIFBSSVNUSU5FX0NMQVNTKTtcbiAgICAkYW5pbWF0ZS5hZGRDbGFzcygkZWxlbWVudCwgRElSVFlfQ0xBU1MpO1xuICAgIGN0cmwuJCRwYXJlbnRGb3JtLiRzZXREaXJ0eSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHNldFVudG91Y2hlZFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogU2V0cyB0aGUgY29udHJvbCB0byBpdHMgdW50b3VjaGVkIHN0YXRlLlxuICAgKlxuICAgKiBUaGlzIG1ldGhvZCBjYW4gYmUgY2FsbGVkIHRvIHJlbW92ZSB0aGUgYG5nLXRvdWNoZWRgIGNsYXNzIGFuZCBzZXQgdGhlIGNvbnRyb2wgdG8gaXRzXG4gICAqIHVudG91Y2hlZCBzdGF0ZSAoYG5nLXVudG91Y2hlZGAgY2xhc3MpLiBVcG9uIGNvbXBpbGF0aW9uLCBhIG1vZGVsIGlzIHNldCBhcyB1bnRvdWNoZWRcbiAgICogYnkgZGVmYXVsdCwgaG93ZXZlciB0aGlzIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIHJlc3RvcmUgdGhhdCBzdGF0ZSBpZiB0aGUgbW9kZWwgaGFzXG4gICAqIGFscmVhZHkgYmVlbiB0b3VjaGVkIGJ5IHRoZSB1c2VyLlxuICAgKi9cbiAgdGhpcy4kc2V0VW50b3VjaGVkID0gZnVuY3Rpb24oKSB7XG4gICAgY3RybC4kdG91Y2hlZCA9IGZhbHNlO1xuICAgIGN0cmwuJHVudG91Y2hlZCA9IHRydWU7XG4gICAgJGFuaW1hdGUuc2V0Q2xhc3MoJGVsZW1lbnQsIFVOVE9VQ0hFRF9DTEFTUywgVE9VQ0hFRF9DTEFTUyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkc2V0VG91Y2hlZFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogU2V0cyB0aGUgY29udHJvbCB0byBpdHMgdG91Y2hlZCBzdGF0ZS5cbiAgICpcbiAgICogVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byByZW1vdmUgdGhlIGBuZy11bnRvdWNoZWRgIGNsYXNzIGFuZCBzZXQgdGhlIGNvbnRyb2wgdG8gaXRzXG4gICAqIHRvdWNoZWQgc3RhdGUgKGBuZy10b3VjaGVkYCBjbGFzcykuIEEgbW9kZWwgaXMgY29uc2lkZXJlZCB0byBiZSB0b3VjaGVkIHdoZW4gdGhlIHVzZXIgaGFzXG4gICAqIGZpcnN0IGZvY3VzZWQgdGhlIGNvbnRyb2wgZWxlbWVudCBhbmQgdGhlbiBzaGlmdGVkIGZvY3VzIGF3YXkgZnJvbSB0aGUgY29udHJvbCAoYmx1ciBldmVudCkuXG4gICAqL1xuICB0aGlzLiRzZXRUb3VjaGVkID0gZnVuY3Rpb24oKSB7XG4gICAgY3RybC4kdG91Y2hlZCA9IHRydWU7XG4gICAgY3RybC4kdW50b3VjaGVkID0gZmFsc2U7XG4gICAgJGFuaW1hdGUuc2V0Q2xhc3MoJGVsZW1lbnQsIFRPVUNIRURfQ0xBU1MsIFVOVE9VQ0hFRF9DTEFTUyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkcm9sbGJhY2tWaWV3VmFsdWVcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIENhbmNlbCBhbiB1cGRhdGUgYW5kIHJlc2V0IHRoZSBpbnB1dCBlbGVtZW50J3MgdmFsdWUgdG8gcHJldmVudCBhbiB1cGRhdGUgdG8gdGhlIGAkbW9kZWxWYWx1ZWAsXG4gICAqIHdoaWNoIG1heSBiZSBjYXVzZWQgYnkgYSBwZW5kaW5nIGRlYm91bmNlZCBldmVudCBvciBiZWNhdXNlIHRoZSBpbnB1dCBpcyB3YWl0aW5nIGZvciBhIHNvbWVcbiAgICogZnV0dXJlIGV2ZW50LlxuICAgKlxuICAgKiBJZiB5b3UgaGF2ZSBhbiBpbnB1dCB0aGF0IHVzZXMgYG5nLW1vZGVsLW9wdGlvbnNgIHRvIHNldCB1cCBkZWJvdW5jZWQgdXBkYXRlcyBvciB1cGRhdGVzIHRoYXRcbiAgICogZGVwZW5kIG9uIHNwZWNpYWwgZXZlbnRzIHN1Y2ggYXMgYmx1ciwgeW91IGNhbiBoYXZlIGEgc2l0dWF0aW9uIHdoZXJlIHRoZXJlIGlzIGEgcGVyaW9kIHdoZW5cbiAgICogdGhlIGAkdmlld1ZhbHVlYCBpcyBvdXQgb2Ygc3luYyB3aXRoIHRoZSBuZ01vZGVsJ3MgYCRtb2RlbFZhbHVlYC5cbiAgICpcbiAgICogSW4gdGhpcyBjYXNlLCB5b3UgY2FuIHVzZSBgJHJvbGxiYWNrVmlld1ZhbHVlKClgIHRvIG1hbnVhbGx5IGNhbmNlbCB0aGUgZGVib3VuY2VkIC8gZnV0dXJlIHVwZGF0ZVxuICAgKiBhbmQgcmVzZXQgdGhlIGlucHV0IHRvIHRoZSBsYXN0IGNvbW1pdHRlZCB2aWV3IHZhbHVlLlxuICAgKlxuICAgKiBJdCBpcyBhbHNvIHBvc3NpYmxlIHRoYXQgeW91IHJ1biBpbnRvIGRpZmZpY3VsdGllcyBpZiB5b3UgdHJ5IHRvIHVwZGF0ZSB0aGUgbmdNb2RlbCdzIGAkbW9kZWxWYWx1ZWBcbiAgICogcHJvZ3JhbW1hdGljYWxseSBiZWZvcmUgdGhlc2UgZGVib3VuY2VkL2Z1dHVyZSBldmVudHMgaGF2ZSByZXNvbHZlZC9vY2N1cnJlZCwgYmVjYXVzZSBBbmd1bGFyJ3NcbiAgICogZGlydHkgY2hlY2tpbmcgbWVjaGFuaXNtIGlzIG5vdCBhYmxlIHRvIHRlbGwgd2hldGhlciB0aGUgbW9kZWwgaGFzIGFjdHVhbGx5IGNoYW5nZWQgb3Igbm90LlxuICAgKlxuICAgKiBUaGUgYCRyb2xsYmFja1ZpZXdWYWx1ZSgpYCBtZXRob2Qgc2hvdWxkIGJlIGNhbGxlZCBiZWZvcmUgcHJvZ3JhbW1hdGljYWxseSBjaGFuZ2luZyB0aGUgbW9kZWwgb2YgYW5cbiAgICogaW5wdXQgd2hpY2ggbWF5IGhhdmUgc3VjaCBldmVudHMgcGVuZGluZy4gVGhpcyBpcyBpbXBvcnRhbnQgaW4gb3JkZXIgdG8gbWFrZSBzdXJlIHRoYXQgdGhlXG4gICAqIGlucHV0IGZpZWxkIHdpbGwgYmUgdXBkYXRlZCB3aXRoIHRoZSBuZXcgbW9kZWwgdmFsdWUgYW5kIGFueSBwZW5kaW5nIG9wZXJhdGlvbnMgYXJlIGNhbmNlbGxlZC5cbiAgICpcbiAgICogPGV4YW1wbGUgbmFtZT1cIm5nLW1vZGVsLWNhbmNlbC11cGRhdGVcIiBtb2R1bGU9XCJjYW5jZWwtdXBkYXRlLWV4YW1wbGVcIj5cbiAgICogICA8ZmlsZSBuYW1lPVwiYXBwLmpzXCI+XG4gICAqICAgICBhbmd1bGFyLm1vZHVsZSgnY2FuY2VsLXVwZGF0ZS1leGFtcGxlJywgW10pXG4gICAqXG4gICAqICAgICAuY29udHJvbGxlcignQ2FuY2VsVXBkYXRlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAqICAgICAgICRzY29wZS5tb2RlbCA9IHt9O1xuICAgKlxuICAgKiAgICAgICAkc2NvcGUuc2V0RW1wdHkgPSBmdW5jdGlvbihlLCB2YWx1ZSwgcm9sbGJhY2spIHtcbiAgICogICAgICAgICBpZiAoZS5rZXlDb2RlID09IDI3KSB7XG4gICAqICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAqICAgICAgICAgICBpZiAocm9sbGJhY2spIHtcbiAgICogICAgICAgICAgICAgJHNjb3BlLm15Rm9ybVt2YWx1ZV0uJHJvbGxiYWNrVmlld1ZhbHVlKCk7XG4gICAqICAgICAgICAgICB9XG4gICAqICAgICAgICAgICAkc2NvcGUubW9kZWxbdmFsdWVdID0gJyc7XG4gICAqICAgICAgICAgfVxuICAgKiAgICAgICB9O1xuICAgKiAgICAgfV0pO1xuICAgKiAgIDwvZmlsZT5cbiAgICogICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgKiAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiQ2FuY2VsVXBkYXRlQ29udHJvbGxlclwiPlxuICAgKiAgICAgICAgPHA+Qm90aCBvZiB0aGVzZSBpbnB1dHMgYXJlIG9ubHkgdXBkYXRlZCBpZiB0aGV5IGFyZSBibHVycmVkLiBIaXR0aW5nIGVzY2FwZSBzaG91bGRcbiAgICogICAgICAgIGVtcHR5IHRoZW0uIEZvbGxvdyB0aGVzZSBzdGVwcyBhbmQgb2JzZXJ2ZSB0aGUgZGlmZmVyZW5jZTo8L3A+XG4gICAqICAgICAgIDxvbD5cbiAgICogICAgICAgICA8bGk+VHlwZSBzb21ldGhpbmcgaW4gdGhlIGlucHV0LiBZb3Ugd2lsbCBzZWUgdGhhdCB0aGUgbW9kZWwgaXMgbm90IHlldCB1cGRhdGVkPC9saT5cbiAgICogICAgICAgICA8bGk+UHJlc3MgdGhlIEVzY2FwZSBrZXkuXG4gICAqICAgICAgICAgICA8b2w+XG4gICAqICAgICAgICAgICAgIDxsaT4gSW4gdGhlIGZpcnN0IGV4YW1wbGUsIG5vdGhpbmcgaGFwcGVucywgYmVjYXVzZSB0aGUgbW9kZWwgaXMgYWxyZWFkeSAnJywgYW5kIG5vXG4gICAqICAgICAgICAgICAgIHVwZGF0ZSBpcyBkZXRlY3RlZC4gSWYgeW91IGJsdXIgdGhlIGlucHV0LCB0aGUgbW9kZWwgd2lsbCBiZSBzZXQgdG8gdGhlIGN1cnJlbnQgdmlldy5cbiAgICogICAgICAgICAgICAgPC9saT5cbiAgICogICAgICAgICAgICAgPGxpPiBJbiB0aGUgc2Vjb25kIGV4YW1wbGUsIHRoZSBwZW5kaW5nIHVwZGF0ZSBpcyBjYW5jZWxsZWQsIGFuZCB0aGUgaW5wdXQgaXMgc2V0IGJhY2tcbiAgICogICAgICAgICAgICAgdG8gdGhlIGxhc3QgY29tbWl0dGVkIHZpZXcgdmFsdWUgKCcnKS4gQmx1cnJpbmcgdGhlIGlucHV0IGRvZXMgbm90aGluZy5cbiAgICogICAgICAgICAgICAgPC9saT5cbiAgICogICAgICAgICAgIDwvb2w+XG4gICAqICAgICAgICAgPC9saT5cbiAgICogICAgICAgPC9vbD5cbiAgICpcbiAgICogICAgICAgPGZvcm0gbmFtZT1cIm15Rm9ybVwiIG5nLW1vZGVsLW9wdGlvbnM9XCJ7IHVwZGF0ZU9uOiAnYmx1cicgfVwiPlxuICAgKiAgICAgICAgIDxkaXY+XG4gICAqICAgICAgICA8cCBpZD1cImlucHV0RGVzY3JpcHRpb24xXCI+V2l0aG91dCAkcm9sbGJhY2tWaWV3VmFsdWUoKTo8L3A+XG4gICAqICAgICAgICAgPGlucHV0IG5hbWU9XCJ2YWx1ZTFcIiBhcmlhLWRlc2NyaWJlZGJ5PVwiaW5wdXREZXNjcmlwdGlvbjFcIiBuZy1tb2RlbD1cIm1vZGVsLnZhbHVlMVwiXG4gICAqICAgICAgICAgICAgICAgIG5nLWtleWRvd249XCJzZXRFbXB0eSgkZXZlbnQsICd2YWx1ZTEnKVwiPlxuICAgKiAgICAgICAgIHZhbHVlMTogXCJ7eyBtb2RlbC52YWx1ZTEgfX1cIlxuICAgKiAgICAgICAgIDwvZGl2PlxuICAgKlxuICAgKiAgICAgICAgIDxkaXY+XG4gICAqICAgICAgICA8cCBpZD1cImlucHV0RGVzY3JpcHRpb24yXCI+V2l0aCAkcm9sbGJhY2tWaWV3VmFsdWUoKTo8L3A+XG4gICAqICAgICAgICAgPGlucHV0IG5hbWU9XCJ2YWx1ZTJcIiBhcmlhLWRlc2NyaWJlZGJ5PVwiaW5wdXREZXNjcmlwdGlvbjJcIiBuZy1tb2RlbD1cIm1vZGVsLnZhbHVlMlwiXG4gICAqICAgICAgICAgICAgICAgIG5nLWtleWRvd249XCJzZXRFbXB0eSgkZXZlbnQsICd2YWx1ZTInLCB0cnVlKVwiPlxuICAgKiAgICAgICAgIHZhbHVlMjogXCJ7eyBtb2RlbC52YWx1ZTIgfX1cIlxuICAgKiAgICAgICAgIDwvZGl2PlxuICAgKiAgICAgICA8L2Zvcm0+XG4gICAqICAgICA8L2Rpdj5cbiAgICogICA8L2ZpbGU+XG4gICAgICAgPGZpbGUgbmFtZT1cInN0eWxlLmNzc1wiPlxuICAgICAgICAgIGRpdiB7XG4gICAgICAgICAgICBkaXNwbGF5OiB0YWJsZS1jZWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgICBkaXY6bnRoLWNoaWxkKDEpIHtcbiAgICAgICAgICAgIHBhZGRpbmctcmlnaHQ6IDMwcHg7XG4gICAgICAgICAgfVxuXG4gICAgICAgIDwvZmlsZT5cbiAgICogPC9leGFtcGxlPlxuICAgKi9cbiAgdGhpcy4kcm9sbGJhY2tWaWV3VmFsdWUgPSBmdW5jdGlvbigpIHtcbiAgICAkdGltZW91dC5jYW5jZWwocGVuZGluZ0RlYm91bmNlKTtcbiAgICBjdHJsLiR2aWV3VmFsdWUgPSBjdHJsLiQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZTtcbiAgICBjdHJsLiRyZW5kZXIoKTtcbiAgfTtcblxuICAvKipcbiAgICogQG5nZG9jIG1ldGhvZFxuICAgKiBAbmFtZSBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2YWxpZGF0ZVxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogUnVucyBlYWNoIG9mIHRoZSByZWdpc3RlcmVkIHZhbGlkYXRvcnMgKGZpcnN0IHN5bmNocm9ub3VzIHZhbGlkYXRvcnMgYW5kIHRoZW5cbiAgICogYXN5bmNocm9ub3VzIHZhbGlkYXRvcnMpLlxuICAgKiBJZiB0aGUgdmFsaWRpdHkgY2hhbmdlcyB0byBpbnZhbGlkLCB0aGUgbW9kZWwgd2lsbCBiZSBzZXQgdG8gYHVuZGVmaW5lZGAsXG4gICAqIHVubGVzcyB7QGxpbmsgbmdNb2RlbE9wdGlvbnMgYG5nTW9kZWxPcHRpb25zLmFsbG93SW52YWxpZGB9IGlzIGB0cnVlYC5cbiAgICogSWYgdGhlIHZhbGlkaXR5IGNoYW5nZXMgdG8gdmFsaWQsIGl0IHdpbGwgc2V0IHRoZSBtb2RlbCB0byB0aGUgbGFzdCBhdmFpbGFibGUgdmFsaWRcbiAgICogYCRtb2RlbFZhbHVlYCwgaS5lLiBlaXRoZXIgdGhlIGxhc3QgcGFyc2VkIHZhbHVlIG9yIHRoZSBsYXN0IHZhbHVlIHNldCBmcm9tIHRoZSBzY29wZS5cbiAgICovXG4gIHRoaXMuJHZhbGlkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gaWdub3JlICR2YWxpZGF0ZSBiZWZvcmUgbW9kZWwgaXMgaW5pdGlhbGl6ZWRcbiAgICBpZiAoaXNOdW1iZXIoY3RybC4kbW9kZWxWYWx1ZSkgJiYgaXNOYU4oY3RybC4kbW9kZWxWYWx1ZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgdmlld1ZhbHVlID0gY3RybC4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWU7XG4gICAgLy8gTm90ZTogd2UgdXNlIHRoZSAkJHJhd01vZGVsVmFsdWUgYXMgJG1vZGVsVmFsdWUgbWlnaHQgaGF2ZSBiZWVuXG4gICAgLy8gc2V0IHRvIHVuZGVmaW5lZCBkdXJpbmcgYSB2aWV3IC0+IG1vZGVsIHVwZGF0ZSB0aGF0IGZvdW5kIHZhbGlkYXRpb25cbiAgICAvLyBlcnJvcnMuIFdlIGNhbid0IHBhcnNlIHRoZSB2aWV3IGhlcmUsIHNpbmNlIHRoYXQgY291bGQgY2hhbmdlXG4gICAgLy8gdGhlIG1vZGVsIGFsdGhvdWdoIG5laXRoZXIgdmlld1ZhbHVlIG5vciB0aGUgbW9kZWwgb24gdGhlIHNjb3BlIGNoYW5nZWRcbiAgICB2YXIgbW9kZWxWYWx1ZSA9IGN0cmwuJCRyYXdNb2RlbFZhbHVlO1xuXG4gICAgdmFyIHByZXZWYWxpZCA9IGN0cmwuJHZhbGlkO1xuICAgIHZhciBwcmV2TW9kZWxWYWx1ZSA9IGN0cmwuJG1vZGVsVmFsdWU7XG5cbiAgICB2YXIgYWxsb3dJbnZhbGlkID0gY3RybC4kb3B0aW9ucyAmJiBjdHJsLiRvcHRpb25zLmFsbG93SW52YWxpZDtcblxuICAgIGN0cmwuJCRydW5WYWxpZGF0b3JzKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSwgZnVuY3Rpb24oYWxsVmFsaWQpIHtcbiAgICAgIC8vIElmIHRoZXJlIHdhcyBubyBjaGFuZ2UgaW4gdmFsaWRpdHksIGRvbid0IHVwZGF0ZSB0aGUgbW9kZWxcbiAgICAgIC8vIFRoaXMgcHJldmVudHMgY2hhbmdpbmcgYW4gaW52YWxpZCBtb2RlbFZhbHVlIHRvIHVuZGVmaW5lZFxuICAgICAgaWYgKCFhbGxvd0ludmFsaWQgJiYgcHJldlZhbGlkICE9PSBhbGxWYWxpZCkge1xuICAgICAgICAvLyBOb3RlOiBEb24ndCBjaGVjayBjdHJsLiR2YWxpZCBoZXJlLCBhcyB3ZSBjb3VsZCBoYXZlXG4gICAgICAgIC8vIGV4dGVybmFsIHZhbGlkYXRvcnMgKGUuZy4gY2FsY3VsYXRlZCBvbiB0aGUgc2VydmVyKSxcbiAgICAgICAgLy8gdGhhdCBqdXN0IGNhbGwgJHNldFZhbGlkaXR5IGFuZCBuZWVkIHRoZSBtb2RlbCB2YWx1ZVxuICAgICAgICAvLyB0byBjYWxjdWxhdGUgdGhlaXIgdmFsaWRpdHkuXG4gICAgICAgIGN0cmwuJG1vZGVsVmFsdWUgPSBhbGxWYWxpZCA/IG1vZGVsVmFsdWUgOiB1bmRlZmluZWQ7XG5cbiAgICAgICAgaWYgKGN0cmwuJG1vZGVsVmFsdWUgIT09IHByZXZNb2RlbFZhbHVlKSB7XG4gICAgICAgICAgY3RybC4kJHdyaXRlTW9kZWxUb1Njb3BlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICB9O1xuXG4gIHRoaXMuJCRydW5WYWxpZGF0b3JzID0gZnVuY3Rpb24obW9kZWxWYWx1ZSwgdmlld1ZhbHVlLCBkb25lQ2FsbGJhY2spIHtcbiAgICBjdXJyZW50VmFsaWRhdGlvblJ1bklkKys7XG4gICAgdmFyIGxvY2FsVmFsaWRhdGlvblJ1bklkID0gY3VycmVudFZhbGlkYXRpb25SdW5JZDtcblxuICAgIC8vIGNoZWNrIHBhcnNlciBlcnJvclxuICAgIGlmICghcHJvY2Vzc1BhcnNlRXJyb3JzKCkpIHtcbiAgICAgIHZhbGlkYXRpb25Eb25lKGZhbHNlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCFwcm9jZXNzU3luY1ZhbGlkYXRvcnMoKSkge1xuICAgICAgdmFsaWRhdGlvbkRvbmUoZmFsc2UpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBwcm9jZXNzQXN5bmNWYWxpZGF0b3JzKCk7XG5cbiAgICBmdW5jdGlvbiBwcm9jZXNzUGFyc2VFcnJvcnMoKSB7XG4gICAgICB2YXIgZXJyb3JLZXkgPSBjdHJsLiQkcGFyc2VyTmFtZSB8fCAncGFyc2UnO1xuICAgICAgaWYgKGlzVW5kZWZpbmVkKHBhcnNlclZhbGlkKSkge1xuICAgICAgICBzZXRWYWxpZGl0eShlcnJvcktleSwgbnVsbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIXBhcnNlclZhbGlkKSB7XG4gICAgICAgICAgZm9yRWFjaChjdHJsLiR2YWxpZGF0b3JzLCBmdW5jdGlvbih2LCBuYW1lKSB7XG4gICAgICAgICAgICBzZXRWYWxpZGl0eShuYW1lLCBudWxsKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBmb3JFYWNoKGN0cmwuJGFzeW5jVmFsaWRhdG9ycywgZnVuY3Rpb24odiwgbmFtZSkge1xuICAgICAgICAgICAgc2V0VmFsaWRpdHkobmFtZSwgbnVsbCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2V0IHRoZSBwYXJzZSBlcnJvciBsYXN0LCB0byBwcmV2ZW50IHVuc2V0dGluZyBpdCwgc2hvdWxkIGEgJHZhbGlkYXRvcnMga2V5ID09IHBhcnNlck5hbWVcbiAgICAgICAgc2V0VmFsaWRpdHkoZXJyb3JLZXksIHBhcnNlclZhbGlkKTtcbiAgICAgICAgcmV0dXJuIHBhcnNlclZhbGlkO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJvY2Vzc1N5bmNWYWxpZGF0b3JzKCkge1xuICAgICAgdmFyIHN5bmNWYWxpZGF0b3JzVmFsaWQgPSB0cnVlO1xuICAgICAgZm9yRWFjaChjdHJsLiR2YWxpZGF0b3JzLCBmdW5jdGlvbih2YWxpZGF0b3IsIG5hbWUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHZhbGlkYXRvcihtb2RlbFZhbHVlLCB2aWV3VmFsdWUpO1xuICAgICAgICBzeW5jVmFsaWRhdG9yc1ZhbGlkID0gc3luY1ZhbGlkYXRvcnNWYWxpZCAmJiByZXN1bHQ7XG4gICAgICAgIHNldFZhbGlkaXR5KG5hbWUsIHJlc3VsdCk7XG4gICAgICB9KTtcbiAgICAgIGlmICghc3luY1ZhbGlkYXRvcnNWYWxpZCkge1xuICAgICAgICBmb3JFYWNoKGN0cmwuJGFzeW5jVmFsaWRhdG9ycywgZnVuY3Rpb24odiwgbmFtZSkge1xuICAgICAgICAgIHNldFZhbGlkaXR5KG5hbWUsIG51bGwpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJvY2Vzc0FzeW5jVmFsaWRhdG9ycygpIHtcbiAgICAgIHZhciB2YWxpZGF0b3JQcm9taXNlcyA9IFtdO1xuICAgICAgdmFyIGFsbFZhbGlkID0gdHJ1ZTtcbiAgICAgIGZvckVhY2goY3RybC4kYXN5bmNWYWxpZGF0b3JzLCBmdW5jdGlvbih2YWxpZGF0b3IsIG5hbWUpIHtcbiAgICAgICAgdmFyIHByb21pc2UgPSB2YWxpZGF0b3IobW9kZWxWYWx1ZSwgdmlld1ZhbHVlKTtcbiAgICAgICAgaWYgKCFpc1Byb21pc2VMaWtlKHByb21pc2UpKSB7XG4gICAgICAgICAgdGhyb3cgbmdNb2RlbE1pbkVycignbm9wcm9taXNlJyxcbiAgICAgICAgICAgIFwiRXhwZWN0ZWQgYXN5bmNocm9ub3VzIHZhbGlkYXRvciB0byByZXR1cm4gYSBwcm9taXNlIGJ1dCBnb3QgJ3swfScgaW5zdGVhZC5cIiwgcHJvbWlzZSk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0VmFsaWRpdHkobmFtZSwgdW5kZWZpbmVkKTtcbiAgICAgICAgdmFsaWRhdG9yUHJvbWlzZXMucHVzaChwcm9taXNlLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgc2V0VmFsaWRpdHkobmFtZSwgdHJ1ZSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgYWxsVmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICBzZXRWYWxpZGl0eShuYW1lLCBmYWxzZSk7XG4gICAgICAgIH0pKTtcbiAgICAgIH0pO1xuICAgICAgaWYgKCF2YWxpZGF0b3JQcm9taXNlcy5sZW5ndGgpIHtcbiAgICAgICAgdmFsaWRhdGlvbkRvbmUodHJ1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkcS5hbGwodmFsaWRhdG9yUHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFsaWRhdGlvbkRvbmUoYWxsVmFsaWQpO1xuICAgICAgICB9LCBub29wKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRWYWxpZGl0eShuYW1lLCBpc1ZhbGlkKSB7XG4gICAgICBpZiAobG9jYWxWYWxpZGF0aW9uUnVuSWQgPT09IGN1cnJlbnRWYWxpZGF0aW9uUnVuSWQpIHtcbiAgICAgICAgY3RybC4kc2V0VmFsaWRpdHkobmFtZSwgaXNWYWxpZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmFsaWRhdGlvbkRvbmUoYWxsVmFsaWQpIHtcbiAgICAgIGlmIChsb2NhbFZhbGlkYXRpb25SdW5JZCA9PT0gY3VycmVudFZhbGlkYXRpb25SdW5JZCkge1xuXG4gICAgICAgIGRvbmVDYWxsYmFjayhhbGxWYWxpZCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJGNvbW1pdFZpZXdWYWx1ZVxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogQ29tbWl0IGEgcGVuZGluZyB1cGRhdGUgdG8gdGhlIGAkbW9kZWxWYWx1ZWAuXG4gICAqXG4gICAqIFVwZGF0ZXMgbWF5IGJlIHBlbmRpbmcgYnkgYSBkZWJvdW5jZWQgZXZlbnQgb3IgYmVjYXVzZSB0aGUgaW5wdXQgaXMgd2FpdGluZyBmb3IgYSBzb21lIGZ1dHVyZVxuICAgKiBldmVudCBkZWZpbmVkIGluIGBuZy1tb2RlbC1vcHRpb25zYC4gdGhpcyBtZXRob2QgaXMgcmFyZWx5IG5lZWRlZCBhcyBgTmdNb2RlbENvbnRyb2xsZXJgXG4gICAqIHVzdWFsbHkgaGFuZGxlcyBjYWxsaW5nIHRoaXMgaW4gcmVzcG9uc2UgdG8gaW5wdXQgZXZlbnRzLlxuICAgKi9cbiAgdGhpcy4kY29tbWl0Vmlld1ZhbHVlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHZpZXdWYWx1ZSA9IGN0cmwuJHZpZXdWYWx1ZTtcblxuICAgICR0aW1lb3V0LmNhbmNlbChwZW5kaW5nRGVib3VuY2UpO1xuXG4gICAgLy8gSWYgdGhlIHZpZXcgdmFsdWUgaGFzIG5vdCBjaGFuZ2VkIHRoZW4gd2Ugc2hvdWxkIGp1c3QgZXhpdCwgZXhjZXB0IGluIHRoZSBjYXNlIHdoZXJlIHRoZXJlIGlzXG4gICAgLy8gYSBuYXRpdmUgdmFsaWRhdG9yIG9uIHRoZSBlbGVtZW50LiBJbiB0aGlzIGNhc2UgdGhlIHZhbGlkYXRpb24gc3RhdGUgbWF5IGhhdmUgY2hhbmdlZCBldmVuIHRob3VnaFxuICAgIC8vIHRoZSB2aWV3VmFsdWUgaGFzIHN0YXllZCBlbXB0eS5cbiAgICBpZiAoY3RybC4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUgPT09IHZpZXdWYWx1ZSAmJiAodmlld1ZhbHVlICE9PSAnJyB8fCAhY3RybC4kJGhhc05hdGl2ZVZhbGlkYXRvcnMpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGN0cmwuJCR1cGRhdGVFbXB0eUNsYXNzZXModmlld1ZhbHVlKTtcbiAgICBjdHJsLiQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZSA9IHZpZXdWYWx1ZTtcblxuICAgIC8vIGNoYW5nZSB0byBkaXJ0eVxuICAgIGlmIChjdHJsLiRwcmlzdGluZSkge1xuICAgICAgdGhpcy4kc2V0RGlydHkoKTtcbiAgICB9XG4gICAgdGhpcy4kJHBhcnNlQW5kVmFsaWRhdGUoKTtcbiAgfTtcblxuICB0aGlzLiQkcGFyc2VBbmRWYWxpZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB2aWV3VmFsdWUgPSBjdHJsLiQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZTtcbiAgICB2YXIgbW9kZWxWYWx1ZSA9IHZpZXdWYWx1ZTtcbiAgICBwYXJzZXJWYWxpZCA9IGlzVW5kZWZpbmVkKG1vZGVsVmFsdWUpID8gdW5kZWZpbmVkIDogdHJ1ZTtcblxuICAgIGlmIChwYXJzZXJWYWxpZCkge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjdHJsLiRwYXJzZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIG1vZGVsVmFsdWUgPSBjdHJsLiRwYXJzZXJzW2ldKG1vZGVsVmFsdWUpO1xuICAgICAgICBpZiAoaXNVbmRlZmluZWQobW9kZWxWYWx1ZSkpIHtcbiAgICAgICAgICBwYXJzZXJWYWxpZCA9IGZhbHNlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChpc051bWJlcihjdHJsLiRtb2RlbFZhbHVlKSAmJiBpc05hTihjdHJsLiRtb2RlbFZhbHVlKSkge1xuICAgICAgLy8gY3RybC4kbW9kZWxWYWx1ZSBoYXMgbm90IGJlZW4gdG91Y2hlZCB5ZXQuLi5cbiAgICAgIGN0cmwuJG1vZGVsVmFsdWUgPSBuZ01vZGVsR2V0KCRzY29wZSk7XG4gICAgfVxuICAgIHZhciBwcmV2TW9kZWxWYWx1ZSA9IGN0cmwuJG1vZGVsVmFsdWU7XG4gICAgdmFyIGFsbG93SW52YWxpZCA9IGN0cmwuJG9wdGlvbnMgJiYgY3RybC4kb3B0aW9ucy5hbGxvd0ludmFsaWQ7XG4gICAgY3RybC4kJHJhd01vZGVsVmFsdWUgPSBtb2RlbFZhbHVlO1xuXG4gICAgaWYgKGFsbG93SW52YWxpZCkge1xuICAgICAgY3RybC4kbW9kZWxWYWx1ZSA9IG1vZGVsVmFsdWU7XG4gICAgICB3cml0ZVRvTW9kZWxJZk5lZWRlZCgpO1xuICAgIH1cblxuICAgIC8vIFBhc3MgdGhlICQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZSBoZXJlLCBiZWNhdXNlIHRoZSBjYWNoZWQgdmlld1ZhbHVlIG1pZ2h0IGJlIG91dCBvZiBkYXRlLlxuICAgIC8vIFRoaXMgY2FuIGhhcHBlbiBpZiBlLmcuICRzZXRWaWV3VmFsdWUgaXMgY2FsbGVkIGZyb20gaW5zaWRlIGEgcGFyc2VyXG4gICAgY3RybC4kJHJ1blZhbGlkYXRvcnMobW9kZWxWYWx1ZSwgY3RybC4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUsIGZ1bmN0aW9uKGFsbFZhbGlkKSB7XG4gICAgICBpZiAoIWFsbG93SW52YWxpZCkge1xuICAgICAgICAvLyBOb3RlOiBEb24ndCBjaGVjayBjdHJsLiR2YWxpZCBoZXJlLCBhcyB3ZSBjb3VsZCBoYXZlXG4gICAgICAgIC8vIGV4dGVybmFsIHZhbGlkYXRvcnMgKGUuZy4gY2FsY3VsYXRlZCBvbiB0aGUgc2VydmVyKSxcbiAgICAgICAgLy8gdGhhdCBqdXN0IGNhbGwgJHNldFZhbGlkaXR5IGFuZCBuZWVkIHRoZSBtb2RlbCB2YWx1ZVxuICAgICAgICAvLyB0byBjYWxjdWxhdGUgdGhlaXIgdmFsaWRpdHkuXG4gICAgICAgIGN0cmwuJG1vZGVsVmFsdWUgPSBhbGxWYWxpZCA/IG1vZGVsVmFsdWUgOiB1bmRlZmluZWQ7XG4gICAgICAgIHdyaXRlVG9Nb2RlbElmTmVlZGVkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiB3cml0ZVRvTW9kZWxJZk5lZWRlZCgpIHtcbiAgICAgIGlmIChjdHJsLiRtb2RlbFZhbHVlICE9PSBwcmV2TW9kZWxWYWx1ZSkge1xuICAgICAgICBjdHJsLiQkd3JpdGVNb2RlbFRvU2NvcGUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgdGhpcy4kJHdyaXRlTW9kZWxUb1Njb3BlID0gZnVuY3Rpb24oKSB7XG4gICAgbmdNb2RlbFNldCgkc2NvcGUsIGN0cmwuJG1vZGVsVmFsdWUpO1xuICAgIGZvckVhY2goY3RybC4kdmlld0NoYW5nZUxpc3RlbmVycywgZnVuY3Rpb24obGlzdGVuZXIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGxpc3RlbmVyKCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICRleGNlcHRpb25IYW5kbGVyKGUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHNldFZpZXdWYWx1ZVxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogVXBkYXRlIHRoZSB2aWV3IHZhbHVlLlxuICAgKlxuICAgKiBUaGlzIG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYSBjb250cm9sIHdhbnRzIHRvIGNoYW5nZSB0aGUgdmlldyB2YWx1ZTsgdHlwaWNhbGx5LFxuICAgKiB0aGlzIGlzIGRvbmUgZnJvbSB3aXRoaW4gYSBET00gZXZlbnQgaGFuZGxlci4gRm9yIGV4YW1wbGUsIHRoZSB7QGxpbmsgbmcuZGlyZWN0aXZlOmlucHV0IGlucHV0fVxuICAgKiBkaXJlY3RpdmUgY2FsbHMgaXQgd2hlbiB0aGUgdmFsdWUgb2YgdGhlIGlucHV0IGNoYW5nZXMgYW5kIHtAbGluayBuZy5kaXJlY3RpdmU6c2VsZWN0IHNlbGVjdH1cbiAgICogY2FsbHMgaXQgd2hlbiBhbiBvcHRpb24gaXMgc2VsZWN0ZWQuXG4gICAqXG4gICAqIFdoZW4gYCRzZXRWaWV3VmFsdWVgIGlzIGNhbGxlZCwgdGhlIG5ldyBgdmFsdWVgIHdpbGwgYmUgc3RhZ2VkIGZvciBjb21taXR0aW5nIHRocm91Z2ggdGhlIGAkcGFyc2Vyc2BcbiAgICogYW5kIGAkdmFsaWRhdG9yc2AgcGlwZWxpbmVzLiBJZiB0aGVyZSBhcmUgbm8gc3BlY2lhbCB7QGxpbmsgbmdNb2RlbE9wdGlvbnN9IHNwZWNpZmllZCB0aGVuIHRoZSBzdGFnZWRcbiAgICogdmFsdWUgc2VudCBkaXJlY3RseSBmb3IgcHJvY2Vzc2luZywgZmluYWxseSB0byBiZSBhcHBsaWVkIHRvIGAkbW9kZWxWYWx1ZWAgYW5kIHRoZW4gdGhlXG4gICAqICoqZXhwcmVzc2lvbioqIHNwZWNpZmllZCBpbiB0aGUgYG5nLW1vZGVsYCBhdHRyaWJ1dGUuIExhc3RseSwgYWxsIHRoZSByZWdpc3RlcmVkIGNoYW5nZSBsaXN0ZW5lcnMsXG4gICAqIGluIHRoZSBgJHZpZXdDaGFuZ2VMaXN0ZW5lcnNgIGxpc3QsIGFyZSBjYWxsZWQuXG4gICAqXG4gICAqIEluIGNhc2UgdGhlIHtAbGluayBuZy5kaXJlY3RpdmU6bmdNb2RlbE9wdGlvbnMgbmdNb2RlbE9wdGlvbnN9IGRpcmVjdGl2ZSBpcyB1c2VkIHdpdGggYHVwZGF0ZU9uYFxuICAgKiBhbmQgdGhlIGBkZWZhdWx0YCB0cmlnZ2VyIGlzIG5vdCBsaXN0ZWQsIGFsbCB0aG9zZSBhY3Rpb25zIHdpbGwgcmVtYWluIHBlbmRpbmcgdW50aWwgb25lIG9mIHRoZVxuICAgKiBgdXBkYXRlT25gIGV2ZW50cyBpcyB0cmlnZ2VyZWQgb24gdGhlIERPTSBlbGVtZW50LlxuICAgKiBBbGwgdGhlc2UgYWN0aW9ucyB3aWxsIGJlIGRlYm91bmNlZCBpZiB0aGUge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ01vZGVsT3B0aW9ucyBuZ01vZGVsT3B0aW9uc31cbiAgICogZGlyZWN0aXZlIGlzIHVzZWQgd2l0aCBhIGN1c3RvbSBkZWJvdW5jZSBmb3IgdGhpcyBwYXJ0aWN1bGFyIGV2ZW50LlxuICAgKiBOb3RlIHRoYXQgYSBgJGRpZ2VzdGAgaXMgb25seSB0cmlnZ2VyZWQgb25jZSB0aGUgYHVwZGF0ZU9uYCBldmVudHMgYXJlIGZpcmVkLCBvciBpZiBgZGVib3VuY2VgXG4gICAqIGlzIHNwZWNpZmllZCwgb25jZSB0aGUgdGltZXIgcnVucyBvdXQuXG4gICAqXG4gICAqIFdoZW4gdXNlZCB3aXRoIHN0YW5kYXJkIGlucHV0cywgdGhlIHZpZXcgdmFsdWUgd2lsbCBhbHdheXMgYmUgYSBzdHJpbmcgKHdoaWNoIGlzIGluIHNvbWUgY2FzZXNcbiAgICogcGFyc2VkIGludG8gYW5vdGhlciB0eXBlLCBzdWNoIGFzIGEgYERhdGVgIG9iamVjdCBmb3IgYGlucHV0W2RhdGVdYC4pXG4gICAqIEhvd2V2ZXIsIGN1c3RvbSBjb250cm9scyBtaWdodCBhbHNvIHBhc3Mgb2JqZWN0cyB0byB0aGlzIG1ldGhvZC4gSW4gdGhpcyBjYXNlLCB3ZSBzaG91bGQgbWFrZVxuICAgKiBhIGNvcHkgb2YgdGhlIG9iamVjdCBiZWZvcmUgcGFzc2luZyBpdCB0byBgJHNldFZpZXdWYWx1ZWAuIFRoaXMgaXMgYmVjYXVzZSBgbmdNb2RlbGAgZG9lcyBub3RcbiAgICogcGVyZm9ybSBhIGRlZXAgd2F0Y2ggb2Ygb2JqZWN0cywgaXQgb25seSBsb29rcyBmb3IgYSBjaGFuZ2Ugb2YgaWRlbnRpdHkuIElmIHlvdSBvbmx5IGNoYW5nZVxuICAgKiB0aGUgcHJvcGVydHkgb2YgdGhlIG9iamVjdCB0aGVuIG5nTW9kZWwgd2lsbCBub3QgcmVhbGl6ZSB0aGF0IHRoZSBvYmplY3QgaGFzIGNoYW5nZWQgYW5kXG4gICAqIHdpbGwgbm90IGludm9rZSB0aGUgYCRwYXJzZXJzYCBhbmQgYCR2YWxpZGF0b3JzYCBwaXBlbGluZXMuIEZvciB0aGlzIHJlYXNvbiwgeW91IHNob3VsZFxuICAgKiBub3QgY2hhbmdlIHByb3BlcnRpZXMgb2YgdGhlIGNvcHkgb25jZSBpdCBoYXMgYmVlbiBwYXNzZWQgdG8gYCRzZXRWaWV3VmFsdWVgLlxuICAgKiBPdGhlcndpc2UgeW91IG1heSBjYXVzZSB0aGUgbW9kZWwgdmFsdWUgb24gdGhlIHNjb3BlIHRvIGNoYW5nZSBpbmNvcnJlY3RseS5cbiAgICpcbiAgICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWluZm9cIj5cbiAgICogSW4gYW55IGNhc2UsIHRoZSB2YWx1ZSBwYXNzZWQgdG8gdGhlIG1ldGhvZCBzaG91bGQgYWx3YXlzIHJlZmxlY3QgdGhlIGN1cnJlbnQgdmFsdWVcbiAgICogb2YgdGhlIGNvbnRyb2wuIEZvciBleGFtcGxlLCBpZiB5b3UgYXJlIGNhbGxpbmcgYCRzZXRWaWV3VmFsdWVgIGZvciBhbiBpbnB1dCBlbGVtZW50LFxuICAgKiB5b3Ugc2hvdWxkIHBhc3MgdGhlIGlucHV0IERPTSB2YWx1ZS4gT3RoZXJ3aXNlLCB0aGUgY29udHJvbCBhbmQgdGhlIHNjb3BlIG1vZGVsIGJlY29tZVxuICAgKiBvdXQgb2Ygc3luYy4gSXQncyBhbHNvIGltcG9ydGFudCB0byBub3RlIHRoYXQgYCRzZXRWaWV3VmFsdWVgIGRvZXMgbm90IGNhbGwgYCRyZW5kZXJgIG9yIGNoYW5nZVxuICAgKiB0aGUgY29udHJvbCdzIERPTSB2YWx1ZSBpbiBhbnkgd2F5LiBJZiB3ZSB3YW50IHRvIGNoYW5nZSB0aGUgY29udHJvbCdzIERPTSB2YWx1ZVxuICAgKiBwcm9ncmFtbWF0aWNhbGx5LCB3ZSBzaG91bGQgdXBkYXRlIHRoZSBgbmdNb2RlbGAgc2NvcGUgZXhwcmVzc2lvbi4gSXRzIG5ldyB2YWx1ZSB3aWxsIGJlXG4gICAqIHBpY2tlZCB1cCBieSB0aGUgbW9kZWwgY29udHJvbGxlciwgd2hpY2ggd2lsbCBydW4gaXQgdGhyb3VnaCB0aGUgYCRmb3JtYXR0ZXJzYCwgYCRyZW5kZXJgIGl0XG4gICAqIHRvIHVwZGF0ZSB0aGUgRE9NLCBhbmQgZmluYWxseSBjYWxsIGAkdmFsaWRhdGVgIG9uIGl0LlxuICAgKiA8L2Rpdj5cbiAgICpcbiAgICogQHBhcmFtIHsqfSB2YWx1ZSB2YWx1ZSBmcm9tIHRoZSB2aWV3LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHJpZ2dlciBFdmVudCB0aGF0IHRyaWdnZXJlZCB0aGUgdXBkYXRlLlxuICAgKi9cbiAgdGhpcy4kc2V0Vmlld1ZhbHVlID0gZnVuY3Rpb24odmFsdWUsIHRyaWdnZXIpIHtcbiAgICBjdHJsLiR2aWV3VmFsdWUgPSB2YWx1ZTtcbiAgICBpZiAoIWN0cmwuJG9wdGlvbnMgfHwgY3RybC4kb3B0aW9ucy51cGRhdGVPbkRlZmF1bHQpIHtcbiAgICAgIGN0cmwuJCRkZWJvdW5jZVZpZXdWYWx1ZUNvbW1pdCh0cmlnZ2VyKTtcbiAgICB9XG4gIH07XG5cbiAgdGhpcy4kJGRlYm91bmNlVmlld1ZhbHVlQ29tbWl0ID0gZnVuY3Rpb24odHJpZ2dlcikge1xuICAgIHZhciBkZWJvdW5jZURlbGF5ID0gMCxcbiAgICAgICAgb3B0aW9ucyA9IGN0cmwuJG9wdGlvbnMsXG4gICAgICAgIGRlYm91bmNlO1xuXG4gICAgaWYgKG9wdGlvbnMgJiYgaXNEZWZpbmVkKG9wdGlvbnMuZGVib3VuY2UpKSB7XG4gICAgICBkZWJvdW5jZSA9IG9wdGlvbnMuZGVib3VuY2U7XG4gICAgICBpZiAoaXNOdW1iZXIoZGVib3VuY2UpKSB7XG4gICAgICAgIGRlYm91bmNlRGVsYXkgPSBkZWJvdW5jZTtcbiAgICAgIH0gZWxzZSBpZiAoaXNOdW1iZXIoZGVib3VuY2VbdHJpZ2dlcl0pKSB7XG4gICAgICAgIGRlYm91bmNlRGVsYXkgPSBkZWJvdW5jZVt0cmlnZ2VyXTtcbiAgICAgIH0gZWxzZSBpZiAoaXNOdW1iZXIoZGVib3VuY2VbJ2RlZmF1bHQnXSkpIHtcbiAgICAgICAgZGVib3VuY2VEZWxheSA9IGRlYm91bmNlWydkZWZhdWx0J107XG4gICAgICB9XG4gICAgfVxuXG4gICAgJHRpbWVvdXQuY2FuY2VsKHBlbmRpbmdEZWJvdW5jZSk7XG4gICAgaWYgKGRlYm91bmNlRGVsYXkpIHtcbiAgICAgIHBlbmRpbmdEZWJvdW5jZSA9ICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBjdHJsLiRjb21taXRWaWV3VmFsdWUoKTtcbiAgICAgIH0sIGRlYm91bmNlRGVsYXkpO1xuICAgIH0gZWxzZSBpZiAoJHJvb3RTY29wZS4kJHBoYXNlKSB7XG4gICAgICBjdHJsLiRjb21taXRWaWV3VmFsdWUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICAgY3RybC4kY29tbWl0Vmlld1ZhbHVlKCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgLy8gbW9kZWwgLT4gdmFsdWVcbiAgLy8gTm90ZTogd2UgY2Fubm90IHVzZSBhIG5vcm1hbCBzY29wZS4kd2F0Y2ggYXMgd2Ugd2FudCB0byBkZXRlY3QgdGhlIGZvbGxvd2luZzpcbiAgLy8gMS4gc2NvcGUgdmFsdWUgaXMgJ2EnXG4gIC8vIDIuIHVzZXIgZW50ZXJzICdiJ1xuICAvLyAzLiBuZy1jaGFuZ2Uga2lja3MgaW4gYW5kIHJldmVydHMgc2NvcGUgdmFsdWUgdG8gJ2EnXG4gIC8vICAgIC0+IHNjb3BlIHZhbHVlIGRpZCBub3QgY2hhbmdlIHNpbmNlIHRoZSBsYXN0IGRpZ2VzdCBhc1xuICAvLyAgICAgICBuZy1jaGFuZ2UgZXhlY3V0ZXMgaW4gYXBwbHkgcGhhc2VcbiAgLy8gNC4gdmlldyBzaG91bGQgYmUgY2hhbmdlZCBiYWNrIHRvICdhJ1xuICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uIG5nTW9kZWxXYXRjaCgpIHtcbiAgICB2YXIgbW9kZWxWYWx1ZSA9IG5nTW9kZWxHZXQoJHNjb3BlKTtcblxuICAgIC8vIGlmIHNjb3BlIG1vZGVsIHZhbHVlIGFuZCBuZ01vZGVsIHZhbHVlIGFyZSBvdXQgb2Ygc3luY1xuICAgIC8vIFRPRE8ocGVyZik6IHdoeSBub3QgbW92ZSB0aGlzIHRvIHRoZSBhY3Rpb24gZm4/XG4gICAgaWYgKG1vZGVsVmFsdWUgIT09IGN0cmwuJG1vZGVsVmFsdWUgJiZcbiAgICAgICAvLyBjaGVja3MgZm9yIE5hTiBpcyBuZWVkZWQgdG8gYWxsb3cgc2V0dGluZyB0aGUgbW9kZWwgdG8gTmFOIHdoZW4gdGhlcmUncyBhbiBhc3luY1ZhbGlkYXRvclxuICAgICAgIChjdHJsLiRtb2RlbFZhbHVlID09PSBjdHJsLiRtb2RlbFZhbHVlIHx8IG1vZGVsVmFsdWUgPT09IG1vZGVsVmFsdWUpXG4gICAgKSB7XG4gICAgICBjdHJsLiRtb2RlbFZhbHVlID0gY3RybC4kJHJhd01vZGVsVmFsdWUgPSBtb2RlbFZhbHVlO1xuICAgICAgcGFyc2VyVmFsaWQgPSB1bmRlZmluZWQ7XG5cbiAgICAgIHZhciBmb3JtYXR0ZXJzID0gY3RybC4kZm9ybWF0dGVycyxcbiAgICAgICAgICBpZHggPSBmb3JtYXR0ZXJzLmxlbmd0aDtcblxuICAgICAgdmFyIHZpZXdWYWx1ZSA9IG1vZGVsVmFsdWU7XG4gICAgICB3aGlsZSAoaWR4LS0pIHtcbiAgICAgICAgdmlld1ZhbHVlID0gZm9ybWF0dGVyc1tpZHhdKHZpZXdWYWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAoY3RybC4kdmlld1ZhbHVlICE9PSB2aWV3VmFsdWUpIHtcbiAgICAgICAgY3RybC4kJHVwZGF0ZUVtcHR5Q2xhc3Nlcyh2aWV3VmFsdWUpO1xuICAgICAgICBjdHJsLiR2aWV3VmFsdWUgPSBjdHJsLiQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZSA9IHZpZXdWYWx1ZTtcbiAgICAgICAgY3RybC4kcmVuZGVyKCk7XG5cbiAgICAgICAgY3RybC4kJHJ1blZhbGlkYXRvcnMobW9kZWxWYWx1ZSwgdmlld1ZhbHVlLCBub29wKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbW9kZWxWYWx1ZTtcbiAgfSk7XG59XTtcblxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nTW9kZWxcbiAqXG4gKiBAZWxlbWVudCBpbnB1dFxuICogQHByaW9yaXR5IDFcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBgbmdNb2RlbGAgZGlyZWN0aXZlIGJpbmRzIGFuIGBpbnB1dGAsYHNlbGVjdGAsIGB0ZXh0YXJlYWAgKG9yIGN1c3RvbSBmb3JtIGNvbnRyb2wpIHRvIGFcbiAqIHByb3BlcnR5IG9uIHRoZSBzY29wZSB1c2luZyB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciBOZ01vZGVsQ29udHJvbGxlcn0sXG4gKiB3aGljaCBpcyBjcmVhdGVkIGFuZCBleHBvc2VkIGJ5IHRoaXMgZGlyZWN0aXZlLlxuICpcbiAqIGBuZ01vZGVsYCBpcyByZXNwb25zaWJsZSBmb3I6XG4gKlxuICogLSBCaW5kaW5nIHRoZSB2aWV3IGludG8gdGhlIG1vZGVsLCB3aGljaCBvdGhlciBkaXJlY3RpdmVzIHN1Y2ggYXMgYGlucHV0YCwgYHRleHRhcmVhYCBvciBgc2VsZWN0YFxuICogICByZXF1aXJlLlxuICogLSBQcm92aWRpbmcgdmFsaWRhdGlvbiBiZWhhdmlvciAoaS5lLiByZXF1aXJlZCwgbnVtYmVyLCBlbWFpbCwgdXJsKS5cbiAqIC0gS2VlcGluZyB0aGUgc3RhdGUgb2YgdGhlIGNvbnRyb2wgKHZhbGlkL2ludmFsaWQsIGRpcnR5L3ByaXN0aW5lLCB0b3VjaGVkL3VudG91Y2hlZCwgdmFsaWRhdGlvbiBlcnJvcnMpLlxuICogLSBTZXR0aW5nIHJlbGF0ZWQgY3NzIGNsYXNzZXMgb24gdGhlIGVsZW1lbnQgKGBuZy12YWxpZGAsIGBuZy1pbnZhbGlkYCwgYG5nLWRpcnR5YCwgYG5nLXByaXN0aW5lYCwgYG5nLXRvdWNoZWRgLFxuICogICBgbmctdW50b3VjaGVkYCwgYG5nLWVtcHR5YCwgYG5nLW5vdC1lbXB0eWApIGluY2x1ZGluZyBhbmltYXRpb25zLlxuICogLSBSZWdpc3RlcmluZyB0aGUgY29udHJvbCB3aXRoIGl0cyBwYXJlbnQge0BsaW5rIG5nLmRpcmVjdGl2ZTpmb3JtIGZvcm19LlxuICpcbiAqIE5vdGU6IGBuZ01vZGVsYCB3aWxsIHRyeSB0byBiaW5kIHRvIHRoZSBwcm9wZXJ0eSBnaXZlbiBieSBldmFsdWF0aW5nIHRoZSBleHByZXNzaW9uIG9uIHRoZVxuICogY3VycmVudCBzY29wZS4gSWYgdGhlIHByb3BlcnR5IGRvZXNuJ3QgYWxyZWFkeSBleGlzdCBvbiB0aGlzIHNjb3BlLCBpdCB3aWxsIGJlIGNyZWF0ZWRcbiAqIGltcGxpY2l0bHkgYW5kIGFkZGVkIHRvIHRoZSBzY29wZS5cbiAqXG4gKiBGb3IgYmVzdCBwcmFjdGljZXMgb24gdXNpbmcgYG5nTW9kZWxgLCBzZWU6XG4gKlxuICogIC0gW1VuZGVyc3RhbmRpbmcgU2NvcGVzXShodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL3dpa2kvVW5kZXJzdGFuZGluZy1TY29wZXMpXG4gKlxuICogRm9yIGJhc2ljIGV4YW1wbGVzLCBob3cgdG8gdXNlIGBuZ01vZGVsYCwgc2VlOlxuICpcbiAqICAtIHtAbGluayBuZy5kaXJlY3RpdmU6aW5wdXQgaW5wdXR9XG4gKiAgICAtIHtAbGluayBpbnB1dFt0ZXh0XSB0ZXh0fVxuICogICAgLSB7QGxpbmsgaW5wdXRbY2hlY2tib3hdIGNoZWNrYm94fVxuICogICAgLSB7QGxpbmsgaW5wdXRbcmFkaW9dIHJhZGlvfVxuICogICAgLSB7QGxpbmsgaW5wdXRbbnVtYmVyXSBudW1iZXJ9XG4gKiAgICAtIHtAbGluayBpbnB1dFtlbWFpbF0gZW1haWx9XG4gKiAgICAtIHtAbGluayBpbnB1dFt1cmxdIHVybH1cbiAqICAgIC0ge0BsaW5rIGlucHV0W2RhdGVdIGRhdGV9XG4gKiAgICAtIHtAbGluayBpbnB1dFtkYXRldGltZS1sb2NhbF0gZGF0ZXRpbWUtbG9jYWx9XG4gKiAgICAtIHtAbGluayBpbnB1dFt0aW1lXSB0aW1lfVxuICogICAgLSB7QGxpbmsgaW5wdXRbbW9udGhdIG1vbnRofVxuICogICAgLSB7QGxpbmsgaW5wdXRbd2Vla10gd2Vla31cbiAqICAtIHtAbGluayBuZy5kaXJlY3RpdmU6c2VsZWN0IHNlbGVjdH1cbiAqICAtIHtAbGluayBuZy5kaXJlY3RpdmU6dGV4dGFyZWEgdGV4dGFyZWF9XG4gKlxuICogIyBDb21wbGV4IE1vZGVscyAob2JqZWN0cyBvciBjb2xsZWN0aW9ucylcbiAqXG4gKiBCeSBkZWZhdWx0LCBgbmdNb2RlbGAgd2F0Y2hlcyB0aGUgbW9kZWwgYnkgcmVmZXJlbmNlLCBub3QgdmFsdWUuIFRoaXMgaXMgaW1wb3J0YW50IHRvIGtub3cgd2hlblxuICogYmluZGluZyBpbnB1dHMgdG8gbW9kZWxzIHRoYXQgYXJlIG9iamVjdHMgKGUuZy4gYERhdGVgKSBvciBjb2xsZWN0aW9ucyAoZS5nLiBhcnJheXMpLiBJZiBvbmx5IHByb3BlcnRpZXMgb2YgdGhlXG4gKiBvYmplY3Qgb3IgY29sbGVjdGlvbiBjaGFuZ2UsIGBuZ01vZGVsYCB3aWxsIG5vdCBiZSBub3RpZmllZCBhbmQgc28gdGhlIGlucHV0IHdpbGwgbm90IGJlICByZS1yZW5kZXJlZC5cbiAqXG4gKiBUaGUgbW9kZWwgbXVzdCBiZSBhc3NpZ25lZCBhbiBlbnRpcmVseSBuZXcgb2JqZWN0IG9yIGNvbGxlY3Rpb24gYmVmb3JlIGEgcmUtcmVuZGVyaW5nIHdpbGwgb2NjdXIuXG4gKlxuICogU29tZSBkaXJlY3RpdmVzIGhhdmUgb3B0aW9ucyB0aGF0IHdpbGwgY2F1c2UgdGhlbSB0byB1c2UgYSBjdXN0b20gYCR3YXRjaENvbGxlY3Rpb25gIG9uIHRoZSBtb2RlbCBleHByZXNzaW9uXG4gKiAtIGZvciBleGFtcGxlLCBgbmdPcHRpb25zYCB3aWxsIGRvIHNvIHdoZW4gYSBgdHJhY2sgYnlgIGNsYXVzZSBpcyBpbmNsdWRlZCBpbiB0aGUgY29tcHJlaGVuc2lvbiBleHByZXNzaW9uIG9yXG4gKiBpZiB0aGUgc2VsZWN0IGlzIGdpdmVuIHRoZSBgbXVsdGlwbGVgIGF0dHJpYnV0ZS5cbiAqXG4gKiBUaGUgYCR3YXRjaENvbGxlY3Rpb24oKWAgbWV0aG9kIG9ubHkgZG9lcyBhIHNoYWxsb3cgY29tcGFyaXNvbiwgbWVhbmluZyB0aGF0IGNoYW5naW5nIHByb3BlcnRpZXMgZGVlcGVyIHRoYW4gdGhlXG4gKiBmaXJzdCBsZXZlbCBvZiB0aGUgb2JqZWN0IChvciBvbmx5IGNoYW5naW5nIHRoZSBwcm9wZXJ0aWVzIG9mIGFuIGl0ZW0gaW4gdGhlIGNvbGxlY3Rpb24gaWYgaXQncyBhbiBhcnJheSkgd2lsbCBzdGlsbFxuICogbm90IHRyaWdnZXIgYSByZS1yZW5kZXJpbmcgb2YgdGhlIG1vZGVsLlxuICpcbiAqICMgQ1NTIGNsYXNzZXNcbiAqIFRoZSBmb2xsb3dpbmcgQ1NTIGNsYXNzZXMgYXJlIGFkZGVkIGFuZCByZW1vdmVkIG9uIHRoZSBhc3NvY2lhdGVkIGlucHV0L3NlbGVjdC90ZXh0YXJlYSBlbGVtZW50XG4gKiBkZXBlbmRpbmcgb24gdGhlIHZhbGlkaXR5IG9mIHRoZSBtb2RlbC5cbiAqXG4gKiAgLSBgbmctdmFsaWRgOiB0aGUgbW9kZWwgaXMgdmFsaWRcbiAqICAtIGBuZy1pbnZhbGlkYDogdGhlIG1vZGVsIGlzIGludmFsaWRcbiAqICAtIGBuZy12YWxpZC1ba2V5XWA6IGZvciBlYWNoIHZhbGlkIGtleSBhZGRlZCBieSBgJHNldFZhbGlkaXR5YFxuICogIC0gYG5nLWludmFsaWQtW2tleV1gOiBmb3IgZWFjaCBpbnZhbGlkIGtleSBhZGRlZCBieSBgJHNldFZhbGlkaXR5YFxuICogIC0gYG5nLXByaXN0aW5lYDogdGhlIGNvbnRyb2wgaGFzbid0IGJlZW4gaW50ZXJhY3RlZCB3aXRoIHlldFxuICogIC0gYG5nLWRpcnR5YDogdGhlIGNvbnRyb2wgaGFzIGJlZW4gaW50ZXJhY3RlZCB3aXRoXG4gKiAgLSBgbmctdG91Y2hlZGA6IHRoZSBjb250cm9sIGhhcyBiZWVuIGJsdXJyZWRcbiAqICAtIGBuZy11bnRvdWNoZWRgOiB0aGUgY29udHJvbCBoYXNuJ3QgYmVlbiBibHVycmVkXG4gKiAgLSBgbmctcGVuZGluZ2A6IGFueSBgJGFzeW5jVmFsaWRhdG9yc2AgYXJlIHVuZnVsZmlsbGVkXG4gKiAgLSBgbmctZW1wdHlgOiB0aGUgdmlldyBkb2VzIG5vdCBjb250YWluIGEgdmFsdWUgb3IgdGhlIHZhbHVlIGlzIGRlZW1lZCBcImVtcHR5XCIsIGFzIGRlZmluZWRcbiAqICAgICBieSB0aGUge0BsaW5rIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJGlzRW1wdHl9IG1ldGhvZFxuICogIC0gYG5nLW5vdC1lbXB0eWA6IHRoZSB2aWV3IGNvbnRhaW5zIGEgbm9uLWVtcHR5IHZhbHVlXG4gKlxuICogS2VlcCBpbiBtaW5kIHRoYXQgbmdBbmltYXRlIGNhbiBkZXRlY3QgZWFjaCBvZiB0aGVzZSBjbGFzc2VzIHdoZW4gYWRkZWQgYW5kIHJlbW92ZWQuXG4gKlxuICogIyMgQW5pbWF0aW9uIEhvb2tzXG4gKlxuICogQW5pbWF0aW9ucyB3aXRoaW4gbW9kZWxzIGFyZSB0cmlnZ2VyZWQgd2hlbiBhbnkgb2YgdGhlIGFzc29jaWF0ZWQgQ1NTIGNsYXNzZXMgYXJlIGFkZGVkIGFuZCByZW1vdmVkXG4gKiBvbiB0aGUgaW5wdXQgZWxlbWVudCB3aGljaCBpcyBhdHRhY2hlZCB0byB0aGUgbW9kZWwuIFRoZXNlIGNsYXNzZXMgaW5jbHVkZTogYC5uZy1wcmlzdGluZWAsIGAubmctZGlydHlgLFxuICogYC5uZy1pbnZhbGlkYCBhbmQgYC5uZy12YWxpZGAgYXMgd2VsbCBhcyBhbnkgb3RoZXIgdmFsaWRhdGlvbnMgdGhhdCBhcmUgcGVyZm9ybWVkIG9uIHRoZSBtb2RlbCBpdHNlbGYuXG4gKiBUaGUgYW5pbWF0aW9ucyB0aGF0IGFyZSB0cmlnZ2VyZWQgd2l0aGluIG5nTW9kZWwgYXJlIHNpbWlsYXIgdG8gaG93IHRoZXkgd29yayBpbiBuZ0NsYXNzIGFuZFxuICogYW5pbWF0aW9ucyBjYW4gYmUgaG9va2VkIGludG8gdXNpbmcgQ1NTIHRyYW5zaXRpb25zLCBrZXlmcmFtZXMgYXMgd2VsbCBhcyBKUyBhbmltYXRpb25zLlxuICpcbiAqIFRoZSBmb2xsb3dpbmcgZXhhbXBsZSBzaG93cyBhIHNpbXBsZSB3YXkgdG8gdXRpbGl6ZSBDU1MgdHJhbnNpdGlvbnMgdG8gc3R5bGUgYW4gaW5wdXQgZWxlbWVudFxuICogdGhhdCBoYXMgYmVlbiByZW5kZXJlZCBhcyBpbnZhbGlkIGFmdGVyIGl0IGhhcyBiZWVuIHZhbGlkYXRlZDpcbiAqXG4gKiA8cHJlPlxuICogLy9iZSBzdXJlIHRvIGluY2x1ZGUgbmdBbmltYXRlIGFzIGEgbW9kdWxlIHRvIGhvb2sgaW50byBtb3JlXG4gKiAvL2FkdmFuY2VkIGFuaW1hdGlvbnNcbiAqIC5teS1pbnB1dCB7XG4gKiAgIHRyYW5zaXRpb246MC41cyBsaW5lYXIgYWxsO1xuICogICBiYWNrZ3JvdW5kOiB3aGl0ZTtcbiAqIH1cbiAqIC5teS1pbnB1dC5uZy1pbnZhbGlkIHtcbiAqICAgYmFja2dyb3VuZDogcmVkO1xuICogICBjb2xvcjp3aGl0ZTtcbiAqIH1cbiAqIDwvcHJlPlxuICpcbiAqIEBleGFtcGxlXG4gKiA8ZXhhbXBsZSBkZXBzPVwiYW5ndWxhci1hbmltYXRlLmpzXCIgYW5pbWF0aW9ucz1cInRydWVcIiBmaXhCYXNlPVwidHJ1ZVwiIG1vZHVsZT1cImlucHV0RXhhbXBsZVwiPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxzY3JpcHQ+XG4gICAgICAgIGFuZ3VsYXIubW9kdWxlKCdpbnB1dEV4YW1wbGUnLCBbXSlcbiAgICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAgICAgJHNjb3BlLnZhbCA9ICcxJztcbiAgICAgICAgICB9XSk7XG4gICAgICAgPC9zY3JpcHQ+XG4gICAgICAgPHN0eWxlPlxuICAgICAgICAgLm15LWlucHV0IHtcbiAgICAgICAgICAgdHJhbnNpdGlvbjphbGwgbGluZWFyIDAuNXM7XG4gICAgICAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xuICAgICAgICAgfVxuICAgICAgICAgLm15LWlucHV0Lm5nLWludmFsaWQge1xuICAgICAgICAgICBjb2xvcjp3aGl0ZTtcbiAgICAgICAgICAgYmFja2dyb3VuZDogcmVkO1xuICAgICAgICAgfVxuICAgICAgIDwvc3R5bGU+XG4gICAgICAgPHAgaWQ9XCJpbnB1dERlc2NyaXB0aW9uXCI+XG4gICAgICAgIFVwZGF0ZSBpbnB1dCB0byBzZWUgdHJhbnNpdGlvbnMgd2hlbiB2YWxpZC9pbnZhbGlkLlxuICAgICAgICBJbnRlZ2VyIGlzIGEgdmFsaWQgdmFsdWUuXG4gICAgICAgPC9wPlxuICAgICAgIDxmb3JtIG5hbWU9XCJ0ZXN0Rm9ybVwiIG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICAgICAgPGlucHV0IG5nLW1vZGVsPVwidmFsXCIgbmctcGF0dGVybj1cIi9eXFxkKyQvXCIgbmFtZT1cImFuaW1cIiBjbGFzcz1cIm15LWlucHV0XCJcbiAgICAgICAgICAgICAgICBhcmlhLWRlc2NyaWJlZGJ5PVwiaW5wdXREZXNjcmlwdGlvblwiIC8+XG4gICAgICAgPC9mb3JtPlxuICAgICA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICogIyMgQmluZGluZyB0byBhIGdldHRlci9zZXR0ZXJcbiAqXG4gKiBTb21ldGltZXMgaXQncyBoZWxwZnVsIHRvIGJpbmQgYG5nTW9kZWxgIHRvIGEgZ2V0dGVyL3NldHRlciBmdW5jdGlvbi4gIEEgZ2V0dGVyL3NldHRlciBpcyBhXG4gKiBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSByZXByZXNlbnRhdGlvbiBvZiB0aGUgbW9kZWwgd2hlbiBjYWxsZWQgd2l0aCB6ZXJvIGFyZ3VtZW50cywgYW5kIHNldHNcbiAqIHRoZSBpbnRlcm5hbCBzdGF0ZSBvZiBhIG1vZGVsIHdoZW4gY2FsbGVkIHdpdGggYW4gYXJndW1lbnQuIEl0J3Mgc29tZXRpbWVzIHVzZWZ1bCB0byB1c2UgdGhpc1xuICogZm9yIG1vZGVscyB0aGF0IGhhdmUgYW4gaW50ZXJuYWwgcmVwcmVzZW50YXRpb24gdGhhdCdzIGRpZmZlcmVudCBmcm9tIHdoYXQgdGhlIG1vZGVsIGV4cG9zZXNcbiAqIHRvIHRoZSB2aWV3LlxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1zdWNjZXNzXCI+XG4gKiAqKkJlc3QgUHJhY3RpY2U6KiogSXQncyBiZXN0IHRvIGtlZXAgZ2V0dGVycyBmYXN0IGJlY2F1c2UgQW5ndWxhciBpcyBsaWtlbHkgdG8gY2FsbCB0aGVtIG1vcmVcbiAqIGZyZXF1ZW50bHkgdGhhbiBvdGhlciBwYXJ0cyBvZiB5b3VyIGNvZGUuXG4gKiA8L2Rpdj5cbiAqXG4gKiBZb3UgdXNlIHRoaXMgYmVoYXZpb3IgYnkgYWRkaW5nIGBuZy1tb2RlbC1vcHRpb25zPVwieyBnZXR0ZXJTZXR0ZXI6IHRydWUgfVwiYCB0byBhbiBlbGVtZW50IHRoYXRcbiAqIGhhcyBgbmctbW9kZWxgIGF0dGFjaGVkIHRvIGl0LiBZb3UgY2FuIGFsc28gYWRkIGBuZy1tb2RlbC1vcHRpb25zPVwieyBnZXR0ZXJTZXR0ZXI6IHRydWUgfVwiYCB0b1xuICogYSBgPGZvcm0+YCwgd2hpY2ggd2lsbCBlbmFibGUgdGhpcyBiZWhhdmlvciBmb3IgYWxsIGA8aW5wdXQ+YHMgd2l0aGluIGl0LiBTZWVcbiAqIHtAbGluayBuZy5kaXJlY3RpdmU6bmdNb2RlbE9wdGlvbnMgYG5nTW9kZWxPcHRpb25zYH0gZm9yIG1vcmUuXG4gKlxuICogVGhlIGZvbGxvd2luZyBleGFtcGxlIHNob3dzIGhvdyB0byB1c2UgYG5nTW9kZWxgIHdpdGggYSBnZXR0ZXIvc2V0dGVyOlxuICpcbiAqIEBleGFtcGxlXG4gKiA8ZXhhbXBsZSBuYW1lPVwibmdNb2RlbC1nZXR0ZXItc2V0dGVyXCIgbW9kdWxlPVwiZ2V0dGVyU2V0dGVyRXhhbXBsZVwiPlxuICAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gICAgICAgICA8Zm9ybSBuYW1lPVwidXNlckZvcm1cIj5cbiAgICAgICAgICAgPGxhYmVsPk5hbWU6XG4gICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmFtZT1cInVzZXJOYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgbmctbW9kZWw9XCJ1c2VyLm5hbWVcIlxuICAgICAgICAgICAgICAgICAgICBuZy1tb2RlbC1vcHRpb25zPVwieyBnZXR0ZXJTZXR0ZXI6IHRydWUgfVwiIC8+XG4gICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICA8L2Zvcm0+XG4gICAgICAgICA8cHJlPnVzZXIubmFtZSA9IDxzcGFuIG5nLWJpbmQ9XCJ1c2VyLm5hbWUoKVwiPjwvc3Bhbj48L3ByZT5cbiAgICAgICA8L2Rpdj5cbiAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwiYXBwLmpzXCI+XG4gICAgICAgYW5ndWxhci5tb2R1bGUoJ2dldHRlclNldHRlckV4YW1wbGUnLCBbXSlcbiAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgIHZhciBfbmFtZSA9ICdCcmlhbic7XG4gICAgICAgICAgICRzY29wZS51c2VyID0ge1xuICAgICAgICAgICAgIG5hbWU6IGZ1bmN0aW9uKG5ld05hbWUpIHtcbiAgICAgICAgICAgICAgLy8gTm90ZSB0aGF0IG5ld05hbWUgY2FuIGJlIHVuZGVmaW5lZCBmb3IgdHdvIHJlYXNvbnM6XG4gICAgICAgICAgICAgIC8vIDEuIEJlY2F1c2UgaXQgaXMgY2FsbGVkIGFzIGEgZ2V0dGVyIGFuZCB0aHVzIGNhbGxlZCB3aXRoIG5vIGFyZ3VtZW50c1xuICAgICAgICAgICAgICAvLyAyLiBCZWNhdXNlIHRoZSBwcm9wZXJ0eSBzaG91bGQgYWN0dWFsbHkgYmUgc2V0IHRvIHVuZGVmaW5lZC4gVGhpcyBoYXBwZW5zIGUuZy4gaWYgdGhlXG4gICAgICAgICAgICAgIC8vICAgIGlucHV0IGlzIGludmFsaWRcbiAgICAgICAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAoX25hbWUgPSBuZXdOYW1lKSA6IF9uYW1lO1xuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfTtcbiAgICAgICAgIH1dKTtcbiAgICAgPC9maWxlPlxuICogPC9leGFtcGxlPlxuICovXG52YXIgbmdNb2RlbERpcmVjdGl2ZSA9IFsnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRyb290U2NvcGUpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHJlcXVpcmU6IFsnbmdNb2RlbCcsICdeP2Zvcm0nLCAnXj9uZ01vZGVsT3B0aW9ucyddLFxuICAgIGNvbnRyb2xsZXI6IE5nTW9kZWxDb250cm9sbGVyLFxuICAgIC8vIFByZWxpbmsgbmVlZHMgdG8gcnVuIGJlZm9yZSBhbnkgaW5wdXQgZGlyZWN0aXZlXG4gICAgLy8gc28gdGhhdCB3ZSBjYW4gc2V0IHRoZSBOZ01vZGVsT3B0aW9ucyBpbiBOZ01vZGVsQ29udHJvbGxlclxuICAgIC8vIGJlZm9yZSBhbnlvbmUgZWxzZSB1c2VzIGl0LlxuICAgIHByaW9yaXR5OiAxLFxuICAgIGNvbXBpbGU6IGZ1bmN0aW9uIG5nTW9kZWxDb21waWxlKGVsZW1lbnQpIHtcbiAgICAgIC8vIFNldHVwIGluaXRpYWwgc3RhdGUgb2YgdGhlIGNvbnRyb2xcbiAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoUFJJU1RJTkVfQ0xBU1MpLmFkZENsYXNzKFVOVE9VQ0hFRF9DTEFTUykuYWRkQ2xhc3MoVkFMSURfQ0xBU1MpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwcmU6IGZ1bmN0aW9uIG5nTW9kZWxQcmVMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJscykge1xuICAgICAgICAgIHZhciBtb2RlbEN0cmwgPSBjdHJsc1swXSxcbiAgICAgICAgICAgICAgZm9ybUN0cmwgPSBjdHJsc1sxXSB8fCBtb2RlbEN0cmwuJCRwYXJlbnRGb3JtO1xuXG4gICAgICAgICAgbW9kZWxDdHJsLiQkc2V0T3B0aW9ucyhjdHJsc1syXSAmJiBjdHJsc1syXS4kb3B0aW9ucyk7XG5cbiAgICAgICAgICAvLyBub3RpZnkgb3RoZXJzLCBlc3BlY2lhbGx5IHBhcmVudCBmb3Jtc1xuICAgICAgICAgIGZvcm1DdHJsLiRhZGRDb250cm9sKG1vZGVsQ3RybCk7XG5cbiAgICAgICAgICBhdHRyLiRvYnNlcnZlKCduYW1lJywgZnVuY3Rpb24obmV3VmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChtb2RlbEN0cmwuJG5hbWUgIT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgIG1vZGVsQ3RybC4kJHBhcmVudEZvcm0uJCRyZW5hbWVDb250cm9sKG1vZGVsQ3RybCwgbmV3VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbW9kZWxDdHJsLiQkcGFyZW50Rm9ybS4kcmVtb3ZlQ29udHJvbChtb2RlbEN0cmwpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBwb3N0OiBmdW5jdGlvbiBuZ01vZGVsUG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmxzKSB7XG4gICAgICAgICAgdmFyIG1vZGVsQ3RybCA9IGN0cmxzWzBdO1xuICAgICAgICAgIGlmIChtb2RlbEN0cmwuJG9wdGlvbnMgJiYgbW9kZWxDdHJsLiRvcHRpb25zLnVwZGF0ZU9uKSB7XG4gICAgICAgICAgICBlbGVtZW50Lm9uKG1vZGVsQ3RybC4kb3B0aW9ucy51cGRhdGVPbiwgZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICAgbW9kZWxDdHJsLiQkZGVib3VuY2VWaWV3VmFsdWVDb21taXQoZXYgJiYgZXYudHlwZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBlbGVtZW50Lm9uKCdibHVyJywgZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgIGlmIChtb2RlbEN0cmwuJHRvdWNoZWQpIHJldHVybjtcblxuICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuJCRwaGFzZSkge1xuICAgICAgICAgICAgICBzY29wZS4kZXZhbEFzeW5jKG1vZGVsQ3RybC4kc2V0VG91Y2hlZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzY29wZS4kYXBwbHkobW9kZWxDdHJsLiRzZXRUb3VjaGVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH07XG59XTtcblxudmFyIERFRkFVTFRfUkVHRVhQID0gLyhcXHMrfF4pZGVmYXVsdChcXHMrfCQpLztcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ01vZGVsT3B0aW9uc1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQWxsb3dzIHR1bmluZyBob3cgbW9kZWwgdXBkYXRlcyBhcmUgZG9uZS4gVXNpbmcgYG5nTW9kZWxPcHRpb25zYCB5b3UgY2FuIHNwZWNpZnkgYSBjdXN0b20gbGlzdCBvZlxuICogZXZlbnRzIHRoYXQgd2lsbCB0cmlnZ2VyIGEgbW9kZWwgdXBkYXRlIGFuZC9vciBhIGRlYm91bmNpbmcgZGVsYXkgc28gdGhhdCB0aGUgYWN0dWFsIHVwZGF0ZSBvbmx5XG4gKiB0YWtlcyBwbGFjZSB3aGVuIGEgdGltZXIgZXhwaXJlczsgdGhpcyB0aW1lciB3aWxsIGJlIHJlc2V0IGFmdGVyIGFub3RoZXIgY2hhbmdlIHRha2VzIHBsYWNlLlxuICpcbiAqIEdpdmVuIHRoZSBuYXR1cmUgb2YgYG5nTW9kZWxPcHRpb25zYCwgdGhlIHZhbHVlIGRpc3BsYXllZCBpbnNpZGUgaW5wdXQgZmllbGRzIGluIHRoZSB2aWV3IG1pZ2h0XG4gKiBiZSBkaWZmZXJlbnQgZnJvbSB0aGUgdmFsdWUgaW4gdGhlIGFjdHVhbCBtb2RlbC4gVGhpcyBtZWFucyB0aGF0IGlmIHlvdSB1cGRhdGUgdGhlIG1vZGVsIHlvdVxuICogc2hvdWxkIGFsc28gaW52b2tlIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIGAkcm9sbGJhY2tWaWV3VmFsdWVgfSBvbiB0aGUgcmVsZXZhbnQgaW5wdXQgZmllbGQgaW5cbiAqIG9yZGVyIHRvIG1ha2Ugc3VyZSBpdCBpcyBzeW5jaHJvbml6ZWQgd2l0aCB0aGUgbW9kZWwgYW5kIHRoYXQgYW55IGRlYm91bmNlZCBhY3Rpb24gaXMgY2FuY2VsZWQuXG4gKlxuICogVGhlIGVhc2llc3Qgd2F5IHRvIHJlZmVyZW5jZSB0aGUgY29udHJvbCdzIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIGAkcm9sbGJhY2tWaWV3VmFsdWVgfVxuICogbWV0aG9kIGlzIGJ5IG1ha2luZyBzdXJlIHRoZSBpbnB1dCBpcyBwbGFjZWQgaW5zaWRlIGEgZm9ybSB0aGF0IGhhcyBhIGBuYW1lYCBhdHRyaWJ1dGUuIFRoaXMgaXNcbiAqIGltcG9ydGFudCBiZWNhdXNlIGBmb3JtYCBjb250cm9sbGVycyBhcmUgcHVibGlzaGVkIHRvIHRoZSByZWxhdGVkIHNjb3BlIHVuZGVyIHRoZSBuYW1lIGluIHRoZWlyXG4gKiBgbmFtZWAgYXR0cmlidXRlLlxuICpcbiAqIEFueSBwZW5kaW5nIGNoYW5nZXMgd2lsbCB0YWtlIHBsYWNlIGltbWVkaWF0ZWx5IHdoZW4gYW4gZW5jbG9zaW5nIGZvcm0gaXMgc3VibWl0dGVkIHZpYSB0aGVcbiAqIGBzdWJtaXRgIGV2ZW50LiBOb3RlIHRoYXQgYG5nQ2xpY2tgIGV2ZW50cyB3aWxsIG9jY3VyIGJlZm9yZSB0aGUgbW9kZWwgaXMgdXBkYXRlZC4gVXNlIGBuZ1N1Ym1pdGBcbiAqIHRvIGhhdmUgYWNjZXNzIHRvIHRoZSB1cGRhdGVkIG1vZGVsLlxuICpcbiAqIGBuZ01vZGVsT3B0aW9uc2AgaGFzIGFuIGVmZmVjdCBvbiB0aGUgZWxlbWVudCBpdCdzIGRlY2xhcmVkIG9uIGFuZCBpdHMgZGVzY2VuZGFudHMuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG5nTW9kZWxPcHRpb25zIG9wdGlvbnMgdG8gYXBwbHkgdG8gdGhlIGN1cnJlbnQgbW9kZWwuIFZhbGlkIGtleXMgYXJlOlxuICogICAtIGB1cGRhdGVPbmA6IHN0cmluZyBzcGVjaWZ5aW5nIHdoaWNoIGV2ZW50IHNob3VsZCB0aGUgaW5wdXQgYmUgYm91bmQgdG8uIFlvdSBjYW4gc2V0IHNldmVyYWxcbiAqICAgICBldmVudHMgdXNpbmcgYW4gc3BhY2UgZGVsaW1pdGVkIGxpc3QuIFRoZXJlIGlzIGEgc3BlY2lhbCBldmVudCBjYWxsZWQgYGRlZmF1bHRgIHRoYXRcbiAqICAgICBtYXRjaGVzIHRoZSBkZWZhdWx0IGV2ZW50cyBiZWxvbmdpbmcgb2YgdGhlIGNvbnRyb2wuXG4gKiAgIC0gYGRlYm91bmNlYDogaW50ZWdlciB2YWx1ZSB3aGljaCBjb250YWlucyB0aGUgZGVib3VuY2UgbW9kZWwgdXBkYXRlIHZhbHVlIGluIG1pbGxpc2Vjb25kcy4gQVxuICogICAgIHZhbHVlIG9mIDAgdHJpZ2dlcnMgYW4gaW1tZWRpYXRlIHVwZGF0ZS4gSWYgYW4gb2JqZWN0IGlzIHN1cHBsaWVkIGluc3RlYWQsIHlvdSBjYW4gc3BlY2lmeSBhXG4gKiAgICAgY3VzdG9tIHZhbHVlIGZvciBlYWNoIGV2ZW50LiBGb3IgZXhhbXBsZTpcbiAqICAgICBgbmctbW9kZWwtb3B0aW9ucz1cInsgdXBkYXRlT246ICdkZWZhdWx0IGJsdXInLCBkZWJvdW5jZTogeyAnZGVmYXVsdCc6IDUwMCwgJ2JsdXInOiAwIH0gfVwiYFxuICogICAtIGBhbGxvd0ludmFsaWRgOiBib29sZWFuIHZhbHVlIHdoaWNoIGluZGljYXRlcyB0aGF0IHRoZSBtb2RlbCBjYW4gYmUgc2V0IHdpdGggdmFsdWVzIHRoYXQgZGlkXG4gKiAgICAgbm90IHZhbGlkYXRlIGNvcnJlY3RseSBpbnN0ZWFkIG9mIHRoZSBkZWZhdWx0IGJlaGF2aW9yIG9mIHNldHRpbmcgdGhlIG1vZGVsIHRvIHVuZGVmaW5lZC5cbiAqICAgLSBgZ2V0dGVyU2V0dGVyYDogYm9vbGVhbiB2YWx1ZSB3aGljaCBkZXRlcm1pbmVzIHdoZXRoZXIgb3Igbm90IHRvIHRyZWF0IGZ1bmN0aW9ucyBib3VuZCB0b1xuICAgICAgIGBuZ01vZGVsYCBhcyBnZXR0ZXJzL3NldHRlcnMuXG4gKiAgIC0gYHRpbWV6b25lYDogRGVmaW5lcyB0aGUgdGltZXpvbmUgdG8gYmUgdXNlZCB0byByZWFkL3dyaXRlIHRoZSBgRGF0ZWAgaW5zdGFuY2UgaW4gdGhlIG1vZGVsIGZvclxuICogICAgIGA8aW5wdXQgdHlwZT1cImRhdGVcIj5gLCBgPGlucHV0IHR5cGU9XCJ0aW1lXCI+YCwgLi4uIC4gSXQgdW5kZXJzdGFuZHMgVVRDL0dNVCBhbmQgdGhlXG4gKiAgICAgY29udGluZW50YWwgVVMgdGltZSB6b25lIGFiYnJldmlhdGlvbnMsIGJ1dCBmb3IgZ2VuZXJhbCB1c2UsIHVzZSBhIHRpbWUgem9uZSBvZmZzZXQsIGZvclxuICogICAgIGV4YW1wbGUsIGAnKzA0MzAnYCAoNCBob3VycywgMzAgbWludXRlcyBlYXN0IG9mIHRoZSBHcmVlbndpY2ggbWVyaWRpYW4pXG4gKiAgICAgSWYgbm90IHNwZWNpZmllZCwgdGhlIHRpbWV6b25lIG9mIHRoZSBicm93c2VyIHdpbGwgYmUgdXNlZC5cbiAqXG4gKiBAZXhhbXBsZVxuXG4gIFRoZSBmb2xsb3dpbmcgZXhhbXBsZSBzaG93cyBob3cgdG8gb3ZlcnJpZGUgaW1tZWRpYXRlIHVwZGF0ZXMuIENoYW5nZXMgb24gdGhlIGlucHV0cyB3aXRoaW4gdGhlXG4gIGZvcm0gd2lsbCB1cGRhdGUgdGhlIG1vZGVsIG9ubHkgd2hlbiB0aGUgY29udHJvbCBsb3NlcyBmb2N1cyAoYmx1ciBldmVudCkuIElmIGBlc2NhcGVgIGtleSBpc1xuICBwcmVzc2VkIHdoaWxlIHRoZSBpbnB1dCBmaWVsZCBpcyBmb2N1c2VkLCB0aGUgdmFsdWUgaXMgcmVzZXQgdG8gdGhlIHZhbHVlIGluIHRoZSBjdXJyZW50IG1vZGVsLlxuXG4gIDxleGFtcGxlIG5hbWU9XCJuZ01vZGVsT3B0aW9ucy1kaXJlY3RpdmUtYmx1clwiIG1vZHVsZT1cIm9wdGlvbnNFeGFtcGxlXCI+XG4gICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gICAgICAgIDxmb3JtIG5hbWU9XCJ1c2VyRm9ybVwiPlxuICAgICAgICAgIDxsYWJlbD5OYW1lOlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmFtZT1cInVzZXJOYW1lXCJcbiAgICAgICAgICAgICAgICAgICBuZy1tb2RlbD1cInVzZXIubmFtZVwiXG4gICAgICAgICAgICAgICAgICAgbmctbW9kZWwtb3B0aW9ucz1cInsgdXBkYXRlT246ICdibHVyJyB9XCJcbiAgICAgICAgICAgICAgICAgICBuZy1rZXl1cD1cImNhbmNlbCgkZXZlbnQpXCIgLz5cbiAgICAgICAgICA8L2xhYmVsPjxiciAvPlxuICAgICAgICAgIDxsYWJlbD5PdGhlciBkYXRhOlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJ1c2VyLmRhdGFcIiAvPlxuICAgICAgICAgIDwvbGFiZWw+PGJyIC8+XG4gICAgICAgIDwvZm9ybT5cbiAgICAgICAgPHByZT51c2VyLm5hbWUgPSA8c3BhbiBuZy1iaW5kPVwidXNlci5uYW1lXCI+PC9zcGFuPjwvcHJlPlxuICAgICAgICA8cHJlPnVzZXIuZGF0YSA9IDxzcGFuIG5nLWJpbmQ9XCJ1c2VyLmRhdGFcIj48L3NwYW4+PC9wcmU+XG4gICAgICA8L2Rpdj5cbiAgICA8L2ZpbGU+XG4gICAgPGZpbGUgbmFtZT1cImFwcC5qc1wiPlxuICAgICAgYW5ndWxhci5tb2R1bGUoJ29wdGlvbnNFeGFtcGxlJywgW10pXG4gICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLnVzZXIgPSB7IG5hbWU6ICdKb2huJywgZGF0YTogJycgfTtcblxuICAgICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDI3KSB7XG4gICAgICAgICAgICAgICRzY29wZS51c2VyRm9ybS51c2VyTmFtZS4kcm9sbGJhY2tWaWV3VmFsdWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICB9XSk7XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgIHZhciBtb2RlbCA9IGVsZW1lbnQoYnkuYmluZGluZygndXNlci5uYW1lJykpO1xuICAgICAgdmFyIGlucHV0ID0gZWxlbWVudChieS5tb2RlbCgndXNlci5uYW1lJykpO1xuICAgICAgdmFyIG90aGVyID0gZWxlbWVudChieS5tb2RlbCgndXNlci5kYXRhJykpO1xuXG4gICAgICBpdCgnc2hvdWxkIGFsbG93IGN1c3RvbSBldmVudHMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgaW5wdXQuc2VuZEtleXMoJyBEb2UnKTtcbiAgICAgICAgaW5wdXQuY2xpY2soKTtcbiAgICAgICAgZXhwZWN0KG1vZGVsLmdldFRleHQoKSkudG9FcXVhbCgnSm9obicpO1xuICAgICAgICBvdGhlci5jbGljaygpO1xuICAgICAgICBleHBlY3QobW9kZWwuZ2V0VGV4dCgpKS50b0VxdWFsKCdKb2huIERvZScpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgJHJvbGxiYWNrVmlld1ZhbHVlIHdoZW4gbW9kZWwgY2hhbmdlcycsIGZ1bmN0aW9uKCkge1xuICAgICAgICBpbnB1dC5zZW5kS2V5cygnIERvZScpO1xuICAgICAgICBleHBlY3QoaW5wdXQuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKS50b0VxdWFsKCdKb2huIERvZScpO1xuICAgICAgICBpbnB1dC5zZW5kS2V5cyhwcm90cmFjdG9yLktleS5FU0NBUEUpO1xuICAgICAgICBleHBlY3QoaW5wdXQuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKS50b0VxdWFsKCdKb2huJyk7XG4gICAgICAgIG90aGVyLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChtb2RlbC5nZXRUZXh0KCkpLnRvRXF1YWwoJ0pvaG4nKTtcbiAgICAgIH0pO1xuICAgIDwvZmlsZT5cbiAgPC9leGFtcGxlPlxuXG4gIFRoaXMgb25lIHNob3dzIGhvdyB0byBkZWJvdW5jZSBtb2RlbCBjaGFuZ2VzLiBNb2RlbCB3aWxsIGJlIHVwZGF0ZWQgb25seSAxIHNlYyBhZnRlciBsYXN0IGNoYW5nZS5cbiAgSWYgdGhlIGBDbGVhcmAgYnV0dG9uIGlzIHByZXNzZWQsIGFueSBkZWJvdW5jZWQgYWN0aW9uIGlzIGNhbmNlbGVkIGFuZCB0aGUgdmFsdWUgYmVjb21lcyBlbXB0eS5cblxuICA8ZXhhbXBsZSBuYW1lPVwibmdNb2RlbE9wdGlvbnMtZGlyZWN0aXZlLWRlYm91bmNlXCIgbW9kdWxlPVwib3B0aW9uc0V4YW1wbGVcIj5cbiAgICA8ZmlsZSBuYW1lPVwiaW5kZXguaHRtbFwiPlxuICAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiAgICAgICAgPGZvcm0gbmFtZT1cInVzZXJGb3JtXCI+XG4gICAgICAgICAgPGxhYmVsPk5hbWU6XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwidXNlck5hbWVcIlxuICAgICAgICAgICAgICAgICAgIG5nLW1vZGVsPVwidXNlci5uYW1lXCJcbiAgICAgICAgICAgICAgICAgICBuZy1tb2RlbC1vcHRpb25zPVwieyBkZWJvdW5jZTogMTAwMCB9XCIgLz5cbiAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgIDxidXR0b24gbmctY2xpY2s9XCJ1c2VyRm9ybS51c2VyTmFtZS4kcm9sbGJhY2tWaWV3VmFsdWUoKTsgdXNlci5uYW1lPScnXCI+Q2xlYXI8L2J1dHRvbj5cbiAgICAgICAgICA8YnIgLz5cbiAgICAgICAgPC9mb3JtPlxuICAgICAgICA8cHJlPnVzZXIubmFtZSA9IDxzcGFuIG5nLWJpbmQ9XCJ1c2VyLm5hbWVcIj48L3NwYW4+PC9wcmU+XG4gICAgICA8L2Rpdj5cbiAgICA8L2ZpbGU+XG4gICAgPGZpbGUgbmFtZT1cImFwcC5qc1wiPlxuICAgICAgYW5ndWxhci5tb2R1bGUoJ29wdGlvbnNFeGFtcGxlJywgW10pXG4gICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLnVzZXIgPSB7IG5hbWU6ICdJZ29yJyB9O1xuICAgICAgICB9XSk7XG4gICAgPC9maWxlPlxuICA8L2V4YW1wbGU+XG5cbiAgVGhpcyBvbmUgc2hvd3MgaG93IHRvIGJpbmQgdG8gZ2V0dGVyL3NldHRlcnM6XG5cbiAgPGV4YW1wbGUgbmFtZT1cIm5nTW9kZWxPcHRpb25zLWRpcmVjdGl2ZS1nZXR0ZXItc2V0dGVyXCIgbW9kdWxlPVwiZ2V0dGVyU2V0dGVyRXhhbXBsZVwiPlxuICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICAgICA8Zm9ybSBuYW1lPVwidXNlckZvcm1cIj5cbiAgICAgICAgICA8bGFiZWw+TmFtZTpcbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJ1c2VyTmFtZVwiXG4gICAgICAgICAgICAgICAgICAgbmctbW9kZWw9XCJ1c2VyLm5hbWVcIlxuICAgICAgICAgICAgICAgICAgIG5nLW1vZGVsLW9wdGlvbnM9XCJ7IGdldHRlclNldHRlcjogdHJ1ZSB9XCIgLz5cbiAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICA8L2Zvcm0+XG4gICAgICAgIDxwcmU+dXNlci5uYW1lID0gPHNwYW4gbmctYmluZD1cInVzZXIubmFtZSgpXCI+PC9zcGFuPjwvcHJlPlxuICAgICAgPC9kaXY+XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJhcHAuanNcIj5cbiAgICAgIGFuZ3VsYXIubW9kdWxlKCdnZXR0ZXJTZXR0ZXJFeGFtcGxlJywgW10pXG4gICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgdmFyIF9uYW1lID0gJ0JyaWFuJztcbiAgICAgICAgICAkc2NvcGUudXNlciA9IHtcbiAgICAgICAgICAgIG5hbWU6IGZ1bmN0aW9uKG5ld05hbWUpIHtcbiAgICAgICAgICAgICAgLy8gTm90ZSB0aGF0IG5ld05hbWUgY2FuIGJlIHVuZGVmaW5lZCBmb3IgdHdvIHJlYXNvbnM6XG4gICAgICAgICAgICAgIC8vIDEuIEJlY2F1c2UgaXQgaXMgY2FsbGVkIGFzIGEgZ2V0dGVyIGFuZCB0aHVzIGNhbGxlZCB3aXRoIG5vIGFyZ3VtZW50c1xuICAgICAgICAgICAgICAvLyAyLiBCZWNhdXNlIHRoZSBwcm9wZXJ0eSBzaG91bGQgYWN0dWFsbHkgYmUgc2V0IHRvIHVuZGVmaW5lZC4gVGhpcyBoYXBwZW5zIGUuZy4gaWYgdGhlXG4gICAgICAgICAgICAgIC8vICAgIGlucHV0IGlzIGludmFsaWRcbiAgICAgICAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAoX25hbWUgPSBuZXdOYW1lKSA6IF9uYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgIH1dKTtcbiAgICA8L2ZpbGU+XG4gIDwvZXhhbXBsZT5cbiAqL1xudmFyIG5nTW9kZWxPcHRpb25zRGlyZWN0aXZlID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICBjb250cm9sbGVyOiBbJyRzY29wZScsICckYXR0cnMnLCBmdW5jdGlvbigkc2NvcGUsICRhdHRycykge1xuICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgdGhpcy4kb3B0aW9ucyA9IGNvcHkoJHNjb3BlLiRldmFsKCRhdHRycy5uZ01vZGVsT3B0aW9ucykpO1xuICAgICAgLy8gQWxsb3cgYWRkaW5nL292ZXJyaWRpbmcgYm91bmQgZXZlbnRzXG4gICAgICBpZiAoaXNEZWZpbmVkKHRoaXMuJG9wdGlvbnMudXBkYXRlT24pKSB7XG4gICAgICAgIHRoaXMuJG9wdGlvbnMudXBkYXRlT25EZWZhdWx0ID0gZmFsc2U7XG4gICAgICAgIC8vIGV4dHJhY3QgXCJkZWZhdWx0XCIgcHNldWRvLWV2ZW50IGZyb20gbGlzdCBvZiBldmVudHMgdGhhdCBjYW4gdHJpZ2dlciBhIG1vZGVsIHVwZGF0ZVxuICAgICAgICB0aGlzLiRvcHRpb25zLnVwZGF0ZU9uID0gdHJpbSh0aGlzLiRvcHRpb25zLnVwZGF0ZU9uLnJlcGxhY2UoREVGQVVMVF9SRUdFWFAsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoYXQuJG9wdGlvbnMudXBkYXRlT25EZWZhdWx0ID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gJyAnO1xuICAgICAgICB9KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLiRvcHRpb25zLnVwZGF0ZU9uRGVmYXVsdCA9IHRydWU7XG4gICAgICB9XG4gICAgfV1cbiAgfTtcbn07XG5cblxuXG4vLyBoZWxwZXIgbWV0aG9kc1xuZnVuY3Rpb24gYWRkU2V0VmFsaWRpdHlNZXRob2QoY29udGV4dCkge1xuICB2YXIgY3RybCA9IGNvbnRleHQuY3RybCxcbiAgICAgICRlbGVtZW50ID0gY29udGV4dC4kZWxlbWVudCxcbiAgICAgIGNsYXNzQ2FjaGUgPSB7fSxcbiAgICAgIHNldCA9IGNvbnRleHQuc2V0LFxuICAgICAgdW5zZXQgPSBjb250ZXh0LnVuc2V0LFxuICAgICAgJGFuaW1hdGUgPSBjb250ZXh0LiRhbmltYXRlO1xuXG4gIGNsYXNzQ2FjaGVbSU5WQUxJRF9DTEFTU10gPSAhKGNsYXNzQ2FjaGVbVkFMSURfQ0xBU1NdID0gJGVsZW1lbnQuaGFzQ2xhc3MoVkFMSURfQ0xBU1MpKTtcblxuICBjdHJsLiRzZXRWYWxpZGl0eSA9IHNldFZhbGlkaXR5O1xuXG4gIGZ1bmN0aW9uIHNldFZhbGlkaXR5KHZhbGlkYXRpb25FcnJvcktleSwgc3RhdGUsIGNvbnRyb2xsZXIpIHtcbiAgICBpZiAoaXNVbmRlZmluZWQoc3RhdGUpKSB7XG4gICAgICBjcmVhdGVBbmRTZXQoJyRwZW5kaW5nJywgdmFsaWRhdGlvbkVycm9yS2V5LCBjb250cm9sbGVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdW5zZXRBbmRDbGVhbnVwKCckcGVuZGluZycsIHZhbGlkYXRpb25FcnJvcktleSwgY29udHJvbGxlcik7XG4gICAgfVxuICAgIGlmICghaXNCb29sZWFuKHN0YXRlKSkge1xuICAgICAgdW5zZXQoY3RybC4kZXJyb3IsIHZhbGlkYXRpb25FcnJvcktleSwgY29udHJvbGxlcik7XG4gICAgICB1bnNldChjdHJsLiQkc3VjY2VzcywgdmFsaWRhdGlvbkVycm9yS2V5LCBjb250cm9sbGVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHN0YXRlKSB7XG4gICAgICAgIHVuc2V0KGN0cmwuJGVycm9yLCB2YWxpZGF0aW9uRXJyb3JLZXksIGNvbnRyb2xsZXIpO1xuICAgICAgICBzZXQoY3RybC4kJHN1Y2Nlc3MsIHZhbGlkYXRpb25FcnJvcktleSwgY29udHJvbGxlcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXQoY3RybC4kZXJyb3IsIHZhbGlkYXRpb25FcnJvcktleSwgY29udHJvbGxlcik7XG4gICAgICAgIHVuc2V0KGN0cmwuJCRzdWNjZXNzLCB2YWxpZGF0aW9uRXJyb3JLZXksIGNvbnRyb2xsZXIpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY3RybC4kcGVuZGluZykge1xuICAgICAgY2FjaGVkVG9nZ2xlQ2xhc3MoUEVORElOR19DTEFTUywgdHJ1ZSk7XG4gICAgICBjdHJsLiR2YWxpZCA9IGN0cmwuJGludmFsaWQgPSB1bmRlZmluZWQ7XG4gICAgICB0b2dnbGVWYWxpZGF0aW9uQ3NzKCcnLCBudWxsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FjaGVkVG9nZ2xlQ2xhc3MoUEVORElOR19DTEFTUywgZmFsc2UpO1xuICAgICAgY3RybC4kdmFsaWQgPSBpc09iamVjdEVtcHR5KGN0cmwuJGVycm9yKTtcbiAgICAgIGN0cmwuJGludmFsaWQgPSAhY3RybC4kdmFsaWQ7XG4gICAgICB0b2dnbGVWYWxpZGF0aW9uQ3NzKCcnLCBjdHJsLiR2YWxpZCk7XG4gICAgfVxuXG4gICAgLy8gcmUtcmVhZCB0aGUgc3RhdGUgYXMgdGhlIHNldC91bnNldCBtZXRob2RzIGNvdWxkIGhhdmVcbiAgICAvLyBjb21iaW5lZCBzdGF0ZSBpbiBjdHJsLiRlcnJvclt2YWxpZGF0aW9uRXJyb3JdICh1c2VkIGZvciBmb3JtcyksXG4gICAgLy8gd2hlcmUgc2V0dGluZy91bnNldHRpbmcgb25seSBpbmNyZW1lbnRzL2RlY3JlbWVudHMgdGhlIHZhbHVlLFxuICAgIC8vIGFuZCBkb2VzIG5vdCByZXBsYWNlIGl0LlxuICAgIHZhciBjb21iaW5lZFN0YXRlO1xuICAgIGlmIChjdHJsLiRwZW5kaW5nICYmIGN0cmwuJHBlbmRpbmdbdmFsaWRhdGlvbkVycm9yS2V5XSkge1xuICAgICAgY29tYmluZWRTdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB9IGVsc2UgaWYgKGN0cmwuJGVycm9yW3ZhbGlkYXRpb25FcnJvcktleV0pIHtcbiAgICAgIGNvbWJpbmVkU3RhdGUgPSBmYWxzZTtcbiAgICB9IGVsc2UgaWYgKGN0cmwuJCRzdWNjZXNzW3ZhbGlkYXRpb25FcnJvcktleV0pIHtcbiAgICAgIGNvbWJpbmVkU3RhdGUgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb21iaW5lZFN0YXRlID0gbnVsbDtcbiAgICB9XG5cbiAgICB0b2dnbGVWYWxpZGF0aW9uQ3NzKHZhbGlkYXRpb25FcnJvcktleSwgY29tYmluZWRTdGF0ZSk7XG4gICAgY3RybC4kJHBhcmVudEZvcm0uJHNldFZhbGlkaXR5KHZhbGlkYXRpb25FcnJvcktleSwgY29tYmluZWRTdGF0ZSwgY3RybCk7XG4gIH1cblxuICBmdW5jdGlvbiBjcmVhdGVBbmRTZXQobmFtZSwgdmFsdWUsIGNvbnRyb2xsZXIpIHtcbiAgICBpZiAoIWN0cmxbbmFtZV0pIHtcbiAgICAgIGN0cmxbbmFtZV0gPSB7fTtcbiAgICB9XG4gICAgc2V0KGN0cmxbbmFtZV0sIHZhbHVlLCBjb250cm9sbGVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHVuc2V0QW5kQ2xlYW51cChuYW1lLCB2YWx1ZSwgY29udHJvbGxlcikge1xuICAgIGlmIChjdHJsW25hbWVdKSB7XG4gICAgICB1bnNldChjdHJsW25hbWVdLCB2YWx1ZSwgY29udHJvbGxlcik7XG4gICAgfVxuICAgIGlmIChpc09iamVjdEVtcHR5KGN0cmxbbmFtZV0pKSB7XG4gICAgICBjdHJsW25hbWVdID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGNhY2hlZFRvZ2dsZUNsYXNzKGNsYXNzTmFtZSwgc3dpdGNoVmFsdWUpIHtcbiAgICBpZiAoc3dpdGNoVmFsdWUgJiYgIWNsYXNzQ2FjaGVbY2xhc3NOYW1lXSkge1xuICAgICAgJGFuaW1hdGUuYWRkQ2xhc3MoJGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICBjbGFzc0NhY2hlW2NsYXNzTmFtZV0gPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAoIXN3aXRjaFZhbHVlICYmIGNsYXNzQ2FjaGVbY2xhc3NOYW1lXSkge1xuICAgICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoJGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICBjbGFzc0NhY2hlW2NsYXNzTmFtZV0gPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiB0b2dnbGVWYWxpZGF0aW9uQ3NzKHZhbGlkYXRpb25FcnJvcktleSwgaXNWYWxpZCkge1xuICAgIHZhbGlkYXRpb25FcnJvcktleSA9IHZhbGlkYXRpb25FcnJvcktleSA/ICctJyArIHNuYWtlX2Nhc2UodmFsaWRhdGlvbkVycm9yS2V5LCAnLScpIDogJyc7XG5cbiAgICBjYWNoZWRUb2dnbGVDbGFzcyhWQUxJRF9DTEFTUyArIHZhbGlkYXRpb25FcnJvcktleSwgaXNWYWxpZCA9PT0gdHJ1ZSk7XG4gICAgY2FjaGVkVG9nZ2xlQ2xhc3MoSU5WQUxJRF9DTEFTUyArIHZhbGlkYXRpb25FcnJvcktleSwgaXNWYWxpZCA9PT0gZmFsc2UpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGlzT2JqZWN0RW1wdHkob2JqKSB7XG4gIGlmIChvYmopIHtcbiAgICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nTm9uQmluZGFibGVcbiAqIEByZXN0cmljdCBBQ1xuICogQHByaW9yaXR5IDEwMDBcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBgbmdOb25CaW5kYWJsZWAgZGlyZWN0aXZlIHRlbGxzIEFuZ3VsYXIgbm90IHRvIGNvbXBpbGUgb3IgYmluZCB0aGUgY29udGVudHMgb2YgdGhlIGN1cnJlbnRcbiAqIERPTSBlbGVtZW50LiBUaGlzIGlzIHVzZWZ1bCBpZiB0aGUgZWxlbWVudCBjb250YWlucyB3aGF0IGFwcGVhcnMgdG8gYmUgQW5ndWxhciBkaXJlY3RpdmVzIGFuZFxuICogYmluZGluZ3MgYnV0IHdoaWNoIHNob3VsZCBiZSBpZ25vcmVkIGJ5IEFuZ3VsYXIuIFRoaXMgY291bGQgYmUgdGhlIGNhc2UgaWYgeW91IGhhdmUgYSBzaXRlIHRoYXRcbiAqIGRpc3BsYXlzIHNuaXBwZXRzIG9mIGNvZGUsIGZvciBpbnN0YW5jZS5cbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqXG4gKiBAZXhhbXBsZVxuICogSW4gdGhpcyBleGFtcGxlIHRoZXJlIGFyZSB0d28gbG9jYXRpb25zIHdoZXJlIGEgc2ltcGxlIGludGVycG9sYXRpb24gYmluZGluZyAoYHt7fX1gKSBpcyBwcmVzZW50LFxuICogYnV0IHRoZSBvbmUgd3JhcHBlZCBpbiBgbmdOb25CaW5kYWJsZWAgaXMgbGVmdCBhbG9uZS5cbiAqXG4gKiBAZXhhbXBsZVxuICAgIDxleGFtcGxlPlxuICAgICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgICAgPGRpdj5Ob3JtYWw6IHt7MSArIDJ9fTwvZGl2PlxuICAgICAgICA8ZGl2IG5nLW5vbi1iaW5kYWJsZT5JZ25vcmVkOiB7ezEgKyAyfX08L2Rpdj5cbiAgICAgIDwvZmlsZT5cbiAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgICBpdCgnc2hvdWxkIGNoZWNrIG5nLW5vbi1iaW5kYWJsZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygnMSArIDInKSkuZ2V0VGV4dCgpKS50b0NvbnRhaW4oJzMnKTtcbiAgICAgICAgIGV4cGVjdChlbGVtZW50LmFsbChieS5jc3MoJ2RpdicpKS5sYXN0KCkuZ2V0VGV4dCgpKS50b01hdGNoKC8xIFxcKyAyLyk7XG4gICAgICAgfSk7XG4gICAgICA8L2ZpbGU+XG4gICAgPC9leGFtcGxlPlxuICovXG52YXIgbmdOb25CaW5kYWJsZURpcmVjdGl2ZSA9IG5nRGlyZWN0aXZlKHsgdGVybWluYWw6IHRydWUsIHByaW9yaXR5OiAxMDAwIH0pO1xuXG4vKiBnbG9iYWwganFMaXRlUmVtb3ZlICovXG5cbnZhciBuZ09wdGlvbnNNaW5FcnIgPSBtaW5FcnIoJ25nT3B0aW9ucycpO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nT3B0aW9uc1xuICogQHJlc3RyaWN0IEFcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBUaGUgYG5nT3B0aW9uc2AgYXR0cmlidXRlIGNhbiBiZSB1c2VkIHRvIGR5bmFtaWNhbGx5IGdlbmVyYXRlIGEgbGlzdCBvZiBgPG9wdGlvbj5gXG4gKiBlbGVtZW50cyBmb3IgdGhlIGA8c2VsZWN0PmAgZWxlbWVudCB1c2luZyB0aGUgYXJyYXkgb3Igb2JqZWN0IG9idGFpbmVkIGJ5IGV2YWx1YXRpbmcgdGhlXG4gKiBgbmdPcHRpb25zYCBjb21wcmVoZW5zaW9uIGV4cHJlc3Npb24uXG4gKlxuICogSW4gbWFueSBjYXNlcywgYG5nUmVwZWF0YCBjYW4gYmUgdXNlZCBvbiBgPG9wdGlvbj5gIGVsZW1lbnRzIGluc3RlYWQgb2YgYG5nT3B0aW9uc2AgdG8gYWNoaWV2ZSBhXG4gKiBzaW1pbGFyIHJlc3VsdC4gSG93ZXZlciwgYG5nT3B0aW9uc2AgcHJvdmlkZXMgc29tZSBiZW5lZml0cyBzdWNoIGFzIHJlZHVjaW5nIG1lbW9yeSBhbmRcbiAqIGluY3JlYXNpbmcgc3BlZWQgYnkgbm90IGNyZWF0aW5nIGEgbmV3IHNjb3BlIGZvciBlYWNoIHJlcGVhdGVkIGluc3RhbmNlLCBhcyB3ZWxsIGFzIHByb3ZpZGluZ1xuICogbW9yZSBmbGV4aWJpbGl0eSBpbiBob3cgdGhlIGA8c2VsZWN0PmAncyBtb2RlbCBpcyBhc3NpZ25lZCB2aWEgdGhlIGBzZWxlY3RgICoqYGFzYCoqIHBhcnQgb2YgdGhlXG4gKiBjb21wcmVoZW5zaW9uIGV4cHJlc3Npb24uIGBuZ09wdGlvbnNgIHNob3VsZCBiZSB1c2VkIHdoZW4gdGhlIGA8c2VsZWN0PmAgbW9kZWwgbmVlZHMgdG8gYmUgYm91bmRcbiAqICB0byBhIG5vbi1zdHJpbmcgdmFsdWUuIFRoaXMgaXMgYmVjYXVzZSBhbiBvcHRpb24gZWxlbWVudCBjYW4gb25seSBiZSBib3VuZCB0byBzdHJpbmcgdmFsdWVzIGF0XG4gKiBwcmVzZW50LlxuICpcbiAqIFdoZW4gYW4gaXRlbSBpbiB0aGUgYDxzZWxlY3Q+YCBtZW51IGlzIHNlbGVjdGVkLCB0aGUgYXJyYXkgZWxlbWVudCBvciBvYmplY3QgcHJvcGVydHlcbiAqIHJlcHJlc2VudGVkIGJ5IHRoZSBzZWxlY3RlZCBvcHRpb24gd2lsbCBiZSBib3VuZCB0byB0aGUgbW9kZWwgaWRlbnRpZmllZCBieSB0aGUgYG5nTW9kZWxgXG4gKiBkaXJlY3RpdmUuXG4gKlxuICogT3B0aW9uYWxseSwgYSBzaW5nbGUgaGFyZC1jb2RlZCBgPG9wdGlvbj5gIGVsZW1lbnQsIHdpdGggdGhlIHZhbHVlIHNldCB0byBhbiBlbXB0eSBzdHJpbmcsIGNhblxuICogYmUgbmVzdGVkIGludG8gdGhlIGA8c2VsZWN0PmAgZWxlbWVudC4gVGhpcyBlbGVtZW50IHdpbGwgdGhlbiByZXByZXNlbnQgdGhlIGBudWxsYCBvciBcIm5vdCBzZWxlY3RlZFwiXG4gKiBvcHRpb24uIFNlZSBleGFtcGxlIGJlbG93IGZvciBkZW1vbnN0cmF0aW9uLlxuICpcbiAqICMjIENvbXBsZXggTW9kZWxzIChvYmplY3RzIG9yIGNvbGxlY3Rpb25zKVxuICpcbiAqIEJ5IGRlZmF1bHQsIGBuZ01vZGVsYCB3YXRjaGVzIHRoZSBtb2RlbCBieSByZWZlcmVuY2UsIG5vdCB2YWx1ZS4gVGhpcyBpcyBpbXBvcnRhbnQgdG8ga25vdyB3aGVuXG4gKiBiaW5kaW5nIHRoZSBzZWxlY3QgdG8gYSBtb2RlbCB0aGF0IGlzIGFuIG9iamVjdCBvciBhIGNvbGxlY3Rpb24uXG4gKlxuICogT25lIGlzc3VlIG9jY3VycyBpZiB5b3Ugd2FudCB0byBwcmVzZWxlY3QgYW4gb3B0aW9uLiBGb3IgZXhhbXBsZSwgaWYgeW91IHNldFxuICogdGhlIG1vZGVsIHRvIGFuIG9iamVjdCB0aGF0IGlzIGVxdWFsIHRvIGFuIG9iamVjdCBpbiB5b3VyIGNvbGxlY3Rpb24sIGBuZ09wdGlvbnNgIHdvbid0IGJlIGFibGUgdG8gc2V0IHRoZSBzZWxlY3Rpb24sXG4gKiBiZWNhdXNlIHRoZSBvYmplY3RzIGFyZSBub3QgaWRlbnRpY2FsLiBTbyBieSBkZWZhdWx0LCB5b3Ugc2hvdWxkIGFsd2F5cyByZWZlcmVuY2UgdGhlIGl0ZW0gaW4geW91ciBjb2xsZWN0aW9uXG4gKiBmb3IgcHJlc2VsZWN0aW9ucywgZS5nLjogYCRzY29wZS5zZWxlY3RlZCA9ICRzY29wZS5jb2xsZWN0aW9uWzNdYC5cbiAqXG4gKiBBbm90aGVyIHNvbHV0aW9uIGlzIHRvIHVzZSBhIGB0cmFjayBieWAgY2xhdXNlLCBiZWNhdXNlIHRoZW4gYG5nT3B0aW9uc2Agd2lsbCB0cmFjayB0aGUgaWRlbnRpdHlcbiAqIG9mIHRoZSBpdGVtIG5vdCBieSByZWZlcmVuY2UsIGJ1dCBieSB0aGUgcmVzdWx0IG9mIHRoZSBgdHJhY2sgYnlgIGV4cHJlc3Npb24uIEZvciBleGFtcGxlLCBpZiB5b3VyXG4gKiBjb2xsZWN0aW9uIGl0ZW1zIGhhdmUgYW4gaWQgcHJvcGVydHksIHlvdSB3b3VsZCBgdHJhY2sgYnkgaXRlbS5pZGAuXG4gKlxuICogQSBkaWZmZXJlbnQgaXNzdWUgd2l0aCBvYmplY3RzIG9yIGNvbGxlY3Rpb25zIGlzIHRoYXQgbmdNb2RlbCB3b24ndCBkZXRlY3QgaWYgYW4gb2JqZWN0IHByb3BlcnR5IG9yXG4gKiBhIGNvbGxlY3Rpb24gaXRlbSBjaGFuZ2VzLiBGb3IgdGhhdCByZWFzb24sIGBuZ09wdGlvbnNgIGFkZGl0aW9uYWxseSB3YXRjaGVzIHRoZSBtb2RlbCB1c2luZ1xuICogYCR3YXRjaENvbGxlY3Rpb25gLCB3aGVuIHRoZSBleHByZXNzaW9uIGNvbnRhaW5zIGEgYHRyYWNrIGJ5YCBjbGF1c2Ugb3IgdGhlIHRoZSBzZWxlY3QgaGFzIHRoZSBgbXVsdGlwbGVgIGF0dHJpYnV0ZS5cbiAqIFRoaXMgYWxsb3dzIG5nT3B0aW9ucyB0byB0cmlnZ2VyIGEgcmUtcmVuZGVyaW5nIG9mIHRoZSBvcHRpb25zIGV2ZW4gaWYgdGhlIGFjdHVhbCBvYmplY3QvY29sbGVjdGlvblxuICogaGFzIG5vdCBjaGFuZ2VkIGlkZW50aXR5LCBidXQgb25seSBhIHByb3BlcnR5IG9uIHRoZSBvYmplY3Qgb3IgYW4gaXRlbSBpbiB0aGUgY29sbGVjdGlvbiBjaGFuZ2VzLlxuICpcbiAqIE5vdGUgdGhhdCBgJHdhdGNoQ29sbGVjdGlvbmAgZG9lcyBhIHNoYWxsb3cgY29tcGFyaXNvbiBvZiB0aGUgcHJvcGVydGllcyBvZiB0aGUgb2JqZWN0IChvciB0aGUgaXRlbXMgaW4gdGhlIGNvbGxlY3Rpb25cbiAqIGlmIHRoZSBtb2RlbCBpcyBhbiBhcnJheSkuIFRoaXMgbWVhbnMgdGhhdCBjaGFuZ2luZyBhIHByb3BlcnR5IGRlZXBlciB0aGFuIHRoZSBmaXJzdCBsZXZlbCBpbnNpZGUgdGhlXG4gKiBvYmplY3QvY29sbGVjdGlvbiB3aWxsIG5vdCB0cmlnZ2VyIGEgcmUtcmVuZGVyaW5nLlxuICpcbiAqICMjIGBzZWxlY3RgICoqYGFzYCoqXG4gKlxuICogVXNpbmcgYHNlbGVjdGAgKipgYXNgKiogd2lsbCBiaW5kIHRoZSByZXN1bHQgb2YgdGhlIGBzZWxlY3RgIGV4cHJlc3Npb24gdG8gdGhlIG1vZGVsLCBidXRcbiAqIHRoZSB2YWx1ZSBvZiB0aGUgYDxzZWxlY3Q+YCBhbmQgYDxvcHRpb24+YCBodG1sIGVsZW1lbnRzIHdpbGwgYmUgZWl0aGVyIHRoZSBpbmRleCAoZm9yIGFycmF5IGRhdGEgc291cmNlcylcbiAqIG9yIHByb3BlcnR5IG5hbWUgKGZvciBvYmplY3QgZGF0YSBzb3VyY2VzKSBvZiB0aGUgdmFsdWUgd2l0aGluIHRoZSBjb2xsZWN0aW9uLiBJZiBhICoqYHRyYWNrIGJ5YCoqIGV4cHJlc3Npb25cbiAqIGlzIHVzZWQsIHRoZSByZXN1bHQgb2YgdGhhdCBleHByZXNzaW9uIHdpbGwgYmUgc2V0IGFzIHRoZSB2YWx1ZSBvZiB0aGUgYG9wdGlvbmAgYW5kIGBzZWxlY3RgIGVsZW1lbnRzLlxuICpcbiAqXG4gKiAjIyMgYHNlbGVjdGAgKipgYXNgKiogYW5kICoqYHRyYWNrIGJ5YCoqXG4gKlxuICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cbiAqIEJlIGNhcmVmdWwgd2hlbiB1c2luZyBgc2VsZWN0YCAqKmBhc2AqKiBhbmQgKipgdHJhY2sgYnlgKiogaW4gdGhlIHNhbWUgZXhwcmVzc2lvbi5cbiAqIDwvZGl2PlxuICpcbiAqIEdpdmVuIHRoaXMgYXJyYXkgb2YgaXRlbXMgb24gdGhlICRzY29wZTpcbiAqXG4gKiBgYGBqc1xuICogJHNjb3BlLml0ZW1zID0gW3tcbiAqICAgaWQ6IDEsXG4gKiAgIGxhYmVsOiAnYUxhYmVsJyxcbiAqICAgc3ViSXRlbTogeyBuYW1lOiAnYVN1Ykl0ZW0nIH1cbiAqIH0sIHtcbiAqICAgaWQ6IDIsXG4gKiAgIGxhYmVsOiAnYkxhYmVsJyxcbiAqICAgc3ViSXRlbTogeyBuYW1lOiAnYlN1Ykl0ZW0nIH1cbiAqIH1dO1xuICogYGBgXG4gKlxuICogVGhpcyB3aWxsIHdvcms6XG4gKlxuICogYGBgaHRtbFxuICogPHNlbGVjdCBuZy1vcHRpb25zPVwiaXRlbSBhcyBpdGVtLmxhYmVsIGZvciBpdGVtIGluIGl0ZW1zIHRyYWNrIGJ5IGl0ZW0uaWRcIiBuZy1tb2RlbD1cInNlbGVjdGVkXCI+PC9zZWxlY3Q+XG4gKiBgYGBcbiAqIGBgYGpzXG4gKiAkc2NvcGUuc2VsZWN0ZWQgPSAkc2NvcGUuaXRlbXNbMF07XG4gKiBgYGBcbiAqXG4gKiBidXQgdGhpcyB3aWxsIG5vdCB3b3JrOlxuICpcbiAqIGBgYGh0bWxcbiAqIDxzZWxlY3Qgbmctb3B0aW9ucz1cIml0ZW0uc3ViSXRlbSBhcyBpdGVtLmxhYmVsIGZvciBpdGVtIGluIGl0ZW1zIHRyYWNrIGJ5IGl0ZW0uaWRcIiBuZy1tb2RlbD1cInNlbGVjdGVkXCI+PC9zZWxlY3Q+XG4gKiBgYGBcbiAqIGBgYGpzXG4gKiAkc2NvcGUuc2VsZWN0ZWQgPSAkc2NvcGUuaXRlbXNbMF0uc3ViSXRlbTtcbiAqIGBgYFxuICpcbiAqIEluIGJvdGggZXhhbXBsZXMsIHRoZSAqKmB0cmFjayBieWAqKiBleHByZXNzaW9uIGlzIGFwcGxpZWQgc3VjY2Vzc2Z1bGx5IHRvIGVhY2ggYGl0ZW1gIGluIHRoZVxuICogYGl0ZW1zYCBhcnJheS4gQmVjYXVzZSB0aGUgc2VsZWN0ZWQgb3B0aW9uIGhhcyBiZWVuIHNldCBwcm9ncmFtbWF0aWNhbGx5IGluIHRoZSBjb250cm9sbGVyLCB0aGVcbiAqICoqYHRyYWNrIGJ5YCoqIGV4cHJlc3Npb24gaXMgYWxzbyBhcHBsaWVkIHRvIHRoZSBgbmdNb2RlbGAgdmFsdWUuIEluIHRoZSBmaXJzdCBleGFtcGxlLCB0aGVcbiAqIGBuZ01vZGVsYCB2YWx1ZSBpcyBgaXRlbXNbMF1gIGFuZCB0aGUgKipgdHJhY2sgYnlgKiogZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYGl0ZW1zWzBdLmlkYCB3aXRoXG4gKiBubyBpc3N1ZS4gSW4gdGhlIHNlY29uZCBleGFtcGxlLCB0aGUgYG5nTW9kZWxgIHZhbHVlIGlzIGBpdGVtc1swXS5zdWJJdGVtYCBhbmQgdGhlICoqYHRyYWNrIGJ5YCoqXG4gKiBleHByZXNzaW9uIGV2YWx1YXRlcyB0byBgaXRlbXNbMF0uc3ViSXRlbS5pZGAgKHdoaWNoIGlzIHVuZGVmaW5lZCkuIEFzIGEgcmVzdWx0LCB0aGUgbW9kZWwgdmFsdWVcbiAqIGlzIG5vdCBtYXRjaGVkIGFnYWluc3QgYW55IGA8b3B0aW9uPmAgYW5kIHRoZSBgPHNlbGVjdD5gIGFwcGVhcnMgYXMgaGF2aW5nIG5vIHNlbGVjdGVkIHZhbHVlLlxuICpcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmdNb2RlbCBBc3NpZ25hYmxlIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBkYXRhLWJpbmQgdG8uXG4gKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG4gKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFRoZSBjb250cm9sIGlzIGNvbnNpZGVyZWQgdmFsaWQgb25seSBpZiB2YWx1ZSBpcyBlbnRlcmVkLlxuICogQHBhcmFtIHtzdHJpbmc9fSBuZ1JlcXVpcmVkIEFkZHMgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgYW5kIGByZXF1aXJlZGAgdmFsaWRhdGlvbiBjb25zdHJhaW50IHRvXG4gKiAgICB0aGUgZWxlbWVudCB3aGVuIHRoZSBuZ1JlcXVpcmVkIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIHRydWUuIFVzZSBgbmdSZXF1aXJlZGAgaW5zdGVhZCBvZlxuICogICAgYHJlcXVpcmVkYCB3aGVuIHlvdSB3YW50IHRvIGRhdGEtYmluZCB0byB0aGUgYHJlcXVpcmVkYCBhdHRyaWJ1dGUuXG4gKiBAcGFyYW0ge2NvbXByZWhlbnNpb25fZXhwcmVzc2lvbj19IG5nT3B0aW9ucyBpbiBvbmUgb2YgdGhlIGZvbGxvd2luZyBmb3JtczpcbiAqXG4gKiAgICogZm9yIGFycmF5IGRhdGEgc291cmNlczpcbiAqICAgICAqIGBsYWJlbGAgKipgZm9yYCoqIGB2YWx1ZWAgKipgaW5gKiogYGFycmF5YFxuICogICAgICogYHNlbGVjdGAgKipgYXNgKiogYGxhYmVsYCAqKmBmb3JgKiogYHZhbHVlYCAqKmBpbmAqKiBgYXJyYXlgXG4gKiAgICAgKiBgbGFiZWxgICoqYGdyb3VwIGJ5YCoqIGBncm91cGAgKipgZm9yYCoqIGB2YWx1ZWAgKipgaW5gKiogYGFycmF5YFxuICogICAgICogYGxhYmVsYCAqKmBkaXNhYmxlIHdoZW5gKiogYGRpc2FibGVgICoqYGZvcmAqKiBgdmFsdWVgICoqYGluYCoqIGBhcnJheWBcbiAqICAgICAqIGBsYWJlbGAgKipgZ3JvdXAgYnlgKiogYGdyb3VwYCAqKmBmb3JgKiogYHZhbHVlYCAqKmBpbmAqKiBgYXJyYXlgICoqYHRyYWNrIGJ5YCoqIGB0cmFja2V4cHJgXG4gKiAgICAgKiBgbGFiZWxgICoqYGRpc2FibGUgd2hlbmAqKiBgZGlzYWJsZWAgKipgZm9yYCoqIGB2YWx1ZWAgKipgaW5gKiogYGFycmF5YCAqKmB0cmFjayBieWAqKiBgdHJhY2tleHByYFxuICogICAgICogYGxhYmVsYCAqKmBmb3JgKiogYHZhbHVlYCAqKmBpbmAqKiBgYXJyYXlgIHwgb3JkZXJCeTpgb3JkZXJleHByYCAqKmB0cmFjayBieWAqKiBgdHJhY2tleHByYFxuICogICAgICAgIChmb3IgaW5jbHVkaW5nIGEgZmlsdGVyIHdpdGggYHRyYWNrIGJ5YClcbiAqICAgKiBmb3Igb2JqZWN0IGRhdGEgc291cmNlczpcbiAqICAgICAqIGBsYWJlbGAgKipgZm9yIChgKipga2V5YCAqKmAsYCoqIGB2YWx1ZWAqKmApIGluYCoqIGBvYmplY3RgXG4gKiAgICAgKiBgc2VsZWN0YCAqKmBhc2AqKiBgbGFiZWxgICoqYGZvciAoYCoqYGtleWAgKipgLGAqKiBgdmFsdWVgKipgKSBpbmAqKiBgb2JqZWN0YFxuICogICAgICogYGxhYmVsYCAqKmBncm91cCBieWAqKiBgZ3JvdXBgICoqYGZvciAoYCoqYGtleWAqKmAsYCoqIGB2YWx1ZWAqKmApIGluYCoqIGBvYmplY3RgXG4gKiAgICAgKiBgbGFiZWxgICoqYGRpc2FibGUgd2hlbmAqKiBgZGlzYWJsZWAgKipgZm9yIChgKipga2V5YCoqYCxgKiogYHZhbHVlYCoqYCkgaW5gKiogYG9iamVjdGBcbiAqICAgICAqIGBzZWxlY3RgICoqYGFzYCoqIGBsYWJlbGAgKipgZ3JvdXAgYnlgKiogYGdyb3VwYFxuICogICAgICAgICAqKmBmb3JgIGAoYCoqYGtleWAqKmAsYCoqIGB2YWx1ZWAqKmApIGluYCoqIGBvYmplY3RgXG4gKiAgICAgKiBgc2VsZWN0YCAqKmBhc2AqKiBgbGFiZWxgICoqYGRpc2FibGUgd2hlbmAqKiBgZGlzYWJsZWBcbiAqICAgICAgICAgKipgZm9yYCBgKGAqKmBrZXlgKipgLGAqKiBgdmFsdWVgKipgKSBpbmAqKiBgb2JqZWN0YFxuICpcbiAqIFdoZXJlOlxuICpcbiAqICAgKiBgYXJyYXlgIC8gYG9iamVjdGA6IGFuIGV4cHJlc3Npb24gd2hpY2ggZXZhbHVhdGVzIHRvIGFuIGFycmF5IC8gb2JqZWN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAqICAgKiBgdmFsdWVgOiBsb2NhbCB2YXJpYWJsZSB3aGljaCB3aWxsIHJlZmVyIHRvIGVhY2ggaXRlbSBpbiB0aGUgYGFycmF5YCBvciBlYWNoIHByb3BlcnR5IHZhbHVlXG4gKiAgICAgIG9mIGBvYmplY3RgIGR1cmluZyBpdGVyYXRpb24uXG4gKiAgICogYGtleWA6IGxvY2FsIHZhcmlhYmxlIHdoaWNoIHdpbGwgcmVmZXIgdG8gYSBwcm9wZXJ0eSBuYW1lIGluIGBvYmplY3RgIGR1cmluZyBpdGVyYXRpb24uXG4gKiAgICogYGxhYmVsYDogVGhlIHJlc3VsdCBvZiB0aGlzIGV4cHJlc3Npb24gd2lsbCBiZSB0aGUgbGFiZWwgZm9yIGA8b3B0aW9uPmAgZWxlbWVudC4gVGhlXG4gKiAgICAgYGV4cHJlc3Npb25gIHdpbGwgbW9zdCBsaWtlbHkgcmVmZXIgdG8gdGhlIGB2YWx1ZWAgdmFyaWFibGUgKGUuZy4gYHZhbHVlLnByb3BlcnR5TmFtZWApLlxuICogICAqIGBzZWxlY3RgOiBUaGUgcmVzdWx0IG9mIHRoaXMgZXhwcmVzc2lvbiB3aWxsIGJlIGJvdW5kIHRvIHRoZSBtb2RlbCBvZiB0aGUgcGFyZW50IGA8c2VsZWN0PmBcbiAqICAgICAgZWxlbWVudC4gSWYgbm90IHNwZWNpZmllZCwgYHNlbGVjdGAgZXhwcmVzc2lvbiB3aWxsIGRlZmF1bHQgdG8gYHZhbHVlYC5cbiAqICAgKiBgZ3JvdXBgOiBUaGUgcmVzdWx0IG9mIHRoaXMgZXhwcmVzc2lvbiB3aWxsIGJlIHVzZWQgdG8gZ3JvdXAgb3B0aW9ucyB1c2luZyB0aGUgYDxvcHRncm91cD5gXG4gKiAgICAgIERPTSBlbGVtZW50LlxuICogICAqIGBkaXNhYmxlYDogVGhlIHJlc3VsdCBvZiB0aGlzIGV4cHJlc3Npb24gd2lsbCBiZSB1c2VkIHRvIGRpc2FibGUgdGhlIHJlbmRlcmVkIGA8b3B0aW9uPmBcbiAqICAgICAgZWxlbWVudC4gUmV0dXJuIGB0cnVlYCB0byBkaXNhYmxlLlxuICogICAqIGB0cmFja2V4cHJgOiBVc2VkIHdoZW4gd29ya2luZyB3aXRoIGFuIGFycmF5IG9mIG9iamVjdHMuIFRoZSByZXN1bHQgb2YgdGhpcyBleHByZXNzaW9uIHdpbGwgYmVcbiAqICAgICAgdXNlZCB0byBpZGVudGlmeSB0aGUgb2JqZWN0cyBpbiB0aGUgYXJyYXkuIFRoZSBgdHJhY2tleHByYCB3aWxsIG1vc3QgbGlrZWx5IHJlZmVyIHRvIHRoZVxuICogICAgIGB2YWx1ZWAgdmFyaWFibGUgKGUuZy4gYHZhbHVlLnByb3BlcnR5TmFtZWApLiBXaXRoIHRoaXMgdGhlIHNlbGVjdGlvbiBpcyBwcmVzZXJ2ZWRcbiAqICAgICAgZXZlbiB3aGVuIHRoZSBvcHRpb25zIGFyZSByZWNyZWF0ZWQgKGUuZy4gcmVsb2FkZWQgZnJvbSB0aGUgc2VydmVyKS5cbiAqXG4gKiBAZXhhbXBsZVxuICAgIDxleGFtcGxlIG1vZHVsZT1cInNlbGVjdEV4YW1wbGVcIj5cbiAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgIDxzY3JpcHQ+XG4gICAgICAgIGFuZ3VsYXIubW9kdWxlKCdzZWxlY3RFeGFtcGxlJywgW10pXG4gICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgICAgICRzY29wZS5jb2xvcnMgPSBbXG4gICAgICAgICAgICAgIHtuYW1lOidibGFjaycsIHNoYWRlOidkYXJrJ30sXG4gICAgICAgICAgICAgIHtuYW1lOid3aGl0ZScsIHNoYWRlOidsaWdodCcsIG5vdEFuT3B0aW9uOiB0cnVlfSxcbiAgICAgICAgICAgICAge25hbWU6J3JlZCcsIHNoYWRlOidkYXJrJ30sXG4gICAgICAgICAgICAgIHtuYW1lOidibHVlJywgc2hhZGU6J2RhcmsnLCBub3RBbk9wdGlvbjogdHJ1ZX0sXG4gICAgICAgICAgICAgIHtuYW1lOid5ZWxsb3cnLCBzaGFkZTonbGlnaHQnLCBub3RBbk9wdGlvbjogZmFsc2V9XG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgJHNjb3BlLm15Q29sb3IgPSAkc2NvcGUuY29sb3JzWzJdOyAvLyByZWRcbiAgICAgICAgICB9XSk7XG4gICAgICAgIDwvc2NyaXB0PlxuICAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICAgICAgIDx1bD5cbiAgICAgICAgICAgIDxsaSBuZy1yZXBlYXQ9XCJjb2xvciBpbiBjb2xvcnNcIj5cbiAgICAgICAgICAgICAgPGxhYmVsPk5hbWU6IDxpbnB1dCBuZy1tb2RlbD1cImNvbG9yLm5hbWVcIj48L2xhYmVsPlxuICAgICAgICAgICAgICA8bGFiZWw+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiY29sb3Iubm90QW5PcHRpb25cIj4gRGlzYWJsZWQ/PC9sYWJlbD5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cImNvbG9ycy5zcGxpY2UoJGluZGV4LCAxKVwiIGFyaWEtbGFiZWw9XCJSZW1vdmVcIj5YPC9idXR0b24+XG4gICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwiY29sb3JzLnB1c2goe30pXCI+YWRkPC9idXR0b24+XG4gICAgICAgICAgICA8L2xpPlxuICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgPGhyLz5cbiAgICAgICAgICA8bGFiZWw+Q29sb3IgKG51bGwgbm90IGFsbG93ZWQpOlxuICAgICAgICAgICAgPHNlbGVjdCBuZy1tb2RlbD1cIm15Q29sb3JcIiBuZy1vcHRpb25zPVwiY29sb3IubmFtZSBmb3IgY29sb3IgaW4gY29sb3JzXCI+PC9zZWxlY3Q+XG4gICAgICAgICAgPC9sYWJlbD48YnIvPlxuICAgICAgICAgIDxsYWJlbD5Db2xvciAobnVsbCBhbGxvd2VkKTpcbiAgICAgICAgICA8c3BhbiAgY2xhc3M9XCJudWxsYWJsZVwiPlxuICAgICAgICAgICAgPHNlbGVjdCBuZy1tb2RlbD1cIm15Q29sb3JcIiBuZy1vcHRpb25zPVwiY29sb3IubmFtZSBmb3IgY29sb3IgaW4gY29sb3JzXCI+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJcIj4tLSBjaG9vc2UgY29sb3IgLS08L29wdGlvbj5cbiAgICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICAgIDwvc3Bhbj48L2xhYmVsPjxici8+XG5cbiAgICAgICAgICA8bGFiZWw+Q29sb3IgZ3JvdXBlZCBieSBzaGFkZTpcbiAgICAgICAgICAgIDxzZWxlY3QgbmctbW9kZWw9XCJteUNvbG9yXCIgbmctb3B0aW9ucz1cImNvbG9yLm5hbWUgZ3JvdXAgYnkgY29sb3Iuc2hhZGUgZm9yIGNvbG9yIGluIGNvbG9yc1wiPlxuICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgPC9sYWJlbD48YnIvPlxuXG4gICAgICAgICAgPGxhYmVsPkNvbG9yIGdyb3VwZWQgYnkgc2hhZGUsIHdpdGggc29tZSBkaXNhYmxlZDpcbiAgICAgICAgICAgIDxzZWxlY3QgbmctbW9kZWw9XCJteUNvbG9yXCJcbiAgICAgICAgICAgICAgICAgIG5nLW9wdGlvbnM9XCJjb2xvci5uYW1lIGdyb3VwIGJ5IGNvbG9yLnNoYWRlIGRpc2FibGUgd2hlbiBjb2xvci5ub3RBbk9wdGlvbiBmb3IgY29sb3IgaW4gY29sb3JzXCI+XG4gICAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICA8L2xhYmVsPjxici8+XG5cblxuXG4gICAgICAgICAgU2VsZWN0IDxidXR0b24gbmctY2xpY2s9XCJteUNvbG9yID0geyBuYW1lOidub3QgaW4gbGlzdCcsIHNoYWRlOiAnb3RoZXInIH1cIj5ib2d1czwvYnV0dG9uPi5cbiAgICAgICAgICA8YnIvPlxuICAgICAgICAgIDxoci8+XG4gICAgICAgICAgQ3VycmVudGx5IHNlbGVjdGVkOiB7eyB7c2VsZWN0ZWRfY29sb3I6bXlDb2xvcn0gfX1cbiAgICAgICAgICA8ZGl2IHN0eWxlPVwiYm9yZGVyOnNvbGlkIDFweCBibGFjazsgaGVpZ2h0OjIwcHhcIlxuICAgICAgICAgICAgICAgbmctc3R5bGU9XCJ7J2JhY2tncm91bmQtY29sb3InOm15Q29sb3IubmFtZX1cIj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2ZpbGU+XG4gICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgICBpdCgnc2hvdWxkIGNoZWNrIG5nLW9wdGlvbnMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygne3NlbGVjdGVkX2NvbG9yOm15Q29sb3J9JykpLmdldFRleHQoKSkudG9NYXRjaCgncmVkJyk7XG4gICAgICAgICAgIGVsZW1lbnQuYWxsKGJ5Lm1vZGVsKCdteUNvbG9yJykpLmZpcnN0KCkuY2xpY2soKTtcbiAgICAgICAgICAgZWxlbWVudC5hbGwoYnkuY3NzKCdzZWxlY3RbbmctbW9kZWw9XCJteUNvbG9yXCJdIG9wdGlvbicpKS5maXJzdCgpLmNsaWNrKCk7XG4gICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ3tzZWxlY3RlZF9jb2xvcjpteUNvbG9yfScpKS5nZXRUZXh0KCkpLnRvTWF0Y2goJ2JsYWNrJyk7XG4gICAgICAgICAgIGVsZW1lbnQoYnkuY3NzKCcubnVsbGFibGUgc2VsZWN0W25nLW1vZGVsPVwibXlDb2xvclwiXScpKS5jbGljaygpO1xuICAgICAgICAgICBlbGVtZW50LmFsbChieS5jc3MoJy5udWxsYWJsZSBzZWxlY3RbbmctbW9kZWw9XCJteUNvbG9yXCJdIG9wdGlvbicpKS5maXJzdCgpLmNsaWNrKCk7XG4gICAgICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmJpbmRpbmcoJ3tzZWxlY3RlZF9jb2xvcjpteUNvbG9yfScpKS5nZXRUZXh0KCkpLnRvTWF0Y2goJ251bGwnKTtcbiAgICAgICAgIH0pO1xuICAgICAgPC9maWxlPlxuICAgIDwvZXhhbXBsZT5cbiAqL1xuXG4vLyBqc2hpbnQgbWF4bGVuOiBmYWxzZVxuLy8gICAgICAgICAgICAgICAgICAgICAvLzAwMDAxMTExMTExMTExMDAwMDAwMDAwMDAyMjIyMjIyMjIyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMzMzMzMzMzMzMzAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA0NDQ0NDQ0NDQ0NDAwMDAwMDAwMDAwMDA1NTU1NTU1NTU1NTU1NTUwMDAwMDAwMDA2NjY2NjY2NjY2NjY2NjYwMDAwMDAwNzc3Nzc3Nzc3Nzc3Nzc3MDAwMDAwMDAwMDAwMDAwODg4ODg4ODg4ODAwMDAwMDAwMDAwMDAwMDAwMDA5OTk5OTk5OTk5XG52YXIgTkdfT1BUSU9OU19SRUdFWFAgPSAvXlxccyooW1xcc1xcU10rPykoPzpcXHMrYXNcXHMrKFtcXHNcXFNdKz8pKT8oPzpcXHMrZ3JvdXBcXHMrYnlcXHMrKFtcXHNcXFNdKz8pKT8oPzpcXHMrZGlzYWJsZVxccyt3aGVuXFxzKyhbXFxzXFxTXSs/KSk/XFxzK2ZvclxccysoPzooW1xcJFxcd11bXFwkXFx3XSopfCg/OlxcKFxccyooW1xcJFxcd11bXFwkXFx3XSopXFxzKixcXHMqKFtcXCRcXHddW1xcJFxcd10qKVxccypcXCkpKVxccytpblxccysoW1xcc1xcU10rPykoPzpcXHMrdHJhY2tcXHMrYnlcXHMrKFtcXHNcXFNdKz8pKT8kLztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDE6IHZhbHVlIGV4cHJlc3Npb24gKHZhbHVlRm4pXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAyOiBsYWJlbCBleHByZXNzaW9uIChkaXNwbGF5Rm4pXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAzOiBncm91cCBieSBleHByZXNzaW9uIChncm91cEJ5Rm4pXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyA0OiBkaXNhYmxlIHdoZW4gZXhwcmVzc2lvbiAoZGlzYWJsZVdoZW5GbilcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDU6IGFycmF5IGl0ZW0gdmFyaWFibGUgbmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gNjogb2JqZWN0IGl0ZW0ga2V5IHZhcmlhYmxlIG5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDc6IG9iamVjdCBpdGVtIHZhbHVlIHZhcmlhYmxlIG5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDg6IGNvbGxlY3Rpb24gZXhwcmVzc2lvblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gOTogdHJhY2sgYnkgZXhwcmVzc2lvblxuLy8ganNoaW50IG1heGxlbjogMTAwXG5cblxudmFyIG5nT3B0aW9uc0RpcmVjdGl2ZSA9IFsnJGNvbXBpbGUnLCAnJHBhcnNlJywgZnVuY3Rpb24oJGNvbXBpbGUsICRwYXJzZSkge1xuXG4gIGZ1bmN0aW9uIHBhcnNlT3B0aW9uc0V4cHJlc3Npb24ob3B0aW9uc0V4cCwgc2VsZWN0RWxlbWVudCwgc2NvcGUpIHtcblxuICAgIHZhciBtYXRjaCA9IG9wdGlvbnNFeHAubWF0Y2goTkdfT1BUSU9OU19SRUdFWFApO1xuICAgIGlmICghKG1hdGNoKSkge1xuICAgICAgdGhyb3cgbmdPcHRpb25zTWluRXJyKCdpZXhwJyxcbiAgICAgICAgXCJFeHBlY3RlZCBleHByZXNzaW9uIGluIGZvcm0gb2YgXCIgK1xuICAgICAgICBcIidfc2VsZWN0XyAoYXMgX2xhYmVsXyk/IGZvciAoX2tleV8sKT9fdmFsdWVfIGluIF9jb2xsZWN0aW9uXydcIiArXG4gICAgICAgIFwiIGJ1dCBnb3QgJ3swfScuIEVsZW1lbnQ6IHsxfVwiLFxuICAgICAgICBvcHRpb25zRXhwLCBzdGFydGluZ1RhZyhzZWxlY3RFbGVtZW50KSk7XG4gICAgfVxuXG4gICAgLy8gRXh0cmFjdCB0aGUgcGFydHMgZnJvbSB0aGUgbmdPcHRpb25zIGV4cHJlc3Npb25cblxuICAgIC8vIFRoZSB2YXJpYWJsZSBuYW1lIGZvciB0aGUgdmFsdWUgb2YgdGhlIGl0ZW0gaW4gdGhlIGNvbGxlY3Rpb25cbiAgICB2YXIgdmFsdWVOYW1lID0gbWF0Y2hbNV0gfHwgbWF0Y2hbN107XG4gICAgLy8gVGhlIHZhcmlhYmxlIG5hbWUgZm9yIHRoZSBrZXkgb2YgdGhlIGl0ZW0gaW4gdGhlIGNvbGxlY3Rpb25cbiAgICB2YXIga2V5TmFtZSA9IG1hdGNoWzZdO1xuXG4gICAgLy8gQW4gZXhwcmVzc2lvbiB0aGF0IGdlbmVyYXRlcyB0aGUgdmlld1ZhbHVlIGZvciBhbiBvcHRpb24gaWYgdGhlcmUgaXMgYSBsYWJlbCBleHByZXNzaW9uXG4gICAgdmFyIHNlbGVjdEFzID0gLyBhcyAvLnRlc3QobWF0Y2hbMF0pICYmIG1hdGNoWzFdO1xuICAgIC8vIEFuIGV4cHJlc3Npb24gdGhhdCBpcyB1c2VkIHRvIHRyYWNrIHRoZSBpZCBvZiBlYWNoIG9iamVjdCBpbiB0aGUgb3B0aW9ucyBjb2xsZWN0aW9uXG4gICAgdmFyIHRyYWNrQnkgPSBtYXRjaFs5XTtcbiAgICAvLyBBbiBleHByZXNzaW9uIHRoYXQgZ2VuZXJhdGVzIHRoZSB2aWV3VmFsdWUgZm9yIGFuIG9wdGlvbiBpZiB0aGVyZSBpcyBubyBsYWJlbCBleHByZXNzaW9uXG4gICAgdmFyIHZhbHVlRm4gPSAkcGFyc2UobWF0Y2hbMl0gPyBtYXRjaFsxXSA6IHZhbHVlTmFtZSk7XG4gICAgdmFyIHNlbGVjdEFzRm4gPSBzZWxlY3RBcyAmJiAkcGFyc2Uoc2VsZWN0QXMpO1xuICAgIHZhciB2aWV3VmFsdWVGbiA9IHNlbGVjdEFzRm4gfHwgdmFsdWVGbjtcbiAgICB2YXIgdHJhY2tCeUZuID0gdHJhY2tCeSAmJiAkcGFyc2UodHJhY2tCeSk7XG5cbiAgICAvLyBHZXQgdGhlIHZhbHVlIGJ5IHdoaWNoIHdlIGFyZSBnb2luZyB0byB0cmFjayB0aGUgb3B0aW9uXG4gICAgLy8gaWYgd2UgaGF2ZSBhIHRyYWNrRm4gdGhlbiB1c2UgdGhhdCAocGFzc2luZyBzY29wZSBhbmQgbG9jYWxzKVxuICAgIC8vIG90aGVyd2lzZSBqdXN0IGhhc2ggdGhlIGdpdmVuIHZpZXdWYWx1ZVxuICAgIHZhciBnZXRUcmFja0J5VmFsdWVGbiA9IHRyYWNrQnkgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24odmFsdWUsIGxvY2FscykgeyByZXR1cm4gdHJhY2tCeUZuKHNjb3BlLCBsb2NhbHMpOyB9IDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldEhhc2hPZlZhbHVlKHZhbHVlKSB7IHJldHVybiBoYXNoS2V5KHZhbHVlKTsgfTtcbiAgICB2YXIgZ2V0VHJhY2tCeVZhbHVlID0gZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgcmV0dXJuIGdldFRyYWNrQnlWYWx1ZUZuKHZhbHVlLCBnZXRMb2NhbHModmFsdWUsIGtleSkpO1xuICAgIH07XG5cbiAgICB2YXIgZGlzcGxheUZuID0gJHBhcnNlKG1hdGNoWzJdIHx8IG1hdGNoWzFdKTtcbiAgICB2YXIgZ3JvdXBCeUZuID0gJHBhcnNlKG1hdGNoWzNdIHx8ICcnKTtcbiAgICB2YXIgZGlzYWJsZVdoZW5GbiA9ICRwYXJzZShtYXRjaFs0XSB8fCAnJyk7XG4gICAgdmFyIHZhbHVlc0ZuID0gJHBhcnNlKG1hdGNoWzhdKTtcblxuICAgIHZhciBsb2NhbHMgPSB7fTtcbiAgICB2YXIgZ2V0TG9jYWxzID0ga2V5TmFtZSA/IGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgIGxvY2Fsc1trZXlOYW1lXSA9IGtleTtcbiAgICAgIGxvY2Fsc1t2YWx1ZU5hbWVdID0gdmFsdWU7XG4gICAgICByZXR1cm4gbG9jYWxzO1xuICAgIH0gOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgbG9jYWxzW3ZhbHVlTmFtZV0gPSB2YWx1ZTtcbiAgICAgIHJldHVybiBsb2NhbHM7XG4gICAgfTtcblxuXG4gICAgZnVuY3Rpb24gT3B0aW9uKHNlbGVjdFZhbHVlLCB2aWV3VmFsdWUsIGxhYmVsLCBncm91cCwgZGlzYWJsZWQpIHtcbiAgICAgIHRoaXMuc2VsZWN0VmFsdWUgPSBzZWxlY3RWYWx1ZTtcbiAgICAgIHRoaXMudmlld1ZhbHVlID0gdmlld1ZhbHVlO1xuICAgICAgdGhpcy5sYWJlbCA9IGxhYmVsO1xuICAgICAgdGhpcy5ncm91cCA9IGdyb3VwO1xuICAgICAgdGhpcy5kaXNhYmxlZCA9IGRpc2FibGVkO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldE9wdGlvblZhbHVlc0tleXMob3B0aW9uVmFsdWVzKSB7XG4gICAgICB2YXIgb3B0aW9uVmFsdWVzS2V5cztcblxuICAgICAgaWYgKCFrZXlOYW1lICYmIGlzQXJyYXlMaWtlKG9wdGlvblZhbHVlcykpIHtcbiAgICAgICAgb3B0aW9uVmFsdWVzS2V5cyA9IG9wdGlvblZhbHVlcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGlmIG9iamVjdCwgZXh0cmFjdCBrZXlzLCBpbiBlbnVtZXJhdGlvbiBvcmRlciwgdW5zb3J0ZWRcbiAgICAgICAgb3B0aW9uVmFsdWVzS2V5cyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpdGVtS2V5IGluIG9wdGlvblZhbHVlcykge1xuICAgICAgICAgIGlmIChvcHRpb25WYWx1ZXMuaGFzT3duUHJvcGVydHkoaXRlbUtleSkgJiYgaXRlbUtleS5jaGFyQXQoMCkgIT09ICckJykge1xuICAgICAgICAgICAgb3B0aW9uVmFsdWVzS2V5cy5wdXNoKGl0ZW1LZXkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG9wdGlvblZhbHVlc0tleXM7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRyYWNrQnk6IHRyYWNrQnksXG4gICAgICBnZXRUcmFja0J5VmFsdWU6IGdldFRyYWNrQnlWYWx1ZSxcbiAgICAgIGdldFdhdGNoYWJsZXM6ICRwYXJzZSh2YWx1ZXNGbiwgZnVuY3Rpb24ob3B0aW9uVmFsdWVzKSB7XG4gICAgICAgIC8vIENyZWF0ZSBhIGNvbGxlY3Rpb24gb2YgdGhpbmdzIHRoYXQgd2Ugd291bGQgbGlrZSB0byB3YXRjaCAod2F0Y2hlZEFycmF5KVxuICAgICAgICAvLyBzbyB0aGF0IHRoZXkgY2FuIGFsbCBiZSB3YXRjaGVkIHVzaW5nIGEgc2luZ2xlICR3YXRjaENvbGxlY3Rpb25cbiAgICAgICAgLy8gdGhhdCBvbmx5IHJ1bnMgdGhlIGhhbmRsZXIgb25jZSBpZiBhbnl0aGluZyBjaGFuZ2VzXG4gICAgICAgIHZhciB3YXRjaGVkQXJyYXkgPSBbXTtcbiAgICAgICAgb3B0aW9uVmFsdWVzID0gb3B0aW9uVmFsdWVzIHx8IFtdO1xuXG4gICAgICAgIHZhciBvcHRpb25WYWx1ZXNLZXlzID0gZ2V0T3B0aW9uVmFsdWVzS2V5cyhvcHRpb25WYWx1ZXMpO1xuICAgICAgICB2YXIgb3B0aW9uVmFsdWVzTGVuZ3RoID0gb3B0aW9uVmFsdWVzS2V5cy5sZW5ndGg7XG4gICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBvcHRpb25WYWx1ZXNMZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICB2YXIga2V5ID0gKG9wdGlvblZhbHVlcyA9PT0gb3B0aW9uVmFsdWVzS2V5cykgPyBpbmRleCA6IG9wdGlvblZhbHVlc0tleXNbaW5kZXhdO1xuICAgICAgICAgIHZhciB2YWx1ZSA9IG9wdGlvblZhbHVlc1trZXldO1xuXG4gICAgICAgICAgdmFyIGxvY2FscyA9IGdldExvY2FscyhvcHRpb25WYWx1ZXNba2V5XSwga2V5KTtcbiAgICAgICAgICB2YXIgc2VsZWN0VmFsdWUgPSBnZXRUcmFja0J5VmFsdWVGbihvcHRpb25WYWx1ZXNba2V5XSwgbG9jYWxzKTtcbiAgICAgICAgICB3YXRjaGVkQXJyYXkucHVzaChzZWxlY3RWYWx1ZSk7XG5cbiAgICAgICAgICAvLyBPbmx5IG5lZWQgdG8gd2F0Y2ggdGhlIGRpc3BsYXlGbiBpZiB0aGVyZSBpcyBhIHNwZWNpZmljIGxhYmVsIGV4cHJlc3Npb25cbiAgICAgICAgICBpZiAobWF0Y2hbMl0gfHwgbWF0Y2hbMV0pIHtcbiAgICAgICAgICAgIHZhciBsYWJlbCA9IGRpc3BsYXlGbihzY29wZSwgbG9jYWxzKTtcbiAgICAgICAgICAgIHdhdGNoZWRBcnJheS5wdXNoKGxhYmVsKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBPbmx5IG5lZWQgdG8gd2F0Y2ggdGhlIGRpc2FibGVXaGVuRm4gaWYgdGhlcmUgaXMgYSBzcGVjaWZpYyBkaXNhYmxlIGV4cHJlc3Npb25cbiAgICAgICAgICBpZiAobWF0Y2hbNF0pIHtcbiAgICAgICAgICAgIHZhciBkaXNhYmxlV2hlbiA9IGRpc2FibGVXaGVuRm4oc2NvcGUsIGxvY2Fscyk7XG4gICAgICAgICAgICB3YXRjaGVkQXJyYXkucHVzaChkaXNhYmxlV2hlbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3YXRjaGVkQXJyYXk7XG4gICAgICB9KSxcblxuICAgICAgZ2V0T3B0aW9uczogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgdmFyIG9wdGlvbkl0ZW1zID0gW107XG4gICAgICAgIHZhciBzZWxlY3RWYWx1ZU1hcCA9IHt9O1xuXG4gICAgICAgIC8vIFRoZSBvcHRpb24gdmFsdWVzIHdlcmUgYWxyZWFkeSBjb21wdXRlZCBpbiB0aGUgYGdldFdhdGNoYWJsZXNgIGZuLFxuICAgICAgICAvLyB3aGljaCBtdXN0IGhhdmUgYmVlbiBjYWxsZWQgdG8gdHJpZ2dlciBgZ2V0T3B0aW9uc2BcbiAgICAgICAgdmFyIG9wdGlvblZhbHVlcyA9IHZhbHVlc0ZuKHNjb3BlKSB8fCBbXTtcbiAgICAgICAgdmFyIG9wdGlvblZhbHVlc0tleXMgPSBnZXRPcHRpb25WYWx1ZXNLZXlzKG9wdGlvblZhbHVlcyk7XG4gICAgICAgIHZhciBvcHRpb25WYWx1ZXNMZW5ndGggPSBvcHRpb25WYWx1ZXNLZXlzLmxlbmd0aDtcblxuICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgb3B0aW9uVmFsdWVzTGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgdmFyIGtleSA9IChvcHRpb25WYWx1ZXMgPT09IG9wdGlvblZhbHVlc0tleXMpID8gaW5kZXggOiBvcHRpb25WYWx1ZXNLZXlzW2luZGV4XTtcbiAgICAgICAgICB2YXIgdmFsdWUgPSBvcHRpb25WYWx1ZXNba2V5XTtcbiAgICAgICAgICB2YXIgbG9jYWxzID0gZ2V0TG9jYWxzKHZhbHVlLCBrZXkpO1xuICAgICAgICAgIHZhciB2aWV3VmFsdWUgPSB2aWV3VmFsdWVGbihzY29wZSwgbG9jYWxzKTtcbiAgICAgICAgICB2YXIgc2VsZWN0VmFsdWUgPSBnZXRUcmFja0J5VmFsdWVGbih2aWV3VmFsdWUsIGxvY2Fscyk7XG4gICAgICAgICAgdmFyIGxhYmVsID0gZGlzcGxheUZuKHNjb3BlLCBsb2NhbHMpO1xuICAgICAgICAgIHZhciBncm91cCA9IGdyb3VwQnlGbihzY29wZSwgbG9jYWxzKTtcbiAgICAgICAgICB2YXIgZGlzYWJsZWQgPSBkaXNhYmxlV2hlbkZuKHNjb3BlLCBsb2NhbHMpO1xuICAgICAgICAgIHZhciBvcHRpb25JdGVtID0gbmV3IE9wdGlvbihzZWxlY3RWYWx1ZSwgdmlld1ZhbHVlLCBsYWJlbCwgZ3JvdXAsIGRpc2FibGVkKTtcblxuICAgICAgICAgIG9wdGlvbkl0ZW1zLnB1c2gob3B0aW9uSXRlbSk7XG4gICAgICAgICAgc2VsZWN0VmFsdWVNYXBbc2VsZWN0VmFsdWVdID0gb3B0aW9uSXRlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaXRlbXM6IG9wdGlvbkl0ZW1zLFxuICAgICAgICAgIHNlbGVjdFZhbHVlTWFwOiBzZWxlY3RWYWx1ZU1hcCxcbiAgICAgICAgICBnZXRPcHRpb25Gcm9tVmlld1ZhbHVlOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGVjdFZhbHVlTWFwW2dldFRyYWNrQnlWYWx1ZSh2YWx1ZSldO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZ2V0Vmlld1ZhbHVlRnJvbU9wdGlvbjogZnVuY3Rpb24ob3B0aW9uKSB7XG4gICAgICAgICAgICAvLyBJZiB0aGUgdmlld1ZhbHVlIGNvdWxkIGJlIGFuIG9iamVjdCB0aGF0IG1heSBiZSBtdXRhdGVkIGJ5IHRoZSBhcHBsaWNhdGlvbixcbiAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gbWFrZSBhIGNvcHkgYW5kIG5vdCByZXR1cm4gdGhlIHJlZmVyZW5jZSB0byB0aGUgdmFsdWUgb24gdGhlIG9wdGlvbi5cbiAgICAgICAgICAgIHJldHVybiB0cmFja0J5ID8gYW5ndWxhci5jb3B5KG9wdGlvbi52aWV3VmFsdWUpIDogb3B0aW9uLnZpZXdWYWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG5cbiAgLy8gd2UgY2FuJ3QganVzdCBqcUxpdGUoJzxvcHRpb24+Jykgc2luY2UganFMaXRlIGlzIG5vdCBzbWFydCBlbm91Z2hcbiAgLy8gdG8gY3JlYXRlIGl0IGluIDxzZWxlY3Q+IGFuZCBJRSBiYXJmcyBvdGhlcndpc2UuXG4gIHZhciBvcHRpb25UZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpLFxuICAgICAgb3B0R3JvdXBUZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGdyb3VwJyk7XG5cbiAgICBmdW5jdGlvbiBuZ09wdGlvbnNQb3N0TGluayhzY29wZSwgc2VsZWN0RWxlbWVudCwgYXR0ciwgY3RybHMpIHtcblxuICAgICAgdmFyIHNlbGVjdEN0cmwgPSBjdHJsc1swXTtcbiAgICAgIHZhciBuZ01vZGVsQ3RybCA9IGN0cmxzWzFdO1xuICAgICAgdmFyIG11bHRpcGxlID0gYXR0ci5tdWx0aXBsZTtcblxuICAgICAgLy8gVGhlIGVtcHR5T3B0aW9uIGFsbG93cyB0aGUgYXBwbGljYXRpb24gZGV2ZWxvcGVyIHRvIHByb3ZpZGUgdGhlaXIgb3duIGN1c3RvbSBcImVtcHR5XCJcbiAgICAgIC8vIG9wdGlvbiB3aGVuIHRoZSB2aWV3VmFsdWUgZG9lcyBub3QgbWF0Y2ggYW55IG9mIHRoZSBvcHRpb24gdmFsdWVzLlxuICAgICAgdmFyIGVtcHR5T3B0aW9uO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGNoaWxkcmVuID0gc2VsZWN0RWxlbWVudC5jaGlsZHJlbigpLCBpaSA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgaWYgKGNoaWxkcmVuW2ldLnZhbHVlID09PSAnJykge1xuICAgICAgICAgIGVtcHR5T3B0aW9uID0gY2hpbGRyZW4uZXEoaSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdmFyIHByb3ZpZGVkRW1wdHlPcHRpb24gPSAhIWVtcHR5T3B0aW9uO1xuXG4gICAgICB2YXIgdW5rbm93bk9wdGlvbiA9IGpxTGl0ZShvcHRpb25UZW1wbGF0ZS5jbG9uZU5vZGUoZmFsc2UpKTtcbiAgICAgIHVua25vd25PcHRpb24udmFsKCc/Jyk7XG5cbiAgICAgIHZhciBvcHRpb25zO1xuICAgICAgdmFyIG5nT3B0aW9ucyA9IHBhcnNlT3B0aW9uc0V4cHJlc3Npb24oYXR0ci5uZ09wdGlvbnMsIHNlbGVjdEVsZW1lbnQsIHNjb3BlKTtcblxuXG4gICAgICB2YXIgcmVuZGVyRW1wdHlPcHRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCFwcm92aWRlZEVtcHR5T3B0aW9uKSB7XG4gICAgICAgICAgc2VsZWN0RWxlbWVudC5wcmVwZW5kKGVtcHR5T3B0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxlY3RFbGVtZW50LnZhbCgnJyk7XG4gICAgICAgIGVtcHR5T3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7IC8vIG5lZWRlZCBmb3IgSUVcbiAgICAgICAgZW1wdHlPcHRpb24uYXR0cignc2VsZWN0ZWQnLCB0cnVlKTtcbiAgICAgIH07XG5cbiAgICAgIHZhciByZW1vdmVFbXB0eU9wdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXByb3ZpZGVkRW1wdHlPcHRpb24pIHtcbiAgICAgICAgICBlbXB0eU9wdGlvbi5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuXG4gICAgICB2YXIgcmVuZGVyVW5rbm93bk9wdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBzZWxlY3RFbGVtZW50LnByZXBlbmQodW5rbm93bk9wdGlvbik7XG4gICAgICAgIHNlbGVjdEVsZW1lbnQudmFsKCc/Jyk7XG4gICAgICAgIHVua25vd25PcHRpb24ucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTsgLy8gbmVlZGVkIGZvciBJRVxuICAgICAgICB1bmtub3duT3B0aW9uLmF0dHIoJ3NlbGVjdGVkJywgdHJ1ZSk7XG4gICAgICB9O1xuXG4gICAgICB2YXIgcmVtb3ZlVW5rbm93bk9wdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB1bmtub3duT3B0aW9uLnJlbW92ZSgpO1xuICAgICAgfTtcblxuICAgICAgLy8gVXBkYXRlIHRoZSBjb250cm9sbGVyIG1ldGhvZHMgZm9yIG11bHRpcGxlIHNlbGVjdGFibGUgb3B0aW9uc1xuICAgICAgaWYgKCFtdWx0aXBsZSkge1xuXG4gICAgICAgIHNlbGVjdEN0cmwud3JpdGVWYWx1ZSA9IGZ1bmN0aW9uIHdyaXRlTmdPcHRpb25zVmFsdWUodmFsdWUpIHtcbiAgICAgICAgICB2YXIgb3B0aW9uID0gb3B0aW9ucy5nZXRPcHRpb25Gcm9tVmlld1ZhbHVlKHZhbHVlKTtcblxuICAgICAgICAgIGlmIChvcHRpb24gJiYgIW9wdGlvbi5kaXNhYmxlZCkge1xuICAgICAgICAgICAgaWYgKHNlbGVjdEVsZW1lbnRbMF0udmFsdWUgIT09IG9wdGlvbi5zZWxlY3RWYWx1ZSkge1xuICAgICAgICAgICAgICByZW1vdmVVbmtub3duT3B0aW9uKCk7XG4gICAgICAgICAgICAgIHJlbW92ZUVtcHR5T3B0aW9uKCk7XG5cbiAgICAgICAgICAgICAgc2VsZWN0RWxlbWVudFswXS52YWx1ZSA9IG9wdGlvbi5zZWxlY3RWYWx1ZTtcbiAgICAgICAgICAgICAgb3B0aW9uLmVsZW1lbnQuc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICBvcHRpb24uZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3NlbGVjdGVkJywgJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCBwcm92aWRlZEVtcHR5T3B0aW9uKSB7XG4gICAgICAgICAgICAgIHJlbW92ZVVua25vd25PcHRpb24oKTtcbiAgICAgICAgICAgICAgcmVuZGVyRW1wdHlPcHRpb24oKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJlbW92ZUVtcHR5T3B0aW9uKCk7XG4gICAgICAgICAgICAgIHJlbmRlclVua25vd25PcHRpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZWN0Q3RybC5yZWFkVmFsdWUgPSBmdW5jdGlvbiByZWFkTmdPcHRpb25zVmFsdWUoKSB7XG5cbiAgICAgICAgICB2YXIgc2VsZWN0ZWRPcHRpb24gPSBvcHRpb25zLnNlbGVjdFZhbHVlTWFwW3NlbGVjdEVsZW1lbnQudmFsKCldO1xuXG4gICAgICAgICAgaWYgKHNlbGVjdGVkT3B0aW9uICYmICFzZWxlY3RlZE9wdGlvbi5kaXNhYmxlZCkge1xuICAgICAgICAgICAgcmVtb3ZlRW1wdHlPcHRpb24oKTtcbiAgICAgICAgICAgIHJlbW92ZVVua25vd25PcHRpb24oKTtcbiAgICAgICAgICAgIHJldHVybiBvcHRpb25zLmdldFZpZXdWYWx1ZUZyb21PcHRpb24oc2VsZWN0ZWRPcHRpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBJZiB3ZSBhcmUgdXNpbmcgYHRyYWNrIGJ5YCB0aGVuIHdlIG11c3Qgd2F0Y2ggdGhlIHRyYWNrZWQgdmFsdWUgb24gdGhlIG1vZGVsXG4gICAgICAgIC8vIHNpbmNlIG5nTW9kZWwgb25seSB3YXRjaGVzIGZvciBvYmplY3QgaWRlbnRpdHkgY2hhbmdlXG4gICAgICAgIGlmIChuZ09wdGlvbnMudHJhY2tCeSkge1xuICAgICAgICAgIHNjb3BlLiR3YXRjaChcbiAgICAgICAgICAgIGZ1bmN0aW9uKCkgeyByZXR1cm4gbmdPcHRpb25zLmdldFRyYWNrQnlWYWx1ZShuZ01vZGVsQ3RybC4kdmlld1ZhbHVlKTsgfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uKCkgeyBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7IH1cbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgbmdNb2RlbEN0cmwuJGlzRW1wdHkgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiAhdmFsdWUgfHwgdmFsdWUubGVuZ3RoID09PSAwO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgc2VsZWN0Q3RybC53cml0ZVZhbHVlID0gZnVuY3Rpb24gd3JpdGVOZ09wdGlvbnNNdWx0aXBsZSh2YWx1ZSkge1xuICAgICAgICAgIG9wdGlvbnMuaXRlbXMuZm9yRWFjaChmdW5jdGlvbihvcHRpb24pIHtcbiAgICAgICAgICAgIG9wdGlvbi5lbGVtZW50LnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhbHVlLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gb3B0aW9ucy5nZXRPcHRpb25Gcm9tVmlld1ZhbHVlKGl0ZW0pO1xuICAgICAgICAgICAgICBpZiAob3B0aW9uICYmICFvcHRpb24uZGlzYWJsZWQpIG9wdGlvbi5lbGVtZW50LnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuXG4gICAgICAgIHNlbGVjdEN0cmwucmVhZFZhbHVlID0gZnVuY3Rpb24gcmVhZE5nT3B0aW9uc011bHRpcGxlKCkge1xuICAgICAgICAgIHZhciBzZWxlY3RlZFZhbHVlcyA9IHNlbGVjdEVsZW1lbnQudmFsKCkgfHwgW10sXG4gICAgICAgICAgICAgIHNlbGVjdGlvbnMgPSBbXTtcblxuICAgICAgICAgIGZvckVhY2goc2VsZWN0ZWRWYWx1ZXMsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9uID0gb3B0aW9ucy5zZWxlY3RWYWx1ZU1hcFt2YWx1ZV07XG4gICAgICAgICAgICBpZiAob3B0aW9uICYmICFvcHRpb24uZGlzYWJsZWQpIHNlbGVjdGlvbnMucHVzaChvcHRpb25zLmdldFZpZXdWYWx1ZUZyb21PcHRpb24ob3B0aW9uKSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICByZXR1cm4gc2VsZWN0aW9ucztcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBJZiB3ZSBhcmUgdXNpbmcgYHRyYWNrIGJ5YCB0aGVuIHdlIG11c3Qgd2F0Y2ggdGhlc2UgdHJhY2tlZCB2YWx1ZXMgb24gdGhlIG1vZGVsXG4gICAgICAgIC8vIHNpbmNlIG5nTW9kZWwgb25seSB3YXRjaGVzIGZvciBvYmplY3QgaWRlbnRpdHkgY2hhbmdlXG4gICAgICAgIGlmIChuZ09wdGlvbnMudHJhY2tCeSkge1xuXG4gICAgICAgICAgc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChpc0FycmF5KG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUpKSB7XG4gICAgICAgICAgICAgIHJldHVybiBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlLm1hcChmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZ09wdGlvbnMuZ2V0VHJhY2tCeVZhbHVlKHZhbHVlKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuICAgICAgfVxuXG5cbiAgICAgIGlmIChwcm92aWRlZEVtcHR5T3B0aW9uKSB7XG5cbiAgICAgICAgLy8gd2UgbmVlZCB0byByZW1vdmUgaXQgYmVmb3JlIGNhbGxpbmcgc2VsZWN0RWxlbWVudC5lbXB0eSgpIGJlY2F1c2Ugb3RoZXJ3aXNlIElFIHdpbGxcbiAgICAgICAgLy8gcmVtb3ZlIHRoZSBsYWJlbCBmcm9tIHRoZSBlbGVtZW50LiB3dGY/XG4gICAgICAgIGVtcHR5T3B0aW9uLnJlbW92ZSgpO1xuXG4gICAgICAgIC8vIGNvbXBpbGUgdGhlIGVsZW1lbnQgc2luY2UgdGhlcmUgbWlnaHQgYmUgYmluZGluZ3MgaW4gaXRcbiAgICAgICAgJGNvbXBpbGUoZW1wdHlPcHRpb24pKHNjb3BlKTtcblxuICAgICAgICAvLyByZW1vdmUgdGhlIGNsYXNzLCB3aGljaCBpcyBhZGRlZCBhdXRvbWF0aWNhbGx5IGJlY2F1c2Ugd2UgcmVjb21waWxlIHRoZSBlbGVtZW50IGFuZCBpdFxuICAgICAgICAvLyBiZWNvbWVzIHRoZSBjb21waWxhdGlvbiByb290XG4gICAgICAgIGVtcHR5T3B0aW9uLnJlbW92ZUNsYXNzKCduZy1zY29wZScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZW1wdHlPcHRpb24gPSBqcUxpdGUob3B0aW9uVGVtcGxhdGUuY2xvbmVOb2RlKGZhbHNlKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFdlIG5lZWQgdG8gZG8gdGhpcyBoZXJlIHRvIGVuc3VyZSB0aGF0IHRoZSBvcHRpb25zIG9iamVjdCBpcyBkZWZpbmVkXG4gICAgICAvLyB3aGVuIHdlIGZpcnN0IGhpdCBpdCBpbiB3cml0ZU5nT3B0aW9uc1ZhbHVlXG4gICAgICB1cGRhdGVPcHRpb25zKCk7XG5cbiAgICAgIC8vIFdlIHdpbGwgcmUtcmVuZGVyIHRoZSBvcHRpb24gZWxlbWVudHMgaWYgdGhlIG9wdGlvbiB2YWx1ZXMgb3IgbGFiZWxzIGNoYW5nZVxuICAgICAgc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihuZ09wdGlvbnMuZ2V0V2F0Y2hhYmxlcywgdXBkYXRlT3B0aW9ucyk7XG5cbiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG5cbiAgICAgIGZ1bmN0aW9uIHVwZGF0ZU9wdGlvbkVsZW1lbnQob3B0aW9uLCBlbGVtZW50KSB7XG4gICAgICAgIG9wdGlvbi5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgZWxlbWVudC5kaXNhYmxlZCA9IG9wdGlvbi5kaXNhYmxlZDtcbiAgICAgICAgLy8gTk9URTogVGhlIGxhYmVsIG11c3QgYmUgc2V0IGJlZm9yZSB0aGUgdmFsdWUsIG90aGVyd2lzZSBJRTEwLzExL0VER0UgY3JlYXRlIHVucmVzcG9uc2l2ZVxuICAgICAgICAvLyBzZWxlY3RzIGluIGNlcnRhaW4gY2lyY3Vtc3RhbmNlcyB3aGVuIG11bHRpcGxlIHNlbGVjdHMgYXJlIG5leHQgdG8gZWFjaCBvdGhlciBhbmQgZGlzcGxheVxuICAgICAgICAvLyB0aGUgb3B0aW9uIGxpc3QgaW4gbGlzdGJveCBzdHlsZSwgaS5lLiB0aGUgc2VsZWN0IGlzIFttdWx0aXBsZV0sIG9yIHNwZWNpZmllcyBhIFtzaXplXS5cbiAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL2FuZ3VsYXIuanMvaXNzdWVzLzExMzE0IGZvciBtb3JlIGluZm8uXG4gICAgICAgIC8vIFRoaXMgaXMgdW5mb3J0dW5hdGVseSB1bnRlc3RhYmxlIHdpdGggdW5pdCAvIGUyZSB0ZXN0c1xuICAgICAgICBpZiAob3B0aW9uLmxhYmVsICE9PSBlbGVtZW50LmxhYmVsKSB7XG4gICAgICAgICAgZWxlbWVudC5sYWJlbCA9IG9wdGlvbi5sYWJlbDtcbiAgICAgICAgICBlbGVtZW50LnRleHRDb250ZW50ID0gb3B0aW9uLmxhYmVsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb24udmFsdWUgIT09IGVsZW1lbnQudmFsdWUpIGVsZW1lbnQudmFsdWUgPSBvcHRpb24uc2VsZWN0VmFsdWU7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFkZE9yUmV1c2VFbGVtZW50KHBhcmVudCwgY3VycmVudCwgdHlwZSwgdGVtcGxhdGVFbGVtZW50KSB7XG4gICAgICAgIHZhciBlbGVtZW50O1xuICAgICAgICAvLyBDaGVjayB3aGV0aGVyIHdlIGNhbiByZXVzZSB0aGUgbmV4dCBlbGVtZW50XG4gICAgICAgIGlmIChjdXJyZW50ICYmIGxvd2VyY2FzZShjdXJyZW50Lm5vZGVOYW1lKSA9PT0gdHlwZSkge1xuICAgICAgICAgIC8vIFRoZSBuZXh0IGVsZW1lbnQgaXMgdGhlIHJpZ2h0IHR5cGUgc28gcmV1c2UgaXRcbiAgICAgICAgICBlbGVtZW50ID0gY3VycmVudDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBUaGUgbmV4dCBlbGVtZW50IGlzIG5vdCB0aGUgcmlnaHQgdHlwZSBzbyBjcmVhdGUgYSBuZXcgb25lXG4gICAgICAgICAgZWxlbWVudCA9IHRlbXBsYXRlRWxlbWVudC5jbG9uZU5vZGUoZmFsc2UpO1xuICAgICAgICAgIGlmICghY3VycmVudCkge1xuICAgICAgICAgICAgLy8gVGhlcmUgYXJlIG5vIG1vcmUgZWxlbWVudHMgc28ganVzdCBhcHBlbmQgaXQgdG8gdGhlIHNlbGVjdFxuICAgICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBUaGUgbmV4dCBlbGVtZW50IGlzIG5vdCBhIGdyb3VwIHNvIGluc2VydCB0aGUgbmV3IG9uZVxuICAgICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShlbGVtZW50LCBjdXJyZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICB9XG5cblxuICAgICAgZnVuY3Rpb24gcmVtb3ZlRXhjZXNzRWxlbWVudHMoY3VycmVudCkge1xuICAgICAgICB2YXIgbmV4dDtcbiAgICAgICAgd2hpbGUgKGN1cnJlbnQpIHtcbiAgICAgICAgICBuZXh0ID0gY3VycmVudC5uZXh0U2libGluZztcbiAgICAgICAgICBqcUxpdGVSZW1vdmUoY3VycmVudCk7XG4gICAgICAgICAgY3VycmVudCA9IG5leHQ7XG4gICAgICAgIH1cbiAgICAgIH1cblxuXG4gICAgICBmdW5jdGlvbiBza2lwRW1wdHlBbmRVbmtub3duT3B0aW9ucyhjdXJyZW50KSB7XG4gICAgICAgIHZhciBlbXB0eU9wdGlvbl8gPSBlbXB0eU9wdGlvbiAmJiBlbXB0eU9wdGlvblswXTtcbiAgICAgICAgdmFyIHVua25vd25PcHRpb25fID0gdW5rbm93bk9wdGlvbiAmJiB1bmtub3duT3B0aW9uWzBdO1xuXG4gICAgICAgIC8vIFdlIGNhbm5vdCByZWx5IG9uIHRoZSBleHRyYWN0ZWQgZW1wdHkgb3B0aW9uIGJlaW5nIHRoZSBzYW1lIGFzIHRoZSBjb21waWxlZCBlbXB0eSBvcHRpb24sXG4gICAgICAgIC8vIGJlY2F1c2UgdGhlIGNvbXBpbGVkIGVtcHR5IG9wdGlvbiBtaWdodCBoYXZlIGJlZW4gcmVwbGFjZWQgYnkgYSBjb21tZW50IGJlY2F1c2VcbiAgICAgICAgLy8gaXQgaGFkIGFuIFwiZWxlbWVudFwiIHRyYW5zY2x1c2lvbiBkaXJlY3RpdmUgb24gaXQgKHN1Y2ggYXMgbmdJZilcbiAgICAgICAgaWYgKGVtcHR5T3B0aW9uXyB8fCB1bmtub3duT3B0aW9uXykge1xuICAgICAgICAgIHdoaWxlIChjdXJyZW50ICYmXG4gICAgICAgICAgICAgICAgKGN1cnJlbnQgPT09IGVtcHR5T3B0aW9uXyB8fFxuICAgICAgICAgICAgICAgIGN1cnJlbnQgPT09IHVua25vd25PcHRpb25fIHx8XG4gICAgICAgICAgICAgICAgY3VycmVudC5ub2RlVHlwZSA9PT0gTk9ERV9UWVBFX0NPTU1FTlQgfHxcbiAgICAgICAgICAgICAgICAobm9kZU5hbWVfKGN1cnJlbnQpID09PSAnb3B0aW9uJyAmJiBjdXJyZW50LnZhbHVlID09PSAnJykpKSB7XG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0U2libGluZztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGN1cnJlbnQ7XG4gICAgICB9XG5cblxuICAgICAgZnVuY3Rpb24gdXBkYXRlT3B0aW9ucygpIHtcblxuICAgICAgICB2YXIgcHJldmlvdXNWYWx1ZSA9IG9wdGlvbnMgJiYgc2VsZWN0Q3RybC5yZWFkVmFsdWUoKTtcblxuICAgICAgICBvcHRpb25zID0gbmdPcHRpb25zLmdldE9wdGlvbnMoKTtcblxuICAgICAgICB2YXIgZ3JvdXBNYXAgPSB7fTtcbiAgICAgICAgdmFyIGN1cnJlbnRFbGVtZW50ID0gc2VsZWN0RWxlbWVudFswXS5maXJzdENoaWxkO1xuXG4gICAgICAgIC8vIEVuc3VyZSB0aGF0IHRoZSBlbXB0eSBvcHRpb24gaXMgYWx3YXlzIHRoZXJlIGlmIGl0IHdhcyBleHBsaWNpdGx5IHByb3ZpZGVkXG4gICAgICAgIGlmIChwcm92aWRlZEVtcHR5T3B0aW9uKSB7XG4gICAgICAgICAgc2VsZWN0RWxlbWVudC5wcmVwZW5kKGVtcHR5T3B0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGN1cnJlbnRFbGVtZW50ID0gc2tpcEVtcHR5QW5kVW5rbm93bk9wdGlvbnMoY3VycmVudEVsZW1lbnQpO1xuXG4gICAgICAgIG9wdGlvbnMuaXRlbXMuZm9yRWFjaChmdW5jdGlvbiB1cGRhdGVPcHRpb24ob3B0aW9uKSB7XG4gICAgICAgICAgdmFyIGdyb3VwO1xuICAgICAgICAgIHZhciBncm91cEVsZW1lbnQ7XG4gICAgICAgICAgdmFyIG9wdGlvbkVsZW1lbnQ7XG5cbiAgICAgICAgICBpZiAoaXNEZWZpbmVkKG9wdGlvbi5ncm91cCkpIHtcblxuICAgICAgICAgICAgLy8gVGhpcyBvcHRpb24gaXMgdG8gbGl2ZSBpbiBhIGdyb3VwXG4gICAgICAgICAgICAvLyBTZWUgaWYgd2UgaGF2ZSBhbHJlYWR5IGNyZWF0ZWQgdGhpcyBncm91cFxuICAgICAgICAgICAgZ3JvdXAgPSBncm91cE1hcFtvcHRpb24uZ3JvdXBdO1xuXG4gICAgICAgICAgICBpZiAoIWdyb3VwKSB7XG5cbiAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBub3QgYWxyZWFkeSBjcmVhdGVkIHRoaXMgZ3JvdXBcbiAgICAgICAgICAgICAgZ3JvdXBFbGVtZW50ID0gYWRkT3JSZXVzZUVsZW1lbnQoc2VsZWN0RWxlbWVudFswXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvcHRncm91cCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdEdyb3VwVGVtcGxhdGUpO1xuICAgICAgICAgICAgICAvLyBNb3ZlIHRvIHRoZSBuZXh0IGVsZW1lbnRcbiAgICAgICAgICAgICAgY3VycmVudEVsZW1lbnQgPSBncm91cEVsZW1lbnQubmV4dFNpYmxpbmc7XG5cbiAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBsYWJlbCBvbiB0aGUgZ3JvdXAgZWxlbWVudFxuICAgICAgICAgICAgICBncm91cEVsZW1lbnQubGFiZWwgPSBvcHRpb24uZ3JvdXA7XG5cbiAgICAgICAgICAgICAgLy8gU3RvcmUgaXQgZm9yIHVzZSBsYXRlclxuICAgICAgICAgICAgICBncm91cCA9IGdyb3VwTWFwW29wdGlvbi5ncm91cF0gPSB7XG4gICAgICAgICAgICAgICAgZ3JvdXBFbGVtZW50OiBncm91cEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgY3VycmVudE9wdGlvbkVsZW1lbnQ6IGdyb3VwRWxlbWVudC5maXJzdENoaWxkXG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU28gbm93IHdlIGhhdmUgYSBncm91cCBmb3IgdGhpcyBvcHRpb24gd2UgYWRkIHRoZSBvcHRpb24gdG8gdGhlIGdyb3VwXG4gICAgICAgICAgICBvcHRpb25FbGVtZW50ID0gYWRkT3JSZXVzZUVsZW1lbnQoZ3JvdXAuZ3JvdXBFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLmN1cnJlbnRPcHRpb25FbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvcHRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvblRlbXBsYXRlKTtcbiAgICAgICAgICAgIHVwZGF0ZU9wdGlvbkVsZW1lbnQob3B0aW9uLCBvcHRpb25FbGVtZW50KTtcbiAgICAgICAgICAgIC8vIE1vdmUgdG8gdGhlIG5leHQgZWxlbWVudFxuICAgICAgICAgICAgZ3JvdXAuY3VycmVudE9wdGlvbkVsZW1lbnQgPSBvcHRpb25FbGVtZW50Lm5leHRTaWJsaW5nO1xuXG4gICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgLy8gVGhpcyBvcHRpb24gaXMgbm90IGluIGEgZ3JvdXBcbiAgICAgICAgICAgIG9wdGlvbkVsZW1lbnQgPSBhZGRPclJldXNlRWxlbWVudChzZWxlY3RFbGVtZW50WzBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvcHRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvblRlbXBsYXRlKTtcbiAgICAgICAgICAgIHVwZGF0ZU9wdGlvbkVsZW1lbnQob3B0aW9uLCBvcHRpb25FbGVtZW50KTtcbiAgICAgICAgICAgIC8vIE1vdmUgdG8gdGhlIG5leHQgZWxlbWVudFxuICAgICAgICAgICAgY3VycmVudEVsZW1lbnQgPSBvcHRpb25FbGVtZW50Lm5leHRTaWJsaW5nO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cblxuICAgICAgICAvLyBOb3cgcmVtb3ZlIGFsbCBleGNlc3Mgb3B0aW9ucyBhbmQgZ3JvdXBcbiAgICAgICAgT2JqZWN0LmtleXMoZ3JvdXBNYXApLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICAgcmVtb3ZlRXhjZXNzRWxlbWVudHMoZ3JvdXBNYXBba2V5XS5jdXJyZW50T3B0aW9uRWxlbWVudCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZW1vdmVFeGNlc3NFbGVtZW50cyhjdXJyZW50RWxlbWVudCk7XG5cbiAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuXG4gICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGUgdmFsdWUgaGFzIGNoYW5nZWQgZHVlIHRvIHRoZSB1cGRhdGUgdG8gdGhlIG9wdGlvbnNcbiAgICAgICAgaWYgKCFuZ01vZGVsQ3RybC4kaXNFbXB0eShwcmV2aW91c1ZhbHVlKSkge1xuICAgICAgICAgIHZhciBuZXh0VmFsdWUgPSBzZWxlY3RDdHJsLnJlYWRWYWx1ZSgpO1xuICAgICAgICAgIHZhciBpc05vdFByaW1pdGl2ZSA9IG5nT3B0aW9ucy50cmFja0J5IHx8IG11bHRpcGxlO1xuICAgICAgICAgIGlmIChpc05vdFByaW1pdGl2ZSA/ICFlcXVhbHMocHJldmlvdXNWYWx1ZSwgbmV4dFZhbHVlKSA6IHByZXZpb3VzVmFsdWUgIT09IG5leHRWYWx1ZSkge1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZShuZXh0VmFsdWUpO1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgdGVybWluYWw6IHRydWUsXG4gICAgcmVxdWlyZTogWydzZWxlY3QnLCAnbmdNb2RlbCddLFxuICAgIGxpbms6IHtcbiAgICAgIHByZTogZnVuY3Rpb24gbmdPcHRpb25zUHJlTGluayhzY29wZSwgc2VsZWN0RWxlbWVudCwgYXR0ciwgY3RybHMpIHtcbiAgICAgICAgLy8gRGVhY3RpdmF0ZSB0aGUgU2VsZWN0Q29udHJvbGxlci5yZWdpc3RlciBtZXRob2QgdG8gcHJldmVudFxuICAgICAgICAvLyBvcHRpb24gZGlyZWN0aXZlcyBmcm9tIGFjY2lkZW50YWxseSByZWdpc3RlcmluZyB0aGVtc2VsdmVzXG4gICAgICAgIC8vIChhbmQgdW53YW50ZWQgJGRlc3Ryb3kgaGFuZGxlcnMgZXRjLilcbiAgICAgICAgY3RybHNbMF0ucmVnaXN0ZXJPcHRpb24gPSBub29wO1xuICAgICAgfSxcbiAgICAgIHBvc3Q6IG5nT3B0aW9uc1Bvc3RMaW5rXG4gICAgfVxuICB9O1xufV07XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdQbHVyYWxpemVcbiAqIEByZXN0cmljdCBFQVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogYG5nUGx1cmFsaXplYCBpcyBhIGRpcmVjdGl2ZSB0aGF0IGRpc3BsYXlzIG1lc3NhZ2VzIGFjY29yZGluZyB0byBlbi1VUyBsb2NhbGl6YXRpb24gcnVsZXMuXG4gKiBUaGVzZSBydWxlcyBhcmUgYnVuZGxlZCB3aXRoIGFuZ3VsYXIuanMsIGJ1dCBjYW4gYmUgb3ZlcnJpZGRlblxuICogKHNlZSB7QGxpbmsgZ3VpZGUvaTE4biBBbmd1bGFyIGkxOG59IGRldiBndWlkZSkuIFlvdSBjb25maWd1cmUgbmdQbHVyYWxpemUgZGlyZWN0aXZlXG4gKiBieSBzcGVjaWZ5aW5nIHRoZSBtYXBwaW5ncyBiZXR3ZWVuXG4gKiBbcGx1cmFsIGNhdGVnb3JpZXNdKGh0dHA6Ly91bmljb2RlLm9yZy9yZXBvcy9jbGRyLXRtcC90cnVuay9kaWZmL3N1cHBsZW1lbnRhbC9sYW5ndWFnZV9wbHVyYWxfcnVsZXMuaHRtbClcbiAqIGFuZCB0aGUgc3RyaW5ncyB0byBiZSBkaXNwbGF5ZWQuXG4gKlxuICogIyBQbHVyYWwgY2F0ZWdvcmllcyBhbmQgZXhwbGljaXQgbnVtYmVyIHJ1bGVzXG4gKiBUaGVyZSBhcmUgdHdvXG4gKiBbcGx1cmFsIGNhdGVnb3JpZXNdKGh0dHA6Ly91bmljb2RlLm9yZy9yZXBvcy9jbGRyLXRtcC90cnVuay9kaWZmL3N1cHBsZW1lbnRhbC9sYW5ndWFnZV9wbHVyYWxfcnVsZXMuaHRtbClcbiAqIGluIEFuZ3VsYXIncyBkZWZhdWx0IGVuLVVTIGxvY2FsZTogXCJvbmVcIiBhbmQgXCJvdGhlclwiLlxuICpcbiAqIFdoaWxlIGEgcGx1cmFsIGNhdGVnb3J5IG1heSBtYXRjaCBtYW55IG51bWJlcnMgKGZvciBleGFtcGxlLCBpbiBlbi1VUyBsb2NhbGUsIFwib3RoZXJcIiBjYW4gbWF0Y2hcbiAqIGFueSBudW1iZXIgdGhhdCBpcyBub3QgMSksIGFuIGV4cGxpY2l0IG51bWJlciBydWxlIGNhbiBvbmx5IG1hdGNoIG9uZSBudW1iZXIuIEZvciBleGFtcGxlLCB0aGVcbiAqIGV4cGxpY2l0IG51bWJlciBydWxlIGZvciBcIjNcIiBtYXRjaGVzIHRoZSBudW1iZXIgMy4gVGhlcmUgYXJlIGV4YW1wbGVzIG9mIHBsdXJhbCBjYXRlZ29yaWVzXG4gKiBhbmQgZXhwbGljaXQgbnVtYmVyIHJ1bGVzIHRocm91Z2hvdXQgdGhlIHJlc3Qgb2YgdGhpcyBkb2N1bWVudGF0aW9uLlxuICpcbiAqICMgQ29uZmlndXJpbmcgbmdQbHVyYWxpemVcbiAqIFlvdSBjb25maWd1cmUgbmdQbHVyYWxpemUgYnkgcHJvdmlkaW5nIDIgYXR0cmlidXRlczogYGNvdW50YCBhbmQgYHdoZW5gLlxuICogWW91IGNhbiBhbHNvIHByb3ZpZGUgYW4gb3B0aW9uYWwgYXR0cmlidXRlLCBgb2Zmc2V0YC5cbiAqXG4gKiBUaGUgdmFsdWUgb2YgdGhlIGBjb3VudGAgYXR0cmlidXRlIGNhbiBiZSBlaXRoZXIgYSBzdHJpbmcgb3IgYW4ge0BsaW5rIGd1aWRlL2V4cHJlc3Npb25cbiAqIEFuZ3VsYXIgZXhwcmVzc2lvbn07IHRoZXNlIGFyZSBldmFsdWF0ZWQgb24gdGhlIGN1cnJlbnQgc2NvcGUgZm9yIGl0cyBib3VuZCB2YWx1ZS5cbiAqXG4gKiBUaGUgYHdoZW5gIGF0dHJpYnV0ZSBzcGVjaWZpZXMgdGhlIG1hcHBpbmdzIGJldHdlZW4gcGx1cmFsIGNhdGVnb3JpZXMgYW5kIHRoZSBhY3R1YWxcbiAqIHN0cmluZyB0byBiZSBkaXNwbGF5ZWQuIFRoZSB2YWx1ZSBvZiB0aGUgYXR0cmlidXRlIHNob3VsZCBiZSBhIEpTT04gb2JqZWN0LlxuICpcbiAqIFRoZSBmb2xsb3dpbmcgZXhhbXBsZSBzaG93cyBob3cgdG8gY29uZmlndXJlIG5nUGx1cmFsaXplOlxuICpcbiAqIGBgYGh0bWxcbiAqIDxuZy1wbHVyYWxpemUgY291bnQ9XCJwZXJzb25Db3VudFwiXG4gICAgICAgICAgICAgICAgIHdoZW49XCJ7JzAnOiAnTm9ib2R5IGlzIHZpZXdpbmcuJyxcbiAqICAgICAgICAgICAgICAgICAgICAgICdvbmUnOiAnMSBwZXJzb24gaXMgdmlld2luZy4nLFxuICogICAgICAgICAgICAgICAgICAgICAgJ290aGVyJzogJ3t9IHBlb3BsZSBhcmUgdmlld2luZy4nfVwiPlxuICogPC9uZy1wbHVyYWxpemU+XG4gKmBgYFxuICpcbiAqIEluIHRoZSBleGFtcGxlLCBgXCIwOiBOb2JvZHkgaXMgdmlld2luZy5cImAgaXMgYW4gZXhwbGljaXQgbnVtYmVyIHJ1bGUuIElmIHlvdSBkaWQgbm90XG4gKiBzcGVjaWZ5IHRoaXMgcnVsZSwgMCB3b3VsZCBiZSBtYXRjaGVkIHRvIHRoZSBcIm90aGVyXCIgY2F0ZWdvcnkgYW5kIFwiMCBwZW9wbGUgYXJlIHZpZXdpbmdcIlxuICogd291bGQgYmUgc2hvd24gaW5zdGVhZCBvZiBcIk5vYm9keSBpcyB2aWV3aW5nXCIuIFlvdSBjYW4gc3BlY2lmeSBhbiBleHBsaWNpdCBudW1iZXIgcnVsZSBmb3JcbiAqIG90aGVyIG51bWJlcnMsIGZvciBleGFtcGxlIDEyLCBzbyB0aGF0IGluc3RlYWQgb2Ygc2hvd2luZyBcIjEyIHBlb3BsZSBhcmUgdmlld2luZ1wiLCB5b3UgY2FuXG4gKiBzaG93IFwiYSBkb3plbiBwZW9wbGUgYXJlIHZpZXdpbmdcIi5cbiAqXG4gKiBZb3UgY2FuIHVzZSBhIHNldCBvZiBjbG9zZWQgYnJhY2VzIChge31gKSBhcyBhIHBsYWNlaG9sZGVyIGZvciB0aGUgbnVtYmVyIHRoYXQgeW91IHdhbnQgc3Vic3RpdHV0ZWRcbiAqIGludG8gcGx1cmFsaXplZCBzdHJpbmdzLiBJbiB0aGUgcHJldmlvdXMgZXhhbXBsZSwgQW5ndWxhciB3aWxsIHJlcGxhY2UgYHt9YCB3aXRoXG4gKiA8c3BhbiBuZy1ub24tYmluZGFibGU+YHt7cGVyc29uQ291bnR9fWA8L3NwYW4+LiBUaGUgY2xvc2VkIGJyYWNlcyBge31gIGlzIGEgcGxhY2Vob2xkZXJcbiAqIGZvciA8c3BhbiBuZy1ub24tYmluZGFibGU+e3tudW1iZXJFeHByZXNzaW9ufX08L3NwYW4+LlxuICpcbiAqIElmIG5vIHJ1bGUgaXMgZGVmaW5lZCBmb3IgYSBjYXRlZ29yeSwgdGhlbiBhbiBlbXB0eSBzdHJpbmcgaXMgZGlzcGxheWVkIGFuZCBhIHdhcm5pbmcgaXMgZ2VuZXJhdGVkLlxuICogTm90ZSB0aGF0IHNvbWUgbG9jYWxlcyBkZWZpbmUgbW9yZSBjYXRlZ29yaWVzIHRoYW4gYG9uZWAgYW5kIGBvdGhlcmAuIEZvciBleGFtcGxlLCBmci1mciBkZWZpbmVzIGBmZXdgIGFuZCBgbWFueWAuXG4gKlxuICogIyBDb25maWd1cmluZyBuZ1BsdXJhbGl6ZSB3aXRoIG9mZnNldFxuICogVGhlIGBvZmZzZXRgIGF0dHJpYnV0ZSBhbGxvd3MgZnVydGhlciBjdXN0b21pemF0aW9uIG9mIHBsdXJhbGl6ZWQgdGV4dCwgd2hpY2ggY2FuIHJlc3VsdCBpblxuICogYSBiZXR0ZXIgdXNlciBleHBlcmllbmNlLiBGb3IgZXhhbXBsZSwgaW5zdGVhZCBvZiB0aGUgbWVzc2FnZSBcIjQgcGVvcGxlIGFyZSB2aWV3aW5nIHRoaXMgZG9jdW1lbnRcIixcbiAqIHlvdSBtaWdodCBkaXNwbGF5IFwiSm9obiwgS2F0ZSBhbmQgMiBvdGhlcnMgYXJlIHZpZXdpbmcgdGhpcyBkb2N1bWVudFwiLlxuICogVGhlIG9mZnNldCBhdHRyaWJ1dGUgYWxsb3dzIHlvdSB0byBvZmZzZXQgYSBudW1iZXIgYnkgYW55IGRlc2lyZWQgdmFsdWUuXG4gKiBMZXQncyB0YWtlIGEgbG9vayBhdCBhbiBleGFtcGxlOlxuICpcbiAqIGBgYGh0bWxcbiAqIDxuZy1wbHVyYWxpemUgY291bnQ9XCJwZXJzb25Db3VudFwiIG9mZnNldD0yXG4gKiAgICAgICAgICAgICAgIHdoZW49XCJ7JzAnOiAnTm9ib2R5IGlzIHZpZXdpbmcuJyxcbiAqICAgICAgICAgICAgICAgICAgICAgICcxJzogJ3t7cGVyc29uMX19IGlzIHZpZXdpbmcuJyxcbiAqICAgICAgICAgICAgICAgICAgICAgICcyJzogJ3t7cGVyc29uMX19IGFuZCB7e3BlcnNvbjJ9fSBhcmUgdmlld2luZy4nLFxuICogICAgICAgICAgICAgICAgICAgICAgJ29uZSc6ICd7e3BlcnNvbjF9fSwge3twZXJzb24yfX0gYW5kIG9uZSBvdGhlciBwZXJzb24gYXJlIHZpZXdpbmcuJyxcbiAqICAgICAgICAgICAgICAgICAgICAgICdvdGhlcic6ICd7e3BlcnNvbjF9fSwge3twZXJzb24yfX0gYW5kIHt9IG90aGVyIHBlb3BsZSBhcmUgdmlld2luZy4nfVwiPlxuICogPC9uZy1wbHVyYWxpemU+XG4gKiBgYGBcbiAqXG4gKiBOb3RpY2UgdGhhdCB3ZSBhcmUgc3RpbGwgdXNpbmcgdHdvIHBsdXJhbCBjYXRlZ29yaWVzKG9uZSwgb3RoZXIpLCBidXQgd2UgYWRkZWRcbiAqIHRocmVlIGV4cGxpY2l0IG51bWJlciBydWxlcyAwLCAxIGFuZCAyLlxuICogV2hlbiBvbmUgcGVyc29uLCBwZXJoYXBzIEpvaG4sIHZpZXdzIHRoZSBkb2N1bWVudCwgXCJKb2huIGlzIHZpZXdpbmdcIiB3aWxsIGJlIHNob3duLlxuICogV2hlbiB0aHJlZSBwZW9wbGUgdmlldyB0aGUgZG9jdW1lbnQsIG5vIGV4cGxpY2l0IG51bWJlciBydWxlIGlzIGZvdW5kLCBzb1xuICogYW4gb2Zmc2V0IG9mIDIgaXMgdGFrZW4gb2ZmIDMsIGFuZCBBbmd1bGFyIHVzZXMgMSB0byBkZWNpZGUgdGhlIHBsdXJhbCBjYXRlZ29yeS5cbiAqIEluIHRoaXMgY2FzZSwgcGx1cmFsIGNhdGVnb3J5ICdvbmUnIGlzIG1hdGNoZWQgYW5kIFwiSm9obiwgTWFyeSBhbmQgb25lIG90aGVyIHBlcnNvbiBhcmUgdmlld2luZ1wiXG4gKiBpcyBzaG93bi5cbiAqXG4gKiBOb3RlIHRoYXQgd2hlbiB5b3Ugc3BlY2lmeSBvZmZzZXRzLCB5b3UgbXVzdCBwcm92aWRlIGV4cGxpY2l0IG51bWJlciBydWxlcyBmb3JcbiAqIG51bWJlcnMgZnJvbSAwIHVwIHRvIGFuZCBpbmNsdWRpbmcgdGhlIG9mZnNldC4gSWYgeW91IHVzZSBhbiBvZmZzZXQgb2YgMywgZm9yIGV4YW1wbGUsXG4gKiB5b3UgbXVzdCBwcm92aWRlIGV4cGxpY2l0IG51bWJlciBydWxlcyBmb3IgMCwgMSwgMiBhbmQgMy4gWW91IG11c3QgYWxzbyBwcm92aWRlIHBsdXJhbCBzdHJpbmdzIGZvclxuICogcGx1cmFsIGNhdGVnb3JpZXMgXCJvbmVcIiBhbmQgXCJvdGhlclwiLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfGV4cHJlc3Npb259IGNvdW50IFRoZSB2YXJpYWJsZSB0byBiZSBib3VuZCB0by5cbiAqIEBwYXJhbSB7c3RyaW5nfSB3aGVuIFRoZSBtYXBwaW5nIGJldHdlZW4gcGx1cmFsIGNhdGVnb3J5IHRvIGl0cyBjb3JyZXNwb25kaW5nIHN0cmluZ3MuXG4gKiBAcGFyYW0ge251bWJlcj19IG9mZnNldCBPZmZzZXQgdG8gZGVkdWN0IGZyb20gdGhlIHRvdGFsIG51bWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICAgIDxleGFtcGxlIG1vZHVsZT1cInBsdXJhbGl6ZUV4YW1wbGVcIj5cbiAgICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgIDxzY3JpcHQ+XG4gICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ3BsdXJhbGl6ZUV4YW1wbGUnLCBbXSlcbiAgICAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgICAgICRzY29wZS5wZXJzb24xID0gJ0lnb3InO1xuICAgICAgICAgICAgICAkc2NvcGUucGVyc29uMiA9ICdNaXNrbyc7XG4gICAgICAgICAgICAgICRzY29wZS5wZXJzb25Db3VudCA9IDE7XG4gICAgICAgICAgICB9XSk7XG4gICAgICAgIDwvc2NyaXB0PlxuICAgICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICAgICAgIDxsYWJlbD5QZXJzb24gMTo8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cInBlcnNvbjFcIiB2YWx1ZT1cIklnb3JcIiAvPjwvbGFiZWw+PGJyLz5cbiAgICAgICAgICA8bGFiZWw+UGVyc29uIDI6PGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJwZXJzb24yXCIgdmFsdWU9XCJNaXNrb1wiIC8+PC9sYWJlbD48YnIvPlxuICAgICAgICAgIDxsYWJlbD5OdW1iZXIgb2YgUGVvcGxlOjxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwicGVyc29uQ291bnRcIiB2YWx1ZT1cIjFcIiAvPjwvbGFiZWw+PGJyLz5cblxuICAgICAgICAgIDwhLS0tIEV4YW1wbGUgd2l0aCBzaW1wbGUgcGx1cmFsaXphdGlvbiBydWxlcyBmb3IgZW4gbG9jYWxlIC0tLT5cbiAgICAgICAgICBXaXRob3V0IE9mZnNldDpcbiAgICAgICAgICA8bmctcGx1cmFsaXplIGNvdW50PVwicGVyc29uQ291bnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgd2hlbj1cInsnMCc6ICdOb2JvZHkgaXMgdmlld2luZy4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvbmUnOiAnMSBwZXJzb24gaXMgdmlld2luZy4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvdGhlcic6ICd7fSBwZW9wbGUgYXJlIHZpZXdpbmcuJ31cIj5cbiAgICAgICAgICA8L25nLXBsdXJhbGl6ZT48YnI+XG5cbiAgICAgICAgICA8IS0tLSBFeGFtcGxlIHdpdGggb2Zmc2V0IC0tLT5cbiAgICAgICAgICBXaXRoIE9mZnNldCgyKTpcbiAgICAgICAgICA8bmctcGx1cmFsaXplIGNvdW50PVwicGVyc29uQ291bnRcIiBvZmZzZXQ9MlxuICAgICAgICAgICAgICAgICAgICAgICAgd2hlbj1cInsnMCc6ICdOb2JvZHkgaXMgdmlld2luZy4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcxJzogJ3t7cGVyc29uMX19IGlzIHZpZXdpbmcuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnMic6ICd7e3BlcnNvbjF9fSBhbmQge3twZXJzb24yfX0gYXJlIHZpZXdpbmcuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb25lJzogJ3t7cGVyc29uMX19LCB7e3BlcnNvbjJ9fSBhbmQgb25lIG90aGVyIHBlcnNvbiBhcmUgdmlld2luZy4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvdGhlcic6ICd7e3BlcnNvbjF9fSwge3twZXJzb24yfX0gYW5kIHt9IG90aGVyIHBlb3BsZSBhcmUgdmlld2luZy4nfVwiPlxuICAgICAgICAgIDwvbmctcGx1cmFsaXplPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZmlsZT5cbiAgICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgICAgaXQoJ3Nob3VsZCBzaG93IGNvcnJlY3QgcGx1cmFsaXplZCBzdHJpbmcnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgd2l0aG91dE9mZnNldCA9IGVsZW1lbnQuYWxsKGJ5LmNzcygnbmctcGx1cmFsaXplJykpLmdldCgwKTtcbiAgICAgICAgICB2YXIgd2l0aE9mZnNldCA9IGVsZW1lbnQuYWxsKGJ5LmNzcygnbmctcGx1cmFsaXplJykpLmdldCgxKTtcbiAgICAgICAgICB2YXIgY291bnRJbnB1dCA9IGVsZW1lbnQoYnkubW9kZWwoJ3BlcnNvbkNvdW50JykpO1xuXG4gICAgICAgICAgZXhwZWN0KHdpdGhvdXRPZmZzZXQuZ2V0VGV4dCgpKS50b0VxdWFsKCcxIHBlcnNvbiBpcyB2aWV3aW5nLicpO1xuICAgICAgICAgIGV4cGVjdCh3aXRoT2Zmc2V0LmdldFRleHQoKSkudG9FcXVhbCgnSWdvciBpcyB2aWV3aW5nLicpO1xuXG4gICAgICAgICAgY291bnRJbnB1dC5jbGVhcigpO1xuICAgICAgICAgIGNvdW50SW5wdXQuc2VuZEtleXMoJzAnKTtcblxuICAgICAgICAgIGV4cGVjdCh3aXRob3V0T2Zmc2V0LmdldFRleHQoKSkudG9FcXVhbCgnTm9ib2R5IGlzIHZpZXdpbmcuJyk7XG4gICAgICAgICAgZXhwZWN0KHdpdGhPZmZzZXQuZ2V0VGV4dCgpKS50b0VxdWFsKCdOb2JvZHkgaXMgdmlld2luZy4nKTtcblxuICAgICAgICAgIGNvdW50SW5wdXQuY2xlYXIoKTtcbiAgICAgICAgICBjb3VudElucHV0LnNlbmRLZXlzKCcyJyk7XG5cbiAgICAgICAgICBleHBlY3Qod2l0aG91dE9mZnNldC5nZXRUZXh0KCkpLnRvRXF1YWwoJzIgcGVvcGxlIGFyZSB2aWV3aW5nLicpO1xuICAgICAgICAgIGV4cGVjdCh3aXRoT2Zmc2V0LmdldFRleHQoKSkudG9FcXVhbCgnSWdvciBhbmQgTWlza28gYXJlIHZpZXdpbmcuJyk7XG5cbiAgICAgICAgICBjb3VudElucHV0LmNsZWFyKCk7XG4gICAgICAgICAgY291bnRJbnB1dC5zZW5kS2V5cygnMycpO1xuXG4gICAgICAgICAgZXhwZWN0KHdpdGhvdXRPZmZzZXQuZ2V0VGV4dCgpKS50b0VxdWFsKCczIHBlb3BsZSBhcmUgdmlld2luZy4nKTtcbiAgICAgICAgICBleHBlY3Qod2l0aE9mZnNldC5nZXRUZXh0KCkpLnRvRXF1YWwoJ0lnb3IsIE1pc2tvIGFuZCBvbmUgb3RoZXIgcGVyc29uIGFyZSB2aWV3aW5nLicpO1xuXG4gICAgICAgICAgY291bnRJbnB1dC5jbGVhcigpO1xuICAgICAgICAgIGNvdW50SW5wdXQuc2VuZEtleXMoJzQnKTtcblxuICAgICAgICAgIGV4cGVjdCh3aXRob3V0T2Zmc2V0LmdldFRleHQoKSkudG9FcXVhbCgnNCBwZW9wbGUgYXJlIHZpZXdpbmcuJyk7XG4gICAgICAgICAgZXhwZWN0KHdpdGhPZmZzZXQuZ2V0VGV4dCgpKS50b0VxdWFsKCdJZ29yLCBNaXNrbyBhbmQgMiBvdGhlciBwZW9wbGUgYXJlIHZpZXdpbmcuJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnc2hvdWxkIHNob3cgZGF0YS1ib3VuZCBuYW1lcycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciB3aXRoT2Zmc2V0ID0gZWxlbWVudC5hbGwoYnkuY3NzKCduZy1wbHVyYWxpemUnKSkuZ2V0KDEpO1xuICAgICAgICAgIHZhciBwZXJzb25Db3VudCA9IGVsZW1lbnQoYnkubW9kZWwoJ3BlcnNvbkNvdW50JykpO1xuICAgICAgICAgIHZhciBwZXJzb24xID0gZWxlbWVudChieS5tb2RlbCgncGVyc29uMScpKTtcbiAgICAgICAgICB2YXIgcGVyc29uMiA9IGVsZW1lbnQoYnkubW9kZWwoJ3BlcnNvbjInKSk7XG4gICAgICAgICAgcGVyc29uQ291bnQuY2xlYXIoKTtcbiAgICAgICAgICBwZXJzb25Db3VudC5zZW5kS2V5cygnNCcpO1xuICAgICAgICAgIHBlcnNvbjEuY2xlYXIoKTtcbiAgICAgICAgICBwZXJzb24xLnNlbmRLZXlzKCdEaScpO1xuICAgICAgICAgIHBlcnNvbjIuY2xlYXIoKTtcbiAgICAgICAgICBwZXJzb24yLnNlbmRLZXlzKCdWb2p0YScpO1xuICAgICAgICAgIGV4cGVjdCh3aXRoT2Zmc2V0LmdldFRleHQoKSkudG9FcXVhbCgnRGksIFZvanRhIGFuZCAyIG90aGVyIHBlb3BsZSBhcmUgdmlld2luZy4nKTtcbiAgICAgICAgfSk7XG4gICAgICA8L2ZpbGU+XG4gICAgPC9leGFtcGxlPlxuICovXG52YXIgbmdQbHVyYWxpemVEaXJlY3RpdmUgPSBbJyRsb2NhbGUnLCAnJGludGVycG9sYXRlJywgJyRsb2cnLCBmdW5jdGlvbigkbG9jYWxlLCAkaW50ZXJwb2xhdGUsICRsb2cpIHtcbiAgdmFyIEJSQUNFID0gL3t9L2csXG4gICAgICBJU19XSEVOID0gL153aGVuKE1pbnVzKT8oLispJC87XG5cbiAgcmV0dXJuIHtcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cikge1xuICAgICAgdmFyIG51bWJlckV4cCA9IGF0dHIuY291bnQsXG4gICAgICAgICAgd2hlbkV4cCA9IGF0dHIuJGF0dHIud2hlbiAmJiBlbGVtZW50LmF0dHIoYXR0ci4kYXR0ci53aGVuKSwgLy8gd2UgaGF2ZSB7e319IGluIGF0dHJzXG4gICAgICAgICAgb2Zmc2V0ID0gYXR0ci5vZmZzZXQgfHwgMCxcbiAgICAgICAgICB3aGVucyA9IHNjb3BlLiRldmFsKHdoZW5FeHApIHx8IHt9LFxuICAgICAgICAgIHdoZW5zRXhwRm5zID0ge30sXG4gICAgICAgICAgc3RhcnRTeW1ib2wgPSAkaW50ZXJwb2xhdGUuc3RhcnRTeW1ib2woKSxcbiAgICAgICAgICBlbmRTeW1ib2wgPSAkaW50ZXJwb2xhdGUuZW5kU3ltYm9sKCksXG4gICAgICAgICAgYnJhY2VSZXBsYWNlbWVudCA9IHN0YXJ0U3ltYm9sICsgbnVtYmVyRXhwICsgJy0nICsgb2Zmc2V0ICsgZW5kU3ltYm9sLFxuICAgICAgICAgIHdhdGNoUmVtb3ZlciA9IGFuZ3VsYXIubm9vcCxcbiAgICAgICAgICBsYXN0Q291bnQ7XG5cbiAgICAgIGZvckVhY2goYXR0ciwgZnVuY3Rpb24oZXhwcmVzc2lvbiwgYXR0cmlidXRlTmFtZSkge1xuICAgICAgICB2YXIgdG1wTWF0Y2ggPSBJU19XSEVOLmV4ZWMoYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIGlmICh0bXBNYXRjaCkge1xuICAgICAgICAgIHZhciB3aGVuS2V5ID0gKHRtcE1hdGNoWzFdID8gJy0nIDogJycpICsgbG93ZXJjYXNlKHRtcE1hdGNoWzJdKTtcbiAgICAgICAgICB3aGVuc1t3aGVuS2V5XSA9IGVsZW1lbnQuYXR0cihhdHRyLiRhdHRyW2F0dHJpYnV0ZU5hbWVdKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBmb3JFYWNoKHdoZW5zLCBmdW5jdGlvbihleHByZXNzaW9uLCBrZXkpIHtcbiAgICAgICAgd2hlbnNFeHBGbnNba2V5XSA9ICRpbnRlcnBvbGF0ZShleHByZXNzaW9uLnJlcGxhY2UoQlJBQ0UsIGJyYWNlUmVwbGFjZW1lbnQpKTtcblxuICAgICAgfSk7XG5cbiAgICAgIHNjb3BlLiR3YXRjaChudW1iZXJFeHAsIGZ1bmN0aW9uIG5nUGx1cmFsaXplV2F0Y2hBY3Rpb24obmV3VmFsKSB7XG4gICAgICAgIHZhciBjb3VudCA9IHBhcnNlRmxvYXQobmV3VmFsKTtcbiAgICAgICAgdmFyIGNvdW50SXNOYU4gPSBpc05hTihjb3VudCk7XG5cbiAgICAgICAgaWYgKCFjb3VudElzTmFOICYmICEoY291bnQgaW4gd2hlbnMpKSB7XG4gICAgICAgICAgLy8gSWYgYW4gZXhwbGljaXQgbnVtYmVyIHJ1bGUgc3VjaCBhcyAxLCAyLCAzLi4uIGlzIGRlZmluZWQsIGp1c3QgdXNlIGl0LlxuICAgICAgICAgIC8vIE90aGVyd2lzZSwgY2hlY2sgaXQgYWdhaW5zdCBwbHVyYWxpemF0aW9uIHJ1bGVzIGluICRsb2NhbGUgc2VydmljZS5cbiAgICAgICAgICBjb3VudCA9ICRsb2NhbGUucGx1cmFsQ2F0KGNvdW50IC0gb2Zmc2V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIGJvdGggYGNvdW50YCBhbmQgYGxhc3RDb3VudGAgYXJlIE5hTiwgd2UgZG9uJ3QgbmVlZCB0byByZS1yZWdpc3RlciBhIHdhdGNoLlxuICAgICAgICAvLyBJbiBKUyBgTmFOICE9PSBOYU5gLCBzbyB3ZSBoYXZlIHRvIGV4cGxpY2l0bHkgY2hlY2suXG4gICAgICAgIGlmICgoY291bnQgIT09IGxhc3RDb3VudCkgJiYgIShjb3VudElzTmFOICYmIGlzTnVtYmVyKGxhc3RDb3VudCkgJiYgaXNOYU4obGFzdENvdW50KSkpIHtcbiAgICAgICAgICB3YXRjaFJlbW92ZXIoKTtcbiAgICAgICAgICB2YXIgd2hlbkV4cEZuID0gd2hlbnNFeHBGbnNbY291bnRdO1xuICAgICAgICAgIGlmIChpc1VuZGVmaW5lZCh3aGVuRXhwRm4pKSB7XG4gICAgICAgICAgICBpZiAobmV3VmFsICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgJGxvZy5kZWJ1ZyhcIm5nUGx1cmFsaXplOiBubyBydWxlIGRlZmluZWQgZm9yICdcIiArIGNvdW50ICsgXCInIGluIFwiICsgd2hlbkV4cCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3YXRjaFJlbW92ZXIgPSBub29wO1xuICAgICAgICAgICAgdXBkYXRlRWxlbWVudFRleHQoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgd2F0Y2hSZW1vdmVyID0gc2NvcGUuJHdhdGNoKHdoZW5FeHBGbiwgdXBkYXRlRWxlbWVudFRleHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsYXN0Q291bnQgPSBjb3VudDtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGZ1bmN0aW9uIHVwZGF0ZUVsZW1lbnRUZXh0KG5ld1RleHQpIHtcbiAgICAgICAgZWxlbWVudC50ZXh0KG5ld1RleHQgfHwgJycpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1dO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nUmVwZWF0XG4gKiBAbXVsdGlFbGVtZW50XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGUgYG5nUmVwZWF0YCBkaXJlY3RpdmUgaW5zdGFudGlhdGVzIGEgdGVtcGxhdGUgb25jZSBwZXIgaXRlbSBmcm9tIGEgY29sbGVjdGlvbi4gRWFjaCB0ZW1wbGF0ZVxuICogaW5zdGFuY2UgZ2V0cyBpdHMgb3duIHNjb3BlLCB3aGVyZSB0aGUgZ2l2ZW4gbG9vcCB2YXJpYWJsZSBpcyBzZXQgdG8gdGhlIGN1cnJlbnQgY29sbGVjdGlvbiBpdGVtLFxuICogYW5kIGAkaW5kZXhgIGlzIHNldCB0byB0aGUgaXRlbSBpbmRleCBvciBrZXkuXG4gKlxuICogU3BlY2lhbCBwcm9wZXJ0aWVzIGFyZSBleHBvc2VkIG9uIHRoZSBsb2NhbCBzY29wZSBvZiBlYWNoIHRlbXBsYXRlIGluc3RhbmNlLCBpbmNsdWRpbmc6XG4gKlxuICogfCBWYXJpYWJsZSAgfCBUeXBlICAgICAgICAgICAgfCBEZXRhaWxzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfC0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxuICogfCBgJGluZGV4YCAgfCB7QHR5cGUgbnVtYmVyfSAgfCBpdGVyYXRvciBvZmZzZXQgb2YgdGhlIHJlcGVhdGVkIGVsZW1lbnQgKDAuLmxlbmd0aC0xKSAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCBgJGZpcnN0YCAgfCB7QHR5cGUgYm9vbGVhbn0gfCB0cnVlIGlmIHRoZSByZXBlYXRlZCBlbGVtZW50IGlzIGZpcnN0IGluIHRoZSBpdGVyYXRvci4gICAgICAgICAgICAgICAgICAgICAgfFxuICogfCBgJG1pZGRsZWAgfCB7QHR5cGUgYm9vbGVhbn0gfCB0cnVlIGlmIHRoZSByZXBlYXRlZCBlbGVtZW50IGlzIGJldHdlZW4gdGhlIGZpcnN0IGFuZCBsYXN0IGluIHRoZSBpdGVyYXRvci4gfFxuICogfCBgJGxhc3RgICAgfCB7QHR5cGUgYm9vbGVhbn0gfCB0cnVlIGlmIHRoZSByZXBlYXRlZCBlbGVtZW50IGlzIGxhc3QgaW4gdGhlIGl0ZXJhdG9yLiAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCBgJGV2ZW5gICAgfCB7QHR5cGUgYm9vbGVhbn0gfCB0cnVlIGlmIHRoZSBpdGVyYXRvciBwb3NpdGlvbiBgJGluZGV4YCBpcyBldmVuIChvdGhlcndpc2UgZmFsc2UpLiAgICAgICAgICAgfFxuICogfCBgJG9kZGAgICAgfCB7QHR5cGUgYm9vbGVhbn0gfCB0cnVlIGlmIHRoZSBpdGVyYXRvciBwb3NpdGlvbiBgJGluZGV4YCBpcyBvZGQgKG90aGVyd2lzZSBmYWxzZSkuICAgICAgICAgICAgfFxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1pbmZvXCI+XG4gKiAgIENyZWF0aW5nIGFsaWFzZXMgZm9yIHRoZXNlIHByb3BlcnRpZXMgaXMgcG9zc2libGUgd2l0aCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nSW5pdCBgbmdJbml0YH0uXG4gKiAgIFRoaXMgbWF5IGJlIHVzZWZ1bCB3aGVuLCBmb3IgaW5zdGFuY2UsIG5lc3RpbmcgbmdSZXBlYXRzLlxuICogPC9kaXY+XG4gKlxuICpcbiAqICMgSXRlcmF0aW5nIG92ZXIgb2JqZWN0IHByb3BlcnRpZXNcbiAqXG4gKiBJdCBpcyBwb3NzaWJsZSB0byBnZXQgYG5nUmVwZWF0YCB0byBpdGVyYXRlIG92ZXIgdGhlIHByb3BlcnRpZXMgb2YgYW4gb2JqZWN0IHVzaW5nIHRoZSBmb2xsb3dpbmdcbiAqIHN5bnRheDpcbiAqXG4gKiBgYGBqc1xuICogPGRpdiBuZy1yZXBlYXQ9XCIoa2V5LCB2YWx1ZSkgaW4gbXlPYmpcIj4gLi4uIDwvZGl2PlxuICogYGBgXG4gKlxuICogWW91IG5lZWQgdG8gYmUgYXdhcmUgdGhhdCB0aGUgSmF2YVNjcmlwdCBzcGVjaWZpY2F0aW9uIGRvZXMgbm90IGRlZmluZSB0aGUgb3JkZXIgb2Yga2V5c1xuICogcmV0dXJuZWQgZm9yIGFuIG9iamVjdC4gKFRvIG1pdGlnYXRlIHRoaXMgaW4gQW5ndWxhciAxLjMgdGhlIGBuZ1JlcGVhdGAgZGlyZWN0aXZlXG4gKiB1c2VkIHRvIHNvcnQgdGhlIGtleXMgYWxwaGFiZXRpY2FsbHkuKVxuICpcbiAqIFZlcnNpb24gMS40IHJlbW92ZWQgdGhlIGFscGhhYmV0aWMgc29ydGluZy4gV2Ugbm93IHJlbHkgb24gdGhlIG9yZGVyIHJldHVybmVkIGJ5IHRoZSBicm93c2VyXG4gKiB3aGVuIHJ1bm5pbmcgYGZvciBrZXkgaW4gbXlPYmpgLiBJdCBzZWVtcyB0aGF0IGJyb3dzZXJzIGdlbmVyYWxseSBmb2xsb3cgdGhlIHN0cmF0ZWd5IG9mIHByb3ZpZGluZ1xuICoga2V5cyBpbiB0aGUgb3JkZXIgaW4gd2hpY2ggdGhleSB3ZXJlIGRlZmluZWQsIGFsdGhvdWdoIHRoZXJlIGFyZSBleGNlcHRpb25zIHdoZW4ga2V5cyBhcmUgZGVsZXRlZFxuICogYW5kIHJlaW5zdGF0ZWQuIFNlZSB0aGUgW01ETiBwYWdlIG9uIGBkZWxldGVgIGZvciBtb3JlIGluZm9dKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL09wZXJhdG9ycy9kZWxldGUjQ3Jvc3MtYnJvd3Nlcl9ub3RlcykuXG4gKlxuICogSWYgdGhpcyBpcyBub3QgZGVzaXJlZCwgdGhlIHJlY29tbWVuZGVkIHdvcmthcm91bmQgaXMgdG8gY29udmVydCB5b3VyIG9iamVjdCBpbnRvIGFuIGFycmF5XG4gKiB0aGF0IGlzIHNvcnRlZCBpbnRvIHRoZSBvcmRlciB0aGF0IHlvdSBwcmVmZXIgYmVmb3JlIHByb3ZpZGluZyBpdCB0byBgbmdSZXBlYXRgLiAgWW91IGNvdWxkXG4gKiBkbyB0aGlzIHdpdGggYSBmaWx0ZXIgc3VjaCBhcyBbdG9BcnJheUZpbHRlcl0oaHR0cDovL25nbW9kdWxlcy5vcmcvbW9kdWxlcy9hbmd1bGFyLXRvQXJyYXlGaWx0ZXIpXG4gKiBvciBpbXBsZW1lbnQgYSBgJHdhdGNoYCBvbiB0aGUgb2JqZWN0IHlvdXJzZWxmLlxuICpcbiAqXG4gKiAjIFRyYWNraW5nIGFuZCBEdXBsaWNhdGVzXG4gKlxuICogYG5nUmVwZWF0YCB1c2VzIHtAbGluayAkcm9vdFNjb3BlLlNjb3BlIyR3YXRjaENvbGxlY3Rpb24gJHdhdGNoQ29sbGVjdGlvbn0gdG8gZGV0ZWN0IGNoYW5nZXMgaW5cbiAqIHRoZSBjb2xsZWN0aW9uLiBXaGVuIGEgY2hhbmdlIGhhcHBlbnMsIG5nUmVwZWF0IHRoZW4gbWFrZXMgdGhlIGNvcnJlc3BvbmRpbmcgY2hhbmdlcyB0byB0aGUgRE9NOlxuICpcbiAqICogV2hlbiBhbiBpdGVtIGlzIGFkZGVkLCBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgdGVtcGxhdGUgaXMgYWRkZWQgdG8gdGhlIERPTS5cbiAqICogV2hlbiBhbiBpdGVtIGlzIHJlbW92ZWQsIGl0cyB0ZW1wbGF0ZSBpbnN0YW5jZSBpcyByZW1vdmVkIGZyb20gdGhlIERPTS5cbiAqICogV2hlbiBpdGVtcyBhcmUgcmVvcmRlcmVkLCB0aGVpciByZXNwZWN0aXZlIHRlbXBsYXRlcyBhcmUgcmVvcmRlcmVkIGluIHRoZSBET00uXG4gKlxuICogVG8gbWluaW1pemUgY3JlYXRpb24gb2YgRE9NIGVsZW1lbnRzLCBgbmdSZXBlYXRgIHVzZXMgYSBmdW5jdGlvblxuICogdG8gXCJrZWVwIHRyYWNrXCIgb2YgYWxsIGl0ZW1zIGluIHRoZSBjb2xsZWN0aW9uIGFuZCB0aGVpciBjb3JyZXNwb25kaW5nIERPTSBlbGVtZW50cy5cbiAqIEZvciBleGFtcGxlLCBpZiBhbiBpdGVtIGlzIGFkZGVkIHRvIHRoZSBjb2xsZWN0aW9uLCBuZ1JlcGVhdCB3aWxsIGtub3cgdGhhdCBhbGwgb3RoZXIgaXRlbXNcbiAqIGFscmVhZHkgaGF2ZSBET00gZWxlbWVudHMsIGFuZCB3aWxsIG5vdCByZS1yZW5kZXIgdGhlbS5cbiAqXG4gKiBUaGUgZGVmYXVsdCB0cmFja2luZyBmdW5jdGlvbiAod2hpY2ggdHJhY2tzIGl0ZW1zIGJ5IHRoZWlyIGlkZW50aXR5KSBkb2VzIG5vdCBhbGxvd1xuICogZHVwbGljYXRlIGl0ZW1zIGluIGFycmF5cy4gVGhpcyBpcyBiZWNhdXNlIHdoZW4gdGhlcmUgYXJlIGR1cGxpY2F0ZXMsIGl0IGlzIG5vdCBwb3NzaWJsZVxuICogdG8gbWFpbnRhaW4gYSBvbmUtdG8tb25lIG1hcHBpbmcgYmV0d2VlbiBjb2xsZWN0aW9uIGl0ZW1zIGFuZCBET00gZWxlbWVudHMuXG4gKlxuICogSWYgeW91IGRvIG5lZWQgdG8gcmVwZWF0IGR1cGxpY2F0ZSBpdGVtcywgeW91IGNhbiBzdWJzdGl0dXRlIHRoZSBkZWZhdWx0IHRyYWNraW5nIGJlaGF2aW9yXG4gKiB3aXRoIHlvdXIgb3duIHVzaW5nIHRoZSBgdHJhY2sgYnlgIGV4cHJlc3Npb24uXG4gKlxuICogRm9yIGV4YW1wbGUsIHlvdSBtYXkgdHJhY2sgaXRlbXMgYnkgdGhlIGluZGV4IG9mIGVhY2ggaXRlbSBpbiB0aGUgY29sbGVjdGlvbiwgdXNpbmcgdGhlXG4gKiBzcGVjaWFsIHNjb3BlIHByb3BlcnR5IGAkaW5kZXhgOlxuICogYGBgaHRtbFxuICogICAgPGRpdiBuZy1yZXBlYXQ9XCJuIGluIFs0MiwgNDIsIDQzLCA0M10gdHJhY2sgYnkgJGluZGV4XCI+XG4gKiAgICAgIHt7bn19XG4gKiAgICA8L2Rpdj5cbiAqIGBgYFxuICpcbiAqIFlvdSBtYXkgYWxzbyB1c2UgYXJiaXRyYXJ5IGV4cHJlc3Npb25zIGluIGB0cmFjayBieWAsIGluY2x1ZGluZyByZWZlcmVuY2VzIHRvIGN1c3RvbSBmdW5jdGlvbnNcbiAqIG9uIHRoZSBzY29wZTpcbiAqIGBgYGh0bWxcbiAqICAgIDxkaXYgbmctcmVwZWF0PVwibiBpbiBbNDIsIDQyLCA0MywgNDNdIHRyYWNrIGJ5IG15VHJhY2tpbmdGdW5jdGlvbihuKVwiPlxuICogICAgICB7e259fVxuICogICAgPC9kaXY+XG4gKiBgYGBcbiAqXG4gKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtc3VjY2Vzc1wiPlxuICogSWYgeW91IGFyZSB3b3JraW5nIHdpdGggb2JqZWN0cyB0aGF0IGhhdmUgYW4gaWRlbnRpZmllciBwcm9wZXJ0eSwgeW91IHNob3VsZCB0cmFja1xuICogYnkgdGhlIGlkZW50aWZpZXIgaW5zdGVhZCBvZiB0aGUgd2hvbGUgb2JqZWN0LiBTaG91bGQgeW91IHJlbG9hZCB5b3VyIGRhdGEgbGF0ZXIsIGBuZ1JlcGVhdGBcbiAqIHdpbGwgbm90IGhhdmUgdG8gcmVidWlsZCB0aGUgRE9NIGVsZW1lbnRzIGZvciBpdGVtcyBpdCBoYXMgYWxyZWFkeSByZW5kZXJlZCwgZXZlbiBpZiB0aGVcbiAqIEphdmFTY3JpcHQgb2JqZWN0cyBpbiB0aGUgY29sbGVjdGlvbiBoYXZlIGJlZW4gc3Vic3RpdHV0ZWQgZm9yIG5ldyBvbmVzLiBGb3IgbGFyZ2UgY29sbGVjdGlvbnMsXG4gKiB0aGlzIHNpZ25pZmljYW50bHkgaW1wcm92ZXMgcmVuZGVyaW5nIHBlcmZvcm1hbmNlLiBJZiB5b3UgZG9uJ3QgaGF2ZSBhIHVuaXF1ZSBpZGVudGlmaWVyLFxuICogYHRyYWNrIGJ5ICRpbmRleGAgY2FuIGFsc28gcHJvdmlkZSBhIHBlcmZvcm1hbmNlIGJvb3N0LlxuICogPC9kaXY+XG4gKiBgYGBodG1sXG4gKiAgICA8ZGl2IG5nLXJlcGVhdD1cIm1vZGVsIGluIGNvbGxlY3Rpb24gdHJhY2sgYnkgbW9kZWwuaWRcIj5cbiAqICAgICAge3ttb2RlbC5uYW1lfX1cbiAqICAgIDwvZGl2PlxuICogYGBgXG4gKlxuICogV2hlbiBubyBgdHJhY2sgYnlgIGV4cHJlc3Npb24gaXMgcHJvdmlkZWQsIGl0IGlzIGVxdWl2YWxlbnQgdG8gdHJhY2tpbmcgYnkgdGhlIGJ1aWx0LWluXG4gKiBgJGlkYCBmdW5jdGlvbiwgd2hpY2ggdHJhY2tzIGl0ZW1zIGJ5IHRoZWlyIGlkZW50aXR5OlxuICogYGBgaHRtbFxuICogICAgPGRpdiBuZy1yZXBlYXQ9XCJvYmogaW4gY29sbGVjdGlvbiB0cmFjayBieSAkaWQob2JqKVwiPlxuICogICAgICB7e29iai5wcm9wfX1cbiAqICAgIDwvZGl2PlxuICogYGBgXG4gKlxuICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cbiAqICoqTm90ZToqKiBgdHJhY2sgYnlgIG11c3QgYWx3YXlzIGJlIHRoZSBsYXN0IGV4cHJlc3Npb246XG4gKiA8L2Rpdj5cbiAqIGBgYFxuICogPGRpdiBuZy1yZXBlYXQ9XCJtb2RlbCBpbiBjb2xsZWN0aW9uIHwgb3JkZXJCeTogJ2lkJyBhcyBmaWx0ZXJlZF9yZXN1bHQgdHJhY2sgYnkgbW9kZWwuaWRcIj5cbiAqICAgICB7e21vZGVsLm5hbWV9fVxuICogPC9kaXY+XG4gKiBgYGBcbiAqXG4gKiAjIFNwZWNpYWwgcmVwZWF0IHN0YXJ0IGFuZCBlbmQgcG9pbnRzXG4gKiBUbyByZXBlYXQgYSBzZXJpZXMgb2YgZWxlbWVudHMgaW5zdGVhZCBvZiBqdXN0IG9uZSBwYXJlbnQgZWxlbWVudCwgbmdSZXBlYXQgKGFzIHdlbGwgYXMgb3RoZXIgbmcgZGlyZWN0aXZlcykgc3VwcG9ydHMgZXh0ZW5kaW5nXG4gKiB0aGUgcmFuZ2Ugb2YgdGhlIHJlcGVhdGVyIGJ5IGRlZmluaW5nIGV4cGxpY2l0IHN0YXJ0IGFuZCBlbmQgcG9pbnRzIGJ5IHVzaW5nICoqbmctcmVwZWF0LXN0YXJ0KiogYW5kICoqbmctcmVwZWF0LWVuZCoqIHJlc3BlY3RpdmVseS5cbiAqIFRoZSAqKm5nLXJlcGVhdC1zdGFydCoqIGRpcmVjdGl2ZSB3b3JrcyB0aGUgc2FtZSBhcyAqKm5nLXJlcGVhdCoqLCBidXQgd2lsbCByZXBlYXQgYWxsIHRoZSBIVE1MIGNvZGUgKGluY2x1ZGluZyB0aGUgdGFnIGl0J3MgZGVmaW5lZCBvbilcbiAqIHVwIHRvIGFuZCBpbmNsdWRpbmcgdGhlIGVuZGluZyBIVE1MIHRhZyB3aGVyZSAqKm5nLXJlcGVhdC1lbmQqKiBpcyBwbGFjZWQuXG4gKlxuICogVGhlIGV4YW1wbGUgYmVsb3cgbWFrZXMgdXNlIG9mIHRoaXMgZmVhdHVyZTpcbiAqIGBgYGh0bWxcbiAqICAgPGhlYWRlciBuZy1yZXBlYXQtc3RhcnQ9XCJpdGVtIGluIGl0ZW1zXCI+XG4gKiAgICAgSGVhZGVyIHt7IGl0ZW0gfX1cbiAqICAgPC9oZWFkZXI+XG4gKiAgIDxkaXYgY2xhc3M9XCJib2R5XCI+XG4gKiAgICAgQm9keSB7eyBpdGVtIH19XG4gKiAgIDwvZGl2PlxuICogICA8Zm9vdGVyIG5nLXJlcGVhdC1lbmQ+XG4gKiAgICAgRm9vdGVyIHt7IGl0ZW0gfX1cbiAqICAgPC9mb290ZXI+XG4gKiBgYGBcbiAqXG4gKiBBbmQgd2l0aCBhbiBpbnB1dCBvZiB7QHR5cGUgWydBJywnQiddfSBmb3IgdGhlIGl0ZW1zIHZhcmlhYmxlIGluIHRoZSBleGFtcGxlIGFib3ZlLCB0aGUgb3V0cHV0IHdpbGwgZXZhbHVhdGUgdG86XG4gKiBgYGBodG1sXG4gKiAgIDxoZWFkZXI+XG4gKiAgICAgSGVhZGVyIEFcbiAqICAgPC9oZWFkZXI+XG4gKiAgIDxkaXYgY2xhc3M9XCJib2R5XCI+XG4gKiAgICAgQm9keSBBXG4gKiAgIDwvZGl2PlxuICogICA8Zm9vdGVyPlxuICogICAgIEZvb3RlciBBXG4gKiAgIDwvZm9vdGVyPlxuICogICA8aGVhZGVyPlxuICogICAgIEhlYWRlciBCXG4gKiAgIDwvaGVhZGVyPlxuICogICA8ZGl2IGNsYXNzPVwiYm9keVwiPlxuICogICAgIEJvZHkgQlxuICogICA8L2Rpdj5cbiAqICAgPGZvb3Rlcj5cbiAqICAgICBGb290ZXIgQlxuICogICA8L2Zvb3Rlcj5cbiAqIGBgYFxuICpcbiAqIFRoZSBjdXN0b20gc3RhcnQgYW5kIGVuZCBwb2ludHMgZm9yIG5nUmVwZWF0IGFsc28gc3VwcG9ydCBhbGwgb3RoZXIgSFRNTCBkaXJlY3RpdmUgc3ludGF4IGZsYXZvcnMgcHJvdmlkZWQgaW4gQW5ndWxhckpTIChzdWNoXG4gKiBhcyAqKmRhdGEtbmctcmVwZWF0LXN0YXJ0KiosICoqeC1uZy1yZXBlYXQtc3RhcnQqKiBhbmQgKipuZzpyZXBlYXQtc3RhcnQqKikuXG4gKlxuICogQGFuaW1hdGlvbnNcbiAqICoqLmVudGVyKiogLSB3aGVuIGEgbmV3IGl0ZW0gaXMgYWRkZWQgdG8gdGhlIGxpc3Qgb3Igd2hlbiBhbiBpdGVtIGlzIHJldmVhbGVkIGFmdGVyIGEgZmlsdGVyXG4gKlxuICogKioubGVhdmUqKiAtIHdoZW4gYW4gaXRlbSBpcyByZW1vdmVkIGZyb20gdGhlIGxpc3Qgb3Igd2hlbiBhbiBpdGVtIGlzIGZpbHRlcmVkIG91dFxuICpcbiAqICoqLm1vdmUqKiAtIHdoZW4gYW4gYWRqYWNlbnQgaXRlbSBpcyBmaWx0ZXJlZCBvdXQgY2F1c2luZyBhIHJlb3JkZXIgb3Igd2hlbiB0aGUgaXRlbSBjb250ZW50cyBhcmUgcmVvcmRlcmVkXG4gKlxuICogU2VlIHRoZSBleGFtcGxlIGJlbG93IGZvciBkZWZpbmluZyBDU1MgYW5pbWF0aW9ucyB3aXRoIG5nUmVwZWF0LlxuICpcbiAqIEBlbGVtZW50IEFOWVxuICogQHNjb3BlXG4gKiBAcHJpb3JpdHkgMTAwMFxuICogQHBhcmFtIHtyZXBlYXRfZXhwcmVzc2lvbn0gbmdSZXBlYXQgVGhlIGV4cHJlc3Npb24gaW5kaWNhdGluZyBob3cgdG8gZW51bWVyYXRlIGEgY29sbGVjdGlvbi4gVGhlc2VcbiAqICAgZm9ybWF0cyBhcmUgY3VycmVudGx5IHN1cHBvcnRlZDpcbiAqXG4gKiAgICogYHZhcmlhYmxlIGluIGV4cHJlc3Npb25gIOKAkyB3aGVyZSB2YXJpYWJsZSBpcyB0aGUgdXNlciBkZWZpbmVkIGxvb3AgdmFyaWFibGUgYW5kIGBleHByZXNzaW9uYFxuICogICAgIGlzIGEgc2NvcGUgZXhwcmVzc2lvbiBnaXZpbmcgdGhlIGNvbGxlY3Rpb24gdG8gZW51bWVyYXRlLlxuICpcbiAqICAgICBGb3IgZXhhbXBsZTogYGFsYnVtIGluIGFydGlzdC5hbGJ1bXNgLlxuICpcbiAqICAgKiBgKGtleSwgdmFsdWUpIGluIGV4cHJlc3Npb25gIOKAkyB3aGVyZSBga2V5YCBhbmQgYHZhbHVlYCBjYW4gYmUgYW55IHVzZXIgZGVmaW5lZCBpZGVudGlmaWVycyxcbiAqICAgICBhbmQgYGV4cHJlc3Npb25gIGlzIHRoZSBzY29wZSBleHByZXNzaW9uIGdpdmluZyB0aGUgY29sbGVjdGlvbiB0byBlbnVtZXJhdGUuXG4gKlxuICogICAgIEZvciBleGFtcGxlOiBgKG5hbWUsIGFnZSkgaW4geydhZGFtJzoxMCwgJ2FtYWxpZSc6MTJ9YC5cbiAqXG4gKiAgICogYHZhcmlhYmxlIGluIGV4cHJlc3Npb24gdHJhY2sgYnkgdHJhY2tpbmdfZXhwcmVzc2lvbmAg4oCTIFlvdSBjYW4gYWxzbyBwcm92aWRlIGFuIG9wdGlvbmFsIHRyYWNraW5nIGV4cHJlc3Npb25cbiAqICAgICB3aGljaCBjYW4gYmUgdXNlZCB0byBhc3NvY2lhdGUgdGhlIG9iamVjdHMgaW4gdGhlIGNvbGxlY3Rpb24gd2l0aCB0aGUgRE9NIGVsZW1lbnRzLiBJZiBubyB0cmFja2luZyBleHByZXNzaW9uXG4gKiAgICAgaXMgc3BlY2lmaWVkLCBuZy1yZXBlYXQgYXNzb2NpYXRlcyBlbGVtZW50cyBieSBpZGVudGl0eS4gSXQgaXMgYW4gZXJyb3IgdG8gaGF2ZVxuICogICAgIG1vcmUgdGhhbiBvbmUgdHJhY2tpbmcgZXhwcmVzc2lvbiB2YWx1ZSByZXNvbHZlIHRvIHRoZSBzYW1lIGtleS4gKFRoaXMgd291bGQgbWVhbiB0aGF0IHR3byBkaXN0aW5jdCBvYmplY3RzIGFyZVxuICogICAgIG1hcHBlZCB0byB0aGUgc2FtZSBET00gZWxlbWVudCwgd2hpY2ggaXMgbm90IHBvc3NpYmxlLilcbiAqXG4gKiAgICAgTm90ZSB0aGF0IHRoZSB0cmFja2luZyBleHByZXNzaW9uIG11c3QgY29tZSBsYXN0LCBhZnRlciBhbnkgZmlsdGVycywgYW5kIHRoZSBhbGlhcyBleHByZXNzaW9uLlxuICpcbiAqICAgICBGb3IgZXhhbXBsZTogYGl0ZW0gaW4gaXRlbXNgIGlzIGVxdWl2YWxlbnQgdG8gYGl0ZW0gaW4gaXRlbXMgdHJhY2sgYnkgJGlkKGl0ZW0pYC4gVGhpcyBpbXBsaWVzIHRoYXQgdGhlIERPTSBlbGVtZW50c1xuICogICAgIHdpbGwgYmUgYXNzb2NpYXRlZCBieSBpdGVtIGlkZW50aXR5IGluIHRoZSBhcnJheS5cbiAqXG4gKiAgICAgRm9yIGV4YW1wbGU6IGBpdGVtIGluIGl0ZW1zIHRyYWNrIGJ5ICRpZChpdGVtKWAuIEEgYnVpbHQgaW4gYCRpZCgpYCBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBhc3NpZ24gYSB1bmlxdWVcbiAqICAgICBgJCRoYXNoS2V5YCBwcm9wZXJ0eSB0byBlYWNoIGl0ZW0gaW4gdGhlIGFycmF5LiBUaGlzIHByb3BlcnR5IGlzIHRoZW4gdXNlZCBhcyBhIGtleSB0byBhc3NvY2lhdGVkIERPTSBlbGVtZW50c1xuICogICAgIHdpdGggdGhlIGNvcnJlc3BvbmRpbmcgaXRlbSBpbiB0aGUgYXJyYXkgYnkgaWRlbnRpdHkuIE1vdmluZyB0aGUgc2FtZSBvYmplY3QgaW4gYXJyYXkgd291bGQgbW92ZSB0aGUgRE9NXG4gKiAgICAgZWxlbWVudCBpbiB0aGUgc2FtZSB3YXkgaW4gdGhlIERPTS5cbiAqXG4gKiAgICAgRm9yIGV4YW1wbGU6IGBpdGVtIGluIGl0ZW1zIHRyYWNrIGJ5IGl0ZW0uaWRgIGlzIGEgdHlwaWNhbCBwYXR0ZXJuIHdoZW4gdGhlIGl0ZW1zIGNvbWUgZnJvbSB0aGUgZGF0YWJhc2UuIEluIHRoaXNcbiAqICAgICBjYXNlIHRoZSBvYmplY3QgaWRlbnRpdHkgZG9lcyBub3QgbWF0dGVyLiBUd28gb2JqZWN0cyBhcmUgY29uc2lkZXJlZCBlcXVpdmFsZW50IGFzIGxvbmcgYXMgdGhlaXIgYGlkYFxuICogICAgIHByb3BlcnR5IGlzIHNhbWUuXG4gKlxuICogICAgIEZvciBleGFtcGxlOiBgaXRlbSBpbiBpdGVtcyB8IGZpbHRlcjpzZWFyY2hUZXh0IHRyYWNrIGJ5IGl0ZW0uaWRgIGlzIGEgcGF0dGVybiB0aGF0IG1pZ2h0IGJlIHVzZWQgdG8gYXBwbHkgYSBmaWx0ZXJcbiAqICAgICB0byBpdGVtcyBpbiBjb25qdW5jdGlvbiB3aXRoIGEgdHJhY2tpbmcgZXhwcmVzc2lvbi5cbiAqXG4gKiAgICogYHZhcmlhYmxlIGluIGV4cHJlc3Npb24gYXMgYWxpYXNfZXhwcmVzc2lvbmAg4oCTIFlvdSBjYW4gYWxzbyBwcm92aWRlIGFuIG9wdGlvbmFsIGFsaWFzIGV4cHJlc3Npb24gd2hpY2ggd2lsbCB0aGVuIHN0b3JlIHRoZVxuICogICAgIGludGVybWVkaWF0ZSByZXN1bHRzIG9mIHRoZSByZXBlYXRlciBhZnRlciB0aGUgZmlsdGVycyBoYXZlIGJlZW4gYXBwbGllZC4gVHlwaWNhbGx5IHRoaXMgaXMgdXNlZCB0byByZW5kZXIgYSBzcGVjaWFsIG1lc3NhZ2VcbiAqICAgICB3aGVuIGEgZmlsdGVyIGlzIGFjdGl2ZSBvbiB0aGUgcmVwZWF0ZXIsIGJ1dCB0aGUgZmlsdGVyZWQgcmVzdWx0IHNldCBpcyBlbXB0eS5cbiAqXG4gKiAgICAgRm9yIGV4YW1wbGU6IGBpdGVtIGluIGl0ZW1zIHwgZmlsdGVyOnggYXMgcmVzdWx0c2Agd2lsbCBzdG9yZSB0aGUgZnJhZ21lbnQgb2YgdGhlIHJlcGVhdGVkIGl0ZW1zIGFzIGByZXN1bHRzYCwgYnV0IG9ubHkgYWZ0ZXJcbiAqICAgICB0aGUgaXRlbXMgaGF2ZSBiZWVuIHByb2Nlc3NlZCB0aHJvdWdoIHRoZSBmaWx0ZXIuXG4gKlxuICogICAgIFBsZWFzZSBub3RlIHRoYXQgYGFzIFt2YXJpYWJsZSBuYW1lXSBpcyBub3QgYW4gb3BlcmF0b3IgYnV0IHJhdGhlciBhIHBhcnQgb2YgbmdSZXBlYXQgbWljcm8tc3ludGF4IHNvIGl0IGNhbiBiZSB1c2VkIG9ubHkgYXQgdGhlIGVuZFxuICogICAgIChhbmQgbm90IGFzIG9wZXJhdG9yLCBpbnNpZGUgYW4gZXhwcmVzc2lvbikuXG4gKlxuICogICAgIEZvciBleGFtcGxlOiBgaXRlbSBpbiBpdGVtcyB8IGZpbHRlciA6IHggfCBvcmRlckJ5IDogb3JkZXIgfCBsaW1pdFRvIDogbGltaXQgYXMgcmVzdWx0c2AgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBUaGlzIGV4YW1wbGUgdXNlcyBgbmdSZXBlYXRgIHRvIGRpc3BsYXkgYSBsaXN0IG9mIHBlb3BsZS4gQSBmaWx0ZXIgaXMgdXNlZCB0byByZXN0cmljdCB0aGUgZGlzcGxheWVkXG4gKiByZXN1bHRzIGJ5IG5hbWUuIE5ldyAoZW50ZXJpbmcpIGFuZCByZW1vdmVkIChsZWF2aW5nKSBpdGVtcyBhcmUgYW5pbWF0ZWQuXG4gIDxleGFtcGxlIG1vZHVsZT1cIm5nUmVwZWF0XCIgbmFtZT1cIm5nUmVwZWF0XCIgZGVwcz1cImFuZ3VsYXItYW5pbWF0ZS5qc1wiIGFuaW1hdGlvbnM9XCJ0cnVlXCI+XG4gICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIDxkaXYgbmctY29udHJvbGxlcj1cInJlcGVhdENvbnRyb2xsZXJcIj5cbiAgICAgICAgSSBoYXZlIHt7ZnJpZW5kcy5sZW5ndGh9fSBmcmllbmRzLiBUaGV5IGFyZTpcbiAgICAgICAgPGlucHV0IHR5cGU9XCJzZWFyY2hcIiBuZy1tb2RlbD1cInFcIiBwbGFjZWhvbGRlcj1cImZpbHRlciBmcmllbmRzLi4uXCIgYXJpYS1sYWJlbD1cImZpbHRlciBmcmllbmRzXCIgLz5cbiAgICAgICAgPHVsIGNsYXNzPVwiZXhhbXBsZS1hbmltYXRlLWNvbnRhaW5lclwiPlxuICAgICAgICAgIDxsaSBjbGFzcz1cImFuaW1hdGUtcmVwZWF0XCIgbmctcmVwZWF0PVwiZnJpZW5kIGluIGZyaWVuZHMgfCBmaWx0ZXI6cSBhcyByZXN1bHRzXCI+XG4gICAgICAgICAgICBbe3skaW5kZXggKyAxfX1dIHt7ZnJpZW5kLm5hbWV9fSB3aG8gaXMge3tmcmllbmQuYWdlfX0geWVhcnMgb2xkLlxuICAgICAgICAgIDwvbGk+XG4gICAgICAgICAgPGxpIGNsYXNzPVwiYW5pbWF0ZS1yZXBlYXRcIiBuZy1pZj1cInJlc3VsdHMubGVuZ3RoID09IDBcIj5cbiAgICAgICAgICAgIDxzdHJvbmc+Tm8gcmVzdWx0cyBmb3VuZC4uLjwvc3Ryb25nPlxuICAgICAgICAgIDwvbGk+XG4gICAgICAgIDwvdWw+XG4gICAgICA8L2Rpdj5cbiAgICA8L2ZpbGU+XG4gICAgPGZpbGUgbmFtZT1cInNjcmlwdC5qc1wiPlxuICAgICAgYW5ndWxhci5tb2R1bGUoJ25nUmVwZWF0JywgWyduZ0FuaW1hdGUnXSkuY29udHJvbGxlcigncmVwZWF0Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAkc2NvcGUuZnJpZW5kcyA9IFtcbiAgICAgICAgICB7bmFtZTonSm9obicsIGFnZToyNSwgZ2VuZGVyOidib3knfSxcbiAgICAgICAgICB7bmFtZTonSmVzc2llJywgYWdlOjMwLCBnZW5kZXI6J2dpcmwnfSxcbiAgICAgICAgICB7bmFtZTonSm9oYW5uYScsIGFnZToyOCwgZ2VuZGVyOidnaXJsJ30sXG4gICAgICAgICAge25hbWU6J0pveScsIGFnZToxNSwgZ2VuZGVyOidnaXJsJ30sXG4gICAgICAgICAge25hbWU6J01hcnknLCBhZ2U6MjgsIGdlbmRlcjonZ2lybCd9LFxuICAgICAgICAgIHtuYW1lOidQZXRlcicsIGFnZTo5NSwgZ2VuZGVyOidib3knfSxcbiAgICAgICAgICB7bmFtZTonU2ViYXN0aWFuJywgYWdlOjUwLCBnZW5kZXI6J2JveSd9LFxuICAgICAgICAgIHtuYW1lOidFcmlrYScsIGFnZToyNywgZ2VuZGVyOidnaXJsJ30sXG4gICAgICAgICAge25hbWU6J1BhdHJpY2snLCBhZ2U6NDAsIGdlbmRlcjonYm95J30sXG4gICAgICAgICAge25hbWU6J1NhbWFudGhhJywgYWdlOjYwLCBnZW5kZXI6J2dpcmwnfVxuICAgICAgICBdO1xuICAgICAgfSk7XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJhbmltYXRpb25zLmNzc1wiPlxuICAgICAgLmV4YW1wbGUtYW5pbWF0ZS1jb250YWluZXIge1xuICAgICAgICBiYWNrZ3JvdW5kOndoaXRlO1xuICAgICAgICBib3JkZXI6MXB4IHNvbGlkIGJsYWNrO1xuICAgICAgICBsaXN0LXN0eWxlOm5vbmU7XG4gICAgICAgIG1hcmdpbjowO1xuICAgICAgICBwYWRkaW5nOjAgMTBweDtcbiAgICAgIH1cblxuICAgICAgLmFuaW1hdGUtcmVwZWF0IHtcbiAgICAgICAgbGluZS1oZWlnaHQ6MzBweDtcbiAgICAgICAgbGlzdC1zdHlsZTpub25lO1xuICAgICAgICBib3gtc2l6aW5nOmJvcmRlci1ib3g7XG4gICAgICB9XG5cbiAgICAgIC5hbmltYXRlLXJlcGVhdC5uZy1tb3ZlLFxuICAgICAgLmFuaW1hdGUtcmVwZWF0Lm5nLWVudGVyLFxuICAgICAgLmFuaW1hdGUtcmVwZWF0Lm5nLWxlYXZlIHtcbiAgICAgICAgdHJhbnNpdGlvbjphbGwgbGluZWFyIDAuNXM7XG4gICAgICB9XG5cbiAgICAgIC5hbmltYXRlLXJlcGVhdC5uZy1sZWF2ZS5uZy1sZWF2ZS1hY3RpdmUsXG4gICAgICAuYW5pbWF0ZS1yZXBlYXQubmctbW92ZSxcbiAgICAgIC5hbmltYXRlLXJlcGVhdC5uZy1lbnRlciB7XG4gICAgICAgIG9wYWNpdHk6MDtcbiAgICAgICAgbWF4LWhlaWdodDowO1xuICAgICAgfVxuXG4gICAgICAuYW5pbWF0ZS1yZXBlYXQubmctbGVhdmUsXG4gICAgICAuYW5pbWF0ZS1yZXBlYXQubmctbW92ZS5uZy1tb3ZlLWFjdGl2ZSxcbiAgICAgIC5hbmltYXRlLXJlcGVhdC5uZy1lbnRlci5uZy1lbnRlci1hY3RpdmUge1xuICAgICAgICBvcGFjaXR5OjE7XG4gICAgICAgIG1heC1oZWlnaHQ6MzBweDtcbiAgICAgIH1cbiAgICA8L2ZpbGU+XG4gICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgdmFyIGZyaWVuZHMgPSBlbGVtZW50LmFsbChieS5yZXBlYXRlcignZnJpZW5kIGluIGZyaWVuZHMnKSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmVuZGVyIGluaXRpYWwgZGF0YSBzZXQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgZXhwZWN0KGZyaWVuZHMuY291bnQoKSkudG9CZSgxMCk7XG4gICAgICAgIGV4cGVjdChmcmllbmRzLmdldCgwKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ1sxXSBKb2huIHdobyBpcyAyNSB5ZWFycyBvbGQuJyk7XG4gICAgICAgIGV4cGVjdChmcmllbmRzLmdldCgxKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ1syXSBKZXNzaWUgd2hvIGlzIDMwIHllYXJzIG9sZC4nKTtcbiAgICAgICAgZXhwZWN0KGZyaWVuZHMubGFzdCgpLmdldFRleHQoKSkudG9FcXVhbCgnWzEwXSBTYW1hbnRoYSB3aG8gaXMgNjAgeWVhcnMgb2xkLicpO1xuICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKCdmcmllbmRzLmxlbmd0aCcpKS5nZXRUZXh0KCkpXG4gICAgICAgICAgICAudG9NYXRjaChcIkkgaGF2ZSAxMCBmcmllbmRzLiBUaGV5IGFyZTpcIik7XG4gICAgICB9KTtcblxuICAgICAgIGl0KCdzaG91bGQgdXBkYXRlIHJlcGVhdGVyIHdoZW4gZmlsdGVyIHByZWRpY2F0ZSBjaGFuZ2VzJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICBleHBlY3QoZnJpZW5kcy5jb3VudCgpKS50b0JlKDEwKTtcblxuICAgICAgICAgZWxlbWVudChieS5tb2RlbCgncScpKS5zZW5kS2V5cygnbWEnKTtcblxuICAgICAgICAgZXhwZWN0KGZyaWVuZHMuY291bnQoKSkudG9CZSgyKTtcbiAgICAgICAgIGV4cGVjdChmcmllbmRzLmdldCgwKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ1sxXSBNYXJ5IHdobyBpcyAyOCB5ZWFycyBvbGQuJyk7XG4gICAgICAgICBleHBlY3QoZnJpZW5kcy5sYXN0KCkuZ2V0VGV4dCgpKS50b0VxdWFsKCdbMl0gU2FtYW50aGEgd2hvIGlzIDYwIHllYXJzIG9sZC4nKTtcbiAgICAgICB9KTtcbiAgICAgIDwvZmlsZT5cbiAgICA8L2V4YW1wbGU+XG4gKi9cbnZhciBuZ1JlcGVhdERpcmVjdGl2ZSA9IFsnJHBhcnNlJywgJyRhbmltYXRlJywgZnVuY3Rpb24oJHBhcnNlLCAkYW5pbWF0ZSkge1xuICB2YXIgTkdfUkVNT1ZFRCA9ICckJE5HX1JFTU9WRUQnO1xuICB2YXIgbmdSZXBlYXRNaW5FcnIgPSBtaW5FcnIoJ25nUmVwZWF0Jyk7XG5cbiAgdmFyIHVwZGF0ZVNjb3BlID0gZnVuY3Rpb24oc2NvcGUsIGluZGV4LCB2YWx1ZUlkZW50aWZpZXIsIHZhbHVlLCBrZXlJZGVudGlmaWVyLCBrZXksIGFycmF5TGVuZ3RoKSB7XG4gICAgLy8gVE9ETyhwZXJmKTogZ2VuZXJhdGUgc2V0dGVycyB0byBzaGF2ZSBvZmYgfjQwbXMgb3IgMS0xLjUlXG4gICAgc2NvcGVbdmFsdWVJZGVudGlmaWVyXSA9IHZhbHVlO1xuICAgIGlmIChrZXlJZGVudGlmaWVyKSBzY29wZVtrZXlJZGVudGlmaWVyXSA9IGtleTtcbiAgICBzY29wZS4kaW5kZXggPSBpbmRleDtcbiAgICBzY29wZS4kZmlyc3QgPSAoaW5kZXggPT09IDApO1xuICAgIHNjb3BlLiRsYXN0ID0gKGluZGV4ID09PSAoYXJyYXlMZW5ndGggLSAxKSk7XG4gICAgc2NvcGUuJG1pZGRsZSA9ICEoc2NvcGUuJGZpcnN0IHx8IHNjb3BlLiRsYXN0KTtcbiAgICAvLyBqc2hpbnQgYml0d2lzZTogZmFsc2VcbiAgICBzY29wZS4kb2RkID0gIShzY29wZS4kZXZlbiA9IChpbmRleCYxKSA9PT0gMCk7XG4gICAgLy8ganNoaW50IGJpdHdpc2U6IHRydWVcbiAgfTtcblxuICB2YXIgZ2V0QmxvY2tTdGFydCA9IGZ1bmN0aW9uKGJsb2NrKSB7XG4gICAgcmV0dXJuIGJsb2NrLmNsb25lWzBdO1xuICB9O1xuXG4gIHZhciBnZXRCbG9ja0VuZCA9IGZ1bmN0aW9uKGJsb2NrKSB7XG4gICAgcmV0dXJuIGJsb2NrLmNsb25lW2Jsb2NrLmNsb25lLmxlbmd0aCAtIDFdO1xuICB9O1xuXG5cbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIG11bHRpRWxlbWVudDogdHJ1ZSxcbiAgICB0cmFuc2NsdWRlOiAnZWxlbWVudCcsXG4gICAgcHJpb3JpdHk6IDEwMDAsXG4gICAgdGVybWluYWw6IHRydWUsXG4gICAgJCR0bGI6IHRydWUsXG4gICAgY29tcGlsZTogZnVuY3Rpb24gbmdSZXBlYXRDb21waWxlKCRlbGVtZW50LCAkYXR0cikge1xuICAgICAgdmFyIGV4cHJlc3Npb24gPSAkYXR0ci5uZ1JlcGVhdDtcbiAgICAgIHZhciBuZ1JlcGVhdEVuZENvbW1lbnQgPSBkb2N1bWVudC5jcmVhdGVDb21tZW50KCcgZW5kIG5nUmVwZWF0OiAnICsgZXhwcmVzc2lvbiArICcgJyk7XG5cbiAgICAgIHZhciBtYXRjaCA9IGV4cHJlc3Npb24ubWF0Y2goL15cXHMqKFtcXHNcXFNdKz8pXFxzK2luXFxzKyhbXFxzXFxTXSs/KSg/Olxccythc1xccysoW1xcc1xcU10rPykpPyg/Olxccyt0cmFja1xccytieVxccysoW1xcc1xcU10rPykpP1xccyokLyk7XG5cbiAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgdGhyb3cgbmdSZXBlYXRNaW5FcnIoJ2lleHAnLCBcIkV4cGVjdGVkIGV4cHJlc3Npb24gaW4gZm9ybSBvZiAnX2l0ZW1fIGluIF9jb2xsZWN0aW9uX1sgdHJhY2sgYnkgX2lkX10nIGJ1dCBnb3QgJ3swfScuXCIsXG4gICAgICAgICAgICBleHByZXNzaW9uKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGxocyA9IG1hdGNoWzFdO1xuICAgICAgdmFyIHJocyA9IG1hdGNoWzJdO1xuICAgICAgdmFyIGFsaWFzQXMgPSBtYXRjaFszXTtcbiAgICAgIHZhciB0cmFja0J5RXhwID0gbWF0Y2hbNF07XG5cbiAgICAgIG1hdGNoID0gbGhzLm1hdGNoKC9eKD86KFxccypbXFwkXFx3XSspfFxcKFxccyooW1xcJFxcd10rKVxccyosXFxzKihbXFwkXFx3XSspXFxzKlxcKSkkLyk7XG5cbiAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgdGhyb3cgbmdSZXBlYXRNaW5FcnIoJ2lpZGV4cCcsIFwiJ19pdGVtXycgaW4gJ19pdGVtXyBpbiBfY29sbGVjdGlvbl8nIHNob3VsZCBiZSBhbiBpZGVudGlmaWVyIG9yICcoX2tleV8sIF92YWx1ZV8pJyBleHByZXNzaW9uLCBidXQgZ290ICd7MH0nLlwiLFxuICAgICAgICAgICAgbGhzKTtcbiAgICAgIH1cbiAgICAgIHZhciB2YWx1ZUlkZW50aWZpZXIgPSBtYXRjaFszXSB8fCBtYXRjaFsxXTtcbiAgICAgIHZhciBrZXlJZGVudGlmaWVyID0gbWF0Y2hbMl07XG5cbiAgICAgIGlmIChhbGlhc0FzICYmICghL15bJGEtekEtWl9dWyRhLXpBLVowLTlfXSokLy50ZXN0KGFsaWFzQXMpIHx8XG4gICAgICAgICAgL14obnVsbHx1bmRlZmluZWR8dGhpc3xcXCRpbmRleHxcXCRmaXJzdHxcXCRtaWRkbGV8XFwkbGFzdHxcXCRldmVufFxcJG9kZHxcXCRwYXJlbnR8XFwkcm9vdHxcXCRpZCkkLy50ZXN0KGFsaWFzQXMpKSkge1xuICAgICAgICB0aHJvdyBuZ1JlcGVhdE1pbkVycignYmFkaWRlbnQnLCBcImFsaWFzICd7MH0nIGlzIGludmFsaWQgLS0tIG11c3QgYmUgYSB2YWxpZCBKUyBpZGVudGlmaWVyIHdoaWNoIGlzIG5vdCBhIHJlc2VydmVkIG5hbWUuXCIsXG4gICAgICAgICAgYWxpYXNBcyk7XG4gICAgICB9XG5cbiAgICAgIHZhciB0cmFja0J5RXhwR2V0dGVyLCB0cmFja0J5SWRFeHBGbiwgdHJhY2tCeUlkQXJyYXlGbiwgdHJhY2tCeUlkT2JqRm47XG4gICAgICB2YXIgaGFzaEZuTG9jYWxzID0geyRpZDogaGFzaEtleX07XG5cbiAgICAgIGlmICh0cmFja0J5RXhwKSB7XG4gICAgICAgIHRyYWNrQnlFeHBHZXR0ZXIgPSAkcGFyc2UodHJhY2tCeUV4cCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0cmFja0J5SWRBcnJheUZuID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiBoYXNoS2V5KHZhbHVlKTtcbiAgICAgICAgfTtcbiAgICAgICAgdHJhY2tCeUlkT2JqRm4gPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICByZXR1cm4ga2V5O1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZnVuY3Rpb24gbmdSZXBlYXRMaW5rKCRzY29wZSwgJGVsZW1lbnQsICRhdHRyLCBjdHJsLCAkdHJhbnNjbHVkZSkge1xuXG4gICAgICAgIGlmICh0cmFja0J5RXhwR2V0dGVyKSB7XG4gICAgICAgICAgdHJhY2tCeUlkRXhwRm4gPSBmdW5jdGlvbihrZXksIHZhbHVlLCBpbmRleCkge1xuICAgICAgICAgICAgLy8gYXNzaWduIGtleSwgdmFsdWUsIGFuZCAkaW5kZXggdG8gdGhlIGxvY2FscyBzbyB0aGF0IHRoZXkgY2FuIGJlIHVzZWQgaW4gaGFzaCBmdW5jdGlvbnNcbiAgICAgICAgICAgIGlmIChrZXlJZGVudGlmaWVyKSBoYXNoRm5Mb2NhbHNba2V5SWRlbnRpZmllcl0gPSBrZXk7XG4gICAgICAgICAgICBoYXNoRm5Mb2NhbHNbdmFsdWVJZGVudGlmaWVyXSA9IHZhbHVlO1xuICAgICAgICAgICAgaGFzaEZuTG9jYWxzLiRpbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgcmV0dXJuIHRyYWNrQnlFeHBHZXR0ZXIoJHNjb3BlLCBoYXNoRm5Mb2NhbHMpO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTdG9yZSBhIGxpc3Qgb2YgZWxlbWVudHMgZnJvbSBwcmV2aW91cyBydW4uIFRoaXMgaXMgYSBoYXNoIHdoZXJlIGtleSBpcyB0aGUgaXRlbSBmcm9tIHRoZVxuICAgICAgICAvLyBpdGVyYXRvciwgYW5kIHRoZSB2YWx1ZSBpcyBvYmplY3RzIHdpdGggZm9sbG93aW5nIHByb3BlcnRpZXMuXG4gICAgICAgIC8vICAgLSBzY29wZTogYm91bmQgc2NvcGVcbiAgICAgICAgLy8gICAtIGVsZW1lbnQ6IHByZXZpb3VzIGVsZW1lbnQuXG4gICAgICAgIC8vICAgLSBpbmRleDogcG9zaXRpb25cbiAgICAgICAgLy9cbiAgICAgICAgLy8gV2UgYXJlIHVzaW5nIG5vLXByb3RvIG9iamVjdCBzbyB0aGF0IHdlIGRvbid0IG5lZWQgdG8gZ3VhcmQgYWdhaW5zdCBpbmhlcml0ZWQgcHJvcHMgdmlhXG4gICAgICAgIC8vIGhhc093blByb3BlcnR5LlxuICAgICAgICB2YXIgbGFzdEJsb2NrTWFwID0gY3JlYXRlTWFwKCk7XG5cbiAgICAgICAgLy93YXRjaCBwcm9wc1xuICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihyaHMsIGZ1bmN0aW9uIG5nUmVwZWF0QWN0aW9uKGNvbGxlY3Rpb24pIHtcbiAgICAgICAgICB2YXIgaW5kZXgsIGxlbmd0aCxcbiAgICAgICAgICAgICAgcHJldmlvdXNOb2RlID0gJGVsZW1lbnRbMF0sICAgICAvLyBub2RlIHRoYXQgY2xvbmVkIG5vZGVzIHNob3VsZCBiZSBpbnNlcnRlZCBhZnRlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemVkIHRvIHRoZSBjb21tZW50IG5vZGUgYW5jaG9yXG4gICAgICAgICAgICAgIG5leHROb2RlLFxuICAgICAgICAgICAgICAvLyBTYW1lIGFzIGxhc3RCbG9ja01hcCBidXQgaXQgaGFzIHRoZSBjdXJyZW50IHN0YXRlLiBJdCB3aWxsIGJlY29tZSB0aGVcbiAgICAgICAgICAgICAgLy8gbGFzdEJsb2NrTWFwIG9uIHRoZSBuZXh0IGl0ZXJhdGlvbi5cbiAgICAgICAgICAgICAgbmV4dEJsb2NrTWFwID0gY3JlYXRlTWFwKCksXG4gICAgICAgICAgICAgIGNvbGxlY3Rpb25MZW5ndGgsXG4gICAgICAgICAgICAgIGtleSwgdmFsdWUsIC8vIGtleS92YWx1ZSBvZiBpdGVyYXRpb25cbiAgICAgICAgICAgICAgdHJhY2tCeUlkLFxuICAgICAgICAgICAgICB0cmFja0J5SWRGbixcbiAgICAgICAgICAgICAgY29sbGVjdGlvbktleXMsXG4gICAgICAgICAgICAgIGJsb2NrLCAgICAgICAvLyBsYXN0IG9iamVjdCBpbmZvcm1hdGlvbiB7c2NvcGUsIGVsZW1lbnQsIGlkfVxuICAgICAgICAgICAgICBuZXh0QmxvY2tPcmRlcixcbiAgICAgICAgICAgICAgZWxlbWVudHNUb1JlbW92ZTtcblxuICAgICAgICAgIGlmIChhbGlhc0FzKSB7XG4gICAgICAgICAgICAkc2NvcGVbYWxpYXNBc10gPSBjb2xsZWN0aW9uO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChpc0FycmF5TGlrZShjb2xsZWN0aW9uKSkge1xuICAgICAgICAgICAgY29sbGVjdGlvbktleXMgPSBjb2xsZWN0aW9uO1xuICAgICAgICAgICAgdHJhY2tCeUlkRm4gPSB0cmFja0J5SWRFeHBGbiB8fCB0cmFja0J5SWRBcnJheUZuO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0cmFja0J5SWRGbiA9IHRyYWNrQnlJZEV4cEZuIHx8IHRyYWNrQnlJZE9iakZuO1xuICAgICAgICAgICAgLy8gaWYgb2JqZWN0LCBleHRyYWN0IGtleXMsIGluIGVudW1lcmF0aW9uIG9yZGVyLCB1bnNvcnRlZFxuICAgICAgICAgICAgY29sbGVjdGlvbktleXMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGl0ZW1LZXkgaW4gY29sbGVjdGlvbikge1xuICAgICAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChjb2xsZWN0aW9uLCBpdGVtS2V5KSAmJiBpdGVtS2V5LmNoYXJBdCgwKSAhPT0gJyQnKSB7XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbktleXMucHVzaChpdGVtS2V5KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbGxlY3Rpb25MZW5ndGggPSBjb2xsZWN0aW9uS2V5cy5sZW5ndGg7XG4gICAgICAgICAgbmV4dEJsb2NrT3JkZXIgPSBuZXcgQXJyYXkoY29sbGVjdGlvbkxlbmd0aCk7XG5cbiAgICAgICAgICAvLyBsb2NhdGUgZXhpc3RpbmcgaXRlbXNcbiAgICAgICAgICBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBjb2xsZWN0aW9uTGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICBrZXkgPSAoY29sbGVjdGlvbiA9PT0gY29sbGVjdGlvbktleXMpID8gaW5kZXggOiBjb2xsZWN0aW9uS2V5c1tpbmRleF07XG4gICAgICAgICAgICB2YWx1ZSA9IGNvbGxlY3Rpb25ba2V5XTtcbiAgICAgICAgICAgIHRyYWNrQnlJZCA9IHRyYWNrQnlJZEZuKGtleSwgdmFsdWUsIGluZGV4KTtcbiAgICAgICAgICAgIGlmIChsYXN0QmxvY2tNYXBbdHJhY2tCeUlkXSkge1xuICAgICAgICAgICAgICAvLyBmb3VuZCBwcmV2aW91c2x5IHNlZW4gYmxvY2tcbiAgICAgICAgICAgICAgYmxvY2sgPSBsYXN0QmxvY2tNYXBbdHJhY2tCeUlkXTtcbiAgICAgICAgICAgICAgZGVsZXRlIGxhc3RCbG9ja01hcFt0cmFja0J5SWRdO1xuICAgICAgICAgICAgICBuZXh0QmxvY2tNYXBbdHJhY2tCeUlkXSA9IGJsb2NrO1xuICAgICAgICAgICAgICBuZXh0QmxvY2tPcmRlcltpbmRleF0gPSBibG9jaztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmV4dEJsb2NrTWFwW3RyYWNrQnlJZF0pIHtcbiAgICAgICAgICAgICAgLy8gaWYgY29sbGlzaW9uIGRldGVjdGVkLiByZXN0b3JlIGxhc3RCbG9ja01hcCBhbmQgdGhyb3cgYW4gZXJyb3JcbiAgICAgICAgICAgICAgZm9yRWFjaChuZXh0QmxvY2tPcmRlciwgZnVuY3Rpb24oYmxvY2spIHtcbiAgICAgICAgICAgICAgICBpZiAoYmxvY2sgJiYgYmxvY2suc2NvcGUpIGxhc3RCbG9ja01hcFtibG9jay5pZF0gPSBibG9jaztcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHRocm93IG5nUmVwZWF0TWluRXJyKCdkdXBlcycsXG4gICAgICAgICAgICAgICAgICBcIkR1cGxpY2F0ZXMgaW4gYSByZXBlYXRlciBhcmUgbm90IGFsbG93ZWQuIFVzZSAndHJhY2sgYnknIGV4cHJlc3Npb24gdG8gc3BlY2lmeSB1bmlxdWUga2V5cy4gUmVwZWF0ZXI6IHswfSwgRHVwbGljYXRlIGtleTogezF9LCBEdXBsaWNhdGUgdmFsdWU6IHsyfVwiLFxuICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbiwgdHJhY2tCeUlkLCB2YWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBuZXcgbmV2ZXIgYmVmb3JlIHNlZW4gYmxvY2tcbiAgICAgICAgICAgICAgbmV4dEJsb2NrT3JkZXJbaW5kZXhdID0ge2lkOiB0cmFja0J5SWQsIHNjb3BlOiB1bmRlZmluZWQsIGNsb25lOiB1bmRlZmluZWR9O1xuICAgICAgICAgICAgICBuZXh0QmxvY2tNYXBbdHJhY2tCeUlkXSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gcmVtb3ZlIGxlZnRvdmVyIGl0ZW1zXG4gICAgICAgICAgZm9yICh2YXIgYmxvY2tLZXkgaW4gbGFzdEJsb2NrTWFwKSB7XG4gICAgICAgICAgICBibG9jayA9IGxhc3RCbG9ja01hcFtibG9ja0tleV07XG4gICAgICAgICAgICBlbGVtZW50c1RvUmVtb3ZlID0gZ2V0QmxvY2tOb2RlcyhibG9jay5jbG9uZSk7XG4gICAgICAgICAgICAkYW5pbWF0ZS5sZWF2ZShlbGVtZW50c1RvUmVtb3ZlKTtcbiAgICAgICAgICAgIGlmIChlbGVtZW50c1RvUmVtb3ZlWzBdLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgLy8gaWYgdGhlIGVsZW1lbnQgd2FzIG5vdCByZW1vdmVkIHlldCBiZWNhdXNlIG9mIHBlbmRpbmcgYW5pbWF0aW9uLCBtYXJrIGl0IGFzIGRlbGV0ZWRcbiAgICAgICAgICAgICAgLy8gc28gdGhhdCB3ZSBjYW4gaWdub3JlIGl0IGxhdGVyXG4gICAgICAgICAgICAgIGZvciAoaW5kZXggPSAwLCBsZW5ndGggPSBlbGVtZW50c1RvUmVtb3ZlLmxlbmd0aDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50c1RvUmVtb3ZlW2luZGV4XVtOR19SRU1PVkVEXSA9IHRydWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJsb2NrLnNjb3BlLiRkZXN0cm95KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gd2UgYXJlIG5vdCB1c2luZyBmb3JFYWNoIGZvciBwZXJmIHJlYXNvbnMgKHRyeWluZyB0byBhdm9pZCAjY2FsbClcbiAgICAgICAgICBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBjb2xsZWN0aW9uTGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICBrZXkgPSAoY29sbGVjdGlvbiA9PT0gY29sbGVjdGlvbktleXMpID8gaW5kZXggOiBjb2xsZWN0aW9uS2V5c1tpbmRleF07XG4gICAgICAgICAgICB2YWx1ZSA9IGNvbGxlY3Rpb25ba2V5XTtcbiAgICAgICAgICAgIGJsb2NrID0gbmV4dEJsb2NrT3JkZXJbaW5kZXhdO1xuXG4gICAgICAgICAgICBpZiAoYmxvY2suc2NvcGUpIHtcbiAgICAgICAgICAgICAgLy8gaWYgd2UgaGF2ZSBhbHJlYWR5IHNlZW4gdGhpcyBvYmplY3QsIHRoZW4gd2UgbmVlZCB0byByZXVzZSB0aGVcbiAgICAgICAgICAgICAgLy8gYXNzb2NpYXRlZCBzY29wZS9lbGVtZW50XG5cbiAgICAgICAgICAgICAgbmV4dE5vZGUgPSBwcmV2aW91c05vZGU7XG5cbiAgICAgICAgICAgICAgLy8gc2tpcCBub2RlcyB0aGF0IGFyZSBhbHJlYWR5IHBlbmRpbmcgcmVtb3ZhbCB2aWEgbGVhdmUgYW5pbWF0aW9uXG4gICAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IG5leHROb2RlLm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgICB9IHdoaWxlIChuZXh0Tm9kZSAmJiBuZXh0Tm9kZVtOR19SRU1PVkVEXSk7XG5cbiAgICAgICAgICAgICAgaWYgKGdldEJsb2NrU3RhcnQoYmxvY2spICE9IG5leHROb2RlKSB7XG4gICAgICAgICAgICAgICAgLy8gZXhpc3RpbmcgaXRlbSB3aGljaCBnb3QgbW92ZWRcbiAgICAgICAgICAgICAgICAkYW5pbWF0ZS5tb3ZlKGdldEJsb2NrTm9kZXMoYmxvY2suY2xvbmUpLCBudWxsLCBqcUxpdGUocHJldmlvdXNOb2RlKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcHJldmlvdXNOb2RlID0gZ2V0QmxvY2tFbmQoYmxvY2spO1xuICAgICAgICAgICAgICB1cGRhdGVTY29wZShibG9jay5zY29wZSwgaW5kZXgsIHZhbHVlSWRlbnRpZmllciwgdmFsdWUsIGtleUlkZW50aWZpZXIsIGtleSwgY29sbGVjdGlvbkxlbmd0aCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBuZXcgaXRlbSB3aGljaCB3ZSBkb24ndCBrbm93IGFib3V0XG4gICAgICAgICAgICAgICR0cmFuc2NsdWRlKGZ1bmN0aW9uIG5nUmVwZWF0VHJhbnNjbHVkZShjbG9uZSwgc2NvcGUpIHtcbiAgICAgICAgICAgICAgICBibG9jay5zY29wZSA9IHNjb3BlO1xuICAgICAgICAgICAgICAgIC8vIGh0dHA6Ly9qc3BlcmYuY29tL2Nsb25lLXZzLWNyZWF0ZWNvbW1lbnRcbiAgICAgICAgICAgICAgICB2YXIgZW5kTm9kZSA9IG5nUmVwZWF0RW5kQ29tbWVudC5jbG9uZU5vZGUoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGNsb25lW2Nsb25lLmxlbmd0aCsrXSA9IGVuZE5vZGU7XG5cbiAgICAgICAgICAgICAgICAvLyBUT0RPKHBlcmYpOiBzdXBwb3J0IG5ha2VkIHByZXZpb3VzTm9kZSBpbiBgZW50ZXJgIHRvIGF2b2lkIGNyZWF0aW9uIG9mIGpxTGl0ZSB3cmFwcGVyP1xuICAgICAgICAgICAgICAgICRhbmltYXRlLmVudGVyKGNsb25lLCBudWxsLCBqcUxpdGUocHJldmlvdXNOb2RlKSk7XG4gICAgICAgICAgICAgICAgcHJldmlvdXNOb2RlID0gZW5kTm9kZTtcbiAgICAgICAgICAgICAgICAvLyBOb3RlOiBXZSBvbmx5IG5lZWQgdGhlIGZpcnN0L2xhc3Qgbm9kZSBvZiB0aGUgY2xvbmVkIG5vZGVzLlxuICAgICAgICAgICAgICAgIC8vIEhvd2V2ZXIsIHdlIG5lZWQgdG8ga2VlcCB0aGUgcmVmZXJlbmNlIHRvIHRoZSBqcWxpdGUgd3JhcHBlciBhcyBpdCBtaWdodCBiZSBjaGFuZ2VkIGxhdGVyXG4gICAgICAgICAgICAgICAgLy8gYnkgYSBkaXJlY3RpdmUgd2l0aCB0ZW1wbGF0ZVVybCB3aGVuIGl0cyB0ZW1wbGF0ZSBhcnJpdmVzLlxuICAgICAgICAgICAgICAgIGJsb2NrLmNsb25lID0gY2xvbmU7XG4gICAgICAgICAgICAgICAgbmV4dEJsb2NrTWFwW2Jsb2NrLmlkXSA9IGJsb2NrO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVNjb3BlKGJsb2NrLnNjb3BlLCBpbmRleCwgdmFsdWVJZGVudGlmaWVyLCB2YWx1ZSwga2V5SWRlbnRpZmllciwga2V5LCBjb2xsZWN0aW9uTGVuZ3RoKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGxhc3RCbG9ja01hcCA9IG5leHRCbG9ja01hcDtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn1dO1xuXG52YXIgTkdfSElERV9DTEFTUyA9ICduZy1oaWRlJztcbnZhciBOR19ISURFX0lOX1BST0dSRVNTX0NMQVNTID0gJ25nLWhpZGUtYW5pbWF0ZSc7XG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nU2hvd1xuICogQG11bHRpRWxlbWVudFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIGBuZ1Nob3dgIGRpcmVjdGl2ZSBzaG93cyBvciBoaWRlcyB0aGUgZ2l2ZW4gSFRNTCBlbGVtZW50IGJhc2VkIG9uIHRoZSBleHByZXNzaW9uXG4gKiBwcm92aWRlZCB0byB0aGUgYG5nU2hvd2AgYXR0cmlidXRlLiBUaGUgZWxlbWVudCBpcyBzaG93biBvciBoaWRkZW4gYnkgcmVtb3Zpbmcgb3IgYWRkaW5nXG4gKiB0aGUgYC5uZy1oaWRlYCBDU1MgY2xhc3Mgb250byB0aGUgZWxlbWVudC4gVGhlIGAubmctaGlkZWAgQ1NTIGNsYXNzIGlzIHByZWRlZmluZWRcbiAqIGluIEFuZ3VsYXJKUyBhbmQgc2V0cyB0aGUgZGlzcGxheSBzdHlsZSB0byBub25lICh1c2luZyBhbiAhaW1wb3J0YW50IGZsYWcpLlxuICogRm9yIENTUCBtb2RlIHBsZWFzZSBhZGQgYGFuZ3VsYXItY3NwLmNzc2AgdG8geW91ciBodG1sIGZpbGUgKHNlZSB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nQ3NwIG5nQ3NwfSkuXG4gKlxuICogYGBgaHRtbFxuICogPCEtLSB3aGVuICRzY29wZS5teVZhbHVlIGlzIHRydXRoeSAoZWxlbWVudCBpcyB2aXNpYmxlKSAtLT5cbiAqIDxkaXYgbmctc2hvdz1cIm15VmFsdWVcIj48L2Rpdj5cbiAqXG4gKiA8IS0tIHdoZW4gJHNjb3BlLm15VmFsdWUgaXMgZmFsc3kgKGVsZW1lbnQgaXMgaGlkZGVuKSAtLT5cbiAqIDxkaXYgbmctc2hvdz1cIm15VmFsdWVcIiBjbGFzcz1cIm5nLWhpZGVcIj48L2Rpdj5cbiAqIGBgYFxuICpcbiAqIFdoZW4gdGhlIGBuZ1Nob3dgIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgZmFsc3kgdmFsdWUgdGhlbiB0aGUgYC5uZy1oaWRlYCBDU1MgY2xhc3MgaXMgYWRkZWQgdG8gdGhlIGNsYXNzXG4gKiBhdHRyaWJ1dGUgb24gdGhlIGVsZW1lbnQgY2F1c2luZyBpdCB0byBiZWNvbWUgaGlkZGVuLiBXaGVuIHRydXRoeSwgdGhlIGAubmctaGlkZWAgQ1NTIGNsYXNzIGlzIHJlbW92ZWRcbiAqIGZyb20gdGhlIGVsZW1lbnQgY2F1c2luZyB0aGUgZWxlbWVudCBub3QgdG8gYXBwZWFyIGhpZGRlbi5cbiAqXG4gKiAjIyBXaHkgaXMgIWltcG9ydGFudCB1c2VkP1xuICpcbiAqIFlvdSBtYXkgYmUgd29uZGVyaW5nIHdoeSAhaW1wb3J0YW50IGlzIHVzZWQgZm9yIHRoZSBgLm5nLWhpZGVgIENTUyBjbGFzcy4gVGhpcyBpcyBiZWNhdXNlIHRoZSBgLm5nLWhpZGVgIHNlbGVjdG9yXG4gKiBjYW4gYmUgZWFzaWx5IG92ZXJyaWRkZW4gYnkgaGVhdmllciBzZWxlY3RvcnMuIEZvciBleGFtcGxlLCBzb21ldGhpbmcgYXMgc2ltcGxlXG4gKiBhcyBjaGFuZ2luZyB0aGUgZGlzcGxheSBzdHlsZSBvbiBhIEhUTUwgbGlzdCBpdGVtIHdvdWxkIG1ha2UgaGlkZGVuIGVsZW1lbnRzIGFwcGVhciB2aXNpYmxlLlxuICogVGhpcyBhbHNvIGJlY29tZXMgYSBiaWdnZXIgaXNzdWUgd2hlbiBkZWFsaW5nIHdpdGggQ1NTIGZyYW1ld29ya3MuXG4gKlxuICogQnkgdXNpbmcgIWltcG9ydGFudCwgdGhlIHNob3cgYW5kIGhpZGUgYmVoYXZpb3Igd2lsbCB3b3JrIGFzIGV4cGVjdGVkIGRlc3BpdGUgYW55IGNsYXNoIGJldHdlZW4gQ1NTIHNlbGVjdG9yXG4gKiBzcGVjaWZpY2l0eSAod2hlbiAhaW1wb3J0YW50IGlzbid0IHVzZWQgd2l0aCBhbnkgY29uZmxpY3Rpbmcgc3R5bGVzKS4gSWYgYSBkZXZlbG9wZXIgY2hvb3NlcyB0byBvdmVycmlkZSB0aGVcbiAqIHN0eWxpbmcgdG8gY2hhbmdlIGhvdyB0byBoaWRlIGFuIGVsZW1lbnQgdGhlbiBpdCBpcyBqdXN0IGEgbWF0dGVyIG9mIHVzaW5nICFpbXBvcnRhbnQgaW4gdGhlaXIgb3duIENTUyBjb2RlLlxuICpcbiAqICMjIyBPdmVycmlkaW5nIGAubmctaGlkZWBcbiAqXG4gKiBCeSBkZWZhdWx0LCB0aGUgYC5uZy1oaWRlYCBjbGFzcyB3aWxsIHN0eWxlIHRoZSBlbGVtZW50IHdpdGggYGRpc3BsYXk6IG5vbmUhaW1wb3J0YW50YC4gSWYgeW91IHdpc2ggdG8gY2hhbmdlXG4gKiB0aGUgaGlkZSBiZWhhdmlvciB3aXRoIG5nU2hvdy9uZ0hpZGUgdGhlbiB0aGlzIGNhbiBiZSBhY2hpZXZlZCBieSByZXN0YXRpbmcgdGhlIHN0eWxlcyBmb3IgdGhlIGAubmctaGlkZWBcbiAqIGNsYXNzIENTUy4gTm90ZSB0aGF0IHRoZSBzZWxlY3RvciB0aGF0IG5lZWRzIHRvIGJlIHVzZWQgaXMgYWN0dWFsbHkgYC5uZy1oaWRlOm5vdCgubmctaGlkZS1hbmltYXRlKWAgdG8gY29wZVxuICogd2l0aCBleHRyYSBhbmltYXRpb24gY2xhc3NlcyB0aGF0IGNhbiBiZSBhZGRlZC5cbiAqXG4gKiBgYGBjc3NcbiAqIC5uZy1oaWRlOm5vdCgubmctaGlkZS1hbmltYXRlKSB7XG4gKiAgIC8mIzQyOyB0aGlzIGlzIGp1c3QgYW5vdGhlciBmb3JtIG9mIGhpZGluZyBhbiBlbGVtZW50ICYjNDI7L1xuICogICBkaXNwbGF5OiBibG9jayFpbXBvcnRhbnQ7XG4gKiAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAqICAgdG9wOiAtOTk5OXB4O1xuICogICBsZWZ0OiAtOTk5OXB4O1xuICogfVxuICogYGBgXG4gKlxuICogQnkgZGVmYXVsdCB5b3UgZG9uJ3QgbmVlZCB0byBvdmVycmlkZSBpbiBDU1MgYW55dGhpbmcgYW5kIHRoZSBhbmltYXRpb25zIHdpbGwgd29yayBhcm91bmQgdGhlIGRpc3BsYXkgc3R5bGUuXG4gKlxuICogIyMgQSBub3RlIGFib3V0IGFuaW1hdGlvbnMgd2l0aCBgbmdTaG93YFxuICpcbiAqIEFuaW1hdGlvbnMgaW4gbmdTaG93L25nSGlkZSB3b3JrIHdpdGggdGhlIHNob3cgYW5kIGhpZGUgZXZlbnRzIHRoYXQgYXJlIHRyaWdnZXJlZCB3aGVuIHRoZSBkaXJlY3RpdmUgZXhwcmVzc2lvblxuICogaXMgdHJ1ZSBhbmQgZmFsc2UuIFRoaXMgc3lzdGVtIHdvcmtzIGxpa2UgdGhlIGFuaW1hdGlvbiBzeXN0ZW0gcHJlc2VudCB3aXRoIG5nQ2xhc3MgZXhjZXB0IHRoYXRcbiAqIHlvdSBtdXN0IGFsc28gaW5jbHVkZSB0aGUgIWltcG9ydGFudCBmbGFnIHRvIG92ZXJyaWRlIHRoZSBkaXNwbGF5IHByb3BlcnR5XG4gKiBzbyB0aGF0IHlvdSBjYW4gcGVyZm9ybSBhbiBhbmltYXRpb24gd2hlbiB0aGUgZWxlbWVudCBpcyBoaWRkZW4gZHVyaW5nIHRoZSB0aW1lIG9mIHRoZSBhbmltYXRpb24uXG4gKlxuICogYGBgY3NzXG4gKiAvL1xuICogLy9hIHdvcmtpbmcgZXhhbXBsZSBjYW4gYmUgZm91bmQgYXQgdGhlIGJvdHRvbSBvZiB0aGlzIHBhZ2VcbiAqIC8vXG4gKiAubXktZWxlbWVudC5uZy1oaWRlLWFkZCwgLm15LWVsZW1lbnQubmctaGlkZS1yZW1vdmUge1xuICogICAvJiM0MjsgdGhpcyBpcyByZXF1aXJlZCBhcyBvZiAxLjN4IHRvIHByb3Blcmx5XG4gKiAgICAgIGFwcGx5IGFsbCBzdHlsaW5nIGluIGEgc2hvdy9oaWRlIGFuaW1hdGlvbiAmIzQyOy9cbiAqICAgdHJhbnNpdGlvbjogMHMgbGluZWFyIGFsbDtcbiAqIH1cbiAqXG4gKiAubXktZWxlbWVudC5uZy1oaWRlLWFkZC1hY3RpdmUsXG4gKiAubXktZWxlbWVudC5uZy1oaWRlLXJlbW92ZS1hY3RpdmUge1xuICogICAvJiM0MjsgdGhlIHRyYW5zaXRpb24gaXMgZGVmaW5lZCBpbiB0aGUgYWN0aXZlIGNsYXNzICYjNDI7L1xuICogICB0cmFuc2l0aW9uOiAxcyBsaW5lYXIgYWxsO1xuICogfVxuICpcbiAqIC5teS1lbGVtZW50Lm5nLWhpZGUtYWRkIHsgLi4uIH1cbiAqIC5teS1lbGVtZW50Lm5nLWhpZGUtYWRkLm5nLWhpZGUtYWRkLWFjdGl2ZSB7IC4uLiB9XG4gKiAubXktZWxlbWVudC5uZy1oaWRlLXJlbW92ZSB7IC4uLiB9XG4gKiAubXktZWxlbWVudC5uZy1oaWRlLXJlbW92ZS5uZy1oaWRlLXJlbW92ZS1hY3RpdmUgeyAuLi4gfVxuICogYGBgXG4gKlxuICogS2VlcCBpbiBtaW5kIHRoYXQsIGFzIG9mIEFuZ3VsYXJKUyB2ZXJzaW9uIDEuMy4wLWJldGEuMTEsIHRoZXJlIGlzIG5vIG5lZWQgdG8gY2hhbmdlIHRoZSBkaXNwbGF5XG4gKiBwcm9wZXJ0eSB0byBibG9jayBkdXJpbmcgYW5pbWF0aW9uIHN0YXRlcy0tbmdBbmltYXRlIHdpbGwgaGFuZGxlIHRoZSBzdHlsZSB0b2dnbGluZyBhdXRvbWF0aWNhbGx5IGZvciB5b3UuXG4gKlxuICogQGFuaW1hdGlvbnNcbiAqIGFkZENsYXNzOiBgLm5nLWhpZGVgIC0gaGFwcGVucyBhZnRlciB0aGUgYG5nU2hvd2AgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSB0cnV0aHkgdmFsdWUgYW5kIHRoZSBqdXN0IGJlZm9yZSBjb250ZW50cyBhcmUgc2V0IHRvIHZpc2libGVcbiAqIHJlbW92ZUNsYXNzOiBgLm5nLWhpZGVgIC0gaGFwcGVucyBhZnRlciB0aGUgYG5nU2hvd2AgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBub24gdHJ1dGh5IHZhbHVlIGFuZCBqdXN0IGJlZm9yZSB0aGUgY29udGVudHMgYXJlIHNldCB0byBoaWRkZW5cbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdTaG93IElmIHRoZSB7QGxpbmsgZ3VpZGUvZXhwcmVzc2lvbiBleHByZXNzaW9ufSBpcyB0cnV0aHlcbiAqICAgICB0aGVuIHRoZSBlbGVtZW50IGlzIHNob3duIG9yIGhpZGRlbiByZXNwZWN0aXZlbHkuXG4gKlxuICogQGV4YW1wbGVcbiAgPGV4YW1wbGUgbW9kdWxlPVwibmdBbmltYXRlXCIgZGVwcz1cImFuZ3VsYXItYW5pbWF0ZS5qc1wiIGFuaW1hdGlvbnM9XCJ0cnVlXCI+XG4gICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAgICAgIENsaWNrIG1lOiA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmctbW9kZWw9XCJjaGVja2VkXCIgYXJpYS1sYWJlbD1cIlRvZ2dsZSBuZ0hpZGVcIj48YnIvPlxuICAgICAgPGRpdj5cbiAgICAgICAgU2hvdzpcbiAgICAgICAgPGRpdiBjbGFzcz1cImNoZWNrLWVsZW1lbnQgYW5pbWF0ZS1zaG93XCIgbmctc2hvdz1cImNoZWNrZWRcIj5cbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tdGh1bWJzLXVwXCI+PC9zcGFuPiBJIHNob3cgdXAgd2hlbiB5b3VyIGNoZWNrYm94IGlzIGNoZWNrZWQuXG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2PlxuICAgICAgICBIaWRlOlxuICAgICAgICA8ZGl2IGNsYXNzPVwiY2hlY2stZWxlbWVudCBhbmltYXRlLXNob3dcIiBuZy1oaWRlPVwiY2hlY2tlZFwiPlxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi10aHVtYnMtZG93blwiPjwvc3Bhbj4gSSBoaWRlIHdoZW4geW91ciBjaGVja2JveCBpcyBjaGVja2VkLlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZmlsZT5cbiAgICA8ZmlsZSBuYW1lPVwiZ2x5cGhpY29ucy5jc3NcIj5cbiAgICAgIEBpbXBvcnQgdXJsKC4uLy4uL2NvbXBvbmVudHMvYm9vdHN0cmFwLTMuMS4xL2Nzcy9ib290c3RyYXAuY3NzKTtcbiAgICA8L2ZpbGU+XG4gICAgPGZpbGUgbmFtZT1cImFuaW1hdGlvbnMuY3NzXCI+XG4gICAgICAuYW5pbWF0ZS1zaG93IHtcbiAgICAgICAgbGluZS1oZWlnaHQ6IDIwcHg7XG4gICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgIHBhZGRpbmc6IDEwcHg7XG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xuICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTtcbiAgICAgIH1cblxuICAgICAgLmFuaW1hdGUtc2hvdy5uZy1oaWRlLWFkZCwgLmFuaW1hdGUtc2hvdy5uZy1oaWRlLXJlbW92ZSB7XG4gICAgICAgIHRyYW5zaXRpb246IGFsbCBsaW5lYXIgMC41cztcbiAgICAgIH1cblxuICAgICAgLmFuaW1hdGUtc2hvdy5uZy1oaWRlIHtcbiAgICAgICAgbGluZS1oZWlnaHQ6IDA7XG4gICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgIHBhZGRpbmc6IDAgMTBweDtcbiAgICAgIH1cblxuICAgICAgLmNoZWNrLWVsZW1lbnQge1xuICAgICAgICBwYWRkaW5nOiAxMHB4O1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCBibGFjaztcbiAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7XG4gICAgICB9XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgIHZhciB0aHVtYnNVcCA9IGVsZW1lbnQoYnkuY3NzKCdzcGFuLmdseXBoaWNvbi10aHVtYnMtdXAnKSk7XG4gICAgICB2YXIgdGh1bWJzRG93biA9IGVsZW1lbnQoYnkuY3NzKCdzcGFuLmdseXBoaWNvbi10aHVtYnMtZG93bicpKTtcblxuICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1zaG93IC8gbmctaGlkZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICBleHBlY3QodGh1bWJzVXAuaXNEaXNwbGF5ZWQoKSkudG9CZUZhbHN5KCk7XG4gICAgICAgIGV4cGVjdCh0aHVtYnNEb3duLmlzRGlzcGxheWVkKCkpLnRvQmVUcnV0aHkoKTtcblxuICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCdjaGVja2VkJykpLmNsaWNrKCk7XG5cbiAgICAgICAgZXhwZWN0KHRodW1ic1VwLmlzRGlzcGxheWVkKCkpLnRvQmVUcnV0aHkoKTtcbiAgICAgICAgZXhwZWN0KHRodW1ic0Rvd24uaXNEaXNwbGF5ZWQoKSkudG9CZUZhbHN5KCk7XG4gICAgICB9KTtcbiAgICA8L2ZpbGU+XG4gIDwvZXhhbXBsZT5cbiAqL1xudmFyIG5nU2hvd0RpcmVjdGl2ZSA9IFsnJGFuaW1hdGUnLCBmdW5jdGlvbigkYW5pbWF0ZSkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgbXVsdGlFbGVtZW50OiB0cnVlLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG4gICAgICBzY29wZS4kd2F0Y2goYXR0ci5uZ1Nob3csIGZ1bmN0aW9uIG5nU2hvd1dhdGNoQWN0aW9uKHZhbHVlKSB7XG4gICAgICAgIC8vIHdlJ3JlIGFkZGluZyBhIHRlbXBvcmFyeSwgYW5pbWF0aW9uLXNwZWNpZmljIGNsYXNzIGZvciBuZy1oaWRlIHNpbmNlIHRoaXMgd2F5XG4gICAgICAgIC8vIHdlIGNhbiBjb250cm9sIHdoZW4gdGhlIGVsZW1lbnQgaXMgYWN0dWFsbHkgZGlzcGxheWVkIG9uIHNjcmVlbiB3aXRob3V0IGhhdmluZ1xuICAgICAgICAvLyB0byBoYXZlIGEgZ2xvYmFsL2dyZWVkeSBDU1Mgc2VsZWN0b3IgdGhhdCBicmVha3Mgd2hlbiBvdGhlciBhbmltYXRpb25zIGFyZSBydW4uXG4gICAgICAgIC8vIFJlYWQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL2FuZ3VsYXIuanMvaXNzdWVzLzkxMDMjaXNzdWVjb21tZW50LTU4MzM1ODQ1XG4gICAgICAgICRhbmltYXRlW3ZhbHVlID8gJ3JlbW92ZUNsYXNzJyA6ICdhZGRDbGFzcyddKGVsZW1lbnQsIE5HX0hJREVfQ0xBU1MsIHtcbiAgICAgICAgICB0ZW1wQ2xhc3NlczogTkdfSElERV9JTl9QUk9HUkVTU19DTEFTU1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1dO1xuXG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdIaWRlXG4gKiBAbXVsdGlFbGVtZW50XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGUgYG5nSGlkZWAgZGlyZWN0aXZlIHNob3dzIG9yIGhpZGVzIHRoZSBnaXZlbiBIVE1MIGVsZW1lbnQgYmFzZWQgb24gdGhlIGV4cHJlc3Npb25cbiAqIHByb3ZpZGVkIHRvIHRoZSBgbmdIaWRlYCBhdHRyaWJ1dGUuIFRoZSBlbGVtZW50IGlzIHNob3duIG9yIGhpZGRlbiBieSByZW1vdmluZyBvciBhZGRpbmdcbiAqIHRoZSBgbmctaGlkZWAgQ1NTIGNsYXNzIG9udG8gdGhlIGVsZW1lbnQuIFRoZSBgLm5nLWhpZGVgIENTUyBjbGFzcyBpcyBwcmVkZWZpbmVkXG4gKiBpbiBBbmd1bGFySlMgYW5kIHNldHMgdGhlIGRpc3BsYXkgc3R5bGUgdG8gbm9uZSAodXNpbmcgYW4gIWltcG9ydGFudCBmbGFnKS5cbiAqIEZvciBDU1AgbW9kZSBwbGVhc2UgYWRkIGBhbmd1bGFyLWNzcC5jc3NgIHRvIHlvdXIgaHRtbCBmaWxlIChzZWUge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0NzcCBuZ0NzcH0pLlxuICpcbiAqIGBgYGh0bWxcbiAqIDwhLS0gd2hlbiAkc2NvcGUubXlWYWx1ZSBpcyB0cnV0aHkgKGVsZW1lbnQgaXMgaGlkZGVuKSAtLT5cbiAqIDxkaXYgbmctaGlkZT1cIm15VmFsdWVcIiBjbGFzcz1cIm5nLWhpZGVcIj48L2Rpdj5cbiAqXG4gKiA8IS0tIHdoZW4gJHNjb3BlLm15VmFsdWUgaXMgZmFsc3kgKGVsZW1lbnQgaXMgdmlzaWJsZSkgLS0+XG4gKiA8ZGl2IG5nLWhpZGU9XCJteVZhbHVlXCI+PC9kaXY+XG4gKiBgYGBcbiAqXG4gKiBXaGVuIHRoZSBgbmdIaWRlYCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byBhIHRydXRoeSB2YWx1ZSB0aGVuIHRoZSBgLm5nLWhpZGVgIENTUyBjbGFzcyBpcyBhZGRlZCB0byB0aGUgY2xhc3NcbiAqIGF0dHJpYnV0ZSBvbiB0aGUgZWxlbWVudCBjYXVzaW5nIGl0IHRvIGJlY29tZSBoaWRkZW4uIFdoZW4gZmFsc3ksIHRoZSBgLm5nLWhpZGVgIENTUyBjbGFzcyBpcyByZW1vdmVkXG4gKiBmcm9tIHRoZSBlbGVtZW50IGNhdXNpbmcgdGhlIGVsZW1lbnQgbm90IHRvIGFwcGVhciBoaWRkZW4uXG4gKlxuICogIyMgV2h5IGlzICFpbXBvcnRhbnQgdXNlZD9cbiAqXG4gKiBZb3UgbWF5IGJlIHdvbmRlcmluZyB3aHkgIWltcG9ydGFudCBpcyB1c2VkIGZvciB0aGUgYC5uZy1oaWRlYCBDU1MgY2xhc3MuIFRoaXMgaXMgYmVjYXVzZSB0aGUgYC5uZy1oaWRlYCBzZWxlY3RvclxuICogY2FuIGJlIGVhc2lseSBvdmVycmlkZGVuIGJ5IGhlYXZpZXIgc2VsZWN0b3JzLiBGb3IgZXhhbXBsZSwgc29tZXRoaW5nIGFzIHNpbXBsZVxuICogYXMgY2hhbmdpbmcgdGhlIGRpc3BsYXkgc3R5bGUgb24gYSBIVE1MIGxpc3QgaXRlbSB3b3VsZCBtYWtlIGhpZGRlbiBlbGVtZW50cyBhcHBlYXIgdmlzaWJsZS5cbiAqIFRoaXMgYWxzbyBiZWNvbWVzIGEgYmlnZ2VyIGlzc3VlIHdoZW4gZGVhbGluZyB3aXRoIENTUyBmcmFtZXdvcmtzLlxuICpcbiAqIEJ5IHVzaW5nICFpbXBvcnRhbnQsIHRoZSBzaG93IGFuZCBoaWRlIGJlaGF2aW9yIHdpbGwgd29yayBhcyBleHBlY3RlZCBkZXNwaXRlIGFueSBjbGFzaCBiZXR3ZWVuIENTUyBzZWxlY3RvclxuICogc3BlY2lmaWNpdHkgKHdoZW4gIWltcG9ydGFudCBpc24ndCB1c2VkIHdpdGggYW55IGNvbmZsaWN0aW5nIHN0eWxlcykuIElmIGEgZGV2ZWxvcGVyIGNob29zZXMgdG8gb3ZlcnJpZGUgdGhlXG4gKiBzdHlsaW5nIHRvIGNoYW5nZSBob3cgdG8gaGlkZSBhbiBlbGVtZW50IHRoZW4gaXQgaXMganVzdCBhIG1hdHRlciBvZiB1c2luZyAhaW1wb3J0YW50IGluIHRoZWlyIG93biBDU1MgY29kZS5cbiAqXG4gKiAjIyMgT3ZlcnJpZGluZyBgLm5nLWhpZGVgXG4gKlxuICogQnkgZGVmYXVsdCwgdGhlIGAubmctaGlkZWAgY2xhc3Mgd2lsbCBzdHlsZSB0aGUgZWxlbWVudCB3aXRoIGBkaXNwbGF5OiBub25lIWltcG9ydGFudGAuIElmIHlvdSB3aXNoIHRvIGNoYW5nZVxuICogdGhlIGhpZGUgYmVoYXZpb3Igd2l0aCBuZ1Nob3cvbmdIaWRlIHRoZW4gdGhpcyBjYW4gYmUgYWNoaWV2ZWQgYnkgcmVzdGF0aW5nIHRoZSBzdHlsZXMgZm9yIHRoZSBgLm5nLWhpZGVgXG4gKiBjbGFzcyBpbiBDU1M6XG4gKlxuICogYGBgY3NzXG4gKiAubmctaGlkZSB7XG4gKiAgIC8mIzQyOyB0aGlzIGlzIGp1c3QgYW5vdGhlciBmb3JtIG9mIGhpZGluZyBhbiBlbGVtZW50ICYjNDI7L1xuICogICBkaXNwbGF5OiBibG9jayFpbXBvcnRhbnQ7XG4gKiAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAqICAgdG9wOiAtOTk5OXB4O1xuICogICBsZWZ0OiAtOTk5OXB4O1xuICogfVxuICogYGBgXG4gKlxuICogQnkgZGVmYXVsdCB5b3UgZG9uJ3QgbmVlZCB0byBvdmVycmlkZSBpbiBDU1MgYW55dGhpbmcgYW5kIHRoZSBhbmltYXRpb25zIHdpbGwgd29yayBhcm91bmQgdGhlIGRpc3BsYXkgc3R5bGUuXG4gKlxuICogIyMgQSBub3RlIGFib3V0IGFuaW1hdGlvbnMgd2l0aCBgbmdIaWRlYFxuICpcbiAqIEFuaW1hdGlvbnMgaW4gbmdTaG93L25nSGlkZSB3b3JrIHdpdGggdGhlIHNob3cgYW5kIGhpZGUgZXZlbnRzIHRoYXQgYXJlIHRyaWdnZXJlZCB3aGVuIHRoZSBkaXJlY3RpdmUgZXhwcmVzc2lvblxuICogaXMgdHJ1ZSBhbmQgZmFsc2UuIFRoaXMgc3lzdGVtIHdvcmtzIGxpa2UgdGhlIGFuaW1hdGlvbiBzeXN0ZW0gcHJlc2VudCB3aXRoIG5nQ2xhc3MsIGV4Y2VwdCB0aGF0IHRoZSBgLm5nLWhpZGVgXG4gKiBDU1MgY2xhc3MgaXMgYWRkZWQgYW5kIHJlbW92ZWQgZm9yIHlvdSBpbnN0ZWFkIG9mIHlvdXIgb3duIENTUyBjbGFzcy5cbiAqXG4gKiBgYGBjc3NcbiAqIC8vXG4gKiAvL2Egd29ya2luZyBleGFtcGxlIGNhbiBiZSBmb3VuZCBhdCB0aGUgYm90dG9tIG9mIHRoaXMgcGFnZVxuICogLy9cbiAqIC5teS1lbGVtZW50Lm5nLWhpZGUtYWRkLCAubXktZWxlbWVudC5uZy1oaWRlLXJlbW92ZSB7XG4gKiAgIHRyYW5zaXRpb246IDAuNXMgbGluZWFyIGFsbDtcbiAqIH1cbiAqXG4gKiAubXktZWxlbWVudC5uZy1oaWRlLWFkZCB7IC4uLiB9XG4gKiAubXktZWxlbWVudC5uZy1oaWRlLWFkZC5uZy1oaWRlLWFkZC1hY3RpdmUgeyAuLi4gfVxuICogLm15LWVsZW1lbnQubmctaGlkZS1yZW1vdmUgeyAuLi4gfVxuICogLm15LWVsZW1lbnQubmctaGlkZS1yZW1vdmUubmctaGlkZS1yZW1vdmUtYWN0aXZlIHsgLi4uIH1cbiAqIGBgYFxuICpcbiAqIEtlZXAgaW4gbWluZCB0aGF0LCBhcyBvZiBBbmd1bGFySlMgdmVyc2lvbiAxLjMuMC1iZXRhLjExLCB0aGVyZSBpcyBubyBuZWVkIHRvIGNoYW5nZSB0aGUgZGlzcGxheVxuICogcHJvcGVydHkgdG8gYmxvY2sgZHVyaW5nIGFuaW1hdGlvbiBzdGF0ZXMtLW5nQW5pbWF0ZSB3aWxsIGhhbmRsZSB0aGUgc3R5bGUgdG9nZ2xpbmcgYXV0b21hdGljYWxseSBmb3IgeW91LlxuICpcbiAqIEBhbmltYXRpb25zXG4gKiByZW1vdmVDbGFzczogYC5uZy1oaWRlYCAtIGhhcHBlbnMgYWZ0ZXIgdGhlIGBuZ0hpZGVgIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGEgdHJ1dGh5IHZhbHVlIGFuZCBqdXN0IGJlZm9yZSB0aGUgY29udGVudHMgYXJlIHNldCB0byBoaWRkZW5cbiAqIGFkZENsYXNzOiBgLm5nLWhpZGVgIC0gaGFwcGVucyBhZnRlciB0aGUgYG5nSGlkZWAgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBub24gdHJ1dGh5IHZhbHVlIGFuZCBqdXN0IGJlZm9yZSB0aGUgY29udGVudHMgYXJlIHNldCB0byB2aXNpYmxlXG4gKlxuICogQGVsZW1lbnQgQU5ZXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nSGlkZSBJZiB0aGUge0BsaW5rIGd1aWRlL2V4cHJlc3Npb24gZXhwcmVzc2lvbn0gaXMgdHJ1dGh5IHRoZW5cbiAqICAgICB0aGUgZWxlbWVudCBpcyBzaG93biBvciBoaWRkZW4gcmVzcGVjdGl2ZWx5LlxuICpcbiAqIEBleGFtcGxlXG4gIDxleGFtcGxlIG1vZHVsZT1cIm5nQW5pbWF0ZVwiIGRlcHM9XCJhbmd1bGFyLWFuaW1hdGUuanNcIiBhbmltYXRpb25zPVwidHJ1ZVwiPlxuICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICBDbGljayBtZTogPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiY2hlY2tlZFwiIGFyaWEtbGFiZWw9XCJUb2dnbGUgbmdTaG93XCI+PGJyLz5cbiAgICAgIDxkaXY+XG4gICAgICAgIFNob3c6XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjaGVjay1lbGVtZW50IGFuaW1hdGUtaGlkZVwiIG5nLXNob3c9XCJjaGVja2VkXCI+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXRodW1icy11cFwiPjwvc3Bhbj4gSSBzaG93IHVwIHdoZW4geW91ciBjaGVja2JveCBpcyBjaGVja2VkLlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdj5cbiAgICAgICAgSGlkZTpcbiAgICAgICAgPGRpdiBjbGFzcz1cImNoZWNrLWVsZW1lbnQgYW5pbWF0ZS1oaWRlXCIgbmctaGlkZT1cImNoZWNrZWRcIj5cbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tdGh1bWJzLWRvd25cIj48L3NwYW4+IEkgaGlkZSB3aGVuIHlvdXIgY2hlY2tib3ggaXMgY2hlY2tlZC5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L2ZpbGU+XG4gICAgPGZpbGUgbmFtZT1cImdseXBoaWNvbnMuY3NzXCI+XG4gICAgICBAaW1wb3J0IHVybCguLi8uLi9jb21wb25lbnRzL2Jvb3RzdHJhcC0zLjEuMS9jc3MvYm9vdHN0cmFwLmNzcyk7XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJhbmltYXRpb25zLmNzc1wiPlxuICAgICAgLmFuaW1hdGUtaGlkZSB7XG4gICAgICAgIHRyYW5zaXRpb246IGFsbCBsaW5lYXIgMC41cztcbiAgICAgICAgbGluZS1oZWlnaHQ6IDIwcHg7XG4gICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgIHBhZGRpbmc6IDEwcHg7XG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xuICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTtcbiAgICAgIH1cblxuICAgICAgLmFuaW1hdGUtaGlkZS5uZy1oaWRlIHtcbiAgICAgICAgbGluZS1oZWlnaHQ6IDA7XG4gICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgIHBhZGRpbmc6IDAgMTBweDtcbiAgICAgIH1cblxuICAgICAgLmNoZWNrLWVsZW1lbnQge1xuICAgICAgICBwYWRkaW5nOiAxMHB4O1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCBibGFjaztcbiAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7XG4gICAgICB9XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgIHZhciB0aHVtYnNVcCA9IGVsZW1lbnQoYnkuY3NzKCdzcGFuLmdseXBoaWNvbi10aHVtYnMtdXAnKSk7XG4gICAgICB2YXIgdGh1bWJzRG93biA9IGVsZW1lbnQoYnkuY3NzKCdzcGFuLmdseXBoaWNvbi10aHVtYnMtZG93bicpKTtcblxuICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1zaG93IC8gbmctaGlkZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICBleHBlY3QodGh1bWJzVXAuaXNEaXNwbGF5ZWQoKSkudG9CZUZhbHN5KCk7XG4gICAgICAgIGV4cGVjdCh0aHVtYnNEb3duLmlzRGlzcGxheWVkKCkpLnRvQmVUcnV0aHkoKTtcblxuICAgICAgICBlbGVtZW50KGJ5Lm1vZGVsKCdjaGVja2VkJykpLmNsaWNrKCk7XG5cbiAgICAgICAgZXhwZWN0KHRodW1ic1VwLmlzRGlzcGxheWVkKCkpLnRvQmVUcnV0aHkoKTtcbiAgICAgICAgZXhwZWN0KHRodW1ic0Rvd24uaXNEaXNwbGF5ZWQoKSkudG9CZUZhbHN5KCk7XG4gICAgICB9KTtcbiAgICA8L2ZpbGU+XG4gIDwvZXhhbXBsZT5cbiAqL1xudmFyIG5nSGlkZURpcmVjdGl2ZSA9IFsnJGFuaW1hdGUnLCBmdW5jdGlvbigkYW5pbWF0ZSkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgbXVsdGlFbGVtZW50OiB0cnVlLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG4gICAgICBzY29wZS4kd2F0Y2goYXR0ci5uZ0hpZGUsIGZ1bmN0aW9uIG5nSGlkZVdhdGNoQWN0aW9uKHZhbHVlKSB7XG4gICAgICAgIC8vIFRoZSBjb21tZW50IGluc2lkZSBvZiB0aGUgbmdTaG93RGlyZWN0aXZlIGV4cGxhaW5zIHdoeSB3ZSBhZGQgYW5kXG4gICAgICAgIC8vIHJlbW92ZSBhIHRlbXBvcmFyeSBjbGFzcyBmb3IgdGhlIHNob3cvaGlkZSBhbmltYXRpb25cbiAgICAgICAgJGFuaW1hdGVbdmFsdWUgPyAnYWRkQ2xhc3MnIDogJ3JlbW92ZUNsYXNzJ10oZWxlbWVudCxOR19ISURFX0NMQVNTLCB7XG4gICAgICAgICAgdGVtcENsYXNzZXM6IE5HX0hJREVfSU5fUFJPR1JFU1NfQ0xBU1NcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ1N0eWxlXG4gKiBAcmVzdHJpY3QgQUNcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBgbmdTdHlsZWAgZGlyZWN0aXZlIGFsbG93cyB5b3UgdG8gc2V0IENTUyBzdHlsZSBvbiBhbiBIVE1MIGVsZW1lbnQgY29uZGl0aW9uYWxseS5cbiAqXG4gKiBAZWxlbWVudCBBTllcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmdTdHlsZVxuICpcbiAqIHtAbGluayBndWlkZS9leHByZXNzaW9uIEV4cHJlc3Npb259IHdoaWNoIGV2YWxzIHRvIGFuXG4gKiBvYmplY3Qgd2hvc2Uga2V5cyBhcmUgQ1NTIHN0eWxlIG5hbWVzIGFuZCB2YWx1ZXMgYXJlIGNvcnJlc3BvbmRpbmcgdmFsdWVzIGZvciB0aG9zZSBDU1NcbiAqIGtleXMuXG4gKlxuICogU2luY2Ugc29tZSBDU1Mgc3R5bGUgbmFtZXMgYXJlIG5vdCB2YWxpZCBrZXlzIGZvciBhbiBvYmplY3QsIHRoZXkgbXVzdCBiZSBxdW90ZWQuXG4gKiBTZWUgdGhlICdiYWNrZ3JvdW5kLWNvbG9yJyBzdHlsZSBpbiB0aGUgZXhhbXBsZSBiZWxvdy5cbiAqXG4gKiBAZXhhbXBsZVxuICAgPGV4YW1wbGU+XG4gICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICAgIDxpbnB1dCB0eXBlPVwiYnV0dG9uXCIgdmFsdWU9XCJzZXQgY29sb3JcIiBuZy1jbGljaz1cIm15U3R5bGU9e2NvbG9yOidyZWQnfVwiPlxuICAgICAgICA8aW5wdXQgdHlwZT1cImJ1dHRvblwiIHZhbHVlPVwic2V0IGJhY2tncm91bmRcIiBuZy1jbGljaz1cIm15U3R5bGU9eydiYWNrZ3JvdW5kLWNvbG9yJzonYmx1ZSd9XCI+XG4gICAgICAgIDxpbnB1dCB0eXBlPVwiYnV0dG9uXCIgdmFsdWU9XCJjbGVhclwiIG5nLWNsaWNrPVwibXlTdHlsZT17fVwiPlxuICAgICAgICA8YnIvPlxuICAgICAgICA8c3BhbiBuZy1zdHlsZT1cIm15U3R5bGVcIj5TYW1wbGUgVGV4dDwvc3Bhbj5cbiAgICAgICAgPHByZT5teVN0eWxlPXt7bXlTdHlsZX19PC9wcmU+XG4gICAgIDwvZmlsZT5cbiAgICAgPGZpbGUgbmFtZT1cInN0eWxlLmNzc1wiPlxuICAgICAgIHNwYW4ge1xuICAgICAgICAgY29sb3I6IGJsYWNrO1xuICAgICAgIH1cbiAgICAgPC9maWxlPlxuICAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgdmFyIGNvbG9yU3BhbiA9IGVsZW1lbnQoYnkuY3NzKCdzcGFuJykpO1xuXG4gICAgICAgaXQoJ3Nob3VsZCBjaGVjayBuZy1zdHlsZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgZXhwZWN0KGNvbG9yU3Bhbi5nZXRDc3NWYWx1ZSgnY29sb3InKSkudG9CZSgncmdiYSgwLCAwLCAwLCAxKScpO1xuICAgICAgICAgZWxlbWVudChieS5jc3MoJ2lucHV0W3ZhbHVlPVxcJ3NldCBjb2xvclxcJ10nKSkuY2xpY2soKTtcbiAgICAgICAgIGV4cGVjdChjb2xvclNwYW4uZ2V0Q3NzVmFsdWUoJ2NvbG9yJykpLnRvQmUoJ3JnYmEoMjU1LCAwLCAwLCAxKScpO1xuICAgICAgICAgZWxlbWVudChieS5jc3MoJ2lucHV0W3ZhbHVlPWNsZWFyXScpKS5jbGljaygpO1xuICAgICAgICAgZXhwZWN0KGNvbG9yU3Bhbi5nZXRDc3NWYWx1ZSgnY29sb3InKSkudG9CZSgncmdiYSgwLCAwLCAwLCAxKScpO1xuICAgICAgIH0pO1xuICAgICA8L2ZpbGU+XG4gICA8L2V4YW1wbGU+XG4gKi9cbnZhciBuZ1N0eWxlRGlyZWN0aXZlID0gbmdEaXJlY3RpdmUoZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgc2NvcGUuJHdhdGNoKGF0dHIubmdTdHlsZSwgZnVuY3Rpb24gbmdTdHlsZVdhdGNoQWN0aW9uKG5ld1N0eWxlcywgb2xkU3R5bGVzKSB7XG4gICAgaWYgKG9sZFN0eWxlcyAmJiAobmV3U3R5bGVzICE9PSBvbGRTdHlsZXMpKSB7XG4gICAgICBmb3JFYWNoKG9sZFN0eWxlcywgZnVuY3Rpb24odmFsLCBzdHlsZSkgeyBlbGVtZW50LmNzcyhzdHlsZSwgJycpO30pO1xuICAgIH1cbiAgICBpZiAobmV3U3R5bGVzKSBlbGVtZW50LmNzcyhuZXdTdHlsZXMpO1xuICB9LCB0cnVlKTtcbn0pO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nU3dpdGNoXG4gKiBAcmVzdHJpY3QgRUFcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBgbmdTd2l0Y2hgIGRpcmVjdGl2ZSBpcyB1c2VkIHRvIGNvbmRpdGlvbmFsbHkgc3dhcCBET00gc3RydWN0dXJlIG9uIHlvdXIgdGVtcGxhdGUgYmFzZWQgb24gYSBzY29wZSBleHByZXNzaW9uLlxuICogRWxlbWVudHMgd2l0aGluIGBuZ1N3aXRjaGAgYnV0IHdpdGhvdXQgYG5nU3dpdGNoV2hlbmAgb3IgYG5nU3dpdGNoRGVmYXVsdGAgZGlyZWN0aXZlcyB3aWxsIGJlIHByZXNlcnZlZCBhdCB0aGUgbG9jYXRpb25cbiAqIGFzIHNwZWNpZmllZCBpbiB0aGUgdGVtcGxhdGUuXG4gKlxuICogVGhlIGRpcmVjdGl2ZSBpdHNlbGYgd29ya3Mgc2ltaWxhciB0byBuZ0luY2x1ZGUsIGhvd2V2ZXIsIGluc3RlYWQgb2YgZG93bmxvYWRpbmcgdGVtcGxhdGUgY29kZSAob3IgbG9hZGluZyBpdFxuICogZnJvbSB0aGUgdGVtcGxhdGUgY2FjaGUpLCBgbmdTd2l0Y2hgIHNpbXBseSBjaG9vc2VzIG9uZSBvZiB0aGUgbmVzdGVkIGVsZW1lbnRzIGFuZCBtYWtlcyBpdCB2aXNpYmxlIGJhc2VkIG9uIHdoaWNoIGVsZW1lbnRcbiAqIG1hdGNoZXMgdGhlIHZhbHVlIG9idGFpbmVkIGZyb20gdGhlIGV2YWx1YXRlZCBleHByZXNzaW9uLiBJbiBvdGhlciB3b3JkcywgeW91IGRlZmluZSBhIGNvbnRhaW5lciBlbGVtZW50XG4gKiAod2hlcmUgeW91IHBsYWNlIHRoZSBkaXJlY3RpdmUpLCBwbGFjZSBhbiBleHByZXNzaW9uIG9uIHRoZSAqKmBvbj1cIi4uLlwiYCBhdHRyaWJ1dGUqKlxuICogKG9yIHRoZSAqKmBuZy1zd2l0Y2g9XCIuLi5cImAgYXR0cmlidXRlKiopLCBkZWZpbmUgYW55IGlubmVyIGVsZW1lbnRzIGluc2lkZSBvZiB0aGUgZGlyZWN0aXZlIGFuZCBwbGFjZVxuICogYSB3aGVuIGF0dHJpYnV0ZSBwZXIgZWxlbWVudC4gVGhlIHdoZW4gYXR0cmlidXRlIGlzIHVzZWQgdG8gaW5mb3JtIG5nU3dpdGNoIHdoaWNoIGVsZW1lbnQgdG8gZGlzcGxheSB3aGVuIHRoZSBvblxuICogZXhwcmVzc2lvbiBpcyBldmFsdWF0ZWQuIElmIGEgbWF0Y2hpbmcgZXhwcmVzc2lvbiBpcyBub3QgZm91bmQgdmlhIGEgd2hlbiBhdHRyaWJ1dGUgdGhlbiBhbiBlbGVtZW50IHdpdGggdGhlIGRlZmF1bHRcbiAqIGF0dHJpYnV0ZSBpcyBkaXNwbGF5ZWQuXG4gKlxuICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWluZm9cIj5cbiAqIEJlIGF3YXJlIHRoYXQgdGhlIGF0dHJpYnV0ZSB2YWx1ZXMgdG8gbWF0Y2ggYWdhaW5zdCBjYW5ub3QgYmUgZXhwcmVzc2lvbnMuIFRoZXkgYXJlIGludGVycHJldGVkXG4gKiBhcyBsaXRlcmFsIHN0cmluZyB2YWx1ZXMgdG8gbWF0Y2ggYWdhaW5zdC5cbiAqIEZvciBleGFtcGxlLCAqKmBuZy1zd2l0Y2gtd2hlbj1cInNvbWVWYWxcImAqKiB3aWxsIG1hdGNoIGFnYWluc3QgdGhlIHN0cmluZyBgXCJzb21lVmFsXCJgIG5vdCBhZ2FpbnN0IHRoZVxuICogdmFsdWUgb2YgdGhlIGV4cHJlc3Npb24gYCRzY29wZS5zb21lVmFsYC5cbiAqIDwvZGl2PlxuXG4gKiBAYW5pbWF0aW9uc1xuICogZW50ZXIgLSBoYXBwZW5zIGFmdGVyIHRoZSBuZ1N3aXRjaCBjb250ZW50cyBjaGFuZ2UgYW5kIHRoZSBtYXRjaGVkIGNoaWxkIGVsZW1lbnQgaXMgcGxhY2VkIGluc2lkZSB0aGUgY29udGFpbmVyXG4gKiBsZWF2ZSAtIGhhcHBlbnMganVzdCBhZnRlciB0aGUgbmdTd2l0Y2ggY29udGVudHMgY2hhbmdlIGFuZCBqdXN0IGJlZm9yZSB0aGUgZm9ybWVyIGNvbnRlbnRzIGFyZSByZW1vdmVkIGZyb20gdGhlIERPTVxuICpcbiAqIEB1c2FnZVxuICpcbiAqIGBgYFxuICogPEFOWSBuZy1zd2l0Y2g9XCJleHByZXNzaW9uXCI+XG4gKiAgIDxBTlkgbmctc3dpdGNoLXdoZW49XCJtYXRjaFZhbHVlMVwiPi4uLjwvQU5ZPlxuICogICA8QU5ZIG5nLXN3aXRjaC13aGVuPVwibWF0Y2hWYWx1ZTJcIj4uLi48L0FOWT5cbiAqICAgPEFOWSBuZy1zd2l0Y2gtZGVmYXVsdD4uLi48L0FOWT5cbiAqIDwvQU5ZPlxuICogYGBgXG4gKlxuICpcbiAqIEBzY29wZVxuICogQHByaW9yaXR5IDEyMDBcbiAqIEBwYXJhbSB7Kn0gbmdTd2l0Y2h8b24gZXhwcmVzc2lvbiB0byBtYXRjaCBhZ2FpbnN0IDxjb2RlPm5nLXN3aXRjaC13aGVuPC9jb2RlPi5cbiAqIE9uIGNoaWxkIGVsZW1lbnRzIGFkZDpcbiAqXG4gKiAqIGBuZ1N3aXRjaFdoZW5gOiB0aGUgY2FzZSBzdGF0ZW1lbnQgdG8gbWF0Y2ggYWdhaW5zdC4gSWYgbWF0Y2ggdGhlbiB0aGlzXG4gKiAgIGNhc2Ugd2lsbCBiZSBkaXNwbGF5ZWQuIElmIHRoZSBzYW1lIG1hdGNoIGFwcGVhcnMgbXVsdGlwbGUgdGltZXMsIGFsbCB0aGVcbiAqICAgZWxlbWVudHMgd2lsbCBiZSBkaXNwbGF5ZWQuXG4gKiAqIGBuZ1N3aXRjaERlZmF1bHRgOiB0aGUgZGVmYXVsdCBjYXNlIHdoZW4gbm8gb3RoZXIgY2FzZSBtYXRjaC4gSWYgdGhlcmVcbiAqICAgYXJlIG11bHRpcGxlIGRlZmF1bHQgY2FzZXMsIGFsbCBvZiB0aGVtIHdpbGwgYmUgZGlzcGxheWVkIHdoZW4gbm8gb3RoZXJcbiAqICAgY2FzZSBtYXRjaC5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAgPGV4YW1wbGUgbW9kdWxlPVwic3dpdGNoRXhhbXBsZVwiIGRlcHM9XCJhbmd1bGFyLWFuaW1hdGUuanNcIiBhbmltYXRpb25zPVwidHJ1ZVwiPlxuICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICAgICAgICA8c2VsZWN0IG5nLW1vZGVsPVwic2VsZWN0aW9uXCIgbmctb3B0aW9ucz1cIml0ZW0gZm9yIGl0ZW0gaW4gaXRlbXNcIj5cbiAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgIDxjb2RlPnNlbGVjdGlvbj17e3NlbGVjdGlvbn19PC9jb2RlPlxuICAgICAgICA8aHIvPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiYW5pbWF0ZS1zd2l0Y2gtY29udGFpbmVyXCJcbiAgICAgICAgICBuZy1zd2l0Y2ggb249XCJzZWxlY3Rpb25cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbmltYXRlLXN3aXRjaFwiIG5nLXN3aXRjaC13aGVuPVwic2V0dGluZ3NcIj5TZXR0aW5ncyBEaXY8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbmltYXRlLXN3aXRjaFwiIG5nLXN3aXRjaC13aGVuPVwiaG9tZVwiPkhvbWUgU3BhbjwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFuaW1hdGUtc3dpdGNoXCIgbmctc3dpdGNoLWRlZmF1bHQ+ZGVmYXVsdDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZmlsZT5cbiAgICA8ZmlsZSBuYW1lPVwic2NyaXB0LmpzXCI+XG4gICAgICBhbmd1bGFyLm1vZHVsZSgnc3dpdGNoRXhhbXBsZScsIFsnbmdBbmltYXRlJ10pXG4gICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICAgJHNjb3BlLml0ZW1zID0gWydzZXR0aW5ncycsICdob21lJywgJ290aGVyJ107XG4gICAgICAgICAgJHNjb3BlLnNlbGVjdGlvbiA9ICRzY29wZS5pdGVtc1swXTtcbiAgICAgICAgfV0pO1xuICAgIDwvZmlsZT5cbiAgICA8ZmlsZSBuYW1lPVwiYW5pbWF0aW9ucy5jc3NcIj5cbiAgICAgIC5hbmltYXRlLXN3aXRjaC1jb250YWluZXIge1xuICAgICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcbiAgICAgICAgYmFja2dyb3VuZDp3aGl0ZTtcbiAgICAgICAgYm9yZGVyOjFweCBzb2xpZCBibGFjaztcbiAgICAgICAgaGVpZ2h0OjQwcHg7XG4gICAgICAgIG92ZXJmbG93OmhpZGRlbjtcbiAgICAgIH1cblxuICAgICAgLmFuaW1hdGUtc3dpdGNoIHtcbiAgICAgICAgcGFkZGluZzoxMHB4O1xuICAgICAgfVxuXG4gICAgICAuYW5pbWF0ZS1zd2l0Y2gubmctYW5pbWF0ZSB7XG4gICAgICAgIHRyYW5zaXRpb246YWxsIGN1YmljLWJlemllcigwLjI1MCwgMC40NjAsIDAuNDUwLCAwLjk0MCkgMC41cztcblxuICAgICAgICBwb3NpdGlvbjphYnNvbHV0ZTtcbiAgICAgICAgdG9wOjA7XG4gICAgICAgIGxlZnQ6MDtcbiAgICAgICAgcmlnaHQ6MDtcbiAgICAgICAgYm90dG9tOjA7XG4gICAgICB9XG5cbiAgICAgIC5hbmltYXRlLXN3aXRjaC5uZy1sZWF2ZS5uZy1sZWF2ZS1hY3RpdmUsXG4gICAgICAuYW5pbWF0ZS1zd2l0Y2gubmctZW50ZXIge1xuICAgICAgICB0b3A6LTUwcHg7XG4gICAgICB9XG4gICAgICAuYW5pbWF0ZS1zd2l0Y2gubmctbGVhdmUsXG4gICAgICAuYW5pbWF0ZS1zd2l0Y2gubmctZW50ZXIubmctZW50ZXItYWN0aXZlIHtcbiAgICAgICAgdG9wOjA7XG4gICAgICB9XG4gICAgPC9maWxlPlxuICAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgIHZhciBzd2l0Y2hFbGVtID0gZWxlbWVudChieS5jc3MoJ1tuZy1zd2l0Y2hdJykpO1xuICAgICAgdmFyIHNlbGVjdCA9IGVsZW1lbnQoYnkubW9kZWwoJ3NlbGVjdGlvbicpKTtcblxuICAgICAgaXQoJ3Nob3VsZCBzdGFydCBpbiBzZXR0aW5ncycsIGZ1bmN0aW9uKCkge1xuICAgICAgICBleHBlY3Qoc3dpdGNoRWxlbS5nZXRUZXh0KCkpLnRvTWF0Y2goL1NldHRpbmdzIERpdi8pO1xuICAgICAgfSk7XG4gICAgICBpdCgnc2hvdWxkIGNoYW5nZSB0byBob21lJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlbGVjdC5hbGwoYnkuY3NzKCdvcHRpb24nKSkuZ2V0KDEpLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChzd2l0Y2hFbGVtLmdldFRleHQoKSkudG9NYXRjaCgvSG9tZSBTcGFuLyk7XG4gICAgICB9KTtcbiAgICAgIGl0KCdzaG91bGQgc2VsZWN0IGRlZmF1bHQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgc2VsZWN0LmFsbChieS5jc3MoJ29wdGlvbicpKS5nZXQoMikuY2xpY2soKTtcbiAgICAgICAgZXhwZWN0KHN3aXRjaEVsZW0uZ2V0VGV4dCgpKS50b01hdGNoKC9kZWZhdWx0Lyk7XG4gICAgICB9KTtcbiAgICA8L2ZpbGU+XG4gIDwvZXhhbXBsZT5cbiAqL1xudmFyIG5nU3dpdGNoRGlyZWN0aXZlID0gWyckYW5pbWF0ZScsIGZ1bmN0aW9uKCRhbmltYXRlKSB7XG4gIHJldHVybiB7XG4gICAgcmVxdWlyZTogJ25nU3dpdGNoJyxcblxuICAgIC8vIGFza3MgZm9yICRzY29wZSB0byBmb29sIHRoZSBCQyBjb250cm9sbGVyIG1vZHVsZVxuICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24gbmdTd2l0Y2hDb250cm9sbGVyKCkge1xuICAgICB0aGlzLmNhc2VzID0ge307XG4gICAgfV0sXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIsIG5nU3dpdGNoQ29udHJvbGxlcikge1xuICAgICAgdmFyIHdhdGNoRXhwciA9IGF0dHIubmdTd2l0Y2ggfHwgYXR0ci5vbixcbiAgICAgICAgICBzZWxlY3RlZFRyYW5zY2x1ZGVzID0gW10sXG4gICAgICAgICAgc2VsZWN0ZWRFbGVtZW50cyA9IFtdLFxuICAgICAgICAgIHByZXZpb3VzTGVhdmVBbmltYXRpb25zID0gW10sXG4gICAgICAgICAgc2VsZWN0ZWRTY29wZXMgPSBbXTtcblxuICAgICAgdmFyIHNwbGljZUZhY3RvcnkgPSBmdW5jdGlvbihhcnJheSwgaW5kZXgpIHtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7IGFycmF5LnNwbGljZShpbmRleCwgMSk7IH07XG4gICAgICB9O1xuXG4gICAgICBzY29wZS4kd2F0Y2god2F0Y2hFeHByLCBmdW5jdGlvbiBuZ1N3aXRjaFdhdGNoQWN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhciBpLCBpaTtcbiAgICAgICAgZm9yIChpID0gMCwgaWkgPSBwcmV2aW91c0xlYXZlQW5pbWF0aW9ucy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgICAgJGFuaW1hdGUuY2FuY2VsKHByZXZpb3VzTGVhdmVBbmltYXRpb25zW2ldKTtcbiAgICAgICAgfVxuICAgICAgICBwcmV2aW91c0xlYXZlQW5pbWF0aW9ucy5sZW5ndGggPSAwO1xuXG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gc2VsZWN0ZWRTY29wZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICAgIHZhciBzZWxlY3RlZCA9IGdldEJsb2NrTm9kZXMoc2VsZWN0ZWRFbGVtZW50c1tpXS5jbG9uZSk7XG4gICAgICAgICAgc2VsZWN0ZWRTY29wZXNbaV0uJGRlc3Ryb3koKTtcbiAgICAgICAgICB2YXIgcHJvbWlzZSA9IHByZXZpb3VzTGVhdmVBbmltYXRpb25zW2ldID0gJGFuaW1hdGUubGVhdmUoc2VsZWN0ZWQpO1xuICAgICAgICAgIHByb21pc2UudGhlbihzcGxpY2VGYWN0b3J5KHByZXZpb3VzTGVhdmVBbmltYXRpb25zLCBpKSk7XG4gICAgICAgIH1cblxuICAgICAgICBzZWxlY3RlZEVsZW1lbnRzLmxlbmd0aCA9IDA7XG4gICAgICAgIHNlbGVjdGVkU2NvcGVzLmxlbmd0aCA9IDA7XG5cbiAgICAgICAgaWYgKChzZWxlY3RlZFRyYW5zY2x1ZGVzID0gbmdTd2l0Y2hDb250cm9sbGVyLmNhc2VzWychJyArIHZhbHVlXSB8fCBuZ1N3aXRjaENvbnRyb2xsZXIuY2FzZXNbJz8nXSkpIHtcbiAgICAgICAgICBmb3JFYWNoKHNlbGVjdGVkVHJhbnNjbHVkZXMsIGZ1bmN0aW9uKHNlbGVjdGVkVHJhbnNjbHVkZSkge1xuICAgICAgICAgICAgc2VsZWN0ZWRUcmFuc2NsdWRlLnRyYW5zY2x1ZGUoZnVuY3Rpb24oY2FzZUVsZW1lbnQsIHNlbGVjdGVkU2NvcGUpIHtcbiAgICAgICAgICAgICAgc2VsZWN0ZWRTY29wZXMucHVzaChzZWxlY3RlZFNjb3BlKTtcbiAgICAgICAgICAgICAgdmFyIGFuY2hvciA9IHNlbGVjdGVkVHJhbnNjbHVkZS5lbGVtZW50O1xuICAgICAgICAgICAgICBjYXNlRWxlbWVudFtjYXNlRWxlbWVudC5sZW5ndGgrK10gPSBkb2N1bWVudC5jcmVhdGVDb21tZW50KCcgZW5kIG5nU3dpdGNoV2hlbjogJyk7XG4gICAgICAgICAgICAgIHZhciBibG9jayA9IHsgY2xvbmU6IGNhc2VFbGVtZW50IH07XG5cbiAgICAgICAgICAgICAgc2VsZWN0ZWRFbGVtZW50cy5wdXNoKGJsb2NrKTtcbiAgICAgICAgICAgICAgJGFuaW1hdGUuZW50ZXIoY2FzZUVsZW1lbnQsIGFuY2hvci5wYXJlbnQoKSwgYW5jaG9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XTtcblxudmFyIG5nU3dpdGNoV2hlbkRpcmVjdGl2ZSA9IG5nRGlyZWN0aXZlKHtcbiAgdHJhbnNjbHVkZTogJ2VsZW1lbnQnLFxuICBwcmlvcml0eTogMTIwMCxcbiAgcmVxdWlyZTogJ15uZ1N3aXRjaCcsXG4gIG11bHRpRWxlbWVudDogdHJ1ZSxcbiAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJsLCAkdHJhbnNjbHVkZSkge1xuICAgIGN0cmwuY2FzZXNbJyEnICsgYXR0cnMubmdTd2l0Y2hXaGVuXSA9IChjdHJsLmNhc2VzWychJyArIGF0dHJzLm5nU3dpdGNoV2hlbl0gfHwgW10pO1xuICAgIGN0cmwuY2FzZXNbJyEnICsgYXR0cnMubmdTd2l0Y2hXaGVuXS5wdXNoKHsgdHJhbnNjbHVkZTogJHRyYW5zY2x1ZGUsIGVsZW1lbnQ6IGVsZW1lbnQgfSk7XG4gIH1cbn0pO1xuXG52YXIgbmdTd2l0Y2hEZWZhdWx0RGlyZWN0aXZlID0gbmdEaXJlY3RpdmUoe1xuICB0cmFuc2NsdWRlOiAnZWxlbWVudCcsXG4gIHByaW9yaXR5OiAxMjAwLFxuICByZXF1aXJlOiAnXm5nU3dpdGNoJyxcbiAgbXVsdGlFbGVtZW50OiB0cnVlLFxuICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCwgJHRyYW5zY2x1ZGUpIHtcbiAgICBjdHJsLmNhc2VzWyc/J10gPSAoY3RybC5jYXNlc1snPyddIHx8IFtdKTtcbiAgICBjdHJsLmNhc2VzWyc/J10ucHVzaCh7IHRyYW5zY2x1ZGU6ICR0cmFuc2NsdWRlLCBlbGVtZW50OiBlbGVtZW50IH0pO1xuICAgfVxufSk7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdUcmFuc2NsdWRlXG4gKiBAcmVzdHJpY3QgRUFDXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBEaXJlY3RpdmUgdGhhdCBtYXJrcyB0aGUgaW5zZXJ0aW9uIHBvaW50IGZvciB0aGUgdHJhbnNjbHVkZWQgRE9NIG9mIHRoZSBuZWFyZXN0IHBhcmVudCBkaXJlY3RpdmUgdGhhdCB1c2VzIHRyYW5zY2x1c2lvbi5cbiAqXG4gKiBZb3UgY2FuIHNwZWNpZnkgdGhhdCB5b3Ugd2FudCB0byBpbnNlcnQgYSBuYW1lZCB0cmFuc2NsdXNpb24gc2xvdCwgaW5zdGVhZCBvZiB0aGUgZGVmYXVsdCBzbG90LCBieSBwcm92aWRpbmcgdGhlIHNsb3QgbmFtZVxuICogYXMgdGhlIHZhbHVlIG9mIHRoZSBgbmctdHJhbnNjbHVkZWAgb3IgYG5nLXRyYW5zY2x1ZGUtc2xvdGAgYXR0cmlidXRlLlxuICpcbiAqIElmIHRoZSB0cmFuc2NsdWRlZCBjb250ZW50IGlzIG5vdCBlbXB0eSAoaS5lLiBjb250YWlucyBvbmUgb3IgbW9yZSBET00gbm9kZXMsIGluY2x1ZGluZyB3aGl0ZXNwYWNlIHRleHQgbm9kZXMpLCBhbnkgZXhpc3RpbmdcbiAqIGNvbnRlbnQgb2YgdGhpcyBlbGVtZW50IHdpbGwgYmUgcmVtb3ZlZCBiZWZvcmUgdGhlIHRyYW5zY2x1ZGVkIGNvbnRlbnQgaXMgaW5zZXJ0ZWQuXG4gKiBJZiB0aGUgdHJhbnNjbHVkZWQgY29udGVudCBpcyBlbXB0eSwgdGhlIGV4aXN0aW5nIGNvbnRlbnQgaXMgbGVmdCBpbnRhY3QuIFRoaXMgbGV0cyB5b3UgcHJvdmlkZSBmYWxsYmFjayBjb250ZW50IGluIHRoZSBjYXNlXG4gKiB0aGF0IG5vIHRyYW5zY2x1ZGVkIGNvbnRlbnQgaXMgcHJvdmlkZWQuXG4gKlxuICogQGVsZW1lbnQgQU5ZXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG5nVHJhbnNjbHVkZXxuZ1RyYW5zY2x1ZGVTbG90IHRoZSBuYW1lIG9mIHRoZSBzbG90IHRvIGluc2VydCBhdCB0aGlzIHBvaW50LiBJZiB0aGlzIGlzIG5vdCBwcm92aWRlZCwgaXMgZW1wdHlcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvciBpdHMgdmFsdWUgaXMgdGhlIHNhbWUgYXMgdGhlIG5hbWUgb2YgdGhlIGF0dHJpYnV0ZSB0aGVuIHRoZSBkZWZhdWx0IHNsb3QgaXMgdXNlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogIyMjIEJhc2ljIHRyYW5zY2x1c2lvblxuICogVGhpcyBleGFtcGxlIGRlbW9uc3RyYXRlcyBiYXNpYyB0cmFuc2NsdXNpb24gb2YgY29udGVudCBpbnRvIGEgY29tcG9uZW50IGRpcmVjdGl2ZS5cbiAqIDxleGFtcGxlIG5hbWU9XCJzaW1wbGVUcmFuc2NsdWRlRXhhbXBsZVwiIG1vZHVsZT1cInRyYW5zY2x1ZGVFeGFtcGxlXCI+XG4gKiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gKiAgICAgPHNjcmlwdD5cbiAqICAgICAgIGFuZ3VsYXIubW9kdWxlKCd0cmFuc2NsdWRlRXhhbXBsZScsIFtdKVxuICogICAgICAgIC5kaXJlY3RpdmUoJ3BhbmUnLCBmdW5jdGlvbigpe1xuICogICAgICAgICAgIHJldHVybiB7XG4gKiAgICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICogICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAqICAgICAgICAgICAgIHNjb3BlOiB7IHRpdGxlOidAJyB9LFxuICogICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IHN0eWxlPVwiYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XCI+JyArXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6IGdyYXlcIj57e3RpdGxlfX08L2Rpdj4nICtcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICc8bmctdHJhbnNjbHVkZT48L25nLXRyYW5zY2x1ZGU+JyArXG4gKiAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PidcbiAqICAgICAgICAgICB9O1xuICogICAgICAgfSlcbiAqICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gKiAgICAgICAgICRzY29wZS50aXRsZSA9ICdMb3JlbSBJcHN1bSc7XG4gKiAgICAgICAgICRzY29wZS50ZXh0ID0gJ05lcXVlIHBvcnJvIHF1aXNxdWFtIGVzdCBxdWkgZG9sb3JlbSBpcHN1bSBxdWlhIGRvbG9yLi4uJztcbiAqICAgICAgIH1dKTtcbiAqICAgICA8L3NjcmlwdD5cbiAqICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICogICAgICAgPGlucHV0IG5nLW1vZGVsPVwidGl0bGVcIiBhcmlhLWxhYmVsPVwidGl0bGVcIj4gPGJyLz5cbiAqICAgICAgIDx0ZXh0YXJlYSBuZy1tb2RlbD1cInRleHRcIiBhcmlhLWxhYmVsPVwidGV4dFwiPjwvdGV4dGFyZWE+IDxici8+XG4gKiAgICAgICA8cGFuZSB0aXRsZT1cInt7dGl0bGV9fVwiPnt7dGV4dH19PC9wYW5lPlxuICogICAgIDwvZGl2PlxuICogICA8L2ZpbGU+XG4gKiAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAqICAgICAgaXQoJ3Nob3VsZCBoYXZlIHRyYW5zY2x1ZGVkJywgZnVuY3Rpb24oKSB7XG4gKiAgICAgICAgdmFyIHRpdGxlRWxlbWVudCA9IGVsZW1lbnQoYnkubW9kZWwoJ3RpdGxlJykpO1xuICogICAgICAgIHRpdGxlRWxlbWVudC5jbGVhcigpO1xuICogICAgICAgIHRpdGxlRWxlbWVudC5zZW5kS2V5cygnVElUTEUnKTtcbiAqICAgICAgICB2YXIgdGV4dEVsZW1lbnQgPSBlbGVtZW50KGJ5Lm1vZGVsKCd0ZXh0JykpO1xuICogICAgICAgIHRleHRFbGVtZW50LmNsZWFyKCk7XG4gKiAgICAgICAgdGV4dEVsZW1lbnQuc2VuZEtleXMoJ1RFWFQnKTtcbiAqICAgICAgICBleHBlY3QoZWxlbWVudChieS5iaW5kaW5nKCd0aXRsZScpKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ1RJVExFJyk7XG4gKiAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygndGV4dCcpKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ1RFWFQnKTtcbiAqICAgICAgfSk7XG4gKiAgIDwvZmlsZT5cbiAqIDwvZXhhbXBsZT5cbiAqXG4gKiBAZXhhbXBsZVxuICogIyMjIFRyYW5zY2x1ZGUgZmFsbGJhY2sgY29udGVudFxuICogVGhpcyBleGFtcGxlIHNob3dzIGhvdyB0byB1c2UgYE5nVHJhbnNjbHVkZWAgd2l0aCBmYWxsYmFjayBjb250ZW50LCB0aGF0XG4gKiBpcyBkaXNwbGF5ZWQgaWYgbm8gdHJhbnNjbHVkZWQgY29udGVudCBpcyBwcm92aWRlZC5cbiAqXG4gKiA8ZXhhbXBsZSBtb2R1bGU9XCJ0cmFuc2NsdWRlRmFsbGJhY2tDb250ZW50RXhhbXBsZVwiPlxuICogPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAqIDxzY3JpcHQ+XG4gKiBhbmd1bGFyLm1vZHVsZSgndHJhbnNjbHVkZUZhbGxiYWNrQ29udGVudEV4YW1wbGUnLCBbXSlcbiAqIC5kaXJlY3RpdmUoJ215QnV0dG9uJywgZnVuY3Rpb24oKXtcbiAqICAgICAgICAgICAgIHJldHVybiB7XG4gKiAgICAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gKiAgICAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gKiAgICAgICAgICAgICAgIHNjb3BlOiB0cnVlLFxuICogICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxidXR0b24gc3R5bGU9XCJjdXJzb3I6IHBvaW50ZXI7XCI+JyArXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICc8bmctdHJhbnNjbHVkZT4nICtcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGIgc3R5bGU9XCJjb2xvcjogcmVkO1wiPkJ1dHRvbjE8L2I+JyArXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L25nLXRyYW5zY2x1ZGU+JyArXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAnPC9idXR0b24+J1xuICogICAgICAgICAgICAgfTtcbiAqICAgICAgICAgfSk7XG4gKiA8L3NjcmlwdD5cbiAqIDwhLS0gZmFsbGJhY2sgYnV0dG9uIGNvbnRlbnQgLS0+XG4gKiA8bXktYnV0dG9uIGlkPVwiZmFsbGJhY2tcIj48L215LWJ1dHRvbj5cbiAqIDwhLS0gbW9kaWZpZWQgYnV0dG9uIGNvbnRlbnQgLS0+XG4gKiA8bXktYnV0dG9uIGlkPVwibW9kaWZpZWRcIj5cbiAqICAgPGkgc3R5bGU9XCJjb2xvcjogZ3JlZW47XCI+QnV0dG9uMjwvaT5cbiAqIDwvbXktYnV0dG9uPlxuICogPC9maWxlPlxuICogPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICogaXQoJ3Nob3VsZCBoYXZlIGRpZmZlcmVudCB0cmFuc2NsdWRlIGVsZW1lbnQgY29udGVudCcsIGZ1bmN0aW9uKCkge1xuICogICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ2ZhbGxiYWNrJykpLmdldFRleHQoKSkudG9CZSgnQnV0dG9uMScpO1xuICogICAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuaWQoJ21vZGlmaWVkJykpLmdldFRleHQoKSkudG9CZSgnQnV0dG9uMicpO1xuICogICAgICAgIH0pO1xuICogPC9maWxlPlxuICogPC9leGFtcGxlPlxuICpcbiAqIEBleGFtcGxlXG4gKiAjIyMgTXVsdGktc2xvdCB0cmFuc2NsdXNpb25cbiAqIFRoaXMgZXhhbXBsZSBkZW1vbnN0cmF0ZXMgdXNpbmcgbXVsdGktc2xvdCB0cmFuc2NsdXNpb24gaW4gYSBjb21wb25lbnQgZGlyZWN0aXZlLlxuICogPGV4YW1wbGUgbmFtZT1cIm11bHRpU2xvdFRyYW5zY2x1ZGVFeGFtcGxlXCIgbW9kdWxlPVwibXVsdGlTbG90VHJhbnNjbHVkZUV4YW1wbGVcIj5cbiAqICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAqICAgIDxzdHlsZT5cbiAqICAgICAgLnRpdGxlLCAuZm9vdGVyIHtcbiAqICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBncmF5XG4gKiAgICAgIH1cbiAqICAgIDwvc3R5bGU+XG4gKiAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICogICAgICA8aW5wdXQgbmctbW9kZWw9XCJ0aXRsZVwiIGFyaWEtbGFiZWw9XCJ0aXRsZVwiPiA8YnIvPlxuICogICAgICA8dGV4dGFyZWEgbmctbW9kZWw9XCJ0ZXh0XCIgYXJpYS1sYWJlbD1cInRleHRcIj48L3RleHRhcmVhPiA8YnIvPlxuICogICAgICA8cGFuZT5cbiAqICAgICAgICA8cGFuZS10aXRsZT48YSBuZy1ocmVmPVwie3tsaW5rfX1cIj57e3RpdGxlfX08L2E+PC9wYW5lLXRpdGxlPlxuICogICAgICAgIDxwYW5lLWJvZHk+PHA+e3t0ZXh0fX08L3A+PC9wYW5lLWJvZHk+XG4gKiAgICAgIDwvcGFuZT5cbiAqICAgIDwvZGl2PlxuICogICA8L2ZpbGU+XG4gKiAgIDxmaWxlIG5hbWU9XCJhcHAuanNcIj5cbiAqICAgIGFuZ3VsYXIubW9kdWxlKCdtdWx0aVNsb3RUcmFuc2NsdWRlRXhhbXBsZScsIFtdKVxuICogICAgIC5kaXJlY3RpdmUoJ3BhbmUnLCBmdW5jdGlvbigpe1xuICogICAgICAgIHJldHVybiB7XG4gKiAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICogICAgICAgICAgdHJhbnNjbHVkZToge1xuICogICAgICAgICAgICAndGl0bGUnOiAnP3BhbmVUaXRsZScsXG4gKiAgICAgICAgICAgICdib2R5JzogJ3BhbmVCb2R5JyxcbiAqICAgICAgICAgICAgJ2Zvb3Rlcic6ICc/cGFuZUZvb3RlcidcbiAqICAgICAgICAgIH0sXG4gKiAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgc3R5bGU9XCJib3JkZXI6IDFweCBzb2xpZCBibGFjaztcIj4nICtcbiAqICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidGl0bGVcIiBuZy10cmFuc2NsdWRlPVwidGl0bGVcIj5GYWxsYmFjayBUaXRsZTwvZGl2PicgK1xuICogICAgICAgICAgICAgICAgICAgICAgJzxkaXYgbmctdHJhbnNjbHVkZT1cImJvZHlcIj48L2Rpdj4nICtcbiAqICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZm9vdGVyXCIgbmctdHJhbnNjbHVkZT1cImZvb3RlclwiPkZhbGxiYWNrIEZvb3RlcjwvZGl2PicgK1xuICogICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nXG4gKiAgICAgICAgfTtcbiAqICAgIH0pXG4gKiAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICogICAgICAkc2NvcGUudGl0bGUgPSAnTG9yZW0gSXBzdW0nO1xuICogICAgICAkc2NvcGUubGluayA9IFwiaHR0cHM6Ly9nb29nbGUuY29tXCI7XG4gKiAgICAgICRzY29wZS50ZXh0ID0gJ05lcXVlIHBvcnJvIHF1aXNxdWFtIGVzdCBxdWkgZG9sb3JlbSBpcHN1bSBxdWlhIGRvbG9yLi4uJztcbiAqICAgIH1dKTtcbiAqICAgPC9maWxlPlxuICogICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gKiAgICAgIGl0KCdzaG91bGQgaGF2ZSB0cmFuc2NsdWRlZCB0aGUgdGl0bGUgYW5kIHRoZSBib2R5JywgZnVuY3Rpb24oKSB7XG4gKiAgICAgICAgdmFyIHRpdGxlRWxlbWVudCA9IGVsZW1lbnQoYnkubW9kZWwoJ3RpdGxlJykpO1xuICogICAgICAgIHRpdGxlRWxlbWVudC5jbGVhcigpO1xuICogICAgICAgIHRpdGxlRWxlbWVudC5zZW5kS2V5cygnVElUTEUnKTtcbiAqICAgICAgICB2YXIgdGV4dEVsZW1lbnQgPSBlbGVtZW50KGJ5Lm1vZGVsKCd0ZXh0JykpO1xuICogICAgICAgIHRleHRFbGVtZW50LmNsZWFyKCk7XG4gKiAgICAgICAgdGV4dEVsZW1lbnQuc2VuZEtleXMoJ1RFWFQnKTtcbiAqICAgICAgICBleHBlY3QoZWxlbWVudChieS5jc3MoJy50aXRsZScpKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ1RJVExFJyk7XG4gKiAgICAgICAgZXhwZWN0KGVsZW1lbnQoYnkuYmluZGluZygndGV4dCcpKS5nZXRUZXh0KCkpLnRvRXF1YWwoJ1RFWFQnKTtcbiAqICAgICAgICBleHBlY3QoZWxlbWVudChieS5jc3MoJy5mb290ZXInKSkuZ2V0VGV4dCgpKS50b0VxdWFsKCdGYWxsYmFjayBGb290ZXInKTtcbiAqICAgICAgfSk7XG4gKiAgIDwvZmlsZT5cbiAqIDwvZXhhbXBsZT5cbiAqL1xudmFyIG5nVHJhbnNjbHVkZU1pbkVyciA9IG1pbkVycignbmdUcmFuc2NsdWRlJyk7XG52YXIgbmdUcmFuc2NsdWRlRGlyZWN0aXZlID0gbmdEaXJlY3RpdmUoe1xuICByZXN0cmljdDogJ0VBQycsXG4gIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY29udHJvbGxlciwgJHRyYW5zY2x1ZGUpIHtcblxuICAgIGlmICgkYXR0cnMubmdUcmFuc2NsdWRlID09PSAkYXR0cnMuJGF0dHIubmdUcmFuc2NsdWRlKSB7XG4gICAgICAvLyBJZiB0aGUgYXR0cmlidXRlIGlzIG9mIHRoZSBmb3JtOiBgbmctdHJhbnNjbHVkZT1cIm5nLXRyYW5zY2x1ZGVcImBcbiAgICAgIC8vIHRoZW4gdHJlYXQgaXQgbGlrZSB0aGUgZGVmYXVsdFxuICAgICAgJGF0dHJzLm5nVHJhbnNjbHVkZSA9ICcnO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5nVHJhbnNjbHVkZUNsb25lQXR0YWNoRm4oY2xvbmUpIHtcbiAgICAgIGlmIChjbG9uZS5sZW5ndGgpIHtcbiAgICAgICAgJGVsZW1lbnQuZW1wdHkoKTtcbiAgICAgICAgJGVsZW1lbnQuYXBwZW5kKGNsb25lKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoISR0cmFuc2NsdWRlKSB7XG4gICAgICB0aHJvdyBuZ1RyYW5zY2x1ZGVNaW5FcnIoJ29ycGhhbicsXG4gICAgICAgJ0lsbGVnYWwgdXNlIG9mIG5nVHJhbnNjbHVkZSBkaXJlY3RpdmUgaW4gdGhlIHRlbXBsYXRlISAnICtcbiAgICAgICAnTm8gcGFyZW50IGRpcmVjdGl2ZSB0aGF0IHJlcXVpcmVzIGEgdHJhbnNjbHVzaW9uIGZvdW5kLiAnICtcbiAgICAgICAnRWxlbWVudDogezB9JyxcbiAgICAgICBzdGFydGluZ1RhZygkZWxlbWVudCkpO1xuICAgIH1cblxuICAgIC8vIElmIHRoZXJlIGlzIG5vIHNsb3QgbmFtZSBkZWZpbmVkIG9yIHRoZSBzbG90IG5hbWUgaXMgbm90IG9wdGlvbmFsXG4gICAgLy8gdGhlbiB0cmFuc2NsdWRlIHRoZSBzbG90XG4gICAgdmFyIHNsb3ROYW1lID0gJGF0dHJzLm5nVHJhbnNjbHVkZSB8fCAkYXR0cnMubmdUcmFuc2NsdWRlU2xvdDtcbiAgICAkdHJhbnNjbHVkZShuZ1RyYW5zY2x1ZGVDbG9uZUF0dGFjaEZuLCBudWxsLCBzbG90TmFtZSk7XG4gIH1cbn0pO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIHNjcmlwdFxuICogQHJlc3RyaWN0IEVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIExvYWQgdGhlIGNvbnRlbnQgb2YgYSBgPHNjcmlwdD5gIGVsZW1lbnQgaW50byB7QGxpbmsgbmcuJHRlbXBsYXRlQ2FjaGUgYCR0ZW1wbGF0ZUNhY2hlYH0sIHNvIHRoYXQgdGhlXG4gKiB0ZW1wbGF0ZSBjYW4gYmUgdXNlZCBieSB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nSW5jbHVkZSBgbmdJbmNsdWRlYH0sXG4gKiB7QGxpbmsgbmdSb3V0ZS5kaXJlY3RpdmU6bmdWaWV3IGBuZ1ZpZXdgfSwgb3Ige0BsaW5rIGd1aWRlL2RpcmVjdGl2ZSBkaXJlY3RpdmVzfS4gVGhlIHR5cGUgb2YgdGhlXG4gKiBgPHNjcmlwdD5gIGVsZW1lbnQgbXVzdCBiZSBzcGVjaWZpZWQgYXMgYHRleHQvbmctdGVtcGxhdGVgLCBhbmQgYSBjYWNoZSBuYW1lIGZvciB0aGUgdGVtcGxhdGUgbXVzdCBiZVxuICogYXNzaWduZWQgdGhyb3VnaCB0aGUgZWxlbWVudCdzIGBpZGAsIHdoaWNoIGNhbiB0aGVuIGJlIHVzZWQgYXMgYSBkaXJlY3RpdmUncyBgdGVtcGxhdGVVcmxgLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIE11c3QgYmUgc2V0IHRvIGAndGV4dC9uZy10ZW1wbGF0ZSdgLlxuICogQHBhcmFtIHtzdHJpbmd9IGlkIENhY2hlIG5hbWUgb2YgdGhlIHRlbXBsYXRlLlxuICpcbiAqIEBleGFtcGxlXG4gIDxleGFtcGxlPlxuICAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gICAgICA8c2NyaXB0IHR5cGU9XCJ0ZXh0L25nLXRlbXBsYXRlXCIgaWQ9XCIvdHBsLmh0bWxcIj5cbiAgICAgICAgQ29udGVudCBvZiB0aGUgdGVtcGxhdGUuXG4gICAgICA8L3NjcmlwdD5cblxuICAgICAgPGEgbmctY2xpY2s9XCJjdXJyZW50VHBsPScvdHBsLmh0bWwnXCIgaWQ9XCJ0cGwtbGlua1wiPkxvYWQgaW5saW5lZCB0ZW1wbGF0ZTwvYT5cbiAgICAgIDxkaXYgaWQ9XCJ0cGwtY29udGVudFwiIG5nLWluY2x1ZGUgc3JjPVwiY3VycmVudFRwbFwiPjwvZGl2PlxuICAgIDwvZmlsZT5cbiAgICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICBpdCgnc2hvdWxkIGxvYWQgdGVtcGxhdGUgZGVmaW5lZCBpbnNpZGUgc2NyaXB0IHRhZycsIGZ1bmN0aW9uKCkge1xuICAgICAgICBlbGVtZW50KGJ5LmNzcygnI3RwbC1saW5rJykpLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChlbGVtZW50KGJ5LmNzcygnI3RwbC1jb250ZW50JykpLmdldFRleHQoKSkudG9NYXRjaCgvQ29udGVudCBvZiB0aGUgdGVtcGxhdGUvKTtcbiAgICAgIH0pO1xuICAgIDwvZmlsZT5cbiAgPC9leGFtcGxlPlxuICovXG52YXIgc2NyaXB0RGlyZWN0aXZlID0gWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICB0ZXJtaW5hbDogdHJ1ZSxcbiAgICBjb21waWxlOiBmdW5jdGlvbihlbGVtZW50LCBhdHRyKSB7XG4gICAgICBpZiAoYXR0ci50eXBlID09ICd0ZXh0L25nLXRlbXBsYXRlJykge1xuICAgICAgICB2YXIgdGVtcGxhdGVVcmwgPSBhdHRyLmlkLFxuICAgICAgICAgICAgdGV4dCA9IGVsZW1lbnRbMF0udGV4dDtcblxuICAgICAgICAkdGVtcGxhdGVDYWNoZS5wdXQodGVtcGxhdGVVcmwsIHRleHQpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1dO1xuXG52YXIgbm9vcE5nTW9kZWxDb250cm9sbGVyID0geyAkc2V0Vmlld1ZhbHVlOiBub29wLCAkcmVuZGVyOiBub29wIH07XG5cbmZ1bmN0aW9uIGNocm9tZUhhY2sob3B0aW9uRWxlbWVudCkge1xuICAvLyBXb3JrYXJvdW5kIGZvciBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MzgxNDU5XG4gIC8vIEFkZGluZyBhbiA8b3B0aW9uIHNlbGVjdGVkPVwic2VsZWN0ZWRcIj4gZWxlbWVudCB0byBhIDxzZWxlY3QgcmVxdWlyZWQ9XCJyZXF1aXJlZFwiPiBzaG91bGRcbiAgLy8gYXV0b21hdGljYWxseSBzZWxlY3QgdGhlIG5ldyBlbGVtZW50XG4gIGlmIChvcHRpb25FbGVtZW50WzBdLmhhc0F0dHJpYnV0ZSgnc2VsZWN0ZWQnKSkge1xuICAgIG9wdGlvbkVsZW1lbnRbMF0uc2VsZWN0ZWQgPSB0cnVlO1xuICB9XG59XG5cbi8qKlxuICogQG5nZG9jIHR5cGVcbiAqIEBuYW1lICBzZWxlY3QuU2VsZWN0Q29udHJvbGxlclxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGUgY29udHJvbGxlciBmb3IgdGhlIGA8c2VsZWN0PmAgZGlyZWN0aXZlLiBUaGlzIHByb3ZpZGVzIHN1cHBvcnQgZm9yIHJlYWRpbmdcbiAqIGFuZCB3cml0aW5nIHRoZSBzZWxlY3RlZCB2YWx1ZShzKSBvZiB0aGUgY29udHJvbCBhbmQgYWxzbyBjb29yZGluYXRlcyBkeW5hbWljYWxseVxuICogYWRkZWQgYDxvcHRpb24+YCBlbGVtZW50cywgcGVyaGFwcyBieSBhbiBgbmdSZXBlYXRgIGRpcmVjdGl2ZS5cbiAqL1xudmFyIFNlbGVjdENvbnRyb2xsZXIgPVxuICAgICAgICBbJyRlbGVtZW50JywgJyRzY29wZScsICckYXR0cnMnLCBmdW5jdGlvbigkZWxlbWVudCwgJHNjb3BlLCAkYXR0cnMpIHtcblxuICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICBvcHRpb25zTWFwID0gbmV3IEhhc2hNYXAoKTtcblxuICAvLyBJZiB0aGUgbmdNb2RlbCBkb2Vzbid0IGdldCBwcm92aWRlZCB0aGVuIHByb3ZpZGUgYSBkdW1teSBub29wIHZlcnNpb24gdG8gcHJldmVudCBlcnJvcnNcbiAgc2VsZi5uZ01vZGVsQ3RybCA9IG5vb3BOZ01vZGVsQ29udHJvbGxlcjtcblxuICAvLyBUaGUgXCJ1bmtub3duXCIgb3B0aW9uIGlzIG9uZSB0aGF0IGlzIHByZXBlbmRlZCB0byB0aGUgbGlzdCBpZiB0aGUgdmlld1ZhbHVlXG4gIC8vIGRvZXMgbm90IG1hdGNoIGFueSBvZiB0aGUgb3B0aW9ucy4gV2hlbiBpdCBpcyByZW5kZXJlZCB0aGUgdmFsdWUgb2YgdGhlIHVua25vd25cbiAgLy8gb3B0aW9uIGlzICc/IFhYWCA/JyB3aGVyZSBYWFggaXMgdGhlIGhhc2hLZXkgb2YgdGhlIHZhbHVlIHRoYXQgaXMgbm90IGtub3duLlxuICAvL1xuICAvLyBXZSBjYW4ndCBqdXN0IGpxTGl0ZSgnPG9wdGlvbj4nKSBzaW5jZSBqcUxpdGUgaXMgbm90IHNtYXJ0IGVub3VnaFxuICAvLyB0byBjcmVhdGUgaXQgaW4gPHNlbGVjdD4gYW5kIElFIGJhcmZzIG90aGVyd2lzZS5cbiAgc2VsZi51bmtub3duT3B0aW9uID0ganFMaXRlKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpKTtcbiAgc2VsZi5yZW5kZXJVbmtub3duT3B0aW9uID0gZnVuY3Rpb24odmFsKSB7XG4gICAgdmFyIHVua25vd25WYWwgPSAnPyAnICsgaGFzaEtleSh2YWwpICsgJyA/JztcbiAgICBzZWxmLnVua25vd25PcHRpb24udmFsKHVua25vd25WYWwpO1xuICAgICRlbGVtZW50LnByZXBlbmQoc2VsZi51bmtub3duT3B0aW9uKTtcbiAgICAkZWxlbWVudC52YWwodW5rbm93blZhbCk7XG4gIH07XG5cbiAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAvLyBkaXNhYmxlIHVua25vd24gb3B0aW9uIHNvIHRoYXQgd2UgZG9uJ3QgZG8gd29yayB3aGVuIHRoZSB3aG9sZSBzZWxlY3QgaXMgYmVpbmcgZGVzdHJveWVkXG4gICAgc2VsZi5yZW5kZXJVbmtub3duT3B0aW9uID0gbm9vcDtcbiAgfSk7XG5cbiAgc2VsZi5yZW1vdmVVbmtub3duT3B0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHNlbGYudW5rbm93bk9wdGlvbi5wYXJlbnQoKSkgc2VsZi51bmtub3duT3B0aW9uLnJlbW92ZSgpO1xuICB9O1xuXG5cbiAgLy8gUmVhZCB0aGUgdmFsdWUgb2YgdGhlIHNlbGVjdCBjb250cm9sLCB0aGUgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBjaGFuZ2VzIGRlcGVuZGluZ1xuICAvLyB1cG9uIHdoZXRoZXIgdGhlIHNlbGVjdCBjYW4gaGF2ZSBtdWx0aXBsZSB2YWx1ZXMgYW5kIHdoZXRoZXIgbmdPcHRpb25zIGlzIGF0IHdvcmsuXG4gIHNlbGYucmVhZFZhbHVlID0gZnVuY3Rpb24gcmVhZFNpbmdsZVZhbHVlKCkge1xuICAgIHNlbGYucmVtb3ZlVW5rbm93bk9wdGlvbigpO1xuICAgIHJldHVybiAkZWxlbWVudC52YWwoKTtcbiAgfTtcblxuXG4gIC8vIFdyaXRlIHRoZSB2YWx1ZSB0byB0aGUgc2VsZWN0IGNvbnRyb2wsIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIGNoYW5nZXMgZGVwZW5kaW5nXG4gIC8vIHVwb24gd2hldGhlciB0aGUgc2VsZWN0IGNhbiBoYXZlIG11bHRpcGxlIHZhbHVlcyBhbmQgd2hldGhlciBuZ09wdGlvbnMgaXMgYXQgd29yay5cbiAgc2VsZi53cml0ZVZhbHVlID0gZnVuY3Rpb24gd3JpdGVTaW5nbGVWYWx1ZSh2YWx1ZSkge1xuICAgIGlmIChzZWxmLmhhc09wdGlvbih2YWx1ZSkpIHtcbiAgICAgIHNlbGYucmVtb3ZlVW5rbm93bk9wdGlvbigpO1xuICAgICAgJGVsZW1lbnQudmFsKHZhbHVlKTtcbiAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHNlbGYuZW1wdHlPcHRpb24ucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTsgLy8gdG8gbWFrZSBJRTkgaGFwcHlcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHZhbHVlID09IG51bGwgJiYgc2VsZi5lbXB0eU9wdGlvbikge1xuICAgICAgICBzZWxmLnJlbW92ZVVua25vd25PcHRpb24oKTtcbiAgICAgICAgJGVsZW1lbnQudmFsKCcnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlbGYucmVuZGVyVW5rbm93bk9wdGlvbih2YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG5cbiAgLy8gVGVsbCB0aGUgc2VsZWN0IGNvbnRyb2wgdGhhdCBhbiBvcHRpb24sIHdpdGggdGhlIGdpdmVuIHZhbHVlLCBoYXMgYmVlbiBhZGRlZFxuICBzZWxmLmFkZE9wdGlvbiA9IGZ1bmN0aW9uKHZhbHVlLCBlbGVtZW50KSB7XG4gICAgLy8gU2tpcCBjb21tZW50IG5vZGVzLCBhcyB0aGV5IG9ubHkgcG9sbHV0ZSB0aGUgYG9wdGlvbnNNYXBgXG4gICAgaWYgKGVsZW1lbnRbMF0ubm9kZVR5cGUgPT09IE5PREVfVFlQRV9DT01NRU5UKSByZXR1cm47XG5cbiAgICBhc3NlcnROb3RIYXNPd25Qcm9wZXJ0eSh2YWx1ZSwgJ1wib3B0aW9uIHZhbHVlXCInKTtcbiAgICBpZiAodmFsdWUgPT09ICcnKSB7XG4gICAgICBzZWxmLmVtcHR5T3B0aW9uID0gZWxlbWVudDtcbiAgICB9XG4gICAgdmFyIGNvdW50ID0gb3B0aW9uc01hcC5nZXQodmFsdWUpIHx8IDA7XG4gICAgb3B0aW9uc01hcC5wdXQodmFsdWUsIGNvdW50ICsgMSk7XG4gICAgc2VsZi5uZ01vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgY2hyb21lSGFjayhlbGVtZW50KTtcbiAgfTtcblxuICAvLyBUZWxsIHRoZSBzZWxlY3QgY29udHJvbCB0aGF0IGFuIG9wdGlvbiwgd2l0aCB0aGUgZ2l2ZW4gdmFsdWUsIGhhcyBiZWVuIHJlbW92ZWRcbiAgc2VsZi5yZW1vdmVPcHRpb24gPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIHZhciBjb3VudCA9IG9wdGlvbnNNYXAuZ2V0KHZhbHVlKTtcbiAgICBpZiAoY291bnQpIHtcbiAgICAgIGlmIChjb3VudCA9PT0gMSkge1xuICAgICAgICBvcHRpb25zTWFwLnJlbW92ZSh2YWx1ZSk7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHtcbiAgICAgICAgICBzZWxmLmVtcHR5T3B0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvcHRpb25zTWFwLnB1dCh2YWx1ZSwgY291bnQgLSAxKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy8gQ2hlY2sgd2hldGhlciB0aGUgc2VsZWN0IGNvbnRyb2wgaGFzIGFuIG9wdGlvbiBtYXRjaGluZyB0aGUgZ2l2ZW4gdmFsdWVcbiAgc2VsZi5oYXNPcHRpb24gPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIHJldHVybiAhIW9wdGlvbnNNYXAuZ2V0KHZhbHVlKTtcbiAgfTtcblxuXG4gIHNlbGYucmVnaXN0ZXJPcHRpb24gPSBmdW5jdGlvbihvcHRpb25TY29wZSwgb3B0aW9uRWxlbWVudCwgb3B0aW9uQXR0cnMsIGludGVycG9sYXRlVmFsdWVGbiwgaW50ZXJwb2xhdGVUZXh0Rm4pIHtcblxuICAgIGlmIChpbnRlcnBvbGF0ZVZhbHVlRm4pIHtcbiAgICAgIC8vIFRoZSB2YWx1ZSBhdHRyaWJ1dGUgaXMgaW50ZXJwb2xhdGVkXG4gICAgICB2YXIgb2xkVmFsO1xuICAgICAgb3B0aW9uQXR0cnMuJG9ic2VydmUoJ3ZhbHVlJywgZnVuY3Rpb24gdmFsdWVBdHRyaWJ1dGVPYnNlcnZlQWN0aW9uKG5ld1ZhbCkge1xuICAgICAgICBpZiAoaXNEZWZpbmVkKG9sZFZhbCkpIHtcbiAgICAgICAgICBzZWxmLnJlbW92ZU9wdGlvbihvbGRWYWwpO1xuICAgICAgICB9XG4gICAgICAgIG9sZFZhbCA9IG5ld1ZhbDtcbiAgICAgICAgc2VsZi5hZGRPcHRpb24obmV3VmFsLCBvcHRpb25FbGVtZW50KTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoaW50ZXJwb2xhdGVUZXh0Rm4pIHtcbiAgICAgIC8vIFRoZSB0ZXh0IGNvbnRlbnQgaXMgaW50ZXJwb2xhdGVkXG4gICAgICBvcHRpb25TY29wZS4kd2F0Y2goaW50ZXJwb2xhdGVUZXh0Rm4sIGZ1bmN0aW9uIGludGVycG9sYXRlV2F0Y2hBY3Rpb24obmV3VmFsLCBvbGRWYWwpIHtcbiAgICAgICAgb3B0aW9uQXR0cnMuJHNldCgndmFsdWUnLCBuZXdWYWwpO1xuICAgICAgICBpZiAob2xkVmFsICE9PSBuZXdWYWwpIHtcbiAgICAgICAgICBzZWxmLnJlbW92ZU9wdGlvbihvbGRWYWwpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuYWRkT3B0aW9uKG5ld1ZhbCwgb3B0aW9uRWxlbWVudCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVGhlIHZhbHVlIGF0dHJpYnV0ZSBpcyBzdGF0aWNcbiAgICAgIHNlbGYuYWRkT3B0aW9uKG9wdGlvbkF0dHJzLnZhbHVlLCBvcHRpb25FbGVtZW50KTtcbiAgICB9XG5cbiAgICBvcHRpb25FbGVtZW50Lm9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xuICAgICAgc2VsZi5yZW1vdmVPcHRpb24ob3B0aW9uQXR0cnMudmFsdWUpO1xuICAgICAgc2VsZi5uZ01vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgfSk7XG4gIH07XG59XTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBzZWxlY3RcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBIVE1MIGBTRUxFQ1RgIGVsZW1lbnQgd2l0aCBhbmd1bGFyIGRhdGEtYmluZGluZy5cbiAqXG4gKiBUaGUgYHNlbGVjdGAgZGlyZWN0aXZlIGlzIHVzZWQgdG9nZXRoZXIgd2l0aCB7QGxpbmsgbmdNb2RlbCBgbmdNb2RlbGB9IHRvIHByb3ZpZGUgZGF0YS1iaW5kaW5nXG4gKiBiZXR3ZWVuIHRoZSBzY29wZSBhbmQgdGhlIGA8c2VsZWN0PmAgY29udHJvbCAoaW5jbHVkaW5nIHNldHRpbmcgZGVmYXVsdCB2YWx1ZXMpLlxuICogSXQgYWxzbyBoYW5kbGVzIGR5bmFtaWMgYDxvcHRpb24+YCBlbGVtZW50cywgd2hpY2ggY2FuIGJlIGFkZGVkIHVzaW5nIHRoZSB7QGxpbmsgbmdSZXBlYXQgYG5nUmVwZWF0fWAgb3JcbiAqIHtAbGluayBuZ09wdGlvbnMgYG5nT3B0aW9uc2B9IGRpcmVjdGl2ZXMuXG4gKlxuICogV2hlbiBhbiBpdGVtIGluIHRoZSBgPHNlbGVjdD5gIG1lbnUgaXMgc2VsZWN0ZWQsIHRoZSB2YWx1ZSBvZiB0aGUgc2VsZWN0ZWQgb3B0aW9uIHdpbGwgYmUgYm91bmRcbiAqIHRvIHRoZSBtb2RlbCBpZGVudGlmaWVkIGJ5IHRoZSBgbmdNb2RlbGAgZGlyZWN0aXZlLiBXaXRoIHN0YXRpYyBvciByZXBlYXRlZCBvcHRpb25zLCB0aGlzIGlzXG4gKiB0aGUgY29udGVudCBvZiB0aGUgYHZhbHVlYCBhdHRyaWJ1dGUgb3IgdGhlIHRleHRDb250ZW50IG9mIHRoZSBgPG9wdGlvbj5gLCBpZiB0aGUgdmFsdWUgYXR0cmlidXRlIGlzIG1pc3NpbmcuXG4gKiBJZiB5b3Ugd2FudCBkeW5hbWljIHZhbHVlIGF0dHJpYnV0ZXMsIHlvdSBjYW4gdXNlIGludGVycG9sYXRpb24gaW5zaWRlIHRoZSB2YWx1ZSBhdHRyaWJ1dGUuXG4gKlxuICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj5cbiAqIE5vdGUgdGhhdCB0aGUgdmFsdWUgb2YgYSBgc2VsZWN0YCBkaXJlY3RpdmUgdXNlZCB3aXRob3V0IGBuZ09wdGlvbnNgIGlzIGFsd2F5cyBhIHN0cmluZy5cbiAqIFdoZW4gdGhlIG1vZGVsIG5lZWRzIHRvIGJlIGJvdW5kIHRvIGEgbm9uLXN0cmluZyB2YWx1ZSwgeW91IG11c3QgZWl0aGVyIGV4cGxpY2l0bHkgY29udmVydCBpdFxuICogdXNpbmcgYSBkaXJlY3RpdmUgKHNlZSBleGFtcGxlIGJlbG93KSBvciB1c2UgYG5nT3B0aW9uc2AgdG8gc3BlY2lmeSB0aGUgc2V0IG9mIG9wdGlvbnMuXG4gKiBUaGlzIGlzIGJlY2F1c2UgYW4gb3B0aW9uIGVsZW1lbnQgY2FuIG9ubHkgYmUgYm91bmQgdG8gc3RyaW5nIHZhbHVlcyBhdCBwcmVzZW50LlxuICogPC9kaXY+XG4gKlxuICogSWYgdGhlIHZpZXdWYWx1ZSBvZiBgbmdNb2RlbGAgZG9lcyBub3QgbWF0Y2ggYW55IG9mIHRoZSBvcHRpb25zLCB0aGVuIHRoZSBjb250cm9sXG4gKiB3aWxsIGF1dG9tYXRpY2FsbHkgYWRkIGFuIFwidW5rbm93blwiIG9wdGlvbiwgd2hpY2ggaXQgdGhlbiByZW1vdmVzIHdoZW4gdGhlIG1pc21hdGNoIGlzIHJlc29sdmVkLlxuICpcbiAqIE9wdGlvbmFsbHksIGEgc2luZ2xlIGhhcmQtY29kZWQgYDxvcHRpb24+YCBlbGVtZW50LCB3aXRoIHRoZSB2YWx1ZSBzZXQgdG8gYW4gZW1wdHkgc3RyaW5nLCBjYW5cbiAqIGJlIG5lc3RlZCBpbnRvIHRoZSBgPHNlbGVjdD5gIGVsZW1lbnQuIFRoaXMgZWxlbWVudCB3aWxsIHRoZW4gcmVwcmVzZW50IHRoZSBgbnVsbGAgb3IgXCJub3Qgc2VsZWN0ZWRcIlxuICogb3B0aW9uLiBTZWUgZXhhbXBsZSBiZWxvdyBmb3IgZGVtb25zdHJhdGlvbi5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtaW5mb1wiPlxuICogSW4gbWFueSBjYXNlcywgYG5nUmVwZWF0YCBjYW4gYmUgdXNlZCBvbiBgPG9wdGlvbj5gIGVsZW1lbnRzIGluc3RlYWQgb2Yge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ09wdGlvbnNcbiAqIG5nT3B0aW9uc30gdG8gYWNoaWV2ZSBhIHNpbWlsYXIgcmVzdWx0LiBIb3dldmVyLCBgbmdPcHRpb25zYCBwcm92aWRlcyBzb21lIGJlbmVmaXRzLCBzdWNoIGFzXG4gKiBtb3JlIGZsZXhpYmlsaXR5IGluIGhvdyB0aGUgYDxzZWxlY3Q+YCdzIG1vZGVsIGlzIGFzc2lnbmVkIHZpYSB0aGUgYHNlbGVjdGAgKipgYXNgKiogcGFydCBvZiB0aGVcbiAqIGNvbXByZWhlbnNpb24gZXhwcmVzc2lvbiwgYW5kIGFkZGl0aW9uYWxseSBpbiByZWR1Y2luZyBtZW1vcnkgYW5kIGluY3JlYXNpbmcgc3BlZWQgYnkgbm90IGNyZWF0aW5nXG4gKiBhIG5ldyBzY29wZSBmb3IgZWFjaCByZXBlYXRlZCBpbnN0YW5jZS5cbiAqIDwvZGl2PlxuICpcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmdNb2RlbCBBc3NpZ25hYmxlIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBkYXRhLWJpbmQgdG8uXG4gKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXG4gKiBAcGFyYW0ge3N0cmluZz19IG11bHRpcGxlIEFsbG93cyBtdWx0aXBsZSBvcHRpb25zIHRvIGJlIHNlbGVjdGVkLiBUaGUgc2VsZWN0ZWQgdmFsdWVzIHdpbGwgYmVcbiAqICAgICBib3VuZCB0byB0aGUgbW9kZWwgYXMgYW4gYXJyYXkuXG4gKiBAcGFyYW0ge3N0cmluZz19IHJlcXVpcmVkIFNldHMgYHJlcXVpcmVkYCB2YWxpZGF0aW9uIGVycm9yIGtleSBpZiB0aGUgdmFsdWUgaXMgbm90IGVudGVyZWQuXG4gKiBAcGFyYW0ge3N0cmluZz19IG5nUmVxdWlyZWQgQWRkcyByZXF1aXJlZCBhdHRyaWJ1dGUgYW5kIHJlcXVpcmVkIHZhbGlkYXRpb24gY29uc3RyYWludCB0b1xuICogdGhlIGVsZW1lbnQgd2hlbiB0aGUgbmdSZXF1aXJlZCBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLiBVc2UgbmdSZXF1aXJlZCBpbnN0ZWFkIG9mIHJlcXVpcmVkXG4gKiB3aGVuIHlvdSB3YW50IHRvIGRhdGEtYmluZCB0byB0aGUgcmVxdWlyZWQgYXR0cmlidXRlLlxuICogQHBhcmFtIHtzdHJpbmc9fSBuZ0NoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBzZWxlY3RlZCBvcHRpb24ocykgY2hhbmdlcyBkdWUgdG8gdXNlclxuICogICAgaW50ZXJhY3Rpb24gd2l0aCB0aGUgc2VsZWN0IGVsZW1lbnQuXG4gKiBAcGFyYW0ge3N0cmluZz19IG5nT3B0aW9ucyBzZXRzIHRoZSBvcHRpb25zIHRoYXQgdGhlIHNlbGVjdCBpcyBwb3B1bGF0ZWQgd2l0aCBhbmQgZGVmaW5lcyB3aGF0IGlzXG4gKiBzZXQgb24gdGhlIG1vZGVsIG9uIHNlbGVjdGlvbi4gU2VlIHtAbGluayBuZ09wdGlvbnMgYG5nT3B0aW9uc2B9LlxuICpcbiAqIEBleGFtcGxlXG4gKiAjIyMgU2ltcGxlIGBzZWxlY3RgIGVsZW1lbnRzIHdpdGggc3RhdGljIG9wdGlvbnNcbiAqXG4gKiA8ZXhhbXBsZSBuYW1lPVwic3RhdGljLXNlbGVjdFwiIG1vZHVsZT1cInN0YXRpY1NlbGVjdFwiPlxuICogPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAqIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gKiAgIDxmb3JtIG5hbWU9XCJteUZvcm1cIj5cbiAqICAgICA8bGFiZWwgZm9yPVwic2luZ2xlU2VsZWN0XCI+IFNpbmdsZSBzZWxlY3Q6IDwvbGFiZWw+PGJyPlxuICogICAgIDxzZWxlY3QgbmFtZT1cInNpbmdsZVNlbGVjdFwiIG5nLW1vZGVsPVwiZGF0YS5zaW5nbGVTZWxlY3RcIj5cbiAqICAgICAgIDxvcHRpb24gdmFsdWU9XCJvcHRpb24tMVwiPk9wdGlvbiAxPC9vcHRpb24+XG4gKiAgICAgICA8b3B0aW9uIHZhbHVlPVwib3B0aW9uLTJcIj5PcHRpb24gMjwvb3B0aW9uPlxuICogICAgIDwvc2VsZWN0Pjxicj5cbiAqXG4gKiAgICAgPGxhYmVsIGZvcj1cInNpbmdsZVNlbGVjdFwiPiBTaW5nbGUgc2VsZWN0IHdpdGggXCJub3Qgc2VsZWN0ZWRcIiBvcHRpb24gYW5kIGR5bmFtaWMgb3B0aW9uIHZhbHVlczogPC9sYWJlbD48YnI+XG4gKiAgICAgPHNlbGVjdCBuYW1lPVwic2luZ2xlU2VsZWN0XCIgaWQ9XCJzaW5nbGVTZWxlY3RcIiBuZy1tb2RlbD1cImRhdGEuc2luZ2xlU2VsZWN0XCI+XG4gKiAgICAgICA8b3B0aW9uIHZhbHVlPVwiXCI+LS0tUGxlYXNlIHNlbGVjdC0tLTwvb3B0aW9uPiA8IS0tIG5vdCBzZWxlY3RlZCAvIGJsYW5rIG9wdGlvbiAtLT5cbiAqICAgICAgIDxvcHRpb24gdmFsdWU9XCJ7e2RhdGEub3B0aW9uMX19XCI+T3B0aW9uIDE8L29wdGlvbj4gPCEtLSBpbnRlcnBvbGF0aW9uIC0tPlxuICogICAgICAgPG9wdGlvbiB2YWx1ZT1cIm9wdGlvbi0yXCI+T3B0aW9uIDI8L29wdGlvbj5cbiAqICAgICA8L3NlbGVjdD48YnI+XG4gKiAgICAgPGJ1dHRvbiBuZy1jbGljaz1cImZvcmNlVW5rbm93bk9wdGlvbigpXCI+Rm9yY2UgdW5rbm93biBvcHRpb248L2J1dHRvbj48YnI+XG4gKiAgICAgPHR0PnNpbmdsZVNlbGVjdCA9IHt7ZGF0YS5zaW5nbGVTZWxlY3R9fTwvdHQ+XG4gKlxuICogICAgIDxocj5cbiAqICAgICA8bGFiZWwgZm9yPVwibXVsdGlwbGVTZWxlY3RcIj4gTXVsdGlwbGUgc2VsZWN0OiA8L2xhYmVsPjxicj5cbiAqICAgICA8c2VsZWN0IG5hbWU9XCJtdWx0aXBsZVNlbGVjdFwiIGlkPVwibXVsdGlwbGVTZWxlY3RcIiBuZy1tb2RlbD1cImRhdGEubXVsdGlwbGVTZWxlY3RcIiBtdWx0aXBsZT5cbiAqICAgICAgIDxvcHRpb24gdmFsdWU9XCJvcHRpb24tMVwiPk9wdGlvbiAxPC9vcHRpb24+XG4gKiAgICAgICA8b3B0aW9uIHZhbHVlPVwib3B0aW9uLTJcIj5PcHRpb24gMjwvb3B0aW9uPlxuICogICAgICAgPG9wdGlvbiB2YWx1ZT1cIm9wdGlvbi0zXCI+T3B0aW9uIDM8L29wdGlvbj5cbiAqICAgICA8L3NlbGVjdD48YnI+XG4gKiAgICAgPHR0Pm11bHRpcGxlU2VsZWN0ID0ge3tkYXRhLm11bHRpcGxlU2VsZWN0fX08L3R0Pjxici8+XG4gKiAgIDwvZm9ybT5cbiAqIDwvZGl2PlxuICogPC9maWxlPlxuICogPGZpbGUgbmFtZT1cImFwcC5qc1wiPlxuICogIGFuZ3VsYXIubW9kdWxlKCdzdGF0aWNTZWxlY3QnLCBbXSlcbiAqICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gKiAgICAgICRzY29wZS5kYXRhID0ge1xuICogICAgICAgc2luZ2xlU2VsZWN0OiBudWxsLFxuICogICAgICAgbXVsdGlwbGVTZWxlY3Q6IFtdLFxuICogICAgICAgb3B0aW9uMTogJ29wdGlvbi0xJyxcbiAqICAgICAgfTtcbiAqXG4gKiAgICAgICRzY29wZS5mb3JjZVVua25vd25PcHRpb24gPSBmdW5jdGlvbigpIHtcbiAqICAgICAgICAkc2NvcGUuZGF0YS5zaW5nbGVTZWxlY3QgPSAnbm9uc2Vuc2UnO1xuICogICAgICB9O1xuICogICB9XSk7XG4gKiA8L2ZpbGU+XG4gKjwvZXhhbXBsZT5cbiAqXG4gKiAjIyMgVXNpbmcgYG5nUmVwZWF0YCB0byBnZW5lcmF0ZSBgc2VsZWN0YCBvcHRpb25zXG4gKiA8ZXhhbXBsZSBuYW1lPVwibmdyZXBlYXQtc2VsZWN0XCIgbW9kdWxlPVwibmdyZXBlYXRTZWxlY3RcIj5cbiAqIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gKiA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICogICA8Zm9ybSBuYW1lPVwibXlGb3JtXCI+XG4gKiAgICAgPGxhYmVsIGZvcj1cInJlcGVhdFNlbGVjdFwiPiBSZXBlYXQgc2VsZWN0OiA8L2xhYmVsPlxuICogICAgIDxzZWxlY3QgbmFtZT1cInJlcGVhdFNlbGVjdFwiIGlkPVwicmVwZWF0U2VsZWN0XCIgbmctbW9kZWw9XCJkYXRhLnJlcGVhdFNlbGVjdFwiPlxuICogICAgICAgPG9wdGlvbiBuZy1yZXBlYXQ9XCJvcHRpb24gaW4gZGF0YS5hdmFpbGFibGVPcHRpb25zXCIgdmFsdWU9XCJ7e29wdGlvbi5pZH19XCI+e3tvcHRpb24ubmFtZX19PC9vcHRpb24+XG4gKiAgICAgPC9zZWxlY3Q+XG4gKiAgIDwvZm9ybT5cbiAqICAgPGhyPlxuICogICA8dHQ+cmVwZWF0U2VsZWN0ID0ge3tkYXRhLnJlcGVhdFNlbGVjdH19PC90dD48YnIvPlxuICogPC9kaXY+XG4gKiA8L2ZpbGU+XG4gKiA8ZmlsZSBuYW1lPVwiYXBwLmpzXCI+XG4gKiAgYW5ndWxhci5tb2R1bGUoJ25ncmVwZWF0U2VsZWN0JywgW10pXG4gKiAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICogICAgICAkc2NvcGUuZGF0YSA9IHtcbiAqICAgICAgIHJlcGVhdFNlbGVjdDogbnVsbCxcbiAqICAgICAgIGF2YWlsYWJsZU9wdGlvbnM6IFtcbiAqICAgICAgICAge2lkOiAnMScsIG5hbWU6ICdPcHRpb24gQSd9LFxuICogICAgICAgICB7aWQ6ICcyJywgbmFtZTogJ09wdGlvbiBCJ30sXG4gKiAgICAgICAgIHtpZDogJzMnLCBuYW1lOiAnT3B0aW9uIEMnfVxuICogICAgICAgXSxcbiAqICAgICAgfTtcbiAqICAgfV0pO1xuICogPC9maWxlPlxuICo8L2V4YW1wbGU+XG4gKlxuICpcbiAqICMjIyBVc2luZyBgc2VsZWN0YCB3aXRoIGBuZ09wdGlvbnNgIGFuZCBzZXR0aW5nIGEgZGVmYXVsdCB2YWx1ZVxuICogU2VlIHRoZSB7QGxpbmsgbmdPcHRpb25zIG5nT3B0aW9ucyBkb2N1bWVudGF0aW9ufSBmb3IgbW9yZSBgbmdPcHRpb25zYCB1c2FnZSBleGFtcGxlcy5cbiAqXG4gKiA8ZXhhbXBsZSBuYW1lPVwic2VsZWN0LXdpdGgtZGVmYXVsdC12YWx1ZXNcIiBtb2R1bGU9XCJkZWZhdWx0VmFsdWVTZWxlY3RcIj5cbiAqIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gKiA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICogICA8Zm9ybSBuYW1lPVwibXlGb3JtXCI+XG4gKiAgICAgPGxhYmVsIGZvcj1cIm15U2VsZWN0XCI+TWFrZSBhIGNob2ljZTo8L2xhYmVsPlxuICogICAgIDxzZWxlY3QgbmFtZT1cIm15U2VsZWN0XCIgaWQ9XCJteVNlbGVjdFwiXG4gKiAgICAgICBuZy1vcHRpb25zPVwib3B0aW9uLm5hbWUgZm9yIG9wdGlvbiBpbiBkYXRhLmF2YWlsYWJsZU9wdGlvbnMgdHJhY2sgYnkgb3B0aW9uLmlkXCJcbiAqICAgICAgIG5nLW1vZGVsPVwiZGF0YS5zZWxlY3RlZE9wdGlvblwiPjwvc2VsZWN0PlxuICogICA8L2Zvcm0+XG4gKiAgIDxocj5cbiAqICAgPHR0Pm9wdGlvbiA9IHt7ZGF0YS5zZWxlY3RlZE9wdGlvbn19PC90dD48YnIvPlxuICogPC9kaXY+XG4gKiA8L2ZpbGU+XG4gKiA8ZmlsZSBuYW1lPVwiYXBwLmpzXCI+XG4gKiAgYW5ndWxhci5tb2R1bGUoJ2RlZmF1bHRWYWx1ZVNlbGVjdCcsIFtdKVxuICogICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAqICAgICAgJHNjb3BlLmRhdGEgPSB7XG4gKiAgICAgICBhdmFpbGFibGVPcHRpb25zOiBbXG4gKiAgICAgICAgIHtpZDogJzEnLCBuYW1lOiAnT3B0aW9uIEEnfSxcbiAqICAgICAgICAge2lkOiAnMicsIG5hbWU6ICdPcHRpb24gQid9LFxuICogICAgICAgICB7aWQ6ICczJywgbmFtZTogJ09wdGlvbiBDJ31cbiAqICAgICAgIF0sXG4gKiAgICAgICBzZWxlY3RlZE9wdGlvbjoge2lkOiAnMycsIG5hbWU6ICdPcHRpb24gQyd9IC8vVGhpcyBzZXRzIHRoZSBkZWZhdWx0IHZhbHVlIG9mIHRoZSBzZWxlY3QgaW4gdGhlIHVpXG4gKiAgICAgICB9O1xuICogICB9XSk7XG4gKiA8L2ZpbGU+XG4gKjwvZXhhbXBsZT5cbiAqXG4gKlxuICogIyMjIEJpbmRpbmcgYHNlbGVjdGAgdG8gYSBub24tc3RyaW5nIHZhbHVlIHZpYSBgbmdNb2RlbGAgcGFyc2luZyAvIGZvcm1hdHRpbmdcbiAqXG4gKiA8ZXhhbXBsZSBuYW1lPVwic2VsZWN0LXdpdGgtbm9uLXN0cmluZy1vcHRpb25zXCIgbW9kdWxlPVwibm9uU3RyaW5nU2VsZWN0XCI+XG4gKiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gKiAgICAgPHNlbGVjdCBuZy1tb2RlbD1cIm1vZGVsLmlkXCIgY29udmVydC10by1udW1iZXI+XG4gKiAgICAgICA8b3B0aW9uIHZhbHVlPVwiMFwiPlplcm88L29wdGlvbj5cbiAqICAgICAgIDxvcHRpb24gdmFsdWU9XCIxXCI+T25lPC9vcHRpb24+XG4gKiAgICAgICA8b3B0aW9uIHZhbHVlPVwiMlwiPlR3bzwvb3B0aW9uPlxuICogICAgIDwvc2VsZWN0PlxuICogICAgIHt7IG1vZGVsIH19XG4gKiAgIDwvZmlsZT5cbiAqICAgPGZpbGUgbmFtZT1cImFwcC5qc1wiPlxuICogICAgIGFuZ3VsYXIubW9kdWxlKCdub25TdHJpbmdTZWxlY3QnLCBbXSlcbiAqICAgICAgIC5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSkge1xuICogICAgICAgICAkcm9vdFNjb3BlLm1vZGVsID0geyBpZDogMiB9O1xuICogICAgICAgfSlcbiAqICAgICAgIC5kaXJlY3RpdmUoJ2NvbnZlcnRUb051bWJlcicsIGZ1bmN0aW9uKCkge1xuICogICAgICAgICByZXR1cm4ge1xuICogICAgICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcbiAqICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcbiAqICAgICAgICAgICAgIG5nTW9kZWwuJHBhcnNlcnMucHVzaChmdW5jdGlvbih2YWwpIHtcbiAqICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHZhbCwgMTApO1xuICogICAgICAgICAgICAgfSk7XG4gKiAgICAgICAgICAgICBuZ01vZGVsLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24odmFsKSB7XG4gKiAgICAgICAgICAgICAgIHJldHVybiAnJyArIHZhbDtcbiAqICAgICAgICAgICAgIH0pO1xuICogICAgICAgICAgIH1cbiAqICAgICAgICAgfTtcbiAqICAgICAgIH0pO1xuICogICA8L2ZpbGU+XG4gKiAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAqICAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgdG8gbW9kZWwnLCBmdW5jdGlvbigpIHtcbiAqICAgICAgIHZhciBzZWxlY3QgPSBlbGVtZW50KGJ5LmNzcygnc2VsZWN0JykpO1xuICogICAgICAgZXhwZWN0KGVsZW1lbnQoYnkubW9kZWwoJ21vZGVsLmlkJykpLiQoJ29wdGlvbjpjaGVja2VkJykuZ2V0VGV4dCgpKS50b0VxdWFsKCdUd28nKTtcbiAqICAgICB9KTtcbiAqICAgPC9maWxlPlxuICogPC9leGFtcGxlPlxuICpcbiAqL1xudmFyIHNlbGVjdERpcmVjdGl2ZSA9IGZ1bmN0aW9uKCkge1xuXG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICByZXF1aXJlOiBbJ3NlbGVjdCcsICc/bmdNb2RlbCddLFxuICAgIGNvbnRyb2xsZXI6IFNlbGVjdENvbnRyb2xsZXIsXG4gICAgcHJpb3JpdHk6IDEsXG4gICAgbGluazoge1xuICAgICAgcHJlOiBzZWxlY3RQcmVMaW5rLFxuICAgICAgcG9zdDogc2VsZWN0UG9zdExpbmtcbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gc2VsZWN0UHJlTGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHMpIHtcblxuICAgICAgLy8gaWYgbmdNb2RlbCBpcyBub3QgZGVmaW5lZCwgd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZ1xuICAgICAgdmFyIG5nTW9kZWxDdHJsID0gY3RybHNbMV07XG4gICAgICBpZiAoIW5nTW9kZWxDdHJsKSByZXR1cm47XG5cbiAgICAgIHZhciBzZWxlY3RDdHJsID0gY3RybHNbMF07XG5cbiAgICAgIHNlbGVjdEN0cmwubmdNb2RlbEN0cmwgPSBuZ01vZGVsQ3RybDtcblxuICAgICAgLy8gV2hlbiB0aGUgc2VsZWN0ZWQgaXRlbShzKSBjaGFuZ2VzIHdlIGRlbGVnYXRlIGdldHRpbmcgdGhlIHZhbHVlIG9mIHRoZSBzZWxlY3QgY29udHJvbFxuICAgICAgLy8gdG8gdGhlIGByZWFkVmFsdWVgIG1ldGhvZCwgd2hpY2ggY2FuIGJlIGNoYW5nZWQgaWYgdGhlIHNlbGVjdCBjYW4gaGF2ZSBtdWx0aXBsZVxuICAgICAgLy8gc2VsZWN0ZWQgdmFsdWVzIG9yIGlmIHRoZSBvcHRpb25zIGFyZSBiZWluZyBnZW5lcmF0ZWQgYnkgYG5nT3B0aW9uc2BcbiAgICAgIGVsZW1lbnQub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZShzZWxlY3RDdHJsLnJlYWRWYWx1ZSgpKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gSWYgdGhlIHNlbGVjdCBhbGxvd3MgbXVsdGlwbGUgdmFsdWVzIHRoZW4gd2UgbmVlZCB0byBtb2RpZnkgaG93IHdlIHJlYWQgYW5kIHdyaXRlXG4gICAgICAvLyB2YWx1ZXMgZnJvbSBhbmQgdG8gdGhlIGNvbnRyb2w7IGFsc28gd2hhdCBpdCBtZWFucyBmb3IgdGhlIHZhbHVlIHRvIGJlIGVtcHR5IGFuZFxuICAgICAgLy8gd2UgaGF2ZSB0byBhZGQgYW4gZXh0cmEgd2F0Y2ggc2luY2UgbmdNb2RlbCBkb2Vzbid0IHdvcmsgd2VsbCB3aXRoIGFycmF5cyAtIGl0XG4gICAgICAvLyBkb2Vzbid0IHRyaWdnZXIgcmVuZGVyaW5nIGlmIG9ubHkgYW4gaXRlbSBpbiB0aGUgYXJyYXkgY2hhbmdlcy5cbiAgICAgIGlmIChhdHRyLm11bHRpcGxlKSB7XG5cbiAgICAgICAgLy8gUmVhZCB2YWx1ZSBub3cgbmVlZHMgdG8gY2hlY2sgZWFjaCBvcHRpb24gdG8gc2VlIGlmIGl0IGlzIHNlbGVjdGVkXG4gICAgICAgIHNlbGVjdEN0cmwucmVhZFZhbHVlID0gZnVuY3Rpb24gcmVhZE11bHRpcGxlVmFsdWUoKSB7XG4gICAgICAgICAgdmFyIGFycmF5ID0gW107XG4gICAgICAgICAgZm9yRWFjaChlbGVtZW50LmZpbmQoJ29wdGlvbicpLCBmdW5jdGlvbihvcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChvcHRpb24uc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgYXJyYXkucHVzaChvcHRpb24udmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBhcnJheTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBXcml0ZSB2YWx1ZSBub3cgbmVlZHMgdG8gc2V0IHRoZSBzZWxlY3RlZCBwcm9wZXJ0eSBvZiBlYWNoIG1hdGNoaW5nIG9wdGlvblxuICAgICAgICBzZWxlY3RDdHJsLndyaXRlVmFsdWUgPSBmdW5jdGlvbiB3cml0ZU11bHRpcGxlVmFsdWUodmFsdWUpIHtcbiAgICAgICAgICB2YXIgaXRlbXMgPSBuZXcgSGFzaE1hcCh2YWx1ZSk7XG4gICAgICAgICAgZm9yRWFjaChlbGVtZW50LmZpbmQoJ29wdGlvbicpLCBmdW5jdGlvbihvcHRpb24pIHtcbiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IGlzRGVmaW5lZChpdGVtcy5nZXQob3B0aW9uLnZhbHVlKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gd2UgaGF2ZSB0byBkbyBpdCBvbiBlYWNoIHdhdGNoIHNpbmNlIG5nTW9kZWwgd2F0Y2hlcyByZWZlcmVuY2UsIGJ1dFxuICAgICAgICAvLyB3ZSBuZWVkIHRvIHdvcmsgb2YgYW4gYXJyYXksIHNvIHdlIG5lZWQgdG8gc2VlIGlmIGFueXRoaW5nIHdhcyBpbnNlcnRlZC9yZW1vdmVkXG4gICAgICAgIHZhciBsYXN0VmlldywgbGFzdFZpZXdSZWYgPSBOYU47XG4gICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiBzZWxlY3RNdWx0aXBsZVdhdGNoKCkge1xuICAgICAgICAgIGlmIChsYXN0Vmlld1JlZiA9PT0gbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSAmJiAhZXF1YWxzKGxhc3RWaWV3LCBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlKSkge1xuICAgICAgICAgICAgbGFzdFZpZXcgPSBzaGFsbG93Q29weShuZ01vZGVsQ3RybC4kdmlld1ZhbHVlKTtcbiAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbGFzdFZpZXdSZWYgPSBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBJZiB3ZSBhcmUgYSBtdWx0aXBsZSBzZWxlY3QgdGhlbiB2YWx1ZSBpcyBub3cgYSBjb2xsZWN0aW9uXG4gICAgICAgIC8vIHNvIHRoZSBtZWFuaW5nIG9mICRpc0VtcHR5IGNoYW5nZXNcbiAgICAgICAgbmdNb2RlbEN0cmwuJGlzRW1wdHkgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiAhdmFsdWUgfHwgdmFsdWUubGVuZ3RoID09PSAwO1xuICAgICAgICB9O1xuXG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VsZWN0UG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJscykge1xuICAgICAgLy8gaWYgbmdNb2RlbCBpcyBub3QgZGVmaW5lZCwgd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZ1xuICAgICAgdmFyIG5nTW9kZWxDdHJsID0gY3RybHNbMV07XG4gICAgICBpZiAoIW5nTW9kZWxDdHJsKSByZXR1cm47XG5cbiAgICAgIHZhciBzZWxlY3RDdHJsID0gY3RybHNbMF07XG5cbiAgICAgIC8vIFdlIGRlbGVnYXRlIHJlbmRlcmluZyB0byB0aGUgYHdyaXRlVmFsdWVgIG1ldGhvZCwgd2hpY2ggY2FuIGJlIGNoYW5nZWRcbiAgICAgIC8vIGlmIHRoZSBzZWxlY3QgY2FuIGhhdmUgbXVsdGlwbGUgc2VsZWN0ZWQgdmFsdWVzIG9yIGlmIHRoZSBvcHRpb25zIGFyZSBiZWluZ1xuICAgICAgLy8gZ2VuZXJhdGVkIGJ5IGBuZ09wdGlvbnNgLlxuICAgICAgLy8gVGhpcyBtdXN0IGJlIGRvbmUgaW4gdGhlIHBvc3RMaW5rIGZuIHRvIHByZXZlbnQgJHJlbmRlciB0byBiZSBjYWxsZWQgYmVmb3JlXG4gICAgICAvLyBhbGwgbm9kZXMgaGF2ZSBiZWVuIGxpbmtlZCBjb3JyZWN0bHkuXG4gICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlbGVjdEN0cmwud3JpdGVWYWx1ZShuZ01vZGVsQ3RybC4kdmlld1ZhbHVlKTtcbiAgICAgIH07XG4gICAgfVxufTtcblxuXG4vLyBUaGUgb3B0aW9uIGRpcmVjdGl2ZSBpcyBwdXJlbHkgZGVzaWduZWQgdG8gY29tbXVuaWNhdGUgdGhlIGV4aXN0ZW5jZSAob3IgbGFjayBvZilcbi8vIG9mIGR5bmFtaWNhbGx5IGNyZWF0ZWQgKGFuZCBkZXN0cm95ZWQpIG9wdGlvbiBlbGVtZW50cyB0byB0aGVpciBjb250YWluaW5nIHNlbGVjdFxuLy8gZGlyZWN0aXZlIHZpYSBpdHMgY29udHJvbGxlci5cbnZhciBvcHRpb25EaXJlY3RpdmUgPSBbJyRpbnRlcnBvbGF0ZScsIGZ1bmN0aW9uKCRpbnRlcnBvbGF0ZSkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgcHJpb3JpdHk6IDEwMCxcbiAgICBjb21waWxlOiBmdW5jdGlvbihlbGVtZW50LCBhdHRyKSB7XG4gICAgICBpZiAoaXNEZWZpbmVkKGF0dHIudmFsdWUpKSB7XG4gICAgICAgIC8vIElmIHRoZSB2YWx1ZSBhdHRyaWJ1dGUgaXMgZGVmaW5lZCwgY2hlY2sgaWYgaXQgY29udGFpbnMgYW4gaW50ZXJwb2xhdGlvblxuICAgICAgICB2YXIgaW50ZXJwb2xhdGVWYWx1ZUZuID0gJGludGVycG9sYXRlKGF0dHIudmFsdWUsIHRydWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gSWYgdGhlIHZhbHVlIGF0dHJpYnV0ZSBpcyBub3QgZGVmaW5lZCB0aGVuIHdlIGZhbGwgYmFjayB0byB0aGVcbiAgICAgICAgLy8gdGV4dCBjb250ZW50IG9mIHRoZSBvcHRpb24gZWxlbWVudCwgd2hpY2ggbWF5IGJlIGludGVycG9sYXRlZFxuICAgICAgICB2YXIgaW50ZXJwb2xhdGVUZXh0Rm4gPSAkaW50ZXJwb2xhdGUoZWxlbWVudC50ZXh0KCksIHRydWUpO1xuICAgICAgICBpZiAoIWludGVycG9sYXRlVGV4dEZuKSB7XG4gICAgICAgICAgYXR0ci4kc2V0KCd2YWx1ZScsIGVsZW1lbnQudGV4dCgpKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgICAgLy8gVGhpcyBpcyBhbiBvcHRpbWl6YXRpb24gb3ZlciB1c2luZyBeXiBzaW5jZSB3ZSBkb24ndCB3YW50IHRvIGhhdmUgdG8gc2VhcmNoXG4gICAgICAgIC8vIGFsbCB0aGUgd2F5IHRvIHRoZSByb290IG9mIHRoZSBET00gZm9yIGV2ZXJ5IHNpbmdsZSBvcHRpb24gZWxlbWVudFxuICAgICAgICB2YXIgc2VsZWN0Q3RybE5hbWUgPSAnJHNlbGVjdENvbnRyb2xsZXInLFxuICAgICAgICAgICAgcGFyZW50ID0gZWxlbWVudC5wYXJlbnQoKSxcbiAgICAgICAgICAgIHNlbGVjdEN0cmwgPSBwYXJlbnQuZGF0YShzZWxlY3RDdHJsTmFtZSkgfHxcbiAgICAgICAgICAgICAgcGFyZW50LnBhcmVudCgpLmRhdGEoc2VsZWN0Q3RybE5hbWUpOyAvLyBpbiBjYXNlIHdlIGFyZSBpbiBvcHRncm91cFxuXG4gICAgICAgIGlmIChzZWxlY3RDdHJsKSB7XG4gICAgICAgICAgc2VsZWN0Q3RybC5yZWdpc3Rlck9wdGlvbihzY29wZSwgZWxlbWVudCwgYXR0ciwgaW50ZXJwb2xhdGVWYWx1ZUZuLCBpbnRlcnBvbGF0ZVRleHRGbik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9O1xufV07XG5cbnZhciBzdHlsZURpcmVjdGl2ZSA9IHZhbHVlRm4oe1xuICByZXN0cmljdDogJ0UnLFxuICB0ZXJtaW5hbDogZmFsc2Vcbn0pO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG5nUmVxdWlyZWRcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBuZ1JlcXVpcmVkIGFkZHMgdGhlIHJlcXVpcmVkIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2YWxpZGF0b3JzIGB2YWxpZGF0b3JgfSB0byB7QGxpbmsgbmdNb2RlbCBgbmdNb2RlbGB9LlxuICogSXQgaXMgbW9zdCBvZnRlbiB1c2VkIGZvciB7QGxpbmsgaW5wdXQgYGlucHV0YH0gYW5kIHtAbGluayBzZWxlY3QgYHNlbGVjdGB9IGNvbnRyb2xzLCBidXQgY2FuIGFsc28gYmVcbiAqIGFwcGxpZWQgdG8gY3VzdG9tIGNvbnRyb2xzLlxuICpcbiAqIFRoZSBkaXJlY3RpdmUgc2V0cyB0aGUgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgb24gdGhlIGVsZW1lbnQgaWYgdGhlIEFuZ3VsYXIgZXhwcmVzc2lvbiBpbnNpZGVcbiAqIGBuZ1JlcXVpcmVkYCBldmFsdWF0ZXMgdG8gdHJ1ZS4gQSBzcGVjaWFsIGRpcmVjdGl2ZSBmb3Igc2V0dGluZyBgcmVxdWlyZWRgIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHdlXG4gKiBjYW5ub3QgdXNlIGludGVycG9sYXRpb24gaW5zaWRlIGByZXF1aXJlZGAuIFNlZSB0aGUge0BsaW5rIGd1aWRlL2ludGVycG9sYXRpb24gaW50ZXJwb2xhdGlvbiBndWlkZX1cbiAqIGZvciBtb3JlIGluZm8uXG4gKlxuICogVGhlIHZhbGlkYXRvciB3aWxsIHNldCB0aGUgYHJlcXVpcmVkYCBlcnJvciBrZXkgdG8gdHJ1ZSBpZiB0aGUgYHJlcXVpcmVkYCBhdHRyaWJ1dGUgaXMgc2V0IGFuZFxuICogY2FsbGluZyB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkaXNFbXB0eSBgTmdNb2RlbENvbnRyb2xsZXIuJGlzRW1wdHlgfSB3aXRoIHRoZVxuICoge0BsaW5rIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHZpZXdWYWx1ZSBgbmdNb2RlbC4kdmlld1ZhbHVlYH0gcmV0dXJucyBgdHJ1ZWAuIEZvciBleGFtcGxlLCB0aGVcbiAqIGAkaXNFbXB0eSgpYCBpbXBsZW1lbnRhdGlvbiBmb3IgYGlucHV0W3RleHRdYCBjaGVja3MgdGhlIGxlbmd0aCBvZiB0aGUgYCR2aWV3VmFsdWVgLiBXaGVuIGRldmVsb3BpbmdcbiAqIGN1c3RvbSBjb250cm9scywgYCRpc0VtcHR5KClgIGNhbiBiZSBvdmVyd3JpdHRlbiB0byBhY2NvdW50IGZvciBhICR2aWV3VmFsdWUgdGhhdCBpcyBub3Qgc3RyaW5nLWJhc2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiA8ZXhhbXBsZSBuYW1lPVwibmdSZXF1aXJlZERpcmVjdGl2ZVwiIG1vZHVsZT1cIm5nUmVxdWlyZWRFeGFtcGxlXCI+XG4gKiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gKiAgICAgPHNjcmlwdD5cbiAqICAgICAgIGFuZ3VsYXIubW9kdWxlKCduZ1JlcXVpcmVkRXhhbXBsZScsIFtdKVxuICogICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICogICAgICAgICAgICRzY29wZS5yZXF1aXJlZCA9IHRydWU7XG4gKiAgICAgICAgIH1dKTtcbiAqICAgICA8L3NjcmlwdD5cbiAqICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICogICAgICAgPGZvcm0gbmFtZT1cImZvcm1cIj5cbiAqICAgICAgICAgPGxhYmVsIGZvcj1cInJlcXVpcmVkXCI+VG9nZ2xlIHJlcXVpcmVkOiA8L2xhYmVsPlxuICogICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmctbW9kZWw9XCJyZXF1aXJlZFwiIGlkPVwicmVxdWlyZWRcIiAvPlxuICogICAgICAgICA8YnI+XG4gKiAgICAgICAgIDxsYWJlbCBmb3I9XCJpbnB1dFwiPlRoaXMgaW5wdXQgbXVzdCBiZSBmaWxsZWQgaWYgYHJlcXVpcmVkYCBpcyB0cnVlOiA8L2xhYmVsPlxuICogICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cIm1vZGVsXCIgaWQ9XCJpbnB1dFwiIG5hbWU9XCJpbnB1dFwiIG5nLXJlcXVpcmVkPVwicmVxdWlyZWRcIiAvPjxicj5cbiAqICAgICAgICAgPGhyPlxuICogICAgICAgICByZXF1aXJlZCBlcnJvciBzZXQ/ID0gPGNvZGU+e3tmb3JtLmlucHV0LiRlcnJvci5yZXF1aXJlZH19PC9jb2RlPjxicj5cbiAqICAgICAgICAgbW9kZWwgPSA8Y29kZT57e21vZGVsfX08L2NvZGU+XG4gKiAgICAgICA8L2Zvcm0+XG4gKiAgICAgPC9kaXY+XG4gKiAgIDwvZmlsZT5cbiAqICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgIHZhciByZXF1aXJlZCA9IGVsZW1lbnQoYnkuYmluZGluZygnZm9ybS5pbnB1dC4kZXJyb3IucmVxdWlyZWQnKSk7XG4gICAgICAgdmFyIG1vZGVsID0gZWxlbWVudChieS5iaW5kaW5nKCdtb2RlbCcpKTtcbiAgICAgICB2YXIgaW5wdXQgPSBlbGVtZW50KGJ5LmlkKCdpbnB1dCcpKTtcblxuICAgICAgIGl0KCdzaG91bGQgc2V0IHRoZSByZXF1aXJlZCBlcnJvcicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgZXhwZWN0KHJlcXVpcmVkLmdldFRleHQoKSkudG9Db250YWluKCd0cnVlJyk7XG5cbiAgICAgICAgIGlucHV0LnNlbmRLZXlzKCcxMjMnKTtcbiAgICAgICAgIGV4cGVjdChyZXF1aXJlZC5nZXRUZXh0KCkpLm5vdC50b0NvbnRhaW4oJ3RydWUnKTtcbiAgICAgICAgIGV4cGVjdChtb2RlbC5nZXRUZXh0KCkpLnRvQ29udGFpbignMTIzJyk7XG4gICAgICAgfSk7XG4gKiAgIDwvZmlsZT5cbiAqIDwvZXhhbXBsZT5cbiAqL1xudmFyIHJlcXVpcmVkRGlyZWN0aXZlID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbG0sIGF0dHIsIGN0cmwpIHtcbiAgICAgIGlmICghY3RybCkgcmV0dXJuO1xuICAgICAgYXR0ci5yZXF1aXJlZCA9IHRydWU7IC8vIGZvcmNlIHRydXRoeSBpbiBjYXNlIHdlIGFyZSBvbiBub24gaW5wdXQgZWxlbWVudFxuXG4gICAgICBjdHJsLiR2YWxpZGF0b3JzLnJlcXVpcmVkID0gZnVuY3Rpb24obW9kZWxWYWx1ZSwgdmlld1ZhbHVlKSB7XG4gICAgICAgIHJldHVybiAhYXR0ci5yZXF1aXJlZCB8fCAhY3RybC4kaXNFbXB0eSh2aWV3VmFsdWUpO1xuICAgICAgfTtcblxuICAgICAgYXR0ci4kb2JzZXJ2ZSgncmVxdWlyZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgY3RybC4kdmFsaWRhdGUoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn07XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdQYXR0ZXJuXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogbmdQYXR0ZXJuIGFkZHMgdGhlIHBhdHRlcm4ge0BsaW5rIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHZhbGlkYXRvcnMgYHZhbGlkYXRvcmB9IHRvIHtAbGluayBuZ01vZGVsIGBuZ01vZGVsYH0uXG4gKiBJdCBpcyBtb3N0IG9mdGVuIHVzZWQgZm9yIHRleHQtYmFzZWQge0BsaW5rIGlucHV0IGBpbnB1dGB9IGNvbnRyb2xzLCBidXQgY2FuIGFsc28gYmUgYXBwbGllZCB0byBjdXN0b20gdGV4dC1iYXNlZCBjb250cm9scy5cbiAqXG4gKiBUaGUgdmFsaWRhdG9yIHNldHMgdGhlIGBwYXR0ZXJuYCBlcnJvciBrZXkgaWYgdGhlIHtAbGluayBuZ01vZGVsLk5nTW9kZWxDb250cm9sbGVyIyR2aWV3VmFsdWUgYG5nTW9kZWwuJHZpZXdWYWx1ZWB9XG4gKiBkb2VzIG5vdCBtYXRjaCBhIFJlZ0V4cCB3aGljaCBpcyBvYnRhaW5lZCBieSBldmFsdWF0aW5nIHRoZSBBbmd1bGFyIGV4cHJlc3Npb24gZ2l2ZW4gaW4gdGhlXG4gKiBgbmdQYXR0ZXJuYCBhdHRyaWJ1dGUgdmFsdWU6XG4gKiAqIElmIHRoZSBleHByZXNzaW9uIGV2YWx1YXRlcyB0byBhIFJlZ0V4cCBvYmplY3QsIHRoZW4gdGhpcyBpcyB1c2VkIGRpcmVjdGx5LlxuICogKiBJZiB0aGUgZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gYSBzdHJpbmcsIHRoZW4gaXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSBSZWdFeHAgYWZ0ZXIgd3JhcHBpbmcgaXRcbiAqIGluIGBeYCBhbmQgYCRgIGNoYXJhY3RlcnMuIEZvciBpbnN0YW5jZSwgYFwiYWJjXCJgIHdpbGwgYmUgY29udmVydGVkIHRvIGBuZXcgUmVnRXhwKCdeYWJjJCcpYC5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtaW5mb1wiPlxuICogKipOb3RlOioqIEF2b2lkIHVzaW5nIHRoZSBgZ2AgZmxhZyBvbiB0aGUgUmVnRXhwLCBhcyBpdCB3aWxsIGNhdXNlIGVhY2ggc3VjY2Vzc2l2ZSBzZWFyY2ggdG9cbiAqIHN0YXJ0IGF0IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBzZWFyY2gncyBtYXRjaCwgdGh1cyBub3QgdGFraW5nIHRoZSB3aG9sZSBpbnB1dCB2YWx1ZSBpbnRvXG4gKiBhY2NvdW50LlxuICogPC9kaXY+XG4gKlxuICogPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWluZm9cIj5cbiAqICoqTm90ZToqKiBUaGlzIGRpcmVjdGl2ZSBpcyBhbHNvIGFkZGVkIHdoZW4gdGhlIHBsYWluIGBwYXR0ZXJuYCBhdHRyaWJ1dGUgaXMgdXNlZCwgd2l0aCB0d29cbiAqIGRpZmZlcmVuY2VzOlxuICogPG9sPlxuICogICA8bGk+XG4gKiAgICAgYG5nUGF0dGVybmAgZG9lcyBub3Qgc2V0IHRoZSBgcGF0dGVybmAgYXR0cmlidXRlIGFuZCB0aGVyZWZvcmUgSFRNTDUgY29uc3RyYWludCB2YWxpZGF0aW9uIGlzXG4gKiAgICAgbm90IGF2YWlsYWJsZS5cbiAqICAgPC9saT5cbiAqICAgPGxpPlxuICogICAgIFRoZSBgbmdQYXR0ZXJuYCBhdHRyaWJ1dGUgbXVzdCBiZSBhbiBleHByZXNzaW9uLCB3aGlsZSB0aGUgYHBhdHRlcm5gIHZhbHVlIG11c3QgYmVcbiAqICAgICBpbnRlcnBvbGF0ZWQuXG4gKiAgIDwvbGk+XG4gKiA8L29sPlxuICogPC9kaXY+XG4gKlxuICogQGV4YW1wbGVcbiAqIDxleGFtcGxlIG5hbWU9XCJuZ1BhdHRlcm5EaXJlY3RpdmVcIiBtb2R1bGU9XCJuZ1BhdHRlcm5FeGFtcGxlXCI+XG4gKiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gKiAgICAgPHNjcmlwdD5cbiAqICAgICAgIGFuZ3VsYXIubW9kdWxlKCduZ1BhdHRlcm5FeGFtcGxlJywgW10pXG4gKiAgICAgICAgIC5jb250cm9sbGVyKCdFeGFtcGxlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gKiAgICAgICAgICAgJHNjb3BlLnJlZ2V4ID0gJ1xcXFxkKyc7XG4gKiAgICAgICAgIH1dKTtcbiAqICAgICA8L3NjcmlwdD5cbiAqICAgICA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJFeGFtcGxlQ29udHJvbGxlclwiPlxuICogICAgICAgPGZvcm0gbmFtZT1cImZvcm1cIj5cbiAqICAgICAgICAgPGxhYmVsIGZvcj1cInJlZ2V4XCI+U2V0IGEgcGF0dGVybiAocmVnZXggc3RyaW5nKTogPC9sYWJlbD5cbiAqICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJyZWdleFwiIGlkPVwicmVnZXhcIiAvPlxuICogICAgICAgICA8YnI+XG4gKiAgICAgICAgIDxsYWJlbCBmb3I9XCJpbnB1dFwiPlRoaXMgaW5wdXQgaXMgcmVzdHJpY3RlZCBieSB0aGUgY3VycmVudCBwYXR0ZXJuOiA8L2xhYmVsPlxuICogICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cIm1vZGVsXCIgaWQ9XCJpbnB1dFwiIG5hbWU9XCJpbnB1dFwiIG5nLXBhdHRlcm49XCJyZWdleFwiIC8+PGJyPlxuICogICAgICAgICA8aHI+XG4gKiAgICAgICAgIGlucHV0IHZhbGlkPyA9IDxjb2RlPnt7Zm9ybS5pbnB1dC4kdmFsaWR9fTwvY29kZT48YnI+XG4gKiAgICAgICAgIG1vZGVsID0gPGNvZGU+e3ttb2RlbH19PC9jb2RlPlxuICogICAgICAgPC9mb3JtPlxuICogICAgIDwvZGl2PlxuICogICA8L2ZpbGU+XG4gKiAgIDxmaWxlIG5hbWU9XCJwcm90cmFjdG9yLmpzXCIgdHlwZT1cInByb3RyYWN0b3JcIj5cbiAgICAgICB2YXIgbW9kZWwgPSBlbGVtZW50KGJ5LmJpbmRpbmcoJ21vZGVsJykpO1xuICAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQoYnkuaWQoJ2lucHV0JykpO1xuXG4gICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB0aGUgaW5wdXQgd2l0aCB0aGUgZGVmYXVsdCBwYXR0ZXJuJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICBpbnB1dC5zZW5kS2V5cygnYWFhJyk7XG4gICAgICAgICBleHBlY3QobW9kZWwuZ2V0VGV4dCgpKS5ub3QudG9Db250YWluKCdhYWEnKTtcblxuICAgICAgICAgaW5wdXQuY2xlYXIoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICBpbnB1dC5zZW5kS2V5cygnMTIzJyk7XG4gICAgICAgICAgIGV4cGVjdChtb2RlbC5nZXRUZXh0KCkpLnRvQ29udGFpbignMTIzJyk7XG4gICAgICAgICB9KTtcbiAgICAgICB9KTtcbiAqICAgPC9maWxlPlxuICogPC9leGFtcGxlPlxuICovXG52YXIgcGF0dGVybkRpcmVjdGl2ZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgcmVxdWlyZTogJz9uZ01vZGVsJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxtLCBhdHRyLCBjdHJsKSB7XG4gICAgICBpZiAoIWN0cmwpIHJldHVybjtcblxuICAgICAgdmFyIHJlZ2V4cCwgcGF0dGVybkV4cCA9IGF0dHIubmdQYXR0ZXJuIHx8IGF0dHIucGF0dGVybjtcbiAgICAgIGF0dHIuJG9ic2VydmUoJ3BhdHRlcm4nLCBmdW5jdGlvbihyZWdleCkge1xuICAgICAgICBpZiAoaXNTdHJpbmcocmVnZXgpICYmIHJlZ2V4Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICByZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgcmVnZXggKyAnJCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlZ2V4ICYmICFyZWdleC50ZXN0KSB7XG4gICAgICAgICAgdGhyb3cgbWluRXJyKCduZ1BhdHRlcm4nKSgnbm9yZWdleHAnLFxuICAgICAgICAgICAgJ0V4cGVjdGVkIHswfSB0byBiZSBhIFJlZ0V4cCBidXQgd2FzIHsxfS4gRWxlbWVudDogezJ9JywgcGF0dGVybkV4cCxcbiAgICAgICAgICAgIHJlZ2V4LCBzdGFydGluZ1RhZyhlbG0pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlZ2V4cCA9IHJlZ2V4IHx8IHVuZGVmaW5lZDtcbiAgICAgICAgY3RybC4kdmFsaWRhdGUoKTtcbiAgICAgIH0pO1xuXG4gICAgICBjdHJsLiR2YWxpZGF0b3JzLnBhdHRlcm4gPSBmdW5jdGlvbihtb2RlbFZhbHVlLCB2aWV3VmFsdWUpIHtcbiAgICAgICAgLy8gSFRNTDUgcGF0dGVybiBjb25zdHJhaW50IHZhbGlkYXRlcyB0aGUgaW5wdXQgdmFsdWUsIHNvIHdlIHZhbGlkYXRlIHRoZSB2aWV3VmFsdWVcbiAgICAgICAgcmV0dXJuIGN0cmwuJGlzRW1wdHkodmlld1ZhbHVlKSB8fCBpc1VuZGVmaW5lZChyZWdleHApIHx8IHJlZ2V4cC50ZXN0KHZpZXdWYWx1ZSk7XG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn07XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbmdNYXhsZW5ndGhcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBuZ01heGxlbmd0aCBhZGRzIHRoZSBtYXhsZW5ndGgge0BsaW5rIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHZhbGlkYXRvcnMgYHZhbGlkYXRvcmB9IHRvIHtAbGluayBuZ01vZGVsIGBuZ01vZGVsYH0uXG4gKiBJdCBpcyBtb3N0IG9mdGVuIHVzZWQgZm9yIHRleHQtYmFzZWQge0BsaW5rIGlucHV0IGBpbnB1dGB9IGNvbnRyb2xzLCBidXQgY2FuIGFsc28gYmUgYXBwbGllZCB0byBjdXN0b20gdGV4dC1iYXNlZCBjb250cm9scy5cbiAqXG4gKiBUaGUgdmFsaWRhdG9yIHNldHMgdGhlIGBtYXhsZW5ndGhgIGVycm9yIGtleSBpZiB0aGUge0BsaW5rIG5nTW9kZWwuTmdNb2RlbENvbnRyb2xsZXIjJHZpZXdWYWx1ZSBgbmdNb2RlbC4kdmlld1ZhbHVlYH1cbiAqIGlzIGxvbmdlciB0aGFuIHRoZSBpbnRlZ2VyIG9idGFpbmVkIGJ5IGV2YWx1YXRpbmcgdGhlIEFuZ3VsYXIgZXhwcmVzc2lvbiBnaXZlbiBpbiB0aGVcbiAqIGBuZ01heGxlbmd0aGAgYXR0cmlidXRlIHZhbHVlLlxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1pbmZvXCI+XG4gKiAqKk5vdGU6KiogVGhpcyBkaXJlY3RpdmUgaXMgYWxzbyBhZGRlZCB3aGVuIHRoZSBwbGFpbiBgbWF4bGVuZ3RoYCBhdHRyaWJ1dGUgaXMgdXNlZCwgd2l0aCB0d29cbiAqIGRpZmZlcmVuY2VzOlxuICogPG9sPlxuICogICA8bGk+XG4gKiAgICAgYG5nTWF4bGVuZ3RoYCBkb2VzIG5vdCBzZXQgdGhlIGBtYXhsZW5ndGhgIGF0dHJpYnV0ZSBhbmQgdGhlcmVmb3JlIEhUTUw1IGNvbnN0cmFpbnRcbiAqICAgICB2YWxpZGF0aW9uIGlzIG5vdCBhdmFpbGFibGUuXG4gKiAgIDwvbGk+XG4gKiAgIDxsaT5cbiAqICAgICBUaGUgYG5nTWF4bGVuZ3RoYCBhdHRyaWJ1dGUgbXVzdCBiZSBhbiBleHByZXNzaW9uLCB3aGlsZSB0aGUgYG1heGxlbmd0aGAgdmFsdWUgbXVzdCBiZVxuICogICAgIGludGVycG9sYXRlZC5cbiAqICAgPC9saT5cbiAqIDwvb2w+XG4gKiA8L2Rpdj5cbiAqXG4gKiBAZXhhbXBsZVxuICogPGV4YW1wbGUgbmFtZT1cIm5nTWF4bGVuZ3RoRGlyZWN0aXZlXCIgbW9kdWxlPVwibmdNYXhsZW5ndGhFeGFtcGxlXCI+XG4gKiAgIDxmaWxlIG5hbWU9XCJpbmRleC5odG1sXCI+XG4gKiAgICAgPHNjcmlwdD5cbiAqICAgICAgIGFuZ3VsYXIubW9kdWxlKCduZ01heGxlbmd0aEV4YW1wbGUnLCBbXSlcbiAqICAgICAgICAgLmNvbnRyb2xsZXIoJ0V4YW1wbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAqICAgICAgICAgICAkc2NvcGUubWF4bGVuZ3RoID0gNTtcbiAqICAgICAgICAgfV0pO1xuICogICAgIDwvc2NyaXB0PlxuICogICAgIDxkaXYgbmctY29udHJvbGxlcj1cIkV4YW1wbGVDb250cm9sbGVyXCI+XG4gKiAgICAgICA8Zm9ybSBuYW1lPVwiZm9ybVwiPlxuICogICAgICAgICA8bGFiZWwgZm9yPVwibWF4bGVuZ3RoXCI+U2V0IGEgbWF4bGVuZ3RoOiA8L2xhYmVsPlxuICogICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIG5nLW1vZGVsPVwibWF4bGVuZ3RoXCIgaWQ9XCJtYXhsZW5ndGhcIiAvPlxuICogICAgICAgICA8YnI+XG4gKiAgICAgICAgIDxsYWJlbCBmb3I9XCJpbnB1dFwiPlRoaXMgaW5wdXQgaXMgcmVzdHJpY3RlZCBieSB0aGUgY3VycmVudCBtYXhsZW5ndGg6IDwvbGFiZWw+XG4gKiAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwibW9kZWxcIiBpZD1cImlucHV0XCIgbmFtZT1cImlucHV0XCIgbmctbWF4bGVuZ3RoPVwibWF4bGVuZ3RoXCIgLz48YnI+XG4gKiAgICAgICAgIDxocj5cbiAqICAgICAgICAgaW5wdXQgdmFsaWQ/ID0gPGNvZGU+e3tmb3JtLmlucHV0LiR2YWxpZH19PC9jb2RlPjxicj5cbiAqICAgICAgICAgbW9kZWwgPSA8Y29kZT57e21vZGVsfX08L2NvZGU+XG4gKiAgICAgICA8L2Zvcm0+XG4gKiAgICAgPC9kaXY+XG4gKiAgIDwvZmlsZT5cbiAqICAgPGZpbGUgbmFtZT1cInByb3RyYWN0b3IuanNcIiB0eXBlPVwicHJvdHJhY3RvclwiPlxuICAgICAgIHZhciBtb2RlbCA9IGVsZW1lbnQoYnkuYmluZGluZygnbW9kZWwnKSk7XG4gICAgICAgdmFyIGlucHV0ID0gZWxlbWVudChieS5pZCgnaW5wdXQnKSk7XG5cbiAgICAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHRoZSBpbnB1dCB3aXRoIHRoZSBkZWZhdWx0IG1heGxlbmd0aCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgaW5wdXQuc2VuZEtleXMoJ2FiY2RlZicpO1xuICAgICAgICAgZXhwZWN0KG1vZGVsLmdldFRleHQoKSkubm90LnRvQ29udGFpbignYWJjZGVmJyk7XG5cbiAgICAgICAgIGlucHV0LmNsZWFyKCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgaW5wdXQuc2VuZEtleXMoJ2FiY2RlJyk7XG4gICAgICAgICAgIGV4cGVjdChtb2RlbC5nZXRUZXh0KCkpLnRvQ29udGFpbignYWJjZGUnKTtcbiAgICAgICAgIH0pO1xuICAgICAgIH0pO1xuICogICA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKi9cbnZhciBtYXhsZW5ndGhEaXJlY3RpdmUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsbSwgYXR0ciwgY3RybCkge1xuICAgICAgaWYgKCFjdHJsKSByZXR1cm47XG5cbiAgICAgIHZhciBtYXhsZW5ndGggPSAtMTtcbiAgICAgIGF0dHIuJG9ic2VydmUoJ21heGxlbmd0aCcsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnRWYWwgPSB0b0ludCh2YWx1ZSk7XG4gICAgICAgIG1heGxlbmd0aCA9IGlzTmFOKGludFZhbCkgPyAtMSA6IGludFZhbDtcbiAgICAgICAgY3RybC4kdmFsaWRhdGUoKTtcbiAgICAgIH0pO1xuICAgICAgY3RybC4kdmFsaWRhdG9ycy5tYXhsZW5ndGggPSBmdW5jdGlvbihtb2RlbFZhbHVlLCB2aWV3VmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIChtYXhsZW5ndGggPCAwKSB8fCBjdHJsLiRpc0VtcHR5KHZpZXdWYWx1ZSkgfHwgKHZpZXdWYWx1ZS5sZW5ndGggPD0gbWF4bGVuZ3RoKTtcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBuZ01pbmxlbmd0aFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIG5nTWlubGVuZ3RoIGFkZHMgdGhlIG1pbmxlbmd0aCB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmFsaWRhdG9ycyBgdmFsaWRhdG9yYH0gdG8ge0BsaW5rIG5nTW9kZWwgYG5nTW9kZWxgfS5cbiAqIEl0IGlzIG1vc3Qgb2Z0ZW4gdXNlZCBmb3IgdGV4dC1iYXNlZCB7QGxpbmsgaW5wdXQgYGlucHV0YH0gY29udHJvbHMsIGJ1dCBjYW4gYWxzbyBiZSBhcHBsaWVkIHRvIGN1c3RvbSB0ZXh0LWJhc2VkIGNvbnRyb2xzLlxuICpcbiAqIFRoZSB2YWxpZGF0b3Igc2V0cyB0aGUgYG1pbmxlbmd0aGAgZXJyb3Iga2V5IGlmIHRoZSB7QGxpbmsgbmdNb2RlbC5OZ01vZGVsQ29udHJvbGxlciMkdmlld1ZhbHVlIGBuZ01vZGVsLiR2aWV3VmFsdWVgfVxuICogaXMgc2hvcnRlciB0aGFuIHRoZSBpbnRlZ2VyIG9idGFpbmVkIGJ5IGV2YWx1YXRpbmcgdGhlIEFuZ3VsYXIgZXhwcmVzc2lvbiBnaXZlbiBpbiB0aGVcbiAqIGBuZ01pbmxlbmd0aGAgYXR0cmlidXRlIHZhbHVlLlxuICpcbiAqIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1pbmZvXCI+XG4gKiAqKk5vdGU6KiogVGhpcyBkaXJlY3RpdmUgaXMgYWxzbyBhZGRlZCB3aGVuIHRoZSBwbGFpbiBgbWlubGVuZ3RoYCBhdHRyaWJ1dGUgaXMgdXNlZCwgd2l0aCB0d29cbiAqIGRpZmZlcmVuY2VzOlxuICogPG9sPlxuICogICA8bGk+XG4gKiAgICAgYG5nTWlubGVuZ3RoYCBkb2VzIG5vdCBzZXQgdGhlIGBtaW5sZW5ndGhgIGF0dHJpYnV0ZSBhbmQgdGhlcmVmb3JlIEhUTUw1IGNvbnN0cmFpbnRcbiAqICAgICB2YWxpZGF0aW9uIGlzIG5vdCBhdmFpbGFibGUuXG4gKiAgIDwvbGk+XG4gKiAgIDxsaT5cbiAqICAgICBUaGUgYG5nTWlubGVuZ3RoYCB2YWx1ZSBtdXN0IGJlIGFuIGV4cHJlc3Npb24sIHdoaWxlIHRoZSBgbWlubGVuZ3RoYCB2YWx1ZSBtdXN0IGJlXG4gKiAgICAgaW50ZXJwb2xhdGVkLlxuICogICA8L2xpPlxuICogPC9vbD5cbiAqIDwvZGl2PlxuICpcbiAqIEBleGFtcGxlXG4gKiA8ZXhhbXBsZSBuYW1lPVwibmdNaW5sZW5ndGhEaXJlY3RpdmVcIiBtb2R1bGU9XCJuZ01pbmxlbmd0aEV4YW1wbGVcIj5cbiAqICAgPGZpbGUgbmFtZT1cImluZGV4Lmh0bWxcIj5cbiAqICAgICA8c2NyaXB0PlxuICogICAgICAgYW5ndWxhci5tb2R1bGUoJ25nTWlubGVuZ3RoRXhhbXBsZScsIFtdKVxuICogICAgICAgICAuY29udHJvbGxlcignRXhhbXBsZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICogICAgICAgICAgICRzY29wZS5taW5sZW5ndGggPSAzO1xuICogICAgICAgICB9XSk7XG4gKiAgICAgPC9zY3JpcHQ+XG4gKiAgICAgPGRpdiBuZy1jb250cm9sbGVyPVwiRXhhbXBsZUNvbnRyb2xsZXJcIj5cbiAqICAgICAgIDxmb3JtIG5hbWU9XCJmb3JtXCI+XG4gKiAgICAgICAgIDxsYWJlbCBmb3I9XCJtaW5sZW5ndGhcIj5TZXQgYSBtaW5sZW5ndGg6IDwvbGFiZWw+XG4gKiAgICAgICAgIDxpbnB1dCB0eXBlPVwibnVtYmVyXCIgbmctbW9kZWw9XCJtaW5sZW5ndGhcIiBpZD1cIm1pbmxlbmd0aFwiIC8+XG4gKiAgICAgICAgIDxicj5cbiAqICAgICAgICAgPGxhYmVsIGZvcj1cImlucHV0XCI+VGhpcyBpbnB1dCBpcyByZXN0cmljdGVkIGJ5IHRoZSBjdXJyZW50IG1pbmxlbmd0aDogPC9sYWJlbD5cbiAqICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJtb2RlbFwiIGlkPVwiaW5wdXRcIiBuYW1lPVwiaW5wdXRcIiBuZy1taW5sZW5ndGg9XCJtaW5sZW5ndGhcIiAvPjxicj5cbiAqICAgICAgICAgPGhyPlxuICogICAgICAgICBpbnB1dCB2YWxpZD8gPSA8Y29kZT57e2Zvcm0uaW5wdXQuJHZhbGlkfX08L2NvZGU+PGJyPlxuICogICAgICAgICBtb2RlbCA9IDxjb2RlPnt7bW9kZWx9fTwvY29kZT5cbiAqICAgICAgIDwvZm9ybT5cbiAqICAgICA8L2Rpdj5cbiAqICAgPC9maWxlPlxuICogICA8ZmlsZSBuYW1lPVwicHJvdHJhY3Rvci5qc1wiIHR5cGU9XCJwcm90cmFjdG9yXCI+XG4gICAgICAgdmFyIG1vZGVsID0gZWxlbWVudChieS5iaW5kaW5nKCdtb2RlbCcpKTtcbiAgICAgICB2YXIgaW5wdXQgPSBlbGVtZW50KGJ5LmlkKCdpbnB1dCcpKTtcblxuICAgICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgdGhlIGlucHV0IHdpdGggdGhlIGRlZmF1bHQgbWlubGVuZ3RoJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICBpbnB1dC5zZW5kS2V5cygnYWInKTtcbiAgICAgICAgIGV4cGVjdChtb2RlbC5nZXRUZXh0KCkpLm5vdC50b0NvbnRhaW4oJ2FiJyk7XG5cbiAgICAgICAgIGlucHV0LnNlbmRLZXlzKCdhYmMnKTtcbiAgICAgICAgIGV4cGVjdChtb2RlbC5nZXRUZXh0KCkpLnRvQ29udGFpbignYWJjJyk7XG4gICAgICAgfSk7XG4gKiAgIDwvZmlsZT5cbiAqIDwvZXhhbXBsZT5cbiAqL1xudmFyIG1pbmxlbmd0aERpcmVjdGl2ZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgcmVxdWlyZTogJz9uZ01vZGVsJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxtLCBhdHRyLCBjdHJsKSB7XG4gICAgICBpZiAoIWN0cmwpIHJldHVybjtcblxuICAgICAgdmFyIG1pbmxlbmd0aCA9IDA7XG4gICAgICBhdHRyLiRvYnNlcnZlKCdtaW5sZW5ndGgnLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBtaW5sZW5ndGggPSB0b0ludCh2YWx1ZSkgfHwgMDtcbiAgICAgICAgY3RybC4kdmFsaWRhdGUoKTtcbiAgICAgIH0pO1xuICAgICAgY3RybC4kdmFsaWRhdG9ycy5taW5sZW5ndGggPSBmdW5jdGlvbihtb2RlbFZhbHVlLCB2aWV3VmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGN0cmwuJGlzRW1wdHkodmlld1ZhbHVlKSB8fCB2aWV3VmFsdWUubGVuZ3RoID49IG1pbmxlbmd0aDtcbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcblxuaWYgKHdpbmRvdy5hbmd1bGFyLmJvb3RzdHJhcCkge1xuICAvL0FuZ3VsYXJKUyBpcyBhbHJlYWR5IGxvYWRlZCwgc28gd2UgY2FuIHJldHVybiBoZXJlLi4uXG4gIGNvbnNvbGUubG9nKCdXQVJOSU5HOiBUcmllZCB0byBsb2FkIGFuZ3VsYXIgbW9yZSB0aGFuIG9uY2UuJyk7XG4gIHJldHVybjtcbn1cblxuLy90cnkgdG8gYmluZCB0byBqcXVlcnkgbm93IHNvIHRoYXQgb25lIGNhbiB3cml0ZSBqcUxpdGUoZG9jdW1lbnQpLnJlYWR5KClcbi8vYnV0IHdlIHdpbGwgcmViaW5kIG9uIGJvb3RzdHJhcCBhZ2Fpbi5cbmJpbmRKUXVlcnkoKTtcblxucHVibGlzaEV4dGVybmFsQVBJKGFuZ3VsYXIpO1xuXG5hbmd1bGFyLm1vZHVsZShcIm5nTG9jYWxlXCIsIFtdLCBbXCIkcHJvdmlkZVwiLCBmdW5jdGlvbigkcHJvdmlkZSkge1xudmFyIFBMVVJBTF9DQVRFR09SWSA9IHtaRVJPOiBcInplcm9cIiwgT05FOiBcIm9uZVwiLCBUV086IFwidHdvXCIsIEZFVzogXCJmZXdcIiwgTUFOWTogXCJtYW55XCIsIE9USEVSOiBcIm90aGVyXCJ9O1xuZnVuY3Rpb24gZ2V0RGVjaW1hbHMobikge1xuICBuID0gbiArICcnO1xuICB2YXIgaSA9IG4uaW5kZXhPZignLicpO1xuICByZXR1cm4gKGkgPT0gLTEpID8gMCA6IG4ubGVuZ3RoIC0gaSAtIDE7XG59XG5cbmZ1bmN0aW9uIGdldFZGKG4sIG9wdF9wcmVjaXNpb24pIHtcbiAgdmFyIHYgPSBvcHRfcHJlY2lzaW9uO1xuXG4gIGlmICh1bmRlZmluZWQgPT09IHYpIHtcbiAgICB2ID0gTWF0aC5taW4oZ2V0RGVjaW1hbHMobiksIDMpO1xuICB9XG5cbiAgdmFyIGJhc2UgPSBNYXRoLnBvdygxMCwgdik7XG4gIHZhciBmID0gKChuICogYmFzZSkgfCAwKSAlIGJhc2U7XG4gIHJldHVybiB7djogdiwgZjogZn07XG59XG5cbiRwcm92aWRlLnZhbHVlKFwiJGxvY2FsZVwiLCB7XG4gIFwiREFURVRJTUVfRk9STUFUU1wiOiB7XG4gICAgXCJBTVBNU1wiOiBbXG4gICAgICBcIkFNXCIsXG4gICAgICBcIlBNXCJcbiAgICBdLFxuICAgIFwiREFZXCI6IFtcbiAgICAgIFwiU3VuZGF5XCIsXG4gICAgICBcIk1vbmRheVwiLFxuICAgICAgXCJUdWVzZGF5XCIsXG4gICAgICBcIldlZG5lc2RheVwiLFxuICAgICAgXCJUaHVyc2RheVwiLFxuICAgICAgXCJGcmlkYXlcIixcbiAgICAgIFwiU2F0dXJkYXlcIlxuICAgIF0sXG4gICAgXCJFUkFOQU1FU1wiOiBbXG4gICAgICBcIkJlZm9yZSBDaHJpc3RcIixcbiAgICAgIFwiQW5ubyBEb21pbmlcIlxuICAgIF0sXG4gICAgXCJFUkFTXCI6IFtcbiAgICAgIFwiQkNcIixcbiAgICAgIFwiQURcIlxuICAgIF0sXG4gICAgXCJGSVJTVERBWU9GV0VFS1wiOiA2LFxuICAgIFwiTU9OVEhcIjogW1xuICAgICAgXCJKYW51YXJ5XCIsXG4gICAgICBcIkZlYnJ1YXJ5XCIsXG4gICAgICBcIk1hcmNoXCIsXG4gICAgICBcIkFwcmlsXCIsXG4gICAgICBcIk1heVwiLFxuICAgICAgXCJKdW5lXCIsXG4gICAgICBcIkp1bHlcIixcbiAgICAgIFwiQXVndXN0XCIsXG4gICAgICBcIlNlcHRlbWJlclwiLFxuICAgICAgXCJPY3RvYmVyXCIsXG4gICAgICBcIk5vdmVtYmVyXCIsXG4gICAgICBcIkRlY2VtYmVyXCJcbiAgICBdLFxuICAgIFwiU0hPUlREQVlcIjogW1xuICAgICAgXCJTdW5cIixcbiAgICAgIFwiTW9uXCIsXG4gICAgICBcIlR1ZVwiLFxuICAgICAgXCJXZWRcIixcbiAgICAgIFwiVGh1XCIsXG4gICAgICBcIkZyaVwiLFxuICAgICAgXCJTYXRcIlxuICAgIF0sXG4gICAgXCJTSE9SVE1PTlRIXCI6IFtcbiAgICAgIFwiSmFuXCIsXG4gICAgICBcIkZlYlwiLFxuICAgICAgXCJNYXJcIixcbiAgICAgIFwiQXByXCIsXG4gICAgICBcIk1heVwiLFxuICAgICAgXCJKdW5cIixcbiAgICAgIFwiSnVsXCIsXG4gICAgICBcIkF1Z1wiLFxuICAgICAgXCJTZXBcIixcbiAgICAgIFwiT2N0XCIsXG4gICAgICBcIk5vdlwiLFxuICAgICAgXCJEZWNcIlxuICAgIF0sXG4gICAgXCJTVEFOREFMT05FTU9OVEhcIjogW1xuICAgICAgXCJKYW51YXJ5XCIsXG4gICAgICBcIkZlYnJ1YXJ5XCIsXG4gICAgICBcIk1hcmNoXCIsXG4gICAgICBcIkFwcmlsXCIsXG4gICAgICBcIk1heVwiLFxuICAgICAgXCJKdW5lXCIsXG4gICAgICBcIkp1bHlcIixcbiAgICAgIFwiQXVndXN0XCIsXG4gICAgICBcIlNlcHRlbWJlclwiLFxuICAgICAgXCJPY3RvYmVyXCIsXG4gICAgICBcIk5vdmVtYmVyXCIsXG4gICAgICBcIkRlY2VtYmVyXCJcbiAgICBdLFxuICAgIFwiV0VFS0VORFJBTkdFXCI6IFtcbiAgICAgIDUsXG4gICAgICA2XG4gICAgXSxcbiAgICBcImZ1bGxEYXRlXCI6IFwiRUVFRSwgTU1NTSBkLCB5XCIsXG4gICAgXCJsb25nRGF0ZVwiOiBcIk1NTU0gZCwgeVwiLFxuICAgIFwibWVkaXVtXCI6IFwiTU1NIGQsIHkgaDptbTpzcyBhXCIsXG4gICAgXCJtZWRpdW1EYXRlXCI6IFwiTU1NIGQsIHlcIixcbiAgICBcIm1lZGl1bVRpbWVcIjogXCJoOm1tOnNzIGFcIixcbiAgICBcInNob3J0XCI6IFwiTS9kL3l5IGg6bW0gYVwiLFxuICAgIFwic2hvcnREYXRlXCI6IFwiTS9kL3l5XCIsXG4gICAgXCJzaG9ydFRpbWVcIjogXCJoOm1tIGFcIlxuICB9LFxuICBcIk5VTUJFUl9GT1JNQVRTXCI6IHtcbiAgICBcIkNVUlJFTkNZX1NZTVwiOiBcIiRcIixcbiAgICBcIkRFQ0lNQUxfU0VQXCI6IFwiLlwiLFxuICAgIFwiR1JPVVBfU0VQXCI6IFwiLFwiLFxuICAgIFwiUEFUVEVSTlNcIjogW1xuICAgICAge1xuICAgICAgICBcImdTaXplXCI6IDMsXG4gICAgICAgIFwibGdTaXplXCI6IDMsXG4gICAgICAgIFwibWF4RnJhY1wiOiAzLFxuICAgICAgICBcIm1pbkZyYWNcIjogMCxcbiAgICAgICAgXCJtaW5JbnRcIjogMSxcbiAgICAgICAgXCJuZWdQcmVcIjogXCItXCIsXG4gICAgICAgIFwibmVnU3VmXCI6IFwiXCIsXG4gICAgICAgIFwicG9zUHJlXCI6IFwiXCIsXG4gICAgICAgIFwicG9zU3VmXCI6IFwiXCJcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIFwiZ1NpemVcIjogMyxcbiAgICAgICAgXCJsZ1NpemVcIjogMyxcbiAgICAgICAgXCJtYXhGcmFjXCI6IDIsXG4gICAgICAgIFwibWluRnJhY1wiOiAyLFxuICAgICAgICBcIm1pbkludFwiOiAxLFxuICAgICAgICBcIm5lZ1ByZVwiOiBcIi1cXHUwMGE0XCIsXG4gICAgICAgIFwibmVnU3VmXCI6IFwiXCIsXG4gICAgICAgIFwicG9zUHJlXCI6IFwiXFx1MDBhNFwiLFxuICAgICAgICBcInBvc1N1ZlwiOiBcIlwiXG4gICAgICB9XG4gICAgXVxuICB9LFxuICBcImlkXCI6IFwiZW4tdXNcIixcbiAgXCJsb2NhbGVJRFwiOiBcImVuX1VTXCIsXG4gIFwicGx1cmFsQ2F0XCI6IGZ1bmN0aW9uKG4sIG9wdF9wcmVjaXNpb24pIHsgIHZhciBpID0gbiB8IDA7ICB2YXIgdmYgPSBnZXRWRihuLCBvcHRfcHJlY2lzaW9uKTsgIGlmIChpID09IDEgJiYgdmYudiA9PSAwKSB7ICAgIHJldHVybiBQTFVSQUxfQ0FURUdPUlkuT05FOyAgfSAgcmV0dXJuIFBMVVJBTF9DQVRFR09SWS5PVEhFUjt9XG59KTtcbn1dKTtcblxuICBqcUxpdGUoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgIGFuZ3VsYXJJbml0KGRvY3VtZW50LCBib290c3RyYXApO1xuICB9KTtcblxufSkod2luZG93LCBkb2N1bWVudCk7XG5cbiF3aW5kb3cuYW5ndWxhci4kJGNzcCgpLm5vSW5saW5lU3R5bGUgJiYgd2luZG93LmFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5oZWFkKS5wcmVwZW5kKCc8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+QGNoYXJzZXQgXCJVVEYtOFwiO1tuZ1xcXFw6Y2xvYWtdLFtuZy1jbG9ha10sW2RhdGEtbmctY2xvYWtdLFt4LW5nLWNsb2FrXSwubmctY2xvYWssLngtbmctY2xvYWssLm5nLWhpZGU6bm90KC5uZy1oaWRlLWFuaW1hdGUpe2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50O31uZ1xcXFw6Zm9ybXtkaXNwbGF5OmJsb2NrO30ubmctYW5pbWF0ZS1zaGlte3Zpc2liaWxpdHk6aGlkZGVuO30ubmctYW5jaG9ye3Bvc2l0aW9uOmFic29sdXRlO308L3N0eWxlPicpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9hbmd1bGFyL2FuZ3VsYXIuanNcbiAqKiBtb2R1bGUgaWQgPSAxXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJyZXF1aXJlKCcuL2FuZ3VsYXInKTtcbm1vZHVsZS5leHBvcnRzID0gYW5ndWxhcjtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9hbmd1bGFyL2luZGV4LmpzXG4gKiogbW9kdWxlIGlkID0gMlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvbGliL2Nzcy1iYXNlLmpzXCIpKCk7XG4vLyBpbXBvcnRzXG5cblxuLy8gbW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCJib2R5e3BhZGRpbmc6MjVweH1oMXttYXJnaW46MTVweCAwfXByZXtmb250LWZhbWlseTptb25vc3BhY2U7Zm9udC1zaXplOjE0cHh9XCIsIFwiXCJdKTtcblxuLy8gZXhwb3J0c1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2Nzcy1sb2FkZXIhLi9pbmRleC5jc3NcbiAqKiBtb2R1bGUgaWQgPSAzXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvKlxyXG5cdE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcblx0QXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxyXG4qL1xyXG4vLyBjc3MgYmFzZSBjb2RlLCBpbmplY3RlZCBieSB0aGUgY3NzLWxvYWRlclxyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xyXG5cdHZhciBsaXN0ID0gW107XHJcblxyXG5cdC8vIHJldHVybiB0aGUgbGlzdCBvZiBtb2R1bGVzIGFzIGNzcyBzdHJpbmdcclxuXHRsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XHJcblx0XHR2YXIgcmVzdWx0ID0gW107XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgaXRlbSA9IHRoaXNbaV07XHJcblx0XHRcdGlmKGl0ZW1bMl0pIHtcclxuXHRcdFx0XHRyZXN1bHQucHVzaChcIkBtZWRpYSBcIiArIGl0ZW1bMl0gKyBcIntcIiArIGl0ZW1bMV0gKyBcIn1cIik7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cmVzdWx0LnB1c2goaXRlbVsxXSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiByZXN1bHQuam9pbihcIlwiKTtcclxuXHR9O1xyXG5cclxuXHQvLyBpbXBvcnQgYSBsaXN0IG9mIG1vZHVsZXMgaW50byB0aGUgbGlzdFxyXG5cdGxpc3QuaSA9IGZ1bmN0aW9uKG1vZHVsZXMsIG1lZGlhUXVlcnkpIHtcclxuXHRcdGlmKHR5cGVvZiBtb2R1bGVzID09PSBcInN0cmluZ1wiKVxyXG5cdFx0XHRtb2R1bGVzID0gW1tudWxsLCBtb2R1bGVzLCBcIlwiXV07XHJcblx0XHR2YXIgYWxyZWFkeUltcG9ydGVkTW9kdWxlcyA9IHt9O1xyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGlkID0gdGhpc1tpXVswXTtcclxuXHRcdFx0aWYodHlwZW9mIGlkID09PSBcIm51bWJlclwiKVxyXG5cdFx0XHRcdGFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaWRdID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdGZvcihpID0gMDsgaSA8IG1vZHVsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGl0ZW0gPSBtb2R1bGVzW2ldO1xyXG5cdFx0XHQvLyBza2lwIGFscmVhZHkgaW1wb3J0ZWQgbW9kdWxlXHJcblx0XHRcdC8vIHRoaXMgaW1wbGVtZW50YXRpb24gaXMgbm90IDEwMCUgcGVyZmVjdCBmb3Igd2VpcmQgbWVkaWEgcXVlcnkgY29tYmluYXRpb25zXHJcblx0XHRcdC8vICB3aGVuIGEgbW9kdWxlIGlzIGltcG9ydGVkIG11bHRpcGxlIHRpbWVzIHdpdGggZGlmZmVyZW50IG1lZGlhIHF1ZXJpZXMuXHJcblx0XHRcdC8vICBJIGhvcGUgdGhpcyB3aWxsIG5ldmVyIG9jY3VyIChIZXkgdGhpcyB3YXkgd2UgaGF2ZSBzbWFsbGVyIGJ1bmRsZXMpXHJcblx0XHRcdGlmKHR5cGVvZiBpdGVtWzBdICE9PSBcIm51bWJlclwiIHx8ICFhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2l0ZW1bMF1dKSB7XHJcblx0XHRcdFx0aWYobWVkaWFRdWVyeSAmJiAhaXRlbVsyXSkge1xyXG5cdFx0XHRcdFx0aXRlbVsyXSA9IG1lZGlhUXVlcnk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKG1lZGlhUXVlcnkpIHtcclxuXHRcdFx0XHRcdGl0ZW1bMl0gPSBcIihcIiArIGl0ZW1bMl0gKyBcIikgYW5kIChcIiArIG1lZGlhUXVlcnkgKyBcIilcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0bGlzdC5wdXNoKGl0ZW0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fTtcclxuXHRyZXR1cm4gbGlzdDtcclxufTtcclxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2Nzcy1sb2FkZXIvbGliL2Nzcy1iYXNlLmpzXG4gKiogbW9kdWxlIGlkID0gNFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSB7XG5cdFwidmVyc2lvblwiOiBcIjAuMS4wXCJcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL2luZGV4Lmpzb25cbiAqKiBtb2R1bGUgaWQgPSA1XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIoZnVuY3Rpb24ocm9vdCkge1xuXG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgU1RPUFBFRCAgPSAwO1xuICB2YXIgU1RPUFBJTkcgPSAxO1xuICB2YXIgUlVOTklORyAgPSAyO1xuXG4gIGZ1bmN0aW9uIGVuZHNXaXRoKHN0ciwgc3VmZml4KSB7XG4gICAgcmV0dXJuIHN0ci5pbmRleE9mKHN1ZmZpeCwgc3RyLmxlbmd0aCAtIHN1ZmZpeC5sZW5ndGgpICE9PSAtMTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG5vb3AoKSB7fVxuXG4gIGZ1bmN0aW9uIE1hbGFya2V5KGVsZW0sIG9wdHMpIHtcblxuICAgIC8vIGFsbG93IGBNYWxhcmtleWAgdG8gYmUgY2FsbGVkIHdpdGhvdXQgdGhlIGBuZXdgIGtleXdvcmRcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgaWYgKCEoc2VsZiBpbnN0YW5jZW9mIE1hbGFya2V5KSkge1xuICAgICAgcmV0dXJuIG5ldyBNYWxhcmtleShlbGVtLCBvcHRzKTtcbiAgICB9XG5cbiAgICAvLyBkZWZhdWx0IGBvcHRzYFxuICAgIG9wdHMgPSBvcHRzIHx8IHt9O1xuICAgIHZhciBsb29wID0gb3B0cy5sb29wO1xuICAgIHZhciB0eXBlU3BlZWQgPSBvcHRzLnNwZWVkIHx8IG9wdHMudHlwZVNwZWVkIHx8IDUwO1xuICAgIHZhciBkZWxldGVTcGVlZCA9IG9wdHMuc3BlZWQgfHwgb3B0cy5kZWxldGVTcGVlZCB8fCA1MDtcbiAgICB2YXIgcGF1c2VEZWxheSA9IG9wdHMuZGVsYXkgfHwgb3B0cy5wYXVzZURlbGF5IHx8IDIwMDA7XG4gICAgdmFyIHBvc3RmaXggPSBvcHRzLnBvc3RmaXggfHwgJyc7XG4gICAgdmFyIGdldHRlciA9IG9wdHMuZ2V0dGVyIHx8IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgIHJldHVybiBlbGVtLmlubmVySFRNTDtcbiAgICB9O1xuICAgIHZhciBzZXR0ZXIgPSBvcHRzLnNldHRlciB8fCBmdW5jdGlvbihlbGVtLCB2YWwpIHtcbiAgICAgIGVsZW0uaW5uZXJIVE1MID0gdmFsO1xuICAgIH07XG5cbiAgICAvLyB0aGUgZnVuY3Rpb24gcXVldWVcbiAgICB2YXIgZm5RdWV1ZSA9IFtdO1xuICAgIHZhciBhcmdzUXVldWUgPSBbXTtcbiAgICB2YXIgaSA9IC0xO1xuICAgIHZhciBzdGF0ZSA9IFNUT1BQRUQ7XG4gICAgdmFyIHBhdXNlQ2IgPSBub29wO1xuICAgIGZ1bmN0aW9uIGVucXVldWUoZm4sIGFyZ3MpIHtcbiAgICAgIGZuUXVldWUucHVzaChmbik7XG4gICAgICBhcmdzUXVldWUucHVzaChhcmdzKTtcbiAgICAgIGlmIChzdGF0ZSAhPSBSVU5OSU5HKSB7XG4gICAgICAgIHN0YXRlID0gUlVOTklORztcbiAgICAgICAgLy8gd2FpdCBmb3IgdGhlIHJlbWFpbmluZyBmdW5jdGlvbnMgdG8gYmUgZW5xdWV1ZWRcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBuZXh0KCk7XG4gICAgICAgIH0sIDApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNlbGY7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICBpZiAoc3RhdGUgIT0gUlVOTklORykge1xuICAgICAgICBzdGF0ZSA9IFNUT1BQRUQ7XG4gICAgICAgIHBhdXNlQ2IoZWxlbSk7XG4gICAgICAgIHBhdXNlQ2IgPSBub29wO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoKytpID09IGZuUXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGlmICghbG9vcCkge1xuICAgICAgICAgIGkgPSBmblF1ZXVlLmxlbmd0aCAtIDE7IC8vIHNldCBgaWAgdG8gdGhlIGxhc3QgZWxlbWVudCBvZiBgZm5RdWV1ZWBcbiAgICAgICAgICBzdGF0ZSA9IFNUT1BQRUQ7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGkgPSAwO1xuICAgICAgfVxuICAgICAgZm5RdWV1ZVtpXS5hcHBseShudWxsLCBbXS5jb25jYXQobmV4dCwgYXJnc1F1ZXVlW2ldKSk7XG4gICAgfVxuXG4gICAgLy8gaW50ZXJuYWwgZnVuY3Rpb25zIHRoYXQgYXJlIGBlbnF1ZXVlZGAgdmlhIHRoZSByZXNwZWN0aXZlIHB1YmxpYyBtZXRob2RzXG4gICAgZnVuY3Rpb24gX3R5cGUoY2IsIHN0ciwgc3BlZWQpIHtcbiAgICAgIHZhciBsZW4gPSBzdHIubGVuZ3RoO1xuICAgICAgaWYgKCFsZW4pIHtcbiAgICAgICAgcmV0dXJuIGNiKCk7XG4gICAgICB9XG4gICAgICAoZnVuY3Rpb24gdChpKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgc2V0dGVyKGVsZW0sIGdldHRlcihlbGVtKSArIHN0cltpXSk7XG4gICAgICAgICAgaSArPSAxO1xuICAgICAgICAgIGlmIChpIDwgbGVuKSB7XG4gICAgICAgICAgICB0KGkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgc3BlZWQpO1xuICAgICAgfSkoMCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIF9kZWxldGUoY2IsIHgsIHNwZWVkKSB7XG4gICAgICB2YXIgY3VyciA9IGdldHRlcihlbGVtKTtcbiAgICAgIHZhciBjb3VudCA9IGN1cnIubGVuZ3RoOyAvLyBkZWZhdWx0IHRvIGRlbGV0aW5nIGVudGlyZSBjb250ZW50cyBvZiBgZWxlbWBcbiAgICAgIGlmICh4ICE9IG51bGwpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB4ID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgLy8gZGVsZXRlIHRoZSBzdHJpbmcgYHhgIGlmIGFuZCBvbmx5IGlmIGBlbGVtYCBlbmRzIHdpdGggYHhgXG4gICAgICAgICAgaWYgKGVuZHNXaXRoKGN1cnIsIHggKyBwb3N0Zml4KSkge1xuICAgICAgICAgICAgY291bnQgPSB4Lmxlbmd0aCArIHBvc3RmaXgubGVuZ3RoO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb3VudCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGRlbGV0ZSB0aGUgbGFzdCBgeGAgY2hhcmFjdGVycyBmcm9tIGBlbGVtYFxuICAgICAgICAgIGlmICh4ID4gLTEpIHtcbiAgICAgICAgICAgIGNvdW50ID0gTWF0aC5taW4oeCwgY291bnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCFjb3VudCkge1xuICAgICAgICByZXR1cm4gY2IoKTtcbiAgICAgIH1cbiAgICAgIChmdW5jdGlvbiBkKGNvdW50KSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGN1cnIgPSBnZXR0ZXIoZWxlbSk7XG4gICAgICAgICAgaWYgKGNvdW50KSB7XG4gICAgICAgICAgICAvLyBkcm9wIGxhc3QgY2hhclxuICAgICAgICAgICAgc2V0dGVyKGVsZW0sIGN1cnIuc3Vic3RyaW5nKDAsIGN1cnIubGVuZ3RoLTEpKTtcbiAgICAgICAgICAgIGQoY291bnQgLSAxKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIHNwZWVkKTtcbiAgICAgIH0pKGNvdW50KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gX2NsZWFyKGNiKSB7XG4gICAgICBzZXR0ZXIoZWxlbSwgJycpO1xuICAgICAgY2IoKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gX2NhbGwoY2IsIGZuKSB7XG4gICAgICBmbi5jYWxsKGNiLCBlbGVtKTtcbiAgICB9XG5cbiAgICAvLyBleHBvc2UgdGhlIHB1YmxpYyBtZXRob2RzXG4gICAgc2VsZi50eXBlID0gZnVuY3Rpb24oc3RyLCBzcGVlZCkge1xuICAgICAgcmV0dXJuIGVucXVldWUoX3R5cGUsIFtzdHIgKyBwb3N0Zml4LCBzcGVlZCB8fCB0eXBlU3BlZWRdKTtcbiAgICB9O1xuICAgIHNlbGYuZGVsZXRlID0gZnVuY3Rpb24oeCwgc3BlZWQpIHtcbiAgICAgIHJldHVybiBlbnF1ZXVlKF9kZWxldGUsIFt4LCBzcGVlZCB8fCBkZWxldGVTcGVlZF0pO1xuICAgIH07XG4gICAgc2VsZi5jbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGVucXVldWUoX2NsZWFyKTtcbiAgICB9O1xuICAgIHNlbGYucGF1c2UgPSBmdW5jdGlvbihkZWxheSkge1xuICAgICAgcmV0dXJuIGVucXVldWUoc2V0VGltZW91dCwgW2RlbGF5IHx8IHBhdXNlRGVsYXldKTtcbiAgICB9O1xuICAgIHNlbGYuY2FsbCA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgICByZXR1cm4gZW5xdWV1ZShfY2FsbCwgW2ZuXSk7XG4gICAgfTtcbiAgICBzZWxmLnRyaWdnZXJQYXVzZSA9IGZ1bmN0aW9uKGNiKSB7XG4gICAgICBzdGF0ZSA9IFNUT1BQSU5HO1xuICAgICAgcGF1c2VDYiA9IGNiIHx8IG5vb3A7XG4gICAgICByZXR1cm4gc2VsZjtcbiAgICB9O1xuICAgIHNlbGYudHJpZ2dlclJlc3VtZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHN0YXRlICE9IFJVTk5JTkcpIHsgLy8gaWUuIGBTVE9QUEVEYCBvciBgU1RPUFBJTkdgXG4gICAgICAgIHZhciBwcmV2U3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgc3RhdGUgPSBSVU5OSU5HO1xuICAgICAgICBpZiAocHJldlN0YXRlID09IFNUT1BQRUQpIHtcbiAgICAgICAgICBuZXh0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBzZWxmO1xuICAgIH07XG4gICAgc2VsZi5pc1J1bm5pbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzdGF0ZSAhPSBTVE9QUEVEOyAvLyBpZS4gYFJVTk5JTkdgIG9yIGBTVE9QUElOR2BcbiAgICB9O1xuXG4gIH1cblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICBpZiAodHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0Jykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gTWFsYXJrZXk7XG4gIH0gZWxzZSB7XG4gICAgcm9vdC5tYWxhcmtleSA9IE1hbGFya2V5O1xuICB9XG5cbn0pKHRoaXMpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L21hbGFya2V5L2luZGV4LmpzXG4gKiogbW9kdWxlIGlkID0gNlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLypcclxuXHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxyXG5cdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcclxuKi9cclxudmFyIHN0eWxlc0luRG9tID0ge30sXHJcblx0bWVtb2l6ZSA9IGZ1bmN0aW9uKGZuKSB7XHJcblx0XHR2YXIgbWVtbztcclxuXHRcdHJldHVybiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGlmICh0eXBlb2YgbWVtbyA9PT0gXCJ1bmRlZmluZWRcIikgbWVtbyA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0XHRcdHJldHVybiBtZW1vO1xyXG5cdFx0fTtcclxuXHR9LFxyXG5cdGlzT2xkSUUgPSBtZW1vaXplKGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIC9tc2llIFs2LTldXFxiLy50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkpO1xyXG5cdH0pLFxyXG5cdGdldEhlYWRFbGVtZW50ID0gbWVtb2l6ZShmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF07XHJcblx0fSksXHJcblx0c2luZ2xldG9uRWxlbWVudCA9IG51bGwsXHJcblx0c2luZ2xldG9uQ291bnRlciA9IDAsXHJcblx0c3R5bGVFbGVtZW50c0luc2VydGVkQXRUb3AgPSBbXTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obGlzdCwgb3B0aW9ucykge1xyXG5cdGlmKHR5cGVvZiBERUJVRyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBERUJVRykge1xyXG5cdFx0aWYodHlwZW9mIGRvY3VtZW50ICE9PSBcIm9iamVjdFwiKSB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgc3R5bGUtbG9hZGVyIGNhbm5vdCBiZSB1c2VkIGluIGEgbm9uLWJyb3dzZXIgZW52aXJvbm1lbnRcIik7XHJcblx0fVxyXG5cclxuXHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuXHQvLyBGb3JjZSBzaW5nbGUtdGFnIHNvbHV0aW9uIG9uIElFNi05LCB3aGljaCBoYXMgYSBoYXJkIGxpbWl0IG9uIHRoZSAjIG9mIDxzdHlsZT5cclxuXHQvLyB0YWdzIGl0IHdpbGwgYWxsb3cgb24gYSBwYWdlXHJcblx0aWYgKHR5cGVvZiBvcHRpb25zLnNpbmdsZXRvbiA9PT0gXCJ1bmRlZmluZWRcIikgb3B0aW9ucy5zaW5nbGV0b24gPSBpc09sZElFKCk7XHJcblxyXG5cdC8vIEJ5IGRlZmF1bHQsIGFkZCA8c3R5bGU+IHRhZ3MgdG8gdGhlIGJvdHRvbSBvZiA8aGVhZD4uXHJcblx0aWYgKHR5cGVvZiBvcHRpb25zLmluc2VydEF0ID09PSBcInVuZGVmaW5lZFwiKSBvcHRpb25zLmluc2VydEF0ID0gXCJib3R0b21cIjtcclxuXHJcblx0dmFyIHN0eWxlcyA9IGxpc3RUb1N0eWxlcyhsaXN0KTtcclxuXHRhZGRTdHlsZXNUb0RvbShzdHlsZXMsIG9wdGlvbnMpO1xyXG5cclxuXHRyZXR1cm4gZnVuY3Rpb24gdXBkYXRlKG5ld0xpc3QpIHtcclxuXHRcdHZhciBtYXlSZW1vdmUgPSBbXTtcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGl0ZW0gPSBzdHlsZXNbaV07XHJcblx0XHRcdHZhciBkb21TdHlsZSA9IHN0eWxlc0luRG9tW2l0ZW0uaWRdO1xyXG5cdFx0XHRkb21TdHlsZS5yZWZzLS07XHJcblx0XHRcdG1heVJlbW92ZS5wdXNoKGRvbVN0eWxlKTtcclxuXHRcdH1cclxuXHRcdGlmKG5ld0xpc3QpIHtcclxuXHRcdFx0dmFyIG5ld1N0eWxlcyA9IGxpc3RUb1N0eWxlcyhuZXdMaXN0KTtcclxuXHRcdFx0YWRkU3R5bGVzVG9Eb20obmV3U3R5bGVzLCBvcHRpb25zKTtcclxuXHRcdH1cclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBtYXlSZW1vdmUubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGRvbVN0eWxlID0gbWF5UmVtb3ZlW2ldO1xyXG5cdFx0XHRpZihkb21TdHlsZS5yZWZzID09PSAwKSB7XHJcblx0XHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGRvbVN0eWxlLnBhcnRzLmxlbmd0aDsgaisrKVxyXG5cdFx0XHRcdFx0ZG9tU3R5bGUucGFydHNbal0oKTtcclxuXHRcdFx0XHRkZWxldGUgc3R5bGVzSW5Eb21bZG9tU3R5bGUuaWRdO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fTtcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkU3R5bGVzVG9Eb20oc3R5bGVzLCBvcHRpb25zKSB7XHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0dmFyIGl0ZW0gPSBzdHlsZXNbaV07XHJcblx0XHR2YXIgZG9tU3R5bGUgPSBzdHlsZXNJbkRvbVtpdGVtLmlkXTtcclxuXHRcdGlmKGRvbVN0eWxlKSB7XHJcblx0XHRcdGRvbVN0eWxlLnJlZnMrKztcclxuXHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGRvbVN0eWxlLnBhcnRzLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0ZG9tU3R5bGUucGFydHNbal0oaXRlbS5wYXJ0c1tqXSk7XHJcblx0XHRcdH1cclxuXHRcdFx0Zm9yKDsgaiA8IGl0ZW0ucGFydHMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRkb21TdHlsZS5wYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dmFyIHBhcnRzID0gW107XHJcblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBpdGVtLnBhcnRzLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0cGFydHMucHVzaChhZGRTdHlsZShpdGVtLnBhcnRzW2pdLCBvcHRpb25zKSk7XHJcblx0XHRcdH1cclxuXHRcdFx0c3R5bGVzSW5Eb21baXRlbS5pZF0gPSB7aWQ6IGl0ZW0uaWQsIHJlZnM6IDEsIHBhcnRzOiBwYXJ0c307XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBsaXN0VG9TdHlsZXMobGlzdCkge1xyXG5cdHZhciBzdHlsZXMgPSBbXTtcclxuXHR2YXIgbmV3U3R5bGVzID0ge307XHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcclxuXHRcdHZhciBpdGVtID0gbGlzdFtpXTtcclxuXHRcdHZhciBpZCA9IGl0ZW1bMF07XHJcblx0XHR2YXIgY3NzID0gaXRlbVsxXTtcclxuXHRcdHZhciBtZWRpYSA9IGl0ZW1bMl07XHJcblx0XHR2YXIgc291cmNlTWFwID0gaXRlbVszXTtcclxuXHRcdHZhciBwYXJ0ID0ge2NzczogY3NzLCBtZWRpYTogbWVkaWEsIHNvdXJjZU1hcDogc291cmNlTWFwfTtcclxuXHRcdGlmKCFuZXdTdHlsZXNbaWRdKVxyXG5cdFx0XHRzdHlsZXMucHVzaChuZXdTdHlsZXNbaWRdID0ge2lkOiBpZCwgcGFydHM6IFtwYXJ0XX0pO1xyXG5cdFx0ZWxzZVxyXG5cdFx0XHRuZXdTdHlsZXNbaWRdLnBhcnRzLnB1c2gocGFydCk7XHJcblx0fVxyXG5cdHJldHVybiBzdHlsZXM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zLCBzdHlsZUVsZW1lbnQpIHtcclxuXHR2YXIgaGVhZCA9IGdldEhlYWRFbGVtZW50KCk7XHJcblx0dmFyIGxhc3RTdHlsZUVsZW1lbnRJbnNlcnRlZEF0VG9wID0gc3R5bGVFbGVtZW50c0luc2VydGVkQXRUb3Bbc3R5bGVFbGVtZW50c0luc2VydGVkQXRUb3AubGVuZ3RoIC0gMV07XHJcblx0aWYgKG9wdGlvbnMuaW5zZXJ0QXQgPT09IFwidG9wXCIpIHtcclxuXHRcdGlmKCFsYXN0U3R5bGVFbGVtZW50SW5zZXJ0ZWRBdFRvcCkge1xyXG5cdFx0XHRoZWFkLmluc2VydEJlZm9yZShzdHlsZUVsZW1lbnQsIGhlYWQuZmlyc3RDaGlsZCk7XHJcblx0XHR9IGVsc2UgaWYobGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AubmV4dFNpYmxpbmcpIHtcclxuXHRcdFx0aGVhZC5pbnNlcnRCZWZvcmUoc3R5bGVFbGVtZW50LCBsYXN0U3R5bGVFbGVtZW50SW5zZXJ0ZWRBdFRvcC5uZXh0U2libGluZyk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRoZWFkLmFwcGVuZENoaWxkKHN0eWxlRWxlbWVudCk7XHJcblx0XHR9XHJcblx0XHRzdHlsZUVsZW1lbnRzSW5zZXJ0ZWRBdFRvcC5wdXNoKHN0eWxlRWxlbWVudCk7XHJcblx0fSBlbHNlIGlmIChvcHRpb25zLmluc2VydEF0ID09PSBcImJvdHRvbVwiKSB7XHJcblx0XHRoZWFkLmFwcGVuZENoaWxkKHN0eWxlRWxlbWVudCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWUgZm9yIHBhcmFtZXRlciAnaW5zZXJ0QXQnLiBNdXN0IGJlICd0b3AnIG9yICdib3R0b20nLlwiKTtcclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZVN0eWxlRWxlbWVudChzdHlsZUVsZW1lbnQpIHtcclxuXHRzdHlsZUVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG5cdHZhciBpZHggPSBzdHlsZUVsZW1lbnRzSW5zZXJ0ZWRBdFRvcC5pbmRleE9mKHN0eWxlRWxlbWVudCk7XHJcblx0aWYoaWR4ID49IDApIHtcclxuXHRcdHN0eWxlRWxlbWVudHNJbnNlcnRlZEF0VG9wLnNwbGljZShpZHgsIDEpO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlU3R5bGVFbGVtZW50KG9wdGlvbnMpIHtcclxuXHR2YXIgc3R5bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xyXG5cdHN0eWxlRWxlbWVudC50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xyXG5cdGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zLCBzdHlsZUVsZW1lbnQpO1xyXG5cdHJldHVybiBzdHlsZUVsZW1lbnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUxpbmtFbGVtZW50KG9wdGlvbnMpIHtcclxuXHR2YXIgbGlua0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlua1wiKTtcclxuXHRsaW5rRWxlbWVudC5yZWwgPSBcInN0eWxlc2hlZXRcIjtcclxuXHRpbnNlcnRTdHlsZUVsZW1lbnQob3B0aW9ucywgbGlua0VsZW1lbnQpO1xyXG5cdHJldHVybiBsaW5rRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkU3R5bGUob2JqLCBvcHRpb25zKSB7XHJcblx0dmFyIHN0eWxlRWxlbWVudCwgdXBkYXRlLCByZW1vdmU7XHJcblxyXG5cdGlmIChvcHRpb25zLnNpbmdsZXRvbikge1xyXG5cdFx0dmFyIHN0eWxlSW5kZXggPSBzaW5nbGV0b25Db3VudGVyKys7XHJcblx0XHRzdHlsZUVsZW1lbnQgPSBzaW5nbGV0b25FbGVtZW50IHx8IChzaW5nbGV0b25FbGVtZW50ID0gY3JlYXRlU3R5bGVFbGVtZW50KG9wdGlvbnMpKTtcclxuXHRcdHVwZGF0ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQsIHN0eWxlSW5kZXgsIGZhbHNlKTtcclxuXHRcdHJlbW92ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQsIHN0eWxlSW5kZXgsIHRydWUpO1xyXG5cdH0gZWxzZSBpZihvYmouc291cmNlTWFwICYmXHJcblx0XHR0eXBlb2YgVVJMID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdHR5cGVvZiBVUkwuY3JlYXRlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdHR5cGVvZiBVUkwucmV2b2tlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdHR5cGVvZiBCbG9iID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdHR5cGVvZiBidG9hID09PSBcImZ1bmN0aW9uXCIpIHtcclxuXHRcdHN0eWxlRWxlbWVudCA9IGNyZWF0ZUxpbmtFbGVtZW50KG9wdGlvbnMpO1xyXG5cdFx0dXBkYXRlID0gdXBkYXRlTGluay5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCk7XHJcblx0XHRyZW1vdmUgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0cmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlRWxlbWVudCk7XHJcblx0XHRcdGlmKHN0eWxlRWxlbWVudC5ocmVmKVxyXG5cdFx0XHRcdFVSTC5yZXZva2VPYmplY3RVUkwoc3R5bGVFbGVtZW50LmhyZWYpO1xyXG5cdFx0fTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0c3R5bGVFbGVtZW50ID0gY3JlYXRlU3R5bGVFbGVtZW50KG9wdGlvbnMpO1xyXG5cdFx0dXBkYXRlID0gYXBwbHlUb1RhZy5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCk7XHJcblx0XHRyZW1vdmUgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0cmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlRWxlbWVudCk7XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0dXBkYXRlKG9iaik7XHJcblxyXG5cdHJldHVybiBmdW5jdGlvbiB1cGRhdGVTdHlsZShuZXdPYmopIHtcclxuXHRcdGlmKG5ld09iaikge1xyXG5cdFx0XHRpZihuZXdPYmouY3NzID09PSBvYmouY3NzICYmIG5ld09iai5tZWRpYSA9PT0gb2JqLm1lZGlhICYmIG5ld09iai5zb3VyY2VNYXAgPT09IG9iai5zb3VyY2VNYXApXHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR1cGRhdGUob2JqID0gbmV3T2JqKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJlbW92ZSgpO1xyXG5cdFx0fVxyXG5cdH07XHJcbn1cclxuXHJcbnZhciByZXBsYWNlVGV4dCA9IChmdW5jdGlvbiAoKSB7XHJcblx0dmFyIHRleHRTdG9yZSA9IFtdO1xyXG5cclxuXHRyZXR1cm4gZnVuY3Rpb24gKGluZGV4LCByZXBsYWNlbWVudCkge1xyXG5cdFx0dGV4dFN0b3JlW2luZGV4XSA9IHJlcGxhY2VtZW50O1xyXG5cdFx0cmV0dXJuIHRleHRTdG9yZS5maWx0ZXIoQm9vbGVhbikuam9pbignXFxuJyk7XHJcblx0fTtcclxufSkoKTtcclxuXHJcbmZ1bmN0aW9uIGFwcGx5VG9TaW5nbGV0b25UYWcoc3R5bGVFbGVtZW50LCBpbmRleCwgcmVtb3ZlLCBvYmopIHtcclxuXHR2YXIgY3NzID0gcmVtb3ZlID8gXCJcIiA6IG9iai5jc3M7XHJcblxyXG5cdGlmIChzdHlsZUVsZW1lbnQuc3R5bGVTaGVldCkge1xyXG5cdFx0c3R5bGVFbGVtZW50LnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KGluZGV4LCBjc3MpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR2YXIgY3NzTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcyk7XHJcblx0XHR2YXIgY2hpbGROb2RlcyA9IHN0eWxlRWxlbWVudC5jaGlsZE5vZGVzO1xyXG5cdFx0aWYgKGNoaWxkTm9kZXNbaW5kZXhdKSBzdHlsZUVsZW1lbnQucmVtb3ZlQ2hpbGQoY2hpbGROb2Rlc1tpbmRleF0pO1xyXG5cdFx0aWYgKGNoaWxkTm9kZXMubGVuZ3RoKSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudC5pbnNlcnRCZWZvcmUoY3NzTm9kZSwgY2hpbGROb2Rlc1tpbmRleF0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LmFwcGVuZENoaWxkKGNzc05vZGUpO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gYXBwbHlUb1RhZyhzdHlsZUVsZW1lbnQsIG9iaikge1xyXG5cdHZhciBjc3MgPSBvYmouY3NzO1xyXG5cdHZhciBtZWRpYSA9IG9iai5tZWRpYTtcclxuXHR2YXIgc291cmNlTWFwID0gb2JqLnNvdXJjZU1hcDtcclxuXHJcblx0aWYobWVkaWEpIHtcclxuXHRcdHN0eWxlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtZWRpYVwiLCBtZWRpYSlcclxuXHR9XHJcblxyXG5cdGlmKHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0KSB7XHJcblx0XHRzdHlsZUVsZW1lbnQuc3R5bGVTaGVldC5jc3NUZXh0ID0gY3NzO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR3aGlsZShzdHlsZUVsZW1lbnQuZmlyc3RDaGlsZCkge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQucmVtb3ZlQ2hpbGQoc3R5bGVFbGVtZW50LmZpcnN0Q2hpbGQpO1xyXG5cdFx0fVxyXG5cdFx0c3R5bGVFbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcykpO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlTGluayhsaW5rRWxlbWVudCwgb2JqKSB7XHJcblx0dmFyIGNzcyA9IG9iai5jc3M7XHJcblx0dmFyIG1lZGlhID0gb2JqLm1lZGlhO1xyXG5cdHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xyXG5cclxuXHRpZihzb3VyY2VNYXApIHtcclxuXHRcdC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzI2NjAzODc1XHJcblx0XHRjc3MgKz0gXCJcXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LFwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKSArIFwiICovXCI7XHJcblx0fVxyXG5cclxuXHR2YXIgYmxvYiA9IG5ldyBCbG9iKFtjc3NdLCB7IHR5cGU6IFwidGV4dC9jc3NcIiB9KTtcclxuXHJcblx0dmFyIG9sZFNyYyA9IGxpbmtFbGVtZW50LmhyZWY7XHJcblxyXG5cdGxpbmtFbGVtZW50LmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG5cclxuXHRpZihvbGRTcmMpXHJcblx0XHRVUkwucmV2b2tlT2JqZWN0VVJMKG9sZFNyYyk7XHJcbn1cclxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L3N0eWxlLWxvYWRlci9hZGRTdHlsZXMuanNcbiAqKiBtb2R1bGUgaWQgPSA3XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvLyBzdHlsZS1sb2FkZXI6IEFkZHMgc29tZSBjc3MgdG8gdGhlIERPTSBieSBhZGRpbmcgYSA8c3R5bGU+IHRhZ1xuXG4vLyBsb2FkIHRoZSBzdHlsZXNcbnZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuL2luZGV4LmNzc1wiKTtcbmlmKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuLy8gYWRkIHRoZSBzdHlsZXMgdG8gdGhlIERPTVxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2FkZFN0eWxlcy5qc1wiKShjb250ZW50LCB7fSk7XG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2Fscztcbi8vIEhvdCBNb2R1bGUgUmVwbGFjZW1lbnRcbmlmKG1vZHVsZS5ob3QpIHtcblx0Ly8gV2hlbiB0aGUgc3R5bGVzIGNoYW5nZSwgdXBkYXRlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0aWYoIWNvbnRlbnQubG9jYWxzKSB7XG5cdFx0bW9kdWxlLmhvdC5hY2NlcHQoXCIhIS4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanMhLi9pbmRleC5jc3NcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanMhLi9pbmRleC5jc3NcIik7XG5cdFx0XHRpZih0eXBlb2YgbmV3Q29udGVudCA9PT0gJ3N0cmluZycpIG5ld0NvbnRlbnQgPSBbW21vZHVsZS5pZCwgbmV3Q29udGVudCwgJyddXTtcblx0XHRcdHVwZGF0ZShuZXdDb250ZW50KTtcblx0XHR9KTtcblx0fVxuXHQvLyBXaGVuIHRoZSBtb2R1bGUgaXMgZGlzcG9zZWQsIHJlbW92ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9pbmRleC5jc3NcbiAqKiBtb2R1bGUgaWQgPSA4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwic291cmNlUm9vdCI6IiJ9